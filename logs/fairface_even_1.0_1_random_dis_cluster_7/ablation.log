===2023-06-08 16:36:48===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
domain number = 7
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-White                    | Train Loss: 2.1803 | Train Acc: 0.1942
 Site-White                    | Train Loss: 2.1699 | Train Acc: 0.2326
 Site-Latino_Hispanic          | Train Loss: 2.1756 | Train Acc: 0.1655
 Site-Latino_Hispanic          | Train Loss: 2.1860 | Train Acc: 0.1990
 Site-Black                    | Train Loss: 2.1721 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 2.1771 | Train Acc: 0.1727
 Site-East_Asian               | Train Loss: 2.1685 | Train Acc: 0.1583
 Site-East_Asian               | Train Loss: 2.1733 | Train Acc: 0.1679
 Site-Indian                   | Train Loss: 2.1652 | Train Acc: 0.2302
 Site-Indian                   | Train Loss: 2.1765 | Train Acc: 0.1894
 Site-Southeast_Asian          | Train Loss: 2.1874 | Train Acc: 0.1871
 Site-Southeast_Asian          | Train Loss: 2.1742 | Train Acc: 0.1990
 Site-Middle_Eastern           | Train Loss: 2.1676 | Train Acc: 0.2158
 Site-Middle_Eastern           | Train Loss: 2.1785 | Train Acc: 0.1583
 Site-White                         | Val  Loss: 2.1864 | Val  Acc: 0.1739
 Site-White                         | Val  Loss: 2.1686 | Val  Acc: 0.2338
 Site-Latino_Hispanic               | Val  Loss: 2.1839 | Val  Acc: 0.2174
 Site-Latino_Hispanic               | Val  Loss: 2.1824 | Val  Acc: 0.1942
 Site-Black                         | Val  Loss: 2.1688 | Val  Acc: 0.1848
 Site-Black                         | Val  Loss: 2.1696 | Val  Acc: 0.2050
 Site-East_Asian                    | Val  Loss: 2.1645 | Val  Acc: 0.2174
 Site-East_Asian                    | Val  Loss: 2.1737 | Val  Acc: 0.1547
 Site-Indian                        | Val  Loss: 2.1738 | Val  Acc: 0.1630
 Site-Indian                        | Val  Loss: 2.1748 | Val  Acc: 0.1871
 Site-Southeast_Asian               | Val  Loss: 2.1789 | Val  Acc: 0.1957
 Site-Southeast_Asian               | Val  Loss: 2.1729 | Val  Acc: 0.1978
 Site-Middle_Eastern                | Val  Loss: 2.1695 | Val  Acc: 0.1630
 Site-Middle_Eastern                | Val  Loss: 2.1806 | Val  Acc: 0.1871
Average Valid Accuracy: 0.1911
 Best site-White                         | Epoch:0 | Val Acc: 0.1739
 Best site-White                         | Epoch:0 | Val Acc: 0.2338
 Best site-Latino_Hispanic               | Epoch:0 | Val Acc: 0.2174
 Best site-Latino_Hispanic               | Epoch:0 | Val Acc: 0.1942
 Best site-Black                         | Epoch:0 | Val Acc: 0.1848
 Best site-Black                         | Epoch:0 | Val Acc: 0.2050
 Best site-East_Asian                    | Epoch:0 | Val Acc: 0.2174
 Best site-East_Asian                    | Epoch:0 | Val Acc: 0.1547
 Best site-Indian                        | Epoch:0 | Val Acc: 0.1630
 Best site-Indian                        | Epoch:0 | Val Acc: 0.1871
 Best site-Southeast_Asian               | Epoch:0 | Val Acc: 0.1957
 Best site-Southeast_Asian               | Epoch:0 | Val Acc: 0.1978
 Best site-Middle_Eastern                | Epoch:0 | Val Acc: 0.1630
 Best site-Middle_Eastern                | Epoch:0 | Val Acc: 0.1871
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-White                    | Train Loss: 2.1392 | Train Acc: 0.3165
 Site-White                    | Train Loss: 2.1216 | Train Acc: 0.3381
 Site-Latino_Hispanic          | Train Loss: 2.1501 | Train Acc: 0.3165
 Site-Latino_Hispanic          | Train Loss: 2.1451 | Train Acc: 0.2758
 Site-Black                    | Train Loss: 2.1571 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 2.1443 | Train Acc: 0.2566
 Site-East_Asian               | Train Loss: 2.1432 | Train Acc: 0.3094
 Site-East_Asian               | Train Loss: 2.1285 | Train Acc: 0.3453
 Site-Indian                   | Train Loss: 2.1579 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 2.1472 | Train Acc: 0.2350
 Site-Southeast_Asian          | Train Loss: 2.1492 | Train Acc: 0.2806
 Site-Southeast_Asian          | Train Loss: 2.1381 | Train Acc: 0.2758
 Site-Middle_Eastern           | Train Loss: 2.1599 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 2.1467 | Train Acc: 0.2398
 Site-White                         | Val  Loss: 2.1381 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 2.1257 | Val  Acc: 0.3237
 Site-Latino_Hispanic               | Val  Loss: 2.1543 | Val  Acc: 0.2500
 Site-Latino_Hispanic               | Val  Loss: 2.1402 | Val  Acc: 0.2914
 Site-Black                         | Val  Loss: 2.1414 | Val  Acc: 0.2391
 Site-Black                         | Val  Loss: 2.1422 | Val  Acc: 0.2302
 Site-East_Asian                    | Val  Loss: 2.1122 | Val  Acc: 0.4130
 Site-East_Asian                    | Val  Loss: 2.1327 | Val  Acc: 0.3345
 Site-Indian                        | Val  Loss: 2.1552 | Val  Acc: 0.2065
 Site-Indian                        | Val  Loss: 2.1442 | Val  Acc: 0.2230
 Site-Southeast_Asian               | Val  Loss: 2.1456 | Val  Acc: 0.2500
 Site-Southeast_Asian               | Val  Loss: 2.1435 | Val  Acc: 0.2662
 Site-Middle_Eastern                | Val  Loss: 2.1262 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 2.1455 | Val  Acc: 0.2626
Average Valid Accuracy: 0.2770
 Best site-White                         | Epoch:1 | Val Acc: 0.3043
 Best site-White                         | Epoch:1 | Val Acc: 0.3237
 Best site-Latino_Hispanic               | Epoch:1 | Val Acc: 0.2500
 Best site-Latino_Hispanic               | Epoch:1 | Val Acc: 0.2914
 Best site-Black                         | Epoch:1 | Val Acc: 0.2391
 Best site-Black                         | Epoch:1 | Val Acc: 0.2302
 Best site-East_Asian                    | Epoch:1 | Val Acc: 0.4130
 Best site-East_Asian                    | Epoch:1 | Val Acc: 0.3345
 Best site-Indian                        | Epoch:1 | Val Acc: 0.2065
 Best site-Indian                        | Epoch:1 | Val Acc: 0.2230
 Best site-Southeast_Asian               | Epoch:1 | Val Acc: 0.2500
 Best site-Southeast_Asian               | Epoch:1 | Val Acc: 0.2662
 Best site-Middle_Eastern                | Epoch:1 | Val Acc: 0.2826
 Best site-Middle_Eastern                | Epoch:1 | Val Acc: 0.2626
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 2 ============
cnt=[2, 1, 2, 2, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-White                    | Train Loss: 2.0687 | Train Acc: 0.3309
 Site-White                    | Train Loss: 2.0864 | Train Acc: 0.3429
 Site-Latino_Hispanic          | Train Loss: 2.0998 | Train Acc: 0.2806
 Site-Latino_Hispanic          | Train Loss: 2.1114 | Train Acc: 0.2758
 Site-Black                    | Train Loss: 2.1056 | Train Acc: 0.2302
 Site-Black                    | Train Loss: 2.1228 | Train Acc: 0.2398
 Site-East_Asian               | Train Loss: 2.0804 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 2.0813 | Train Acc: 0.3741
 Site-Indian                   | Train Loss: 2.0906 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 2.1280 | Train Acc: 0.2374
 Site-Southeast_Asian          | Train Loss: 2.1323 | Train Acc: 0.2806
 Site-Southeast_Asian          | Train Loss: 2.1171 | Train Acc: 0.2782
 Site-Middle_Eastern           | Train Loss: 2.0990 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 2.1126 | Train Acc: 0.2734
 Site-White                         | Val  Loss: 2.1210 | Val  Acc: 0.2935
 Site-White                         | Val  Loss: 2.0891 | Val  Acc: 0.3453
 Site-Latino_Hispanic               | Val  Loss: 2.1241 | Val  Acc: 0.3043
 Site-Latino_Hispanic               | Val  Loss: 2.1114 | Val  Acc: 0.2770
 Site-Black                         | Val  Loss: 2.1159 | Val  Acc: 0.2935
 Site-Black                         | Val  Loss: 2.1064 | Val  Acc: 0.2338
 Site-East_Asian                    | Val  Loss: 2.0772 | Val  Acc: 0.4239
 Site-East_Asian                    | Val  Loss: 2.0903 | Val  Acc: 0.3669
 Site-Indian                        | Val  Loss: 2.1353 | Val  Acc: 0.1630
 Site-Indian                        | Val  Loss: 2.1246 | Val  Acc: 0.2194
 Site-Southeast_Asian               | Val  Loss: 2.1112 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 2.1153 | Val  Acc: 0.2734
 Site-Middle_Eastern                | Val  Loss: 2.0962 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 2.1169 | Val  Acc: 0.2626
Average Valid Accuracy: 0.2881
 Best site-White                         | Epoch:2 | Val Acc: 0.2935
 Best site-White                         | Epoch:2 | Val Acc: 0.3453
 Best site-Latino_Hispanic               | Epoch:2 | Val Acc: 0.3043
 Best site-Latino_Hispanic               | Epoch:2 | Val Acc: 0.2770
 Best site-Black                         | Epoch:2 | Val Acc: 0.2935
 Best site-Black                         | Epoch:2 | Val Acc: 0.2338
 Best site-East_Asian                    | Epoch:2 | Val Acc: 0.4239
 Best site-East_Asian                    | Epoch:2 | Val Acc: 0.3669
 Best site-Indian                        | Epoch:2 | Val Acc: 0.1630
 Best site-Indian                        | Epoch:2 | Val Acc: 0.2194
 Best site-Southeast_Asian               | Epoch:2 | Val Acc: 0.2935
 Best site-Southeast_Asian               | Epoch:2 | Val Acc: 0.2734
 Best site-Middle_Eastern                | Epoch:2 | Val Acc: 0.2826
 Best site-Middle_Eastern                | Epoch:2 | Val Acc: 0.2626
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 3 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-White                    | Train Loss: 2.0465 | Train Acc: 0.3453
 Site-White                    | Train Loss: 2.0521 | Train Acc: 0.3477
 Site-Latino_Hispanic          | Train Loss: 2.0986 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 2.0852 | Train Acc: 0.2638
 Site-Black                    | Train Loss: 2.1058 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 2.0952 | Train Acc: 0.2374
 Site-East_Asian               | Train Loss: 2.0493 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 2.0463 | Train Acc: 0.3813
 Site-Indian                   | Train Loss: 2.1060 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 2.0987 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 2.0967 | Train Acc: 0.3022
 Site-Southeast_Asian          | Train Loss: 2.0887 | Train Acc: 0.2974
 Site-Middle_Eastern           | Train Loss: 2.1039 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 2.0901 | Train Acc: 0.2590
 Site-White                         | Val  Loss: 2.0793 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 2.0526 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 2.0959 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 2.0787 | Val  Acc: 0.2878
 Site-Black                         | Val  Loss: 2.0763 | Val  Acc: 0.2826
 Site-Black                         | Val  Loss: 2.0874 | Val  Acc: 0.2482
 Site-East_Asian                    | Val  Loss: 2.0274 | Val  Acc: 0.4239
 Site-East_Asian                    | Val  Loss: 2.0515 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 2.1046 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 2.0992 | Val  Acc: 0.2410
 Site-Southeast_Asian               | Val  Loss: 2.0835 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 2.0894 | Val  Acc: 0.2950
 Site-Middle_Eastern                | Val  Loss: 2.0741 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 2.0908 | Val  Acc: 0.2590
Average Valid Accuracy: 0.2989
 Best site-White                         | Epoch:3 | Val Acc: 0.3152
 Best site-White                         | Epoch:3 | Val Acc: 0.3525
 Best site-Latino_Hispanic               | Epoch:3 | Val Acc: 0.2826
 Best site-Latino_Hispanic               | Epoch:3 | Val Acc: 0.2878
 Best site-Black                         | Epoch:3 | Val Acc: 0.2826
 Best site-Black                         | Epoch:3 | Val Acc: 0.2482
 Best site-East_Asian                    | Epoch:3 | Val Acc: 0.4239
 Best site-East_Asian                    | Epoch:3 | Val Acc: 0.3813
 Best site-Indian                        | Epoch:3 | Val Acc: 0.2391
 Best site-Indian                        | Epoch:3 | Val Acc: 0.2410
 Best site-Southeast_Asian               | Epoch:3 | Val Acc: 0.2935
 Best site-Southeast_Asian               | Epoch:3 | Val Acc: 0.2950
 Best site-Middle_Eastern                | Epoch:3 | Val Acc: 0.2826
 Best site-Middle_Eastern                | Epoch:3 | Val Acc: 0.2590
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 4 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-White                    | Train Loss: 2.0449 | Train Acc: 0.3597
 Site-White                    | Train Loss: 2.0196 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 2.0449 | Train Acc: 0.2806
 Site-Latino_Hispanic          | Train Loss: 2.0638 | Train Acc: 0.2638
 Site-Black                    | Train Loss: 2.0740 | Train Acc: 0.2086
 Site-Black                    | Train Loss: 2.0765 | Train Acc: 0.2542
 Site-East_Asian               | Train Loss: 1.9826 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 2.0146 | Train Acc: 0.3909
 Site-Indian                   | Train Loss: 2.0920 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 2.0780 | Train Acc: 0.2350
 Site-Southeast_Asian          | Train Loss: 2.0926 | Train Acc: 0.3094
 Site-Southeast_Asian          | Train Loss: 2.0639 | Train Acc: 0.2974
 Site-Middle_Eastern           | Train Loss: 2.0693 | Train Acc: 0.2590
 Site-Middle_Eastern           | Train Loss: 2.0693 | Train Acc: 0.2590
 Site-White                         | Val  Loss: 2.0563 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 2.0202 | Val  Acc: 0.3597
 Site-Latino_Hispanic               | Val  Loss: 2.0682 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 2.0558 | Val  Acc: 0.2842
 Site-Black                         | Val  Loss: 2.0587 | Val  Acc: 0.2609
 Site-Black                         | Val  Loss: 2.0604 | Val  Acc: 0.2374
 Site-East_Asian                    | Val  Loss: 1.9788 | Val  Acc: 0.4348
 Site-East_Asian                    | Val  Loss: 2.0197 | Val  Acc: 0.3849
 Site-Indian                        | Val  Loss: 2.0850 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 2.0820 | Val  Acc: 0.2194
 Site-Southeast_Asian               | Val  Loss: 2.0753 | Val  Acc: 0.2826
 Site-Southeast_Asian               | Val  Loss: 2.0640 | Val  Acc: 0.3094
 Site-Middle_Eastern                | Val  Loss: 2.0521 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 2.0668 | Val  Acc: 0.2482
Average Valid Accuracy: 0.2950
============ Train epoch 5 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-White                    | Train Loss: 2.0293 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.9864 | Train Acc: 0.3501
 Site-Latino_Hispanic          | Train Loss: 2.0116 | Train Acc: 0.2806
 Site-Latino_Hispanic          | Train Loss: 2.0349 | Train Acc: 0.2638
 Site-Black                    | Train Loss: 2.1053 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 2.0551 | Train Acc: 0.2422
 Site-East_Asian               | Train Loss: 1.9716 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.9801 | Train Acc: 0.3933
 Site-Indian                   | Train Loss: 2.0547 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 2.0700 | Train Acc: 0.2278
 Site-Southeast_Asian          | Train Loss: 2.1052 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 2.0475 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 2.0736 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 2.0559 | Train Acc: 0.2638
 Site-White                         | Val  Loss: 2.0429 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.9958 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 2.0505 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 2.0310 | Val  Acc: 0.2806
 Site-Black                         | Val  Loss: 2.0445 | Val  Acc: 0.2609
 Site-Black                         | Val  Loss: 2.0431 | Val  Acc: 0.2482
 Site-East_Asian                    | Val  Loss: 1.9553 | Val  Acc: 0.4239
 Site-East_Asian                    | Val  Loss: 1.9889 | Val  Acc: 0.3777
 Site-Indian                        | Val  Loss: 2.0701 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 2.0663 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 2.0460 | Val  Acc: 0.2826
 Site-Southeast_Asian               | Val  Loss: 2.0466 | Val  Acc: 0.2986
 Site-Middle_Eastern                | Val  Loss: 2.0226 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 2.0452 | Val  Acc: 0.2626
Average Valid Accuracy: 0.2940
============ Train epoch 6 ============
cnt=[2, 4, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.9648 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.9659 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9967 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 2.0195 | Train Acc: 0.2710
 Site-Black                    | Train Loss: 2.1161 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 2.0381 | Train Acc: 0.2470
 Site-East_Asian               | Train Loss: 1.9392 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.9595 | Train Acc: 0.3837
 Site-Indian                   | Train Loss: 2.0297 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 2.0494 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 2.0460 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 2.0354 | Train Acc: 0.3070
 Site-Middle_Eastern           | Train Loss: 1.9565 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 2.0250 | Train Acc: 0.2590
 Site-White                         | Val  Loss: 2.0257 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.9706 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 2.0212 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 2.0130 | Val  Acc: 0.2806
 Site-Black                         | Val  Loss: 2.0233 | Val  Acc: 0.2717
 Site-Black                         | Val  Loss: 2.0259 | Val  Acc: 0.2410
 Site-East_Asian                    | Val  Loss: 1.9392 | Val  Acc: 0.4130
 Site-East_Asian                    | Val  Loss: 1.9698 | Val  Acc: 0.3957
 Site-Indian                        | Val  Loss: 2.0574 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 2.0448 | Val  Acc: 0.2230
 Site-Southeast_Asian               | Val  Loss: 2.0263 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 2.0273 | Val  Acc: 0.2986
 Site-Middle_Eastern                | Val  Loss: 2.0032 | Val  Acc: 0.2500
 Site-Middle_Eastern                | Val  Loss: 2.0266 | Val  Acc: 0.2482
Average Valid Accuracy: 0.2916
============ Train epoch 7 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.9413 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.9440 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 2.0347 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 2.0026 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 2.0730 | Train Acc: 0.2014
 Site-Black                    | Train Loss: 2.0321 | Train Acc: 0.2518
 Site-East_Asian               | Train Loss: 1.9636 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.9279 | Train Acc: 0.3861
 Site-Indian                   | Train Loss: 1.9810 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 2.0387 | Train Acc: 0.2302
 Site-Southeast_Asian          | Train Loss: 2.0209 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 2.0180 | Train Acc: 0.2998
 Site-Middle_Eastern           | Train Loss: 2.0019 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 2.0131 | Train Acc: 0.2614
 Site-White                         | Val  Loss: 1.9908 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.9514 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 2.0002 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.9947 | Val  Acc: 0.2842
 Site-Black                         | Val  Loss: 2.0164 | Val  Acc: 0.3043
 Site-Black                         | Val  Loss: 2.0097 | Val  Acc: 0.2374
 Site-East_Asian                    | Val  Loss: 1.8937 | Val  Acc: 0.4130
 Site-East_Asian                    | Val  Loss: 1.9430 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 2.0483 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 2.0353 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 2.0054 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 2.0062 | Val  Acc: 0.2986
 Site-Middle_Eastern                | Val  Loss: 1.9749 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 2.0139 | Val  Acc: 0.2554
Average Valid Accuracy: 0.2963
============ Train epoch 8 ============
cnt=[2, 3, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.9812 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.9340 | Train Acc: 0.3501
 Site-Latino_Hispanic          | Train Loss: 1.9942 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.9890 | Train Acc: 0.2686
 Site-Black                    | Train Loss: 2.0164 | Train Acc: 0.2302
 Site-Black                    | Train Loss: 2.0148 | Train Acc: 0.2518
 Site-East_Asian               | Train Loss: 1.9107 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.9014 | Train Acc: 0.3837
 Site-Indian                   | Train Loss: 2.0665 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 2.0243 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 1.9975 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9976 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.9696 | Train Acc: 0.2590
 Site-Middle_Eastern           | Train Loss: 2.0031 | Train Acc: 0.2614
 Site-White                         | Val  Loss: 1.9961 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.9298 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.9911 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.9774 | Val  Acc: 0.2806
 Site-Black                         | Val  Loss: 2.0033 | Val  Acc: 0.2826
 Site-Black                         | Val  Loss: 2.0000 | Val  Acc: 0.2482
 Site-East_Asian                    | Val  Loss: 1.8624 | Val  Acc: 0.4239
 Site-East_Asian                    | Val  Loss: 1.9309 | Val  Acc: 0.3741
 Site-Indian                        | Val  Loss: 2.0287 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 2.0227 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.9975 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.9918 | Val  Acc: 0.3094
 Site-Middle_Eastern                | Val  Loss: 1.9615 | Val  Acc: 0.2609
 Site-Middle_Eastern                | Val  Loss: 1.9964 | Val  Acc: 0.2554
Average Valid Accuracy: 0.2955
============ Train epoch 9 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.9283 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.9044 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9299 | Train Acc: 0.2806
 Site-Latino_Hispanic          | Train Loss: 1.9750 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 2.0359 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 2.0051 | Train Acc: 0.2494
 Site-East_Asian               | Train Loss: 1.9336 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.8779 | Train Acc: 0.3837
 Site-Indian                   | Train Loss: 1.9738 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 2.0058 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 1.9795 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9967 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.9738 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.9873 | Train Acc: 0.2494
 Site-White                         | Val  Loss: 1.9736 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.9167 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 1.9744 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.9605 | Val  Acc: 0.2806
 Site-Black                         | Val  Loss: 1.9768 | Val  Acc: 0.2717
 Site-Black                         | Val  Loss: 1.9901 | Val  Acc: 0.2482
 Site-East_Asian                    | Val  Loss: 1.8494 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.9045 | Val  Acc: 0.3777
 Site-Indian                        | Val  Loss: 2.0242 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 2.0090 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.9807 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.9780 | Val  Acc: 0.3022
 Site-Middle_Eastern                | Val  Loss: 1.9406 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 1.9825 | Val  Acc: 0.2590
Average Valid Accuracy: 0.2976
============ Train epoch 10 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8620 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8978 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.9489 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.9526 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.9844 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 1.9922 | Train Acc: 0.2470
 Site-East_Asian               | Train Loss: 1.9309 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.8704 | Train Acc: 0.3861
 Site-Indian                   | Train Loss: 1.9997 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 2.0122 | Train Acc: 0.2302
 Site-Southeast_Asian          | Train Loss: 2.0497 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.9904 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.8909 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9732 | Train Acc: 0.2590
 Site-White                         | Val  Loss: 1.9741 | Val  Acc: 0.2935
 Site-White                         | Val  Loss: 1.9032 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.9616 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.9489 | Val  Acc: 0.2842
 Site-Black                         | Val  Loss: 1.9713 | Val  Acc: 0.2609
 Site-Black                         | Val  Loss: 1.9702 | Val  Acc: 0.2554
 Site-East_Asian                    | Val  Loss: 1.8271 | Val  Acc: 0.4348
 Site-East_Asian                    | Val  Loss: 1.8851 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 2.0153 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9981 | Val  Acc: 0.2230
 Site-Southeast_Asian               | Val  Loss: 1.9721 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.9738 | Val  Acc: 0.3022
 Site-Middle_Eastern                | Val  Loss: 1.9375 | Val  Acc: 0.2717
 Site-Middle_Eastern                | Val  Loss: 1.9660 | Val  Acc: 0.2518
Average Valid Accuracy: 0.2942
============ Train epoch 11 ============
cnt=[2, 3, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8948 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8768 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9922 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.9546 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.9704 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 1.9821 | Train Acc: 0.2494
 Site-East_Asian               | Train Loss: 1.7976 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.8498 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 1.9419 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 1.9967 | Train Acc: 0.2302
 Site-Southeast_Asian          | Train Loss: 1.9972 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.9715 | Train Acc: 0.2998
 Site-Middle_Eastern           | Train Loss: 1.9352 | Train Acc: 0.2590
 Site-Middle_Eastern           | Train Loss: 1.9532 | Train Acc: 0.2590
 Site-White                         | Val  Loss: 1.9357 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.8805 | Val  Acc: 0.3489
 Site-Latino_Hispanic               | Val  Loss: 1.9534 | Val  Acc: 0.2935
 Site-Latino_Hispanic               | Val  Loss: 1.9445 | Val  Acc: 0.2842
 Site-Black                         | Val  Loss: 1.9569 | Val  Acc: 0.2826
 Site-Black                         | Val  Loss: 1.9560 | Val  Acc: 0.2518
 Site-East_Asian                    | Val  Loss: 1.8223 | Val  Acc: 0.4348
 Site-East_Asian                    | Val  Loss: 1.8820 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 2.0110 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9840 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.9755 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.9586 | Val  Acc: 0.3094
 Site-Middle_Eastern                | Val  Loss: 1.9269 | Val  Acc: 0.2609
 Site-Middle_Eastern                | Val  Loss: 1.9665 | Val  Acc: 0.2554
Average Valid Accuracy: 0.2978
============ Train epoch 12 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8885 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8746 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9835 | Train Acc: 0.2806
 Site-Latino_Hispanic          | Train Loss: 1.9407 | Train Acc: 0.2686
 Site-Black                    | Train Loss: 1.9916 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.9746 | Train Acc: 0.2542
 Site-East_Asian               | Train Loss: 1.8583 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.8478 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 2.0362 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 1.9774 | Train Acc: 0.2302
 Site-Southeast_Asian          | Train Loss: 1.9723 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.9612 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.9674 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.9496 | Train Acc: 0.2566
 Site-White                         | Val  Loss: 1.9539 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.8698 | Val  Acc: 0.3489
 Site-Latino_Hispanic               | Val  Loss: 1.9459 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.9250 | Val  Acc: 0.2842
 Site-Black                         | Val  Loss: 1.9459 | Val  Acc: 0.2717
 Site-Black                         | Val  Loss: 1.9519 | Val  Acc: 0.2410
 Site-East_Asian                    | Val  Loss: 1.8076 | Val  Acc: 0.4130
 Site-East_Asian                    | Val  Loss: 1.8577 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 2.0088 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9801 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.9561 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.9506 | Val  Acc: 0.2986
 Site-Middle_Eastern                | Val  Loss: 1.9075 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 1.9501 | Val  Acc: 0.2590
Average Valid Accuracy: 0.2948
============ Train epoch 13 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8677 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8567 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.9172 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.9208 | Train Acc: 0.2686
 Site-Black                    | Train Loss: 2.0144 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 1.9549 | Train Acc: 0.2494
 Site-East_Asian               | Train Loss: 1.8770 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.8331 | Train Acc: 0.3813
 Site-Indian                   | Train Loss: 1.9740 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9706 | Train Acc: 0.2302
 Site-Southeast_Asian          | Train Loss: 2.0220 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.9618 | Train Acc: 0.3094
 Site-Middle_Eastern           | Train Loss: 1.9146 | Train Acc: 0.2590
 Site-Middle_Eastern           | Train Loss: 1.9538 | Train Acc: 0.2566
 Site-White                         | Val  Loss: 1.9284 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.8493 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 1.9248 | Val  Acc: 0.2935
 Site-Latino_Hispanic               | Val  Loss: 1.9252 | Val  Acc: 0.2806
 Site-Black                         | Val  Loss: 1.9380 | Val  Acc: 0.2717
 Site-Black                         | Val  Loss: 1.9425 | Val  Acc: 0.2446
 Site-East_Asian                    | Val  Loss: 1.7760 | Val  Acc: 0.4239
 Site-East_Asian                    | Val  Loss: 1.8446 | Val  Acc: 0.3777
 Site-Indian                        | Val  Loss: 1.9923 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.9726 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.9502 | Val  Acc: 0.3152
 Site-Southeast_Asian               | Val  Loss: 1.9445 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.8948 | Val  Acc: 0.2717
 Site-Middle_Eastern                | Val  Loss: 1.9424 | Val  Acc: 0.2590
Average Valid Accuracy: 0.2971
============ Train epoch 14 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8217 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8433 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.8949 | Train Acc: 0.2806
 Site-Latino_Hispanic          | Train Loss: 1.9167 | Train Acc: 0.2710
 Site-Black                    | Train Loss: 1.9732 | Train Acc: 0.2086
 Site-Black                    | Train Loss: 1.9615 | Train Acc: 0.2566
 Site-East_Asian               | Train Loss: 1.7989 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.8209 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 2.0463 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9833 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 1.8847 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9387 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.9359 | Train Acc: 0.2590
 Site-Middle_Eastern           | Train Loss: 1.9291 | Train Acc: 0.2638
 Site-White                         | Val  Loss: 1.9232 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.8520 | Val  Acc: 0.3597
 Site-Latino_Hispanic               | Val  Loss: 1.9282 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.9019 | Val  Acc: 0.2770
 Site-Black                         | Val  Loss: 1.9290 | Val  Acc: 0.2717
 Site-Black                         | Val  Loss: 1.9333 | Val  Acc: 0.2446
 Site-East_Asian                    | Val  Loss: 1.7868 | Val  Acc: 0.4239
 Site-East_Asian                    | Val  Loss: 1.8372 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 1.9861 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9658 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.9382 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.9365 | Val  Acc: 0.3022
 Site-Middle_Eastern                | Val  Loss: 1.8886 | Val  Acc: 0.2717
 Site-Middle_Eastern                | Val  Loss: 1.9248 | Val  Acc: 0.2554
Average Valid Accuracy: 0.2947
============ Train epoch 15 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8578 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8246 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9544 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.9003 | Train Acc: 0.2686
 Site-Black                    | Train Loss: 1.9863 | Train Acc: 0.2374
 Site-Black                    | Train Loss: 1.9620 | Train Acc: 0.2542
 Site-East_Asian               | Train Loss: 1.7837 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.8076 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 1.9648 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9756 | Train Acc: 0.2278
 Site-Southeast_Asian          | Train Loss: 1.9076 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.9408 | Train Acc: 0.3070
 Site-Middle_Eastern           | Train Loss: 1.9135 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9258 | Train Acc: 0.2590
 Site-White                         | Val  Loss: 1.9058 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.8418 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.9251 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.8953 | Val  Acc: 0.2842
 Site-Black                         | Val  Loss: 1.9188 | Val  Acc: 0.2935
 Site-Black                         | Val  Loss: 1.9300 | Val  Acc: 0.2446
 Site-East_Asian                    | Val  Loss: 1.7545 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.8255 | Val  Acc: 0.3849
 Site-Indian                        | Val  Loss: 1.9855 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9571 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.9250 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.9274 | Val  Acc: 0.3022
 Site-Middle_Eastern                | Val  Loss: 1.8854 | Val  Acc: 0.2717
 Site-Middle_Eastern                | Val  Loss: 1.9232 | Val  Acc: 0.2518
Average Valid Accuracy: 0.2994
 Best site-White                         | Epoch:15 | Val Acc: 0.3152
 Best site-White                         | Epoch:15 | Val Acc: 0.3561
 Best site-Latino_Hispanic               | Epoch:15 | Val Acc: 0.2826
 Best site-Latino_Hispanic               | Epoch:15 | Val Acc: 0.2842
 Best site-Black                         | Epoch:15 | Val Acc: 0.2935
 Best site-Black                         | Epoch:15 | Val Acc: 0.2446
 Best site-East_Asian                    | Epoch:15 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:15 | Val Acc: 0.3849
 Best site-Indian                        | Epoch:15 | Val Acc: 0.2283
 Best site-Indian                        | Epoch:15 | Val Acc: 0.2266
 Best site-Southeast_Asian               | Epoch:15 | Val Acc: 0.3043
 Best site-Southeast_Asian               | Epoch:15 | Val Acc: 0.3022
 Best site-Middle_Eastern                | Epoch:15 | Val Acc: 0.2717
 Best site-Middle_Eastern                | Epoch:15 | Val Acc: 0.2518
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 16 ============
cnt=[2, 4, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8698 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8177 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.8961 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.9180 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.9388 | Train Acc: 0.2086
 Site-Black                    | Train Loss: 1.9544 | Train Acc: 0.2542
 Site-East_Asian               | Train Loss: 1.7444 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7966 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.9084 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9632 | Train Acc: 0.2350
 Site-Southeast_Asian          | Train Loss: 1.8838 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9390 | Train Acc: 0.3118
 Site-Middle_Eastern           | Train Loss: 1.9235 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.9140 | Train Acc: 0.2542
 Site-White                         | Val  Loss: 1.9084 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.8201 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 1.9141 | Val  Acc: 0.2935
 Site-Latino_Hispanic               | Val  Loss: 1.8878 | Val  Acc: 0.2770
 Site-Black                         | Val  Loss: 1.9195 | Val  Acc: 0.2826
 Site-Black                         | Val  Loss: 1.9143 | Val  Acc: 0.2518
 Site-East_Asian                    | Val  Loss: 1.7488 | Val  Acc: 0.4130
 Site-East_Asian                    | Val  Loss: 1.8238 | Val  Acc: 0.3777
 Site-Indian                        | Val  Loss: 1.9796 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9567 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.9298 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.9153 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.8736 | Val  Acc: 0.2717
 Site-Middle_Eastern                | Val  Loss: 1.9183 | Val  Acc: 0.2518
Average Valid Accuracy: 0.2958
============ Train epoch 17 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8143 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8151 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.8914 | Train Acc: 0.2734
 Site-Latino_Hispanic          | Train Loss: 1.9061 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 2.0032 | Train Acc: 0.2302
 Site-Black                    | Train Loss: 1.9317 | Train Acc: 0.2566
 Site-East_Asian               | Train Loss: 1.7686 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7968 | Train Acc: 0.3861
 Site-Indian                   | Train Loss: 2.0319 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9536 | Train Acc: 0.2350
 Site-Southeast_Asian          | Train Loss: 1.8649 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9247 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.7977 | Train Acc: 0.2518
 Site-Middle_Eastern           | Train Loss: 1.9057 | Train Acc: 0.2614
 Site-White                         | Val  Loss: 1.9041 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.8216 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 1.9094 | Val  Acc: 0.2935
 Site-Latino_Hispanic               | Val  Loss: 1.8867 | Val  Acc: 0.2806
 Site-Black                         | Val  Loss: 1.9125 | Val  Acc: 0.2826
 Site-Black                         | Val  Loss: 1.9109 | Val  Acc: 0.2518
 Site-East_Asian                    | Val  Loss: 1.7250 | Val  Acc: 0.4348
 Site-East_Asian                    | Val  Loss: 1.8127 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 1.9706 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9428 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.9217 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.9157 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.8576 | Val  Acc: 0.2717
 Site-Middle_Eastern                | Val  Loss: 1.9111 | Val  Acc: 0.2626
Average Valid Accuracy: 0.2978
============ Train epoch 18 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7512 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8059 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.8909 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8973 | Train Acc: 0.2710
 Site-Black                    | Train Loss: 1.9180 | Train Acc: 0.2014
 Site-Black                    | Train Loss: 1.9318 | Train Acc: 0.2590
 Site-East_Asian               | Train Loss: 1.8175 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7769 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 1.9183 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 1.9517 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 1.9013 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.9149 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.8975 | Train Acc: 0.2878
 Site-Middle_Eastern           | Train Loss: 1.9146 | Train Acc: 0.2542
 Site-White                         | Val  Loss: 1.8934 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.8131 | Val  Acc: 0.3453
 Site-Latino_Hispanic               | Val  Loss: 1.8908 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.8771 | Val  Acc: 0.2878
 Site-Black                         | Val  Loss: 1.9021 | Val  Acc: 0.3043
 Site-Black                         | Val  Loss: 1.9036 | Val  Acc: 0.2554
 Site-East_Asian                    | Val  Loss: 1.7425 | Val  Acc: 0.4239
 Site-East_Asian                    | Val  Loss: 1.7931 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 1.9645 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.9407 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.9104 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.9085 | Val  Acc: 0.3094
 Site-Middle_Eastern                | Val  Loss: 1.8567 | Val  Acc: 0.2609
 Site-Middle_Eastern                | Val  Loss: 1.9108 | Val  Acc: 0.2518
Average Valid Accuracy: 0.2971
============ Train epoch 19 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7287 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7859 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.8091 | Train Acc: 0.2806
 Site-Latino_Hispanic          | Train Loss: 1.8892 | Train Acc: 0.2686
 Site-Black                    | Train Loss: 1.9657 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.9149 | Train Acc: 0.2542
 Site-East_Asian               | Train Loss: 1.7930 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7868 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 1.9340 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 1.9391 | Train Acc: 0.2350
 Site-Southeast_Asian          | Train Loss: 1.9232 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.9156 | Train Acc: 0.2998
 Site-Middle_Eastern           | Train Loss: 1.9270 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8966 | Train Acc: 0.2590
 Site-White                         | Val  Loss: 1.8844 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7938 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 1.8853 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.8632 | Val  Acc: 0.2878
 Site-Black                         | Val  Loss: 1.9025 | Val  Acc: 0.3152
 Site-Black                         | Val  Loss: 1.8989 | Val  Acc: 0.2482
 Site-East_Asian                    | Val  Loss: 1.7211 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7956 | Val  Acc: 0.3813
 Site-Indian                        | Val  Loss: 1.9565 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9380 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.9090 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.9204 | Val  Acc: 0.2986
 Site-Middle_Eastern                | Val  Loss: 1.8497 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 1.8937 | Val  Acc: 0.2590
Average Valid Accuracy: 0.3022
 Best site-White                         | Epoch:19 | Val Acc: 0.3152
 Best site-White                         | Epoch:19 | Val Acc: 0.3525
 Best site-Latino_Hispanic               | Epoch:19 | Val Acc: 0.2826
 Best site-Latino_Hispanic               | Epoch:19 | Val Acc: 0.2878
 Best site-Black                         | Epoch:19 | Val Acc: 0.3152
 Best site-Black                         | Epoch:19 | Val Acc: 0.2482
 Best site-East_Asian                    | Epoch:19 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:19 | Val Acc: 0.3813
 Best site-Indian                        | Epoch:19 | Val Acc: 0.2283
 Best site-Indian                        | Epoch:19 | Val Acc: 0.2302
 Best site-Southeast_Asian               | Epoch:19 | Val Acc: 0.3043
 Best site-Southeast_Asian               | Epoch:19 | Val Acc: 0.2986
 Best site-Middle_Eastern                | Epoch:19 | Val Acc: 0.2826
 Best site-Middle_Eastern                | Epoch:19 | Val Acc: 0.2590
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
 Test site-White                     (3)| Epoch:19 | Test Acc: 0.2968
 Test site-Latino_Hispanic           (1)| Epoch:19 | Test Acc: 0.2627
 Test site-Black                     (2)| Epoch:19 | Test Acc: 0.2625
 Test site-East_Asian                (0)| Epoch:19 | Test Acc: 0.4091
 Test site-Indian                    (4)| Epoch:19 | Test Acc: 0.2440
 Test site-Southeast_Asian           (6)| Epoch:19 | Test Acc: 0.3407
 Test site-Middle_Eastern            (5)| Epoch:19 | Test Acc: 0.2938
White: 0.2968, Latino_Hispanic: 0.2627, Black: 0.2625, East_Asian: 0.4091, Indian: 0.2440, Southeast_Asian: 0.3407, Middle_Eastern: 0.2938, 
Average Test Accuracy(group): 0.3014, Average Test Accuracy(individual): 0.3014,
domain std=0.0528, cluster std=0.0528, individual std=0.0528, 
============ Train epoch 20 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6572 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7947 | Train Acc: 0.3501
 Site-Latino_Hispanic          | Train Loss: 1.8234 | Train Acc: 0.3022
 Site-Latino_Hispanic          | Train Loss: 1.8740 | Train Acc: 0.2758
 Site-Black                    | Train Loss: 1.9231 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 1.9241 | Train Acc: 0.2566
 Site-East_Asian               | Train Loss: 1.7123 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7681 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 1.8944 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9427 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 1.9165 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9042 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.8683 | Train Acc: 0.2590
 Site-Middle_Eastern           | Train Loss: 1.8822 | Train Acc: 0.2614
 Site-White                         | Val  Loss: 1.8675 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7850 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.8866 | Val  Acc: 0.2935
 Site-Latino_Hispanic               | Val  Loss: 1.8622 | Val  Acc: 0.2806
 Site-Black                         | Val  Loss: 1.9002 | Val  Acc: 0.3043
 Site-Black                         | Val  Loss: 1.8903 | Val  Acc: 0.2446
 Site-East_Asian                    | Val  Loss: 1.7175 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7895 | Val  Acc: 0.3885
 Site-Indian                        | Val  Loss: 1.9531 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.9298 | Val  Acc: 0.2374
 Site-Southeast_Asian               | Val  Loss: 1.9017 | Val  Acc: 0.3152
 Site-Southeast_Asian               | Val  Loss: 1.8971 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.8419 | Val  Acc: 0.2717
 Site-Middle_Eastern                | Val  Loss: 1.8847 | Val  Acc: 0.2590
Average Valid Accuracy: 0.3033
 Best site-White                         | Epoch:20 | Val Acc: 0.3152
 Best site-White                         | Epoch:20 | Val Acc: 0.3561
 Best site-Latino_Hispanic               | Epoch:20 | Val Acc: 0.2935
 Best site-Latino_Hispanic               | Epoch:20 | Val Acc: 0.2806
 Best site-Black                         | Epoch:20 | Val Acc: 0.3043
 Best site-Black                         | Epoch:20 | Val Acc: 0.2446
 Best site-East_Asian                    | Epoch:20 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:20 | Val Acc: 0.3885
 Best site-Indian                        | Epoch:20 | Val Acc: 0.2283
 Best site-Indian                        | Epoch:20 | Val Acc: 0.2374
 Best site-Southeast_Asian               | Epoch:20 | Val Acc: 0.3152
 Best site-Southeast_Asian               | Epoch:20 | Val Acc: 0.3058
 Best site-Middle_Eastern                | Epoch:20 | Val Acc: 0.2717
 Best site-Middle_Eastern                | Epoch:20 | Val Acc: 0.2590
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 21 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7531 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7739 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.8735 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.8829 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.9553 | Train Acc: 0.2374
 Site-Black                    | Train Loss: 1.9104 | Train Acc: 0.2710
 Site-East_Asian               | Train Loss: 1.7685 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7649 | Train Acc: 0.3861
 Site-Indian                   | Train Loss: 1.9305 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 1.9466 | Train Acc: 0.2398
 Site-Southeast_Asian          | Train Loss: 1.8868 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9072 | Train Acc: 0.3070
 Site-Middle_Eastern           | Train Loss: 1.8506 | Train Acc: 0.2590
 Site-Middle_Eastern           | Train Loss: 1.8693 | Train Acc: 0.2686
 Site-White                         | Val  Loss: 1.8815 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.7813 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.8740 | Val  Acc: 0.2935
 Site-Latino_Hispanic               | Val  Loss: 1.8570 | Val  Acc: 0.2806
 Site-Black                         | Val  Loss: 1.8847 | Val  Acc: 0.3261
 Site-Black                         | Val  Loss: 1.8864 | Val  Acc: 0.2698
 Site-East_Asian                    | Val  Loss: 1.7032 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7792 | Val  Acc: 0.3885
 Site-Indian                        | Val  Loss: 1.9471 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.9256 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.8920 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.9021 | Val  Acc: 0.3165
 Site-Middle_Eastern                | Val  Loss: 1.8370 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 1.8876 | Val  Acc: 0.2626
Average Valid Accuracy: 0.3053
 Best site-White                         | Epoch:21 | Val Acc: 0.3043
 Best site-White                         | Epoch:21 | Val Acc: 0.3561
 Best site-Latino_Hispanic               | Epoch:21 | Val Acc: 0.2935
 Best site-Latino_Hispanic               | Epoch:21 | Val Acc: 0.2806
 Best site-Black                         | Epoch:21 | Val Acc: 0.3261
 Best site-Black                         | Epoch:21 | Val Acc: 0.2698
 Best site-East_Asian                    | Epoch:21 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:21 | Val Acc: 0.3885
 Best site-Indian                        | Epoch:21 | Val Acc: 0.2174
 Best site-Indian                        | Epoch:21 | Val Acc: 0.2266
 Best site-Southeast_Asian               | Epoch:21 | Val Acc: 0.3043
 Best site-Southeast_Asian               | Epoch:21 | Val Acc: 0.3165
 Best site-Middle_Eastern                | Epoch:21 | Val Acc: 0.2826
 Best site-Middle_Eastern                | Epoch:21 | Val Acc: 0.2626
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 22 ============
cnt=[2, 4, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7740 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7775 | Train Acc: 0.3573
 Site-Latino_Hispanic          | Train Loss: 1.8822 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.8701 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.9247 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 1.9029 | Train Acc: 0.2614
 Site-East_Asian               | Train Loss: 1.7441 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.7413 | Train Acc: 0.3933
 Site-Indian                   | Train Loss: 1.9171 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9370 | Train Acc: 0.2302
 Site-Southeast_Asian          | Train Loss: 1.8285 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8846 | Train Acc: 0.2974
 Site-Middle_Eastern           | Train Loss: 1.8364 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.8728 | Train Acc: 0.2542
 Site-White                         | Val  Loss: 1.8796 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7795 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.8801 | Val  Acc: 0.3043
 Site-Latino_Hispanic               | Val  Loss: 1.8465 | Val  Acc: 0.2878
 Site-Black                         | Val  Loss: 1.8782 | Val  Acc: 0.3043
 Site-Black                         | Val  Loss: 1.8768 | Val  Acc: 0.2554
 Site-East_Asian                    | Val  Loss: 1.6696 | Val  Acc: 0.4565
 Site-East_Asian                    | Val  Loss: 1.7732 | Val  Acc: 0.3849
 Site-Indian                        | Val  Loss: 1.9601 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.9190 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.8881 | Val  Acc: 0.3152
 Site-Southeast_Asian               | Val  Loss: 1.8953 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.8424 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 1.8811 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3059
 Best site-White                         | Epoch:22 | Val Acc: 0.3152
 Best site-White                         | Epoch:22 | Val Acc: 0.3561
 Best site-Latino_Hispanic               | Epoch:22 | Val Acc: 0.3043
 Best site-Latino_Hispanic               | Epoch:22 | Val Acc: 0.2878
 Best site-Black                         | Epoch:22 | Val Acc: 0.3043
 Best site-Black                         | Epoch:22 | Val Acc: 0.2554
 Best site-East_Asian                    | Epoch:22 | Val Acc: 0.4565
 Best site-East_Asian                    | Epoch:22 | Val Acc: 0.3849
 Best site-Indian                        | Epoch:22 | Val Acc: 0.2174
 Best site-Indian                        | Epoch:22 | Val Acc: 0.2266
 Best site-Southeast_Asian               | Epoch:22 | Val Acc: 0.3152
 Best site-Southeast_Asian               | Epoch:22 | Val Acc: 0.3058
 Best site-Middle_Eastern                | Epoch:22 | Val Acc: 0.2826
 Best site-Middle_Eastern                | Epoch:22 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 23 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7766 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7726 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.7688 | Train Acc: 0.2806
 Site-Latino_Hispanic          | Train Loss: 1.8524 | Train Acc: 0.2782
 Site-Black                    | Train Loss: 2.0304 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 1.9041 | Train Acc: 0.2638
 Site-East_Asian               | Train Loss: 1.6620 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.7445 | Train Acc: 0.3933
 Site-Indian                   | Train Loss: 1.8960 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9224 | Train Acc: 0.2422
 Site-Southeast_Asian          | Train Loss: 1.8079 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.8950 | Train Acc: 0.2998
 Site-Middle_Eastern           | Train Loss: 1.8998 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8736 | Train Acc: 0.2614
 Site-White                         | Val  Loss: 1.8581 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7640 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.8465 | Val  Acc: 0.2826
 Site-Latino_Hispanic               | Val  Loss: 1.8560 | Val  Acc: 0.2950
 Site-Black                         | Val  Loss: 1.8904 | Val  Acc: 0.2826
 Site-Black                         | Val  Loss: 1.8711 | Val  Acc: 0.2482
 Site-East_Asian                    | Val  Loss: 1.6745 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7609 | Val  Acc: 0.3849
 Site-Indian                        | Val  Loss: 1.9419 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.9122 | Val  Acc: 0.2230
 Site-Southeast_Asian               | Val  Loss: 1.8832 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.8819 | Val  Acc: 0.2986
 Site-Middle_Eastern                | Val  Loss: 1.8253 | Val  Acc: 0.2609
 Site-Middle_Eastern                | Val  Loss: 1.8704 | Val  Acc: 0.2662
Average Valid Accuracy: 0.2978
============ Train epoch 24 ============
cnt=[2, 4, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7932 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7673 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.8209 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8558 | Train Acc: 0.2710
 Site-Black                    | Train Loss: 1.8804 | Train Acc: 0.2374
 Site-Black                    | Train Loss: 1.8999 | Train Acc: 0.2662
 Site-East_Asian               | Train Loss: 1.8227 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7431 | Train Acc: 0.3981
 Site-Indian                   | Train Loss: 1.8441 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 1.9015 | Train Acc: 0.2422
 Site-Southeast_Asian          | Train Loss: 1.9385 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8856 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.8310 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8704 | Train Acc: 0.2614
 Site-White                         | Val  Loss: 1.8462 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.7705 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 1.8561 | Val  Acc: 0.2935
 Site-Latino_Hispanic               | Val  Loss: 1.8391 | Val  Acc: 0.2842
 Site-Black                         | Val  Loss: 1.8678 | Val  Acc: 0.3370
 Site-Black                         | Val  Loss: 1.8723 | Val  Acc: 0.2626
 Site-East_Asian                    | Val  Loss: 1.6656 | Val  Acc: 0.4565
 Site-East_Asian                    | Val  Loss: 1.7567 | Val  Acc: 0.3885
 Site-Indian                        | Val  Loss: 1.9209 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 1.9042 | Val  Acc: 0.2266
 Site-Southeast_Asian               | Val  Loss: 1.8814 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.8831 | Val  Acc: 0.3094
 Site-Middle_Eastern                | Val  Loss: 1.8249 | Val  Acc: 0.2717
 Site-Middle_Eastern                | Val  Loss: 1.8645 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3071
 Best site-White                         | Epoch:24 | Val Acc: 0.3043
 Best site-White                         | Epoch:24 | Val Acc: 0.3525
 Best site-Latino_Hispanic               | Epoch:24 | Val Acc: 0.2935
 Best site-Latino_Hispanic               | Epoch:24 | Val Acc: 0.2842
 Best site-Black                         | Epoch:24 | Val Acc: 0.3370
 Best site-Black                         | Epoch:24 | Val Acc: 0.2626
 Best site-East_Asian                    | Epoch:24 | Val Acc: 0.4565
 Best site-East_Asian                    | Epoch:24 | Val Acc: 0.3885
 Best site-Indian                        | Epoch:24 | Val Acc: 0.2391
 Best site-Indian                        | Epoch:24 | Val Acc: 0.2266
 Best site-Southeast_Asian               | Epoch:24 | Val Acc: 0.3043
 Best site-Southeast_Asian               | Epoch:24 | Val Acc: 0.3094
 Best site-Middle_Eastern                | Epoch:24 | Val Acc: 0.2717
 Best site-Middle_Eastern                | Epoch:24 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 25 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8225 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7617 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.7931 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8426 | Train Acc: 0.2686
 Site-Black                    | Train Loss: 1.8893 | Train Acc: 0.2302
 Site-Black                    | Train Loss: 1.8865 | Train Acc: 0.2662
 Site-East_Asian               | Train Loss: 1.7355 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.7326 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.8973 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 1.9215 | Train Acc: 0.2422
 Site-Southeast_Asian          | Train Loss: 1.8630 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.8867 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.8362 | Train Acc: 0.2806
 Site-Middle_Eastern           | Train Loss: 1.8760 | Train Acc: 0.2758
 Site-White                         | Val  Loss: 1.8321 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7560 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 1.8633 | Val  Acc: 0.3043
 Site-Latino_Hispanic               | Val  Loss: 1.8281 | Val  Acc: 0.2842
 Site-Black                         | Val  Loss: 1.8551 | Val  Acc: 0.3152
 Site-Black                         | Val  Loss: 1.8734 | Val  Acc: 0.2770
 Site-East_Asian                    | Val  Loss: 1.6663 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7456 | Val  Acc: 0.3957
 Site-Indian                        | Val  Loss: 1.9478 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 1.9056 | Val  Acc: 0.2338
 Site-Southeast_Asian               | Val  Loss: 1.8726 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.8775 | Val  Acc: 0.3022
 Site-Middle_Eastern                | Val  Loss: 1.8099 | Val  Acc: 0.2826
 Site-Middle_Eastern                | Val  Loss: 1.8602 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3089
 Best site-White                         | Epoch:25 | Val Acc: 0.3152
 Best site-White                         | Epoch:25 | Val Acc: 0.3525
 Best site-Latino_Hispanic               | Epoch:25 | Val Acc: 0.3043
 Best site-Latino_Hispanic               | Epoch:25 | Val Acc: 0.2842
 Best site-Black                         | Epoch:25 | Val Acc: 0.3152
 Best site-Black                         | Epoch:25 | Val Acc: 0.2770
 Best site-East_Asian                    | Epoch:25 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:25 | Val Acc: 0.3957
 Best site-Indian                        | Epoch:25 | Val Acc: 0.2391
 Best site-Indian                        | Epoch:25 | Val Acc: 0.2338
 Best site-Southeast_Asian               | Epoch:25 | Val Acc: 0.3043
 Best site-Southeast_Asian               | Epoch:25 | Val Acc: 0.3022
 Best site-Middle_Eastern                | Epoch:25 | Val Acc: 0.2826
 Best site-Middle_Eastern                | Epoch:25 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 26 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7810 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7462 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9088 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8527 | Train Acc: 0.2782
 Site-Black                    | Train Loss: 1.8782 | Train Acc: 0.2374
 Site-Black                    | Train Loss: 1.8938 | Train Acc: 0.2638
 Site-East_Asian               | Train Loss: 1.7895 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.7140 | Train Acc: 0.3981
 Site-Indian                   | Train Loss: 1.8451 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 1.9120 | Train Acc: 0.2398
 Site-Southeast_Asian          | Train Loss: 1.8806 | Train Acc: 0.3094
 Site-Southeast_Asian          | Train Loss: 1.8755 | Train Acc: 0.3094
 Site-Middle_Eastern           | Train Loss: 1.7240 | Train Acc: 0.2806
 Site-Middle_Eastern           | Train Loss: 1.8615 | Train Acc: 0.2782
 Site-White                         | Val  Loss: 1.8454 | Val  Acc: 0.3261
 Site-White                         | Val  Loss: 1.7613 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.8403 | Val  Acc: 0.3043
 Site-Latino_Hispanic               | Val  Loss: 1.8374 | Val  Acc: 0.2950
 Site-Black                         | Val  Loss: 1.8520 | Val  Acc: 0.3043
 Site-Black                         | Val  Loss: 1.8618 | Val  Acc: 0.2842
 Site-East_Asian                    | Val  Loss: 1.6655 | Val  Acc: 0.4348
 Site-East_Asian                    | Val  Loss: 1.7510 | Val  Acc: 0.3885
 Site-Indian                        | Val  Loss: 1.9389 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.9035 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.8590 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.8652 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.8181 | Val  Acc: 0.3043
 Site-Middle_Eastern                | Val  Loss: 1.8557 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3095
 Best site-White                         | Epoch:26 | Val Acc: 0.3261
 Best site-White                         | Epoch:26 | Val Acc: 0.3561
 Best site-Latino_Hispanic               | Epoch:26 | Val Acc: 0.3043
 Best site-Latino_Hispanic               | Epoch:26 | Val Acc: 0.2950
 Best site-Black                         | Epoch:26 | Val Acc: 0.3043
 Best site-Black                         | Epoch:26 | Val Acc: 0.2842
 Best site-East_Asian                    | Epoch:26 | Val Acc: 0.4348
 Best site-East_Asian                    | Epoch:26 | Val Acc: 0.3885
 Best site-Indian                        | Epoch:26 | Val Acc: 0.2174
 Best site-Indian                        | Epoch:26 | Val Acc: 0.2302
 Best site-Southeast_Asian               | Epoch:26 | Val Acc: 0.3043
 Best site-Southeast_Asian               | Epoch:26 | Val Acc: 0.3058
 Best site-Middle_Eastern                | Epoch:26 | Val Acc: 0.3043
 Best site-Middle_Eastern                | Epoch:26 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 27 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7708 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7421 | Train Acc: 0.3573
 Site-Latino_Hispanic          | Train Loss: 1.8251 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.8400 | Train Acc: 0.2830
 Site-Black                    | Train Loss: 1.9282 | Train Acc: 0.2446
 Site-Black                    | Train Loss: 1.8961 | Train Acc: 0.2686
 Site-East_Asian               | Train Loss: 1.7096 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.7261 | Train Acc: 0.4029
 Site-Indian                   | Train Loss: 1.9430 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 1.8986 | Train Acc: 0.2446
 Site-Southeast_Asian          | Train Loss: 1.8206 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.8724 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.8130 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8481 | Train Acc: 0.2758
 Site-White                         | Val  Loss: 1.8473 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7538 | Val  Acc: 0.3597
 Site-Latino_Hispanic               | Val  Loss: 1.8386 | Val  Acc: 0.3152
 Site-Latino_Hispanic               | Val  Loss: 1.8285 | Val  Acc: 0.2878
 Site-Black                         | Val  Loss: 1.8668 | Val  Acc: 0.3478
 Site-Black                         | Val  Loss: 1.8677 | Val  Acc: 0.2734
 Site-East_Asian                    | Val  Loss: 1.6505 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7368 | Val  Acc: 0.3885
 Site-Indian                        | Val  Loss: 1.9257 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.8937 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.8682 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.8673 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.8023 | Val  Acc: 0.2935
 Site-Middle_Eastern                | Val  Loss: 1.8522 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3110
 Best site-White                         | Epoch:27 | Val Acc: 0.3152
 Best site-White                         | Epoch:27 | Val Acc: 0.3597
 Best site-Latino_Hispanic               | Epoch:27 | Val Acc: 0.3152
 Best site-Latino_Hispanic               | Epoch:27 | Val Acc: 0.2878
 Best site-Black                         | Epoch:27 | Val Acc: 0.3478
 Best site-Black                         | Epoch:27 | Val Acc: 0.2734
 Best site-East_Asian                    | Epoch:27 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:27 | Val Acc: 0.3885
 Best site-Indian                        | Epoch:27 | Val Acc: 0.2174
 Best site-Indian                        | Epoch:27 | Val Acc: 0.2302
 Best site-Southeast_Asian               | Epoch:27 | Val Acc: 0.2935
 Best site-Southeast_Asian               | Epoch:27 | Val Acc: 0.3058
 Best site-Middle_Eastern                | Epoch:27 | Val Acc: 0.2935
 Best site-Middle_Eastern                | Epoch:27 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 28 ============
cnt=[1, 4, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7107 | Train Acc: 0.3381
 Site-White                    | Train Loss: 1.7396 | Train Acc: 0.3621
 Site-Latino_Hispanic          | Train Loss: 1.8692 | Train Acc: 0.3022
 Site-Latino_Hispanic          | Train Loss: 1.8162 | Train Acc: 0.2782
 Site-Black                    | Train Loss: 1.8588 | Train Acc: 0.2590
 Site-Black                    | Train Loss: 1.8846 | Train Acc: 0.2830
 Site-East_Asian               | Train Loss: 1.7537 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7059 | Train Acc: 0.3933
 Site-Indian                   | Train Loss: 1.9134 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.9028 | Train Acc: 0.2350
 Site-Southeast_Asian          | Train Loss: 1.8589 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.8791 | Train Acc: 0.3070
 Site-Middle_Eastern           | Train Loss: 1.8710 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.8282 | Train Acc: 0.2734
 Site-White                         | Val  Loss: 1.8405 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7525 | Val  Acc: 0.3525
 Site-Latino_Hispanic               | Val  Loss: 1.8261 | Val  Acc: 0.2935
 Site-Latino_Hispanic               | Val  Loss: 1.8178 | Val  Acc: 0.2950
 Site-Black                         | Val  Loss: 1.8575 | Val  Acc: 0.3152
 Site-Black                         | Val  Loss: 1.8617 | Val  Acc: 0.2806
 Site-East_Asian                    | Val  Loss: 1.6461 | Val  Acc: 0.4239
 Site-East_Asian                    | Val  Loss: 1.7339 | Val  Acc: 0.3885
 Site-Indian                        | Val  Loss: 1.9193 | Val  Acc: 0.1957
 Site-Indian                        | Val  Loss: 1.8906 | Val  Acc: 0.2338
 Site-Southeast_Asian               | Val  Loss: 1.8630 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.8550 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.7989 | Val  Acc: 0.3261
 Site-Middle_Eastern                | Val  Loss: 1.8368 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3074
============ Train epoch 29 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8416 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7405 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.8770 | Train Acc: 0.3094
 Site-Latino_Hispanic          | Train Loss: 1.8222 | Train Acc: 0.2710
 Site-Black                    | Train Loss: 1.9082 | Train Acc: 0.2374
 Site-Black                    | Train Loss: 1.8818 | Train Acc: 0.2782
 Site-East_Asian               | Train Loss: 1.7282 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.6972 | Train Acc: 0.4053
 Site-Indian                   | Train Loss: 1.9115 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.9033 | Train Acc: 0.2494
 Site-Southeast_Asian          | Train Loss: 1.8009 | Train Acc: 0.3094
 Site-Southeast_Asian          | Train Loss: 1.8545 | Train Acc: 0.3118
 Site-Middle_Eastern           | Train Loss: 1.8953 | Train Acc: 0.2878
 Site-Middle_Eastern           | Train Loss: 1.8419 | Train Acc: 0.2830
 Site-White                         | Val  Loss: 1.8472 | Val  Acc: 0.2935
 Site-White                         | Val  Loss: 1.7427 | Val  Acc: 0.3417
 Site-Latino_Hispanic               | Val  Loss: 1.8403 | Val  Acc: 0.3152
 Site-Latino_Hispanic               | Val  Loss: 1.8195 | Val  Acc: 0.2986
 Site-Black                         | Val  Loss: 1.8556 | Val  Acc: 0.3261
 Site-Black                         | Val  Loss: 1.8594 | Val  Acc: 0.2806
 Site-East_Asian                    | Val  Loss: 1.6389 | Val  Acc: 0.4674
 Site-East_Asian                    | Val  Loss: 1.7269 | Val  Acc: 0.3957
 Site-Indian                        | Val  Loss: 1.9181 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.8839 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.8566 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.8574 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.7826 | Val  Acc: 0.3043
 Site-Middle_Eastern                | Val  Loss: 1.8435 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3108
============ Train epoch 30 ============
cnt=[2, 2, 1, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7402 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7155 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.8571 | Train Acc: 0.3022
 Site-Latino_Hispanic          | Train Loss: 1.8235 | Train Acc: 0.2758
 Site-Black                    | Train Loss: 1.8562 | Train Acc: 0.2590
 Site-Black                    | Train Loss: 1.8787 | Train Acc: 0.2734
 Site-East_Asian               | Train Loss: 1.7183 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.6846 | Train Acc: 0.4053
 Site-Indian                   | Train Loss: 1.8592 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 1.8758 | Train Acc: 0.2470
 Site-Southeast_Asian          | Train Loss: 1.8627 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.8485 | Train Acc: 0.3094
 Site-Middle_Eastern           | Train Loss: 1.8431 | Train Acc: 0.2806
 Site-Middle_Eastern           | Train Loss: 1.8371 | Train Acc: 0.2710
 Site-White                         | Val  Loss: 1.8386 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.7447 | Val  Acc: 0.3633
 Site-Latino_Hispanic               | Val  Loss: 1.8290 | Val  Acc: 0.3152
 Site-Latino_Hispanic               | Val  Loss: 1.8034 | Val  Acc: 0.2986
 Site-Black                         | Val  Loss: 1.8434 | Val  Acc: 0.3043
 Site-Black                         | Val  Loss: 1.8514 | Val  Acc: 0.2770
 Site-East_Asian                    | Val  Loss: 1.6206 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7235 | Val  Acc: 0.3921
 Site-Indian                        | Val  Loss: 1.9037 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.8811 | Val  Acc: 0.2302
 Site-Southeast_Asian               | Val  Loss: 1.8474 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.8439 | Val  Acc: 0.3094
 Site-Middle_Eastern                | Val  Loss: 1.7969 | Val  Acc: 0.2935
 Site-Middle_Eastern                | Val  Loss: 1.8336 | Val  Acc: 0.2986
Average Valid Accuracy: 0.3118
 Best site-White                         | Epoch:30 | Val Acc: 0.3043
 Best site-White                         | Epoch:30 | Val Acc: 0.3633
 Best site-Latino_Hispanic               | Epoch:30 | Val Acc: 0.3152
 Best site-Latino_Hispanic               | Epoch:30 | Val Acc: 0.2986
 Best site-Black                         | Epoch:30 | Val Acc: 0.3043
 Best site-Black                         | Epoch:30 | Val Acc: 0.2770
 Best site-East_Asian                    | Epoch:30 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:30 | Val Acc: 0.3921
 Best site-Indian                        | Epoch:30 | Val Acc: 0.2283
 Best site-Indian                        | Epoch:30 | Val Acc: 0.2302
 Best site-Southeast_Asian               | Epoch:30 | Val Acc: 0.3043
 Best site-Southeast_Asian               | Epoch:30 | Val Acc: 0.3094
 Best site-Middle_Eastern                | Epoch:30 | Val Acc: 0.2935
 Best site-Middle_Eastern                | Epoch:30 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 31 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6898 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7278 | Train Acc: 0.3621
 Site-Latino_Hispanic          | Train Loss: 1.7566 | Train Acc: 0.3165
 Site-Latino_Hispanic          | Train Loss: 1.8316 | Train Acc: 0.2830
 Site-Black                    | Train Loss: 1.8293 | Train Acc: 0.2374
 Site-Black                    | Train Loss: 1.8856 | Train Acc: 0.2710
 Site-East_Asian               | Train Loss: 1.7290 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.7016 | Train Acc: 0.4005
 Site-Indian                   | Train Loss: 1.8710 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.9019 | Train Acc: 0.2518
 Site-Southeast_Asian          | Train Loss: 1.8054 | Train Acc: 0.3381
 Site-Southeast_Asian          | Train Loss: 1.8650 | Train Acc: 0.3141
 Site-Middle_Eastern           | Train Loss: 1.8591 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8340 | Train Acc: 0.2878
 Site-White                         | Val  Loss: 1.8389 | Val  Acc: 0.3043
 Site-White                         | Val  Loss: 1.7366 | Val  Acc: 0.3633
 Site-Latino_Hispanic               | Val  Loss: 1.8227 | Val  Acc: 0.3152
 Site-Latino_Hispanic               | Val  Loss: 1.8054 | Val  Acc: 0.3022
 Site-Black                         | Val  Loss: 1.8314 | Val  Acc: 0.3370
 Site-Black                         | Val  Loss: 1.8461 | Val  Acc: 0.2878
 Site-East_Asian                    | Val  Loss: 1.6225 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7230 | Val  Acc: 0.3993
 Site-Indian                        | Val  Loss: 1.9195 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 1.8758 | Val  Acc: 0.2374
 Site-Southeast_Asian               | Val  Loss: 1.8530 | Val  Acc: 0.3043
 Site-Southeast_Asian               | Val  Loss: 1.8504 | Val  Acc: 0.3094
 Site-Middle_Eastern                | Val  Loss: 1.7858 | Val  Acc: 0.3152
 Site-Middle_Eastern                | Val  Loss: 1.8364 | Val  Acc: 0.2842
Average Valid Accuracy: 0.3175
 Best site-White                         | Epoch:31 | Val Acc: 0.3043
 Best site-White                         | Epoch:31 | Val Acc: 0.3633
 Best site-Latino_Hispanic               | Epoch:31 | Val Acc: 0.3152
 Best site-Latino_Hispanic               | Epoch:31 | Val Acc: 0.3022
 Best site-Black                         | Epoch:31 | Val Acc: 0.3370
 Best site-Black                         | Epoch:31 | Val Acc: 0.2878
 Best site-East_Asian                    | Epoch:31 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:31 | Val Acc: 0.3993
 Best site-Indian                        | Epoch:31 | Val Acc: 0.2391
 Best site-Indian                        | Epoch:31 | Val Acc: 0.2374
 Best site-Southeast_Asian               | Epoch:31 | Val Acc: 0.3043
 Best site-Southeast_Asian               | Epoch:31 | Val Acc: 0.3094
 Best site-Middle_Eastern                | Epoch:31 | Val Acc: 0.3152
 Best site-Middle_Eastern                | Epoch:31 | Val Acc: 0.2842
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 32 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8098 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.7260 | Train Acc: 0.3621
 Site-Latino_Hispanic          | Train Loss: 1.8330 | Train Acc: 0.3237
 Site-Latino_Hispanic          | Train Loss: 1.8109 | Train Acc: 0.2926
 Site-Black                    | Train Loss: 1.8279 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.8641 | Train Acc: 0.2950
 Site-East_Asian               | Train Loss: 1.7027 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.6812 | Train Acc: 0.4053
 Site-Indian                   | Train Loss: 1.9189 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 1.8697 | Train Acc: 0.2542
 Site-Southeast_Asian          | Train Loss: 1.8816 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.8317 | Train Acc: 0.3213
 Site-Middle_Eastern           | Train Loss: 1.8751 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8358 | Train Acc: 0.2854
 Site-White                         | Val  Loss: 1.7920 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7205 | Val  Acc: 0.3597
 Site-Latino_Hispanic               | Val  Loss: 1.8143 | Val  Acc: 0.3478
 Site-Latino_Hispanic               | Val  Loss: 1.7998 | Val  Acc: 0.2950
 Site-Black                         | Val  Loss: 1.8370 | Val  Acc: 0.3370
 Site-Black                         | Val  Loss: 1.8345 | Val  Acc: 0.2842
 Site-East_Asian                    | Val  Loss: 1.6205 | Val  Acc: 0.4565
 Site-East_Asian                    | Val  Loss: 1.7102 | Val  Acc: 0.4029
 Site-Indian                        | Val  Loss: 1.9186 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 1.8756 | Val  Acc: 0.2338
 Site-Southeast_Asian               | Val  Loss: 1.8230 | Val  Acc: 0.3152
 Site-Southeast_Asian               | Val  Loss: 1.8383 | Val  Acc: 0.3129
 Site-Middle_Eastern                | Val  Loss: 1.7847 | Val  Acc: 0.3043
 Site-Middle_Eastern                | Val  Loss: 1.8227 | Val  Acc: 0.2950
Average Valid Accuracy: 0.3213
 Best site-White                         | Epoch:32 | Val Acc: 0.3152
 Best site-White                         | Epoch:32 | Val Acc: 0.3597
 Best site-Latino_Hispanic               | Epoch:32 | Val Acc: 0.3478
 Best site-Latino_Hispanic               | Epoch:32 | Val Acc: 0.2950
 Best site-Black                         | Epoch:32 | Val Acc: 0.3370
 Best site-Black                         | Epoch:32 | Val Acc: 0.2842
 Best site-East_Asian                    | Epoch:32 | Val Acc: 0.4565
 Best site-East_Asian                    | Epoch:32 | Val Acc: 0.4029
 Best site-Indian                        | Epoch:32 | Val Acc: 0.2391
 Best site-Indian                        | Epoch:32 | Val Acc: 0.2338
 Best site-Southeast_Asian               | Epoch:32 | Val Acc: 0.3152
 Best site-Southeast_Asian               | Epoch:32 | Val Acc: 0.3129
 Best site-Middle_Eastern                | Epoch:32 | Val Acc: 0.3043
 Best site-Middle_Eastern                | Epoch:32 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 33 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7371 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.7004 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.8094 | Train Acc: 0.3237
 Site-Latino_Hispanic          | Train Loss: 1.8003 | Train Acc: 0.2926
 Site-Black                    | Train Loss: 1.9498 | Train Acc: 0.2446
 Site-Black                    | Train Loss: 1.8551 | Train Acc: 0.3070
 Site-East_Asian               | Train Loss: 1.6190 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.6943 | Train Acc: 0.4101
 Site-Indian                   | Train Loss: 1.7988 | Train Acc: 0.2734
 Site-Indian                   | Train Loss: 1.8890 | Train Acc: 0.2350
 Site-Southeast_Asian          | Train Loss: 1.7887 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8360 | Train Acc: 0.3189
 Site-Middle_Eastern           | Train Loss: 1.7517 | Train Acc: 0.2950
 Site-Middle_Eastern           | Train Loss: 1.8230 | Train Acc: 0.2950
 Site-White                         | Val  Loss: 1.8078 | Val  Acc: 0.3261
 Site-White                         | Val  Loss: 1.7235 | Val  Acc: 0.3597
 Site-Latino_Hispanic               | Val  Loss: 1.8116 | Val  Acc: 0.3152
 Site-Latino_Hispanic               | Val  Loss: 1.7877 | Val  Acc: 0.2986
 Site-Black                         | Val  Loss: 1.8207 | Val  Acc: 0.3261
 Site-Black                         | Val  Loss: 1.8356 | Val  Acc: 0.2986
 Site-East_Asian                    | Val  Loss: 1.6039 | Val  Acc: 0.4565
 Site-East_Asian                    | Val  Loss: 1.7084 | Val  Acc: 0.4137
 Site-Indian                        | Val  Loss: 1.8919 | Val  Acc: 0.2174
 Site-Indian                        | Val  Loss: 1.8613 | Val  Acc: 0.2410
 Site-Southeast_Asian               | Val  Loss: 1.8441 | Val  Acc: 0.3152
 Site-Southeast_Asian               | Val  Loss: 1.8367 | Val  Acc: 0.3165
 Site-Middle_Eastern                | Val  Loss: 1.7673 | Val  Acc: 0.3478
 Site-Middle_Eastern                | Val  Loss: 1.8371 | Val  Acc: 0.2842
Average Valid Accuracy: 0.3226
 Best site-White                         | Epoch:33 | Val Acc: 0.3261
 Best site-White                         | Epoch:33 | Val Acc: 0.3597
 Best site-Latino_Hispanic               | Epoch:33 | Val Acc: 0.3152
 Best site-Latino_Hispanic               | Epoch:33 | Val Acc: 0.2986
 Best site-Black                         | Epoch:33 | Val Acc: 0.3261
 Best site-Black                         | Epoch:33 | Val Acc: 0.2986
 Best site-East_Asian                    | Epoch:33 | Val Acc: 0.4565
 Best site-East_Asian                    | Epoch:33 | Val Acc: 0.4137
 Best site-Indian                        | Epoch:33 | Val Acc: 0.2174
 Best site-Indian                        | Epoch:33 | Val Acc: 0.2410
 Best site-Southeast_Asian               | Epoch:33 | Val Acc: 0.3152
 Best site-Southeast_Asian               | Epoch:33 | Val Acc: 0.3165
 Best site-Middle_Eastern                | Epoch:33 | Val Acc: 0.3478
 Best site-Middle_Eastern                | Epoch:33 | Val Acc: 0.2842
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 34 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7186 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.7129 | Train Acc: 0.3573
 Site-Latino_Hispanic          | Train Loss: 1.7700 | Train Acc: 0.3381
 Site-Latino_Hispanic          | Train Loss: 1.8009 | Train Acc: 0.2806
 Site-Black                    | Train Loss: 1.8472 | Train Acc: 0.2878
 Site-Black                    | Train Loss: 1.8619 | Train Acc: 0.2974
 Site-East_Asian               | Train Loss: 1.6650 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.6879 | Train Acc: 0.4077
 Site-Indian                   | Train Loss: 1.8347 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 1.8637 | Train Acc: 0.2542
 Site-Southeast_Asian          | Train Loss: 1.8907 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8531 | Train Acc: 0.3165
 Site-Middle_Eastern           | Train Loss: 1.8272 | Train Acc: 0.2878
 Site-Middle_Eastern           | Train Loss: 1.8180 | Train Acc: 0.3046
 Site-White                         | Val  Loss: 1.8062 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7089 | Val  Acc: 0.3633
 Site-Latino_Hispanic               | Val  Loss: 1.7992 | Val  Acc: 0.3370
 Site-Latino_Hispanic               | Val  Loss: 1.7912 | Val  Acc: 0.3058
 Site-Black                         | Val  Loss: 1.8279 | Val  Acc: 0.3478
 Site-Black                         | Val  Loss: 1.8313 | Val  Acc: 0.3022
 Site-East_Asian                    | Val  Loss: 1.6237 | Val  Acc: 0.4457
 Site-East_Asian                    | Val  Loss: 1.7063 | Val  Acc: 0.4029
 Site-Indian                        | Val  Loss: 1.8918 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.8649 | Val  Acc: 0.2662
 Site-Southeast_Asian               | Val  Loss: 1.8413 | Val  Acc: 0.2935
 Site-Southeast_Asian               | Val  Loss: 1.8386 | Val  Acc: 0.3201
 Site-Middle_Eastern                | Val  Loss: 1.7681 | Val  Acc: 0.3478
 Site-Middle_Eastern                | Val  Loss: 1.8178 | Val  Acc: 0.2950
Average Valid Accuracy: 0.3265
 Best site-White                         | Epoch:34 | Val Acc: 0.3152
 Best site-White                         | Epoch:34 | Val Acc: 0.3633
 Best site-Latino_Hispanic               | Epoch:34 | Val Acc: 0.3370
 Best site-Latino_Hispanic               | Epoch:34 | Val Acc: 0.3058
 Best site-Black                         | Epoch:34 | Val Acc: 0.3478
 Best site-Black                         | Epoch:34 | Val Acc: 0.3022
 Best site-East_Asian                    | Epoch:34 | Val Acc: 0.4457
 Best site-East_Asian                    | Epoch:34 | Val Acc: 0.4029
 Best site-Indian                        | Epoch:34 | Val Acc: 0.2283
 Best site-Indian                        | Epoch:34 | Val Acc: 0.2662
 Best site-Southeast_Asian               | Epoch:34 | Val Acc: 0.2935
 Best site-Southeast_Asian               | Epoch:34 | Val Acc: 0.3201
 Best site-Middle_Eastern                | Epoch:34 | Val Acc: 0.3478
 Best site-Middle_Eastern                | Epoch:34 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7202 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.6934 | Train Acc: 0.3693
 Site-Latino_Hispanic          | Train Loss: 1.7569 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.7931 | Train Acc: 0.2974
 Site-Black                    | Train Loss: 1.9896 | Train Acc: 0.2590
 Site-Black                    | Train Loss: 1.8670 | Train Acc: 0.3094
 Site-East_Asian               | Train Loss: 1.6300 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.6736 | Train Acc: 0.4221
 Site-Indian                   | Train Loss: 1.7841 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.8755 | Train Acc: 0.2494
 Site-Southeast_Asian          | Train Loss: 1.8312 | Train Acc: 0.3094
 Site-Southeast_Asian          | Train Loss: 1.8460 | Train Acc: 0.3213
 Site-Middle_Eastern           | Train Loss: 1.8274 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8157 | Train Acc: 0.2830
 Site-White                         | Val  Loss: 1.8195 | Val  Acc: 0.3478
 Site-White                         | Val  Loss: 1.7069 | Val  Acc: 0.3669
 Site-Latino_Hispanic               | Val  Loss: 1.8151 | Val  Acc: 0.3478
 Site-Latino_Hispanic               | Val  Loss: 1.7813 | Val  Acc: 0.2986
 Site-Black                         | Val  Loss: 1.8150 | Val  Acc: 0.3478
 Site-Black                         | Val  Loss: 1.8265 | Val  Acc: 0.3273
 Site-East_Asian                    | Val  Loss: 1.6088 | Val  Acc: 0.4674
 Site-East_Asian                    | Val  Loss: 1.6890 | Val  Acc: 0.4101
 Site-Indian                        | Val  Loss: 1.8855 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 1.8459 | Val  Acc: 0.2446
 Site-Southeast_Asian               | Val  Loss: 1.8206 | Val  Acc: 0.3261
 Site-Southeast_Asian               | Val  Loss: 1.8437 | Val  Acc: 0.3058
 Site-Middle_Eastern                | Val  Loss: 1.7678 | Val  Acc: 0.3261
 Site-Middle_Eastern                | Val  Loss: 1.8093 | Val  Acc: 0.3058
Average Valid Accuracy: 0.3329
 Best site-White                         | Epoch:35 | Val Acc: 0.3478
 Best site-White                         | Epoch:35 | Val Acc: 0.3669
 Best site-Latino_Hispanic               | Epoch:35 | Val Acc: 0.3478
 Best site-Latino_Hispanic               | Epoch:35 | Val Acc: 0.2986
 Best site-Black                         | Epoch:35 | Val Acc: 0.3478
 Best site-Black                         | Epoch:35 | Val Acc: 0.3273
 Best site-East_Asian                    | Epoch:35 | Val Acc: 0.4674
 Best site-East_Asian                    | Epoch:35 | Val Acc: 0.4101
 Best site-Indian                        | Epoch:35 | Val Acc: 0.2391
 Best site-Indian                        | Epoch:35 | Val Acc: 0.2446
 Best site-Southeast_Asian               | Epoch:35 | Val Acc: 0.3261
 Best site-Southeast_Asian               | Epoch:35 | Val Acc: 0.3058
 Best site-Middle_Eastern                | Epoch:35 | Val Acc: 0.3261
 Best site-Middle_Eastern                | Epoch:35 | Val Acc: 0.3058
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6235 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.7065 | Train Acc: 0.3717
 Site-Latino_Hispanic          | Train Loss: 1.7307 | Train Acc: 0.3165
 Site-Latino_Hispanic          | Train Loss: 1.7843 | Train Acc: 0.2998
 Site-Black                    | Train Loss: 1.8542 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.8371 | Train Acc: 0.3189
 Site-East_Asian               | Train Loss: 1.6669 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.6750 | Train Acc: 0.4149
 Site-Indian                   | Train Loss: 1.8560 | Train Acc: 0.2734
 Site-Indian                   | Train Loss: 1.8678 | Train Acc: 0.2470
 Site-Southeast_Asian          | Train Loss: 1.7790 | Train Acc: 0.3309
 Site-Southeast_Asian          | Train Loss: 1.8292 | Train Acc: 0.3261
 Site-Middle_Eastern           | Train Loss: 1.7819 | Train Acc: 0.2950
 Site-Middle_Eastern           | Train Loss: 1.8047 | Train Acc: 0.2854
 Site-White                         | Val  Loss: 1.8065 | Val  Acc: 0.3152
 Site-White                         | Val  Loss: 1.7051 | Val  Acc: 0.3669
 Site-Latino_Hispanic               | Val  Loss: 1.7903 | Val  Acc: 0.3261
 Site-Latino_Hispanic               | Val  Loss: 1.7773 | Val  Acc: 0.3165
 Site-Black                         | Val  Loss: 1.8533 | Val  Acc: 0.3587
 Site-Black                         | Val  Loss: 1.8287 | Val  Acc: 0.3094
 Site-East_Asian                    | Val  Loss: 1.5920 | Val  Acc: 0.4783
 Site-East_Asian                    | Val  Loss: 1.6943 | Val  Acc: 0.4101
 Site-Indian                        | Val  Loss: 1.9011 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.8566 | Val  Acc: 0.2482
 Site-Southeast_Asian               | Val  Loss: 1.8339 | Val  Acc: 0.3370
 Site-Southeast_Asian               | Val  Loss: 1.8223 | Val  Acc: 0.3094
 Site-Middle_Eastern                | Val  Loss: 1.7627 | Val  Acc: 0.3152
 Site-Middle_Eastern                | Val  Loss: 1.8092 | Val  Acc: 0.2986
Average Valid Accuracy: 0.3298
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7127 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.6903 | Train Acc: 0.3837
 Site-Latino_Hispanic          | Train Loss: 1.7460 | Train Acc: 0.3453
 Site-Latino_Hispanic          | Train Loss: 1.7921 | Train Acc: 0.2902
 Site-Black                    | Train Loss: 1.7831 | Train Acc: 0.2878
 Site-Black                    | Train Loss: 1.8466 | Train Acc: 0.3046
 Site-East_Asian               | Train Loss: 1.6947 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.6787 | Train Acc: 0.4221
 Site-Indian                   | Train Loss: 1.8370 | Train Acc: 0.2734
 Site-Indian                   | Train Loss: 1.8565 | Train Acc: 0.2590
 Site-Southeast_Asian          | Train Loss: 1.8350 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8171 | Train Acc: 0.3285
 Site-Middle_Eastern           | Train Loss: 1.8335 | Train Acc: 0.3094
 Site-Middle_Eastern           | Train Loss: 1.8056 | Train Acc: 0.3022
 Site-White                         | Val  Loss: 1.8075 | Val  Acc: 0.3261
 Site-White                         | Val  Loss: 1.7058 | Val  Acc: 0.3561
 Site-Latino_Hispanic               | Val  Loss: 1.7934 | Val  Acc: 0.3370
 Site-Latino_Hispanic               | Val  Loss: 1.7748 | Val  Acc: 0.3165
 Site-Black                         | Val  Loss: 1.8190 | Val  Acc: 0.3152
 Site-Black                         | Val  Loss: 1.8116 | Val  Acc: 0.3273
 Site-East_Asian                    | Val  Loss: 1.5912 | Val  Acc: 0.4565
 Site-East_Asian                    | Val  Loss: 1.6859 | Val  Acc: 0.4137
 Site-Indian                        | Val  Loss: 1.8921 | Val  Acc: 0.2283
 Site-Indian                        | Val  Loss: 1.8488 | Val  Acc: 0.2590
 Site-Southeast_Asian               | Val  Loss: 1.8062 | Val  Acc: 0.3696
 Site-Southeast_Asian               | Val  Loss: 1.8188 | Val  Acc: 0.3165
 Site-Middle_Eastern                | Val  Loss: 1.7568 | Val  Acc: 0.3587
 Site-Middle_Eastern                | Val  Loss: 1.8092 | Val  Acc: 0.3129
Average Valid Accuracy: 0.3352
 Best site-White                         | Epoch:37 | Val Acc: 0.3261
 Best site-White                         | Epoch:37 | Val Acc: 0.3561
 Best site-Latino_Hispanic               | Epoch:37 | Val Acc: 0.3370
 Best site-Latino_Hispanic               | Epoch:37 | Val Acc: 0.3165
 Best site-Black                         | Epoch:37 | Val Acc: 0.3152
 Best site-Black                         | Epoch:37 | Val Acc: 0.3273
 Best site-East_Asian                    | Epoch:37 | Val Acc: 0.4565
 Best site-East_Asian                    | Epoch:37 | Val Acc: 0.4137
 Best site-Indian                        | Epoch:37 | Val Acc: 0.2283
 Best site-Indian                        | Epoch:37 | Val Acc: 0.2590
 Best site-Southeast_Asian               | Epoch:37 | Val Acc: 0.3696
 Best site-Southeast_Asian               | Epoch:37 | Val Acc: 0.3165
 Best site-Middle_Eastern                | Epoch:37 | Val Acc: 0.3587
 Best site-Middle_Eastern                | Epoch:37 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 38 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7109 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.6937 | Train Acc: 0.3861
 Site-Latino_Hispanic          | Train Loss: 1.7561 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.7755 | Train Acc: 0.2974
 Site-Black                    | Train Loss: 1.8572 | Train Acc: 0.2806
 Site-Black                    | Train Loss: 1.8417 | Train Acc: 0.3094
 Site-East_Asian               | Train Loss: 1.6033 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.6715 | Train Acc: 0.4293
 Site-Indian                   | Train Loss: 1.8974 | Train Acc: 0.2878
 Site-Indian                   | Train Loss: 1.8476 | Train Acc: 0.2614
 Site-Southeast_Asian          | Train Loss: 1.8921 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.8231 | Train Acc: 0.3189
 Site-Middle_Eastern           | Train Loss: 1.8036 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.8005 | Train Acc: 0.2974
 Site-White                         | Val  Loss: 1.8127 | Val  Acc: 0.3370
 Site-White                         | Val  Loss: 1.6989 | Val  Acc: 0.3597
 Site-Latino_Hispanic               | Val  Loss: 1.7785 | Val  Acc: 0.3261
 Site-Latino_Hispanic               | Val  Loss: 1.7757 | Val  Acc: 0.3201
 Site-Black                         | Val  Loss: 1.8318 | Val  Acc: 0.3478
 Site-Black                         | Val  Loss: 1.8184 | Val  Acc: 0.3129
 Site-East_Asian                    | Val  Loss: 1.5867 | Val  Acc: 0.4891
 Site-East_Asian                    | Val  Loss: 1.6875 | Val  Acc: 0.4245
 Site-Indian                        | Val  Loss: 1.8946 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 1.8516 | Val  Acc: 0.2590
 Site-Southeast_Asian               | Val  Loss: 1.8151 | Val  Acc: 0.3478
 Site-Southeast_Asian               | Val  Loss: 1.8209 | Val  Acc: 0.3237
 Site-Middle_Eastern                | Val  Loss: 1.7601 | Val  Acc: 0.3478
 Site-Middle_Eastern                | Val  Loss: 1.7954 | Val  Acc: 0.3058
Average Valid Accuracy: 0.3386
 Best site-White                         | Epoch:38 | Val Acc: 0.3370
 Best site-White                         | Epoch:38 | Val Acc: 0.3597
 Best site-Latino_Hispanic               | Epoch:38 | Val Acc: 0.3261
 Best site-Latino_Hispanic               | Epoch:38 | Val Acc: 0.3201
 Best site-Black                         | Epoch:38 | Val Acc: 0.3478
 Best site-Black                         | Epoch:38 | Val Acc: 0.3129
 Best site-East_Asian                    | Epoch:38 | Val Acc: 0.4891
 Best site-East_Asian                    | Epoch:38 | Val Acc: 0.4245
 Best site-Indian                        | Epoch:38 | Val Acc: 0.2391
 Best site-Indian                        | Epoch:38 | Val Acc: 0.2590
 Best site-Southeast_Asian               | Epoch:38 | Val Acc: 0.3478
 Best site-Southeast_Asian               | Epoch:38 | Val Acc: 0.3237
 Best site-Middle_Eastern                | Epoch:38 | Val Acc: 0.3478
 Best site-Middle_Eastern                | Epoch:38 | Val Acc: 0.3058
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 39 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7134 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.6858 | Train Acc: 0.3861
 Site-Latino_Hispanic          | Train Loss: 1.8072 | Train Acc: 0.3381
 Site-Latino_Hispanic          | Train Loss: 1.7913 | Train Acc: 0.3070
 Site-Black                    | Train Loss: 1.8598 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.8309 | Train Acc: 0.3070
 Site-East_Asian               | Train Loss: 1.7190 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.6535 | Train Acc: 0.4221
 Site-Indian                   | Train Loss: 1.8570 | Train Acc: 0.2806
 Site-Indian                   | Train Loss: 1.8596 | Train Acc: 0.2734
 Site-Southeast_Asian          | Train Loss: 1.7708 | Train Acc: 0.3381
 Site-Southeast_Asian          | Train Loss: 1.8389 | Train Acc: 0.3309
 Site-Middle_Eastern           | Train Loss: 1.7541 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.7927 | Train Acc: 0.3070
 Site-White                         | Val  Loss: 1.7768 | Val  Acc: 0.3478
 Site-White                         | Val  Loss: 1.6931 | Val  Acc: 0.3849
 Site-Latino_Hispanic               | Val  Loss: 1.7874 | Val  Acc: 0.3370
 Site-Latino_Hispanic               | Val  Loss: 1.7754 | Val  Acc: 0.3201
 Site-Black                         | Val  Loss: 1.8199 | Val  Acc: 0.3370
 Site-Black                         | Val  Loss: 1.8214 | Val  Acc: 0.3201
 Site-East_Asian                    | Val  Loss: 1.6147 | Val  Acc: 0.4674
 Site-East_Asian                    | Val  Loss: 1.6876 | Val  Acc: 0.4245
 Site-Indian                        | Val  Loss: 1.8809 | Val  Acc: 0.2500
 Site-Indian                        | Val  Loss: 1.8445 | Val  Acc: 0.2518
 Site-Southeast_Asian               | Val  Loss: 1.8260 | Val  Acc: 0.3261
 Site-Southeast_Asian               | Val  Loss: 1.8089 | Val  Acc: 0.3237
 Site-Middle_Eastern                | Val  Loss: 1.7359 | Val  Acc: 0.3478
 Site-Middle_Eastern                | Val  Loss: 1.7966 | Val  Acc: 0.2914
Average Valid Accuracy: 0.3378
============ Train epoch 40 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7122 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.6882 | Train Acc: 0.3861
 Site-Latino_Hispanic          | Train Loss: 1.8018 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.7761 | Train Acc: 0.3094
 Site-Black                    | Train Loss: 1.8746 | Train Acc: 0.2806
 Site-Black                    | Train Loss: 1.8385 | Train Acc: 0.3189
 Site-East_Asian               | Train Loss: 1.6454 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.6390 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.7902 | Train Acc: 0.2878
 Site-Indian                   | Train Loss: 1.8440 | Train Acc: 0.2662
 Site-Southeast_Asian          | Train Loss: 1.8249 | Train Acc: 0.3381
 Site-Southeast_Asian          | Train Loss: 1.8290 | Train Acc: 0.3333
 Site-Middle_Eastern           | Train Loss: 1.8020 | Train Acc: 0.3165
 Site-Middle_Eastern           | Train Loss: 1.7842 | Train Acc: 0.3094
 Site-White                         | Val  Loss: 1.7873 | Val  Acc: 0.3370
 Site-White                         | Val  Loss: 1.6918 | Val  Acc: 0.3813
 Site-Latino_Hispanic               | Val  Loss: 1.7814 | Val  Acc: 0.3478
 Site-Latino_Hispanic               | Val  Loss: 1.7726 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.8018 | Val  Acc: 0.3587
 Site-Black                         | Val  Loss: 1.8139 | Val  Acc: 0.3273
 Site-East_Asian                    | Val  Loss: 1.5985 | Val  Acc: 0.4783
 Site-East_Asian                    | Val  Loss: 1.6781 | Val  Acc: 0.4388
 Site-Indian                        | Val  Loss: 1.8634 | Val  Acc: 0.2500
 Site-Indian                        | Val  Loss: 1.8346 | Val  Acc: 0.2590
 Site-Southeast_Asian               | Val  Loss: 1.7903 | Val  Acc: 0.3478
 Site-Southeast_Asian               | Val  Loss: 1.8145 | Val  Acc: 0.3453
 Site-Middle_Eastern                | Val  Loss: 1.7241 | Val  Acc: 0.3696
 Site-Middle_Eastern                | Val  Loss: 1.7960 | Val  Acc: 0.3165
Average Valid Accuracy: 0.3489
 Best site-White                         | Epoch:40 | Val Acc: 0.3370
 Best site-White                         | Epoch:40 | Val Acc: 0.3813
 Best site-Latino_Hispanic               | Epoch:40 | Val Acc: 0.3478
 Best site-Latino_Hispanic               | Epoch:40 | Val Acc: 0.3273
 Best site-Black                         | Epoch:40 | Val Acc: 0.3587
 Best site-Black                         | Epoch:40 | Val Acc: 0.3273
 Best site-East_Asian                    | Epoch:40 | Val Acc: 0.4783
 Best site-East_Asian                    | Epoch:40 | Val Acc: 0.4388
 Best site-Indian                        | Epoch:40 | Val Acc: 0.2500
 Best site-Indian                        | Epoch:40 | Val Acc: 0.2590
 Best site-Southeast_Asian               | Epoch:40 | Val Acc: 0.3478
 Best site-Southeast_Asian               | Epoch:40 | Val Acc: 0.3453
 Best site-Middle_Eastern                | Epoch:40 | Val Acc: 0.3696
 Best site-Middle_Eastern                | Epoch:40 | Val Acc: 0.3165
 Test site-White                     (4)| Epoch:40 | Test Acc: 0.3476
 Test site-Latino_Hispanic           (6)| Epoch:40 | Test Acc: 0.3006
 Test site-Black                     (0)| Epoch:40 | Test Acc: 0.3031
 Test site-East_Asian                (5)| Epoch:40 | Test Acc: 0.4773
 Test site-Indian                    (3)| Epoch:40 | Test Acc: 0.2967
 Test site-Southeast_Asian           (2)| Epoch:40 | Test Acc: 0.3963
 Test site-Middle_Eastern            (1)| Epoch:40 | Test Acc: 0.3402
White: 0.3476, Latino_Hispanic: 0.3006, Black: 0.3031, East_Asian: 0.4773, Indian: 0.2967, Southeast_Asian: 0.3963, Middle_Eastern: 0.3402, 
Average Test Accuracy(group): 0.3517, Average Test Accuracy(individual): 0.3517,
domain std=0.0608, cluster std=0.0608, individual std=0.0608, 
Average Test Accuracy: 0.3517
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 41 ============
cnt=[3, 2, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6796 | Train Acc: 0.3309
 Site-White                    | Train Loss: 1.6734 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.8806 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.7691 | Train Acc: 0.3237
 Site-Black                    | Train Loss: 1.8151 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.8281 | Train Acc: 0.3333
 Site-East_Asian               | Train Loss: 1.6756 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.6628 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.8356 | Train Acc: 0.2806
 Site-Indian                   | Train Loss: 1.8551 | Train Acc: 0.2590
 Site-Southeast_Asian          | Train Loss: 1.7316 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8167 | Train Acc: 0.3213
 Site-Middle_Eastern           | Train Loss: 1.7516 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.7847 | Train Acc: 0.3046
 Site-White                         | Val  Loss: 1.7782 | Val  Acc: 0.3478
 Site-White                         | Val  Loss: 1.6962 | Val  Acc: 0.3705
 Site-Latino_Hispanic               | Val  Loss: 1.7791 | Val  Acc: 0.3587
 Site-Latino_Hispanic               | Val  Loss: 1.7703 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.8319 | Val  Acc: 0.4022
 Site-Black                         | Val  Loss: 1.8050 | Val  Acc: 0.3094
 Site-East_Asian                    | Val  Loss: 1.5826 | Val  Acc: 0.4783
 Site-East_Asian                    | Val  Loss: 1.6661 | Val  Acc: 0.4317
 Site-Indian                        | Val  Loss: 1.8915 | Val  Acc: 0.2717
 Site-Indian                        | Val  Loss: 1.8389 | Val  Acc: 0.2410
 Site-Southeast_Asian               | Val  Loss: 1.8121 | Val  Acc: 0.3478
 Site-Southeast_Asian               | Val  Loss: 1.7964 | Val  Acc: 0.3201
 Site-Middle_Eastern                | Val  Loss: 1.7280 | Val  Acc: 0.3696
 Site-Middle_Eastern                | Val  Loss: 1.7930 | Val  Acc: 0.3165
Average Valid Accuracy: 0.3495
 Best site-White                         | Epoch:41 | Val Acc: 0.3478
 Best site-White                         | Epoch:41 | Val Acc: 0.3705
 Best site-Latino_Hispanic               | Epoch:41 | Val Acc: 0.3587
 Best site-Latino_Hispanic               | Epoch:41 | Val Acc: 0.3273
 Best site-Black                         | Epoch:41 | Val Acc: 0.4022
 Best site-Black                         | Epoch:41 | Val Acc: 0.3094
 Best site-East_Asian                    | Epoch:41 | Val Acc: 0.4783
 Best site-East_Asian                    | Epoch:41 | Val Acc: 0.4317
 Best site-Indian                        | Epoch:41 | Val Acc: 0.2717
 Best site-Indian                        | Epoch:41 | Val Acc: 0.2410
 Best site-Southeast_Asian               | Epoch:41 | Val Acc: 0.3478
 Best site-Southeast_Asian               | Epoch:41 | Val Acc: 0.3201
 Best site-Middle_Eastern                | Epoch:41 | Val Acc: 0.3696
 Best site-Middle_Eastern                | Epoch:41 | Val Acc: 0.3165
 Test site-White                     (2)| Epoch:41 | Test Acc: 0.3529
 Test site-Latino_Hispanic           (6)| Epoch:41 | Test Acc: 0.3133
 Test site-Black                     (1)| Epoch:41 | Test Acc: 0.3094
 Test site-East_Asian                (5)| Epoch:41 | Test Acc: 0.4870
 Test site-Indian                    (4)| Epoch:41 | Test Acc: 0.3014
 Test site-Southeast_Asian           (3)| Epoch:41 | Test Acc: 0.3963
 Test site-Middle_Eastern            (0)| Epoch:41 | Test Acc: 0.3454
White: 0.3529, Latino_Hispanic: 0.3133, Black: 0.3094, East_Asian: 0.4870, Indian: 0.3014, Southeast_Asian: 0.3963, Middle_Eastern: 0.3454, 
Average Test Accuracy(group): 0.3580, Average Test Accuracy(individual): 0.3580,
domain std=0.0608, cluster std=0.0608, individual std=0.0608, 
Average Test Accuracy: 0.3580
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 42 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7400 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.6762 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.8404 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.7736 | Train Acc: 0.3237
 Site-Black                    | Train Loss: 1.8023 | Train Acc: 0.2878
 Site-Black                    | Train Loss: 1.8239 | Train Acc: 0.3429
 Site-East_Asian               | Train Loss: 1.7195 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.6389 | Train Acc: 0.4317
 Site-Indian                   | Train Loss: 1.8050 | Train Acc: 0.2734
 Site-Indian                   | Train Loss: 1.8419 | Train Acc: 0.2590
 Site-Southeast_Asian          | Train Loss: 1.7842 | Train Acc: 0.3381
 Site-Southeast_Asian          | Train Loss: 1.8121 | Train Acc: 0.3357
 Site-Middle_Eastern           | Train Loss: 1.8326 | Train Acc: 0.3237
 Site-Middle_Eastern           | Train Loss: 1.7851 | Train Acc: 0.3141
 Site-White                         | Val  Loss: 1.7896 | Val  Acc: 0.3478
 Site-White                         | Val  Loss: 1.6788 | Val  Acc: 0.3813
 Site-Latino_Hispanic               | Val  Loss: 1.7624 | Val  Acc: 0.3587
 Site-Latino_Hispanic               | Val  Loss: 1.7598 | Val  Acc: 0.3165
 Site-Black                         | Val  Loss: 1.7940 | Val  Acc: 0.3804
 Site-Black                         | Val  Loss: 1.7957 | Val  Acc: 0.3381
 Site-East_Asian                    | Val  Loss: 1.5864 | Val  Acc: 0.4783
 Site-East_Asian                    | Val  Loss: 1.6623 | Val  Acc: 0.4388
 Site-Indian                        | Val  Loss: 1.8725 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 1.8280 | Val  Acc: 0.2554
 Site-Southeast_Asian               | Val  Loss: 1.7986 | Val  Acc: 0.3478
 Site-Southeast_Asian               | Val  Loss: 1.8061 | Val  Acc: 0.3417
 Site-Middle_Eastern                | Val  Loss: 1.7279 | Val  Acc: 0.3587
 Site-Middle_Eastern                | Val  Loss: 1.7886 | Val  Acc: 0.3345
Average Valid Accuracy: 0.3512
 Best site-White                         | Epoch:42 | Val Acc: 0.3478
 Best site-White                         | Epoch:42 | Val Acc: 0.3813
 Best site-Latino_Hispanic               | Epoch:42 | Val Acc: 0.3587
 Best site-Latino_Hispanic               | Epoch:42 | Val Acc: 0.3165
 Best site-Black                         | Epoch:42 | Val Acc: 0.3804
 Best site-Black                         | Epoch:42 | Val Acc: 0.3381
 Best site-East_Asian                    | Epoch:42 | Val Acc: 0.4783
 Best site-East_Asian                    | Epoch:42 | Val Acc: 0.4388
 Best site-Indian                        | Epoch:42 | Val Acc: 0.2391
 Best site-Indian                        | Epoch:42 | Val Acc: 0.2554
 Best site-Southeast_Asian               | Epoch:42 | Val Acc: 0.3478
 Best site-Southeast_Asian               | Epoch:42 | Val Acc: 0.3417
 Best site-Middle_Eastern                | Epoch:42 | Val Acc: 0.3587
 Best site-Middle_Eastern                | Epoch:42 | Val Acc: 0.3345
 Test site-White                     (5)| Epoch:42 | Test Acc: 0.3556
 Test site-Latino_Hispanic           (6)| Epoch:42 | Test Acc: 0.3165
 Test site-Black                     (2)| Epoch:42 | Test Acc: 0.3187
 Test site-East_Asian                (0)| Epoch:42 | Test Acc: 0.4870
 Test site-Indian                    (3)| Epoch:42 | Test Acc: 0.3038
 Test site-Southeast_Asian           (4)| Epoch:42 | Test Acc: 0.3963
 Test site-Middle_Eastern            (1)| Epoch:42 | Test Acc: 0.3428
White: 0.3556, Latino_Hispanic: 0.3165, Black: 0.3187, East_Asian: 0.4870, Indian: 0.3038, Southeast_Asian: 0.3963, Middle_Eastern: 0.3428, 
Average Test Accuracy(group): 0.3601, Average Test Accuracy(individual): 0.3601,
domain std=0.0592, cluster std=0.0592, individual std=0.0592, 
Average Test Accuracy: 0.3601
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 43 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7246 | Train Acc: 0.3741
 Site-White                    | Train Loss: 1.6689 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.7469 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.7743 | Train Acc: 0.3261
 Site-Black                    | Train Loss: 1.8938 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.8289 | Train Acc: 0.3237
 Site-East_Asian               | Train Loss: 1.7805 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.6314 | Train Acc: 0.4436
 Site-Indian                   | Train Loss: 1.8710 | Train Acc: 0.2806
 Site-Indian                   | Train Loss: 1.8576 | Train Acc: 0.2494
 Site-Southeast_Asian          | Train Loss: 1.7688 | Train Acc: 0.3453
 Site-Southeast_Asian          | Train Loss: 1.7973 | Train Acc: 0.3549
 Site-Middle_Eastern           | Train Loss: 1.8200 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.7615 | Train Acc: 0.3094
 Site-White                         | Val  Loss: 1.7868 | Val  Acc: 0.3261
 Site-White                         | Val  Loss: 1.6780 | Val  Acc: 0.3849
 Site-Latino_Hispanic               | Val  Loss: 1.7706 | Val  Acc: 0.3370
 Site-Latino_Hispanic               | Val  Loss: 1.7508 | Val  Acc: 0.3381
 Site-Black                         | Val  Loss: 1.7829 | Val  Acc: 0.3804
 Site-Black                         | Val  Loss: 1.8060 | Val  Acc: 0.3345
 Site-East_Asian                    | Val  Loss: 1.5514 | Val  Acc: 0.4891
 Site-East_Asian                    | Val  Loss: 1.6598 | Val  Acc: 0.4388
 Site-Indian                        | Val  Loss: 1.8862 | Val  Acc: 0.2500
 Site-Indian                        | Val  Loss: 1.8228 | Val  Acc: 0.2590
 Site-Southeast_Asian               | Val  Loss: 1.8173 | Val  Acc: 0.3261
 Site-Southeast_Asian               | Val  Loss: 1.8077 | Val  Acc: 0.3381
 Site-Middle_Eastern                | Val  Loss: 1.7361 | Val  Acc: 0.4130
 Site-Middle_Eastern                | Val  Loss: 1.7827 | Val  Acc: 0.3273
Average Valid Accuracy: 0.3530
 Best site-White                         | Epoch:43 | Val Acc: 0.3261
 Best site-White                         | Epoch:43 | Val Acc: 0.3849
 Best site-Latino_Hispanic               | Epoch:43 | Val Acc: 0.3370
 Best site-Latino_Hispanic               | Epoch:43 | Val Acc: 0.3381
 Best site-Black                         | Epoch:43 | Val Acc: 0.3804
 Best site-Black                         | Epoch:43 | Val Acc: 0.3345
 Best site-East_Asian                    | Epoch:43 | Val Acc: 0.4891
 Best site-East_Asian                    | Epoch:43 | Val Acc: 0.4388
 Best site-Indian                        | Epoch:43 | Val Acc: 0.2500
 Best site-Indian                        | Epoch:43 | Val Acc: 0.2590
 Best site-Southeast_Asian               | Epoch:43 | Val Acc: 0.3261
 Best site-Southeast_Asian               | Epoch:43 | Val Acc: 0.3381
 Best site-Middle_Eastern                | Epoch:43 | Val Acc: 0.4130
 Best site-Middle_Eastern                | Epoch:43 | Val Acc: 0.3273
 Test site-White                     (5)| Epoch:43 | Test Acc: 0.3583
 Test site-Latino_Hispanic           (6)| Epoch:43 | Test Acc: 0.3165
 Test site-Black                     (2)| Epoch:43 | Test Acc: 0.3250
 Test site-East_Asian                (1)| Epoch:43 | Test Acc: 0.4870
 Test site-Indian                    (4)| Epoch:43 | Test Acc: 0.3038
 Test site-Southeast_Asian           (3)| Epoch:43 | Test Acc: 0.4000
 Test site-Middle_Eastern            (0)| Epoch:43 | Test Acc: 0.3454
White: 0.3583, Latino_Hispanic: 0.3165, Black: 0.3250, East_Asian: 0.4870, Indian: 0.3038, Southeast_Asian: 0.4000, Middle_Eastern: 0.3454, 
Average Test Accuracy(group): 0.3623, Average Test Accuracy(individual): 0.3623,
domain std=0.0588, cluster std=0.0588, individual std=0.0588, 
Average Test Accuracy: 0.3623
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 44 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6154 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.6651 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.7554 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.7600 | Train Acc: 0.3094
 Site-Black                    | Train Loss: 1.8317 | Train Acc: 0.2878
 Site-Black                    | Train Loss: 1.8117 | Train Acc: 0.3453
 Site-East_Asian               | Train Loss: 1.6850 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.6365 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.7758 | Train Acc: 0.2806
 Site-Indian                   | Train Loss: 1.8227 | Train Acc: 0.2638
 Site-Southeast_Asian          | Train Loss: 1.8127 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8099 | Train Acc: 0.3429
 Site-Middle_Eastern           | Train Loss: 1.7606 | Train Acc: 0.2950
 Site-Middle_Eastern           | Train Loss: 1.7816 | Train Acc: 0.3285
 Site-White                         | Val  Loss: 1.7754 | Val  Acc: 0.3370
 Site-White                         | Val  Loss: 1.6736 | Val  Acc: 0.3885
 Site-Latino_Hispanic               | Val  Loss: 1.7629 | Val  Acc: 0.3478
 Site-Latino_Hispanic               | Val  Loss: 1.7499 | Val  Acc: 0.3381
 Site-Black                         | Val  Loss: 1.7978 | Val  Acc: 0.3478
 Site-Black                         | Val  Loss: 1.7956 | Val  Acc: 0.3381
 Site-East_Asian                    | Val  Loss: 1.5569 | Val  Acc: 0.4891
 Site-East_Asian                    | Val  Loss: 1.6563 | Val  Acc: 0.4281
 Site-Indian                        | Val  Loss: 1.8636 | Val  Acc: 0.2500
 Site-Indian                        | Val  Loss: 1.8229 | Val  Acc: 0.2590
 Site-Southeast_Asian               | Val  Loss: 1.7886 | Val  Acc: 0.3370
 Site-Southeast_Asian               | Val  Loss: 1.7974 | Val  Acc: 0.3417
 Site-Middle_Eastern                | Val  Loss: 1.7232 | Val  Acc: 0.3913
 Site-Middle_Eastern                | Val  Loss: 1.7765 | Val  Acc: 0.3273
Average Valid Accuracy: 0.3515
 Test site-White                     (3)| Epoch:43 | Test Acc: 0.3610
 Test site-Latino_Hispanic           (5)| Epoch:43 | Test Acc: 0.3228
 Test site-Black                     (2)| Epoch:43 | Test Acc: 0.3250
 Test site-East_Asian                (6)| Epoch:43 | Test Acc: 0.5000
 Test site-Indian                    (4)| Epoch:43 | Test Acc: 0.3062
 Test site-Southeast_Asian           (0)| Epoch:43 | Test Acc: 0.4037
 Test site-Middle_Eastern            (1)| Epoch:43 | Test Acc: 0.3479
White: 0.3610, Latino_Hispanic: 0.3228, Black: 0.3250, East_Asian: 0.5000, Indian: 0.3062, Southeast_Asian: 0.4037, Middle_Eastern: 0.3479, 
Average Test Accuracy(group): 0.3667, Average Test Accuracy(individual): 0.3667,
domain std=0.0619, cluster std=0.0619, individual std=0.0619, 
Average Test Accuracy: 0.3667
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6791 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.6628 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.7064 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.7550 | Train Acc: 0.3333
 Site-Black                    | Train Loss: 1.8666 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.8067 | Train Acc: 0.3309
 Site-East_Asian               | Train Loss: 1.5826 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.6348 | Train Acc: 0.4508
 Site-Indian                   | Train Loss: 1.8198 | Train Acc: 0.3094
 Site-Indian                   | Train Loss: 1.8318 | Train Acc: 0.2734
 Site-Southeast_Asian          | Train Loss: 1.6972 | Train Acc: 0.3381
 Site-Southeast_Asian          | Train Loss: 1.7931 | Train Acc: 0.3429
 Site-Middle_Eastern           | Train Loss: 1.7659 | Train Acc: 0.3381
 Site-Middle_Eastern           | Train Loss: 1.7569 | Train Acc: 0.3237
 Site-White                         | Val  Loss: 1.7737 | Val  Acc: 0.3478
 Site-White                         | Val  Loss: 1.6769 | Val  Acc: 0.3669
 Site-Latino_Hispanic               | Val  Loss: 1.7490 | Val  Acc: 0.3696
 Site-Latino_Hispanic               | Val  Loss: 1.7387 | Val  Acc: 0.3381
 Site-Black                         | Val  Loss: 1.7838 | Val  Acc: 0.3696
 Site-Black                         | Val  Loss: 1.7926 | Val  Acc: 0.3417
 Site-East_Asian                    | Val  Loss: 1.5524 | Val  Acc: 0.4783
 Site-East_Asian                    | Val  Loss: 1.6506 | Val  Acc: 0.4532
 Site-Indian                        | Val  Loss: 1.8866 | Val  Acc: 0.2609
 Site-Indian                        | Val  Loss: 1.8149 | Val  Acc: 0.2770
 Site-Southeast_Asian               | Val  Loss: 1.7887 | Val  Acc: 0.3478
 Site-Southeast_Asian               | Val  Loss: 1.7990 | Val  Acc: 0.3381
 Site-Middle_Eastern                | Val  Loss: 1.7085 | Val  Acc: 0.3804
 Site-Middle_Eastern                | Val  Loss: 1.7715 | Val  Acc: 0.3345
Average Valid Accuracy: 0.3574
 Best site-White                         | Epoch:45 | Val Acc: 0.3478
 Best site-White                         | Epoch:45 | Val Acc: 0.3669
 Best site-Latino_Hispanic               | Epoch:45 | Val Acc: 0.3696
 Best site-Latino_Hispanic               | Epoch:45 | Val Acc: 0.3381
 Best site-Black                         | Epoch:45 | Val Acc: 0.3696
 Best site-Black                         | Epoch:45 | Val Acc: 0.3417
 Best site-East_Asian                    | Epoch:45 | Val Acc: 0.4783
 Best site-East_Asian                    | Epoch:45 | Val Acc: 0.4532
 Best site-Indian                        | Epoch:45 | Val Acc: 0.2609
 Best site-Indian                        | Epoch:45 | Val Acc: 0.2770
 Best site-Southeast_Asian               | Epoch:45 | Val Acc: 0.3478
 Best site-Southeast_Asian               | Epoch:45 | Val Acc: 0.3381
 Best site-Middle_Eastern                | Epoch:45 | Val Acc: 0.3804
 Best site-Middle_Eastern                | Epoch:45 | Val Acc: 0.3345
 Test site-White                     (6)| Epoch:45 | Test Acc: 0.3583
 Test site-Latino_Hispanic           (3)| Epoch:45 | Test Acc: 0.3228
 Test site-Black                     (2)| Epoch:45 | Test Acc: 0.3312
 Test site-East_Asian                (5)| Epoch:45 | Test Acc: 0.5065
 Test site-Indian                    (4)| Epoch:45 | Test Acc: 0.3134
 Test site-Southeast_Asian           (0)| Epoch:45 | Test Acc: 0.4074
 Test site-Middle_Eastern            (1)| Epoch:45 | Test Acc: 0.3479
White: 0.3583, Latino_Hispanic: 0.3228, Black: 0.3312, East_Asian: 0.5065, Indian: 0.3134, Southeast_Asian: 0.4074, Middle_Eastern: 0.3479, 
Average Test Accuracy(group): 0.3697, Average Test Accuracy(individual): 0.3697,
domain std=0.0628, cluster std=0.0628, individual std=0.0628, 
Average Test Accuracy: 0.3697
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 46 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6436 | Train Acc: 0.3957
 Site-White                    | Train Loss: 1.6621 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.7952 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.7551 | Train Acc: 0.3405
 Site-Black                    | Train Loss: 1.8453 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.8223 | Train Acc: 0.3309
 Site-East_Asian               | Train Loss: 1.6245 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.6270 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.8058 | Train Acc: 0.3022
 Site-Indian                   | Train Loss: 1.8237 | Train Acc: 0.2734
 Site-Southeast_Asian          | Train Loss: 1.7957 | Train Acc: 0.3381
 Site-Southeast_Asian          | Train Loss: 1.7993 | Train Acc: 0.3597
 Site-Middle_Eastern           | Train Loss: 1.7690 | Train Acc: 0.3237
 Site-Middle_Eastern           | Train Loss: 1.7689 | Train Acc: 0.3237
 Site-White                         | Val  Loss: 1.7798 | Val  Acc: 0.3478
 Site-White                         | Val  Loss: 1.6700 | Val  Acc: 0.3813
 Site-Latino_Hispanic               | Val  Loss: 1.7679 | Val  Acc: 0.3370
 Site-Latino_Hispanic               | Val  Loss: 1.7460 | Val  Acc: 0.3237
 Site-Black                         | Val  Loss: 1.7913 | Val  Acc: 0.3478
 Site-Black                         | Val  Loss: 1.7957 | Val  Acc: 0.3525
 Site-East_Asian                    | Val  Loss: 1.5725 | Val  Acc: 0.4891
 Site-East_Asian                    | Val  Loss: 1.6490 | Val  Acc: 0.4388
 Site-Indian                        | Val  Loss: 1.8616 | Val  Acc: 0.2391
 Site-Indian                        | Val  Loss: 1.8089 | Val  Acc: 0.2590
 Site-Southeast_Asian               | Val  Loss: 1.7846 | Val  Acc: 0.3587
 Site-Southeast_Asian               | Val  Loss: 1.7863 | Val  Acc: 0.3345
 Site-Middle_Eastern                | Val  Loss: 1.7271 | Val  Acc: 0.3804
 Site-Middle_Eastern                | Val  Loss: 1.7753 | Val  Acc: 0.3309
Average Valid Accuracy: 0.3515
 Test site-White                     (5)| Epoch:45 | Test Acc: 0.3636
 Test site-Latino_Hispanic           (6)| Epoch:45 | Test Acc: 0.3228
 Test site-Black                     (3)| Epoch:45 | Test Acc: 0.3344
 Test site-East_Asian                (4)| Epoch:45 | Test Acc: 0.5097
 Test site-Indian                    (0)| Epoch:45 | Test Acc: 0.3182
 Test site-Southeast_Asian           (1)| Epoch:45 | Test Acc: 0.4074
 Test site-Middle_Eastern            (2)| Epoch:45 | Test Acc: 0.3454
White: 0.3636, Latino_Hispanic: 0.3228, Black: 0.3344, East_Asian: 0.5097, Indian: 0.3182, Southeast_Asian: 0.4074, Middle_Eastern: 0.3454, 
Average Test Accuracy(group): 0.3716, Average Test Accuracy(individual): 0.3716,
domain std=0.0630, cluster std=0.0630, individual std=0.0630, 
Average Test Accuracy: 0.3716
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 47 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6091 | Train Acc: 0.3957
 Site-White                    | Train Loss: 1.6672 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.7561 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.7672 | Train Acc: 0.3429
 Site-Black                    | Train Loss: 1.8132 | Train Acc: 0.2950
 Site-Black                    | Train Loss: 1.8007 | Train Acc: 0.3285
 Site-East_Asian               | Train Loss: 1.5735 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.6222 | Train Acc: 0.4556
 Site-Indian                   | Train Loss: 1.8522 | Train Acc: 0.3022
 Site-Indian                   | Train Loss: 1.8275 | Train Acc: 0.2878
 Site-Southeast_Asian          | Train Loss: 1.7091 | Train Acc: 0.3453
 Site-Southeast_Asian          | Train Loss: 1.7882 | Train Acc: 0.3501
 Site-Middle_Eastern           | Train Loss: 1.7415 | Train Acc: 0.3094
 Site-Middle_Eastern           | Train Loss: 1.7572 | Train Acc: 0.3309
 Site-White                         | Val  Loss: 1.7742 | Val  Acc: 0.3587
 Site-White                         | Val  Loss: 1.6725 | Val  Acc: 0.3921
 Site-Latino_Hispanic               | Val  Loss: 1.7530 | Val  Acc: 0.3696
 Site-Latino_Hispanic               | Val  Loss: 1.7423 | Val  Acc: 0.3453
 Site-Black                         | Val  Loss: 1.7689 | Val  Acc: 0.3587
 Site-Black                         | Val  Loss: 1.7897 | Val  Acc: 0.3237
 Site-East_Asian                    | Val  Loss: 1.5709 | Val  Acc: 0.4891
 Site-East_Asian                    | Val  Loss: 1.6583 | Val  Acc: 0.4460
 Site-Indian                        | Val  Loss: 1.8696 | Val  Acc: 0.2500
 Site-Indian                        | Val  Loss: 1.8091 | Val  Acc: 0.2554
 Site-Southeast_Asian               | Val  Loss: 1.7858 | Val  Acc: 0.3587
 Site-Southeast_Asian               | Val  Loss: 1.7760 | Val  Acc: 0.3309
 Site-Middle_Eastern                | Val  Loss: 1.7233 | Val  Acc: 0.3696
 Site-Middle_Eastern                | Val  Loss: 1.7668 | Val  Acc: 0.3345
Average Valid Accuracy: 0.3559
 Test site-White                     (1)| Epoch:46 | Test Acc: 0.3636
 Test site-Latino_Hispanic           (6)| Epoch:46 | Test Acc: 0.3259
 Test site-Black                     (2)| Epoch:46 | Test Acc: 0.3375
 Test site-East_Asian                (5)| Epoch:46 | Test Acc: 0.5130
 Test site-Indian                    (3)| Epoch:46 | Test Acc: 0.3134
 Test site-Southeast_Asian           (0)| Epoch:46 | Test Acc: 0.4148
 Test site-Middle_Eastern            (4)| Epoch:46 | Test Acc: 0.3454
White: 0.3636, Latino_Hispanic: 0.3259, Black: 0.3375, East_Asian: 0.5130, Indian: 0.3134, Southeast_Asian: 0.4148, Middle_Eastern: 0.3454, 
Average Test Accuracy(group): 0.3734, Average Test Accuracy(individual): 0.3734,
domain std=0.0646, cluster std=0.0646, individual std=0.0646, 
Average Test Accuracy: 0.3734
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 48 ============
cnt=[2, 4, 2, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.5863 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.6630 | Train Acc: 0.4053
 Site-Latino_Hispanic          | Train Loss: 1.6876 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.7587 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.7607 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.8125 | Train Acc: 0.3357
 Site-East_Asian               | Train Loss: 1.6674 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.6185 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.7257 | Train Acc: 0.3094
 Site-Indian                   | Train Loss: 1.8140 | Train Acc: 0.2710
 Site-Southeast_Asian          | Train Loss: 1.8674 | Train Acc: 0.3597
 Site-Southeast_Asian          | Train Loss: 1.7857 | Train Acc: 0.3453
 Site-Middle_Eastern           | Train Loss: 1.8106 | Train Acc: 0.3165
 Site-Middle_Eastern           | Train Loss: 1.7636 | Train Acc: 0.3357
 Site-White                         | Val  Loss: 1.7597 | Val  Acc: 0.3478
 Site-White                         | Val  Loss: 1.6713 | Val  Acc: 0.4029
 Site-Latino_Hispanic               | Val  Loss: 1.7390 | Val  Acc: 0.3804
 Site-Latino_Hispanic               | Val  Loss: 1.7386 | Val  Acc: 0.3525
 Site-Black                         | Val  Loss: 1.7891 | Val  Acc: 0.3587
 Site-Black                         | Val  Loss: 1.7747 | Val  Acc: 0.3381
 Site-East_Asian                    | Val  Loss: 1.5629 | Val  Acc: 0.4674
 Site-East_Asian                    | Val  Loss: 1.6419 | Val  Acc: 0.4460
 Site-Indian                        | Val  Loss: 1.8530 | Val  Acc: 0.2500
 Site-Indian                        | Val  Loss: 1.8080 | Val  Acc: 0.2698
 Site-Southeast_Asian               | Val  Loss: 1.7791 | Val  Acc: 0.3804
 Site-Southeast_Asian               | Val  Loss: 1.7787 | Val  Acc: 0.3417
 Site-Middle_Eastern                | Val  Loss: 1.7149 | Val  Acc: 0.3696
 Site-Middle_Eastern                | Val  Loss: 1.7701 | Val  Acc: 0.3237
Average Valid Accuracy: 0.3592
 Best site-White                         | Epoch:48 | Val Acc: 0.3478
 Best site-White                         | Epoch:48 | Val Acc: 0.4029
 Best site-Latino_Hispanic               | Epoch:48 | Val Acc: 0.3804
 Best site-Latino_Hispanic               | Epoch:48 | Val Acc: 0.3525
 Best site-Black                         | Epoch:48 | Val Acc: 0.3587
 Best site-Black                         | Epoch:48 | Val Acc: 0.3381
 Best site-East_Asian                    | Epoch:48 | Val Acc: 0.4674
 Best site-East_Asian                    | Epoch:48 | Val Acc: 0.4460
 Best site-Indian                        | Epoch:48 | Val Acc: 0.2500
 Best site-Indian                        | Epoch:48 | Val Acc: 0.2698
 Best site-Southeast_Asian               | Epoch:48 | Val Acc: 0.3804
 Best site-Southeast_Asian               | Epoch:48 | Val Acc: 0.3417
 Best site-Middle_Eastern                | Epoch:48 | Val Acc: 0.3696
 Best site-Middle_Eastern                | Epoch:48 | Val Acc: 0.3237
 Test site-White                     (5)| Epoch:48 | Test Acc: 0.3610
 Test site-Latino_Hispanic           (1)| Epoch:48 | Test Acc: 0.3291
 Test site-Black                     (3)| Epoch:48 | Test Acc: 0.3406
 Test site-East_Asian                (2)| Epoch:48 | Test Acc: 0.5130
 Test site-Indian                    (0)| Epoch:48 | Test Acc: 0.3254
 Test site-Southeast_Asian           (6)| Epoch:48 | Test Acc: 0.4148
 Test site-Middle_Eastern            (1)| Epoch:48 | Test Acc: 0.3454
White: 0.3610, Latino_Hispanic: 0.3291, Black: 0.3406, East_Asian: 0.5130, Indian: 0.3254, Southeast_Asian: 0.4148, Middle_Eastern: 0.3454, 
Average Test Accuracy(group): 0.3756, Average Test Accuracy(individual): 0.3756,
domain std=0.0626, cluster std=nan, individual std=0.0626, 
Average Test Accuracy: 0.3756
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7068 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.6516 | Train Acc: 0.4077
 Site-Latino_Hispanic          | Train Loss: 1.7869 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.7523 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.7745 | Train Acc: 0.2878
 Site-Black                    | Train Loss: 1.8090 | Train Acc: 0.3549
 Site-East_Asian               | Train Loss: 1.5967 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.6157 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.8069 | Train Acc: 0.2734
 Site-Indian                   | Train Loss: 1.8145 | Train Acc: 0.3022
 Site-Southeast_Asian          | Train Loss: 1.8318 | Train Acc: 0.3669
 Site-Southeast_Asian          | Train Loss: 1.7712 | Train Acc: 0.3669
 Site-Middle_Eastern           | Train Loss: 1.8095 | Train Acc: 0.3237
 Site-Middle_Eastern           | Train Loss: 1.7496 | Train Acc: 0.3549
 Site-White                         | Val  Loss: 1.7605 | Val  Acc: 0.4022
 Site-White                         | Val  Loss: 1.6542 | Val  Acc: 0.3885
 Site-Latino_Hispanic               | Val  Loss: 1.7423 | Val  Acc: 0.3696
 Site-Latino_Hispanic               | Val  Loss: 1.7386 | Val  Acc: 0.3561
 Site-Black                         | Val  Loss: 1.7794 | Val  Acc: 0.3913
 Site-Black                         | Val  Loss: 1.7838 | Val  Acc: 0.3345
 Site-East_Asian                    | Val  Loss: 1.5626 | Val  Acc: 0.5109
 Site-East_Asian                    | Val  Loss: 1.6456 | Val  Acc: 0.4568
 Site-Indian                        | Val  Loss: 1.8359 | Val  Acc: 0.2935
 Site-Indian                        | Val  Loss: 1.7963 | Val  Acc: 0.2806
 Site-Southeast_Asian               | Val  Loss: 1.7713 | Val  Acc: 0.3696
 Site-Southeast_Asian               | Val  Loss: 1.7818 | Val  Acc: 0.3597
 Site-Middle_Eastern                | Val  Loss: 1.7001 | Val  Acc: 0.3804
 Site-Middle_Eastern                | Val  Loss: 1.7583 | Val  Acc: 0.3417
Average Valid Accuracy: 0.3740
 Best site-White                         | Epoch:49 | Val Acc: 0.4022
 Best site-White                         | Epoch:49 | Val Acc: 0.3885
 Best site-Latino_Hispanic               | Epoch:49 | Val Acc: 0.3696
 Best site-Latino_Hispanic               | Epoch:49 | Val Acc: 0.3561
 Best site-Black                         | Epoch:49 | Val Acc: 0.3913
 Best site-Black                         | Epoch:49 | Val Acc: 0.3345
 Best site-East_Asian                    | Epoch:49 | Val Acc: 0.5109
 Best site-East_Asian                    | Epoch:49 | Val Acc: 0.4568
 Best site-Indian                        | Epoch:49 | Val Acc: 0.2935
 Best site-Indian                        | Epoch:49 | Val Acc: 0.2806
 Best site-Southeast_Asian               | Epoch:49 | Val Acc: 0.3696
 Best site-Southeast_Asian               | Epoch:49 | Val Acc: 0.3597
 Best site-Middle_Eastern                | Epoch:49 | Val Acc: 0.3804
 Best site-Middle_Eastern                | Epoch:49 | Val Acc: 0.3417
 Test site-White                     (5)| Epoch:49 | Test Acc: 0.3636
 Test site-Latino_Hispanic           (0)| Epoch:49 | Test Acc: 0.3323
 Test site-Black                     (2)| Epoch:49 | Test Acc: 0.3406
 Test site-East_Asian                (1)| Epoch:49 | Test Acc: 0.5130
 Test site-Indian                    (4)| Epoch:49 | Test Acc: 0.3278
 Test site-Southeast_Asian           (6)| Epoch:49 | Test Acc: 0.4185
 Test site-Middle_Eastern            (3)| Epoch:49 | Test Acc: 0.3454
White: 0.3636, Latino_Hispanic: 0.3323, Black: 0.3406, East_Asian: 0.5130, Indian: 0.3278, Southeast_Asian: 0.4185, Middle_Eastern: 0.3454, 
Average Test Accuracy(group): 0.3773, Average Test Accuracy(individual): 0.3773,
domain std=0.0623, cluster std=0.0623, individual std=0.0623, 
Average Test Accuracy: 0.3773
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ablation...
 Test site-White                     (5)| Epoch:49 | Test Acc: 0.3636
 Test site-Latino_Hispanic           (0)| Epoch:49 | Test Acc: 0.3323
 Test site-Black                     (2)| Epoch:49 | Test Acc: 0.3406
 Test site-East_Asian                (1)| Epoch:49 | Test Acc: 0.5130
 Test site-Indian                    (4)| Epoch:49 | Test Acc: 0.3278
 Test site-Southeast_Asian           (6)| Epoch:49 | Test Acc: 0.4185
 Test site-Middle_Eastern            (3)| Epoch:49 | Test Acc: 0.3454
White: 0.3636, Latino_Hispanic: 0.3323, Black: 0.3406, East_Asian: 0.5130, Indian: 0.3278, Southeast_Asian: 0.4185, Middle_Eastern: 0.3454, 
Average Test Accuracy(group): 0.3773, Average Test Accuracy(individual): 0.3773,
domain std=0.0623, cluster std=0.0623, individual std=0.0623, 
===2023-06-08 17:55:03===
===2023-06-08 17:55:19===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
domain number = 7
Loading snapshots...
 Test site-White                     | Epoch:49 | Test Acc: 0.3636
 Test site-Latino_Hispanic           | Epoch:49 | Test Acc: 0.3323
 Test site-Black                     | Epoch:49 | Test Acc: 0.3406
 Test site-East_Asian                | Epoch:49 | Test Acc: 0.5130
 Test site-Indian                    | Epoch:49 | Test Acc: 0.3278
 Test site-Southeast_Asian           | Epoch:49 | Test Acc: 0.4185
 Test site-Middle_Eastern            | Epoch:49 | Test Acc: 0.3454
White: 0.3636, Latino_Hispanic: 0.3323, Black: 0.3406, East_Asian: 0.5130, Indian: 0.3278, Southeast_Asian: 0.4185, Middle_Eastern: 0.3454, 
Average Test Accuracy(group): 0.3773, Average Test Accuracy(individual): 0.3773,
domain std=0.0623, cluster std=-1.0000, individual std=0.0623, 
