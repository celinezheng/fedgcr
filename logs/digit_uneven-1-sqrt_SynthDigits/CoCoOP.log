===2023-03-30 04:25:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8338 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.7604 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.7460 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 1.6860 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 2.1996 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1529 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1885 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0878 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.8407 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.2409 | Train Acc: 0.1705
 Site-MNIST     | Val  Loss: 1.6835 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7555 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.7994 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7470 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.0891 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.2422 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1351 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2242 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.8198 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 2.2417 | Val  Acc: 0.1695
Average Valid Accuracy: 0.3763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4285 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.3415 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.3660 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.2540 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.1415 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.0858 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1047 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.9809 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 1.4838 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 2.1343 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.2887 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.3698 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.4039 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.3150 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.9641 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 2.1845 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0555 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1571 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.4939 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 2.1262 | Val  Acc: 0.2034
Average Valid Accuracy: 0.4949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1296 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.0277 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.0825 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.9706 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 2.1171 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0099 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0249 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.9102 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 1.2046 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 2.0050 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 0.9908 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0747 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1157 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.0201 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.8839 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 2.1164 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 1.9947 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0874 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.2351 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 2.0403 | Val  Acc: 0.3051
Average Valid Accuracy: 0.5542
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8867 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.8419 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.8775 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.7825 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 2.0484 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9530 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9557 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8453 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 1.0152 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.9138 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 0.7937 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8790 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.9183 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.8286 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8072 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 2.0603 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.9610 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.0274 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.0478 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 1.9674 | Val  Acc: 0.3051
Average Valid Accuracy: 0.5847
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-USPS       | Epoch:3 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7533 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.7208 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.7252 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6520 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.9942 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.8866 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.9012 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.7520 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.8924 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.8607 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 0.6598 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.7420 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7753 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6994 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.7296 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.9934 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.9156 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.9664 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.9196 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 1.8989 | Val  Acc: 0.3559
Average Valid Accuracy: 0.6102
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2712
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6569 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6190 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.6385 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.5344 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.9732 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8540 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.8201 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7437 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.7711 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 1.7865 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 0.5593 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6441 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6669 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6051 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.6844 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.9453 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.8865 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.9135 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.7999 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 1.8260 | Val  Acc: 0.3898
Average Valid Accuracy: 0.6288
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2542
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5662 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5116 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.5445 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4805 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.9356 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.7791 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7472 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6808 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.7018 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 1.7004 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 0.4804 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5692 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5797 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5342 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.6097 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.8999 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.8252 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8590 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.7146 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 1.7738 | Val  Acc: 0.4068
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2542
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5014 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.4972 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4773 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3870 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8670 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.7373 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.6948 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.6688 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.6454 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 1.6178 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 0.4104 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4919 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4933 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4770 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.5543 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.8626 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.7886 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7896 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.6422 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 1.7203 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2881
 Best site-USPS       | Epoch:7 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4135 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4072 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4237 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3217 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8716 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.7039 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.6781 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.5767 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.6020 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.5537 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 0.3443 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4249 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4111 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4163 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.4951 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.8170 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.7572 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7092 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.5867 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 1.6660 | Val  Acc: 0.4915
Average Valid Accuracy: 0.6763
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3220
 Best site-USPS       | Epoch:8 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3685 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3275 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3785 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2697 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7399 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.6624 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.6013 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.5548 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.5174 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.4780 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.2921 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3796 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3492 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3704 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.4284 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.7597 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.7061 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6528 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.5485 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 1.6049 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6881
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3559
 Best site-USPS       | Epoch:9 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SynthDigits...
===2023-03-30 04:57:55===
===2023-03-30 04:57:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SynthDigits: 0.4200
Average Test Accuracy: 0.4200
