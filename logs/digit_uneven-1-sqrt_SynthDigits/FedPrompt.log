===2023-03-30 01:36:34===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7771 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.6743 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.6896 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.6014 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2203 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1562 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1682 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0942 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 1.8126 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 2.2125 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.6148 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.7020 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7355 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.6700 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 2.0761 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.2294 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1343 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2113 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.7777 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 2.2366 | Val  Acc: 0.1695
Average Valid Accuracy: 0.4034
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2241 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.1671 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.1883 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.0785 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.1864 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0508 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0687 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9449 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 1.3367 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 2.0862 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.0984 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1777 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2271 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.1277 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.9409 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.1362 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0428 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.1187 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.3830 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 2.1220 | Val  Acc: 0.2034
Average Valid Accuracy: 0.5000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8381 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.7952 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.7906 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.7162 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 2.0883 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 1.9130 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.9415 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7665 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 1.0061 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.8587 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 0.7147 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7851 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8700 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.7363 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.7628 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 2.0292 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.9142 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 2.0088 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.0501 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 1.9066 | Val  Acc: 0.2881
Average Valid Accuracy: 0.5695
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5983 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.5440 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.5684 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4723 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.8879 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.8039 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7232 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.6910 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.6777 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 1.7065 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 0.4776 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5641 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5912 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.5273 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.5783 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.7902 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7466 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.9225 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 0.7450 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 1.7789 | Val  Acc: 0.3559
Average Valid Accuracy: 0.6271
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2034
 Best site-USPS       | Epoch:3 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3281 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3077 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3130 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.2487 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7228 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.5677 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.4775 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.4583 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.4344 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.4600 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.2464 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3346 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.3489 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3112 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.3980 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.5978 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5966 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6796 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.4608 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 1.5797 | Val  Acc: 0.4746
Average Valid Accuracy: 0.7169
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:4 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4576
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2769 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2422 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2437 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.1944 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5235 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.3734 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.3263 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 1.3405 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.3473 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 1.2697 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.1931 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2675 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2584 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2454 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.2215 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.4420 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.3463 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.5048 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.3638 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 1.4742 | Val  Acc: 0.5085
Average Valid Accuracy: 0.7576
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4915
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1691 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1614 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1623 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1194 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.3131 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.2549 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 1.1542 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 1.2248 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.2992 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.9439 | Train Acc: 0.7500
 Site-MNIST     | Val  Loss: 0.1160 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1791 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1754 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1536 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.1210 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.1889 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.3148 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.3287 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 0.2748 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 1.2745 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7932
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6271
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1808 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1422 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1631 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1140 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.0845 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 0.9504 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 0.9683 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.0450 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.1787 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.7749 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.1216 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1747 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1500 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1482 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8989 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.0444 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 0.9263 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.0578 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 0.2067 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 1.1811 | Val  Acc: 0.6780
Average Valid Accuracy: 0.8441
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7119
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1073 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0828 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0794 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0582 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9388 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 0.8195 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 0.7635 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.8898 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 0.1444 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.5434 | Train Acc: 0.8636
 Site-MNIST     | Val  Loss: 0.0571 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0887 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0872 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0926 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7992 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 0.7970 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 0.8373 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.9427 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 0.2079 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 1.0517 | Val  Acc: 0.7119
Average Valid Accuracy: 0.8729
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6949
 Best site-USPS       | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.7119
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0896 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0635 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0597 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0380 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7702 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 0.6174 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 0.6298 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 0.6376 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.0920 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.4455 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.0417 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0696 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0789 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.5754 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.7297 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.6580 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 0.6697 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.1876 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 1.0043 | Val  Acc: 0.7627
Average Valid Accuracy: 0.9153
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8475
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SynthDigits...
===2023-03-30 02:10:18===
===2023-03-30 02:10:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SynthDigits: 0.4087
Average Test Accuracy: 0.4087
