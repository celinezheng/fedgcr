===2023-03-25 19:34:05===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7063 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.6605 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.6830 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.5730 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6779 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2348 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.2077 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7275 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 2.1380 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2071 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.5665 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.5948 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6504 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.6882 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.6271 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 2.1871 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2289 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.7463 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1168 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2259 | Val  Acc: 0.1525
Average Valid Accuracy: 0.4627
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2644 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.2019 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.2184 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1462 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 1.2251 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1671 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1224 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.3184 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 1.9565 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.0977 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.0981 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.1720 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2307 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2681 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1710 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.1266 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1254 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.3707 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9299 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1162 | Val  Acc: 0.1525
Average Valid Accuracy: 0.5729
 Best site-MNIST      | Epoch:1 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-USPS       | Epoch:1 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8623 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.8167 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.8045 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.7453 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.8345 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.1111 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0002 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.0173 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8112 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.9507 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 0.6873 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.7466 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8336 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.8833 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.7637 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0920 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.9693 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.0713 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.7643 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 1.9657 | Val  Acc: 0.2712
Average Valid Accuracy: 0.6203
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2712
 Best site-USPS       | Epoch:2 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6091 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6422 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6229 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5239 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5935 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9591 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.8768 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.7929 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.6759 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.7911 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 0.4896 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5377 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6234 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6476 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5592 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9472 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8560 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.8266 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6011 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 1.8289 | Val  Acc: 0.4068
Average Valid Accuracy: 0.6661
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2712
 Best site-USPS       | Epoch:3 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4285 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.3975 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3906 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3107 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.4216 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.8774 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7757 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.6470 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.5246 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.6051 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.3000 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3182 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4035 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4369 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4006 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8657 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.7138 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.7160 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.5541 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.7203 | Val  Acc: 0.4237
Average Valid Accuracy: 0.6932
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-USPS       | Epoch:4 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3288 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3762 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3744 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2966 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3342 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.7439 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.6102 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.5683 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.1787 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.4380 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.2886 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3163 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3780 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.4107 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3273 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.6694 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6132 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.5444 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.3825 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5703 | Val  Acc: 0.5085
Average Valid Accuracy: 0.7492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4576
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2307 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2303 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2406 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1503 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2231 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.5204 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.5039 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.4022 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.1726 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.2289 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.1610 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1713 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2293 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2491 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2154 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.5910 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.4461 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.4530 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.3683 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.4287 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7627
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4746
 Best site-USPS       | Epoch:6 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2056 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.1826 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1881 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1032 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1624 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.3480 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.2743 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 0.3196 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.9415 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 0.9322 | Train Acc: 0.7727
 Site-MNIST     | Val  Loss: 0.1119 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1369 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1845 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1988 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1646 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.3720 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.2397 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.3676 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.2165 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.2628 | Val  Acc: 0.6441
Average Valid Accuracy: 0.8136
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5763
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1340 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1382 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1574 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0740 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1068 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1826 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.1139 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.2525 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.6601 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.7509 | Train Acc: 0.8409
 Site-MNIST     | Val  Loss: 0.0871 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0984 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1450 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1546 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1156 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.2228 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 0.9789 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 0.2882 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0617 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.1659 | Val  Acc: 0.6949
Average Valid Accuracy: 0.8407
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6610
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1162 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1033 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1055 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0500 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0844 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.9951 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 0.9144 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 0.2140 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.6410 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.5725 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0758 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1067 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1176 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0927 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.0103 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 0.8203 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.2757 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0550 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.0248 | Val  Acc: 0.7797
Average Valid Accuracy: 0.8780
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8136
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.7797
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
===2023-03-25 20:08:41===
===2023-03-25 20:08:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8964
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3290
 Test site-USPS      | Epoch:9 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5382
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4093
Average Test Accuracy: 0.6098
===2023-03-29 00:18:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6926 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.6527 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6700 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.5637 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.6667 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.2309 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.2004 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7289 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 2.1422 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2029 | Train Acc: 0.1932
 Site-MNIST     | Val  Loss: 1.5600 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.5836 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6397 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6802 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6168 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1803 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2249 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.7384 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1124 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2295 | Val  Acc: 0.1525
Average Valid Accuracy: 0.4627
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1881 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.1137 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.1433 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.0638 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1582 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.1672 | Train Acc: 0.1705
 Site-SVHN      | Train Loss: 2.0962 | Train Acc: 0.2045
 Site-USPS      | Train Loss: 1.2443 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.9231 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.0773 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 0.9924 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0999 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.1584 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1857 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.0873 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.0976 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.1199 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.3131 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.8934 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1146 | Val  Acc: 0.1695
Average Valid Accuracy: 0.5475
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7596 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.6846 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6727 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6220 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.7284 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.1393 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 1.9220 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.8328 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.7294 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.9894 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 0.5717 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6216 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.7155 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.7367 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6742 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.9974 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.9921 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.8692 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.7524 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0149 | Val  Acc: 0.3220
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-USPS       | Epoch:2 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4572 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.4861 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4605 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3795 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4967 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.8953 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.7631 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.5930 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6401 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.8098 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 0.3361 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4010 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4440 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4629 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.4557 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.8325 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7818 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6930 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6528 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9105 | Val  Acc: 0.2881
Average Valid Accuracy: 0.6627
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-USPS       | Epoch:3 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2831 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2726 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2689 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2133 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.3015 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.7649 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6174 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.4403 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.3702 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.6404 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.2094 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2116 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2758 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2750 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3045 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.6778 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.6191 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.5037 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.5461 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8178 | Val  Acc: 0.3898
Average Valid Accuracy: 0.7305
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4237
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2022 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1964 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1935 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1530 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1974 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.6090 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.4031 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.3975 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.0353 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.3959 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.1563 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1546 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1981 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1936 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2143 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.4722 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.4017 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.4210 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.3696 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6565 | Val  Acc: 0.4407
Average Valid Accuracy: 0.7746
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5254
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1395 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1353 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1532 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0928 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1311 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.3290 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.1784 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.2707 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.9361 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.0179 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.1025 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1028 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1372 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1457 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1377 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.2752 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.1507 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 0.3172 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2759 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.5184 | Val  Acc: 0.5254
Average Valid Accuracy: 0.8102
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6441
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1209 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0822 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1035 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0556 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0968 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1057 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 0.9769 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 0.2154 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.7348 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7201 | Train Acc: 0.7841
 Site-MNIST     | Val  Loss: 0.0636 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0675 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1046 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0789 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1051 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.0724 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 0.9522 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 0.2804 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1165 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.2690 | Val  Acc: 0.5424
Average Valid Accuracy: 0.8271
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6441
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0733 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0624 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0741 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0341 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0579 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8960 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 0.7745 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 0.1981 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.5440 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.6222 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.0387 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0460 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0717 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0665 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0736 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.8354 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.7573 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.2692 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.0732 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.2665 | Val  Acc: 0.5932
Average Valid Accuracy: 0.8678
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-USPS       | Epoch:8 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0542 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0406 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0508 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0285 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0458 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8054 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 0.6315 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.1100 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.4740 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.4417 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.0329 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0292 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0600 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0407 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0554 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6949 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.6275 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.2241 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.9681 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.1230 | Val  Acc: 0.6780
Average Valid Accuracy: 0.8864
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7966
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/FedPrompt...
===2023-03-29 00:52:31===
===2023-03-29 00:52:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8986
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3194
 Test site-USPS      | Epoch:9 | Test Acc: 0.8602
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5462
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3821
Average Test Accuracy: 0.6013
