===2023-03-28 22:25:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7419 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.6236 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.6321 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.5911 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6869 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2406 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1826 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.7323 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1134 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2136 | Train Acc: 0.1705
 Site-MNIST     | Val  Loss: 1.5771 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.6023 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.6528 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6845 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6301 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.1961 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.2268 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7409 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1181 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.1981 | Val  Acc: 0.1525
Average Valid Accuracy: 0.4576
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3110 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.2726 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.2708 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.1639 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.2755 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1623 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1078 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.3746 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.9600 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.1016 | Train Acc: 0.1932
 Site-MNIST     | Val  Loss: 1.1571 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.2104 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.2673 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.3046 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.2124 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.1173 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1462 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.3997 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 1.9395 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0875 | Val  Acc: 0.1864
Average Valid Accuracy: 0.5458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0323 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.9910 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.0411 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.9210 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.9956 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.1137 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0799 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.1540 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.8627 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.0159 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 0.8958 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.9568 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0164 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.0586 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.9498 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.0743 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0891 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.1768 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.8171 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0102 | Val  Acc: 0.2034
Average Valid Accuracy: 0.6034
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1864
 Best site-USPS       | Epoch:2 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8228 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.7919 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.8133 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.7095 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.8295 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 2.0935 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9978 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.0392 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7373 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.9139 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 0.7028 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.7516 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8161 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8593 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7483 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.0342 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0412 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.0204 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7256 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9395 | Val  Acc: 0.2373
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6851 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6964 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.6862 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.6005 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.6989 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 2.0140 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9688 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.8574 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.6838 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.8488 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 0.5709 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.6252 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6805 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.7255 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6280 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.9947 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0016 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.9152 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6546 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8844 | Val  Acc: 0.3051
Average Valid Accuracy: 0.6763
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.5954 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5659 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.6197 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4981 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.5874 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 2.0074 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9330 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.8309 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.5885 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.7679 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 0.4785 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5200 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.5816 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6133 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5375 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.9574 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9629 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.8205 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.5853 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8245 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6949
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5047 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5086 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.5189 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4436 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.5024 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.9533 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8929 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.7559 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.5734 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.7117 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.4213 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4617 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5086 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.5358 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4761 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.9246 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9233 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.7561 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.5436 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7738 | Val  Acc: 0.3898
Average Valid Accuracy: 0.7102
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2881
 Best site-USPS       | Epoch:6 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4546 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4536 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4753 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3549 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.4413 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.9226 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8490 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.6870 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4973 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.6505 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.3675 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3971 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4544 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4796 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.4301 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8932 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8941 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.7048 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.4796 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7307 | Val  Acc: 0.4068
Average Valid Accuracy: 0.7220
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3220
 Best site-USPS       | Epoch:7 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4038 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3857 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4211 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3322 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.4230 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.8877 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8048 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.6168 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4638 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.6090 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.3198 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3589 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4028 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4173 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3761 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8641 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8642 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6478 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.4411 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6817 | Val  Acc: 0.4576
Average Valid Accuracy: 0.7305
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3220
 Best site-USPS       | Epoch:8 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3727 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3621 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3845 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2733 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.3783 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.9389 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7971 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.6004 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.3266 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.5762 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.2971 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3215 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3617 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3843 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3546 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8351 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.8348 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6343 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.3890 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6478 | Val  Acc: 0.4915
Average Valid Accuracy: 0.7373
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3220
 Best site-USPS       | Epoch:9 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/DoPrompt...
===2023-03-28 22:59:19===
===2023-03-28 22:59:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8564
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2791
 Test site-USPS      | Epoch:9 | Test Acc: 0.8441
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4668
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3729
Average Test Accuracy: 0.5639
