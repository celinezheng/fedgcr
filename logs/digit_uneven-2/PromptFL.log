===2023-03-25 20:12:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2299 | Train Acc: 0.2614
 Site-MNIST     | Train Loss: 2.2091 | Train Acc: 0.4205
 Site-MNIST     | Train Loss: 2.2357 | Train Acc: 0.1818
 Site-MNIST     | Train Loss: 2.2218 | Train Acc: 0.3182
 Site-MNIST     | Train Loss: 2.2306 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.2784 | Train Acc: 0.1364
 Site-SVHN      | Train Loss: 2.2795 | Train Acc: 0.1136
 Site-USPS      | Train Loss: 2.2308 | Train Acc: 0.3750
 Site-SynthDigits| Train Loss: 2.2917 | Train Acc: 0.1705
 Site-MNIST-M   | Train Loss: 2.2873 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 2.2205 | Val  Acc: 0.3390
 Site-MNIST     | Val  Loss: 2.2251 | Val  Acc: 0.3220
 Site-MNIST     | Val  Loss: 2.2400 | Val  Acc: 0.1017
 Site-MNIST     | Val  Loss: 2.2254 | Val  Acc: 0.3729
 Site-MNIST     | Val  Loss: 2.1952 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 2.2892 | Val  Acc: 0.0678
 Site-SVHN      | Val  Loss: 2.2711 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 2.2468 | Val  Acc: 0.3051
 Site-SynthDigits| Val  Loss: 2.2966 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 2.2953 | Val  Acc: 0.1525
Average Valid Accuracy: 0.2458
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3390
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3729
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0678
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.3051
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.1572 | Train Acc: 0.3636
 Site-MNIST     | Train Loss: 2.1279 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 2.1619 | Train Acc: 0.3864
 Site-MNIST     | Train Loss: 2.1395 | Train Acc: 0.4432
 Site-MNIST     | Train Loss: 2.1733 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 2.2677 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.2677 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 2.1682 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.2841 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.2715 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 2.1355 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 2.1406 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.1745 | Val  Acc: 0.3390
 Site-MNIST     | Val  Loss: 2.1494 | Val  Acc: 0.4237
 Site-MNIST     | Val  Loss: 2.1139 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2698 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.2622 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 2.1862 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 2.2922 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 2.2835 | Val  Acc: 0.2034
Average Valid Accuracy: 0.3373
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4237
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-USPS       | Epoch:1 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.0953 | Train Acc: 0.4091
 Site-MNIST     | Train Loss: 2.0516 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 2.0927 | Train Acc: 0.4432
 Site-MNIST     | Train Loss: 2.0639 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 2.1149 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 2.2480 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2540 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 2.1097 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 2.2689 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.2592 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 2.0548 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 2.0613 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.1096 | Val  Acc: 0.4237
 Site-MNIST     | Val  Loss: 2.0765 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 2.0353 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 2.2529 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.2549 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.1302 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 2.2850 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2720 | Val  Acc: 0.2203
Average Valid Accuracy: 0.3678
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-USPS       | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.0252 | Train Acc: 0.3977
 Site-MNIST     | Train Loss: 1.9699 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 2.0241 | Train Acc: 0.4545
 Site-MNIST     | Train Loss: 1.9793 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 2.0447 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 2.2374 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2428 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 2.0313 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2577 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2508 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 1.9767 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.9875 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.0478 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.0069 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.9575 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2384 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2497 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.0781 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 2.2747 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2616 | Val  Acc: 0.2373
Average Valid Accuracy: 0.3780
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2542
 Best site-USPS       | Epoch:3 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 1.9763 | Train Acc: 0.4205
 Site-MNIST     | Train Loss: 1.9135 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.9603 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.9148 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.9806 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 2.2257 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2376 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.9844 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2389 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2371 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 1.9058 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.9176 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 1.9891 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.9426 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.8863 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 2.2263 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2437 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.0273 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.2638 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2521 | Val  Acc: 0.2373
Average Valid Accuracy: 0.3949
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 1.8871 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 1.8100 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.8915 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.8580 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.9158 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 2.2239 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.2151 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.9481 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2364 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2319 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.8389 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.8534 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.9329 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.8833 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.8200 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 2.2151 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2376 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.9801 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.2512 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2423 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4254
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 1.8675 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.7701 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.8408 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.7907 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.8707 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 2.2116 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.2161 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.9223 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 2.2117 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2168 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 1.7752 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.7927 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.8789 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.8283 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7605 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 2.2047 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2315 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.9372 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.2384 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2335 | Val  Acc: 0.3390
Average Valid Accuracy: 0.4492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2712
 Best site-USPS       | Epoch:6 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.8184 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.7361 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.8114 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.7297 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.8083 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 2.2091 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.2065 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.8399 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 2.1933 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2127 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.7167 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7372 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.8298 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.7773 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7046 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.1947 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2253 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.8942 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.2263 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2234 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4712
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2881
 Best site-USPS       | Epoch:7 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.7349 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.6768 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.7385 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.6974 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.8013 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 2.1912 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1899 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.8234 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1868 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1964 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.6598 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6819 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.7811 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7259 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.6503 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.1857 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2193 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.8559 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.2129 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2138 | Val  Acc: 0.3390
Average Valid Accuracy: 0.4932
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3051
 Best site-USPS       | Epoch:8 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.7004 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6285 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.7057 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.6242 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.7450 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 2.1851 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1782 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.7831 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1626 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1837 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.6063 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.6301 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.7323 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6768 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.5981 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1774 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2140 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.8180 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1999 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2040 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5051
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3051
 Best site-USPS       | Epoch:9 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/PromptFL...
===2023-03-25 20:27:03===
===2023-03-25 20:27:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.5243
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2005
 Test site-USPS      | Epoch:9 | Test Acc: 0.6559
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.2786
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2086
Average Test Accuracy: 0.3736
