===2023-03-28 20:34:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7379 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.6593 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.6676 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6006 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6885 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2471 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1849 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.7474 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 2.1252 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.2140 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.6039 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.6194 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6688 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6992 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.6521 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1919 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.2303 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.7635 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1257 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2212 | Val  Acc: 0.1356
Average Valid Accuracy: 0.4593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2797 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.2045 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2267 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1255 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.2418 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.1382 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0998 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.3495 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.9601 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.0983 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 1.1258 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.1747 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2161 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.2717 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.1695 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.1001 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1447 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.4085 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 1.9503 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0951 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5559
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1525
 Best site-USPS       | Epoch:1 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9686 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.9075 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9230 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.8454 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.9443 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.1062 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 1.9975 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1237 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8074 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9645 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 0.8292 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.8637 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.9117 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.9823 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8841 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0499 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0729 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.1622 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.8079 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0096 | Val  Acc: 0.2542
Average Valid Accuracy: 0.6186
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7423 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.7312 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.7415 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6732 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.7504 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 2.0288 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 1.9913 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.9436 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7332 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.8747 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 0.6478 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.6757 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7381 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7932 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7134 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 2.0143 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.0116 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 0.9829 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7047 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.9176 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6525
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2034
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6197 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6184 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.6006 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5510 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.5989 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0197 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 1.9265 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 0.8283 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.6402 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.7888 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 0.5333 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.5479 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6138 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6609 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5911 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.9805 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9543 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.8567 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6259 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8419 | Val  Acc: 0.3729
Average Valid Accuracy: 0.6763
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2373
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.5302 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5326 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5240 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4443 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.5569 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.9885 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.9019 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.7292 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.5388 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.7295 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 0.4500 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4613 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5274 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5623 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5100 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.9355 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.8960 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.7635 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.5607 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7841 | Val  Acc: 0.4068
Average Valid Accuracy: 0.6915
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.4568 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4390 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4471 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4019 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.4759 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.9616 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8114 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6604 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.4413 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.6382 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 0.3860 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4040 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4654 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4882 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4507 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8857 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.8392 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.7012 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.4971 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7276 | Val  Acc: 0.4407
Average Valid Accuracy: 0.7085
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2373
 Best site-USPS       | Epoch:6 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4148 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4450 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4067 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3231 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.4300 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.8731 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.7675 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.6087 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.3900 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.5789 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.3305 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3574 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4136 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4262 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4036 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.8530 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.7888 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.6492 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.4478 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6783 | Val  Acc: 0.4915
Average Valid Accuracy: 0.7322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2881
 Best site-USPS       | Epoch:7 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.3605 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3898 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3851 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2921 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.3692 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.8937 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.7361 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.5844 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.3382 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.5325 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.2935 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3174 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3778 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3786 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3712 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.8102 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7393 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.6205 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.4027 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6267 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7390
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3051
 Best site-USPS       | Epoch:8 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3154 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3134 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3403 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2481 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.3128 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.8374 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.6464 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.5653 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.2801 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.4564 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.2650 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2762 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3352 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3235 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3337 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.7901 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.6719 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.5752 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.3694 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5767 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7475
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3220
 Best site-USPS       | Epoch:9 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2/CoCoOP...
===2023-03-28 21:06:49===
===2023-03-28 21:06:51===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8664
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3456
 Test site-USPS      | Epoch:9 | Test Acc: 0.8226
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5172
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4357
Average Test Accuracy: 0.5975
