===2023-03-28 12:36:51===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2053 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.1942 | Train Acc: 0.2667
 Site-Clipart   | Train Loss: 2.2176 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.2903 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.3141 | Train Acc: 0.0667
 Site-Infograph | Train Loss: 2.2489 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.2890 | Train Acc: 0.0000
 Site-Painting  | Train Loss: 2.3453 | Train Acc: 0.0667
 Site-Painting  | Train Loss: 2.1826 | Train Acc: 0.2667
 Site-QuickDraw | Train Loss: 2.4265 | Train Acc: 0.0667
 Site-Real      | Train Loss: 2.2220 | Train Acc: 0.1333
 Site-Sketch    | Train Loss: 2.0995 | Train Acc: 0.1333
 Site-Clipart   | Val  Loss: 2.1183 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.2121 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.1875 | Val  Acc: 0.1000
 Site-Clipart   | Val  Loss: 2.1979 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2532 | Val  Acc: 0.0000
 Site-Infograph | Val  Loss: 2.1286 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1924 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.2787 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2382 | Val  Acc: 0.1000
 Site-QuickDraw | Val  Loss: 2.3624 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 2.3107 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 2.2218 | Val  Acc: 0.1000
Average Valid Accuracy: 0.1500
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.2000
 Best site-Painting   | Epoch:0 | Val Acc: 0.1000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1000
 Best site-Real       | Epoch:0 | Val Acc: 0.0000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.1516 | Train Acc: 0.2667
 Site-Clipart   | Train Loss: 2.0965 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1268 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.1575 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.1789 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.1473 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.2306 | Train Acc: 0.0667
 Site-Painting  | Train Loss: 2.1472 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 2.0482 | Train Acc: 0.3333
 Site-QuickDraw | Train Loss: 2.3237 | Train Acc: 0.0667
 Site-Real      | Train Loss: 2.1210 | Train Acc: 0.1333
 Site-Sketch    | Train Loss: 1.9924 | Train Acc: 0.2667
 Site-Clipart   | Val  Loss: 2.0377 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.2255 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.0988 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.1181 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.2500 | Val  Acc: 0.0000
 Site-Infograph | Val  Loss: 2.0020 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.0821 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0997 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1159 | Val  Acc: 0.2000
 Site-QuickDraw | Val  Loss: 2.3309 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2158 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 2.1979 | Val  Acc: 0.2000
Average Valid Accuracy: 0.2000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Painting   | Epoch:1 | Val Acc: 0.2000
 Best site-Painting   | Epoch:1 | Val Acc: 0.2000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.0000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 2.0909 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9969 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.0220 | Train Acc: 0.2667
 Site-Clipart   | Train Loss: 2.0143 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 2.1386 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.0736 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.2525 | Train Acc: 0.1333
 Site-Painting  | Train Loss: 2.1553 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 2.0414 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.2858 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.0362 | Train Acc: 0.2000
 Site-Sketch    | Train Loss: 1.8777 | Train Acc: 0.2667
 Site-Clipart   | Val  Loss: 1.9694 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.0953 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.0847 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.9204 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.2121 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 1.9842 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.1072 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9845 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0335 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.3283 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.1606 | Val  Acc: 0.3000
 Site-Sketch    | Val  Loss: 2.1554 | Val  Acc: 0.2000
Average Valid Accuracy: 0.3083
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Painting   | Epoch:2 | Val Acc: 0.3000
 Best site-Painting   | Epoch:2 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.0000
 Best site-Real       | Epoch:2 | Val Acc: 0.3000
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 2.0668 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.8717 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9744 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9337 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 2.0939 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.0042 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.2299 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 2.0674 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 1.9009 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.1967 | Train Acc: 0.1333
 Site-Real      | Train Loss: 1.9024 | Train Acc: 0.4000
 Site-Sketch    | Train Loss: 1.7679 | Train Acc: 0.4667
 Site-Clipart   | Val  Loss: 1.8479 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1003 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.9559 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.8139 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.2174 | Val  Acc: 0.1000
 Site-Infograph | Val  Loss: 1.9689 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0634 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.7958 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.9426 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.3283 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.0809 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 2.1062 | Val  Acc: 0.2000
Average Valid Accuracy: 0.3167
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2000
 Best site-Painting   | Epoch:3 | Val Acc: 0.5000
 Best site-Painting   | Epoch:3 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0000
 Best site-Real       | Epoch:3 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.9909 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.7542 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.8309 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.9206 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0666 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 1.9590 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.1370 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 1.9008 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 1.8082 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.1780 | Train Acc: 0.0667
 Site-Real      | Train Loss: 1.8492 | Train Acc: 0.4667
 Site-Sketch    | Train Loss: 1.7005 | Train Acc: 0.5333
 Site-Clipart   | Val  Loss: 1.7615 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9716 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.8356 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.7240 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 2.0906 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9506 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 1.9801 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.6990 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8932 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.2203 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.9420 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 2.0116 | Val  Acc: 0.2000
Average Valid Accuracy: 0.3833
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Painting   | Epoch:4 | Val Acc: 0.6000
 Best site-Painting   | Epoch:4 | Val Acc: 0.4000
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2000
 Best site-Real       | Epoch:4 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.8174 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.7030 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.8050 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8755 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.0157 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.0180 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.1477 | Train Acc: 0.2667
 Site-Painting  | Train Loss: 1.8233 | Train Acc: 0.5333
 Site-Painting  | Train Loss: 1.7895 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.1626 | Train Acc: 0.2000
 Site-Real      | Train Loss: 1.7480 | Train Acc: 0.4667
 Site-Sketch    | Train Loss: 1.5273 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7284 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8313 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.7805 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.5557 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 2.0340 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8524 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9813 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.6075 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 1.7581 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 2.2573 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.8652 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.8748 | Val  Acc: 0.4000
Average Valid Accuracy: 0.4667
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4000
 Best site-Painting   | Epoch:5 | Val Acc: 0.7000
 Best site-Painting   | Epoch:5 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1000
 Best site-Real       | Epoch:5 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.7998 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.5558 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.6768 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.7434 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.9835 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0130 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.0564 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 1.7475 | Train Acc: 0.5333
 Site-Painting  | Train Loss: 1.6426 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.1236 | Train Acc: 0.2667
 Site-Real      | Train Loss: 1.6408 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.5064 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.7285 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6775 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.7502 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4805 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.9627 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8909 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.0121 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.4184 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.7317 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 2.2358 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.6312 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.8840 | Val  Acc: 0.4000
Average Valid Accuracy: 0.5083
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8000
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.1000
 Best site-Real       | Epoch:6 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.7051 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.4432 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5973 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.6743 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.0039 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8929 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9954 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 1.5738 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 1.6178 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.0949 | Train Acc: 0.2000
 Site-Real      | Train Loss: 1.5758 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.4084 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5854 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.6217 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.6723 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4857 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.9978 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 1.7994 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9013 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.3637 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.5778 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 2.2214 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.6391 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.8356 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5250
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8000
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2000
 Best site-Real       | Epoch:7 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.6412 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.3124 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5515 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6320 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 2.0096 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8499 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 1.9971 | Train Acc: 0.2667
 Site-Painting  | Train Loss: 1.5671 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 1.5743 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.0306 | Train Acc: 0.2667
 Site-Real      | Train Loss: 1.4354 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.2960 | Train Acc: 0.7333
 Site-Clipart   | Val  Loss: 1.4100 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.6158 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.5337 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.3787 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.9545 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.7064 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8068 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.4084 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 1.5959 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 2.1845 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.5301 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.7475 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5500
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4000
 Best site-Painting   | Epoch:8 | Val Acc: 0.7000
 Best site-Painting   | Epoch:8 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.1000
 Best site-Real       | Epoch:8 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.5515 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.3576 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5271 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5132 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.8985 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8524 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 1.8787 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 1.5303 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.3895 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 2.0207 | Train Acc: 0.2667
 Site-Real      | Train Loss: 1.2981 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.2473 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.4101 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.5846 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.5460 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.2428 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.8615 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8400 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.7906 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.2227 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.5735 | Val  Acc: 0.6000
 Site-QuickDraw | Val  Loss: 2.2031 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.5327 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.6558 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5667
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5000
 Best site-Painting   | Epoch:9 | Val Acc: 0.8000
 Best site-Painting   | Epoch:9 | Val Acc: 0.6000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2000
 Best site-Real       | Epoch:9 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
===2023-03-28 12:45:05===
===2023-03-28 12:45:06===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.5038
 Test site-Infograph | Epoch:9 | Test Acc: 0.3196
 Test site-Painting  | Epoch:9 | Test Acc: 0.5444
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3420
 Test site-Real      | Epoch:9 | Test Acc: 0.5670
 Test site-Sketch    | Epoch:9 | Test Acc: 0.4621
Average Test Accuracy: 0.4565
===2023-03-28 18:10:45===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0545 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9831 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 1.9191 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 1.9497 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 2.1694 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.1803 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1203 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 2.0787 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 2.0495 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 2.3257 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.9928 | Train Acc: 0.4444
 Site-Sketch    | Train Loss: 1.9128 | Train Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8986 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9351 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9389 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 2.0665 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1181 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.1800 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1805 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.9585 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 2.0791 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2768 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1335 | Val  Acc: 0.3571
 Site-Sketch    | Val  Loss: 2.0357 | Val  Acc: 0.3095
Average Valid Accuracy: 0.3373
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1429
 Best site-Real       | Epoch:0 | Val Acc: 0.3571
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7498 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.6661 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.5672 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.6636 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 2.1131 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.9920 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.9693 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.7590 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.7654 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 2.2461 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.6424 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.6697 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.5414 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.5790 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.6421 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7700 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9132 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9646 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0684 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.6071 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 1.8694 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.2195 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7447 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 1.8196 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4841
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5952
 Best site-Painting   | Epoch:1 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4840 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.4872 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.3488 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.3983 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.0260 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.9032 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7872 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.4340 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 1.4837 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.1631 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.3402 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.4126 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2731 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2646 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.5011 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.4556 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7865 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8320 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0050 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.2601 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.5697 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.1168 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.4430 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.6451 | Val  Acc: 0.5476
Average Valid Accuracy: 0.5714
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.8095
 Best site-Painting   | Epoch:2 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2619
 Best site-Real       | Epoch:2 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.3093 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.2600 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1704 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.2138 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.9379 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7696 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.6491 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.2397 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 1.2322 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.1085 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.1254 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.2382 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.1194 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.1225 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.2937 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3139 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6980 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.7766 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9108 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.1790 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.3553 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0954 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.2663 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.4008 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6111
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7619
 Best site-Painting   | Epoch:3 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2619
 Best site-Real       | Epoch:3 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.1563 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.1285 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0588 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0337 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.7735 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6708 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.5194 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.0603 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 1.0911 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.0614 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.9447 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0573 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9265 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9712 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1770 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1565 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6431 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6114 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8132 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.9440 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.2567 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.0257 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0846 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.3401 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6587
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3810
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-Painting   | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3095
 Best site-Real       | Epoch:4 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.0819 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.0149 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9166 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9068 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.8359 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.5762 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4725 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.9820 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.0642 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.0325 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.8485 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.9744 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8683 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.8832 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0477 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1051 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5521 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5918 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7668 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.9187 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.0750 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 2.0433 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.8887 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.2041 | Val  Acc: 0.7857
Average Valid Accuracy: 0.6885
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-Painting   | Epoch:5 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3095
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.0060 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 0.9494 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.8556 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8116 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.7539 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5590 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3879 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.8137 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8734 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9733 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.7574 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.9307 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.7468 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7535 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9804 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9906 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3984 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4898 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7078 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.7848 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.9846 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.9726 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7933 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.1572 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7063
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.9048
 Best site-Painting   | Epoch:6 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3810
 Best site-Real       | Epoch:6 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.8363 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8642 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8122 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.7381 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.7163 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4705 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3934 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.7931 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7988 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9174 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.6690 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8327 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.6708 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7266 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9009 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.8361 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4753 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.4183 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6899 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.7297 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.8924 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.9361 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7240 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.1410 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7202
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4286
 Best site-Painting   | Epoch:7 | Val Acc: 0.8810
 Best site-Painting   | Epoch:7 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3333
 Best site-Real       | Epoch:7 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.7947 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8356 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7033 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6508 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6851 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.4507 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.3327 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.6807 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.7460 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.8179 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.6415 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7832 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.5662 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6009 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8327 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8210 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3747 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3691 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.6249 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6742 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.8027 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.8045 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7132 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0778 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7579
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5238
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-Painting   | Epoch:8 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3810
 Best site-Real       | Epoch:8 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.7874 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7215 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6446 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5878 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.5932 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3580 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3033 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.6530 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.7196 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7896 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.5549 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7143 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6182 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5754 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7817 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7819 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3616 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3359 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6253 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.6226 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.8000 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8617 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6287 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.9982 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7341
===2023-03-28 18:43:07===
===2023-03-28 18:43:08===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.8232
 Test site-Infograph | Epoch:8 | Test Acc: 0.4475
 Test site-Painting  | Epoch:8 | Test Acc: 0.8207
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.4210
 Test site-Real      | Epoch:8 | Test Acc: 0.8973
 Test site-Sketch    | Epoch:8 | Test Acc: 0.7816
Average Test Accuracy: 0.6985
