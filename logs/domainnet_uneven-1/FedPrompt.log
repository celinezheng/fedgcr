===2023-03-28 10:33:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0205 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9637 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 1.8717 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8809 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 2.2094 | Train Acc: 0.1587
 Site-Infograph | Train Loss: 2.1488 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 2.0408 | Train Acc: 0.3810
 Site-Painting  | Train Loss: 1.9418 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.9360 | Train Acc: 0.4762
 Site-QuickDraw | Train Loss: 2.3096 | Train Acc: 0.0476
 Site-Real      | Train Loss: 1.9106 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.8432 | Train Acc: 0.5873
 Site-Clipart   | Val  Loss: 1.8513 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.8881 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9647 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 2.0603 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1063 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1362 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1717 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8200 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0243 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.2510 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9572 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 2.0155 | Val  Acc: 0.3810
Average Valid Accuracy: 0.3770
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.5000
 Best site-Painting   | Epoch:0 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1429
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6182 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.7056 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.5304 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4797 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 2.1383 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.0547 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.9841 | Train Acc: 0.3651
 Site-Painting  | Train Loss: 1.5371 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 1.5427 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 2.1930 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.4475 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.4660 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.3970 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4454 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6507 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6368 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 2.0050 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0072 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.1823 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.3897 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 1.6775 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.1644 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4527 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.7007 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5417
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Painting   | Epoch:1 | Val Acc: 0.7143
 Best site-Painting   | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3333
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2583 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.4043 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.1873 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1158 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.8895 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.6934 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.6841 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.1484 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 1.1515 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.1011 | Train Acc: 0.2857
 Site-Real      | Train Loss: 1.0242 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 1.1578 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.1709 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0896 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3679 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.2802 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7994 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.7367 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.0002 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.0344 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.4135 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 2.0812 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.1020 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.4216 | Val  Acc: 0.5952
Average Valid Accuracy: 0.6171
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.8810
 Best site-Painting   | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2381
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0477 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1214 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.9031 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8019 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.8688 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.6299 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4769 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.8942 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.9899 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.0221 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.7251 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.8605 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7880 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8057 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.1801 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.1435 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5512 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.5643 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8310 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.8297 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.0721 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 2.0236 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.7710 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1461 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6786
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4048
 Best site-Painting   | Epoch:3 | Val Acc: 0.8095
 Best site-Painting   | Epoch:3 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4048
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8340 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.9633 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 0.7077 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.6686 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.6494 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4379 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3836 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.7225 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7207 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.7561 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.4996 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.7041 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.6206 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6454 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9480 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.8454 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4016 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.4413 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7651 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.5635 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.8416 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.8664 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6408 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9516 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7163
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3333
 Best site-Painting   | Epoch:4 | Val Acc: 0.9286
 Best site-Painting   | Epoch:4 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3810
 Best site-Real       | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6306 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7267 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4987 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4493 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.3714 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2049 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.1084 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.5950 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5911 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.7576 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.4800 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6267 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4329 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3868 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.8129 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6373 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1591 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1572 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4878 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.4424 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.6792 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.8823 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.4954 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 1.0268 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7837
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5238
 Best site-Painting   | Epoch:5 | Val Acc: 0.9286
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4048
 Best site-Real       | Epoch:5 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5174 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6265 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.3506 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3425 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.6285 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.1753 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0340 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4573 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4816 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.4685 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.2911 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4539 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.3450 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3273 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.6118 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5449 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1464 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.0970 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5103 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.3790 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.6014 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.7475 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.3692 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7446 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7837
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3365 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4591 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3270 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2931 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.2803 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0743 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9945 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.3759 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3137 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.4556 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.2244 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3274 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2603 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2813 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5733 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4438 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9816 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.0498 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2757 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.2024 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3801 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.6783 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.3577 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7249 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3810
 Best site-Real       | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2912 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4373 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.1687 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1845 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.1394 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.9861 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7656 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.3054 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.2957 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5901 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.2530 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3512 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.1489 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1598 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4232 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3631 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8221 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.8730 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1764 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.2293 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3316 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.9329 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.3193 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7609 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8234
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4762
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3571
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2298 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2739 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1646 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1619 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.0422 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.8662 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.7337 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2206 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2533 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.4075 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2147 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2533 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.1992 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1955 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3253 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3174 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8746 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.6976 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9742 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1496 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3645 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.5504 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3875 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8337 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8274
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4524
 Best site-Real       | Epoch:9 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/FedPrompt...
===2023-03-28 11:05:57===
===2023-03-28 11:05:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8441
 Test site-Infograph | Epoch:9 | Test Acc: 0.5068
 Test site-Painting  | Epoch:9 | Test Acc: 0.8498
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4010
 Test site-Real      | Epoch:9 | Test Acc: 0.9269
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7870
Average Test Accuracy: 0.7193
