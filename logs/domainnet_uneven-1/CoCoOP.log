===2023-03-28 12:02:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.1774 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.0190 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 2.0227 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 2.2095 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.2386 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.1872 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.3140 | Train Acc: 0.1333
 Site-Painting  | Train Loss: 2.1896 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 2.1161 | Train Acc: 0.2667
 Site-QuickDraw | Train Loss: 2.3426 | Train Acc: 0.0667
 Site-Real      | Train Loss: 2.1363 | Train Acc: 0.3333
 Site-Sketch    | Train Loss: 2.0722 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.0563 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.1248 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.1881 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.1162 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.3735 | Val  Acc: 0.0000
 Site-Infograph | Val  Loss: 2.1474 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.2178 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1996 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1520 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.3645 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 2.1266 | Val  Acc: 0.1000
 Site-Sketch    | Val  Loss: 2.1680 | Val  Acc: 0.3000
Average Valid Accuracy: 0.2583
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2000
 Best site-Painting   | Epoch:0 | Val Acc: 0.3000
 Best site-Painting   | Epoch:0 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2000
 Best site-Real       | Epoch:0 | Val Acc: 0.1000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.0835 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.8524 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.0058 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9596 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.1411 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.0571 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.2217 | Train Acc: 0.1333
 Site-Painting  | Train Loss: 2.0425 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 1.8796 | Train Acc: 0.3333
 Site-QuickDraw | Train Loss: 2.2637 | Train Acc: 0.1333
 Site-Real      | Train Loss: 1.9232 | Train Acc: 0.5333
 Site-Sketch    | Train Loss: 1.7125 | Train Acc: 0.7333
 Site-Clipart   | Val  Loss: 1.9173 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0513 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.9189 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.7876 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 2.2143 | Val  Acc: 0.1000
 Site-Infograph | Val  Loss: 1.9783 | Val  Acc: 0.1000
 Site-Infograph | Val  Loss: 2.1155 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.7969 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0515 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.1890 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.8338 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9714 | Val  Acc: 0.3000
Average Valid Accuracy: 0.3500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1000
 Best site-Painting   | Epoch:1 | Val Acc: 0.5000
 Best site-Painting   | Epoch:1 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3000
 Best site-Real       | Epoch:1 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.8995 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.6343 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.7113 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.8365 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 2.0759 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 1.9354 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.0889 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.9326 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.6584 | Train Acc: 0.5333
 Site-QuickDraw | Train Loss: 2.1794 | Train Acc: 0.1333
 Site-Real      | Train Loss: 1.7634 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.5737 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.6283 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.7955 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7732 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.5751 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 2.0182 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 1.8022 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9893 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5568 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 1.8835 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.2079 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.7515 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.8976 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4833
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4000
 Best site-Painting   | Epoch:2 | Val Acc: 0.7000
 Best site-Painting   | Epoch:2 | Val Acc: 0.4000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1000
 Best site-Real       | Epoch:2 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.6965 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.4502 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.5978 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.5672 | Train Acc: 0.7333
 Site-Infograph | Train Loss: 1.9171 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7642 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.9917 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.6904 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.5585 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.1060 | Train Acc: 0.2000
 Site-Real      | Train Loss: 1.5128 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.2638 | Train Acc: 0.7333
 Site-Clipart   | Val  Loss: 1.5797 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.5840 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5990 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.3818 | Val  Acc: 0.9000
 Site-Infograph | Val  Loss: 1.8593 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.7439 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.9080 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.2734 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.6022 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 2.1789 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.6341 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.7392 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6000
 Best site-Painting   | Epoch:3 | Val Acc: 0.8000
 Best site-Painting   | Epoch:3 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1000
 Best site-Real       | Epoch:3 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.6588 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.1800 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 1.1877 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.4506 | Train Acc: 0.7333
 Site-Infograph | Train Loss: 1.7381 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.6949 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.8962 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.5135 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.3077 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 2.0490 | Train Acc: 0.2667
 Site-Real      | Train Loss: 1.3962 | Train Acc: 0.7333
 Site-Sketch    | Train Loss: 1.0555 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1419 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.2767 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3252 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.2371 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.7491 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.5705 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.6838 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 1.1668 | Val  Acc: 0.9000
 Site-Painting  | Val  Loss: 1.4167 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 2.3068 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.4121 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.5907 | Val  Acc: 0.7000
Average Valid Accuracy: 0.7083
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7000
 Best site-Painting   | Epoch:4 | Val Acc: 0.9000
 Best site-Painting   | Epoch:4 | Val Acc: 0.8000
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2000
 Best site-Real       | Epoch:4 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.4206 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.0708 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 1.1056 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.2943 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.7087 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.6150 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.7876 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.2733 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.1928 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 2.0873 | Train Acc: 0.2000
 Site-Real      | Train Loss: 1.0824 | Train Acc: 0.8667
 Site-Sketch    | Train Loss: 0.9521 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1512 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.1240 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1544 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.0282 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.4502 | Val  Acc: 0.9000
 Site-Infograph | Val  Loss: 1.5155 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.7842 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.9981 | Val  Acc: 0.9000
 Site-Painting  | Val  Loss: 1.2600 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 2.2043 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.2699 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.4858 | Val  Acc: 0.6000
Average Valid Accuracy: 0.7167
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.9000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3000
 Best site-Painting   | Epoch:5 | Val Acc: 0.9000
 Best site-Painting   | Epoch:5 | Val Acc: 0.8000
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2000
 Best site-Real       | Epoch:5 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.2244 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.9134 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.9860 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 1.1469 | Train Acc: 0.8667
 Site-Infograph | Train Loss: 1.6138 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 1.4507 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.6795 | Train Acc: 0.5333
 Site-Painting  | Train Loss: 1.1362 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.0182 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.9138 | Train Acc: 0.4000
 Site-Real      | Train Loss: 1.0171 | Train Acc: 0.9333
 Site-Sketch    | Train Loss: 0.7323 | Train Acc: 0.9333
 Site-Clipart   | Val  Loss: 1.0242 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.1369 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.9906 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.8948 | Val  Acc: 0.9000
 Site-Infograph | Val  Loss: 1.3987 | Val  Acc: 0.9000
 Site-Infograph | Val  Loss: 1.3720 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.4048 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8484 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.0813 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 2.1804 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.1080 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.3231 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.9000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8000
 Best site-Painting   | Epoch:6 | Val Acc: 1.0000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8000
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2000
 Best site-Real       | Epoch:6 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.0309 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.7535 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.8817 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.8799 | Train Acc: 0.9333
 Site-Infograph | Train Loss: 1.4174 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.3195 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.4975 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 0.9998 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.8891 | Train Acc: 0.8667
 Site-QuickDraw | Train Loss: 1.8016 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8172 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6586 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9072 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0155 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8153 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7984 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2358 | Val  Acc: 0.9000
 Site-Infograph | Val  Loss: 1.1885 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.3749 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.6995 | Val  Acc: 0.9000
 Site-Painting  | Val  Loss: 1.1098 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 2.3091 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.0406 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2424 | Val  Acc: 0.7000
Average Valid Accuracy: 0.7750
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.0079 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.7050 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.7568 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.8275 | Train Acc: 0.9333
 Site-Infograph | Train Loss: 1.2953 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.2064 | Train Acc: 0.7333
 Site-Infograph | Train Loss: 1.3210 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.7999 | Train Acc: 0.9333
 Site-Painting  | Train Loss: 0.7628 | Train Acc: 0.9333
 Site-QuickDraw | Train Loss: 1.8512 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.6971 | Train Acc: 0.9333
 Site-Sketch    | Train Loss: 0.5532 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7030 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6520 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7339 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6614 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.1088 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2048 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.2013 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.5763 | Val  Acc: 0.9000
 Site-Painting  | Val  Loss: 0.8163 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 2.3129 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 0.9663 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2056 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8250
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:8 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2000
 Best site-Real       | Epoch:8 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.8045 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.5385 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.6098 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.6838 | Train Acc: 0.9333
 Site-Infograph | Train Loss: 1.1740 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.0987 | Train Acc: 0.8667
 Site-Infograph | Train Loss: 1.2842 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 0.8028 | Train Acc: 0.8667
 Site-Painting  | Train Loss: 0.7735 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.6075 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.5835 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4442 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6151 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5187 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6921 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5605 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.1360 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.0498 | Val  Acc: 0.9000
 Site-Infograph | Val  Loss: 1.1737 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.5062 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.8422 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 2.2279 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 0.8694 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.1872 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8167
===2023-03-28 12:10:36===
===2023-03-28 12:10:37===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.6065
 Test site-Infograph | Epoch:8 | Test Acc: 0.3851
 Test site-Painting  | Epoch:8 | Test Acc: 0.6074
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.3330
 Test site-Real      | Epoch:8 | Test Acc: 0.6450
 Test site-Sketch    | Epoch:8 | Test Acc: 0.5253
Average Test Accuracy: 0.5170
===2023-03-28 14:51:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:51:05===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
===2023-03-28 15:21:13===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2076 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.2478 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.1196 | Train Acc: 0.2667
 Site-Clipart   | Train Loss: 2.2666 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.2477 | Train Acc: 0.0667
 Site-Infograph | Train Loss: 2.1942 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.2828 | Train Acc: 0.0667
 Site-Painting  | Train Loss: 2.1744 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 2.2944 | Train Acc: 0.2667
 Site-QuickDraw | Train Loss: 2.3253 | Train Acc: 0.0667
 Site-Real      | Train Loss: 2.2218 | Train Acc: 0.1333
 Site-Sketch    | Train Loss: 2.1204 | Train Acc: 0.2667
 Site-Clipart   | Val  Loss: 2.0561 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.3043 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.2440 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.1734 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.2700 | Val  Acc: 0.1000
 Site-Infograph | Val  Loss: 2.1263 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2020 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.2223 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.3040 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.3839 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 2.3457 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 2.2104 | Val  Acc: 0.2000
Average Valid Accuracy: 0.1667
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.1000
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1000
 Best site-Real       | Epoch:0 | Val Acc: 0.0000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.1160 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.0196 | Train Acc: 0.2667
 Site-Clipart   | Train Loss: 2.1116 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1103 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.2280 | Train Acc: 0.0000
 Site-Infograph | Train Loss: 2.2062 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.2628 | Train Acc: 0.0667
 Site-Painting  | Train Loss: 2.1832 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 2.0711 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.2875 | Train Acc: 0.0667
 Site-Real      | Train Loss: 2.1496 | Train Acc: 0.1333
 Site-Sketch    | Train Loss: 1.9799 | Train Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.0002 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.1813 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.0639 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.0297 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.2943 | Val  Acc: 0.1000
 Site-Infograph | Val  Loss: 2.0837 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.1922 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.1590 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.2227 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.2432 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 2.2489 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 2.2589 | Val  Acc: 0.2000
Average Valid Accuracy: 0.2333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1000
 Best site-Painting   | Epoch:1 | Val Acc: 0.3000
 Best site-Painting   | Epoch:1 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3000
 Best site-Real       | Epoch:1 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 2.1263 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9453 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9824 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.0630 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.1669 | Train Acc: 0.0667
 Site-Infograph | Train Loss: 2.1191 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.2261 | Train Acc: 0.0667
 Site-Painting  | Train Loss: 2.0486 | Train Acc: 0.2667
 Site-Painting  | Train Loss: 1.9976 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.1851 | Train Acc: 0.2000
 Site-Real      | Train Loss: 2.0362 | Train Acc: 0.2667
 Site-Sketch    | Train Loss: 1.8094 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.8250 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.0435 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.0302 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.0715 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.2506 | Val  Acc: 0.1000
 Site-Infograph | Val  Loss: 2.0119 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.0958 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.9423 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1468 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.1968 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 2.0840 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 2.1407 | Val  Acc: 0.2000
Average Valid Accuracy: 0.2833
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1000
 Best site-Painting   | Epoch:2 | Val Acc: 0.3000
 Best site-Painting   | Epoch:2 | Val Acc: 0.4000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2000
 Best site-Real       | Epoch:2 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.9887 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8322 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.8526 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9276 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 2.1529 | Train Acc: 0.0667
 Site-Infograph | Train Loss: 1.9903 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.1842 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 1.9292 | Train Acc: 0.4667
 Site-Painting  | Train Loss: 1.9086 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.1496 | Train Acc: 0.1333
 Site-Real      | Train Loss: 1.9251 | Train Acc: 0.5333
 Site-Sketch    | Train Loss: 1.7163 | Train Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.8938 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9564 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.0389 | Val  Acc: 0.2000
 Site-Clipart   | Val  Loss: 1.8311 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.1054 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 1.9308 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0921 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.7166 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9737 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.2327 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.9324 | Val  Acc: 0.4000
 Site-Sketch    | Val  Loss: 2.0085 | Val  Acc: 0.2000
Average Valid Accuracy: 0.3333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1000
 Best site-Painting   | Epoch:3 | Val Acc: 0.6000
 Best site-Painting   | Epoch:3 | Val Acc: 0.4000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2000
 Best site-Real       | Epoch:3 | Val Acc: 0.4000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.9914 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.7353 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.8786 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8777 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 2.0283 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 1.9745 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.1248 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 1.9225 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.8133 | Train Acc: 0.5333
 Site-QuickDraw | Train Loss: 2.1771 | Train Acc: 0.2000
 Site-Real      | Train Loss: 1.7873 | Train Acc: 0.6000
 Site-Sketch    | Train Loss: 1.5259 | Train Acc: 0.5333
 Site-Clipart   | Val  Loss: 1.6453 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.8423 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.9104 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.5947 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 2.0907 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.0134 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 1.9219 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6868 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 1.9211 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.2245 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.8178 | Val  Acc: 0.4000
 Site-Sketch    | Val  Loss: 2.0036 | Val  Acc: 0.2000
Average Valid Accuracy: 0.4083
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3000
 Best site-Painting   | Epoch:4 | Val Acc: 0.7000
 Best site-Painting   | Epoch:4 | Val Acc: 0.4000
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2000
 Best site-Real       | Epoch:4 | Val Acc: 0.4000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.8590 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.6170 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.7582 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.8433 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 1.9928 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8961 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 2.0928 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 1.7566 | Train Acc: 0.5333
 Site-Painting  | Train Loss: 1.7273 | Train Acc: 0.5333
 Site-QuickDraw | Train Loss: 2.0993 | Train Acc: 0.1333
 Site-Real      | Train Loss: 1.6942 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.5273 | Train Acc: 0.5333
 Site-Clipart   | Val  Loss: 1.6522 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.8191 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.7577 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.5741 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 2.0515 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9731 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 1.9434 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5991 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8799 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.2823 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 1.7899 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.9252 | Val  Acc: 0.3000
Average Valid Accuracy: 0.4083
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.7461 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.5725 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6422 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.6851 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 2.0908 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 1.9101 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9820 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.7696 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.7010 | Train Acc: 0.5333
 Site-QuickDraw | Train Loss: 2.0862 | Train Acc: 0.3333
 Site-Real      | Train Loss: 1.5967 | Train Acc: 0.7333
 Site-Sketch    | Train Loss: 1.4281 | Train Acc: 0.5333
 Site-Clipart   | Val  Loss: 1.5464 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.7398 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6200 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.4987 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 2.0292 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 1.8961 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9547 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.4762 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8319 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 2.1437 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.6345 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.8805 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5500
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8000
 Best site-Painting   | Epoch:6 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4000
 Best site-Real       | Epoch:6 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.7202 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.3778 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5951 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.5848 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.9542 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.8724 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 2.0025 | Train Acc: 0.2667
 Site-Painting  | Train Loss: 1.5696 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 1.5342 | Train Acc: 0.7333
 Site-QuickDraw | Train Loss: 2.1006 | Train Acc: 0.2667
 Site-Real      | Train Loss: 1.5081 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.3758 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4842 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.5982 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6113 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.3432 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.9322 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9028 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9129 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.3629 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.7322 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.2239 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.6414 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.7648 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5333
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.7034 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.3504 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5239 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5251 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 1.8480 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 1.8380 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.9059 | Train Acc: 0.5333
 Site-Painting  | Train Loss: 1.5619 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 1.4397 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.0015 | Train Acc: 0.4000
 Site-Real      | Train Loss: 1.4437 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.2255 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.3954 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.5634 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4926 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.2684 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.8999 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7501 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8421 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.2529 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.6758 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 2.1724 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.4313 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.6248 | Val  Acc: 0.7000
Average Valid Accuracy: 0.5750
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Painting   | Epoch:8 | Val Acc: 0.8000
 Best site-Painting   | Epoch:8 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2000
 Best site-Real       | Epoch:8 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.5304 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.3714 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4765 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.4907 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.8634 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 1.8771 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.9082 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.5125 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 1.3783 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 1.9192 | Train Acc: 0.4667
 Site-Real      | Train Loss: 1.3088 | Train Acc: 0.7333
 Site-Sketch    | Train Loss: 1.1712 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.3196 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.5121 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.2860 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.2647 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.8983 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8600 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7970 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.0690 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.4388 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 2.1841 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.3469 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.6259 | Val  Acc: 0.6000
Average Valid Accuracy: 0.6000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4000
 Best site-Painting   | Epoch:9 | Val Acc: 0.8000
 Best site-Painting   | Epoch:9 | Val Acc: 0.8000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2000
 Best site-Real       | Epoch:9 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
===2023-03-28 15:28:48===
===2023-03-28 15:28:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.5038
 Test site-Infograph | Epoch:9 | Test Acc: 0.3364
 Test site-Painting  | Epoch:9 | Test Acc: 0.5654
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3180
===2023-03-28 15:32:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
===2023-03-28 16:26:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0405 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9756 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.9471 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.9807 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.2108 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1961 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1433 | Train Acc: 0.2381
 Site-Painting  | Train Loss: 1.9952 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 2.0415 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 2.3060 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.9940 | Train Acc: 0.3651
 Site-Sketch    | Train Loss: 1.9326 | Train Acc: 0.5079
 Site-Clipart   | Val  Loss: 1.9508 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9228 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9912 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 2.0490 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1543 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1845 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.2334 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.9682 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 2.1446 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2768 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.0824 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0793 | Val  Acc: 0.3810
Average Valid Accuracy: 0.3512
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.4762
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Real       | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7618 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.7348 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.5865 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.6834 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 2.1152 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.0026 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.9323 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.7308 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 1.7417 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 2.2412 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.6432 | Train Acc: 0.6508
 Site-Sketch    | Train Loss: 1.6362 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.5598 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5565 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.6758 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.7596 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.9485 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9716 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.0342 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.6659 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 1.8211 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.1926 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.7357 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.7886 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5040
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Painting   | Epoch:1 | Val Acc: 0.5714
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4524 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4370 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.3295 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3133 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.9759 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8875 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.7251 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.3932 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.3998 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.1542 | Train Acc: 0.1746
 Site-Real      | Train Loss: 1.3279 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.3884 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.3273 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.2390 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.4374 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.4522 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8190 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8523 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.0332 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.2740 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.5943 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.0893 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.4060 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5509 | Val  Acc: 0.5714
Average Valid Accuracy: 0.5952
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Painting   | Epoch:2 | Val Acc: 0.7381
 Best site-Painting   | Epoch:2 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2619
 Best site-Real       | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1961 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.2239 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0681 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1633 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.9131 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.7778 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.5602 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.1961 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 1.1751 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.1011 | Train Acc: 0.3175
 Site-Real      | Train Loss: 1.0997 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.2040 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.1653 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.0133 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1971 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.2968 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6473 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7590 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9599 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.0445 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.3889 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.0462 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.2061 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.4836 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6448
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3571
 Best site-Painting   | Epoch:3 | Val Acc: 0.8571
 Best site-Painting   | Epoch:3 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3095
 Best site-Real       | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.1568 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.0853 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9606 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9489 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.8501 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6424 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.5023 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.0290 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.0684 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 2.0405 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.9624 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.0523 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9490 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.8825 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1582 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0553 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.5888 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5786 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8883 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.8755 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 1.1804 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 2.0214 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.9768 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.3369 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6766
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3571
 Best site-Painting   | Epoch:4 | Val Acc: 0.9286
 Best site-Painting   | Epoch:4 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2857
 Best site-Real       | Epoch:4 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.8855 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9169 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8916 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.8415 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.8712 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6327 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3757 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.9670 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.9103 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9928 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.8248 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9083 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.7378 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8157 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9533 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9712 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.4740 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5739 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7580 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.7822 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.0657 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 2.0335 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.8255 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.2345 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6766
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.8776 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 0.8429 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7742 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7277 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.7642 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5429 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.3602 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.8808 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.7515 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.9354 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.6816 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8186 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.6541 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6717 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8791 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9010 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4009 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4958 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7765 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.6534 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.9272 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.9118 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7343 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.1313 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7163
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-Painting   | Epoch:6 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3810
 Best site-Real       | Epoch:6 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.7245 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7788 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6793 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6817 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.7406 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.4778 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.2653 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.7694 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7307 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.8712 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.6337 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7432 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6167 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6722 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8307 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8664 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3204 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4334 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6740 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.6393 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.8748 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.8607 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6592 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.0751 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7262
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3571
 Best site-Painting   | Epoch:7 | Val Acc: 0.8810
 Best site-Painting   | Epoch:7 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3810
 Best site-Real       | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.6713 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7082 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6894 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.5310 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.6602 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.3570 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.2560 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.6718 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6606 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8781 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.5642 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7357 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.5460 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6157 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7202 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.7827 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3631 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.3756 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.5848 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.5637 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.7669 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8238 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.6452 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9829 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4286
 Best site-Painting   | Epoch:8 | Val Acc: 0.9286
 Best site-Painting   | Epoch:8 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4048
 Best site-Real       | Epoch:8 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.6803 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6867 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6504 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.5053 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.6739 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.3774 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.2108 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.6109 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.6121 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.7966 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.5201 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.6528 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.4907 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5565 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6483 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7088 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3605 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.2792 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5740 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.4284 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.7181 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8024 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.5617 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9828 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7540
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-Painting   | Epoch:9 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3333
 Best site-Real       | Epoch:9 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1/CoCoOP...
===2023-03-28 16:58:29===
===2023-03-28 16:59:17===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8251
 Test site-Infograph | Epoch:9 | Test Acc: 0.4810
 Test site-Painting  | Epoch:9 | Test Acc: 0.8562
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3810
 Test site-Real      | Epoch:9 | Test Acc: 0.9129
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8105
Average Test Accuracy: 0.7111
