===2023-03-26 18:23:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0533 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9606 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.2277 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1691 | Train Acc: 0.2381
 Site-Painting  | Train Loss: 2.0876 | Train Acc: 0.3651
 Site-Painting  | Train Loss: 2.0350 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 2.2156 | Train Acc: 0.2063
 Site-QuickDraw | Train Loss: 2.1775 | Train Acc: 0.2857
 Site-Sketch    | Train Loss: 1.9777 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 2.0460 | Train Acc: 0.3651
 Site-Clipart   | Val  Loss: 2.0037 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 2.0390 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1509 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1632 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.9821 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 2.1705 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1797 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2043 | Val  Acc: 0.1667
 Site-Sketch    | Val  Loss: 1.9996 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0762 | Val  Acc: 0.4762
Average Valid Accuracy: 0.3262
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7524 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.7059 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 2.0728 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.9737 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.6529 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 1.6693 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.0825 | Train Acc: 0.2857
 Site-QuickDraw | Train Loss: 2.0025 | Train Acc: 0.3968
 Site-Sketch    | Train Loss: 1.5660 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.7038 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.7325 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7179 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9815 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0486 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.5596 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 1.8495 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.9628 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0618 | Val  Acc: 0.3095
 Site-Sketch    | Val  Loss: 1.7181 | Val  Acc: 0.5952
 Site-Sketch    | Val  Loss: 1.7738 | Val  Acc: 0.5238
Average Valid Accuracy: 0.4929
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Painting   | Epoch:1 | Val Acc: 0.6905
 Best site-Painting   | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3095
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5952
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4354 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4335 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.8781 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.7022 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.2949 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 1.3230 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 1.9500 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 1.8382 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 1.3397 | Train Acc: 0.6508
 Site-Sketch    | Train Loss: 1.4411 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.5006 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.3766 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.7171 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8792 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.1595 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.5391 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.7953 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.8952 | Val  Acc: 0.4048
 Site-Sketch    | Val  Loss: 1.3626 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.5287 | Val  Acc: 0.6190
Average Valid Accuracy: 0.6190
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Painting   | Epoch:2 | Val Acc: 0.8095
 Best site-Painting   | Epoch:2 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.2070 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.2249 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.8349 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6347 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.0731 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 1.1066 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 1.7424 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.6380 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.1152 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.1687 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.3770 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.1689 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5571 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8827 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 1.0142 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.3025 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.5563 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.6996 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.2355 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.2678 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6548
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Painting   | Epoch:3 | Val Acc: 0.8095
 Best site-Painting   | Epoch:3 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.9260 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.0245 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.5989 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.4600 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.8628 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.9111 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.8635 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 1.5835 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 0.8373 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 0.9826 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.0520 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9139 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3359 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5948 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.7965 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.0632 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.4574 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.6587 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 0.9698 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.0564 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7167
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-Painting   | Epoch:4 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.7525 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8578 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.5277 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3474 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.6606 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.6720 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.4562 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.3979 | Train Acc: 0.6190
 Site-Sketch    | Train Loss: 0.7823 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 0.7678 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7910 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8347 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2144 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5442 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.6120 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.7913 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.3409 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.5359 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 0.8697 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 0.8454 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.6491 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7371 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.2724 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0686 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.6379 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5463 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.5577 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 1.4441 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 0.6777 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 0.7189 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 0.6475 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6228 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0095 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3473 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.3851 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.6701 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.3347 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.6136 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 0.6560 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 0.6647 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7405
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4999 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.6517 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.2699 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0871 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.5252 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.4665 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.3001 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.1174 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 0.5783 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 0.5954 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.7677 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6840 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.9903 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3477 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3604 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.5080 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.0334 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.2277 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 0.6876 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.6596 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5476
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3782 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4172 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.1114 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9433 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.3071 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.3562 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.5690 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.3320 | Train Acc: 0.6190
 Site-Sketch    | Train Loss: 0.4894 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.4433 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4700 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4881 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.7880 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1731 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3392 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3869 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.2568 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.4743 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 0.4192 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4955 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7976
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3197 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3548 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.0119 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.7764 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.3401 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.2695 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.4900 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.4238 | Train Acc: 0.4444
 Site-Sketch    | Train Loss: 0.3923 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.3526 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3985 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3318 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7709 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9854 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.2161 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3861 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.2039 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.5416 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 0.3681 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3766 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8357
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7381
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
===2023-03-26 18:50:52===
===2023-03-26 18:50:53===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 3
Loading snapshots...
Test Accuracy of Real: 0.8866
Average Test Accuracy: 0.8866
===2023-03-28 00:06:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0475 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 1.9542 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.2108 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1574 | Train Acc: 0.2381
 Site-Painting  | Train Loss: 2.0752 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 2.0179 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 2.2409 | Train Acc: 0.1905
 Site-QuickDraw | Train Loss: 2.1839 | Train Acc: 0.2540
 Site-Sketch    | Train Loss: 1.9663 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 2.0406 | Train Acc: 0.4444
 Site-Clipart   | Val  Loss: 1.9928 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.0415 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1366 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1509 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.9615 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 2.1568 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1972 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.2085 | Val  Acc: 0.1667
 Site-Sketch    | Val  Loss: 2.0018 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 2.0731 | Val  Acc: 0.4524
Average Valid Accuracy: 0.3310
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.4762
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7455 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.7346 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 2.0709 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.9769 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.6297 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 1.6270 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1448 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 2.0081 | Train Acc: 0.3651
 Site-Sketch    | Train Loss: 1.5514 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.6954 | Train Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.7541 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.7415 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.0248 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0985 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.5351 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.8114 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.9791 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.0697 | Val  Acc: 0.3095
 Site-Sketch    | Val  Loss: 1.7008 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.6946 | Val  Acc: 0.5238
Average Valid Accuracy: 0.5024
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.7381
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3095
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4047 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4200 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.9016 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.7074 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.2121 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 1.2678 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 1.9317 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 1.8047 | Train Acc: 0.5873
 Site-Sketch    | Train Loss: 1.2981 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.3552 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.4840 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.3476 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7100 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8899 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.0940 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.4586 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.7335 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.8349 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 1.3214 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.4061 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1089 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0877 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.8251 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.6250 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.9318 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.9713 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.7541 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.6194 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 0.9235 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.9814 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.2444 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0961 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.5086 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.8853 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.8927 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.1717 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.5679 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.6877 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.0278 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.0355 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3571
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-Painting   | Epoch:3 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.9007 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9375 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.5825 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.4021 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.7358 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.8417 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7821 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 1.4798 | Train Acc: 0.6032
 Site-Sketch    | Train Loss: 0.7399 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.8741 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9727 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.8614 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2574 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.5465 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6960 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.8357 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.3884 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.5248 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 0.8296 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.9687 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7167
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 25 ============
============ Train epoch 26 ============
===2023-03-28 00:21:45===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0475 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 1.9542 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.2108 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1574 | Train Acc: 0.2381
 Site-Painting  | Train Loss: 2.0752 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 2.0179 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 2.2409 | Train Acc: 0.1905
 Site-QuickDraw | Train Loss: 2.1839 | Train Acc: 0.2540
 Site-Sketch    | Train Loss: 1.9663 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 2.0406 | Train Acc: 0.4444
 Site-Clipart   | Val  Loss: 1.9928 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.0415 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1366 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1509 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.9615 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 2.1568 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1972 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.2085 | Val  Acc: 0.1667
 Site-Sketch    | Val  Loss: 2.0018 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 2.0731 | Val  Acc: 0.4524
Average Valid Accuracy: 0.3310
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.4762
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7455 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.7346 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 2.0709 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.9769 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.6297 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 1.6270 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1448 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 2.0081 | Train Acc: 0.3651
 Site-Sketch    | Train Loss: 1.5514 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.6954 | Train Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.7541 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.7415 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.0248 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0985 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.5351 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.8114 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.9791 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.0697 | Val  Acc: 0.3095
 Site-Sketch    | Val  Loss: 1.7008 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.6946 | Val  Acc: 0.5238
Average Valid Accuracy: 0.5024
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.7381
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3095
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4047 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4200 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.9016 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.7074 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.2121 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 1.2678 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 1.9317 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 1.8047 | Train Acc: 0.5873
 Site-Sketch    | Train Loss: 1.2981 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.3552 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.4840 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.3476 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7100 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8899 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.0940 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.4586 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.7335 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.8349 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 1.3214 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.4061 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1089 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0877 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.8251 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.6250 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.9318 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.9713 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.7541 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.6194 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 0.9235 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.9814 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.2444 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0961 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.5086 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.8853 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.8927 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.1717 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.5679 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.6877 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.0278 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.0355 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3571
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-Painting   | Epoch:3 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.9007 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9375 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.5825 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.4021 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.7358 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.8417 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7821 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 1.4798 | Train Acc: 0.6032
 Site-Sketch    | Train Loss: 0.7399 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.8741 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9727 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.8614 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2574 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.5465 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6960 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.8357 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.3884 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.5248 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 0.8296 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.9687 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7167
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6598 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7469 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.5474 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.3315 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.5200 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.6003 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.4384 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.3449 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 0.5936 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6026 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.7034 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7487 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.2161 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5956 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.5784 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.6637 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.2774 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.4505 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 0.7129 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6910 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7452
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4762
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5107 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6400 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.0827 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.9657 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.4907 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4498 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.3542 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.2662 | Train Acc: 0.5873
 Site-Sketch    | Train Loss: 0.5937 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.5947 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.5415 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5052 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8603 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.2379 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.3001 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4803 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.1826 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.4391 | Val  Acc: 0.4762
 Site-Sketch    | Val  Loss: 0.5453 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.5915 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7690
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4762
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4041 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4966 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.2533 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9303 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.3810 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.3420 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.1826 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 0.9359 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 0.4322 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.4472 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6117 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5384 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8248 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1652 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.2783 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3445 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.8169 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.1784 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 0.5588 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5474 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8214
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2865 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3220 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.9344 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.8069 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2420 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2641 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3430 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.1366 | Train Acc: 0.5873
 Site-Sketch    | Train Loss: 0.4013 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3774 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3617 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3824 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.6574 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0117 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.2206 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2757 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.0871 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.3443 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 0.3403 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3910 | Val  Acc: 0.9524
Average Valid Accuracy: 0.8357
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7143
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2550 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2416 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.8735 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.6324 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2072 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1926 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3020 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.0667 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 0.3169 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.2322 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.2529 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2759 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.5158 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8891 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.1259 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2191 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.0071 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3036 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 0.2421 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.2414 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8810
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Real...
===2023-03-28 00:48:58===
===2023-03-28 00:48:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of Real: 0.8825
Average Test Accuracy: 0.8825
