===2023-03-29 10:11:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-MNIST     | Train Loss: 1.7537 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.6404 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.6672 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.5786 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2272 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1891 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1687 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.7502 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 2.1329 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2149 | Train Acc: 0.1932
 Site-MNIST     | Val  Loss: 1.6014 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6724 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7038 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.6432 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.2134 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.1688 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2221 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.7598 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 2.1136 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2491 | Val  Acc: 0.1186
Average Valid Accuracy: 0.4136
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2417 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.1476 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.2118 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.0758 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.1686 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.0659 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0536 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 1.2926 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9214 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.0902 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 1.1318 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2020 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.2083 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.1175 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1027 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0483 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1418 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.3610 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 1.9443 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1484 | Val  Acc: 0.1864
Average Valid Accuracy: 0.4847
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1525
 Best site-USPS       | Epoch:1 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8874 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 0.8558 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 0.8449 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.7693 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 2.0454 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.9591 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.9052 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.9296 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.7621 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.8695 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.7761 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8487 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 0.9022 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 0.8195 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.9683 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9731 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 2.0466 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.0249 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.7827 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 1.9175 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5356
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1864
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5621 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.5173 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5521 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4371 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.8749 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8188 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7128 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.6430 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.5805 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.6092 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 0.4661 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5345 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5657 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5027 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.7854 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7834 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.9196 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.7532 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.6538 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.7754 | Val  Acc: 0.3729
Average Valid Accuracy: 0.6000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-USPS       | Epoch:3 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4152 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.3541 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3912 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2790 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7737 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.5788 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.4912 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 0.4398 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.2086 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.3924 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.2902 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4020 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3843 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4116 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.5678 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.6233 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.6881 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.4474 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.4086 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.5738 | Val  Acc: 0.4746
Average Valid Accuracy: 0.7085
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-USPS       | Epoch:4 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3255 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2584 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2747 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.1789 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4114 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 1.4294 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.2177 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 0.3017 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 1.0866 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.1048 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.2079 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2978 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.2665 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2972 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.3379 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.3673 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.4892 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.3793 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.3248 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3435 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7424
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4576
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2057 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1628 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1836 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1141 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3027 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 1.1023 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 0.9989 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.1998 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.8322 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.8321 | Train Acc: 0.7500
 Site-MNIST     | Val  Loss: 0.1281 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2012 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1657 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2017 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.0586 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 1.1420 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.2467 | Val  Acc: 0.5424
 Site-USPS      | Val  Loss: 0.2597 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.1544 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.2564 | Val  Acc: 0.5932
Average Valid Accuracy: 0.7915
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5424
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1471 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1182 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1395 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0797 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0500 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 0.8740 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.8159 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.1574 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.6789 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.6323 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.0995 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1463 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1142 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1423 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8864 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 0.8679 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 0.9570 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 0.2500 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.1065 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.0842 | Val  Acc: 0.6949
Average Valid Accuracy: 0.8458
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7119
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0941 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0795 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0853 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0510 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.8595 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.6539 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.6840 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.1192 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.5620 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.4504 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.0636 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0903 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0813 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1028 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.7491 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.6787 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.7459 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.2041 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0322 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.0629 | Val  Acc: 0.6949
Average Valid Accuracy: 0.8712
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8136
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0664 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0528 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0898 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0382 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7532 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 0.5357 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 0.4863 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.0943 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.5088 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.3587 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.0530 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0892 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0538 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0643 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5602 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.5480 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.5871 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.2054 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0313 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.9581 | Val  Acc: 0.7119
Average Valid Accuracy: 0.8983
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8983
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.7119
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt-align/FedPrompt...
===2023-03-29 10:45:35===
===2023-03-29 10:45:36===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8864
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3340
 Test site-USPS      | Epoch:9 | Test Acc: 0.8817
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5167
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3643
Average Test Accuracy: 0.5966
