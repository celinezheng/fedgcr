===2023-08-12 03:11:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
===2023-08-12 03:12:02===
===2023-08-12 08:28:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 4, 4, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6627 | Train Acc: 0.5849
 Site-MNIST                     (2) | Train Loss: 1.7236 | Train Acc: 0.5390
 Site-USPS                      (2) | Train Loss: 1.6203 | Train Acc: 0.6927
 Site-USPS                      (2) | Train Loss: 1.6366 | Train Acc: 0.6574
 Site-SynthDigits               (0) | Train Loss: 2.0559 | Train Acc: 0.2992
 Site-SynthDigits               (0) | Train Loss: 2.0226 | Train Acc: 0.3417
 Site-MNIST_M                   (1) | Train Loss: 2.1848 | Train Acc: 0.2210
 Site-MNIST_M                   (1) | Train Loss: 2.1833 | Train Acc: 0.2251
 Site-SVHN                      (1) | Train Loss: 2.1921 | Train Acc: 0.1995
 Site-SVHN                      (1) | Train Loss: 2.1735 | Train Acc: 0.2359
Average Train Accuracy: 0.3996
 Site-MNIST                     (2) | Val  Loss: 1.7611 | Val  Acc: 0.5109
 Site-MNIST                     (2) | Val  Loss: 1.6877 | Val  Acc: 0.5791
 Site-USPS                      (2) | Val  Loss: 1.6446 | Val  Acc: 0.6522
 Site-USPS                      (2) | Val  Loss: 1.6560 | Val  Acc: 0.6367
 Site-SynthDigits               (0) | Val  Loss: 2.0734 | Val  Acc: 0.2935
 Site-SynthDigits               (0) | Val  Loss: 2.0365 | Val  Acc: 0.3309
 Site-MNIST_M                   (1) | Val  Loss: 2.2369 | Val  Acc: 0.2283
 Site-MNIST_M                   (1) | Val  Loss: 2.1856 | Val  Acc: 0.2374
 Site-SVHN                      (1) | Val  Loss: 2.1650 | Val  Acc: 0.2935
 Site-SVHN                      (1) | Val  Loss: 2.1733 | Val  Acc: 0.2374
Average Valid Accuracy: 0.4000
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5109
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5791
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.6522
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.6367
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.2935
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3309
 Best site-MNIST_M                  (1)  | Epoch:0 | Val Acc: 0.2283
 Best site-MNIST_M                  (1)  | Epoch:0 | Val Acc: 0.2374
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2935
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 1 ============
cnt=[4, 4, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (1) | Train Loss: 1.2595 | Train Acc: 0.8059
 Site-MNIST                     (1) | Train Loss: 1.3357 | Train Acc: 0.7336
 Site-USPS                      (1) | Train Loss: 1.1645 | Train Acc: 0.8113
 Site-USPS                      (1) | Train Loss: 1.1932 | Train Acc: 0.7901
 Site-SynthDigits               (2) | Train Loss: 1.8224 | Train Acc: 0.3827
 Site-SynthDigits               (2) | Train Loss: 1.7420 | Train Acc: 0.4413
 Site-MNIST_M                   (0) | Train Loss: 1.9518 | Train Acc: 0.3585
 Site-MNIST_M                   (0) | Train Loss: 1.9762 | Train Acc: 0.3354
 Site-SVHN                      (0) | Train Loss: 2.0656 | Train Acc: 0.2642
 Site-SVHN                      (0) | Train Loss: 2.0248 | Train Acc: 0.2996
Average Train Accuracy: 0.5223
 Site-MNIST                     (1) | Val  Loss: 1.3429 | Val  Acc: 0.7283
 Site-MNIST                     (1) | Val  Loss: 1.3018 | Val  Acc: 0.7734
 Site-USPS                      (1) | Val  Loss: 1.2130 | Val  Acc: 0.7609
 Site-USPS                      (1) | Val  Loss: 1.2281 | Val  Acc: 0.7770
 Site-SynthDigits               (2) | Val  Loss: 1.7738 | Val  Acc: 0.3913
 Site-SynthDigits               (2) | Val  Loss: 1.7512 | Val  Acc: 0.4065
 Site-MNIST_M                   (0) | Val  Loss: 2.0151 | Val  Acc: 0.3370
 Site-MNIST_M                   (0) | Val  Loss: 1.9423 | Val  Acc: 0.3993
 Site-SVHN                      (0) | Val  Loss: 2.0463 | Val  Acc: 0.3152
 Site-SVHN                      (0) | Val  Loss: 2.0603 | Val  Acc: 0.3022
Average Valid Accuracy: 0.5191
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7283
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7734
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.7609
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.7770
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3913
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.4065
 Best site-MNIST_M                  (0)  | Epoch:1 | Val Acc: 0.3370
 Best site-MNIST_M                  (0)  | Epoch:1 | Val Acc: 0.3993
 Best site-SVHN                     (0)  | Epoch:1 | Val Acc: 0.3152
 Best site-SVHN                     (0)  | Epoch:1 | Val Acc: 0.3022
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (1) | Train Loss: 1.1046 | Train Acc: 0.7817
 Site-MNIST                     (1) | Train Loss: 1.1927 | Train Acc: 0.7175
 Site-USPS                      (0) | Train Loss: 0.9989 | Train Acc: 0.8248
 Site-USPS                      (0) | Train Loss: 1.0341 | Train Acc: 0.7901
 Site-SynthDigits               (1) | Train Loss: 1.5810 | Train Acc: 0.4960
 Site-SynthDigits               (1) | Train Loss: 1.4998 | Train Acc: 0.5274
 Site-MNIST_M                   (2) | Train Loss: 1.7144 | Train Acc: 0.4609
 Site-MNIST_M                   (2) | Train Loss: 1.7744 | Train Acc: 0.4135
 Site-SVHN                      (1) | Train Loss: 1.9451 | Train Acc: 0.3504
 Site-SVHN                      (1) | Train Loss: 1.8853 | Train Acc: 0.3435
Average Train Accuracy: 0.5706
 Site-MNIST                     (1) | Val  Loss: 1.1816 | Val  Acc: 0.7391
 Site-MNIST                     (1) | Val  Loss: 1.1635 | Val  Acc: 0.7770
 Site-USPS                      (0) | Val  Loss: 1.0496 | Val  Acc: 0.7935
 Site-USPS                      (0) | Val  Loss: 1.0698 | Val  Acc: 0.7914
 Site-SynthDigits               (1) | Val  Loss: 1.5076 | Val  Acc: 0.4674
 Site-SynthDigits               (1) | Val  Loss: 1.4848 | Val  Acc: 0.4964
 Site-MNIST_M                   (2) | Val  Loss: 1.8003 | Val  Acc: 0.4239
 Site-MNIST_M                   (2) | Val  Loss: 1.7125 | Val  Acc: 0.5000
 Site-SVHN                      (1) | Val  Loss: 1.9265 | Val  Acc: 0.3370
 Site-SVHN                      (1) | Val  Loss: 1.9484 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5685
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7391
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7770
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7935
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7914
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.4674
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.4964
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.4239
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.5000
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3370
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3597
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (1) | Train Loss: 0.8507 | Train Acc: 0.8706
 Site-MNIST                     (1) | Train Loss: 0.9363 | Train Acc: 0.8027
 Site-USPS                      (1) | Train Loss: 0.8046 | Train Acc: 0.8625
 Site-USPS                      (1) | Train Loss: 0.8318 | Train Acc: 0.8332
 Site-SynthDigits               (1) | Train Loss: 1.3829 | Train Acc: 0.5876
 Site-SynthDigits               (1) | Train Loss: 1.2870 | Train Acc: 0.6413
 Site-MNIST_M                   (0) | Train Loss: 1.5758 | Train Acc: 0.5067
 Site-MNIST_M                   (0) | Train Loss: 1.6096 | Train Acc: 0.4924
 Site-SVHN                      (2) | Train Loss: 1.8219 | Train Acc: 0.3962
 Site-SVHN                      (2) | Train Loss: 1.7438 | Train Acc: 0.4206
Average Train Accuracy: 0.6414
 Site-MNIST                     (1) | Val  Loss: 0.9257 | Val  Acc: 0.8152
 Site-MNIST                     (1) | Val  Loss: 0.9183 | Val  Acc: 0.8309
 Site-USPS                      (1) | Val  Loss: 0.8804 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.8778 | Val  Acc: 0.8094
 Site-SynthDigits               (1) | Val  Loss: 1.3264 | Val  Acc: 0.5870
 Site-SynthDigits               (1) | Val  Loss: 1.2876 | Val  Acc: 0.5863
 Site-MNIST_M                   (0) | Val  Loss: 1.6611 | Val  Acc: 0.4239
 Site-MNIST_M                   (0) | Val  Loss: 1.5598 | Val  Acc: 0.5288
 Site-SVHN                      (2) | Val  Loss: 1.8017 | Val  Acc: 0.3370
 Site-SVHN                      (2) | Val  Loss: 1.8289 | Val  Acc: 0.3993
Average Valid Accuracy: 0.6068
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8152
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8309
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.7500
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.8094
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.5870
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.5863
 Best site-MNIST_M                  (0)  | Epoch:3 | Val Acc: 0.4239
 Best site-MNIST_M                  (0)  | Epoch:3 | Val Acc: 0.5288
 Best site-SVHN                     (2)  | Epoch:3 | Val Acc: 0.3370
 Best site-SVHN                     (2)  | Epoch:3 | Val Acc: 0.3993
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 4 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 0.7205 | Train Acc: 0.8733
 Site-MNIST                     (0) | Train Loss: 0.8140 | Train Acc: 0.8350
 Site-USPS                      (2) | Train Loss: 0.7217 | Train Acc: 0.8598
 Site-USPS                      (2) | Train Loss: 0.7459 | Train Acc: 0.8377
 Site-SynthDigits               (0) | Train Loss: 1.2048 | Train Acc: 0.6523
 Site-SynthDigits               (0) | Train Loss: 1.1174 | Train Acc: 0.6978
 Site-MNIST_M                   (1) | Train Loss: 1.4591 | Train Acc: 0.6011
 Site-MNIST_M                   (1) | Train Loss: 1.5025 | Train Acc: 0.5453
 Site-SVHN                      (0) | Train Loss: 1.6708 | Train Acc: 0.4636
 Site-SVHN                      (0) | Train Loss: 1.5954 | Train Acc: 0.4816
Average Train Accuracy: 0.6847
 Site-MNIST                     (0) | Val  Loss: 0.7652 | Val  Acc: 0.8370
 Site-MNIST                     (0) | Val  Loss: 0.7895 | Val  Acc: 0.8489
 Site-USPS                      (2) | Val  Loss: 0.8106 | Val  Acc: 0.7609
 Site-USPS                      (2) | Val  Loss: 0.8025 | Val  Acc: 0.8129
 Site-SynthDigits               (0) | Val  Loss: 1.1465 | Val  Acc: 0.6413
 Site-SynthDigits               (0) | Val  Loss: 1.1304 | Val  Acc: 0.6439
 Site-MNIST_M                   (1) | Val  Loss: 1.5608 | Val  Acc: 0.5217
 Site-MNIST_M                   (1) | Val  Loss: 1.4580 | Val  Acc: 0.5863
 Site-SVHN                      (0) | Val  Loss: 1.6640 | Val  Acc: 0.4022
 Site-SVHN                      (0) | Val  Loss: 1.6693 | Val  Acc: 0.4676
Average Valid Accuracy: 0.6523
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8370
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8489
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.7609
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.8129
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.6413
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.6439
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5217
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5863
 Best site-SVHN                     (0)  | Epoch:4 | Val Acc: 0.4022
 Best site-SVHN                     (0)  | Epoch:4 | Val Acc: 0.4676
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 5 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.6394 | Train Acc: 0.8814
 Site-MNIST                     (0) | Train Loss: 0.7226 | Train Acc: 0.8269
 Site-USPS                      (2) | Train Loss: 0.6628 | Train Acc: 0.8518
 Site-USPS                      (2) | Train Loss: 0.6852 | Train Acc: 0.8323
 Site-SynthDigits               (0) | Train Loss: 1.1169 | Train Acc: 0.6550
 Site-SynthDigits               (0) | Train Loss: 1.0234 | Train Acc: 0.7112
 Site-MNIST_M                   (1) | Train Loss: 1.3245 | Train Acc: 0.6334
 Site-MNIST_M                   (1) | Train Loss: 1.3783 | Train Acc: 0.6000
 Site-SVHN                      (0) | Train Loss: 1.5667 | Train Acc: 0.4690
 Site-SVHN                      (0) | Train Loss: 1.4904 | Train Acc: 0.4942
Average Train Accuracy: 0.6955
 Site-MNIST                     (0) | Val  Loss: 0.6662 | Val  Acc: 0.8370
 Site-MNIST                     (0) | Val  Loss: 0.7058 | Val  Acc: 0.8525
 Site-USPS                      (2) | Val  Loss: 0.7589 | Val  Acc: 0.7717
 Site-USPS                      (2) | Val  Loss: 0.7479 | Val  Acc: 0.8129
 Site-SynthDigits               (0) | Val  Loss: 1.0410 | Val  Acc: 0.6304
 Site-SynthDigits               (0) | Val  Loss: 1.0516 | Val  Acc: 0.6115
 Site-MNIST_M                   (1) | Val  Loss: 1.4299 | Val  Acc: 0.5543
 Site-MNIST_M                   (1) | Val  Loss: 1.3311 | Val  Acc: 0.6367
 Site-SVHN                      (0) | Val  Loss: 1.5411 | Val  Acc: 0.4457
 Site-SVHN                      (0) | Val  Loss: 1.5480 | Val  Acc: 0.4748
Average Valid Accuracy: 0.6628
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8370
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8525
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.7717
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.8129
 Best site-SynthDigits              (0)  | Epoch:5 | Val Acc: 0.6304
 Best site-SynthDigits              (0)  | Epoch:5 | Val Acc: 0.6115
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.5543
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.6367
 Best site-SVHN                     (0)  | Epoch:5 | Val Acc: 0.4457
 Best site-SVHN                     (0)  | Epoch:5 | Val Acc: 0.4748
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 4, 4, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (2) | Train Loss: 0.5460 | Train Acc: 0.8976
 Site-MNIST                     (2) | Train Loss: 0.6382 | Train Acc: 0.8493
 Site-USPS                      (1) | Train Loss: 0.5930 | Train Acc: 0.8787
 Site-USPS                      (1) | Train Loss: 0.6102 | Train Acc: 0.8538
 Site-SynthDigits               (2) | Train Loss: 0.9893 | Train Acc: 0.6873
 Site-SynthDigits               (2) | Train Loss: 0.9097 | Train Acc: 0.7426
 Site-MNIST_M                   (0) | Train Loss: 1.2734 | Train Acc: 0.6469
 Site-MNIST_M                   (0) | Train Loss: 1.3005 | Train Acc: 0.6161
 Site-SVHN                      (1) | Train Loss: 1.4351 | Train Acc: 0.5337
 Site-SVHN                      (1) | Train Loss: 1.3535 | Train Acc: 0.5623
Average Train Accuracy: 0.7268
 Site-MNIST                     (2) | Val  Loss: 0.5767 | Val  Acc: 0.8478
 Site-MNIST                     (2) | Val  Loss: 0.6199 | Val  Acc: 0.8561
 Site-USPS                      (1) | Val  Loss: 0.6968 | Val  Acc: 0.7826
 Site-USPS                      (1) | Val  Loss: 0.6712 | Val  Acc: 0.8345
 Site-SynthDigits               (2) | Val  Loss: 0.9411 | Val  Acc: 0.6630
 Site-SynthDigits               (2) | Val  Loss: 0.9314 | Val  Acc: 0.6978
 Site-MNIST_M                   (0) | Val  Loss: 1.3602 | Val  Acc: 0.5326
 Site-MNIST_M                   (0) | Val  Loss: 1.2688 | Val  Acc: 0.6187
 Site-SVHN                      (1) | Val  Loss: 1.3856 | Val  Acc: 0.5109
 Site-SVHN                      (1) | Val  Loss: 1.4009 | Val  Acc: 0.5468
Average Valid Accuracy: 0.6891
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8478
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8561
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7826
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8345
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6630
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6978
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.5326
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.6187
 Best site-SVHN                     (1)  | Epoch:6 | Val Acc: 0.5109
 Best site-SVHN                     (1)  | Epoch:6 | Val Acc: 0.5468
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 7 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (1) | Train Loss: 0.5159 | Train Acc: 0.8814
 Site-MNIST                     (1) | Train Loss: 0.5972 | Train Acc: 0.8386
 Site-USPS                      (0) | Train Loss: 0.5455 | Train Acc: 0.8841
 Site-USPS                      (0) | Train Loss: 0.5693 | Train Acc: 0.8619
 Site-SynthDigits               (0) | Train Loss: 0.9387 | Train Acc: 0.7224
 Site-SynthDigits               (0) | Train Loss: 0.8443 | Train Acc: 0.7614
 Site-MNIST_M                   (2) | Train Loss: 1.1711 | Train Acc: 0.6604
 Site-MNIST_M                   (2) | Train Loss: 1.1989 | Train Acc: 0.6520
 Site-SVHN                      (0) | Train Loss: 1.3861 | Train Acc: 0.5418
 Site-SVHN                      (0) | Train Loss: 1.3180 | Train Acc: 0.5785
Average Train Accuracy: 0.7382
 Site-MNIST                     (1) | Val  Loss: 0.5259 | Val  Acc: 0.8261
 Site-MNIST                     (1) | Val  Loss: 0.5821 | Val  Acc: 0.8453
 Site-USPS                      (0) | Val  Loss: 0.6528 | Val  Acc: 0.7826
 Site-USPS                      (0) | Val  Loss: 0.6221 | Val  Acc: 0.8453
 Site-SynthDigits               (0) | Val  Loss: 0.8867 | Val  Acc: 0.6957
 Site-SynthDigits               (0) | Val  Loss: 0.8713 | Val  Acc: 0.7266
 Site-MNIST_M                   (2) | Val  Loss: 1.2539 | Val  Acc: 0.5761
 Site-MNIST_M                   (2) | Val  Loss: 1.1692 | Val  Acc: 0.6583
 Site-SVHN                      (0) | Val  Loss: 1.3392 | Val  Acc: 0.5000
 Site-SVHN                      (0) | Val  Loss: 1.3611 | Val  Acc: 0.5540
Average Valid Accuracy: 0.7010
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8261
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8453
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7826
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8453
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.6957
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.7266
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.5761
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.6583
 Best site-SVHN                     (0)  | Epoch:7 | Val Acc: 0.5000
 Best site-SVHN                     (0)  | Epoch:7 | Val Acc: 0.5540
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 4, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (1) | Train Loss: 0.4599 | Train Acc: 0.9084
 Site-MNIST                     (1) | Train Loss: 0.5470 | Train Acc: 0.8529
 Site-USPS                      (2) | Train Loss: 0.5186 | Train Acc: 0.8733
 Site-USPS                      (2) | Train Loss: 0.5355 | Train Acc: 0.8592
 Site-SynthDigits               (1) | Train Loss: 0.8539 | Train Acc: 0.7493
 Site-SynthDigits               (1) | Train Loss: 0.7720 | Train Acc: 0.7848
 Site-MNIST_M                   (0) | Train Loss: 1.1156 | Train Acc: 0.6604
 Site-MNIST_M                   (0) | Train Loss: 1.1293 | Train Acc: 0.6709
 Site-SVHN                      (2) | Train Loss: 1.3264 | Train Acc: 0.5553
 Site-SVHN                      (2) | Train Loss: 1.2681 | Train Acc: 0.5874
Average Train Accuracy: 0.7502
 Site-MNIST                     (1) | Val  Loss: 0.4688 | Val  Acc: 0.8478
 Site-MNIST                     (1) | Val  Loss: 0.5307 | Val  Acc: 0.8705
 Site-USPS                      (2) | Val  Loss: 0.6329 | Val  Acc: 0.7826
 Site-USPS                      (2) | Val  Loss: 0.5976 | Val  Acc: 0.8417
 Site-SynthDigits               (1) | Val  Loss: 0.8029 | Val  Acc: 0.7391
 Site-SynthDigits               (1) | Val  Loss: 0.8031 | Val  Acc: 0.7410
 Site-MNIST_M                   (0) | Val  Loss: 1.1946 | Val  Acc: 0.5761
 Site-MNIST_M                   (0) | Val  Loss: 1.1026 | Val  Acc: 0.6871
 Site-SVHN                      (2) | Val  Loss: 1.3126 | Val  Acc: 0.5761
 Site-SVHN                      (2) | Val  Loss: 1.3169 | Val  Acc: 0.5755
Average Valid Accuracy: 0.7238
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8478
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8705
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.7826
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.8417
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.7391
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.7410
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.5761
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.6871
 Best site-SVHN                     (2)  | Epoch:8 | Val Acc: 0.5761
 Best site-SVHN                     (2)  | Epoch:8 | Val Acc: 0.5755
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 9 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (2) | Train Loss: 0.4271 | Train Acc: 0.8976
 Site-MNIST                     (2) | Train Loss: 0.5119 | Train Acc: 0.8511
 Site-USPS                      (0) | Train Loss: 0.4896 | Train Acc: 0.8733
 Site-USPS                      (0) | Train Loss: 0.5056 | Train Acc: 0.8655
 Site-SynthDigits               (0) | Train Loss: 0.8163 | Train Acc: 0.7709
 Site-SynthDigits               (0) | Train Loss: 0.7353 | Train Acc: 0.7928
 Site-MNIST_M                   (1) | Train Loss: 1.0618 | Train Acc: 0.6739
 Site-MNIST_M                   (1) | Train Loss: 1.0741 | Train Acc: 0.6852
 Site-SVHN                      (0) | Train Loss: 1.2692 | Train Acc: 0.5741
 Site-SVHN                      (0) | Train Loss: 1.2091 | Train Acc: 0.6045
Average Train Accuracy: 0.7589
 Site-MNIST                     (2) | Val  Loss: 0.4351 | Val  Acc: 0.8370
 Site-MNIST                     (2) | Val  Loss: 0.4961 | Val  Acc: 0.8525
 Site-USPS                      (0) | Val  Loss: 0.6077 | Val  Acc: 0.7935
 Site-USPS                      (0) | Val  Loss: 0.5655 | Val  Acc: 0.8381
 Site-SynthDigits               (0) | Val  Loss: 0.7800 | Val  Acc: 0.7283
 Site-SynthDigits               (0) | Val  Loss: 0.7649 | Val  Acc: 0.7446
 Site-MNIST_M                   (1) | Val  Loss: 1.1383 | Val  Acc: 0.5870
 Site-MNIST_M                   (1) | Val  Loss: 1.0397 | Val  Acc: 0.6835
 Site-SVHN                      (0) | Val  Loss: 1.2414 | Val  Acc: 0.5761
 Site-SVHN                      (0) | Val  Loss: 1.2579 | Val  Acc: 0.6187
Average Valid Accuracy: 0.7259
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8370
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8525
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.7935
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8381
 Best site-SynthDigits              (0)  | Epoch:9 | Val Acc: 0.7283
 Best site-SynthDigits              (0)  | Epoch:9 | Val Acc: 0.7446
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.5870
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.6835
 Best site-SVHN                     (0)  | Epoch:9 | Val Acc: 0.5761
 Best site-SVHN                     (0)  | Epoch:9 | Val Acc: 0.6187
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (2) | Train Loss: 0.4112 | Train Acc: 0.8922
 Site-MNIST                     (2) | Train Loss: 0.4981 | Train Acc: 0.8529
 Site-USPS                      (1) | Train Loss: 0.4950 | Train Acc: 0.8787
 Site-USPS                      (1) | Train Loss: 0.5179 | Train Acc: 0.8601
 Site-SynthDigits               (1) | Train Loss: 0.7393 | Train Acc: 0.7951
 Site-SynthDigits               (1) | Train Loss: 0.6712 | Train Acc: 0.8072
 Site-MNIST_M                   (0) | Train Loss: 1.0079 | Train Acc: 0.6846
 Site-MNIST_M                   (0) | Train Loss: 1.0016 | Train Acc: 0.7175
 Site-SVHN                      (1) | Train Loss: 1.2618 | Train Acc: 0.5822
 Site-SVHN                      (1) | Train Loss: 1.2042 | Train Acc: 0.6045
Average Train Accuracy: 0.7675
 Site-MNIST                     (2) | Val  Loss: 0.4104 | Val  Acc: 0.8587
 Site-MNIST                     (2) | Val  Loss: 0.4865 | Val  Acc: 0.8669
 Site-USPS                      (1) | Val  Loss: 0.6093 | Val  Acc: 0.7935
 Site-USPS                      (1) | Val  Loss: 0.5719 | Val  Acc: 0.8309
 Site-SynthDigits               (1) | Val  Loss: 0.6873 | Val  Acc: 0.7500
 Site-SynthDigits               (1) | Val  Loss: 0.7033 | Val  Acc: 0.7554
 Site-MNIST_M                   (0) | Val  Loss: 1.0686 | Val  Acc: 0.6196
 Site-MNIST_M                   (0) | Val  Loss: 0.9807 | Val  Acc: 0.7086
 Site-SVHN                      (1) | Val  Loss: 1.2335 | Val  Acc: 0.5870
 Site-SVHN                      (1) | Val  Loss: 1.2377 | Val  Acc: 0.5935
Average Valid Accuracy: 0.7364
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8587
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8669
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.7935
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.8309
 Best site-SynthDigits              (1)  | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits              (1)  | Epoch:10 | Val Acc: 0.7554
 Best site-MNIST_M                  (0)  | Epoch:10 | Val Acc: 0.6196
 Best site-MNIST_M                  (0)  | Epoch:10 | Val Acc: 0.7086
 Best site-SVHN                     (1)  | Epoch:10 | Val Acc: 0.5870
 Best site-SVHN                     (1)  | Epoch:10 | Val Acc: 0.5935
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 6, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (2) | Train Loss: 0.3939 | Train Acc: 0.9003
 Site-MNIST                     (2) | Train Loss: 0.4842 | Train Acc: 0.8547
 Site-USPS                      (2) | Train Loss: 0.4521 | Train Acc: 0.8625
 Site-USPS                      (2) | Train Loss: 0.4818 | Train Acc: 0.8744
 Site-SynthDigits               (2) | Train Loss: 0.7139 | Train Acc: 0.7951
 Site-SynthDigits               (2) | Train Loss: 0.6415 | Train Acc: 0.8135
 Site-MNIST_M                   (1) | Train Loss: 1.0003 | Train Acc: 0.6739
 Site-MNIST_M                   (1) | Train Loss: 0.9932 | Train Acc: 0.7040
 Site-SVHN                      (0) | Train Loss: 1.1782 | Train Acc: 0.5930
 Site-SVHN                      (0) | Train Loss: 1.0898 | Train Acc: 0.6538
Average Train Accuracy: 0.7725
 Site-MNIST                     (2) | Val  Loss: 0.3959 | Val  Acc: 0.8478
 Site-MNIST                     (2) | Val  Loss: 0.4679 | Val  Acc: 0.8705
 Site-USPS                      (2) | Val  Loss: 0.5750 | Val  Acc: 0.8043
 Site-USPS                      (2) | Val  Loss: 0.5312 | Val  Acc: 0.8417
 Site-SynthDigits               (2) | Val  Loss: 0.6757 | Val  Acc: 0.7500
 Site-SynthDigits               (2) | Val  Loss: 0.6731 | Val  Acc: 0.7518
 Site-MNIST_M                   (1) | Val  Loss: 1.0611 | Val  Acc: 0.6413
 Site-MNIST_M                   (1) | Val  Loss: 0.9692 | Val  Acc: 0.6978
 Site-SVHN                      (0) | Val  Loss: 1.1162 | Val  Acc: 0.6196
 Site-SVHN                      (0) | Val  Loss: 1.1384 | Val  Acc: 0.6439
Average Valid Accuracy: 0.7469
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8478
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8705
 Best site-USPS                     (2)  | Epoch:11 | Val Acc: 0.8043
 Best site-USPS                     (2)  | Epoch:11 | Val Acc: 0.8417
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7500
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7518
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.6413
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.6978
 Best site-SVHN                     (0)  | Epoch:11 | Val Acc: 0.6196
 Best site-SVHN                     (0)  | Epoch:11 | Val Acc: 0.6439
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 12 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (2) | Train Loss: 0.3637 | Train Acc: 0.8949
 Site-MNIST                     (2) | Train Loss: 0.4454 | Train Acc: 0.8619
 Site-USPS                      (0) | Train Loss: 0.4396 | Train Acc: 0.8760
 Site-USPS                      (0) | Train Loss: 0.4599 | Train Acc: 0.8664
 Site-SynthDigits               (0) | Train Loss: 0.6725 | Train Acc: 0.8194
 Site-SynthDigits               (0) | Train Loss: 0.5952 | Train Acc: 0.8233
 Site-MNIST_M                   (1) | Train Loss: 0.9256 | Train Acc: 0.7170
 Site-MNIST_M                   (1) | Train Loss: 0.9038 | Train Acc: 0.7453
 Site-SVHN                      (0) | Train Loss: 1.1644 | Train Acc: 0.5957
 Site-SVHN                      (0) | Train Loss: 1.0859 | Train Acc: 0.6502
Average Train Accuracy: 0.7850
 Site-MNIST                     (2) | Val  Loss: 0.3679 | Val  Acc: 0.8478
 Site-MNIST                     (2) | Val  Loss: 0.4386 | Val  Acc: 0.8597
 Site-USPS                      (0) | Val  Loss: 0.5585 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.5150 | Val  Acc: 0.8489
 Site-SynthDigits               (0) | Val  Loss: 0.6310 | Val  Acc: 0.7609
 Site-SynthDigits               (0) | Val  Loss: 0.6355 | Val  Acc: 0.7842
 Site-MNIST_M                   (1) | Val  Loss: 0.9823 | Val  Acc: 0.6739
 Site-MNIST_M                   (1) | Val  Loss: 0.8881 | Val  Acc: 0.7446
 Site-SVHN                      (0) | Val  Loss: 1.1327 | Val  Acc: 0.5978
 Site-SVHN                      (0) | Val  Loss: 1.1397 | Val  Acc: 0.6439
Average Valid Accuracy: 0.7577
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8478
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8597
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.8152
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.8489
 Best site-SynthDigits              (0)  | Epoch:12 | Val Acc: 0.7609
 Best site-SynthDigits              (0)  | Epoch:12 | Val Acc: 0.7842
 Best site-MNIST_M                  (1)  | Epoch:12 | Val Acc: 0.6739
 Best site-MNIST_M                  (1)  | Epoch:12 | Val Acc: 0.7446
 Best site-SVHN                     (0)  | Epoch:12 | Val Acc: 0.5978
 Best site-SVHN                     (0)  | Epoch:12 | Val Acc: 0.6439
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.3423 | Train Acc: 0.9057
 Site-MNIST                     (2) | Train Loss: 0.4193 | Train Acc: 0.8762
 Site-USPS                      (1) | Train Loss: 0.4028 | Train Acc: 0.8868
 Site-USPS                      (1) | Train Loss: 0.4180 | Train Acc: 0.8825
 Site-SynthDigits               (1) | Train Loss: 0.6381 | Train Acc: 0.8248
 Site-SynthDigits               (1) | Train Loss: 0.5654 | Train Acc: 0.8413
 Site-MNIST_M                   (0) | Train Loss: 0.8930 | Train Acc: 0.7466
 Site-MNIST_M                   (0) | Train Loss: 0.8796 | Train Acc: 0.7507
 Site-SVHN                      (1) | Train Loss: 1.1438 | Train Acc: 0.5984
 Site-SVHN                      (1) | Train Loss: 1.0555 | Train Acc: 0.6529
Average Train Accuracy: 0.7966
 Site-MNIST                     (2) | Val  Loss: 0.3343 | Val  Acc: 0.8587
 Site-MNIST                     (2) | Val  Loss: 0.4122 | Val  Acc: 0.8849
 Site-USPS                      (1) | Val  Loss: 0.5272 | Val  Acc: 0.8152
 Site-USPS                      (1) | Val  Loss: 0.4775 | Val  Acc: 0.8561
 Site-SynthDigits               (1) | Val  Loss: 0.6072 | Val  Acc: 0.7826
 Site-SynthDigits               (1) | Val  Loss: 0.6025 | Val  Acc: 0.7914
 Site-MNIST_M                   (0) | Val  Loss: 0.9461 | Val  Acc: 0.6957
 Site-MNIST_M                   (0) | Val  Loss: 0.8566 | Val  Acc: 0.7482
 Site-SVHN                      (1) | Val  Loss: 1.0891 | Val  Acc: 0.6196
 Site-SVHN                      (1) | Val  Loss: 1.1087 | Val  Acc: 0.6403
Average Valid Accuracy: 0.7693
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8587
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8849
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8152
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8561
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7826
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7914
 Best site-MNIST_M                  (0)  | Epoch:13 | Val Acc: 0.6957
 Best site-MNIST_M                  (0)  | Epoch:13 | Val Acc: 0.7482
 Best site-SVHN                     (1)  | Epoch:13 | Val Acc: 0.6196
 Best site-SVHN                     (1)  | Epoch:13 | Val Acc: 0.6403
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (2) | Train Loss: 0.3166 | Train Acc: 0.9057
 Site-MNIST                     (2) | Train Loss: 0.3919 | Train Acc: 0.8897
 Site-USPS                      (1) | Train Loss: 0.3949 | Train Acc: 0.8868
 Site-USPS                      (1) | Train Loss: 0.4087 | Train Acc: 0.8780
 Site-SynthDigits               (1) | Train Loss: 0.6080 | Train Acc: 0.8383
 Site-SynthDigits               (1) | Train Loss: 0.5386 | Train Acc: 0.8529
 Site-MNIST_M                   (0) | Train Loss: 0.8541 | Train Acc: 0.7439
 Site-MNIST_M                   (0) | Train Loss: 0.8348 | Train Acc: 0.7695
 Site-SVHN                      (1) | Train Loss: 1.1044 | Train Acc: 0.6199
 Site-SVHN                      (1) | Train Loss: 1.0276 | Train Acc: 0.6583
Average Train Accuracy: 0.8043
 Site-MNIST                     (2) | Val  Loss: 0.3131 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3882 | Val  Acc: 0.8849
 Site-USPS                      (1) | Val  Loss: 0.5210 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.4641 | Val  Acc: 0.8417
 Site-SynthDigits               (1) | Val  Loss: 0.5726 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.5689 | Val  Acc: 0.8273
 Site-MNIST_M                   (0) | Val  Loss: 0.8930 | Val  Acc: 0.7283
 Site-MNIST_M                   (0) | Val  Loss: 0.8067 | Val  Acc: 0.7662
 Site-SVHN                      (1) | Val  Loss: 1.0700 | Val  Acc: 0.6304
 Site-SVHN                      (1) | Val  Loss: 1.0802 | Val  Acc: 0.6619
Average Valid Accuracy: 0.7862
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8913
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8849
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8417
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.8261
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.8273
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.7283
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.7662
 Best site-SVHN                     (1)  | Epoch:14 | Val Acc: 0.6304
 Best site-SVHN                     (1)  | Epoch:14 | Val Acc: 0.6619
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (0) | Train Loss: 0.3106 | Train Acc: 0.9084
 Site-MNIST                     (0) | Train Loss: 0.3809 | Train Acc: 0.8897
 Site-USPS                      (1) | Train Loss: 0.3914 | Train Acc: 0.8895
 Site-USPS                      (1) | Train Loss: 0.3987 | Train Acc: 0.8870
 Site-SynthDigits               (1) | Train Loss: 0.5803 | Train Acc: 0.8410
 Site-SynthDigits               (1) | Train Loss: 0.5209 | Train Acc: 0.8574
 Site-MNIST_M                   (2) | Train Loss: 0.8101 | Train Acc: 0.7466
 Site-MNIST_M                   (2) | Train Loss: 0.7869 | Train Acc: 0.7830
 Site-SVHN                      (1) | Train Loss: 1.0918 | Train Acc: 0.6226
 Site-SVHN                      (1) | Train Loss: 1.0259 | Train Acc: 0.6610
Average Train Accuracy: 0.8086
 Site-MNIST                     (0) | Val  Loss: 0.3026 | Val  Acc: 0.8913
 Site-MNIST                     (0) | Val  Loss: 0.3769 | Val  Acc: 0.9029
 Site-USPS                      (1) | Val  Loss: 0.5035 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.4512 | Val  Acc: 0.8453
 Site-SynthDigits               (1) | Val  Loss: 0.5455 | Val  Acc: 0.8043
 Site-SynthDigits               (1) | Val  Loss: 0.5503 | Val  Acc: 0.8129
 Site-MNIST_M                   (2) | Val  Loss: 0.8589 | Val  Acc: 0.7283
 Site-MNIST_M                   (2) | Val  Loss: 0.7646 | Val  Acc: 0.7842
 Site-SVHN                      (1) | Val  Loss: 1.0786 | Val  Acc: 0.6413
 Site-SVHN                      (1) | Val  Loss: 1.0687 | Val  Acc: 0.6619
Average Valid Accuracy: 0.7877
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.8913
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9029
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8453
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8043
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8129
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.7283
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.7842
 Best site-SVHN                     (1)  | Epoch:15 | Val Acc: 0.6413
 Best site-SVHN                     (1)  | Epoch:15 | Val Acc: 0.6619
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 16 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (2) | Train Loss: 0.2955 | Train Acc: 0.9084
 Site-MNIST                     (2) | Train Loss: 0.3704 | Train Acc: 0.8987
 Site-USPS                      (0) | Train Loss: 0.3693 | Train Acc: 0.8949
 Site-USPS                      (0) | Train Loss: 0.3842 | Train Acc: 0.8924
 Site-SynthDigits               (0) | Train Loss: 0.5661 | Train Acc: 0.8356
 Site-SynthDigits               (0) | Train Loss: 0.5093 | Train Acc: 0.8628
 Site-MNIST_M                   (1) | Train Loss: 0.8005 | Train Acc: 0.7520
 Site-MNIST_M                   (1) | Train Loss: 0.7692 | Train Acc: 0.7901
 Site-SVHN                      (0) | Train Loss: 1.0482 | Train Acc: 0.6415
 Site-SVHN                      (0) | Train Loss: 0.9606 | Train Acc: 0.6906
Average Train Accuracy: 0.8167
 Site-MNIST                     (2) | Val  Loss: 0.2855 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.3632 | Val  Acc: 0.9029
 Site-USPS                      (0) | Val  Loss: 0.4877 | Val  Acc: 0.8043
 Site-USPS                      (0) | Val  Loss: 0.4274 | Val  Acc: 0.8525
 Site-SynthDigits               (0) | Val  Loss: 0.5418 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.5312 | Val  Acc: 0.8309
 Site-MNIST_M                   (1) | Val  Loss: 0.8381 | Val  Acc: 0.7391
 Site-MNIST_M                   (1) | Val  Loss: 0.7501 | Val  Acc: 0.7734
 Site-SVHN                      (0) | Val  Loss: 0.9978 | Val  Acc: 0.7065
 Site-SVHN                      (0) | Val  Loss: 1.0096 | Val  Acc: 0.7014
Average Valid Accuracy: 0.8050
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9022
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9029
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8043
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8525
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8370
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8309
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7391
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7734
 Best site-SVHN                     (0)  | Epoch:16 | Val Acc: 0.7065
 Best site-SVHN                     (0)  | Epoch:16 | Val Acc: 0.7014
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 17 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (1) | Train Loss: 0.2806 | Train Acc: 0.9137
 Site-MNIST                     (1) | Train Loss: 0.3494 | Train Acc: 0.9040
 Site-USPS                      (0) | Train Loss: 0.3419 | Train Acc: 0.8895
 Site-USPS                      (0) | Train Loss: 0.3564 | Train Acc: 0.9013
 Site-SynthDigits               (0) | Train Loss: 0.5604 | Train Acc: 0.8437
 Site-SynthDigits               (0) | Train Loss: 0.5034 | Train Acc: 0.8664
 Site-MNIST_M                   (2) | Train Loss: 0.7656 | Train Acc: 0.7520
 Site-MNIST_M                   (2) | Train Loss: 0.7349 | Train Acc: 0.7901
 Site-SVHN                      (0) | Train Loss: 1.0346 | Train Acc: 0.6442
 Site-SVHN                      (0) | Train Loss: 0.9341 | Train Acc: 0.6924
Average Train Accuracy: 0.8197
 Site-MNIST                     (1) | Val  Loss: 0.2726 | Val  Acc: 0.9022
 Site-MNIST                     (1) | Val  Loss: 0.3502 | Val  Acc: 0.9101
 Site-USPS                      (0) | Val  Loss: 0.4682 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.4064 | Val  Acc: 0.8561
 Site-SynthDigits               (0) | Val  Loss: 0.5371 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.5255 | Val  Acc: 0.8237
 Site-MNIST_M                   (2) | Val  Loss: 0.8108 | Val  Acc: 0.7391
 Site-MNIST_M                   (2) | Val  Loss: 0.7274 | Val  Acc: 0.7914
 Site-SVHN                      (0) | Val  Loss: 0.9696 | Val  Acc: 0.7065
 Site-SVHN                      (0) | Val  Loss: 0.9849 | Val  Acc: 0.6942
Average Valid Accuracy: 0.8076
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9022
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9101
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8152
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8561
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8370
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8237
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.7391
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.7914
 Best site-SVHN                     (0)  | Epoch:17 | Val Acc: 0.7065
 Best site-SVHN                     (0)  | Epoch:17 | Val Acc: 0.6942
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.2790 | Train Acc: 0.9164
 Site-MNIST                     (0) | Train Loss: 0.3432 | Train Acc: 0.9031
 Site-USPS                      (1) | Train Loss: 0.3469 | Train Acc: 0.9003
 Site-USPS                      (1) | Train Loss: 0.3473 | Train Acc: 0.9004
 Site-SynthDigits               (1) | Train Loss: 0.5320 | Train Acc: 0.8464
 Site-SynthDigits               (1) | Train Loss: 0.4734 | Train Acc: 0.8717
 Site-MNIST_M                   (2) | Train Loss: 0.7420 | Train Acc: 0.7574
 Site-MNIST_M                   (2) | Train Loss: 0.6991 | Train Acc: 0.8090
 Site-SVHN                      (1) | Train Loss: 1.0087 | Train Acc: 0.6658
 Site-SVHN                      (1) | Train Loss: 0.9315 | Train Acc: 0.6951
Average Train Accuracy: 0.8266
 Site-MNIST                     (0) | Val  Loss: 0.2654 | Val  Acc: 0.9022
 Site-MNIST                     (0) | Val  Loss: 0.3450 | Val  Acc: 0.9065
 Site-USPS                      (1) | Val  Loss: 0.4610 | Val  Acc: 0.8152
 Site-USPS                      (1) | Val  Loss: 0.4000 | Val  Acc: 0.8669
 Site-SynthDigits               (1) | Val  Loss: 0.5011 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.4931 | Val  Acc: 0.8417
 Site-MNIST_M                   (2) | Val  Loss: 0.7701 | Val  Acc: 0.7609
 Site-MNIST_M                   (2) | Val  Loss: 0.6949 | Val  Acc: 0.8022
 Site-SVHN                      (1) | Val  Loss: 0.9666 | Val  Acc: 0.7283
 Site-SVHN                      (1) | Val  Loss: 0.9704 | Val  Acc: 0.7050
Average Valid Accuracy: 0.8155
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9022
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9065
 Best site-USPS                     (1)  | Epoch:18 | Val Acc: 0.8152
 Best site-USPS                     (1)  | Epoch:18 | Val Acc: 0.8669
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8261
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8417
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7609
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.8022
 Best site-SVHN                     (1)  | Epoch:18 | Val Acc: 0.7283
 Best site-SVHN                     (1)  | Epoch:18 | Val Acc: 0.7050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 19 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (2) | Train Loss: 0.2653 | Train Acc: 0.9191
 Site-MNIST                     (2) | Train Loss: 0.3345 | Train Acc: 0.9013
 Site-USPS                      (0) | Train Loss: 0.3294 | Train Acc: 0.9030
 Site-USPS                      (0) | Train Loss: 0.3424 | Train Acc: 0.9031
 Site-SynthDigits               (0) | Train Loss: 0.5229 | Train Acc: 0.8544
 Site-SynthDigits               (0) | Train Loss: 0.4715 | Train Acc: 0.8762
 Site-MNIST_M                   (1) | Train Loss: 0.7200 | Train Acc: 0.7628
 Site-MNIST_M                   (1) | Train Loss: 0.6916 | Train Acc: 0.8099
 Site-SVHN                      (0) | Train Loss: 1.0132 | Train Acc: 0.6685
 Site-SVHN                      (0) | Train Loss: 0.9293 | Train Acc: 0.6906
Average Train Accuracy: 0.8289
 Site-MNIST                     (2) | Val  Loss: 0.2627 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3381 | Val  Acc: 0.8921
 Site-USPS                      (0) | Val  Loss: 0.4469 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.3870 | Val  Acc: 0.8633
 Site-SynthDigits               (0) | Val  Loss: 0.4928 | Val  Acc: 0.8261
 Site-SynthDigits               (0) | Val  Loss: 0.4888 | Val  Acc: 0.8345
 Site-MNIST_M                   (1) | Val  Loss: 0.7532 | Val  Acc: 0.7826
 Site-MNIST_M                   (1) | Val  Loss: 0.6726 | Val  Acc: 0.8165
 Site-SVHN                      (0) | Val  Loss: 0.9551 | Val  Acc: 0.7065
 Site-SVHN                      (0) | Val  Loss: 0.9670 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8137
============ Train epoch 20 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (2) | Train Loss: 0.2616 | Train Acc: 0.9191
 Site-MNIST                     (2) | Train Loss: 0.3321 | Train Acc: 0.9004
 Site-USPS                      (0) | Train Loss: 0.3241 | Train Acc: 0.9030
 Site-USPS                      (0) | Train Loss: 0.3230 | Train Acc: 0.9112
 Site-SynthDigits               (0) | Train Loss: 0.5125 | Train Acc: 0.8491
 Site-SynthDigits               (0) | Train Loss: 0.4602 | Train Acc: 0.8762
 Site-MNIST_M                   (1) | Train Loss: 0.7026 | Train Acc: 0.7655
 Site-MNIST_M                   (1) | Train Loss: 0.6674 | Train Acc: 0.8161
 Site-SVHN                      (0) | Train Loss: 0.9814 | Train Acc: 0.6739
 Site-SVHN                      (0) | Train Loss: 0.8858 | Train Acc: 0.7049
Average Train Accuracy: 0.8319
 Site-MNIST                     (2) | Val  Loss: 0.2583 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.3331 | Val  Acc: 0.8921
 Site-USPS                      (0) | Val  Loss: 0.4274 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.3725 | Val  Acc: 0.8705
 Site-SynthDigits               (0) | Val  Loss: 0.4899 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.4737 | Val  Acc: 0.8525
 Site-MNIST_M                   (1) | Val  Loss: 0.7444 | Val  Acc: 0.7609
 Site-MNIST_M                   (1) | Val  Loss: 0.6614 | Val  Acc: 0.8094
 Site-SVHN                      (0) | Val  Loss: 0.9132 | Val  Acc: 0.7283
 Site-SVHN                      (0) | Val  Loss: 0.9366 | Val  Acc: 0.7050
Average Valid Accuracy: 0.8206
 Best site-MNIST                    (2)  | Epoch:20 | Val Acc: 0.9022
 Best site-MNIST                    (2)  | Epoch:20 | Val Acc: 0.8921
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.8261
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.8705
 Best site-SynthDigits              (0)  | Epoch:20 | Val Acc: 0.8587
 Best site-SynthDigits              (0)  | Epoch:20 | Val Acc: 0.8525
 Best site-MNIST_M                  (1)  | Epoch:20 | Val Acc: 0.7609
 Best site-MNIST_M                  (1)  | Epoch:20 | Val Acc: 0.8094
 Best site-SVHN                     (0)  | Epoch:20 | Val Acc: 0.7283
 Best site-SVHN                     (0)  | Epoch:20 | Val Acc: 0.7050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 21 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.2537 | Train Acc: 0.9299
 Site-MNIST                     (1) | Train Loss: 0.3132 | Train Acc: 0.9121
 Site-USPS                      (0) | Train Loss: 0.3181 | Train Acc: 0.9084
 Site-USPS                      (0) | Train Loss: 0.3299 | Train Acc: 0.9130
 Site-SynthDigits               (0) | Train Loss: 0.4855 | Train Acc: 0.8652
 Site-SynthDigits               (0) | Train Loss: 0.4413 | Train Acc: 0.8906
 Site-MNIST_M                   (2) | Train Loss: 0.6936 | Train Acc: 0.7709
 Site-MNIST_M                   (2) | Train Loss: 0.6443 | Train Acc: 0.8197
 Site-SVHN                      (0) | Train Loss: 0.9746 | Train Acc: 0.6658
 Site-SVHN                      (0) | Train Loss: 0.8808 | Train Acc: 0.7103
Average Train Accuracy: 0.8386
 Site-MNIST                     (1) | Val  Loss: 0.2432 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3225 | Val  Acc: 0.9209
 Site-USPS                      (0) | Val  Loss: 0.4290 | Val  Acc: 0.8478
 Site-USPS                      (0) | Val  Loss: 0.3708 | Val  Acc: 0.8813
 Site-SynthDigits               (0) | Val  Loss: 0.4636 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.4530 | Val  Acc: 0.8597
 Site-MNIST_M                   (2) | Val  Loss: 0.7188 | Val  Acc: 0.7717
 Site-MNIST_M                   (2) | Val  Loss: 0.6385 | Val  Acc: 0.8129
 Site-SVHN                      (0) | Val  Loss: 0.9135 | Val  Acc: 0.7500
 Site-SVHN                      (0) | Val  Loss: 0.9254 | Val  Acc: 0.7050
Average Valid Accuracy: 0.8332
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9239
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9209
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.8478
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.8813
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8587
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8597
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7717
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.8129
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.7500
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.7050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 4, 4, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (1) | Train Loss: 0.2542 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.3113 | Train Acc: 0.9076
 Site-USPS                      (2) | Train Loss: 0.3273 | Train Acc: 0.9057
 Site-USPS                      (2) | Train Loss: 0.3240 | Train Acc: 0.9031
 Site-SynthDigits               (2) | Train Loss: 0.4748 | Train Acc: 0.8625
 Site-SynthDigits               (2) | Train Loss: 0.4192 | Train Acc: 0.8915
 Site-MNIST_M                   (1) | Train Loss: 0.6972 | Train Acc: 0.7817
 Site-MNIST_M                   (1) | Train Loss: 0.6528 | Train Acc: 0.8206
 Site-SVHN                      (0) | Train Loss: 0.9502 | Train Acc: 0.6712
 Site-SVHN                      (0) | Train Loss: 0.8630 | Train Acc: 0.7229
Average Train Accuracy: 0.8389
 Site-MNIST                     (1) | Val  Loss: 0.2408 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3196 | Val  Acc: 0.9173
 Site-USPS                      (2) | Val  Loss: 0.4262 | Val  Acc: 0.8261
 Site-USPS                      (2) | Val  Loss: 0.3721 | Val  Acc: 0.8705
 Site-SynthDigits               (2) | Val  Loss: 0.4430 | Val  Acc: 0.8587
 Site-SynthDigits               (2) | Val  Loss: 0.4386 | Val  Acc: 0.8597
 Site-MNIST_M                   (1) | Val  Loss: 0.7231 | Val  Acc: 0.7609
 Site-MNIST_M                   (1) | Val  Loss: 0.6439 | Val  Acc: 0.8201
 Site-SVHN                      (0) | Val  Loss: 0.8750 | Val  Acc: 0.7500
 Site-SVHN                      (0) | Val  Loss: 0.8978 | Val  Acc: 0.7194
Average Valid Accuracy: 0.8307
============ Train epoch 23 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (2) | Train Loss: 0.2312 | Train Acc: 0.9326
 Site-MNIST                     (2) | Train Loss: 0.2931 | Train Acc: 0.9121
 Site-USPS                      (1) | Train Loss: 0.2980 | Train Acc: 0.9111
 Site-USPS                      (1) | Train Loss: 0.2992 | Train Acc: 0.9157
 Site-SynthDigits               (1) | Train Loss: 0.4875 | Train Acc: 0.8679
 Site-SynthDigits               (1) | Train Loss: 0.4309 | Train Acc: 0.8906
 Site-MNIST_M                   (0) | Train Loss: 0.6718 | Train Acc: 0.7763
 Site-MNIST_M                   (0) | Train Loss: 0.6370 | Train Acc: 0.8215
 Site-SVHN                      (1) | Train Loss: 0.9513 | Train Acc: 0.6873
 Site-SVHN                      (1) | Train Loss: 0.8343 | Train Acc: 0.7300
Average Train Accuracy: 0.8445
 Site-MNIST                     (2) | Val  Loss: 0.2216 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.3001 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.4036 | Val  Acc: 0.8478
 Site-USPS                      (1) | Val  Loss: 0.3442 | Val  Acc: 0.8777
 Site-SynthDigits               (1) | Val  Loss: 0.4537 | Val  Acc: 0.8478
 Site-SynthDigits               (1) | Val  Loss: 0.4415 | Val  Acc: 0.8561
 Site-MNIST_M                   (0) | Val  Loss: 0.6947 | Val  Acc: 0.7717
 Site-MNIST_M                   (0) | Val  Loss: 0.6236 | Val  Acc: 0.8237
 Site-SVHN                      (1) | Val  Loss: 0.8556 | Val  Acc: 0.6957
 Site-SVHN                      (1) | Val  Loss: 0.8896 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8303
============ Train epoch 24 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (1) | Train Loss: 0.2356 | Train Acc: 0.9245
 Site-MNIST                     (1) | Train Loss: 0.2975 | Train Acc: 0.9139
 Site-USPS                      (0) | Train Loss: 0.2903 | Train Acc: 0.9137
 Site-USPS                      (0) | Train Loss: 0.2910 | Train Acc: 0.9193
 Site-SynthDigits               (0) | Train Loss: 0.4530 | Train Acc: 0.8760
 Site-SynthDigits               (0) | Train Loss: 0.4046 | Train Acc: 0.8996
 Site-MNIST_M                   (2) | Train Loss: 0.6624 | Train Acc: 0.7763
 Site-MNIST_M                   (2) | Train Loss: 0.6127 | Train Acc: 0.8260
 Site-SVHN                      (0) | Train Loss: 0.9572 | Train Acc: 0.6900
 Site-SVHN                      (0) | Train Loss: 0.8367 | Train Acc: 0.7193
Average Train Accuracy: 0.8459
 Site-MNIST                     (1) | Val  Loss: 0.2197 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.2966 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3886 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.3340 | Val  Acc: 0.8885
 Site-SynthDigits               (0) | Val  Loss: 0.4248 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4121 | Val  Acc: 0.8633
 Site-MNIST_M                   (2) | Val  Loss: 0.6754 | Val  Acc: 0.7717
 Site-MNIST_M                   (2) | Val  Loss: 0.6088 | Val  Acc: 0.8237
 Site-SVHN                      (0) | Val  Loss: 0.8741 | Val  Acc: 0.7065
 Site-SVHN                      (0) | Val  Loss: 0.8933 | Val  Acc: 0.7122
Average Valid Accuracy: 0.8350
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9348
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8696
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8885
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8633
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7717
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.8237
 Best site-SVHN                     (0)  | Epoch:24 | Val Acc: 0.7065
 Best site-SVHN                     (0)  | Epoch:24 | Val Acc: 0.7122
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (0) | Train Loss: 0.2264 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2859 | Train Acc: 0.9184
 Site-USPS                      (1) | Train Loss: 0.2877 | Train Acc: 0.9084
 Site-USPS                      (1) | Train Loss: 0.2886 | Train Acc: 0.9193
 Site-SynthDigits               (1) | Train Loss: 0.4460 | Train Acc: 0.8733
 Site-SynthDigits               (1) | Train Loss: 0.3978 | Train Acc: 0.8996
 Site-MNIST_M                   (2) | Train Loss: 0.6503 | Train Acc: 0.7817
 Site-MNIST_M                   (2) | Train Loss: 0.6067 | Train Acc: 0.8242
 Site-SVHN                      (1) | Train Loss: 0.9379 | Train Acc: 0.6846
 Site-SVHN                      (1) | Train Loss: 0.8176 | Train Acc: 0.7309
Average Train Accuracy: 0.8478
 Site-MNIST                     (0) | Val  Loss: 0.2123 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.2885 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.3896 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.3292 | Val  Acc: 0.8885
 Site-SynthDigits               (1) | Val  Loss: 0.4209 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.4106 | Val  Acc: 0.8597
 Site-MNIST_M                   (2) | Val  Loss: 0.6647 | Val  Acc: 0.7935
 Site-MNIST_M                   (2) | Val  Loss: 0.5963 | Val  Acc: 0.8309
 Site-SVHN                      (1) | Val  Loss: 0.8627 | Val  Acc: 0.7391
 Site-SVHN                      (1) | Val  Loss: 0.8789 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8440
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9348
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.8804
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.8885
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.8597
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.7935
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.8309
 Best site-SVHN                     (1)  | Epoch:25 | Val Acc: 0.7391
 Best site-SVHN                     (1)  | Epoch:25 | Val Acc: 0.7158
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (0) | Train Loss: 0.2276 | Train Acc: 0.9299
 Site-MNIST                     (0) | Train Loss: 0.2862 | Train Acc: 0.9193
 Site-USPS                      (1) | Train Loss: 0.2716 | Train Acc: 0.9137
 Site-USPS                      (1) | Train Loss: 0.2735 | Train Acc: 0.9220
 Site-SynthDigits               (1) | Train Loss: 0.4469 | Train Acc: 0.8706
 Site-SynthDigits               (1) | Train Loss: 0.3957 | Train Acc: 0.8978
 Site-MNIST_M                   (2) | Train Loss: 0.6411 | Train Acc: 0.7898
 Site-MNIST_M                   (2) | Train Loss: 0.5890 | Train Acc: 0.8323
 Site-SVHN                      (1) | Train Loss: 0.9416 | Train Acc: 0.6712
 Site-SVHN                      (1) | Train Loss: 0.8259 | Train Acc: 0.7327
Average Train Accuracy: 0.8479
 Site-MNIST                     (0) | Val  Loss: 0.2125 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2878 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.3752 | Val  Acc: 0.8587
 Site-USPS                      (1) | Val  Loss: 0.3131 | Val  Acc: 0.8921
 Site-SynthDigits               (1) | Val  Loss: 0.4109 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.4040 | Val  Acc: 0.8669
 Site-MNIST_M                   (2) | Val  Loss: 0.6399 | Val  Acc: 0.8043
 Site-MNIST_M                   (2) | Val  Loss: 0.5813 | Val  Acc: 0.8345
 Site-SVHN                      (1) | Val  Loss: 0.8499 | Val  Acc: 0.7391
 Site-SVHN                      (1) | Val  Loss: 0.8727 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8480
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:26 | Val Acc: 0.8587
 Best site-USPS                     (1)  | Epoch:26 | Val Acc: 0.8921
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.8669
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.8043
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.8345
 Best site-SVHN                     (1)  | Epoch:26 | Val Acc: 0.7391
 Best site-SVHN                     (1)  | Epoch:26 | Val Acc: 0.7302
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (0) | Train Loss: 0.2339 | Train Acc: 0.9326
 Site-MNIST                     (0) | Train Loss: 0.2815 | Train Acc: 0.9193
 Site-USPS                      (1) | Train Loss: 0.2717 | Train Acc: 0.9137
 Site-USPS                      (1) | Train Loss: 0.2706 | Train Acc: 0.9274
 Site-SynthDigits               (1) | Train Loss: 0.4258 | Train Acc: 0.8760
 Site-SynthDigits               (1) | Train Loss: 0.3792 | Train Acc: 0.9076
 Site-MNIST_M                   (2) | Train Loss: 0.6315 | Train Acc: 0.7871
 Site-MNIST_M                   (2) | Train Loss: 0.5792 | Train Acc: 0.8422
 Site-SVHN                      (1) | Train Loss: 0.9278 | Train Acc: 0.6873
 Site-SVHN                      (1) | Train Loss: 0.7930 | Train Acc: 0.7480
Average Train Accuracy: 0.8541
 Site-MNIST                     (0) | Val  Loss: 0.2123 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2889 | Val  Acc: 0.9353
 Site-USPS                      (1) | Val  Loss: 0.3668 | Val  Acc: 0.8696
 Site-USPS                      (1) | Val  Loss: 0.3103 | Val  Acc: 0.8993
 Site-SynthDigits               (1) | Val  Loss: 0.4009 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3861 | Val  Acc: 0.8777
 Site-MNIST_M                   (2) | Val  Loss: 0.6483 | Val  Acc: 0.8152
 Site-MNIST_M                   (2) | Val  Loss: 0.5795 | Val  Acc: 0.8381
 Site-SVHN                      (1) | Val  Loss: 0.8265 | Val  Acc: 0.7717
 Site-SVHN                      (1) | Val  Loss: 0.8486 | Val  Acc: 0.7338
Average Valid Accuracy: 0.8567
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9353
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8696
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8993
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8777
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.8152
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.8381
 Best site-SVHN                     (1)  | Epoch:27 | Val Acc: 0.7717
 Best site-SVHN                     (1)  | Epoch:27 | Val Acc: 0.7338
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (0) | Train Loss: 0.2288 | Train Acc: 0.9326
 Site-MNIST                     (0) | Train Loss: 0.2844 | Train Acc: 0.9148
 Site-USPS                      (1) | Train Loss: 0.2655 | Train Acc: 0.9245
 Site-USPS                      (1) | Train Loss: 0.2648 | Train Acc: 0.9211
 Site-SynthDigits               (1) | Train Loss: 0.4089 | Train Acc: 0.8760
 Site-SynthDigits               (1) | Train Loss: 0.3635 | Train Acc: 0.9094
 Site-MNIST_M                   (2) | Train Loss: 0.6164 | Train Acc: 0.8005
 Site-MNIST_M                   (2) | Train Loss: 0.5609 | Train Acc: 0.8493
 Site-SVHN                      (1) | Train Loss: 0.9176 | Train Acc: 0.7116
 Site-SVHN                      (1) | Train Loss: 0.7981 | Train Acc: 0.7444
Average Train Accuracy: 0.8584
 Site-MNIST                     (0) | Val  Loss: 0.2128 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.2911 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.3640 | Val  Acc: 0.8696
 Site-USPS                      (1) | Val  Loss: 0.3102 | Val  Acc: 0.8993
 Site-SynthDigits               (1) | Val  Loss: 0.3825 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3750 | Val  Acc: 0.8777
 Site-MNIST_M                   (2) | Val  Loss: 0.6247 | Val  Acc: 0.8261
 Site-MNIST_M                   (2) | Val  Loss: 0.5668 | Val  Acc: 0.8309
 Site-SVHN                      (1) | Val  Loss: 0.8325 | Val  Acc: 0.7609
 Site-SVHN                      (1) | Val  Loss: 0.8452 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8538
============ Train epoch 29 ============
cnt=[4, 2, 4, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.2280 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2812 | Train Acc: 0.9166
 Site-USPS                      (0) | Train Loss: 0.2803 | Train Acc: 0.9164
 Site-USPS                      (0) | Train Loss: 0.2695 | Train Acc: 0.9202
 Site-SynthDigits               (2) | Train Loss: 0.4080 | Train Acc: 0.8760
 Site-SynthDigits               (2) | Train Loss: 0.3585 | Train Acc: 0.9085
 Site-MNIST_M                   (1) | Train Loss: 0.6135 | Train Acc: 0.8113
 Site-MNIST_M                   (1) | Train Loss: 0.5586 | Train Acc: 0.8386
 Site-SVHN                      (2) | Train Loss: 0.9016 | Train Acc: 0.7008
 Site-SVHN                      (2) | Train Loss: 0.7851 | Train Acc: 0.7489
Average Train Accuracy: 0.8575
 Site-MNIST                     (0) | Val  Loss: 0.2139 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2916 | Val  Acc: 0.9245
 Site-USPS                      (0) | Val  Loss: 0.3708 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.3142 | Val  Acc: 0.8921
 Site-SynthDigits               (2) | Val  Loss: 0.3830 | Val  Acc: 0.8696
 Site-SynthDigits               (2) | Val  Loss: 0.3681 | Val  Acc: 0.8777
 Site-MNIST_M                   (1) | Val  Loss: 0.6205 | Val  Acc: 0.8478
 Site-MNIST_M                   (1) | Val  Loss: 0.5562 | Val  Acc: 0.8417
 Site-SVHN                      (2) | Val  Loss: 0.8079 | Val  Acc: 0.7391
 Site-SVHN                      (2) | Val  Loss: 0.8293 | Val  Acc: 0.7410
Average Valid Accuracy: 0.8549
============ Train epoch 30 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (2) | Train Loss: 0.2226 | Train Acc: 0.9353
 Site-MNIST                     (2) | Train Loss: 0.2732 | Train Acc: 0.9193
 Site-USPS                      (0) | Train Loss: 0.2508 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.2534 | Train Acc: 0.9265
 Site-SynthDigits               (0) | Train Loss: 0.4126 | Train Acc: 0.8787
 Site-SynthDigits               (0) | Train Loss: 0.3594 | Train Acc: 0.9112
 Site-MNIST_M                   (1) | Train Loss: 0.6025 | Train Acc: 0.7978
 Site-MNIST_M                   (1) | Train Loss: 0.5588 | Train Acc: 0.8466
 Site-SVHN                      (0) | Train Loss: 0.9119 | Train Acc: 0.6846
 Site-SVHN                      (0) | Train Loss: 0.7849 | Train Acc: 0.7525
Average Train Accuracy: 0.8591
 Site-MNIST                     (2) | Val  Loss: 0.2096 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2855 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3445 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.2896 | Val  Acc: 0.9029
 Site-SynthDigits               (0) | Val  Loss: 0.3825 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.3670 | Val  Acc: 0.8813
 Site-MNIST_M                   (1) | Val  Loss: 0.6030 | Val  Acc: 0.8587
 Site-MNIST_M                   (1) | Val  Loss: 0.5479 | Val  Acc: 0.8417
 Site-SVHN                      (0) | Val  Loss: 0.8070 | Val  Acc: 0.7609
 Site-SVHN                      (0) | Val  Loss: 0.8362 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8603
 Best site-MNIST                    (2)  | Epoch:30 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:30 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.8696
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.9029
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8804
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8813
 Best site-MNIST_M                  (1)  | Epoch:30 | Val Acc: 0.8587
 Best site-MNIST_M                  (1)  | Epoch:30 | Val Acc: 0.8417
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7609
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7302
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 31 ============
cnt=[4, 4, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.2137 | Train Acc: 0.9407
 Site-MNIST                     (1) | Train Loss: 0.2698 | Train Acc: 0.9211
 Site-USPS                      (1) | Train Loss: 0.2708 | Train Acc: 0.9111
 Site-USPS                      (1) | Train Loss: 0.2609 | Train Acc: 0.9247
 Site-SynthDigits               (0) | Train Loss: 0.4013 | Train Acc: 0.8760
 Site-SynthDigits               (0) | Train Loss: 0.3483 | Train Acc: 0.9112
 Site-MNIST_M                   (2) | Train Loss: 0.6033 | Train Acc: 0.8086
 Site-MNIST_M                   (2) | Train Loss: 0.5432 | Train Acc: 0.8466
 Site-SVHN                      (0) | Train Loss: 0.8875 | Train Acc: 0.7035
 Site-SVHN                      (0) | Train Loss: 0.7644 | Train Acc: 0.7552
Average Train Accuracy: 0.8599
 Site-MNIST                     (1) | Val  Loss: 0.1901 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.2719 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.3617 | Val  Acc: 0.8696
 Site-USPS                      (1) | Val  Loss: 0.3031 | Val  Acc: 0.8993
 Site-SynthDigits               (0) | Val  Loss: 0.3698 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3558 | Val  Acc: 0.8777
 Site-MNIST_M                   (2) | Val  Loss: 0.5946 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.5435 | Val  Acc: 0.8417
 Site-SVHN                      (0) | Val  Loss: 0.7957 | Val  Acc: 0.7500
 Site-SVHN                      (0) | Val  Loss: 0.8154 | Val  Acc: 0.7482
Average Valid Accuracy: 0.8581
============ Train epoch 32 ============
cnt=[4, 2, 4, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2125 | Train Acc: 0.9353
 Site-MNIST                     (0) | Train Loss: 0.2522 | Train Acc: 0.9283
 Site-USPS                      (2) | Train Loss: 0.2719 | Train Acc: 0.9164
 Site-USPS                      (2) | Train Loss: 0.2690 | Train Acc: 0.9274
 Site-SynthDigits               (2) | Train Loss: 0.4002 | Train Acc: 0.8706
 Site-SynthDigits               (2) | Train Loss: 0.3522 | Train Acc: 0.9094
 Site-MNIST_M                   (0) | Train Loss: 0.5953 | Train Acc: 0.7978
 Site-MNIST_M                   (0) | Train Loss: 0.5478 | Train Acc: 0.8484
 Site-SVHN                      (1) | Train Loss: 0.8676 | Train Acc: 0.7170
 Site-SVHN                      (1) | Train Loss: 0.7294 | Train Acc: 0.7722
Average Train Accuracy: 0.8623
 Site-MNIST                     (0) | Val  Loss: 0.1827 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2650 | Val  Acc: 0.9317
 Site-USPS                      (2) | Val  Loss: 0.3688 | Val  Acc: 0.8804
 Site-USPS                      (2) | Val  Loss: 0.3065 | Val  Acc: 0.8957
 Site-SynthDigits               (2) | Val  Loss: 0.3838 | Val  Acc: 0.8696
 Site-SynthDigits               (2) | Val  Loss: 0.3591 | Val  Acc: 0.8777
 Site-MNIST_M                   (0) | Val  Loss: 0.6024 | Val  Acc: 0.8478
 Site-MNIST_M                   (0) | Val  Loss: 0.5475 | Val  Acc: 0.8381
 Site-SVHN                      (1) | Val  Loss: 0.7620 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.7833 | Val  Acc: 0.7626
Average Valid Accuracy: 0.8632
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9317
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.8804
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.8957
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8696
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8777
 Best site-MNIST_M                  (0)  | Epoch:32 | Val Acc: 0.8478
 Best site-MNIST_M                  (0)  | Epoch:32 | Val Acc: 0.8381
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7826
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7626
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 33 ============
cnt=[4, 4, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (0) | Train Loss: 0.2030 | Train Acc: 0.9461
 Site-MNIST                     (0) | Train Loss: 0.2522 | Train Acc: 0.9265
 Site-USPS                      (0) | Train Loss: 0.2621 | Train Acc: 0.9245
 Site-USPS                      (0) | Train Loss: 0.2563 | Train Acc: 0.9202
 Site-SynthDigits               (1) | Train Loss: 0.3878 | Train Acc: 0.8868
 Site-SynthDigits               (1) | Train Loss: 0.3398 | Train Acc: 0.9130
 Site-MNIST_M                   (2) | Train Loss: 0.5794 | Train Acc: 0.8167
 Site-MNIST_M                   (2) | Train Loss: 0.5338 | Train Acc: 0.8502
 Site-SVHN                      (1) | Train Loss: 0.8644 | Train Acc: 0.7062
 Site-SVHN                      (1) | Train Loss: 0.7391 | Train Acc: 0.7704
Average Train Accuracy: 0.8661
 Site-MNIST                     (0) | Val  Loss: 0.1779 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2612 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3630 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.2985 | Val  Acc: 0.8993
 Site-SynthDigits               (1) | Val  Loss: 0.3607 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3502 | Val  Acc: 0.8777
 Site-MNIST_M                   (2) | Val  Loss: 0.5897 | Val  Acc: 0.8478
 Site-MNIST_M                   (2) | Val  Loss: 0.5319 | Val  Acc: 0.8417
 Site-SVHN                      (1) | Val  Loss: 0.7810 | Val  Acc: 0.7717
 Site-SVHN                      (1) | Val  Loss: 0.7887 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8621
============ Train epoch 34 ============
cnt=[4, 2, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (0) | Train Loss: 0.1948 | Train Acc: 0.9461
 Site-MNIST                     (0) | Train Loss: 0.2484 | Train Acc: 0.9291
 Site-USPS                      (0) | Train Loss: 0.2533 | Train Acc: 0.9164
 Site-USPS                      (0) | Train Loss: 0.2505 | Train Acc: 0.9327
 Site-SynthDigits               (2) | Train Loss: 0.3752 | Train Acc: 0.8868
 Site-SynthDigits               (2) | Train Loss: 0.3244 | Train Acc: 0.9184
 Site-MNIST_M                   (1) | Train Loss: 0.5760 | Train Acc: 0.8032
 Site-MNIST_M                   (1) | Train Loss: 0.5166 | Train Acc: 0.8511
 Site-SVHN                      (2) | Train Loss: 0.8702 | Train Acc: 0.7251
 Site-SVHN                      (2) | Train Loss: 0.7290 | Train Acc: 0.7749
Average Train Accuracy: 0.8684
 Site-MNIST                     (0) | Val  Loss: 0.1686 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2576 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3601 | Val  Acc: 0.8913
 Site-USPS                      (0) | Val  Loss: 0.2935 | Val  Acc: 0.8993
 Site-SynthDigits               (2) | Val  Loss: 0.3445 | Val  Acc: 0.8913
 Site-SynthDigits               (2) | Val  Loss: 0.3330 | Val  Acc: 0.8849
 Site-MNIST_M                   (1) | Val  Loss: 0.5811 | Val  Acc: 0.8587
 Site-MNIST_M                   (1) | Val  Loss: 0.5226 | Val  Acc: 0.8381
 Site-SVHN                      (2) | Val  Loss: 0.7730 | Val  Acc: 0.7717
 Site-SVHN                      (2) | Val  Loss: 0.7848 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8690
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:34 | Val Acc: 0.8913
 Best site-USPS                     (0)  | Epoch:34 | Val Acc: 0.8993
 Best site-SynthDigits              (2)  | Epoch:34 | Val Acc: 0.8913
 Best site-SynthDigits              (2)  | Epoch:34 | Val Acc: 0.8849
 Best site-MNIST_M                  (1)  | Epoch:34 | Val Acc: 0.8587
 Best site-MNIST_M                  (1)  | Epoch:34 | Val Acc: 0.8381
 Best site-SVHN                     (2)  | Epoch:34 | Val Acc: 0.7717
 Best site-SVHN                     (2)  | Epoch:34 | Val Acc: 0.7770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (2) | Train Loss: 0.1956 | Train Acc: 0.9434
 Site-MNIST                     (2) | Train Loss: 0.2402 | Train Acc: 0.9291
 Site-USPS                      (1) | Train Loss: 0.2408 | Train Acc: 0.9326
 Site-USPS                      (1) | Train Loss: 0.2405 | Train Acc: 0.9327
 Site-SynthDigits               (1) | Train Loss: 0.3718 | Train Acc: 0.8814
 Site-SynthDigits               (1) | Train Loss: 0.3288 | Train Acc: 0.9148
 Site-MNIST_M                   (0) | Train Loss: 0.5650 | Train Acc: 0.8032
 Site-MNIST_M                   (0) | Train Loss: 0.5141 | Train Acc: 0.8556
 Site-SVHN                      (1) | Train Loss: 0.8528 | Train Acc: 0.7170
 Site-SVHN                      (1) | Train Loss: 0.7119 | Train Acc: 0.7830
Average Train Accuracy: 0.8693
 Site-MNIST                     (2) | Val  Loss: 0.1675 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2544 | Val  Acc: 0.9353
 Site-USPS                      (1) | Val  Loss: 0.3378 | Val  Acc: 0.8913
 Site-USPS                      (1) | Val  Loss: 0.2725 | Val  Acc: 0.9065
 Site-SynthDigits               (1) | Val  Loss: 0.3563 | Val  Acc: 0.8913
 Site-SynthDigits               (1) | Val  Loss: 0.3289 | Val  Acc: 0.8921
 Site-MNIST_M                   (0) | Val  Loss: 0.5603 | Val  Acc: 0.8478
 Site-MNIST_M                   (0) | Val  Loss: 0.5074 | Val  Acc: 0.8417
 Site-SVHN                      (1) | Val  Loss: 0.7470 | Val  Acc: 0.7935
 Site-SVHN                      (1) | Val  Loss: 0.7714 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8711
 Best site-MNIST                    (2)  | Epoch:35 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:35 | Val Acc: 0.9353
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.8913
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.9065
 Best site-SynthDigits              (1)  | Epoch:35 | Val Acc: 0.8913
 Best site-SynthDigits              (1)  | Epoch:35 | Val Acc: 0.8921
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.8478
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.8417
 Best site-SVHN                     (1)  | Epoch:35 | Val Acc: 0.7935
 Best site-SVHN                     (1)  | Epoch:35 | Val Acc: 0.7662
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 4, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (1) | Train Loss: 0.1941 | Train Acc: 0.9407
 Site-MNIST                     (1) | Train Loss: 0.2429 | Train Acc: 0.9318
 Site-USPS                      (1) | Train Loss: 0.2500 | Train Acc: 0.9245
 Site-USPS                      (1) | Train Loss: 0.2482 | Train Acc: 0.9309
 Site-SynthDigits               (2) | Train Loss: 0.3781 | Train Acc: 0.8814
 Site-SynthDigits               (2) | Train Loss: 0.3231 | Train Acc: 0.9175
 Site-MNIST_M                   (0) | Train Loss: 0.5701 | Train Acc: 0.8113
 Site-MNIST_M                   (0) | Train Loss: 0.5063 | Train Acc: 0.8556
 Site-SVHN                      (2) | Train Loss: 0.8597 | Train Acc: 0.7035
 Site-SVHN                      (2) | Train Loss: 0.7078 | Train Acc: 0.7892
Average Train Accuracy: 0.8687
 Site-MNIST                     (1) | Val  Loss: 0.1631 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2524 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.3578 | Val  Acc: 0.8913
 Site-USPS                      (1) | Val  Loss: 0.2894 | Val  Acc: 0.9065
 Site-SynthDigits               (2) | Val  Loss: 0.3495 | Val  Acc: 0.8913
 Site-SynthDigits               (2) | Val  Loss: 0.3284 | Val  Acc: 0.8993
 Site-MNIST_M                   (0) | Val  Loss: 0.5623 | Val  Acc: 0.8696
 Site-MNIST_M                   (0) | Val  Loss: 0.5105 | Val  Acc: 0.8525
 Site-SVHN                      (2) | Val  Loss: 0.7401 | Val  Acc: 0.7717
 Site-SVHN                      (2) | Val  Loss: 0.7652 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8733
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9317
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.8913
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.9065
 Best site-SynthDigits              (2)  | Epoch:36 | Val Acc: 0.8913
 Best site-SynthDigits              (2)  | Epoch:36 | Val Acc: 0.8993
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.8696
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.8525
 Best site-SVHN                     (2)  | Epoch:36 | Val Acc: 0.7717
 Best site-SVHN                     (2)  | Epoch:36 | Val Acc: 0.7734
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 37 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (1) | Train Loss: 0.1902 | Train Acc: 0.9407
 Site-MNIST                     (1) | Train Loss: 0.2418 | Train Acc: 0.9345
 Site-USPS                      (0) | Train Loss: 0.2276 | Train Acc: 0.9407
 Site-USPS                      (0) | Train Loss: 0.2298 | Train Acc: 0.9390
 Site-SynthDigits               (0) | Train Loss: 0.3570 | Train Acc: 0.8922
 Site-SynthDigits               (0) | Train Loss: 0.3153 | Train Acc: 0.9175
 Site-MNIST_M                   (2) | Train Loss: 0.5588 | Train Acc: 0.8140
 Site-MNIST_M                   (2) | Train Loss: 0.4971 | Train Acc: 0.8583
 Site-SVHN                      (0) | Train Loss: 0.8607 | Train Acc: 0.7197
 Site-SVHN                      (0) | Train Loss: 0.7102 | Train Acc: 0.7740
Average Train Accuracy: 0.8731
 Site-MNIST                     (1) | Val  Loss: 0.1586 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2428 | Val  Acc: 0.9424
 Site-USPS                      (0) | Val  Loss: 0.3257 | Val  Acc: 0.8804
 Site-USPS                      (0) | Val  Loss: 0.2637 | Val  Acc: 0.9137
 Site-SynthDigits               (0) | Val  Loss: 0.3243 | Val  Acc: 0.8913
 Site-SynthDigits               (0) | Val  Loss: 0.3197 | Val  Acc: 0.8921
 Site-MNIST_M                   (2) | Val  Loss: 0.5385 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4941 | Val  Acc: 0.8525
 Site-SVHN                      (0) | Val  Loss: 0.7570 | Val  Acc: 0.7717
 Site-SVHN                      (0) | Val  Loss: 0.7719 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8744
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.9565
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.9424
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.8804
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9137
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.8913
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.8921
 Best site-MNIST_M                  (2)  | Epoch:37 | Val Acc: 0.8696
 Best site-MNIST_M                  (2)  | Epoch:37 | Val Acc: 0.8525
 Best site-SVHN                     (0)  | Epoch:37 | Val Acc: 0.7717
 Best site-SVHN                     (0)  | Epoch:37 | Val Acc: 0.7734
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 38 ============
cnt=[4, 4, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.1957 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2445 | Train Acc: 0.9354
 Site-USPS                      (1) | Train Loss: 0.2471 | Train Acc: 0.9326
 Site-USPS                      (1) | Train Loss: 0.2433 | Train Acc: 0.9309
 Site-SynthDigits               (0) | Train Loss: 0.3496 | Train Acc: 0.8922
 Site-SynthDigits               (0) | Train Loss: 0.3075 | Train Acc: 0.9193
 Site-MNIST_M                   (2) | Train Loss: 0.5445 | Train Acc: 0.8059
 Site-MNIST_M                   (2) | Train Loss: 0.4878 | Train Acc: 0.8529
 Site-SVHN                      (0) | Train Loss: 0.8448 | Train Acc: 0.7224
 Site-SVHN                      (0) | Train Loss: 0.6995 | Train Acc: 0.7830
Average Train Accuracy: 0.8710
 Site-MNIST                     (1) | Val  Loss: 0.1578 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2485 | Val  Acc: 0.9353
 Site-USPS                      (1) | Val  Loss: 0.3389 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.2787 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3268 | Val  Acc: 0.9022
 Site-SynthDigits               (0) | Val  Loss: 0.3123 | Val  Acc: 0.9101
 Site-MNIST_M                   (2) | Val  Loss: 0.5416 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4940 | Val  Acc: 0.8453
 Site-SVHN                      (0) | Val  Loss: 0.7256 | Val  Acc: 0.7717
 Site-SVHN                      (0) | Val  Loss: 0.7449 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8751
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9565
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9353
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.8804
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9065
 Best site-SynthDigits              (0)  | Epoch:38 | Val Acc: 0.9022
 Best site-SynthDigits              (0)  | Epoch:38 | Val Acc: 0.9101
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8696
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8453
 Best site-SVHN                     (0)  | Epoch:38 | Val Acc: 0.7717
 Best site-SVHN                     (0)  | Epoch:38 | Val Acc: 0.7734
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 39 ============
cnt=[6, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (0) | Train Loss: 0.1974 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2400 | Train Acc: 0.9283
 Site-USPS                      (0) | Train Loss: 0.2553 | Train Acc: 0.9407
 Site-USPS                      (0) | Train Loss: 0.2482 | Train Acc: 0.9202
 Site-SynthDigits               (0) | Train Loss: 0.3590 | Train Acc: 0.8868
 Site-SynthDigits               (0) | Train Loss: 0.3087 | Train Acc: 0.9103
 Site-MNIST_M                   (1) | Train Loss: 0.5497 | Train Acc: 0.8275
 Site-MNIST_M                   (1) | Train Loss: 0.4863 | Train Acc: 0.8610
 Site-SVHN                      (2) | Train Loss: 0.8221 | Train Acc: 0.7278
 Site-SVHN                      (2) | Train Loss: 0.6745 | Train Acc: 0.7874
Average Train Accuracy: 0.8728
 Site-MNIST                     (0) | Val  Loss: 0.1624 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2508 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3386 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.2868 | Val  Acc: 0.9101
 Site-SynthDigits               (0) | Val  Loss: 0.3226 | Val  Acc: 0.8913
 Site-SynthDigits               (0) | Val  Loss: 0.3191 | Val  Acc: 0.8993
 Site-MNIST_M                   (1) | Val  Loss: 0.5459 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.4963 | Val  Acc: 0.8561
 Site-SVHN                      (2) | Val  Loss: 0.7100 | Val  Acc: 0.7935
 Site-SVHN                      (2) | Val  Loss: 0.7224 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8751
============ Train epoch 40 ============
cnt=[2, 2, 6, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (2) | Train Loss: 0.1842 | Train Acc: 0.9461
 Site-MNIST                     (2) | Train Loss: 0.2340 | Train Acc: 0.9354
 Site-USPS                      (2) | Train Loss: 0.2540 | Train Acc: 0.9272
 Site-USPS                      (2) | Train Loss: 0.2426 | Train Acc: 0.9309
 Site-SynthDigits               (2) | Train Loss: 0.3513 | Train Acc: 0.8841
 Site-SynthDigits               (2) | Train Loss: 0.3102 | Train Acc: 0.9103
 Site-MNIST_M                   (1) | Train Loss: 0.5501 | Train Acc: 0.8113
 Site-MNIST_M                   (1) | Train Loss: 0.4837 | Train Acc: 0.8592
 Site-SVHN                      (0) | Train Loss: 0.8160 | Train Acc: 0.7305
 Site-SVHN                      (0) | Train Loss: 0.6611 | Train Acc: 0.7982
Average Train Accuracy: 0.8733
 Site-MNIST                     (2) | Val  Loss: 0.1539 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2399 | Val  Acc: 0.9388
 Site-USPS                      (2) | Val  Loss: 0.3329 | Val  Acc: 0.8913
 Site-USPS                      (2) | Val  Loss: 0.2724 | Val  Acc: 0.9065
 Site-SynthDigits               (2) | Val  Loss: 0.3240 | Val  Acc: 0.8804
 Site-SynthDigits               (2) | Val  Loss: 0.3109 | Val  Acc: 0.8993
 Site-MNIST_M                   (1) | Val  Loss: 0.5286 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.4838 | Val  Acc: 0.8489
 Site-SVHN                      (0) | Val  Loss: 0.7061 | Val  Acc: 0.8043
 Site-SVHN                      (0) | Val  Loss: 0.7121 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8787
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9565
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9388
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.8913
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9065
 Best site-SynthDigits              (2)  | Epoch:40 | Val Acc: 0.8804
 Best site-SynthDigits              (2)  | Epoch:40 | Val Acc: 0.8993
 Best site-MNIST_M                  (1)  | Epoch:40 | Val Acc: 0.8696
 Best site-MNIST_M                  (1)  | Epoch:40 | Val Acc: 0.8489
 Best site-SVHN                     (0)  | Epoch:40 | Val Acc: 0.8043
 Best site-SVHN                     (0)  | Epoch:40 | Val Acc: 0.7914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.1832 | Train Acc: 0.9407
 Site-MNIST                     (1) | Train Loss: 0.2346 | Train Acc: 0.9372
 Site-USPS                      (1) | Train Loss: 0.2375 | Train Acc: 0.9407
 Site-USPS                      (1) | Train Loss: 0.2282 | Train Acc: 0.9318
 Site-SynthDigits               (1) | Train Loss: 0.3568 | Train Acc: 0.8841
 Site-SynthDigits               (1) | Train Loss: 0.3136 | Train Acc: 0.9130
 Site-MNIST_M                   (0) | Train Loss: 0.5241 | Train Acc: 0.8248
 Site-MNIST_M                   (0) | Train Loss: 0.4770 | Train Acc: 0.8673
 Site-SVHN                      (2) | Train Loss: 0.8160 | Train Acc: 0.7197
 Site-SVHN                      (2) | Train Loss: 0.6534 | Train Acc: 0.7901
Average Train Accuracy: 0.8749
 Site-MNIST                     (1) | Val  Loss: 0.1575 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2390 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3252 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.2668 | Val  Acc: 0.9137
 Site-SynthDigits               (1) | Val  Loss: 0.3332 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3163 | Val  Acc: 0.8921
 Site-MNIST_M                   (0) | Val  Loss: 0.5171 | Val  Acc: 0.8696
 Site-MNIST_M                   (0) | Val  Loss: 0.4778 | Val  Acc: 0.8597
 Site-SVHN                      (2) | Val  Loss: 0.7002 | Val  Acc: 0.7935
 Site-SVHN                      (2) | Val  Loss: 0.7151 | Val  Acc: 0.7806
Average Valid Accuracy: 0.8765
============ Train epoch 42 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (2) | Train Loss: 0.1853 | Train Acc: 0.9380
 Site-MNIST                     (2) | Train Loss: 0.2268 | Train Acc: 0.9354
 Site-USPS                      (1) | Train Loss: 0.2188 | Train Acc: 0.9407
 Site-USPS                      (1) | Train Loss: 0.2207 | Train Acc: 0.9327
 Site-SynthDigits               (1) | Train Loss: 0.3383 | Train Acc: 0.8976
 Site-SynthDigits               (1) | Train Loss: 0.2937 | Train Acc: 0.9229
 Site-MNIST_M                   (0) | Train Loss: 0.5268 | Train Acc: 0.8329
 Site-MNIST_M                   (0) | Train Loss: 0.4656 | Train Acc: 0.8664
 Site-SVHN                      (1) | Train Loss: 0.8188 | Train Acc: 0.7197
 Site-SVHN                      (1) | Train Loss: 0.6556 | Train Acc: 0.7964
Average Train Accuracy: 0.8783
 Site-MNIST                     (2) | Val  Loss: 0.1505 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2350 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3120 | Val  Acc: 0.8913
 Site-USPS                      (1) | Val  Loss: 0.2473 | Val  Acc: 0.9173
 Site-SynthDigits               (1) | Val  Loss: 0.3109 | Val  Acc: 0.8913
 Site-SynthDigits               (1) | Val  Loss: 0.2955 | Val  Acc: 0.8993
 Site-MNIST_M                   (0) | Val  Loss: 0.4934 | Val  Acc: 0.8696
 Site-MNIST_M                   (0) | Val  Loss: 0.4618 | Val  Acc: 0.8525
 Site-SVHN                      (1) | Val  Loss: 0.7065 | Val  Acc: 0.7935
 Site-SVHN                      (1) | Val  Loss: 0.7222 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8783
============ Train epoch 43 ============
cnt=[4, 4, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (1) | Train Loss: 0.1957 | Train Acc: 0.9380
 Site-MNIST                     (1) | Train Loss: 0.2381 | Train Acc: 0.9300
 Site-USPS                      (0) | Train Loss: 0.2273 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.2311 | Train Acc: 0.9345
 Site-SynthDigits               (0) | Train Loss: 0.3373 | Train Acc: 0.8922
 Site-SynthDigits               (0) | Train Loss: 0.3067 | Train Acc: 0.9175
 Site-MNIST_M                   (1) | Train Loss: 0.5267 | Train Acc: 0.8302
 Site-MNIST_M                   (1) | Train Loss: 0.4655 | Train Acc: 0.8717
 Site-SVHN                      (2) | Train Loss: 0.8062 | Train Acc: 0.7278
 Site-SVHN                      (2) | Train Loss: 0.6338 | Train Acc: 0.7982
Average Train Accuracy: 0.8778
 Site-MNIST                     (1) | Val  Loss: 0.1618 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2415 | Val  Acc: 0.9388
 Site-USPS                      (0) | Val  Loss: 0.3159 | Val  Acc: 0.8913
 Site-USPS                      (0) | Val  Loss: 0.2569 | Val  Acc: 0.9137
 Site-SynthDigits               (0) | Val  Loss: 0.3188 | Val  Acc: 0.8913
 Site-SynthDigits               (0) | Val  Loss: 0.2989 | Val  Acc: 0.8993
 Site-MNIST_M                   (1) | Val  Loss: 0.5077 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.4692 | Val  Acc: 0.8525
 Site-SVHN                      (2) | Val  Loss: 0.6809 | Val  Acc: 0.8043
 Site-SVHN                      (2) | Val  Loss: 0.6929 | Val  Acc: 0.7878
Average Valid Accuracy: 0.8805
 Best site-MNIST                    (1)  | Epoch:43 | Val Acc: 0.9565
 Best site-MNIST                    (1)  | Epoch:43 | Val Acc: 0.9388
 Best site-USPS                     (0)  | Epoch:43 | Val Acc: 0.8913
 Best site-USPS                     (0)  | Epoch:43 | Val Acc: 0.9137
 Best site-SynthDigits              (0)  | Epoch:43 | Val Acc: 0.8913
 Best site-SynthDigits              (0)  | Epoch:43 | Val Acc: 0.8993
 Best site-MNIST_M                  (1)  | Epoch:43 | Val Acc: 0.8696
 Best site-MNIST_M                  (1)  | Epoch:43 | Val Acc: 0.8525
 Best site-SVHN                     (2)  | Epoch:43 | Val Acc: 0.8043
 Best site-SVHN                     (2)  | Epoch:43 | Val Acc: 0.7878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 44 ============
cnt=[4, 4, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (1) | Train Loss: 0.1947 | Train Acc: 0.9326
 Site-MNIST                     (1) | Train Loss: 0.2315 | Train Acc: 0.9300
 Site-USPS                      (1) | Train Loss: 0.2302 | Train Acc: 0.9488
 Site-USPS                      (1) | Train Loss: 0.2285 | Train Acc: 0.9372
 Site-SynthDigits               (0) | Train Loss: 0.3256 | Train Acc: 0.9030
 Site-SynthDigits               (0) | Train Loss: 0.2844 | Train Acc: 0.9247
 Site-MNIST_M                   (2) | Train Loss: 0.5201 | Train Acc: 0.8410
 Site-MNIST_M                   (2) | Train Loss: 0.4615 | Train Acc: 0.8646
 Site-SVHN                      (0) | Train Loss: 0.8041 | Train Acc: 0.7358
 Site-SVHN                      (0) | Train Loss: 0.6407 | Train Acc: 0.8045
Average Train Accuracy: 0.8822
 Site-MNIST                     (1) | Val  Loss: 0.1640 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2406 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3062 | Val  Acc: 0.8913
 Site-USPS                      (1) | Val  Loss: 0.2532 | Val  Acc: 0.9137
 Site-SynthDigits               (0) | Val  Loss: 0.2955 | Val  Acc: 0.9022
 Site-SynthDigits               (0) | Val  Loss: 0.2809 | Val  Acc: 0.9137
 Site-MNIST_M                   (2) | Val  Loss: 0.4942 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4610 | Val  Acc: 0.8525
 Site-SVHN                      (0) | Val  Loss: 0.6752 | Val  Acc: 0.8043
 Site-SVHN                      (0) | Val  Loss: 0.6903 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8827
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:44 | Val Acc: 0.8913
 Best site-USPS                     (1)  | Epoch:44 | Val Acc: 0.9137
 Best site-SynthDigits              (0)  | Epoch:44 | Val Acc: 0.9022
 Best site-SynthDigits              (0)  | Epoch:44 | Val Acc: 0.9137
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.8696
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.8525
 Best site-SVHN                     (0)  | Epoch:44 | Val Acc: 0.8043
 Best site-SVHN                     (0)  | Epoch:44 | Val Acc: 0.7950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 6, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (0) | Train Loss: 0.1829 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2301 | Train Acc: 0.9345
 Site-USPS                      (1) | Train Loss: 0.2116 | Train Acc: 0.9461
 Site-USPS                      (1) | Train Loss: 0.2072 | Train Acc: 0.9381
 Site-SynthDigits               (1) | Train Loss: 0.3303 | Train Acc: 0.8949
 Site-SynthDigits               (1) | Train Loss: 0.2846 | Train Acc: 0.9229
 Site-MNIST_M                   (2) | Train Loss: 0.5132 | Train Acc: 0.8410
 Site-MNIST_M                   (2) | Train Loss: 0.4565 | Train Acc: 0.8637
 Site-SVHN                      (1) | Train Loss: 0.8140 | Train Acc: 0.7143
 Site-SVHN                      (1) | Train Loss: 0.6468 | Train Acc: 0.8090
Average Train Accuracy: 0.8802
 Site-MNIST                     (0) | Val  Loss: 0.1563 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2269 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.2883 | Val  Acc: 0.8913
 Site-USPS                      (1) | Val  Loss: 0.2354 | Val  Acc: 0.9281
 Site-SynthDigits               (1) | Val  Loss: 0.2975 | Val  Acc: 0.9022
 Site-SynthDigits               (1) | Val  Loss: 0.2823 | Val  Acc: 0.9065
 Site-MNIST_M                   (2) | Val  Loss: 0.4777 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4446 | Val  Acc: 0.8561
 Site-SVHN                      (1) | Val  Loss: 0.6911 | Val  Acc: 0.8152
 Site-SVHN                      (1) | Val  Loss: 0.6925 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8859
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9565
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8913
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.9281
 Best site-SynthDigits              (1)  | Epoch:45 | Val Acc: 0.9022
 Best site-SynthDigits              (1)  | Epoch:45 | Val Acc: 0.9065
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8696
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8561
 Best site-SVHN                     (1)  | Epoch:45 | Val Acc: 0.8152
 Best site-SVHN                     (1)  | Epoch:45 | Val Acc: 0.7950
 Test site-MNIST                     (0)| Epoch:45 | Test Acc: 0.9404
 Test site-USPS                      (1)| Epoch:45 | Test Acc: 0.9452
 Test site-SynthDigits               (1)| Epoch:45 | Test Acc: 0.9046
 Test site-MNIST_M                   (2)| Epoch:45 | Test Acc: 0.7769
 Test site-SVHN                      (1)| Epoch:45 | Test Acc: 0.7235
MNIST: 0.9404, USPS: 0.9452, SynthDigits: 0.9046, MNIST_M: 0.7769, SVHN: 0.7235, 
Average Test Accuracy(group): 0.8581, Average Test Accuracy(individual): 0.8581,
domain std=0.0908, cluster std=0.0668, individual std=0.0908, 
===2023-08-12 12:11:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 3
Loading snapshots...
 Test site-MNIST                     (1)| Epoch:44 | Test Acc: 0.9369
 Test site-USPS                      (1)| Epoch:44 | Test Acc: 0.9387
 Test site-SynthDigits               (0)| Epoch:44 | Test Acc: 0.9065
 Test site-MNIST_M                   (2)| Epoch:44 | Test Acc: 0.7741
 Test site-SVHN                      (0)| Epoch:44 | Test Acc: 0.7270
MNIST: 0.9369, USPS: 0.9387, SynthDigits: 0.9065, MNIST_M: 0.7741, SVHN: 0.7270, 
Average Test Accuracy(group): 0.8566, Average Test Accuracy(individual): 0.8566,
domain std=0.0886, cluster std=0.0693, individual std=0.0886, 
