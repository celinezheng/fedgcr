===2023-07-02 15:14:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0389 | Train Acc: 0.5854
 Site-USPS                          | Train Loss: 2.0082 | Train Acc: 0.5985
 Site-SynthDigits                   | Train Loss: 2.2468 | Train Acc: 0.2633
 Site-MNIST_M                       | Train Loss: 2.2796 | Train Acc: 0.1619
 Site-SVHN                          | Train Loss: 2.2839 | Train Acc: 0.1068
Average Train Accuracy: 0.3432
 Site-MNIST                         | Val  Loss: 2.0384 | Val  Acc: 0.6027
 Site-USPS                          | Val  Loss: 1.9948 | Val  Acc: 0.5960
 Site-SynthDigits                   | Val  Loss: 2.2979 | Val  Acc: 0.2519
 Site-MNIST_M                       | Val  Loss: 2.2807 | Val  Acc: 0.1609
 Site-SVHN                          | Val  Loss: 2.2812 | Val  Acc: 0.1207
Average Valid Accuracy: 0.3464
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6027
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5960
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2519
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.7905 | Train Acc: 0.7006
 Site-USPS                          | Train Loss: 1.7642 | Train Acc: 0.6717
 Site-SynthDigits                   | Train Loss: 2.1624 | Train Acc: 0.3201
 Site-MNIST_M                       | Train Loss: 2.2423 | Train Acc: 0.2557
 Site-SVHN                          | Train Loss: 2.2722 | Train Acc: 0.1282
Average Train Accuracy: 0.4153
 Site-MNIST                         | Val  Loss: 1.7847 | Val  Acc: 0.7205
 Site-USPS                          | Val  Loss: 1.7361 | Val  Acc: 0.6667
 Site-SynthDigits                   | Val  Loss: 2.2543 | Val  Acc: 0.3359
 Site-MNIST_M                       | Val  Loss: 2.2443 | Val  Acc: 0.2759
 Site-SVHN                          | Val  Loss: 2.2738 | Val  Acc: 0.1379
Average Valid Accuracy: 0.4274
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7205
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6667
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3359
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2759
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.5838 | Train Acc: 0.7452
 Site-USPS                          | Train Loss: 1.5262 | Train Acc: 0.7449
 Site-SynthDigits                   | Train Loss: 2.0891 | Train Acc: 0.3352
 Site-MNIST_M                       | Train Loss: 2.1980 | Train Acc: 0.2898
 Site-SVHN                          | Train Loss: 2.2608 | Train Acc: 0.1453
Average Train Accuracy: 0.4521
 Site-MNIST                         | Val  Loss: 1.5778 | Val  Acc: 0.7508
 Site-USPS                          | Val  Loss: 1.5161 | Val  Acc: 0.7374
 Site-SynthDigits                   | Val  Loss: 2.2147 | Val  Acc: 0.3740
 Site-MNIST_M                       | Val  Loss: 2.2054 | Val  Acc: 0.3103
 Site-SVHN                          | Val  Loss: 2.2608 | Val  Acc: 0.1379
Average Valid Accuracy: 0.4621
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7508
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7374
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3740
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3103
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.3971 | Train Acc: 0.7653
 Site-USPS                          | Train Loss: 1.3525 | Train Acc: 0.7854
 Site-SynthDigits                   | Train Loss: 2.0373 | Train Acc: 0.3693
 Site-MNIST_M                       | Train Loss: 2.1622 | Train Acc: 0.3153
 Site-SVHN                          | Train Loss: 2.2488 | Train Acc: 0.1624
Average Train Accuracy: 0.4796
 Site-MNIST                         | Val  Loss: 1.3845 | Val  Acc: 0.7508
 Site-USPS                          | Val  Loss: 1.3293 | Val  Acc: 0.7828
 Site-SynthDigits                   | Val  Loss: 2.1835 | Val  Acc: 0.3969
 Site-MNIST_M                       | Val  Loss: 2.1686 | Val  Acc: 0.3218
 Site-SVHN                          | Val  Loss: 2.2473 | Val  Acc: 0.1724
Average Valid Accuracy: 0.4850
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7508
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7828
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3969
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3218
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.2255 | Train Acc: 0.7990
 Site-USPS                          | Train Loss: 1.1810 | Train Acc: 0.8068
 Site-SynthDigits                   | Train Loss: 1.9840 | Train Acc: 0.3826
 Site-MNIST_M                       | Train Loss: 2.1258 | Train Acc: 0.3295
 Site-SVHN                          | Train Loss: 2.2361 | Train Acc: 0.1966
Average Train Accuracy: 0.5029
 Site-MNIST                         | Val  Loss: 1.2133 | Val  Acc: 0.7845
 Site-USPS                          | Val  Loss: 1.1630 | Val  Acc: 0.8182
 Site-SynthDigits                   | Val  Loss: 2.1560 | Val  Acc: 0.3969
 Site-MNIST_M                       | Val  Loss: 2.1294 | Val  Acc: 0.3563
 Site-SVHN                          | Val  Loss: 2.2327 | Val  Acc: 0.1897
Average Valid Accuracy: 0.5091
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7845
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8182
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3969
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3563
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.1039 | Train Acc: 0.8049
 Site-USPS                          | Train Loss: 1.0253 | Train Acc: 0.8409
 Site-SynthDigits                   | Train Loss: 1.9533 | Train Acc: 0.4053
 Site-MNIST_M                       | Train Loss: 2.0839 | Train Acc: 0.3523
 Site-SVHN                          | Train Loss: 2.2316 | Train Acc: 0.2137
Average Train Accuracy: 0.5234
 Site-MNIST                         | Val  Loss: 1.0821 | Val  Acc: 0.7912
 Site-USPS                          | Val  Loss: 1.0244 | Val  Acc: 0.8434
 Site-SynthDigits                   | Val  Loss: 2.1266 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.0843 | Val  Acc: 0.3563
 Site-SVHN                          | Val  Loss: 2.2083 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5239
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7912
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8434
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3563
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.9867 | Train Acc: 0.8124
 Site-USPS                          | Train Loss: 0.9142 | Train Acc: 0.8460
 Site-SynthDigits                   | Train Loss: 1.8672 | Train Acc: 0.4129
 Site-MNIST_M                       | Train Loss: 2.0516 | Train Acc: 0.3551
 Site-SVHN                          | Train Loss: 2.2218 | Train Acc: 0.2179
Average Train Accuracy: 0.5289
 Site-MNIST                         | Val  Loss: 0.9702 | Val  Acc: 0.8047
 Site-USPS                          | Val  Loss: 0.9272 | Val  Acc: 0.8535
 Site-SynthDigits                   | Val  Loss: 2.1035 | Val  Acc: 0.3969
 Site-MNIST_M                       | Val  Loss: 2.0469 | Val  Acc: 0.3678
 Site-SVHN                          | Val  Loss: 2.1953 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5363
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8047
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8535
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3969
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3678
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.8946 | Train Acc: 0.8251
 Site-USPS                          | Train Loss: 0.8290 | Train Acc: 0.8598
 Site-SynthDigits                   | Train Loss: 1.8451 | Train Acc: 0.4280
 Site-MNIST_M                       | Train Loss: 2.0134 | Train Acc: 0.3807
 Site-SVHN                          | Train Loss: 2.2137 | Train Acc: 0.2222
Average Train Accuracy: 0.5432
 Site-MNIST                         | Val  Loss: 0.8713 | Val  Acc: 0.8283
 Site-USPS                          | Val  Loss: 0.8385 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 2.0936 | Val  Acc: 0.4198
 Site-MNIST_M                       | Val  Loss: 2.0111 | Val  Acc: 0.3793
 Site-SVHN                          | Val  Loss: 2.1843 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5485
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8283
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8737
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4198
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3793
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.8149 | Train Acc: 0.8326
 Site-USPS                          | Train Loss: 0.7603 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.7912 | Train Acc: 0.4337
 Site-MNIST_M                       | Train Loss: 1.9725 | Train Acc: 0.3920
 Site-SVHN                          | Train Loss: 2.2070 | Train Acc: 0.2222
Average Train Accuracy: 0.5491
 Site-MNIST                         | Val  Loss: 0.7907 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.7822 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 2.0682 | Val  Acc: 0.4198
 Site-MNIST_M                       | Val  Loss: 1.9845 | Val  Acc: 0.4138
 Site-SVHN                          | Val  Loss: 2.1744 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5568
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8350
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8737
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4198
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4138
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.7556 | Train Acc: 0.8377
 Site-USPS                          | Train Loss: 0.6872 | Train Acc: 0.8763
 Site-SynthDigits                   | Train Loss: 1.8110 | Train Acc: 0.4299
 Site-MNIST_M                       | Train Loss: 1.9479 | Train Acc: 0.4034
 Site-SVHN                          | Train Loss: 2.2029 | Train Acc: 0.2308
Average Train Accuracy: 0.5556
 Site-MNIST                         | Val  Loss: 0.7353 | Val  Acc: 0.8283
 Site-USPS                          | Val  Loss: 0.7254 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0935 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 1.9546 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1661 | Val  Acc: 0.2931
Average Valid Accuracy: 0.5693
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8283
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4368
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.6929 | Train Acc: 0.8419
 Site-USPS                          | Train Loss: 0.6483 | Train Acc: 0.8763
 Site-SynthDigits                   | Train Loss: 1.7449 | Train Acc: 0.4394
 Site-MNIST_M                       | Train Loss: 1.9127 | Train Acc: 0.4034
 Site-SVHN                          | Train Loss: 2.2005 | Train Acc: 0.2265
Average Train Accuracy: 0.5575
 Site-MNIST                         | Val  Loss: 0.6719 | Val  Acc: 0.8384
 Site-USPS                          | Val  Loss: 0.6811 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 2.0581 | Val  Acc: 0.4198
 Site-MNIST_M                       | Val  Loss: 1.9265 | Val  Acc: 0.4253
 Site-SVHN                          | Val  Loss: 2.1642 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5666
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.6474 | Train Acc: 0.8537
 Site-USPS                          | Train Loss: 0.5926 | Train Acc: 0.8826
 Site-SynthDigits                   | Train Loss: 1.7524 | Train Acc: 0.4489
 Site-MNIST_M                       | Train Loss: 1.8964 | Train Acc: 0.4233
 Site-SVHN                          | Train Loss: 2.2015 | Train Acc: 0.2137
Average Train Accuracy: 0.5644
 Site-MNIST                         | Val  Loss: 0.6299 | Val  Acc: 0.8418
 Site-USPS                          | Val  Loss: 0.6419 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0808 | Val  Acc: 0.4198
 Site-MNIST_M                       | Val  Loss: 1.9159 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1612 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5682
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.6167 | Train Acc: 0.8553
 Site-USPS                          | Train Loss: 0.5752 | Train Acc: 0.8813
 Site-SynthDigits                   | Train Loss: 1.7052 | Train Acc: 0.4470
 Site-MNIST_M                       | Train Loss: 1.8727 | Train Acc: 0.4347
 Site-SVHN                          | Train Loss: 2.1861 | Train Acc: 0.2051
Average Train Accuracy: 0.5647
 Site-MNIST                         | Val  Loss: 0.5964 | Val  Acc: 0.8620
 Site-USPS                          | Val  Loss: 0.6158 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 2.0280 | Val  Acc: 0.4351
 Site-MNIST_M                       | Val  Loss: 1.8800 | Val  Acc: 0.4253
 Site-SVHN                          | Val  Loss: 2.1464 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5715
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8620
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4351
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4253
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.5659 | Train Acc: 0.8713
 Site-USPS                          | Train Loss: 0.5298 | Train Acc: 0.8902
 Site-SynthDigits                   | Train Loss: 1.6722 | Train Acc: 0.4640
 Site-MNIST_M                       | Train Loss: 1.8416 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 2.1815 | Train Acc: 0.2009
Average Train Accuracy: 0.5694
 Site-MNIST                         | Val  Loss: 0.5406 | Val  Acc: 0.8721
 Site-USPS                          | Val  Loss: 0.5859 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0009 | Val  Acc: 0.4427
 Site-MNIST_M                       | Val  Loss: 1.8642 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1380 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5719
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8721
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4427
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4368
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.5436 | Train Acc: 0.8680
 Site-USPS                          | Train Loss: 0.5116 | Train Acc: 0.8927
 Site-SynthDigits                   | Train Loss: 1.6764 | Train Acc: 0.4640
 Site-MNIST_M                       | Train Loss: 1.8154 | Train Acc: 0.4375
 Site-SVHN                          | Train Loss: 2.1735 | Train Acc: 0.2094
Average Train Accuracy: 0.5743
 Site-MNIST                         | Val  Loss: 0.5241 | Val  Acc: 0.8754
 Site-USPS                          | Val  Loss: 0.5727 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 2.0800 | Val  Acc: 0.4504
 Site-MNIST_M                       | Val  Loss: 1.8356 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1284 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5796
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8754
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4504
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4368
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.5111 | Train Acc: 0.8831
 Site-USPS                          | Train Loss: 0.4834 | Train Acc: 0.8952
 Site-SynthDigits                   | Train Loss: 1.6520 | Train Acc: 0.4602
 Site-MNIST_M                       | Train Loss: 1.7899 | Train Acc: 0.4574
 Site-SVHN                          | Train Loss: 2.1644 | Train Acc: 0.2094
Average Train Accuracy: 0.5811
 Site-MNIST                         | Val  Loss: 0.4905 | Val  Acc: 0.8788
 Site-USPS                          | Val  Loss: 0.5419 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9848 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.8173 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1166 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5823
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8788
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4368
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.4883 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.4672 | Train Acc: 0.8990
 Site-SynthDigits                   | Train Loss: 1.6052 | Train Acc: 0.4659
 Site-MNIST_M                       | Train Loss: 1.7880 | Train Acc: 0.4403
 Site-SVHN                          | Train Loss: 2.1645 | Train Acc: 0.2137
Average Train Accuracy: 0.5812
 Site-MNIST                         | Val  Loss: 0.4605 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.5256 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.9727 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.8089 | Val  Acc: 0.4253
 Site-SVHN                          | Val  Loss: 2.1108 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5844
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8956
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4253
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.4579 | Train Acc: 0.8957
 Site-USPS                          | Train Loss: 0.4491 | Train Acc: 0.9040
 Site-SynthDigits                   | Train Loss: 1.6228 | Train Acc: 0.4754
 Site-MNIST_M                       | Train Loss: 1.7669 | Train Acc: 0.4460
 Site-SVHN                          | Train Loss: 2.1560 | Train Acc: 0.2051
Average Train Accuracy: 0.5853
 Site-MNIST                         | Val  Loss: 0.4317 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.5071 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.9760 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.7932 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1088 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5798
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.4225 | Train Acc: 0.9075
 Site-USPS                          | Train Loss: 0.4182 | Train Acc: 0.9053
 Site-SynthDigits                   | Train Loss: 1.6089 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.7614 | Train Acc: 0.4432
 Site-SVHN                          | Train Loss: 2.1556 | Train Acc: 0.2094
Average Train Accuracy: 0.5874
 Site-MNIST                         | Val  Loss: 0.4056 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.4867 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.9923 | Val  Acc: 0.4504
 Site-MNIST_M                       | Val  Loss: 1.7822 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1073 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5839
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.4133 | Train Acc: 0.8966
 Site-USPS                          | Train Loss: 0.4163 | Train Acc: 0.9053
 Site-SynthDigits                   | Train Loss: 1.5778 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.7547 | Train Acc: 0.4602
 Site-SVHN                          | Train Loss: 2.1340 | Train Acc: 0.2222
Average Train Accuracy: 0.5923
 Site-MNIST                         | Val  Loss: 0.3930 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.4737 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.9464 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.7727 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0930 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5915
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8956
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4828
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.4026 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.4019 | Train Acc: 0.9053
 Site-SynthDigits                   | Train Loss: 1.5852 | Train Acc: 0.4811
 Site-MNIST_M                       | Train Loss: 1.7504 | Train Acc: 0.4574
 Site-SVHN                          | Train Loss: 2.1395 | Train Acc: 0.2308
Average Train Accuracy: 0.5961
 Site-MNIST                         | Val  Loss: 0.3816 | Val  Acc: 0.9057
 Site-USPS                          | Val  Loss: 0.4570 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.9674 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.7568 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.0911 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5897
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.3866 | Train Acc: 0.9125
 Site-USPS                          | Train Loss: 0.3927 | Train Acc: 0.9066
 Site-SynthDigits                   | Train Loss: 1.5409 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.7169 | Train Acc: 0.4631
 Site-SVHN                          | Train Loss: 2.1428 | Train Acc: 0.2308
Average Train Accuracy: 0.5980
 Site-MNIST                         | Val  Loss: 0.3650 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.4527 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.9516 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.7610 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.0885 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5942
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4713
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.3711 | Train Acc: 0.9151
 Site-USPS                          | Train Loss: 0.3815 | Train Acc: 0.9104
 Site-SynthDigits                   | Train Loss: 1.5443 | Train Acc: 0.4905
 Site-MNIST_M                       | Train Loss: 1.7107 | Train Acc: 0.4631
 Site-SVHN                          | Train Loss: 2.1376 | Train Acc: 0.2308
Average Train Accuracy: 0.6020
 Site-MNIST                         | Val  Loss: 0.3491 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.4473 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.9343 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.7402 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0870 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5960
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9192
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.3641 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.3623 | Train Acc: 0.9104
 Site-SynthDigits                   | Train Loss: 1.5897 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.6800 | Train Acc: 0.4801
 Site-SVHN                          | Train Loss: 2.1253 | Train Acc: 0.2308
Average Train Accuracy: 0.6025
 Site-MNIST                         | Val  Loss: 0.3447 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.4232 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.9352 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.7328 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0686 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6018
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9125
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.4828
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.3503 | Train Acc: 0.9159
 Site-USPS                          | Train Loss: 0.3651 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.5211 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.7020 | Train Acc: 0.4716
 Site-SVHN                          | Train Loss: 2.1310 | Train Acc: 0.2308
Average Train Accuracy: 0.6056
 Site-MNIST                         | Val  Loss: 0.3291 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.4176 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.9383 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.7194 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0861 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6010
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.3382 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.3417 | Train Acc: 0.9141
 Site-SynthDigits                   | Train Loss: 1.5189 | Train Acc: 0.4962
 Site-MNIST_M                       | Train Loss: 1.7017 | Train Acc: 0.4631
 Site-SVHN                          | Train Loss: 2.1351 | Train Acc: 0.2265
Average Train Accuracy: 0.6040
 Site-MNIST                         | Val  Loss: 0.3166 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.4082 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9508 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.7258 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.0904 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6002
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.3307 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.3337 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.5190 | Train Acc: 0.5095
 Site-MNIST_M                       | Train Loss: 1.6630 | Train Acc: 0.4773
 Site-SVHN                          | Train Loss: 2.1087 | Train Acc: 0.2350
Average Train Accuracy: 0.6119
 Site-MNIST                         | Val  Loss: 0.3118 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.4095 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8758 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.7098 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0695 | Val  Acc: 0.2241
Average Valid Accuracy: 0.6079
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.3179 | Train Acc: 0.9184
 Site-USPS                          | Train Loss: 0.3369 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.4814 | Train Acc: 0.5133
 Site-MNIST_M                       | Train Loss: 1.6660 | Train Acc: 0.4801
 Site-SVHN                          | Train Loss: 2.1255 | Train Acc: 0.2308
Average Train Accuracy: 0.6116
 Site-MNIST                         | Val  Loss: 0.2990 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.4012 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9145 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.6895 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0703 | Val  Acc: 0.2241
Average Valid Accuracy: 0.6084
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5191
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.2982 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.3103 | Train Acc: 0.9205
 Site-SynthDigits                   | Train Loss: 1.4998 | Train Acc: 0.5208
 Site-MNIST_M                       | Train Loss: 1.6450 | Train Acc: 0.4830
 Site-SVHN                          | Train Loss: 2.1217 | Train Acc: 0.2308
Average Train Accuracy: 0.6170
 Site-MNIST                         | Val  Loss: 0.2827 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.3858 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.9411 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.6661 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0743 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6186
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9293
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.2964 | Train Acc: 0.9277
 Site-USPS                          | Train Loss: 0.3131 | Train Acc: 0.9205
 Site-SynthDigits                   | Train Loss: 1.4644 | Train Acc: 0.5189
 Site-MNIST_M                       | Train Loss: 1.6615 | Train Acc: 0.4773
 Site-SVHN                          | Train Loss: 2.1203 | Train Acc: 0.2308
Average Train Accuracy: 0.6150
 Site-MNIST                         | Val  Loss: 0.2809 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.3803 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8889 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.6822 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0754 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6171
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.2866 | Train Acc: 0.9310
 Site-USPS                          | Train Loss: 0.2949 | Train Acc: 0.9205
 Site-SynthDigits                   | Train Loss: 1.4688 | Train Acc: 0.5265
 Site-MNIST_M                       | Train Loss: 1.6474 | Train Acc: 0.4830
 Site-SVHN                          | Train Loss: 2.1162 | Train Acc: 0.2350
Average Train Accuracy: 0.6192
 Site-MNIST                         | Val  Loss: 0.2682 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3679 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8877 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.6720 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0687 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6229
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9360
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5267
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.2738 | Train Acc: 0.9352
 Site-USPS                          | Train Loss: 0.2966 | Train Acc: 0.9217
 Site-SynthDigits                   | Train Loss: 1.4967 | Train Acc: 0.5303
 Site-MNIST_M                       | Train Loss: 1.6274 | Train Acc: 0.4773
 Site-SVHN                          | Train Loss: 2.1189 | Train Acc: 0.2393
Average Train Accuracy: 0.6208
 Site-MNIST                         | Val  Loss: 0.2596 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3660 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8940 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.6674 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0677 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6195
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.2634 | Train Acc: 0.9369
 Site-USPS                          | Train Loss: 0.3038 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.4523 | Train Acc: 0.5246
 Site-MNIST_M                       | Train Loss: 1.6485 | Train Acc: 0.4858
 Site-SVHN                          | Train Loss: 2.1203 | Train Acc: 0.2350
Average Train Accuracy: 0.6213
 Site-MNIST                         | Val  Loss: 0.2477 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3615 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.9076 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.6658 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0729 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6216
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.2583 | Train Acc: 0.9386
 Site-USPS                          | Train Loss: 0.2876 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.4555 | Train Acc: 0.5379
 Site-MNIST_M                       | Train Loss: 1.6408 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.1073 | Train Acc: 0.2436
Average Train Accuracy: 0.6266
 Site-MNIST                         | Val  Loss: 0.2435 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3516 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8778 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.6540 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0657 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6318
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9428
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5420
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.2499 | Train Acc: 0.9420
 Site-USPS                          | Train Loss: 0.2767 | Train Acc: 0.9268
 Site-SynthDigits                   | Train Loss: 1.4706 | Train Acc: 0.5379
 Site-MNIST_M                       | Train Loss: 1.6018 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.1092 | Train Acc: 0.2607
Average Train Accuracy: 0.6312
 Site-MNIST                         | Val  Loss: 0.2353 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3516 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.8660 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.6264 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0600 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6307
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.2590 | Train Acc: 0.9361
 Site-USPS                          | Train Loss: 0.2825 | Train Acc: 0.9255
 Site-SynthDigits                   | Train Loss: 1.4029 | Train Acc: 0.5473
 Site-MNIST_M                       | Train Loss: 1.5943 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.0969 | Train Acc: 0.2479
Average Train Accuracy: 0.6291
 Site-MNIST                         | Val  Loss: 0.2402 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3624 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8086 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.6322 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0557 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6275
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.2440 | Train Acc: 0.9411
 Site-USPS                          | Train Loss: 0.2807 | Train Acc: 0.9268
 Site-SynthDigits                   | Train Loss: 1.4067 | Train Acc: 0.5530
 Site-MNIST_M                       | Train Loss: 1.5934 | Train Acc: 0.4915
 Site-SVHN                          | Train Loss: 2.1201 | Train Acc: 0.2479
Average Train Accuracy: 0.6321
 Site-MNIST                         | Val  Loss: 0.2294 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3394 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8523 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.6255 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0658 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6317
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.2402 | Train Acc: 0.9420
 Site-USPS                          | Train Loss: 0.2598 | Train Acc: 0.9268
 Site-SynthDigits                   | Train Loss: 1.4082 | Train Acc: 0.5492
 Site-MNIST_M                       | Train Loss: 1.5949 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.1165 | Train Acc: 0.2564
Average Train Accuracy: 0.6343
 Site-MNIST                         | Val  Loss: 0.2250 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3401 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8513 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.6151 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0671 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6356
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9428
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5496
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5057
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.2369 | Train Acc: 0.9403
 Site-USPS                          | Train Loss: 0.2750 | Train Acc: 0.9255
 Site-SynthDigits                   | Train Loss: 1.3979 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.5692 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.1014 | Train Acc: 0.2479
Average Train Accuracy: 0.6318
 Site-MNIST                         | Val  Loss: 0.2246 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3355 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.7898 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.6271 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0431 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6312
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.2286 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.2574 | Train Acc: 0.9356
 Site-SynthDigits                   | Train Loss: 1.4054 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.5567 | Train Acc: 0.4858
 Site-SVHN                          | Train Loss: 2.0898 | Train Acc: 0.2564
Average Train Accuracy: 0.6373
 Site-MNIST                         | Val  Loss: 0.2139 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3296 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.8436 | Val  Acc: 0.6031
 Site-MNIST_M                       | Val  Loss: 1.6003 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0682 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6451
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9495
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6031
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.4828
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.2266 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.2613 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.3765 | Train Acc: 0.5530
 Site-MNIST_M                       | Train Loss: 1.5720 | Train Acc: 0.4915
 Site-SVHN                          | Train Loss: 2.1200 | Train Acc: 0.2650
Average Train Accuracy: 0.6360
 Site-MNIST                         | Val  Loss: 0.2083 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3349 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.7932 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.6085 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0563 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6428
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.2175 | Train Acc: 0.9512
 Site-USPS                          | Train Loss: 0.2610 | Train Acc: 0.9280
 Site-SynthDigits                   | Train Loss: 1.3614 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.5658 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.1122 | Train Acc: 0.2521
Average Train Accuracy: 0.6359
 Site-MNIST                         | Val  Loss: 0.2020 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3204 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8005 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.6054 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0555 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6370
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.2147 | Train Acc: 0.9521
 Site-USPS                          | Train Loss: 0.2442 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.3401 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.5355 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1191 | Train Acc: 0.2521
Average Train Accuracy: 0.6403
 Site-MNIST                         | Val  Loss: 0.1988 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3023 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.8060 | Val  Acc: 0.5802
 Site-MNIST_M                       | Val  Loss: 1.5929 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0531 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6435
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.2018 | Train Acc: 0.9546
 Site-USPS                          | Train Loss: 0.2324 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.3631 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.5499 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 2.1011 | Train Acc: 0.2521
Average Train Accuracy: 0.6391
 Site-MNIST                         | Val  Loss: 0.1888 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.2959 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.8017 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.6058 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0580 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6388
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1985 | Train Acc: 0.9563
 Site-USPS                          | Train Loss: 0.2345 | Train Acc: 0.9331
 Site-SynthDigits                   | Train Loss: 1.3715 | Train Acc: 0.5587
 Site-MNIST_M                       | Train Loss: 1.5270 | Train Acc: 0.4943
 Site-SVHN                          | Train Loss: 2.1059 | Train Acc: 0.2564
Average Train Accuracy: 0.6398
 Site-MNIST                         | Val  Loss: 0.1841 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2943 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.8008 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.5886 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.0631 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6438
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1953 | Train Acc: 0.9554
 Site-USPS                          | Train Loss: 0.2429 | Train Acc: 0.9369
 Site-SynthDigits                   | Train Loss: 1.3332 | Train Acc: 0.5701
 Site-MNIST_M                       | Train Loss: 1.5454 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 2.1057 | Train Acc: 0.2521
Average Train Accuracy: 0.6429
 Site-MNIST                         | Val  Loss: 0.1817 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2879 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.8021 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.5815 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0566 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6446
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1931 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2237 | Train Acc: 0.9343
 Site-SynthDigits                   | Train Loss: 1.3399 | Train Acc: 0.5720
 Site-MNIST_M                       | Train Loss: 1.5347 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 2.1184 | Train Acc: 0.2650
Average Train Accuracy: 0.6457
 Site-MNIST                         | Val  Loss: 0.1812 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2898 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.7596 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.5871 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0497 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6454
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9192
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5725
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.4828
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1933 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2402 | Train Acc: 0.9394
 Site-SynthDigits                   | Train Loss: 1.3228 | Train Acc: 0.5644
 Site-MNIST_M                       | Train Loss: 1.5057 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.0969 | Train Acc: 0.2564
Average Train Accuracy: 0.6466
 Site-MNIST                         | Val  Loss: 0.1784 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2849 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7420 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.5623 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0533 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6517
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5725
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.5057
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1830 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2188 | Train Acc: 0.9444
 Site-SynthDigits                   | Train Loss: 1.3106 | Train Acc: 0.5644
 Site-MNIST_M                       | Train Loss: 1.5099 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 2.1009 | Train Acc: 0.2521
Average Train Accuracy: 0.6438
 Site-MNIST                         | Val  Loss: 0.1702 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2856 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7730 | Val  Acc: 0.6031
 Site-MNIST_M                       | Val  Loss: 1.5562 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0511 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6572
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9663
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9293
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.6031
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/term...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1782 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.2134 | Train Acc: 0.9419
 Site-SynthDigits                   | Train Loss: 1.3074 | Train Acc: 0.5587
 Site-MNIST_M                       | Train Loss: 1.5089 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 2.1015 | Train Acc: 0.2521
Average Train Accuracy: 0.6436
 Site-MNIST                         | Val  Loss: 0.1665 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2756 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7655 | Val  Acc: 0.5878
 Site-MNIST_M                       | Val  Loss: 1.5588 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.0538 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6542
===2023-07-02 15:49:12===
===2023-07-02 15:49:15===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.9203
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9290
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5400
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.3817
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.2762
MNIST: 0.9203, USPS: 0.9290, SynthDigits: 0.5400, MNIST_M: 0.3817, SVHN: 0.2762, 
Average Test Accuracy(group): 0.6094, Average Test Accuracy(individual): 0.6094,
domain std=0.2707, cluster std=-1.0000, individual std=0.2707, 
