===2023-07-02 18:42:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0352 | Train Acc: 0.6182
 Site-USPS                          | Train Loss: 2.0084 | Train Acc: 0.5997
 Site-SynthDigits                   | Train Loss: 2.2340 | Train Acc: 0.2614
 Site-MNIST_M                       | Train Loss: 2.2801 | Train Acc: 0.1648
 Site-SVHN                          | Train Loss: 2.2847 | Train Acc: 0.1111
Average Train Accuracy: 0.3510
 Site-MNIST                         | Val  Loss: 2.0320 | Val  Acc: 0.6229
 Site-USPS                          | Val  Loss: 1.9862 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 2.2840 | Val  Acc: 0.2443
 Site-MNIST_M                       | Val  Loss: 2.2816 | Val  Acc: 0.1609
 Site-SVHN                          | Val  Loss: 2.2787 | Val  Acc: 0.1552
Average Valid Accuracy: 0.3548
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6229
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2443
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.7963 | Train Acc: 0.6972
 Site-USPS                          | Train Loss: 1.7591 | Train Acc: 0.6629
 Site-SynthDigits                   | Train Loss: 2.1544 | Train Acc: 0.3277
 Site-MNIST_M                       | Train Loss: 2.2371 | Train Acc: 0.2670
 Site-SVHN                          | Train Loss: 2.2743 | Train Acc: 0.1496
Average Train Accuracy: 0.4209
 Site-MNIST                         | Val  Loss: 1.7862 | Val  Acc: 0.7104
 Site-USPS                          | Val  Loss: 1.7325 | Val  Acc: 0.6566
 Site-SynthDigits                   | Val  Loss: 2.2377 | Val  Acc: 0.3435
 Site-MNIST_M                       | Val  Loss: 2.2370 | Val  Acc: 0.2529
 Site-SVHN                          | Val  Loss: 2.2778 | Val  Acc: 0.1552
Average Valid Accuracy: 0.4237
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7104
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6566
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3435
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2529
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.5787 | Train Acc: 0.7309
 Site-USPS                          | Train Loss: 1.5619 | Train Acc: 0.7020
 Site-SynthDigits                   | Train Loss: 2.0940 | Train Acc: 0.3542
 Site-MNIST_M                       | Train Loss: 2.2005 | Train Acc: 0.2784
 Site-SVHN                          | Train Loss: 2.2645 | Train Acc: 0.1581
Average Train Accuracy: 0.4447
 Site-MNIST                         | Val  Loss: 1.5683 | Val  Acc: 0.7542
 Site-USPS                          | Val  Loss: 1.5376 | Val  Acc: 0.6717
 Site-SynthDigits                   | Val  Loss: 2.1927 | Val  Acc: 0.3664
 Site-MNIST_M                       | Val  Loss: 2.2037 | Val  Acc: 0.2644
 Site-SVHN                          | Val  Loss: 2.2676 | Val  Acc: 0.1724
Average Valid Accuracy: 0.4458
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7542
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6717
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3664
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2644
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.3924 | Train Acc: 0.7704
 Site-USPS                          | Train Loss: 1.3932 | Train Acc: 0.7513
 Site-SynthDigits                   | Train Loss: 2.0313 | Train Acc: 0.3674
 Site-MNIST_M                       | Train Loss: 2.1591 | Train Acc: 0.3239
 Site-SVHN                          | Train Loss: 2.2526 | Train Acc: 0.1453
Average Train Accuracy: 0.4716
 Site-MNIST                         | Val  Loss: 1.3780 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 1.3655 | Val  Acc: 0.7273
 Site-SynthDigits                   | Val  Loss: 2.1599 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.1634 | Val  Acc: 0.3103
 Site-SVHN                          | Val  Loss: 2.2501 | Val  Acc: 0.1207
Average Valid Accuracy: 0.4681
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7778
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7273
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3103
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.2434 | Train Acc: 0.7923
 Site-USPS                          | Train Loss: 1.2192 | Train Acc: 0.7917
 Site-SynthDigits                   | Train Loss: 1.9896 | Train Acc: 0.3864
 Site-MNIST_M                       | Train Loss: 2.1240 | Train Acc: 0.3210
 Site-SVHN                          | Train Loss: 2.2377 | Train Acc: 0.1496
Average Train Accuracy: 0.4882
 Site-MNIST                         | Val  Loss: 1.2310 | Val  Acc: 0.7879
 Site-USPS                          | Val  Loss: 1.1923 | Val  Acc: 0.7576
 Site-SynthDigits                   | Val  Loss: 2.1373 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.1262 | Val  Acc: 0.3103
 Site-SVHN                          | Val  Loss: 2.2310 | Val  Acc: 0.1207
Average Valid Accuracy: 0.4762
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7879
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7576
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3103
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.1057 | Train Acc: 0.8091
 Site-USPS                          | Train Loss: 1.0821 | Train Acc: 0.8030
 Site-SynthDigits                   | Train Loss: 1.9274 | Train Acc: 0.4091
 Site-MNIST_M                       | Train Loss: 2.0742 | Train Acc: 0.3409
 Site-SVHN                          | Train Loss: 2.2276 | Train Acc: 0.1923
Average Train Accuracy: 0.5109
 Site-MNIST                         | Val  Loss: 1.0888 | Val  Acc: 0.8047
 Site-USPS                          | Val  Loss: 1.0648 | Val  Acc: 0.7778
 Site-SynthDigits                   | Val  Loss: 2.1408 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.0709 | Val  Acc: 0.3563
 Site-SVHN                          | Val  Loss: 2.2262 | Val  Acc: 0.1724
Average Valid Accuracy: 0.5032
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8047
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7778
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3563
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.9827 | Train Acc: 0.8276
 Site-USPS                          | Train Loss: 0.9613 | Train Acc: 0.8270
 Site-SynthDigits                   | Train Loss: 1.8768 | Train Acc: 0.4091
 Site-MNIST_M                       | Train Loss: 2.0530 | Train Acc: 0.3608
 Site-SVHN                          | Train Loss: 2.2215 | Train Acc: 0.1966
Average Train Accuracy: 0.5242
 Site-MNIST                         | Val  Loss: 0.9667 | Val  Acc: 0.8283
 Site-USPS                          | Val  Loss: 0.9455 | Val  Acc: 0.8182
 Site-SynthDigits                   | Val  Loss: 2.1353 | Val  Acc: 0.4198
 Site-MNIST_M                       | Val  Loss: 2.0295 | Val  Acc: 0.3678
 Site-SVHN                          | Val  Loss: 2.2070 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5282
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8283
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8182
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4198
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3678
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.8954 | Train Acc: 0.8360
 Site-USPS                          | Train Loss: 0.8676 | Train Acc: 0.8422
 Site-SynthDigits                   | Train Loss: 1.8597 | Train Acc: 0.4186
 Site-MNIST_M                       | Train Loss: 2.0126 | Train Acc: 0.3608
 Site-SVHN                          | Train Loss: 2.2108 | Train Acc: 0.2222
Average Train Accuracy: 0.5359
 Site-MNIST                         | Val  Loss: 0.8751 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.8678 | Val  Acc: 0.8434
 Site-SynthDigits                   | Val  Loss: 2.1260 | Val  Acc: 0.4351
 Site-MNIST_M                       | Val  Loss: 1.9974 | Val  Acc: 0.3793
 Site-SVHN                          | Val  Loss: 2.1978 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5503
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8350
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8434
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4351
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3793
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.8242 | Train Acc: 0.8276
 Site-USPS                          | Train Loss: 0.7815 | Train Acc: 0.8535
 Site-SynthDigits                   | Train Loss: 1.8190 | Train Acc: 0.4205
 Site-MNIST_M                       | Train Loss: 1.9757 | Train Acc: 0.3778
 Site-SVHN                          | Train Loss: 2.2024 | Train Acc: 0.2265
Average Train Accuracy: 0.5412
 Site-MNIST                         | Val  Loss: 0.8019 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.7955 | Val  Acc: 0.8586
 Site-SynthDigits                   | Val  Loss: 2.1228 | Val  Acc: 0.4122
 Site-MNIST_M                       | Val  Loss: 1.9624 | Val  Acc: 0.3793
 Site-SVHN                          | Val  Loss: 2.1804 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5522
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8350
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8586
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4122
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3793
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.7602 | Train Acc: 0.8310
 Site-USPS                          | Train Loss: 0.7332 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.7907 | Train Acc: 0.4242
 Site-MNIST_M                       | Train Loss: 1.9434 | Train Acc: 0.4006
 Site-SVHN                          | Train Loss: 2.1966 | Train Acc: 0.2222
Average Train Accuracy: 0.5486
 Site-MNIST                         | Val  Loss: 0.7407 | Val  Acc: 0.8418
 Site-USPS                          | Val  Loss: 0.7396 | Val  Acc: 0.8586
 Site-SynthDigits                   | Val  Loss: 2.1313 | Val  Acc: 0.4122
 Site-MNIST_M                       | Val  Loss: 1.9335 | Val  Acc: 0.3908
 Site-SVHN                          | Val  Loss: 2.1693 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5489
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.7069 | Train Acc: 0.8419
 Site-USPS                          | Train Loss: 0.6788 | Train Acc: 0.8699
 Site-SynthDigits                   | Train Loss: 1.7769 | Train Acc: 0.4337
 Site-MNIST_M                       | Train Loss: 1.9104 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 2.1953 | Train Acc: 0.2265
Average Train Accuracy: 0.5585
 Site-MNIST                         | Val  Loss: 0.6807 | Val  Acc: 0.8384
 Site-USPS                          | Val  Loss: 0.7021 | Val  Acc: 0.8636
 Site-SynthDigits                   | Val  Loss: 2.0990 | Val  Acc: 0.4275
 Site-MNIST_M                       | Val  Loss: 1.8991 | Val  Acc: 0.4138
 Site-SVHN                          | Val  Loss: 2.1644 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5535
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8384
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8636
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4275
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4138
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.6765 | Train Acc: 0.8385
 Site-USPS                          | Train Loss: 0.6302 | Train Acc: 0.8712
 Site-SynthDigits                   | Train Loss: 1.7170 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 1.8948 | Train Acc: 0.4233
 Site-SVHN                          | Train Loss: 2.1889 | Train Acc: 0.2179
Average Train Accuracy: 0.5603
 Site-MNIST                         | Val  Loss: 0.6496 | Val  Acc: 0.8451
 Site-USPS                          | Val  Loss: 0.6655 | Val  Acc: 0.8687
 Site-SynthDigits                   | Val  Loss: 2.1121 | Val  Acc: 0.4580
 Site-MNIST_M                       | Val  Loss: 1.8703 | Val  Acc: 0.4023
 Site-SVHN                          | Val  Loss: 2.1510 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5665
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8451
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8687
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4580
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4023
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.6258 | Train Acc: 0.8520
 Site-USPS                          | Train Loss: 0.5968 | Train Acc: 0.8788
 Site-SynthDigits                   | Train Loss: 1.7045 | Train Acc: 0.4470
 Site-MNIST_M                       | Train Loss: 1.8552 | Train Acc: 0.4403
 Site-SVHN                          | Train Loss: 2.1758 | Train Acc: 0.2179
Average Train Accuracy: 0.5672
 Site-MNIST                         | Val  Loss: 0.6006 | Val  Acc: 0.8519
 Site-USPS                          | Val  Loss: 0.6288 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 2.0644 | Val  Acc: 0.4580
 Site-MNIST_M                       | Val  Loss: 1.8510 | Val  Acc: 0.4483
 Site-SVHN                          | Val  Loss: 2.1443 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5781
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8519
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8737
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4580
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4483
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.5888 | Train Acc: 0.8528
 Site-USPS                          | Train Loss: 0.5706 | Train Acc: 0.8838
 Site-SynthDigits                   | Train Loss: 1.6937 | Train Acc: 0.4640
 Site-MNIST_M                       | Train Loss: 1.8517 | Train Acc: 0.4460
 Site-SVHN                          | Train Loss: 2.1775 | Train Acc: 0.2308
Average Train Accuracy: 0.5755
 Site-MNIST                         | Val  Loss: 0.5649 | Val  Acc: 0.8552
 Site-USPS                          | Val  Loss: 0.6025 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 2.0660 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.8271 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.1400 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5802
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8552
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4598
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.5621 | Train Acc: 0.8595
 Site-USPS                          | Train Loss: 0.5327 | Train Acc: 0.8813
 Site-SynthDigits                   | Train Loss: 1.7095 | Train Acc: 0.4564
 Site-MNIST_M                       | Train Loss: 1.7930 | Train Acc: 0.4460
 Site-SVHN                          | Train Loss: 2.1736 | Train Acc: 0.2137
Average Train Accuracy: 0.5714
 Site-MNIST                         | Val  Loss: 0.5391 | Val  Acc: 0.8552
 Site-USPS                          | Val  Loss: 0.5770 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 2.0392 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.8024 | Val  Acc: 0.4253
 Site-SVHN                          | Val  Loss: 2.1348 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5748
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.5282 | Train Acc: 0.8688
 Site-USPS                          | Train Loss: 0.5219 | Train Acc: 0.8889
 Site-SynthDigits                   | Train Loss: 1.6389 | Train Acc: 0.4602
 Site-MNIST_M                       | Train Loss: 1.7854 | Train Acc: 0.4517
 Site-SVHN                          | Train Loss: 2.1750 | Train Acc: 0.2222
Average Train Accuracy: 0.5784
 Site-MNIST                         | Val  Loss: 0.5029 | Val  Acc: 0.8620
 Site-USPS                          | Val  Loss: 0.5634 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0390 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.7837 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.1298 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5821
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8620
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4598
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.5038 | Train Acc: 0.8747
 Site-USPS                          | Train Loss: 0.4867 | Train Acc: 0.8927
 Site-SynthDigits                   | Train Loss: 1.6478 | Train Acc: 0.4659
 Site-MNIST_M                       | Train Loss: 1.7556 | Train Acc: 0.4688
 Site-SVHN                          | Train Loss: 2.1678 | Train Acc: 0.2051
Average Train Accuracy: 0.5814
 Site-MNIST                         | Val  Loss: 0.4825 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.5437 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 2.0278 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.7510 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.1242 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5911
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8653
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.4861 | Train Acc: 0.8789
 Site-USPS                          | Train Loss: 0.4711 | Train Acc: 0.8914
 Site-SynthDigits                   | Train Loss: 1.6328 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.7354 | Train Acc: 0.4801
 Site-SVHN                          | Train Loss: 2.1711 | Train Acc: 0.2094
Average Train Accuracy: 0.5863
 Site-MNIST                         | Val  Loss: 0.4598 | Val  Acc: 0.8721
 Site-USPS                          | Val  Loss: 0.5288 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0138 | Val  Acc: 0.4885
 Site-MNIST_M                       | Val  Loss: 1.7301 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.1178 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6041
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8721
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4885
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.4651 | Train Acc: 0.8831
 Site-USPS                          | Train Loss: 0.4622 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.5739 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.7269 | Train Acc: 0.4801
 Site-SVHN                          | Train Loss: 2.1539 | Train Acc: 0.2094
Average Train Accuracy: 0.5888
 Site-MNIST                         | Val  Loss: 0.4365 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.5188 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0113 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.7122 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.1125 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5862
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.4368 | Train Acc: 0.8907
 Site-USPS                          | Train Loss: 0.4365 | Train Acc: 0.8977
 Site-SynthDigits                   | Train Loss: 1.6240 | Train Acc: 0.4792
 Site-MNIST_M                       | Train Loss: 1.6989 | Train Acc: 0.4830
 Site-SVHN                          | Train Loss: 2.1567 | Train Acc: 0.2137
Average Train Accuracy: 0.5928
 Site-MNIST                         | Val  Loss: 0.4131 | Val  Acc: 0.8754
 Site-USPS                          | Val  Loss: 0.5067 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 2.0010 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.6993 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1073 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5954
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.4193 | Train Acc: 0.8966
 Site-USPS                          | Train Loss: 0.4232 | Train Acc: 0.8965
 Site-SynthDigits                   | Train Loss: 1.5712 | Train Acc: 0.4886
 Site-MNIST_M                       | Train Loss: 1.6998 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1633 | Train Acc: 0.2137
Average Train Accuracy: 0.5996
 Site-MNIST                         | Val  Loss: 0.3970 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4925 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9754 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6716 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.1012 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6048
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.4103 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4083 | Train Acc: 0.8990
 Site-SynthDigits                   | Train Loss: 1.5531 | Train Acc: 0.4924
 Site-MNIST_M                       | Train Loss: 1.6867 | Train Acc: 0.4858
 Site-SVHN                          | Train Loss: 2.1521 | Train Acc: 0.2094
Average Train Accuracy: 0.5963
 Site-MNIST                         | Val  Loss: 0.3854 | Val  Acc: 0.8855
 Site-USPS                          | Val  Loss: 0.4865 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9590 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6666 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0987 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6005
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.3880 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.3966 | Train Acc: 0.8990
 Site-SynthDigits                   | Train Loss: 1.5502 | Train Acc: 0.4830
 Site-MNIST_M                       | Train Loss: 1.6693 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.1453 | Train Acc: 0.2222
Average Train Accuracy: 0.5997
 Site-MNIST                         | Val  Loss: 0.3664 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.4697 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9722 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.6501 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1004 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6071
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9091
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5057
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.3825 | Train Acc: 0.9016
 Site-USPS                          | Train Loss: 0.3897 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.4987 | Train Acc: 0.4981
 Site-MNIST_M                       | Train Loss: 1.6618 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.1383 | Train Acc: 0.2051
Average Train Accuracy: 0.5990
 Site-MNIST                         | Val  Loss: 0.3620 | Val  Acc: 0.8923
 Site-USPS                          | Val  Loss: 0.4573 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9319 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6414 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0951 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6018
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.3629 | Train Acc: 0.9066
 Site-USPS                          | Train Loss: 0.3674 | Train Acc: 0.9066
 Site-SynthDigits                   | Train Loss: 1.5050 | Train Acc: 0.4962
 Site-MNIST_M                       | Train Loss: 1.6447 | Train Acc: 0.4858
 Site-SVHN                          | Train Loss: 2.1371 | Train Acc: 0.2265
Average Train Accuracy: 0.6043
 Site-MNIST                         | Val  Loss: 0.3395 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4489 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9388 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6180 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0952 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6154
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.3526 | Train Acc: 0.9100
 Site-USPS                          | Train Loss: 0.3758 | Train Acc: 0.9003
 Site-SynthDigits                   | Train Loss: 1.4974 | Train Acc: 0.5038
 Site-MNIST_M                       | Train Loss: 1.6202 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 2.1315 | Train Acc: 0.2222
Average Train Accuracy: 0.6073
 Site-MNIST                         | Val  Loss: 0.3310 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.4408 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9284 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.6092 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0846 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6129
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.3433 | Train Acc: 0.9117
 Site-USPS                          | Train Loss: 0.3522 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4435 | Train Acc: 0.5114
 Site-MNIST_M                       | Train Loss: 1.6356 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.1330 | Train Acc: 0.2265
Average Train Accuracy: 0.6112
 Site-MNIST                         | Val  Loss: 0.3216 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.4315 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9185 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.5922 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0822 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6257
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4962
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5517
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.3355 | Train Acc: 0.9134
 Site-USPS                          | Train Loss: 0.3464 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4883 | Train Acc: 0.5246
 Site-MNIST_M                       | Train Loss: 1.6289 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1431 | Train Acc: 0.2308
Average Train Accuracy: 0.6178
 Site-MNIST                         | Val  Loss: 0.3112 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.4209 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9210 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.5833 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0776 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6267
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9125
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.3127 | Train Acc: 0.9243
 Site-USPS                          | Train Loss: 0.3366 | Train Acc: 0.9040
 Site-SynthDigits                   | Train Loss: 1.4972 | Train Acc: 0.5152
 Site-MNIST_M                       | Train Loss: 1.6138 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.1361 | Train Acc: 0.2393
Average Train Accuracy: 0.6160
 Site-MNIST                         | Val  Loss: 0.2932 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.4139 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9313 | Val  Acc: 0.4885
 Site-MNIST_M                       | Val  Loss: 1.5805 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0814 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6214
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.3042 | Train Acc: 0.9268
 Site-USPS                          | Train Loss: 0.3349 | Train Acc: 0.9066
 Site-SynthDigits                   | Train Loss: 1.4471 | Train Acc: 0.5265
 Site-MNIST_M                       | Train Loss: 1.5819 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1282 | Train Acc: 0.2393
Average Train Accuracy: 0.6221
 Site-MNIST                         | Val  Loss: 0.2836 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.4000 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9285 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.5712 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0768 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6266
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.2953 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.3240 | Train Acc: 0.9104
 Site-SynthDigits                   | Train Loss: 1.4670 | Train Acc: 0.5322
 Site-MNIST_M                       | Train Loss: 1.5731 | Train Acc: 0.5085
 Site-SVHN                          | Train Loss: 2.1180 | Train Acc: 0.2479
Average Train Accuracy: 0.6258
 Site-MNIST                         | Val  Loss: 0.2734 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.3973 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.8990 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.5513 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0755 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6318
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9293
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5191
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.2899 | Train Acc: 0.9243
 Site-USPS                          | Train Loss: 0.3186 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.4053 | Train Acc: 0.5436
 Site-MNIST_M                       | Train Loss: 1.5782 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 2.1310 | Train Acc: 0.2479
Average Train Accuracy: 0.6274
 Site-MNIST                         | Val  Loss: 0.2713 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.3934 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8931 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.5460 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0754 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6367
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9259
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5420
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.2746 | Train Acc: 0.9378
 Site-USPS                          | Train Loss: 0.3121 | Train Acc: 0.9179
 Site-SynthDigits                   | Train Loss: 1.4260 | Train Acc: 0.5227
 Site-MNIST_M                       | Train Loss: 1.5616 | Train Acc: 0.5085
 Site-SVHN                          | Train Loss: 2.1106 | Train Acc: 0.2521
Average Train Accuracy: 0.6278
 Site-MNIST                         | Val  Loss: 0.2546 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3848 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8993 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.5414 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0795 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6368
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.2647 | Train Acc: 0.9403
 Site-USPS                          | Train Loss: 0.2980 | Train Acc: 0.9217
 Site-SynthDigits                   | Train Loss: 1.4145 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.5628 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1169 | Train Acc: 0.2479
Average Train Accuracy: 0.6305
 Site-MNIST                         | Val  Loss: 0.2450 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3722 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8915 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.5417 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0736 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6428
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9428
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5267
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.2734 | Train Acc: 0.9310
 Site-USPS                          | Train Loss: 0.2887 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.4087 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.5790 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1372 | Train Acc: 0.2393
Average Train Accuracy: 0.6302
 Site-MNIST                         | Val  Loss: 0.2550 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.3676 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8560 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.5396 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0748 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6357
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.2593 | Train Acc: 0.9378
 Site-USPS                          | Train Loss: 0.2942 | Train Acc: 0.9179
 Site-SynthDigits                   | Train Loss: 1.3934 | Train Acc: 0.5417
 Site-MNIST_M                       | Train Loss: 1.5537 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1162 | Train Acc: 0.2521
Average Train Accuracy: 0.6322
 Site-MNIST                         | Val  Loss: 0.2426 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3647 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8516 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.5229 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0634 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6397
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.2579 | Train Acc: 0.9378
 Site-USPS                          | Train Loss: 0.2841 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.3716 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.5387 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1165 | Train Acc: 0.2607
Average Train Accuracy: 0.6362
 Site-MNIST                         | Val  Loss: 0.2357 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3586 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8524 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.5172 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0648 | Val  Acc: 0.3448
Average Valid Accuracy: 0.6520
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9529
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.2439 | Train Acc: 0.9411
 Site-USPS                          | Train Loss: 0.2750 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.4150 | Train Acc: 0.5360
 Site-MNIST_M                       | Train Loss: 1.5403 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1057 | Train Acc: 0.2436
Average Train Accuracy: 0.6318
 Site-MNIST                         | Val  Loss: 0.2247 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3515 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8570 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.5133 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0617 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6468
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.2404 | Train Acc: 0.9420
 Site-USPS                          | Train Loss: 0.2790 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.3677 | Train Acc: 0.5549
 Site-MNIST_M                       | Train Loss: 1.5390 | Train Acc: 0.5085
 Site-SVHN                          | Train Loss: 2.1113 | Train Acc: 0.2521
Average Train Accuracy: 0.6364
 Site-MNIST                         | Val  Loss: 0.2217 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3432 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8555 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.5021 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0666 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6485
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.2304 | Train Acc: 0.9428
 Site-USPS                          | Train Loss: 0.2660 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.3576 | Train Acc: 0.5530
 Site-MNIST_M                       | Train Loss: 1.5346 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1019 | Train Acc: 0.2521
Average Train Accuracy: 0.6365
 Site-MNIST                         | Val  Loss: 0.2149 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3324 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.8379 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.4970 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0648 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6484
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.2243 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.2638 | Train Acc: 0.9293
 Site-SynthDigits                   | Train Loss: 1.3867 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.5134 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 2.1084 | Train Acc: 0.2564
Average Train Accuracy: 0.6377
 Site-MNIST                         | Val  Loss: 0.2060 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3275 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.8425 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.4882 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0624 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6502
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.2276 | Train Acc: 0.9411
 Site-USPS                          | Train Loss: 0.2634 | Train Acc: 0.9280
 Site-SynthDigits                   | Train Loss: 1.3502 | Train Acc: 0.5587
 Site-MNIST_M                       | Train Loss: 1.4751 | Train Acc: 0.5227
 Site-SVHN                          | Train Loss: 2.1183 | Train Acc: 0.2521
Average Train Accuracy: 0.6405
 Site-MNIST                         | Val  Loss: 0.2109 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3239 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.8109 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.4845 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0635 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6500
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.2192 | Train Acc: 0.9479
 Site-USPS                          | Train Loss: 0.2448 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.3368 | Train Acc: 0.5644
 Site-MNIST_M                       | Train Loss: 1.5065 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1106 | Train Acc: 0.2521
Average Train Accuracy: 0.6421
 Site-MNIST                         | Val  Loss: 0.2041 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3170 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7973 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.4926 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0730 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6546
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9562
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5573
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.2048 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.2542 | Train Acc: 0.9331
 Site-SynthDigits                   | Train Loss: 1.3753 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.4984 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1051 | Train Acc: 0.2650
Average Train Accuracy: 0.6439
 Site-MNIST                         | Val  Loss: 0.1905 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3099 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7976 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.4707 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0706 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6596
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9562
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5496
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.2062 | Train Acc: 0.9521
 Site-USPS                          | Train Loss: 0.2465 | Train Acc: 0.9331
 Site-SynthDigits                   | Train Loss: 1.3233 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.4693 | Train Acc: 0.5284
 Site-SVHN                          | Train Loss: 2.1242 | Train Acc: 0.2607
Average Train Accuracy: 0.6473
 Site-MNIST                         | Val  Loss: 0.1913 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3105 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7815 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.4706 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0698 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6595
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.2123 | Train Acc: 0.9445
 Site-USPS                          | Train Loss: 0.2422 | Train Acc: 0.9343
 Site-SynthDigits                   | Train Loss: 1.3447 | Train Acc: 0.5758
 Site-MNIST_M                       | Train Loss: 1.4752 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 2.1077 | Train Acc: 0.2650
Average Train Accuracy: 0.6479
 Site-MNIST                         | Val  Loss: 0.1924 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3081 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7954 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.4538 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0614 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6631
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9293
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5725
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1890 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2311 | Train Acc: 0.9394
 Site-SynthDigits                   | Train Loss: 1.3248 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.4742 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1143 | Train Acc: 0.2650
Average Train Accuracy: 0.6476
 Site-MNIST                         | Val  Loss: 0.1734 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2993 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7907 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.4508 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0640 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6651
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9293
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5573
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5517
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1866 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2242 | Train Acc: 0.9394
 Site-SynthDigits                   | Train Loss: 1.3314 | Train Acc: 0.5644
 Site-MNIST_M                       | Train Loss: 1.4789 | Train Acc: 0.5170
 Site-SVHN                          | Train Loss: 2.0936 | Train Acc: 0.2650
Average Train Accuracy: 0.6486
 Site-MNIST                         | Val  Loss: 0.1703 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3011 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7738 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.4436 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0616 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6658
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9293
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5573
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.5517
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1862 | Train Acc: 0.9546
 Site-USPS                          | Train Loss: 0.2256 | Train Acc: 0.9381
 Site-SynthDigits                   | Train Loss: 1.3151 | Train Acc: 0.5758
 Site-MNIST_M                       | Train Loss: 1.4659 | Train Acc: 0.5227
 Site-SVHN                          | Train Loss: 2.1154 | Train Acc: 0.2692
Average Train Accuracy: 0.6521
 Site-MNIST                         | Val  Loss: 0.1720 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2950 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7304 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.4555 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0639 | Val  Acc: 0.3448
Average Valid Accuracy: 0.6668
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5649
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1786 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2200 | Train Acc: 0.9356
 Site-SynthDigits                   | Train Loss: 1.2981 | Train Acc: 0.5663
 Site-MNIST_M                       | Train Loss: 1.4592 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1061 | Train Acc: 0.2650
Average Train Accuracy: 0.6478
 Site-MNIST                         | Val  Loss: 0.1633 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2896 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7470 | Val  Acc: 0.5802
 Site-MNIST_M                       | Val  Loss: 1.4324 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0635 | Val  Acc: 0.3448
Average Valid Accuracy: 0.6662
===2023-07-02 19:45:30===
===2023-07-02 19:45:33===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.9194
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9247
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5547
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.3963
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.2710
MNIST: 0.9194, USPS: 0.9247, SynthDigits: 0.5547, MNIST_M: 0.3963, SVHN: 0.2710, 
Average Test Accuracy(group): 0.6132, Average Test Accuracy(individual): 0.6132,
domain std=0.2677, cluster std=-1.0000, individual std=0.2677, 
===2023-07-30 13:58:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0352 | Train Acc: 0.6182
 Site-USPS                          | Train Loss: 2.0084 | Train Acc: 0.5997
 Site-SynthDigits                   | Train Loss: 2.2340 | Train Acc: 0.2614
 Site-MNIST_M                       | Train Loss: 2.2801 | Train Acc: 0.1648
 Site-SVHN                          | Train Loss: 2.2847 | Train Acc: 0.1111
Average Train Accuracy: 0.3510
 Site-MNIST                         | Val  Loss: 2.0320 | Val  Acc: 0.6229
 Site-USPS                          | Val  Loss: 1.9862 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 2.2840 | Val  Acc: 0.2443
 Site-MNIST_M                       | Val  Loss: 2.2816 | Val  Acc: 0.1609
 Site-SVHN                          | Val  Loss: 2.2787 | Val  Acc: 0.1552
Average Valid Accuracy: 0.3548
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6229
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2443
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.7963 | Train Acc: 0.6972
 Site-USPS                          | Train Loss: 1.7591 | Train Acc: 0.6629
 Site-SynthDigits                   | Train Loss: 2.1544 | Train Acc: 0.3277
 Site-MNIST_M                       | Train Loss: 2.2371 | Train Acc: 0.2670
 Site-SVHN                          | Train Loss: 2.2743 | Train Acc: 0.1496
Average Train Accuracy: 0.4209
 Site-MNIST                         | Val  Loss: 1.7862 | Val  Acc: 0.7104
 Site-USPS                          | Val  Loss: 1.7325 | Val  Acc: 0.6566
 Site-SynthDigits                   | Val  Loss: 2.2377 | Val  Acc: 0.3435
 Site-MNIST_M                       | Val  Loss: 2.2370 | Val  Acc: 0.2529
 Site-SVHN                          | Val  Loss: 2.2778 | Val  Acc: 0.1552
Average Valid Accuracy: 0.4237
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7104
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6566
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3435
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2529
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.5787 | Train Acc: 0.7309
 Site-USPS                          | Train Loss: 1.5619 | Train Acc: 0.7020
 Site-SynthDigits                   | Train Loss: 2.0940 | Train Acc: 0.3542
 Site-MNIST_M                       | Train Loss: 2.2005 | Train Acc: 0.2784
 Site-SVHN                          | Train Loss: 2.2645 | Train Acc: 0.1581
Average Train Accuracy: 0.4447
 Site-MNIST                         | Val  Loss: 1.5683 | Val  Acc: 0.7542
 Site-USPS                          | Val  Loss: 1.5376 | Val  Acc: 0.6717
 Site-SynthDigits                   | Val  Loss: 2.1927 | Val  Acc: 0.3664
 Site-MNIST_M                       | Val  Loss: 2.2037 | Val  Acc: 0.2644
 Site-SVHN                          | Val  Loss: 2.2676 | Val  Acc: 0.1724
Average Valid Accuracy: 0.4458
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7542
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6717
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3664
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2644
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.3924 | Train Acc: 0.7704
 Site-USPS                          | Train Loss: 1.3932 | Train Acc: 0.7513
 Site-SynthDigits                   | Train Loss: 2.0313 | Train Acc: 0.3674
 Site-MNIST_M                       | Train Loss: 2.1591 | Train Acc: 0.3239
 Site-SVHN                          | Train Loss: 2.2526 | Train Acc: 0.1453
Average Train Accuracy: 0.4716
 Site-MNIST                         | Val  Loss: 1.3780 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 1.3655 | Val  Acc: 0.7273
 Site-SynthDigits                   | Val  Loss: 2.1599 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.1634 | Val  Acc: 0.3103
 Site-SVHN                          | Val  Loss: 2.2501 | Val  Acc: 0.1207
Average Valid Accuracy: 0.4681
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7778
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7273
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3103
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.2434 | Train Acc: 0.7923
 Site-USPS                          | Train Loss: 1.2192 | Train Acc: 0.7917
 Site-SynthDigits                   | Train Loss: 1.9896 | Train Acc: 0.3864
 Site-MNIST_M                       | Train Loss: 2.1240 | Train Acc: 0.3210
 Site-SVHN                          | Train Loss: 2.2377 | Train Acc: 0.1496
Average Train Accuracy: 0.4882
 Site-MNIST                         | Val  Loss: 1.2310 | Val  Acc: 0.7879
 Site-USPS                          | Val  Loss: 1.1923 | Val  Acc: 0.7576
 Site-SynthDigits                   | Val  Loss: 2.1373 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.1262 | Val  Acc: 0.3103
 Site-SVHN                          | Val  Loss: 2.2310 | Val  Acc: 0.1207
Average Valid Accuracy: 0.4762
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7879
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7576
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3103
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.1057 | Train Acc: 0.8091
 Site-USPS                          | Train Loss: 1.0821 | Train Acc: 0.8030
 Site-SynthDigits                   | Train Loss: 1.9274 | Train Acc: 0.4091
 Site-MNIST_M                       | Train Loss: 2.0742 | Train Acc: 0.3409
 Site-SVHN                          | Train Loss: 2.2276 | Train Acc: 0.1923
Average Train Accuracy: 0.5109
 Site-MNIST                         | Val  Loss: 1.0888 | Val  Acc: 0.8047
 Site-USPS                          | Val  Loss: 1.0648 | Val  Acc: 0.7778
 Site-SynthDigits                   | Val  Loss: 2.1408 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.0709 | Val  Acc: 0.3563
 Site-SVHN                          | Val  Loss: 2.2262 | Val  Acc: 0.1724
Average Valid Accuracy: 0.5032
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8047
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7778
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3563
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.9827 | Train Acc: 0.8276
 Site-USPS                          | Train Loss: 0.9613 | Train Acc: 0.8270
 Site-SynthDigits                   | Train Loss: 1.8768 | Train Acc: 0.4091
 Site-MNIST_M                       | Train Loss: 2.0530 | Train Acc: 0.3608
 Site-SVHN                          | Train Loss: 2.2215 | Train Acc: 0.1966
Average Train Accuracy: 0.5242
 Site-MNIST                         | Val  Loss: 0.9667 | Val  Acc: 0.8283
 Site-USPS                          | Val  Loss: 0.9455 | Val  Acc: 0.8182
 Site-SynthDigits                   | Val  Loss: 2.1353 | Val  Acc: 0.4198
 Site-MNIST_M                       | Val  Loss: 2.0295 | Val  Acc: 0.3678
 Site-SVHN                          | Val  Loss: 2.2070 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5282
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8283
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8182
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4198
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3678
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.8954 | Train Acc: 0.8360
 Site-USPS                          | Train Loss: 0.8676 | Train Acc: 0.8422
 Site-SynthDigits                   | Train Loss: 1.8597 | Train Acc: 0.4186
 Site-MNIST_M                       | Train Loss: 2.0126 | Train Acc: 0.3608
 Site-SVHN                          | Train Loss: 2.2108 | Train Acc: 0.2222
Average Train Accuracy: 0.5359
 Site-MNIST                         | Val  Loss: 0.8751 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.8678 | Val  Acc: 0.8434
 Site-SynthDigits                   | Val  Loss: 2.1260 | Val  Acc: 0.4351
 Site-MNIST_M                       | Val  Loss: 1.9974 | Val  Acc: 0.3793
 Site-SVHN                          | Val  Loss: 2.1978 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5503
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8350
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8434
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4351
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3793
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.8242 | Train Acc: 0.8276
 Site-USPS                          | Train Loss: 0.7815 | Train Acc: 0.8535
 Site-SynthDigits                   | Train Loss: 1.8190 | Train Acc: 0.4205
 Site-MNIST_M                       | Train Loss: 1.9757 | Train Acc: 0.3778
 Site-SVHN                          | Train Loss: 2.2024 | Train Acc: 0.2265
Average Train Accuracy: 0.5412
 Site-MNIST                         | Val  Loss: 0.8019 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.7955 | Val  Acc: 0.8586
 Site-SynthDigits                   | Val  Loss: 2.1228 | Val  Acc: 0.4122
 Site-MNIST_M                       | Val  Loss: 1.9624 | Val  Acc: 0.3793
 Site-SVHN                          | Val  Loss: 2.1804 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5522
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8350
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8586
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4122
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3793
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.7602 | Train Acc: 0.8310
 Site-USPS                          | Train Loss: 0.7332 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.7907 | Train Acc: 0.4242
 Site-MNIST_M                       | Train Loss: 1.9434 | Train Acc: 0.4006
 Site-SVHN                          | Train Loss: 2.1966 | Train Acc: 0.2222
Average Train Accuracy: 0.5486
 Site-MNIST                         | Val  Loss: 0.7407 | Val  Acc: 0.8418
 Site-USPS                          | Val  Loss: 0.7396 | Val  Acc: 0.8586
 Site-SynthDigits                   | Val  Loss: 2.1313 | Val  Acc: 0.4122
 Site-MNIST_M                       | Val  Loss: 1.9335 | Val  Acc: 0.3908
 Site-SVHN                          | Val  Loss: 2.1693 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5489
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.7069 | Train Acc: 0.8419
 Site-USPS                          | Train Loss: 0.6788 | Train Acc: 0.8699
 Site-SynthDigits                   | Train Loss: 1.7769 | Train Acc: 0.4337
 Site-MNIST_M                       | Train Loss: 1.9104 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 2.1953 | Train Acc: 0.2265
Average Train Accuracy: 0.5585
 Site-MNIST                         | Val  Loss: 0.6807 | Val  Acc: 0.8384
 Site-USPS                          | Val  Loss: 0.7021 | Val  Acc: 0.8636
 Site-SynthDigits                   | Val  Loss: 2.0990 | Val  Acc: 0.4275
 Site-MNIST_M                       | Val  Loss: 1.8991 | Val  Acc: 0.4138
 Site-SVHN                          | Val  Loss: 2.1644 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5535
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8384
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8636
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4275
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4138
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.6765 | Train Acc: 0.8385
 Site-USPS                          | Train Loss: 0.6302 | Train Acc: 0.8712
 Site-SynthDigits                   | Train Loss: 1.7170 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 1.8948 | Train Acc: 0.4233
 Site-SVHN                          | Train Loss: 2.1889 | Train Acc: 0.2179
Average Train Accuracy: 0.5603
 Site-MNIST                         | Val  Loss: 0.6496 | Val  Acc: 0.8451
 Site-USPS                          | Val  Loss: 0.6655 | Val  Acc: 0.8687
 Site-SynthDigits                   | Val  Loss: 2.1121 | Val  Acc: 0.4580
 Site-MNIST_M                       | Val  Loss: 1.8703 | Val  Acc: 0.4023
 Site-SVHN                          | Val  Loss: 2.1510 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5665
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8451
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8687
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4580
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4023
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.6258 | Train Acc: 0.8520
 Site-USPS                          | Train Loss: 0.5968 | Train Acc: 0.8788
 Site-SynthDigits                   | Train Loss: 1.7045 | Train Acc: 0.4470
 Site-MNIST_M                       | Train Loss: 1.8552 | Train Acc: 0.4403
 Site-SVHN                          | Train Loss: 2.1758 | Train Acc: 0.2179
Average Train Accuracy: 0.5672
 Site-MNIST                         | Val  Loss: 0.6006 | Val  Acc: 0.8519
 Site-USPS                          | Val  Loss: 0.6288 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 2.0644 | Val  Acc: 0.4580
 Site-MNIST_M                       | Val  Loss: 1.8510 | Val  Acc: 0.4483
 Site-SVHN                          | Val  Loss: 2.1443 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5781
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8519
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8737
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4580
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4483
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.5888 | Train Acc: 0.8528
 Site-USPS                          | Train Loss: 0.5706 | Train Acc: 0.8838
 Site-SynthDigits                   | Train Loss: 1.6937 | Train Acc: 0.4640
 Site-MNIST_M                       | Train Loss: 1.8517 | Train Acc: 0.4460
 Site-SVHN                          | Train Loss: 2.1775 | Train Acc: 0.2308
Average Train Accuracy: 0.5755
 Site-MNIST                         | Val  Loss: 0.5649 | Val  Acc: 0.8552
 Site-USPS                          | Val  Loss: 0.6025 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 2.0660 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.8271 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.1400 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5802
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8552
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4598
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.5621 | Train Acc: 0.8595
 Site-USPS                          | Train Loss: 0.5327 | Train Acc: 0.8813
 Site-SynthDigits                   | Train Loss: 1.7095 | Train Acc: 0.4564
 Site-MNIST_M                       | Train Loss: 1.7930 | Train Acc: 0.4460
 Site-SVHN                          | Train Loss: 2.1736 | Train Acc: 0.2137
Average Train Accuracy: 0.5714
 Site-MNIST                         | Val  Loss: 0.5391 | Val  Acc: 0.8552
 Site-USPS                          | Val  Loss: 0.5770 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 2.0392 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.8024 | Val  Acc: 0.4253
 Site-SVHN                          | Val  Loss: 2.1348 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5748
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.5282 | Train Acc: 0.8688
 Site-USPS                          | Train Loss: 0.5219 | Train Acc: 0.8889
 Site-SynthDigits                   | Train Loss: 1.6389 | Train Acc: 0.4602
 Site-MNIST_M                       | Train Loss: 1.7854 | Train Acc: 0.4517
 Site-SVHN                          | Train Loss: 2.1750 | Train Acc: 0.2222
Average Train Accuracy: 0.5784
 Site-MNIST                         | Val  Loss: 0.5029 | Val  Acc: 0.8620
 Site-USPS                          | Val  Loss: 0.5634 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0390 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.7837 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.1298 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5821
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8620
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4598
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.5038 | Train Acc: 0.8747
 Site-USPS                          | Train Loss: 0.4867 | Train Acc: 0.8927
 Site-SynthDigits                   | Train Loss: 1.6478 | Train Acc: 0.4659
 Site-MNIST_M                       | Train Loss: 1.7556 | Train Acc: 0.4688
 Site-SVHN                          | Train Loss: 2.1678 | Train Acc: 0.2051
Average Train Accuracy: 0.5814
 Site-MNIST                         | Val  Loss: 0.4825 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.5437 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 2.0278 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.7510 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.1242 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5911
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8653
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.4861 | Train Acc: 0.8789
 Site-USPS                          | Train Loss: 0.4711 | Train Acc: 0.8914
 Site-SynthDigits                   | Train Loss: 1.6328 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.7354 | Train Acc: 0.4801
 Site-SVHN                          | Train Loss: 2.1711 | Train Acc: 0.2094
Average Train Accuracy: 0.5863
 Site-MNIST                         | Val  Loss: 0.4598 | Val  Acc: 0.8721
 Site-USPS                          | Val  Loss: 0.5288 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0138 | Val  Acc: 0.4885
 Site-MNIST_M                       | Val  Loss: 1.7301 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.1178 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6041
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8721
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4885
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.4651 | Train Acc: 0.8831
 Site-USPS                          | Train Loss: 0.4622 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.5739 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.7269 | Train Acc: 0.4801
 Site-SVHN                          | Train Loss: 2.1539 | Train Acc: 0.2094
Average Train Accuracy: 0.5888
 Site-MNIST                         | Val  Loss: 0.4365 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.5188 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 2.0113 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.7122 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.1125 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5862
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.4368 | Train Acc: 0.8907
 Site-USPS                          | Train Loss: 0.4365 | Train Acc: 0.8977
 Site-SynthDigits                   | Train Loss: 1.6240 | Train Acc: 0.4792
 Site-MNIST_M                       | Train Loss: 1.6989 | Train Acc: 0.4830
 Site-SVHN                          | Train Loss: 2.1567 | Train Acc: 0.2137
Average Train Accuracy: 0.5928
 Site-MNIST                         | Val  Loss: 0.4131 | Val  Acc: 0.8754
 Site-USPS                          | Val  Loss: 0.5067 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 2.0010 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.6993 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1073 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5954
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.4193 | Train Acc: 0.8966
 Site-USPS                          | Train Loss: 0.4232 | Train Acc: 0.8965
 Site-SynthDigits                   | Train Loss: 1.5712 | Train Acc: 0.4886
 Site-MNIST_M                       | Train Loss: 1.6998 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1633 | Train Acc: 0.2137
Average Train Accuracy: 0.5996
 Site-MNIST                         | Val  Loss: 0.3970 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4925 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9754 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6716 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.1012 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6048
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.4103 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4083 | Train Acc: 0.8990
 Site-SynthDigits                   | Train Loss: 1.5531 | Train Acc: 0.4924
 Site-MNIST_M                       | Train Loss: 1.6867 | Train Acc: 0.4858
 Site-SVHN                          | Train Loss: 2.1521 | Train Acc: 0.2094
Average Train Accuracy: 0.5963
 Site-MNIST                         | Val  Loss: 0.3854 | Val  Acc: 0.8855
 Site-USPS                          | Val  Loss: 0.4865 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9590 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6666 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0987 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6005
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.3880 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.3966 | Train Acc: 0.8990
 Site-SynthDigits                   | Train Loss: 1.5502 | Train Acc: 0.4830
 Site-MNIST_M                       | Train Loss: 1.6693 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.1453 | Train Acc: 0.2222
Average Train Accuracy: 0.5997
 Site-MNIST                         | Val  Loss: 0.3664 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.4697 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9722 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.6501 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1004 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6071
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9091
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5057
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.3825 | Train Acc: 0.9016
 Site-USPS                          | Train Loss: 0.3897 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.4987 | Train Acc: 0.4981
 Site-MNIST_M                       | Train Loss: 1.6618 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.1383 | Train Acc: 0.2051
Average Train Accuracy: 0.5990
 Site-MNIST                         | Val  Loss: 0.3620 | Val  Acc: 0.8923
 Site-USPS                          | Val  Loss: 0.4573 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9319 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6414 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0951 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6018
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.3629 | Train Acc: 0.9066
 Site-USPS                          | Train Loss: 0.3674 | Train Acc: 0.9066
 Site-SynthDigits                   | Train Loss: 1.5050 | Train Acc: 0.4962
 Site-MNIST_M                       | Train Loss: 1.6447 | Train Acc: 0.4858
 Site-SVHN                          | Train Loss: 2.1371 | Train Acc: 0.2265
Average Train Accuracy: 0.6043
 Site-MNIST                         | Val  Loss: 0.3395 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4489 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9388 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6180 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0952 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6154
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.3526 | Train Acc: 0.9100
 Site-USPS                          | Train Loss: 0.3758 | Train Acc: 0.9003
 Site-SynthDigits                   | Train Loss: 1.4974 | Train Acc: 0.5038
 Site-MNIST_M                       | Train Loss: 1.6202 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 2.1315 | Train Acc: 0.2222
Average Train Accuracy: 0.6073
 Site-MNIST                         | Val  Loss: 0.3310 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.4408 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9284 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.6092 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0846 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6129
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.3433 | Train Acc: 0.9117
 Site-USPS                          | Train Loss: 0.3522 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4435 | Train Acc: 0.5114
 Site-MNIST_M                       | Train Loss: 1.6356 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.1330 | Train Acc: 0.2265
Average Train Accuracy: 0.6112
 Site-MNIST                         | Val  Loss: 0.3216 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.4315 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9185 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.5922 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0822 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6257
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4962
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5517
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.3355 | Train Acc: 0.9134
 Site-USPS                          | Train Loss: 0.3464 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4883 | Train Acc: 0.5246
 Site-MNIST_M                       | Train Loss: 1.6289 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1431 | Train Acc: 0.2308
Average Train Accuracy: 0.6178
 Site-MNIST                         | Val  Loss: 0.3112 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.4209 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9210 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.5833 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0776 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6267
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9125
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.3127 | Train Acc: 0.9243
 Site-USPS                          | Train Loss: 0.3366 | Train Acc: 0.9040
 Site-SynthDigits                   | Train Loss: 1.4972 | Train Acc: 0.5152
 Site-MNIST_M                       | Train Loss: 1.6138 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.1361 | Train Acc: 0.2393
Average Train Accuracy: 0.6160
 Site-MNIST                         | Val  Loss: 0.2932 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.4139 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9313 | Val  Acc: 0.4885
 Site-MNIST_M                       | Val  Loss: 1.5805 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0814 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6214
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.3042 | Train Acc: 0.9268
 Site-USPS                          | Train Loss: 0.3349 | Train Acc: 0.9066
 Site-SynthDigits                   | Train Loss: 1.4471 | Train Acc: 0.5265
 Site-MNIST_M                       | Train Loss: 1.5819 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1282 | Train Acc: 0.2393
Average Train Accuracy: 0.6221
 Site-MNIST                         | Val  Loss: 0.2836 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.4000 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9285 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.5712 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0768 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6266
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.2953 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.3240 | Train Acc: 0.9104
 Site-SynthDigits                   | Train Loss: 1.4670 | Train Acc: 0.5322
 Site-MNIST_M                       | Train Loss: 1.5731 | Train Acc: 0.5085
 Site-SVHN                          | Train Loss: 2.1180 | Train Acc: 0.2479
Average Train Accuracy: 0.6258
 Site-MNIST                         | Val  Loss: 0.2734 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.3973 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.8990 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.5513 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0755 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6318
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9293
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5191
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.2899 | Train Acc: 0.9243
 Site-USPS                          | Train Loss: 0.3186 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.4053 | Train Acc: 0.5436
 Site-MNIST_M                       | Train Loss: 1.5782 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 2.1310 | Train Acc: 0.2479
Average Train Accuracy: 0.6274
 Site-MNIST                         | Val  Loss: 0.2713 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.3934 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8931 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.5460 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0754 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6367
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9259
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5420
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.2746 | Train Acc: 0.9378
 Site-USPS                          | Train Loss: 0.3121 | Train Acc: 0.9179
 Site-SynthDigits                   | Train Loss: 1.4260 | Train Acc: 0.5227
 Site-MNIST_M                       | Train Loss: 1.5616 | Train Acc: 0.5085
 Site-SVHN                          | Train Loss: 2.1106 | Train Acc: 0.2521
Average Train Accuracy: 0.6278
 Site-MNIST                         | Val  Loss: 0.2546 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3848 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8993 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.5414 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0795 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6368
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.2647 | Train Acc: 0.9403
 Site-USPS                          | Train Loss: 0.2980 | Train Acc: 0.9217
 Site-SynthDigits                   | Train Loss: 1.4145 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.5628 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1169 | Train Acc: 0.2479
Average Train Accuracy: 0.6305
 Site-MNIST                         | Val  Loss: 0.2450 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3722 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8915 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.5417 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0736 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6428
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9428
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5267
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.2734 | Train Acc: 0.9310
 Site-USPS                          | Train Loss: 0.2887 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.4087 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.5790 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1372 | Train Acc: 0.2393
Average Train Accuracy: 0.6302
 Site-MNIST                         | Val  Loss: 0.2550 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.3676 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8560 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.5396 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0748 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6357
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.2593 | Train Acc: 0.9378
 Site-USPS                          | Train Loss: 0.2942 | Train Acc: 0.9179
 Site-SynthDigits                   | Train Loss: 1.3934 | Train Acc: 0.5417
 Site-MNIST_M                       | Train Loss: 1.5537 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1162 | Train Acc: 0.2521
Average Train Accuracy: 0.6322
 Site-MNIST                         | Val  Loss: 0.2426 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3647 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8516 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.5229 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0634 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6397
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.2579 | Train Acc: 0.9378
 Site-USPS                          | Train Loss: 0.2841 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.3716 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.5387 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1165 | Train Acc: 0.2607
Average Train Accuracy: 0.6362
 Site-MNIST                         | Val  Loss: 0.2357 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3586 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8524 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.5172 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0648 | Val  Acc: 0.3448
Average Valid Accuracy: 0.6520
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9529
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.2439 | Train Acc: 0.9411
 Site-USPS                          | Train Loss: 0.2750 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.4150 | Train Acc: 0.5360
 Site-MNIST_M                       | Train Loss: 1.5403 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1057 | Train Acc: 0.2436
Average Train Accuracy: 0.6318
 Site-MNIST                         | Val  Loss: 0.2247 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3515 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8570 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.5133 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0617 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6468
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.2404 | Train Acc: 0.9420
 Site-USPS                          | Train Loss: 0.2790 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.3677 | Train Acc: 0.5549
 Site-MNIST_M                       | Train Loss: 1.5390 | Train Acc: 0.5085
 Site-SVHN                          | Train Loss: 2.1113 | Train Acc: 0.2521
Average Train Accuracy: 0.6364
 Site-MNIST                         | Val  Loss: 0.2217 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3432 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8555 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.5021 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0666 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6485
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.2304 | Train Acc: 0.9428
 Site-USPS                          | Train Loss: 0.2660 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.3576 | Train Acc: 0.5530
 Site-MNIST_M                       | Train Loss: 1.5346 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1019 | Train Acc: 0.2521
Average Train Accuracy: 0.6365
 Site-MNIST                         | Val  Loss: 0.2149 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3324 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.8379 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.4970 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0648 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6484
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.2243 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.2638 | Train Acc: 0.9293
 Site-SynthDigits                   | Train Loss: 1.3867 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.5134 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 2.1084 | Train Acc: 0.2564
Average Train Accuracy: 0.6377
 Site-MNIST                         | Val  Loss: 0.2060 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3275 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.8425 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.4882 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0624 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6502
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.2276 | Train Acc: 0.9411
 Site-USPS                          | Train Loss: 0.2634 | Train Acc: 0.9280
 Site-SynthDigits                   | Train Loss: 1.3502 | Train Acc: 0.5587
 Site-MNIST_M                       | Train Loss: 1.4751 | Train Acc: 0.5227
 Site-SVHN                          | Train Loss: 2.1183 | Train Acc: 0.2521
Average Train Accuracy: 0.6405
 Site-MNIST                         | Val  Loss: 0.2109 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3239 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.8109 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.4845 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0635 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6500
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.2192 | Train Acc: 0.9479
 Site-USPS                          | Train Loss: 0.2448 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.3368 | Train Acc: 0.5644
 Site-MNIST_M                       | Train Loss: 1.5065 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1106 | Train Acc: 0.2521
Average Train Accuracy: 0.6421
 Site-MNIST                         | Val  Loss: 0.2041 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3170 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7973 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.4926 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0730 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6546
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9562
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5573
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.2048 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.2542 | Train Acc: 0.9331
 Site-SynthDigits                   | Train Loss: 1.3753 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.4984 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1051 | Train Acc: 0.2650
Average Train Accuracy: 0.6439
 Site-MNIST                         | Val  Loss: 0.1905 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3099 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7976 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.4707 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0706 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6596
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9562
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5496
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.2062 | Train Acc: 0.9521
 Site-USPS                          | Train Loss: 0.2465 | Train Acc: 0.9331
 Site-SynthDigits                   | Train Loss: 1.3233 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.4693 | Train Acc: 0.5284
 Site-SVHN                          | Train Loss: 2.1242 | Train Acc: 0.2607
Average Train Accuracy: 0.6473
 Site-MNIST                         | Val  Loss: 0.1913 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3105 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7815 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.4706 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0698 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6595
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.2123 | Train Acc: 0.9445
 Site-USPS                          | Train Loss: 0.2422 | Train Acc: 0.9343
 Site-SynthDigits                   | Train Loss: 1.3447 | Train Acc: 0.5758
 Site-MNIST_M                       | Train Loss: 1.4752 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 2.1077 | Train Acc: 0.2650
Average Train Accuracy: 0.6479
 Site-MNIST                         | Val  Loss: 0.1924 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3081 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7954 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.4538 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0614 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6631
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9293
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5725
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1890 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2311 | Train Acc: 0.9394
 Site-SynthDigits                   | Train Loss: 1.3248 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.4742 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1143 | Train Acc: 0.2650
Average Train Accuracy: 0.6476
 Site-MNIST                         | Val  Loss: 0.1734 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2993 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7907 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.4508 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0640 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6651
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9293
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5573
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5517
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1866 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2242 | Train Acc: 0.9394
 Site-SynthDigits                   | Train Loss: 1.3314 | Train Acc: 0.5644
 Site-MNIST_M                       | Train Loss: 1.4789 | Train Acc: 0.5170
 Site-SVHN                          | Train Loss: 2.0936 | Train Acc: 0.2650
Average Train Accuracy: 0.6486
 Site-MNIST                         | Val  Loss: 0.1703 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3011 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7738 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.4436 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0616 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6658
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9293
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5573
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.5517
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1862 | Train Acc: 0.9546
 Site-USPS                          | Train Loss: 0.2256 | Train Acc: 0.9381
 Site-SynthDigits                   | Train Loss: 1.3151 | Train Acc: 0.5758
 Site-MNIST_M                       | Train Loss: 1.4659 | Train Acc: 0.5227
 Site-SVHN                          | Train Loss: 2.1154 | Train Acc: 0.2692
Average Train Accuracy: 0.6521
 Site-MNIST                         | Val  Loss: 0.1720 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2950 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7304 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.4555 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0639 | Val  Acc: 0.3448
Average Valid Accuracy: 0.6668
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5649
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedmix...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1786 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2200 | Train Acc: 0.9356
 Site-SynthDigits                   | Train Loss: 1.2981 | Train Acc: 0.5663
 Site-MNIST_M                       | Train Loss: 1.4592 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.1061 | Train Acc: 0.2650
Average Train Accuracy: 0.6478
 Site-MNIST                         | Val  Loss: 0.1633 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2896 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7470 | Val  Acc: 0.5802
 Site-MNIST_M                       | Val  Loss: 1.4324 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0635 | Val  Acc: 0.3448
Average Valid Accuracy: 0.6662
===2023-07-30 15:02:24===
===2023-07-30 15:02:39===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.9194
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9247
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5547
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.3963
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.2710
MNIST: 0.9194, USPS: 0.9247, SynthDigits: 0.5547, MNIST_M: 0.3963, SVHN: 0.2710, 
Average Test Accuracy(group): 0.6132, Average Test Accuracy(individual): 0.6132,
domain std=0.2677, cluster std=-1.0000, individual std=0.2677, 
