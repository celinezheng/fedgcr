===2023-07-03 10:06:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-07-03 10:07:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
===2023-07-03 11:15:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-07-03 11:15:27===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
===2023-07-03 14:19:36===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.1404 | Train Acc: 0.7965
 Site-USPS                      (1) | Train Loss: 1.1726 | Train Acc: 0.8131
 Site-SynthDigits               (3) | Train Loss: 1.9338 | Train Acc: 0.3220
 Site-MNIST_M                   (0) | Train Loss: 2.0980 | Train Acc: 0.2131
 Site-SVHN                      (0) | Train Loss: 2.2031 | Train Acc: 0.1624
Average Train Accuracy: 0.4614
 Site-MNIST                     (2) | Val  Loss: 1.1140 | Val  Acc: 0.7946
 Site-USPS                      (1) | Val  Loss: 1.1624 | Val  Acc: 0.8384
 Site-SynthDigits               (3) | Val  Loss: 2.0123 | Val  Acc: 0.3511
 Site-MNIST_M                   (0) | Val  Loss: 2.1292 | Val  Acc: 0.1609
 Site-SVHN                      (0) | Val  Loss: 2.2313 | Val  Acc: 0.1034
Average Valid Accuracy: 0.4497
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.7946
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.8384
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.3511
 Best site-MNIST_M                  (0)  | Epoch:0 | Val Acc: 0.1609
 Best site-SVHN                     (0)  | Epoch:0 | Val Acc: 0.1034
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 0.8413 | Train Acc: 0.8427
 Site-USPS                      (0) | Train Loss: 0.8358 | Train Acc: 0.8573
 Site-SynthDigits               (3) | Train Loss: 1.6855 | Train Acc: 0.4148
 Site-MNIST_M                   (2) | Train Loss: 1.8362 | Train Acc: 0.3608
 Site-SVHN                      (1) | Train Loss: 2.0609 | Train Acc: 0.2564
Average Train Accuracy: 0.5464
 Site-MNIST                     (0) | Val  Loss: 0.8330 | Val  Acc: 0.8451
 Site-USPS                      (0) | Val  Loss: 0.8487 | Val  Acc: 0.8737
 Site-SynthDigits               (3) | Val  Loss: 1.8455 | Val  Acc: 0.3740
 Site-MNIST_M                   (2) | Val  Loss: 1.8881 | Val  Acc: 0.3793
 Site-SVHN                      (1) | Val  Loss: 1.9975 | Val  Acc: 0.2931
Average Valid Accuracy: 0.5531
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.8451
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.8737
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.3740
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.3793
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.2931
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 0.7856 | Train Acc: 0.8276
 Site-USPS                      (0) | Train Loss: 0.7153 | Train Acc: 0.8725
 Site-SynthDigits               (2) | Train Loss: 1.4800 | Train Acc: 0.5076
 Site-MNIST_M                   (3) | Train Loss: 1.6639 | Train Acc: 0.4517
 Site-SVHN                      (1) | Train Loss: 1.9854 | Train Acc: 0.3077
Average Train Accuracy: 0.5934
 Site-MNIST                     (0) | Val  Loss: 0.7929 | Val  Acc: 0.8519
 Site-USPS                      (0) | Val  Loss: 0.7340 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 1.5984 | Val  Acc: 0.5115
 Site-MNIST_M                   (3) | Val  Loss: 1.7020 | Val  Acc: 0.4713
 Site-SVHN                      (1) | Val  Loss: 1.8813 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6068
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8519
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.5115
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.4713
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3103
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.6854 | Train Acc: 0.8267
 Site-USPS                      (0) | Train Loss: 0.6407 | Train Acc: 0.8687
 Site-SynthDigits               (3) | Train Loss: 1.3319 | Train Acc: 0.5966
 Site-MNIST_M                   (2) | Train Loss: 1.5510 | Train Acc: 0.5312
 Site-SVHN                      (1) | Train Loss: 1.9037 | Train Acc: 0.3675
Average Train Accuracy: 0.6382
 Site-MNIST                     (0) | Val  Loss: 0.6919 | Val  Acc: 0.8283
 Site-USPS                      (0) | Val  Loss: 0.6621 | Val  Acc: 0.8687
 Site-SynthDigits               (3) | Val  Loss: 1.4089 | Val  Acc: 0.6107
 Site-MNIST_M                   (2) | Val  Loss: 1.5859 | Val  Acc: 0.5517
 Site-SVHN                      (1) | Val  Loss: 1.7982 | Val  Acc: 0.3793
Average Valid Accuracy: 0.6477
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8283
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8687
 Best site-SynthDigits              (3)  | Epoch:3 | Val Acc: 0.6107
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.5517
 Best site-SVHN                     (1)  | Epoch:3 | Val Acc: 0.3793
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (1) | Train Loss: 0.6233 | Train Acc: 0.8537
 Site-USPS                      (1) | Train Loss: 0.5902 | Train Acc: 0.8763
 Site-SynthDigits               (0) | Train Loss: 1.2074 | Train Acc: 0.6420
 Site-MNIST_M                   (2) | Train Loss: 1.4153 | Train Acc: 0.5767
 Site-SVHN                      (3) | Train Loss: 1.7746 | Train Acc: 0.3889
Average Train Accuracy: 0.6675
 Site-MNIST                     (1) | Val  Loss: 0.6320 | Val  Acc: 0.8519
 Site-USPS                      (1) | Val  Loss: 0.6267 | Val  Acc: 0.8586
 Site-SynthDigits               (0) | Val  Loss: 1.2660 | Val  Acc: 0.6718
 Site-MNIST_M                   (2) | Val  Loss: 1.4281 | Val  Acc: 0.6092
 Site-SVHN                      (3) | Val  Loss: 1.7069 | Val  Acc: 0.4138
Average Valid Accuracy: 0.6810
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8519
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.8586
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.6718
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.6092
 Best site-SVHN                     (3)  | Epoch:4 | Val Acc: 0.4138
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.5473 | Train Acc: 0.8621
 Site-USPS                      (0) | Train Loss: 0.5394 | Train Acc: 0.8813
 Site-SynthDigits               (1) | Train Loss: 1.0943 | Train Acc: 0.6780
 Site-MNIST_M                   (2) | Train Loss: 1.3385 | Train Acc: 0.6278
 Site-SVHN                      (3) | Train Loss: 1.6889 | Train Acc: 0.4359
Average Train Accuracy: 0.6970
 Site-MNIST                     (0) | Val  Loss: 0.5687 | Val  Acc: 0.8653
 Site-USPS                      (0) | Val  Loss: 0.5779 | Val  Acc: 0.8636
 Site-SynthDigits               (1) | Val  Loss: 1.1237 | Val  Acc: 0.7176
 Site-MNIST_M                   (2) | Val  Loss: 1.3344 | Val  Acc: 0.6552
 Site-SVHN                      (3) | Val  Loss: 1.6124 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7100
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8653
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8636
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.7176
 Best site-MNIST_M                  (2)  | Epoch:5 | Val Acc: 0.6552
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.4483
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.4973 | Train Acc: 0.8755
 Site-USPS                      (1) | Train Loss: 0.5038 | Train Acc: 0.8838
 Site-SynthDigits               (3) | Train Loss: 0.9914 | Train Acc: 0.7140
 Site-MNIST_M                   (2) | Train Loss: 1.2651 | Train Acc: 0.6392
 Site-SVHN                      (0) | Train Loss: 1.6341 | Train Acc: 0.4701
Average Train Accuracy: 0.7165
 Site-MNIST                     (1) | Val  Loss: 0.5080 | Val  Acc: 0.8788
 Site-USPS                      (1) | Val  Loss: 0.5656 | Val  Acc: 0.8687
 Site-SynthDigits               (3) | Val  Loss: 0.9908 | Val  Acc: 0.7481
 Site-MNIST_M                   (2) | Val  Loss: 1.2590 | Val  Acc: 0.6437
 Site-SVHN                      (0) | Val  Loss: 1.5170 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7278
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8788
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8687
 Best site-SynthDigits              (3)  | Epoch:6 | Val Acc: 0.7481
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.6437
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (1) | Train Loss: 0.4806 | Train Acc: 0.8705
 Site-USPS                      (1) | Train Loss: 0.4865 | Train Acc: 0.8750
 Site-SynthDigits               (3) | Train Loss: 0.9246 | Train Acc: 0.7311
 Site-MNIST_M                   (2) | Train Loss: 1.1651 | Train Acc: 0.6847
 Site-SVHN                      (0) | Train Loss: 1.5127 | Train Acc: 0.5171
Average Train Accuracy: 0.7357
 Site-MNIST                     (1) | Val  Loss: 0.4979 | Val  Acc: 0.8620
 Site-USPS                      (1) | Val  Loss: 0.5467 | Val  Acc: 0.8535
 Site-SynthDigits               (3) | Val  Loss: 0.8812 | Val  Acc: 0.7634
 Site-MNIST_M                   (2) | Val  Loss: 1.1319 | Val  Acc: 0.7241
 Site-SVHN                      (0) | Val  Loss: 1.4723 | Val  Acc: 0.5172
Average Valid Accuracy: 0.7440
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8620
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8535
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.7634
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.7241
 Best site-SVHN                     (0)  | Epoch:7 | Val Acc: 0.5172
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (1) | Train Loss: 0.4141 | Train Acc: 0.8957
 Site-USPS                      (1) | Train Loss: 0.4486 | Train Acc: 0.8813
 Site-SynthDigits               (3) | Train Loss: 0.8561 | Train Acc: 0.7670
 Site-MNIST_M                   (2) | Train Loss: 1.1219 | Train Acc: 0.6875
 Site-SVHN                      (0) | Train Loss: 1.5091 | Train Acc: 0.5299
Average Train Accuracy: 0.7523
 Site-MNIST                     (1) | Val  Loss: 0.4224 | Val  Acc: 0.8956
 Site-USPS                      (1) | Val  Loss: 0.5213 | Val  Acc: 0.8586
 Site-SynthDigits               (3) | Val  Loss: 0.8272 | Val  Acc: 0.7939
 Site-MNIST_M                   (2) | Val  Loss: 1.1074 | Val  Acc: 0.7586
 Site-SVHN                      (0) | Val  Loss: 1.3841 | Val  Acc: 0.5345
Average Valid Accuracy: 0.7682
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8956
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8586
 Best site-SynthDigits              (3)  | Epoch:8 | Val Acc: 0.7939
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.7586
 Best site-SVHN                     (0)  | Epoch:8 | Val Acc: 0.5345
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.3955 | Train Acc: 0.8966
 Site-USPS                      (0) | Train Loss: 0.4200 | Train Acc: 0.9015
 Site-SynthDigits               (1) | Train Loss: 0.7957 | Train Acc: 0.7765
 Site-MNIST_M                   (2) | Train Loss: 1.0384 | Train Acc: 0.7102
 Site-SVHN                      (3) | Train Loss: 1.3561 | Train Acc: 0.5385
Average Train Accuracy: 0.7647
 Site-MNIST                     (0) | Val  Loss: 0.4149 | Val  Acc: 0.8990
 Site-USPS                      (0) | Val  Loss: 0.4918 | Val  Acc: 0.8737
 Site-SynthDigits               (1) | Val  Loss: 0.7715 | Val  Acc: 0.8015
 Site-MNIST_M                   (2) | Val  Loss: 1.0058 | Val  Acc: 0.7471
 Site-SVHN                      (3) | Val  Loss: 1.3333 | Val  Acc: 0.5862
Average Valid Accuracy: 0.7815
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8990
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8737
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.8015
 Best site-MNIST_M                  (2)  | Epoch:9 | Val Acc: 0.7471
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5862
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (1) | Train Loss: 0.3523 | Train Acc: 0.9134
 Site-USPS                      (1) | Train Loss: 0.4071 | Train Acc: 0.8977
 Site-SynthDigits               (2) | Train Loss: 0.7426 | Train Acc: 0.7973
 Site-MNIST_M                   (3) | Train Loss: 0.9829 | Train Acc: 0.7244
 Site-SVHN                      (0) | Train Loss: 1.3481 | Train Acc: 0.5855
Average Train Accuracy: 0.7837
 Site-MNIST                     (1) | Val  Loss: 0.3749 | Val  Acc: 0.9192
 Site-USPS                      (1) | Val  Loss: 0.4836 | Val  Acc: 0.8636
 Site-SynthDigits               (2) | Val  Loss: 0.7119 | Val  Acc: 0.8092
 Site-MNIST_M                   (3) | Val  Loss: 0.9481 | Val  Acc: 0.7701
 Site-SVHN                      (0) | Val  Loss: 1.2546 | Val  Acc: 0.6207
Average Valid Accuracy: 0.7966
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.9192
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.8636
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.8092
 Best site-MNIST_M                  (3)  | Epoch:10 | Val Acc: 0.7701
 Best site-SVHN                     (0)  | Epoch:10 | Val Acc: 0.6207
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (3) | Train Loss: 0.3557 | Train Acc: 0.9008
 Site-USPS                      (1) | Train Loss: 0.3858 | Train Acc: 0.9053
 Site-SynthDigits               (2) | Train Loss: 0.6779 | Train Acc: 0.8239
 Site-MNIST_M                   (0) | Train Loss: 0.9250 | Train Acc: 0.7642
 Site-SVHN                      (2) | Train Loss: 1.3177 | Train Acc: 0.5855
Average Train Accuracy: 0.7959
 Site-MNIST                     (3) | Val  Loss: 0.3724 | Val  Acc: 0.8990
 Site-USPS                      (1) | Val  Loss: 0.4684 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 0.6262 | Val  Acc: 0.8702
 Site-MNIST_M                   (0) | Val  Loss: 0.8866 | Val  Acc: 0.8161
 Site-SVHN                      (2) | Val  Loss: 1.2105 | Val  Acc: 0.6552
Average Valid Accuracy: 0.8239
 Best site-MNIST                    (3)  | Epoch:11 | Val Acc: 0.8990
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8788
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.8702
 Best site-MNIST_M                  (0)  | Epoch:11 | Val Acc: 0.8161
 Best site-SVHN                     (2)  | Epoch:11 | Val Acc: 0.6552
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (0) | Train Loss: 0.3265 | Train Acc: 0.9184
 Site-USPS                      (0) | Train Loss: 0.3721 | Train Acc: 0.9053
 Site-SynthDigits               (3) | Train Loss: 0.6500 | Train Acc: 0.8314
 Site-MNIST_M                   (2) | Train Loss: 0.8819 | Train Acc: 0.7528
 Site-SVHN                      (1) | Train Loss: 1.2391 | Train Acc: 0.5940
Average Train Accuracy: 0.8004
 Site-MNIST                     (0) | Val  Loss: 0.3330 | Val  Acc: 0.9192
 Site-USPS                      (0) | Val  Loss: 0.4495 | Val  Acc: 0.8687
 Site-SynthDigits               (3) | Val  Loss: 0.5883 | Val  Acc: 0.8779
 Site-MNIST_M                   (2) | Val  Loss: 0.8497 | Val  Acc: 0.7931
 Site-SVHN                      (1) | Val  Loss: 1.1372 | Val  Acc: 0.6724
Average Valid Accuracy: 0.8263
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9192
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.8687
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.8779
 Best site-MNIST_M                  (2)  | Epoch:12 | Val Acc: 0.7931
 Best site-SVHN                     (1)  | Epoch:12 | Val Acc: 0.6724
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (1) | Train Loss: 0.2994 | Train Acc: 0.9209
 Site-USPS                      (1) | Train Loss: 0.3570 | Train Acc: 0.9053
 Site-SynthDigits               (0) | Train Loss: 0.6136 | Train Acc: 0.8390
 Site-MNIST_M                   (2) | Train Loss: 0.8335 | Train Acc: 0.7756
 Site-SVHN                      (3) | Train Loss: 1.1874 | Train Acc: 0.6026
Average Train Accuracy: 0.8087
 Site-MNIST                     (1) | Val  Loss: 0.3185 | Val  Acc: 0.9192
 Site-USPS                      (1) | Val  Loss: 0.4282 | Val  Acc: 0.8737
 Site-SynthDigits               (0) | Val  Loss: 0.5441 | Val  Acc: 0.8855
 Site-MNIST_M                   (2) | Val  Loss: 0.8017 | Val  Acc: 0.8046
 Site-SVHN                      (3) | Val  Loss: 1.0905 | Val  Acc: 0.6379
Average Valid Accuracy: 0.8242
============ Train epoch 14 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (1) | Train Loss: 0.2793 | Train Acc: 0.9310
 Site-USPS                      (1) | Train Loss: 0.3420 | Train Acc: 0.9116
 Site-SynthDigits               (3) | Train Loss: 0.6013 | Train Acc: 0.8504
 Site-MNIST_M                   (0) | Train Loss: 0.8082 | Train Acc: 0.7898
 Site-SVHN                      (2) | Train Loss: 1.0966 | Train Acc: 0.6026
Average Train Accuracy: 0.8171
 Site-MNIST                     (1) | Val  Loss: 0.2964 | Val  Acc: 0.9327
 Site-USPS                      (1) | Val  Loss: 0.4194 | Val  Acc: 0.8838
 Site-SynthDigits               (3) | Val  Loss: 0.5194 | Val  Acc: 0.9008
 Site-MNIST_M                   (0) | Val  Loss: 0.7843 | Val  Acc: 0.8046
 Site-SVHN                      (2) | Val  Loss: 1.0445 | Val  Acc: 0.6552
Average Valid Accuracy: 0.8354
 Best site-MNIST                    (1)  | Epoch:14 | Val Acc: 0.9327
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8838
 Best site-SynthDigits              (3)  | Epoch:14 | Val Acc: 0.9008
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.8046
 Best site-SVHN                     (2)  | Epoch:14 | Val Acc: 0.6552
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (3) | Train Loss: 0.2746 | Train Acc: 0.9294
 Site-USPS                      (1) | Train Loss: 0.3217 | Train Acc: 0.9104
 Site-SynthDigits               (2) | Train Loss: 0.5524 | Train Acc: 0.8504
 Site-MNIST_M                   (0) | Train Loss: 0.7606 | Train Acc: 0.8097
 Site-SVHN                      (2) | Train Loss: 1.1065 | Train Acc: 0.6239
Average Train Accuracy: 0.8247
 Site-MNIST                     (3) | Val  Loss: 0.2783 | Val  Acc: 0.9293
 Site-USPS                      (1) | Val  Loss: 0.4056 | Val  Acc: 0.8737
 Site-SynthDigits               (2) | Val  Loss: 0.4816 | Val  Acc: 0.8779
 Site-MNIST_M                   (0) | Val  Loss: 0.7323 | Val  Acc: 0.8506
 Site-SVHN                      (2) | Val  Loss: 1.0261 | Val  Acc: 0.6552
Average Valid Accuracy: 0.8373
 Best site-MNIST                    (3)  | Epoch:15 | Val Acc: 0.9293
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8737
 Best site-SynthDigits              (2)  | Epoch:15 | Val Acc: 0.8779
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.8506
 Best site-SVHN                     (2)  | Epoch:15 | Val Acc: 0.6552
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.2543 | Train Acc: 0.9344
 Site-USPS                      (1) | Train Loss: 0.3126 | Train Acc: 0.9192
 Site-SynthDigits               (0) | Train Loss: 0.5092 | Train Acc: 0.8807
 Site-MNIST_M                   (2) | Train Loss: 0.7310 | Train Acc: 0.8239
 Site-SVHN                      (3) | Train Loss: 1.1254 | Train Acc: 0.6410
Average Train Accuracy: 0.8398
 Site-MNIST                     (1) | Val  Loss: 0.2717 | Val  Acc: 0.9428
 Site-USPS                      (1) | Val  Loss: 0.3975 | Val  Acc: 0.8838
 Site-SynthDigits               (0) | Val  Loss: 0.4431 | Val  Acc: 0.9084
 Site-MNIST_M                   (2) | Val  Loss: 0.7055 | Val  Acc: 0.8736
 Site-SVHN                      (3) | Val  Loss: 0.9727 | Val  Acc: 0.6379
Average Valid Accuracy: 0.8493
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9428
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.8838
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.9084
 Best site-MNIST_M                  (2)  | Epoch:16 | Val Acc: 0.8736
 Best site-SVHN                     (3)  | Epoch:16 | Val Acc: 0.6379
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (1) | Train Loss: 0.2441 | Train Acc: 0.9378
 Site-USPS                      (1) | Train Loss: 0.2965 | Train Acc: 0.9268
 Site-SynthDigits               (3) | Train Loss: 0.5149 | Train Acc: 0.8731
 Site-MNIST_M                   (0) | Train Loss: 0.7115 | Train Acc: 0.8295
 Site-SVHN                      (2) | Train Loss: 1.0302 | Train Acc: 0.6667
Average Train Accuracy: 0.8468
 Site-MNIST                     (1) | Val  Loss: 0.2613 | Val  Acc: 0.9428
 Site-USPS                      (1) | Val  Loss: 0.3706 | Val  Acc: 0.9040
 Site-SynthDigits               (3) | Val  Loss: 0.4406 | Val  Acc: 0.9084
 Site-MNIST_M                   (0) | Val  Loss: 0.6890 | Val  Acc: 0.8621
 Site-SVHN                      (2) | Val  Loss: 0.9633 | Val  Acc: 0.6724
Average Valid Accuracy: 0.8579
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9428
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.9040
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.9084
 Best site-MNIST_M                  (0)  | Epoch:17 | Val Acc: 0.8621
 Best site-SVHN                     (2)  | Epoch:17 | Val Acc: 0.6724
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (3) | Train Loss: 0.2376 | Train Acc: 0.9361
 Site-USPS                      (0) | Train Loss: 0.2849 | Train Acc: 0.9179
 Site-SynthDigits               (1) | Train Loss: 0.4937 | Train Acc: 0.8750
 Site-MNIST_M                   (2) | Train Loss: 0.6724 | Train Acc: 0.8352
 Site-SVHN                      (1) | Train Loss: 1.0212 | Train Acc: 0.6581
Average Train Accuracy: 0.8445
 Site-MNIST                     (3) | Val  Loss: 0.2522 | Val  Acc: 0.9293
 Site-USPS                      (0) | Val  Loss: 0.3667 | Val  Acc: 0.8838
 Site-SynthDigits               (1) | Val  Loss: 0.4035 | Val  Acc: 0.9084
 Site-MNIST_M                   (2) | Val  Loss: 0.6489 | Val  Acc: 0.8851
 Site-SVHN                      (1) | Val  Loss: 0.9402 | Val  Acc: 0.6724
Average Valid Accuracy: 0.8558
============ Train epoch 19 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (3) | Train Loss: 0.2329 | Train Acc: 0.9344
 Site-USPS                      (1) | Train Loss: 0.2802 | Train Acc: 0.9192
 Site-SynthDigits               (0) | Train Loss: 0.4479 | Train Acc: 0.8864
 Site-MNIST_M                   (2) | Train Loss: 0.6453 | Train Acc: 0.8523
 Site-SVHN                      (0) | Train Loss: 1.0617 | Train Acc: 0.6709
Average Train Accuracy: 0.8526
 Site-MNIST                     (3) | Val  Loss: 0.2511 | Val  Acc: 0.9327
 Site-USPS                      (1) | Val  Loss: 0.3731 | Val  Acc: 0.8737
 Site-SynthDigits               (0) | Val  Loss: 0.3627 | Val  Acc: 0.9084
 Site-MNIST_M                   (2) | Val  Loss: 0.6219 | Val  Acc: 0.8966
 Site-SVHN                      (0) | Val  Loss: 0.8904 | Val  Acc: 0.7241
Average Valid Accuracy: 0.8671
 Best site-MNIST                    (3)  | Epoch:19 | Val Acc: 0.9327
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8737
 Best site-SynthDigits              (0)  | Epoch:19 | Val Acc: 0.9084
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.8966
 Best site-SVHN                     (0)  | Epoch:19 | Val Acc: 0.7241
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (3) | Train Loss: 0.2179 | Train Acc: 0.9420
 Site-USPS                      (0) | Train Loss: 0.2691 | Train Acc: 0.9242
 Site-SynthDigits               (1) | Train Loss: 0.4381 | Train Acc: 0.8845
 Site-MNIST_M                   (2) | Train Loss: 0.6335 | Train Acc: 0.8523
 Site-SVHN                      (1) | Train Loss: 0.9540 | Train Acc: 0.6838
Average Train Accuracy: 0.8573
 Site-MNIST                     (3) | Val  Loss: 0.2333 | Val  Acc: 0.9428
 Site-USPS                      (0) | Val  Loss: 0.3448 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.3455 | Val  Acc: 0.9237
 Site-MNIST_M                   (2) | Val  Loss: 0.6065 | Val  Acc: 0.8851
 Site-SVHN                      (1) | Val  Loss: 0.8650 | Val  Acc: 0.7069
Average Valid Accuracy: 0.8695
 Best site-MNIST                    (3)  | Epoch:20 | Val Acc: 0.9428
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.9237
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.8851
 Best site-SVHN                     (1)  | Epoch:20 | Val Acc: 0.7069
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 21 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (3) | Train Loss: 0.2048 | Train Acc: 0.9521
 Site-USPS                      (0) | Train Loss: 0.2612 | Train Acc: 0.9230
 Site-SynthDigits               (1) | Train Loss: 0.4236 | Train Acc: 0.8864
 Site-MNIST_M                   (2) | Train Loss: 0.6038 | Train Acc: 0.8778
 Site-SVHN                      (1) | Train Loss: 0.9252 | Train Acc: 0.6795
Average Train Accuracy: 0.8637
 Site-MNIST                     (3) | Val  Loss: 0.2198 | Val  Acc: 0.9529
 Site-USPS                      (0) | Val  Loss: 0.3437 | Val  Acc: 0.8939
 Site-SynthDigits               (1) | Val  Loss: 0.3436 | Val  Acc: 0.9008
 Site-MNIST_M                   (2) | Val  Loss: 0.5969 | Val  Acc: 0.8736
 Site-SVHN                      (1) | Val  Loss: 0.8238 | Val  Acc: 0.7069
Average Valid Accuracy: 0.8656
============ Train epoch 22 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (3) | Train Loss: 0.2031 | Train Acc: 0.9487
 Site-USPS                      (0) | Train Loss: 0.2460 | Train Acc: 0.9293
 Site-SynthDigits               (1) | Train Loss: 0.4141 | Train Acc: 0.8883
 Site-MNIST_M                   (2) | Train Loss: 0.5794 | Train Acc: 0.8665
 Site-SVHN                      (1) | Train Loss: 0.8990 | Train Acc: 0.6795
Average Train Accuracy: 0.8624
 Site-MNIST                     (3) | Val  Loss: 0.2153 | Val  Acc: 0.9461
 Site-USPS                      (0) | Val  Loss: 0.3247 | Val  Acc: 0.9091
 Site-SynthDigits               (1) | Val  Loss: 0.3275 | Val  Acc: 0.9160
 Site-MNIST_M                   (2) | Val  Loss: 0.5567 | Val  Acc: 0.8966
 Site-SVHN                      (1) | Val  Loss: 0.8320 | Val  Acc: 0.6724
Average Valid Accuracy: 0.8680
============ Train epoch 23 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (3) | Train Loss: 0.1982 | Train Acc: 0.9529
 Site-USPS                      (0) | Train Loss: 0.2408 | Train Acc: 0.9331
 Site-SynthDigits               (1) | Train Loss: 0.3827 | Train Acc: 0.8958
 Site-MNIST_M                   (2) | Train Loss: 0.5630 | Train Acc: 0.8835
 Site-SVHN                      (1) | Train Loss: 0.9208 | Train Acc: 0.6966
Average Train Accuracy: 0.8724
 Site-MNIST                     (3) | Val  Loss: 0.2052 | Val  Acc: 0.9529
 Site-USPS                      (0) | Val  Loss: 0.3148 | Val  Acc: 0.9192
 Site-SynthDigits               (1) | Val  Loss: 0.3055 | Val  Acc: 0.9160
 Site-MNIST_M                   (2) | Val  Loss: 0.5416 | Val  Acc: 0.8966
 Site-SVHN                      (1) | Val  Loss: 0.8056 | Val  Acc: 0.6897
Average Valid Accuracy: 0.8749
 Best site-MNIST                    (3)  | Epoch:23 | Val Acc: 0.9529
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.9192
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.9160
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.8966
 Best site-SVHN                     (1)  | Epoch:23 | Val Acc: 0.6897
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.2080 | Train Acc: 0.9554
 Site-USPS                      (3) | Train Loss: 0.2387 | Train Acc: 0.9318
 Site-SynthDigits               (1) | Train Loss: 0.3697 | Train Acc: 0.9015
 Site-MNIST_M                   (2) | Train Loss: 0.5499 | Train Acc: 0.8750
 Site-SVHN                      (1) | Train Loss: 0.8749 | Train Acc: 0.6923
Average Train Accuracy: 0.8712
 Site-MNIST                     (0) | Val  Loss: 0.2005 | Val  Acc: 0.9529
 Site-USPS                      (3) | Val  Loss: 0.3125 | Val  Acc: 0.9192
 Site-SynthDigits               (1) | Val  Loss: 0.2834 | Val  Acc: 0.9237
 Site-MNIST_M                   (2) | Val  Loss: 0.5333 | Val  Acc: 0.8966
 Site-SVHN                      (1) | Val  Loss: 0.7729 | Val  Acc: 0.7586
Average Valid Accuracy: 0.8902
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9529
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.9192
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.9237
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.8966
 Best site-SVHN                     (1)  | Epoch:24 | Val Acc: 0.7586
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (2) | Train Loss: 0.1817 | Train Acc: 0.9554
 Site-USPS                      (3) | Train Loss: 0.2223 | Train Acc: 0.9356
 Site-SynthDigits               (1) | Train Loss: 0.3681 | Train Acc: 0.9110
 Site-MNIST_M                   (0) | Train Loss: 0.5193 | Train Acc: 0.8920
 Site-SVHN                      (1) | Train Loss: 0.8521 | Train Acc: 0.7051
Average Train Accuracy: 0.8798
 Site-MNIST                     (2) | Val  Loss: 0.1965 | Val  Acc: 0.9562
 Site-USPS                      (3) | Val  Loss: 0.2962 | Val  Acc: 0.9141
 Site-SynthDigits               (1) | Val  Loss: 0.2729 | Val  Acc: 0.9389
 Site-MNIST_M                   (0) | Val  Loss: 0.5038 | Val  Acc: 0.9310
 Site-SVHN                      (1) | Val  Loss: 0.7667 | Val  Acc: 0.7586
Average Valid Accuracy: 0.8998
 Best site-MNIST                    (2)  | Epoch:25 | Val Acc: 0.9562
 Best site-USPS                     (3)  | Epoch:25 | Val Acc: 0.9141
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.9389
 Best site-MNIST_M                  (0)  | Epoch:25 | Val Acc: 0.9310
 Best site-SVHN                     (1)  | Epoch:25 | Val Acc: 0.7586
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (0) | Train Loss: 0.1827 | Train Acc: 0.9563
 Site-USPS                      (3) | Train Loss: 0.2197 | Train Acc: 0.9394
 Site-SynthDigits               (1) | Train Loss: 0.3501 | Train Acc: 0.9205
 Site-MNIST_M                   (2) | Train Loss: 0.4999 | Train Acc: 0.9006
 Site-SVHN                      (1) | Train Loss: 0.8820 | Train Acc: 0.7094
Average Train Accuracy: 0.8852
 Site-MNIST                     (0) | Val  Loss: 0.1937 | Val  Acc: 0.9529
 Site-USPS                      (3) | Val  Loss: 0.2970 | Val  Acc: 0.9242
 Site-SynthDigits               (1) | Val  Loss: 0.2550 | Val  Acc: 0.9466
 Site-MNIST_M                   (2) | Val  Loss: 0.4890 | Val  Acc: 0.9425
 Site-SVHN                      (1) | Val  Loss: 0.7530 | Val  Acc: 0.7414
Average Valid Accuracy: 0.9015
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9529
 Best site-USPS                     (3)  | Epoch:26 | Val Acc: 0.9242
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.9466
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.9425
 Best site-SVHN                     (1)  | Epoch:26 | Val Acc: 0.7414
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.1897 | Train Acc: 0.9563
 Site-USPS                      (3) | Train Loss: 0.2218 | Train Acc: 0.9331
 Site-SynthDigits               (0) | Train Loss: 0.3280 | Train Acc: 0.9242
 Site-MNIST_M                   (2) | Train Loss: 0.4825 | Train Acc: 0.9176
 Site-SVHN                      (0) | Train Loss: 0.8384 | Train Acc: 0.7308
Average Train Accuracy: 0.8924
 Site-MNIST                     (1) | Val  Loss: 0.1877 | Val  Acc: 0.9562
 Site-USPS                      (3) | Val  Loss: 0.3008 | Val  Acc: 0.9091
 Site-SynthDigits               (0) | Val  Loss: 0.2426 | Val  Acc: 0.9542
 Site-MNIST_M                   (2) | Val  Loss: 0.4758 | Val  Acc: 0.9540
 Site-SVHN                      (0) | Val  Loss: 0.7121 | Val  Acc: 0.8276
Average Valid Accuracy: 0.9202
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9562
 Best site-USPS                     (3)  | Epoch:27 | Val Acc: 0.9091
 Best site-SynthDigits              (0)  | Epoch:27 | Val Acc: 0.9542
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.9540
 Best site-SVHN                     (0)  | Epoch:27 | Val Acc: 0.8276
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.1662 | Train Acc: 0.9588
 Site-USPS                      (3) | Train Loss: 0.2118 | Train Acc: 0.9369
 Site-SynthDigits               (0) | Train Loss: 0.3260 | Train Acc: 0.9186
 Site-MNIST_M                   (2) | Train Loss: 0.4643 | Train Acc: 0.9034
 Site-SVHN                      (0) | Train Loss: 0.7823 | Train Acc: 0.7521
Average Train Accuracy: 0.8940
 Site-MNIST                     (1) | Val  Loss: 0.1801 | Val  Acc: 0.9596
 Site-USPS                      (3) | Val  Loss: 0.2835 | Val  Acc: 0.9343
 Site-SynthDigits               (0) | Val  Loss: 0.2433 | Val  Acc: 0.9542
 Site-MNIST_M                   (2) | Val  Loss: 0.4458 | Val  Acc: 0.9540
 Site-SVHN                      (0) | Val  Loss: 0.7172 | Val  Acc: 0.7759
Average Valid Accuracy: 0.9156
============ Train epoch 29 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.1605 | Train Acc: 0.9613
 Site-USPS                      (3) | Train Loss: 0.2033 | Train Acc: 0.9381
 Site-SynthDigits               (1) | Train Loss: 0.3210 | Train Acc: 0.9205
 Site-MNIST_M                   (2) | Train Loss: 0.4593 | Train Acc: 0.9091
 Site-SVHN                      (1) | Train Loss: 0.7539 | Train Acc: 0.7521
Average Train Accuracy: 0.8962
 Site-MNIST                     (0) | Val  Loss: 0.1737 | Val  Acc: 0.9562
 Site-USPS                      (3) | Val  Loss: 0.2686 | Val  Acc: 0.9394
 Site-SynthDigits               (1) | Val  Loss: 0.2366 | Val  Acc: 0.9542
 Site-MNIST_M                   (2) | Val  Loss: 0.4368 | Val  Acc: 0.9540
 Site-SVHN                      (1) | Val  Loss: 0.6985 | Val  Acc: 0.7759
Average Valid Accuracy: 0.9159
============ Train epoch 30 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.1572 | Train Acc: 0.9638
 Site-USPS                      (3) | Train Loss: 0.1979 | Train Acc: 0.9407
 Site-SynthDigits               (0) | Train Loss: 0.3015 | Train Acc: 0.9318
 Site-MNIST_M                   (2) | Train Loss: 0.4236 | Train Acc: 0.9205
 Site-SVHN                      (0) | Train Loss: 0.7646 | Train Acc: 0.7521
Average Train Accuracy: 0.9018
 Site-MNIST                     (1) | Val  Loss: 0.1651 | Val  Acc: 0.9630
 Site-USPS                      (3) | Val  Loss: 0.2674 | Val  Acc: 0.9343
 Site-SynthDigits               (0) | Val  Loss: 0.2209 | Val  Acc: 0.9618
 Site-MNIST_M                   (2) | Val  Loss: 0.4041 | Val  Acc: 0.9425
 Site-SVHN                      (0) | Val  Loss: 0.6890 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9224
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9630
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.9343
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.9618
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.9425
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.8103
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.1517 | Train Acc: 0.9622
 Site-USPS                      (3) | Train Loss: 0.1972 | Train Acc: 0.9394
 Site-SynthDigits               (0) | Train Loss: 0.2900 | Train Acc: 0.9337
 Site-MNIST_M                   (2) | Train Loss: 0.4220 | Train Acc: 0.9205
 Site-SVHN                      (0) | Train Loss: 0.8345 | Train Acc: 0.7479
Average Train Accuracy: 0.9007
 Site-MNIST                     (1) | Val  Loss: 0.1609 | Val  Acc: 0.9630
 Site-USPS                      (3) | Val  Loss: 0.2624 | Val  Acc: 0.9293
 Site-SynthDigits               (0) | Val  Loss: 0.2132 | Val  Acc: 0.9618
 Site-MNIST_M                   (2) | Val  Loss: 0.4068 | Val  Acc: 0.9540
 Site-SVHN                      (0) | Val  Loss: 0.6645 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9237
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9630
 Best site-USPS                     (3)  | Epoch:31 | Val Acc: 0.9293
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.9618
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.9540
 Best site-SVHN                     (0)  | Epoch:31 | Val Acc: 0.8103
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 32 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (1) | Train Loss: 0.1530 | Train Acc: 0.9638
 Site-USPS                      (3) | Train Loss: 0.1874 | Train Acc: 0.9407
 Site-SynthDigits               (0) | Train Loss: 0.2908 | Train Acc: 0.9356
 Site-MNIST_M                   (2) | Train Loss: 0.4146 | Train Acc: 0.9233
 Site-SVHN                      (0) | Train Loss: 0.7275 | Train Acc: 0.7821
Average Train Accuracy: 0.9091
 Site-MNIST                     (1) | Val  Loss: 0.1590 | Val  Acc: 0.9663
 Site-USPS                      (3) | Val  Loss: 0.2522 | Val  Acc: 0.9394
 Site-SynthDigits               (0) | Val  Loss: 0.2048 | Val  Acc: 0.9618
 Site-MNIST_M                   (2) | Val  Loss: 0.3919 | Val  Acc: 0.9655
 Site-SVHN                      (0) | Val  Loss: 0.6545 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9287
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9663
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.9394
 Best site-SynthDigits              (0)  | Epoch:32 | Val Acc: 0.9618
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.9655
 Best site-SVHN                     (0)  | Epoch:32 | Val Acc: 0.8103
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 33 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (3) | Train Loss: 0.1514 | Train Acc: 0.9622
 Site-USPS                      (0) | Train Loss: 0.1779 | Train Acc: 0.9482
 Site-SynthDigits               (1) | Train Loss: 0.2783 | Train Acc: 0.9394
 Site-MNIST_M                   (2) | Train Loss: 0.3987 | Train Acc: 0.9318
 Site-SVHN                      (1) | Train Loss: 0.7067 | Train Acc: 0.7821
Average Train Accuracy: 0.9127
 Site-MNIST                     (3) | Val  Loss: 0.1600 | Val  Acc: 0.9663
 Site-USPS                      (0) | Val  Loss: 0.2381 | Val  Acc: 0.9394
 Site-SynthDigits               (1) | Val  Loss: 0.2049 | Val  Acc: 0.9618
 Site-MNIST_M                   (2) | Val  Loss: 0.3709 | Val  Acc: 0.9655
 Site-SVHN                      (1) | Val  Loss: 0.6510 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9287
============ Train epoch 34 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.1457 | Train Acc: 0.9630
 Site-USPS                      (3) | Train Loss: 0.1762 | Train Acc: 0.9508
 Site-SynthDigits               (0) | Train Loss: 0.2643 | Train Acc: 0.9470
 Site-MNIST_M                   (2) | Train Loss: 0.3766 | Train Acc: 0.9432
 Site-SVHN                      (0) | Train Loss: 0.6918 | Train Acc: 0.7607
Average Train Accuracy: 0.9129
 Site-MNIST                     (1) | Val  Loss: 0.1538 | Val  Acc: 0.9663
 Site-USPS                      (3) | Val  Loss: 0.2320 | Val  Acc: 0.9394
 Site-SynthDigits               (0) | Val  Loss: 0.1937 | Val  Acc: 0.9618
 Site-MNIST_M                   (2) | Val  Loss: 0.3499 | Val  Acc: 0.9655
 Site-SVHN                      (0) | Val  Loss: 0.6451 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9287
============ Train epoch 35 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (3) | Train Loss: 0.1516 | Train Acc: 0.9647
 Site-USPS                      (1) | Train Loss: 0.1754 | Train Acc: 0.9444
 Site-SynthDigits               (2) | Train Loss: 0.2639 | Train Acc: 0.9432
 Site-MNIST_M                   (0) | Train Loss: 0.3802 | Train Acc: 0.9290
 Site-SVHN                      (2) | Train Loss: 0.6945 | Train Acc: 0.7949
Average Train Accuracy: 0.9152
 Site-MNIST                     (3) | Val  Loss: 0.1511 | Val  Acc: 0.9697
 Site-USPS                      (1) | Val  Loss: 0.2386 | Val  Acc: 0.9444
 Site-SynthDigits               (2) | Val  Loss: 0.1885 | Val  Acc: 0.9695
 Site-MNIST_M                   (0) | Val  Loss: 0.3561 | Val  Acc: 0.9655
 Site-SVHN                      (2) | Val  Loss: 0.6235 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9319
 Best site-MNIST                    (3)  | Epoch:35 | Val Acc: 0.9697
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.9444
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.9695
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.9655
 Best site-SVHN                     (2)  | Epoch:35 | Val Acc: 0.8103
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 36 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (3) | Train Loss: 0.1375 | Train Acc: 0.9647
 Site-USPS                      (0) | Train Loss: 0.1683 | Train Acc: 0.9508
 Site-SynthDigits               (1) | Train Loss: 0.2521 | Train Acc: 0.9508
 Site-MNIST_M                   (2) | Train Loss: 0.3694 | Train Acc: 0.9489
 Site-SVHN                      (1) | Train Loss: 0.6469 | Train Acc: 0.8077
Average Train Accuracy: 0.9245
 Site-MNIST                     (3) | Val  Loss: 0.1460 | Val  Acc: 0.9697
 Site-USPS                      (0) | Val  Loss: 0.2184 | Val  Acc: 0.9495
 Site-SynthDigits               (1) | Val  Loss: 0.1853 | Val  Acc: 0.9695
 Site-MNIST_M                   (2) | Val  Loss: 0.3381 | Val  Acc: 0.9770
 Site-SVHN                      (1) | Val  Loss: 0.6206 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9352
 Best site-MNIST                    (3)  | Epoch:36 | Val Acc: 0.9697
 Best site-USPS                     (0)  | Epoch:36 | Val Acc: 0.9495
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.9695
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.9770
 Best site-SVHN                     (1)  | Epoch:36 | Val Acc: 0.8103
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 37 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.1357 | Train Acc: 0.9647
 Site-USPS                      (2) | Train Loss: 0.1656 | Train Acc: 0.9520
 Site-SynthDigits               (1) | Train Loss: 0.2415 | Train Acc: 0.9508
 Site-MNIST_M                   (0) | Train Loss: 0.3588 | Train Acc: 0.9489
 Site-SVHN                      (1) | Train Loss: 0.6552 | Train Acc: 0.8120
Average Train Accuracy: 0.9257
 Site-MNIST                     (3) | Val  Loss: 0.1433 | Val  Acc: 0.9697
 Site-USPS                      (2) | Val  Loss: 0.2090 | Val  Acc: 0.9495
 Site-SynthDigits               (1) | Val  Loss: 0.1718 | Val  Acc: 0.9695
 Site-MNIST_M                   (0) | Val  Loss: 0.3225 | Val  Acc: 0.9885
 Site-SVHN                      (1) | Val  Loss: 0.6132 | Val  Acc: 0.8276
Average Valid Accuracy: 0.9409
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9697
 Best site-USPS                     (2)  | Epoch:37 | Val Acc: 0.9495
 Best site-SynthDigits              (1)  | Epoch:37 | Val Acc: 0.9695
 Best site-MNIST_M                  (0)  | Epoch:37 | Val Acc: 0.9885
 Best site-SVHN                     (1)  | Epoch:37 | Val Acc: 0.8276
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.1355 | Train Acc: 0.9680
 Site-USPS                      (3) | Train Loss: 0.1646 | Train Acc: 0.9482
 Site-SynthDigits               (0) | Train Loss: 0.2342 | Train Acc: 0.9489
 Site-MNIST_M                   (2) | Train Loss: 0.3554 | Train Acc: 0.9403
 Site-SVHN                      (0) | Train Loss: 0.6646 | Train Acc: 0.8034
Average Train Accuracy: 0.9218
 Site-MNIST                     (1) | Val  Loss: 0.1372 | Val  Acc: 0.9697
 Site-USPS                      (3) | Val  Loss: 0.2135 | Val  Acc: 0.9444
 Site-SynthDigits               (0) | Val  Loss: 0.1679 | Val  Acc: 0.9695
 Site-MNIST_M                   (2) | Val  Loss: 0.3200 | Val  Acc: 0.9885
 Site-SVHN                      (0) | Val  Loss: 0.6075 | Val  Acc: 0.7931
Average Valid Accuracy: 0.9330
============ Train epoch 39 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (3) | Train Loss: 0.1345 | Train Acc: 0.9647
 Site-USPS                      (1) | Train Loss: 0.1595 | Train Acc: 0.9495
 Site-SynthDigits               (0) | Train Loss: 0.2317 | Train Acc: 0.9508
 Site-MNIST_M                   (2) | Train Loss: 0.3473 | Train Acc: 0.9489
 Site-SVHN                      (0) | Train Loss: 0.6459 | Train Acc: 0.8120
Average Train Accuracy: 0.9252
 Site-MNIST                     (3) | Val  Loss: 0.1356 | Val  Acc: 0.9697
 Site-USPS                      (1) | Val  Loss: 0.2028 | Val  Acc: 0.9394
 Site-SynthDigits               (0) | Val  Loss: 0.1641 | Val  Acc: 0.9771
 Site-MNIST_M                   (2) | Val  Loss: 0.3165 | Val  Acc: 0.9770
 Site-SVHN                      (0) | Val  Loss: 0.5988 | Val  Acc: 0.8276
Average Valid Accuracy: 0.9382
============ Train epoch 40 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.1261 | Train Acc: 0.9697
 Site-USPS                      (3) | Train Loss: 0.1544 | Train Acc: 0.9482
 Site-SynthDigits               (0) | Train Loss: 0.2348 | Train Acc: 0.9489
 Site-MNIST_M                   (2) | Train Loss: 0.3392 | Train Acc: 0.9574
 Site-SVHN                      (0) | Train Loss: 0.6184 | Train Acc: 0.8120
Average Train Accuracy: 0.9272
 Site-MNIST                     (1) | Val  Loss: 0.1319 | Val  Acc: 0.9697
 Site-USPS                      (3) | Val  Loss: 0.1962 | Val  Acc: 0.9394
 Site-SynthDigits               (0) | Val  Loss: 0.1678 | Val  Acc: 0.9771
 Site-MNIST_M                   (2) | Val  Loss: 0.3008 | Val  Acc: 1.0000
 Site-SVHN                      (0) | Val  Loss: 0.5854 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9393
============ Train epoch 41 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.1242 | Train Acc: 0.9647
 Site-USPS                      (3) | Train Loss: 0.1535 | Train Acc: 0.9545
 Site-SynthDigits               (0) | Train Loss: 0.2310 | Train Acc: 0.9545
 Site-MNIST_M                   (2) | Train Loss: 0.3322 | Train Acc: 0.9460
 Site-SVHN                      (0) | Train Loss: 0.6344 | Train Acc: 0.8205
Average Train Accuracy: 0.9281
 Site-MNIST                     (1) | Val  Loss: 0.1302 | Val  Acc: 0.9697
 Site-USPS                      (3) | Val  Loss: 0.1863 | Val  Acc: 0.9394
 Site-SynthDigits               (0) | Val  Loss: 0.1603 | Val  Acc: 0.9847
 Site-MNIST_M                   (2) | Val  Loss: 0.2902 | Val  Acc: 0.9885
 Site-SVHN                      (0) | Val  Loss: 0.5846 | Val  Acc: 0.8103
Average Valid Accuracy: 0.9385
============ Train epoch 42 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (2) | Train Loss: 0.1242 | Train Acc: 0.9647
 Site-USPS                      (3) | Train Loss: 0.1478 | Train Acc: 0.9558
 Site-SynthDigits               (1) | Train Loss: 0.2165 | Train Acc: 0.9527
 Site-MNIST_M                   (0) | Train Loss: 0.3231 | Train Acc: 0.9602
 Site-SVHN                      (1) | Train Loss: 0.6193 | Train Acc: 0.8205
Average Train Accuracy: 0.9308
 Site-MNIST                     (2) | Val  Loss: 0.1310 | Val  Acc: 0.9630
 Site-USPS                      (3) | Val  Loss: 0.1790 | Val  Acc: 0.9596
 Site-SynthDigits               (1) | Val  Loss: 0.1495 | Val  Acc: 0.9847
 Site-MNIST_M                   (0) | Val  Loss: 0.2852 | Val  Acc: 0.9885
 Site-SVHN                      (1) | Val  Loss: 0.5727 | Val  Acc: 0.8793
Average Valid Accuracy: 0.9550
 Best site-MNIST                    (2)  | Epoch:42 | Val Acc: 0.9630
 Best site-USPS                     (3)  | Epoch:42 | Val Acc: 0.9596
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.9847
 Best site-MNIST_M                  (0)  | Epoch:42 | Val Acc: 0.9885
 Best site-SVHN                     (1)  | Epoch:42 | Val Acc: 0.8793
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.1220 | Train Acc: 0.9706
 Site-USPS                      (3) | Train Loss: 0.1460 | Train Acc: 0.9545
 Site-SynthDigits               (1) | Train Loss: 0.2109 | Train Acc: 0.9508
 Site-MNIST_M                   (2) | Train Loss: 0.3201 | Train Acc: 0.9631
 Site-SVHN                      (1) | Train Loss: 0.5763 | Train Acc: 0.8462
Average Train Accuracy: 0.9370
 Site-MNIST                     (0) | Val  Loss: 0.1258 | Val  Acc: 0.9663
 Site-USPS                      (3) | Val  Loss: 0.1856 | Val  Acc: 0.9444
 Site-SynthDigits               (1) | Val  Loss: 0.1524 | Val  Acc: 0.9695
 Site-MNIST_M                   (2) | Val  Loss: 0.2897 | Val  Acc: 0.9770
 Site-SVHN                      (1) | Val  Loss: 0.5421 | Val  Acc: 0.8448
Average Valid Accuracy: 0.9404
============ Train epoch 44 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.1210 | Train Acc: 0.9680
 Site-USPS                      (3) | Train Loss: 0.1451 | Train Acc: 0.9571
 Site-SynthDigits               (1) | Train Loss: 0.2033 | Train Acc: 0.9564
 Site-MNIST_M                   (2) | Train Loss: 0.3030 | Train Acc: 0.9688
 Site-SVHN                      (1) | Train Loss: 0.6167 | Train Acc: 0.8034
Average Train Accuracy: 0.9307
 Site-MNIST                     (0) | Val  Loss: 0.1268 | Val  Acc: 0.9663
 Site-USPS                      (3) | Val  Loss: 0.1842 | Val  Acc: 0.9495
 Site-SynthDigits               (1) | Val  Loss: 0.1410 | Val  Acc: 0.9847
 Site-MNIST_M                   (2) | Val  Loss: 0.2732 | Val  Acc: 1.0000
 Site-SVHN                      (1) | Val  Loss: 0.5428 | Val  Acc: 0.8621
Average Valid Accuracy: 0.9525
============ Train epoch 45 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (3) | Train Loss: 0.1139 | Train Acc: 0.9714
 Site-USPS                      (0) | Train Loss: 0.1411 | Train Acc: 0.9545
 Site-SynthDigits               (1) | Train Loss: 0.2023 | Train Acc: 0.9621
 Site-MNIST_M                   (2) | Train Loss: 0.2962 | Train Acc: 0.9659
 Site-SVHN                      (1) | Train Loss: 0.5742 | Train Acc: 0.8419
Average Train Accuracy: 0.9392
 Site-MNIST                     (3) | Val  Loss: 0.1214 | Val  Acc: 0.9663
 Site-USPS                      (0) | Val  Loss: 0.1794 | Val  Acc: 0.9495
 Site-SynthDigits               (1) | Val  Loss: 0.1379 | Val  Acc: 0.9771
 Site-MNIST_M                   (2) | Val  Loss: 0.2629 | Val  Acc: 1.0000
 Site-SVHN                      (1) | Val  Loss: 0.5389 | Val  Acc: 0.8448
Average Valid Accuracy: 0.9476
 Test site-MNIST                     (3)| Epoch:42 | Test Acc: 0.9474
 Test site-USPS                      (0)| Epoch:42 | Test Acc: 0.9398
 Test site-SynthDigits               (1)| Epoch:42 | Test Acc: 0.8988
 Test site-MNIST_M                   (2)| Epoch:42 | Test Acc: 0.7077
 Test site-SVHN                      (1)| Epoch:42 | Test Acc: 0.6696
MNIST: 0.9474, USPS: 0.9398, SynthDigits: 0.8988, MNIST_M: 0.7077, SVHN: 0.6696, 
Average Test Accuracy(group): 0.8327, Average Test Accuracy(individual): 0.8327,
domain std=0.1193, cluster std=0.1025, individual std=0.1193, 
Average Test Accuracy: 0.8327
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (3) | Train Loss: 0.1115 | Train Acc: 0.9706
 Site-USPS                      (0) | Train Loss: 0.1380 | Train Acc: 0.9596
 Site-SynthDigits               (1) | Train Loss: 0.1955 | Train Acc: 0.9621
 Site-MNIST_M                   (2) | Train Loss: 0.2942 | Train Acc: 0.9659
 Site-SVHN                      (1) | Train Loss: 0.5926 | Train Acc: 0.8547
Average Train Accuracy: 0.9426
 Site-MNIST                     (3) | Val  Loss: 0.1193 | Val  Acc: 0.9663
 Site-USPS                      (0) | Val  Loss: 0.1650 | Val  Acc: 0.9545
 Site-SynthDigits               (1) | Val  Loss: 0.1359 | Val  Acc: 0.9847
 Site-MNIST_M                   (2) | Val  Loss: 0.2564 | Val  Acc: 1.0000
 Site-SVHN                      (1) | Val  Loss: 0.5309 | Val  Acc: 0.8448
Average Valid Accuracy: 0.9501
 Test site-MNIST                     (3)| Epoch:45 | Test Acc: 0.9480
 Test site-USPS                      (0)| Epoch:45 | Test Acc: 0.9398
 Test site-SynthDigits               (1)| Epoch:45 | Test Acc: 0.8973
 Test site-MNIST_M                   (2)| Epoch:45 | Test Acc: 0.7060
 Test site-SVHN                      (1)| Epoch:45 | Test Acc: 0.6728
MNIST: 0.9480, USPS: 0.9398, SynthDigits: 0.8973, MNIST_M: 0.7060, SVHN: 0.6728, 
Average Test Accuracy(group): 0.8328, Average Test Accuracy(individual): 0.8328,
domain std=0.1188, cluster std=0.1031, individual std=0.1188, 
Average Test Accuracy: 0.8328
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (1) | Train Loss: 0.1099 | Train Acc: 0.9714
 Site-USPS                      (3) | Train Loss: 0.1348 | Train Acc: 0.9583
 Site-SynthDigits               (0) | Train Loss: 0.1931 | Train Acc: 0.9678
 Site-MNIST_M                   (2) | Train Loss: 0.2827 | Train Acc: 0.9716
 Site-SVHN                      (0) | Train Loss: 0.5474 | Train Acc: 0.8419
Average Train Accuracy: 0.9422
 Site-MNIST                     (1) | Val  Loss: 0.1173 | Val  Acc: 0.9663
 Site-USPS                      (3) | Val  Loss: 0.1707 | Val  Acc: 0.9444
 Site-SynthDigits               (0) | Val  Loss: 0.1308 | Val  Acc: 0.9924
 Site-MNIST_M                   (2) | Val  Loss: 0.2508 | Val  Acc: 1.0000
 Site-SVHN                      (0) | Val  Loss: 0.5206 | Val  Acc: 0.8448
Average Valid Accuracy: 0.9496
 Test site-MNIST                     (1)| Epoch:46 | Test Acc: 0.9483
 Test site-USPS                      (3)| Epoch:46 | Test Acc: 0.9398
 Test site-SynthDigits               (0)| Epoch:46 | Test Acc: 0.9000
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.7146
 Test site-SVHN                      (0)| Epoch:46 | Test Acc: 0.6708
MNIST: 0.9483, USPS: 0.9398, SynthDigits: 0.9000, MNIST_M: 0.7146, SVHN: 0.6708, 
Average Test Accuracy(group): 0.8347, Average Test Accuracy(individual): 0.8347,
domain std=0.1179, cluster std=0.1002, individual std=0.1179, 
Average Test Accuracy: 0.8347
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 48 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (3) | Train Loss: 0.1095 | Train Acc: 0.9739
 Site-USPS                      (0) | Train Loss: 0.1334 | Train Acc: 0.9634
 Site-SynthDigits               (1) | Train Loss: 0.1875 | Train Acc: 0.9640
 Site-MNIST_M                   (2) | Train Loss: 0.2759 | Train Acc: 0.9659
 Site-SVHN                      (1) | Train Loss: 0.5521 | Train Acc: 0.8376
Average Train Accuracy: 0.9410
 Site-MNIST                     (3) | Val  Loss: 0.1124 | Val  Acc: 0.9663
 Site-USPS                      (0) | Val  Loss: 0.1672 | Val  Acc: 0.9495
 Site-SynthDigits               (1) | Val  Loss: 0.1328 | Val  Acc: 0.9847
 Site-MNIST_M                   (2) | Val  Loss: 0.2445 | Val  Acc: 1.0000
 Site-SVHN                      (1) | Val  Loss: 0.5024 | Val  Acc: 0.8621
Average Valid Accuracy: 0.9525
 Test site-MNIST                     (3)| Epoch:47 | Test Acc: 0.9494
 Test site-USPS                      (0)| Epoch:47 | Test Acc: 0.9419
 Test site-SynthDigits               (1)| Epoch:47 | Test Acc: 0.8984
 Test site-MNIST_M                   (2)| Epoch:47 | Test Acc: 0.7163
 Test site-SVHN                      (1)| Epoch:47 | Test Acc: 0.6747
MNIST: 0.9494, USPS: 0.9419, SynthDigits: 0.8984, MNIST_M: 0.7163, SVHN: 0.6747, 
Average Test Accuracy(group): 0.8361, Average Test Accuracy(individual): 0.8361,
domain std=0.1169, cluster std=0.1003, individual std=0.1169, 
Average Test Accuracy: 0.8361
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_clscon_distinct/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (3) | Train Loss: 0.1043 | Train Acc: 0.9739
 Site-USPS                      (1) | Train Loss: 0.1299 | Train Acc: 0.9646
 Site-SynthDigits               (0) | Train Loss: 0.1934 | Train Acc: 0.9659
 Site-MNIST_M                   (2) | Train Loss: 0.2682 | Train Acc: 0.9716
 Site-SVHN                      (0) | Train Loss: 0.5113 | Train Acc: 0.8547
Average Train Accuracy: 0.9462
 Site-MNIST                     (3) | Val  Loss: 0.1082 | Val  Acc: 0.9663
 Site-USPS                      (1) | Val  Loss: 0.1612 | Val  Acc: 0.9545
 Site-SynthDigits               (0) | Val  Loss: 0.1319 | Val  Acc: 0.9847
 Site-MNIST_M                   (2) | Val  Loss: 0.2346 | Val  Acc: 1.0000
 Site-SVHN                      (0) | Val  Loss: 0.5102 | Val  Acc: 0.8448
Average Valid Accuracy: 0.9501
 Test site-MNIST                     (3)| Epoch:48 | Test Acc: 0.9494
 Test site-USPS                      (1)| Epoch:48 | Test Acc: 0.9419
 Test site-SynthDigits               (0)| Epoch:48 | Test Acc: 0.8967
 Test site-MNIST_M                   (2)| Epoch:48 | Test Acc: 0.7143
 Test site-SVHN                      (0)| Epoch:48 | Test Acc: 0.6749
MNIST: 0.9494, USPS: 0.9419, SynthDigits: 0.8967, MNIST_M: 0.7143, SVHN: 0.6749, 
Average Test Accuracy(group): 0.8354, Average Test Accuracy(individual): 0.8354,
domain std=0.1171, cluster std=0.1011, individual std=0.1171, 
Average Test Accuracy: 0.8354
===2023-07-03 18:47:11===
===2023-07-03 18:47:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.9494
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9419
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.8984
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.7163
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.6747
MNIST: 0.9494, USPS: 0.9419, SynthDigits: 0.8984, MNIST_M: 0.7163, SVHN: 0.6747, 
Average Test Accuracy(group): 0.8361, Average Test Accuracy(individual): 0.8361,
domain std=0.1169, cluster std=-1.0000, individual std=0.1169, 
