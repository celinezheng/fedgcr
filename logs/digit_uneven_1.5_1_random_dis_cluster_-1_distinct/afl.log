===2023-07-02 13:54:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0472 | Train Acc: 0.5795
 Site-USPS                          | Train Loss: 2.0170 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 2.2476 | Train Acc: 0.2670
 Site-MNIST_M                       | Train Loss: 2.2800 | Train Acc: 0.1591
 Site-SVHN                          | Train Loss: 2.2833 | Train Acc: 0.1026
Average Train Accuracy: 0.3408
 Site-MNIST                         | Val  Loss: 2.0468 | Val  Acc: 0.5960
 Site-USPS                          | Val  Loss: 2.0041 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 2.2973 | Val  Acc: 0.2595
 Site-MNIST_M                       | Val  Loss: 2.2808 | Val  Acc: 0.1609
 Site-SVHN                          | Val  Loss: 2.2808 | Val  Acc: 0.1207
Average Valid Accuracy: 0.3456
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5960
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2595
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.8175 | Train Acc: 0.6997
 Site-USPS                          | Train Loss: 1.7901 | Train Acc: 0.6566
 Site-SynthDigits                   | Train Loss: 2.1666 | Train Acc: 0.3277
 Site-MNIST_M                       | Train Loss: 2.2447 | Train Acc: 0.2585
 Site-SVHN                          | Train Loss: 2.2706 | Train Acc: 0.1410
Average Train Accuracy: 0.4167
 Site-MNIST                         | Val  Loss: 1.8123 | Val  Acc: 0.7104
 Site-USPS                          | Val  Loss: 1.7624 | Val  Acc: 0.6667
 Site-SynthDigits                   | Val  Loss: 2.2540 | Val  Acc: 0.3359
 Site-MNIST_M                       | Val  Loss: 2.2477 | Val  Acc: 0.2759
 Site-SVHN                          | Val  Loss: 2.2722 | Val  Acc: 0.1552
Average Valid Accuracy: 0.4288
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7104
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6667
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3359
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2759
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.6198 | Train Acc: 0.7435
 Site-USPS                          | Train Loss: 1.5731 | Train Acc: 0.7374
 Site-SynthDigits                   | Train Loss: 2.0944 | Train Acc: 0.3466
 Site-MNIST_M                       | Train Loss: 2.1991 | Train Acc: 0.3097
 Site-SVHN                          | Train Loss: 2.2573 | Train Acc: 0.1496
Average Train Accuracy: 0.4573
 Site-MNIST                         | Val  Loss: 1.6130 | Val  Acc: 0.7407
 Site-USPS                          | Val  Loss: 1.5638 | Val  Acc: 0.7323
 Site-SynthDigits                   | Val  Loss: 2.2092 | Val  Acc: 0.3740
 Site-MNIST_M                       | Val  Loss: 2.2024 | Val  Acc: 0.3218
 Site-SVHN                          | Val  Loss: 2.2574 | Val  Acc: 0.1724
Average Valid Accuracy: 0.4683
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7407
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7323
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3740
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3218
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.4530 | Train Acc: 0.7796
 Site-USPS                          | Train Loss: 1.4118 | Train Acc: 0.7626
 Site-SynthDigits                   | Train Loss: 2.0440 | Train Acc: 0.3788
 Site-MNIST_M                       | Train Loss: 2.1642 | Train Acc: 0.3153
 Site-SVHN                          | Train Loss: 2.2420 | Train Acc: 0.1752
Average Train Accuracy: 0.4823
 Site-MNIST                         | Val  Loss: 1.4394 | Val  Acc: 0.7845
 Site-USPS                          | Val  Loss: 1.3881 | Val  Acc: 0.7576
 Site-SynthDigits                   | Val  Loss: 2.1690 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.1667 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 2.2425 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5008
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7845
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7576
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3333
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.2950 | Train Acc: 0.7906
 Site-USPS                          | Train Loss: 1.2549 | Train Acc: 0.7929
 Site-SynthDigits                   | Train Loss: 1.9882 | Train Acc: 0.4015
 Site-MNIST_M                       | Train Loss: 2.1281 | Train Acc: 0.3352
 Site-SVHN                          | Train Loss: 2.2265 | Train Acc: 0.1966
Average Train Accuracy: 0.5034
 Site-MNIST                         | Val  Loss: 1.2848 | Val  Acc: 0.7811
 Site-USPS                          | Val  Loss: 1.2349 | Val  Acc: 0.7980
 Site-SynthDigits                   | Val  Loss: 2.1414 | Val  Acc: 0.4275
 Site-MNIST_M                       | Val  Loss: 2.1316 | Val  Acc: 0.3563
 Site-SVHN                          | Val  Loss: 2.2275 | Val  Acc: 0.1897
Average Valid Accuracy: 0.5105
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7811
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7980
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4275
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3563
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.1708 | Train Acc: 0.8116
 Site-USPS                          | Train Loss: 1.1218 | Train Acc: 0.8194
 Site-SynthDigits                   | Train Loss: 1.9575 | Train Acc: 0.4242
 Site-MNIST_M                       | Train Loss: 2.0941 | Train Acc: 0.3466
 Site-SVHN                          | Train Loss: 2.2183 | Train Acc: 0.2308
Average Train Accuracy: 0.5265
 Site-MNIST                         | Val  Loss: 1.1522 | Val  Acc: 0.8013
 Site-USPS                          | Val  Loss: 1.1166 | Val  Acc: 0.8283
 Site-SynthDigits                   | Val  Loss: 2.1017 | Val  Acc: 0.4351
 Site-MNIST_M                       | Val  Loss: 2.0917 | Val  Acc: 0.3793
 Site-SVHN                          | Val  Loss: 2.2069 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5336
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8013
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8283
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4351
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3793
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.0821 | Train Acc: 0.8066
 Site-USPS                          | Train Loss: 1.0044 | Train Acc: 0.8283
 Site-SynthDigits                   | Train Loss: 1.8708 | Train Acc: 0.4299
 Site-MNIST_M                       | Train Loss: 2.0544 | Train Acc: 0.3835
 Site-SVHN                          | Train Loss: 2.2047 | Train Acc: 0.2436
Average Train Accuracy: 0.5384
 Site-MNIST                         | Val  Loss: 1.0672 | Val  Acc: 0.8047
 Site-USPS                          | Val  Loss: 1.0098 | Val  Acc: 0.8333
 Site-SynthDigits                   | Val  Loss: 2.0660 | Val  Acc: 0.4351
 Site-MNIST_M                       | Val  Loss: 2.0526 | Val  Acc: 0.4023
 Site-SVHN                          | Val  Loss: 2.1816 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5434
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8047
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8333
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4351
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4023
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.9819 | Train Acc: 0.8150
 Site-USPS                          | Train Loss: 0.9328 | Train Acc: 0.8371
 Site-SynthDigits                   | Train Loss: 1.8426 | Train Acc: 0.4394
 Site-MNIST_M                       | Train Loss: 2.0249 | Train Acc: 0.3920
 Site-SVHN                          | Train Loss: 2.1909 | Train Acc: 0.2436
Average Train Accuracy: 0.5454
 Site-MNIST                         | Val  Loss: 0.9597 | Val  Acc: 0.8114
 Site-USPS                          | Val  Loss: 0.9338 | Val  Acc: 0.8434
 Site-SynthDigits                   | Val  Loss: 2.0487 | Val  Acc: 0.4351
 Site-MNIST_M                       | Val  Loss: 2.0226 | Val  Acc: 0.4023
 Site-SVHN                          | Val  Loss: 2.1679 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5502
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8114
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8434
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4351
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4023
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.9212 | Train Acc: 0.8150
 Site-USPS                          | Train Loss: 0.8549 | Train Acc: 0.8472
 Site-SynthDigits                   | Train Loss: 1.7903 | Train Acc: 0.4470
 Site-MNIST_M                       | Train Loss: 1.9771 | Train Acc: 0.3920
 Site-SVHN                          | Train Loss: 2.1771 | Train Acc: 0.2436
Average Train Accuracy: 0.5490
 Site-MNIST                         | Val  Loss: 0.8979 | Val  Acc: 0.8249
 Site-USPS                          | Val  Loss: 0.8689 | Val  Acc: 0.8586
 Site-SynthDigits                   | Val  Loss: 2.0201 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.9930 | Val  Acc: 0.4023
 Site-SVHN                          | Val  Loss: 2.1534 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5620
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8249
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8586
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4023
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.8701 | Train Acc: 0.8124
 Site-USPS                          | Train Loss: 0.7861 | Train Acc: 0.8624
 Site-SynthDigits                   | Train Loss: 1.7979 | Train Acc: 0.4545
 Site-MNIST_M                       | Train Loss: 1.9576 | Train Acc: 0.4148
 Site-SVHN                          | Train Loss: 2.1705 | Train Acc: 0.2436
Average Train Accuracy: 0.5575
 Site-MNIST                         | Val  Loss: 0.8476 | Val  Acc: 0.8182
 Site-USPS                          | Val  Loss: 0.8166 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 1.9896 | Val  Acc: 0.4580
 Site-MNIST_M                       | Val  Loss: 1.9523 | Val  Acc: 0.4138
 Site-SVHN                          | Val  Loss: 2.1378 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5679
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8182
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8737
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4580
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4138
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.7998 | Train Acc: 0.8209
 Site-USPS                          | Train Loss: 0.7441 | Train Acc: 0.8687
 Site-SynthDigits                   | Train Loss: 1.7321 | Train Acc: 0.4640
 Site-MNIST_M                       | Train Loss: 1.9197 | Train Acc: 0.4261
 Site-SVHN                          | Train Loss: 2.1618 | Train Acc: 0.2436
Average Train Accuracy: 0.5647
 Site-MNIST                         | Val  Loss: 0.7803 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.7676 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.9733 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.9237 | Val  Acc: 0.4023
 Site-SVHN                          | Val  Loss: 2.1258 | Val  Acc: 0.2931
Average Valid Accuracy: 0.5758
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8316
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4023
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.7636 | Train Acc: 0.8234
 Site-USPS                          | Train Loss: 0.6874 | Train Acc: 0.8712
 Site-SynthDigits                   | Train Loss: 1.7280 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.8898 | Train Acc: 0.4375
 Site-SVHN                          | Train Loss: 2.1538 | Train Acc: 0.2692
Average Train Accuracy: 0.5746
 Site-MNIST                         | Val  Loss: 0.7397 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.7332 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9543 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.9002 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1191 | Val  Acc: 0.3103
Average Valid Accuracy: 0.5879
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8350
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4368
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.7235 | Train Acc: 0.8276
 Site-USPS                          | Train Loss: 0.6662 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.6828 | Train Acc: 0.4867
 Site-MNIST_M                       | Train Loss: 1.8688 | Train Acc: 0.4545
 Site-SVHN                          | Train Loss: 2.1394 | Train Acc: 0.2564
Average Train Accuracy: 0.5780
 Site-MNIST                         | Val  Loss: 0.7009 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.7019 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 1.9178 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.8646 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.1075 | Val  Acc: 0.3103
Average Valid Accuracy: 0.5950
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8350
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8737
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4962
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4598
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.6783 | Train Acc: 0.8436
 Site-USPS                          | Train Loss: 0.6205 | Train Acc: 0.8737
 Site-SynthDigits                   | Train Loss: 1.6489 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.8248 | Train Acc: 0.4688
 Site-SVHN                          | Train Loss: 2.1283 | Train Acc: 0.2521
Average Train Accuracy: 0.5865
 Site-MNIST                         | Val  Loss: 0.6519 | Val  Acc: 0.8586
 Site-USPS                          | Val  Loss: 0.6761 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 1.9016 | Val  Acc: 0.4885
 Site-MNIST_M                       | Val  Loss: 1.8385 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.0992 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5913
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.6303 | Train Acc: 0.8503
 Site-USPS                          | Train Loss: 0.6030 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.6452 | Train Acc: 0.4905
 Site-MNIST_M                       | Train Loss: 1.8028 | Train Acc: 0.4744
 Site-SVHN                          | Train Loss: 2.1207 | Train Acc: 0.2564
Average Train Accuracy: 0.5893
 Site-MNIST                         | Val  Loss: 0.6063 | Val  Acc: 0.8620
 Site-USPS                          | Val  Loss: 0.6550 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8972 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.8148 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0850 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5991
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8620
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4962
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4828
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.5976 | Train Acc: 0.8553
 Site-USPS                          | Train Loss: 0.5660 | Train Acc: 0.8775
 Site-SynthDigits                   | Train Loss: 1.6270 | Train Acc: 0.4886
 Site-MNIST_M                       | Train Loss: 1.7716 | Train Acc: 0.4830
 Site-SVHN                          | Train Loss: 2.1062 | Train Acc: 0.2521
Average Train Accuracy: 0.5913
 Site-MNIST                         | Val  Loss: 0.5752 | Val  Acc: 0.8519
 Site-USPS                          | Val  Loss: 0.6263 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.8820 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.7968 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.0749 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5981
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.5717 | Train Acc: 0.8663
 Site-USPS                          | Train Loss: 0.5556 | Train Acc: 0.8801
 Site-SynthDigits                   | Train Loss: 1.5772 | Train Acc: 0.4981
 Site-MNIST_M                       | Train Loss: 1.7590 | Train Acc: 0.4915
 Site-SVHN                          | Train Loss: 2.0951 | Train Acc: 0.2607
Average Train Accuracy: 0.5993
 Site-MNIST                         | Val  Loss: 0.5452 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.6110 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8665 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.7817 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.0558 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5962
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.5423 | Train Acc: 0.8730
 Site-USPS                          | Train Loss: 0.5316 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.5873 | Train Acc: 0.4981
 Site-MNIST_M                       | Train Loss: 1.7345 | Train Acc: 0.4858
 Site-SVHN                          | Train Loss: 2.0886 | Train Acc: 0.2607
Average Train Accuracy: 0.6008
 Site-MNIST                         | Val  Loss: 0.5154 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.5962 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.8669 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.7619 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0578 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6026
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8687
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4962
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5057
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.5135 | Train Acc: 0.8730
 Site-USPS                          | Train Loss: 0.5000 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.5653 | Train Acc: 0.5038
 Site-MNIST_M                       | Train Loss: 1.7168 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.0857 | Train Acc: 0.2607
Average Train Accuracy: 0.6042
 Site-MNIST                         | Val  Loss: 0.4945 | Val  Acc: 0.8754
 Site-USPS                          | Val  Loss: 0.5741 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.8538 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.7356 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0449 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6097
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8754
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4962
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.4896 | Train Acc: 0.8806
 Site-USPS                          | Train Loss: 0.4947 | Train Acc: 0.8927
 Site-SynthDigits                   | Train Loss: 1.5495 | Train Acc: 0.5019
 Site-MNIST_M                       | Train Loss: 1.7134 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.0622 | Train Acc: 0.2607
Average Train Accuracy: 0.6049
 Site-MNIST                         | Val  Loss: 0.4687 | Val  Acc: 0.8788
 Site-USPS                          | Val  Loss: 0.5608 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.8392 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.7297 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0330 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6026
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.4823 | Train Acc: 0.8831
 Site-USPS                          | Train Loss: 0.4840 | Train Acc: 0.8914
 Site-SynthDigits                   | Train Loss: 1.5366 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.7058 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.0642 | Train Acc: 0.2778
Average Train Accuracy: 0.6144
 Site-MNIST                         | Val  Loss: 0.4581 | Val  Acc: 0.8788
 Site-USPS                          | Val  Loss: 0.5478 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.8159 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.7122 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0143 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6134
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8788
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.4540 | Train Acc: 0.8890
 Site-USPS                          | Train Loss: 0.4706 | Train Acc: 0.8965
 Site-SynthDigits                   | Train Loss: 1.5143 | Train Acc: 0.5114
 Site-MNIST_M                       | Train Loss: 1.6596 | Train Acc: 0.5085
 Site-SVHN                          | Train Loss: 2.0589 | Train Acc: 0.2821
Average Train Accuracy: 0.6175
 Site-MNIST                         | Val  Loss: 0.4288 | Val  Acc: 0.8788
 Site-USPS                          | Val  Loss: 0.5324 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.8316 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.6991 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0163 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6125
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.4382 | Train Acc: 0.8932
 Site-USPS                          | Train Loss: 0.4546 | Train Acc: 0.8977
 Site-SynthDigits                   | Train Loss: 1.5140 | Train Acc: 0.5152
 Site-MNIST_M                       | Train Loss: 1.6517 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.0536 | Train Acc: 0.2863
Average Train Accuracy: 0.6179
 Site-MNIST                         | Val  Loss: 0.4144 | Val  Acc: 0.8923
 Site-USPS                          | Val  Loss: 0.5258 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.8010 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.6842 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0146 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6129
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.4249 | Train Acc: 0.8957
 Site-USPS                          | Train Loss: 0.4294 | Train Acc: 0.9003
 Site-SynthDigits                   | Train Loss: 1.5480 | Train Acc: 0.5341
 Site-MNIST_M                       | Train Loss: 1.6272 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.0421 | Train Acc: 0.2949
Average Train Accuracy: 0.6278
 Site-MNIST                         | Val  Loss: 0.4037 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4986 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8041 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.6731 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0075 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6265
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.4082 | Train Acc: 0.8999
 Site-USPS                          | Train Loss: 0.4413 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.4905 | Train Acc: 0.5360
 Site-MNIST_M                       | Train Loss: 1.6355 | Train Acc: 0.5227
 Site-SVHN                          | Train Loss: 2.0387 | Train Acc: 0.2821
Average Train Accuracy: 0.6284
 Site-MNIST                         | Val  Loss: 0.3848 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4982 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7885 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.6580 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0072 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6217
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.3953 | Train Acc: 0.9033
 Site-USPS                          | Train Loss: 0.4175 | Train Acc: 0.9028
 Site-SynthDigits                   | Train Loss: 1.4818 | Train Acc: 0.5473
 Site-MNIST_M                       | Train Loss: 1.6215 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.0414 | Train Acc: 0.2778
Average Train Accuracy: 0.6285
 Site-MNIST                         | Val  Loss: 0.3724 | Val  Acc: 0.8923
 Site-USPS                          | Val  Loss: 0.4866 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7748 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.6553 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.0015 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6220
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.3859 | Train Acc: 0.9066
 Site-USPS                          | Train Loss: 0.4041 | Train Acc: 0.9066
 Site-SynthDigits                   | Train Loss: 1.4834 | Train Acc: 0.5587
 Site-MNIST_M                       | Train Loss: 1.5842 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 2.0149 | Train Acc: 0.2991
Average Train Accuracy: 0.6382
 Site-MNIST                         | Val  Loss: 0.3662 | Val  Acc: 0.8990
 Site-USPS                          | Val  Loss: 0.4826 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7407 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.6292 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 1.9881 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6283
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8990
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5725
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.3716 | Train Acc: 0.9083
 Site-USPS                          | Train Loss: 0.4049 | Train Acc: 0.9053
 Site-SynthDigits                   | Train Loss: 1.4404 | Train Acc: 0.5587
 Site-MNIST_M                       | Train Loss: 1.5972 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 2.0279 | Train Acc: 0.2863
Average Train Accuracy: 0.6357
 Site-MNIST                         | Val  Loss: 0.3524 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4774 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7347 | Val  Acc: 0.5573
 Site-MNIST_M                       | Val  Loss: 1.6148 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 1.9898 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6293
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5573
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.3572 | Train Acc: 0.9159
 Site-USPS                          | Train Loss: 0.3769 | Train Acc: 0.9066
 Site-SynthDigits                   | Train Loss: 1.4414 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.5793 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 2.0105 | Train Acc: 0.2906
Average Train Accuracy: 0.6402
 Site-MNIST                         | Val  Loss: 0.3376 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.4596 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7366 | Val  Acc: 0.5802
 Site-MNIST_M                       | Val  Loss: 1.6074 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 1.9887 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6382
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9125
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5802
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.3532 | Train Acc: 0.9159
 Site-USPS                          | Train Loss: 0.3788 | Train Acc: 0.9053
 Site-SynthDigits                   | Train Loss: 1.4185 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.5840 | Train Acc: 0.5312
 Site-SVHN                          | Train Loss: 2.0176 | Train Acc: 0.2949
Average Train Accuracy: 0.6420
 Site-MNIST                         | Val  Loss: 0.3333 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.4553 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7164 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.6083 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9889 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6383
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9091
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5725
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.3410 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.3624 | Train Acc: 0.9078
 Site-SynthDigits                   | Train Loss: 1.4207 | Train Acc: 0.5701
 Site-MNIST_M                       | Train Loss: 1.5586 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 2.0101 | Train Acc: 0.2949
Average Train Accuracy: 0.6490
 Site-MNIST                         | Val  Loss: 0.3187 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.4366 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7261 | Val  Acc: 0.5878
 Site-MNIST_M                       | Val  Loss: 1.5902 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9759 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6400
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9192
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5878
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.3254 | Train Acc: 0.9251
 Site-USPS                          | Train Loss: 0.3573 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4400 | Train Acc: 0.5682
 Site-MNIST_M                       | Train Loss: 1.5433 | Train Acc: 0.5341
 Site-SVHN                          | Train Loss: 2.0067 | Train Acc: 0.3034
Average Train Accuracy: 0.6480
 Site-MNIST                         | Val  Loss: 0.3073 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.4270 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7115 | Val  Acc: 0.5802
 Site-MNIST_M                       | Val  Loss: 1.5907 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 1.9756 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6368
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.3155 | Train Acc: 0.9243
 Site-USPS                          | Train Loss: 0.3743 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.3932 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.5462 | Train Acc: 0.5483
 Site-SVHN                          | Train Loss: 2.0088 | Train Acc: 0.3034
Average Train Accuracy: 0.6529
 Site-MNIST                         | Val  Loss: 0.2977 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.4253 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.6993 | Val  Acc: 0.5878
 Site-MNIST_M                       | Val  Loss: 1.5778 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9672 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6406
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9226
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5878
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.3034 | Train Acc: 0.9327
 Site-USPS                          | Train Loss: 0.3574 | Train Acc: 0.9141
 Site-SynthDigits                   | Train Loss: 1.4054 | Train Acc: 0.5758
 Site-MNIST_M                       | Train Loss: 1.5597 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 2.0007 | Train Acc: 0.3077
Average Train Accuracy: 0.6512
 Site-MNIST                         | Val  Loss: 0.2863 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.4282 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.6825 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.5758 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 1.9719 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6411
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9360
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5725
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.3030 | Train Acc: 0.9285
 Site-USPS                          | Train Loss: 0.3416 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.4044 | Train Acc: 0.5682
 Site-MNIST_M                       | Train Loss: 1.5174 | Train Acc: 0.5540
 Site-SVHN                          | Train Loss: 1.9944 | Train Acc: 0.3034
Average Train Accuracy: 0.6539
 Site-MNIST                         | Val  Loss: 0.2861 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.4113 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.6395 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.5645 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9544 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6343
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.2996 | Train Acc: 0.9294
 Site-USPS                          | Train Loss: 0.3417 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.3545 | Train Acc: 0.5814
 Site-MNIST_M                       | Train Loss: 1.5047 | Train Acc: 0.5483
 Site-SVHN                          | Train Loss: 1.9822 | Train Acc: 0.2906
Average Train Accuracy: 0.6530
 Site-MNIST                         | Val  Loss: 0.2817 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.4192 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.6411 | Val  Acc: 0.5878
 Site-MNIST_M                       | Val  Loss: 1.5493 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 1.9634 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6383
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.2929 | Train Acc: 0.9294
 Site-USPS                          | Train Loss: 0.3410 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.3414 | Train Acc: 0.5814
 Site-MNIST_M                       | Train Loss: 1.5005 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 1.9877 | Train Acc: 0.3120
Average Train Accuracy: 0.6592
 Site-MNIST                         | Val  Loss: 0.2761 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3903 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.6526 | Val  Acc: 0.5954
 Site-MNIST_M                       | Val  Loss: 1.5336 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 1.9477 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6450
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5954
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.2890 | Train Acc: 0.9268
 Site-USPS                          | Train Loss: 0.3188 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.3498 | Train Acc: 0.5739
 Site-MNIST_M                       | Train Loss: 1.5077 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.9906 | Train Acc: 0.2949
Average Train Accuracy: 0.6527
 Site-MNIST                         | Val  Loss: 0.2724 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.3994 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.6233 | Val  Acc: 0.5802
 Site-MNIST_M                       | Val  Loss: 1.5446 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9492 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6398
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.2817 | Train Acc: 0.9327
 Site-USPS                          | Train Loss: 0.3354 | Train Acc: 0.9129
 Site-SynthDigits                   | Train Loss: 1.3453 | Train Acc: 0.5890
 Site-MNIST_M                       | Train Loss: 1.4733 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 1.9685 | Train Acc: 0.3120
Average Train Accuracy: 0.6607
 Site-MNIST                         | Val  Loss: 0.2680 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3927 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.6043 | Val  Acc: 0.6107
 Site-MNIST_M                       | Val  Loss: 1.5288 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 1.9341 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6449
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.2736 | Train Acc: 0.9352
 Site-USPS                          | Train Loss: 0.3137 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.3466 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.4675 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.9584 | Train Acc: 0.3077
Average Train Accuracy: 0.6593
 Site-MNIST                         | Val  Loss: 0.2585 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3865 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.6281 | Val  Acc: 0.6031
 Site-MNIST_M                       | Val  Loss: 1.5193 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 1.9483 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6540
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9360
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6031
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.2753 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.3133 | Train Acc: 0.9205
 Site-SynthDigits                   | Train Loss: 1.3130 | Train Acc: 0.5890
 Site-MNIST_M                       | Train Loss: 1.4670 | Train Acc: 0.5540
 Site-SVHN                          | Train Loss: 1.9791 | Train Acc: 0.3162
Average Train Accuracy: 0.6620
 Site-MNIST                         | Val  Loss: 0.2572 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3743 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5948 | Val  Acc: 0.5954
 Site-MNIST_M                       | Val  Loss: 1.5204 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9300 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6531
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.2675 | Train Acc: 0.9352
 Site-USPS                          | Train Loss: 0.3160 | Train Acc: 0.9217
 Site-SynthDigits                   | Train Loss: 1.3028 | Train Acc: 0.5890
 Site-MNIST_M                       | Train Loss: 1.4642 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 1.9678 | Train Acc: 0.3120
Average Train Accuracy: 0.6630
 Site-MNIST                         | Val  Loss: 0.2498 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3586 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.6007 | Val  Acc: 0.6031
 Site-MNIST_M                       | Val  Loss: 1.5038 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9216 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6560
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6031
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.2655 | Train Acc: 0.9361
 Site-USPS                          | Train Loss: 0.2982 | Train Acc: 0.9205
 Site-SynthDigits                   | Train Loss: 1.2708 | Train Acc: 0.5947
 Site-MNIST_M                       | Train Loss: 1.4465 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 1.9712 | Train Acc: 0.3120
Average Train Accuracy: 0.6640
 Site-MNIST                         | Val  Loss: 0.2487 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3484 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5934 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.5041 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9166 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6674
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6260
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/afl...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.2484 | Train Acc: 0.9394
 Site-USPS                          | Train Loss: 0.2892 | Train Acc: 0.9217
 Site-SynthDigits                   | Train Loss: 1.2991 | Train Acc: 0.5966
 Site-MNIST_M                       | Train Loss: 1.4421 | Train Acc: 0.5597
 Site-SVHN                          | Train Loss: 1.9582 | Train Acc: 0.3034
Average Train Accuracy: 0.6642
 Site-MNIST                         | Val  Loss: 0.2351 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3425 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.6006 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.4978 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9132 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6598
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.2456 | Train Acc: 0.9403
 Site-USPS                          | Train Loss: 0.2944 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.2995 | Train Acc: 0.6023
 Site-MNIST_M                       | Train Loss: 1.4300 | Train Acc: 0.5653
 Site-SVHN                          | Train Loss: 1.9607 | Train Acc: 0.2949
Average Train Accuracy: 0.6652
 Site-MNIST                         | Val  Loss: 0.2310 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3451 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5809 | Val  Acc: 0.6336
 Site-MNIST_M                       | Val  Loss: 1.4936 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9113 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6593
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.2475 | Train Acc: 0.9369
 Site-USPS                          | Train Loss: 0.2987 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.2578 | Train Acc: 0.6042
 Site-MNIST_M                       | Train Loss: 1.4377 | Train Acc: 0.5625
 Site-SVHN                          | Train Loss: 1.9496 | Train Acc: 0.2991
Average Train Accuracy: 0.6651
 Site-MNIST                         | Val  Loss: 0.2322 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3361 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5711 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.4778 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.9010 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6605
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.2363 | Train Acc: 0.9437
 Site-USPS                          | Train Loss: 0.2785 | Train Acc: 0.9280
 Site-SynthDigits                   | Train Loss: 1.2800 | Train Acc: 0.5985
 Site-MNIST_M                       | Train Loss: 1.4427 | Train Acc: 0.5625
 Site-SVHN                          | Train Loss: 1.9622 | Train Acc: 0.3077
Average Train Accuracy: 0.6681
 Site-MNIST                         | Val  Loss: 0.2236 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3413 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5794 | Val  Acc: 0.6183
 Site-MNIST_M                       | Val  Loss: 1.4848 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 1.9109 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6633
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.2363 | Train Acc: 0.9428
 Site-USPS                          | Train Loss: 0.2935 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.2480 | Train Acc: 0.6042
 Site-MNIST_M                       | Train Loss: 1.4075 | Train Acc: 0.5597
 Site-SVHN                          | Train Loss: 1.9377 | Train Acc: 0.2991
Average Train Accuracy: 0.6660
 Site-MNIST                         | Val  Loss: 0.2223 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3299 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5554 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.4581 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.8927 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6632
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.2270 | Train Acc: 0.9445
 Site-USPS                          | Train Loss: 0.2738 | Train Acc: 0.9268
 Site-SynthDigits                   | Train Loss: 1.2419 | Train Acc: 0.6042
 Site-MNIST_M                       | Train Loss: 1.4130 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 1.9348 | Train Acc: 0.3120
Average Train Accuracy: 0.6688
 Site-MNIST                         | Val  Loss: 0.2129 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3300 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5550 | Val  Acc: 0.6336
 Site-MNIST_M                       | Val  Loss: 1.4645 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 1.8875 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6641
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.2215 | Train Acc: 0.9470
 Site-USPS                          | Train Loss: 0.2687 | Train Acc: 0.9255
 Site-SynthDigits                   | Train Loss: 1.2260 | Train Acc: 0.6098
 Site-MNIST_M                       | Train Loss: 1.4047 | Train Acc: 0.5653
 Site-SVHN                          | Train Loss: 1.9377 | Train Acc: 0.3034
Average Train Accuracy: 0.6702
 Site-MNIST                         | Val  Loss: 0.2093 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3268 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5420 | Val  Acc: 0.6336
 Site-MNIST_M                       | Val  Loss: 1.4538 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 1.8923 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6623
===2023-07-02 14:28:43===
===2023-07-02 14:28:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:42 | Test Acc: 0.9031
 Test site-USPS                      | Epoch:42 | Test Acc: 0.9183
 Test site-SynthDigits               | Epoch:42 | Test Acc: 0.5581
 Test site-MNIST_M                   | Epoch:42 | Test Acc: 0.4009
 Test site-SVHN                      | Epoch:42 | Test Acc: 0.2881
MNIST: 0.9031, USPS: 0.9183, SynthDigits: 0.5581, MNIST_M: 0.4009, SVHN: 0.2881, 
Average Test Accuracy(group): 0.6137, Average Test Accuracy(individual): 0.6137,
domain std=0.2573, cluster std=-1.0000, individual std=0.2573, 
