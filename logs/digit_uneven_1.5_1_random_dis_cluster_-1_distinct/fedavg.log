===2023-07-02 13:12:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0196 | Train Acc: 0.6468
 Site-USPS                          | Train Loss: 2.0132 | Train Acc: 0.6667
 Site-SynthDigits                   | Train Loss: 2.2338 | Train Acc: 0.2386
 Site-MNIST_M                       | Train Loss: 2.2637 | Train Acc: 0.1733
 Site-SVHN                          | Train Loss: 2.2838 | Train Acc: 0.1368
Average Train Accuracy: 0.3724
 Site-MNIST                         | Val  Loss: 2.0157 | Val  Acc: 0.6700
 Site-USPS                          | Val  Loss: 1.9845 | Val  Acc: 0.6414
 Site-SynthDigits                   | Val  Loss: 2.2806 | Val  Acc: 0.1985
 Site-MNIST_M                       | Val  Loss: 2.2597 | Val  Acc: 0.1609
 Site-SVHN                          | Val  Loss: 2.2939 | Val  Acc: 0.1552
Average Valid Accuracy: 0.3652
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6700
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6414
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1985
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.7647 | Train Acc: 0.7040
 Site-USPS                          | Train Loss: 1.7627 | Train Acc: 0.7247
 Site-SynthDigits                   | Train Loss: 2.1525 | Train Acc: 0.3239
 Site-MNIST_M                       | Train Loss: 2.2145 | Train Acc: 0.2642
 Site-SVHN                          | Train Loss: 2.2700 | Train Acc: 0.1496
Average Train Accuracy: 0.4333
 Site-MNIST                         | Val  Loss: 1.7544 | Val  Acc: 0.7071
 Site-USPS                          | Val  Loss: 1.7329 | Val  Acc: 0.6869
 Site-SynthDigits                   | Val  Loss: 2.2179 | Val  Acc: 0.3206
 Site-MNIST_M                       | Val  Loss: 2.2045 | Val  Acc: 0.2299
 Site-SVHN                          | Val  Loss: 2.2837 | Val  Acc: 0.1379
Average Valid Accuracy: 0.4165
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7071
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6869
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3206
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2299
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.5343 | Train Acc: 0.7595
 Site-USPS                          | Train Loss: 1.5145 | Train Acc: 0.7778
 Site-SynthDigits                   | Train Loss: 2.0828 | Train Acc: 0.3409
 Site-MNIST_M                       | Train Loss: 2.1678 | Train Acc: 0.3182
 Site-SVHN                          | Train Loss: 2.2597 | Train Acc: 0.1667
Average Train Accuracy: 0.4726
 Site-MNIST                         | Val  Loss: 1.5278 | Val  Acc: 0.7710
 Site-USPS                          | Val  Loss: 1.4851 | Val  Acc: 0.7323
 Site-SynthDigits                   | Val  Loss: 2.1663 | Val  Acc: 0.3359
 Site-MNIST_M                       | Val  Loss: 2.1552 | Val  Acc: 0.3218
 Site-SVHN                          | Val  Loss: 2.2744 | Val  Acc: 0.1552
Average Valid Accuracy: 0.4633
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7710
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7323
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3359
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3218
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.3390 | Train Acc: 0.7881
 Site-USPS                          | Train Loss: 1.3139 | Train Acc: 0.8068
 Site-SynthDigits                   | Train Loss: 2.0105 | Train Acc: 0.3561
 Site-MNIST_M                       | Train Loss: 2.1186 | Train Acc: 0.3636
 Site-SVHN                          | Train Loss: 2.2452 | Train Acc: 0.1923
Average Train Accuracy: 0.5014
 Site-MNIST                         | Val  Loss: 1.3248 | Val  Acc: 0.7946
 Site-USPS                          | Val  Loss: 1.2859 | Val  Acc: 0.7727
 Site-SynthDigits                   | Val  Loss: 2.1220 | Val  Acc: 0.3893
 Site-MNIST_M                       | Val  Loss: 2.1056 | Val  Acc: 0.3563
 Site-SVHN                          | Val  Loss: 2.2564 | Val  Acc: 0.1552
Average Valid Accuracy: 0.4936
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7946
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7727
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3893
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3563
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.1752 | Train Acc: 0.7973
 Site-USPS                          | Train Loss: 1.1323 | Train Acc: 0.8396
 Site-SynthDigits                   | Train Loss: 1.9760 | Train Acc: 0.3750
 Site-MNIST_M                       | Train Loss: 2.0724 | Train Acc: 0.3949
 Site-SVHN                          | Train Loss: 2.2407 | Train Acc: 0.1752
Average Train Accuracy: 0.5164
 Site-MNIST                         | Val  Loss: 1.1603 | Val  Acc: 0.7811
 Site-USPS                          | Val  Loss: 1.1133 | Val  Acc: 0.8283
 Site-SynthDigits                   | Val  Loss: 2.0984 | Val  Acc: 0.3969
 Site-MNIST_M                       | Val  Loss: 2.0550 | Val  Acc: 0.4138
 Site-SVHN                          | Val  Loss: 2.2450 | Val  Acc: 0.1724
Average Valid Accuracy: 0.5185
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7811
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8283
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3969
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4138
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.0372 | Train Acc: 0.8133
 Site-USPS                          | Train Loss: 0.9877 | Train Acc: 0.8422
 Site-SynthDigits                   | Train Loss: 1.8934 | Train Acc: 0.3883
 Site-MNIST_M                       | Train Loss: 2.0244 | Train Acc: 0.4119
 Site-SVHN                          | Train Loss: 2.2321 | Train Acc: 0.2094
Average Train Accuracy: 0.5330
 Site-MNIST                         | Val  Loss: 1.0190 | Val  Acc: 0.8081
 Site-USPS                          | Val  Loss: 0.9859 | Val  Acc: 0.8384
 Site-SynthDigits                   | Val  Loss: 2.0705 | Val  Acc: 0.4046
 Site-MNIST_M                       | Val  Loss: 2.0027 | Val  Acc: 0.4253
 Site-SVHN                          | Val  Loss: 2.2300 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5401
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8081
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8384
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4046
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.4253
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.9211 | Train Acc: 0.8234
 Site-USPS                          | Train Loss: 0.8813 | Train Acc: 0.8561
 Site-SynthDigits                   | Train Loss: 1.8549 | Train Acc: 0.4053
 Site-MNIST_M                       | Train Loss: 1.9821 | Train Acc: 0.4034
 Site-SVHN                          | Train Loss: 2.2163 | Train Acc: 0.2179
Average Train Accuracy: 0.5412
 Site-MNIST                         | Val  Loss: 0.8991 | Val  Acc: 0.8215
 Site-USPS                          | Val  Loss: 0.8939 | Val  Acc: 0.8535
 Site-SynthDigits                   | Val  Loss: 2.0564 | Val  Acc: 0.4198
 Site-MNIST_M                       | Val  Loss: 1.9604 | Val  Acc: 0.4138
 Site-SVHN                          | Val  Loss: 2.2163 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5466
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8215
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8535
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4198
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4138
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.8333 | Train Acc: 0.8301
 Site-USPS                          | Train Loss: 0.7948 | Train Acc: 0.8611
 Site-SynthDigits                   | Train Loss: 1.8131 | Train Acc: 0.4186
 Site-MNIST_M                       | Train Loss: 1.9307 | Train Acc: 0.4347
 Site-SVHN                          | Train Loss: 2.2097 | Train Acc: 0.2179
Average Train Accuracy: 0.5525
 Site-MNIST                         | Val  Loss: 0.8085 | Val  Acc: 0.8384
 Site-USPS                          | Val  Loss: 0.8144 | Val  Acc: 0.8535
 Site-SynthDigits                   | Val  Loss: 2.0420 | Val  Acc: 0.4427
 Site-MNIST_M                       | Val  Loss: 1.9186 | Val  Acc: 0.4253
 Site-SVHN                          | Val  Loss: 2.2040 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5534
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8384
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8535
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4427
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4253
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.7580 | Train Acc: 0.8318
 Site-USPS                          | Train Loss: 0.7236 | Train Acc: 0.8662
 Site-SynthDigits                   | Train Loss: 1.7984 | Train Acc: 0.4186
 Site-MNIST_M                       | Train Loss: 1.9128 | Train Acc: 0.4375
 Site-SVHN                          | Train Loss: 2.1983 | Train Acc: 0.2051
Average Train Accuracy: 0.5518
 Site-MNIST                         | Val  Loss: 0.7385 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.7524 | Val  Acc: 0.8586
 Site-SynthDigits                   | Val  Loss: 2.0211 | Val  Acc: 0.4275
 Site-MNIST_M                       | Val  Loss: 1.8772 | Val  Acc: 0.4253
 Site-SVHN                          | Val  Loss: 2.1940 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5507
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.6893 | Train Acc: 0.8410
 Site-USPS                          | Train Loss: 0.6623 | Train Acc: 0.8699
 Site-SynthDigits                   | Train Loss: 1.7607 | Train Acc: 0.4280
 Site-MNIST_M                       | Train Loss: 1.8699 | Train Acc: 0.4574
 Site-SVHN                          | Train Loss: 2.1990 | Train Acc: 0.1966
Average Train Accuracy: 0.5586
 Site-MNIST                         | Val  Loss: 0.6677 | Val  Acc: 0.8418
 Site-USPS                          | Val  Loss: 0.7065 | Val  Acc: 0.8687
 Site-SynthDigits                   | Val  Loss: 2.0142 | Val  Acc: 0.4198
 Site-MNIST_M                       | Val  Loss: 1.8480 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1902 | Val  Acc: 0.1897
Average Valid Accuracy: 0.5513
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.6371 | Train Acc: 0.8478
 Site-USPS                          | Train Loss: 0.6179 | Train Acc: 0.8801
 Site-SynthDigits                   | Train Loss: 1.7314 | Train Acc: 0.4413
 Site-MNIST_M                       | Train Loss: 1.8280 | Train Acc: 0.4574
 Site-SVHN                          | Train Loss: 2.1807 | Train Acc: 0.2009
Average Train Accuracy: 0.5655
 Site-MNIST                         | Val  Loss: 0.6174 | Val  Acc: 0.8485
 Site-USPS                          | Val  Loss: 0.6625 | Val  Acc: 0.8687
 Site-SynthDigits                   | Val  Loss: 1.9948 | Val  Acc: 0.4275
 Site-MNIST_M                       | Val  Loss: 1.8188 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.1780 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5623
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8485
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8687
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4275
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4598
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.5931 | Train Acc: 0.8579
 Site-USPS                          | Train Loss: 0.5860 | Train Acc: 0.8838
 Site-SynthDigits                   | Train Loss: 1.7006 | Train Acc: 0.4451
 Site-MNIST_M                       | Train Loss: 1.8275 | Train Acc: 0.4631
 Site-SVHN                          | Train Loss: 2.1808 | Train Acc: 0.2051
Average Train Accuracy: 0.5710
 Site-MNIST                         | Val  Loss: 0.5682 | Val  Acc: 0.8620
 Site-USPS                          | Val  Loss: 0.6302 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9886 | Val  Acc: 0.4275
 Site-MNIST_M                       | Val  Loss: 1.7950 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.1718 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5680
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8620
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4275
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4598
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.5637 | Train Acc: 0.8612
 Site-USPS                          | Train Loss: 0.5473 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.6862 | Train Acc: 0.4697
 Site-MNIST_M                       | Train Loss: 1.7831 | Train Acc: 0.4830
 Site-SVHN                          | Train Loss: 2.1720 | Train Acc: 0.2051
Average Train Accuracy: 0.5811
 Site-MNIST                         | Val  Loss: 0.5360 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.5940 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.9625 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.7567 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1602 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5867
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8687
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.5057
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.5239 | Train Acc: 0.8638
 Site-USPS                          | Train Loss: 0.4992 | Train Acc: 0.8876
 Site-SynthDigits                   | Train Loss: 1.6627 | Train Acc: 0.4659
 Site-MNIST_M                       | Train Loss: 1.7584 | Train Acc: 0.4688
 Site-SVHN                          | Train Loss: 2.1735 | Train Acc: 0.1880
Average Train Accuracy: 0.5748
 Site-MNIST                         | Val  Loss: 0.4952 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.5694 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.9587 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.7384 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.1574 | Val  Acc: 0.1724
Average Valid Accuracy: 0.5752
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.5046 | Train Acc: 0.8663
 Site-USPS                          | Train Loss: 0.4808 | Train Acc: 0.8965
 Site-SynthDigits                   | Train Loss: 1.6599 | Train Acc: 0.4640
 Site-MNIST_M                       | Train Loss: 1.7304 | Train Acc: 0.4773
 Site-SVHN                          | Train Loss: 2.1648 | Train Acc: 0.1795
Average Train Accuracy: 0.5767
 Site-MNIST                         | Val  Loss: 0.4678 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.5514 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.9558 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.7149 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1498 | Val  Acc: 0.1724
Average Valid Accuracy: 0.5843
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.4664 | Train Acc: 0.8823
 Site-USPS                          | Train Loss: 0.4695 | Train Acc: 0.8952
 Site-SynthDigits                   | Train Loss: 1.5953 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.7301 | Train Acc: 0.4830
 Site-SVHN                          | Train Loss: 2.1586 | Train Acc: 0.1923
Average Train Accuracy: 0.5849
 Site-MNIST                         | Val  Loss: 0.4356 | Val  Acc: 0.8822
 Site-USPS                          | Val  Loss: 0.5346 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9598 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.6891 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1413 | Val  Acc: 0.1724
Average Valid Accuracy: 0.5845
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.4484 | Train Acc: 0.8898
 Site-USPS                          | Train Loss: 0.4527 | Train Acc: 0.8889
 Site-SynthDigits                   | Train Loss: 1.5787 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.6919 | Train Acc: 0.4943
 Site-SVHN                          | Train Loss: 2.1601 | Train Acc: 0.1966
Average Train Accuracy: 0.5894
 Site-MNIST                         | Val  Loss: 0.4157 | Val  Acc: 0.8822
 Site-USPS                          | Val  Loss: 0.5125 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.9555 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.6637 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.1400 | Val  Acc: 0.1897
Average Valid Accuracy: 0.5928
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8822
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4962
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.1897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.4234 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4203 | Train Acc: 0.9028
 Site-SynthDigits                   | Train Loss: 1.5819 | Train Acc: 0.4811
 Site-MNIST_M                       | Train Loss: 1.6858 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1521 | Train Acc: 0.2051
Average Train Accuracy: 0.5973
 Site-MNIST                         | Val  Loss: 0.3900 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4830 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.9523 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.6481 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.1323 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5996
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4962
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.4062 | Train Acc: 0.9008
 Site-USPS                          | Train Loss: 0.4139 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.5736 | Train Acc: 0.4886
 Site-MNIST_M                       | Train Loss: 1.6717 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.1457 | Train Acc: 0.2179
Average Train Accuracy: 0.6012
 Site-MNIST                         | Val  Loss: 0.3733 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.4838 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9269 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.6348 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1386 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6032
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5057
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.3950 | Train Acc: 0.9024
 Site-USPS                          | Train Loss: 0.3917 | Train Acc: 0.9053
 Site-SynthDigits                   | Train Loss: 1.5420 | Train Acc: 0.4924
 Site-MNIST_M                       | Train Loss: 1.6460 | Train Acc: 0.4943
 Site-SVHN                          | Train Loss: 2.1441 | Train Acc: 0.2179
Average Train Accuracy: 0.6025
 Site-MNIST                         | Val  Loss: 0.3615 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.4587 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9136 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.6175 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.1236 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5987
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.3649 | Train Acc: 0.9125
 Site-USPS                          | Train Loss: 0.3699 | Train Acc: 0.9116
 Site-SynthDigits                   | Train Loss: 1.5298 | Train Acc: 0.4962
 Site-MNIST_M                       | Train Loss: 1.6430 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 2.1354 | Train Acc: 0.2222
Average Train Accuracy: 0.6097
 Site-MNIST                         | Val  Loss: 0.3356 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.4479 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.9193 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.6085 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.1345 | Val  Acc: 0.2241
Average Valid Accuracy: 0.6079
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9259
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.3650 | Train Acc: 0.9108
 Site-USPS                          | Train Loss: 0.3552 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4969 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.6057 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1200 | Train Acc: 0.2265
Average Train Accuracy: 0.6099
 Site-MNIST                         | Val  Loss: 0.3348 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.4296 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8665 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.5825 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.1159 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6063
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.3384 | Train Acc: 0.9184
 Site-USPS                          | Train Loss: 0.3471 | Train Acc: 0.9141
 Site-SynthDigits                   | Train Loss: 1.5095 | Train Acc: 0.5038
 Site-MNIST_M                       | Train Loss: 1.6280 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 2.1194 | Train Acc: 0.2137
Average Train Accuracy: 0.6111
 Site-MNIST                         | Val  Loss: 0.3086 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.4176 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.8850 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.5786 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.1203 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6088
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5172
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.1897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.3238 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.3326 | Train Acc: 0.9217
 Site-SynthDigits                   | Train Loss: 1.4936 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.5970 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 2.1142 | Train Acc: 0.2308
Average Train Accuracy: 0.6174
 Site-MNIST                         | Val  Loss: 0.2957 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.4102 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8704 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.5590 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.1150 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6143
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.3125 | Train Acc: 0.9218
 Site-USPS                          | Train Loss: 0.3255 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.4597 | Train Acc: 0.4962
 Site-MNIST_M                       | Train Loss: 1.5661 | Train Acc: 0.5114
 Site-SVHN                          | Train Loss: 2.1223 | Train Acc: 0.2222
Average Train Accuracy: 0.6136
 Site-MNIST                         | Val  Loss: 0.2839 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.4057 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8585 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.5402 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.1072 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6110
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.3030 | Train Acc: 0.9184
 Site-USPS                          | Train Loss: 0.3071 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.4604 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.5836 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 2.1213 | Train Acc: 0.2350
Average Train Accuracy: 0.6164
 Site-MNIST                         | Val  Loss: 0.2741 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3883 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.8640 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.5479 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.1047 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6164
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9360
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.2971 | Train Acc: 0.9193
 Site-USPS                          | Train Loss: 0.3063 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.4562 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.5715 | Train Acc: 0.5227
 Site-SVHN                          | Train Loss: 2.1079 | Train Acc: 0.2479
Average Train Accuracy: 0.6240
 Site-MNIST                         | Val  Loss: 0.2673 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3815 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.8625 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.5182 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.1051 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6168
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9360
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.1897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.2820 | Train Acc: 0.9260
 Site-USPS                          | Train Loss: 0.2990 | Train Acc: 0.9205
 Site-SynthDigits                   | Train Loss: 1.4223 | Train Acc: 0.5095
 Site-MNIST_M                       | Train Loss: 1.5338 | Train Acc: 0.5341
 Site-SVHN                          | Train Loss: 2.1206 | Train Acc: 0.2265
Average Train Accuracy: 0.6233
 Site-MNIST                         | Val  Loss: 0.2543 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3680 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8385 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.5047 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0934 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6143
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.2741 | Train Acc: 0.9294
 Site-USPS                          | Train Loss: 0.2923 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.4242 | Train Acc: 0.5152
 Site-MNIST_M                       | Train Loss: 1.5213 | Train Acc: 0.5426
 Site-SVHN                          | Train Loss: 2.1274 | Train Acc: 0.2222
Average Train Accuracy: 0.6265
 Site-MNIST                         | Val  Loss: 0.2438 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3748 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.8391 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.4822 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0973 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6172
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.1897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.2671 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2716 | Train Acc: 0.9268
 Site-SynthDigits                   | Train Loss: 1.4159 | Train Acc: 0.5133
 Site-MNIST_M                       | Train Loss: 1.5102 | Train Acc: 0.5483
 Site-SVHN                          | Train Loss: 2.1248 | Train Acc: 0.2308
Average Train Accuracy: 0.6299
 Site-MNIST                         | Val  Loss: 0.2395 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3587 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.8127 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.4701 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0972 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6213
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9562
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.1897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.2545 | Train Acc: 0.9336
 Site-USPS                          | Train Loss: 0.2726 | Train Acc: 0.9331
 Site-SynthDigits                   | Train Loss: 1.4232 | Train Acc: 0.5189
 Site-MNIST_M                       | Train Loss: 1.5152 | Train Acc: 0.5540
 Site-SVHN                          | Train Loss: 2.0977 | Train Acc: 0.2308
Average Train Accuracy: 0.6341
 Site-MNIST                         | Val  Loss: 0.2290 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3526 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.8158 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.4791 | Val  Acc: 0.5747
 Site-SVHN                          | Val  Loss: 2.0997 | Val  Acc: 0.1724
Average Valid Accuracy: 0.6295
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5267
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5747
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.2435 | Train Acc: 0.9369
 Site-USPS                          | Train Loss: 0.2648 | Train Acc: 0.9280
 Site-SynthDigits                   | Train Loss: 1.3934 | Train Acc: 0.5208
 Site-MNIST_M                       | Train Loss: 1.5205 | Train Acc: 0.5398
 Site-SVHN                          | Train Loss: 2.1097 | Train Acc: 0.2350
Average Train Accuracy: 0.6321
 Site-MNIST                         | Val  Loss: 0.2185 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.3498 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.8246 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.4773 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.1045 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6211
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.2450 | Train Acc: 0.9336
 Site-USPS                          | Train Loss: 0.2520 | Train Acc: 0.9369
 Site-SynthDigits                   | Train Loss: 1.3683 | Train Acc: 0.5284
 Site-MNIST_M                       | Train Loss: 1.4895 | Train Acc: 0.5682
 Site-SVHN                          | Train Loss: 2.1019 | Train Acc: 0.2350
Average Train Accuracy: 0.6404
 Site-MNIST                         | Val  Loss: 0.2178 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3383 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.7783 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.4583 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0902 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6336
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9192
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5191
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5632
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.2312 | Train Acc: 0.9420
 Site-USPS                          | Train Loss: 0.2490 | Train Acc: 0.9343
 Site-SynthDigits                   | Train Loss: 1.3892 | Train Acc: 0.5284
 Site-MNIST_M                       | Train Loss: 1.4936 | Train Acc: 0.5483
 Site-SVHN                          | Train Loss: 2.0855 | Train Acc: 0.2393
Average Train Accuracy: 0.6385
 Site-MNIST                         | Val  Loss: 0.2039 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3337 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7887 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.4668 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0890 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6331
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.2317 | Train Acc: 0.9411
 Site-USPS                          | Train Loss: 0.2406 | Train Acc: 0.9369
 Site-SynthDigits                   | Train Loss: 1.3568 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.4966 | Train Acc: 0.5540
 Site-SVHN                          | Train Loss: 2.1023 | Train Acc: 0.2393
Average Train Accuracy: 0.6422
 Site-MNIST                         | Val  Loss: 0.2029 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3267 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.7688 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.4511 | Val  Acc: 0.5747
 Site-SVHN                          | Val  Loss: 2.0852 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6349
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.5191
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5747
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.2168 | Train Acc: 0.9437
 Site-USPS                          | Train Loss: 0.2455 | Train Acc: 0.9369
 Site-SynthDigits                   | Train Loss: 1.3438 | Train Acc: 0.5189
 Site-MNIST_M                       | Train Loss: 1.4791 | Train Acc: 0.5597
 Site-SVHN                          | Train Loss: 2.1045 | Train Acc: 0.2308
Average Train Accuracy: 0.6380
 Site-MNIST                         | Val  Loss: 0.1922 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3263 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7889 | Val  Acc: 0.4885
 Site-MNIST_M                       | Val  Loss: 1.4206 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0845 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6257
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.2129 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.2326 | Train Acc: 0.9381
 Site-SynthDigits                   | Train Loss: 1.3819 | Train Acc: 0.5265
 Site-MNIST_M                       | Train Loss: 1.4725 | Train Acc: 0.5426
 Site-SVHN                          | Train Loss: 2.0903 | Train Acc: 0.2179
Average Train Accuracy: 0.6349
 Site-MNIST                         | Val  Loss: 0.1860 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3162 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.7955 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.4443 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0886 | Val  Acc: 0.1724
Average Valid Accuracy: 0.6233
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.2093 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.2258 | Train Acc: 0.9381
 Site-SynthDigits                   | Train Loss: 1.3727 | Train Acc: 0.5265
 Site-MNIST_M                       | Train Loss: 1.4421 | Train Acc: 0.5426
 Site-SVHN                          | Train Loss: 2.0926 | Train Acc: 0.2265
Average Train Accuracy: 0.6360
 Site-MNIST                         | Val  Loss: 0.1854 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.3178 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.7597 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.4223 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0858 | Val  Acc: 0.1897
Average Valid Accuracy: 0.6258
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.2025 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.2218 | Train Acc: 0.9419
 Site-SynthDigits                   | Train Loss: 1.3231 | Train Acc: 0.5379
 Site-MNIST_M                       | Train Loss: 1.4548 | Train Acc: 0.5540
 Site-SVHN                          | Train Loss: 2.1164 | Train Acc: 0.2222
Average Train Accuracy: 0.6411
 Site-MNIST                         | Val  Loss: 0.1774 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3063 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7796 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.4175 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0805 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6353
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5191
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5632
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1978 | Train Acc: 0.9470
 Site-USPS                          | Train Loss: 0.2228 | Train Acc: 0.9407
 Site-SynthDigits                   | Train Loss: 1.2939 | Train Acc: 0.5492
 Site-MNIST_M                       | Train Loss: 1.4472 | Train Acc: 0.5540
 Site-SVHN                          | Train Loss: 2.0983 | Train Acc: 0.2350
Average Train Accuracy: 0.6452
 Site-MNIST                         | Val  Loss: 0.1746 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2996 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7801 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.4116 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0741 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6348
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1936 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.2168 | Train Acc: 0.9419
 Site-SynthDigits                   | Train Loss: 1.3371 | Train Acc: 0.5473
 Site-MNIST_M                       | Train Loss: 1.4400 | Train Acc: 0.5682
 Site-SVHN                          | Train Loss: 2.0956 | Train Acc: 0.2393
Average Train Accuracy: 0.6493
 Site-MNIST                         | Val  Loss: 0.1708 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2988 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7315 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.3794 | Val  Acc: 0.5747
 Site-SVHN                          | Val  Loss: 2.0764 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6420
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9697
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5747
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1962 | Train Acc: 0.9529
 Site-USPS                          | Train Loss: 0.2064 | Train Acc: 0.9444
 Site-SynthDigits                   | Train Loss: 1.3051 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.4306 | Train Acc: 0.5767
 Site-SVHN                          | Train Loss: 2.0899 | Train Acc: 0.2564
Average Train Accuracy: 0.6582
 Site-MNIST                         | Val  Loss: 0.1720 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2936 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.7059 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.3801 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 2.0639 | Val  Acc: 0.2241
Average Valid Accuracy: 0.6499
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9731
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5420
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1934 | Train Acc: 0.9512
 Site-USPS                          | Train Loss: 0.2051 | Train Acc: 0.9432
 Site-SynthDigits                   | Train Loss: 1.3292 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.4410 | Train Acc: 0.5653
 Site-SVHN                          | Train Loss: 2.0904 | Train Acc: 0.2607
Average Train Accuracy: 0.6562
 Site-MNIST                         | Val  Loss: 0.1666 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2835 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.7157 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.3698 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 2.0684 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6508
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9293
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1830 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2022 | Train Acc: 0.9482
 Site-SynthDigits                   | Train Loss: 1.2935 | Train Acc: 0.5644
 Site-MNIST_M                       | Train Loss: 1.4194 | Train Acc: 0.5625
 Site-SVHN                          | Train Loss: 2.0680 | Train Acc: 0.2436
Average Train Accuracy: 0.6555
 Site-MNIST                         | Val  Loss: 0.1582 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2863 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.7043 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.3806 | Val  Acc: 0.5747
 Site-SVHN                          | Val  Loss: 2.0571 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6450
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1746 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2034 | Train Acc: 0.9457
 Site-SynthDigits                   | Train Loss: 1.2772 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.4048 | Train Acc: 0.5710
 Site-SVHN                          | Train Loss: 2.0844 | Train Acc: 0.2393
Average Train Accuracy: 0.6549
 Site-MNIST                         | Val  Loss: 0.1525 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2759 | Val  Acc: 0.9293
 Site-SynthDigits                   | Val  Loss: 1.6905 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.3621 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0553 | Val  Acc: 0.2069
Average Valid Accuracy: 0.6399
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1730 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.1963 | Train Acc: 0.9470
 Site-SynthDigits                   | Train Loss: 1.2773 | Train Acc: 0.5663
 Site-MNIST_M                       | Train Loss: 1.4010 | Train Acc: 0.5710
 Site-SVHN                          | Train Loss: 2.0735 | Train Acc: 0.2607
Average Train Accuracy: 0.6606
 Site-MNIST                         | Val  Loss: 0.1498 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2740 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6925 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.3502 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 2.0557 | Val  Acc: 0.2241
Average Valid Accuracy: 0.6538
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9697
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9394
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5496
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1674 | Train Acc: 0.9605
 Site-USPS                          | Train Loss: 0.1838 | Train Acc: 0.9508
 Site-SynthDigits                   | Train Loss: 1.2606 | Train Acc: 0.5720
 Site-MNIST_M                       | Train Loss: 1.3988 | Train Acc: 0.5852
 Site-SVHN                          | Train Loss: 2.0773 | Train Acc: 0.2564
Average Train Accuracy: 0.6650
 Site-MNIST                         | Val  Loss: 0.1470 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2678 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6598 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.3515 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 2.0527 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6603
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9697
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9394
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5649
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedavg...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1654 | Train Acc: 0.9622
 Site-USPS                          | Train Loss: 0.1838 | Train Acc: 0.9508
 Site-SynthDigits                   | Train Loss: 1.2744 | Train Acc: 0.5663
 Site-MNIST_M                       | Train Loss: 1.3931 | Train Acc: 0.5739
 Site-SVHN                          | Train Loss: 2.0769 | Train Acc: 0.2821
Average Train Accuracy: 0.6670
 Site-MNIST                         | Val  Loss: 0.1410 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2735 | Val  Acc: 0.9343
 Site-SynthDigits                   | Val  Loss: 1.6716 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.3460 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 2.0474 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6600
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1642 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1872 | Train Acc: 0.9495
 Site-SynthDigits                   | Train Loss: 1.2716 | Train Acc: 0.5701
 Site-MNIST_M                       | Train Loss: 1.3913 | Train Acc: 0.5710
 Site-SVHN                          | Train Loss: 2.0918 | Train Acc: 0.2564
Average Train Accuracy: 0.6613
 Site-MNIST                         | Val  Loss: 0.1404 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2654 | Val  Acc: 0.9343
 Site-SynthDigits                   | Val  Loss: 1.6652 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.3558 | Val  Acc: 0.5747
 Site-SVHN                          | Val  Loss: 2.0540 | Val  Acc: 0.2241
Average Valid Accuracy: 0.6542
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1586 | Train Acc: 0.9647
 Site-USPS                          | Train Loss: 0.1809 | Train Acc: 0.9482
 Site-SynthDigits                   | Train Loss: 1.2554 | Train Acc: 0.5777
 Site-MNIST_M                       | Train Loss: 1.3546 | Train Acc: 0.5824
 Site-SVHN                          | Train Loss: 2.0884 | Train Acc: 0.2607
Average Train Accuracy: 0.6667
 Site-MNIST                         | Val  Loss: 0.1344 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2611 | Val  Acc: 0.9343
 Site-SynthDigits                   | Val  Loss: 1.6469 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.3203 | Val  Acc: 0.5977
 Site-SVHN                          | Val  Loss: 2.0428 | Val  Acc: 0.2241
Average Valid Accuracy: 0.6588
===2023-07-02 13:48:39===
===2023-07-02 13:48:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:46 | Test Acc: 0.9243
 Test site-USPS                      | Epoch:46 | Test Acc: 0.9269
 Test site-SynthDigits               | Epoch:46 | Test Acc: 0.5599
 Test site-MNIST_M                   | Epoch:46 | Test Acc: 0.4191
 Test site-SVHN                      | Epoch:46 | Test Acc: 0.2784
MNIST: 0.9243, USPS: 0.9269, SynthDigits: 0.5599, MNIST_M: 0.4191, SVHN: 0.2784, 
Average Test Accuracy(group): 0.6217, Average Test Accuracy(individual): 0.6217,
domain std=0.2636, cluster std=-1.0000, individual std=0.2636, 
