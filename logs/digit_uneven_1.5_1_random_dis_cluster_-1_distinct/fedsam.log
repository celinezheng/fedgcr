===2023-07-02 17:53:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 0.9732 | Train Acc: 0.8133
 Site-USPS                          | Train Loss: 1.0097 | Train Acc: 0.7210
 Site-SynthDigits                   | Train Loss: 2.0229 | Train Acc: 0.2614
 Site-MNIST_M                       | Train Loss: 2.0886 | Train Acc: 0.2983
 Site-SVHN                          | Train Loss: 2.2510 | Train Acc: 0.1282
Average Train Accuracy: 0.4444
 Site-MNIST                         | Val  Loss: 0.9612 | Val  Acc: 0.7912
 Site-USPS                          | Val  Loss: 1.0138 | Val  Acc: 0.7071
 Site-SynthDigits                   | Val  Loss: 2.2266 | Val  Acc: 0.2901
 Site-MNIST_M                       | Val  Loss: 2.0830 | Val  Acc: 0.3103
 Site-SVHN                          | Val  Loss: 2.2567 | Val  Acc: 0.1552
Average Valid Accuracy: 0.4508
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7912
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7071
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2901
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3103
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.6495 | Train Acc: 0.8082
 Site-USPS                          | Train Loss: 0.5867 | Train Acc: 0.8497
 Site-SynthDigits                   | Train Loss: 1.7580 | Train Acc: 0.4034
 Site-MNIST_M                       | Train Loss: 1.8700 | Train Acc: 0.3977
 Site-SVHN                          | Train Loss: 2.2187 | Train Acc: 0.1581
Average Train Accuracy: 0.5234
 Site-MNIST                         | Val  Loss: 0.6390 | Val  Acc: 0.7946
 Site-USPS                          | Val  Loss: 0.6184 | Val  Acc: 0.8586
 Site-SynthDigits                   | Val  Loss: 2.0686 | Val  Acc: 0.4351
 Site-MNIST_M                       | Val  Loss: 1.8412 | Val  Acc: 0.4023
 Site-SVHN                          | Val  Loss: 2.1611 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5429
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7946
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8586
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4351
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4023
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.4408 | Train Acc: 0.8764
 Site-USPS                          | Train Loss: 0.4648 | Train Acc: 0.8674
 Site-SynthDigits                   | Train Loss: 1.6622 | Train Acc: 0.4545
 Site-MNIST_M                       | Train Loss: 1.8159 | Train Acc: 0.4261
 Site-SVHN                          | Train Loss: 2.1984 | Train Acc: 0.2094
Average Train Accuracy: 0.5668
 Site-MNIST                         | Val  Loss: 0.4364 | Val  Acc: 0.8552
 Site-USPS                          | Val  Loss: 0.5214 | Val  Acc: 0.8535
 Site-SynthDigits                   | Val  Loss: 1.9971 | Val  Acc: 0.4504
 Site-MNIST_M                       | Val  Loss: 1.7937 | Val  Acc: 0.4368
 Site-SVHN                          | Val  Loss: 2.1162 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5675
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8552
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8535
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4504
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4368
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.3541 | Train Acc: 0.9016
 Site-USPS                          | Train Loss: 0.4490 | Train Acc: 0.8624
 Site-SynthDigits                   | Train Loss: 1.5738 | Train Acc: 0.4735
 Site-MNIST_M                       | Train Loss: 1.7328 | Train Acc: 0.4489
 Site-SVHN                          | Train Loss: 2.1841 | Train Acc: 0.2137
Average Train Accuracy: 0.5800
 Site-MNIST                         | Val  Loss: 0.3341 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.4955 | Val  Acc: 0.8384
 Site-SynthDigits                   | Val  Loss: 2.0003 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.6823 | Val  Acc: 0.4828
 Site-SVHN                          | Val  Loss: 2.1087 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5940
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9091
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8384
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4828
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.2945 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3427 | Train Acc: 0.9053
 Site-SynthDigits                   | Train Loss: 1.5157 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.6818 | Train Acc: 0.4688
 Site-SVHN                          | Train Loss: 2.1366 | Train Acc: 0.2607
Average Train Accuracy: 0.6114
 Site-MNIST                         | Val  Loss: 0.2885 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.3931 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8911 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.6150 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.0593 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6256
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.2491 | Train Acc: 0.9310
 Site-USPS                          | Train Loss: 0.2880 | Train Acc: 0.9381
 Site-SynthDigits                   | Train Loss: 1.5037 | Train Acc: 0.5114
 Site-MNIST_M                       | Train Loss: 1.6097 | Train Acc: 0.4716
 Site-SVHN                          | Train Loss: 2.1455 | Train Acc: 0.2436
Average Train Accuracy: 0.6191
 Site-MNIST                         | Val  Loss: 0.2377 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3411 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.8727 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.5487 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0523 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6377
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9360
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9192
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.2209 | Train Acc: 0.9420
 Site-USPS                          | Train Loss: 0.2615 | Train Acc: 0.9369
 Site-SynthDigits                   | Train Loss: 1.3508 | Train Acc: 0.5322
 Site-MNIST_M                       | Train Loss: 1.5669 | Train Acc: 0.5028
 Site-SVHN                          | Train Loss: 2.1430 | Train Acc: 0.2479
Average Train Accuracy: 0.6323
 Site-MNIST                         | Val  Loss: 0.2069 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3259 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.7674 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.4868 | Val  Acc: 0.5402
 Site-SVHN                          | Val  Loss: 2.0587 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6465
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9495
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9192
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5649
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5402
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.2011 | Train Acc: 0.9529
 Site-USPS                          | Train Loss: 0.2628 | Train Acc: 0.9293
 Site-SynthDigits                   | Train Loss: 1.3101 | Train Acc: 0.5492
 Site-MNIST_M                       | Train Loss: 1.5508 | Train Acc: 0.5085
 Site-SVHN                          | Train Loss: 2.1216 | Train Acc: 0.2607
Average Train Accuracy: 0.6401
 Site-MNIST                         | Val  Loss: 0.1830 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3277 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.7263 | Val  Acc: 0.5802
 Site-MNIST_M                       | Val  Loss: 1.4817 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0020 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6614
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9562
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5802
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5632
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.1654 | Train Acc: 0.9613
 Site-USPS                          | Train Loss: 0.2426 | Train Acc: 0.9268
 Site-SynthDigits                   | Train Loss: 1.2809 | Train Acc: 0.5777
 Site-MNIST_M                       | Train Loss: 1.4687 | Train Acc: 0.5284
 Site-SVHN                          | Train Loss: 2.0910 | Train Acc: 0.2564
Average Train Accuracy: 0.6501
 Site-MNIST                         | Val  Loss: 0.1554 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3057 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.6702 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.4074 | Val  Acc: 0.5977
 Site-SVHN                          | Val  Loss: 2.0270 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6781
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6260
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5977
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.1459 | Train Acc: 0.9647
 Site-USPS                          | Train Loss: 0.2350 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.3361 | Train Acc: 0.5701
 Site-MNIST_M                       | Train Loss: 1.4533 | Train Acc: 0.5284
 Site-SVHN                          | Train Loss: 2.1269 | Train Acc: 0.2692
Average Train Accuracy: 0.6528
 Site-MNIST                         | Val  Loss: 0.1341 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2857 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.6716 | Val  Acc: 0.5954
 Site-MNIST_M                       | Val  Loss: 1.3771 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0210 | Val  Acc: 0.3621
Average Valid Accuracy: 0.6796
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9697
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9192
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5954
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.5517
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3621
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.1465 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1892 | Train Acc: 0.9545
 Site-SynthDigits                   | Train Loss: 1.2276 | Train Acc: 0.5871
 Site-MNIST_M                       | Train Loss: 1.3669 | Train Acc: 0.5597
 Site-SVHN                          | Train Loss: 2.1058 | Train Acc: 0.2863
Average Train Accuracy: 0.6695
 Site-MNIST                         | Val  Loss: 0.1351 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2361 | Val  Acc: 0.9444
 Site-SynthDigits                   | Val  Loss: 1.7095 | Val  Acc: 0.6336
 Site-MNIST_M                       | Val  Loss: 1.3131 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 2.0359 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6778
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.1275 | Train Acc: 0.9655
 Site-USPS                          | Train Loss: 0.1721 | Train Acc: 0.9508
 Site-SynthDigits                   | Train Loss: 1.2228 | Train Acc: 0.5890
 Site-MNIST_M                       | Train Loss: 1.3563 | Train Acc: 0.5653
 Site-SVHN                          | Train Loss: 2.0896 | Train Acc: 0.2778
Average Train Accuracy: 0.6697
 Site-MNIST                         | Val  Loss: 0.1198 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2205 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6110 | Val  Acc: 0.6031
 Site-MNIST_M                       | Val  Loss: 1.2722 | Val  Acc: 0.6092
 Site-SVHN                          | Val  Loss: 2.0353 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6905
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9731
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9394
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6031
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.6092
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.1161 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.1862 | Train Acc: 0.9495
 Site-SynthDigits                   | Train Loss: 1.1520 | Train Acc: 0.6004
 Site-MNIST_M                       | Train Loss: 1.3439 | Train Acc: 0.5597
 Site-SVHN                          | Train Loss: 2.0946 | Train Acc: 0.2906
Average Train Accuracy: 0.6745
 Site-MNIST                         | Val  Loss: 0.1146 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2278 | Val  Acc: 0.9343
 Site-SynthDigits                   | Val  Loss: 1.5202 | Val  Acc: 0.6412
 Site-MNIST_M                       | Val  Loss: 1.2691 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 2.0238 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6815
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.1094 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.1516 | Train Acc: 0.9596
 Site-SynthDigits                   | Train Loss: 1.1275 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.3301 | Train Acc: 0.5426
 Site-SVHN                          | Train Loss: 2.0816 | Train Acc: 0.2906
Average Train Accuracy: 0.6773
 Site-MNIST                         | Val  Loss: 0.1101 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2137 | Val  Acc: 0.9596
 Site-SynthDigits                   | Val  Loss: 1.4987 | Val  Acc: 0.6489
 Site-MNIST_M                       | Val  Loss: 1.2443 | Val  Acc: 0.5747
 Site-SVHN                          | Val  Loss: 2.0318 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6920
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9663
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9596
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6489
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5747
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.0956 | Train Acc: 0.9773
 Site-USPS                          | Train Loss: 0.1328 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 1.1216 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.3221 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 2.0859 | Train Acc: 0.3077
Average Train Accuracy: 0.6854
 Site-MNIST                         | Val  Loss: 0.0953 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2078 | Val  Acc: 0.9545
 Site-SynthDigits                   | Val  Loss: 1.4368 | Val  Acc: 0.6412
 Site-MNIST_M                       | Val  Loss: 1.2196 | Val  Acc: 0.5977
 Site-SVHN                          | Val  Loss: 1.9993 | Val  Acc: 0.3621
Average Valid Accuracy: 0.7057
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9731
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9545
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6412
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5977
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3621
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.0861 | Train Acc: 0.9798
 Site-USPS                          | Train Loss: 0.1451 | Train Acc: 0.9609
 Site-SynthDigits                   | Train Loss: 1.0525 | Train Acc: 0.6420
 Site-MNIST_M                       | Train Loss: 1.2874 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 2.0780 | Train Acc: 0.2863
Average Train Accuracy: 0.6852
 Site-MNIST                         | Val  Loss: 0.0903 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.1872 | Val  Acc: 0.9545
 Site-SynthDigits                   | Val  Loss: 1.3226 | Val  Acc: 0.6794
 Site-MNIST_M                       | Val  Loss: 1.2260 | Val  Acc: 0.5747
 Site-SVHN                          | Val  Loss: 2.0094 | Val  Acc: 0.3276
Average Valid Accuracy: 0.7019
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.0827 | Train Acc: 0.9849
 Site-USPS                          | Train Loss: 0.1300 | Train Acc: 0.9621
 Site-SynthDigits                   | Train Loss: 1.0583 | Train Acc: 0.6307
 Site-MNIST_M                       | Train Loss: 1.2669 | Train Acc: 0.5625
 Site-SVHN                          | Train Loss: 2.0337 | Train Acc: 0.3333
Average Train Accuracy: 0.6947
 Site-MNIST                         | Val  Loss: 0.0795 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1786 | Val  Acc: 0.9444
 Site-SynthDigits                   | Val  Loss: 1.4434 | Val  Acc: 0.6641
 Site-MNIST_M                       | Val  Loss: 1.2016 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 1.9131 | Val  Acc: 0.3621
Average Valid Accuracy: 0.7080
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9832
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9444
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.6641
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3621
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.0723 | Train Acc: 0.9891
 Site-USPS                          | Train Loss: 0.1410 | Train Acc: 0.9583
 Site-SynthDigits                   | Train Loss: 1.0696 | Train Acc: 0.6326
 Site-MNIST_M                       | Train Loss: 1.2323 | Train Acc: 0.5767
 Site-SVHN                          | Train Loss: 2.0123 | Train Acc: 0.3162
Average Train Accuracy: 0.6946
 Site-MNIST                         | Val  Loss: 0.0685 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1774 | Val  Acc: 0.9444
 Site-SynthDigits                   | Val  Loss: 1.4503 | Val  Acc: 0.6565
 Site-MNIST_M                       | Val  Loss: 1.1794 | Val  Acc: 0.6207
 Site-SVHN                          | Val  Loss: 1.8955 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7182
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9899
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9444
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6565
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.6207
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.0682 | Train Acc: 0.9882
 Site-USPS                          | Train Loss: 0.1179 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 0.9989 | Train Acc: 0.6439
 Site-MNIST_M                       | Train Loss: 1.2169 | Train Acc: 0.5938
 Site-SVHN                          | Train Loss: 2.0450 | Train Acc: 0.3248
Average Train Accuracy: 0.7033
 Site-MNIST                         | Val  Loss: 0.0660 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1766 | Val  Acc: 0.9596
 Site-SynthDigits                   | Val  Loss: 1.4328 | Val  Acc: 0.6565
 Site-MNIST_M                       | Val  Loss: 1.1174 | Val  Acc: 0.6207
 Site-SVHN                          | Val  Loss: 1.9163 | Val  Acc: 0.3966
Average Valid Accuracy: 0.7233
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9832
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9596
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.6565
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.6207
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.0640 | Train Acc: 0.9916
 Site-USPS                          | Train Loss: 0.1131 | Train Acc: 0.9609
 Site-SynthDigits                   | Train Loss: 0.9867 | Train Acc: 0.6723
 Site-MNIST_M                       | Train Loss: 1.2228 | Train Acc: 0.5938
 Site-SVHN                          | Train Loss: 1.9989 | Train Acc: 0.3120
Average Train Accuracy: 0.7061
 Site-MNIST                         | Val  Loss: 0.0615 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1653 | Val  Acc: 0.9495
 Site-SynthDigits                   | Val  Loss: 1.3629 | Val  Acc: 0.6947
 Site-MNIST_M                       | Val  Loss: 1.1047 | Val  Acc: 0.6322
 Site-SVHN                          | Val  Loss: 1.9166 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7395
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9899
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9495
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6947
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.6322
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.4310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.0613 | Train Acc: 0.9924
 Site-USPS                          | Train Loss: 0.1067 | Train Acc: 0.9672
 Site-SynthDigits                   | Train Loss: 0.9635 | Train Acc: 0.6818
 Site-MNIST_M                       | Train Loss: 1.1968 | Train Acc: 0.6165
 Site-SVHN                          | Train Loss: 2.0449 | Train Acc: 0.3248
Average Train Accuracy: 0.7165
 Site-MNIST                         | Val  Loss: 0.0597 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1464 | Val  Acc: 0.9596
 Site-SynthDigits                   | Val  Loss: 1.3313 | Val  Acc: 0.6870
 Site-MNIST_M                       | Val  Loss: 1.0624 | Val  Acc: 0.6322
 Site-SVHN                          | Val  Loss: 1.9523 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7296
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.0607 | Train Acc: 0.9899
 Site-USPS                          | Train Loss: 0.1165 | Train Acc: 0.9672
 Site-SynthDigits                   | Train Loss: 0.9824 | Train Acc: 0.6705
 Site-MNIST_M                       | Train Loss: 1.1725 | Train Acc: 0.5881
 Site-SVHN                          | Train Loss: 2.0285 | Train Acc: 0.3205
Average Train Accuracy: 0.7072
 Site-MNIST                         | Val  Loss: 0.0622 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1567 | Val  Acc: 0.9596
 Site-SynthDigits                   | Val  Loss: 1.3518 | Val  Acc: 0.6794
 Site-MNIST_M                       | Val  Loss: 1.1011 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 1.8941 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7223
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.0515 | Train Acc: 0.9933
 Site-USPS                          | Train Loss: 0.1000 | Train Acc: 0.9697
 Site-SynthDigits                   | Train Loss: 0.9241 | Train Acc: 0.6875
 Site-MNIST_M                       | Train Loss: 1.1390 | Train Acc: 0.6136
 Site-SVHN                          | Train Loss: 2.0235 | Train Acc: 0.3291
Average Train Accuracy: 0.7186
 Site-MNIST                         | Val  Loss: 0.0529 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1376 | Val  Acc: 0.9545
 Site-SynthDigits                   | Val  Loss: 1.3130 | Val  Acc: 0.6947
 Site-MNIST_M                       | Val  Loss: 1.0863 | Val  Acc: 0.6207
 Site-SVHN                          | Val  Loss: 1.9327 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7382
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.0468 | Train Acc: 0.9941
 Site-USPS                          | Train Loss: 0.0965 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 0.9882 | Train Acc: 0.6951
 Site-MNIST_M                       | Train Loss: 1.1115 | Train Acc: 0.6449
 Site-SVHN                          | Train Loss: 1.9892 | Train Acc: 0.3291
Average Train Accuracy: 0.7271
 Site-MNIST                         | Val  Loss: 0.0468 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1381 | Val  Acc: 0.9646
 Site-SynthDigits                   | Val  Loss: 1.2505 | Val  Acc: 0.6947
 Site-MNIST_M                       | Val  Loss: 1.0416 | Val  Acc: 0.6552
 Site-SVHN                          | Val  Loss: 1.8747 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7512
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9646
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.6947
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.6552
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.0455 | Train Acc: 0.9933
 Site-USPS                          | Train Loss: 0.0989 | Train Acc: 0.9710
 Site-SynthDigits                   | Train Loss: 0.9265 | Train Acc: 0.6951
 Site-MNIST_M                       | Train Loss: 1.1084 | Train Acc: 0.6250
 Site-SVHN                          | Train Loss: 2.0199 | Train Acc: 0.3333
Average Train Accuracy: 0.7235
 Site-MNIST                         | Val  Loss: 0.0436 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1229 | Val  Acc: 0.9646
 Site-SynthDigits                   | Val  Loss: 1.3084 | Val  Acc: 0.7099
 Site-MNIST_M                       | Val  Loss: 1.0440 | Val  Acc: 0.5977
 Site-SVHN                          | Val  Loss: 1.8964 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7352
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.0441 | Train Acc: 0.9941
 Site-USPS                          | Train Loss: 0.0831 | Train Acc: 0.9773
 Site-SynthDigits                   | Train Loss: 0.8844 | Train Acc: 0.7254
 Site-MNIST_M                       | Train Loss: 1.0870 | Train Acc: 0.6392
 Site-SVHN                          | Train Loss: 1.9943 | Train Acc: 0.3419
Average Train Accuracy: 0.7356
 Site-MNIST                         | Val  Loss: 0.0433 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1046 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.1474 | Val  Acc: 0.7099
 Site-MNIST_M                       | Val  Loss: 1.0429 | Val  Acc: 0.6322
 Site-SVHN                          | Val  Loss: 1.8658 | Val  Acc: 0.3966
Average Valid Accuracy: 0.7397
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.0449 | Train Acc: 0.9916
 Site-USPS                          | Train Loss: 0.0759 | Train Acc: 0.9747
 Site-SynthDigits                   | Train Loss: 0.9170 | Train Acc: 0.7216
 Site-MNIST_M                       | Train Loss: 1.0782 | Train Acc: 0.6449
 Site-SVHN                          | Train Loss: 1.9513 | Train Acc: 0.3718
Average Train Accuracy: 0.7409
 Site-MNIST                         | Val  Loss: 0.0408 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1047 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.3030 | Val  Acc: 0.7252
 Site-MNIST_M                       | Val  Loss: 1.0570 | Val  Acc: 0.6207
 Site-SVHN                          | Val  Loss: 1.8631 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7480
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.0346 | Train Acc: 0.9941
 Site-USPS                          | Train Loss: 0.0902 | Train Acc: 0.9747
 Site-SynthDigits                   | Train Loss: 0.8584 | Train Acc: 0.7254
 Site-MNIST_M                       | Train Loss: 1.0650 | Train Acc: 0.6477
 Site-SVHN                          | Train Loss: 1.9808 | Train Acc: 0.3333
Average Train Accuracy: 0.7351
 Site-MNIST                         | Val  Loss: 0.0326 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1093 | Val  Acc: 0.9646
 Site-SynthDigits                   | Val  Loss: 1.1695 | Val  Acc: 0.7252
 Site-MNIST_M                       | Val  Loss: 1.0325 | Val  Acc: 0.6437
 Site-SVHN                          | Val  Loss: 1.8556 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7474
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.0372 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0748 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 0.8594 | Train Acc: 0.7254
 Site-MNIST_M                       | Train Loss: 1.0478 | Train Acc: 0.6676
 Site-SVHN                          | Train Loss: 1.9913 | Train Acc: 0.3291
Average Train Accuracy: 0.7378
 Site-MNIST                         | Val  Loss: 0.0348 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1087 | Val  Acc: 0.9646
 Site-SynthDigits                   | Val  Loss: 1.1771 | Val  Acc: 0.7099
 Site-MNIST_M                       | Val  Loss: 1.0054 | Val  Acc: 0.6552
 Site-SVHN                          | Val  Loss: 1.8744 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7543
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9646
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.7099
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.6552
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.0338 | Train Acc: 0.9958
 Site-USPS                          | Train Loss: 0.0713 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 0.8201 | Train Acc: 0.7311
 Site-MNIST_M                       | Train Loss: 1.0148 | Train Acc: 0.6932
 Site-SVHN                          | Train Loss: 1.9666 | Train Acc: 0.3504
Average Train Accuracy: 0.7485
 Site-MNIST                         | Val  Loss: 0.0338 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.0867 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.1556 | Val  Acc: 0.7176
 Site-MNIST_M                       | Val  Loss: 1.0024 | Val  Acc: 0.6782
 Site-SVHN                          | Val  Loss: 1.8654 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7579
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9697
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.7176
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.6782
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.4310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.0327 | Train Acc: 0.9958
 Site-USPS                          | Train Loss: 0.0625 | Train Acc: 0.9747
 Site-SynthDigits                   | Train Loss: 0.8513 | Train Acc: 0.7462
 Site-MNIST_M                       | Train Loss: 1.0295 | Train Acc: 0.6790
 Site-SVHN                          | Train Loss: 1.9706 | Train Acc: 0.3462
Average Train Accuracy: 0.7484
 Site-MNIST                         | Val  Loss: 0.0307 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1034 | Val  Acc: 0.9747
 Site-SynthDigits                   | Val  Loss: 1.1116 | Val  Acc: 0.7405
 Site-MNIST_M                       | Val  Loss: 1.0006 | Val  Acc: 0.6897
 Site-SVHN                          | Val  Loss: 1.8630 | Val  Acc: 0.4655
Average Valid Accuracy: 0.7727
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9747
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.7405
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.6897
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.0309 | Train Acc: 0.9958
 Site-USPS                          | Train Loss: 0.0583 | Train Acc: 0.9811
 Site-SynthDigits                   | Train Loss: 0.8545 | Train Acc: 0.7386
 Site-MNIST_M                       | Train Loss: 1.0069 | Train Acc: 0.6960
 Site-SVHN                          | Train Loss: 1.9628 | Train Acc: 0.3590
Average Train Accuracy: 0.7541
 Site-MNIST                         | Val  Loss: 0.0287 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1029 | Val  Acc: 0.9798
 Site-SynthDigits                   | Val  Loss: 1.1445 | Val  Acc: 0.7252
 Site-MNIST_M                       | Val  Loss: 0.9808 | Val  Acc: 0.7011
 Site-SVHN                          | Val  Loss: 1.8190 | Val  Acc: 0.4655
Average Valid Accuracy: 0.7730
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9798
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.7252
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.7011
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.0257 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0596 | Train Acc: 0.9811
 Site-SynthDigits                   | Train Loss: 0.7716 | Train Acc: 0.7595
 Site-MNIST_M                       | Train Loss: 1.0139 | Train Acc: 0.6847
 Site-SVHN                          | Train Loss: 1.9670 | Train Acc: 0.3462
Average Train Accuracy: 0.7536
 Site-MNIST                         | Val  Loss: 0.0248 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0808 | Val  Acc: 0.9798
 Site-SynthDigits                   | Val  Loss: 1.0403 | Val  Acc: 0.7710
 Site-MNIST_M                       | Val  Loss: 0.9901 | Val  Acc: 0.7011
 Site-SVHN                          | Val  Loss: 1.8610 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7725
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.0239 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0628 | Train Acc: 0.9811
 Site-SynthDigits                   | Train Loss: 0.7818 | Train Acc: 0.7405
 Site-MNIST_M                       | Train Loss: 1.0516 | Train Acc: 0.6761
 Site-SVHN                          | Train Loss: 1.9702 | Train Acc: 0.3462
Average Train Accuracy: 0.7481
 Site-MNIST                         | Val  Loss: 0.0228 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0950 | Val  Acc: 0.9747
 Site-SynthDigits                   | Val  Loss: 1.0359 | Val  Acc: 0.7557
 Site-MNIST_M                       | Val  Loss: 1.0135 | Val  Acc: 0.6782
 Site-SVHN                          | Val  Loss: 1.8098 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7707
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.0226 | Train Acc: 0.9975
 Site-USPS                          | Train Loss: 0.0543 | Train Acc: 0.9823
 Site-SynthDigits                   | Train Loss: 0.8070 | Train Acc: 0.7633
 Site-MNIST_M                       | Train Loss: 0.9547 | Train Acc: 0.6875
 Site-SVHN                          | Train Loss: 1.9458 | Train Acc: 0.3376
Average Train Accuracy: 0.7536
 Site-MNIST                         | Val  Loss: 0.0210 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0795 | Val  Acc: 0.9848
 Site-SynthDigits                   | Val  Loss: 1.0502 | Val  Acc: 0.7710
 Site-MNIST_M                       | Val  Loss: 0.9647 | Val  Acc: 0.7011
 Site-SVHN                          | Val  Loss: 1.7935 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7804
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9966
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9848
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.7710
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.7011
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.0220 | Train Acc: 0.9975
 Site-USPS                          | Train Loss: 0.0512 | Train Acc: 0.9861
 Site-SynthDigits                   | Train Loss: 0.7410 | Train Acc: 0.7557
 Site-MNIST_M                       | Train Loss: 0.9412 | Train Acc: 0.7074
 Site-SVHN                          | Train Loss: 1.9149 | Train Acc: 0.3376
Average Train Accuracy: 0.7569
 Site-MNIST                         | Val  Loss: 0.0216 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0761 | Val  Acc: 0.9848
 Site-SynthDigits                   | Val  Loss: 0.9586 | Val  Acc: 0.7557
 Site-MNIST_M                       | Val  Loss: 0.9763 | Val  Acc: 0.6552
 Site-SVHN                          | Val  Loss: 1.8041 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7647
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.0239 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0505 | Train Acc: 0.9886
 Site-SynthDigits                   | Train Loss: 0.7443 | Train Acc: 0.7557
 Site-MNIST_M                       | Train Loss: 0.9478 | Train Acc: 0.7045
 Site-SVHN                          | Train Loss: 1.9553 | Train Acc: 0.3675
Average Train Accuracy: 0.7626
 Site-MNIST                         | Val  Loss: 0.0228 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.1064 | Val  Acc: 0.9899
 Site-SynthDigits                   | Val  Loss: 0.9772 | Val  Acc: 0.7481
 Site-MNIST_M                       | Val  Loss: 0.9625 | Val  Acc: 0.6897
 Site-SVHN                          | Val  Loss: 1.8212 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7745
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.0192 | Train Acc: 0.9975
 Site-USPS                          | Train Loss: 0.0470 | Train Acc: 0.9861
 Site-SynthDigits                   | Train Loss: 0.7453 | Train Acc: 0.7803
 Site-MNIST_M                       | Train Loss: 0.9174 | Train Acc: 0.7131
 Site-SVHN                          | Train Loss: 1.9649 | Train Acc: 0.3333
Average Train Accuracy: 0.7621
 Site-MNIST                         | Val  Loss: 0.0174 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0845 | Val  Acc: 0.9848
 Site-SynthDigits                   | Val  Loss: 0.9239 | Val  Acc: 0.7863
 Site-MNIST_M                       | Val  Loss: 0.9663 | Val  Acc: 0.7011
 Site-SVHN                          | Val  Loss: 1.8491 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7834
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9966
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9848
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.7863
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.7011
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.0211 | Train Acc: 0.9983
 Site-USPS                          | Train Loss: 0.0441 | Train Acc: 0.9937
 Site-SynthDigits                   | Train Loss: 0.7361 | Train Acc: 0.7670
 Site-MNIST_M                       | Train Loss: 0.8854 | Train Acc: 0.7301
 Site-SVHN                          | Train Loss: 1.9496 | Train Acc: 0.3504
Average Train Accuracy: 0.7679
 Site-MNIST                         | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0711 | Val  Acc: 0.9949
 Site-SynthDigits                   | Val  Loss: 0.9207 | Val  Acc: 0.7710
 Site-MNIST_M                       | Val  Loss: 0.9527 | Val  Acc: 0.7241
 Site-SVHN                          | Val  Loss: 1.8266 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7842
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9949
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.7710
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.7241
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.0201 | Train Acc: 0.9975
 Site-USPS                          | Train Loss: 0.0430 | Train Acc: 0.9874
 Site-SynthDigits                   | Train Loss: 0.7216 | Train Acc: 0.7879
 Site-MNIST_M                       | Train Loss: 0.9018 | Train Acc: 0.7301
 Site-SVHN                          | Train Loss: 1.9153 | Train Acc: 0.3675
Average Train Accuracy: 0.7741
 Site-MNIST                         | Val  Loss: 0.0184 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0602 | Val  Acc: 0.9848
 Site-SynthDigits                   | Val  Loss: 0.9223 | Val  Acc: 0.7710
 Site-MNIST_M                       | Val  Loss: 0.9751 | Val  Acc: 0.7241
 Site-SVHN                          | Val  Loss: 1.8266 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7815
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.0166 | Train Acc: 0.9983
 Site-USPS                          | Train Loss: 0.0412 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.6921 | Train Acc: 0.7841
 Site-MNIST_M                       | Train Loss: 0.9211 | Train Acc: 0.7017
 Site-SVHN                          | Train Loss: 1.9143 | Train Acc: 0.3632
Average Train Accuracy: 0.7675
 Site-MNIST                         | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0544 | Val  Acc: 0.9949
 Site-SynthDigits                   | Val  Loss: 0.8709 | Val  Acc: 0.7786
 Site-MNIST_M                       | Val  Loss: 0.9704 | Val  Acc: 0.7126
 Site-SVHN                          | Val  Loss: 1.8075 | Val  Acc: 0.4655
Average Valid Accuracy: 0.7903
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9949
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7786
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.7126
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.4655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.0144 | Train Acc: 0.9983
 Site-USPS                          | Train Loss: 0.0468 | Train Acc: 0.9886
 Site-SynthDigits                   | Train Loss: 0.6786 | Train Acc: 0.7936
 Site-MNIST_M                       | Train Loss: 0.9187 | Train Acc: 0.7244
 Site-SVHN                          | Train Loss: 1.8815 | Train Acc: 0.3590
Average Train Accuracy: 0.7728
 Site-MNIST                         | Val  Loss: 0.0129 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0625 | Val  Acc: 0.9899
 Site-SynthDigits                   | Val  Loss: 0.9332 | Val  Acc: 0.8092
 Site-MNIST_M                       | Val  Loss: 0.9681 | Val  Acc: 0.7126
 Site-SVHN                          | Val  Loss: 1.7536 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7913
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9966
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9899
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.8092
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.7126
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.0137 | Train Acc: 0.9983
 Site-USPS                          | Train Loss: 0.0495 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 0.6499 | Train Acc: 0.7917
 Site-MNIST_M                       | Train Loss: 0.8962 | Train Acc: 0.7131
 Site-SVHN                          | Train Loss: 1.9320 | Train Acc: 0.3504
Average Train Accuracy: 0.7677
 Site-MNIST                         | Val  Loss: 0.0123 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0584 | Val  Acc: 0.9848
 Site-SynthDigits                   | Val  Loss: 0.8449 | Val  Acc: 0.7939
 Site-MNIST_M                       | Val  Loss: 0.9959 | Val  Acc: 0.6897
 Site-SVHN                          | Val  Loss: 1.7671 | Val  Acc: 0.4310
Average Valid Accuracy: 0.7792
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.0148 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0354 | Train Acc: 0.9912
 Site-SynthDigits                   | Train Loss: 0.6545 | Train Acc: 0.7955
 Site-MNIST_M                       | Train Loss: 0.8634 | Train Acc: 0.7244
 Site-SVHN                          | Train Loss: 1.9279 | Train Acc: 0.3846
Average Train Accuracy: 0.7790
 Site-MNIST                         | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0466 | Val  Acc: 0.9949
 Site-SynthDigits                   | Val  Loss: 0.8711 | Val  Acc: 0.7939
 Site-MNIST_M                       | Val  Loss: 0.9396 | Val  Acc: 0.7126
 Site-SVHN                          | Val  Loss: 1.7850 | Val  Acc: 0.4655
Average Valid Accuracy: 0.7934
 Best site-MNIST                     | Epoch:43 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9949
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7939
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.7126
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.0127 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0343 | Train Acc: 0.9912
 Site-SynthDigits                   | Train Loss: 0.7135 | Train Acc: 0.8049
 Site-MNIST_M                       | Train Loss: 0.8478 | Train Acc: 0.7244
 Site-SVHN                          | Train Loss: 1.9125 | Train Acc: 0.3761
Average Train Accuracy: 0.7791
 Site-MNIST                         | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0552 | Val  Acc: 0.9949
 Site-SynthDigits                   | Val  Loss: 0.9104 | Val  Acc: 0.8244
 Site-MNIST_M                       | Val  Loss: 0.9294 | Val  Acc: 0.7126
 Site-SVHN                          | Val  Loss: 1.7386 | Val  Acc: 0.4828
Average Valid Accuracy: 0.8030
 Best site-MNIST                     | Epoch:44 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9949
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.8244
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.7126
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4828
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.0130 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0334 | Train Acc: 0.9975
 Site-SynthDigits                   | Train Loss: 0.6633 | Train Acc: 0.8049
 Site-MNIST_M                       | Train Loss: 0.8770 | Train Acc: 0.7273
 Site-SVHN                          | Train Loss: 1.9066 | Train Acc: 0.3718
Average Train Accuracy: 0.7801
 Site-MNIST                         | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0585 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.8669 | Val  Acc: 0.8244
 Site-MNIST_M                       | Val  Loss: 0.9240 | Val  Acc: 0.7356
 Site-SVHN                          | Val  Loss: 1.7564 | Val  Acc: 0.4828
Average Valid Accuracy: 0.8086
 Best site-MNIST                     | Epoch:45 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:45 | Val Acc: 1.0000
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.8244
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.7356
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.4828
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/fedsam...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.0108 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0309 | Train Acc: 0.9937
 Site-SynthDigits                   | Train Loss: 0.6661 | Train Acc: 0.8087
 Site-MNIST_M                       | Train Loss: 0.8642 | Train Acc: 0.7386
 Site-SVHN                          | Train Loss: 1.9000 | Train Acc: 0.3803
Average Train Accuracy: 0.7841
 Site-MNIST                         | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0521 | Val  Acc: 0.9899
 Site-SynthDigits                   | Val  Loss: 0.8489 | Val  Acc: 0.8168
 Site-MNIST_M                       | Val  Loss: 0.9393 | Val  Acc: 0.7011
 Site-SVHN                          | Val  Loss: 1.7594 | Val  Acc: 0.4655
Average Valid Accuracy: 0.7947
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.0101 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0361 | Train Acc: 0.9912
 Site-SynthDigits                   | Train Loss: 0.6483 | Train Acc: 0.8030
 Site-MNIST_M                       | Train Loss: 0.8511 | Train Acc: 0.7216
 Site-SVHN                          | Train Loss: 1.8848 | Train Acc: 0.3761
Average Train Accuracy: 0.7782
 Site-MNIST                         | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0413 | Val  Acc: 0.9848
 Site-SynthDigits                   | Val  Loss: 0.7528 | Val  Acc: 0.8168
 Site-MNIST_M                       | Val  Loss: 0.9105 | Val  Acc: 0.6897
 Site-SVHN                          | Val  Loss: 1.7443 | Val  Acc: 0.4828
Average Valid Accuracy: 0.7948
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.0092 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0291 | Train Acc: 0.9949
 Site-SynthDigits                   | Train Loss: 0.6196 | Train Acc: 0.8068
 Site-MNIST_M                       | Train Loss: 0.8375 | Train Acc: 0.7273
 Site-SVHN                          | Train Loss: 1.8902 | Train Acc: 0.3632
Average Train Accuracy: 0.7783
 Site-MNIST                         | Val  Loss: 0.0085 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0475 | Val  Acc: 0.9949
 Site-SynthDigits                   | Val  Loss: 0.7610 | Val  Acc: 0.8168
 Site-MNIST_M                       | Val  Loss: 0.8927 | Val  Acc: 0.7126
 Site-SVHN                          | Val  Loss: 1.7111 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7939
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.0085 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0269 | Train Acc: 0.9937
 Site-SynthDigits                   | Train Loss: 0.5900 | Train Acc: 0.8277
 Site-MNIST_M                       | Train Loss: 0.8083 | Train Acc: 0.7415
 Site-SVHN                          | Train Loss: 1.9037 | Train Acc: 0.3632
Average Train Accuracy: 0.7850
 Site-MNIST                         | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0436 | Val  Acc: 0.9949
 Site-SynthDigits                   | Val  Loss: 0.7561 | Val  Acc: 0.8473
 Site-MNIST_M                       | Val  Loss: 0.9289 | Val  Acc: 0.7126
 Site-SVHN                          | Val  Loss: 1.7364 | Val  Acc: 0.4828
Average Valid Accuracy: 0.8075
===2023-07-02 18:45:15===
===2023-07-02 18:45:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:45 | Test Acc: 0.9437
 Test site-USPS                      | Epoch:45 | Test Acc: 0.9462
 Test site-SynthDigits               | Epoch:45 | Test Acc: 0.6302
 Test site-MNIST_M                   | Epoch:45 | Test Acc: 0.3849
 Test site-SVHN                      | Epoch:45 | Test Acc: 0.2734
MNIST: 0.9437, USPS: 0.9462, SynthDigits: 0.6302, MNIST_M: 0.3849, SVHN: 0.2734, 
Average Test Accuracy(group): 0.6357, Average Test Accuracy(individual): 0.6357,
domain std=0.2777, cluster std=-1.0000, individual std=0.2777, 
