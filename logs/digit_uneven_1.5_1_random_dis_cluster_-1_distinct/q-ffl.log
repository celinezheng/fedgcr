===2023-07-02 14:34:25===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
============ Train epoch 0 ============
denominator: 15022.521484375
 Site-MNIST                         | Train Loss: 2.1650 | Train Acc: 0.5349
 Site-USPS                          | Train Loss: 2.1570 | Train Acc: 0.5379
 Site-SynthDigits                   | Train Loss: 2.2621 | Train Acc: 0.1989
 Site-MNIST_M                       | Train Loss: 2.2785 | Train Acc: 0.1562
 Site-SVHN                          | Train Loss: 2.2793 | Train Acc: 0.1538
Average Train Accuracy: 0.3163
 Site-MNIST                         | Val  Loss: 2.1616 | Val  Acc: 0.5791
 Site-USPS                          | Val  Loss: 2.1348 | Val  Acc: 0.5505
 Site-SynthDigits                   | Val  Loss: 2.2935 | Val  Acc: 0.1603
 Site-MNIST_M                       | Val  Loss: 2.2790 | Val  Acc: 0.1609
 Site-SVHN                          | Val  Loss: 2.2936 | Val  Acc: 0.1379
Average Valid Accuracy: 0.3178
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5791
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5505
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1603
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 1 ============
denominator: 14556.5478515625
 Site-MNIST                         | Train Loss: 2.0317 | Train Acc: 0.6636
 Site-USPS                          | Train Loss: 2.0137 | Train Acc: 0.6717
 Site-SynthDigits                   | Train Loss: 2.2143 | Train Acc: 0.2992
 Site-MNIST_M                       | Train Loss: 2.2458 | Train Acc: 0.2301
 Site-SVHN                          | Train Loss: 2.2616 | Train Acc: 0.1752
Average Train Accuracy: 0.4080
 Site-MNIST                         | Val  Loss: 2.0250 | Val  Acc: 0.6902
 Site-USPS                          | Val  Loss: 1.9873 | Val  Acc: 0.6465
 Site-SynthDigits                   | Val  Loss: 2.2481 | Val  Acc: 0.2595
 Site-MNIST_M                       | Val  Loss: 2.2429 | Val  Acc: 0.1839
 Site-SVHN                          | Val  Loss: 2.2800 | Val  Acc: 0.1552
Average Valid Accuracy: 0.3871
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6902
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6465
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2595
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1839
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 2 ============
denominator: 14239.8876953125
 Site-MNIST                         | Train Loss: 1.8981 | Train Acc: 0.6863
 Site-USPS                          | Train Loss: 1.8677 | Train Acc: 0.7172
 Site-SynthDigits                   | Train Loss: 2.1660 | Train Acc: 0.3712
 Site-MNIST_M                       | Train Loss: 2.2175 | Train Acc: 0.2869
 Site-SVHN                          | Train Loss: 2.2473 | Train Acc: 0.2051
Average Train Accuracy: 0.4533
 Site-MNIST                         | Val  Loss: 1.8930 | Val  Acc: 0.7003
 Site-USPS                          | Val  Loss: 1.8422 | Val  Acc: 0.6717
 Site-SynthDigits                   | Val  Loss: 2.2025 | Val  Acc: 0.3664
 Site-MNIST_M                       | Val  Loss: 2.2110 | Val  Acc: 0.2759
 Site-SVHN                          | Val  Loss: 2.2676 | Val  Acc: 0.2069
Average Valid Accuracy: 0.4442
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7003
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6717
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3664
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2759
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 3 ============
denominator: 13832.5224609375
 Site-MNIST                         | Train Loss: 1.7784 | Train Acc: 0.7031
 Site-USPS                          | Train Loss: 1.7275 | Train Acc: 0.7500
 Site-SynthDigits                   | Train Loss: 2.1109 | Train Acc: 0.3977
 Site-MNIST_M                       | Train Loss: 2.1879 | Train Acc: 0.3210
 Site-SVHN                          | Train Loss: 2.2314 | Train Acc: 0.2222
Average Train Accuracy: 0.4788
 Site-MNIST                         | Val  Loss: 1.7676 | Val  Acc: 0.7037
 Site-USPS                          | Val  Loss: 1.6989 | Val  Acc: 0.7172
 Site-SynthDigits                   | Val  Loss: 2.1579 | Val  Acc: 0.4122
 Site-MNIST_M                       | Val  Loss: 2.1781 | Val  Acc: 0.2874
 Site-SVHN                          | Val  Loss: 2.2542 | Val  Acc: 0.2241
Average Valid Accuracy: 0.4689
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7037
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7172
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4122
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2874
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 4 ============
denominator: 13505.2529296875
 Site-MNIST                         | Train Loss: 1.6675 | Train Acc: 0.7098
 Site-USPS                          | Train Loss: 1.6010 | Train Acc: 0.7652
 Site-SynthDigits                   | Train Loss: 2.0777 | Train Acc: 0.4223
 Site-MNIST_M                       | Train Loss: 2.1596 | Train Acc: 0.3523
 Site-SVHN                          | Train Loss: 2.2201 | Train Acc: 0.2479
Average Train Accuracy: 0.4995
 Site-MNIST                         | Val  Loss: 1.6551 | Val  Acc: 0.7104
 Site-USPS                          | Val  Loss: 1.5773 | Val  Acc: 0.7222
 Site-SynthDigits                   | Val  Loss: 2.1175 | Val  Acc: 0.4427
 Site-MNIST_M                       | Val  Loss: 2.1464 | Val  Acc: 0.2989
 Site-SVHN                          | Val  Loss: 2.2448 | Val  Acc: 0.2241
Average Valid Accuracy: 0.4797
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7104
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7222
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4427
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2989
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 5 ============
denominator: 13130.0
 Site-MNIST                         | Train Loss: 1.5461 | Train Acc: 0.7443
 Site-USPS                          | Train Loss: 1.4664 | Train Acc: 0.8068
 Site-SynthDigits                   | Train Loss: 2.0143 | Train Acc: 0.4432
 Site-MNIST_M                       | Train Loss: 2.1308 | Train Acc: 0.3580
 Site-SVHN                          | Train Loss: 2.2059 | Train Acc: 0.2564
Average Train Accuracy: 0.5217
 Site-MNIST                         | Val  Loss: 1.5316 | Val  Acc: 0.7508
 Site-USPS                          | Val  Loss: 1.4441 | Val  Acc: 0.7828
 Site-SynthDigits                   | Val  Loss: 2.0828 | Val  Acc: 0.4504
 Site-MNIST_M                       | Val  Loss: 2.1131 | Val  Acc: 0.3563
 Site-SVHN                          | Val  Loss: 2.2327 | Val  Acc: 0.2241
Average Valid Accuracy: 0.5129
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7508
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7828
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4504
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3563
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 6 ============
denominator: 12831.92578125
 Site-MNIST                         | Train Loss: 1.4467 | Train Acc: 0.7511
 Site-USPS                          | Train Loss: 1.3569 | Train Acc: 0.8119
 Site-SynthDigits                   | Train Loss: 1.9725 | Train Acc: 0.4545
 Site-MNIST_M                       | Train Loss: 2.0970 | Train Acc: 0.3977
 Site-SVHN                          | Train Loss: 2.1875 | Train Acc: 0.2564
Average Train Accuracy: 0.5343
 Site-MNIST                         | Val  Loss: 1.4315 | Val  Acc: 0.7508
 Site-USPS                          | Val  Loss: 1.3378 | Val  Acc: 0.7828
 Site-SynthDigits                   | Val  Loss: 2.0537 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 2.0756 | Val  Acc: 0.4138
 Site-SVHN                          | Val  Loss: 2.2181 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5324
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7508
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7828
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4138
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 7 ============
denominator: 12510.4580078125
 Site-MNIST                         | Train Loss: 1.3518 | Train Acc: 0.7620
 Site-USPS                          | Train Loss: 1.2543 | Train Acc: 0.8258
 Site-SynthDigits                   | Train Loss: 1.9261 | Train Acc: 0.4621
 Site-MNIST_M                       | Train Loss: 2.0557 | Train Acc: 0.4261
 Site-SVHN                          | Train Loss: 2.1741 | Train Acc: 0.2607
Average Train Accuracy: 0.5473
 Site-MNIST                         | Val  Loss: 1.3378 | Val  Acc: 0.7643
 Site-USPS                          | Val  Loss: 1.2338 | Val  Acc: 0.8030
 Site-SynthDigits                   | Val  Loss: 2.0298 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 2.0388 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.1981 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5591
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7643
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8030
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4713
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 8 ============
denominator: 12159.66015625
 Site-MNIST                         | Train Loss: 1.2618 | Train Acc: 0.7595
 Site-USPS                          | Train Loss: 1.1490 | Train Acc: 0.8472
 Site-SynthDigits                   | Train Loss: 1.9001 | Train Acc: 0.4413
 Site-MNIST_M                       | Train Loss: 2.0310 | Train Acc: 0.4432
 Site-SVHN                          | Train Loss: 2.1572 | Train Acc: 0.2650
Average Train Accuracy: 0.5512
 Site-MNIST                         | Val  Loss: 1.2518 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 1.1342 | Val  Acc: 0.8232
 Site-SynthDigits                   | Val  Loss: 1.9931 | Val  Acc: 0.4733
 Site-MNIST_M                       | Val  Loss: 1.9930 | Val  Acc: 0.4943
 Site-SVHN                          | Val  Loss: 2.1790 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5655
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8232
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4733
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4943
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 9 ============
denominator: 11795.955078125
 Site-MNIST                         | Train Loss: 1.1723 | Train Acc: 0.7704
 Site-USPS                          | Train Loss: 1.0400 | Train Acc: 0.8460
 Site-SynthDigits                   | Train Loss: 1.8606 | Train Acc: 0.4394
 Site-MNIST_M                       | Train Loss: 1.9866 | Train Acc: 0.4517
 Site-SVHN                          | Train Loss: 2.1529 | Train Acc: 0.2650
Average Train Accuracy: 0.5545
 Site-MNIST                         | Val  Loss: 1.1575 | Val  Acc: 0.7710
 Site-USPS                          | Val  Loss: 1.0453 | Val  Acc: 0.8283
 Site-SynthDigits                   | Val  Loss: 1.9703 | Val  Acc: 0.4504
 Site-MNIST_M                       | Val  Loss: 1.9608 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.1670 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5594
============ Train epoch 10 ============
denominator: 11559.2099609375
 Site-MNIST                         | Train Loss: 1.0941 | Train Acc: 0.7855
 Site-USPS                          | Train Loss: 0.9705 | Train Acc: 0.8535
 Site-SynthDigits                   | Train Loss: 1.8176 | Train Acc: 0.4659
 Site-MNIST_M                       | Train Loss: 1.9461 | Train Acc: 0.4517
 Site-SVHN                          | Train Loss: 2.1279 | Train Acc: 0.2735
Average Train Accuracy: 0.5660
 Site-MNIST                         | Val  Loss: 1.0815 | Val  Acc: 0.7912
 Site-USPS                          | Val  Loss: 0.9789 | Val  Acc: 0.8384
 Site-SynthDigits                   | Val  Loss: 1.9465 | Val  Acc: 0.4656
 Site-MNIST_M                       | Val  Loss: 1.9244 | Val  Acc: 0.4598
 Site-SVHN                          | Val  Loss: 2.1503 | Val  Acc: 0.2931
Average Valid Accuracy: 0.5696
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7912
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8384
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4656
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4598
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 11 ============
denominator: 11303.830078125
 Site-MNIST                         | Train Loss: 1.0373 | Train Acc: 0.7839
 Site-USPS                          | Train Loss: 0.9114 | Train Acc: 0.8548
 Site-SynthDigits                   | Train Loss: 1.7813 | Train Acc: 0.4811
 Site-MNIST_M                       | Train Loss: 1.9228 | Train Acc: 0.4659
 Site-SVHN                          | Train Loss: 2.1192 | Train Acc: 0.2692
Average Train Accuracy: 0.5710
 Site-MNIST                         | Val  Loss: 1.0193 | Val  Acc: 0.7946
 Site-USPS                          | Val  Loss: 0.9213 | Val  Acc: 0.8535
 Site-SynthDigits                   | Val  Loss: 1.9184 | Val  Acc: 0.4885
 Site-MNIST_M                       | Val  Loss: 1.8913 | Val  Acc: 0.4713
 Site-SVHN                          | Val  Loss: 2.1360 | Val  Acc: 0.2931
Average Valid Accuracy: 0.5802
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7946
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8535
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4885
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4713
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 12 ============
denominator: 11033.6435546875
 Site-MNIST                         | Train Loss: 0.9810 | Train Acc: 0.7839
 Site-USPS                          | Train Loss: 0.8473 | Train Acc: 0.8624
 Site-SynthDigits                   | Train Loss: 1.7450 | Train Acc: 0.4830
 Site-MNIST_M                       | Train Loss: 1.8817 | Train Acc: 0.4886
 Site-SVHN                          | Train Loss: 2.1117 | Train Acc: 0.2906
Average Train Accuracy: 0.5817
 Site-MNIST                         | Val  Loss: 0.9614 | Val  Acc: 0.7811
 Site-USPS                          | Val  Loss: 0.8670 | Val  Acc: 0.8535
 Site-SynthDigits                   | Val  Loss: 1.8857 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.8516 | Val  Acc: 0.5057
 Site-SVHN                          | Val  Loss: 2.1193 | Val  Acc: 0.2931
Average Valid Accuracy: 0.5829
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7811
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8535
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.5057
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 13 ============
denominator: 10829.8623046875
 Site-MNIST                         | Train Loss: 0.9304 | Train Acc: 0.7897
 Site-USPS                          | Train Loss: 0.7706 | Train Acc: 0.8687
 Site-SynthDigits                   | Train Loss: 1.7150 | Train Acc: 0.4981
 Site-MNIST_M                       | Train Loss: 1.8371 | Train Acc: 0.4972
 Site-SVHN                          | Train Loss: 2.0993 | Train Acc: 0.2821
Average Train Accuracy: 0.5871
 Site-MNIST                         | Val  Loss: 0.9080 | Val  Acc: 0.7980
 Site-USPS                          | Val  Loss: 0.8184 | Val  Acc: 0.8636
 Site-SynthDigits                   | Val  Loss: 1.8652 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.8181 | Val  Acc: 0.5287
 Site-SVHN                          | Val  Loss: 2.1061 | Val  Acc: 0.2931
Average Valid Accuracy: 0.5975
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7980
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8636
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5287
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 14 ============
denominator: 10572.4306640625
 Site-MNIST                         | Train Loss: 0.8777 | Train Acc: 0.7981
 Site-USPS                          | Train Loss: 0.7304 | Train Acc: 0.8737
 Site-SynthDigits                   | Train Loss: 1.6900 | Train Acc: 0.4962
 Site-MNIST_M                       | Train Loss: 1.8069 | Train Acc: 0.5142
 Site-SVHN                          | Train Loss: 2.0863 | Train Acc: 0.2949
Average Train Accuracy: 0.5954
 Site-MNIST                         | Val  Loss: 0.8494 | Val  Acc: 0.8081
 Site-USPS                          | Val  Loss: 0.7772 | Val  Acc: 0.8636
 Site-SynthDigits                   | Val  Loss: 1.8432 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.7871 | Val  Acc: 0.5172
 Site-SVHN                          | Val  Loss: 2.0919 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5891
============ Train epoch 15 ============
denominator: 10306.5625
 Site-MNIST                         | Train Loss: 0.8134 | Train Acc: 0.8091
 Site-USPS                          | Train Loss: 0.6909 | Train Acc: 0.8763
 Site-SynthDigits                   | Train Loss: 1.6319 | Train Acc: 0.5019
 Site-MNIST_M                       | Train Loss: 1.7845 | Train Acc: 0.5312
 Site-SVHN                          | Train Loss: 2.0720 | Train Acc: 0.2906
Average Train Accuracy: 0.6018
 Site-MNIST                         | Val  Loss: 0.7906 | Val  Acc: 0.8148
 Site-USPS                          | Val  Loss: 0.7376 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 1.8270 | Val  Acc: 0.4809
 Site-MNIST_M                       | Val  Loss: 1.7536 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0792 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5994
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8148
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8737
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4809
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.5517
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 16 ============
denominator: 10078.3740234375
 Site-MNIST                         | Train Loss: 0.7879 | Train Acc: 0.8099
 Site-USPS                          | Train Loss: 0.6635 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.6001 | Train Acc: 0.5133
 Site-MNIST_M                       | Train Loss: 1.7380 | Train Acc: 0.5312
 Site-SVHN                          | Train Loss: 2.0689 | Train Acc: 0.2778
Average Train Accuracy: 0.6014
 Site-MNIST                         | Val  Loss: 0.7575 | Val  Acc: 0.8148
 Site-USPS                          | Val  Loss: 0.7015 | Val  Acc: 0.8737
 Site-SynthDigits                   | Val  Loss: 1.8163 | Val  Acc: 0.4962
 Site-MNIST_M                       | Val  Loss: 1.7214 | Val  Acc: 0.5517
 Site-SVHN                          | Val  Loss: 2.0643 | Val  Acc: 0.2586
Average Valid Accuracy: 0.5990
============ Train epoch 17 ============
denominator: 10003.47265625
 Site-MNIST                         | Train Loss: 0.7507 | Train Acc: 0.8124
 Site-USPS                          | Train Loss: 0.6203 | Train Acc: 0.8775
 Site-SynthDigits                   | Train Loss: 1.5870 | Train Acc: 0.5246
 Site-MNIST_M                       | Train Loss: 1.7100 | Train Acc: 0.5455
 Site-SVHN                          | Train Loss: 2.0508 | Train Acc: 0.2735
Average Train Accuracy: 0.6067
 Site-MNIST                         | Val  Loss: 0.7162 | Val  Acc: 0.8182
 Site-USPS                          | Val  Loss: 0.6722 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7978 | Val  Acc: 0.5115
 Site-MNIST_M                       | Val  Loss: 1.6900 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0551 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6061
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8182
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5115
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5632
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 18 ============
denominator: 9802.603515625
 Site-MNIST                         | Train Loss: 0.7031 | Train Acc: 0.8217
 Site-USPS                          | Train Loss: 0.5877 | Train Acc: 0.8775
 Site-SynthDigits                   | Train Loss: 1.5674 | Train Acc: 0.5208
 Site-MNIST_M                       | Train Loss: 1.6917 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 2.0431 | Train Acc: 0.2735
Average Train Accuracy: 0.6089
 Site-MNIST                         | Val  Loss: 0.6722 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.6436 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7897 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.6706 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 2.0411 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6125
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8350
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 19 ============
denominator: 9681.029296875
 Site-MNIST                         | Train Loss: 0.6759 | Train Acc: 0.8200
 Site-USPS                          | Train Loss: 0.5677 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.5354 | Train Acc: 0.5379
 Site-MNIST_M                       | Train Loss: 1.6664 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 2.0230 | Train Acc: 0.2991
Average Train Accuracy: 0.6200
 Site-MNIST                         | Val  Loss: 0.6457 | Val  Acc: 0.8384
 Site-USPS                          | Val  Loss: 0.6202 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.7565 | Val  Acc: 0.5038
 Site-MNIST_M                       | Val  Loss: 1.6422 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0197 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6150
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8384
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5038
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5632
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 20 ============
denominator: 9530.732421875
 Site-MNIST                         | Train Loss: 0.6293 | Train Acc: 0.8352
 Site-USPS                          | Train Loss: 0.5340 | Train Acc: 0.8813
 Site-SynthDigits                   | Train Loss: 1.5154 | Train Acc: 0.5322
 Site-MNIST_M                       | Train Loss: 1.6332 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 2.0143 | Train Acc: 0.2821
Average Train Accuracy: 0.6175
 Site-MNIST                         | Val  Loss: 0.6063 | Val  Acc: 0.8485
 Site-USPS                          | Val  Loss: 0.6001 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.7492 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.6203 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 2.0269 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6212
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8485
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5632
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 21 ============
denominator: 9412.6728515625
 Site-MNIST                         | Train Loss: 0.6114 | Train Acc: 0.8402
 Site-USPS                          | Train Loss: 0.5115 | Train Acc: 0.8851
 Site-SynthDigits                   | Train Loss: 1.4858 | Train Acc: 0.5360
 Site-MNIST_M                       | Train Loss: 1.5951 | Train Acc: 0.5625
 Site-SVHN                          | Train Loss: 1.9970 | Train Acc: 0.2906
Average Train Accuracy: 0.6229
 Site-MNIST                         | Val  Loss: 0.5860 | Val  Acc: 0.8485
 Site-USPS                          | Val  Loss: 0.5802 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.7203 | Val  Acc: 0.5191
 Site-MNIST_M                       | Val  Loss: 1.5968 | Val  Acc: 0.5747
 Site-SVHN                          | Val  Loss: 2.0073 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6214
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8485
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5191
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5747
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 22 ============
denominator: 9215.5634765625
 Site-MNIST                         | Train Loss: 0.5945 | Train Acc: 0.8402
 Site-USPS                          | Train Loss: 0.4983 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.4790 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.5960 | Train Acc: 0.5739
 Site-SVHN                          | Train Loss: 1.9908 | Train Acc: 0.2906
Average Train Accuracy: 0.6262
 Site-MNIST                         | Val  Loss: 0.5638 | Val  Acc: 0.8485
 Site-USPS                          | Val  Loss: 0.5645 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.7099 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.5709 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 1.9953 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6242
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8485
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5267
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 23 ============
denominator: 9169.59375
 Site-MNIST                         | Train Loss: 0.5657 | Train Acc: 0.8436
 Site-USPS                          | Train Loss: 0.4735 | Train Acc: 0.8876
 Site-SynthDigits                   | Train Loss: 1.4651 | Train Acc: 0.5492
 Site-MNIST_M                       | Train Loss: 1.5673 | Train Acc: 0.5795
 Site-SVHN                          | Train Loss: 1.9875 | Train Acc: 0.2991
Average Train Accuracy: 0.6318
 Site-MNIST                         | Val  Loss: 0.5380 | Val  Acc: 0.8451
 Site-USPS                          | Val  Loss: 0.5407 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.6895 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.5502 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 1.9790 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6251
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8451
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 24 ============
denominator: 9026.306640625
 Site-MNIST                         | Train Loss: 0.5413 | Train Acc: 0.8537
 Site-USPS                          | Train Loss: 0.4530 | Train Acc: 0.8902
 Site-SynthDigits                   | Train Loss: 1.4285 | Train Acc: 0.5549
 Site-MNIST_M                       | Train Loss: 1.5289 | Train Acc: 0.5824
 Site-SVHN                          | Train Loss: 1.9834 | Train Acc: 0.3034
Average Train Accuracy: 0.6369
 Site-MNIST                         | Val  Loss: 0.5152 | Val  Acc: 0.8586
 Site-USPS                          | Val  Loss: 0.5250 | Val  Acc: 0.8838
 Site-SynthDigits                   | Val  Loss: 1.6693 | Val  Acc: 0.5267
 Site-MNIST_M                       | Val  Loss: 1.5284 | Val  Acc: 0.5632
 Site-SVHN                          | Val  Loss: 1.9729 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6251
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8586
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8838
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5267
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5632
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 25 ============
denominator: 8975.767578125
 Site-MNIST                         | Train Loss: 0.5241 | Train Acc: 0.8579
 Site-USPS                          | Train Loss: 0.4318 | Train Acc: 0.8952
 Site-SynthDigits                   | Train Loss: 1.4242 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.5140 | Train Acc: 0.5966
 Site-SVHN                          | Train Loss: 1.9724 | Train Acc: 0.2949
Average Train Accuracy: 0.6403
 Site-MNIST                         | Val  Loss: 0.4930 | Val  Acc: 0.8552
 Site-USPS                          | Val  Loss: 0.5019 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.6666 | Val  Acc: 0.5344
 Site-MNIST_M                       | Val  Loss: 1.5028 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 1.9667 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6326
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8552
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5344
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 26 ============
denominator: 8801.130859375
 Site-MNIST                         | Train Loss: 0.5102 | Train Acc: 0.8587
 Site-USPS                          | Train Loss: 0.4238 | Train Acc: 0.8965
 Site-SynthDigits                   | Train Loss: 1.4007 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.5096 | Train Acc: 0.5966
 Site-SVHN                          | Train Loss: 1.9616 | Train Acc: 0.2906
Average Train Accuracy: 0.6410
 Site-MNIST                         | Val  Loss: 0.4789 | Val  Acc: 0.8620
 Site-USPS                          | Val  Loss: 0.4908 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.6678 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.4843 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 1.9620 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6310
============ Train epoch 27 ============
denominator: 8756.6904296875
 Site-MNIST                         | Train Loss: 0.4931 | Train Acc: 0.8595
 Site-USPS                          | Train Loss: 0.4161 | Train Acc: 0.9003
 Site-SynthDigits                   | Train Loss: 1.3646 | Train Acc: 0.5777
 Site-MNIST_M                       | Train Loss: 1.4700 | Train Acc: 0.6165
 Site-SVHN                          | Train Loss: 1.9461 | Train Acc: 0.3205
Average Train Accuracy: 0.6549
 Site-MNIST                         | Val  Loss: 0.4660 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.4812 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.6213 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.4644 | Val  Acc: 0.5862
 Site-SVHN                          | Val  Loss: 1.9315 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6351
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8653
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5420
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5862
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 28 ============
denominator: 8689.03515625
 Site-MNIST                         | Train Loss: 0.4639 | Train Acc: 0.8738
 Site-USPS                          | Train Loss: 0.3915 | Train Acc: 0.8990
 Site-SynthDigits                   | Train Loss: 1.3649 | Train Acc: 0.5701
 Site-MNIST_M                       | Train Loss: 1.4588 | Train Acc: 0.6193
 Site-SVHN                          | Train Loss: 1.9630 | Train Acc: 0.3034
Average Train Accuracy: 0.6531
 Site-MNIST                         | Val  Loss: 0.4320 | Val  Acc: 0.8721
 Site-USPS                          | Val  Loss: 0.4643 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.6263 | Val  Acc: 0.5420
 Site-MNIST_M                       | Val  Loss: 1.4386 | Val  Acc: 0.6437
 Site-SVHN                          | Val  Loss: 1.9459 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6455
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8721
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5420
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.6437
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 29 ============
denominator: 8528.7705078125
 Site-MNIST                         | Train Loss: 0.4551 | Train Acc: 0.8722
 Site-USPS                          | Train Loss: 0.3811 | Train Acc: 0.9003
 Site-SynthDigits                   | Train Loss: 1.3472 | Train Acc: 0.5814
 Site-MNIST_M                       | Train Loss: 1.4422 | Train Acc: 0.6108
 Site-SVHN                          | Train Loss: 1.9480 | Train Acc: 0.3120
Average Train Accuracy: 0.6553
 Site-MNIST                         | Val  Loss: 0.4263 | Val  Acc: 0.8721
 Site-USPS                          | Val  Loss: 0.4564 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.5967 | Val  Acc: 0.5496
 Site-MNIST_M                       | Val  Loss: 1.4256 | Val  Acc: 0.6207
 Site-SVHN                          | Val  Loss: 1.9235 | Val  Acc: 0.2759
Average Valid Accuracy: 0.6424
============ Train epoch 30 ============
denominator: 8530.5634765625
 Site-MNIST                         | Train Loss: 0.4433 | Train Acc: 0.8797
 Site-USPS                          | Train Loss: 0.3792 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.3526 | Train Acc: 0.5758
 Site-MNIST_M                       | Train Loss: 1.4287 | Train Acc: 0.6278
 Site-SVHN                          | Train Loss: 1.9249 | Train Acc: 0.3034
Average Train Accuracy: 0.6592
 Site-MNIST                         | Val  Loss: 0.4127 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4421 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.6082 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.4019 | Val  Acc: 0.6437
 Site-SVHN                          | Val  Loss: 1.9233 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6510
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5649
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.6437
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 31 ============
denominator: 8436.9521484375
 Site-MNIST                         | Train Loss: 0.4390 | Train Acc: 0.8772
 Site-USPS                          | Train Loss: 0.3642 | Train Acc: 0.9040
 Site-SynthDigits                   | Train Loss: 1.3062 | Train Acc: 0.5909
 Site-MNIST_M                       | Train Loss: 1.4203 | Train Acc: 0.6193
 Site-SVHN                          | Train Loss: 1.9111 | Train Acc: 0.3291
Average Train Accuracy: 0.6641
 Site-MNIST                         | Val  Loss: 0.4064 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4288 | Val  Acc: 0.8939
 Site-SynthDigits                   | Val  Loss: 1.5742 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.3928 | Val  Acc: 0.6207
 Site-SVHN                          | Val  Loss: 1.8906 | Val  Acc: 0.2931
Average Valid Accuracy: 0.6538
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8939
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5725
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.6207
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.2931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 32 ============
denominator: 8287.466796875
 Site-MNIST                         | Train Loss: 0.4164 | Train Acc: 0.8881
 Site-USPS                          | Train Loss: 0.3458 | Train Acc: 0.9129
 Site-SynthDigits                   | Train Loss: 1.3132 | Train Acc: 0.6004
 Site-MNIST_M                       | Train Loss: 1.4032 | Train Acc: 0.6307
 Site-SVHN                          | Train Loss: 1.9215 | Train Acc: 0.3120
Average Train Accuracy: 0.6688
 Site-MNIST                         | Val  Loss: 0.3831 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4164 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5935 | Val  Acc: 0.5802
 Site-MNIST_M                       | Val  Loss: 1.3657 | Val  Acc: 0.6322
 Site-SVHN                          | Val  Loss: 1.9079 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6658
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5802
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.6322
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 33 ============
denominator: 8225.89453125
 Site-MNIST                         | Train Loss: 0.4166 | Train Acc: 0.8823
 Site-USPS                          | Train Loss: 0.3546 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.2961 | Train Acc: 0.5966
 Site-MNIST_M                       | Train Loss: 1.3745 | Train Acc: 0.6364
 Site-SVHN                          | Train Loss: 1.8849 | Train Acc: 0.3462
Average Train Accuracy: 0.6741
 Site-MNIST                         | Val  Loss: 0.3818 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.4211 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.5584 | Val  Acc: 0.5649
 Site-MNIST_M                       | Val  Loss: 1.3704 | Val  Acc: 0.6437
 Site-SVHN                          | Val  Loss: 1.8684 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6627
============ Train epoch 34 ============
denominator: 8146.73095703125
 Site-MNIST                         | Train Loss: 0.3975 | Train Acc: 0.8907
 Site-USPS                          | Train Loss: 0.3291 | Train Acc: 0.9141
 Site-SynthDigits                   | Train Loss: 1.2820 | Train Acc: 0.6061
 Site-MNIST_M                       | Train Loss: 1.3636 | Train Acc: 0.6477
 Site-SVHN                          | Train Loss: 1.9250 | Train Acc: 0.3162
Average Train Accuracy: 0.6750
 Site-MNIST                         | Val  Loss: 0.3634 | Val  Acc: 0.8990
 Site-USPS                          | Val  Loss: 0.4041 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5559 | Val  Acc: 0.5878
 Site-MNIST_M                       | Val  Loss: 1.3346 | Val  Acc: 0.6437
 Site-SVHN                          | Val  Loss: 1.8947 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6690
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8990
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.5878
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.6437
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 35 ============
denominator: 8112.814453125
 Site-MNIST                         | Train Loss: 0.3940 | Train Acc: 0.8881
 Site-USPS                          | Train Loss: 0.3388 | Train Acc: 0.9154
 Site-SynthDigits                   | Train Loss: 1.2483 | Train Acc: 0.6136
 Site-MNIST_M                       | Train Loss: 1.3647 | Train Acc: 0.6477
 Site-SVHN                          | Train Loss: 1.8963 | Train Acc: 0.3419
Average Train Accuracy: 0.6814
 Site-MNIST                         | Val  Loss: 0.3618 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.4035 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5268 | Val  Acc: 0.5725
 Site-MNIST_M                       | Val  Loss: 1.3420 | Val  Acc: 0.6322
 Site-SVHN                          | Val  Loss: 1.8431 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6664
============ Train epoch 36 ============
denominator: 8065.4208984375
 Site-MNIST                         | Train Loss: 0.3800 | Train Acc: 0.8991
 Site-USPS                          | Train Loss: 0.3111 | Train Acc: 0.9205
 Site-SynthDigits                   | Train Loss: 1.2839 | Train Acc: 0.5985
 Site-MNIST_M                       | Train Loss: 1.3272 | Train Acc: 0.6477
 Site-SVHN                          | Train Loss: 1.8852 | Train Acc: 0.3248
Average Train Accuracy: 0.6781
 Site-MNIST                         | Val  Loss: 0.3423 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.3835 | Val  Acc: 0.9040
 Site-SynthDigits                   | Val  Loss: 1.5500 | Val  Acc: 0.5878
 Site-MNIST_M                       | Val  Loss: 1.3088 | Val  Acc: 0.6552
 Site-SVHN                          | Val  Loss: 1.8791 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6740
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9125
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9040
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5878
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.6552
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 37 ============
denominator: 8033.529296875
 Site-MNIST                         | Train Loss: 0.3754 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.3119 | Train Acc: 0.9141
 Site-SynthDigits                   | Train Loss: 1.2655 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.3047 | Train Acc: 0.6534
 Site-SVHN                          | Train Loss: 1.8756 | Train Acc: 0.3291
Average Train Accuracy: 0.6825
 Site-MNIST                         | Val  Loss: 0.3430 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.3903 | Val  Acc: 0.8990
 Site-SynthDigits                   | Val  Loss: 1.5064 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.3066 | Val  Acc: 0.6322
 Site-SVHN                          | Val  Loss: 1.8485 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6774
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8990
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6260
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.6322
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 38 ============
denominator: 7925.6865234375
 Site-MNIST                         | Train Loss: 0.3625 | Train Acc: 0.8974
 Site-USPS                          | Train Loss: 0.2995 | Train Acc: 0.9192
 Site-SynthDigits                   | Train Loss: 1.2151 | Train Acc: 0.6231
 Site-MNIST_M                       | Train Loss: 1.3115 | Train Acc: 0.6562
 Site-SVHN                          | Train Loss: 1.8691 | Train Acc: 0.3504
Average Train Accuracy: 0.6893
 Site-MNIST                         | Val  Loss: 0.3288 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.3779 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5331 | Val  Acc: 0.6412
 Site-MNIST_M                       | Val  Loss: 1.2881 | Val  Acc: 0.6437
 Site-SVHN                          | Val  Loss: 1.8512 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6813
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6412
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.6437
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 39 ============
denominator: 7810.9921875
 Site-MNIST                         | Train Loss: 0.3637 | Train Acc: 0.8999
 Site-USPS                          | Train Loss: 0.3058 | Train Acc: 0.9192
 Site-SynthDigits                   | Train Loss: 1.1803 | Train Acc: 0.6269
 Site-MNIST_M                       | Train Loss: 1.2954 | Train Acc: 0.6562
 Site-SVHN                          | Train Loss: 1.8636 | Train Acc: 0.3504
Average Train Accuracy: 0.6905
 Site-MNIST                         | Val  Loss: 0.3295 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.3755 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.4928 | Val  Acc: 0.6183
 Site-MNIST_M                       | Val  Loss: 1.2778 | Val  Acc: 0.6207
 Site-SVHN                          | Val  Loss: 1.8254 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6735
============ Train epoch 40 ============
denominator: 7853.1943359375
 Site-MNIST                         | Train Loss: 0.3493 | Train Acc: 0.9050
 Site-USPS                          | Train Loss: 0.2953 | Train Acc: 0.9217
 Site-SynthDigits                   | Train Loss: 1.2308 | Train Acc: 0.6288
 Site-MNIST_M                       | Train Loss: 1.2907 | Train Acc: 0.6619
 Site-SVHN                          | Train Loss: 1.8642 | Train Acc: 0.3504
Average Train Accuracy: 0.6936
 Site-MNIST                         | Val  Loss: 0.3170 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.3609 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.4907 | Val  Acc: 0.6336
 Site-MNIST_M                       | Val  Loss: 1.2497 | Val  Acc: 0.6437
 Site-SVHN                          | Val  Loss: 1.8335 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6832
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9091
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9192
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6336
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6437
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 41 ============
denominator: 7769.1298828125
 Site-MNIST                         | Train Loss: 0.3379 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.2867 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.1932 | Train Acc: 0.6307
 Site-MNIST_M                       | Train Loss: 1.2787 | Train Acc: 0.6733
 Site-SVHN                          | Train Loss: 1.8404 | Train Acc: 0.3590
Average Train Accuracy: 0.6980
 Site-MNIST                         | Val  Loss: 0.3054 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.3559 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.4711 | Val  Acc: 0.6031
 Site-MNIST_M                       | Val  Loss: 1.2500 | Val  Acc: 0.6667
 Site-SVHN                          | Val  Loss: 1.8007 | Val  Acc: 0.3448
Average Valid Accuracy: 0.6865
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9091
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6031
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.6667
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 42 ============
denominator: 7658.4990234375
 Site-MNIST                         | Train Loss: 0.3353 | Train Acc: 0.9075
 Site-USPS                          | Train Loss: 0.2802 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.2181 | Train Acc: 0.6383
 Site-MNIST_M                       | Train Loss: 1.2660 | Train Acc: 0.6733
 Site-SVHN                          | Train Loss: 1.8398 | Train Acc: 0.3504
Average Train Accuracy: 0.6987
 Site-MNIST                         | Val  Loss: 0.3003 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.3496 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.4640 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.2277 | Val  Acc: 0.6437
 Site-SVHN                          | Val  Loss: 1.8100 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6861
============ Train epoch 43 ============
denominator: 7660.22705078125
 Site-MNIST                         | Train Loss: 0.3259 | Train Acc: 0.9066
 Site-USPS                          | Train Loss: 0.2799 | Train Acc: 0.9268
 Site-SynthDigits                   | Train Loss: 1.1733 | Train Acc: 0.6477
 Site-MNIST_M                       | Train Loss: 1.2387 | Train Acc: 0.6847
 Site-SVHN                          | Train Loss: 1.8191 | Train Acc: 0.3718
Average Train Accuracy: 0.7075
 Site-MNIST                         | Val  Loss: 0.2955 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.3546 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.4641 | Val  Acc: 0.6336
 Site-MNIST_M                       | Val  Loss: 1.2169 | Val  Acc: 0.6782
 Site-SVHN                          | Val  Loss: 1.7950 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6945
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9192
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6336
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6782
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 44 ============
denominator: 7562.560546875
 Site-MNIST                         | Train Loss: 0.3175 | Train Acc: 0.9125
 Site-USPS                          | Train Loss: 0.2770 | Train Acc: 0.9230
 Site-SynthDigits                   | Train Loss: 1.1678 | Train Acc: 0.6439
 Site-MNIST_M                       | Train Loss: 1.2174 | Train Acc: 0.6960
 Site-SVHN                          | Train Loss: 1.8262 | Train Acc: 0.3462
Average Train Accuracy: 0.7043
 Site-MNIST                         | Val  Loss: 0.2850 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.3377 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.4645 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.1972 | Val  Acc: 0.6667
 Site-SVHN                          | Val  Loss: 1.7978 | Val  Acc: 0.3621
Average Valid Accuracy: 0.6983
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9226
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6260
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6667
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.3621
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 45 ============
denominator: 7500.921875
 Site-MNIST                         | Train Loss: 0.3105 | Train Acc: 0.9108
 Site-USPS                          | Train Loss: 0.2624 | Train Acc: 0.9268
 Site-SynthDigits                   | Train Loss: 1.1528 | Train Acc: 0.6458
 Site-MNIST_M                       | Train Loss: 1.2216 | Train Acc: 0.6903
 Site-SVHN                          | Train Loss: 1.8038 | Train Acc: 0.3803
Average Train Accuracy: 0.7108
 Site-MNIST                         | Val  Loss: 0.2773 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.3353 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.4519 | Val  Acc: 0.6336
 Site-MNIST_M                       | Val  Loss: 1.1876 | Val  Acc: 0.6782
 Site-SVHN                          | Val  Loss: 1.7842 | Val  Acc: 0.3621
Average Valid Accuracy: 0.7008
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.6336
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.6782
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3621
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 46 ============
denominator: 7485.916015625
 Site-MNIST                         | Train Loss: 0.2955 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.2494 | Train Acc: 0.9331
 Site-SynthDigits                   | Train Loss: 1.1490 | Train Acc: 0.6477
 Site-MNIST_M                       | Train Loss: 1.2000 | Train Acc: 0.6989
 Site-SVHN                          | Train Loss: 1.8175 | Train Acc: 0.3632
Average Train Accuracy: 0.7114
 Site-MNIST                         | Val  Loss: 0.2672 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.3310 | Val  Acc: 0.9242
 Site-SynthDigits                   | Val  Loss: 1.4468 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.1706 | Val  Acc: 0.6782
 Site-SVHN                          | Val  Loss: 1.8024 | Val  Acc: 0.3621
Average Valid Accuracy: 0.7026
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9226
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9242
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6260
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6782
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3621
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 47 ============
denominator: 7489.4296875
 Site-MNIST                         | Train Loss: 0.3055 | Train Acc: 0.9125
 Site-USPS                          | Train Loss: 0.2540 | Train Acc: 0.9293
 Site-SynthDigits                   | Train Loss: 1.1315 | Train Acc: 0.6629
 Site-MNIST_M                       | Train Loss: 1.1781 | Train Acc: 0.6932
 Site-SVHN                          | Train Loss: 1.7988 | Train Acc: 0.3889
Average Train Accuracy: 0.7174
 Site-MNIST                         | Val  Loss: 0.2723 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.3293 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.3836 | Val  Acc: 0.6412
 Site-MNIST_M                       | Val  Loss: 1.1533 | Val  Acc: 0.6667
 Site-SVHN                          | Val  Loss: 1.7513 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7034
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9141
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.6412
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.6667
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_distinct/q-ffl...
============ Train epoch 48 ============
denominator: 7473.8173828125
 Site-MNIST                         | Train Loss: 0.2917 | Train Acc: 0.9176
 Site-USPS                          | Train Loss: 0.2530 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.1407 | Train Acc: 0.6591
 Site-MNIST_M                       | Train Loss: 1.1739 | Train Acc: 0.6989
 Site-SVHN                          | Train Loss: 1.8061 | Train Acc: 0.3632
Average Train Accuracy: 0.7141
 Site-MNIST                         | Val  Loss: 0.2585 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.3187 | Val  Acc: 0.9192
 Site-SynthDigits                   | Val  Loss: 1.4247 | Val  Acc: 0.6260
 Site-MNIST_M                       | Val  Loss: 1.1388 | Val  Acc: 0.6897
 Site-SVHN                          | Val  Loss: 1.7748 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7018
============ Train epoch 49 ============
denominator: 7382.19873046875
 Site-MNIST                         | Train Loss: 0.2891 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.2411 | Train Acc: 0.9306
 Site-SynthDigits                   | Train Loss: 1.1244 | Train Acc: 0.6648
 Site-MNIST_M                       | Train Loss: 1.1554 | Train Acc: 0.7045
 Site-SVHN                          | Train Loss: 1.7957 | Train Acc: 0.3803
Average Train Accuracy: 0.7201
 Site-MNIST                         | Val  Loss: 0.2552 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.3192 | Val  Acc: 0.9141
 Site-SynthDigits                   | Val  Loss: 1.3814 | Val  Acc: 0.6412
 Site-MNIST_M                       | Val  Loss: 1.1265 | Val  Acc: 0.6782
 Site-SVHN                          | Val  Loss: 1.7493 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6967
===2023-07-02 15:09:00===
===2023-07-02 15:09:05===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,792,528,352,234,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.8931
 Test site-USPS                      | Epoch:47 | Test Acc: 0.9097
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.6096
 Test site-MNIST_M                   | Epoch:47 | Test Acc: 0.4540
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.3102
MNIST: 0.8931, USPS: 0.9097, SynthDigits: 0.6096, MNIST_M: 0.4540, SVHN: 0.3102, 
Average Test Accuracy(group): 0.6353, Average Test Accuracy(individual): 0.6353,
domain std=0.2371, cluster std=-1.0000, individual std=0.2371, 
