===2023-06-13 12:11:12===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: True
data_number=[18,26,39,57,84,124,182,268,393,579,30,44,65,96,141,208,306,37,55,81,119,176,69,101,149,74,109,125,85,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[5912,2980,1573,1070,616,419,285,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[3, 4, 8, 4, 9, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.0319 | Train Acc: 0.3333
 Site-White_utk                 (4) | Train Loss: 2.0827 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2144 | Train Acc: 0.1282
 Site-White_utk                 (4) | Train Loss: 2.2037 | Train Acc: 0.0877
 Site-White_utk                 (4) | Train Loss: 2.1814 | Train Acc: 0.1310
 Site-White_utk                 (0) | Train Loss: 2.1194 | Train Acc: 0.1613
 Site-White_utk                 (4) | Train Loss: 2.1461 | Train Acc: 0.1538
 Site-White_utk                 (4) | Train Loss: 2.1669 | Train Acc: 0.1418
 Site-White_utk                 (4) | Train Loss: 2.1346 | Train Acc: 0.1450
 Site-White_utk                 (4) | Train Loss: 2.1259 | Train Acc: 0.1451
 Site-White                     (2) | Train Loss: 1.9227 | Train Acc: 0.3667
 Site-White                     (2) | Train Loss: 1.9839 | Train Acc: 0.2955
 Site-White                     (2) | Train Loss: 1.9232 | Train Acc: 0.2769
 Site-White                     (2) | Train Loss: 1.9578 | Train Acc: 0.3958
 Site-White                     (2) | Train Loss: 2.0012 | Train Acc: 0.2979
 Site-White                     (2) | Train Loss: 1.9951 | Train Acc: 0.3173
 Site-White                     (2) | Train Loss: 1.9772 | Train Acc: 0.3268
 Site-Black_utk                 (5) | Train Loss: 2.0245 | Train Acc: 0.2432
 Site-Black_utk                 (3) | Train Loss: 2.0210 | Train Acc: 0.2364
 Site-Black_utk                 (3) | Train Loss: 2.0036 | Train Acc: 0.3210
 Site-Black_utk                 (3) | Train Loss: 2.0317 | Train Acc: 0.2605
 Site-Black_utk                 (3) | Train Loss: 2.0666 | Train Acc: 0.2273
 Site-Latino_Hispanic           (1) | Train Loss: 2.1233 | Train Acc: 0.2029
 Site-Latino_Hispanic           (1) | Train Loss: 2.0161 | Train Acc: 0.3069
 Site-Latino_Hispanic           (1) | Train Loss: 2.0586 | Train Acc: 0.2215
 Site-Indian_utk                (4) | Train Loss: 2.0025 | Train Acc: 0.2297
 Site-Indian_utk                (0) | Train Loss: 2.0037 | Train Acc: 0.3486
 Site-Southeast_Asian           (1) | Train Loss: 2.0483 | Train Acc: 0.2560
 Site-Middle_Eastern            (2) | Train Loss: 2.0861 | Train Acc: 0.2235
Average Train Accuracy: 0.2378
 Site-White_utk                 (0) | Val  Loss: 2.2195 | Val  Acc: 0.2500
 Site-White_utk                 (4) | Val  Loss: 2.1253 | Val  Acc: 0.1176
 Site-White_utk                 (4) | Val  Loss: 2.1644 | Val  Acc: 0.1538
 Site-White_utk                 (4) | Val  Loss: 2.1454 | Val  Acc: 0.2105
 Site-White_utk                 (4) | Val  Loss: 2.1430 | Val  Acc: 0.1250
 Site-White_utk                 (0) | Val  Loss: 2.1254 | Val  Acc: 0.1341
 Site-White_utk                 (4) | Val  Loss: 2.1429 | Val  Acc: 0.1405
 Site-White_utk                 (4) | Val  Loss: 2.1382 | Val  Acc: 0.1629
 Site-White_utk                 (4) | Val  Loss: 2.1304 | Val  Acc: 0.1374
 Site-White_utk                 (4) | Val  Loss: 2.1701 | Val  Acc: 0.1218
 Site-White                     (2) | Val  Loss: 1.8563 | Val  Acc: 0.4000
 Site-White                     (2) | Val  Loss: 1.9733 | Val  Acc: 0.3103
 Site-White                     (2) | Val  Loss: 1.9418 | Val  Acc: 0.3256
 Site-White                     (2) | Val  Loss: 1.9768 | Val  Acc: 0.3906
 Site-White                     (2) | Val  Loss: 1.9892 | Val  Acc: 0.3298
 Site-White                     (2) | Val  Loss: 2.0285 | Val  Acc: 0.2878
 Site-White                     (2) | Val  Loss: 1.9672 | Val  Acc: 0.3039
 Site-Black_utk                 (5) | Val  Loss: 2.0055 | Val  Acc: 0.3200
 Site-Black_utk                 (3) | Val  Loss: 1.9705 | Val  Acc: 0.3611
 Site-Black_utk                 (3) | Val  Loss: 2.0548 | Val  Acc: 0.2407
 Site-Black_utk                 (3) | Val  Loss: 2.0328 | Val  Acc: 0.2785
 Site-Black_utk                 (3) | Val  Loss: 2.0216 | Val  Acc: 0.2906
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9978 | Val  Acc: 0.3478
 Site-Latino_Hispanic           (1) | Val  Loss: 2.0488 | Val  Acc: 0.2687
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9895 | Val  Acc: 0.3434
 Site-Indian_utk                (4) | Val  Loss: 2.0271 | Val  Acc: 0.2653
 Site-Indian_utk                (0) | Val  Loss: 2.0343 | Val  Acc: 0.4521
 Site-Southeast_Asian           (1) | Val  Loss: 2.0179 | Val  Acc: 0.2289
 Site-Middle_Eastern            (2) | Val  Loss: 2.1052 | Val  Acc: 0.1754
Average Valid Accuracy: 0.2577
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1538
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.2105
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1341
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1405
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1629
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1374
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1218
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.4000
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.3103
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.3256
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.3906
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.3298
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.2878
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.3039
 Best site-Black_utk                (5)  | Epoch:0 | Val Acc: 0.3200
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.3611
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.2407
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.2785
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.2906
 Best site-Latino_Hispanic          (1)  | Epoch:0 | Val Acc: 0.3478
 Best site-Latino_Hispanic          (1)  | Epoch:0 | Val Acc: 0.2687
 Best site-Latino_Hispanic          (1)  | Epoch:0 | Val Acc: 0.3434
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2653
 Best site-Indian_utk               (0)  | Epoch:0 | Val Acc: 0.4521
 Best site-Southeast_Asian          (1)  | Epoch:0 | Val Acc: 0.2289
 Best site-Middle_Eastern           (2)  | Epoch:0 | Val Acc: 0.1754
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 12, 1, 5, 1, 9, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (4) | Train Loss: 1.9319 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 2.0213 | Train Acc: 0.1154
 Site-White_utk                 (5) | Train Loss: 2.0829 | Train Acc: 0.2564
 Site-White_utk                 (2) | Train Loss: 2.1081 | Train Acc: 0.1930
 Site-White_utk                 (0) | Train Loss: 2.0337 | Train Acc: 0.2143
 Site-White_utk                 (5) | Train Loss: 2.0461 | Train Acc: 0.1855
 Site-White_utk                 (5) | Train Loss: 2.0365 | Train Acc: 0.2088
 Site-White_utk                 (5) | Train Loss: 2.0406 | Train Acc: 0.1940
 Site-White_utk                 (5) | Train Loss: 2.0129 | Train Acc: 0.2036
 Site-White_utk                 (5) | Train Loss: 2.0123 | Train Acc: 0.2263
 Site-White                     (1) | Train Loss: 1.8733 | Train Acc: 0.4000
 Site-White                     (1) | Train Loss: 1.9122 | Train Acc: 0.3182
 Site-White                     (1) | Train Loss: 1.8249 | Train Acc: 0.3385
 Site-White                     (1) | Train Loss: 1.8819 | Train Acc: 0.3438
 Site-White                     (1) | Train Loss: 1.9637 | Train Acc: 0.3050
 Site-White                     (1) | Train Loss: 1.9446 | Train Acc: 0.3029
 Site-White                     (1) | Train Loss: 1.9128 | Train Acc: 0.3431
 Site-Black_utk                 (3) | Train Loss: 1.8436 | Train Acc: 0.4595
 Site-Black_utk                 (3) | Train Loss: 1.9734 | Train Acc: 0.3091
 Site-Black_utk                 (3) | Train Loss: 1.9267 | Train Acc: 0.2840
 Site-Black_utk                 (3) | Train Loss: 1.9841 | Train Acc: 0.2941
 Site-Black_utk                 (3) | Train Loss: 2.0008 | Train Acc: 0.2841
 Site-Latino_Hispanic           (1) | Train Loss: 2.1791 | Train Acc: 0.2174
 Site-Latino_Hispanic           (1) | Train Loss: 1.9552 | Train Acc: 0.3267
 Site-Latino_Hispanic           (1) | Train Loss: 2.0255 | Train Acc: 0.2416
 Site-Indian_utk                (5) | Train Loss: 2.0386 | Train Acc: 0.2973
 Site-Indian_utk                (5) | Train Loss: 1.9265 | Train Acc: 0.3119
 Site-Southeast_Asian           (1) | Train Loss: 1.9837 | Train Acc: 0.2880
 Site-Middle_Eastern            (1) | Train Loss: 1.9858 | Train Acc: 0.2706
Average Train Accuracy: 0.2781
 Site-White_utk                 (4) | Val  Loss: 2.1529 | Val  Acc: 0.0833
 Site-White_utk                 (5) | Val  Loss: 2.0438 | Val  Acc: 0.1765
 Site-White_utk                 (5) | Val  Loss: 2.0408 | Val  Acc: 0.2308
 Site-White_utk                 (2) | Val  Loss: 2.0779 | Val  Acc: 0.1842
 Site-White_utk                 (0) | Val  Loss: 2.0575 | Val  Acc: 0.1429
 Site-White_utk                 (5) | Val  Loss: 2.0563 | Val  Acc: 0.1707
 Site-White_utk                 (5) | Val  Loss: 2.0052 | Val  Acc: 0.2479
 Site-White_utk                 (5) | Val  Loss: 2.0113 | Val  Acc: 0.2303
 Site-White_utk                 (5) | Val  Loss: 2.0235 | Val  Acc: 0.2023
 Site-White_utk                 (5) | Val  Loss: 2.0438 | Val  Acc: 0.2021
 Site-White                     (1) | Val  Loss: 1.7417 | Val  Acc: 0.3500
 Site-White                     (1) | Val  Loss: 1.9611 | Val  Acc: 0.3793
 Site-White                     (1) | Val  Loss: 1.9036 | Val  Acc: 0.4419
 Site-White                     (1) | Val  Loss: 1.8813 | Val  Acc: 0.3594
 Site-White                     (1) | Val  Loss: 1.8820 | Val  Acc: 0.3298
 Site-White                     (1) | Val  Loss: 1.9592 | Val  Acc: 0.3309
 Site-White                     (1) | Val  Loss: 1.9089 | Val  Acc: 0.3284
 Site-Black_utk                 (3) | Val  Loss: 1.9924 | Val  Acc: 0.3200
 Site-Black_utk                 (3) | Val  Loss: 1.8940 | Val  Acc: 0.3611
 Site-Black_utk                 (3) | Val  Loss: 1.9362 | Val  Acc: 0.3704
 Site-Black_utk                 (3) | Val  Loss: 1.9343 | Val  Acc: 0.3671
 Site-Black_utk                 (3) | Val  Loss: 1.9854 | Val  Acc: 0.2308
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9087 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9753 | Val  Acc: 0.2239
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9404 | Val  Acc: 0.3232
 Site-Indian_utk                (5) | Val  Loss: 1.9633 | Val  Acc: 0.2041
 Site-Indian_utk                (5) | Val  Loss: 1.9481 | Val  Acc: 0.3562
 Site-Southeast_Asian           (1) | Val  Loss: 1.9546 | Val  Acc: 0.2892
 Site-Middle_Eastern            (1) | Val  Loss: 2.0593 | Val  Acc: 0.1754
Average Valid Accuracy: 0.2737
 Best site-White_utk                (4)  | Epoch:1 | Val Acc: 0.0833
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1765
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.2308
 Best site-White_utk                (2)  | Epoch:1 | Val Acc: 0.1842
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1429
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1707
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.2479
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.2303
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.2023
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.2021
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3500
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3793
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.4419
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3594
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3298
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3309
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3284
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.3200
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.3611
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.3704
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.3671
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.2308
 Best site-Latino_Hispanic          (1)  | Epoch:1 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (1)  | Epoch:1 | Val Acc: 0.2239
 Best site-Latino_Hispanic          (1)  | Epoch:1 | Val Acc: 0.3232
 Best site-Indian_utk               (5)  | Epoch:1 | Val Acc: 0.2041
 Best site-Indian_utk               (5)  | Epoch:1 | Val Acc: 0.3562
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2892
 Best site-Middle_Eastern           (1)  | Epoch:1 | Val Acc: 0.1754
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 11, 10, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (5) | Train Loss: 1.7621 | Train Acc: 0.5000
 Site-White_utk                 (2) | Train Loss: 1.8834 | Train Acc: 0.1538
 Site-White_utk                 (2) | Train Loss: 1.9848 | Train Acc: 0.2051
 Site-White_utk                 (0) | Train Loss: 1.9448 | Train Acc: 0.2632
 Site-White_utk                 (2) | Train Loss: 1.9802 | Train Acc: 0.2381
 Site-White_utk                 (2) | Train Loss: 1.9095 | Train Acc: 0.2903
 Site-White_utk                 (2) | Train Loss: 1.9679 | Train Acc: 0.2418
 Site-White_utk                 (2) | Train Loss: 1.9477 | Train Acc: 0.2463
 Site-White_utk                 (2) | Train Loss: 1.9315 | Train Acc: 0.3079
 Site-White_utk                 (2) | Train Loss: 1.8815 | Train Acc: 0.2867
 Site-White                     (4) | Train Loss: 1.8254 | Train Acc: 0.3667
 Site-White                     (1) | Train Loss: 1.8764 | Train Acc: 0.3409
 Site-White                     (1) | Train Loss: 1.6223 | Train Acc: 0.3231
 Site-White                     (1) | Train Loss: 1.8252 | Train Acc: 0.3021
 Site-White                     (1) | Train Loss: 1.8414 | Train Acc: 0.3475
 Site-White                     (1) | Train Loss: 1.9221 | Train Acc: 0.3125
 Site-White                     (1) | Train Loss: 1.8570 | Train Acc: 0.3203
 Site-Black_utk                 (3) | Train Loss: 1.8399 | Train Acc: 0.3784
 Site-Black_utk                 (3) | Train Loss: 1.9061 | Train Acc: 0.3273
 Site-Black_utk                 (3) | Train Loss: 1.9901 | Train Acc: 0.2716
 Site-Black_utk                 (3) | Train Loss: 1.9843 | Train Acc: 0.2521
 Site-Black_utk                 (3) | Train Loss: 2.0216 | Train Acc: 0.2216
 Site-Latino_Hispanic           (1) | Train Loss: 1.9993 | Train Acc: 0.1884
 Site-Latino_Hispanic           (1) | Train Loss: 1.9005 | Train Acc: 0.3465
 Site-Latino_Hispanic           (1) | Train Loss: 1.9064 | Train Acc: 0.2349
 Site-Indian_utk                (2) | Train Loss: 1.9944 | Train Acc: 0.2568
 Site-Indian_utk                (2) | Train Loss: 1.8925 | Train Acc: 0.2569
 Site-Southeast_Asian           (1) | Train Loss: 1.9569 | Train Acc: 0.2880
 Site-Middle_Eastern            (1) | Train Loss: 1.9620 | Train Acc: 0.2706
Average Train Accuracy: 0.2876
 Site-White_utk                 (5) | Val  Loss: 1.9324 | Val  Acc: 0.3333
 Site-White_utk                 (2) | Val  Loss: 1.9458 | Val  Acc: 0.1765
 Site-White_utk                 (2) | Val  Loss: 1.8588 | Val  Acc: 0.3846
 Site-White_utk                 (0) | Val  Loss: 1.9449 | Val  Acc: 0.2632
 Site-White_utk                 (2) | Val  Loss: 1.9455 | Val  Acc: 0.3214
 Site-White_utk                 (2) | Val  Loss: 1.9026 | Val  Acc: 0.2927
 Site-White_utk                 (2) | Val  Loss: 1.8499 | Val  Acc: 0.3884
 Site-White_utk                 (2) | Val  Loss: 1.9154 | Val  Acc: 0.3371
 Site-White_utk                 (2) | Val  Loss: 1.9290 | Val  Acc: 0.2863
 Site-White_utk                 (2) | Val  Loss: 1.9063 | Val  Acc: 0.2513
 Site-White                     (4) | Val  Loss: 1.7263 | Val  Acc: 0.3500
 Site-White                     (1) | Val  Loss: 1.8861 | Val  Acc: 0.1724
 Site-White                     (1) | Val  Loss: 1.8371 | Val  Acc: 0.3953
 Site-White                     (1) | Val  Loss: 1.8862 | Val  Acc: 0.2812
 Site-White                     (1) | Val  Loss: 1.8572 | Val  Acc: 0.3404
 Site-White                     (1) | Val  Loss: 1.9005 | Val  Acc: 0.2734
 Site-White                     (1) | Val  Loss: 1.8589 | Val  Acc: 0.3186
 Site-Black_utk                 (3) | Val  Loss: 2.0866 | Val  Acc: 0.1200
 Site-Black_utk                 (3) | Val  Loss: 1.9629 | Val  Acc: 0.1944
 Site-Black_utk                 (3) | Val  Loss: 1.9293 | Val  Acc: 0.2407
 Site-Black_utk                 (3) | Val  Loss: 1.9287 | Val  Acc: 0.2658
 Site-Black_utk                 (3) | Val  Loss: 1.9504 | Val  Acc: 0.2735
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9051 | Val  Acc: 0.2174
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9041 | Val  Acc: 0.2537
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8861 | Val  Acc: 0.2929
 Site-Indian_utk                (2) | Val  Loss: 1.9142 | Val  Acc: 0.2653
 Site-Indian_utk                (2) | Val  Loss: 1.9435 | Val  Acc: 0.2877
 Site-Southeast_Asian           (1) | Val  Loss: 1.8824 | Val  Acc: 0.2410
 Site-Middle_Eastern            (1) | Val  Loss: 2.0334 | Val  Acc: 0.1579
Average Valid Accuracy: 0.2751
 Best site-White_utk                (5)  | Epoch:2 | Val Acc: 0.3333
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.1765
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.3846
 Best site-White_utk                (0)  | Epoch:2 | Val Acc: 0.2632
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.3214
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.2927
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.3884
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.3371
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.2863
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.2513
 Best site-White                    (4)  | Epoch:2 | Val Acc: 0.3500
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.1724
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3953
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.2812
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3404
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.2734
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3186
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.1200
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.1944
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.2407
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.2658
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.2735
 Best site-Latino_Hispanic          (1)  | Epoch:2 | Val Acc: 0.2174
 Best site-Latino_Hispanic          (1)  | Epoch:2 | Val Acc: 0.2537
 Best site-Latino_Hispanic          (1)  | Epoch:2 | Val Acc: 0.2929
 Best site-Indian_utk               (2)  | Epoch:2 | Val Acc: 0.2653
 Best site-Indian_utk               (2)  | Epoch:2 | Val Acc: 0.2877
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.2410
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.1579
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 2, 6, 9, 6, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (0) | Train Loss: 1.6986 | Train Acc: 0.5556
 Site-White_utk                 (0) | Train Loss: 1.7271 | Train Acc: 0.3462
 Site-White_utk                 (4) | Train Loss: 1.8707 | Train Acc: 0.2051
 Site-White_utk                 (0) | Train Loss: 1.8870 | Train Acc: 0.2807
 Site-White_utk                 (4) | Train Loss: 1.8851 | Train Acc: 0.2738
 Site-White_utk                 (0) | Train Loss: 1.8468 | Train Acc: 0.2984
 Site-White_utk                 (4) | Train Loss: 1.8797 | Train Acc: 0.2967
 Site-White_utk                 (4) | Train Loss: 1.9023 | Train Acc: 0.2910
 Site-White_utk                 (4) | Train Loss: 1.8435 | Train Acc: 0.3359
 Site-White_utk                 (4) | Train Loss: 1.8038 | Train Acc: 0.3005
 Site-White                     (5) | Train Loss: 1.6964 | Train Acc: 0.3667
 Site-White                     (3) | Train Loss: 1.8026 | Train Acc: 0.3636
 Site-White                     (1) | Train Loss: 2.0732 | Train Acc: 0.3231
 Site-White                     (3) | Train Loss: 1.7509 | Train Acc: 0.3958
 Site-White                     (3) | Train Loss: 1.7565 | Train Acc: 0.3191
 Site-White                     (3) | Train Loss: 1.8113 | Train Acc: 0.3317
 Site-White                     (3) | Train Loss: 1.7552 | Train Acc: 0.3431
 Site-Black_utk                 (2) | Train Loss: 1.7426 | Train Acc: 0.3784
 Site-Black_utk                 (2) | Train Loss: 1.8152 | Train Acc: 0.3091
 Site-Black_utk                 (2) | Train Loss: 1.8867 | Train Acc: 0.2593
 Site-Black_utk                 (2) | Train Loss: 1.9118 | Train Acc: 0.3025
 Site-Black_utk                 (2) | Train Loss: 1.9051 | Train Acc: 0.2557
 Site-Latino_Hispanic           (3) | Train Loss: 1.7819 | Train Acc: 0.2609
 Site-Latino_Hispanic           (1) | Train Loss: 1.8737 | Train Acc: 0.3069
 Site-Latino_Hispanic           (3) | Train Loss: 1.9316 | Train Acc: 0.2550
 Site-Indian_utk                (2) | Train Loss: 1.8070 | Train Acc: 0.2973
 Site-Indian_utk                (0) | Train Loss: 1.7970 | Train Acc: 0.3394
 Site-Southeast_Asian           (3) | Train Loss: 1.9092 | Train Acc: 0.2480
 Site-Middle_Eastern            (3) | Train Loss: 1.9284 | Train Acc: 0.2941
Average Train Accuracy: 0.3150
 Site-White_utk                 (0) | Val  Loss: 1.8524 | Val  Acc: 0.4167
 Site-White_utk                 (0) | Val  Loss: 1.8263 | Val  Acc: 0.1765
 Site-White_utk                 (4) | Val  Loss: 1.8195 | Val  Acc: 0.2692
 Site-White_utk                 (0) | Val  Loss: 1.8902 | Val  Acc: 0.3421
 Site-White_utk                 (4) | Val  Loss: 1.8834 | Val  Acc: 0.2679
 Site-White_utk                 (0) | Val  Loss: 1.8839 | Val  Acc: 0.2439
 Site-White_utk                 (4) | Val  Loss: 1.8113 | Val  Acc: 0.2893
 Site-White_utk                 (4) | Val  Loss: 1.8457 | Val  Acc: 0.2921
 Site-White_utk                 (4) | Val  Loss: 1.8665 | Val  Acc: 0.2901
 Site-White_utk                 (4) | Val  Loss: 1.7922 | Val  Acc: 0.2876
 Site-White                     (5) | Val  Loss: 1.6132 | Val  Acc: 0.4500
 Site-White                     (3) | Val  Loss: 1.7945 | Val  Acc: 0.3103
 Site-White                     (1) | Val  Loss: 1.7300 | Val  Acc: 0.3953
 Site-White                     (3) | Val  Loss: 1.7942 | Val  Acc: 0.3125
 Site-White                     (3) | Val  Loss: 1.7605 | Val  Acc: 0.3830
 Site-White                     (3) | Val  Loss: 1.8003 | Val  Acc: 0.4029
 Site-White                     (3) | Val  Loss: 1.7462 | Val  Acc: 0.3676
 Site-Black_utk                 (2) | Val  Loss: 1.8748 | Val  Acc: 0.3600
 Site-Black_utk                 (2) | Val  Loss: 1.7823 | Val  Acc: 0.3333
 Site-Black_utk                 (2) | Val  Loss: 1.8716 | Val  Acc: 0.2222
 Site-Black_utk                 (2) | Val  Loss: 1.8444 | Val  Acc: 0.2785
 Site-Black_utk                 (2) | Val  Loss: 1.8318 | Val  Acc: 0.3248
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8127 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8599 | Val  Acc: 0.2985
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8202 | Val  Acc: 0.3636
 Site-Indian_utk                (2) | Val  Loss: 1.8211 | Val  Acc: 0.3061
 Site-Indian_utk                (0) | Val  Loss: 1.8889 | Val  Acc: 0.2740
 Site-Southeast_Asian           (3) | Val  Loss: 1.8518 | Val  Acc: 0.3133
 Site-Middle_Eastern            (3) | Val  Loss: 1.9314 | Val  Acc: 0.2632
Average Valid Accuracy: 0.3151
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.4167
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1765
 Best site-White_utk                (4)  | Epoch:3 | Val Acc: 0.2692
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.3421
 Best site-White_utk                (4)  | Epoch:3 | Val Acc: 0.2679
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.2439
 Best site-White_utk                (4)  | Epoch:3 | Val Acc: 0.2893
 Best site-White_utk                (4)  | Epoch:3 | Val Acc: 0.2921
 Best site-White_utk                (4)  | Epoch:3 | Val Acc: 0.2901
 Best site-White_utk                (4)  | Epoch:3 | Val Acc: 0.2876
 Best site-White                    (5)  | Epoch:3 | Val Acc: 0.4500
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3103
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.3953
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3125
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3830
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.4029
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3676
 Best site-Black_utk                (2)  | Epoch:3 | Val Acc: 0.3600
 Best site-Black_utk                (2)  | Epoch:3 | Val Acc: 0.3333
 Best site-Black_utk                (2)  | Epoch:3 | Val Acc: 0.2222
 Best site-Black_utk                (2)  | Epoch:3 | Val Acc: 0.2785
 Best site-Black_utk                (2)  | Epoch:3 | Val Acc: 0.3248
 Best site-Latino_Hispanic          (3)  | Epoch:3 | Val Acc: 0.3043
 Best site-Latino_Hispanic          (1)  | Epoch:3 | Val Acc: 0.2985
 Best site-Latino_Hispanic          (3)  | Epoch:3 | Val Acc: 0.3636
 Best site-Indian_utk               (2)  | Epoch:3 | Val Acc: 0.3061
 Best site-Indian_utk               (0)  | Epoch:3 | Val Acc: 0.2740
 Best site-Southeast_Asian          (3)  | Epoch:3 | Val Acc: 0.3133
 Best site-Middle_Eastern           (3)  | Epoch:3 | Val Acc: 0.2632
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 12, 3, 10, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk                 (3) | Train Loss: 1.6859 | Train Acc: 0.4444
 Site-White_utk                 (3) | Train Loss: 1.6872 | Train Acc: 0.2308
 Site-White_utk                 (3) | Train Loss: 1.7441 | Train Acc: 0.3077
 Site-White_utk                 (3) | Train Loss: 1.8112 | Train Acc: 0.3333
 Site-White_utk                 (3) | Train Loss: 1.8083 | Train Acc: 0.3214
 Site-White_utk                 (3) | Train Loss: 1.7532 | Train Acc: 0.3468
 Site-White_utk                 (3) | Train Loss: 1.8267 | Train Acc: 0.2747
 Site-White_utk                 (3) | Train Loss: 1.8029 | Train Acc: 0.3134
 Site-White_utk                 (3) | Train Loss: 1.7862 | Train Acc: 0.3333
 Site-White_utk                 (3) | Train Loss: 1.7443 | Train Acc: 0.3523
 Site-White                     (1) | Train Loss: 1.6999 | Train Acc: 0.4000
 Site-White                     (1) | Train Loss: 1.7425 | Train Acc: 0.4545
 Site-White                     (1) | Train Loss: 1.6361 | Train Acc: 0.2923
 Site-White                     (1) | Train Loss: 1.6585 | Train Acc: 0.4375
 Site-White                     (1) | Train Loss: 1.7377 | Train Acc: 0.3333
 Site-White                     (1) | Train Loss: 1.7345 | Train Acc: 0.4183
 Site-White                     (1) | Train Loss: 1.7377 | Train Acc: 0.3824
 Site-Black_utk                 (0) | Train Loss: 1.6788 | Train Acc: 0.4865
 Site-Black_utk                 (5) | Train Loss: 1.8259 | Train Acc: 0.3091
 Site-Black_utk                 (2) | Train Loss: 1.8304 | Train Acc: 0.2963
 Site-Black_utk                 (2) | Train Loss: 1.8350 | Train Acc: 0.2857
 Site-Black_utk                 (2) | Train Loss: 1.8805 | Train Acc: 0.2898
 Site-Latino_Hispanic           (1) | Train Loss: 1.9898 | Train Acc: 0.2754
 Site-Latino_Hispanic           (1) | Train Loss: 1.8520 | Train Acc: 0.3564
 Site-Latino_Hispanic           (1) | Train Loss: 1.8470 | Train Acc: 0.3020
 Site-Indian_utk                (4) | Train Loss: 1.6183 | Train Acc: 0.3919
 Site-Indian_utk                (4) | Train Loss: 1.7486 | Train Acc: 0.3394
 Site-Southeast_Asian           (1) | Train Loss: 1.8262 | Train Acc: 0.3600
 Site-Middle_Eastern            (1) | Train Loss: 1.8635 | Train Acc: 0.2824
Average Train Accuracy: 0.3432
 Site-White_utk                 (3) | Val  Loss: 1.8782 | Val  Acc: 0.4167
 Site-White_utk                 (3) | Val  Loss: 1.8095 | Val  Acc: 0.2353
 Site-White_utk                 (3) | Val  Loss: 1.7269 | Val  Acc: 0.3077
 Site-White_utk                 (3) | Val  Loss: 1.8064 | Val  Acc: 0.4211
 Site-White_utk                 (3) | Val  Loss: 1.8219 | Val  Acc: 0.3214
 Site-White_utk                 (3) | Val  Loss: 1.7602 | Val  Acc: 0.3293
 Site-White_utk                 (3) | Val  Loss: 1.7322 | Val  Acc: 0.3554
 Site-White_utk                 (3) | Val  Loss: 1.7757 | Val  Acc: 0.3034
 Site-White_utk                 (3) | Val  Loss: 1.8111 | Val  Acc: 0.3130
 Site-White_utk                 (3) | Val  Loss: 1.7265 | Val  Acc: 0.3187
 Site-White                     (1) | Val  Loss: 1.5902 | Val  Acc: 0.4500
 Site-White                     (1) | Val  Loss: 1.8161 | Val  Acc: 0.3103
 Site-White                     (1) | Val  Loss: 1.7107 | Val  Acc: 0.4651
 Site-White                     (1) | Val  Loss: 1.7879 | Val  Acc: 0.3438
 Site-White                     (1) | Val  Loss: 1.7741 | Val  Acc: 0.2872
 Site-White                     (1) | Val  Loss: 1.7673 | Val  Acc: 0.3669
 Site-White                     (1) | Val  Loss: 1.6842 | Val  Acc: 0.3627
 Site-Black_utk                 (0) | Val  Loss: 1.8569 | Val  Acc: 0.2800
 Site-Black_utk                 (5) | Val  Loss: 1.7475 | Val  Acc: 0.3056
 Site-Black_utk                 (2) | Val  Loss: 1.8289 | Val  Acc: 0.2963
 Site-Black_utk                 (2) | Val  Loss: 1.8269 | Val  Acc: 0.2658
 Site-Black_utk                 (2) | Val  Loss: 1.8064 | Val  Acc: 0.2991
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8231 | Val  Acc: 0.2826
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9245 | Val  Acc: 0.2836
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7937 | Val  Acc: 0.3535
 Site-Indian_utk                (4) | Val  Loss: 1.7516 | Val  Acc: 0.3673
 Site-Indian_utk                (4) | Val  Loss: 1.8590 | Val  Acc: 0.2877
 Site-Southeast_Asian           (1) | Val  Loss: 1.7508 | Val  Acc: 0.3614
 Site-Middle_Eastern            (1) | Val  Loss: 1.8825 | Val  Acc: 0.1930
Average Valid Accuracy: 0.3270
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.4167
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.2353
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.3077
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.4211
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.3214
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.3293
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.3554
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.3034
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.3130
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.3187
 Best site-White                    (1)  | Epoch:4 | Val Acc: 0.4500
 Best site-White                    (1)  | Epoch:4 | Val Acc: 0.3103
 Best site-White                    (1)  | Epoch:4 | Val Acc: 0.4651
 Best site-White                    (1)  | Epoch:4 | Val Acc: 0.3438
 Best site-White                    (1)  | Epoch:4 | Val Acc: 0.2872
 Best site-White                    (1)  | Epoch:4 | Val Acc: 0.3669
 Best site-White                    (1)  | Epoch:4 | Val Acc: 0.3627
 Best site-Black_utk                (0)  | Epoch:4 | Val Acc: 0.2800
 Best site-Black_utk                (5)  | Epoch:4 | Val Acc: 0.3056
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.2963
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.2658
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.2991
 Best site-Latino_Hispanic          (1)  | Epoch:4 | Val Acc: 0.2826
 Best site-Latino_Hispanic          (1)  | Epoch:4 | Val Acc: 0.2836
 Best site-Latino_Hispanic          (1)  | Epoch:4 | Val Acc: 0.3535
 Best site-Indian_utk               (4)  | Epoch:4 | Val Acc: 0.3673
 Best site-Indian_utk               (4)  | Epoch:4 | Val Acc: 0.2877
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.3614
 Best site-Middle_Eastern           (1)  | Epoch:4 | Val Acc: 0.1930
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 2, 10, 5, 5, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White_utk                 (2) | Train Loss: 1.6457 | Train Acc: 0.2778
 Site-White_utk                 (2) | Train Loss: 1.6232 | Train Acc: 0.3462
 Site-White_utk                 (2) | Train Loss: 1.7604 | Train Acc: 0.3077
 Site-White_utk                 (2) | Train Loss: 1.7408 | Train Acc: 0.2982
 Site-White_utk                 (2) | Train Loss: 1.7543 | Train Acc: 0.3810
 Site-White_utk                 (2) | Train Loss: 1.7182 | Train Acc: 0.3065
 Site-White_utk                 (2) | Train Loss: 1.7400 | Train Acc: 0.3187
 Site-White_utk                 (2) | Train Loss: 1.7334 | Train Acc: 0.3358
 Site-White_utk                 (2) | Train Loss: 1.7335 | Train Acc: 0.3613
 Site-White_utk                 (2) | Train Loss: 1.7226 | Train Acc: 0.3523
 Site-White                     (3) | Train Loss: 1.5604 | Train Acc: 0.5333
 Site-White                     (5) | Train Loss: 1.7601 | Train Acc: 0.3636
 Site-White                     (5) | Train Loss: 1.8448 | Train Acc: 0.3538
 Site-White                     (5) | Train Loss: 1.6271 | Train Acc: 0.4375
 Site-White                     (0) | Train Loss: 1.8123 | Train Acc: 0.3759
 Site-White                     (0) | Train Loss: 1.7176 | Train Acc: 0.4135
 Site-White                     (5) | Train Loss: 1.6641 | Train Acc: 0.3987
 Site-Black_utk                 (4) | Train Loss: 1.5911 | Train Acc: 0.5405
 Site-Black_utk                 (4) | Train Loss: 1.7268 | Train Acc: 0.4545
 Site-Black_utk                 (4) | Train Loss: 1.6585 | Train Acc: 0.4074
 Site-Black_utk                 (4) | Train Loss: 1.7589 | Train Acc: 0.4370
 Site-Black_utk                 (4) | Train Loss: 1.8038 | Train Acc: 0.3693
 Site-Latino_Hispanic           (3) | Train Loss: 2.1897 | Train Acc: 0.2899
 Site-Latino_Hispanic           (3) | Train Loss: 1.8129 | Train Acc: 0.3663
 Site-Latino_Hispanic           (3) | Train Loss: 1.8583 | Train Acc: 0.3154
 Site-Indian_utk                (1) | Train Loss: 1.6839 | Train Acc: 0.4054
 Site-Indian_utk                (1) | Train Loss: 1.6685 | Train Acc: 0.4312
 Site-Southeast_Asian           (3) | Train Loss: 1.8135 | Train Acc: 0.3600
 Site-Middle_Eastern            (0) | Train Loss: 1.9110 | Train Acc: 0.2941
Average Train Accuracy: 0.3735
 Site-White_utk                 (2) | Val  Loss: 1.8160 | Val  Acc: 0.3333
 Site-White_utk                 (2) | Val  Loss: 1.8167 | Val  Acc: 0.1765
 Site-White_utk                 (2) | Val  Loss: 1.7762 | Val  Acc: 0.2308
 Site-White_utk                 (2) | Val  Loss: 1.7752 | Val  Acc: 0.3421
 Site-White_utk                 (2) | Val  Loss: 1.7711 | Val  Acc: 0.3214
 Site-White_utk                 (2) | Val  Loss: 1.7517 | Val  Acc: 0.3415
 Site-White_utk                 (2) | Val  Loss: 1.6376 | Val  Acc: 0.4132
 Site-White_utk                 (2) | Val  Loss: 1.6999 | Val  Acc: 0.3764
 Site-White_utk                 (2) | Val  Loss: 1.7538 | Val  Acc: 0.3435
 Site-White_utk                 (2) | Val  Loss: 1.6576 | Val  Acc: 0.3187
 Site-White                     (3) | Val  Loss: 1.5627 | Val  Acc: 0.4500
 Site-White                     (5) | Val  Loss: 1.7329 | Val  Acc: 0.3793
 Site-White                     (5) | Val  Loss: 1.6263 | Val  Acc: 0.5349
 Site-White                     (5) | Val  Loss: 1.6822 | Val  Acc: 0.4375
 Site-White                     (0) | Val  Loss: 1.6842 | Val  Acc: 0.4255
 Site-White                     (0) | Val  Loss: 1.6794 | Val  Acc: 0.4101
 Site-White                     (5) | Val  Loss: 1.6322 | Val  Acc: 0.4069
 Site-Black_utk                 (4) | Val  Loss: 1.7552 | Val  Acc: 0.3200
 Site-Black_utk                 (4) | Val  Loss: 1.6701 | Val  Acc: 0.4722
 Site-Black_utk                 (4) | Val  Loss: 1.6977 | Val  Acc: 0.4259
 Site-Black_utk                 (4) | Val  Loss: 1.7291 | Val  Acc: 0.4051
 Site-Black_utk                 (4) | Val  Loss: 1.7453 | Val  Acc: 0.3504
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7806 | Val  Acc: 0.3478
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8524 | Val  Acc: 0.2836
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7773 | Val  Acc: 0.3333
 Site-Indian_utk                (1) | Val  Loss: 1.7261 | Val  Acc: 0.3265
 Site-Indian_utk                (1) | Val  Loss: 1.7455 | Val  Acc: 0.3836
 Site-Southeast_Asian           (3) | Val  Loss: 1.7099 | Val  Acc: 0.3855
 Site-Middle_Eastern            (0) | Val  Loss: 1.9607 | Val  Acc: 0.1579
Average Valid Accuracy: 0.3598
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.3333
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.1765
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2308
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.3421
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.3214
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.3415
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.4132
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.3764
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.3435
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.3187
 Best site-White                    (3)  | Epoch:5 | Val Acc: 0.4500
 Best site-White                    (5)  | Epoch:5 | Val Acc: 0.3793
 Best site-White                    (5)  | Epoch:5 | Val Acc: 0.5349
 Best site-White                    (5)  | Epoch:5 | Val Acc: 0.4375
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.4255
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.4101
 Best site-White                    (5)  | Epoch:5 | Val Acc: 0.4069
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.3200
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.4722
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.4259
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.4051
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.3504
 Best site-Latino_Hispanic          (3)  | Epoch:5 | Val Acc: 0.3478
 Best site-Latino_Hispanic          (3)  | Epoch:5 | Val Acc: 0.2836
 Best site-Latino_Hispanic          (3)  | Epoch:5 | Val Acc: 0.3333
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3265
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3836
 Best site-Southeast_Asian          (3)  | Epoch:5 | Val Acc: 0.3855
 Best site-Middle_Eastern           (0)  | Epoch:5 | Val Acc: 0.1579
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 6, 9, 5, 6, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White_utk                 (0) | Train Loss: 1.4682 | Train Acc: 0.5000
 Site-White_utk                 (2) | Train Loss: 1.4821 | Train Acc: 0.4231
 Site-White_utk                 (2) | Train Loss: 1.7239 | Train Acc: 0.2821
 Site-White_utk                 (2) | Train Loss: 1.6947 | Train Acc: 0.3684
 Site-White_utk                 (2) | Train Loss: 1.6805 | Train Acc: 0.2976
 Site-White_utk                 (2) | Train Loss: 1.6698 | Train Acc: 0.3629
 Site-White_utk                 (2) | Train Loss: 1.7326 | Train Acc: 0.3571
 Site-White_utk                 (2) | Train Loss: 1.6871 | Train Acc: 0.3470
 Site-White_utk                 (2) | Train Loss: 1.6642 | Train Acc: 0.4020
 Site-White_utk                 (2) | Train Loss: 1.6597 | Train Acc: 0.4041
 Site-White                     (4) | Train Loss: 1.5589 | Train Acc: 0.5667
 Site-White                     (1) | Train Loss: 1.7301 | Train Acc: 0.4091
 Site-White                     (4) | Train Loss: 1.7265 | Train Acc: 0.3846
 Site-White                     (1) | Train Loss: 1.6304 | Train Acc: 0.4375
 Site-White                     (1) | Train Loss: 1.7115 | Train Acc: 0.3830
 Site-White                     (4) | Train Loss: 1.6741 | Train Acc: 0.4279
 Site-White                     (4) | Train Loss: 1.6420 | Train Acc: 0.4150
 Site-Black_utk                 (3) | Train Loss: 1.5872 | Train Acc: 0.4865
 Site-Black_utk                 (3) | Train Loss: 1.7158 | Train Acc: 0.4364
 Site-Black_utk                 (3) | Train Loss: 1.7283 | Train Acc: 0.3827
 Site-Black_utk                 (3) | Train Loss: 1.7575 | Train Acc: 0.3866
 Site-Black_utk                 (3) | Train Loss: 1.7737 | Train Acc: 0.3580
 Site-Latino_Hispanic           (4) | Train Loss: 1.7628 | Train Acc: 0.2754
 Site-Latino_Hispanic           (4) | Train Loss: 1.7892 | Train Acc: 0.3366
 Site-Latino_Hispanic           (1) | Train Loss: 1.8451 | Train Acc: 0.2886
 Site-Indian_utk                (5) | Train Loss: 1.7184 | Train Acc: 0.3649
 Site-Indian_utk                (5) | Train Loss: 1.6755 | Train Acc: 0.3578
 Site-Southeast_Asian           (1) | Train Loss: 1.7506 | Train Acc: 0.3360
 Site-Middle_Eastern            (1) | Train Loss: 1.7576 | Train Acc: 0.3176
Average Train Accuracy: 0.3826
 Site-White_utk                 (0) | Val  Loss: 1.6796 | Val  Acc: 0.4167
 Site-White_utk                 (2) | Val  Loss: 1.7100 | Val  Acc: 0.2353
 Site-White_utk                 (2) | Val  Loss: 1.6843 | Val  Acc: 0.3077
 Site-White_utk                 (2) | Val  Loss: 1.7266 | Val  Acc: 0.3947
 Site-White_utk                 (2) | Val  Loss: 1.7363 | Val  Acc: 0.3571
 Site-White_utk                 (2) | Val  Loss: 1.6940 | Val  Acc: 0.3537
 Site-White_utk                 (2) | Val  Loss: 1.5944 | Val  Acc: 0.4628
 Site-White_utk                 (2) | Val  Loss: 1.6102 | Val  Acc: 0.4382
 Site-White_utk                 (2) | Val  Loss: 1.7107 | Val  Acc: 0.3664
 Site-White_utk                 (2) | Val  Loss: 1.5989 | Val  Acc: 0.3446
 Site-White                     (4) | Val  Loss: 1.5240 | Val  Acc: 0.4500
 Site-White                     (1) | Val  Loss: 1.7106 | Val  Acc: 0.3448
 Site-White                     (4) | Val  Loss: 1.6251 | Val  Acc: 0.4651
 Site-White                     (1) | Val  Loss: 1.7091 | Val  Acc: 0.4375
 Site-White                     (1) | Val  Loss: 1.7160 | Val  Acc: 0.4149
 Site-White                     (4) | Val  Loss: 1.6666 | Val  Acc: 0.4245
 Site-White                     (4) | Val  Loss: 1.5877 | Val  Acc: 0.4118
 Site-Black_utk                 (3) | Val  Loss: 1.7305 | Val  Acc: 0.4000
 Site-Black_utk                 (3) | Val  Loss: 1.6763 | Val  Acc: 0.3333
 Site-Black_utk                 (3) | Val  Loss: 1.6894 | Val  Acc: 0.4259
 Site-Black_utk                 (3) | Val  Loss: 1.7471 | Val  Acc: 0.3418
 Site-Black_utk                 (3) | Val  Loss: 1.7139 | Val  Acc: 0.3590
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7243 | Val  Acc: 0.3478
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8994 | Val  Acc: 0.3134
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7178 | Val  Acc: 0.3131
 Site-Indian_utk                (5) | Val  Loss: 1.6812 | Val  Acc: 0.3061
 Site-Indian_utk                (5) | Val  Loss: 1.7462 | Val  Acc: 0.3836
 Site-Southeast_Asian           (1) | Val  Loss: 1.7430 | Val  Acc: 0.3253
 Site-Middle_Eastern            (1) | Val  Loss: 1.9000 | Val  Acc: 0.1404
Average Valid Accuracy: 0.3661
 Best site-White_utk                (0)  | Epoch:6 | Val Acc: 0.4167
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2353
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.3077
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.3947
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.3571
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.3537
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.4628
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.4382
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.3664
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.3446
 Best site-White                    (4)  | Epoch:6 | Val Acc: 0.4500
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.3448
 Best site-White                    (4)  | Epoch:6 | Val Acc: 0.4651
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4375
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4149
 Best site-White                    (4)  | Epoch:6 | Val Acc: 0.4245
 Best site-White                    (4)  | Epoch:6 | Val Acc: 0.4118
 Best site-Black_utk                (3)  | Epoch:6 | Val Acc: 0.4000
 Best site-Black_utk                (3)  | Epoch:6 | Val Acc: 0.3333
 Best site-Black_utk                (3)  | Epoch:6 | Val Acc: 0.4259
 Best site-Black_utk                (3)  | Epoch:6 | Val Acc: 0.3418
 Best site-Black_utk                (3)  | Epoch:6 | Val Acc: 0.3590
 Best site-Latino_Hispanic          (4)  | Epoch:6 | Val Acc: 0.3478
 Best site-Latino_Hispanic          (4)  | Epoch:6 | Val Acc: 0.3134
 Best site-Latino_Hispanic          (1)  | Epoch:6 | Val Acc: 0.3131
 Best site-Indian_utk               (5)  | Epoch:6 | Val Acc: 0.3061
 Best site-Indian_utk               (5)  | Epoch:6 | Val Acc: 0.3836
 Best site-Southeast_Asian          (1)  | Epoch:6 | Val Acc: 0.3253
 Best site-Middle_Eastern           (1)  | Epoch:6 | Val Acc: 0.1404
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 1, 2, 11, 1, 9, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White_utk                 (4) | Train Loss: 1.4670 | Train Acc: 0.6111
 Site-White_utk                 (5) | Train Loss: 1.4628 | Train Acc: 0.4615
 Site-White_utk                 (5) | Train Loss: 1.6377 | Train Acc: 0.3846
 Site-White_utk                 (5) | Train Loss: 1.6130 | Train Acc: 0.4211
 Site-White_utk                 (5) | Train Loss: 1.5840 | Train Acc: 0.4286
 Site-White_utk                 (5) | Train Loss: 1.6345 | Train Acc: 0.3387
 Site-White_utk                 (5) | Train Loss: 1.6672 | Train Acc: 0.3462
 Site-White_utk                 (5) | Train Loss: 1.6677 | Train Acc: 0.3955
 Site-White_utk                 (5) | Train Loss: 1.5710 | Train Acc: 0.4198
 Site-White_utk                 (5) | Train Loss: 1.5820 | Train Acc: 0.4214
 Site-White                     (3) | Train Loss: 1.5243 | Train Acc: 0.4667
 Site-White                     (3) | Train Loss: 1.7000 | Train Acc: 0.3864
 Site-White                     (3) | Train Loss: 1.4934 | Train Acc: 0.3231
 Site-White                     (3) | Train Loss: 1.5791 | Train Acc: 0.4583
 Site-White                     (3) | Train Loss: 1.5929 | Train Acc: 0.3901
 Site-White                     (3) | Train Loss: 1.6670 | Train Acc: 0.3942
 Site-White                     (3) | Train Loss: 1.6146 | Train Acc: 0.4314
 Site-Black_utk                 (0) | Train Loss: 1.6154 | Train Acc: 0.4865
 Site-Black_utk                 (0) | Train Loss: 1.7122 | Train Acc: 0.3818
 Site-Black_utk                 (0) | Train Loss: 1.7409 | Train Acc: 0.3457
 Site-Black_utk                 (0) | Train Loss: 1.7263 | Train Acc: 0.3361
 Site-Black_utk                 (0) | Train Loss: 1.7589 | Train Acc: 0.3068
 Site-Latino_Hispanic           (3) | Train Loss: 1.6754 | Train Acc: 0.2754
 Site-Latino_Hispanic           (3) | Train Loss: 1.7351 | Train Acc: 0.4059
 Site-Latino_Hispanic           (3) | Train Loss: 1.7643 | Train Acc: 0.2886
 Site-Indian_utk                (2) | Train Loss: 1.6362 | Train Acc: 0.3784
 Site-Indian_utk                (2) | Train Loss: 1.6275 | Train Acc: 0.3945
 Site-Southeast_Asian           (3) | Train Loss: 1.7551 | Train Acc: 0.3440
 Site-Middle_Eastern            (1) | Train Loss: 1.6705 | Train Acc: 0.3647
Average Train Accuracy: 0.3927
 Site-White_utk                 (4) | Val  Loss: 1.7342 | Val  Acc: 0.5000
 Site-White_utk                 (5) | Val  Loss: 1.6497 | Val  Acc: 0.2353
 Site-White_utk                 (5) | Val  Loss: 1.6261 | Val  Acc: 0.2692
 Site-White_utk                 (5) | Val  Loss: 1.6729 | Val  Acc: 0.3684
 Site-White_utk                 (5) | Val  Loss: 1.6269 | Val  Acc: 0.4107
 Site-White_utk                 (5) | Val  Loss: 1.6221 | Val  Acc: 0.3659
 Site-White_utk                 (5) | Val  Loss: 1.5597 | Val  Acc: 0.4463
 Site-White_utk                 (5) | Val  Loss: 1.5987 | Val  Acc: 0.4101
 Site-White_utk                 (5) | Val  Loss: 1.6427 | Val  Acc: 0.4046
 Site-White_utk                 (5) | Val  Loss: 1.5540 | Val  Acc: 0.3368
 Site-White                     (3) | Val  Loss: 1.4785 | Val  Acc: 0.4000
 Site-White                     (3) | Val  Loss: 1.6756 | Val  Acc: 0.3103
 Site-White                     (3) | Val  Loss: 1.5939 | Val  Acc: 0.4651
 Site-White                     (3) | Val  Loss: 1.6427 | Val  Acc: 0.4844
 Site-White                     (3) | Val  Loss: 1.6983 | Val  Acc: 0.3723
 Site-White                     (3) | Val  Loss: 1.6461 | Val  Acc: 0.4029
 Site-White                     (3) | Val  Loss: 1.5650 | Val  Acc: 0.3775
 Site-Black_utk                 (0) | Val  Loss: 1.7044 | Val  Acc: 0.3600
 Site-Black_utk                 (0) | Val  Loss: 1.6661 | Val  Acc: 0.3889
 Site-Black_utk                 (0) | Val  Loss: 1.7414 | Val  Acc: 0.3704
 Site-Black_utk                 (0) | Val  Loss: 1.6900 | Val  Acc: 0.3291
 Site-Black_utk                 (0) | Val  Loss: 1.6972 | Val  Acc: 0.3761
 Site-Latino_Hispanic           (3) | Val  Loss: 1.6268 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7651 | Val  Acc: 0.3134
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7345 | Val  Acc: 0.3737
 Site-Indian_utk                (2) | Val  Loss: 1.6778 | Val  Acc: 0.4082
 Site-Indian_utk                (2) | Val  Loss: 1.7180 | Val  Acc: 0.4110
 Site-Southeast_Asian           (3) | Val  Loss: 1.6524 | Val  Acc: 0.3494
 Site-Middle_Eastern            (1) | Val  Loss: 1.8557 | Val  Acc: 0.1930
Average Valid Accuracy: 0.3740
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.5000
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2353
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2692
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.3684
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.4107
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.3659
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.4463
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.4101
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.4046
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.3368
 Best site-White                    (3)  | Epoch:7 | Val Acc: 0.4000
 Best site-White                    (3)  | Epoch:7 | Val Acc: 0.3103
 Best site-White                    (3)  | Epoch:7 | Val Acc: 0.4651
 Best site-White                    (3)  | Epoch:7 | Val Acc: 0.4844
 Best site-White                    (3)  | Epoch:7 | Val Acc: 0.3723
 Best site-White                    (3)  | Epoch:7 | Val Acc: 0.4029
 Best site-White                    (3)  | Epoch:7 | Val Acc: 0.3775
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3600
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3889
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3704
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3291
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3761
 Best site-Latino_Hispanic          (3)  | Epoch:7 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (3)  | Epoch:7 | Val Acc: 0.3134
 Best site-Latino_Hispanic          (3)  | Epoch:7 | Val Acc: 0.3737
 Best site-Indian_utk               (2)  | Epoch:7 | Val Acc: 0.4082
 Best site-Indian_utk               (2)  | Epoch:7 | Val Acc: 0.4110
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.3494
 Best site-Middle_Eastern           (1)  | Epoch:7 | Val Acc: 0.1930
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 2, 12, 4, 4, 6, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White_utk                 (2) | Train Loss: 1.3972 | Train Acc: 0.5556
 Site-White_utk                 (2) | Train Loss: 1.4395 | Train Acc: 0.3846
 Site-White_utk                 (2) | Train Loss: 1.5571 | Train Acc: 0.4103
 Site-White_utk                 (2) | Train Loss: 1.5968 | Train Acc: 0.3509
 Site-White_utk                 (2) | Train Loss: 1.5064 | Train Acc: 0.3810
 Site-White_utk                 (2) | Train Loss: 1.5993 | Train Acc: 0.3710
 Site-White_utk                 (2) | Train Loss: 1.6406 | Train Acc: 0.3242
 Site-White_utk                 (2) | Train Loss: 1.5898 | Train Acc: 0.3731
 Site-White_utk                 (2) | Train Loss: 1.5412 | Train Acc: 0.4148
 Site-White_utk                 (2) | Train Loss: 1.5728 | Train Acc: 0.4266
 Site-White                     (5) | Train Loss: 1.4037 | Train Acc: 0.5333
 Site-White                     (3) | Train Loss: 1.6823 | Train Acc: 0.4318
 Site-White                     (3) | Train Loss: 2.0168 | Train Acc: 0.3846
 Site-White                     (3) | Train Loss: 1.5214 | Train Acc: 0.4583
 Site-White                     (1) | Train Loss: 1.6376 | Train Acc: 0.3972
 Site-White                     (5) | Train Loss: 1.6155 | Train Acc: 0.4279
 Site-White                     (3) | Train Loss: 1.6014 | Train Acc: 0.4020
 Site-Black_utk                 (0) | Train Loss: 1.5627 | Train Acc: 0.5135
 Site-Black_utk                 (4) | Train Loss: 1.6681 | Train Acc: 0.4182
 Site-Black_utk                 (4) | Train Loss: 1.6119 | Train Acc: 0.3210
 Site-Black_utk                 (4) | Train Loss: 1.6726 | Train Acc: 0.3950
 Site-Black_utk                 (4) | Train Loss: 1.7012 | Train Acc: 0.3523
 Site-Latino_Hispanic           (5) | Train Loss: 1.6368 | Train Acc: 0.2899
 Site-Latino_Hispanic           (5) | Train Loss: 1.7271 | Train Acc: 0.3267
 Site-Latino_Hispanic           (5) | Train Loss: 1.7407 | Train Acc: 0.3490
 Site-Indian_utk                (2) | Train Loss: 1.6439 | Train Acc: 0.4459
 Site-Indian_utk                (2) | Train Loss: 1.5806 | Train Acc: 0.4128
 Site-Southeast_Asian           (5) | Train Loss: 1.7593 | Train Acc: 0.3440
 Site-Middle_Eastern            (1) | Train Loss: 1.6672 | Train Acc: 0.3529
Average Train Accuracy: 0.3982
 Site-White_utk                 (2) | Val  Loss: 1.6809 | Val  Acc: 0.4167
 Site-White_utk                 (2) | Val  Loss: 1.7549 | Val  Acc: 0.1765
 Site-White_utk                 (2) | Val  Loss: 1.5965 | Val  Acc: 0.3462
 Site-White_utk                 (2) | Val  Loss: 1.6581 | Val  Acc: 0.4474
 Site-White_utk                 (2) | Val  Loss: 1.6538 | Val  Acc: 0.3929
 Site-White_utk                 (2) | Val  Loss: 1.6459 | Val  Acc: 0.3902
 Site-White_utk                 (2) | Val  Loss: 1.5356 | Val  Acc: 0.4215
 Site-White_utk                 (2) | Val  Loss: 1.5503 | Val  Acc: 0.4213
 Site-White_utk                 (2) | Val  Loss: 1.6192 | Val  Acc: 0.3855
 Site-White_utk                 (2) | Val  Loss: 1.5044 | Val  Acc: 0.3627
 Site-White                     (5) | Val  Loss: 1.4330 | Val  Acc: 0.5500
 Site-White                     (3) | Val  Loss: 1.6085 | Val  Acc: 0.3793
 Site-White                     (3) | Val  Loss: 1.5220 | Val  Acc: 0.4884
 Site-White                     (3) | Val  Loss: 1.6232 | Val  Acc: 0.4375
 Site-White                     (1) | Val  Loss: 1.6292 | Val  Acc: 0.4149
 Site-White                     (5) | Val  Loss: 1.5697 | Val  Acc: 0.4317
 Site-White                     (3) | Val  Loss: 1.5240 | Val  Acc: 0.4265
 Site-Black_utk                 (0) | Val  Loss: 1.7482 | Val  Acc: 0.3600
 Site-Black_utk                 (4) | Val  Loss: 1.5917 | Val  Acc: 0.4444
 Site-Black_utk                 (4) | Val  Loss: 1.6871 | Val  Acc: 0.4259
 Site-Black_utk                 (4) | Val  Loss: 1.6950 | Val  Acc: 0.3924
 Site-Black_utk                 (4) | Val  Loss: 1.6676 | Val  Acc: 0.4188
 Site-Latino_Hispanic           (5) | Val  Loss: 1.6169 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8129 | Val  Acc: 0.3134
 Site-Latino_Hispanic           (5) | Val  Loss: 1.6991 | Val  Acc: 0.3434
 Site-Indian_utk                (2) | Val  Loss: 1.6369 | Val  Acc: 0.3265
 Site-Indian_utk                (2) | Val  Loss: 1.7024 | Val  Acc: 0.3425
 Site-Southeast_Asian           (5) | Val  Loss: 1.6212 | Val  Acc: 0.3976
 Site-Middle_Eastern            (1) | Val  Loss: 1.7854 | Val  Acc: 0.1930
Average Valid Accuracy: 0.3853
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.4167
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.1765
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3462
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.4474
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3929
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3902
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.4215
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.4213
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3855
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3627
 Best site-White                    (5)  | Epoch:8 | Val Acc: 0.5500
 Best site-White                    (3)  | Epoch:8 | Val Acc: 0.3793
 Best site-White                    (3)  | Epoch:8 | Val Acc: 0.4884
 Best site-White                    (3)  | Epoch:8 | Val Acc: 0.4375
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.4149
 Best site-White                    (5)  | Epoch:8 | Val Acc: 0.4317
 Best site-White                    (3)  | Epoch:8 | Val Acc: 0.4265
 Best site-Black_utk                (0)  | Epoch:8 | Val Acc: 0.3600
 Best site-Black_utk                (4)  | Epoch:8 | Val Acc: 0.4444
 Best site-Black_utk                (4)  | Epoch:8 | Val Acc: 0.4259
 Best site-Black_utk                (4)  | Epoch:8 | Val Acc: 0.3924
 Best site-Black_utk                (4)  | Epoch:8 | Val Acc: 0.4188
 Best site-Latino_Hispanic          (5)  | Epoch:8 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (5)  | Epoch:8 | Val Acc: 0.3134
 Best site-Latino_Hispanic          (5)  | Epoch:8 | Val Acc: 0.3434
 Best site-Indian_utk               (2)  | Epoch:8 | Val Acc: 0.3265
 Best site-Indian_utk               (2)  | Epoch:8 | Val Acc: 0.3425
 Best site-Southeast_Asian          (5)  | Epoch:8 | Val Acc: 0.3976
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.1930
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
============ Train epoch 9 ============
cnt=[7, 11, 4, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White_utk                 (5) | Train Loss: 1.4344 | Train Acc: 0.5000
 Site-White_utk                 (1) | Train Loss: 1.3884 | Train Acc: 0.4231
 Site-White_utk                 (1) | Train Loss: 1.5423 | Train Acc: 0.3590
 Site-White_utk                 (1) | Train Loss: 1.5324 | Train Acc: 0.4035
 Site-White_utk                 (1) | Train Loss: 1.5864 | Train Acc: 0.4048
 Site-White_utk                 (1) | Train Loss: 1.5511 | Train Acc: 0.4113
 Site-White_utk                 (1) | Train Loss: 1.6258 | Train Acc: 0.3297
 Site-White_utk                 (1) | Train Loss: 1.5813 | Train Acc: 0.3843
 Site-White_utk                 (1) | Train Loss: 1.5487 | Train Acc: 0.4402
 Site-White_utk                 (1) | Train Loss: 1.4364 | Train Acc: 0.4439
 Site-White                     (4) | Train Loss: 1.4624 | Train Acc: 0.5333
 Site-White                     (0) | Train Loss: 1.6133 | Train Acc: 0.3864
 Site-White                     (0) | Train Loss: 1.2614 | Train Acc: 0.4000
 Site-White                     (0) | Train Loss: 1.5103 | Train Acc: 0.4688
 Site-White                     (0) | Train Loss: 1.5795 | Train Acc: 0.4043
 Site-White                     (0) | Train Loss: 1.6296 | Train Acc: 0.4087
 Site-White                     (0) | Train Loss: 1.5422 | Train Acc: 0.3922
 Site-Black_utk                 (3) | Train Loss: 1.5968 | Train Acc: 0.3784
 Site-Black_utk                 (3) | Train Loss: 1.7096 | Train Acc: 0.3818
 Site-Black_utk                 (3) | Train Loss: 1.7506 | Train Acc: 0.4074
 Site-Black_utk                 (3) | Train Loss: 1.6736 | Train Acc: 0.3361
 Site-Black_utk                 (3) | Train Loss: 1.7258 | Train Acc: 0.3352
 Site-Latino_Hispanic           (2) | Train Loss: 1.9058 | Train Acc: 0.2754
 Site-Latino_Hispanic           (2) | Train Loss: 1.7251 | Train Acc: 0.3069
 Site-Latino_Hispanic           (2) | Train Loss: 1.7397 | Train Acc: 0.3087
 Site-Indian_utk                (1) | Train Loss: 1.6034 | Train Acc: 0.4324
 Site-Indian_utk                (1) | Train Loss: 1.5929 | Train Acc: 0.3945
 Site-Southeast_Asian           (2) | Train Loss: 1.6988 | Train Acc: 0.3920
 Site-Middle_Eastern            (0) | Train Loss: 1.7242 | Train Acc: 0.4000
Average Train Accuracy: 0.3946
 Site-White_utk                 (5) | Val  Loss: 1.6213 | Val  Acc: 0.3333
 Site-White_utk                 (1) | Val  Loss: 1.6715 | Val  Acc: 0.2353
 Site-White_utk                 (1) | Val  Loss: 1.5756 | Val  Acc: 0.3077
 Site-White_utk                 (1) | Val  Loss: 1.6174 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.6122 | Val  Acc: 0.4107
 Site-White_utk                 (1) | Val  Loss: 1.5606 | Val  Acc: 0.4024
 Site-White_utk                 (1) | Val  Loss: 1.5144 | Val  Acc: 0.4959
 Site-White_utk                 (1) | Val  Loss: 1.5180 | Val  Acc: 0.4213
 Site-White_utk                 (1) | Val  Loss: 1.5716 | Val  Acc: 0.4084
 Site-White_utk                 (1) | Val  Loss: 1.5077 | Val  Acc: 0.4067
 Site-White                     (4) | Val  Loss: 1.4795 | Val  Acc: 0.4500
 Site-White                     (0) | Val  Loss: 1.6553 | Val  Acc: 0.4138
 Site-White                     (0) | Val  Loss: 1.4970 | Val  Acc: 0.5349
 Site-White                     (0) | Val  Loss: 1.6151 | Val  Acc: 0.4531
 Site-White                     (0) | Val  Loss: 1.6188 | Val  Acc: 0.3936
 Site-White                     (0) | Val  Loss: 1.5862 | Val  Acc: 0.4245
 Site-White                     (0) | Val  Loss: 1.5370 | Val  Acc: 0.4118
 Site-Black_utk                 (3) | Val  Loss: 1.7625 | Val  Acc: 0.3200
 Site-Black_utk                 (3) | Val  Loss: 1.5663 | Val  Acc: 0.4444
 Site-Black_utk                 (3) | Val  Loss: 1.6347 | Val  Acc: 0.3519
 Site-Black_utk                 (3) | Val  Loss: 1.7142 | Val  Acc: 0.3797
 Site-Black_utk                 (3) | Val  Loss: 1.6421 | Val  Acc: 0.3419
 Site-Latino_Hispanic           (2) | Val  Loss: 1.6426 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7624 | Val  Acc: 0.3284
 Site-Latino_Hispanic           (2) | Val  Loss: 1.6613 | Val  Acc: 0.4141
 Site-Indian_utk                (1) | Val  Loss: 1.5838 | Val  Acc: 0.4082
 Site-Indian_utk                (1) | Val  Loss: 1.7355 | Val  Acc: 0.3425
 Site-Southeast_Asian           (2) | Val  Loss: 1.6365 | Val  Acc: 0.3494
 Site-Middle_Eastern            (0) | Val  Loss: 1.7576 | Val  Acc: 0.2807
Average Valid Accuracy: 0.3893
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.3333
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.2353
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.3077
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.5000
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.4107
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.4024
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.4959
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.4213
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.4084
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.4067
 Best site-White                    (4)  | Epoch:9 | Val Acc: 0.4500
 Best site-White                    (0)  | Epoch:9 | Val Acc: 0.4138
 Best site-White                    (0)  | Epoch:9 | Val Acc: 0.5349
 Best site-White                    (0)  | Epoch:9 | Val Acc: 0.4531
 Best site-White                    (0)  | Epoch:9 | Val Acc: 0.3936
 Best site-White                    (0)  | Epoch:9 | Val Acc: 0.4245
 Best site-White                    (0)  | Epoch:9 | Val Acc: 0.4118
 Best site-Black_utk                (3)  | Epoch:9 | Val Acc: 0.3200
 Best site-Black_utk                (3)  | Epoch:9 | Val Acc: 0.4444
 Best site-Black_utk                (3)  | Epoch:9 | Val Acc: 0.3519
 Best site-Black_utk                (3)  | Epoch:9 | Val Acc: 0.3797
 Best site-Black_utk                (3)  | Epoch:9 | Val Acc: 0.3419
 Best site-Latino_Hispanic          (2)  | Epoch:9 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (2)  | Epoch:9 | Val Acc: 0.3284
 Best site-Latino_Hispanic          (2)  | Epoch:9 | Val Acc: 0.4141
 Best site-Indian_utk               (1)  | Epoch:9 | Val Acc: 0.4082
 Best site-Indian_utk               (1)  | Epoch:9 | Val Acc: 0.3425
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3494
 Best site-Middle_Eastern           (0)  | Epoch:9 | Val Acc: 0.2807
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1_gmap...
 Test site-White_utk                 (5)| Epoch:9 | Test Acc: 0.3188
 Test site-White                     (4)| Epoch:9 | Test Acc: 0.4064
 Test site-Black_utk                 (3)| Epoch:9 | Test Acc: 0.3091
 Test site-Latino_Hispanic           (2)| Epoch:9 | Test Acc: 0.3354
 Test site-Indian_utk                (1)| Epoch:9 | Test Acc: 0.3867
 Test site-Southeast_Asian           (2)| Epoch:9 | Test Acc: 0.3704
 Test site-Middle_Eastern            (0)| Epoch:9 | Test Acc: 0.3557
White_utk: 0.3188, White: 0.4064, Black_utk: 0.3091, Latino_Hispanic: 0.3354, Indian_utk: 0.3867, Southeast_Asian: 0.3704, Middle_Eastern: 0.3557, 
Average Test Accuracy(group): 0.3546, Average Test Accuracy(individual): 0.3477,
domain CV=0.0934, cluster CV=0.0967, individual CV=0.1120, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6/ccop_q=1...
===2023-06-13 12:57:18===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: True
data_number=[18,26,39,57,84,124,182,268,393,579,30,44,65,96,141,208,306,37,55,81,119,176,69,101,149,74,109,125,85,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[5912,2980,1573,1070,616,419,285,]
domain number = 6
Loading snapshots...
 Test site-White_utk                 (5)| Epoch:8 | Test Acc: 0.3133
 Test site-White                     (4)| Epoch:8 | Test Acc: 0.4118
 Test site-Black_utk                 (3)| Epoch:8 | Test Acc: 0.3145
 Test site-Latino_Hispanic           (2)| Epoch:8 | Test Acc: 0.3291
 Test site-Indian_utk                (1)| Epoch:8 | Test Acc: 0.4133
 Test site-Southeast_Asian           (2)| Epoch:8 | Test Acc: 0.3778
 Test site-Middle_Eastern            (0)| Epoch:8 | Test Acc: 0.3479
White_utk: 0.3133, White: 0.4118, Black_utk: 0.3145, Latino_Hispanic: 0.3291, Indian_utk: 0.4133, Southeast_Asian: 0.3778, Middle_Eastern: 0.3479, 
Average Test Accuracy(group): 0.3583, Average Test Accuracy(individual): 0.3492,
domain CV=0.1115, cluster CV=0.1135, individual CV=0.1264, 
