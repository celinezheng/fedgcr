===2023-03-27 15:22:27===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0224 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9665 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.1814 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1466 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 1.9357 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9478 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2579 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 2.1659 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.8264 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.8705 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8464 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 1.9496 | Train Acc: 0.3968
 Site-Clipart   | Val  Loss: 1.9876 | Val  Acc: 0.3095
 Site-Clipart   | Val  Loss: 1.9659 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1109 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1431 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.8211 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 2.0262 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.1753 | Val  Acc: 0.3095
 Site-QuickDraw | Val  Loss: 2.1906 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.8117 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 1.8443 | Val  Acc: 0.5952
 Site-Sketch    | Val  Loss: 1.8818 | Val  Acc: 0.4048
 Site-Sketch    | Val  Loss: 1.9985 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3829
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3095
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3095
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.5714
 Best site-Real       | Epoch:0 | Val Acc: 0.5952
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6386 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.6891 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.0718 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.0104 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.4748 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.4937 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.1195 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 2.0386 | Train Acc: 0.3016
 Site-Real      | Train Loss: 1.2866 | Train Acc: 0.8571
 Site-Real      | Train Loss: 1.3433 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.4346 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.5629 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.7168 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.6730 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.9376 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.1294 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.3463 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.6541 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.9944 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.0718 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.3099 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 1.3576 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.6057 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.5462 | Val  Acc: 0.6429
Average Valid Accuracy: 0.5873
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.7619
 Best site-Painting   | Epoch:1 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-Real       | Epoch:1 | Val Acc: 0.8810
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3138 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.2997 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.9087 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7354 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.1483 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 1.0871 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9385 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.8229 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.8412 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.8866 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 1.1990 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.2648 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3473 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3490 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6946 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8904 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.9942 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.2426 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7641 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.8809 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.8475 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.9257 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.2248 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.2611 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6885
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4286
 Best site-Real       | Epoch:2 | Val Acc: 0.9286
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0208 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0469 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.8218 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.5550 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.8202 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8525 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.8801 | Train Acc: 0.3492
 Site-QuickDraw | Train Loss: 1.6462 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.5969 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.6091 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8930 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.0345 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.0316 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1330 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4655 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.7335 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.6915 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 1.0787 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.5555 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.7138 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5574 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.6356 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.9877 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.9691 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7361
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4286
 Best site-Painting   | Epoch:3 | Val Acc: 0.9524
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4762
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8113 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9300 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.7444 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4584 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.6887 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.6645 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.7038 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 1.4781 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.4049 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.3960 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.7076 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.7973 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9247 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.8748 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3429 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.7884 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 0.5793 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.6923 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.4008 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.6255 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3829 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3864 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7532 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8441 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3095
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4286
 Best site-Real       | Epoch:4 | Val Acc: 0.9762
 Best site-Real       | Epoch:4 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.7116 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7588 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.5978 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.2979 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.5420 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.5793 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.5134 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.3425 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.3605 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2718 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.6070 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6227 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.7482 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7317 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0810 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.6116 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.3474 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.6452 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.2451 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.4060 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2539 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3106 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7343 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.6577 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7877
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4524
 Best site-Painting   | Epoch:5 | Val Acc: 0.9762
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5476
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5306 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5749 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.4445 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.0985 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3467 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3980 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.5104 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.1521 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.2432 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2057 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4829 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.5705 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6618 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.5549 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1270 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3834 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3170 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5065 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 0.9971 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.3792 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1946 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2755 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4960 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6012 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5476
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4659 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5952 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.4171 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 0.9547 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.3235 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3291 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.2625 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.0040 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.2080 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1911 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3922 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5384 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5505 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4972 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.9451 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3673 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.1793 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3565 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.8150 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.3203 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1529 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2237 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4999 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4262 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8433
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5476
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.4051 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3801 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2263 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9091 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2598 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2968 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1934 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 0.9746 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.1753 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1042 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3157 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4196 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.3852 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3658 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8718 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3853 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.1452 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3704 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.8362 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.0934 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.1016 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1581 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3854 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.4080 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8452
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4762
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6190
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2736 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3091 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1446 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.7288 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.2250 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2036 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1168 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 0.9038 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1680 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1153 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3707 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3724 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.4499 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3226 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6121 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9710 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.1209 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2589 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.7428 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.0589 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.1043 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2172 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4167 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.3829 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8829
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:9 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6905
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.5...
===2023-03-27 15:55:41===
===2023-03-27 15:55:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8118
 Test site-Infograph | Epoch:9 | Test Acc: 0.4992
 Test site-Painting  | Epoch:9 | Test Acc: 0.8643
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5670
 Test site-Real      | Epoch:9 | Test Acc: 0.9228
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7978
Average Test Accuracy: 0.7438
===2023-03-30 19:19:06===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
