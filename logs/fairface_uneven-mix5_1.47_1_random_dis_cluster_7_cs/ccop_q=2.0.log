===2023-06-16 01:09:32===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 90
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[19,28,41,61,90,132,194,286,421,619,43,64,94,139,204,300,442,70,103,151,223,328,88,130,191,164,241,276,187,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
===2023-06-16 01:09:51===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 90
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[19,28,41,61,90,132,194,286,421,619,43,64,94,139,204,300,442,70,103,151,223,328,88,130,191,164,241,276,187,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 44 ============
cnt=[10, 1, 1, 4, 8, 4, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-White_utk                 (0) | Train Loss: 1.2541 | Train Acc: 0.3684
 Site-White_utk                 (0) | Train Loss: 1.3107 | Train Acc: 0.4643
 Site-White_utk                 (0) | Train Loss: 1.5138 | Train Acc: 0.4146
 Site-White_utk                 (0) | Train Loss: 1.2860 | Train Acc: 0.5082
 Site-White_utk                 (0) | Train Loss: 1.2848 | Train Acc: 0.4778
 Site-White_utk                 (0) | Train Loss: 1.1593 | Train Acc: 0.4621
 Site-White_utk                 (0) | Train Loss: 1.4127 | Train Acc: 0.4485
 Site-White_utk                 (0) | Train Loss: 1.3117 | Train Acc: 0.5070
 Site-White_utk                 (0) | Train Loss: 1.3266 | Train Acc: 0.5511
 Site-White_utk                 (0) | Train Loss: 1.4307 | Train Acc: 0.4394
 Site-East_Asian                (1) | Train Loss: 1.1515 | Train Acc: 0.6279
 Site-East_Asian                (3) | Train Loss: 1.6658 | Train Acc: 0.2812
 Site-East_Asian                (3) | Train Loss: 1.5730 | Train Acc: 0.3936
 Site-East_Asian                (3) | Train Loss: 1.4637 | Train Acc: 0.4460
 Site-East_Asian                (5) | Train Loss: 1.4132 | Train Acc: 0.4559
 Site-East_Asian                (3) | Train Loss: 1.3971 | Train Acc: 0.4667
 Site-East_Asian                (5) | Train Loss: 1.5082 | Train Acc: 0.4389
 Site-Indian_utk                (4) | Train Loss: 1.2222 | Train Acc: 0.4143
 Site-Indian_utk                (4) | Train Loss: 1.3895 | Train Acc: 0.4660
 Site-Indian_utk                (4) | Train Loss: 1.4423 | Train Acc: 0.4967
 Site-Indian_utk                (4) | Train Loss: 1.3508 | Train Acc: 0.5202
 Site-Indian_utk                (4) | Train Loss: 1.4190 | Train Acc: 0.4665
 Site-Black_utk                 (4) | Train Loss: 1.5868 | Train Acc: 0.4091
 Site-Black_utk                 (4) | Train Loss: 1.1504 | Train Acc: 0.4308
 Site-Black_utk                 (4) | Train Loss: 1.6533 | Train Acc: 0.3455
 Site-Southeast_Asian           (5) | Train Loss: 1.5521 | Train Acc: 0.4024
 Site-Southeast_Asian           (5) | Train Loss: 1.6169 | Train Acc: 0.4108
 Site-Asian_ffhq                (6) | Train Loss: 2.2211 | Train Acc: 0.2681
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.8948 | Train Acc: 0.3155
Average Train Accuracy: 0.4378
 Site-White_utk                 (0) | Val  Loss: 1.3188 | Val  Acc: 0.2500
 Site-White_utk                 (0) | Val  Loss: 1.1130 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.3607 | Val  Acc: 0.4074
 Site-White_utk                 (0) | Val  Loss: 1.4749 | Val  Acc: 0.3250
 Site-White_utk                 (0) | Val  Loss: 1.4627 | Val  Acc: 0.4500
 Site-White_utk                 (0) | Val  Loss: 1.4233 | Val  Acc: 0.5455
 Site-White_utk                 (0) | Val  Loss: 1.2791 | Val  Acc: 0.4729
 Site-White_utk                 (0) | Val  Loss: 1.2941 | Val  Acc: 0.5969
 Site-White_utk                 (0) | Val  Loss: 1.2922 | Val  Acc: 0.5429
 Site-White_utk                 (0) | Val  Loss: 1.3567 | Val  Acc: 0.4636
 Site-East_Asian                (1) | Val  Loss: 1.3058 | Val  Acc: 0.6207
 Site-East_Asian                (3) | Val  Loss: 1.3482 | Val  Acc: 0.5476
 Site-East_Asian                (3) | Val  Loss: 1.5251 | Val  Acc: 0.4603
 Site-East_Asian                (3) | Val  Loss: 1.3610 | Val  Acc: 0.5652
 Site-East_Asian                (5) | Val  Loss: 1.1879 | Val  Acc: 0.4926
 Site-East_Asian                (3) | Val  Loss: 1.4281 | Val  Acc: 0.4900
 Site-East_Asian                (5) | Val  Loss: 1.4236 | Val  Acc: 0.4932
 Site-Indian_utk                (4) | Val  Loss: 1.3775 | Val  Acc: 0.5217
 Site-Indian_utk                (4) | Val  Loss: 1.2294 | Val  Acc: 0.4412
 Site-Indian_utk                (4) | Val  Loss: 1.4130 | Val  Acc: 0.5149
 Site-Indian_utk                (4) | Val  Loss: 1.3990 | Val  Acc: 0.4865
 Site-Indian_utk                (4) | Val  Loss: 1.3917 | Val  Acc: 0.4954
 Site-Black_utk                 (4) | Val  Loss: 1.5989 | Val  Acc: 0.3793
 Site-Black_utk                 (4) | Val  Loss: 1.6232 | Val  Acc: 0.4302
 Site-Black_utk                 (4) | Val  Loss: 1.5015 | Val  Acc: 0.4488
 Site-Southeast_Asian           (5) | Val  Loss: 1.6397 | Val  Acc: 0.4312
 Site-Southeast_Asian           (5) | Val  Loss: 1.5924 | Val  Acc: 0.4250
 Site-Asian_ffhq                (6) | Val  Loss: 2.3457 | Val  Acc: 0.1359
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8216 | Val  Acc: 0.2800
Average Valid Accuracy: 0.4556
============ Train epoch 45 ============
cnt=[1, 8, 5, 9, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-White_utk                 (0) | Train Loss: 1.2695 | Train Acc: 0.4737
 Site-White_utk                 (3) | Train Loss: 1.3314 | Train Acc: 0.5357
 Site-White_utk                 (3) | Train Loss: 1.5328 | Train Acc: 0.3902
 Site-White_utk                 (3) | Train Loss: 1.3233 | Train Acc: 0.4426
 Site-White_utk                 (3) | Train Loss: 1.5059 | Train Acc: 0.4667
 Site-White_utk                 (3) | Train Loss: 1.4207 | Train Acc: 0.4242
 Site-White_utk                 (3) | Train Loss: 1.3128 | Train Acc: 0.3866
 Site-White_utk                 (3) | Train Loss: 1.3816 | Train Acc: 0.4790
 Site-White_utk                 (3) | Train Loss: 1.3827 | Train Acc: 0.4988
 Site-White_utk                 (3) | Train Loss: 1.4913 | Train Acc: 0.4006
 Site-East_Asian                (6) | Train Loss: 1.2234 | Train Acc: 0.5349
 Site-East_Asian                (1) | Train Loss: 1.6885 | Train Acc: 0.3438
 Site-East_Asian                (1) | Train Loss: 1.5398 | Train Acc: 0.4468
 Site-East_Asian                (1) | Train Loss: 1.4187 | Train Acc: 0.4532
 Site-East_Asian                (1) | Train Loss: 1.4338 | Train Acc: 0.4461
 Site-East_Asian                (1) | Train Loss: 1.4284 | Train Acc: 0.4667
 Site-East_Asian                (1) | Train Loss: 1.5178 | Train Acc: 0.4095
 Site-Indian_utk                (2) | Train Loss: 1.5071 | Train Acc: 0.5286
 Site-Indian_utk                (2) | Train Loss: 1.3438 | Train Acc: 0.4660
 Site-Indian_utk                (2) | Train Loss: 1.3222 | Train Acc: 0.4437
 Site-Indian_utk                (2) | Train Loss: 1.3118 | Train Acc: 0.4888
 Site-Indian_utk                (2) | Train Loss: 1.4014 | Train Acc: 0.4695
 Site-Black_utk                 (5) | Train Loss: 1.4570 | Train Acc: 0.4773
 Site-Black_utk                 (5) | Train Loss: 1.3092 | Train Acc: 0.4769
 Site-Black_utk                 (5) | Train Loss: 1.5678 | Train Acc: 0.3927
 Site-Southeast_Asian           (1) | Train Loss: 1.6122 | Train Acc: 0.3902
 Site-Southeast_Asian           (1) | Train Loss: 1.6252 | Train Acc: 0.4066
 Site-Asian_ffhq                (4) | Train Loss: 1.5852 | Train Acc: 0.4601
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4510 | Train Acc: 0.4171
Average Train Accuracy: 0.4489
 Site-White_utk                 (0) | Val  Loss: 1.2870 | Val  Acc: 0.5000
 Site-White_utk                 (3) | Val  Loss: 1.2637 | Val  Acc: 0.5000
 Site-White_utk                 (3) | Val  Loss: 1.3392 | Val  Acc: 0.3704
 Site-White_utk                 (3) | Val  Loss: 1.4903 | Val  Acc: 0.4000
 Site-White_utk                 (3) | Val  Loss: 1.5887 | Val  Acc: 0.3333
 Site-White_utk                 (3) | Val  Loss: 1.4729 | Val  Acc: 0.4659
 Site-White_utk                 (3) | Val  Loss: 1.3030 | Val  Acc: 0.4961
 Site-White_utk                 (3) | Val  Loss: 1.3594 | Val  Acc: 0.5183
 Site-White_utk                 (3) | Val  Loss: 1.3524 | Val  Acc: 0.4571
 Site-White_utk                 (3) | Val  Loss: 1.4283 | Val  Acc: 0.4150
 Site-East_Asian                (6) | Val  Loss: 1.3169 | Val  Acc: 0.4483
 Site-East_Asian                (1) | Val  Loss: 1.3850 | Val  Acc: 0.5476
 Site-East_Asian                (1) | Val  Loss: 1.5025 | Val  Acc: 0.4444
 Site-East_Asian                (1) | Val  Loss: 1.3428 | Val  Acc: 0.5109
 Site-East_Asian                (1) | Val  Loss: 1.1048 | Val  Acc: 0.4559
 Site-East_Asian                (1) | Val  Loss: 1.4228 | Val  Acc: 0.4450
 Site-East_Asian                (1) | Val  Loss: 1.4116 | Val  Acc: 0.4660
 Site-Indian_utk                (2) | Val  Loss: 1.3809 | Val  Acc: 0.4348
 Site-Indian_utk                (2) | Val  Loss: 1.2968 | Val  Acc: 0.5294
 Site-Indian_utk                (2) | Val  Loss: 1.3132 | Val  Acc: 0.5545
 Site-Indian_utk                (2) | Val  Loss: 1.3661 | Val  Acc: 0.4865
 Site-Indian_utk                (2) | Val  Loss: 1.3364 | Val  Acc: 0.4771
 Site-Black_utk                 (5) | Val  Loss: 1.5522 | Val  Acc: 0.3966
 Site-Black_utk                 (5) | Val  Loss: 1.5470 | Val  Acc: 0.4302
 Site-Black_utk                 (5) | Val  Loss: 1.4603 | Val  Acc: 0.4646
 Site-Southeast_Asian           (1) | Val  Loss: 1.7326 | Val  Acc: 0.4312
 Site-Southeast_Asian           (1) | Val  Loss: 1.6687 | Val  Acc: 0.3937
 Site-Asian_ffhq                (4) | Val  Loss: 2.0184 | Val  Acc: 0.1196
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.5909 | Val  Acc: 0.2880
Average Valid Accuracy: 0.4407
 Test site-White_utk                 (0)| Epoch:43 | Test Acc: 0.3834
 Test site-East_Asian                (6)| Epoch:43 | Test Acc: 0.4866
 Test site-Indian_utk                (2)| Epoch:43 | Test Acc: 0.4979
 Test site-Black_utk                 (5)| Epoch:43 | Test Acc: 0.4133
 Test site-Southeast_Asian           (1)| Epoch:43 | Test Acc: 0.4263
 Test site-Asian_ffhq                (4)| Epoch:43 | Test Acc: 0.2537
 Test site-Latino_Hispanic_ffhq      (4)| Epoch:43 | Test Acc: 0.2786
White_utk: 0.3834, East_Asian: 0.4866, Indian_utk: 0.4979, Black_utk: 0.4133, Southeast_Asian: 0.4263, Asian_ffhq: 0.2537, Latino_Hispanic_ffhq: 0.2786, 
Average Test Accuracy(group): 0.3914, Average Test Accuracy(individual): 0.4260,
domain std=0.0877, cluster std=0.0750, individual std=0.0648, 
============ Train epoch 46 ============
cnt=[9, 5, 8, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-White_utk                 (6) | Train Loss: 1.2500 | Train Acc: 0.4211
 Site-White_utk                 (4) | Train Loss: 1.3884 | Train Acc: 0.5000
 Site-White_utk                 (2) | Train Loss: 1.4565 | Train Acc: 0.3902
 Site-White_utk                 (2) | Train Loss: 1.2436 | Train Acc: 0.5246
 Site-White_utk                 (2) | Train Loss: 1.3436 | Train Acc: 0.4556
 Site-White_utk                 (2) | Train Loss: 1.4862 | Train Acc: 0.4697
 Site-White_utk                 (2) | Train Loss: 1.4365 | Train Acc: 0.3969
 Site-White_utk                 (2) | Train Loss: 1.3162 | Train Acc: 0.4790
 Site-White_utk                 (2) | Train Loss: 1.3313 | Train Acc: 0.5416
 Site-White_utk                 (2) | Train Loss: 1.4060 | Train Acc: 0.4378
 Site-East_Asian                (0) | Train Loss: 1.1983 | Train Acc: 0.5349
 Site-East_Asian                (0) | Train Loss: 1.6347 | Train Acc: 0.3594
 Site-East_Asian                (0) | Train Loss: 1.5601 | Train Acc: 0.4574
 Site-East_Asian                (0) | Train Loss: 1.4639 | Train Acc: 0.4892
 Site-East_Asian                (0) | Train Loss: 1.2913 | Train Acc: 0.4461
 Site-East_Asian                (0) | Train Loss: 1.3701 | Train Acc: 0.4833
 Site-East_Asian                (0) | Train Loss: 1.4605 | Train Acc: 0.4321
 Site-Indian_utk                (1) | Train Loss: 1.4787 | Train Acc: 0.5143
 Site-Indian_utk                (1) | Train Loss: 1.3755 | Train Acc: 0.4660
 Site-Indian_utk                (1) | Train Loss: 1.4045 | Train Acc: 0.4702
 Site-Indian_utk                (1) | Train Loss: 1.3088 | Train Acc: 0.5695
 Site-Indian_utk                (1) | Train Loss: 1.3820 | Train Acc: 0.4817
 Site-Black_utk                 (5) | Train Loss: 1.5418 | Train Acc: 0.4091
 Site-Black_utk                 (5) | Train Loss: 1.2872 | Train Acc: 0.5154
 Site-Black_utk                 (5) | Train Loss: 1.6064 | Train Acc: 0.3613
 Site-Southeast_Asian           (0) | Train Loss: 1.5139 | Train Acc: 0.3963
 Site-Southeast_Asian           (0) | Train Loss: 1.6356 | Train Acc: 0.4357
 Site-Asian_ffhq                (3) | Train Loss: 1.8546 | Train Acc: 0.4239
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.5993 | Train Acc: 0.4064
Average Train Accuracy: 0.4575
 Site-White_utk                 (6) | Val  Loss: 1.2764 | Val  Acc: 0.5000
 Site-White_utk                 (4) | Val  Loss: 1.2530 | Val  Acc: 0.4444
 Site-White_utk                 (2) | Val  Loss: 1.2308 | Val  Acc: 0.3704
 Site-White_utk                 (2) | Val  Loss: 1.4485 | Val  Acc: 0.3500
 Site-White_utk                 (2) | Val  Loss: 1.5041 | Val  Acc: 0.4333
 Site-White_utk                 (2) | Val  Loss: 1.4286 | Val  Acc: 0.5455
 Site-White_utk                 (2) | Val  Loss: 1.4045 | Val  Acc: 0.5426
 Site-White_utk                 (2) | Val  Loss: 1.3042 | Val  Acc: 0.5759
 Site-White_utk                 (2) | Val  Loss: 1.2823 | Val  Acc: 0.5321
 Site-White_utk                 (2) | Val  Loss: 1.3820 | Val  Acc: 0.4636
 Site-East_Asian                (0) | Val  Loss: 1.3491 | Val  Acc: 0.5517
 Site-East_Asian                (0) | Val  Loss: 1.3437 | Val  Acc: 0.5476
 Site-East_Asian                (0) | Val  Loss: 1.4461 | Val  Acc: 0.4762
 Site-East_Asian                (0) | Val  Loss: 1.3970 | Val  Acc: 0.4674
 Site-East_Asian                (0) | Val  Loss: 1.1162 | Val  Acc: 0.5074
 Site-East_Asian                (0) | Val  Loss: 1.3579 | Val  Acc: 0.4950
 Site-East_Asian                (0) | Val  Loss: 1.3774 | Val  Acc: 0.5034
 Site-Indian_utk                (1) | Val  Loss: 1.3844 | Val  Acc: 0.4783
 Site-Indian_utk                (1) | Val  Loss: 1.2385 | Val  Acc: 0.4853
 Site-Indian_utk                (1) | Val  Loss: 1.3564 | Val  Acc: 0.5842
 Site-Indian_utk                (1) | Val  Loss: 1.3462 | Val  Acc: 0.4932
 Site-Indian_utk                (1) | Val  Loss: 1.3409 | Val  Acc: 0.5092
 Site-Black_utk                 (5) | Val  Loss: 1.4783 | Val  Acc: 0.3448
 Site-Black_utk                 (5) | Val  Loss: 1.5621 | Val  Acc: 0.4070
 Site-Black_utk                 (5) | Val  Loss: 1.4701 | Val  Acc: 0.4488
 Site-Southeast_Asian           (0) | Val  Loss: 1.5861 | Val  Acc: 0.4771
 Site-Southeast_Asian           (0) | Val  Loss: 1.5907 | Val  Acc: 0.4313
 Site-Asian_ffhq                (3) | Val  Loss: 2.1566 | Val  Acc: 0.1413
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.6347 | Val  Acc: 0.3520
Average Valid Accuracy: 0.4641
 Best site-White_utk                (6)  | Epoch:46 | Val Acc: 0.5000
 Best site-White_utk                (4)  | Epoch:46 | Val Acc: 0.4444
 Best site-White_utk                (2)  | Epoch:46 | Val Acc: 0.3704
 Best site-White_utk                (2)  | Epoch:46 | Val Acc: 0.3500
 Best site-White_utk                (2)  | Epoch:46 | Val Acc: 0.4333
 Best site-White_utk                (2)  | Epoch:46 | Val Acc: 0.5455
 Best site-White_utk                (2)  | Epoch:46 | Val Acc: 0.5426
 Best site-White_utk                (2)  | Epoch:46 | Val Acc: 0.5759
 Best site-White_utk                (2)  | Epoch:46 | Val Acc: 0.5321
 Best site-White_utk                (2)  | Epoch:46 | Val Acc: 0.4636
 Best site-East_Asian               (0)  | Epoch:46 | Val Acc: 0.5517
 Best site-East_Asian               (0)  | Epoch:46 | Val Acc: 0.5476
 Best site-East_Asian               (0)  | Epoch:46 | Val Acc: 0.4762
 Best site-East_Asian               (0)  | Epoch:46 | Val Acc: 0.4674
 Best site-East_Asian               (0)  | Epoch:46 | Val Acc: 0.5074
 Best site-East_Asian               (0)  | Epoch:46 | Val Acc: 0.4950
 Best site-East_Asian               (0)  | Epoch:46 | Val Acc: 0.5034
 Best site-Indian_utk               (1)  | Epoch:46 | Val Acc: 0.4783
 Best site-Indian_utk               (1)  | Epoch:46 | Val Acc: 0.4853
 Best site-Indian_utk               (1)  | Epoch:46 | Val Acc: 0.5842
 Best site-Indian_utk               (1)  | Epoch:46 | Val Acc: 0.4932
 Best site-Indian_utk               (1)  | Epoch:46 | Val Acc: 0.5092
 Best site-Black_utk                (5)  | Epoch:46 | Val Acc: 0.3448
 Best site-Black_utk                (5)  | Epoch:46 | Val Acc: 0.4070
 Best site-Black_utk                (5)  | Epoch:46 | Val Acc: 0.4488
 Best site-Southeast_Asian          (0)  | Epoch:46 | Val Acc: 0.4771
 Best site-Southeast_Asian          (0)  | Epoch:46 | Val Acc: 0.4313
 Best site-Asian_ffhq               (3)  | Epoch:46 | Val Acc: 0.1413
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:46 | Val Acc: 0.3520
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0...
============ Train epoch 47 ============
cnt=[8, 10, 1, 5, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-White_utk                 (1) | Train Loss: 1.2805 | Train Acc: 0.4737
 Site-White_utk                 (1) | Train Loss: 1.3266 | Train Acc: 0.5357
 Site-White_utk                 (1) | Train Loss: 1.4912 | Train Acc: 0.3659
 Site-White_utk                 (1) | Train Loss: 1.2635 | Train Acc: 0.4426
 Site-White_utk                 (1) | Train Loss: 1.3119 | Train Acc: 0.4667
 Site-White_utk                 (1) | Train Loss: 1.2706 | Train Acc: 0.4470
 Site-White_utk                 (1) | Train Loss: 1.3727 | Train Acc: 0.4433
 Site-White_utk                 (1) | Train Loss: 1.3121 | Train Acc: 0.4755
 Site-White_utk                 (1) | Train Loss: 1.3600 | Train Acc: 0.5226
 Site-White_utk                 (1) | Train Loss: 1.3981 | Train Acc: 0.4475
 Site-East_Asian                (6) | Train Loss: 1.1726 | Train Acc: 0.5349
 Site-East_Asian                (0) | Train Loss: 1.6546 | Train Acc: 0.3750
 Site-East_Asian                (0) | Train Loss: 1.4369 | Train Acc: 0.4574
 Site-East_Asian                (0) | Train Loss: 1.3779 | Train Acc: 0.4964
 Site-East_Asian                (0) | Train Loss: 1.3311 | Train Acc: 0.4510
 Site-East_Asian                (0) | Train Loss: 1.3630 | Train Acc: 0.4900
 Site-East_Asian                (0) | Train Loss: 1.4814 | Train Acc: 0.4412
 Site-Indian_utk                (3) | Train Loss: 1.2529 | Train Acc: 0.5429
 Site-Indian_utk                (3) | Train Loss: 1.2892 | Train Acc: 0.5243
 Site-Indian_utk                (3) | Train Loss: 1.3806 | Train Acc: 0.5099
 Site-Indian_utk                (3) | Train Loss: 1.2750 | Train Acc: 0.5112
 Site-Indian_utk                (3) | Train Loss: 1.3763 | Train Acc: 0.4634
 Site-Black_utk                 (4) | Train Loss: 1.4818 | Train Acc: 0.3636
 Site-Black_utk                 (4) | Train Loss: 1.4484 | Train Acc: 0.4538
 Site-Black_utk                 (4) | Train Loss: 1.5884 | Train Acc: 0.3717
 Site-Southeast_Asian           (0) | Train Loss: 1.5274 | Train Acc: 0.4024
 Site-Southeast_Asian           (0) | Train Loss: 1.6468 | Train Acc: 0.3859
 Site-Asian_ffhq                (5) | Train Loss: 1.8304 | Train Acc: 0.4312
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5283 | Train Acc: 0.3797
Average Train Accuracy: 0.4554
 Site-White_utk                 (1) | Val  Loss: 1.3164 | Val  Acc: 0.5833
 Site-White_utk                 (1) | Val  Loss: 1.2463 | Val  Acc: 0.2778
 Site-White_utk                 (1) | Val  Loss: 1.2874 | Val  Acc: 0.4074
 Site-White_utk                 (1) | Val  Loss: 1.4283 | Val  Acc: 0.4500
 Site-White_utk                 (1) | Val  Loss: 1.4370 | Val  Acc: 0.4667
 Site-White_utk                 (1) | Val  Loss: 1.3992 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.3452 | Val  Acc: 0.5581
 Site-White_utk                 (1) | Val  Loss: 1.3189 | Val  Acc: 0.5864
 Site-White_utk                 (1) | Val  Loss: 1.3112 | Val  Acc: 0.5107
 Site-White_utk                 (1) | Val  Loss: 1.3801 | Val  Acc: 0.4563
 Site-East_Asian                (6) | Val  Loss: 1.3457 | Val  Acc: 0.6207
 Site-East_Asian                (0) | Val  Loss: 1.3567 | Val  Acc: 0.5476
 Site-East_Asian                (0) | Val  Loss: 1.4440 | Val  Acc: 0.4762
 Site-East_Asian                (0) | Val  Loss: 1.3775 | Val  Acc: 0.4565
 Site-East_Asian                (0) | Val  Loss: 1.0900 | Val  Acc: 0.4779
 Site-East_Asian                (0) | Val  Loss: 1.3407 | Val  Acc: 0.4800
 Site-East_Asian                (0) | Val  Loss: 1.3908 | Val  Acc: 0.4830
 Site-Indian_utk                (3) | Val  Loss: 1.3700 | Val  Acc: 0.5217
 Site-Indian_utk                (3) | Val  Loss: 1.3267 | Val  Acc: 0.4559
 Site-Indian_utk                (3) | Val  Loss: 1.3907 | Val  Acc: 0.5644
 Site-Indian_utk                (3) | Val  Loss: 1.3557 | Val  Acc: 0.5270
 Site-Indian_utk                (3) | Val  Loss: 1.3486 | Val  Acc: 0.4954
 Site-Black_utk                 (4) | Val  Loss: 1.5034 | Val  Acc: 0.3966
 Site-Black_utk                 (4) | Val  Loss: 1.5450 | Val  Acc: 0.4186
 Site-Black_utk                 (4) | Val  Loss: 1.4687 | Val  Acc: 0.4488
 Site-Southeast_Asian           (0) | Val  Loss: 1.6378 | Val  Acc: 0.4312
 Site-Southeast_Asian           (0) | Val  Loss: 1.5893 | Val  Acc: 0.4250
 Site-Asian_ffhq                (5) | Val  Loss: 2.0621 | Val  Acc: 0.1685
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.5946 | Val  Acc: 0.3280
Average Valid Accuracy: 0.4662
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.5833
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.2778
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.4074
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.4500
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.4667
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.5000
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.5581
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.5864
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.5107
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.4563
 Best site-East_Asian               (6)  | Epoch:47 | Val Acc: 0.6207
 Best site-East_Asian               (0)  | Epoch:47 | Val Acc: 0.5476
 Best site-East_Asian               (0)  | Epoch:47 | Val Acc: 0.4762
 Best site-East_Asian               (0)  | Epoch:47 | Val Acc: 0.4565
 Best site-East_Asian               (0)  | Epoch:47 | Val Acc: 0.4779
 Best site-East_Asian               (0)  | Epoch:47 | Val Acc: 0.4800
 Best site-East_Asian               (0)  | Epoch:47 | Val Acc: 0.4830
 Best site-Indian_utk               (3)  | Epoch:47 | Val Acc: 0.5217
 Best site-Indian_utk               (3)  | Epoch:47 | Val Acc: 0.4559
 Best site-Indian_utk               (3)  | Epoch:47 | Val Acc: 0.5644
 Best site-Indian_utk               (3)  | Epoch:47 | Val Acc: 0.5270
 Best site-Indian_utk               (3)  | Epoch:47 | Val Acc: 0.4954
 Best site-Black_utk                (4)  | Epoch:47 | Val Acc: 0.3966
 Best site-Black_utk                (4)  | Epoch:47 | Val Acc: 0.4186
 Best site-Black_utk                (4)  | Epoch:47 | Val Acc: 0.4488
 Best site-Southeast_Asian          (0)  | Epoch:47 | Val Acc: 0.4312
 Best site-Southeast_Asian          (0)  | Epoch:47 | Val Acc: 0.4250
 Best site-Asian_ffhq               (5)  | Epoch:47 | Val Acc: 0.1685
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:47 | Val Acc: 0.3280
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0_gmap...
 Test site-White_utk                 (1)| Epoch:47 | Test Acc: 0.3957
 Test site-East_Asian                (6)| Epoch:47 | Test Acc: 0.4896
 Test site-Indian_utk                (3)| Epoch:47 | Test Acc: 0.5083
 Test site-Black_utk                 (4)| Epoch:47 | Test Acc: 0.3980
 Test site-Southeast_Asian           (0)| Epoch:47 | Test Acc: 0.4367
 Test site-Asian_ffhq                (5)| Epoch:47 | Test Acc: 0.2574
 Test site-Latino_Hispanic_ffhq      (2)| Epoch:47 | Test Acc: 0.2736
White_utk: 0.3957, East_Asian: 0.4896, Indian_utk: 0.5083, Black_utk: 0.3980, Southeast_Asian: 0.4367, Asian_ffhq: 0.2574, Latino_Hispanic_ffhq: 0.2736, 
Average Test Accuracy(group): 0.3942, Average Test Accuracy(individual): 0.4319,
domain std=0.0904, cluster std=0.0941, individual std=0.0656, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0...
============ Train epoch 48 ============
cnt=[9, 9, 1, 3, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-White_utk                 (6) | Train Loss: 1.1993 | Train Acc: 0.4211
 Site-White_utk                 (0) | Train Loss: 1.3316 | Train Acc: 0.5000
 Site-White_utk                 (0) | Train Loss: 1.4777 | Train Acc: 0.3415
 Site-White_utk                 (0) | Train Loss: 1.2306 | Train Acc: 0.5574
 Site-White_utk                 (0) | Train Loss: 1.4859 | Train Acc: 0.4444
 Site-White_utk                 (0) | Train Loss: 1.2671 | Train Acc: 0.4621
 Site-White_utk                 (0) | Train Loss: 1.5012 | Train Acc: 0.4124
 Site-White_utk                 (0) | Train Loss: 1.3306 | Train Acc: 0.4790
 Site-White_utk                 (0) | Train Loss: 1.3551 | Train Acc: 0.5202
 Site-White_utk                 (0) | Train Loss: 1.4170 | Train Acc: 0.4184
 Site-East_Asian                (1) | Train Loss: 1.1635 | Train Acc: 0.5814
 Site-East_Asian                (1) | Train Loss: 1.6063 | Train Acc: 0.3750
 Site-East_Asian                (1) | Train Loss: 1.5212 | Train Acc: 0.4894
 Site-East_Asian                (1) | Train Loss: 1.5211 | Train Acc: 0.5036
 Site-East_Asian                (1) | Train Loss: 1.4111 | Train Acc: 0.4902
 Site-East_Asian                (1) | Train Loss: 1.3687 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.4513 | Train Acc: 0.4457
 Site-Indian_utk                (5) | Train Loss: 1.2918 | Train Acc: 0.4857
 Site-Indian_utk                (5) | Train Loss: 1.2889 | Train Acc: 0.5049
 Site-Indian_utk                (5) | Train Loss: 1.3761 | Train Acc: 0.4901
 Site-Indian_utk                (5) | Train Loss: 1.2930 | Train Acc: 0.5426
 Site-Indian_utk                (5) | Train Loss: 1.4052 | Train Acc: 0.4665
 Site-Black_utk                 (3) | Train Loss: 1.4462 | Train Acc: 0.4659
 Site-Black_utk                 (3) | Train Loss: 1.4861 | Train Acc: 0.4692
 Site-Black_utk                 (3) | Train Loss: 1.5626 | Train Acc: 0.3665
 Site-Southeast_Asian           (1) | Train Loss: 1.5573 | Train Acc: 0.4146
 Site-Southeast_Asian           (1) | Train Loss: 1.5970 | Train Acc: 0.4232
 Site-Asian_ffhq                (2) | Train Loss: 1.6896 | Train Acc: 0.4312
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4556 | Train Acc: 0.4171
Average Train Accuracy: 0.4627
 Site-White_utk                 (6) | Val  Loss: 1.3165 | Val  Acc: 0.5833
 Site-White_utk                 (0) | Val  Loss: 1.2464 | Val  Acc: 0.3889
 Site-White_utk                 (0) | Val  Loss: 1.3206 | Val  Acc: 0.4074
 Site-White_utk                 (0) | Val  Loss: 1.5012 | Val  Acc: 0.3750
 Site-White_utk                 (0) | Val  Loss: 1.4596 | Val  Acc: 0.4833
 Site-White_utk                 (0) | Val  Loss: 1.4534 | Val  Acc: 0.5114
 Site-White_utk                 (0) | Val  Loss: 1.2897 | Val  Acc: 0.5581
 Site-White_utk                 (0) | Val  Loss: 1.3320 | Val  Acc: 0.5969
 Site-White_utk                 (0) | Val  Loss: 1.3021 | Val  Acc: 0.5107
 Site-White_utk                 (0) | Val  Loss: 1.3966 | Val  Acc: 0.4612
 Site-East_Asian                (1) | Val  Loss: 1.3219 | Val  Acc: 0.5172
 Site-East_Asian                (1) | Val  Loss: 1.3520 | Val  Acc: 0.5238
 Site-East_Asian                (1) | Val  Loss: 1.4205 | Val  Acc: 0.4762
 Site-East_Asian                (1) | Val  Loss: 1.3866 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.1008 | Val  Acc: 0.4779
 Site-East_Asian                (1) | Val  Loss: 1.3647 | Val  Acc: 0.5250
 Site-East_Asian                (1) | Val  Loss: 1.3754 | Val  Acc: 0.4932
 Site-Indian_utk                (5) | Val  Loss: 1.3971 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.3011 | Val  Acc: 0.5147
 Site-Indian_utk                (5) | Val  Loss: 1.3347 | Val  Acc: 0.5347
 Site-Indian_utk                (5) | Val  Loss: 1.3882 | Val  Acc: 0.4865
 Site-Indian_utk                (5) | Val  Loss: 1.3277 | Val  Acc: 0.5138
 Site-Black_utk                 (3) | Val  Loss: 1.4928 | Val  Acc: 0.4483
 Site-Black_utk                 (3) | Val  Loss: 1.5577 | Val  Acc: 0.4302
 Site-Black_utk                 (3) | Val  Loss: 1.4483 | Val  Acc: 0.4646
 Site-Southeast_Asian           (1) | Val  Loss: 1.6696 | Val  Acc: 0.4312
 Site-Southeast_Asian           (1) | Val  Loss: 1.6075 | Val  Acc: 0.4250
 Site-Asian_ffhq                (2) | Val  Loss: 2.0582 | Val  Acc: 0.1467
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.5693 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4691
 Best site-White_utk                (6)  | Epoch:48 | Val Acc: 0.5833
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.3889
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.4074
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.3750
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.4833
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.5114
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.5581
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.5969
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.5107
 Best site-White_utk                (0)  | Epoch:48 | Val Acc: 0.4612
 Best site-East_Asian               (1)  | Epoch:48 | Val Acc: 0.5172
 Best site-East_Asian               (1)  | Epoch:48 | Val Acc: 0.5238
 Best site-East_Asian               (1)  | Epoch:48 | Val Acc: 0.4762
 Best site-East_Asian               (1)  | Epoch:48 | Val Acc: 0.5000
 Best site-East_Asian               (1)  | Epoch:48 | Val Acc: 0.4779
 Best site-East_Asian               (1)  | Epoch:48 | Val Acc: 0.5250
 Best site-East_Asian               (1)  | Epoch:48 | Val Acc: 0.4932
 Best site-Indian_utk               (5)  | Epoch:48 | Val Acc: 0.5000
 Best site-Indian_utk               (5)  | Epoch:48 | Val Acc: 0.5147
 Best site-Indian_utk               (5)  | Epoch:48 | Val Acc: 0.5347
 Best site-Indian_utk               (5)  | Epoch:48 | Val Acc: 0.4865
 Best site-Indian_utk               (5)  | Epoch:48 | Val Acc: 0.5138
 Best site-Black_utk                (3)  | Epoch:48 | Val Acc: 0.4483
 Best site-Black_utk                (3)  | Epoch:48 | Val Acc: 0.4302
 Best site-Black_utk                (3)  | Epoch:48 | Val Acc: 0.4646
 Best site-Southeast_Asian          (1)  | Epoch:48 | Val Acc: 0.4312
 Best site-Southeast_Asian          (1)  | Epoch:48 | Val Acc: 0.4250
 Best site-Asian_ffhq               (2)  | Epoch:48 | Val Acc: 0.1467
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:48 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0...
============ Train epoch 49 ============
cnt=[1, 9, 9, 3, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-White_utk                 (0) | Train Loss: 1.1995 | Train Acc: 0.5263
 Site-White_utk                 (2) | Train Loss: 1.2661 | Train Acc: 0.5000
 Site-White_utk                 (2) | Train Loss: 1.4783 | Train Acc: 0.4146
 Site-White_utk                 (2) | Train Loss: 1.2067 | Train Acc: 0.5410
 Site-White_utk                 (2) | Train Loss: 1.3370 | Train Acc: 0.5000
 Site-White_utk                 (2) | Train Loss: 1.4680 | Train Acc: 0.3939
 Site-White_utk                 (2) | Train Loss: 1.4291 | Train Acc: 0.4330
 Site-White_utk                 (2) | Train Loss: 1.3416 | Train Acc: 0.4650
 Site-White_utk                 (2) | Train Loss: 1.3199 | Train Acc: 0.5059
 Site-White_utk                 (2) | Train Loss: 1.3766 | Train Acc: 0.4443
 Site-East_Asian                (1) | Train Loss: 1.1909 | Train Acc: 0.5581
 Site-East_Asian                (1) | Train Loss: 1.5681 | Train Acc: 0.3906
 Site-East_Asian                (1) | Train Loss: 1.4854 | Train Acc: 0.4787
 Site-East_Asian                (1) | Train Loss: 1.3855 | Train Acc: 0.4748
 Site-East_Asian                (1) | Train Loss: 1.3614 | Train Acc: 0.4657
 Site-East_Asian                (1) | Train Loss: 1.3380 | Train Acc: 0.5133
 Site-East_Asian                (1) | Train Loss: 1.4199 | Train Acc: 0.4525
 Site-Indian_utk                (6) | Train Loss: 1.5018 | Train Acc: 0.5000
 Site-Indian_utk                (6) | Train Loss: 1.3248 | Train Acc: 0.4854
 Site-Indian_utk                (6) | Train Loss: 1.3357 | Train Acc: 0.4967
 Site-Indian_utk                (6) | Train Loss: 1.2885 | Train Acc: 0.5471
 Site-Indian_utk                (6) | Train Loss: 1.3420 | Train Acc: 0.4970
 Site-Black_utk                 (3) | Train Loss: 1.4576 | Train Acc: 0.4659
 Site-Black_utk                 (3) | Train Loss: 1.1872 | Train Acc: 0.4846
 Site-Black_utk                 (3) | Train Loss: 1.5400 | Train Acc: 0.4136
 Site-Southeast_Asian           (1) | Train Loss: 1.4853 | Train Acc: 0.4207
 Site-Southeast_Asian           (1) | Train Loss: 1.5874 | Train Acc: 0.4481
 Site-Asian_ffhq                (4) | Train Loss: 1.8296 | Train Acc: 0.3841
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.5637 | Train Acc: 0.4118
Average Train Accuracy: 0.4694
 Site-White_utk                 (0) | Val  Loss: 1.3286 | Val  Acc: 0.5000
 Site-White_utk                 (2) | Val  Loss: 1.1726 | Val  Acc: 0.4444
 Site-White_utk                 (2) | Val  Loss: 1.2738 | Val  Acc: 0.3704
 Site-White_utk                 (2) | Val  Loss: 1.4201 | Val  Acc: 0.4000
 Site-White_utk                 (2) | Val  Loss: 1.4413 | Val  Acc: 0.4333
 Site-White_utk                 (2) | Val  Loss: 1.4446 | Val  Acc: 0.5114
 Site-White_utk                 (2) | Val  Loss: 1.3472 | Val  Acc: 0.5116
 Site-White_utk                 (2) | Val  Loss: 1.2886 | Val  Acc: 0.5707
 Site-White_utk                 (2) | Val  Loss: 1.2759 | Val  Acc: 0.5000
 Site-White_utk                 (2) | Val  Loss: 1.3535 | Val  Acc: 0.4757
 Site-East_Asian                (1) | Val  Loss: 1.3864 | Val  Acc: 0.5517
 Site-East_Asian                (1) | Val  Loss: 1.2762 | Val  Acc: 0.5714
 Site-East_Asian                (1) | Val  Loss: 1.4287 | Val  Acc: 0.5556
 Site-East_Asian                (1) | Val  Loss: 1.3083 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.0968 | Val  Acc: 0.5147
 Site-East_Asian                (1) | Val  Loss: 1.3650 | Val  Acc: 0.4950
 Site-East_Asian                (1) | Val  Loss: 1.3508 | Val  Acc: 0.5068
 Site-Indian_utk                (6) | Val  Loss: 1.3461 | Val  Acc: 0.5217
 Site-Indian_utk                (6) | Val  Loss: 1.2030 | Val  Acc: 0.5294
 Site-Indian_utk                (6) | Val  Loss: 1.3341 | Val  Acc: 0.5941
 Site-Indian_utk                (6) | Val  Loss: 1.3574 | Val  Acc: 0.5203
 Site-Indian_utk                (6) | Val  Loss: 1.3042 | Val  Acc: 0.5138
 Site-Black_utk                 (3) | Val  Loss: 1.4526 | Val  Acc: 0.4138
 Site-Black_utk                 (3) | Val  Loss: 1.4726 | Val  Acc: 0.4186
 Site-Black_utk                 (3) | Val  Loss: 1.4309 | Val  Acc: 0.4803
 Site-Southeast_Asian           (1) | Val  Loss: 1.5776 | Val  Acc: 0.4587
 Site-Southeast_Asian           (1) | Val  Loss: 1.5528 | Val  Acc: 0.4313
 Site-Asian_ffhq                (4) | Val  Loss: 2.1790 | Val  Acc: 0.1304
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.6362 | Val  Acc: 0.3600
Average Valid Accuracy: 0.4753
 Best site-White_utk                (0)  | Epoch:49 | Val Acc: 0.5000
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.4444
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.3704
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.4000
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.4333
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.5114
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.5116
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.5707
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.5000
 Best site-White_utk                (2)  | Epoch:49 | Val Acc: 0.4757
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5517
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5714
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5556
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5000
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5147
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.4950
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5068
 Best site-Indian_utk               (6)  | Epoch:49 | Val Acc: 0.5217
 Best site-Indian_utk               (6)  | Epoch:49 | Val Acc: 0.5294
 Best site-Indian_utk               (6)  | Epoch:49 | Val Acc: 0.5941
 Best site-Indian_utk               (6)  | Epoch:49 | Val Acc: 0.5203
 Best site-Indian_utk               (6)  | Epoch:49 | Val Acc: 0.5138
 Best site-Black_utk                (3)  | Epoch:49 | Val Acc: 0.4138
 Best site-Black_utk                (3)  | Epoch:49 | Val Acc: 0.4186
 Best site-Black_utk                (3)  | Epoch:49 | Val Acc: 0.4803
 Best site-Southeast_Asian          (1)  | Epoch:49 | Val Acc: 0.4587
 Best site-Southeast_Asian          (1)  | Epoch:49 | Val Acc: 0.4313
 Best site-Asian_ffhq               (4)  | Epoch:49 | Val Acc: 0.1304
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:49 | Val Acc: 0.3600
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0_gmap...
 Test site-White_utk                 (0)| Epoch:49 | Test Acc: 0.4070
 Test site-East_Asian                (1)| Epoch:49 | Test Acc: 0.4975
 Test site-Indian_utk                (6)| Epoch:49 | Test Acc: 0.5271
 Test site-Black_utk                 (3)| Epoch:49 | Test Acc: 0.4388
 Test site-Southeast_Asian           (1)| Epoch:49 | Test Acc: 0.4437
 Test site-Asian_ffhq                (4)| Epoch:49 | Test Acc: 0.2335
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:49 | Test Acc: 0.2786
White_utk: 0.4070, East_Asian: 0.4975, Indian_utk: 0.5271, Black_utk: 0.4388, Southeast_Asian: 0.4437, Asian_ffhq: 0.2335, Latino_Hispanic_ffhq: 0.2786, 
Average Test Accuracy(group): 0.4037, Average Test Accuracy(individual): 0.4450,
domain std=0.1011, cluster std=0.0982, individual std=0.0695, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0...
============ Train epoch 50 ============
cnt=[1, 2, 3, 4, 10, 6, 3, ]
power_decay: 0.9, powerI: 0.5023, powerC: 0.4977
 Site-White_utk                 (4) | Train Loss: 1.2057 | Train Acc: 0.4737
 Site-White_utk                 (4) | Train Loss: 1.3006 | Train Acc: 0.4643
 Site-White_utk                 (4) | Train Loss: 1.4509 | Train Acc: 0.4878
 Site-White_utk                 (4) | Train Loss: 1.2158 | Train Acc: 0.5574
 Site-White_utk                 (4) | Train Loss: 1.3974 | Train Acc: 0.4667
 Site-White_utk                 (4) | Train Loss: 1.2280 | Train Acc: 0.4318
 Site-White_utk                 (4) | Train Loss: 1.3536 | Train Acc: 0.4278
 Site-White_utk                 (4) | Train Loss: 1.3106 | Train Acc: 0.4965
 Site-White_utk                 (4) | Train Loss: 1.3129 | Train Acc: 0.5178
 Site-White_utk                 (4) | Train Loss: 1.3622 | Train Acc: 0.4523
 Site-East_Asian                (2) | Train Loss: 1.1447 | Train Acc: 0.5349
 Site-East_Asian                (5) | Train Loss: 1.5825 | Train Acc: 0.3438
 Site-East_Asian                (5) | Train Loss: 1.4607 | Train Acc: 0.4468
 Site-East_Asian                (5) | Train Loss: 1.3448 | Train Acc: 0.4820
 Site-East_Asian                (5) | Train Loss: 1.4113 | Train Acc: 0.4657
 Site-East_Asian                (5) | Train Loss: 1.3657 | Train Acc: 0.5067
 Site-East_Asian                (5) | Train Loss: 1.4296 | Train Acc: 0.4525
 Site-Indian_utk                (0) | Train Loss: 1.4272 | Train Acc: 0.5429
 Site-Indian_utk                (3) | Train Loss: 1.3755 | Train Acc: 0.4466
 Site-Indian_utk                (3) | Train Loss: 1.3431 | Train Acc: 0.5166
 Site-Indian_utk                (3) | Train Loss: 1.2771 | Train Acc: 0.5426
 Site-Indian_utk                (3) | Train Loss: 1.3067 | Train Acc: 0.4878
 Site-Black_utk                 (6) | Train Loss: 1.5786 | Train Acc: 0.4773
 Site-Black_utk                 (6) | Train Loss: 1.5629 | Train Acc: 0.5000
 Site-Black_utk                 (6) | Train Loss: 1.5271 | Train Acc: 0.4084
 Site-Southeast_Asian           (2) | Train Loss: 1.4930 | Train Acc: 0.4512
 Site-Southeast_Asian           (2) | Train Loss: 1.5763 | Train Acc: 0.4564
 Site-Asian_ffhq                (1) | Train Loss: 1.6804 | Train Acc: 0.4348
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.4861 | Train Acc: 0.3690
Average Train Accuracy: 0.4704
 Site-White_utk                 (4) | Val  Loss: 1.2910 | Val  Acc: 0.4167
 Site-White_utk                 (4) | Val  Loss: 1.2424 | Val  Acc: 0.4444
 Site-White_utk                 (4) | Val  Loss: 1.3117 | Val  Acc: 0.2963
 Site-White_utk                 (4) | Val  Loss: 1.3328 | Val  Acc: 0.4500
 Site-White_utk                 (4) | Val  Loss: 1.4658 | Val  Acc: 0.4167
 Site-White_utk                 (4) | Val  Loss: 1.4409 | Val  Acc: 0.5114
 Site-White_utk                 (4) | Val  Loss: 1.3055 | Val  Acc: 0.5426
 Site-White_utk                 (4) | Val  Loss: 1.2988 | Val  Acc: 0.5602
 Site-White_utk                 (4) | Val  Loss: 1.2811 | Val  Acc: 0.5393
 Site-White_utk                 (4) | Val  Loss: 1.3566 | Val  Acc: 0.4733
 Site-East_Asian                (2) | Val  Loss: 1.3102 | Val  Acc: 0.5172
 Site-East_Asian                (5) | Val  Loss: 1.3281 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.4428 | Val  Acc: 0.4444
 Site-East_Asian                (5) | Val  Loss: 1.3408 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.0915 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.4129 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.3726 | Val  Acc: 0.5068
 Site-Indian_utk                (0) | Val  Loss: 1.3611 | Val  Acc: 0.5435
 Site-Indian_utk                (3) | Val  Loss: 1.3063 | Val  Acc: 0.5294
 Site-Indian_utk                (3) | Val  Loss: 1.3433 | Val  Acc: 0.5446
 Site-Indian_utk                (3) | Val  Loss: 1.3568 | Val  Acc: 0.5068
 Site-Indian_utk                (3) | Val  Loss: 1.3159 | Val  Acc: 0.5183
 Site-Black_utk                 (6) | Val  Loss: 1.5250 | Val  Acc: 0.3966
 Site-Black_utk                 (6) | Val  Loss: 1.5050 | Val  Acc: 0.3721
 Site-Black_utk                 (6) | Val  Loss: 1.4721 | Val  Acc: 0.4252
 Site-Southeast_Asian           (2) | Val  Loss: 1.5945 | Val  Acc: 0.4404
 Site-Southeast_Asian           (2) | Val  Loss: 1.5409 | Val  Acc: 0.4437
 Site-Asian_ffhq                (1) | Val  Loss: 2.0252 | Val  Acc: 0.1467
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.5894 | Val  Acc: 0.3520
Average Valid Accuracy: 0.4611
============ Train epoch 51 ============
cnt=[10, 8, 3, 1, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.5021, powerC: 0.4979
 Site-White_utk                 (0) | Train Loss: 1.1343 | Train Acc: 0.4737
 Site-White_utk                 (0) | Train Loss: 1.2424 | Train Acc: 0.5714
 Site-White_utk                 (0) | Train Loss: 1.3874 | Train Acc: 0.4634
 Site-White_utk                 (0) | Train Loss: 1.2442 | Train Acc: 0.5574
 Site-White_utk                 (0) | Train Loss: 1.2662 | Train Acc: 0.5000
 Site-White_utk                 (0) | Train Loss: 1.3414 | Train Acc: 0.4621
 Site-White_utk                 (0) | Train Loss: 1.5227 | Train Acc: 0.4124
 Site-White_utk                 (0) | Train Loss: 1.2967 | Train Acc: 0.4685
 Site-White_utk                 (0) | Train Loss: 1.3480 | Train Acc: 0.5226
 Site-White_utk                 (0) | Train Loss: 1.3772 | Train Acc: 0.4378
 Site-East_Asian                (4) | Train Loss: 1.1676 | Train Acc: 0.6047
 Site-East_Asian                (1) | Train Loss: 1.5232 | Train Acc: 0.3750
 Site-East_Asian                (1) | Train Loss: 1.4716 | Train Acc: 0.4468
 Site-East_Asian                (1) | Train Loss: 1.4431 | Train Acc: 0.4892
 Site-East_Asian                (1) | Train Loss: 1.3131 | Train Acc: 0.4706
 Site-East_Asian                (1) | Train Loss: 1.3175 | Train Acc: 0.5133
 Site-East_Asian                (1) | Train Loss: 1.3981 | Train Acc: 0.4525
 Site-Indian_utk                (6) | Train Loss: 1.2738 | Train Acc: 0.5286
 Site-Indian_utk                (6) | Train Loss: 1.2906 | Train Acc: 0.4854
 Site-Indian_utk                (6) | Train Loss: 1.3094 | Train Acc: 0.5099
 Site-Indian_utk                (6) | Train Loss: 1.2639 | Train Acc: 0.5336
 Site-Indian_utk                (6) | Train Loss: 1.3194 | Train Acc: 0.5244
 Site-Black_utk                 (2) | Train Loss: 1.5308 | Train Acc: 0.4318
 Site-Black_utk                 (2) | Train Loss: 1.1144 | Train Acc: 0.5308
 Site-Black_utk                 (2) | Train Loss: 1.5460 | Train Acc: 0.3717
 Site-Southeast_Asian           (1) | Train Loss: 1.5257 | Train Acc: 0.4268
 Site-Southeast_Asian           (1) | Train Loss: 1.5863 | Train Acc: 0.4274
 Site-Asian_ffhq                (3) | Train Loss: 1.6275 | Train Acc: 0.4420
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.4369 | Train Acc: 0.4225
Average Train Accuracy: 0.4778
 Site-White_utk                 (0) | Val  Loss: 1.2873 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.1777 | Val  Acc: 0.4444
 Site-White_utk                 (0) | Val  Loss: 1.2310 | Val  Acc: 0.3704
 Site-White_utk                 (0) | Val  Loss: 1.4404 | Val  Acc: 0.4000
 Site-White_utk                 (0) | Val  Loss: 1.4545 | Val  Acc: 0.4833
 Site-White_utk                 (0) | Val  Loss: 1.4197 | Val  Acc: 0.5341
 Site-White_utk                 (0) | Val  Loss: 1.2722 | Val  Acc: 0.5504
 Site-White_utk                 (0) | Val  Loss: 1.3112 | Val  Acc: 0.5497
 Site-White_utk                 (0) | Val  Loss: 1.2712 | Val  Acc: 0.5321
 Site-White_utk                 (0) | Val  Loss: 1.3914 | Val  Acc: 0.4296
 Site-East_Asian                (4) | Val  Loss: 1.2922 | Val  Acc: 0.5517
 Site-East_Asian                (1) | Val  Loss: 1.3558 | Val  Acc: 0.5476
 Site-East_Asian                (1) | Val  Loss: 1.4601 | Val  Acc: 0.4762
 Site-East_Asian                (1) | Val  Loss: 1.3142 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.0561 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.3123 | Val  Acc: 0.4900
 Site-East_Asian                (1) | Val  Loss: 1.3647 | Val  Acc: 0.4932
 Site-Indian_utk                (6) | Val  Loss: 1.3479 | Val  Acc: 0.5217
 Site-Indian_utk                (6) | Val  Loss: 1.2926 | Val  Acc: 0.5294
 Site-Indian_utk                (6) | Val  Loss: 1.2903 | Val  Acc: 0.5842
 Site-Indian_utk                (6) | Val  Loss: 1.3459 | Val  Acc: 0.5135
 Site-Indian_utk                (6) | Val  Loss: 1.3283 | Val  Acc: 0.5046
 Site-Black_utk                 (2) | Val  Loss: 1.4586 | Val  Acc: 0.4138
 Site-Black_utk                 (2) | Val  Loss: 1.5269 | Val  Acc: 0.3953
 Site-Black_utk                 (2) | Val  Loss: 1.4574 | Val  Acc: 0.4567
 Site-Southeast_Asian           (1) | Val  Loss: 1.5873 | Val  Acc: 0.4587
 Site-Southeast_Asian           (1) | Val  Loss: 1.5524 | Val  Acc: 0.4062
 Site-Asian_ffhq                (3) | Val  Loss: 2.0620 | Val  Acc: 0.1467
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.5415 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4691
 Test site-White_utk                 (0)| Epoch:49 | Test Acc: 0.3977
 Test site-East_Asian                (4)| Epoch:49 | Test Acc: 0.5075
 Test site-Indian_utk                (6)| Epoch:49 | Test Acc: 0.5396
 Test site-Black_utk                 (2)| Epoch:49 | Test Acc: 0.4286
 Test site-Southeast_Asian           (1)| Epoch:49 | Test Acc: 0.4454
 Test site-Asian_ffhq                (3)| Epoch:49 | Test Acc: 0.2739
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:49 | Test Acc: 0.3035
White_utk: 0.3977, East_Asian: 0.5075, Indian_utk: 0.5396, Black_utk: 0.4286, Southeast_Asian: 0.4454, Asian_ffhq: 0.2739, Latino_Hispanic_ffhq: 0.3035, 
Average Test Accuracy(group): 0.4137, Average Test Accuracy(individual): 0.4476,
domain std=0.0909, cluster std=0.0946, individual std=0.0705, 
============ Train epoch 52 ============
cnt=[1, 2, 1, 8, 8, 8, 1, ]
power_decay: 0.9, powerI: 0.5019, powerC: 0.4981
 Site-White_utk                 (0) | Train Loss: 1.1774 | Train Acc: 0.5263
 Site-White_utk                 (6) | Train Loss: 1.2915 | Train Acc: 0.5357
 Site-White_utk                 (3) | Train Loss: 1.4341 | Train Acc: 0.4390
 Site-White_utk                 (3) | Train Loss: 1.1695 | Train Acc: 0.5410
 Site-White_utk                 (3) | Train Loss: 1.2767 | Train Acc: 0.5333
 Site-White_utk                 (3) | Train Loss: 1.3168 | Train Acc: 0.4697
 Site-White_utk                 (3) | Train Loss: 1.3408 | Train Acc: 0.4381
 Site-White_utk                 (3) | Train Loss: 1.2510 | Train Acc: 0.5280
 Site-White_utk                 (3) | Train Loss: 1.2765 | Train Acc: 0.5273
 Site-White_utk                 (3) | Train Loss: 1.2990 | Train Acc: 0.5057
 Site-East_Asian                (2) | Train Loss: 1.1666 | Train Acc: 0.5581
 Site-East_Asian                (4) | Train Loss: 1.6248 | Train Acc: 0.3750
 Site-East_Asian                (4) | Train Loss: 1.5231 | Train Acc: 0.4787
 Site-East_Asian                (4) | Train Loss: 1.4317 | Train Acc: 0.4892
 Site-East_Asian                (4) | Train Loss: 1.4598 | Train Acc: 0.4804
 Site-East_Asian                (4) | Train Loss: 1.3595 | Train Acc: 0.5133
 Site-East_Asian                (4) | Train Loss: 1.3855 | Train Acc: 0.4842
 Site-Indian_utk                (5) | Train Loss: 1.2871 | Train Acc: 0.5000
 Site-Indian_utk                (5) | Train Loss: 1.2481 | Train Acc: 0.4854
 Site-Indian_utk                (5) | Train Loss: 1.2581 | Train Acc: 0.4967
 Site-Indian_utk                (5) | Train Loss: 1.2731 | Train Acc: 0.5291
 Site-Indian_utk                (5) | Train Loss: 1.3304 | Train Acc: 0.4787
 Site-Black_utk                 (5) | Train Loss: 1.4166 | Train Acc: 0.4318
 Site-Black_utk                 (5) | Train Loss: 1.5005 | Train Acc: 0.4538
 Site-Black_utk                 (5) | Train Loss: 1.5466 | Train Acc: 0.4084
 Site-Southeast_Asian           (4) | Train Loss: 1.5138 | Train Acc: 0.4634
 Site-Southeast_Asian           (4) | Train Loss: 1.5469 | Train Acc: 0.4440
 Site-Asian_ffhq                (1) | Train Loss: 1.8938 | Train Acc: 0.3623
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6411 | Train Acc: 0.3850
Average Train Accuracy: 0.4780
 Site-White_utk                 (0) | Val  Loss: 1.3071 | Val  Acc: 0.3333
 Site-White_utk                 (6) | Val  Loss: 1.1134 | Val  Acc: 0.6111
 Site-White_utk                 (3) | Val  Loss: 1.2273 | Val  Acc: 0.4815
 Site-White_utk                 (3) | Val  Loss: 1.4059 | Val  Acc: 0.4500
 Site-White_utk                 (3) | Val  Loss: 1.4305 | Val  Acc: 0.4500
 Site-White_utk                 (3) | Val  Loss: 1.3128 | Val  Acc: 0.5341
 Site-White_utk                 (3) | Val  Loss: 1.3750 | Val  Acc: 0.5426
 Site-White_utk                 (3) | Val  Loss: 1.2626 | Val  Acc: 0.5969
 Site-White_utk                 (3) | Val  Loss: 1.2324 | Val  Acc: 0.5393
 Site-White_utk                 (3) | Val  Loss: 1.3223 | Val  Acc: 0.5073
 Site-East_Asian                (2) | Val  Loss: 1.4088 | Val  Acc: 0.4483
 Site-East_Asian                (4) | Val  Loss: 1.2712 | Val  Acc: 0.5714
 Site-East_Asian                (4) | Val  Loss: 1.4628 | Val  Acc: 0.5238
 Site-East_Asian                (4) | Val  Loss: 1.3126 | Val  Acc: 0.5543
 Site-East_Asian                (4) | Val  Loss: 1.0910 | Val  Acc: 0.5368
 Site-East_Asian                (4) | Val  Loss: 1.3600 | Val  Acc: 0.5200
 Site-East_Asian                (4) | Val  Loss: 1.3663 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.3441 | Val  Acc: 0.4565
 Site-Indian_utk                (5) | Val  Loss: 1.1402 | Val  Acc: 0.5441
 Site-Indian_utk                (5) | Val  Loss: 1.2743 | Val  Acc: 0.6040
 Site-Indian_utk                (5) | Val  Loss: 1.3070 | Val  Acc: 0.5338
 Site-Indian_utk                (5) | Val  Loss: 1.2916 | Val  Acc: 0.5183
 Site-Black_utk                 (5) | Val  Loss: 1.4480 | Val  Acc: 0.3621
 Site-Black_utk                 (5) | Val  Loss: 1.5058 | Val  Acc: 0.4186
 Site-Black_utk                 (5) | Val  Loss: 1.4311 | Val  Acc: 0.4409
 Site-Southeast_Asian           (4) | Val  Loss: 1.5383 | Val  Acc: 0.4679
 Site-Southeast_Asian           (4) | Val  Loss: 1.5105 | Val  Acc: 0.4813
 Site-Asian_ffhq                (1) | Val  Loss: 2.2224 | Val  Acc: 0.1359
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.6541 | Val  Acc: 0.3680
Average Valid Accuracy: 0.4839
 Best site-White_utk                (0)  | Epoch:52 | Val Acc: 0.3333
 Best site-White_utk                (6)  | Epoch:52 | Val Acc: 0.6111
 Best site-White_utk                (3)  | Epoch:52 | Val Acc: 0.4815
 Best site-White_utk                (3)  | Epoch:52 | Val Acc: 0.4500
 Best site-White_utk                (3)  | Epoch:52 | Val Acc: 0.4500
 Best site-White_utk                (3)  | Epoch:52 | Val Acc: 0.5341
 Best site-White_utk                (3)  | Epoch:52 | Val Acc: 0.5426
 Best site-White_utk                (3)  | Epoch:52 | Val Acc: 0.5969
 Best site-White_utk                (3)  | Epoch:52 | Val Acc: 0.5393
 Best site-White_utk                (3)  | Epoch:52 | Val Acc: 0.5073
 Best site-East_Asian               (2)  | Epoch:52 | Val Acc: 0.4483
 Best site-East_Asian               (4)  | Epoch:52 | Val Acc: 0.5714
 Best site-East_Asian               (4)  | Epoch:52 | Val Acc: 0.5238
 Best site-East_Asian               (4)  | Epoch:52 | Val Acc: 0.5543
 Best site-East_Asian               (4)  | Epoch:52 | Val Acc: 0.5368
 Best site-East_Asian               (4)  | Epoch:52 | Val Acc: 0.5200
 Best site-East_Asian               (4)  | Epoch:52 | Val Acc: 0.5000
 Best site-Indian_utk               (5)  | Epoch:52 | Val Acc: 0.4565
 Best site-Indian_utk               (5)  | Epoch:52 | Val Acc: 0.5441
 Best site-Indian_utk               (5)  | Epoch:52 | Val Acc: 0.6040
 Best site-Indian_utk               (5)  | Epoch:52 | Val Acc: 0.5338
 Best site-Indian_utk               (5)  | Epoch:52 | Val Acc: 0.5183
 Best site-Black_utk                (5)  | Epoch:52 | Val Acc: 0.3621
 Best site-Black_utk                (5)  | Epoch:52 | Val Acc: 0.4186
 Best site-Black_utk                (5)  | Epoch:52 | Val Acc: 0.4409
 Best site-Southeast_Asian          (4)  | Epoch:52 | Val Acc: 0.4679
 Best site-Southeast_Asian          (4)  | Epoch:52 | Val Acc: 0.4813
 Best site-Asian_ffhq               (1)  | Epoch:52 | Val Acc: 0.1359
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:52 | Val Acc: 0.3680
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=2.0...
============ Train epoch 53 ============
cnt=[8, 9, 3, 2, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5017, powerC: 0.4983
 Site-White_utk                 (5) | Train Loss: 1.2961 | Train Acc: 0.4737
 Site-White_utk                 (0) | Train Loss: 1.2593 | Train Acc: 0.5000
 Site-White_utk                 (0) | Train Loss: 1.4613 | Train Acc: 0.4390
 Site-White_utk                 (6) | Train Loss: 1.2261 | Train Acc: 0.4918
 Site-White_utk                 (0) | Train Loss: 1.3527 | Train Acc: 0.4556
 Site-White_utk                 (0) | Train Loss: 1.3465 | Train Acc: 0.4242
 Site-White_utk                 (0) | Train Loss: 1.8796 | Train Acc: 0.3969
 Site-White_utk                 (0) | Train Loss: 1.3388 | Train Acc: 0.4650
 Site-White_utk                 (0) | Train Loss: 1.3361 | Train Acc: 0.5083
 Site-White_utk                 (0) | Train Loss: 1.3677 | Train Acc: 0.4523
 Site-East_Asian                (1) | Train Loss: 1.1655 | Train Acc: 0.5581
 Site-East_Asian                (1) | Train Loss: 1.6173 | Train Acc: 0.2969
 Site-East_Asian                (1) | Train Loss: 1.5652 | Train Acc: 0.4574
 Site-East_Asian                (1) | Train Loss: 1.2891 | Train Acc: 0.4964
 Site-East_Asian                (1) | Train Loss: 1.3176 | Train Acc: 0.4706
 Site-East_Asian                (1) | Train Loss: 1.3274 | Train Acc: 0.5067
 Site-East_Asian                (1) | Train Loss: 1.4080 | Train Acc: 0.4570
 Site-Indian_utk                (4) | Train Loss: 1.0058 | Train Acc: 0.5429
 Site-Indian_utk                (4) | Train Loss: 1.3650 | Train Acc: 0.5340
 Site-Indian_utk                (4) | Train Loss: 1.3416 | Train Acc: 0.4901
 Site-Indian_utk                (4) | Train Loss: 1.2244 | Train Acc: 0.5471
 Site-Indian_utk                (4) | Train Loss: 1.3064 | Train Acc: 0.4817
 Site-Black_utk                 (2) | Train Loss: 1.4250 | Train Acc: 0.4773
 Site-Black_utk                 (2) | Train Loss: 1.8602 | Train Acc: 0.4538
 Site-Black_utk                 (2) | Train Loss: 1.5383 | Train Acc: 0.4031
 Site-Southeast_Asian           (1) | Train Loss: 1.5558 | Train Acc: 0.4268
 Site-Southeast_Asian           (1) | Train Loss: 1.5543 | Train Acc: 0.4481
 Site-Asian_ffhq                (3) | Train Loss: 1.6208 | Train Acc: 0.4565
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.4004 | Train Acc: 0.4278
Average Train Accuracy: 0.4669
 Site-White_utk                 (5) | Val  Loss: 1.2511 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.1488 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.3224 | Val  Acc: 0.4444
 Site-White_utk                 (6) | Val  Loss: 1.4463 | Val  Acc: 0.4750
 Site-White_utk                 (0) | Val  Loss: 1.4973 | Val  Acc: 0.4000
 Site-White_utk                 (0) | Val  Loss: 1.4387 | Val  Acc: 0.4886
 Site-White_utk                 (0) | Val  Loss: 1.3159 | Val  Acc: 0.5116
 Site-White_utk                 (0) | Val  Loss: 1.3267 | Val  Acc: 0.5131
 Site-White_utk                 (0) | Val  Loss: 1.2844 | Val  Acc: 0.5214
 Site-White_utk                 (0) | Val  Loss: 1.3915 | Val  Acc: 0.4490
 Site-East_Asian                (1) | Val  Loss: 1.3450 | Val  Acc: 0.5517
 Site-East_Asian                (1) | Val  Loss: 1.2695 | Val  Acc: 0.5238
 Site-East_Asian                (1) | Val  Loss: 1.4159 | Val  Acc: 0.5238
 Site-East_Asian                (1) | Val  Loss: 1.3402 | Val  Acc: 0.5326
 Site-East_Asian                (1) | Val  Loss: 1.0550 | Val  Acc: 0.5147
 Site-East_Asian                (1) | Val  Loss: 1.2988 | Val  Acc: 0.5300
 Site-East_Asian                (1) | Val  Loss: 1.3455 | Val  Acc: 0.4864
 Site-Indian_utk                (4) | Val  Loss: 1.2399 | Val  Acc: 0.5435
 Site-Indian_utk                (4) | Val  Loss: 1.3273 | Val  Acc: 0.4853
 Site-Indian_utk                (4) | Val  Loss: 1.3211 | Val  Acc: 0.5050
 Site-Indian_utk                (4) | Val  Loss: 1.2966 | Val  Acc: 0.4932
 Site-Indian_utk                (4) | Val  Loss: 1.2939 | Val  Acc: 0.5183
 Site-Black_utk                 (2) | Val  Loss: 1.3786 | Val  Acc: 0.3966
 Site-Black_utk                 (2) | Val  Loss: 1.4705 | Val  Acc: 0.4186
 Site-Black_utk                 (2) | Val  Loss: 1.4058 | Val  Acc: 0.4882
 Site-Southeast_Asian           (1) | Val  Loss: 1.6101 | Val  Acc: 0.4587
 Site-Southeast_Asian           (1) | Val  Loss: 1.5126 | Val  Acc: 0.4437
 Site-Asian_ffhq                (3) | Val  Loss: 1.9857 | Val  Acc: 0.1630
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.5183 | Val  Acc: 0.3600
Average Valid Accuracy: 0.4738
 Test site-White_utk                 (5)| Epoch:52 | Test Acc: 0.3947
 Test site-East_Asian                (1)| Epoch:52 | Test Acc: 0.5085
 Test site-Indian_utk                (4)| Epoch:52 | Test Acc: 0.5417
 Test site-Black_utk                 (2)| Epoch:52 | Test Acc: 0.4439
 Test site-Southeast_Asian           (1)| Epoch:52 | Test Acc: 0.4506
 Test site-Asian_ffhq                (3)| Epoch:52 | Test Acc: 0.2904
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:52 | Test Acc: 0.3184
White_utk: 0.3947, East_Asian: 0.5085, Indian_utk: 0.5417, Black_utk: 0.4439, Southeast_Asian: 0.4506, Asian_ffhq: 0.2904, Latino_Hispanic_ffhq: 0.3184, 
Average Test Accuracy(group): 0.4212, Average Test Accuracy(individual): 0.4502,
domain std=0.0861, cluster std=0.0720, individual std=0.0693, 
============ Train epoch 54 ============
