===2023-06-15 20:53:53===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[24,35,52,76,112,165,243,358,526,774,54,80,118,173,255,375,552,87,129,189,279,410,110,162,239,205,301,345,234,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 1, 1, 3, 5, 8, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.1860 | Train Acc: 0.1250
 Site-White_utk                 (0) | Train Loss: 2.3488 | Train Acc: 0.1143
 Site-White_utk                 (0) | Train Loss: 2.4357 | Train Acc: 0.0962
 Site-White_utk                 (0) | Train Loss: 2.4090 | Train Acc: 0.1184
 Site-White_utk                 (0) | Train Loss: 2.3390 | Train Acc: 0.1161
 Site-White_utk                 (0) | Train Loss: 2.3164 | Train Acc: 0.1152
 Site-White_utk                 (0) | Train Loss: 2.3436 | Train Acc: 0.1111
 Site-White_utk                 (0) | Train Loss: 2.3481 | Train Acc: 0.1061
 Site-White_utk                 (0) | Train Loss: 2.3226 | Train Acc: 0.1122
 Site-White_utk                 (0) | Train Loss: 2.2987 | Train Acc: 0.1137
 Site-East_Asian                (1) | Train Loss: 1.8354 | Train Acc: 0.3704
 Site-East_Asian                (5) | Train Loss: 1.8503 | Train Acc: 0.3625
 Site-East_Asian                (5) | Train Loss: 1.7597 | Train Acc: 0.4237
 Site-East_Asian                (5) | Train Loss: 1.8597 | Train Acc: 0.3642
 Site-East_Asian                (5) | Train Loss: 1.8187 | Train Acc: 0.3804
 Site-East_Asian                (5) | Train Loss: 1.8296 | Train Acc: 0.3973
 Site-East_Asian                (5) | Train Loss: 1.8252 | Train Acc: 0.3804
 Site-Indian_utk                (4) | Train Loss: 1.9434 | Train Acc: 0.3448
 Site-Indian_utk                (4) | Train Loss: 2.0556 | Train Acc: 0.3721
 Site-Indian_utk                (4) | Train Loss: 1.9295 | Train Acc: 0.3492
 Site-Indian_utk                (4) | Train Loss: 1.9412 | Train Acc: 0.3584
 Site-Indian_utk                (4) | Train Loss: 1.8106 | Train Acc: 0.3878
 Site-Black_utk                 (3) | Train Loss: 1.9101 | Train Acc: 0.3455
 Site-Black_utk                 (3) | Train Loss: 1.9316 | Train Acc: 0.3210
 Site-Black_utk                 (3) | Train Loss: 1.9275 | Train Acc: 0.3347
 Site-Southeast_Asian           (5) | Train Loss: 1.9673 | Train Acc: 0.3122
 Site-Southeast_Asian           (5) | Train Loss: 2.0063 | Train Acc: 0.3056
 Site-Asian_ffhq                (6) | Train Loss: 1.4150 | Train Acc: 0.5565
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5518 | Train Acc: 0.4402
Average Train Accuracy: 0.2840
 Site-White_utk                 (0) | Val  Loss: 2.4827 | Val  Acc: 0.0625
 Site-White_utk                 (0) | Val  Loss: 2.3463 | Val  Acc: 0.0870
 Site-White_utk                 (0) | Val  Loss: 2.2853 | Val  Acc: 0.1176
 Site-White_utk                 (0) | Val  Loss: 2.3412 | Val  Acc: 0.0980
 Site-White_utk                 (0) | Val  Loss: 2.3429 | Val  Acc: 0.1067
 Site-White_utk                 (0) | Val  Loss: 2.3315 | Val  Acc: 0.1091
 Site-White_utk                 (0) | Val  Loss: 2.3376 | Val  Acc: 0.1111
 Site-White_utk                 (0) | Val  Loss: 2.3130 | Val  Acc: 0.1134
 Site-White_utk                 (0) | Val  Loss: 2.3374 | Val  Acc: 0.1054
 Site-White_utk                 (0) | Val  Loss: 2.3587 | Val  Acc: 0.1124
 Site-East_Asian                (1) | Val  Loss: 1.6094 | Val  Acc: 0.4722
 Site-East_Asian                (5) | Val  Loss: 1.8074 | Val  Acc: 0.3774
 Site-East_Asian                (5) | Val  Loss: 1.7478 | Val  Acc: 0.3846
 Site-East_Asian                (5) | Val  Loss: 1.8637 | Val  Acc: 0.3793
 Site-East_Asian                (5) | Val  Loss: 1.8581 | Val  Acc: 0.3765
 Site-East_Asian                (5) | Val  Loss: 1.8259 | Val  Acc: 0.3960
 Site-East_Asian                (5) | Val  Loss: 1.8196 | Val  Acc: 0.3913
 Site-Indian_utk                (4) | Val  Loss: 1.8986 | Val  Acc: 0.3621
 Site-Indian_utk                (4) | Val  Loss: 1.8117 | Val  Acc: 0.3837
 Site-Indian_utk                (4) | Val  Loss: 1.8610 | Val  Acc: 0.3810
 Site-Indian_utk                (4) | Val  Loss: 1.9081 | Val  Acc: 0.3602
 Site-Indian_utk                (4) | Val  Loss: 1.9416 | Val  Acc: 0.3480
 Site-Black_utk                 (3) | Val  Loss: 1.8051 | Val  Acc: 0.3425
 Site-Black_utk                 (3) | Val  Loss: 1.9664 | Val  Acc: 0.3148
 Site-Black_utk                 (3) | Val  Loss: 1.9491 | Val  Acc: 0.3333
 Site-Southeast_Asian           (5) | Val  Loss: 1.9928 | Val  Acc: 0.3088
 Site-Southeast_Asian           (5) | Val  Loss: 2.0086 | Val  Acc: 0.2935
 Site-Asian_ffhq                (6) | Val  Loss: 2.0256 | Val  Acc: 0.0043
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.5468 | Val  Acc: 0.5256
Average Valid Accuracy: 0.2675
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.0625
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.0870
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.0980
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1067
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1091
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1111
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1134
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1054
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1124
 Best site-East_Asian               (1)  | Epoch:0 | Val Acc: 0.4722
 Best site-East_Asian               (5)  | Epoch:0 | Val Acc: 0.3774
 Best site-East_Asian               (5)  | Epoch:0 | Val Acc: 0.3846
 Best site-East_Asian               (5)  | Epoch:0 | Val Acc: 0.3793
 Best site-East_Asian               (5)  | Epoch:0 | Val Acc: 0.3765
 Best site-East_Asian               (5)  | Epoch:0 | Val Acc: 0.3960
 Best site-East_Asian               (5)  | Epoch:0 | Val Acc: 0.3913
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3621
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3837
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3810
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3602
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3480
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.3425
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.3148
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.3333
 Best site-Southeast_Asian          (5)  | Epoch:0 | Val Acc: 0.3088
 Best site-Southeast_Asian          (5)  | Epoch:0 | Val Acc: 0.2935
 Best site-Asian_ffhq               (6)  | Epoch:0 | Val Acc: 0.0043
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:0 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 8, 5, 9, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (0) | Train Loss: 1.8754 | Train Acc: 0.3333
 Site-White_utk                 (3) | Train Loss: 1.9800 | Train Acc: 0.2571
 Site-White_utk                 (3) | Train Loss: 2.0253 | Train Acc: 0.2500
 Site-White_utk                 (3) | Train Loss: 1.9944 | Train Acc: 0.2105
 Site-White_utk                 (3) | Train Loss: 1.9882 | Train Acc: 0.2411
 Site-White_utk                 (3) | Train Loss: 1.9647 | Train Acc: 0.2182
 Site-White_utk                 (3) | Train Loss: 2.0174 | Train Acc: 0.2099
 Site-White_utk                 (3) | Train Loss: 1.9765 | Train Acc: 0.2654
 Site-White_utk                 (3) | Train Loss: 1.9886 | Train Acc: 0.2681
 Site-White_utk                 (3) | Train Loss: 1.9521 | Train Acc: 0.2829
 Site-East_Asian                (6) | Train Loss: 1.8934 | Train Acc: 0.3889
 Site-East_Asian                (1) | Train Loss: 1.9416 | Train Acc: 0.2875
 Site-East_Asian                (1) | Train Loss: 1.9010 | Train Acc: 0.3814
 Site-East_Asian                (1) | Train Loss: 1.9290 | Train Acc: 0.3584
 Site-East_Asian                (1) | Train Loss: 1.9039 | Train Acc: 0.3608
 Site-East_Asian                (1) | Train Loss: 1.9292 | Train Acc: 0.3333
 Site-East_Asian                (1) | Train Loss: 1.9145 | Train Acc: 0.3696
 Site-Indian_utk                (2) | Train Loss: 1.9620 | Train Acc: 0.3218
 Site-Indian_utk                (2) | Train Loss: 1.9970 | Train Acc: 0.3256
 Site-Indian_utk                (2) | Train Loss: 1.9318 | Train Acc: 0.3175
 Site-Indian_utk                (2) | Train Loss: 1.9191 | Train Acc: 0.3620
 Site-Indian_utk                (2) | Train Loss: 1.8663 | Train Acc: 0.3610
 Site-Black_utk                 (5) | Train Loss: 1.9174 | Train Acc: 0.3273
 Site-Black_utk                 (5) | Train Loss: 1.9897 | Train Acc: 0.3148
 Site-Black_utk                 (5) | Train Loss: 1.9915 | Train Acc: 0.2427
 Site-Southeast_Asian           (1) | Train Loss: 2.0186 | Train Acc: 0.2585
 Site-Southeast_Asian           (1) | Train Loss: 1.9922 | Train Acc: 0.3156
 Site-Asian_ffhq                (4) | Train Loss: 1.8680 | Train Acc: 0.3565
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.8811 | Train Acc: 0.3761
Average Train Accuracy: 0.3067
 Site-White_utk                 (0) | Val  Loss: 1.9468 | Val  Acc: 0.3125
 Site-White_utk                 (3) | Val  Loss: 2.0278 | Val  Acc: 0.2174
 Site-White_utk                 (3) | Val  Loss: 1.9871 | Val  Acc: 0.2647
 Site-White_utk                 (3) | Val  Loss: 1.9530 | Val  Acc: 0.2745
 Site-White_utk                 (3) | Val  Loss: 1.9619 | Val  Acc: 0.2933
 Site-White_utk                 (3) | Val  Loss: 2.0208 | Val  Acc: 0.2727
 Site-White_utk                 (3) | Val  Loss: 2.0003 | Val  Acc: 0.2778
 Site-White_utk                 (3) | Val  Loss: 1.9878 | Val  Acc: 0.2689
 Site-White_utk                 (3) | Val  Loss: 1.9924 | Val  Acc: 0.2536
 Site-White_utk                 (3) | Val  Loss: 1.9801 | Val  Acc: 0.2655
 Site-East_Asian                (6) | Val  Loss: 1.8275 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.9179 | Val  Acc: 0.3396
 Site-East_Asian                (1) | Val  Loss: 1.9392 | Val  Acc: 0.2436
 Site-East_Asian                (1) | Val  Loss: 1.9428 | Val  Acc: 0.3707
 Site-East_Asian                (1) | Val  Loss: 1.9576 | Val  Acc: 0.3118
 Site-East_Asian                (1) | Val  Loss: 1.9122 | Val  Acc: 0.3560
 Site-East_Asian                (1) | Val  Loss: 1.9235 | Val  Acc: 0.3451
 Site-Indian_utk                (2) | Val  Loss: 1.9022 | Val  Acc: 0.2414
 Site-Indian_utk                (2) | Val  Loss: 1.8879 | Val  Acc: 0.3488
 Site-Indian_utk                (2) | Val  Loss: 1.8952 | Val  Acc: 0.3730
 Site-Indian_utk                (2) | Val  Loss: 1.9408 | Val  Acc: 0.3226
 Site-Indian_utk                (2) | Val  Loss: 1.9197 | Val  Acc: 0.3590
 Site-Black_utk                 (5) | Val  Loss: 2.0336 | Val  Acc: 0.3151
 Site-Black_utk                 (5) | Val  Loss: 2.0068 | Val  Acc: 0.2500
 Site-Black_utk                 (5) | Val  Loss: 1.9967 | Val  Acc: 0.2642
 Site-Southeast_Asian           (1) | Val  Loss: 1.9302 | Val  Acc: 0.3162
 Site-Southeast_Asian           (1) | Val  Loss: 1.9697 | Val  Acc: 0.3085
 Site-Asian_ffhq                (4) | Val  Loss: 2.0353 | Val  Acc: 0.2087
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.9307 | Val  Acc: 0.2821
Average Valid Accuracy: 0.3020
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.3125
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2174
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2647
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2745
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2933
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2727
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2778
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2689
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2536
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2655
 Best site-East_Asian               (6)  | Epoch:1 | Val Acc: 0.5000
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3396
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.2436
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3707
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3118
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3560
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3451
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.2414
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3488
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3730
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3226
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3590
 Best site-Black_utk                (5)  | Epoch:1 | Val Acc: 0.3151
 Best site-Black_utk                (5)  | Epoch:1 | Val Acc: 0.2500
 Best site-Black_utk                (5)  | Epoch:1 | Val Acc: 0.2642
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.3162
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.3085
 Best site-Asian_ffhq               (4)  | Epoch:1 | Val Acc: 0.2087
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:1 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 2 ============
cnt=[8, 5, 9, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (6) | Train Loss: 1.7050 | Train Acc: 0.5417
 Site-White_utk                 (2) | Train Loss: 1.7844 | Train Acc: 0.3143
 Site-White_utk                 (2) | Train Loss: 1.9058 | Train Acc: 0.3077
 Site-White_utk                 (2) | Train Loss: 1.7919 | Train Acc: 0.2895
 Site-White_utk                 (2) | Train Loss: 1.8268 | Train Acc: 0.3750
 Site-White_utk                 (2) | Train Loss: 1.8578 | Train Acc: 0.3030
 Site-White_utk                 (2) | Train Loss: 1.8932 | Train Acc: 0.2840
 Site-White_utk                 (2) | Train Loss: 1.8437 | Train Acc: 0.3101
 Site-White_utk                 (2) | Train Loss: 1.8461 | Train Acc: 0.3232
 Site-White_utk                 (2) | Train Loss: 1.8214 | Train Acc: 0.3114
 Site-East_Asian                (4) | Train Loss: 1.6819 | Train Acc: 0.4630
 Site-East_Asian                (0) | Train Loss: 1.8554 | Train Acc: 0.3000
 Site-East_Asian                (0) | Train Loss: 1.8465 | Train Acc: 0.4407
 Site-East_Asian                (0) | Train Loss: 1.8428 | Train Acc: 0.3410
 Site-East_Asian                (0) | Train Loss: 1.8306 | Train Acc: 0.3529
 Site-East_Asian                (0) | Train Loss: 1.8571 | Train Acc: 0.3547
 Site-East_Asian                (0) | Train Loss: 1.8332 | Train Acc: 0.3732
 Site-Indian_utk                (1) | Train Loss: 1.7960 | Train Acc: 0.3333
 Site-Indian_utk                (1) | Train Loss: 1.7610 | Train Acc: 0.3488
 Site-Indian_utk                (1) | Train Loss: 1.8627 | Train Acc: 0.3492
 Site-Indian_utk                (1) | Train Loss: 1.8188 | Train Acc: 0.3835
 Site-Indian_utk                (1) | Train Loss: 1.7809 | Train Acc: 0.3829
 Site-Black_utk                 (5) | Train Loss: 1.8620 | Train Acc: 0.3818
 Site-Black_utk                 (5) | Train Loss: 1.9120 | Train Acc: 0.3210
 Site-Black_utk                 (5) | Train Loss: 1.9062 | Train Acc: 0.3013
 Site-Southeast_Asian           (0) | Train Loss: 1.8993 | Train Acc: 0.3171
 Site-Southeast_Asian           (0) | Train Loss: 1.9052 | Train Acc: 0.3455
 Site-Asian_ffhq                (3) | Train Loss: 1.9170 | Train Acc: 0.2464
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.8587 | Train Acc: 0.3291
Average Train Accuracy: 0.3457
 Site-White_utk                 (6) | Val  Loss: 1.8599 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 1.7920 | Val  Acc: 0.4783
 Site-White_utk                 (2) | Val  Loss: 1.8800 | Val  Acc: 0.2647
 Site-White_utk                 (2) | Val  Loss: 1.8605 | Val  Acc: 0.2353
 Site-White_utk                 (2) | Val  Loss: 1.7516 | Val  Acc: 0.3600
 Site-White_utk                 (2) | Val  Loss: 1.8765 | Val  Acc: 0.3636
 Site-White_utk                 (2) | Val  Loss: 1.8616 | Val  Acc: 0.2901
 Site-White_utk                 (2) | Val  Loss: 1.8350 | Val  Acc: 0.2899
 Site-White_utk                 (2) | Val  Loss: 1.8647 | Val  Acc: 0.3248
 Site-White_utk                 (2) | Val  Loss: 1.8242 | Val  Acc: 0.3217
 Site-East_Asian                (4) | Val  Loss: 1.7394 | Val  Acc: 0.4444
 Site-East_Asian                (0) | Val  Loss: 1.7990 | Val  Acc: 0.3396
 Site-East_Asian                (0) | Val  Loss: 1.8382 | Val  Acc: 0.2821
 Site-East_Asian                (0) | Val  Loss: 1.8508 | Val  Acc: 0.3276
 Site-East_Asian                (0) | Val  Loss: 1.8726 | Val  Acc: 0.3471
 Site-East_Asian                (0) | Val  Loss: 1.8387 | Val  Acc: 0.3560
 Site-East_Asian                (0) | Val  Loss: 1.8103 | Val  Acc: 0.3913
 Site-Indian_utk                (1) | Val  Loss: 1.7694 | Val  Acc: 0.3103
 Site-Indian_utk                (1) | Val  Loss: 1.8058 | Val  Acc: 0.3372
 Site-Indian_utk                (1) | Val  Loss: 1.7937 | Val  Acc: 0.3730
 Site-Indian_utk                (1) | Val  Loss: 1.8375 | Val  Acc: 0.3387
 Site-Indian_utk                (1) | Val  Loss: 1.8198 | Val  Acc: 0.3480
 Site-Black_utk                 (5) | Val  Loss: 2.0255 | Val  Acc: 0.3562
 Site-Black_utk                 (5) | Val  Loss: 1.9386 | Val  Acc: 0.2500
 Site-Black_utk                 (5) | Val  Loss: 1.9003 | Val  Acc: 0.2767
 Site-Southeast_Asian           (0) | Val  Loss: 1.8722 | Val  Acc: 0.3603
 Site-Southeast_Asian           (0) | Val  Loss: 1.9126 | Val  Acc: 0.3284
 Site-Asian_ffhq                (3) | Val  Loss: 2.0556 | Val  Acc: 0.1783
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.9341 | Val  Acc: 0.2885
Average Valid Accuracy: 0.3246
 Best site-White_utk                (6)  | Epoch:2 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.4783
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.2647
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.2353
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.3600
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.3636
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.2901
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.2899
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.3248
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.3217
 Best site-East_Asian               (4)  | Epoch:2 | Val Acc: 0.4444
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3396
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.2821
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3276
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3471
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3560
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3913
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3103
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3372
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3730
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3387
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3480
 Best site-Black_utk                (5)  | Epoch:2 | Val Acc: 0.3562
 Best site-Black_utk                (5)  | Epoch:2 | Val Acc: 0.2500
 Best site-Black_utk                (5)  | Epoch:2 | Val Acc: 0.2767
 Best site-Southeast_Asian          (0)  | Epoch:2 | Val Acc: 0.3603
 Best site-Southeast_Asian          (0)  | Epoch:2 | Val Acc: 0.3284
 Best site-Asian_ffhq               (3)  | Epoch:2 | Val Acc: 0.1783
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:2 | Val Acc: 0.2885
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 3 ============
===2023-06-15 21:25:32===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
===2023-06-15 21:25:53===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 8, 5, 3, 1, 9, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (6) | Train Loss: 2.1220 | Train Acc: 0.2500
 Site-White_utk                 (6) | Train Loss: 2.1497 | Train Acc: 0.1176
 Site-White_utk                 (6) | Train Loss: 2.2299 | Train Acc: 0.1154
 Site-White_utk                 (6) | Train Loss: 2.2479 | Train Acc: 0.0526
 Site-White_utk                 (6) | Train Loss: 2.2217 | Train Acc: 0.0714
 Site-White_utk                 (0) | Train Loss: 2.1780 | Train Acc: 0.1585
 Site-White_utk                 (6) | Train Loss: 2.1468 | Train Acc: 0.1405
 Site-White_utk                 (6) | Train Loss: 2.1979 | Train Acc: 0.1173
 Site-White_utk                 (6) | Train Loss: 2.2104 | Train Acc: 0.1027
 Site-White_utk                 (6) | Train Loss: 2.1808 | Train Acc: 0.1214
 Site-East_Asian                (2) | Train Loss: 1.9367 | Train Acc: 0.4444
 Site-East_Asian                (5) | Train Loss: 2.0114 | Train Acc: 0.4750
 Site-East_Asian                (2) | Train Loss: 2.0116 | Train Acc: 0.3390
 Site-East_Asian                (2) | Train Loss: 2.0109 | Train Acc: 0.3372
 Site-East_Asian                (2) | Train Loss: 2.0047 | Train Acc: 0.3701
 Site-East_Asian                (2) | Train Loss: 2.0226 | Train Acc: 0.3102
 Site-East_Asian                (2) | Train Loss: 1.9668 | Train Acc: 0.3841
 Site-Indian_utk                (3) | Train Loss: 2.0749 | Train Acc: 0.1628
 Site-Indian_utk                (3) | Train Loss: 1.9925 | Train Acc: 0.3281
 Site-Indian_utk                (3) | Train Loss: 2.0337 | Train Acc: 0.3191
 Site-Indian_utk                (3) | Train Loss: 2.0270 | Train Acc: 0.2590
 Site-Indian_utk                (3) | Train Loss: 2.0663 | Train Acc: 0.2878
 Site-Black_utk                 (4) | Train Loss: 2.0391 | Train Acc: 0.2909
 Site-Black_utk                 (4) | Train Loss: 2.0230 | Train Acc: 0.2469
 Site-Black_utk                 (4) | Train Loss: 2.0772 | Train Acc: 0.2017
 Site-Southeast_Asian           (2) | Train Loss: 2.0600 | Train Acc: 0.2647
 Site-Southeast_Asian           (2) | Train Loss: 2.0941 | Train Acc: 0.2467
 Site-Asian_ffhq                (1) | Train Loss: 1.7702 | Train Acc: 0.5988
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.7844 | Train Acc: 0.5128
Average Train Accuracy: 0.2630
 Site-White_utk                 (6) | Val  Loss: 2.1692 | Val  Acc: 0.1250
 Site-White_utk                 (6) | Val  Loss: 2.2353 | Val  Acc: 0.0000
 Site-White_utk                 (6) | Val  Loss: 2.2015 | Val  Acc: 0.1176
 Site-White_utk                 (6) | Val  Loss: 2.1934 | Val  Acc: 0.1600
 Site-White_utk                 (6) | Val  Loss: 2.2065 | Val  Acc: 0.1081
 Site-White_utk                 (0) | Val  Loss: 2.1914 | Val  Acc: 0.1091
 Site-White_utk                 (6) | Val  Loss: 2.1757 | Val  Acc: 0.0988
 Site-White_utk                 (6) | Val  Loss: 2.1989 | Val  Acc: 0.1261
 Site-White_utk                 (6) | Val  Loss: 2.1908 | Val  Acc: 0.0857
 Site-White_utk                 (6) | Val  Loss: 2.2572 | Val  Acc: 0.1202
 Site-East_Asian                (2) | Val  Loss: 2.1150 | Val  Acc: 0.1111
 Site-East_Asian                (5) | Val  Loss: 1.9710 | Val  Acc: 0.4231
 Site-East_Asian                (2) | Val  Loss: 2.0322 | Val  Acc: 0.2821
 Site-East_Asian                (2) | Val  Loss: 1.9969 | Val  Acc: 0.2982
 Site-East_Asian                (2) | Val  Loss: 2.0211 | Val  Acc: 0.3647
 Site-East_Asian                (2) | Val  Loss: 1.9756 | Val  Acc: 0.3680
 Site-East_Asian                (2) | Val  Loss: 1.9945 | Val  Acc: 0.3804
 Site-Indian_utk                (3) | Val  Loss: 2.0051 | Val  Acc: 0.2759
 Site-Indian_utk                (3) | Val  Loss: 2.0708 | Val  Acc: 0.2326
 Site-Indian_utk                (3) | Val  Loss: 2.0624 | Val  Acc: 0.3175
 Site-Indian_utk                (3) | Val  Loss: 2.0956 | Val  Acc: 0.2283
 Site-Indian_utk                (3) | Val  Loss: 2.0380 | Val  Acc: 0.2941
 Site-Black_utk                 (4) | Val  Loss: 2.0641 | Val  Acc: 0.2500
 Site-Black_utk                 (4) | Val  Loss: 2.0650 | Val  Acc: 0.2593
 Site-Black_utk                 (4) | Val  Loss: 2.0148 | Val  Acc: 0.3165
 Site-Southeast_Asian           (2) | Val  Loss: 2.2184 | Val  Acc: 0.2647
 Site-Southeast_Asian           (2) | Val  Loss: 2.1006 | Val  Acc: 0.2400
 Site-Asian_ffhq                (1) | Val  Loss: 1.7670 | Val  Acc: 0.5826
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.7755 | Val  Acc: 0.5128
Average Valid Accuracy: 0.2432
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.0000
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.1600
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.1081
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1091
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.0988
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.1261
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.0857
 Best site-White_utk                (6)  | Epoch:0 | Val Acc: 0.1202
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.1111
 Best site-East_Asian               (5)  | Epoch:0 | Val Acc: 0.4231
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.2821
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.2982
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3647
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3680
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3804
 Best site-Indian_utk               (3)  | Epoch:0 | Val Acc: 0.2759
 Best site-Indian_utk               (3)  | Epoch:0 | Val Acc: 0.2326
 Best site-Indian_utk               (3)  | Epoch:0 | Val Acc: 0.3175
 Best site-Indian_utk               (3)  | Epoch:0 | Val Acc: 0.2283
 Best site-Indian_utk               (3)  | Epoch:0 | Val Acc: 0.2941
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.2500
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.2593
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3165
 Best site-Southeast_Asian          (2)  | Epoch:0 | Val Acc: 0.2647
 Best site-Southeast_Asian          (2)  | Epoch:0 | Val Acc: 0.2400
 Best site-Asian_ffhq               (1)  | Epoch:0 | Val Acc: 0.5826
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:0 | Val Acc: 0.5128
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 9, 2, 2, 5, 7, 3, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (0) | Train Loss: 1.9084 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 2.1531 | Train Acc: 0.0588
 Site-White_utk                 (2) | Train Loss: 2.1428 | Train Acc: 0.1154
 Site-White_utk                 (5) | Train Loss: 2.1958 | Train Acc: 0.0789
 Site-White_utk                 (5) | Train Loss: 2.1559 | Train Acc: 0.1071
 Site-White_utk                 (5) | Train Loss: 2.1305 | Train Acc: 0.1707
 Site-White_utk                 (5) | Train Loss: 2.1137 | Train Acc: 0.1488
 Site-White_utk                 (5) | Train Loss: 2.1256 | Train Acc: 0.1397
 Site-White_utk                 (5) | Train Loss: 2.0902 | Train Acc: 0.1445
 Site-White_utk                 (5) | Train Loss: 2.1457 | Train Acc: 0.1576
 Site-East_Asian                (1) | Train Loss: 1.8638 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.9226 | Train Acc: 0.4000
 Site-East_Asian                (1) | Train Loss: 1.9527 | Train Acc: 0.3051
 Site-East_Asian                (1) | Train Loss: 2.0410 | Train Acc: 0.3023
 Site-East_Asian                (1) | Train Loss: 1.9379 | Train Acc: 0.3780
 Site-East_Asian                (1) | Train Loss: 1.9539 | Train Acc: 0.3155
 Site-East_Asian                (1) | Train Loss: 1.9211 | Train Acc: 0.3732
 Site-Indian_utk                (4) | Train Loss: 1.9867 | Train Acc: 0.2558
 Site-Indian_utk                (4) | Train Loss: 1.9597 | Train Acc: 0.3906
 Site-Indian_utk                (4) | Train Loss: 1.9770 | Train Acc: 0.3191
 Site-Indian_utk                (4) | Train Loss: 1.9503 | Train Acc: 0.3094
 Site-Indian_utk                (4) | Train Loss: 1.9746 | Train Acc: 0.3024
 Site-Black_utk                 (6) | Train Loss: 1.9550 | Train Acc: 0.3091
 Site-Black_utk                 (6) | Train Loss: 2.0008 | Train Acc: 0.3210
 Site-Black_utk                 (6) | Train Loss: 2.0114 | Train Acc: 0.2857
 Site-Southeast_Asian           (1) | Train Loss: 2.0104 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0227 | Train Acc: 0.2933
 Site-Asian_ffhq                (3) | Train Loss: 1.6945 | Train Acc: 0.7384
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.7374 | Train Acc: 0.6325
Average Train Accuracy: 0.2899
 Site-White_utk                 (0) | Val  Loss: 2.0154 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 2.0771 | Val  Acc: 0.1818
 Site-White_utk                 (2) | Val  Loss: 2.1070 | Val  Acc: 0.1176
 Site-White_utk                 (5) | Val  Loss: 2.1695 | Val  Acc: 0.1600
 Site-White_utk                 (5) | Val  Loss: 2.1097 | Val  Acc: 0.1081
 Site-White_utk                 (5) | Val  Loss: 2.1223 | Val  Acc: 0.1273
 Site-White_utk                 (5) | Val  Loss: 2.1466 | Val  Acc: 0.1728
 Site-White_utk                 (5) | Val  Loss: 2.1480 | Val  Acc: 0.1092
 Site-White_utk                 (5) | Val  Loss: 2.1229 | Val  Acc: 0.1543
 Site-White_utk                 (5) | Val  Loss: 2.1708 | Val  Acc: 0.1434
 Site-East_Asian                (1) | Val  Loss: 2.0511 | Val  Acc: 0.2222
 Site-East_Asian                (1) | Val  Loss: 1.9544 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.9876 | Val  Acc: 0.3590
 Site-East_Asian                (1) | Val  Loss: 1.9450 | Val  Acc: 0.3158
 Site-East_Asian                (1) | Val  Loss: 1.9706 | Val  Acc: 0.3882
 Site-East_Asian                (1) | Val  Loss: 1.9113 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.9397 | Val  Acc: 0.3967
 Site-Indian_utk                (4) | Val  Loss: 1.9474 | Val  Acc: 0.3103
 Site-Indian_utk                (4) | Val  Loss: 1.9729 | Val  Acc: 0.3023
 Site-Indian_utk                (4) | Val  Loss: 1.9786 | Val  Acc: 0.3492
 Site-Indian_utk                (4) | Val  Loss: 1.9650 | Val  Acc: 0.3261
 Site-Indian_utk                (4) | Val  Loss: 1.9491 | Val  Acc: 0.2794
 Site-Black_utk                 (6) | Val  Loss: 1.9896 | Val  Acc: 0.3889
 Site-Black_utk                 (6) | Val  Loss: 1.9967 | Val  Acc: 0.2222
 Site-Black_utk                 (6) | Val  Loss: 1.9779 | Val  Acc: 0.3038
 Site-Southeast_Asian           (1) | Val  Loss: 2.1553 | Val  Acc: 0.2500
 Site-Southeast_Asian           (1) | Val  Loss: 2.0585 | Val  Acc: 0.2600
 Site-Asian_ffhq                (3) | Val  Loss: 1.7074 | Val  Acc: 0.6261
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8005 | Val  Acc: 0.3718
Average Valid Accuracy: 0.2755
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:1 | Val Acc: 0.1818
 Best site-White_utk                (2)  | Epoch:1 | Val Acc: 0.1176
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1600
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1081
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1273
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1728
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1092
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1543
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.1434
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.2222
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3846
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3590
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3158
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3882
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4080
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3967
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3103
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3023
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3492
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3261
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.2794
 Best site-Black_utk                (6)  | Epoch:1 | Val Acc: 0.3889
 Best site-Black_utk                (6)  | Epoch:1 | Val Acc: 0.2222
 Best site-Black_utk                (6)  | Epoch:1 | Val Acc: 0.3038
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2500
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2600
 Best site-Asian_ffhq               (3)  | Epoch:1 | Val Acc: 0.6261
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:1 | Val Acc: 0.3718
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 2 ============
cnt=[9, 5, 2, 8, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (4) | Train Loss: 1.8418 | Train Acc: 0.4167
 Site-White_utk                 (6) | Train Loss: 2.0906 | Train Acc: 0.2353
 Site-White_utk                 (3) | Train Loss: 2.0433 | Train Acc: 0.1154
 Site-White_utk                 (3) | Train Loss: 2.1808 | Train Acc: 0.1316
 Site-White_utk                 (3) | Train Loss: 2.0657 | Train Acc: 0.1250
 Site-White_utk                 (3) | Train Loss: 2.0295 | Train Acc: 0.2317
 Site-White_utk                 (3) | Train Loss: 2.0732 | Train Acc: 0.1570
 Site-White_utk                 (3) | Train Loss: 2.0975 | Train Acc: 0.1955
 Site-White_utk                 (3) | Train Loss: 2.0390 | Train Acc: 0.1787
 Site-White_utk                 (3) | Train Loss: 2.0236 | Train Acc: 0.1783
 Site-East_Asian                (0) | Train Loss: 1.8427 | Train Acc: 0.3704
 Site-East_Asian                (0) | Train Loss: 1.9072 | Train Acc: 0.4500
 Site-East_Asian                (0) | Train Loss: 1.9250 | Train Acc: 0.3729
 Site-East_Asian                (0) | Train Loss: 1.9642 | Train Acc: 0.3488
 Site-East_Asian                (0) | Train Loss: 1.9198 | Train Acc: 0.3858
 Site-East_Asian                (0) | Train Loss: 1.9225 | Train Acc: 0.3636
 Site-East_Asian                (0) | Train Loss: 1.9031 | Train Acc: 0.3804
 Site-Indian_utk                (1) | Train Loss: 1.9455 | Train Acc: 0.3256
 Site-Indian_utk                (1) | Train Loss: 1.8963 | Train Acc: 0.4375
 Site-Indian_utk                (1) | Train Loss: 1.9286 | Train Acc: 0.3723
 Site-Indian_utk                (1) | Train Loss: 1.9434 | Train Acc: 0.4101
 Site-Indian_utk                (1) | Train Loss: 1.9400 | Train Acc: 0.3220
 Site-Black_utk                 (5) | Train Loss: 1.8994 | Train Acc: 0.4000
 Site-Black_utk                 (5) | Train Loss: 2.0009 | Train Acc: 0.3210
 Site-Black_utk                 (5) | Train Loss: 1.9985 | Train Acc: 0.3025
 Site-Southeast_Asian           (0) | Train Loss: 1.9624 | Train Acc: 0.3431
 Site-Southeast_Asian           (0) | Train Loss: 2.0018 | Train Acc: 0.3133
 Site-Asian_ffhq                (2) | Train Loss: 1.6698 | Train Acc: 0.7151
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.7317 | Train Acc: 0.6325
Average Train Accuracy: 0.3287
 Site-White_utk                 (4) | Val  Loss: 1.9725 | Val  Acc: 0.2500
 Site-White_utk                 (6) | Val  Loss: 2.0297 | Val  Acc: 0.1818
 Site-White_utk                 (3) | Val  Loss: 2.0187 | Val  Acc: 0.2353
 Site-White_utk                 (3) | Val  Loss: 2.0813 | Val  Acc: 0.1600
 Site-White_utk                 (3) | Val  Loss: 2.1277 | Val  Acc: 0.0811
 Site-White_utk                 (3) | Val  Loss: 2.0475 | Val  Acc: 0.2182
 Site-White_utk                 (3) | Val  Loss: 2.0818 | Val  Acc: 0.1852
 Site-White_utk                 (3) | Val  Loss: 2.1027 | Val  Acc: 0.1765
 Site-White_utk                 (3) | Val  Loss: 2.0938 | Val  Acc: 0.1600
 Site-White_utk                 (3) | Val  Loss: 2.1580 | Val  Acc: 0.1977
 Site-East_Asian                (0) | Val  Loss: 2.0128 | Val  Acc: 0.2778
 Site-East_Asian                (0) | Val  Loss: 1.8826 | Val  Acc: 0.4231
 Site-East_Asian                (0) | Val  Loss: 1.9711 | Val  Acc: 0.3333
 Site-East_Asian                (0) | Val  Loss: 1.8933 | Val  Acc: 0.4211
 Site-East_Asian                (0) | Val  Loss: 1.9151 | Val  Acc: 0.3882
 Site-East_Asian                (0) | Val  Loss: 1.8748 | Val  Acc: 0.4160
 Site-East_Asian                (0) | Val  Loss: 1.8987 | Val  Acc: 0.3967
 Site-Indian_utk                (1) | Val  Loss: 1.9415 | Val  Acc: 0.3103
 Site-Indian_utk                (1) | Val  Loss: 1.8807 | Val  Acc: 0.3488
 Site-Indian_utk                (1) | Val  Loss: 1.9418 | Val  Acc: 0.3175
 Site-Indian_utk                (1) | Val  Loss: 1.9855 | Val  Acc: 0.3261
 Site-Indian_utk                (1) | Val  Loss: 1.9088 | Val  Acc: 0.3015
 Site-Black_utk                 (5) | Val  Loss: 1.9547 | Val  Acc: 0.3333
 Site-Black_utk                 (5) | Val  Loss: 1.9666 | Val  Acc: 0.3333
 Site-Black_utk                 (5) | Val  Loss: 1.9700 | Val  Acc: 0.3544
 Site-Southeast_Asian           (0) | Val  Loss: 2.1976 | Val  Acc: 0.3235
 Site-Southeast_Asian           (0) | Val  Loss: 2.0102 | Val  Acc: 0.2900
 Site-Asian_ffhq                (2) | Val  Loss: 1.6683 | Val  Acc: 0.6783
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8844 | Val  Acc: 0.2308
Average Valid Accuracy: 0.2983
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.2500
 Best site-White_utk                (6)  | Epoch:2 | Val Acc: 0.1818
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.2353
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1600
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.0811
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.2182
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1852
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1765
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1600
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1977
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.2778
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.4231
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3333
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.4211
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3882
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.4160
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3967
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3103
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3488
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3175
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3261
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3015
 Best site-Black_utk                (5)  | Epoch:2 | Val Acc: 0.3333
 Best site-Black_utk                (5)  | Epoch:2 | Val Acc: 0.3333
 Best site-Black_utk                (5)  | Epoch:2 | Val Acc: 0.3544
 Best site-Southeast_Asian          (0)  | Epoch:2 | Val Acc: 0.3235
 Best site-Southeast_Asian          (0)  | Epoch:2 | Val Acc: 0.2900
 Best site-Asian_ffhq               (2)  | Epoch:2 | Val Acc: 0.6783
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:2 | Val Acc: 0.2308
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 3 ============
cnt=[9, 2, 2, 3, 1, 3, 9, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (4) | Train Loss: 1.8398 | Train Acc: 0.3333
 Site-White_utk                 (6) | Train Loss: 2.0023 | Train Acc: 0.2941
 Site-White_utk                 (6) | Train Loss: 2.0105 | Train Acc: 0.1923
 Site-White_utk                 (6) | Train Loss: 2.0869 | Train Acc: 0.1316
 Site-White_utk                 (6) | Train Loss: 2.0527 | Train Acc: 0.1964
 Site-White_utk                 (6) | Train Loss: 2.0246 | Train Acc: 0.3049
 Site-White_utk                 (6) | Train Loss: 1.9960 | Train Acc: 0.2149
 Site-White_utk                 (6) | Train Loss: 2.0585 | Train Acc: 0.1955
 Site-White_utk                 (6) | Train Loss: 2.0485 | Train Acc: 0.2129
 Site-White_utk                 (6) | Train Loss: 1.9344 | Train Acc: 0.2067
 Site-East_Asian                (0) | Train Loss: 1.8448 | Train Acc: 0.3704
 Site-East_Asian                (0) | Train Loss: 1.8418 | Train Acc: 0.4750
 Site-East_Asian                (0) | Train Loss: 1.9059 | Train Acc: 0.3729
 Site-East_Asian                (0) | Train Loss: 1.9274 | Train Acc: 0.3837
 Site-East_Asian                (0) | Train Loss: 1.8682 | Train Acc: 0.4173
 Site-East_Asian                (0) | Train Loss: 1.8997 | Train Acc: 0.3850
 Site-East_Asian                (0) | Train Loss: 1.8559 | Train Acc: 0.3877
 Site-Indian_utk                (1) | Train Loss: 1.9227 | Train Acc: 0.3023
 Site-Indian_utk                (1) | Train Loss: 1.8290 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.9127 | Train Acc: 0.3723
 Site-Indian_utk                (3) | Train Loss: 1.8926 | Train Acc: 0.3885
 Site-Indian_utk                (3) | Train Loss: 1.8891 | Train Acc: 0.3707
 Site-Black_utk                 (5) | Train Loss: 1.8735 | Train Acc: 0.4909
 Site-Black_utk                 (5) | Train Loss: 1.9134 | Train Acc: 0.3086
 Site-Black_utk                 (5) | Train Loss: 1.9319 | Train Acc: 0.3109
 Site-Southeast_Asian           (0) | Train Loss: 2.0103 | Train Acc: 0.3137
 Site-Southeast_Asian           (0) | Train Loss: 1.9869 | Train Acc: 0.3400
 Site-Asian_ffhq                (2) | Train Loss: 1.6688 | Train Acc: 0.6744
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.7038 | Train Acc: 0.6239
Average Train Accuracy: 0.3435
 Site-White_utk                 (4) | Val  Loss: 1.9077 | Val  Acc: 0.2500
 Site-White_utk                 (6) | Val  Loss: 2.0077 | Val  Acc: 0.1818
 Site-White_utk                 (6) | Val  Loss: 2.0220 | Val  Acc: 0.1176
 Site-White_utk                 (6) | Val  Loss: 2.0287 | Val  Acc: 0.1600
 Site-White_utk                 (6) | Val  Loss: 2.0315 | Val  Acc: 0.2162
 Site-White_utk                 (6) | Val  Loss: 2.0481 | Val  Acc: 0.2000
 Site-White_utk                 (6) | Val  Loss: 2.0467 | Val  Acc: 0.1852
 Site-White_utk                 (6) | Val  Loss: 2.0665 | Val  Acc: 0.2017
 Site-White_utk                 (6) | Val  Loss: 2.0550 | Val  Acc: 0.1943
 Site-White_utk                 (6) | Val  Loss: 2.0887 | Val  Acc: 0.2209
 Site-East_Asian                (0) | Val  Loss: 1.9393 | Val  Acc: 0.2778
 Site-East_Asian                (0) | Val  Loss: 1.8416 | Val  Acc: 0.4231
 Site-East_Asian                (0) | Val  Loss: 1.9424 | Val  Acc: 0.3590
 Site-East_Asian                (0) | Val  Loss: 1.8798 | Val  Acc: 0.3860
 Site-East_Asian                (0) | Val  Loss: 1.9297 | Val  Acc: 0.4000
 Site-East_Asian                (0) | Val  Loss: 1.8521 | Val  Acc: 0.4000
 Site-East_Asian                (0) | Val  Loss: 1.8729 | Val  Acc: 0.4076
 Site-Indian_utk                (1) | Val  Loss: 1.9249 | Val  Acc: 0.3448
 Site-Indian_utk                (1) | Val  Loss: 1.8593 | Val  Acc: 0.3721
 Site-Indian_utk                (3) | Val  Loss: 1.8891 | Val  Acc: 0.3175
 Site-Indian_utk                (3) | Val  Loss: 1.9059 | Val  Acc: 0.3587
 Site-Indian_utk                (3) | Val  Loss: 1.8521 | Val  Acc: 0.3603
 Site-Black_utk                 (5) | Val  Loss: 1.9066 | Val  Acc: 0.3889
 Site-Black_utk                 (5) | Val  Loss: 1.9436 | Val  Acc: 0.2778
 Site-Black_utk                 (5) | Val  Loss: 1.9276 | Val  Acc: 0.3544
 Site-Southeast_Asian           (0) | Val  Loss: 2.0427 | Val  Acc: 0.2941
 Site-Southeast_Asian           (0) | Val  Loss: 1.9807 | Val  Acc: 0.3500
 Site-Asian_ffhq                (2) | Val  Loss: 1.6675 | Val  Acc: 0.6609
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8586 | Val  Acc: 0.1795
Average Valid Accuracy: 0.3048
 Best site-White_utk                (4)  | Epoch:3 | Val Acc: 0.2500
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1818
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1176
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1600
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.2162
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.2000
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1852
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.2017
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1943
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.2209
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.2778
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.4231
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.3590
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.3860
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.4000
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.4000
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.4076
 Best site-Indian_utk               (1)  | Epoch:3 | Val Acc: 0.3448
 Best site-Indian_utk               (1)  | Epoch:3 | Val Acc: 0.3721
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3175
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3587
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3603
 Best site-Black_utk                (5)  | Epoch:3 | Val Acc: 0.3889
 Best site-Black_utk                (5)  | Epoch:3 | Val Acc: 0.2778
 Best site-Black_utk                (5)  | Epoch:3 | Val Acc: 0.3544
 Best site-Southeast_Asian          (0)  | Epoch:3 | Val Acc: 0.2941
 Best site-Southeast_Asian          (0)  | Epoch:3 | Val Acc: 0.3500
 Best site-Asian_ffhq               (2)  | Epoch:3 | Val Acc: 0.6609
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:3 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 4 ============
cnt=[10, 4, 1, 5, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk                 (0) | Train Loss: 1.8382 | Train Acc: 0.4167
 Site-White_utk                 (0) | Train Loss: 1.9927 | Train Acc: 0.1765
 Site-White_utk                 (0) | Train Loss: 1.9432 | Train Acc: 0.2308
 Site-White_utk                 (0) | Train Loss: 2.0707 | Train Acc: 0.2105
 Site-White_utk                 (0) | Train Loss: 1.9866 | Train Acc: 0.2143
 Site-White_utk                 (0) | Train Loss: 1.9987 | Train Acc: 0.3049
 Site-White_utk                 (0) | Train Loss: 1.9634 | Train Acc: 0.2645
 Site-White_utk                 (0) | Train Loss: 1.9981 | Train Acc: 0.2346
 Site-White_utk                 (0) | Train Loss: 1.9980 | Train Acc: 0.2357
 Site-White_utk                 (0) | Train Loss: 1.9560 | Train Acc: 0.2506
 Site-East_Asian                (4) | Train Loss: 1.7579 | Train Acc: 0.4444
 Site-East_Asian                (4) | Train Loss: 1.7609 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.8941 | Train Acc: 0.3390
 Site-East_Asian                (1) | Train Loss: 1.8277 | Train Acc: 0.3953
 Site-East_Asian                (4) | Train Loss: 1.8288 | Train Acc: 0.4488
 Site-East_Asian                (1) | Train Loss: 1.8551 | Train Acc: 0.3743
 Site-East_Asian                (1) | Train Loss: 1.8233 | Train Acc: 0.4167
 Site-Indian_utk                (3) | Train Loss: 1.8751 | Train Acc: 0.2791
 Site-Indian_utk                (3) | Train Loss: 1.8315 | Train Acc: 0.4219
 Site-Indian_utk                (3) | Train Loss: 1.8443 | Train Acc: 0.4255
 Site-Indian_utk                (3) | Train Loss: 1.8637 | Train Acc: 0.3741
 Site-Indian_utk                (3) | Train Loss: 1.8863 | Train Acc: 0.4098
 Site-Black_utk                 (6) | Train Loss: 1.8696 | Train Acc: 0.4545
 Site-Black_utk                 (6) | Train Loss: 1.9188 | Train Acc: 0.2963
 Site-Black_utk                 (6) | Train Loss: 1.8986 | Train Acc: 0.3277
 Site-Southeast_Asian           (4) | Train Loss: 1.9286 | Train Acc: 0.3627
 Site-Southeast_Asian           (4) | Train Loss: 1.9445 | Train Acc: 0.3733
 Site-Asian_ffhq                (2) | Train Loss: 1.6271 | Train Acc: 0.6860
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.6571 | Train Acc: 0.6325
Average Train Accuracy: 0.3621
 Site-White_utk                 (0) | Val  Loss: 1.8404 | Val  Acc: 0.2500
 Site-White_utk                 (0) | Val  Loss: 1.9248 | Val  Acc: 0.1818
 Site-White_utk                 (0) | Val  Loss: 1.9671 | Val  Acc: 0.1765
 Site-White_utk                 (0) | Val  Loss: 1.9721 | Val  Acc: 0.2400
 Site-White_utk                 (0) | Val  Loss: 1.9675 | Val  Acc: 0.2162
 Site-White_utk                 (0) | Val  Loss: 1.9953 | Val  Acc: 0.2364
 Site-White_utk                 (0) | Val  Loss: 2.0476 | Val  Acc: 0.1852
 Site-White_utk                 (0) | Val  Loss: 1.9939 | Val  Acc: 0.1849
 Site-White_utk                 (0) | Val  Loss: 2.0158 | Val  Acc: 0.2000
 Site-White_utk                 (0) | Val  Loss: 2.0703 | Val  Acc: 0.2054
 Site-East_Asian                (4) | Val  Loss: 1.9552 | Val  Acc: 0.2778
 Site-East_Asian                (4) | Val  Loss: 1.7776 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8368 | Val  Acc: 0.4359
 Site-East_Asian                (1) | Val  Loss: 1.8268 | Val  Acc: 0.4211
 Site-East_Asian                (4) | Val  Loss: 1.8398 | Val  Acc: 0.4118
 Site-East_Asian                (1) | Val  Loss: 1.8072 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.8300 | Val  Acc: 0.4185
 Site-Indian_utk                (3) | Val  Loss: 1.8065 | Val  Acc: 0.4138
 Site-Indian_utk                (3) | Val  Loss: 1.7979 | Val  Acc: 0.2791
 Site-Indian_utk                (3) | Val  Loss: 1.8604 | Val  Acc: 0.3968
 Site-Indian_utk                (3) | Val  Loss: 1.8784 | Val  Acc: 0.3478
 Site-Indian_utk                (3) | Val  Loss: 1.7953 | Val  Acc: 0.3676
 Site-Black_utk                 (6) | Val  Loss: 1.8131 | Val  Acc: 0.5278
 Site-Black_utk                 (6) | Val  Loss: 1.9064 | Val  Acc: 0.4074
 Site-Black_utk                 (6) | Val  Loss: 1.8955 | Val  Acc: 0.3165
 Site-Southeast_Asian           (4) | Val  Loss: 2.0102 | Val  Acc: 0.3382
 Site-Southeast_Asian           (4) | Val  Loss: 1.9617 | Val  Acc: 0.3200
 Site-Asian_ffhq                (2) | Val  Loss: 1.6369 | Val  Acc: 0.6522
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.8787 | Val  Acc: 0.1795
Average Valid Accuracy: 0.3248
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2500
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.1818
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.1765
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2400
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2162
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2364
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.1852
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.1849
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2000
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2054
 Best site-East_Asian               (4)  | Epoch:4 | Val Acc: 0.2778
 Best site-East_Asian               (4)  | Epoch:4 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4359
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4211
 Best site-East_Asian               (4)  | Epoch:4 | Val Acc: 0.4118
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4080
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4185
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.4138
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.2791
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.3968
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.3478
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.3676
 Best site-Black_utk                (6)  | Epoch:4 | Val Acc: 0.5278
 Best site-Black_utk                (6)  | Epoch:4 | Val Acc: 0.4074
 Best site-Black_utk                (6)  | Epoch:4 | Val Acc: 0.3165
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.3382
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.3200
 Best site-Asian_ffhq               (2)  | Epoch:4 | Val Acc: 0.6522
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:4 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Test site-White_utk                 (0)| Epoch:4 | Test Acc: 0.2528
 Test site-East_Asian                (4)| Epoch:4 | Test Acc: 0.3920
 Test site-Indian_utk                (3)| Epoch:4 | Test Acc: 0.4208
 Test site-Black_utk                 (6)| Epoch:4 | Test Acc: 0.2755
 Test site-Southeast_Asian           (4)| Epoch:4 | Test Acc: 0.3328
 Test site-Asian_ffhq                (2)| Epoch:4 | Test Acc: 0.2849
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:4 | Test Acc: 0.2985
White_utk: 0.2528, East_Asian: 0.3920, Indian_utk: 0.4208, Black_utk: 0.2755, Southeast_Asian: 0.3328, Asian_ffhq: 0.2849, Latino_Hispanic_ffhq: 0.2985, 
Average Test Accuracy(group): 0.3225, Average Test Accuracy(individual): 0.3259,
domain std=0.0581, cluster std=0.0603, individual std=0.0693, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 1, 11, 1, 2, 8, 5, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White_utk                 (0) | Train Loss: 1.8157 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 1.9108 | Train Acc: 0.2941
 Site-White_utk                 (2) | Train Loss: 1.9196 | Train Acc: 0.2692
 Site-White_utk                 (2) | Train Loss: 2.0134 | Train Acc: 0.2105
 Site-White_utk                 (2) | Train Loss: 1.9662 | Train Acc: 0.2321
 Site-White_utk                 (2) | Train Loss: 1.9306 | Train Acc: 0.2927
 Site-White_utk                 (2) | Train Loss: 1.9253 | Train Acc: 0.2397
 Site-White_utk                 (2) | Train Loss: 1.9619 | Train Acc: 0.2793
 Site-White_utk                 (2) | Train Loss: 1.9207 | Train Acc: 0.2205
 Site-White_utk                 (2) | Train Loss: 1.9423 | Train Acc: 0.2584
 Site-East_Asian                (5) | Train Loss: 1.7037 | Train Acc: 0.4444
 Site-East_Asian                (5) | Train Loss: 1.7540 | Train Acc: 0.4750
 Site-East_Asian                (5) | Train Loss: 1.8596 | Train Acc: 0.3390
 Site-East_Asian                (1) | Train Loss: 1.8124 | Train Acc: 0.3837
 Site-East_Asian                (5) | Train Loss: 1.8005 | Train Acc: 0.4173
 Site-East_Asian                (5) | Train Loss: 1.8258 | Train Acc: 0.3904
 Site-East_Asian                (5) | Train Loss: 1.7810 | Train Acc: 0.3986
 Site-Indian_utk                (6) | Train Loss: 1.8656 | Train Acc: 0.3023
 Site-Indian_utk                (6) | Train Loss: 1.7722 | Train Acc: 0.4062
 Site-Indian_utk                (6) | Train Loss: 1.8339 | Train Acc: 0.3617
 Site-Indian_utk                (6) | Train Loss: 1.8223 | Train Acc: 0.3957
 Site-Indian_utk                (6) | Train Loss: 1.8467 | Train Acc: 0.4195
 Site-Black_utk                 (3) | Train Loss: 1.8077 | Train Acc: 0.4364
 Site-Black_utk                 (2) | Train Loss: 1.8204 | Train Acc: 0.3704
 Site-Black_utk                 (2) | Train Loss: 1.9059 | Train Acc: 0.3109
 Site-Southeast_Asian           (5) | Train Loss: 1.9384 | Train Acc: 0.3529
 Site-Southeast_Asian           (5) | Train Loss: 1.9099 | Train Acc: 0.3400
 Site-Asian_ffhq                (4) | Train Loss: 1.5977 | Train Acc: 0.6919
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6520 | Train Acc: 0.6325
Average Train Accuracy: 0.3620
 Site-White_utk                 (0) | Val  Loss: 1.8129 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 1.8984 | Val  Acc: 0.2727
 Site-White_utk                 (2) | Val  Loss: 1.8751 | Val  Acc: 0.2941
 Site-White_utk                 (2) | Val  Loss: 1.9860 | Val  Acc: 0.3200
 Site-White_utk                 (2) | Val  Loss: 1.9555 | Val  Acc: 0.1892
 Site-White_utk                 (2) | Val  Loss: 1.9792 | Val  Acc: 0.2364
 Site-White_utk                 (2) | Val  Loss: 2.0019 | Val  Acc: 0.1975
 Site-White_utk                 (2) | Val  Loss: 1.9537 | Val  Acc: 0.2353
 Site-White_utk                 (2) | Val  Loss: 1.9876 | Val  Acc: 0.2171
 Site-White_utk                 (2) | Val  Loss: 2.0468 | Val  Acc: 0.2326
 Site-East_Asian                (5) | Val  Loss: 1.9326 | Val  Acc: 0.2222
 Site-East_Asian                (5) | Val  Loss: 1.8303 | Val  Acc: 0.4231
 Site-East_Asian                (5) | Val  Loss: 1.8250 | Val  Acc: 0.4359
 Site-East_Asian                (1) | Val  Loss: 1.7848 | Val  Acc: 0.4211
 Site-East_Asian                (5) | Val  Loss: 1.8328 | Val  Acc: 0.4235
 Site-East_Asian                (5) | Val  Loss: 1.7719 | Val  Acc: 0.4240
 Site-East_Asian                (5) | Val  Loss: 1.7980 | Val  Acc: 0.4348
 Site-Indian_utk                (6) | Val  Loss: 1.7855 | Val  Acc: 0.3793
 Site-Indian_utk                (6) | Val  Loss: 1.7811 | Val  Acc: 0.3721
 Site-Indian_utk                (6) | Val  Loss: 1.8065 | Val  Acc: 0.4127
 Site-Indian_utk                (6) | Val  Loss: 1.8474 | Val  Acc: 0.3370
 Site-Indian_utk                (6) | Val  Loss: 1.7313 | Val  Acc: 0.3750
 Site-Black_utk                 (3) | Val  Loss: 1.8938 | Val  Acc: 0.3889
 Site-Black_utk                 (2) | Val  Loss: 1.8460 | Val  Acc: 0.3519
 Site-Black_utk                 (2) | Val  Loss: 1.8566 | Val  Acc: 0.3291
 Site-Southeast_Asian           (5) | Val  Loss: 1.9408 | Val  Acc: 0.3235
 Site-Southeast_Asian           (5) | Val  Loss: 1.9070 | Val  Acc: 0.3700
 Site-Asian_ffhq                (4) | Val  Loss: 1.6218 | Val  Acc: 0.6348
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8395 | Val  Acc: 0.2179
Average Valid Accuracy: 0.3352
 Best site-White_utk                (0)  | Epoch:5 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2727
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2941
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.3200
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.1892
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2364
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.1975
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2353
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2171
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2326
 Best site-East_Asian               (5)  | Epoch:5 | Val Acc: 0.2222
 Best site-East_Asian               (5)  | Epoch:5 | Val Acc: 0.4231
 Best site-East_Asian               (5)  | Epoch:5 | Val Acc: 0.4359
 Best site-East_Asian               (1)  | Epoch:5 | Val Acc: 0.4211
 Best site-East_Asian               (5)  | Epoch:5 | Val Acc: 0.4235
 Best site-East_Asian               (5)  | Epoch:5 | Val Acc: 0.4240
 Best site-East_Asian               (5)  | Epoch:5 | Val Acc: 0.4348
 Best site-Indian_utk               (6)  | Epoch:5 | Val Acc: 0.3793
 Best site-Indian_utk               (6)  | Epoch:5 | Val Acc: 0.3721
 Best site-Indian_utk               (6)  | Epoch:5 | Val Acc: 0.4127
 Best site-Indian_utk               (6)  | Epoch:5 | Val Acc: 0.3370
 Best site-Indian_utk               (6)  | Epoch:5 | Val Acc: 0.3750
 Best site-Black_utk                (3)  | Epoch:5 | Val Acc: 0.3889
 Best site-Black_utk                (2)  | Epoch:5 | Val Acc: 0.3519
 Best site-Black_utk                (2)  | Epoch:5 | Val Acc: 0.3291
 Best site-Southeast_Asian          (5)  | Epoch:5 | Val Acc: 0.3235
 Best site-Southeast_Asian          (5)  | Epoch:5 | Val Acc: 0.3700
 Best site-Asian_ffhq               (4)  | Epoch:5 | Val Acc: 0.6348
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:5 | Val Acc: 0.2179
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 2, 9, 5, 8, 3, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White_utk                 (4) | Train Loss: 1.7358 | Train Acc: 0.4167
 Site-White_utk                 (6) | Train Loss: 1.9219 | Train Acc: 0.2353
 Site-White_utk                 (4) | Train Loss: 1.8833 | Train Acc: 0.1923
 Site-White_utk                 (4) | Train Loss: 1.9676 | Train Acc: 0.2105
 Site-White_utk                 (4) | Train Loss: 1.8737 | Train Acc: 0.3571
 Site-White_utk                 (3) | Train Loss: 1.9438 | Train Acc: 0.2927
 Site-White_utk                 (4) | Train Loss: 1.8921 | Train Acc: 0.2397
 Site-White_utk                 (4) | Train Loss: 1.9240 | Train Acc: 0.2626
 Site-White_utk                 (4) | Train Loss: 1.9019 | Train Acc: 0.2510
 Site-White_utk                 (4) | Train Loss: 1.9482 | Train Acc: 0.2791
 Site-East_Asian                (2) | Train Loss: 1.6536 | Train Acc: 0.4444
 Site-East_Asian                (2) | Train Loss: 1.7357 | Train Acc: 0.4500
 Site-East_Asian                (2) | Train Loss: 1.8410 | Train Acc: 0.3729
 Site-East_Asian                (2) | Train Loss: 1.7761 | Train Acc: 0.4419
 Site-East_Asian                (2) | Train Loss: 1.7874 | Train Acc: 0.4331
 Site-East_Asian                (2) | Train Loss: 1.8132 | Train Acc: 0.3743
 Site-East_Asian                (2) | Train Loss: 1.7504 | Train Acc: 0.4130
 Site-Indian_utk                (0) | Train Loss: 1.8257 | Train Acc: 0.3721
 Site-Indian_utk                (3) | Train Loss: 1.7496 | Train Acc: 0.4531
 Site-Indian_utk                (3) | Train Loss: 1.7874 | Train Acc: 0.3936
 Site-Indian_utk                (3) | Train Loss: 1.8511 | Train Acc: 0.4173
 Site-Indian_utk                (3) | Train Loss: 1.7750 | Train Acc: 0.4390
 Site-Black_utk                 (5) | Train Loss: 1.7965 | Train Acc: 0.4364
 Site-Black_utk                 (5) | Train Loss: 1.8009 | Train Acc: 0.4074
 Site-Black_utk                 (5) | Train Loss: 1.8507 | Train Acc: 0.4118
 Site-Southeast_Asian           (2) | Train Loss: 1.8864 | Train Acc: 0.3431
 Site-Southeast_Asian           (2) | Train Loss: 1.8933 | Train Acc: 0.3600
 Site-Asian_ffhq                (1) | Train Loss: 1.5933 | Train Acc: 0.6453
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6637 | Train Acc: 0.5897
Average Train Accuracy: 0.3771
 Site-White_utk                 (4) | Val  Loss: 1.7560 | Val  Acc: 0.2500
 Site-White_utk                 (6) | Val  Loss: 1.8481 | Val  Acc: 0.1818
 Site-White_utk                 (4) | Val  Loss: 1.8695 | Val  Acc: 0.2353
 Site-White_utk                 (4) | Val  Loss: 1.9169 | Val  Acc: 0.2800
 Site-White_utk                 (4) | Val  Loss: 1.9211 | Val  Acc: 0.2973
 Site-White_utk                 (3) | Val  Loss: 1.9662 | Val  Acc: 0.2364
 Site-White_utk                 (4) | Val  Loss: 2.0050 | Val  Acc: 0.2346
 Site-White_utk                 (4) | Val  Loss: 1.9107 | Val  Acc: 0.2521
 Site-White_utk                 (4) | Val  Loss: 1.9549 | Val  Acc: 0.2286
 Site-White_utk                 (4) | Val  Loss: 2.0068 | Val  Acc: 0.2558
 Site-East_Asian                (2) | Val  Loss: 1.9049 | Val  Acc: 0.2778
 Site-East_Asian                (2) | Val  Loss: 1.7568 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.7893 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.7560 | Val  Acc: 0.4035
 Site-East_Asian                (2) | Val  Loss: 1.7837 | Val  Acc: 0.4471
 Site-East_Asian                (2) | Val  Loss: 1.7533 | Val  Acc: 0.4480
 Site-East_Asian                (2) | Val  Loss: 1.7779 | Val  Acc: 0.4402
 Site-Indian_utk                (0) | Val  Loss: 1.7952 | Val  Acc: 0.4483
 Site-Indian_utk                (3) | Val  Loss: 1.7351 | Val  Acc: 0.4186
 Site-Indian_utk                (3) | Val  Loss: 1.7894 | Val  Acc: 0.4286
 Site-Indian_utk                (3) | Val  Loss: 1.8343 | Val  Acc: 0.3804
 Site-Indian_utk                (3) | Val  Loss: 1.6980 | Val  Acc: 0.4338
 Site-Black_utk                 (5) | Val  Loss: 1.9096 | Val  Acc: 0.3889
 Site-Black_utk                 (5) | Val  Loss: 1.8296 | Val  Acc: 0.3333
 Site-Black_utk                 (5) | Val  Loss: 1.7926 | Val  Acc: 0.3418
 Site-Southeast_Asian           (2) | Val  Loss: 1.9903 | Val  Acc: 0.3676
 Site-Southeast_Asian           (2) | Val  Loss: 1.9125 | Val  Acc: 0.3400
 Site-Asian_ffhq                (1) | Val  Loss: 1.6335 | Val  Acc: 0.6000
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.9048 | Val  Acc: 0.1538
Average Valid Accuracy: 0.3457
 Best site-White_utk                (4)  | Epoch:6 | Val Acc: 0.2500
 Best site-White_utk                (6)  | Epoch:6 | Val Acc: 0.1818
 Best site-White_utk                (4)  | Epoch:6 | Val Acc: 0.2353
 Best site-White_utk                (4)  | Epoch:6 | Val Acc: 0.2800
 Best site-White_utk                (4)  | Epoch:6 | Val Acc: 0.2973
 Best site-White_utk                (3)  | Epoch:6 | Val Acc: 0.2364
 Best site-White_utk                (4)  | Epoch:6 | Val Acc: 0.2346
 Best site-White_utk                (4)  | Epoch:6 | Val Acc: 0.2521
 Best site-White_utk                (4)  | Epoch:6 | Val Acc: 0.2286
 Best site-White_utk                (4)  | Epoch:6 | Val Acc: 0.2558
 Best site-East_Asian               (2)  | Epoch:6 | Val Acc: 0.2778
 Best site-East_Asian               (2)  | Epoch:6 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:6 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:6 | Val Acc: 0.4035
 Best site-East_Asian               (2)  | Epoch:6 | Val Acc: 0.4471
 Best site-East_Asian               (2)  | Epoch:6 | Val Acc: 0.4480
 Best site-East_Asian               (2)  | Epoch:6 | Val Acc: 0.4402
 Best site-Indian_utk               (0)  | Epoch:6 | Val Acc: 0.4483
 Best site-Indian_utk               (3)  | Epoch:6 | Val Acc: 0.4186
 Best site-Indian_utk               (3)  | Epoch:6 | Val Acc: 0.4286
 Best site-Indian_utk               (3)  | Epoch:6 | Val Acc: 0.3804
 Best site-Indian_utk               (3)  | Epoch:6 | Val Acc: 0.4338
 Best site-Black_utk                (5)  | Epoch:6 | Val Acc: 0.3889
 Best site-Black_utk                (5)  | Epoch:6 | Val Acc: 0.3333
 Best site-Black_utk                (5)  | Epoch:6 | Val Acc: 0.3418
 Best site-Southeast_Asian          (2)  | Epoch:6 | Val Acc: 0.3676
 Best site-Southeast_Asian          (2)  | Epoch:6 | Val Acc: 0.3400
 Best site-Asian_ffhq               (1)  | Epoch:6 | Val Acc: 0.6000
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:6 | Val Acc: 0.1538
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 9, 1, 5, 9, 1, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White_utk                 (4) | Train Loss: 1.6220 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.8209 | Train Acc: 0.2353
 Site-White_utk                 (4) | Train Loss: 1.8142 | Train Acc: 0.3077
 Site-White_utk                 (0) | Train Loss: 1.9419 | Train Acc: 0.2105
 Site-White_utk                 (4) | Train Loss: 1.8515 | Train Acc: 0.2500
 Site-White_utk                 (4) | Train Loss: 1.9538 | Train Acc: 0.3049
 Site-White_utk                 (4) | Train Loss: 1.8532 | Train Acc: 0.2727
 Site-White_utk                 (4) | Train Loss: 1.9111 | Train Acc: 0.2570
 Site-White_utk                 (4) | Train Loss: 1.8832 | Train Acc: 0.2662
 Site-White_utk                 (4) | Train Loss: 1.8620 | Train Acc: 0.3023
 Site-East_Asian                (1) | Train Loss: 1.6649 | Train Acc: 0.4444
 Site-East_Asian                (1) | Train Loss: 1.6779 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8284 | Train Acc: 0.3898
 Site-East_Asian                (1) | Train Loss: 1.8300 | Train Acc: 0.4070
 Site-East_Asian                (1) | Train Loss: 1.7788 | Train Acc: 0.4409
 Site-East_Asian                (1) | Train Loss: 1.7687 | Train Acc: 0.4011
 Site-East_Asian                (1) | Train Loss: 1.7421 | Train Acc: 0.4130
 Site-Indian_utk                (3) | Train Loss: 1.8128 | Train Acc: 0.4186
 Site-Indian_utk                (3) | Train Loss: 1.7432 | Train Acc: 0.4531
 Site-Indian_utk                (3) | Train Loss: 1.7528 | Train Acc: 0.3936
 Site-Indian_utk                (3) | Train Loss: 1.8070 | Train Acc: 0.4101
 Site-Indian_utk                (3) | Train Loss: 1.7317 | Train Acc: 0.4439
 Site-Black_utk                 (6) | Train Loss: 1.7642 | Train Acc: 0.4364
 Site-Black_utk                 (6) | Train Loss: 1.8027 | Train Acc: 0.3457
 Site-Black_utk                 (6) | Train Loss: 1.8290 | Train Acc: 0.3782
 Site-Southeast_Asian           (1) | Train Loss: 1.8534 | Train Acc: 0.3627
 Site-Southeast_Asian           (1) | Train Loss: 1.8931 | Train Acc: 0.3467
 Site-Asian_ffhq                (2) | Train Loss: 1.5788 | Train Acc: 0.6453
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.6214 | Train Acc: 0.5897
Average Train Accuracy: 0.3800
 Site-White_utk                 (4) | Val  Loss: 1.7405 | Val  Acc: 0.3750
 Site-White_utk                 (4) | Val  Loss: 1.8404 | Val  Acc: 0.2727
 Site-White_utk                 (4) | Val  Loss: 1.8150 | Val  Acc: 0.2941
 Site-White_utk                 (0) | Val  Loss: 1.8907 | Val  Acc: 0.2800
 Site-White_utk                 (4) | Val  Loss: 1.8547 | Val  Acc: 0.2162
 Site-White_utk                 (4) | Val  Loss: 1.9008 | Val  Acc: 0.2545
 Site-White_utk                 (4) | Val  Loss: 1.9459 | Val  Acc: 0.2222
 Site-White_utk                 (4) | Val  Loss: 1.9139 | Val  Acc: 0.2521
 Site-White_utk                 (4) | Val  Loss: 1.9249 | Val  Acc: 0.2457
 Site-White_utk                 (4) | Val  Loss: 1.9838 | Val  Acc: 0.2442
 Site-East_Asian                (1) | Val  Loss: 1.8565 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.7309 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.7270 | Val  Acc: 0.4359
 Site-East_Asian                (1) | Val  Loss: 1.7503 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.7546 | Val  Acc: 0.4235
 Site-East_Asian                (1) | Val  Loss: 1.7227 | Val  Acc: 0.4320
 Site-East_Asian                (1) | Val  Loss: 1.7423 | Val  Acc: 0.4402
 Site-Indian_utk                (3) | Val  Loss: 1.8237 | Val  Acc: 0.3793
 Site-Indian_utk                (3) | Val  Loss: 1.7196 | Val  Acc: 0.3953
 Site-Indian_utk                (3) | Val  Loss: 1.7776 | Val  Acc: 0.4603
 Site-Indian_utk                (3) | Val  Loss: 1.7993 | Val  Acc: 0.3913
 Site-Indian_utk                (3) | Val  Loss: 1.6901 | Val  Acc: 0.4412
 Site-Black_utk                 (6) | Val  Loss: 1.8009 | Val  Acc: 0.4722
 Site-Black_utk                 (6) | Val  Loss: 1.8269 | Val  Acc: 0.3519
 Site-Black_utk                 (6) | Val  Loss: 1.7913 | Val  Acc: 0.3291
 Site-Southeast_Asian           (1) | Val  Loss: 1.9812 | Val  Acc: 0.3088
 Site-Southeast_Asian           (1) | Val  Loss: 1.8929 | Val  Acc: 0.3800
 Site-Asian_ffhq                (2) | Val  Loss: 1.6109 | Val  Acc: 0.6000
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.9082 | Val  Acc: 0.1667
Average Valid Accuracy: 0.3526
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.3750
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2727
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2941
 Best site-White_utk                (0)  | Epoch:7 | Val Acc: 0.2800
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2162
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2545
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2222
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2521
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2457
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2442
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.2778
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4359
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4211
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4235
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4320
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4402
 Best site-Indian_utk               (3)  | Epoch:7 | Val Acc: 0.3793
 Best site-Indian_utk               (3)  | Epoch:7 | Val Acc: 0.3953
 Best site-Indian_utk               (3)  | Epoch:7 | Val Acc: 0.4603
 Best site-Indian_utk               (3)  | Epoch:7 | Val Acc: 0.3913
 Best site-Indian_utk               (3)  | Epoch:7 | Val Acc: 0.4412
 Best site-Black_utk                (6)  | Epoch:7 | Val Acc: 0.4722
 Best site-Black_utk                (6)  | Epoch:7 | Val Acc: 0.3519
 Best site-Black_utk                (6)  | Epoch:7 | Val Acc: 0.3291
 Best site-Southeast_Asian          (1)  | Epoch:7 | Val Acc: 0.3088
 Best site-Southeast_Asian          (1)  | Epoch:7 | Val Acc: 0.3800
 Best site-Asian_ffhq               (2)  | Epoch:7 | Val Acc: 0.6000
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:7 | Val Acc: 0.1667
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 1, 9, 10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White_utk                 (0) | Train Loss: 1.6219 | Train Acc: 0.3333
 Site-White_utk                 (6) | Train Loss: 1.8330 | Train Acc: 0.2353
 Site-White_utk                 (3) | Train Loss: 1.8774 | Train Acc: 0.3462
 Site-White_utk                 (1) | Train Loss: 1.9283 | Train Acc: 0.2105
 Site-White_utk                 (3) | Train Loss: 1.8467 | Train Acc: 0.3393
 Site-White_utk                 (3) | Train Loss: 1.7912 | Train Acc: 0.3293
 Site-White_utk                 (3) | Train Loss: 1.8551 | Train Acc: 0.2645
 Site-White_utk                 (3) | Train Loss: 1.9047 | Train Acc: 0.2570
 Site-White_utk                 (3) | Train Loss: 1.8500 | Train Acc: 0.3080
 Site-White_utk                 (3) | Train Loss: 1.7848 | Train Acc: 0.3152
 Site-East_Asian                (2) | Train Loss: 1.5688 | Train Acc: 0.4815
 Site-East_Asian                (2) | Train Loss: 1.6485 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.8145 | Train Acc: 0.3898
 Site-East_Asian                (2) | Train Loss: 1.7787 | Train Acc: 0.4070
 Site-East_Asian                (2) | Train Loss: 1.7448 | Train Acc: 0.4331
 Site-East_Asian                (2) | Train Loss: 1.7560 | Train Acc: 0.3850
 Site-East_Asian                (2) | Train Loss: 1.6839 | Train Acc: 0.4493
 Site-Indian_utk                (5) | Train Loss: 1.7635 | Train Acc: 0.3953
 Site-Indian_utk                (5) | Train Loss: 1.6888 | Train Acc: 0.5312
 Site-Indian_utk                (5) | Train Loss: 1.7913 | Train Acc: 0.3511
 Site-Indian_utk                (5) | Train Loss: 1.7733 | Train Acc: 0.4245
 Site-Indian_utk                (5) | Train Loss: 1.6916 | Train Acc: 0.4146
 Site-Black_utk                 (3) | Train Loss: 1.7205 | Train Acc: 0.4727
 Site-Black_utk                 (3) | Train Loss: 1.8167 | Train Acc: 0.4074
 Site-Black_utk                 (3) | Train Loss: 1.7997 | Train Acc: 0.3866
 Site-Southeast_Asian           (2) | Train Loss: 1.8878 | Train Acc: 0.3333
 Site-Southeast_Asian           (2) | Train Loss: 1.8982 | Train Acc: 0.3600
 Site-Asian_ffhq                (4) | Train Loss: 1.6355 | Train Acc: 0.6105
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6315 | Train Acc: 0.5983
Average Train Accuracy: 0.3886
 Site-White_utk                 (0) | Val  Loss: 1.6512 | Val  Acc: 0.3750
 Site-White_utk                 (6) | Val  Loss: 1.8490 | Val  Acc: 0.2727
 Site-White_utk                 (3) | Val  Loss: 1.8707 | Val  Acc: 0.2353
 Site-White_utk                 (1) | Val  Loss: 1.8490 | Val  Acc: 0.2400
 Site-White_utk                 (3) | Val  Loss: 1.8222 | Val  Acc: 0.3243
 Site-White_utk                 (3) | Val  Loss: 1.8611 | Val  Acc: 0.3091
 Site-White_utk                 (3) | Val  Loss: 1.8944 | Val  Acc: 0.2593
 Site-White_utk                 (3) | Val  Loss: 1.8810 | Val  Acc: 0.2605
 Site-White_utk                 (3) | Val  Loss: 1.8892 | Val  Acc: 0.2800
 Site-White_utk                 (3) | Val  Loss: 1.9610 | Val  Acc: 0.2946
 Site-East_Asian                (2) | Val  Loss: 1.8751 | Val  Acc: 0.2778
 Site-East_Asian                (2) | Val  Loss: 1.6786 | Val  Acc: 0.5000
 Site-East_Asian                (2) | Val  Loss: 1.7185 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.7212 | Val  Acc: 0.4211
 Site-East_Asian                (2) | Val  Loss: 1.7354 | Val  Acc: 0.4588
 Site-East_Asian                (2) | Val  Loss: 1.7117 | Val  Acc: 0.4640
 Site-East_Asian                (2) | Val  Loss: 1.7383 | Val  Acc: 0.4402
 Site-Indian_utk                (5) | Val  Loss: 1.7067 | Val  Acc: 0.4483
 Site-Indian_utk                (5) | Val  Loss: 1.7202 | Val  Acc: 0.3023
 Site-Indian_utk                (5) | Val  Loss: 1.7428 | Val  Acc: 0.4444
 Site-Indian_utk                (5) | Val  Loss: 1.7852 | Val  Acc: 0.4239
 Site-Indian_utk                (5) | Val  Loss: 1.6694 | Val  Acc: 0.4118
 Site-Black_utk                 (3) | Val  Loss: 1.7620 | Val  Acc: 0.5278
 Site-Black_utk                 (3) | Val  Loss: 1.8079 | Val  Acc: 0.2963
 Site-Black_utk                 (3) | Val  Loss: 1.7751 | Val  Acc: 0.3418
 Site-Southeast_Asian           (2) | Val  Loss: 1.9217 | Val  Acc: 0.3824
 Site-Southeast_Asian           (2) | Val  Loss: 1.8689 | Val  Acc: 0.3600
 Site-Asian_ffhq                (4) | Val  Loss: 1.6199 | Val  Acc: 0.5478
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8410 | Val  Acc: 0.1667
Average Valid Accuracy: 0.3630
 Best site-White_utk                (0)  | Epoch:8 | Val Acc: 0.3750
 Best site-White_utk                (6)  | Epoch:8 | Val Acc: 0.2727
 Best site-White_utk                (3)  | Epoch:8 | Val Acc: 0.2353
 Best site-White_utk                (1)  | Epoch:8 | Val Acc: 0.2400
 Best site-White_utk                (3)  | Epoch:8 | Val Acc: 0.3243
 Best site-White_utk                (3)  | Epoch:8 | Val Acc: 0.3091
 Best site-White_utk                (3)  | Epoch:8 | Val Acc: 0.2593
 Best site-White_utk                (3)  | Epoch:8 | Val Acc: 0.2605
 Best site-White_utk                (3)  | Epoch:8 | Val Acc: 0.2800
 Best site-White_utk                (3)  | Epoch:8 | Val Acc: 0.2946
 Best site-East_Asian               (2)  | Epoch:8 | Val Acc: 0.2778
 Best site-East_Asian               (2)  | Epoch:8 | Val Acc: 0.5000
 Best site-East_Asian               (2)  | Epoch:8 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:8 | Val Acc: 0.4211
 Best site-East_Asian               (2)  | Epoch:8 | Val Acc: 0.4588
 Best site-East_Asian               (2)  | Epoch:8 | Val Acc: 0.4640
 Best site-East_Asian               (2)  | Epoch:8 | Val Acc: 0.4402
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.4483
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.3023
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.4444
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.4239
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.4118
 Best site-Black_utk                (3)  | Epoch:8 | Val Acc: 0.5278
 Best site-Black_utk                (3)  | Epoch:8 | Val Acc: 0.2963
 Best site-Black_utk                (3)  | Epoch:8 | Val Acc: 0.3418
 Best site-Southeast_Asian          (2)  | Epoch:8 | Val Acc: 0.3824
 Best site-Southeast_Asian          (2)  | Epoch:8 | Val Acc: 0.3600
 Best site-Asian_ffhq               (4)  | Epoch:8 | Val Acc: 0.5478
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:8 | Val Acc: 0.1667
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 9 ============
cnt=[8, 9, 5, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White_utk                 (5) | Train Loss: 1.5390 | Train Acc: 0.3333
 Site-White_utk                 (6) | Train Loss: 1.8594 | Train Acc: 0.2941
 Site-White_utk                 (0) | Train Loss: 1.7963 | Train Acc: 0.2692
 Site-White_utk                 (0) | Train Loss: 1.9081 | Train Acc: 0.2368
 Site-White_utk                 (0) | Train Loss: 1.8102 | Train Acc: 0.3036
 Site-White_utk                 (0) | Train Loss: 1.8348 | Train Acc: 0.3293
 Site-White_utk                 (0) | Train Loss: 1.8378 | Train Acc: 0.2479
 Site-White_utk                 (0) | Train Loss: 1.8760 | Train Acc: 0.2682
 Site-White_utk                 (0) | Train Loss: 1.8835 | Train Acc: 0.2662
 Site-White_utk                 (0) | Train Loss: 1.8068 | Train Acc: 0.3049
 Site-East_Asian                (1) | Train Loss: 1.5797 | Train Acc: 0.4444
 Site-East_Asian                (1) | Train Loss: 1.6007 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.7701 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.7411 | Train Acc: 0.3953
 Site-East_Asian                (1) | Train Loss: 1.6848 | Train Acc: 0.4724
 Site-East_Asian                (1) | Train Loss: 1.7122 | Train Acc: 0.4278
 Site-East_Asian                (1) | Train Loss: 1.6736 | Train Acc: 0.4239
 Site-Indian_utk                (2) | Train Loss: 1.7138 | Train Acc: 0.3953
 Site-Indian_utk                (2) | Train Loss: 1.6777 | Train Acc: 0.4688
 Site-Indian_utk                (2) | Train Loss: 1.7301 | Train Acc: 0.3723
 Site-Indian_utk                (2) | Train Loss: 1.7956 | Train Acc: 0.3885
 Site-Indian_utk                (2) | Train Loss: 1.7054 | Train Acc: 0.4195
 Site-Black_utk                 (4) | Train Loss: 1.7278 | Train Acc: 0.4545
 Site-Black_utk                 (4) | Train Loss: 1.7548 | Train Acc: 0.3827
 Site-Black_utk                 (4) | Train Loss: 1.7662 | Train Acc: 0.4370
 Site-Southeast_Asian           (1) | Train Loss: 1.8625 | Train Acc: 0.3431
 Site-Southeast_Asian           (1) | Train Loss: 1.8459 | Train Acc: 0.3600
 Site-Asian_ffhq                (3) | Train Loss: 1.5322 | Train Acc: 0.6802
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.5566 | Train Acc: 0.5812
Average Train Accuracy: 0.3853
 Site-White_utk                 (5) | Val  Loss: 1.6248 | Val  Acc: 0.3750
 Site-White_utk                 (6) | Val  Loss: 1.8162 | Val  Acc: 0.3636
 Site-White_utk                 (0) | Val  Loss: 1.7935 | Val  Acc: 0.3529
 Site-White_utk                 (0) | Val  Loss: 1.8215 | Val  Acc: 0.3200
 Site-White_utk                 (0) | Val  Loss: 1.8494 | Val  Acc: 0.2162
 Site-White_utk                 (0) | Val  Loss: 1.8583 | Val  Acc: 0.2909
 Site-White_utk                 (0) | Val  Loss: 1.8728 | Val  Acc: 0.2346
 Site-White_utk                 (0) | Val  Loss: 1.8407 | Val  Acc: 0.3277
 Site-White_utk                 (0) | Val  Loss: 1.8819 | Val  Acc: 0.2686
 Site-White_utk                 (0) | Val  Loss: 1.9775 | Val  Acc: 0.2868
 Site-East_Asian                (1) | Val  Loss: 1.8138 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.6815 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.6695 | Val  Acc: 0.4359
 Site-East_Asian                (1) | Val  Loss: 1.6640 | Val  Acc: 0.4561
 Site-East_Asian                (1) | Val  Loss: 1.6989 | Val  Acc: 0.4471
 Site-East_Asian                (1) | Val  Loss: 1.6701 | Val  Acc: 0.4480
 Site-East_Asian                (1) | Val  Loss: 1.6784 | Val  Acc: 0.4402
 Site-Indian_utk                (2) | Val  Loss: 1.7060 | Val  Acc: 0.4138
 Site-Indian_utk                (2) | Val  Loss: 1.6803 | Val  Acc: 0.4419
 Site-Indian_utk                (2) | Val  Loss: 1.6855 | Val  Acc: 0.3968
 Site-Indian_utk                (2) | Val  Loss: 1.7920 | Val  Acc: 0.4022
 Site-Indian_utk                (2) | Val  Loss: 1.6295 | Val  Acc: 0.4412
 Site-Black_utk                 (4) | Val  Loss: 1.7658 | Val  Acc: 0.5278
 Site-Black_utk                 (4) | Val  Loss: 1.7608 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.7145 | Val  Acc: 0.4304
 Site-Southeast_Asian           (1) | Val  Loss: 1.8037 | Val  Acc: 0.3382
 Site-Southeast_Asian           (1) | Val  Loss: 1.8643 | Val  Acc: 0.3600
 Site-Asian_ffhq                (3) | Val  Loss: 1.5628 | Val  Acc: 0.6174
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8125 | Val  Acc: 0.1538
Average Valid Accuracy: 0.3745
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.3750
 Best site-White_utk                (6)  | Epoch:9 | Val Acc: 0.3636
 Best site-White_utk                (0)  | Epoch:9 | Val Acc: 0.3529
 Best site-White_utk                (0)  | Epoch:9 | Val Acc: 0.3200
 Best site-White_utk                (0)  | Epoch:9 | Val Acc: 0.2162
 Best site-White_utk                (0)  | Epoch:9 | Val Acc: 0.2909
 Best site-White_utk                (0)  | Epoch:9 | Val Acc: 0.2346
 Best site-White_utk                (0)  | Epoch:9 | Val Acc: 0.3277
 Best site-White_utk                (0)  | Epoch:9 | Val Acc: 0.2686
 Best site-White_utk                (0)  | Epoch:9 | Val Acc: 0.2868
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.2778
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.4359
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.4561
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.4471
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.4480
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.4402
 Best site-Indian_utk               (2)  | Epoch:9 | Val Acc: 0.4138
 Best site-Indian_utk               (2)  | Epoch:9 | Val Acc: 0.4419
 Best site-Indian_utk               (2)  | Epoch:9 | Val Acc: 0.3968
 Best site-Indian_utk               (2)  | Epoch:9 | Val Acc: 0.4022
 Best site-Indian_utk               (2)  | Epoch:9 | Val Acc: 0.4412
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.5278
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.4304
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.3382
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.3600
 Best site-Asian_ffhq               (3)  | Epoch:9 | Val Acc: 0.6174
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:9 | Val Acc: 0.1538
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Test site-White_utk                 (5)| Epoch:9 | Test Acc: 0.2991
 Test site-East_Asian                (1)| Epoch:9 | Test Acc: 0.4577
 Test site-Indian_utk                (2)| Epoch:9 | Test Acc: 0.4479
 Test site-Black_utk                 (4)| Epoch:9 | Test Acc: 0.3571
 Test site-Southeast_Asian           (1)| Epoch:9 | Test Acc: 0.3865
 Test site-Asian_ffhq                (3)| Epoch:9 | Test Acc: 0.2463
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:9 | Test Acc: 0.2836
White_utk: 0.2991, East_Asian: 0.4577, Indian_utk: 0.4479, Black_utk: 0.3571, Southeast_Asian: 0.3865, Asian_ffhq: 0.2463, Latino_Hispanic_ffhq: 0.2836, 
Average Test Accuracy(group): 0.3540, Average Test Accuracy(individual): 0.3727,
domain std=0.0758, cluster std=0.0685, individual std=0.0738, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 10 ============
cnt=[9, 9, 1, 3, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-White_utk                 (4) | Train Loss: 1.6426 | Train Acc: 0.3333
 Site-White_utk                 (0) | Train Loss: 1.7836 | Train Acc: 0.3529
 Site-White_utk                 (0) | Train Loss: 1.8140 | Train Acc: 0.2308
 Site-White_utk                 (0) | Train Loss: 1.8851 | Train Acc: 0.2368
 Site-White_utk                 (0) | Train Loss: 1.8084 | Train Acc: 0.2679
 Site-White_utk                 (0) | Train Loss: 1.7669 | Train Acc: 0.3049
 Site-White_utk                 (0) | Train Loss: 1.8044 | Train Acc: 0.3058
 Site-White_utk                 (0) | Train Loss: 1.8481 | Train Acc: 0.2905
 Site-White_utk                 (0) | Train Loss: 1.8723 | Train Acc: 0.2662
 Site-White_utk                 (0) | Train Loss: 1.8472 | Train Acc: 0.2946
 Site-East_Asian                (1) | Train Loss: 1.5668 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.5851 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.7327 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.6965 | Train Acc: 0.4070
 Site-East_Asian                (1) | Train Loss: 1.6774 | Train Acc: 0.4331
 Site-East_Asian                (1) | Train Loss: 1.6901 | Train Acc: 0.4011
 Site-East_Asian                (1) | Train Loss: 1.6516 | Train Acc: 0.4420
 Site-Indian_utk                (5) | Train Loss: 1.7433 | Train Acc: 0.4186
 Site-Indian_utk                (5) | Train Loss: 1.6085 | Train Acc: 0.4531
 Site-Indian_utk                (5) | Train Loss: 1.6800 | Train Acc: 0.4043
 Site-Indian_utk                (5) | Train Loss: 1.6952 | Train Acc: 0.4245
 Site-Indian_utk                (5) | Train Loss: 1.7057 | Train Acc: 0.4341
 Site-Black_utk                 (3) | Train Loss: 1.6708 | Train Acc: 0.5091
 Site-Black_utk                 (3) | Train Loss: 1.7875 | Train Acc: 0.3704
 Site-Black_utk                 (3) | Train Loss: 1.7593 | Train Acc: 0.4202
 Site-Southeast_Asian           (1) | Train Loss: 1.8189 | Train Acc: 0.3725
 Site-Southeast_Asian           (1) | Train Loss: 1.7952 | Train Acc: 0.3733
 Site-Asian_ffhq                (6) | Train Loss: 1.4712 | Train Acc: 0.6802
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4993 | Train Acc: 0.6325
Average Train Accuracy: 0.3910
 Site-White_utk                 (4) | Val  Loss: 1.6252 | Val  Acc: 0.3750
 Site-White_utk                 (0) | Val  Loss: 1.8024 | Val  Acc: 0.1818
 Site-White_utk                 (0) | Val  Loss: 1.8143 | Val  Acc: 0.4118
 Site-White_utk                 (0) | Val  Loss: 1.8175 | Val  Acc: 0.3200
 Site-White_utk                 (0) | Val  Loss: 1.8313 | Val  Acc: 0.2432
 Site-White_utk                 (0) | Val  Loss: 1.8704 | Val  Acc: 0.2727
 Site-White_utk                 (0) | Val  Loss: 1.9046 | Val  Acc: 0.2593
 Site-White_utk                 (0) | Val  Loss: 1.8550 | Val  Acc: 0.2353
 Site-White_utk                 (0) | Val  Loss: 1.8566 | Val  Acc: 0.2914
 Site-White_utk                 (0) | Val  Loss: 1.9698 | Val  Acc: 0.2713
 Site-East_Asian                (1) | Val  Loss: 1.8181 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.6106 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.6334 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.6680 | Val  Acc: 0.4386
 Site-East_Asian                (1) | Val  Loss: 1.6665 | Val  Acc: 0.4588
 Site-East_Asian                (1) | Val  Loss: 1.6766 | Val  Acc: 0.4240
 Site-East_Asian                (1) | Val  Loss: 1.6912 | Val  Acc: 0.4402
 Site-Indian_utk                (5) | Val  Loss: 1.6900 | Val  Acc: 0.4138
 Site-Indian_utk                (5) | Val  Loss: 1.6413 | Val  Acc: 0.4186
 Site-Indian_utk                (5) | Val  Loss: 1.6784 | Val  Acc: 0.4286
 Site-Indian_utk                (5) | Val  Loss: 1.7439 | Val  Acc: 0.4457
 Site-Indian_utk                (5) | Val  Loss: 1.5829 | Val  Acc: 0.4044
 Site-Black_utk                 (3) | Val  Loss: 1.7298 | Val  Acc: 0.4722
 Site-Black_utk                 (3) | Val  Loss: 1.7421 | Val  Acc: 0.3519
 Site-Black_utk                 (3) | Val  Loss: 1.7051 | Val  Acc: 0.4051
 Site-Southeast_Asian           (1) | Val  Loss: 1.8088 | Val  Acc: 0.3529
 Site-Southeast_Asian           (1) | Val  Loss: 1.8251 | Val  Acc: 0.3500
 Site-Asian_ffhq                (6) | Val  Loss: 1.5158 | Val  Acc: 0.6348
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.7949 | Val  Acc: 0.1410
Average Valid Accuracy: 0.3670
============ Train epoch 11 ============
cnt=[9, 1, 1, 8, 8, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-White_utk                 (6) | Train Loss: 1.5741 | Train Acc: 0.3333
 Site-White_utk                 (3) | Train Loss: 1.7053 | Train Acc: 0.4118
 Site-White_utk                 (3) | Train Loss: 1.7718 | Train Acc: 0.3462
 Site-White_utk                 (3) | Train Loss: 1.8543 | Train Acc: 0.2105
 Site-White_utk                 (3) | Train Loss: 1.7305 | Train Acc: 0.3929
 Site-White_utk                 (1) | Train Loss: 1.7971 | Train Acc: 0.3659
 Site-White_utk                 (3) | Train Loss: 1.7522 | Train Acc: 0.3058
 Site-White_utk                 (3) | Train Loss: 1.8361 | Train Acc: 0.2570
 Site-White_utk                 (3) | Train Loss: 1.7943 | Train Acc: 0.2890
 Site-White_utk                 (3) | Train Loss: 1.8021 | Train Acc: 0.3411
 Site-East_Asian                (0) | Train Loss: 1.5925 | Train Acc: 0.4815
 Site-East_Asian                (0) | Train Loss: 1.5759 | Train Acc: 0.4750
 Site-East_Asian                (0) | Train Loss: 1.7709 | Train Acc: 0.3559
 Site-East_Asian                (0) | Train Loss: 1.7184 | Train Acc: 0.3953
 Site-East_Asian                (0) | Train Loss: 1.7075 | Train Acc: 0.4252
 Site-East_Asian                (0) | Train Loss: 1.6877 | Train Acc: 0.4171
 Site-East_Asian                (0) | Train Loss: 1.6522 | Train Acc: 0.4312
 Site-Indian_utk                (4) | Train Loss: 1.6372 | Train Acc: 0.4651
 Site-Indian_utk                (4) | Train Loss: 1.6122 | Train Acc: 0.5312
 Site-Indian_utk                (4) | Train Loss: 1.6932 | Train Acc: 0.4043
 Site-Indian_utk                (4) | Train Loss: 1.6424 | Train Acc: 0.4604
 Site-Indian_utk                (4) | Train Loss: 1.6747 | Train Acc: 0.4293
 Site-Black_utk                 (4) | Train Loss: 1.7006 | Train Acc: 0.4727
 Site-Black_utk                 (4) | Train Loss: 1.6720 | Train Acc: 0.3704
 Site-Black_utk                 (4) | Train Loss: 1.7593 | Train Acc: 0.4202
 Site-Southeast_Asian           (0) | Train Loss: 1.8097 | Train Acc: 0.3725
 Site-Southeast_Asian           (0) | Train Loss: 1.7782 | Train Acc: 0.3533
 Site-Asian_ffhq                (2) | Train Loss: 1.5279 | Train Acc: 0.6744
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.6029 | Train Acc: 0.6154
Average Train Accuracy: 0.4070
 Site-White_utk                 (6) | Val  Loss: 1.5917 | Val  Acc: 0.3750
 Site-White_utk                 (3) | Val  Loss: 1.6792 | Val  Acc: 0.2727
 Site-White_utk                 (3) | Val  Loss: 1.7790 | Val  Acc: 0.2941
 Site-White_utk                 (3) | Val  Loss: 1.6557 | Val  Acc: 0.3600
 Site-White_utk                 (3) | Val  Loss: 1.7482 | Val  Acc: 0.2703
 Site-White_utk                 (1) | Val  Loss: 1.8103 | Val  Acc: 0.3273
 Site-White_utk                 (3) | Val  Loss: 1.8647 | Val  Acc: 0.2593
 Site-White_utk                 (3) | Val  Loss: 1.8014 | Val  Acc: 0.2689
 Site-White_utk                 (3) | Val  Loss: 1.8440 | Val  Acc: 0.2914
 Site-White_utk                 (3) | Val  Loss: 1.8751 | Val  Acc: 0.2636
 Site-East_Asian                (0) | Val  Loss: 1.8539 | Val  Acc: 0.2778
 Site-East_Asian                (0) | Val  Loss: 1.6380 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.6309 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.6653 | Val  Acc: 0.4386
 Site-East_Asian                (0) | Val  Loss: 1.6814 | Val  Acc: 0.4588
 Site-East_Asian                (0) | Val  Loss: 1.6513 | Val  Acc: 0.4480
 Site-East_Asian                (0) | Val  Loss: 1.6884 | Val  Acc: 0.4348
 Site-Indian_utk                (4) | Val  Loss: 1.6936 | Val  Acc: 0.4138
 Site-Indian_utk                (4) | Val  Loss: 1.6068 | Val  Acc: 0.4884
 Site-Indian_utk                (4) | Val  Loss: 1.6720 | Val  Acc: 0.3968
 Site-Indian_utk                (4) | Val  Loss: 1.7374 | Val  Acc: 0.4239
 Site-Indian_utk                (4) | Val  Loss: 1.6188 | Val  Acc: 0.3971
 Site-Black_utk                 (4) | Val  Loss: 1.7709 | Val  Acc: 0.4167
 Site-Black_utk                 (4) | Val  Loss: 1.7481 | Val  Acc: 0.3889
 Site-Black_utk                 (4) | Val  Loss: 1.7519 | Val  Acc: 0.3418
 Site-Southeast_Asian           (0) | Val  Loss: 1.8889 | Val  Acc: 0.3235
 Site-Southeast_Asian           (0) | Val  Loss: 1.8680 | Val  Acc: 0.3500
 Site-Asian_ffhq                (2) | Val  Loss: 1.5680 | Val  Acc: 0.6348
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.8813 | Val  Acc: 0.1410
Average Valid Accuracy: 0.3683
============ Train epoch 12 ============
cnt=[2, 9, 8, 5, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-White_utk                 (5) | Train Loss: 1.5649 | Train Acc: 0.3333
 Site-White_utk                 (1) | Train Loss: 1.7703 | Train Acc: 0.3529
 Site-White_utk                 (1) | Train Loss: 1.7050 | Train Acc: 0.3462
 Site-White_utk                 (1) | Train Loss: 1.8623 | Train Acc: 0.2895
 Site-White_utk                 (1) | Train Loss: 1.7182 | Train Acc: 0.3571
 Site-White_utk                 (1) | Train Loss: 1.8325 | Train Acc: 0.3659
 Site-White_utk                 (1) | Train Loss: 1.7640 | Train Acc: 0.3388
 Site-White_utk                 (1) | Train Loss: 1.7987 | Train Acc: 0.3073
 Site-White_utk                 (1) | Train Loss: 1.7095 | Train Acc: 0.3232
 Site-White_utk                 (1) | Train Loss: 1.8047 | Train Acc: 0.3540
 Site-East_Asian                (6) | Train Loss: 1.5514 | Train Acc: 0.4444
 Site-East_Asian                (2) | Train Loss: 1.5454 | Train Acc: 0.5250
 Site-East_Asian                (2) | Train Loss: 1.7559 | Train Acc: 0.3390
 Site-East_Asian                (2) | Train Loss: 1.6782 | Train Acc: 0.4186
 Site-East_Asian                (2) | Train Loss: 1.6752 | Train Acc: 0.4488
 Site-East_Asian                (2) | Train Loss: 1.7018 | Train Acc: 0.4118
 Site-East_Asian                (2) | Train Loss: 1.6819 | Train Acc: 0.4348
 Site-Indian_utk                (3) | Train Loss: 1.6936 | Train Acc: 0.4419
 Site-Indian_utk                (3) | Train Loss: 1.5920 | Train Acc: 0.4844
 Site-Indian_utk                (3) | Train Loss: 1.6889 | Train Acc: 0.4043
 Site-Indian_utk                (3) | Train Loss: 1.6469 | Train Acc: 0.4604
 Site-Indian_utk                (3) | Train Loss: 1.7716 | Train Acc: 0.4732
 Site-Black_utk                 (4) | Train Loss: 1.6400 | Train Acc: 0.5273
 Site-Black_utk                 (4) | Train Loss: 1.6713 | Train Acc: 0.4198
 Site-Black_utk                 (4) | Train Loss: 1.7303 | Train Acc: 0.4286
 Site-Southeast_Asian           (2) | Train Loss: 1.8202 | Train Acc: 0.3627
 Site-Southeast_Asian           (2) | Train Loss: 1.8022 | Train Acc: 0.3867
 Site-Asian_ffhq                (0) | Train Loss: 1.5967 | Train Acc: 0.6453
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.6225 | Train Acc: 0.5812
Average Train Accuracy: 0.4140
 Site-White_utk                 (5) | Val  Loss: 1.6185 | Val  Acc: 0.3750
 Site-White_utk                 (1) | Val  Loss: 1.6624 | Val  Acc: 0.2727
 Site-White_utk                 (1) | Val  Loss: 1.7262 | Val  Acc: 0.3529
 Site-White_utk                 (1) | Val  Loss: 1.7332 | Val  Acc: 0.2800
 Site-White_utk                 (1) | Val  Loss: 1.7155 | Val  Acc: 0.3514
 Site-White_utk                 (1) | Val  Loss: 1.7646 | Val  Acc: 0.2909
 Site-White_utk                 (1) | Val  Loss: 1.8292 | Val  Acc: 0.3333
 Site-White_utk                 (1) | Val  Loss: 1.7852 | Val  Acc: 0.3025
 Site-White_utk                 (1) | Val  Loss: 1.7927 | Val  Acc: 0.3314
 Site-White_utk                 (1) | Val  Loss: 1.8573 | Val  Acc: 0.3333
 Site-East_Asian                (6) | Val  Loss: 1.8182 | Val  Acc: 0.3333
 Site-East_Asian                (2) | Val  Loss: 1.6612 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.6728 | Val  Acc: 0.4359
 Site-East_Asian                (2) | Val  Loss: 1.6662 | Val  Acc: 0.4386
 Site-East_Asian                (2) | Val  Loss: 1.6826 | Val  Acc: 0.4588
 Site-East_Asian                (2) | Val  Loss: 1.6852 | Val  Acc: 0.4400
 Site-East_Asian                (2) | Val  Loss: 1.6970 | Val  Acc: 0.4239
 Site-Indian_utk                (3) | Val  Loss: 1.7224 | Val  Acc: 0.3793
 Site-Indian_utk                (3) | Val  Loss: 1.6180 | Val  Acc: 0.4651
 Site-Indian_utk                (3) | Val  Loss: 1.6954 | Val  Acc: 0.4603
 Site-Indian_utk                (3) | Val  Loss: 1.7695 | Val  Acc: 0.4022
 Site-Indian_utk                (3) | Val  Loss: 1.5612 | Val  Acc: 0.4118
 Site-Black_utk                 (4) | Val  Loss: 1.7427 | Val  Acc: 0.4444
 Site-Black_utk                 (4) | Val  Loss: 1.7421 | Val  Acc: 0.3704
 Site-Black_utk                 (4) | Val  Loss: 1.6921 | Val  Acc: 0.3924
 Site-Southeast_Asian           (2) | Val  Loss: 1.8586 | Val  Acc: 0.3824
 Site-Southeast_Asian           (2) | Val  Loss: 1.8018 | Val  Acc: 0.3700
 Site-Asian_ffhq                (0) | Val  Loss: 1.6025 | Val  Acc: 0.6000
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.9463 | Val  Acc: 0.1282
Average Valid Accuracy: 0.3801
 Best site-White_utk                (5)  | Epoch:12 | Val Acc: 0.3750
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.2727
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.3529
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.2800
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.3514
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.2909
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.3333
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.3025
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.3314
 Best site-White_utk                (1)  | Epoch:12 | Val Acc: 0.3333
 Best site-East_Asian               (6)  | Epoch:12 | Val Acc: 0.3333
 Best site-East_Asian               (2)  | Epoch:12 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:12 | Val Acc: 0.4359
 Best site-East_Asian               (2)  | Epoch:12 | Val Acc: 0.4386
 Best site-East_Asian               (2)  | Epoch:12 | Val Acc: 0.4588
 Best site-East_Asian               (2)  | Epoch:12 | Val Acc: 0.4400
 Best site-East_Asian               (2)  | Epoch:12 | Val Acc: 0.4239
 Best site-Indian_utk               (3)  | Epoch:12 | Val Acc: 0.3793
 Best site-Indian_utk               (3)  | Epoch:12 | Val Acc: 0.4651
 Best site-Indian_utk               (3)  | Epoch:12 | Val Acc: 0.4603
 Best site-Indian_utk               (3)  | Epoch:12 | Val Acc: 0.4022
 Best site-Indian_utk               (3)  | Epoch:12 | Val Acc: 0.4118
 Best site-Black_utk                (4)  | Epoch:12 | Val Acc: 0.4444
 Best site-Black_utk                (4)  | Epoch:12 | Val Acc: 0.3704
 Best site-Black_utk                (4)  | Epoch:12 | Val Acc: 0.3924
 Best site-Southeast_Asian          (2)  | Epoch:12 | Val Acc: 0.3824
 Best site-Southeast_Asian          (2)  | Epoch:12 | Val Acc: 0.3700
 Best site-Asian_ffhq               (0)  | Epoch:12 | Val Acc: 0.6000
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:12 | Val Acc: 0.1282
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 13 ============
cnt=[8, 9, 5, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-White_utk                 (3) | Train Loss: 1.5515 | Train Acc: 0.3333
 Site-White_utk                 (0) | Train Loss: 1.6872 | Train Acc: 0.3529
 Site-White_utk                 (5) | Train Loss: 1.7050 | Train Acc: 0.2692
 Site-White_utk                 (0) | Train Loss: 1.8362 | Train Acc: 0.2105
 Site-White_utk                 (0) | Train Loss: 1.6920 | Train Acc: 0.3929
 Site-White_utk                 (0) | Train Loss: 1.7838 | Train Acc: 0.3780
 Site-White_utk                 (0) | Train Loss: 1.7265 | Train Acc: 0.3058
 Site-White_utk                 (0) | Train Loss: 1.8062 | Train Acc: 0.2849
 Site-White_utk                 (0) | Train Loss: 1.8735 | Train Acc: 0.3156
 Site-White_utk                 (0) | Train Loss: 1.7732 | Train Acc: 0.3618
 Site-East_Asian                (1) | Train Loss: 1.5344 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.5443 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.7387 | Train Acc: 0.3559
 Site-East_Asian                (1) | Train Loss: 1.7641 | Train Acc: 0.4302
 Site-East_Asian                (1) | Train Loss: 1.6930 | Train Acc: 0.4409
 Site-East_Asian                (1) | Train Loss: 1.6671 | Train Acc: 0.4064
 Site-East_Asian                (1) | Train Loss: 1.6385 | Train Acc: 0.4348
 Site-Indian_utk                (2) | Train Loss: 1.6759 | Train Acc: 0.4651
 Site-Indian_utk                (2) | Train Loss: 1.6136 | Train Acc: 0.4688
 Site-Indian_utk                (2) | Train Loss: 1.6488 | Train Acc: 0.4255
 Site-Indian_utk                (2) | Train Loss: 1.6765 | Train Acc: 0.4820
 Site-Indian_utk                (2) | Train Loss: 1.6689 | Train Acc: 0.4683
 Site-Black_utk                 (6) | Train Loss: 1.6442 | Train Acc: 0.4909
 Site-Black_utk                 (6) | Train Loss: 1.7469 | Train Acc: 0.4198
 Site-Black_utk                 (6) | Train Loss: 1.6856 | Train Acc: 0.4790
 Site-Southeast_Asian           (1) | Train Loss: 1.8300 | Train Acc: 0.3529
 Site-Southeast_Asian           (1) | Train Loss: 1.8126 | Train Acc: 0.3867
 Site-Asian_ffhq                (4) | Train Loss: 1.5157 | Train Acc: 0.6686
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5746 | Train Acc: 0.5897
Average Train Accuracy: 0.4121
 Site-White_utk                 (3) | Val  Loss: 1.5878 | Val  Acc: 0.3750
 Site-White_utk                 (0) | Val  Loss: 1.7028 | Val  Acc: 0.2727
 Site-White_utk                 (5) | Val  Loss: 1.7364 | Val  Acc: 0.3529
 Site-White_utk                 (0) | Val  Loss: 1.7568 | Val  Acc: 0.3600
 Site-White_utk                 (0) | Val  Loss: 1.7501 | Val  Acc: 0.2432
 Site-White_utk                 (0) | Val  Loss: 1.8070 | Val  Acc: 0.3091
 Site-White_utk                 (0) | Val  Loss: 1.7720 | Val  Acc: 0.3086
 Site-White_utk                 (0) | Val  Loss: 1.7391 | Val  Acc: 0.3109
 Site-White_utk                 (0) | Val  Loss: 1.8043 | Val  Acc: 0.3029
 Site-White_utk                 (0) | Val  Loss: 1.8635 | Val  Acc: 0.2907
 Site-East_Asian                (1) | Val  Loss: 1.8118 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.6062 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.6178 | Val  Acc: 0.5128
 Site-East_Asian                (1) | Val  Loss: 1.6687 | Val  Acc: 0.4386
 Site-East_Asian                (1) | Val  Loss: 1.6661 | Val  Acc: 0.4588
 Site-East_Asian                (1) | Val  Loss: 1.6535 | Val  Acc: 0.4560
 Site-East_Asian                (1) | Val  Loss: 1.6455 | Val  Acc: 0.4239
 Site-Indian_utk                (2) | Val  Loss: 1.6369 | Val  Acc: 0.4828
 Site-Indian_utk                (2) | Val  Loss: 1.5951 | Val  Acc: 0.3953
 Site-Indian_utk                (2) | Val  Loss: 1.6351 | Val  Acc: 0.4444
 Site-Indian_utk                (2) | Val  Loss: 1.7304 | Val  Acc: 0.4130
 Site-Indian_utk                (2) | Val  Loss: 1.5691 | Val  Acc: 0.4485
 Site-Black_utk                 (6) | Val  Loss: 1.7348 | Val  Acc: 0.4722
 Site-Black_utk                 (6) | Val  Loss: 1.7189 | Val  Acc: 0.3704
 Site-Black_utk                 (6) | Val  Loss: 1.6796 | Val  Acc: 0.4051
 Site-Southeast_Asian           (1) | Val  Loss: 1.6701 | Val  Acc: 0.3676
 Site-Southeast_Asian           (1) | Val  Loss: 1.7770 | Val  Acc: 0.3700
 Site-Asian_ffhq                (4) | Val  Loss: 1.5569 | Val  Acc: 0.6261
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.9268 | Val  Acc: 0.1538
Average Valid Accuracy: 0.3829
 Best site-White_utk                (3)  | Epoch:13 | Val Acc: 0.3750
 Best site-White_utk                (0)  | Epoch:13 | Val Acc: 0.2727
 Best site-White_utk                (5)  | Epoch:13 | Val Acc: 0.3529
 Best site-White_utk                (0)  | Epoch:13 | Val Acc: 0.3600
 Best site-White_utk                (0)  | Epoch:13 | Val Acc: 0.2432
 Best site-White_utk                (0)  | Epoch:13 | Val Acc: 0.3091
 Best site-White_utk                (0)  | Epoch:13 | Val Acc: 0.3086
 Best site-White_utk                (0)  | Epoch:13 | Val Acc: 0.3109
 Best site-White_utk                (0)  | Epoch:13 | Val Acc: 0.3029
 Best site-White_utk                (0)  | Epoch:13 | Val Acc: 0.2907
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.2778
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.5128
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.4386
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.4588
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.4560
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.4239
 Best site-Indian_utk               (2)  | Epoch:13 | Val Acc: 0.4828
 Best site-Indian_utk               (2)  | Epoch:13 | Val Acc: 0.3953
 Best site-Indian_utk               (2)  | Epoch:13 | Val Acc: 0.4444
 Best site-Indian_utk               (2)  | Epoch:13 | Val Acc: 0.4130
 Best site-Indian_utk               (2)  | Epoch:13 | Val Acc: 0.4485
 Best site-Black_utk                (6)  | Epoch:13 | Val Acc: 0.4722
 Best site-Black_utk                (6)  | Epoch:13 | Val Acc: 0.3704
 Best site-Black_utk                (6)  | Epoch:13 | Val Acc: 0.4051
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.3676
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.3700
 Best site-Asian_ffhq               (4)  | Epoch:13 | Val Acc: 0.6261
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:13 | Val Acc: 0.1538
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 14 ============
cnt=[8, 8, 1, 9, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-White_utk                 (3) | Train Loss: 1.5216 | Train Acc: 0.4167
 Site-White_utk                 (6) | Train Loss: 1.7375 | Train Acc: 0.3529
 Site-White_utk                 (3) | Train Loss: 1.6888 | Train Acc: 0.3077
 Site-White_utk                 (3) | Train Loss: 1.7825 | Train Acc: 0.2895
 Site-White_utk                 (3) | Train Loss: 1.6746 | Train Acc: 0.3571
 Site-White_utk                 (3) | Train Loss: 1.7731 | Train Acc: 0.3537
 Site-White_utk                 (3) | Train Loss: 1.7480 | Train Acc: 0.2893
 Site-White_utk                 (3) | Train Loss: 1.7970 | Train Acc: 0.2626
 Site-White_utk                 (3) | Train Loss: 1.7343 | Train Acc: 0.3574
 Site-White_utk                 (3) | Train Loss: 1.7546 | Train Acc: 0.3798
 Site-East_Asian                (0) | Train Loss: 1.6038 | Train Acc: 0.4074
 Site-East_Asian                (4) | Train Loss: 1.5419 | Train Acc: 0.5250
 Site-East_Asian                (0) | Train Loss: 1.7326 | Train Acc: 0.3898
 Site-East_Asian                (0) | Train Loss: 1.7144 | Train Acc: 0.3837
 Site-East_Asian                (0) | Train Loss: 1.6672 | Train Acc: 0.4488
 Site-East_Asian                (0) | Train Loss: 1.6947 | Train Acc: 0.4064
 Site-East_Asian                (0) | Train Loss: 1.5685 | Train Acc: 0.4239
 Site-Indian_utk                (1) | Train Loss: 1.6179 | Train Acc: 0.4186
 Site-Indian_utk                (1) | Train Loss: 1.5762 | Train Acc: 0.4688
 Site-Indian_utk                (1) | Train Loss: 1.6662 | Train Acc: 0.4574
 Site-Indian_utk                (1) | Train Loss: 1.6148 | Train Acc: 0.4460
 Site-Indian_utk                (1) | Train Loss: 1.6165 | Train Acc: 0.4488
 Site-Black_utk                 (1) | Train Loss: 1.6562 | Train Acc: 0.4545
 Site-Black_utk                 (1) | Train Loss: 1.6951 | Train Acc: 0.4321
 Site-Black_utk                 (1) | Train Loss: 1.7212 | Train Acc: 0.4370
 Site-Southeast_Asian           (0) | Train Loss: 1.7540 | Train Acc: 0.3922
 Site-Southeast_Asian           (0) | Train Loss: 1.7397 | Train Acc: 0.3600
 Site-Asian_ffhq                (2) | Train Loss: 1.5319 | Train Acc: 0.6337
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.5826 | Train Acc: 0.5897
Average Train Accuracy: 0.4100
 Site-White_utk                 (3) | Val  Loss: 1.5098 | Val  Acc: 0.5000
 Site-White_utk                 (6) | Val  Loss: 1.6763 | Val  Acc: 0.4545
 Site-White_utk                 (3) | Val  Loss: 1.7375 | Val  Acc: 0.2941
 Site-White_utk                 (3) | Val  Loss: 1.7161 | Val  Acc: 0.3200
 Site-White_utk                 (3) | Val  Loss: 1.6782 | Val  Acc: 0.2432
 Site-White_utk                 (3) | Val  Loss: 1.7459 | Val  Acc: 0.3273
 Site-White_utk                 (3) | Val  Loss: 1.8359 | Val  Acc: 0.2840
 Site-White_utk                 (3) | Val  Loss: 1.7182 | Val  Acc: 0.3529
 Site-White_utk                 (3) | Val  Loss: 1.8036 | Val  Acc: 0.2971
 Site-White_utk                 (3) | Val  Loss: 1.8505 | Val  Acc: 0.3101
 Site-East_Asian                (0) | Val  Loss: 1.7462 | Val  Acc: 0.3889
 Site-East_Asian                (4) | Val  Loss: 1.5592 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.5811 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.6306 | Val  Acc: 0.4386
 Site-East_Asian                (0) | Val  Loss: 1.6098 | Val  Acc: 0.4941
 Site-East_Asian                (0) | Val  Loss: 1.6145 | Val  Acc: 0.4480
 Site-East_Asian                (0) | Val  Loss: 1.6679 | Val  Acc: 0.4348
 Site-Indian_utk                (1) | Val  Loss: 1.6502 | Val  Acc: 0.4138
 Site-Indian_utk                (1) | Val  Loss: 1.5510 | Val  Acc: 0.4884
 Site-Indian_utk                (1) | Val  Loss: 1.6182 | Val  Acc: 0.4286
 Site-Indian_utk                (1) | Val  Loss: 1.7383 | Val  Acc: 0.4783
 Site-Indian_utk                (1) | Val  Loss: 1.5645 | Val  Acc: 0.4338
 Site-Black_utk                 (1) | Val  Loss: 1.6954 | Val  Acc: 0.4444
 Site-Black_utk                 (1) | Val  Loss: 1.6881 | Val  Acc: 0.4074
 Site-Black_utk                 (1) | Val  Loss: 1.6619 | Val  Acc: 0.4177
 Site-Southeast_Asian           (0) | Val  Loss: 1.7773 | Val  Acc: 0.3971
 Site-Southeast_Asian           (0) | Val  Loss: 1.7820 | Val  Acc: 0.3900
 Site-Asian_ffhq                (2) | Val  Loss: 1.5821 | Val  Acc: 0.5826
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.9875 | Val  Acc: 0.1282
Average Valid Accuracy: 0.3973
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.5000
 Best site-White_utk                (6)  | Epoch:14 | Val Acc: 0.4545
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.2941
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.3200
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.2432
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.3273
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.2840
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.3529
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.2971
 Best site-White_utk                (3)  | Epoch:14 | Val Acc: 0.3101
 Best site-East_Asian               (0)  | Epoch:14 | Val Acc: 0.3889
 Best site-East_Asian               (4)  | Epoch:14 | Val Acc: 0.4615
 Best site-East_Asian               (0)  | Epoch:14 | Val Acc: 0.4615
 Best site-East_Asian               (0)  | Epoch:14 | Val Acc: 0.4386
 Best site-East_Asian               (0)  | Epoch:14 | Val Acc: 0.4941
 Best site-East_Asian               (0)  | Epoch:14 | Val Acc: 0.4480
 Best site-East_Asian               (0)  | Epoch:14 | Val Acc: 0.4348
 Best site-Indian_utk               (1)  | Epoch:14 | Val Acc: 0.4138
 Best site-Indian_utk               (1)  | Epoch:14 | Val Acc: 0.4884
 Best site-Indian_utk               (1)  | Epoch:14 | Val Acc: 0.4286
 Best site-Indian_utk               (1)  | Epoch:14 | Val Acc: 0.4783
 Best site-Indian_utk               (1)  | Epoch:14 | Val Acc: 0.4338
 Best site-Black_utk                (1)  | Epoch:14 | Val Acc: 0.4444
 Best site-Black_utk                (1)  | Epoch:14 | Val Acc: 0.4074
 Best site-Black_utk                (1)  | Epoch:14 | Val Acc: 0.4177
 Best site-Southeast_Asian          (0)  | Epoch:14 | Val Acc: 0.3971
 Best site-Southeast_Asian          (0)  | Epoch:14 | Val Acc: 0.3900
 Best site-Asian_ffhq               (2)  | Epoch:14 | Val Acc: 0.5826
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:14 | Val Acc: 0.1282
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Test site-White_utk                 (3)| Epoch:14 | Test Acc: 0.3350
 Test site-East_Asian                (0)| Epoch:14 | Test Acc: 0.4776
 Test site-Indian_utk                (1)| Epoch:14 | Test Acc: 0.4625
 Test site-Black_utk                 (1)| Epoch:14 | Test Acc: 0.3418
 Test site-Southeast_Asian           (0)| Epoch:14 | Test Acc: 0.4125
 Test site-Asian_ffhq                (2)| Epoch:14 | Test Acc: 0.2371
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:14 | Test Acc: 0.2587
White_utk: 0.3350, East_Asian: 0.4776, Indian_utk: 0.4625, Black_utk: 0.3418, Southeast_Asian: 0.4125, Asian_ffhq: 0.2371, Latino_Hispanic_ffhq: 0.2587, 
Average Test Accuracy(group): 0.3608, Average Test Accuracy(individual): 0.3915,
domain std=0.0873, cluster std=0.0878, individual std=0.0740, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 15 ============
cnt=[9, 1, 2, 3, 1, 8, 5, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-White_utk                 (4) | Train Loss: 1.5247 | Train Acc: 0.2500
 Site-White_utk                 (0) | Train Loss: 1.6881 | Train Acc: 0.2941
 Site-White_utk                 (0) | Train Loss: 1.6589 | Train Acc: 0.3846
 Site-White_utk                 (0) | Train Loss: 1.7964 | Train Acc: 0.2368
 Site-White_utk                 (0) | Train Loss: 1.6671 | Train Acc: 0.4107
 Site-White_utk                 (0) | Train Loss: 1.7712 | Train Acc: 0.4146
 Site-White_utk                 (0) | Train Loss: 1.6852 | Train Acc: 0.3140
 Site-White_utk                 (0) | Train Loss: 1.7670 | Train Acc: 0.3128
 Site-White_utk                 (0) | Train Loss: 1.7170 | Train Acc: 0.3232
 Site-White_utk                 (0) | Train Loss: 1.7197 | Train Acc: 0.3618
 Site-East_Asian                (5) | Train Loss: 1.4911 | Train Acc: 0.4444
 Site-East_Asian                (1) | Train Loss: 1.4989 | Train Acc: 0.5000
 Site-East_Asian                (5) | Train Loss: 1.7368 | Train Acc: 0.3220
 Site-East_Asian                (5) | Train Loss: 1.7444 | Train Acc: 0.4186
 Site-East_Asian                (5) | Train Loss: 1.6516 | Train Acc: 0.4488
 Site-East_Asian                (5) | Train Loss: 1.6458 | Train Acc: 0.4064
 Site-East_Asian                (5) | Train Loss: 1.6142 | Train Acc: 0.4239
 Site-Indian_utk                (6) | Train Loss: 1.6099 | Train Acc: 0.4884
 Site-Indian_utk                (6) | Train Loss: 1.5797 | Train Acc: 0.4844
 Site-Indian_utk                (6) | Train Loss: 1.6001 | Train Acc: 0.4149
 Site-Indian_utk                (6) | Train Loss: 1.6161 | Train Acc: 0.4748
 Site-Indian_utk                (6) | Train Loss: 1.6160 | Train Acc: 0.4537
 Site-Black_utk                 (3) | Train Loss: 1.6286 | Train Acc: 0.5273
 Site-Black_utk                 (3) | Train Loss: 1.6897 | Train Acc: 0.4321
 Site-Black_utk                 (3) | Train Loss: 1.6904 | Train Acc: 0.4118
 Site-Southeast_Asian           (5) | Train Loss: 1.8101 | Train Acc: 0.3922
 Site-Southeast_Asian           (5) | Train Loss: 1.7538 | Train Acc: 0.3800
 Site-Asian_ffhq                (2) | Train Loss: 1.5711 | Train Acc: 0.6221
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5664 | Train Acc: 0.6068
Average Train Accuracy: 0.4123
 Site-White_utk                 (4) | Val  Loss: 1.5162 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.5885 | Val  Acc: 0.3636
 Site-White_utk                 (0) | Val  Loss: 1.6989 | Val  Acc: 0.2941
 Site-White_utk                 (0) | Val  Loss: 1.6836 | Val  Acc: 0.3600
 Site-White_utk                 (0) | Val  Loss: 1.7093 | Val  Acc: 0.2973
 Site-White_utk                 (0) | Val  Loss: 1.7361 | Val  Acc: 0.3273
 Site-White_utk                 (0) | Val  Loss: 1.8090 | Val  Acc: 0.2593
 Site-White_utk                 (0) | Val  Loss: 1.7674 | Val  Acc: 0.2941
 Site-White_utk                 (0) | Val  Loss: 1.7734 | Val  Acc: 0.3086
 Site-White_utk                 (0) | Val  Loss: 1.8415 | Val  Acc: 0.3411
 Site-East_Asian                (5) | Val  Loss: 1.7585 | Val  Acc: 0.3889
 Site-East_Asian                (1) | Val  Loss: 1.6030 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.6119 | Val  Acc: 0.4615
 Site-East_Asian                (5) | Val  Loss: 1.6105 | Val  Acc: 0.4386
 Site-East_Asian                (5) | Val  Loss: 1.6279 | Val  Acc: 0.4941
 Site-East_Asian                (5) | Val  Loss: 1.6291 | Val  Acc: 0.4560
 Site-East_Asian                (5) | Val  Loss: 1.6320 | Val  Acc: 0.4457
 Site-Indian_utk                (6) | Val  Loss: 1.6546 | Val  Acc: 0.4483
 Site-Indian_utk                (6) | Val  Loss: 1.5332 | Val  Acc: 0.5116
 Site-Indian_utk                (6) | Val  Loss: 1.6186 | Val  Acc: 0.4444
 Site-Indian_utk                (6) | Val  Loss: 1.6797 | Val  Acc: 0.4239
 Site-Indian_utk                (6) | Val  Loss: 1.4807 | Val  Acc: 0.4485
 Site-Black_utk                 (3) | Val  Loss: 1.6938 | Val  Acc: 0.5556
 Site-Black_utk                 (3) | Val  Loss: 1.6730 | Val  Acc: 0.3333
 Site-Black_utk                 (3) | Val  Loss: 1.6504 | Val  Acc: 0.4177
 Site-Southeast_Asian           (5) | Val  Loss: 1.8310 | Val  Acc: 0.3529
 Site-Southeast_Asian           (5) | Val  Loss: 1.7527 | Val  Acc: 0.3900
 Site-Asian_ffhq                (2) | Val  Loss: 1.5659 | Val  Acc: 0.6000
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9355 | Val  Acc: 0.1538
Average Valid Accuracy: 0.4004
 Best site-White_utk                (4)  | Epoch:15 | Val Acc: 0.5000
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.3636
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.2941
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.3600
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.2973
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.3273
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.2593
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.2941
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.3086
 Best site-White_utk                (0)  | Epoch:15 | Val Acc: 0.3411
 Best site-East_Asian               (5)  | Epoch:15 | Val Acc: 0.3889
 Best site-East_Asian               (1)  | Epoch:15 | Val Acc: 0.5000
 Best site-East_Asian               (5)  | Epoch:15 | Val Acc: 0.4615
 Best site-East_Asian               (5)  | Epoch:15 | Val Acc: 0.4386
 Best site-East_Asian               (5)  | Epoch:15 | Val Acc: 0.4941
 Best site-East_Asian               (5)  | Epoch:15 | Val Acc: 0.4560
 Best site-East_Asian               (5)  | Epoch:15 | Val Acc: 0.4457
 Best site-Indian_utk               (6)  | Epoch:15 | Val Acc: 0.4483
 Best site-Indian_utk               (6)  | Epoch:15 | Val Acc: 0.5116
 Best site-Indian_utk               (6)  | Epoch:15 | Val Acc: 0.4444
 Best site-Indian_utk               (6)  | Epoch:15 | Val Acc: 0.4239
 Best site-Indian_utk               (6)  | Epoch:15 | Val Acc: 0.4485
 Best site-Black_utk                (3)  | Epoch:15 | Val Acc: 0.5556
 Best site-Black_utk                (3)  | Epoch:15 | Val Acc: 0.3333
 Best site-Black_utk                (3)  | Epoch:15 | Val Acc: 0.4177
 Best site-Southeast_Asian          (5)  | Epoch:15 | Val Acc: 0.3529
 Best site-Southeast_Asian          (5)  | Epoch:15 | Val Acc: 0.3900
 Best site-Asian_ffhq               (2)  | Epoch:15 | Val Acc: 0.6000
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:15 | Val Acc: 0.1538
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 9, 8, 3, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-White_utk                 (5) | Train Loss: 1.5423 | Train Acc: 0.3333
 Site-White_utk                 (1) | Train Loss: 1.6456 | Train Acc: 0.3529
 Site-White_utk                 (1) | Train Loss: 1.6110 | Train Acc: 0.3462
 Site-White_utk                 (1) | Train Loss: 1.7545 | Train Acc: 0.2895
 Site-White_utk                 (1) | Train Loss: 1.6566 | Train Acc: 0.3571
 Site-White_utk                 (1) | Train Loss: 1.6780 | Train Acc: 0.3537
 Site-White_utk                 (1) | Train Loss: 1.6864 | Train Acc: 0.3223
 Site-White_utk                 (1) | Train Loss: 1.7559 | Train Acc: 0.2849
 Site-White_utk                 (1) | Train Loss: 1.7502 | Train Acc: 0.3650
 Site-White_utk                 (1) | Train Loss: 1.6808 | Train Acc: 0.3540
 Site-East_Asian                (2) | Train Loss: 1.5696 | Train Acc: 0.4074
 Site-East_Asian                (6) | Train Loss: 1.4702 | Train Acc: 0.5750
 Site-East_Asian                (2) | Train Loss: 1.7207 | Train Acc: 0.3729
 Site-East_Asian                (2) | Train Loss: 1.7709 | Train Acc: 0.3953
 Site-East_Asian                (2) | Train Loss: 1.6428 | Train Acc: 0.4409
 Site-East_Asian                (2) | Train Loss: 1.6506 | Train Acc: 0.4171
 Site-East_Asian                (2) | Train Loss: 1.6100 | Train Acc: 0.4384
 Site-Indian_utk                (4) | Train Loss: 1.5757 | Train Acc: 0.4419
 Site-Indian_utk                (4) | Train Loss: 1.5815 | Train Acc: 0.4688
 Site-Indian_utk                (4) | Train Loss: 1.6131 | Train Acc: 0.4043
 Site-Indian_utk                (4) | Train Loss: 1.5658 | Train Acc: 0.4892
 Site-Indian_utk                (4) | Train Loss: 1.6150 | Train Acc: 0.4780
 Site-Black_utk                 (3) | Train Loss: 1.6603 | Train Acc: 0.4545
 Site-Black_utk                 (3) | Train Loss: 1.6445 | Train Acc: 0.4321
 Site-Black_utk                 (3) | Train Loss: 1.6681 | Train Acc: 0.4370
 Site-Southeast_Asian           (2) | Train Loss: 1.7847 | Train Acc: 0.3824
 Site-Southeast_Asian           (2) | Train Loss: 1.7867 | Train Acc: 0.3800
 Site-Asian_ffhq                (0) | Train Loss: 1.5893 | Train Acc: 0.6105
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.6009 | Train Acc: 0.5556
Average Train Accuracy: 0.4117
 Site-White_utk                 (5) | Val  Loss: 1.4485 | Val  Acc: 0.6250
 Site-White_utk                 (1) | Val  Loss: 1.6775 | Val  Acc: 0.2727
 Site-White_utk                 (1) | Val  Loss: 1.7274 | Val  Acc: 0.3529
 Site-White_utk                 (1) | Val  Loss: 1.6647 | Val  Acc: 0.2800
 Site-White_utk                 (1) | Val  Loss: 1.6333 | Val  Acc: 0.3243
 Site-White_utk                 (1) | Val  Loss: 1.7320 | Val  Acc: 0.3273
 Site-White_utk                 (1) | Val  Loss: 1.7217 | Val  Acc: 0.3210
 Site-White_utk                 (1) | Val  Loss: 1.7365 | Val  Acc: 0.3025
 Site-White_utk                 (1) | Val  Loss: 1.7322 | Val  Acc: 0.3657
 Site-White_utk                 (1) | Val  Loss: 1.8236 | Val  Acc: 0.3488
 Site-East_Asian                (2) | Val  Loss: 1.7776 | Val  Acc: 0.3333
 Site-East_Asian                (6) | Val  Loss: 1.6322 | Val  Acc: 0.4231
 Site-East_Asian                (2) | Val  Loss: 1.6004 | Val  Acc: 0.4359
 Site-East_Asian                (2) | Val  Loss: 1.6216 | Val  Acc: 0.4211
 Site-East_Asian                (2) | Val  Loss: 1.5887 | Val  Acc: 0.4824
 Site-East_Asian                (2) | Val  Loss: 1.6017 | Val  Acc: 0.4560
 Site-East_Asian                (2) | Val  Loss: 1.6096 | Val  Acc: 0.4402
 Site-Indian_utk                (4) | Val  Loss: 1.6636 | Val  Acc: 0.4483
 Site-Indian_utk                (4) | Val  Loss: 1.5238 | Val  Acc: 0.5349
 Site-Indian_utk                (4) | Val  Loss: 1.6339 | Val  Acc: 0.4444
 Site-Indian_utk                (4) | Val  Loss: 1.6571 | Val  Acc: 0.4239
 Site-Indian_utk                (4) | Val  Loss: 1.5048 | Val  Acc: 0.4485
 Site-Black_utk                 (3) | Val  Loss: 1.6696 | Val  Acc: 0.4722
 Site-Black_utk                 (3) | Val  Loss: 1.6858 | Val  Acc: 0.4074
 Site-Black_utk                 (3) | Val  Loss: 1.6126 | Val  Acc: 0.4051
 Site-Southeast_Asian           (2) | Val  Loss: 1.8872 | Val  Acc: 0.3676
 Site-Southeast_Asian           (2) | Val  Loss: 1.7370 | Val  Acc: 0.4000
 Site-Asian_ffhq                (0) | Val  Loss: 1.5932 | Val  Acc: 0.5739
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.9366 | Val  Acc: 0.1538
Average Valid Accuracy: 0.3997
============ Train epoch 17 ============
cnt=[11, 2, 2, 7, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-White_utk                 (0) | Train Loss: 1.4988 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.6189 | Train Acc: 0.4118
 Site-White_utk                 (0) | Train Loss: 1.6307 | Train Acc: 0.3462
 Site-White_utk                 (0) | Train Loss: 1.7977 | Train Acc: 0.2368
 Site-White_utk                 (0) | Train Loss: 1.6121 | Train Acc: 0.3929
 Site-White_utk                 (0) | Train Loss: 1.6761 | Train Acc: 0.4024
 Site-White_utk                 (0) | Train Loss: 1.6551 | Train Acc: 0.3802
 Site-White_utk                 (0) | Train Loss: 1.7447 | Train Acc: 0.3296
 Site-White_utk                 (0) | Train Loss: 1.7177 | Train Acc: 0.3764
 Site-White_utk                 (0) | Train Loss: 1.6883 | Train Acc: 0.4005
 Site-East_Asian                (3) | Train Loss: 1.5438 | Train Acc: 0.4444
 Site-East_Asian                (3) | Train Loss: 1.5327 | Train Acc: 0.5500
 Site-East_Asian                (3) | Train Loss: 1.6953 | Train Acc: 0.4068
 Site-East_Asian                (3) | Train Loss: 1.7539 | Train Acc: 0.4302
 Site-East_Asian                (3) | Train Loss: 1.6385 | Train Acc: 0.4567
 Site-East_Asian                (3) | Train Loss: 1.6389 | Train Acc: 0.4118
 Site-East_Asian                (3) | Train Loss: 1.5863 | Train Acc: 0.4493
 Site-Indian_utk                (4) | Train Loss: 1.5955 | Train Acc: 0.4651
 Site-Indian_utk                (4) | Train Loss: 1.5591 | Train Acc: 0.5156
 Site-Indian_utk                (4) | Train Loss: 1.5995 | Train Acc: 0.3936
 Site-Indian_utk                (4) | Train Loss: 1.6381 | Train Acc: 0.4604
 Site-Indian_utk                (4) | Train Loss: 1.5737 | Train Acc: 0.4634
 Site-Black_utk                 (6) | Train Loss: 1.6205 | Train Acc: 0.4909
 Site-Black_utk                 (0) | Train Loss: 1.6857 | Train Acc: 0.4444
 Site-Black_utk                 (0) | Train Loss: 1.6764 | Train Acc: 0.4286
 Site-Southeast_Asian           (1) | Train Loss: 1.8188 | Train Acc: 0.3627
 Site-Southeast_Asian           (1) | Train Loss: 1.7908 | Train Acc: 0.4200
 Site-Asian_ffhq                (2) | Train Loss: 1.6241 | Train Acc: 0.6337
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6334 | Train Acc: 0.5385
Average Train Accuracy: 0.4268
 Site-White_utk                 (0) | Val  Loss: 1.5809 | Val  Acc: 0.3750
 Site-White_utk                 (5) | Val  Loss: 1.6336 | Val  Acc: 0.3636
 Site-White_utk                 (0) | Val  Loss: 1.6621 | Val  Acc: 0.4118
 Site-White_utk                 (0) | Val  Loss: 1.6547 | Val  Acc: 0.4800
 Site-White_utk                 (0) | Val  Loss: 1.6350 | Val  Acc: 0.2973
 Site-White_utk                 (0) | Val  Loss: 1.7014 | Val  Acc: 0.3455
 Site-White_utk                 (0) | Val  Loss: 1.7063 | Val  Acc: 0.3827
 Site-White_utk                 (0) | Val  Loss: 1.6857 | Val  Acc: 0.3445
 Site-White_utk                 (0) | Val  Loss: 1.7490 | Val  Acc: 0.2971
 Site-White_utk                 (0) | Val  Loss: 1.8181 | Val  Acc: 0.3605
 Site-East_Asian                (3) | Val  Loss: 1.7056 | Val  Acc: 0.3889
 Site-East_Asian                (3) | Val  Loss: 1.5694 | Val  Acc: 0.4615
 Site-East_Asian                (3) | Val  Loss: 1.5497 | Val  Acc: 0.4872
 Site-East_Asian                (3) | Val  Loss: 1.6091 | Val  Acc: 0.4035
 Site-East_Asian                (3) | Val  Loss: 1.6093 | Val  Acc: 0.4706
 Site-East_Asian                (3) | Val  Loss: 1.5882 | Val  Acc: 0.4560
 Site-East_Asian                (3) | Val  Loss: 1.6222 | Val  Acc: 0.4511
 Site-Indian_utk                (4) | Val  Loss: 1.6130 | Val  Acc: 0.4138
 Site-Indian_utk                (4) | Val  Loss: 1.5297 | Val  Acc: 0.4884
 Site-Indian_utk                (4) | Val  Loss: 1.5893 | Val  Acc: 0.5079
 Site-Indian_utk                (4) | Val  Loss: 1.6752 | Val  Acc: 0.4565
 Site-Indian_utk                (4) | Val  Loss: 1.5029 | Val  Acc: 0.4559
 Site-Black_utk                 (6) | Val  Loss: 1.7187 | Val  Acc: 0.5278
 Site-Black_utk                 (0) | Val  Loss: 1.6845 | Val  Acc: 0.3889
 Site-Black_utk                 (0) | Val  Loss: 1.7118 | Val  Acc: 0.3544
 Site-Southeast_Asian           (1) | Val  Loss: 1.9618 | Val  Acc: 0.3235
 Site-Southeast_Asian           (1) | Val  Loss: 1.7189 | Val  Acc: 0.3700
 Site-Asian_ffhq                (2) | Val  Loss: 1.6226 | Val  Acc: 0.5652
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9094 | Val  Acc: 0.1282
Average Valid Accuracy: 0.4054
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.3750
 Best site-White_utk                (5)  | Epoch:17 | Val Acc: 0.3636
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.4118
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.4800
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.2973
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.3455
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.3827
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.3445
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.2971
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.3605
 Best site-East_Asian               (3)  | Epoch:17 | Val Acc: 0.3889
 Best site-East_Asian               (3)  | Epoch:17 | Val Acc: 0.4615
 Best site-East_Asian               (3)  | Epoch:17 | Val Acc: 0.4872
 Best site-East_Asian               (3)  | Epoch:17 | Val Acc: 0.4035
 Best site-East_Asian               (3)  | Epoch:17 | Val Acc: 0.4706
 Best site-East_Asian               (3)  | Epoch:17 | Val Acc: 0.4560
 Best site-East_Asian               (3)  | Epoch:17 | Val Acc: 0.4511
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.4138
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.4884
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.5079
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.4565
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.4559
 Best site-Black_utk                (6)  | Epoch:17 | Val Acc: 0.5278
 Best site-Black_utk                (0)  | Epoch:17 | Val Acc: 0.3889
 Best site-Black_utk                (0)  | Epoch:17 | Val Acc: 0.3544
 Best site-Southeast_Asian          (1)  | Epoch:17 | Val Acc: 0.3235
 Best site-Southeast_Asian          (1)  | Epoch:17 | Val Acc: 0.3700
 Best site-Asian_ffhq               (2)  | Epoch:17 | Val Acc: 0.5652
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:17 | Val Acc: 0.1282
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 9, 2, 7, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-White_utk                 (1) | Train Loss: 1.4416 | Train Acc: 0.4167
 Site-White_utk                 (1) | Train Loss: 1.6712 | Train Acc: 0.4118
 Site-White_utk                 (1) | Train Loss: 1.6136 | Train Acc: 0.5000
 Site-White_utk                 (1) | Train Loss: 1.7561 | Train Acc: 0.2368
 Site-White_utk                 (6) | Train Loss: 1.6146 | Train Acc: 0.3750
 Site-White_utk                 (1) | Train Loss: 1.6881 | Train Acc: 0.3537
 Site-White_utk                 (1) | Train Loss: 1.6579 | Train Acc: 0.3306
 Site-White_utk                 (1) | Train Loss: 1.7180 | Train Acc: 0.3631
 Site-White_utk                 (1) | Train Loss: 1.6847 | Train Acc: 0.3764
 Site-White_utk                 (1) | Train Loss: 1.6754 | Train Acc: 0.4186
 Site-East_Asian                (3) | Train Loss: 1.5274 | Train Acc: 0.4074
 Site-East_Asian                (0) | Train Loss: 1.5338 | Train Acc: 0.5250
 Site-East_Asian                (0) | Train Loss: 1.6945 | Train Acc: 0.3898
 Site-East_Asian                (3) | Train Loss: 1.6197 | Train Acc: 0.4186
 Site-East_Asian                (3) | Train Loss: 1.6369 | Train Acc: 0.4724
 Site-East_Asian                (3) | Train Loss: 1.6237 | Train Acc: 0.4171
 Site-East_Asian                (3) | Train Loss: 1.5857 | Train Acc: 0.4420
 Site-Indian_utk                (4) | Train Loss: 1.6409 | Train Acc: 0.4419
 Site-Indian_utk                (4) | Train Loss: 1.5743 | Train Acc: 0.4844
 Site-Indian_utk                (4) | Train Loss: 1.6081 | Train Acc: 0.3830
 Site-Indian_utk                (4) | Train Loss: 1.6264 | Train Acc: 0.4676
 Site-Indian_utk                (4) | Train Loss: 1.6120 | Train Acc: 0.4390
 Site-Black_utk                 (5) | Train Loss: 1.6290 | Train Acc: 0.5091
 Site-Black_utk                 (5) | Train Loss: 1.6939 | Train Acc: 0.4444
 Site-Black_utk                 (5) | Train Loss: 1.7063 | Train Acc: 0.3866
 Site-Southeast_Asian           (3) | Train Loss: 1.7329 | Train Acc: 0.3627
 Site-Southeast_Asian           (3) | Train Loss: 1.7169 | Train Acc: 0.3800
 Site-Asian_ffhq                (2) | Train Loss: 1.6370 | Train Acc: 0.6047
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6248 | Train Acc: 0.5385
Average Train Accuracy: 0.4240
 Site-White_utk                 (1) | Val  Loss: 1.4858 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.6666 | Val  Acc: 0.2727
 Site-White_utk                 (1) | Val  Loss: 1.6961 | Val  Acc: 0.4706
 Site-White_utk                 (1) | Val  Loss: 1.6501 | Val  Acc: 0.3600
 Site-White_utk                 (6) | Val  Loss: 1.6196 | Val  Acc: 0.2703
 Site-White_utk                 (1) | Val  Loss: 1.7127 | Val  Acc: 0.3636
 Site-White_utk                 (1) | Val  Loss: 1.7075 | Val  Acc: 0.2963
 Site-White_utk                 (1) | Val  Loss: 1.6931 | Val  Acc: 0.3277
 Site-White_utk                 (1) | Val  Loss: 1.7275 | Val  Acc: 0.3486
 Site-White_utk                 (1) | Val  Loss: 1.7834 | Val  Acc: 0.3566
 Site-East_Asian                (3) | Val  Loss: 1.7213 | Val  Acc: 0.3333
 Site-East_Asian                (0) | Val  Loss: 1.5204 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.5830 | Val  Acc: 0.4615
 Site-East_Asian                (3) | Val  Loss: 1.5824 | Val  Acc: 0.4561
 Site-East_Asian                (3) | Val  Loss: 1.6045 | Val  Acc: 0.4824
 Site-East_Asian                (3) | Val  Loss: 1.5957 | Val  Acc: 0.4560
 Site-East_Asian                (3) | Val  Loss: 1.6004 | Val  Acc: 0.4565
 Site-Indian_utk                (4) | Val  Loss: 1.6008 | Val  Acc: 0.4138
 Site-Indian_utk                (4) | Val  Loss: 1.4778 | Val  Acc: 0.5581
 Site-Indian_utk                (4) | Val  Loss: 1.6163 | Val  Acc: 0.4762
 Site-Indian_utk                (4) | Val  Loss: 1.6460 | Val  Acc: 0.4457
 Site-Indian_utk                (4) | Val  Loss: 1.4903 | Val  Acc: 0.4338
 Site-Black_utk                 (5) | Val  Loss: 1.6532 | Val  Acc: 0.5000
 Site-Black_utk                 (5) | Val  Loss: 1.7475 | Val  Acc: 0.3519
 Site-Black_utk                 (5) | Val  Loss: 1.6342 | Val  Acc: 0.4177
 Site-Southeast_Asian           (3) | Val  Loss: 1.7127 | Val  Acc: 0.3824
 Site-Southeast_Asian           (3) | Val  Loss: 1.7420 | Val  Acc: 0.4000
 Site-Asian_ffhq                (2) | Val  Loss: 1.6910 | Val  Acc: 0.5391
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8917 | Val  Acc: 0.1026
Average Valid Accuracy: 0.4033
============ Train epoch 19 ============
cnt=[10, 2, 5, 1, 7, 1, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-White_utk                 (0) | Train Loss: 1.4405 | Train Acc: 0.2500
 Site-White_utk                 (0) | Train Loss: 1.6005 | Train Acc: 0.4118
 Site-White_utk                 (0) | Train Loss: 1.6082 | Train Acc: 0.4231
 Site-White_utk                 (0) | Train Loss: 1.7501 | Train Acc: 0.2895
 Site-White_utk                 (0) | Train Loss: 1.6503 | Train Acc: 0.3929
 Site-White_utk                 (0) | Train Loss: 1.6834 | Train Acc: 0.4146
 Site-White_utk                 (0) | Train Loss: 1.6418 | Train Acc: 0.3719
 Site-White_utk                 (0) | Train Loss: 1.6977 | Train Acc: 0.3743
 Site-White_utk                 (0) | Train Loss: 1.6922 | Train Acc: 0.3878
 Site-White_utk                 (0) | Train Loss: 1.6202 | Train Acc: 0.4444
 Site-East_Asian                (4) | Train Loss: 1.4781 | Train Acc: 0.5185
 Site-East_Asian                (4) | Train Loss: 1.5230 | Train Acc: 0.5250
 Site-East_Asian                (4) | Train Loss: 1.7090 | Train Acc: 0.3559
 Site-East_Asian                (4) | Train Loss: 1.6849 | Train Acc: 0.4070
 Site-East_Asian                (4) | Train Loss: 1.5875 | Train Acc: 0.4646
 Site-East_Asian                (4) | Train Loss: 1.6244 | Train Acc: 0.4332
 Site-East_Asian                (4) | Train Loss: 1.5794 | Train Acc: 0.4457
 Site-Indian_utk                (2) | Train Loss: 1.5951 | Train Acc: 0.4651
 Site-Indian_utk                (2) | Train Loss: 1.5705 | Train Acc: 0.5000
 Site-Indian_utk                (2) | Train Loss: 1.6208 | Train Acc: 0.3830
 Site-Indian_utk                (2) | Train Loss: 1.7065 | Train Acc: 0.4532
 Site-Indian_utk                (2) | Train Loss: 1.6093 | Train Acc: 0.4537
 Site-Black_utk                 (6) | Train Loss: 1.5902 | Train Acc: 0.5091
 Site-Black_utk                 (6) | Train Loss: 1.7288 | Train Acc: 0.3827
 Site-Black_utk                 (6) | Train Loss: 1.6555 | Train Acc: 0.4454
 Site-Southeast_Asian           (1) | Train Loss: 1.7556 | Train Acc: 0.3922
 Site-Southeast_Asian           (1) | Train Loss: 1.7254 | Train Acc: 0.3800
 Site-Asian_ffhq                (5) | Train Loss: 1.6469 | Train Acc: 0.5698
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6356 | Train Acc: 0.5641
Average Train Accuracy: 0.4279
 Site-White_utk                 (0) | Val  Loss: 1.5130 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.5557 | Val  Acc: 0.5455
 Site-White_utk                 (0) | Val  Loss: 1.5808 | Val  Acc: 0.4118
 Site-White_utk                 (0) | Val  Loss: 1.6018 | Val  Acc: 0.5200
 Site-White_utk                 (0) | Val  Loss: 1.6167 | Val  Acc: 0.3243
 Site-White_utk                 (0) | Val  Loss: 1.6941 | Val  Acc: 0.3818
 Site-White_utk                 (0) | Val  Loss: 1.7340 | Val  Acc: 0.3333
 Site-White_utk                 (0) | Val  Loss: 1.6907 | Val  Acc: 0.3361
 Site-White_utk                 (0) | Val  Loss: 1.7163 | Val  Acc: 0.3600
 Site-White_utk                 (0) | Val  Loss: 1.7464 | Val  Acc: 0.3682
 Site-East_Asian                (4) | Val  Loss: 1.7121 | Val  Acc: 0.3889
 Site-East_Asian                (4) | Val  Loss: 1.5395 | Val  Acc: 0.4615
 Site-East_Asian                (4) | Val  Loss: 1.5565 | Val  Acc: 0.4615
 Site-East_Asian                (4) | Val  Loss: 1.5931 | Val  Acc: 0.4386
 Site-East_Asian                (4) | Val  Loss: 1.6289 | Val  Acc: 0.4706
 Site-East_Asian                (4) | Val  Loss: 1.5776 | Val  Acc: 0.4560
 Site-East_Asian                (4) | Val  Loss: 1.6332 | Val  Acc: 0.4402
 Site-Indian_utk                (2) | Val  Loss: 1.5831 | Val  Acc: 0.5172
 Site-Indian_utk                (2) | Val  Loss: 1.5036 | Val  Acc: 0.5349
 Site-Indian_utk                (2) | Val  Loss: 1.5956 | Val  Acc: 0.4127
 Site-Indian_utk                (2) | Val  Loss: 1.6820 | Val  Acc: 0.4022
 Site-Indian_utk                (2) | Val  Loss: 1.5108 | Val  Acc: 0.4191
 Site-Black_utk                 (6) | Val  Loss: 1.6116 | Val  Acc: 0.5278
 Site-Black_utk                 (6) | Val  Loss: 1.6880 | Val  Acc: 0.3889
 Site-Black_utk                 (6) | Val  Loss: 1.6379 | Val  Acc: 0.3797
 Site-Southeast_Asian           (1) | Val  Loss: 1.8324 | Val  Acc: 0.3529
 Site-Southeast_Asian           (1) | Val  Loss: 1.7091 | Val  Acc: 0.3900
 Site-Asian_ffhq                (5) | Val  Loss: 1.6781 | Val  Acc: 0.4870
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8739 | Val  Acc: 0.1667
Average Valid Accuracy: 0.4199
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.5000
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.5455
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.4118
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.5200
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.3243
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.3818
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.3333
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.3361
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.3600
 Best site-White_utk                (0)  | Epoch:19 | Val Acc: 0.3682
 Best site-East_Asian               (4)  | Epoch:19 | Val Acc: 0.3889
 Best site-East_Asian               (4)  | Epoch:19 | Val Acc: 0.4615
 Best site-East_Asian               (4)  | Epoch:19 | Val Acc: 0.4615
 Best site-East_Asian               (4)  | Epoch:19 | Val Acc: 0.4386
 Best site-East_Asian               (4)  | Epoch:19 | Val Acc: 0.4706
 Best site-East_Asian               (4)  | Epoch:19 | Val Acc: 0.4560
 Best site-East_Asian               (4)  | Epoch:19 | Val Acc: 0.4402
 Best site-Indian_utk               (2)  | Epoch:19 | Val Acc: 0.5172
 Best site-Indian_utk               (2)  | Epoch:19 | Val Acc: 0.5349
 Best site-Indian_utk               (2)  | Epoch:19 | Val Acc: 0.4127
 Best site-Indian_utk               (2)  | Epoch:19 | Val Acc: 0.4022
 Best site-Indian_utk               (2)  | Epoch:19 | Val Acc: 0.4191
 Best site-Black_utk                (6)  | Epoch:19 | Val Acc: 0.5278
 Best site-Black_utk                (6)  | Epoch:19 | Val Acc: 0.3889
 Best site-Black_utk                (6)  | Epoch:19 | Val Acc: 0.3797
 Best site-Southeast_Asian          (1)  | Epoch:19 | Val Acc: 0.3529
 Best site-Southeast_Asian          (1)  | Epoch:19 | Val Acc: 0.3900
 Best site-Asian_ffhq               (5)  | Epoch:19 | Val Acc: 0.4870
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:19 | Val Acc: 0.1667
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Test site-White_utk                 (0)| Epoch:19 | Test Acc: 0.3607
 Test site-East_Asian                (4)| Epoch:19 | Test Acc: 0.4706
 Test site-Indian_utk                (2)| Epoch:19 | Test Acc: 0.4479
 Test site-Black_utk                 (6)| Epoch:19 | Test Acc: 0.3520
 Test site-Southeast_Asian           (1)| Epoch:19 | Test Acc: 0.4090
 Test site-Asian_ffhq                (5)| Epoch:19 | Test Acc: 0.2132
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:19 | Test Acc: 0.2338
White_utk: 0.3607, East_Asian: 0.4706, Indian_utk: 0.4479, Black_utk: 0.3520, Southeast_Asian: 0.4090, Asian_ffhq: 0.2132, Latino_Hispanic_ffhq: 0.2338, 
Average Test Accuracy(group): 0.3553, Average Test Accuracy(individual): 0.3953,
domain std=0.0924, cluster std=0.0924, individual std=0.0671, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 3, 1, 8, 2, 5, 9, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-White_utk                 (6) | Train Loss: 1.4611 | Train Acc: 0.3333
 Site-White_utk                 (6) | Train Loss: 1.6069 | Train Acc: 0.3529
 Site-White_utk                 (6) | Train Loss: 1.6047 | Train Acc: 0.4231
 Site-White_utk                 (6) | Train Loss: 1.7417 | Train Acc: 0.2632
 Site-White_utk                 (0) | Train Loss: 1.5992 | Train Acc: 0.4107
 Site-White_utk                 (6) | Train Loss: 1.5688 | Train Acc: 0.4146
 Site-White_utk                 (6) | Train Loss: 1.6375 | Train Acc: 0.3471
 Site-White_utk                 (6) | Train Loss: 1.7166 | Train Acc: 0.3352
 Site-White_utk                 (6) | Train Loss: 1.6577 | Train Acc: 0.3612
 Site-White_utk                 (6) | Train Loss: 1.6023 | Train Acc: 0.4186
 Site-East_Asian                (3) | Train Loss: 1.4706 | Train Acc: 0.4444
 Site-East_Asian                (3) | Train Loss: 1.5256 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.7305 | Train Acc: 0.3729
 Site-East_Asian                (3) | Train Loss: 1.6218 | Train Acc: 0.4186
 Site-East_Asian                (3) | Train Loss: 1.6029 | Train Acc: 0.4409
 Site-East_Asian                (3) | Train Loss: 1.6297 | Train Acc: 0.4118
 Site-East_Asian                (3) | Train Loss: 1.5553 | Train Acc: 0.4529
 Site-Indian_utk                (5) | Train Loss: 1.5774 | Train Acc: 0.4884
 Site-Indian_utk                (5) | Train Loss: 1.5450 | Train Acc: 0.4844
 Site-Indian_utk                (5) | Train Loss: 1.5755 | Train Acc: 0.4468
 Site-Indian_utk                (5) | Train Loss: 1.6152 | Train Acc: 0.4964
 Site-Indian_utk                (5) | Train Loss: 1.5423 | Train Acc: 0.4878
 Site-Black_utk                 (1) | Train Loss: 1.6071 | Train Acc: 0.4545
 Site-Black_utk                 (1) | Train Loss: 1.5981 | Train Acc: 0.3951
 Site-Black_utk                 (1) | Train Loss: 1.6788 | Train Acc: 0.4538
 Site-Southeast_Asian           (3) | Train Loss: 1.8114 | Train Acc: 0.3922
 Site-Southeast_Asian           (3) | Train Loss: 1.6720 | Train Acc: 0.4067
 Site-Asian_ffhq                (4) | Train Loss: 1.6013 | Train Acc: 0.6047
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6141 | Train Acc: 0.5641
Average Train Accuracy: 0.4268
 Site-White_utk                 (6) | Val  Loss: 1.4109 | Val  Acc: 0.5000
 Site-White_utk                 (6) | Val  Loss: 1.5506 | Val  Acc: 0.4545
 Site-White_utk                 (6) | Val  Loss: 1.6443 | Val  Acc: 0.3529
 Site-White_utk                 (6) | Val  Loss: 1.6247 | Val  Acc: 0.4800
 Site-White_utk                 (0) | Val  Loss: 1.6379 | Val  Acc: 0.3243
 Site-White_utk                 (6) | Val  Loss: 1.6321 | Val  Acc: 0.3636
 Site-White_utk                 (6) | Val  Loss: 1.7891 | Val  Acc: 0.3086
 Site-White_utk                 (6) | Val  Loss: 1.6644 | Val  Acc: 0.3529
 Site-White_utk                 (6) | Val  Loss: 1.7044 | Val  Acc: 0.3486
 Site-White_utk                 (6) | Val  Loss: 1.7701 | Val  Acc: 0.3721
 Site-East_Asian                (3) | Val  Loss: 1.7465 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.5284 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.5429 | Val  Acc: 0.4359
 Site-East_Asian                (3) | Val  Loss: 1.5767 | Val  Acc: 0.4211
 Site-East_Asian                (3) | Val  Loss: 1.5845 | Val  Acc: 0.4824
 Site-East_Asian                (3) | Val  Loss: 1.5856 | Val  Acc: 0.4640
 Site-East_Asian                (3) | Val  Loss: 1.6034 | Val  Acc: 0.4402
 Site-Indian_utk                (5) | Val  Loss: 1.5802 | Val  Acc: 0.3793
 Site-Indian_utk                (5) | Val  Loss: 1.5319 | Val  Acc: 0.4419
 Site-Indian_utk                (5) | Val  Loss: 1.5624 | Val  Acc: 0.4762
 Site-Indian_utk                (5) | Val  Loss: 1.6548 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.5150 | Val  Acc: 0.4559
 Site-Black_utk                 (1) | Val  Loss: 1.6680 | Val  Acc: 0.4722
 Site-Black_utk                 (1) | Val  Loss: 1.6452 | Val  Acc: 0.4630
 Site-Black_utk                 (1) | Val  Loss: 1.6038 | Val  Acc: 0.4177
 Site-Southeast_Asian           (3) | Val  Loss: 1.8192 | Val  Acc: 0.3971
 Site-Southeast_Asian           (3) | Val  Loss: 1.7226 | Val  Acc: 0.4000
 Site-Asian_ffhq                (4) | Val  Loss: 1.6271 | Val  Acc: 0.5826
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8798 | Val  Acc: 0.1282
Average Valid Accuracy: 0.4141
============ Train epoch 21 ============
cnt=[9, 1, 9, 2, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-White_utk                 (1) | Train Loss: 1.4896 | Train Acc: 0.2500
 Site-White_utk                 (2) | Train Loss: 1.6408 | Train Acc: 0.3529
 Site-White_utk                 (2) | Train Loss: 1.6026 | Train Acc: 0.4231
 Site-White_utk                 (2) | Train Loss: 1.7365 | Train Acc: 0.3158
 Site-White_utk                 (2) | Train Loss: 1.5762 | Train Acc: 0.4643
 Site-White_utk                 (2) | Train Loss: 1.5136 | Train Acc: 0.4878
 Site-White_utk                 (2) | Train Loss: 1.5863 | Train Acc: 0.3967
 Site-White_utk                 (2) | Train Loss: 1.7257 | Train Acc: 0.3296
 Site-White_utk                 (2) | Train Loss: 1.6801 | Train Acc: 0.3460
 Site-White_utk                 (2) | Train Loss: 1.6458 | Train Acc: 0.4341
 Site-East_Asian                (0) | Train Loss: 1.4877 | Train Acc: 0.4444
 Site-East_Asian                (0) | Train Loss: 1.5169 | Train Acc: 0.5000
 Site-East_Asian                (0) | Train Loss: 1.6946 | Train Acc: 0.3729
 Site-East_Asian                (0) | Train Loss: 1.6741 | Train Acc: 0.3953
 Site-East_Asian                (0) | Train Loss: 1.6014 | Train Acc: 0.4646
 Site-East_Asian                (0) | Train Loss: 1.6281 | Train Acc: 0.4064
 Site-East_Asian                (0) | Train Loss: 1.5851 | Train Acc: 0.4457
 Site-Indian_utk                (5) | Train Loss: 1.6072 | Train Acc: 0.4419
 Site-Indian_utk                (6) | Train Loss: 1.5350 | Train Acc: 0.5156
 Site-Indian_utk                (6) | Train Loss: 1.5791 | Train Acc: 0.4149
 Site-Indian_utk                (6) | Train Loss: 1.5748 | Train Acc: 0.4604
 Site-Indian_utk                (6) | Train Loss: 1.5680 | Train Acc: 0.4878
 Site-Black_utk                 (4) | Train Loss: 1.6241 | Train Acc: 0.4727
 Site-Black_utk                 (4) | Train Loss: 1.6704 | Train Acc: 0.3580
 Site-Black_utk                 (4) | Train Loss: 1.6303 | Train Acc: 0.4538
 Site-Southeast_Asian           (0) | Train Loss: 1.6971 | Train Acc: 0.3922
 Site-Southeast_Asian           (0) | Train Loss: 1.7130 | Train Acc: 0.3867
 Site-Asian_ffhq                (3) | Train Loss: 1.5773 | Train Acc: 0.6221
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.5748 | Train Acc: 0.5556
Average Train Accuracy: 0.4273
 Site-White_utk                 (1) | Val  Loss: 1.4512 | Val  Acc: 0.6250
 Site-White_utk                 (2) | Val  Loss: 1.6082 | Val  Acc: 0.3636
 Site-White_utk                 (2) | Val  Loss: 1.6339 | Val  Acc: 0.2353
 Site-White_utk                 (2) | Val  Loss: 1.5793 | Val  Acc: 0.4400
 Site-White_utk                 (2) | Val  Loss: 1.6069 | Val  Acc: 0.3514
 Site-White_utk                 (2) | Val  Loss: 1.6808 | Val  Acc: 0.3273
 Site-White_utk                 (2) | Val  Loss: 1.7006 | Val  Acc: 0.3333
 Site-White_utk                 (2) | Val  Loss: 1.6174 | Val  Acc: 0.3950
 Site-White_utk                 (2) | Val  Loss: 1.7355 | Val  Acc: 0.3143
 Site-White_utk                 (2) | Val  Loss: 1.7488 | Val  Acc: 0.3643
 Site-East_Asian                (0) | Val  Loss: 1.6921 | Val  Acc: 0.3333
 Site-East_Asian                (0) | Val  Loss: 1.5221 | Val  Acc: 0.4231
 Site-East_Asian                (0) | Val  Loss: 1.5398 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.5471 | Val  Acc: 0.4386
 Site-East_Asian                (0) | Val  Loss: 1.5778 | Val  Acc: 0.4824
 Site-East_Asian                (0) | Val  Loss: 1.5697 | Val  Acc: 0.4640
 Site-East_Asian                (0) | Val  Loss: 1.5821 | Val  Acc: 0.4293
 Site-Indian_utk                (5) | Val  Loss: 1.5719 | Val  Acc: 0.4828
 Site-Indian_utk                (6) | Val  Loss: 1.4523 | Val  Acc: 0.5116
 Site-Indian_utk                (6) | Val  Loss: 1.5703 | Val  Acc: 0.4286
 Site-Indian_utk                (6) | Val  Loss: 1.6065 | Val  Acc: 0.5000
 Site-Indian_utk                (6) | Val  Loss: 1.4727 | Val  Acc: 0.4118
 Site-Black_utk                 (4) | Val  Loss: 1.6382 | Val  Acc: 0.5000
 Site-Black_utk                 (4) | Val  Loss: 1.6846 | Val  Acc: 0.3704
 Site-Black_utk                 (4) | Val  Loss: 1.5581 | Val  Acc: 0.4304
 Site-Southeast_Asian           (0) | Val  Loss: 1.7712 | Val  Acc: 0.3971
 Site-Southeast_Asian           (0) | Val  Loss: 1.7126 | Val  Acc: 0.3800
 Site-Asian_ffhq                (3) | Val  Loss: 1.6108 | Val  Acc: 0.5217
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.9201 | Val  Acc: 0.1282
Average Valid Accuracy: 0.4084
============ Train epoch 22 ============
cnt=[9, 8, 2, 3, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-White_utk                 (5) | Train Loss: 1.4344 | Train Acc: 0.4167
 Site-White_utk                 (6) | Train Loss: 1.6309 | Train Acc: 0.3529
 Site-White_utk                 (1) | Train Loss: 1.5305 | Train Acc: 0.4615
 Site-White_utk                 (1) | Train Loss: 1.7431 | Train Acc: 0.2368
 Site-White_utk                 (1) | Train Loss: 1.5896 | Train Acc: 0.4286
 Site-White_utk                 (1) | Train Loss: 1.6236 | Train Acc: 0.4146
 Site-White_utk                 (1) | Train Loss: 1.5853 | Train Acc: 0.4050
 Site-White_utk                 (1) | Train Loss: 1.6976 | Train Acc: 0.3799
 Site-White_utk                 (1) | Train Loss: 1.5704 | Train Acc: 0.4144
 Site-White_utk                 (1) | Train Loss: 1.6055 | Train Acc: 0.4264
 Site-East_Asian                (0) | Train Loss: 1.4946 | Train Acc: 0.4815
 Site-East_Asian                (0) | Train Loss: 1.4586 | Train Acc: 0.5000
 Site-East_Asian                (0) | Train Loss: 1.7020 | Train Acc: 0.3729
 Site-East_Asian                (0) | Train Loss: 1.6774 | Train Acc: 0.4186
 Site-East_Asian                (0) | Train Loss: 1.6126 | Train Acc: 0.4646
 Site-East_Asian                (0) | Train Loss: 1.6094 | Train Acc: 0.4225
 Site-East_Asian                (0) | Train Loss: 1.5914 | Train Acc: 0.4348
 Site-Indian_utk                (4) | Train Loss: 1.5892 | Train Acc: 0.4884
 Site-Indian_utk                (4) | Train Loss: 1.5120 | Train Acc: 0.5469
 Site-Indian_utk                (4) | Train Loss: 1.6133 | Train Acc: 0.4043
 Site-Indian_utk                (4) | Train Loss: 1.5810 | Train Acc: 0.4748
 Site-Indian_utk                (4) | Train Loss: 1.5378 | Train Acc: 0.4927
 Site-Black_utk                 (3) | Train Loss: 1.6073 | Train Acc: 0.4909
 Site-Black_utk                 (3) | Train Loss: 1.7626 | Train Acc: 0.4198
 Site-Black_utk                 (3) | Train Loss: 1.6658 | Train Acc: 0.4286
 Site-Southeast_Asian           (0) | Train Loss: 1.7281 | Train Acc: 0.4216
 Site-Southeast_Asian           (0) | Train Loss: 1.7267 | Train Acc: 0.3867
 Site-Asian_ffhq                (2) | Train Loss: 1.6061 | Train Acc: 0.6453
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6486 | Train Acc: 0.5726
Average Train Accuracy: 0.4415
 Site-White_utk                 (5) | Val  Loss: 1.4039 | Val  Acc: 0.5000
 Site-White_utk                 (6) | Val  Loss: 1.5852 | Val  Acc: 0.4545
 Site-White_utk                 (1) | Val  Loss: 1.6168 | Val  Acc: 0.4706
 Site-White_utk                 (1) | Val  Loss: 1.6432 | Val  Acc: 0.4000
 Site-White_utk                 (1) | Val  Loss: 1.5750 | Val  Acc: 0.3243
 Site-White_utk                 (1) | Val  Loss: 1.6139 | Val  Acc: 0.3091
 Site-White_utk                 (1) | Val  Loss: 1.7142 | Val  Acc: 0.3704
 Site-White_utk                 (1) | Val  Loss: 1.6381 | Val  Acc: 0.3866
 Site-White_utk                 (1) | Val  Loss: 1.6936 | Val  Acc: 0.3657
 Site-White_utk                 (1) | Val  Loss: 1.7422 | Val  Acc: 0.3605
 Site-East_Asian                (0) | Val  Loss: 1.7566 | Val  Acc: 0.2778
 Site-East_Asian                (0) | Val  Loss: 1.4814 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.5363 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.6009 | Val  Acc: 0.4211
 Site-East_Asian                (0) | Val  Loss: 1.6222 | Val  Acc: 0.4824
 Site-East_Asian                (0) | Val  Loss: 1.5819 | Val  Acc: 0.4640
 Site-East_Asian                (0) | Val  Loss: 1.6250 | Val  Acc: 0.4511
 Site-Indian_utk                (4) | Val  Loss: 1.6191 | Val  Acc: 0.4828
 Site-Indian_utk                (4) | Val  Loss: 1.4809 | Val  Acc: 0.4884
 Site-Indian_utk                (4) | Val  Loss: 1.5816 | Val  Acc: 0.4603
 Site-Indian_utk                (4) | Val  Loss: 1.6057 | Val  Acc: 0.4565
 Site-Indian_utk                (4) | Val  Loss: 1.4495 | Val  Acc: 0.4265
 Site-Black_utk                 (3) | Val  Loss: 1.6280 | Val  Acc: 0.5000
 Site-Black_utk                 (3) | Val  Loss: 1.6302 | Val  Acc: 0.4074
 Site-Black_utk                 (3) | Val  Loss: 1.6063 | Val  Acc: 0.4430
 Site-Southeast_Asian           (0) | Val  Loss: 1.8279 | Val  Acc: 0.3676
 Site-Southeast_Asian           (0) | Val  Loss: 1.6968 | Val  Acc: 0.3800
 Site-Asian_ffhq                (2) | Val  Loss: 1.6402 | Val  Acc: 0.5304
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9476 | Val  Acc: 0.1410
Average Valid Accuracy: 0.4167
============ Train epoch 23 ============
cnt=[8, 9, 1, 1, 1, 1, 8, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-White_utk                 (3) | Train Loss: 1.4081 | Train Acc: 0.4167
 Site-White_utk                 (6) | Train Loss: 1.5595 | Train Acc: 0.4118
 Site-White_utk                 (6) | Train Loss: 1.6091 | Train Acc: 0.4231
 Site-White_utk                 (6) | Train Loss: 1.6608 | Train Acc: 0.2632
 Site-White_utk                 (6) | Train Loss: 1.5696 | Train Acc: 0.4286
 Site-White_utk                 (0) | Train Loss: 1.5906 | Train Acc: 0.3780
 Site-White_utk                 (6) | Train Loss: 1.6207 | Train Acc: 0.3471
 Site-White_utk                 (6) | Train Loss: 1.6864 | Train Acc: 0.3352
 Site-White_utk                 (6) | Train Loss: 1.5714 | Train Acc: 0.3840
 Site-White_utk                 (6) | Train Loss: 1.5774 | Train Acc: 0.4238
 Site-East_Asian                (1) | Train Loss: 1.4619 | Train Acc: 0.4444
 Site-East_Asian                (1) | Train Loss: 1.4457 | Train Acc: 0.5250
 Site-East_Asian                (1) | Train Loss: 1.6512 | Train Acc: 0.3898
 Site-East_Asian                (1) | Train Loss: 1.6099 | Train Acc: 0.3837
 Site-East_Asian                (1) | Train Loss: 1.5943 | Train Acc: 0.4488
 Site-East_Asian                (1) | Train Loss: 1.6132 | Train Acc: 0.4011
 Site-East_Asian                (1) | Train Loss: 1.5808 | Train Acc: 0.4384
 Site-Indian_utk                (5) | Train Loss: 1.5405 | Train Acc: 0.5116
 Site-Indian_utk                (0) | Train Loss: 1.5850 | Train Acc: 0.4531
 Site-Indian_utk                (0) | Train Loss: 1.5490 | Train Acc: 0.4468
 Site-Indian_utk                (0) | Train Loss: 1.5810 | Train Acc: 0.4676
 Site-Indian_utk                (0) | Train Loss: 1.5632 | Train Acc: 0.4780
 Site-Black_utk                 (0) | Train Loss: 1.5650 | Train Acc: 0.4727
 Site-Black_utk                 (0) | Train Loss: 1.5916 | Train Acc: 0.4074
 Site-Black_utk                 (0) | Train Loss: 1.6602 | Train Acc: 0.4118
 Site-Southeast_Asian           (1) | Train Loss: 1.7682 | Train Acc: 0.4118
 Site-Southeast_Asian           (1) | Train Loss: 1.7315 | Train Acc: 0.3867
 Site-Asian_ffhq                (4) | Train Loss: 1.5938 | Train Acc: 0.6105
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5899 | Train Acc: 0.5641
Average Train Accuracy: 0.4298
 Site-White_utk                 (3) | Val  Loss: 1.3435 | Val  Acc: 0.6250
 Site-White_utk                 (6) | Val  Loss: 1.5727 | Val  Acc: 0.3636
 Site-White_utk                 (6) | Val  Loss: 1.6818 | Val  Acc: 0.2941
 Site-White_utk                 (6) | Val  Loss: 1.5714 | Val  Acc: 0.3600
 Site-White_utk                 (6) | Val  Loss: 1.5951 | Val  Acc: 0.3514
 Site-White_utk                 (0) | Val  Loss: 1.6363 | Val  Acc: 0.3818
 Site-White_utk                 (6) | Val  Loss: 1.6908 | Val  Acc: 0.3580
 Site-White_utk                 (6) | Val  Loss: 1.6322 | Val  Acc: 0.3697
 Site-White_utk                 (6) | Val  Loss: 1.6997 | Val  Acc: 0.3829
 Site-White_utk                 (6) | Val  Loss: 1.7201 | Val  Acc: 0.3721
 Site-East_Asian                (1) | Val  Loss: 1.6542 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.4643 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.5418 | Val  Acc: 0.4359
 Site-East_Asian                (1) | Val  Loss: 1.5415 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.5788 | Val  Acc: 0.4824
 Site-East_Asian                (1) | Val  Loss: 1.5681 | Val  Acc: 0.4400
 Site-East_Asian                (1) | Val  Loss: 1.5881 | Val  Acc: 0.4457
 Site-Indian_utk                (5) | Val  Loss: 1.6001 | Val  Acc: 0.4483
 Site-Indian_utk                (0) | Val  Loss: 1.4460 | Val  Acc: 0.5581
 Site-Indian_utk                (0) | Val  Loss: 1.5690 | Val  Acc: 0.4921
 Site-Indian_utk                (0) | Val  Loss: 1.6253 | Val  Acc: 0.4783
 Site-Indian_utk                (0) | Val  Loss: 1.4775 | Val  Acc: 0.4412
 Site-Black_utk                 (0) | Val  Loss: 1.6599 | Val  Acc: 0.4444
 Site-Black_utk                 (0) | Val  Loss: 1.6941 | Val  Acc: 0.4074
 Site-Black_utk                 (0) | Val  Loss: 1.5903 | Val  Acc: 0.4177
 Site-Southeast_Asian           (1) | Val  Loss: 1.7796 | Val  Acc: 0.3529
 Site-Southeast_Asian           (1) | Val  Loss: 1.6662 | Val  Acc: 0.4000
 Site-Asian_ffhq                (4) | Val  Loss: 1.6053 | Val  Acc: 0.5043
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9154 | Val  Acc: 0.0641
Average Valid Accuracy: 0.4086
============ Train epoch 24 ============
cnt=[2, 3, 9, 5, 5, 1, 4, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-White_utk                 (4) | Train Loss: 1.5139 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.5915 | Train Acc: 0.3529
 Site-White_utk                 (6) | Train Loss: 1.5237 | Train Acc: 0.4615
 Site-White_utk                 (4) | Train Loss: 1.6884 | Train Acc: 0.3158
 Site-White_utk                 (6) | Train Loss: 1.5734 | Train Acc: 0.4821
 Site-White_utk                 (4) | Train Loss: 1.5556 | Train Acc: 0.4512
 Site-White_utk                 (4) | Train Loss: 1.6048 | Train Acc: 0.3802
 Site-White_utk                 (6) | Train Loss: 1.6718 | Train Acc: 0.3352
 Site-White_utk                 (4) | Train Loss: 1.6979 | Train Acc: 0.3688
 Site-White_utk                 (6) | Train Loss: 1.5886 | Train Acc: 0.4315
 Site-East_Asian                (2) | Train Loss: 1.4004 | Train Acc: 0.4444
 Site-East_Asian                (2) | Train Loss: 1.4397 | Train Acc: 0.5250
 Site-East_Asian                (2) | Train Loss: 1.6884 | Train Acc: 0.4068
 Site-East_Asian                (2) | Train Loss: 1.5615 | Train Acc: 0.4302
 Site-East_Asian                (2) | Train Loss: 1.5899 | Train Acc: 0.4567
 Site-East_Asian                (2) | Train Loss: 1.5952 | Train Acc: 0.4118
 Site-East_Asian                (2) | Train Loss: 1.5135 | Train Acc: 0.4565
 Site-Indian_utk                (3) | Train Loss: 1.5104 | Train Acc: 0.5116
 Site-Indian_utk                (3) | Train Loss: 1.5173 | Train Acc: 0.5000
 Site-Indian_utk                (3) | Train Loss: 1.5089 | Train Acc: 0.4681
 Site-Indian_utk                (3) | Train Loss: 1.6266 | Train Acc: 0.4676
 Site-Indian_utk                (3) | Train Loss: 1.5356 | Train Acc: 0.5024
 Site-Black_utk                 (1) | Train Loss: 1.5493 | Train Acc: 0.4727
 Site-Black_utk                 (1) | Train Loss: 1.6367 | Train Acc: 0.4568
 Site-Black_utk                 (1) | Train Loss: 1.6383 | Train Acc: 0.4286
 Site-Southeast_Asian           (2) | Train Loss: 1.7061 | Train Acc: 0.3431
 Site-Southeast_Asian           (2) | Train Loss: 1.6725 | Train Acc: 0.4267
 Site-Asian_ffhq                (0) | Train Loss: 1.5722 | Train Acc: 0.6221
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.5697 | Train Acc: 0.5812
Average Train Accuracy: 0.4422
 Site-White_utk                 (4) | Val  Loss: 1.4017 | Val  Acc: 0.5000
 Site-White_utk                 (5) | Val  Loss: 1.6370 | Val  Acc: 0.3636
 Site-White_utk                 (6) | Val  Loss: 1.7224 | Val  Acc: 0.2353
 Site-White_utk                 (4) | Val  Loss: 1.6466 | Val  Acc: 0.3200
 Site-White_utk                 (6) | Val  Loss: 1.5508 | Val  Acc: 0.4054
 Site-White_utk                 (4) | Val  Loss: 1.6592 | Val  Acc: 0.3455
 Site-White_utk                 (4) | Val  Loss: 1.6560 | Val  Acc: 0.3210
 Site-White_utk                 (6) | Val  Loss: 1.6356 | Val  Acc: 0.4202
 Site-White_utk                 (4) | Val  Loss: 1.6641 | Val  Acc: 0.3771
 Site-White_utk                 (6) | Val  Loss: 1.7777 | Val  Acc: 0.3605
 Site-East_Asian                (2) | Val  Loss: 1.6436 | Val  Acc: 0.3333
 Site-East_Asian                (2) | Val  Loss: 1.4473 | Val  Acc: 0.5000
 Site-East_Asian                (2) | Val  Loss: 1.5287 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.5734 | Val  Acc: 0.4561
 Site-East_Asian                (2) | Val  Loss: 1.5778 | Val  Acc: 0.5059
 Site-East_Asian                (2) | Val  Loss: 1.5685 | Val  Acc: 0.4400
 Site-East_Asian                (2) | Val  Loss: 1.5575 | Val  Acc: 0.4402
 Site-Indian_utk                (3) | Val  Loss: 1.5405 | Val  Acc: 0.4828
 Site-Indian_utk                (3) | Val  Loss: 1.4303 | Val  Acc: 0.5349
 Site-Indian_utk                (3) | Val  Loss: 1.5338 | Val  Acc: 0.4921
 Site-Indian_utk                (3) | Val  Loss: 1.6035 | Val  Acc: 0.4239
 Site-Indian_utk                (3) | Val  Loss: 1.4393 | Val  Acc: 0.4559
 Site-Black_utk                 (1) | Val  Loss: 1.6167 | Val  Acc: 0.4444
 Site-Black_utk                 (1) | Val  Loss: 1.6473 | Val  Acc: 0.4259
 Site-Black_utk                 (1) | Val  Loss: 1.6070 | Val  Acc: 0.3924
 Site-Southeast_Asian           (2) | Val  Loss: 1.6906 | Val  Acc: 0.4265
 Site-Southeast_Asian           (2) | Val  Loss: 1.6952 | Val  Acc: 0.4000
 Site-Asian_ffhq                (0) | Val  Loss: 1.5903 | Val  Acc: 0.5304
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.8464 | Val  Acc: 0.1538
Average Valid Accuracy: 0.4120
 Test site-White_utk                 (4)| Epoch:19 | Test Acc: 0.3720
 Test site-East_Asian                (2)| Epoch:19 | Test Acc: 0.4697
 Test site-Indian_utk                (3)| Epoch:19 | Test Acc: 0.4604
 Test site-Black_utk                 (1)| Epoch:19 | Test Acc: 0.3724
 Test site-Southeast_Asian           (2)| Epoch:19 | Test Acc: 0.4055
 Test site-Asian_ffhq                (0)| Epoch:19 | Test Acc: 0.2188
 Test site-Latino_Hispanic_ffhq      (0)| Epoch:19 | Test Acc: 0.2438
White_utk: 0.3720, East_Asian: 0.4697, Indian_utk: 0.4604, Black_utk: 0.3724, Southeast_Asian: 0.4055, Asian_ffhq: 0.2188, Latino_Hispanic_ffhq: 0.2438, 
Average Test Accuracy(group): 0.3632, Average Test Accuracy(individual): 0.4035,
domain std=0.0909, cluster std=0.0701, individual std=0.0641, 
============ Train epoch 25 ============
cnt=[1, 1, 3, 1, 2, 8, 13, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-White_utk                 (0) | Train Loss: 1.3690 | Train Acc: 0.4167
 Site-White_utk                 (6) | Train Loss: 1.5585 | Train Acc: 0.4118
 Site-White_utk                 (6) | Train Loss: 1.5885 | Train Acc: 0.3846
 Site-White_utk                 (3) | Train Loss: 1.7291 | Train Acc: 0.2632
 Site-White_utk                 (6) | Train Loss: 1.6063 | Train Acc: 0.4464
 Site-White_utk                 (6) | Train Loss: 1.5876 | Train Acc: 0.3902
 Site-White_utk                 (6) | Train Loss: 1.5961 | Train Acc: 0.3719
 Site-White_utk                 (6) | Train Loss: 1.6790 | Train Acc: 0.3240
 Site-White_utk                 (6) | Train Loss: 1.5882 | Train Acc: 0.3574
 Site-White_utk                 (6) | Train Loss: 1.5947 | Train Acc: 0.4651
 Site-East_Asian                (5) | Train Loss: 1.4564 | Train Acc: 0.4444
 Site-East_Asian                (1) | Train Loss: 1.4351 | Train Acc: 0.5750
 Site-East_Asian                (5) | Train Loss: 1.6888 | Train Acc: 0.3729
 Site-East_Asian                (5) | Train Loss: 1.6726 | Train Acc: 0.4302
 Site-East_Asian                (5) | Train Loss: 1.5726 | Train Acc: 0.4409
 Site-East_Asian                (5) | Train Loss: 1.5864 | Train Acc: 0.4171
 Site-East_Asian                (5) | Train Loss: 1.5169 | Train Acc: 0.4457
 Site-Indian_utk                (6) | Train Loss: 1.5711 | Train Acc: 0.4186
 Site-Indian_utk                (6) | Train Loss: 1.5072 | Train Acc: 0.4375
 Site-Indian_utk                (6) | Train Loss: 1.5684 | Train Acc: 0.4362
 Site-Indian_utk                (6) | Train Loss: 1.5192 | Train Acc: 0.4748
 Site-Indian_utk                (6) | Train Loss: 1.5152 | Train Acc: 0.4829
 Site-Black_utk                 (2) | Train Loss: 1.5306 | Train Acc: 0.4727
 Site-Black_utk                 (2) | Train Loss: 1.6451 | Train Acc: 0.4568
 Site-Black_utk                 (2) | Train Loss: 1.5943 | Train Acc: 0.4706
 Site-Southeast_Asian           (5) | Train Loss: 1.7090 | Train Acc: 0.4020
 Site-Southeast_Asian           (5) | Train Loss: 1.7004 | Train Acc: 0.3933
 Site-Asian_ffhq                (4) | Train Loss: 1.5767 | Train Acc: 0.6221
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5845 | Train Acc: 0.5556
Average Train Accuracy: 0.4338
 Site-White_utk                 (0) | Val  Loss: 1.3778 | Val  Acc: 0.6250
 Site-White_utk                 (6) | Val  Loss: 1.5884 | Val  Acc: 0.5455
 Site-White_utk                 (6) | Val  Loss: 1.5912 | Val  Acc: 0.4118
 Site-White_utk                 (3) | Val  Loss: 1.5556 | Val  Acc: 0.4800
 Site-White_utk                 (6) | Val  Loss: 1.5126 | Val  Acc: 0.4324
 Site-White_utk                 (6) | Val  Loss: 1.6154 | Val  Acc: 0.3818
 Site-White_utk                 (6) | Val  Loss: 1.7225 | Val  Acc: 0.3333
 Site-White_utk                 (6) | Val  Loss: 1.5971 | Val  Acc: 0.4034
 Site-White_utk                 (6) | Val  Loss: 1.6666 | Val  Acc: 0.3829
 Site-White_utk                 (6) | Val  Loss: 1.7139 | Val  Acc: 0.3915
 Site-East_Asian                (5) | Val  Loss: 1.6883 | Val  Acc: 0.3889
 Site-East_Asian                (1) | Val  Loss: 1.4059 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.5771 | Val  Acc: 0.4359
 Site-East_Asian                (5) | Val  Loss: 1.5814 | Val  Acc: 0.4211
 Site-East_Asian                (5) | Val  Loss: 1.5740 | Val  Acc: 0.4941
 Site-East_Asian                (5) | Val  Loss: 1.5517 | Val  Acc: 0.4480
 Site-East_Asian                (5) | Val  Loss: 1.5797 | Val  Acc: 0.4457
 Site-Indian_utk                (6) | Val  Loss: 1.4743 | Val  Acc: 0.4483
 Site-Indian_utk                (6) | Val  Loss: 1.4290 | Val  Acc: 0.4419
 Site-Indian_utk                (6) | Val  Loss: 1.5287 | Val  Acc: 0.4762
 Site-Indian_utk                (6) | Val  Loss: 1.5932 | Val  Acc: 0.4891
 Site-Indian_utk                (6) | Val  Loss: 1.4402 | Val  Acc: 0.4191
 Site-Black_utk                 (2) | Val  Loss: 1.6006 | Val  Acc: 0.5278
 Site-Black_utk                 (2) | Val  Loss: 1.6370 | Val  Acc: 0.3889
 Site-Black_utk                 (2) | Val  Loss: 1.5674 | Val  Acc: 0.4177
 Site-Southeast_Asian           (5) | Val  Loss: 1.9357 | Val  Acc: 0.3676
 Site-Southeast_Asian           (5) | Val  Loss: 1.7193 | Val  Acc: 0.3700
 Site-Asian_ffhq                (4) | Val  Loss: 1.5707 | Val  Acc: 0.5652
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8492 | Val  Acc: 0.1667
Average Valid Accuracy: 0.4345
 Best site-White_utk                (0)  | Epoch:25 | Val Acc: 0.6250
 Best site-White_utk                (6)  | Epoch:25 | Val Acc: 0.5455
 Best site-White_utk                (6)  | Epoch:25 | Val Acc: 0.4118
 Best site-White_utk                (3)  | Epoch:25 | Val Acc: 0.4800
 Best site-White_utk                (6)  | Epoch:25 | Val Acc: 0.4324
 Best site-White_utk                (6)  | Epoch:25 | Val Acc: 0.3818
 Best site-White_utk                (6)  | Epoch:25 | Val Acc: 0.3333
 Best site-White_utk                (6)  | Epoch:25 | Val Acc: 0.4034
 Best site-White_utk                (6)  | Epoch:25 | Val Acc: 0.3829
 Best site-White_utk                (6)  | Epoch:25 | Val Acc: 0.3915
 Best site-East_Asian               (5)  | Epoch:25 | Val Acc: 0.3889
 Best site-East_Asian               (1)  | Epoch:25 | Val Acc: 0.5000
 Best site-East_Asian               (5)  | Epoch:25 | Val Acc: 0.4359
 Best site-East_Asian               (5)  | Epoch:25 | Val Acc: 0.4211
 Best site-East_Asian               (5)  | Epoch:25 | Val Acc: 0.4941
 Best site-East_Asian               (5)  | Epoch:25 | Val Acc: 0.4480
 Best site-East_Asian               (5)  | Epoch:25 | Val Acc: 0.4457
 Best site-Indian_utk               (6)  | Epoch:25 | Val Acc: 0.4483
 Best site-Indian_utk               (6)  | Epoch:25 | Val Acc: 0.4419
 Best site-Indian_utk               (6)  | Epoch:25 | Val Acc: 0.4762
 Best site-Indian_utk               (6)  | Epoch:25 | Val Acc: 0.4891
 Best site-Indian_utk               (6)  | Epoch:25 | Val Acc: 0.4191
 Best site-Black_utk                (2)  | Epoch:25 | Val Acc: 0.5278
 Best site-Black_utk                (2)  | Epoch:25 | Val Acc: 0.3889
 Best site-Black_utk                (2)  | Epoch:25 | Val Acc: 0.4177
 Best site-Southeast_Asian          (5)  | Epoch:25 | Val Acc: 0.3676
 Best site-Southeast_Asian          (5)  | Epoch:25 | Val Acc: 0.3700
 Best site-Asian_ffhq               (4)  | Epoch:25 | Val Acc: 0.5652
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:25 | Val Acc: 0.1667
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 26 ============
cnt=[6, 8, 1, 11, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-White_utk                 (2) | Train Loss: 1.4052 | Train Acc: 0.3333
 Site-White_utk                 (3) | Train Loss: 1.5908 | Train Acc: 0.3529
 Site-White_utk                 (3) | Train Loss: 1.5897 | Train Acc: 0.5000
 Site-White_utk                 (3) | Train Loss: 1.6961 | Train Acc: 0.3158
 Site-White_utk                 (3) | Train Loss: 1.5839 | Train Acc: 0.4643
 Site-White_utk                 (3) | Train Loss: 1.5774 | Train Acc: 0.4512
 Site-White_utk                 (3) | Train Loss: 1.5913 | Train Acc: 0.3719
 Site-White_utk                 (3) | Train Loss: 1.6836 | Train Acc: 0.3631
 Site-White_utk                 (3) | Train Loss: 1.5792 | Train Acc: 0.3840
 Site-White_utk                 (3) | Train Loss: 1.5790 | Train Acc: 0.4238
 Site-East_Asian                (4) | Train Loss: 1.5003 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.4321 | Train Acc: 0.5750
 Site-East_Asian                (1) | Train Loss: 1.7058 | Train Acc: 0.3559
 Site-East_Asian                (1) | Train Loss: 1.6255 | Train Acc: 0.4186
 Site-East_Asian                (1) | Train Loss: 1.5856 | Train Acc: 0.4724
 Site-East_Asian                (1) | Train Loss: 1.5743 | Train Acc: 0.4225
 Site-East_Asian                (1) | Train Loss: 1.4988 | Train Acc: 0.4710
 Site-Indian_utk                (0) | Train Loss: 1.5385 | Train Acc: 0.4651
 Site-Indian_utk                (0) | Train Loss: 1.5019 | Train Acc: 0.5000
 Site-Indian_utk                (0) | Train Loss: 1.5578 | Train Acc: 0.4149
 Site-Indian_utk                (0) | Train Loss: 1.6425 | Train Acc: 0.4532
 Site-Indian_utk                (0) | Train Loss: 1.5562 | Train Acc: 0.4927
 Site-Black_utk                 (0) | Train Loss: 1.5851 | Train Acc: 0.4727
 Site-Black_utk                 (3) | Train Loss: 1.5906 | Train Acc: 0.3086
 Site-Black_utk                 (3) | Train Loss: 1.6176 | Train Acc: 0.4874
 Site-Southeast_Asian           (1) | Train Loss: 1.7281 | Train Acc: 0.3922
 Site-Southeast_Asian           (1) | Train Loss: 1.6309 | Train Acc: 0.3667
 Site-Asian_ffhq                (6) | Train Loss: 1.5855 | Train Acc: 0.6279
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.5956 | Train Acc: 0.5726
Average Train Accuracy: 0.4358
 Site-White_utk                 (2) | Val  Loss: 1.3412 | Val  Acc: 0.7500
 Site-White_utk                 (3) | Val  Loss: 1.5914 | Val  Acc: 0.3636
 Site-White_utk                 (3) | Val  Loss: 1.5236 | Val  Acc: 0.5882
 Site-White_utk                 (3) | Val  Loss: 1.5539 | Val  Acc: 0.4400
 Site-White_utk                 (3) | Val  Loss: 1.5306 | Val  Acc: 0.3514
 Site-White_utk                 (3) | Val  Loss: 1.6517 | Val  Acc: 0.4000
 Site-White_utk                 (3) | Val  Loss: 1.6756 | Val  Acc: 0.3827
 Site-White_utk                 (3) | Val  Loss: 1.6453 | Val  Acc: 0.3697
 Site-White_utk                 (3) | Val  Loss: 1.6487 | Val  Acc: 0.3829
 Site-White_utk                 (3) | Val  Loss: 1.7459 | Val  Acc: 0.3411
 Site-East_Asian                (4) | Val  Loss: 1.6631 | Val  Acc: 0.4444
 Site-East_Asian                (1) | Val  Loss: 1.4693 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.5255 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.5288 | Val  Acc: 0.4561
 Site-East_Asian                (1) | Val  Loss: 1.5694 | Val  Acc: 0.4941
 Site-East_Asian                (1) | Val  Loss: 1.5472 | Val  Acc: 0.4480
 Site-East_Asian                (1) | Val  Loss: 1.5414 | Val  Acc: 0.4728
 Site-Indian_utk                (0) | Val  Loss: 1.5410 | Val  Acc: 0.4828
 Site-Indian_utk                (0) | Val  Loss: 1.4345 | Val  Acc: 0.5349
 Site-Indian_utk                (0) | Val  Loss: 1.5470 | Val  Acc: 0.4603
 Site-Indian_utk                (0) | Val  Loss: 1.5999 | Val  Acc: 0.4783
 Site-Indian_utk                (0) | Val  Loss: 1.4494 | Val  Acc: 0.4412
 Site-Black_utk                 (0) | Val  Loss: 1.5459 | Val  Acc: 0.6111
 Site-Black_utk                 (3) | Val  Loss: 1.6204 | Val  Acc: 0.3889
 Site-Black_utk                 (3) | Val  Loss: 1.5517 | Val  Acc: 0.4177
 Site-Southeast_Asian           (1) | Val  Loss: 1.7984 | Val  Acc: 0.3824
 Site-Southeast_Asian           (1) | Val  Loss: 1.7110 | Val  Acc: 0.3900
 Site-Asian_ffhq                (6) | Val  Loss: 1.5730 | Val  Acc: 0.5130
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.8179 | Val  Acc: 0.1795
Average Valid Accuracy: 0.4444
 Best site-White_utk                (2)  | Epoch:26 | Val Acc: 0.7500
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.3636
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.5882
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.4400
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.3514
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.4000
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.3827
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.3697
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.3829
 Best site-White_utk                (3)  | Epoch:26 | Val Acc: 0.3411
 Best site-East_Asian               (4)  | Epoch:26 | Val Acc: 0.4444
 Best site-East_Asian               (1)  | Epoch:26 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:26 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:26 | Val Acc: 0.4561
 Best site-East_Asian               (1)  | Epoch:26 | Val Acc: 0.4941
 Best site-East_Asian               (1)  | Epoch:26 | Val Acc: 0.4480
 Best site-East_Asian               (1)  | Epoch:26 | Val Acc: 0.4728
 Best site-Indian_utk               (0)  | Epoch:26 | Val Acc: 0.4828
 Best site-Indian_utk               (0)  | Epoch:26 | Val Acc: 0.5349
 Best site-Indian_utk               (0)  | Epoch:26 | Val Acc: 0.4603
 Best site-Indian_utk               (0)  | Epoch:26 | Val Acc: 0.4783
 Best site-Indian_utk               (0)  | Epoch:26 | Val Acc: 0.4412
 Best site-Black_utk                (0)  | Epoch:26 | Val Acc: 0.6111
 Best site-Black_utk                (3)  | Epoch:26 | Val Acc: 0.3889
 Best site-Black_utk                (3)  | Epoch:26 | Val Acc: 0.4177
 Best site-Southeast_Asian          (1)  | Epoch:26 | Val Acc: 0.3824
 Best site-Southeast_Asian          (1)  | Epoch:26 | Val Acc: 0.3900
 Best site-Asian_ffhq               (6)  | Epoch:26 | Val Acc: 0.5130
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:26 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 9, 1, 3, 9, 5, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-White_utk                 (4) | Train Loss: 1.5123 | Train Acc: 0.3333
 Site-White_utk                 (4) | Train Loss: 1.5900 | Train Acc: 0.4118
 Site-White_utk                 (4) | Train Loss: 1.5410 | Train Acc: 0.3846
 Site-White_utk                 (4) | Train Loss: 1.7198 | Train Acc: 0.1842
 Site-White_utk                 (0) | Train Loss: 1.4982 | Train Acc: 0.4107
 Site-White_utk                 (4) | Train Loss: 1.5760 | Train Acc: 0.4268
 Site-White_utk                 (4) | Train Loss: 1.5827 | Train Acc: 0.3802
 Site-White_utk                 (4) | Train Loss: 1.6750 | Train Acc: 0.3520
 Site-White_utk                 (4) | Train Loss: 1.6687 | Train Acc: 0.3726
 Site-White_utk                 (4) | Train Loss: 1.5848 | Train Acc: 0.4238
 Site-East_Asian                (1) | Train Loss: 1.4573 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.3920 | Train Acc: 0.5500
 Site-East_Asian                (1) | Train Loss: 1.6275 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.6305 | Train Acc: 0.4186
 Site-East_Asian                (1) | Train Loss: 1.5636 | Train Acc: 0.4409
 Site-East_Asian                (1) | Train Loss: 1.5606 | Train Acc: 0.4171
 Site-East_Asian                (1) | Train Loss: 1.5154 | Train Acc: 0.4710
 Site-Indian_utk                (5) | Train Loss: 1.5287 | Train Acc: 0.5116
 Site-Indian_utk                (5) | Train Loss: 1.5154 | Train Acc: 0.5000
 Site-Indian_utk                (5) | Train Loss: 1.5414 | Train Acc: 0.3830
 Site-Indian_utk                (5) | Train Loss: 1.6210 | Train Acc: 0.4388
 Site-Indian_utk                (5) | Train Loss: 1.5471 | Train Acc: 0.4439
 Site-Black_utk                 (3) | Train Loss: 1.5925 | Train Acc: 0.4545
 Site-Black_utk                 (3) | Train Loss: 1.6414 | Train Acc: 0.4691
 Site-Black_utk                 (3) | Train Loss: 1.6023 | Train Acc: 0.4202
 Site-Southeast_Asian           (1) | Train Loss: 1.7531 | Train Acc: 0.3824
 Site-Southeast_Asian           (1) | Train Loss: 1.6792 | Train Acc: 0.3933
 Site-Asian_ffhq                (6) | Train Loss: 1.5473 | Train Acc: 0.6279
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5541 | Train Acc: 0.5556
Average Train Accuracy: 0.4280
 Site-White_utk                 (4) | Val  Loss: 1.3480 | Val  Acc: 0.6250
 Site-White_utk                 (4) | Val  Loss: 1.5988 | Val  Acc: 0.2727
 Site-White_utk                 (4) | Val  Loss: 1.6593 | Val  Acc: 0.2941
 Site-White_utk                 (4) | Val  Loss: 1.5703 | Val  Acc: 0.3200
 Site-White_utk                 (0) | Val  Loss: 1.5412 | Val  Acc: 0.4324
 Site-White_utk                 (4) | Val  Loss: 1.6143 | Val  Acc: 0.4000
 Site-White_utk                 (4) | Val  Loss: 1.6555 | Val  Acc: 0.3210
 Site-White_utk                 (4) | Val  Loss: 1.6286 | Val  Acc: 0.4034
 Site-White_utk                 (4) | Val  Loss: 1.6561 | Val  Acc: 0.3371
 Site-White_utk                 (4) | Val  Loss: 1.7580 | Val  Acc: 0.3760
 Site-East_Asian                (1) | Val  Loss: 1.6085 | Val  Acc: 0.3889
 Site-East_Asian                (1) | Val  Loss: 1.4850 | Val  Acc: 0.5769
 Site-East_Asian                (1) | Val  Loss: 1.5264 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.5131 | Val  Acc: 0.4386
 Site-East_Asian                (1) | Val  Loss: 1.5358 | Val  Acc: 0.4941
 Site-East_Asian                (1) | Val  Loss: 1.5462 | Val  Acc: 0.4720
 Site-East_Asian                (1) | Val  Loss: 1.5473 | Val  Acc: 0.4511
 Site-Indian_utk                (5) | Val  Loss: 1.5931 | Val  Acc: 0.3448
 Site-Indian_utk                (5) | Val  Loss: 1.4134 | Val  Acc: 0.4884
 Site-Indian_utk                (5) | Val  Loss: 1.5062 | Val  Acc: 0.4762
 Site-Indian_utk                (5) | Val  Loss: 1.5761 | Val  Acc: 0.4674
 Site-Indian_utk                (5) | Val  Loss: 1.3609 | Val  Acc: 0.4338
 Site-Black_utk                 (3) | Val  Loss: 1.5361 | Val  Acc: 0.5556
 Site-Black_utk                 (3) | Val  Loss: 1.6337 | Val  Acc: 0.4444
 Site-Black_utk                 (3) | Val  Loss: 1.5425 | Val  Acc: 0.4430
 Site-Southeast_Asian           (1) | Val  Loss: 1.7683 | Val  Acc: 0.3676
 Site-Southeast_Asian           (1) | Val  Loss: 1.7042 | Val  Acc: 0.3700
 Site-Asian_ffhq                (6) | Val  Loss: 1.5669 | Val  Acc: 0.5565
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8067 | Val  Acc: 0.1667
Average Valid Accuracy: 0.4200
============ Train epoch 28 ============
cnt=[8, 5, 1, 10, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-White_utk                 (3) | Train Loss: 1.4395 | Train Acc: 0.4167
 Site-White_utk                 (3) | Train Loss: 1.5620 | Train Acc: 0.3529
 Site-White_utk                 (3) | Train Loss: 1.5557 | Train Acc: 0.3846
 Site-White_utk                 (3) | Train Loss: 1.7299 | Train Acc: 0.2368
 Site-White_utk                 (3) | Train Loss: 1.5223 | Train Acc: 0.4286
 Site-White_utk                 (3) | Train Loss: 1.4827 | Train Acc: 0.4268
 Site-White_utk                 (3) | Train Loss: 1.6001 | Train Acc: 0.3884
 Site-White_utk                 (3) | Train Loss: 1.6639 | Train Acc: 0.3631
 Site-White_utk                 (3) | Train Loss: 1.5727 | Train Acc: 0.3954
 Site-White_utk                 (3) | Train Loss: 1.4906 | Train Acc: 0.4625
 Site-East_Asian                (6) | Train Loss: 1.4148 | Train Acc: 0.4815
 Site-East_Asian                (0) | Train Loss: 1.4489 | Train Acc: 0.5250
 Site-East_Asian                (0) | Train Loss: 1.6443 | Train Acc: 0.4068
 Site-East_Asian                (0) | Train Loss: 1.6440 | Train Acc: 0.4302
 Site-East_Asian                (0) | Train Loss: 1.5923 | Train Acc: 0.4567
 Site-East_Asian                (0) | Train Loss: 1.5714 | Train Acc: 0.4171
 Site-East_Asian                (0) | Train Loss: 1.5225 | Train Acc: 0.4384
 Site-Indian_utk                (1) | Train Loss: 1.4899 | Train Acc: 0.4884
 Site-Indian_utk                (1) | Train Loss: 1.5174 | Train Acc: 0.5156
 Site-Indian_utk                (1) | Train Loss: 1.5285 | Train Acc: 0.3723
 Site-Indian_utk                (1) | Train Loss: 1.5928 | Train Acc: 0.4964
 Site-Indian_utk                (1) | Train Loss: 1.5553 | Train Acc: 0.4976
 Site-Black_utk                 (5) | Train Loss: 1.5812 | Train Acc: 0.4364
 Site-Black_utk                 (5) | Train Loss: 1.6299 | Train Acc: 0.4444
 Site-Black_utk                 (5) | Train Loss: 1.5995 | Train Acc: 0.4538
 Site-Southeast_Asian           (0) | Train Loss: 1.6936 | Train Acc: 0.3725
 Site-Southeast_Asian           (0) | Train Loss: 1.6748 | Train Acc: 0.3733
 Site-Asian_ffhq                (2) | Train Loss: 1.5650 | Train Acc: 0.6279
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5484 | Train Acc: 0.5470
Average Train Accuracy: 0.4358
 Site-White_utk                 (3) | Val  Loss: 1.4040 | Val  Acc: 0.3750
 Site-White_utk                 (3) | Val  Loss: 1.5371 | Val  Acc: 0.4545
 Site-White_utk                 (3) | Val  Loss: 1.6366 | Val  Acc: 0.4706
 Site-White_utk                 (3) | Val  Loss: 1.5909 | Val  Acc: 0.4400
 Site-White_utk                 (3) | Val  Loss: 1.5724 | Val  Acc: 0.4054
 Site-White_utk                 (3) | Val  Loss: 1.5882 | Val  Acc: 0.3818
 Site-White_utk                 (3) | Val  Loss: 1.6841 | Val  Acc: 0.3580
 Site-White_utk                 (3) | Val  Loss: 1.6311 | Val  Acc: 0.3782
 Site-White_utk                 (3) | Val  Loss: 1.6637 | Val  Acc: 0.3600
 Site-White_utk                 (3) | Val  Loss: 1.6767 | Val  Acc: 0.3992
 Site-East_Asian                (6) | Val  Loss: 1.7436 | Val  Acc: 0.2778
 Site-East_Asian                (0) | Val  Loss: 1.4549 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.5005 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.4918 | Val  Acc: 0.4737
 Site-East_Asian                (0) | Val  Loss: 1.5746 | Val  Acc: 0.4588
 Site-East_Asian                (0) | Val  Loss: 1.5422 | Val  Acc: 0.4640
 Site-East_Asian                (0) | Val  Loss: 1.5699 | Val  Acc: 0.4348
 Site-Indian_utk                (1) | Val  Loss: 1.5189 | Val  Acc: 0.5862
 Site-Indian_utk                (1) | Val  Loss: 1.4459 | Val  Acc: 0.5116
 Site-Indian_utk                (1) | Val  Loss: 1.5197 | Val  Acc: 0.4603
 Site-Indian_utk                (1) | Val  Loss: 1.5588 | Val  Acc: 0.5000
 Site-Indian_utk                (1) | Val  Loss: 1.3839 | Val  Acc: 0.4265
 Site-Black_utk                 (5) | Val  Loss: 1.5877 | Val  Acc: 0.4722
 Site-Black_utk                 (5) | Val  Loss: 1.5968 | Val  Acc: 0.3704
 Site-Black_utk                 (5) | Val  Loss: 1.5621 | Val  Acc: 0.3797
 Site-Southeast_Asian           (0) | Val  Loss: 1.6761 | Val  Acc: 0.3824
 Site-Southeast_Asian           (0) | Val  Loss: 1.7093 | Val  Acc: 0.4200
 Site-Asian_ffhq                (2) | Val  Loss: 1.5469 | Val  Acc: 0.5478
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8784 | Val  Acc: 0.1667
Average Valid Accuracy: 0.4247
============ Train epoch 29 ============
cnt=[1, 11, 8, 1, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-White_utk                 (6) | Train Loss: 1.4350 | Train Acc: 0.4167
 Site-White_utk                 (1) | Train Loss: 1.5373 | Train Acc: 0.4118
 Site-White_utk                 (1) | Train Loss: 1.5700 | Train Acc: 0.3846
 Site-White_utk                 (1) | Train Loss: 1.7175 | Train Acc: 0.2368
 Site-White_utk                 (1) | Train Loss: 1.5763 | Train Acc: 0.3393
 Site-White_utk                 (1) | Train Loss: 1.5899 | Train Acc: 0.4268
 Site-White_utk                 (1) | Train Loss: 1.5611 | Train Acc: 0.4380
 Site-White_utk                 (1) | Train Loss: 1.6822 | Train Acc: 0.3408
 Site-White_utk                 (1) | Train Loss: 1.5906 | Train Acc: 0.4106
 Site-White_utk                 (1) | Train Loss: 1.5633 | Train Acc: 0.4444
 Site-East_Asian                (2) | Train Loss: 1.4459 | Train Acc: 0.4074
 Site-East_Asian                (3) | Train Loss: 1.4117 | Train Acc: 0.5500
 Site-East_Asian                (2) | Train Loss: 1.6691 | Train Acc: 0.3898
 Site-East_Asian                (2) | Train Loss: 1.6027 | Train Acc: 0.4419
 Site-East_Asian                (2) | Train Loss: 1.5473 | Train Acc: 0.4646
 Site-East_Asian                (2) | Train Loss: 1.5505 | Train Acc: 0.4225
 Site-East_Asian                (2) | Train Loss: 1.4948 | Train Acc: 0.4601
 Site-Indian_utk                (5) | Train Loss: 1.5332 | Train Acc: 0.4884
 Site-Indian_utk                (5) | Train Loss: 1.4874 | Train Acc: 0.5469
 Site-Indian_utk                (5) | Train Loss: 1.5046 | Train Acc: 0.4468
 Site-Indian_utk                (5) | Train Loss: 1.6702 | Train Acc: 0.4820
 Site-Indian_utk                (5) | Train Loss: 1.5241 | Train Acc: 0.4829
 Site-Black_utk                 (0) | Train Loss: 1.5517 | Train Acc: 0.4727
 Site-Black_utk                 (1) | Train Loss: 1.6025 | Train Acc: 0.4691
 Site-Black_utk                 (1) | Train Loss: 1.6374 | Train Acc: 0.4370
 Site-Southeast_Asian           (2) | Train Loss: 1.6920 | Train Acc: 0.4020
 Site-Southeast_Asian           (2) | Train Loss: 1.6797 | Train Acc: 0.3867
 Site-Asian_ffhq                (4) | Train Loss: 1.5490 | Train Acc: 0.6221
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5496 | Train Acc: 0.5385
Average Train Accuracy: 0.4400
 Site-White_utk                 (6) | Val  Loss: 1.4724 | Val  Acc: 0.3750
 Site-White_utk                 (1) | Val  Loss: 1.5733 | Val  Acc: 0.3636
 Site-White_utk                 (1) | Val  Loss: 1.5969 | Val  Acc: 0.4706
 Site-White_utk                 (1) | Val  Loss: 1.6078 | Val  Acc: 0.4000
 Site-White_utk                 (1) | Val  Loss: 1.5261 | Val  Acc: 0.3514
 Site-White_utk                 (1) | Val  Loss: 1.5787 | Val  Acc: 0.3818
 Site-White_utk                 (1) | Val  Loss: 1.6257 | Val  Acc: 0.3457
 Site-White_utk                 (1) | Val  Loss: 1.6100 | Val  Acc: 0.4286
 Site-White_utk                 (1) | Val  Loss: 1.6583 | Val  Acc: 0.3657
 Site-White_utk                 (1) | Val  Loss: 1.6760 | Val  Acc: 0.3915
 Site-East_Asian                (2) | Val  Loss: 1.6877 | Val  Acc: 0.2778
 Site-East_Asian                (3) | Val  Loss: 1.4345 | Val  Acc: 0.5000
 Site-East_Asian                (2) | Val  Loss: 1.4872 | Val  Acc: 0.4103
 Site-East_Asian                (2) | Val  Loss: 1.5040 | Val  Acc: 0.4211
 Site-East_Asian                (2) | Val  Loss: 1.5138 | Val  Acc: 0.4941
 Site-East_Asian                (2) | Val  Loss: 1.5578 | Val  Acc: 0.4240
 Site-East_Asian                (2) | Val  Loss: 1.5397 | Val  Acc: 0.4511
 Site-Indian_utk                (5) | Val  Loss: 1.5595 | Val  Acc: 0.5172
 Site-Indian_utk                (5) | Val  Loss: 1.3765 | Val  Acc: 0.5116
 Site-Indian_utk                (5) | Val  Loss: 1.4945 | Val  Acc: 0.4762
 Site-Indian_utk                (5) | Val  Loss: 1.5809 | Val  Acc: 0.4565
 Site-Indian_utk                (5) | Val  Loss: 1.3984 | Val  Acc: 0.4706
 Site-Black_utk                 (0) | Val  Loss: 1.5628 | Val  Acc: 0.5556
 Site-Black_utk                 (1) | Val  Loss: 1.5896 | Val  Acc: 0.4259
 Site-Black_utk                 (1) | Val  Loss: 1.5466 | Val  Acc: 0.4051
 Site-Southeast_Asian           (2) | Val  Loss: 1.8085 | Val  Acc: 0.3824
 Site-Southeast_Asian           (2) | Val  Loss: 1.6803 | Val  Acc: 0.4000
 Site-Asian_ffhq                (4) | Val  Loss: 1.5629 | Val  Acc: 0.5913
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8755 | Val  Acc: 0.1538
Average Valid Accuracy: 0.4206
 Test site-White_utk                 (6)| Epoch:26 | Test Acc: 0.3741
 Test site-East_Asian                (2)| Epoch:26 | Test Acc: 0.4756
 Test site-Indian_utk                (5)| Epoch:26 | Test Acc: 0.4771
 Test site-Black_utk                 (0)| Epoch:26 | Test Acc: 0.3776
 Test site-Southeast_Asian           (2)| Epoch:26 | Test Acc: 0.4194
 Test site-Asian_ffhq                (4)| Epoch:26 | Test Acc: 0.2188
 Test site-Latino_Hispanic_ffhq      (4)| Epoch:26 | Test Acc: 0.2289
White_utk: 0.3741, East_Asian: 0.4756, Indian_utk: 0.4771, Black_utk: 0.3776, Southeast_Asian: 0.4194, Asian_ffhq: 0.2188, Latino_Hispanic_ffhq: 0.2289, 
Average Test Accuracy(group): 0.3673, Average Test Accuracy(individual): 0.4095,
domain std=0.0985, cluster std=0.0829, individual std=0.0690, 
============ Train epoch 30 ============
cnt=[1, 9, 3, 4, 2, 9, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-White_utk                 (0) | Train Loss: 1.4218 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.5714 | Train Acc: 0.4706
 Site-White_utk                 (5) | Train Loss: 1.5611 | Train Acc: 0.3462
 Site-White_utk                 (5) | Train Loss: 1.6327 | Train Acc: 0.2632
 Site-White_utk                 (5) | Train Loss: 1.5204 | Train Acc: 0.4107
 Site-White_utk                 (5) | Train Loss: 1.6252 | Train Acc: 0.4146
 Site-White_utk                 (5) | Train Loss: 1.5763 | Train Acc: 0.3802
 Site-White_utk                 (5) | Train Loss: 1.6762 | Train Acc: 0.3296
 Site-White_utk                 (5) | Train Loss: 1.6459 | Train Acc: 0.3954
 Site-White_utk                 (5) | Train Loss: 1.4930 | Train Acc: 0.4419
 Site-East_Asian                (1) | Train Loss: 1.3847 | Train Acc: 0.5185
 Site-East_Asian                (1) | Train Loss: 1.4463 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.6490 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.6108 | Train Acc: 0.4767
 Site-East_Asian                (1) | Train Loss: 1.5540 | Train Acc: 0.4567
 Site-East_Asian                (1) | Train Loss: 1.5476 | Train Acc: 0.4064
 Site-East_Asian                (1) | Train Loss: 1.5058 | Train Acc: 0.4529
 Site-Indian_utk                (6) | Train Loss: 1.5011 | Train Acc: 0.5349
 Site-Indian_utk                (3) | Train Loss: 1.4514 | Train Acc: 0.4844
 Site-Indian_utk                (3) | Train Loss: 1.5804 | Train Acc: 0.4255
 Site-Indian_utk                (3) | Train Loss: 1.5221 | Train Acc: 0.4676
 Site-Indian_utk                (3) | Train Loss: 1.4987 | Train Acc: 0.4878
 Site-Black_utk                 (2) | Train Loss: 1.5339 | Train Acc: 0.4545
 Site-Black_utk                 (2) | Train Loss: 1.5550 | Train Acc: 0.4074
 Site-Black_utk                 (2) | Train Loss: 1.5971 | Train Acc: 0.4370
 Site-Southeast_Asian           (1) | Train Loss: 1.6944 | Train Acc: 0.3824
 Site-Southeast_Asian           (1) | Train Loss: 1.6839 | Train Acc: 0.3667
 Site-Asian_ffhq                (4) | Train Loss: 1.5629 | Train Acc: 0.6395
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6222 | Train Acc: 0.5556
Average Train Accuracy: 0.4349
 Site-White_utk                 (0) | Val  Loss: 1.2735 | Val  Acc: 0.7500
 Site-White_utk                 (5) | Val  Loss: 1.5308 | Val  Acc: 0.3636
 Site-White_utk                 (5) | Val  Loss: 1.6956 | Val  Acc: 0.4118
 Site-White_utk                 (5) | Val  Loss: 1.5448 | Val  Acc: 0.4800
 Site-White_utk                 (5) | Val  Loss: 1.5487 | Val  Acc: 0.3514
 Site-White_utk                 (5) | Val  Loss: 1.5959 | Val  Acc: 0.3818
 Site-White_utk                 (5) | Val  Loss: 1.5961 | Val  Acc: 0.3827
 Site-White_utk                 (5) | Val  Loss: 1.5974 | Val  Acc: 0.4202
 Site-White_utk                 (5) | Val  Loss: 1.6079 | Val  Acc: 0.4114
 Site-White_utk                 (5) | Val  Loss: 1.6699 | Val  Acc: 0.3915
 Site-East_Asian                (1) | Val  Loss: 1.6389 | Val  Acc: 0.3889
 Site-East_Asian                (1) | Val  Loss: 1.4537 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.4509 | Val  Acc: 0.4872
 Site-East_Asian                (1) | Val  Loss: 1.5440 | Val  Acc: 0.4386
 Site-East_Asian                (1) | Val  Loss: 1.5476 | Val  Acc: 0.4706
 Site-East_Asian                (1) | Val  Loss: 1.5491 | Val  Acc: 0.4560
 Site-East_Asian                (1) | Val  Loss: 1.5348 | Val  Acc: 0.4674
 Site-Indian_utk                (6) | Val  Loss: 1.4552 | Val  Acc: 0.5172
 Site-Indian_utk                (3) | Val  Loss: 1.3813 | Val  Acc: 0.5349
 Site-Indian_utk                (3) | Val  Loss: 1.5220 | Val  Acc: 0.4444
 Site-Indian_utk                (3) | Val  Loss: 1.5566 | Val  Acc: 0.5109
 Site-Indian_utk                (3) | Val  Loss: 1.3555 | Val  Acc: 0.4926
 Site-Black_utk                 (2) | Val  Loss: 1.5819 | Val  Acc: 0.4722
 Site-Black_utk                 (2) | Val  Loss: 1.5914 | Val  Acc: 0.4074
 Site-Black_utk                 (2) | Val  Loss: 1.5038 | Val  Acc: 0.4177
 Site-Southeast_Asian           (1) | Val  Loss: 1.7398 | Val  Acc: 0.3824
 Site-Southeast_Asian           (1) | Val  Loss: 1.6648 | Val  Acc: 0.4100
 Site-Asian_ffhq                (4) | Val  Loss: 1.5970 | Val  Acc: 0.5043
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8216 | Val  Acc: 0.1538
Average Valid Accuracy: 0.4414
============ Train epoch 31 ============
cnt=[2, 9, 10, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-White_utk                 (2) | Train Loss: 1.4407 | Train Acc: 0.4167
 Site-White_utk                 (2) | Train Loss: 1.5574 | Train Acc: 0.3529
 Site-White_utk                 (2) | Train Loss: 1.5597 | Train Acc: 0.4615
 Site-White_utk                 (2) | Train Loss: 1.6750 | Train Acc: 0.3421
 Site-White_utk                 (2) | Train Loss: 1.4638 | Train Acc: 0.4643
 Site-White_utk                 (2) | Train Loss: 1.5902 | Train Acc: 0.4268
 Site-White_utk                 (2) | Train Loss: 1.5742 | Train Acc: 0.3719
 Site-White_utk                 (2) | Train Loss: 1.6474 | Train Acc: 0.3520
 Site-White_utk                 (2) | Train Loss: 1.6474 | Train Acc: 0.4030
 Site-White_utk                 (2) | Train Loss: 1.5472 | Train Acc: 0.4522
 Site-East_Asian                (1) | Train Loss: 1.4240 | Train Acc: 0.4444
 Site-East_Asian                (1) | Train Loss: 1.4361 | Train Acc: 0.5250
 Site-East_Asian                (1) | Train Loss: 1.6474 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.6131 | Train Acc: 0.4070
 Site-East_Asian                (1) | Train Loss: 1.5255 | Train Acc: 0.4488
 Site-East_Asian                (1) | Train Loss: 1.5466 | Train Acc: 0.4225
 Site-East_Asian                (1) | Train Loss: 1.4481 | Train Acc: 0.4746
 Site-Indian_utk                (0) | Train Loss: 1.4737 | Train Acc: 0.4884
 Site-Indian_utk                (0) | Train Loss: 1.4542 | Train Acc: 0.4688
 Site-Indian_utk                (6) | Train Loss: 1.5261 | Train Acc: 0.4043
 Site-Indian_utk                (6) | Train Loss: 1.5946 | Train Acc: 0.4964
 Site-Indian_utk                (6) | Train Loss: 1.5568 | Train Acc: 0.4683
 Site-Black_utk                 (5) | Train Loss: 1.5899 | Train Acc: 0.4909
 Site-Black_utk                 (4) | Train Loss: 1.6187 | Train Acc: 0.3580
 Site-Black_utk                 (4) | Train Loss: 1.5861 | Train Acc: 0.4538
 Site-Southeast_Asian           (1) | Train Loss: 1.6742 | Train Acc: 0.4020
 Site-Southeast_Asian           (1) | Train Loss: 1.6688 | Train Acc: 0.3800
 Site-Asian_ffhq                (3) | Train Loss: 1.6034 | Train Acc: 0.5988
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.5965 | Train Acc: 0.5470
Average Train Accuracy: 0.4378
 Site-White_utk                 (2) | Val  Loss: 1.3815 | Val  Acc: 0.6250
 Site-White_utk                 (2) | Val  Loss: 1.5458 | Val  Acc: 0.4545
 Site-White_utk                 (2) | Val  Loss: 1.5998 | Val  Acc: 0.4706
 Site-White_utk                 (2) | Val  Loss: 1.4743 | Val  Acc: 0.4400
 Site-White_utk                 (2) | Val  Loss: 1.5218 | Val  Acc: 0.3784
 Site-White_utk                 (2) | Val  Loss: 1.5583 | Val  Acc: 0.4182
 Site-White_utk                 (2) | Val  Loss: 1.6422 | Val  Acc: 0.3951
 Site-White_utk                 (2) | Val  Loss: 1.5708 | Val  Acc: 0.3866
 Site-White_utk                 (2) | Val  Loss: 1.6515 | Val  Acc: 0.4057
 Site-White_utk                 (2) | Val  Loss: 1.6965 | Val  Acc: 0.3527
 Site-East_Asian                (1) | Val  Loss: 1.6565 | Val  Acc: 0.4444
 Site-East_Asian                (1) | Val  Loss: 1.4789 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.4808 | Val  Acc: 0.4103
 Site-East_Asian                (1) | Val  Loss: 1.5365 | Val  Acc: 0.4035
 Site-East_Asian                (1) | Val  Loss: 1.5097 | Val  Acc: 0.4941
 Site-East_Asian                (1) | Val  Loss: 1.5167 | Val  Acc: 0.4560
 Site-East_Asian                (1) | Val  Loss: 1.5455 | Val  Acc: 0.4620
 Site-Indian_utk                (0) | Val  Loss: 1.5288 | Val  Acc: 0.4483
 Site-Indian_utk                (0) | Val  Loss: 1.3834 | Val  Acc: 0.5116
 Site-Indian_utk                (6) | Val  Loss: 1.4741 | Val  Acc: 0.5397
 Site-Indian_utk                (6) | Val  Loss: 1.5418 | Val  Acc: 0.4783
 Site-Indian_utk                (6) | Val  Loss: 1.3922 | Val  Acc: 0.4632
 Site-Black_utk                 (5) | Val  Loss: 1.5828 | Val  Acc: 0.5278
 Site-Black_utk                 (4) | Val  Loss: 1.5778 | Val  Acc: 0.4259
 Site-Black_utk                 (4) | Val  Loss: 1.5423 | Val  Acc: 0.4304
 Site-Southeast_Asian           (1) | Val  Loss: 1.8235 | Val  Acc: 0.3529
 Site-Southeast_Asian           (1) | Val  Loss: 1.6344 | Val  Acc: 0.4100
 Site-Asian_ffhq                (3) | Val  Loss: 1.5945 | Val  Acc: 0.5478
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8842 | Val  Acc: 0.1667
Average Valid Accuracy: 0.4414
============ Train epoch 32 ============
cnt=[1, 9, 1, 8, 2, 3, 5, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-White_utk                 (3) | Train Loss: 1.3451 | Train Acc: 0.3333
 Site-White_utk                 (0) | Train Loss: 1.5299 | Train Acc: 0.3529
 Site-White_utk                 (2) | Train Loss: 1.5067 | Train Acc: 0.4231
 Site-White_utk                 (3) | Train Loss: 1.6216 | Train Acc: 0.3421
 Site-White_utk                 (3) | Train Loss: 1.5195 | Train Acc: 0.4643
 Site-White_utk                 (3) | Train Loss: 1.5430 | Train Acc: 0.4024
 Site-White_utk                 (3) | Train Loss: 1.5348 | Train Acc: 0.4132
 Site-White_utk                 (3) | Train Loss: 1.6255 | Train Acc: 0.3799
 Site-White_utk                 (3) | Train Loss: 1.6367 | Train Acc: 0.4144
 Site-White_utk                 (3) | Train Loss: 1.5220 | Train Acc: 0.4548
 Site-East_Asian                (1) | Train Loss: 1.4050 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.4502 | Train Acc: 0.5250
 Site-East_Asian                (1) | Train Loss: 1.6754 | Train Acc: 0.3559
 Site-East_Asian                (1) | Train Loss: 1.7544 | Train Acc: 0.4302
 Site-East_Asian                (1) | Train Loss: 1.5578 | Train Acc: 0.4331
 Site-East_Asian                (1) | Train Loss: 1.5506 | Train Acc: 0.4332
 Site-East_Asian                (1) | Train Loss: 1.5293 | Train Acc: 0.4529
 Site-Indian_utk                (6) | Train Loss: 1.4828 | Train Acc: 0.4884
 Site-Indian_utk                (6) | Train Loss: 1.4386 | Train Acc: 0.5156
 Site-Indian_utk                (6) | Train Loss: 1.5010 | Train Acc: 0.4468
 Site-Indian_utk                (6) | Train Loss: 1.4468 | Train Acc: 0.4820
 Site-Indian_utk                (6) | Train Loss: 1.4957 | Train Acc: 0.5024
 Site-Black_utk                 (5) | Train Loss: 1.5820 | Train Acc: 0.4364
 Site-Black_utk                 (5) | Train Loss: 1.5571 | Train Acc: 0.4444
 Site-Black_utk                 (5) | Train Loss: 1.5880 | Train Acc: 0.4622
 Site-Southeast_Asian           (1) | Train Loss: 1.7160 | Train Acc: 0.3922
 Site-Southeast_Asian           (1) | Train Loss: 1.6545 | Train Acc: 0.3867
 Site-Asian_ffhq                (4) | Train Loss: 1.5800 | Train Acc: 0.5988
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5745 | Train Acc: 0.5556
Average Train Accuracy: 0.4415
 Site-White_utk                 (3) | Val  Loss: 1.4422 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.5684 | Val  Acc: 0.3636
 Site-White_utk                 (2) | Val  Loss: 1.6508 | Val  Acc: 0.4118
 Site-White_utk                 (3) | Val  Loss: 1.4939 | Val  Acc: 0.4400
 Site-White_utk                 (3) | Val  Loss: 1.4959 | Val  Acc: 0.4324
 Site-White_utk                 (3) | Val  Loss: 1.5927 | Val  Acc: 0.4000
 Site-White_utk                 (3) | Val  Loss: 1.6297 | Val  Acc: 0.3827
 Site-White_utk                 (3) | Val  Loss: 1.6014 | Val  Acc: 0.3529
 Site-White_utk                 (3) | Val  Loss: 1.6324 | Val  Acc: 0.3714
 Site-White_utk                 (3) | Val  Loss: 1.6654 | Val  Acc: 0.3527
 Site-East_Asian                (1) | Val  Loss: 1.7122 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.4242 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.4553 | Val  Acc: 0.4872
 Site-East_Asian                (1) | Val  Loss: 1.5037 | Val  Acc: 0.4561
 Site-East_Asian                (1) | Val  Loss: 1.5501 | Val  Acc: 0.4471
 Site-East_Asian                (1) | Val  Loss: 1.5195 | Val  Acc: 0.4400
 Site-East_Asian                (1) | Val  Loss: 1.5465 | Val  Acc: 0.4620
 Site-Indian_utk                (6) | Val  Loss: 1.5381 | Val  Acc: 0.5172
 Site-Indian_utk                (6) | Val  Loss: 1.4103 | Val  Acc: 0.5116
 Site-Indian_utk                (6) | Val  Loss: 1.4850 | Val  Acc: 0.5079
 Site-Indian_utk                (6) | Val  Loss: 1.5207 | Val  Acc: 0.4674
 Site-Indian_utk                (6) | Val  Loss: 1.3859 | Val  Acc: 0.5147
 Site-Black_utk                 (5) | Val  Loss: 1.5858 | Val  Acc: 0.5000
 Site-Black_utk                 (5) | Val  Loss: 1.6345 | Val  Acc: 0.3704
 Site-Black_utk                 (5) | Val  Loss: 1.5593 | Val  Acc: 0.4684
 Site-Southeast_Asian           (1) | Val  Loss: 1.6298 | Val  Acc: 0.3971
 Site-Southeast_Asian           (1) | Val  Loss: 1.6377 | Val  Acc: 0.4500
 Site-Asian_ffhq                (4) | Val  Loss: 1.6023 | Val  Acc: 0.5304
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8678 | Val  Acc: 0.1282
Average Valid Accuracy: 0.4309
============ Train epoch 33 ============
cnt=[5, 9, 1, 9, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-White_utk                 (6) | Train Loss: 1.3839 | Train Acc: 0.4167
 Site-White_utk                 (3) | Train Loss: 1.4874 | Train Acc: 0.4118
 Site-White_utk                 (3) | Train Loss: 1.5385 | Train Acc: 0.4231
 Site-White_utk                 (3) | Train Loss: 1.6282 | Train Acc: 0.3158
 Site-White_utk                 (3) | Train Loss: 1.5181 | Train Acc: 0.4464
 Site-White_utk                 (3) | Train Loss: 1.5439 | Train Acc: 0.4268
 Site-White_utk                 (3) | Train Loss: 1.5437 | Train Acc: 0.4050
 Site-White_utk                 (3) | Train Loss: 1.6238 | Train Acc: 0.3799
 Site-White_utk                 (3) | Train Loss: 1.5725 | Train Acc: 0.4144
 Site-White_utk                 (3) | Train Loss: 1.5564 | Train Acc: 0.4755
 Site-East_Asian                (1) | Train Loss: 1.4540 | Train Acc: 0.5185
 Site-East_Asian                (1) | Train Loss: 1.3943 | Train Acc: 0.5750
 Site-East_Asian                (1) | Train Loss: 1.6442 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.6597 | Train Acc: 0.4070
 Site-East_Asian                (1) | Train Loss: 1.5263 | Train Acc: 0.4803
 Site-East_Asian                (1) | Train Loss: 1.5300 | Train Acc: 0.4332
 Site-East_Asian                (1) | Train Loss: 1.4971 | Train Acc: 0.4493
 Site-Indian_utk                (0) | Train Loss: 1.4839 | Train Acc: 0.4651
 Site-Indian_utk                (0) | Train Loss: 1.4993 | Train Acc: 0.4844
 Site-Indian_utk                (0) | Train Loss: 1.4718 | Train Acc: 0.4681
 Site-Indian_utk                (0) | Train Loss: 1.4996 | Train Acc: 0.4748
 Site-Indian_utk                (0) | Train Loss: 1.4673 | Train Acc: 0.4732
 Site-Black_utk                 (4) | Train Loss: 1.5067 | Train Acc: 0.5091
 Site-Black_utk                 (4) | Train Loss: 1.5445 | Train Acc: 0.4444
 Site-Black_utk                 (4) | Train Loss: 1.5729 | Train Acc: 0.4706
 Site-Southeast_Asian           (1) | Train Loss: 1.6802 | Train Acc: 0.4118
 Site-Southeast_Asian           (1) | Train Loss: 1.6678 | Train Acc: 0.4133
 Site-Asian_ffhq                (5) | Train Loss: 1.6081 | Train Acc: 0.5988
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6018 | Train Acc: 0.5556
Average Train Accuracy: 0.4524
 Site-White_utk                 (6) | Val  Loss: 1.3683 | Val  Acc: 0.5000
 Site-White_utk                 (3) | Val  Loss: 1.5012 | Val  Acc: 0.3636
 Site-White_utk                 (3) | Val  Loss: 1.5724 | Val  Acc: 0.4706
 Site-White_utk                 (3) | Val  Loss: 1.5158 | Val  Acc: 0.4000
 Site-White_utk                 (3) | Val  Loss: 1.5209 | Val  Acc: 0.4054
 Site-White_utk                 (3) | Val  Loss: 1.5788 | Val  Acc: 0.4000
 Site-White_utk                 (3) | Val  Loss: 1.6541 | Val  Acc: 0.3827
 Site-White_utk                 (3) | Val  Loss: 1.5613 | Val  Acc: 0.3782
 Site-White_utk                 (3) | Val  Loss: 1.6242 | Val  Acc: 0.3943
 Site-White_utk                 (3) | Val  Loss: 1.6598 | Val  Acc: 0.3915
 Site-East_Asian                (1) | Val  Loss: 1.5883 | Val  Acc: 0.3889
 Site-East_Asian                (1) | Val  Loss: 1.4789 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.4925 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.5405 | Val  Acc: 0.4035
 Site-East_Asian                (1) | Val  Loss: 1.5196 | Val  Acc: 0.4706
 Site-East_Asian                (1) | Val  Loss: 1.5137 | Val  Acc: 0.4400
 Site-East_Asian                (1) | Val  Loss: 1.5413 | Val  Acc: 0.4674
 Site-Indian_utk                (0) | Val  Loss: 1.4685 | Val  Acc: 0.5517
 Site-Indian_utk                (0) | Val  Loss: 1.4058 | Val  Acc: 0.5581
 Site-Indian_utk                (0) | Val  Loss: 1.4756 | Val  Acc: 0.5238
 Site-Indian_utk                (0) | Val  Loss: 1.5765 | Val  Acc: 0.5000
 Site-Indian_utk                (0) | Val  Loss: 1.3571 | Val  Acc: 0.4853
 Site-Black_utk                 (4) | Val  Loss: 1.6718 | Val  Acc: 0.4444
 Site-Black_utk                 (4) | Val  Loss: 1.6043 | Val  Acc: 0.4074
 Site-Black_utk                 (4) | Val  Loss: 1.5469 | Val  Acc: 0.4430
 Site-Southeast_Asian           (1) | Val  Loss: 1.8279 | Val  Acc: 0.3676
 Site-Southeast_Asian           (1) | Val  Loss: 1.6229 | Val  Acc: 0.4300
 Site-Asian_ffhq                (5) | Val  Loss: 1.5859 | Val  Acc: 0.5652
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9391 | Val  Acc: 0.1154
Average Valid Accuracy: 0.4335
============ Train epoch 34 ============
cnt=[1, 9, 10, 1, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-White_utk                 (6) | Train Loss: 1.3771 | Train Acc: 0.4167
 Site-White_utk                 (2) | Train Loss: 1.4838 | Train Acc: 0.4118
 Site-White_utk                 (0) | Train Loss: 1.4506 | Train Acc: 0.4231
 Site-White_utk                 (2) | Train Loss: 1.6812 | Train Acc: 0.2632
 Site-White_utk                 (2) | Train Loss: 1.4945 | Train Acc: 0.4286
 Site-White_utk                 (2) | Train Loss: 1.5887 | Train Acc: 0.4634
 Site-White_utk                 (2) | Train Loss: 1.5602 | Train Acc: 0.3719
 Site-White_utk                 (2) | Train Loss: 1.6182 | Train Acc: 0.3799
 Site-White_utk                 (2) | Train Loss: 1.6379 | Train Acc: 0.4373
 Site-White_utk                 (2) | Train Loss: 1.4733 | Train Acc: 0.4625
 Site-East_Asian                (1) | Train Loss: 1.3984 | Train Acc: 0.5185
 Site-East_Asian                (1) | Train Loss: 1.3925 | Train Acc: 0.5250
 Site-East_Asian                (1) | Train Loss: 1.5842 | Train Acc: 0.3898
 Site-East_Asian                (1) | Train Loss: 1.5849 | Train Acc: 0.4070
 Site-East_Asian                (1) | Train Loss: 1.5524 | Train Acc: 0.4646
 Site-East_Asian                (1) | Train Loss: 1.5396 | Train Acc: 0.4011
 Site-East_Asian                (1) | Train Loss: 1.4952 | Train Acc: 0.4493
 Site-Indian_utk                (3) | Train Loss: 1.5791 | Train Acc: 0.4186
 Site-Indian_utk                (5) | Train Loss: 1.4926 | Train Acc: 0.4844
 Site-Indian_utk                (5) | Train Loss: 1.4459 | Train Acc: 0.4468
 Site-Indian_utk                (5) | Train Loss: 1.5087 | Train Acc: 0.4820
 Site-Indian_utk                (5) | Train Loss: 1.4556 | Train Acc: 0.4683
 Site-Black_utk                 (5) | Train Loss: 1.5572 | Train Acc: 0.5091
 Site-Black_utk                 (2) | Train Loss: 1.5069 | Train Acc: 0.4815
 Site-Black_utk                 (2) | Train Loss: 1.5575 | Train Acc: 0.4790
 Site-Southeast_Asian           (1) | Train Loss: 1.7330 | Train Acc: 0.4020
 Site-Southeast_Asian           (1) | Train Loss: 1.6419 | Train Acc: 0.3733
 Site-Asian_ffhq                (4) | Train Loss: 1.5996 | Train Acc: 0.6047
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5752 | Train Acc: 0.5812
Average Train Accuracy: 0.4464
 Site-White_utk                 (6) | Val  Loss: 1.3213 | Val  Acc: 0.6250
 Site-White_utk                 (2) | Val  Loss: 1.6543 | Val  Acc: 0.4545
 Site-White_utk                 (0) | Val  Loss: 1.5388 | Val  Acc: 0.5294
 Site-White_utk                 (2) | Val  Loss: 1.4463 | Val  Acc: 0.4400
 Site-White_utk                 (2) | Val  Loss: 1.5317 | Val  Acc: 0.4054
 Site-White_utk                 (2) | Val  Loss: 1.5797 | Val  Acc: 0.3818
 Site-White_utk                 (2) | Val  Loss: 1.5913 | Val  Acc: 0.4321
 Site-White_utk                 (2) | Val  Loss: 1.5472 | Val  Acc: 0.3782
 Site-White_utk                 (2) | Val  Loss: 1.6219 | Val  Acc: 0.3829
 Site-White_utk                 (2) | Val  Loss: 1.6702 | Val  Acc: 0.4031
 Site-East_Asian                (1) | Val  Loss: 1.5959 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.3661 | Val  Acc: 0.5385
 Site-East_Asian                (1) | Val  Loss: 1.4921 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.5344 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.4933 | Val  Acc: 0.4824
 Site-East_Asian                (1) | Val  Loss: 1.5030 | Val  Acc: 0.4480
 Site-East_Asian                (1) | Val  Loss: 1.5491 | Val  Acc: 0.4674
 Site-Indian_utk                (3) | Val  Loss: 1.5076 | Val  Acc: 0.5172
 Site-Indian_utk                (5) | Val  Loss: 1.3696 | Val  Acc: 0.5814
 Site-Indian_utk                (5) | Val  Loss: 1.4768 | Val  Acc: 0.4921
 Site-Indian_utk                (5) | Val  Loss: 1.5384 | Val  Acc: 0.4674
 Site-Indian_utk                (5) | Val  Loss: 1.3441 | Val  Acc: 0.4706
 Site-Black_utk                 (5) | Val  Loss: 1.5113 | Val  Acc: 0.5833
 Site-Black_utk                 (2) | Val  Loss: 1.6030 | Val  Acc: 0.3704
 Site-Black_utk                 (2) | Val  Loss: 1.5198 | Val  Acc: 0.4430
 Site-Southeast_Asian           (1) | Val  Loss: 1.6525 | Val  Acc: 0.3824
 Site-Southeast_Asian           (1) | Val  Loss: 1.6217 | Val  Acc: 0.4100
 Site-Asian_ffhq                (4) | Val  Loss: 1.5995 | Val  Acc: 0.5304
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8675 | Val  Acc: 0.1795
Average Valid Accuracy: 0.4487
 Best site-White_utk                (6)  | Epoch:34 | Val Acc: 0.6250
 Best site-White_utk                (2)  | Epoch:34 | Val Acc: 0.4545
 Best site-White_utk                (0)  | Epoch:34 | Val Acc: 0.5294
 Best site-White_utk                (2)  | Epoch:34 | Val Acc: 0.4400
 Best site-White_utk                (2)  | Epoch:34 | Val Acc: 0.4054
 Best site-White_utk                (2)  | Epoch:34 | Val Acc: 0.3818
 Best site-White_utk                (2)  | Epoch:34 | Val Acc: 0.4321
 Best site-White_utk                (2)  | Epoch:34 | Val Acc: 0.3782
 Best site-White_utk                (2)  | Epoch:34 | Val Acc: 0.3829
 Best site-White_utk                (2)  | Epoch:34 | Val Acc: 0.4031
 Best site-East_Asian               (1)  | Epoch:34 | Val Acc: 0.3333
 Best site-East_Asian               (1)  | Epoch:34 | Val Acc: 0.5385
 Best site-East_Asian               (1)  | Epoch:34 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:34 | Val Acc: 0.4211
 Best site-East_Asian               (1)  | Epoch:34 | Val Acc: 0.4824
 Best site-East_Asian               (1)  | Epoch:34 | Val Acc: 0.4480
 Best site-East_Asian               (1)  | Epoch:34 | Val Acc: 0.4674
 Best site-Indian_utk               (3)  | Epoch:34 | Val Acc: 0.5172
 Best site-Indian_utk               (5)  | Epoch:34 | Val Acc: 0.5814
 Best site-Indian_utk               (5)  | Epoch:34 | Val Acc: 0.4921
 Best site-Indian_utk               (5)  | Epoch:34 | Val Acc: 0.4674
 Best site-Indian_utk               (5)  | Epoch:34 | Val Acc: 0.4706
 Best site-Black_utk                (5)  | Epoch:34 | Val Acc: 0.5833
 Best site-Black_utk                (2)  | Epoch:34 | Val Acc: 0.3704
 Best site-Black_utk                (2)  | Epoch:34 | Val Acc: 0.4430
 Best site-Southeast_Asian          (1)  | Epoch:34 | Val Acc: 0.3824
 Best site-Southeast_Asian          (1)  | Epoch:34 | Val Acc: 0.4100
 Best site-Asian_ffhq               (4)  | Epoch:34 | Val Acc: 0.5304
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:34 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Test site-White_utk                 (6)| Epoch:34 | Test Acc: 0.3864
 Test site-East_Asian                (1)| Epoch:34 | Test Acc: 0.4806
 Test site-Indian_utk                (3)| Epoch:34 | Test Acc: 0.4875
 Test site-Black_utk                 (5)| Epoch:34 | Test Acc: 0.4031
 Test site-Southeast_Asian           (1)| Epoch:34 | Test Acc: 0.4090
 Test site-Asian_ffhq                (4)| Epoch:34 | Test Acc: 0.2188
 Test site-Latino_Hispanic_ffhq      (4)| Epoch:34 | Test Acc: 0.2139
White_utk: 0.3864, East_Asian: 0.4806, Indian_utk: 0.4875, Black_utk: 0.4031, Southeast_Asian: 0.4090, Asian_ffhq: 0.2188, Latino_Hispanic_ffhq: 0.2139, 
Average Test Accuracy(group): 0.3713, Average Test Accuracy(individual): 0.4181,
domain std=0.1043, cluster std=0.0854, individual std=0.0704, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 35 ============
cnt=[8, 5, 2, 1, 9, 1, 3, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-White_utk                 (3) | Train Loss: 1.4430 | Train Acc: 0.3333
 Site-White_utk                 (4) | Train Loss: 1.5463 | Train Acc: 0.4118
 Site-White_utk                 (4) | Train Loss: 1.5241 | Train Acc: 0.3846
 Site-White_utk                 (4) | Train Loss: 1.6635 | Train Acc: 0.3158
 Site-White_utk                 (4) | Train Loss: 1.4604 | Train Acc: 0.4821
 Site-White_utk                 (4) | Train Loss: 1.6127 | Train Acc: 0.4390
 Site-White_utk                 (4) | Train Loss: 1.5154 | Train Acc: 0.4050
 Site-White_utk                 (4) | Train Loss: 1.6281 | Train Acc: 0.3743
 Site-White_utk                 (4) | Train Loss: 1.5252 | Train Acc: 0.3878
 Site-White_utk                 (4) | Train Loss: 1.5556 | Train Acc: 0.4444
 Site-East_Asian                (5) | Train Loss: 1.4026 | Train Acc: 0.4815
 Site-East_Asian                (0) | Train Loss: 1.4080 | Train Acc: 0.5250
 Site-East_Asian                (0) | Train Loss: 1.6256 | Train Acc: 0.3898
 Site-East_Asian                (0) | Train Loss: 1.5053 | Train Acc: 0.4186
 Site-East_Asian                (0) | Train Loss: 1.5272 | Train Acc: 0.4409
 Site-East_Asian                (0) | Train Loss: 1.5316 | Train Acc: 0.4278
 Site-East_Asian                (0) | Train Loss: 1.4909 | Train Acc: 0.4457
 Site-Indian_utk                (1) | Train Loss: 1.4039 | Train Acc: 0.5581
 Site-Indian_utk                (1) | Train Loss: 1.4828 | Train Acc: 0.5312
 Site-Indian_utk                (1) | Train Loss: 1.4606 | Train Acc: 0.4681
 Site-Indian_utk                (1) | Train Loss: 1.5215 | Train Acc: 0.4892
 Site-Indian_utk                (1) | Train Loss: 1.4838 | Train Acc: 0.4976
 Site-Black_utk                 (6) | Train Loss: 1.5866 | Train Acc: 0.4727
 Site-Black_utk                 (6) | Train Loss: 1.6293 | Train Acc: 0.4198
 Site-Black_utk                 (6) | Train Loss: 1.5750 | Train Acc: 0.4706
 Site-Southeast_Asian           (0) | Train Loss: 1.6844 | Train Acc: 0.4020
 Site-Southeast_Asian           (0) | Train Loss: 1.6413 | Train Acc: 0.4000
 Site-Asian_ffhq                (2) | Train Loss: 1.6267 | Train Acc: 0.5988
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5816 | Train Acc: 0.5726
Average Train Accuracy: 0.4479
 Site-White_utk                 (3) | Val  Loss: 1.3706 | Val  Acc: 0.5000
 Site-White_utk                 (4) | Val  Loss: 1.5500 | Val  Acc: 0.4545
 Site-White_utk                 (4) | Val  Loss: 1.6121 | Val  Acc: 0.4118
 Site-White_utk                 (4) | Val  Loss: 1.4597 | Val  Acc: 0.4400
 Site-White_utk                 (4) | Val  Loss: 1.4701 | Val  Acc: 0.3514
 Site-White_utk                 (4) | Val  Loss: 1.5470 | Val  Acc: 0.3636
 Site-White_utk                 (4) | Val  Loss: 1.5553 | Val  Acc: 0.4321
 Site-White_utk                 (4) | Val  Loss: 1.5306 | Val  Acc: 0.4286
 Site-White_utk                 (4) | Val  Loss: 1.5952 | Val  Acc: 0.3771
 Site-White_utk                 (4) | Val  Loss: 1.6394 | Val  Acc: 0.3953
 Site-East_Asian                (5) | Val  Loss: 1.6733 | Val  Acc: 0.2778
 Site-East_Asian                (0) | Val  Loss: 1.4454 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.4632 | Val  Acc: 0.4872
 Site-East_Asian                (0) | Val  Loss: 1.5249 | Val  Acc: 0.4386
 Site-East_Asian                (0) | Val  Loss: 1.5369 | Val  Acc: 0.4706
 Site-East_Asian                (0) | Val  Loss: 1.4906 | Val  Acc: 0.4640
 Site-East_Asian                (0) | Val  Loss: 1.5274 | Val  Acc: 0.4511
 Site-Indian_utk                (1) | Val  Loss: 1.4959 | Val  Acc: 0.4483
 Site-Indian_utk                (1) | Val  Loss: 1.3374 | Val  Acc: 0.5349
 Site-Indian_utk                (1) | Val  Loss: 1.4609 | Val  Acc: 0.5238
 Site-Indian_utk                (1) | Val  Loss: 1.5678 | Val  Acc: 0.4565
 Site-Indian_utk                (1) | Val  Loss: 1.3257 | Val  Acc: 0.4926
 Site-Black_utk                 (6) | Val  Loss: 1.5403 | Val  Acc: 0.6111
 Site-Black_utk                 (6) | Val  Loss: 1.5748 | Val  Acc: 0.4815
 Site-Black_utk                 (6) | Val  Loss: 1.5215 | Val  Acc: 0.3797
 Site-Southeast_Asian           (0) | Val  Loss: 1.6832 | Val  Acc: 0.4118
 Site-Southeast_Asian           (0) | Val  Loss: 1.6400 | Val  Acc: 0.4200
 Site-Asian_ffhq                (2) | Val  Loss: 1.6083 | Val  Acc: 0.5478
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8945 | Val  Acc: 0.1410
Average Valid Accuracy: 0.4364
============ Train epoch 36 ============
cnt=[2, 9, 10, 2, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-White_utk                 (2) | Train Loss: 1.4190 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 1.5286 | Train Acc: 0.3529
 Site-White_utk                 (2) | Train Loss: 1.5137 | Train Acc: 0.5000
 Site-White_utk                 (2) | Train Loss: 1.6786 | Train Acc: 0.2895
 Site-White_utk                 (2) | Train Loss: 1.4966 | Train Acc: 0.4464
 Site-White_utk                 (2) | Train Loss: 1.5677 | Train Acc: 0.4512
 Site-White_utk                 (2) | Train Loss: 1.5318 | Train Acc: 0.4380
 Site-White_utk                 (2) | Train Loss: 1.6270 | Train Acc: 0.3687
 Site-White_utk                 (2) | Train Loss: 1.5006 | Train Acc: 0.4068
 Site-White_utk                 (2) | Train Loss: 1.4754 | Train Acc: 0.4729
 Site-East_Asian                (1) | Train Loss: 1.3585 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.3741 | Train Acc: 0.5500
 Site-East_Asian                (1) | Train Loss: 1.6332 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.6541 | Train Acc: 0.4419
 Site-East_Asian                (1) | Train Loss: 1.5330 | Train Acc: 0.4567
 Site-East_Asian                (1) | Train Loss: 1.5365 | Train Acc: 0.4225
 Site-East_Asian                (1) | Train Loss: 1.4450 | Train Acc: 0.4638
 Site-Indian_utk                (6) | Train Loss: 1.4015 | Train Acc: 0.5581
 Site-Indian_utk                (6) | Train Loss: 1.4542 | Train Acc: 0.5156
 Site-Indian_utk                (4) | Train Loss: 1.5127 | Train Acc: 0.4362
 Site-Indian_utk                (4) | Train Loss: 1.5677 | Train Acc: 0.4532
 Site-Indian_utk                (4) | Train Loss: 1.4302 | Train Acc: 0.5268
 Site-Black_utk                 (5) | Train Loss: 1.5032 | Train Acc: 0.4545
 Site-Black_utk                 (0) | Train Loss: 1.6306 | Train Acc: 0.4074
 Site-Black_utk                 (0) | Train Loss: 1.5531 | Train Acc: 0.5042
 Site-Southeast_Asian           (1) | Train Loss: 1.7176 | Train Acc: 0.3922
 Site-Southeast_Asian           (1) | Train Loss: 1.6912 | Train Acc: 0.3667
 Site-Asian_ffhq                (3) | Train Loss: 1.5435 | Train Acc: 0.6395
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.5362 | Train Acc: 0.5726
Average Train Accuracy: 0.4509
 Site-White_utk                 (2) | Val  Loss: 1.2785 | Val  Acc: 0.7500
 Site-White_utk                 (2) | Val  Loss: 1.5134 | Val  Acc: 0.3636
 Site-White_utk                 (2) | Val  Loss: 1.5138 | Val  Acc: 0.4118
 Site-White_utk                 (2) | Val  Loss: 1.4821 | Val  Acc: 0.4800
 Site-White_utk                 (2) | Val  Loss: 1.5017 | Val  Acc: 0.4054
 Site-White_utk                 (2) | Val  Loss: 1.5596 | Val  Acc: 0.4364
 Site-White_utk                 (2) | Val  Loss: 1.6320 | Val  Acc: 0.3704
 Site-White_utk                 (2) | Val  Loss: 1.5568 | Val  Acc: 0.3866
 Site-White_utk                 (2) | Val  Loss: 1.6011 | Val  Acc: 0.3943
 Site-White_utk                 (2) | Val  Loss: 1.6477 | Val  Acc: 0.3798
 Site-East_Asian                (1) | Val  Loss: 1.5795 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.4517 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.4621 | Val  Acc: 0.4359
 Site-East_Asian                (1) | Val  Loss: 1.4944 | Val  Acc: 0.4737
 Site-East_Asian                (1) | Val  Loss: 1.4898 | Val  Acc: 0.4824
 Site-East_Asian                (1) | Val  Loss: 1.4994 | Val  Acc: 0.4400
 Site-East_Asian                (1) | Val  Loss: 1.5160 | Val  Acc: 0.4565
 Site-Indian_utk                (6) | Val  Loss: 1.5209 | Val  Acc: 0.4828
 Site-Indian_utk                (6) | Val  Loss: 1.3621 | Val  Acc: 0.5116
 Site-Indian_utk                (4) | Val  Loss: 1.4782 | Val  Acc: 0.4921
 Site-Indian_utk                (4) | Val  Loss: 1.5387 | Val  Acc: 0.5109
 Site-Indian_utk                (4) | Val  Loss: 1.3479 | Val  Acc: 0.4853
 Site-Black_utk                 (5) | Val  Loss: 1.5459 | Val  Acc: 0.4722
 Site-Black_utk                 (0) | Val  Loss: 1.5790 | Val  Acc: 0.3519
 Site-Black_utk                 (0) | Val  Loss: 1.5028 | Val  Acc: 0.4430
 Site-Southeast_Asian           (1) | Val  Loss: 1.7410 | Val  Acc: 0.3824
 Site-Southeast_Asian           (1) | Val  Loss: 1.6502 | Val  Acc: 0.3800
 Site-Asian_ffhq                (3) | Val  Loss: 1.5494 | Val  Acc: 0.5478
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.9241 | Val  Acc: 0.0897
Average Valid Accuracy: 0.4343
============ Train epoch 37 ============
cnt=[5, 1, 2, 2, 11, 1, 7, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-White_utk                 (3) | Train Loss: 1.4277 | Train Acc: 0.3333
 Site-White_utk                 (4) | Train Loss: 1.4895 | Train Acc: 0.4118
 Site-White_utk                 (4) | Train Loss: 1.5575 | Train Acc: 0.4615
 Site-White_utk                 (4) | Train Loss: 1.6215 | Train Acc: 0.2895
 Site-White_utk                 (4) | Train Loss: 1.4624 | Train Acc: 0.4286
 Site-White_utk                 (3) | Train Loss: 1.5451 | Train Acc: 0.4390
 Site-White_utk                 (4) | Train Loss: 1.5590 | Train Acc: 0.3636
 Site-White_utk                 (4) | Train Loss: 1.6288 | Train Acc: 0.3575
 Site-White_utk                 (4) | Train Loss: 1.4955 | Train Acc: 0.4068
 Site-White_utk                 (4) | Train Loss: 1.5109 | Train Acc: 0.4444
 Site-East_Asian                (5) | Train Loss: 1.4252 | Train Acc: 0.4074
 Site-East_Asian                (6) | Train Loss: 1.4082 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.6340 | Train Acc: 0.3390
 Site-East_Asian                (6) | Train Loss: 1.6040 | Train Acc: 0.4302
 Site-East_Asian                (6) | Train Loss: 1.5497 | Train Acc: 0.4409
 Site-East_Asian                (6) | Train Loss: 1.5516 | Train Acc: 0.4011
 Site-East_Asian                (6) | Train Loss: 1.4904 | Train Acc: 0.4710
 Site-Indian_utk                (0) | Train Loss: 1.4663 | Train Acc: 0.4651
 Site-Indian_utk                (0) | Train Loss: 1.4312 | Train Acc: 0.5156
 Site-Indian_utk                (0) | Train Loss: 1.4200 | Train Acc: 0.4787
 Site-Indian_utk                (0) | Train Loss: 1.4997 | Train Acc: 0.4820
 Site-Indian_utk                (0) | Train Loss: 1.4571 | Train Acc: 0.4976
 Site-Black_utk                 (4) | Train Loss: 1.4799 | Train Acc: 0.5091
 Site-Black_utk                 (4) | Train Loss: 1.5775 | Train Acc: 0.4074
 Site-Black_utk                 (4) | Train Loss: 1.5443 | Train Acc: 0.4706
 Site-Southeast_Asian           (6) | Train Loss: 1.6830 | Train Acc: 0.4118
 Site-Southeast_Asian           (6) | Train Loss: 1.6402 | Train Acc: 0.4000
 Site-Asian_ffhq                (2) | Train Loss: 1.5480 | Train Acc: 0.5988
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5321 | Train Acc: 0.5983
Average Train Accuracy: 0.4400
 Site-White_utk                 (3) | Val  Loss: 1.2848 | Val  Acc: 0.5000
 Site-White_utk                 (4) | Val  Loss: 1.4872 | Val  Acc: 0.3636
 Site-White_utk                 (4) | Val  Loss: 1.5483 | Val  Acc: 0.5294
 Site-White_utk                 (4) | Val  Loss: 1.4407 | Val  Acc: 0.4000
 Site-White_utk                 (4) | Val  Loss: 1.5120 | Val  Acc: 0.4324
 Site-White_utk                 (3) | Val  Loss: 1.5406 | Val  Acc: 0.3818
 Site-White_utk                 (4) | Val  Loss: 1.5750 | Val  Acc: 0.4198
 Site-White_utk                 (4) | Val  Loss: 1.5531 | Val  Acc: 0.4202
 Site-White_utk                 (4) | Val  Loss: 1.6009 | Val  Acc: 0.3829
 Site-White_utk                 (4) | Val  Loss: 1.6171 | Val  Acc: 0.4147
 Site-East_Asian                (5) | Val  Loss: 1.5489 | Val  Acc: 0.4444
 Site-East_Asian                (6) | Val  Loss: 1.4806 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.5097 | Val  Acc: 0.4103
 Site-East_Asian                (6) | Val  Loss: 1.5137 | Val  Acc: 0.4035
 Site-East_Asian                (6) | Val  Loss: 1.4987 | Val  Acc: 0.5059
 Site-East_Asian                (6) | Val  Loss: 1.5063 | Val  Acc: 0.4560
 Site-East_Asian                (6) | Val  Loss: 1.5182 | Val  Acc: 0.4565
 Site-Indian_utk                (0) | Val  Loss: 1.5025 | Val  Acc: 0.4483
 Site-Indian_utk                (0) | Val  Loss: 1.3482 | Val  Acc: 0.5116
 Site-Indian_utk                (0) | Val  Loss: 1.3915 | Val  Acc: 0.5397
 Site-Indian_utk                (0) | Val  Loss: 1.5241 | Val  Acc: 0.4674
 Site-Indian_utk                (0) | Val  Loss: 1.3641 | Val  Acc: 0.4926
 Site-Black_utk                 (4) | Val  Loss: 1.5225 | Val  Acc: 0.5556
 Site-Black_utk                 (4) | Val  Loss: 1.5745 | Val  Acc: 0.4444
 Site-Black_utk                 (4) | Val  Loss: 1.5249 | Val  Acc: 0.4177
 Site-Southeast_Asian           (6) | Val  Loss: 1.5818 | Val  Acc: 0.3824
 Site-Southeast_Asian           (6) | Val  Loss: 1.6251 | Val  Acc: 0.4200
 Site-Asian_ffhq                (2) | Val  Loss: 1.5677 | Val  Acc: 0.5391
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9383 | Val  Acc: 0.1154
Average Valid Accuracy: 0.4372
============ Train epoch 38 ============
cnt=[3, 9, 9, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-White_utk                 (2) | Train Loss: 1.4514 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.4476 | Train Acc: 0.4706
 Site-White_utk                 (2) | Train Loss: 1.5373 | Train Acc: 0.3846
 Site-White_utk                 (2) | Train Loss: 1.6111 | Train Acc: 0.3421
 Site-White_utk                 (2) | Train Loss: 1.4421 | Train Acc: 0.5000
 Site-White_utk                 (2) | Train Loss: 1.5209 | Train Acc: 0.4390
 Site-White_utk                 (2) | Train Loss: 1.4755 | Train Acc: 0.4380
 Site-White_utk                 (2) | Train Loss: 1.6093 | Train Acc: 0.3631
 Site-White_utk                 (2) | Train Loss: 1.4910 | Train Acc: 0.4068
 Site-White_utk                 (2) | Train Loss: 1.4374 | Train Acc: 0.4522
 Site-East_Asian                (1) | Train Loss: 1.4342 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.3914 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.6159 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.5371 | Train Acc: 0.4186
 Site-East_Asian                (1) | Train Loss: 1.5409 | Train Acc: 0.4567
 Site-East_Asian                (1) | Train Loss: 1.5216 | Train Acc: 0.4225
 Site-East_Asian                (1) | Train Loss: 1.4891 | Train Acc: 0.4529
 Site-Indian_utk                (3) | Train Loss: 1.4362 | Train Acc: 0.4651
 Site-Indian_utk                (3) | Train Loss: 1.4680 | Train Acc: 0.5000
 Site-Indian_utk                (3) | Train Loss: 1.4647 | Train Acc: 0.4362
 Site-Indian_utk                (3) | Train Loss: 1.6107 | Train Acc: 0.4892
 Site-Indian_utk                (3) | Train Loss: 1.4477 | Train Acc: 0.4878
 Site-Black_utk                 (0) | Train Loss: 1.5163 | Train Acc: 0.4909
 Site-Black_utk                 (0) | Train Loss: 1.5313 | Train Acc: 0.4444
 Site-Black_utk                 (0) | Train Loss: 1.5621 | Train Acc: 0.4538
 Site-Southeast_Asian           (1) | Train Loss: 1.6140 | Train Acc: 0.4118
 Site-Southeast_Asian           (1) | Train Loss: 1.6715 | Train Acc: 0.4200
 Site-Asian_ffhq                (6) | Train Loss: 1.5793 | Train Acc: 0.5930
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.5557 | Train Acc: 0.5385
Average Train Accuracy: 0.4500
 Site-White_utk                 (2) | Val  Loss: 1.2403 | Val  Acc: 0.6250
 Site-White_utk                 (4) | Val  Loss: 1.4880 | Val  Acc: 0.4545
 Site-White_utk                 (2) | Val  Loss: 1.5654 | Val  Acc: 0.4118
 Site-White_utk                 (2) | Val  Loss: 1.5032 | Val  Acc: 0.4400
 Site-White_utk                 (2) | Val  Loss: 1.4952 | Val  Acc: 0.3514
 Site-White_utk                 (2) | Val  Loss: 1.5261 | Val  Acc: 0.4182
 Site-White_utk                 (2) | Val  Loss: 1.5572 | Val  Acc: 0.3704
 Site-White_utk                 (2) | Val  Loss: 1.5623 | Val  Acc: 0.4034
 Site-White_utk                 (2) | Val  Loss: 1.5939 | Val  Acc: 0.4057
 Site-White_utk                 (2) | Val  Loss: 1.6243 | Val  Acc: 0.3915
 Site-East_Asian                (1) | Val  Loss: 1.7163 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.4665 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.4127 | Val  Acc: 0.5385
 Site-East_Asian                (1) | Val  Loss: 1.4927 | Val  Acc: 0.4386
 Site-East_Asian                (1) | Val  Loss: 1.4837 | Val  Acc: 0.4824
 Site-East_Asian                (1) | Val  Loss: 1.5357 | Val  Acc: 0.4720
 Site-East_Asian                (1) | Val  Loss: 1.4994 | Val  Acc: 0.4674
 Site-Indian_utk                (3) | Val  Loss: 1.4593 | Val  Acc: 0.5172
 Site-Indian_utk                (3) | Val  Loss: 1.4351 | Val  Acc: 0.3721
 Site-Indian_utk                (3) | Val  Loss: 1.4024 | Val  Acc: 0.5238
 Site-Indian_utk                (3) | Val  Loss: 1.5362 | Val  Acc: 0.5109
 Site-Indian_utk                (3) | Val  Loss: 1.3130 | Val  Acc: 0.4779
 Site-Black_utk                 (0) | Val  Loss: 1.5600 | Val  Acc: 0.5833
 Site-Black_utk                 (0) | Val  Loss: 1.5288 | Val  Acc: 0.4259
 Site-Black_utk                 (0) | Val  Loss: 1.5038 | Val  Acc: 0.4304
 Site-Southeast_Asian           (1) | Val  Loss: 1.7775 | Val  Acc: 0.3676
 Site-Southeast_Asian           (1) | Val  Loss: 1.6419 | Val  Acc: 0.4000
 Site-Asian_ffhq                (6) | Val  Loss: 1.5552 | Val  Acc: 0.5652
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.8740 | Val  Acc: 0.1026
Average Valid Accuracy: 0.4388
============ Train epoch 39 ============
cnt=[1, 1, 9, 10, 1, 6, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-White_utk                 (0) | Train Loss: 1.3680 | Train Acc: 0.4167
 Site-White_utk                 (3) | Train Loss: 1.5487 | Train Acc: 0.3529
 Site-White_utk                 (3) | Train Loss: 1.4252 | Train Acc: 0.5000
 Site-White_utk                 (1) | Train Loss: 1.6253 | Train Acc: 0.3421
 Site-White_utk                 (3) | Train Loss: 1.4406 | Train Acc: 0.4643
 Site-White_utk                 (3) | Train Loss: 1.4907 | Train Acc: 0.4634
 Site-White_utk                 (3) | Train Loss: 1.5010 | Train Acc: 0.4050
 Site-White_utk                 (3) | Train Loss: 1.5566 | Train Acc: 0.4413
 Site-White_utk                 (3) | Train Loss: 1.6023 | Train Acc: 0.4373
 Site-White_utk                 (3) | Train Loss: 1.4128 | Train Acc: 0.4806
 Site-East_Asian                (2) | Train Loss: 1.4107 | Train Acc: 0.4815
 Site-East_Asian                (2) | Train Loss: 1.4228 | Train Acc: 0.5250
 Site-East_Asian                (2) | Train Loss: 1.6103 | Train Acc: 0.3729
 Site-East_Asian                (2) | Train Loss: 1.5503 | Train Acc: 0.4186
 Site-East_Asian                (2) | Train Loss: 1.5297 | Train Acc: 0.4646
 Site-East_Asian                (2) | Train Loss: 1.5309 | Train Acc: 0.4385
 Site-East_Asian                (2) | Train Loss: 1.4211 | Train Acc: 0.4710
 Site-Indian_utk                (5) | Train Loss: 1.4392 | Train Acc: 0.4884
 Site-Indian_utk                (5) | Train Loss: 1.4863 | Train Acc: 0.4375
 Site-Indian_utk                (5) | Train Loss: 1.4181 | Train Acc: 0.4574
 Site-Indian_utk                (5) | Train Loss: 1.5232 | Train Acc: 0.4820
 Site-Indian_utk                (5) | Train Loss: 1.4177 | Train Acc: 0.5073
 Site-Black_utk                 (5) | Train Loss: 1.4785 | Train Acc: 0.4545
 Site-Black_utk                 (3) | Train Loss: 1.6006 | Train Acc: 0.4321
 Site-Black_utk                 (3) | Train Loss: 1.5666 | Train Acc: 0.4958
 Site-Southeast_Asian           (2) | Train Loss: 1.6637 | Train Acc: 0.3922
 Site-Southeast_Asian           (2) | Train Loss: 1.6653 | Train Acc: 0.4200
 Site-Asian_ffhq                (6) | Train Loss: 1.6169 | Train Acc: 0.5756
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5755 | Train Acc: 0.5385
Average Train Accuracy: 0.4537
 Site-White_utk                 (0) | Val  Loss: 1.2217 | Val  Acc: 0.6250
 Site-White_utk                 (3) | Val  Loss: 1.6047 | Val  Acc: 0.3636
 Site-White_utk                 (3) | Val  Loss: 1.5482 | Val  Acc: 0.4706
 Site-White_utk                 (1) | Val  Loss: 1.4580 | Val  Acc: 0.4800
 Site-White_utk                 (3) | Val  Loss: 1.3909 | Val  Acc: 0.3784
 Site-White_utk                 (3) | Val  Loss: 1.5258 | Val  Acc: 0.4364
 Site-White_utk                 (3) | Val  Loss: 1.5919 | Val  Acc: 0.4074
 Site-White_utk                 (3) | Val  Loss: 1.5079 | Val  Acc: 0.4622
 Site-White_utk                 (3) | Val  Loss: 1.5867 | Val  Acc: 0.4057
 Site-White_utk                 (3) | Val  Loss: 1.6366 | Val  Acc: 0.4109
 Site-East_Asian                (2) | Val  Loss: 1.6070 | Val  Acc: 0.3333
 Site-East_Asian                (2) | Val  Loss: 1.4601 | Val  Acc: 0.4231
 Site-East_Asian                (2) | Val  Loss: 1.4695 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.4830 | Val  Acc: 0.4386
 Site-East_Asian                (2) | Val  Loss: 1.4616 | Val  Acc: 0.5059
 Site-East_Asian                (2) | Val  Loss: 1.4764 | Val  Acc: 0.4480
 Site-East_Asian                (2) | Val  Loss: 1.5236 | Val  Acc: 0.4674
 Site-Indian_utk                (5) | Val  Loss: 1.4591 | Val  Acc: 0.4828
 Site-Indian_utk                (5) | Val  Loss: 1.4045 | Val  Acc: 0.5814
 Site-Indian_utk                (5) | Val  Loss: 1.3899 | Val  Acc: 0.5397
 Site-Indian_utk                (5) | Val  Loss: 1.5348 | Val  Acc: 0.4783
 Site-Indian_utk                (5) | Val  Loss: 1.3477 | Val  Acc: 0.4706
 Site-Black_utk                 (5) | Val  Loss: 1.5316 | Val  Acc: 0.5556
 Site-Black_utk                 (3) | Val  Loss: 1.5931 | Val  Acc: 0.4259
 Site-Black_utk                 (3) | Val  Loss: 1.4868 | Val  Acc: 0.4304
 Site-Southeast_Asian           (2) | Val  Loss: 1.5696 | Val  Acc: 0.3676
 Site-Southeast_Asian           (2) | Val  Loss: 1.6446 | Val  Acc: 0.4400
 Site-Asian_ffhq                (6) | Val  Loss: 1.6543 | Val  Acc: 0.5217
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8628 | Val  Acc: 0.1538
Average Valid Accuracy: 0.4471
 Test site-White_utk                 (0)| Epoch:34 | Test Acc: 0.3998
 Test site-East_Asian                (2)| Epoch:34 | Test Acc: 0.4726
 Test site-Indian_utk                (5)| Epoch:34 | Test Acc: 0.4979
 Test site-Black_utk                 (5)| Epoch:34 | Test Acc: 0.3827
 Test site-Southeast_Asian           (2)| Epoch:34 | Test Acc: 0.4090
 Test site-Asian_ffhq                (6)| Epoch:34 | Test Acc: 0.1967
 Test site-Latino_Hispanic_ffhq      (4)| Epoch:34 | Test Acc: 0.2040
White_utk: 0.3998, East_Asian: 0.4726, Indian_utk: 0.4979, Black_utk: 0.3827, Southeast_Asian: 0.4090, Asian_ffhq: 0.1967, Latino_Hispanic_ffhq: 0.2040, 
Average Test Accuracy(group): 0.3661, Average Test Accuracy(individual): 0.4194,
domain std=0.1115, cluster std=0.1064, individual std=0.0731, 
============ Train epoch 40 ============
cnt=[9, 2, 8, 3, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-White_utk                 (5) | Train Loss: 1.3677 | Train Acc: 0.5000
 Site-White_utk                 (0) | Train Loss: 1.4446 | Train Acc: 0.3529
 Site-White_utk                 (0) | Train Loss: 1.3806 | Train Acc: 0.5769
 Site-White_utk                 (0) | Train Loss: 1.6215 | Train Acc: 0.3947
 Site-White_utk                 (0) | Train Loss: 1.4843 | Train Acc: 0.4107
 Site-White_utk                 (0) | Train Loss: 1.4571 | Train Acc: 0.4390
 Site-White_utk                 (0) | Train Loss: 1.4863 | Train Acc: 0.3884
 Site-White_utk                 (0) | Train Loss: 1.5617 | Train Acc: 0.4190
 Site-White_utk                 (0) | Train Loss: 1.4907 | Train Acc: 0.4297
 Site-White_utk                 (0) | Train Loss: 1.4787 | Train Acc: 0.4548
 Site-East_Asian                (2) | Train Loss: 1.4329 | Train Acc: 0.4815
 Site-East_Asian                (6) | Train Loss: 1.3883 | Train Acc: 0.5500
 Site-East_Asian                (2) | Train Loss: 1.6704 | Train Acc: 0.3559
 Site-East_Asian                (2) | Train Loss: 1.6333 | Train Acc: 0.4419
 Site-East_Asian                (2) | Train Loss: 1.5167 | Train Acc: 0.4646
 Site-East_Asian                (2) | Train Loss: 1.5480 | Train Acc: 0.4332
 Site-East_Asian                (2) | Train Loss: 1.4537 | Train Acc: 0.4783
 Site-Indian_utk                (4) | Train Loss: 1.4876 | Train Acc: 0.4651
 Site-Indian_utk                (4) | Train Loss: 1.4134 | Train Acc: 0.5156
 Site-Indian_utk                (4) | Train Loss: 1.4649 | Train Acc: 0.4681
 Site-Indian_utk                (4) | Train Loss: 1.4482 | Train Acc: 0.4964
 Site-Indian_utk                (4) | Train Loss: 1.4631 | Train Acc: 0.4878
 Site-Black_utk                 (3) | Train Loss: 1.5315 | Train Acc: 0.4727
 Site-Black_utk                 (3) | Train Loss: 1.6968 | Train Acc: 0.3827
 Site-Black_utk                 (3) | Train Loss: 1.5391 | Train Acc: 0.4622
 Site-Southeast_Asian           (2) | Train Loss: 1.6736 | Train Acc: 0.3922
 Site-Southeast_Asian           (2) | Train Loss: 1.6648 | Train Acc: 0.4067
 Site-Asian_ffhq                (1) | Train Loss: 1.5186 | Train Acc: 0.6163
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.5314 | Train Acc: 0.5641
Average Train Accuracy: 0.4587
 Site-White_utk                 (5) | Val  Loss: 1.3179 | Val  Acc: 0.7500
 Site-White_utk                 (0) | Val  Loss: 1.5132 | Val  Acc: 0.3636
 Site-White_utk                 (0) | Val  Loss: 1.6000 | Val  Acc: 0.4706
 Site-White_utk                 (0) | Val  Loss: 1.3474 | Val  Acc: 0.4800
 Site-White_utk                 (0) | Val  Loss: 1.4748 | Val  Acc: 0.4054
 Site-White_utk                 (0) | Val  Loss: 1.5580 | Val  Acc: 0.4000
 Site-White_utk                 (0) | Val  Loss: 1.5851 | Val  Acc: 0.4074
 Site-White_utk                 (0) | Val  Loss: 1.5530 | Val  Acc: 0.3866
 Site-White_utk                 (0) | Val  Loss: 1.5891 | Val  Acc: 0.3943
 Site-White_utk                 (0) | Val  Loss: 1.6288 | Val  Acc: 0.4031
 Site-East_Asian                (2) | Val  Loss: 1.5713 | Val  Acc: 0.3333
 Site-East_Asian                (6) | Val  Loss: 1.4861 | Val  Acc: 0.4231
 Site-East_Asian                (2) | Val  Loss: 1.4921 | Val  Acc: 0.4359
 Site-East_Asian                (2) | Val  Loss: 1.4904 | Val  Acc: 0.4035
 Site-East_Asian                (2) | Val  Loss: 1.4779 | Val  Acc: 0.5176
 Site-East_Asian                (2) | Val  Loss: 1.4891 | Val  Acc: 0.4400
 Site-East_Asian                (2) | Val  Loss: 1.5080 | Val  Acc: 0.4620
 Site-Indian_utk                (4) | Val  Loss: 1.5060 | Val  Acc: 0.4828
 Site-Indian_utk                (4) | Val  Loss: 1.3650 | Val  Acc: 0.5116
 Site-Indian_utk                (4) | Val  Loss: 1.4395 | Val  Acc: 0.4603
 Site-Indian_utk                (4) | Val  Loss: 1.5303 | Val  Acc: 0.4891
 Site-Indian_utk                (4) | Val  Loss: 1.3147 | Val  Acc: 0.4559
 Site-Black_utk                 (3) | Val  Loss: 1.5569 | Val  Acc: 0.5278
 Site-Black_utk                 (3) | Val  Loss: 1.5750 | Val  Acc: 0.4259
 Site-Black_utk                 (3) | Val  Loss: 1.5036 | Val  Acc: 0.4304
 Site-Southeast_Asian           (2) | Val  Loss: 1.6075 | Val  Acc: 0.4118
 Site-Southeast_Asian           (2) | Val  Loss: 1.6142 | Val  Acc: 0.4000
 Site-Asian_ffhq                (1) | Val  Loss: 1.5877 | Val  Acc: 0.5826
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.9166 | Val  Acc: 0.1026
Average Valid Accuracy: 0.4399
 Test site-White_utk                 (5)| Epoch:34 | Test Acc: 0.3936
 Test site-East_Asian                (2)| Epoch:34 | Test Acc: 0.4796
 Test site-Indian_utk                (4)| Epoch:34 | Test Acc: 0.5083
 Test site-Black_utk                 (3)| Epoch:34 | Test Acc: 0.3929
 Test site-Southeast_Asian           (2)| Epoch:34 | Test Acc: 0.4090
 Test site-Asian_ffhq                (1)| Epoch:34 | Test Acc: 0.2077
 Test site-Latino_Hispanic_ffhq      (1)| Epoch:34 | Test Acc: 0.2090
White_utk: 0.3936, East_Asian: 0.4796, Indian_utk: 0.5083, Black_utk: 0.3929, Southeast_Asian: 0.4090, Asian_ffhq: 0.2077, Latino_Hispanic_ffhq: 0.2090, 
Average Test Accuracy(group): 0.3714, Average Test Accuracy(individual): 0.4224,
domain std=0.1108, cluster std=0.0915, individual std=0.0749, 
Average Test Accuracy: 0.3714
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 41 ============
cnt=[13, 9, 1, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-White_utk                 (2) | Train Loss: 1.4335 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.5654 | Train Acc: 0.3529
 Site-White_utk                 (0) | Train Loss: 1.5150 | Train Acc: 0.4231
 Site-White_utk                 (0) | Train Loss: 1.6328 | Train Acc: 0.3421
 Site-White_utk                 (0) | Train Loss: 1.5040 | Train Acc: 0.4107
 Site-White_utk                 (0) | Train Loss: 1.4762 | Train Acc: 0.4390
 Site-White_utk                 (0) | Train Loss: 1.5042 | Train Acc: 0.4298
 Site-White_utk                 (0) | Train Loss: 1.5691 | Train Acc: 0.3966
 Site-White_utk                 (0) | Train Loss: 1.5307 | Train Acc: 0.4068
 Site-White_utk                 (0) | Train Loss: 1.4103 | Train Acc: 0.4755
 Site-East_Asian                (1) | Train Loss: 1.4105 | Train Acc: 0.4444
 Site-East_Asian                (1) | Train Loss: 1.4302 | Train Acc: 0.5500
 Site-East_Asian                (1) | Train Loss: 1.6367 | Train Acc: 0.3390
 Site-East_Asian                (1) | Train Loss: 1.5725 | Train Acc: 0.4186
 Site-East_Asian                (1) | Train Loss: 1.5250 | Train Acc: 0.4488
 Site-East_Asian                (1) | Train Loss: 1.5163 | Train Acc: 0.4171
 Site-East_Asian                (1) | Train Loss: 1.4506 | Train Acc: 0.4601
 Site-Indian_utk                (0) | Train Loss: 1.4205 | Train Acc: 0.5116
 Site-Indian_utk                (0) | Train Loss: 1.3955 | Train Acc: 0.5469
 Site-Indian_utk                (0) | Train Loss: 1.4157 | Train Acc: 0.4681
 Site-Indian_utk                (0) | Train Loss: 1.5508 | Train Acc: 0.4604
 Site-Indian_utk                (0) | Train Loss: 1.3825 | Train Acc: 0.4976
 Site-Black_utk                 (5) | Train Loss: 1.6171 | Train Acc: 0.4909
 Site-Black_utk                 (5) | Train Loss: 1.6030 | Train Acc: 0.3704
 Site-Black_utk                 (5) | Train Loss: 1.5597 | Train Acc: 0.4538
 Site-Southeast_Asian           (1) | Train Loss: 1.6504 | Train Acc: 0.3725
 Site-Southeast_Asian           (1) | Train Loss: 1.6310 | Train Acc: 0.3933
 Site-Asian_ffhq                (6) | Train Loss: 1.5414 | Train Acc: 0.6163
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.5360 | Train Acc: 0.5641
Average Train Accuracy: 0.4454
 Site-White_utk                 (2) | Val  Loss: 1.3002 | Val  Acc: 0.5000
 Site-White_utk                 (4) | Val  Loss: 1.5403 | Val  Acc: 0.4545
 Site-White_utk                 (0) | Val  Loss: 1.5257 | Val  Acc: 0.4118
 Site-White_utk                 (0) | Val  Loss: 1.5327 | Val  Acc: 0.4400
 Site-White_utk                 (0) | Val  Loss: 1.4003 | Val  Acc: 0.3784
 Site-White_utk                 (0) | Val  Loss: 1.5352 | Val  Acc: 0.3818
 Site-White_utk                 (0) | Val  Loss: 1.5855 | Val  Acc: 0.4321
 Site-White_utk                 (0) | Val  Loss: 1.5082 | Val  Acc: 0.4790
 Site-White_utk                 (0) | Val  Loss: 1.5668 | Val  Acc: 0.3943
 Site-White_utk                 (0) | Val  Loss: 1.6283 | Val  Acc: 0.4341
 Site-East_Asian                (1) | Val  Loss: 1.6507 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.3429 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.4917 | Val  Acc: 0.4103
 Site-East_Asian                (1) | Val  Loss: 1.5111 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.4794 | Val  Acc: 0.4706
 Site-East_Asian                (1) | Val  Loss: 1.5031 | Val  Acc: 0.4560
 Site-East_Asian                (1) | Val  Loss: 1.4945 | Val  Acc: 0.4565
 Site-Indian_utk                (0) | Val  Loss: 1.4141 | Val  Acc: 0.5517
 Site-Indian_utk                (0) | Val  Loss: 1.3089 | Val  Acc: 0.5116
 Site-Indian_utk                (0) | Val  Loss: 1.4055 | Val  Acc: 0.4921
 Site-Indian_utk                (0) | Val  Loss: 1.5606 | Val  Acc: 0.4565
 Site-Indian_utk                (0) | Val  Loss: 1.3060 | Val  Acc: 0.4632
 Site-Black_utk                 (5) | Val  Loss: 1.5026 | Val  Acc: 0.5278
 Site-Black_utk                 (5) | Val  Loss: 1.5534 | Val  Acc: 0.5000
 Site-Black_utk                 (5) | Val  Loss: 1.5107 | Val  Acc: 0.4430
 Site-Southeast_Asian           (1) | Val  Loss: 1.7194 | Val  Acc: 0.3824
 Site-Southeast_Asian           (1) | Val  Loss: 1.6334 | Val  Acc: 0.4300
 Site-Asian_ffhq                (6) | Val  Loss: 1.5677 | Val  Acc: 0.5478
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8618 | Val  Acc: 0.1410
Average Valid Accuracy: 0.4414
 Test site-White_utk                 (2)| Epoch:40 | Test Acc: 0.3947
 Test site-East_Asian                (1)| Epoch:40 | Test Acc: 0.4816
 Test site-Indian_utk                (0)| Epoch:40 | Test Acc: 0.5021
 Test site-Black_utk                 (5)| Epoch:40 | Test Acc: 0.3929
 Test site-Southeast_Asian           (1)| Epoch:40 | Test Acc: 0.4107
 Test site-Asian_ffhq                (6)| Epoch:40 | Test Acc: 0.2096
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:40 | Test Acc: 0.2139
White_utk: 0.3947, East_Asian: 0.4816, Indian_utk: 0.5021, Black_utk: 0.3929, Southeast_Asian: 0.4107, Asian_ffhq: 0.2096, Latino_Hispanic_ffhq: 0.2139, 
Average Test Accuracy(group): 0.3722, Average Test Accuracy(individual): 0.4225,
domain std=0.1087, cluster std=0.0959, individual std=0.0733, 
Average Test Accuracy: 0.3722
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 1, 2, 7, 10, 3, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-White_utk                 (4) | Train Loss: 1.3987 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.5207 | Train Acc: 0.2941
 Site-White_utk                 (4) | Train Loss: 1.4903 | Train Acc: 0.4615
 Site-White_utk                 (4) | Train Loss: 1.5891 | Train Acc: 0.3421
 Site-White_utk                 (4) | Train Loss: 1.4814 | Train Acc: 0.4643
 Site-White_utk                 (4) | Train Loss: 1.5379 | Train Acc: 0.4146
 Site-White_utk                 (4) | Train Loss: 1.5066 | Train Acc: 0.4132
 Site-White_utk                 (4) | Train Loss: 1.5607 | Train Acc: 0.4022
 Site-White_utk                 (4) | Train Loss: 1.5648 | Train Acc: 0.3954
 Site-White_utk                 (4) | Train Loss: 1.4380 | Train Acc: 0.4858
 Site-East_Asian                (3) | Train Loss: 1.4557 | Train Acc: 0.4444
 Site-East_Asian                (1) | Train Loss: 1.3886 | Train Acc: 0.5750
 Site-East_Asian                (6) | Train Loss: 1.6520 | Train Acc: 0.3559
 Site-East_Asian                (3) | Train Loss: 1.6332 | Train Acc: 0.4302
 Site-East_Asian                (3) | Train Loss: 1.5234 | Train Acc: 0.4488
 Site-East_Asian                (3) | Train Loss: 1.5126 | Train Acc: 0.4278
 Site-East_Asian                (3) | Train Loss: 1.4032 | Train Acc: 0.5000
 Site-Indian_utk                (0) | Train Loss: 1.5441 | Train Acc: 0.4419
 Site-Indian_utk                (0) | Train Loss: 1.3876 | Train Acc: 0.5625
 Site-Indian_utk                (0) | Train Loss: 1.4824 | Train Acc: 0.4362
 Site-Indian_utk                (0) | Train Loss: 1.4754 | Train Acc: 0.4964
 Site-Indian_utk                (0) | Train Loss: 1.4291 | Train Acc: 0.4780
 Site-Black_utk                 (5) | Train Loss: 1.5057 | Train Acc: 0.4364
 Site-Black_utk                 (5) | Train Loss: 1.5616 | Train Acc: 0.4198
 Site-Black_utk                 (5) | Train Loss: 1.5323 | Train Acc: 0.4622
 Site-Southeast_Asian           (3) | Train Loss: 1.6942 | Train Acc: 0.3824
 Site-Southeast_Asian           (3) | Train Loss: 1.5448 | Train Acc: 0.4067
 Site-Asian_ffhq                (2) | Train Loss: 1.5276 | Train Acc: 0.6221
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5548 | Train Acc: 0.5556
Average Train Accuracy: 0.4473
 Site-White_utk                 (4) | Val  Loss: 1.2930 | Val  Acc: 0.7500
 Site-White_utk                 (4) | Val  Loss: 1.4400 | Val  Acc: 0.5455
 Site-White_utk                 (4) | Val  Loss: 1.5970 | Val  Acc: 0.4706
 Site-White_utk                 (4) | Val  Loss: 1.3937 | Val  Acc: 0.5200
 Site-White_utk                 (4) | Val  Loss: 1.4259 | Val  Acc: 0.3514
 Site-White_utk                 (4) | Val  Loss: 1.5198 | Val  Acc: 0.4364
 Site-White_utk                 (4) | Val  Loss: 1.5761 | Val  Acc: 0.3704
 Site-White_utk                 (4) | Val  Loss: 1.5546 | Val  Acc: 0.4286
 Site-White_utk                 (4) | Val  Loss: 1.5788 | Val  Acc: 0.4171
 Site-White_utk                 (4) | Val  Loss: 1.6474 | Val  Acc: 0.4031
 Site-East_Asian                (3) | Val  Loss: 1.5258 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.4244 | Val  Acc: 0.5000
 Site-East_Asian                (6) | Val  Loss: 1.4274 | Val  Acc: 0.4615
 Site-East_Asian                (3) | Val  Loss: 1.4378 | Val  Acc: 0.4386
 Site-East_Asian                (3) | Val  Loss: 1.4858 | Val  Acc: 0.4941
 Site-East_Asian                (3) | Val  Loss: 1.4820 | Val  Acc: 0.4480
 Site-East_Asian                (3) | Val  Loss: 1.5101 | Val  Acc: 0.4565
 Site-Indian_utk                (0) | Val  Loss: 1.4934 | Val  Acc: 0.4828
 Site-Indian_utk                (0) | Val  Loss: 1.3647 | Val  Acc: 0.5581
 Site-Indian_utk                (0) | Val  Loss: 1.3778 | Val  Acc: 0.4921
 Site-Indian_utk                (0) | Val  Loss: 1.5395 | Val  Acc: 0.5109
 Site-Indian_utk                (0) | Val  Loss: 1.2643 | Val  Acc: 0.5074
 Site-Black_utk                 (5) | Val  Loss: 1.5272 | Val  Acc: 0.6111
 Site-Black_utk                 (5) | Val  Loss: 1.4979 | Val  Acc: 0.4074
 Site-Black_utk                 (5) | Val  Loss: 1.5187 | Val  Acc: 0.4177
 Site-Southeast_Asian           (3) | Val  Loss: 1.7107 | Val  Acc: 0.3971
 Site-Southeast_Asian           (3) | Val  Loss: 1.6350 | Val  Acc: 0.3900
 Site-Asian_ffhq                (2) | Val  Loss: 1.5642 | Val  Acc: 0.5478
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8814 | Val  Acc: 0.1282
Average Valid Accuracy: 0.4578
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.7500
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.5455
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.4706
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.5200
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.3514
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.4364
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.3704
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.4286
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.4171
 Best site-White_utk                (4)  | Epoch:42 | Val Acc: 0.4031
 Best site-East_Asian               (3)  | Epoch:42 | Val Acc: 0.3333
 Best site-East_Asian               (1)  | Epoch:42 | Val Acc: 0.5000
 Best site-East_Asian               (6)  | Epoch:42 | Val Acc: 0.4615
 Best site-East_Asian               (3)  | Epoch:42 | Val Acc: 0.4386
 Best site-East_Asian               (3)  | Epoch:42 | Val Acc: 0.4941
 Best site-East_Asian               (3)  | Epoch:42 | Val Acc: 0.4480
 Best site-East_Asian               (3)  | Epoch:42 | Val Acc: 0.4565
 Best site-Indian_utk               (0)  | Epoch:42 | Val Acc: 0.4828
 Best site-Indian_utk               (0)  | Epoch:42 | Val Acc: 0.5581
 Best site-Indian_utk               (0)  | Epoch:42 | Val Acc: 0.4921
 Best site-Indian_utk               (0)  | Epoch:42 | Val Acc: 0.5109
 Best site-Indian_utk               (0)  | Epoch:42 | Val Acc: 0.5074
 Best site-Black_utk                (5)  | Epoch:42 | Val Acc: 0.6111
 Best site-Black_utk                (5)  | Epoch:42 | Val Acc: 0.4074
 Best site-Black_utk                (5)  | Epoch:42 | Val Acc: 0.4177
 Best site-Southeast_Asian          (3)  | Epoch:42 | Val Acc: 0.3971
 Best site-Southeast_Asian          (3)  | Epoch:42 | Val Acc: 0.3900
 Best site-Asian_ffhq               (2)  | Epoch:42 | Val Acc: 0.5478
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:42 | Val Acc: 0.1282
 Test site-White_utk                 (4)| Epoch:42 | Test Acc: 0.3957
 Test site-East_Asian                (3)| Epoch:42 | Test Acc: 0.4796
 Test site-Indian_utk                (0)| Epoch:42 | Test Acc: 0.5042
 Test site-Black_utk                 (5)| Epoch:42 | Test Acc: 0.3929
 Test site-Southeast_Asian           (3)| Epoch:42 | Test Acc: 0.4177
 Test site-Asian_ffhq                (2)| Epoch:42 | Test Acc: 0.2096
 Test site-Latino_Hispanic_ffhq      (2)| Epoch:42 | Test Acc: 0.2139
White_utk: 0.3957, East_Asian: 0.4796, Indian_utk: 0.5042, Black_utk: 0.3929, Southeast_Asian: 0.4177, Asian_ffhq: 0.2096, Latino_Hispanic_ffhq: 0.2139, 
Average Test Accuracy(group): 0.3734, Average Test Accuracy(individual): 0.4232,
domain std=0.1092, cluster std=0.0931, individual std=0.0731, 
Average Test Accuracy: 0.3734
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 43 ============
cnt=[8, 1, 2, 5, 9, 3, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-White_utk                 (4) | Train Loss: 1.3664 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.5239 | Train Acc: 0.2941
 Site-White_utk                 (4) | Train Loss: 1.4619 | Train Acc: 0.5000
 Site-White_utk                 (1) | Train Loss: 1.6014 | Train Acc: 0.3947
 Site-White_utk                 (4) | Train Loss: 1.4906 | Train Acc: 0.4643
 Site-White_utk                 (4) | Train Loss: 1.3844 | Train Acc: 0.4390
 Site-White_utk                 (4) | Train Loss: 1.4754 | Train Acc: 0.4132
 Site-White_utk                 (4) | Train Loss: 1.5973 | Train Acc: 0.3687
 Site-White_utk                 (4) | Train Loss: 1.6109 | Train Acc: 0.4297
 Site-White_utk                 (4) | Train Loss: 1.4231 | Train Acc: 0.4703
 Site-East_Asian                (6) | Train Loss: 1.3430 | Train Acc: 0.4444
 Site-East_Asian                (0) | Train Loss: 1.3976 | Train Acc: 0.5250
 Site-East_Asian                (0) | Train Loss: 1.6795 | Train Acc: 0.3220
 Site-East_Asian                (0) | Train Loss: 1.5029 | Train Acc: 0.4419
 Site-East_Asian                (0) | Train Loss: 1.5101 | Train Acc: 0.4646
 Site-East_Asian                (0) | Train Loss: 1.5179 | Train Acc: 0.4171
 Site-East_Asian                (0) | Train Loss: 1.4397 | Train Acc: 0.4783
 Site-Indian_utk                (3) | Train Loss: 1.4775 | Train Acc: 0.5116
 Site-Indian_utk                (3) | Train Loss: 1.3946 | Train Acc: 0.5312
 Site-Indian_utk                (3) | Train Loss: 1.4247 | Train Acc: 0.4681
 Site-Indian_utk                (3) | Train Loss: 1.4464 | Train Acc: 0.4892
 Site-Indian_utk                (3) | Train Loss: 1.4599 | Train Acc: 0.4780
 Site-Black_utk                 (5) | Train Loss: 1.5117 | Train Acc: 0.4364
 Site-Black_utk                 (5) | Train Loss: 1.5121 | Train Acc: 0.4321
 Site-Black_utk                 (5) | Train Loss: 1.5225 | Train Acc: 0.4790
 Site-Southeast_Asian           (0) | Train Loss: 1.6397 | Train Acc: 0.3824
 Site-Southeast_Asian           (0) | Train Loss: 1.6782 | Train Acc: 0.4133
 Site-Asian_ffhq                (2) | Train Loss: 1.5376 | Train Acc: 0.6395
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5465 | Train Acc: 0.5812
Average Train Accuracy: 0.4526
 Site-White_utk                 (4) | Val  Loss: 1.3274 | Val  Acc: 0.7500
 Site-White_utk                 (4) | Val  Loss: 1.4571 | Val  Acc: 0.4545
 Site-White_utk                 (4) | Val  Loss: 1.4256 | Val  Acc: 0.5294
 Site-White_utk                 (1) | Val  Loss: 1.4449 | Val  Acc: 0.4400
 Site-White_utk                 (4) | Val  Loss: 1.3965 | Val  Acc: 0.3514
 Site-White_utk                 (4) | Val  Loss: 1.5357 | Val  Acc: 0.3818
 Site-White_utk                 (4) | Val  Loss: 1.5581 | Val  Acc: 0.4074
 Site-White_utk                 (4) | Val  Loss: 1.4940 | Val  Acc: 0.4622
 Site-White_utk                 (4) | Val  Loss: 1.6013 | Val  Acc: 0.4057
 Site-White_utk                 (4) | Val  Loss: 1.6422 | Val  Acc: 0.4109
 Site-East_Asian                (6) | Val  Loss: 1.5450 | Val  Acc: 0.3333
 Site-East_Asian                (0) | Val  Loss: 1.3790 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.4809 | Val  Acc: 0.4615
 Site-East_Asian                (0) | Val  Loss: 1.4930 | Val  Acc: 0.4561
 Site-East_Asian                (0) | Val  Loss: 1.4724 | Val  Acc: 0.4824
 Site-East_Asian                (0) | Val  Loss: 1.4803 | Val  Acc: 0.4480
 Site-East_Asian                (0) | Val  Loss: 1.4998 | Val  Acc: 0.4511
 Site-Indian_utk                (3) | Val  Loss: 1.5421 | Val  Acc: 0.4138
 Site-Indian_utk                (3) | Val  Loss: 1.3034 | Val  Acc: 0.6512
 Site-Indian_utk                (3) | Val  Loss: 1.4026 | Val  Acc: 0.5397
 Site-Indian_utk                (3) | Val  Loss: 1.4898 | Val  Acc: 0.5109
 Site-Indian_utk                (3) | Val  Loss: 1.2819 | Val  Acc: 0.4706
 Site-Black_utk                 (5) | Val  Loss: 1.5104 | Val  Acc: 0.4722
 Site-Black_utk                 (5) | Val  Loss: 1.5722 | Val  Acc: 0.4444
 Site-Black_utk                 (5) | Val  Loss: 1.5220 | Val  Acc: 0.4177
 Site-Southeast_Asian           (0) | Val  Loss: 1.7020 | Val  Acc: 0.4118
 Site-Southeast_Asian           (0) | Val  Loss: 1.6408 | Val  Acc: 0.3900
 Site-Asian_ffhq                (2) | Val  Loss: 1.5476 | Val  Acc: 0.5478
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8606 | Val  Acc: 0.1154
Average Valid Accuracy: 0.4521
 Test site-White_utk                 (4)| Epoch:42 | Test Acc: 0.3957
 Test site-East_Asian                (6)| Epoch:42 | Test Acc: 0.4816
 Test site-Indian_utk                (3)| Epoch:42 | Test Acc: 0.5042
 Test site-Black_utk                 (5)| Epoch:42 | Test Acc: 0.3878
 Test site-Southeast_Asian           (0)| Epoch:42 | Test Acc: 0.4194
 Test site-Asian_ffhq                (2)| Epoch:42 | Test Acc: 0.2114
 Test site-Latino_Hispanic_ffhq      (2)| Epoch:42 | Test Acc: 0.2139
White_utk: 0.3957, East_Asian: 0.4816, Indian_utk: 0.5042, Black_utk: 0.3878, Southeast_Asian: 0.4194, Asian_ffhq: 0.2114, Latino_Hispanic_ffhq: 0.2139, 
Average Test Accuracy(group): 0.3734, Average Test Accuracy(individual): 0.4233,
domain std=0.1091, cluster std=0.0901, individual std=0.0735, 
Average Test Accuracy: 0.3734
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7_cs/ccop_q=1...
============ Train epoch 44 ============
===2023-06-16 01:05:47===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 90
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[16,24,36,53,78,116,170,250,368,541,38,56,82,121,178,263,386,61,90,132,195,287,77,113,167,143,211,241,164,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
Loading snapshots...
 Test site-White_utk                 (4)| Epoch:43 | Test Acc: 0.3957
 Test site-East_Asian                (6)| Epoch:43 | Test Acc: 0.4816
 Test site-Indian_utk                (3)| Epoch:43 | Test Acc: 0.5042
 Test site-Black_utk                 (5)| Epoch:43 | Test Acc: 0.3878
 Test site-Southeast_Asian           (0)| Epoch:43 | Test Acc: 0.4194
 Test site-Asian_ffhq                (2)| Epoch:43 | Test Acc: 0.2114
 Test site-Latino_Hispanic_ffhq      (2)| Epoch:43 | Test Acc: 0.2139
White_utk: 0.3957, East_Asian: 0.4816, Indian_utk: 0.5042, Black_utk: 0.3878, Southeast_Asian: 0.4194, Asian_ffhq: 0.2114, Latino_Hispanic_ffhq: 0.2139, 
Average Test Accuracy(group): 0.3734, Average Test Accuracy(individual): 0.4233,
domain std=0.1091, cluster std=0.0901, individual std=0.0735, 
===2023-06-16 01:09:39===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 90
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[19,28,41,61,90,132,194,286,421,619,43,64,94,139,204,300,442,70,103,151,223,328,88,130,191,164,241,276,187,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
