===2023-08-02 01:01:51===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.6781 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.9306 | Train Acc: 0.4510
 Site-Clipart                       | Train Loss: 1.7034 | Train Acc: 0.8514
 Site-Art                           | Train Loss: 1.5545 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.6546 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.4591 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.5152 | Train Acc: 0.9709
Average Train Accuracy: 0.8596
 Site-Clipart                       | Val  Loss: 1.5621 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.6199 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.9368 | Val  Acc: 0.5102
 Site-Art                           | Val  Loss: 1.7136 | Val  Acc: 0.9153
 Site-Art                           | Val  Loss: 1.6536 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.6895 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.6527 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8585
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.8088
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.5102
 Best site-Art                       | Epoch:0 | Val Acc: 0.9153
 Best site-Art                       | Epoch:0 | Val Acc: 0.9412
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.9700
 Best site-Product                   | Epoch:0 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 1.0598 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.5939 | Train Acc: 0.6176
 Site-Clipart                       | Train Loss: 1.2705 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.9977 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.1972 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.8444 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.9147 | Train Acc: 0.9903
Average Train Accuracy: 0.9100
 Site-Clipart                       | Val  Loss: 0.9962 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.0677 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.5668 | Val  Acc: 0.6429
 Site-Art                           | Val  Loss: 1.2931 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1529 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.2075 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 1.1207 | Val  Acc: 0.9275
Average Valid Accuracy: 0.9109
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9118
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6429
 Best site-Art                       | Epoch:1 | Val Acc: 1.0000
 Best site-Art                       | Epoch:1 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.9600
 Best site-Product                   | Epoch:1 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 0.6362 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.3724 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.0059 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.6794 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.8027 | Train Acc: 0.9457
 Site-RealWorld                     | Train Loss: 0.4477 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5275 | Train Acc: 0.9903
Average Train Accuracy: 0.9227
 Site-Clipart                       | Val  Loss: 0.6490 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6994 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.2487 | Val  Acc: 0.8265
 Site-Art                           | Val  Loss: 0.9513 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8103 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.8810 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.8152 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9405
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8265
 Best site-Art                       | Epoch:2 | Val Acc: 1.0000
 Best site-Art                       | Epoch:2 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9700
 Best site-Product                   | Epoch:2 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 0.5055 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.2028 | Train Acc: 0.6863
 Site-Clipart                       | Train Loss: 0.8269 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.5199 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.8319 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.2537 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3002 | Train Acc: 0.9709
Average Train Accuracy: 0.9216
 Site-Clipart                       | Val  Loss: 0.4414 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5103 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.0952 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 0.7306 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5726 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.6137 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.4593 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9428
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8061
 Best site-Art                       | Epoch:3 | Val Acc: 1.0000
 Best site-Art                       | Epoch:3 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9800
 Best site-Product                   | Epoch:3 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 0.4603 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 1.0687 | Train Acc: 0.7549
 Site-Clipart                       | Train Loss: 0.5934 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.3123 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.6444 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.1640 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2210 | Train Acc: 0.9806
Average Train Accuracy: 0.9412
 Site-Clipart                       | Val  Loss: 0.3496 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4029 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 0.9315 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.5405 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.4111 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.5035 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.4148 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9439
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9118
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8571
 Best site-Art                       | Epoch:4 | Val Acc: 0.9661
 Best site-Art                       | Epoch:4 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9700
 Best site-Product                   | Epoch:4 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 0.3627 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.0231 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.4938 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 0.2976 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.4744 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.0941 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1208 | Train Acc: 1.0000
Average Train Accuracy: 0.9364
 Site-Clipart                       | Val  Loss: 0.2372 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3127 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 0.8006 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.4635 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.3337 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.3920 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.3326 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9521
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8971
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8776
 Best site-Art                       | Epoch:5 | Val Acc: 0.9831
 Best site-Art                       | Epoch:5 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9900
 Best site-Product                   | Epoch:5 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 0.3070 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.8841 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 0.4708 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.2298 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.3384 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.0676 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0768 | Train Acc: 0.9903
Average Train Accuracy: 0.9435
 Site-Clipart                       | Val  Loss: 0.2315 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.2561 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.7564 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 0.3771 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.2610 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.3336 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.2608 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9385
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 0.2388 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.7993 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 0.4599 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.1781 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.2280 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.0452 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0643 | Train Acc: 1.0000
Average Train Accuracy: 0.9422
 Site-Clipart                       | Val  Loss: 0.1622 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.2133 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.6749 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.2703 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.2416 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.2388 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2456 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9548
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9559
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8469
 Best site-Art                       | Epoch:7 | Val Acc: 0.9661
 Best site-Art                       | Epoch:7 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 0.1568 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.7987 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.3021 | Train Acc: 0.9662
 Site-Art                           | Train Loss: 0.1555 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.2502 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0256 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0408 | Train Acc: 1.0000
Average Train Accuracy: 0.9562
 Site-Clipart                       | Val  Loss: 0.1422 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.1799 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.5831 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.2562 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1907 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.2139 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.1962 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9640
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9559
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8878
 Best site-Art                       | Epoch:8 | Val Acc: 1.0000
 Best site-Art                       | Epoch:8 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9900
 Best site-Product                   | Epoch:8 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.2552 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.7241 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.3065 | Train Acc: 0.9527
 Site-Art                           | Train Loss: 0.1871 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.3773 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0330 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0464 | Train Acc: 0.9903
Average Train Accuracy: 0.9552
 Site-Clipart                       | Val  Loss: 0.1068 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.1661 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.5673 | Val  Acc: 0.8163
 Site-Art                           | Val  Loss: 0.2314 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.1490 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.1878 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1702 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9582
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.2372 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.7228 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 0.2396 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.1249 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.3804 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0377 | Train Acc: 0.9903
Average Train Accuracy: 0.9538
 Site-Clipart                       | Val  Loss: 0.0983 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1634 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.5718 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.1720 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.1461 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.1525 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1316 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9663
 Best site-Clipart                   | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8776
 Best site-Art                       | Epoch:10 | Val Acc: 0.9831
 Best site-Art                       | Epoch:10 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-Product                   | Epoch:10 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.2252 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.7558 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 0.2310 | Train Acc: 0.9730
 Site-Art                           | Train Loss: 0.1163 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.2000 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0114 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0266 | Train Acc: 0.9903
Average Train Accuracy: 0.9537
 Site-Clipart                       | Val  Loss: 0.1022 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.1412 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.4715 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.1722 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.1202 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.1583 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1454 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9632
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.3472 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.6590 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.1944 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0922 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.1355 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.0203 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0338 | Train Acc: 0.9903
Average Train Accuracy: 0.9550
 Site-Clipart                       | Val  Loss: 0.0888 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.1238 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.4798 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.1228 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1102 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.1199 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.1411 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9599
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.2312 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.6397 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.2086 | Train Acc: 0.9662
 Site-Art                           | Train Loss: 0.1447 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.1266 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0165 | Train Acc: 1.0000
Average Train Accuracy: 0.9542
 Site-Clipart                       | Val  Loss: 0.0706 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.1140 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.4353 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.1457 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0879 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1050 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0901 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9722
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9706
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8878
 Best site-Art                       | Epoch:13 | Val Acc: 0.9831
 Best site-Art                       | Epoch:13 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:13 | Val Acc: 1.0000
 Best site-Product                   | Epoch:13 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.1305 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.6653 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.2112 | Train Acc: 0.9662
 Site-Art                           | Train Loss: 0.1092 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0762 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0143 | Train Acc: 1.0000
Average Train Accuracy: 0.9527
 Site-Clipart                       | Val  Loss: 0.0569 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0918 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.4224 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.1139 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0939 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0729 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1125 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9650
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.2149 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.6277 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.1520 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.1114 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0738 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0270 | Train Acc: 1.0000
Average Train Accuracy: 0.9572
 Site-Clipart                       | Val  Loss: 0.0508 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0984 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.3867 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0993 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0658 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0862 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0905 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9739
 Best site-Clipart                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9559
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8878
 Best site-Art                       | Epoch:15 | Val Acc: 1.0000
 Best site-Art                       | Epoch:15 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.1875 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.6222 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 0.1728 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.0551 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0677 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0116 | Train Acc: 1.0000
Average Train Accuracy: 0.9585
 Site-Clipart                       | Val  Loss: 0.0946 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.0698 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3174 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0844 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0682 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0920 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1447 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9766
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9853
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9184
 Best site-Art                       | Epoch:16 | Val Acc: 0.9831
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-Product                   | Epoch:16 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.1829 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.5442 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.1381 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.0578 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0647 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0122 | Train Acc: 1.0000
Average Train Accuracy: 0.9641
 Site-Clipart                       | Val  Loss: 0.0450 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0814 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.3530 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0582 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0561 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9754
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.1346 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.5734 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.1672 | Train Acc: 0.9662
 Site-Art                           | Train Loss: 0.0595 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0766 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0098 | Train Acc: 1.0000
Average Train Accuracy: 0.9618
 Site-Clipart                       | Val  Loss: 0.0405 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0942 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.3718 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0522 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0479 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0911 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0655 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9756
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.2159 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.5717 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.1371 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.1052 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0556 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0151 | Train Acc: 0.9903
Average Train Accuracy: 0.9536
 Site-Clipart                       | Val  Loss: 0.0417 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0506 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3490 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0837 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0527 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0563 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0857 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9774
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8878
 Best site-Art                       | Epoch:19 | Val Acc: 0.9831
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-Product                   | Epoch:19 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.2051 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.5768 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.0878 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0915 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.0409 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0106 | Train Acc: 1.0000
Average Train Accuracy: 0.9634
 Site-Clipart                       | Val  Loss: 0.0348 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0531 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3339 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0423 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0505 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0819 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9778
 Best site-Clipart                   | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9853
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8980
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9900
 Best site-Product                   | Epoch:20 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.1319 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.5443 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.0840 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0981 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0363 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0056 | Train Acc: 1.0000
Average Train Accuracy: 0.9646
 Site-Clipart                       | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0645 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3168 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0468 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0407 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0660 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0581 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9848
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9184
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9900
 Best site-Product                   | Epoch:21 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.2045 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.5777 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.1037 | Train Acc: 0.9662
 Site-Art                           | Train Loss: 0.1150 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0509 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0061 | Train Acc: 1.0000
Average Train Accuracy: 0.9567
 Site-Clipart                       | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0531 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3668 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.0564 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0292 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0618 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0577 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9730
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.1464 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.5703 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.1036 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0536 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0319 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0092 | Train Acc: 1.0000
Average Train Accuracy: 0.9691
 Site-Clipart                       | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0570 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2651 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0406 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0386 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1235 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9775
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.1727 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.5774 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.0829 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0597 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0612 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0056 | Train Acc: 1.0000
Average Train Accuracy: 0.9636
 Site-Clipart                       | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0473 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3236 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0269 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0552 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0913 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9784
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.1742 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.5473 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.0783 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0634 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0376 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0052 | Train Acc: 1.0000
Average Train Accuracy: 0.9693
 Site-Clipart                       | Val  Loss: 0.0187 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0199 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2730 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.0458 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0578 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0451 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9863
 Best site-Clipart                   | Epoch:25 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:25 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9286
 Best site-Art                       | Epoch:25 | Val Acc: 1.0000
 Best site-Art                       | Epoch:25 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:25 | Val Acc: 0.9900
 Best site-Product                   | Epoch:25 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.1234 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.5353 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.0783 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0837 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0234 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0070 | Train Acc: 1.0000
Average Train Accuracy: 0.9610
 Site-Clipart                       | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3360 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.0264 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0327 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0438 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0466 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9723
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.2115 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.5635 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.0576 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0659 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0167 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0058 | Train Acc: 1.0000
Average Train Accuracy: 0.9609
 Site-Clipart                       | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2775 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0193 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0641 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9827
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.4148 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.5174 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.0763 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0474 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0219 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0060 | Train Acc: 1.0000
Average Train Accuracy: 0.9650
 Site-Clipart                       | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0332 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2470 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0424 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0377 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.1230 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9763
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.0857 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.4985 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.0601 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0410 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0309 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0037 | Train Acc: 1.0000
Average Train Accuracy: 0.9698
 Site-Clipart                       | Val  Loss: 0.0177 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0351 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2804 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0257 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0450 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9825
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.1918 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.5786 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.0632 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0743 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0341 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0052 | Train Acc: 1.0000
Average Train Accuracy: 0.9659
 Site-Clipart                       | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0213 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2554 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0192 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0166 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0341 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0551 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9778
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.0910 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.4910 | Train Acc: 0.8725
 Site-Clipart                       | Train Loss: 0.0833 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0318 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0238 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0019 | Train Acc: 1.0000
Average Train Accuracy: 0.9767
 Site-Clipart                       | Val  Loss: 0.0207 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0324 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2782 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0580 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.0321 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9761
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.2546 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.4822 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.0518 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0392 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0037 | Train Acc: 1.0000
Average Train Accuracy: 0.9638
 Site-Clipart                       | Val  Loss: 0.0252 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.0307 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.2716 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0248 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0369 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0542 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9730
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.0824 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.5247 | Train Acc: 0.8627
 Site-Clipart                       | Train Loss: 0.0466 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0511 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0156 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0021 | Train Acc: 1.0000
Average Train Accuracy: 0.9767
 Site-Clipart                       | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0188 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2496 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0124 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0256 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0342 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9842
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.1583 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.5087 | Train Acc: 0.8529
 Site-Clipart                       | Train Loss: 0.0422 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0699 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0290 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0019 | Train Acc: 1.0000
Average Train Accuracy: 0.9753
 Site-Clipart                       | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0248 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2664 | Val  Acc: 0.9388
 Site-Art                           | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0869 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9871
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9388
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:34 | Val Acc: 1.0000
 Best site-Product                   | Epoch:34 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedsam...
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.1033 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.4588 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.0599 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0347 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0066 | Train Acc: 0.9903
Average Train Accuracy: 0.9657
 Site-Clipart                       | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0407 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2310 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0161 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0161 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0522 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0243 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9781
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.1214 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.3602 | Train Acc: 0.8922
 Site-Clipart                       | Train Loss: 0.0683 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0365 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0147 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0038 | Train Acc: 1.0000
Average Train Accuracy: 0.9830
 Site-Clipart                       | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0309 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2809 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0271 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9798
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.1691 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.3913 | Train Acc: 0.8627
 Site-Clipart                       | Train Loss: 0.0624 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0434 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0039 | Train Acc: 1.0000
Average Train Accuracy: 0.9748
 Site-Clipart                       | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0518 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2309 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0751 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.0253 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9828
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.0965 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.4014 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.0513 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0218 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0100 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0018 | Train Acc: 1.0000
Average Train Accuracy: 0.9760
 Site-Clipart                       | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0419 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.2521 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0074 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0102 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0593 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9792
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.0530 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.4921 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.0298 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0640 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0292 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0094 | Train Acc: 0.9903
Average Train Accuracy: 0.9730
 Site-Clipart                       | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0267 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2435 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0117 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0249 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0322 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9810
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.1623 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.3779 | Train Acc: 0.8725
 Site-Clipart                       | Train Loss: 0.0382 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0445 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0076 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0031 | Train Acc: 1.0000
Average Train Accuracy: 0.9788
 Site-Clipart                       | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2237 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0307 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0256 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9834
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.1405 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.4066 | Train Acc: 0.8725
 Site-Clipart                       | Train Loss: 0.0468 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0841 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0014 | Train Acc: 1.0000
Average Train Accuracy: 0.9776
 Site-Clipart                       | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0205 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2371 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0399 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9856
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.0540 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.4787 | Train Acc: 0.8627
 Site-Clipart                       | Train Loss: 0.0418 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0589 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0004 | Train Acc: 1.0000
Average Train Accuracy: 0.9758
 Site-Clipart                       | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0231 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2424 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0334 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0233 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9798
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.0395 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.3379 | Train Acc: 0.9118
 Site-Clipart                       | Train Loss: 0.0398 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0261 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0072 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0021 | Train Acc: 1.0000
Average Train Accuracy: 0.9848
 Site-Clipart                       | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0277 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.1931 | Val  Acc: 0.9388
 Site-Art                           | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0373 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0302 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9836
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.1442 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.4401 | Train Acc: 0.8824
 Site-Clipart                       | Train Loss: 0.0579 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0425 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0017 | Train Acc: 1.0000
Average Train Accuracy: 0.9760
 Site-Clipart                       | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2431 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0415 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0194 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0414 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9794
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.0641 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.3268 | Train Acc: 0.9020
 Site-Clipart                       | Train Loss: 0.0477 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0242 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0058 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0004 | Train Acc: 1.0000
Average Train Accuracy: 0.9814
 Site-Clipart                       | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0222 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2163 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0445 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0335 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9792
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.0550 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.3654 | Train Acc: 0.8922
 Site-Clipart                       | Train Loss: 0.0442 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0137 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0094 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0008 | Train Acc: 1.0000
Average Train Accuracy: 0.9836
 Site-Clipart                       | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0218 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2261 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0346 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0197 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9769
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.0425 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.3391 | Train Acc: 0.8627
 Site-Clipart                       | Train Loss: 0.0286 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0125 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0004 | Train Acc: 1.0000
Average Train Accuracy: 0.9804
 Site-Clipart                       | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0265 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2431 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0176 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0298 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0467 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9827
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.0352 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.4155 | Train Acc: 0.8725
 Site-Clipart                       | Train Loss: 0.0481 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0405 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0032 | Train Acc: 1.0000
Average Train Accuracy: 0.9776
 Site-Clipart                       | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0302 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2112 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0424 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0388 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9798
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.0625 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.3073 | Train Acc: 0.8824
 Site-Clipart                       | Train Loss: 0.0216 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0331 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0010 | Train Acc: 1.0000
Average Train Accuracy: 0.9816
 Site-Clipart                       | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0165 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.1757 | Val  Acc: 0.9592
 Site-Art                           | Val  Loss: 0.0440 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0348 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0290 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9841
===2023-08-02 01:32:26===
===2023-08-02 01:32:31===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:34 | Test Acc: 0.5617
 Test site-Art                       (0)| Epoch:34 | Test Acc: 0.6646
 Test site-RealWorld                 (3)| Epoch:34 | Test Acc: 0.6111
 Test site-Product                   (3)| Epoch:34 | Test Acc: 0.5771
Clipart: 0.5617, Art: 0.6646, RealWorld: 0.6111, Product: 0.5771, 
Average Test Accuracy(group): 0.6036, Average Test Accuracy(individual): 0.6004,
domain std=0.0395, cluster std=0.0210, individual std=0.0437, 
