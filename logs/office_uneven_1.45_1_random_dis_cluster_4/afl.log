===2023-08-01 23:45:57===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.2386 | Train Acc: 0.3143
 Site-Clipart                       | Train Loss: 2.3632 | Train Acc: 0.0000
 Site-Clipart                       | Train Loss: 2.2131 | Train Acc: 0.2568
 Site-Art                           | Train Loss: 2.2124 | Train Acc: 0.4773
 Site-Art                           | Train Loss: 2.1821 | Train Acc: 0.2481
 Site-RealWorld                     | Train Loss: 2.2269 | Train Acc: 0.4600
 Site-Product                       | Train Loss: 2.2473 | Train Acc: 0.3786
Average Train Accuracy: 0.3050
 Site-Clipart                       | Val  Loss: 2.2043 | Val  Acc: 0.2553
 Site-Clipart                       | Val  Loss: 2.2422 | Val  Acc: 0.1176
 Site-Clipart                       | Val  Loss: 2.3460 | Val  Acc: 0.0204
 Site-Art                           | Val  Loss: 2.2103 | Val  Acc: 0.3390
 Site-Art                           | Val  Loss: 2.2115 | Val  Acc: 0.2471
 Site-RealWorld                     | Val  Loss: 2.2463 | Val  Acc: 0.1600
 Site-Product                       | Val  Loss: 2.2853 | Val  Acc: 0.0725
Average Valid Accuracy: 0.1731
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.2553
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.1176
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.0204
 Best site-Art                       | Epoch:0 | Val Acc: 0.3390
 Best site-Art                       | Epoch:0 | Val Acc: 0.2471
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1600
 Best site-Product                   | Epoch:0 | Val Acc: 0.0725
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 2.1391 | Train Acc: 0.4714
 Site-Clipart                       | Train Loss: 2.3154 | Train Acc: 0.0784
 Site-Clipart                       | Train Loss: 2.1601 | Train Acc: 0.5000
 Site-Art                           | Train Loss: 2.1106 | Train Acc: 0.6591
 Site-Art                           | Train Loss: 2.1741 | Train Acc: 0.3798
 Site-RealWorld                     | Train Loss: 2.1317 | Train Acc: 0.7000
 Site-Product                       | Train Loss: 2.1652 | Train Acc: 0.6214
Average Train Accuracy: 0.4872
 Site-Clipart                       | Val  Loss: 2.1311 | Val  Acc: 0.5106
 Site-Clipart                       | Val  Loss: 2.1783 | Val  Acc: 0.3235
 Site-Clipart                       | Val  Loss: 2.3017 | Val  Acc: 0.0612
 Site-Art                           | Val  Loss: 2.1576 | Val  Acc: 0.4915
 Site-Art                           | Val  Loss: 2.1462 | Val  Acc: 0.4941
 Site-RealWorld                     | Val  Loss: 2.1785 | Val  Acc: 0.5300
 Site-Product                       | Val  Loss: 2.2001 | Val  Acc: 0.3188
Average Valid Accuracy: 0.3900
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5106
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.3235
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.0612
 Best site-Art                       | Epoch:1 | Val Acc: 0.4915
 Best site-Art                       | Epoch:1 | Val Acc: 0.4941
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.5300
 Best site-Product                   | Epoch:1 | Val Acc: 0.3188
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 2.0477 | Train Acc: 0.6429
 Site-Clipart                       | Train Loss: 2.2666 | Train Acc: 0.1569
 Site-Clipart                       | Train Loss: 2.0926 | Train Acc: 0.7027
 Site-Art                           | Train Loss: 2.0430 | Train Acc: 0.7159
 Site-Art                           | Train Loss: 2.0387 | Train Acc: 0.5736
 Site-RealWorld                     | Train Loss: 2.0273 | Train Acc: 0.9200
 Site-Product                       | Train Loss: 2.0774 | Train Acc: 0.8447
Average Train Accuracy: 0.6509
 Site-Clipart                       | Val  Loss: 2.0584 | Val  Acc: 0.7447
 Site-Clipart                       | Val  Loss: 2.0921 | Val  Acc: 0.4706
 Site-Clipart                       | Val  Loss: 2.2386 | Val  Acc: 0.1837
 Site-Art                           | Val  Loss: 2.0912 | Val  Acc: 0.6271
 Site-Art                           | Val  Loss: 2.0707 | Val  Acc: 0.6000
 Site-RealWorld                     | Val  Loss: 2.1164 | Val  Acc: 0.6900
 Site-Product                       | Val  Loss: 2.1389 | Val  Acc: 0.6377
Average Valid Accuracy: 0.5648
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7447
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.4706
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.1837
 Best site-Art                       | Epoch:2 | Val Acc: 0.6271
 Best site-Art                       | Epoch:2 | Val Acc: 0.6000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6900
 Best site-Product                   | Epoch:2 | Val Acc: 0.6377
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 2.0071 | Train Acc: 0.7429
 Site-Clipart                       | Train Loss: 2.2097 | Train Acc: 0.2745
 Site-Clipart                       | Train Loss: 2.0454 | Train Acc: 0.7432
 Site-Art                           | Train Loss: 1.9886 | Train Acc: 0.8295
 Site-Art                           | Train Loss: 2.0325 | Train Acc: 0.6977
 Site-RealWorld                     | Train Loss: 1.9499 | Train Acc: 0.9467
 Site-Product                       | Train Loss: 1.9892 | Train Acc: 0.8738
Average Train Accuracy: 0.7298
 Site-Clipart                       | Val  Loss: 1.9815 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 2.0143 | Val  Acc: 0.6324
 Site-Clipart                       | Val  Loss: 2.1926 | Val  Acc: 0.1837
 Site-Art                           | Val  Loss: 2.0476 | Val  Acc: 0.6949
 Site-Art                           | Val  Loss: 1.9998 | Val  Acc: 0.7765
 Site-RealWorld                     | Val  Loss: 2.0397 | Val  Acc: 0.7900
 Site-Product                       | Val  Loss: 2.0527 | Val  Acc: 0.7246
Average Valid Accuracy: 0.6708
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8936
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6324
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.1837
 Best site-Art                       | Epoch:3 | Val Acc: 0.6949
 Best site-Art                       | Epoch:3 | Val Acc: 0.7765
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7900
 Best site-Product                   | Epoch:3 | Val Acc: 0.7246
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.9260 | Train Acc: 0.7857
 Site-Clipart                       | Train Loss: 2.1578 | Train Acc: 0.3431
 Site-Clipart                       | Train Loss: 1.9721 | Train Acc: 0.8243
 Site-Art                           | Train Loss: 1.8850 | Train Acc: 0.8409
 Site-Art                           | Train Loss: 1.9999 | Train Acc: 0.8062
 Site-RealWorld                     | Train Loss: 1.8713 | Train Acc: 0.9600
 Site-Product                       | Train Loss: 1.9269 | Train Acc: 0.9126
Average Train Accuracy: 0.7818
 Site-Clipart                       | Val  Loss: 1.9016 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.9297 | Val  Acc: 0.6618
 Site-Clipart                       | Val  Loss: 2.1270 | Val  Acc: 0.2857
 Site-Art                           | Val  Loss: 1.9764 | Val  Acc: 0.7288
 Site-Art                           | Val  Loss: 1.9323 | Val  Acc: 0.8353
 Site-RealWorld                     | Val  Loss: 1.9846 | Val  Acc: 0.8500
 Site-Product                       | Val  Loss: 1.9864 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7287
 Best site-Clipart                   | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.6618
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.2857
 Best site-Art                       | Epoch:4 | Val Acc: 0.7288
 Best site-Art                       | Epoch:4 | Val Acc: 0.8353
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8500
 Best site-Product                   | Epoch:4 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.8340 | Train Acc: 0.8429
 Site-Clipart                       | Train Loss: 2.1251 | Train Acc: 0.3725
 Site-Clipart                       | Train Loss: 1.9127 | Train Acc: 0.8243
 Site-Art                           | Train Loss: 1.8315 | Train Acc: 0.8523
 Site-Art                           | Train Loss: 1.9862 | Train Acc: 0.8682
 Site-RealWorld                     | Train Loss: 1.7871 | Train Acc: 0.9733
 Site-Product                       | Train Loss: 1.8326 | Train Acc: 0.9417
Average Train Accuracy: 0.8108
 Site-Clipart                       | Val  Loss: 1.8307 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.8732 | Val  Acc: 0.6765
 Site-Clipart                       | Val  Loss: 2.0697 | Val  Acc: 0.3776
 Site-Art                           | Val  Loss: 1.9429 | Val  Acc: 0.8136
 Site-Art                           | Val  Loss: 1.8593 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.9312 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 1.9297 | Val  Acc: 0.8841
Average Valid Accuracy: 0.7906
 Best site-Clipart                   | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.6765
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.3776
 Best site-Art                       | Epoch:5 | Val Acc: 0.8136
 Best site-Art                       | Epoch:5 | Val Acc: 0.8824
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9000
 Best site-Product                   | Epoch:5 | Val Acc: 0.8841
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.8240 | Train Acc: 0.8571
 Site-Clipart                       | Train Loss: 2.0631 | Train Acc: 0.4314
 Site-Clipart                       | Train Loss: 1.8855 | Train Acc: 0.8446
 Site-Art                           | Train Loss: 1.7660 | Train Acc: 0.8523
 Site-Art                           | Train Loss: 1.8390 | Train Acc: 0.8450
 Site-RealWorld                     | Train Loss: 1.7069 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.7518 | Train Acc: 0.9709
Average Train Accuracy: 0.8287
 Site-Clipart                       | Val  Loss: 1.7464 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.7779 | Val  Acc: 0.6765
 Site-Clipart                       | Val  Loss: 2.0336 | Val  Acc: 0.4388
 Site-Art                           | Val  Loss: 1.8796 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.8028 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.8708 | Val  Acc: 0.8800
 Site-Product                       | Val  Loss: 1.8612 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7932
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.6765
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.4388
 Best site-Art                       | Epoch:6 | Val Acc: 0.8475
 Best site-Art                       | Epoch:6 | Val Acc: 0.8824
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8800
 Best site-Product                   | Epoch:6 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.7124 | Train Acc: 0.8714
 Site-Clipart                       | Train Loss: 2.0048 | Train Acc: 0.5000
 Site-Clipart                       | Train Loss: 1.8178 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 1.6976 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.7354 | Train Acc: 0.9380
 Site-RealWorld                     | Train Loss: 1.6239 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.6830 | Train Acc: 0.9806
Average Train Accuracy: 0.8660
 Site-Clipart                       | Val  Loss: 1.6815 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 1.7219 | Val  Acc: 0.8382
 Site-Clipart                       | Val  Loss: 1.9825 | Val  Acc: 0.5102
 Site-Art                           | Val  Loss: 1.8133 | Val  Acc: 0.9322
 Site-Art                           | Val  Loss: 1.7498 | Val  Acc: 0.8941
 Site-RealWorld                     | Val  Loss: 1.8032 | Val  Acc: 0.9100
 Site-Product                       | Val  Loss: 1.7955 | Val  Acc: 0.8986
Average Valid Accuracy: 0.8517
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8382
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.5102
 Best site-Art                       | Epoch:7 | Val Acc: 0.9322
 Best site-Art                       | Epoch:7 | Val Acc: 0.8941
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9100
 Best site-Product                   | Epoch:7 | Val Acc: 0.8986
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.6142 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 1.9651 | Train Acc: 0.5098
 Site-Clipart                       | Train Loss: 1.7297 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 1.6334 | Train Acc: 0.8864
 Site-Art                           | Train Loss: 1.8236 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.5469 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.6048 | Train Acc: 0.9709
Average Train Accuracy: 0.8669
 Site-Clipart                       | Val  Loss: 1.5976 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.6640 | Val  Acc: 0.8235
 Site-Clipart                       | Val  Loss: 1.9304 | Val  Acc: 0.5612
 Site-Art                           | Val  Loss: 1.7548 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.6811 | Val  Acc: 0.9176
 Site-RealWorld                     | Val  Loss: 1.7380 | Val  Acc: 0.9400
 Site-Product                       | Val  Loss: 1.7089 | Val  Acc: 0.8841
Average Valid Accuracy: 0.8612
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8235
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.5612
 Best site-Art                       | Epoch:8 | Val Acc: 0.9661
 Best site-Art                       | Epoch:8 | Val Acc: 0.9176
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9400
 Best site-Product                   | Epoch:8 | Val Acc: 0.8841
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 1.6221 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.9066 | Train Acc: 0.5588
 Site-Clipart                       | Train Loss: 1.6965 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 1.5829 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.8160 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.4904 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.5473 | Train Acc: 0.9515
Average Train Accuracy: 0.8854
 Site-Clipart                       | Val  Loss: 1.5301 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 1.5591 | Val  Acc: 0.8382
 Site-Clipart                       | Val  Loss: 1.8835 | Val  Acc: 0.5816
 Site-Art                           | Val  Loss: 1.7152 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.6138 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.7034 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 1.6692 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8818
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8382
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.5816
 Best site-Art                       | Epoch:9 | Val Acc: 0.9661
 Best site-Art                       | Epoch:9 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9300
 Best site-Product                   | Epoch:9 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 1.5625 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 1.8675 | Train Acc: 0.5686
 Site-Clipart                       | Train Loss: 1.6497 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 1.5039 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.8013 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.4083 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.4779 | Train Acc: 0.9709
Average Train Accuracy: 0.8887
 Site-Clipart                       | Val  Loss: 1.4581 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 1.5483 | Val  Acc: 0.8382
 Site-Clipart                       | Val  Loss: 1.8332 | Val  Acc: 0.5714
 Site-Art                           | Val  Loss: 1.6548 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.5679 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.6298 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 1.5883 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8826
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8382
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.5714
 Best site-Art                       | Epoch:10 | Val Acc: 0.9492
 Best site-Art                       | Epoch:10 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9600
 Best site-Product                   | Epoch:10 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 1.5321 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.8171 | Train Acc: 0.5980
 Site-Clipart                       | Train Loss: 1.5952 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 1.4413 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.7165 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.3392 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.4005 | Train Acc: 0.9806
Average Train Accuracy: 0.8955
 Site-Clipart                       | Val  Loss: 1.4017 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.4449 | Val  Acc: 0.8529
 Site-Clipart                       | Val  Loss: 1.7786 | Val  Acc: 0.6122
 Site-Art                           | Val  Loss: 1.6117 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.5010 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 1.5735 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.5457 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8935
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8529
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.6122
 Best site-Art                       | Epoch:11 | Val Acc: 0.9661
 Best site-Art                       | Epoch:11 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9500
 Best site-Product                   | Epoch:11 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 1.5629 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.7743 | Train Acc: 0.6078
 Site-Clipart                       | Train Loss: 1.5375 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 1.3857 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.6413 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.3137 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.3463 | Train Acc: 0.9709
Average Train Accuracy: 0.9002
 Site-Clipart                       | Val  Loss: 1.3343 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.3806 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.7536 | Val  Acc: 0.6735
 Site-Art                           | Val  Loss: 1.5415 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.4362 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.5195 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 1.5021 | Val  Acc: 0.9275
Average Valid Accuracy: 0.9088
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.6735
 Best site-Art                       | Epoch:12 | Val Acc: 0.9661
 Best site-Art                       | Epoch:12 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9900
 Best site-Product                   | Epoch:12 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 1.4787 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.7327 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.5051 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 1.3725 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.5476 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.2164 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2830 | Train Acc: 0.9806
Average Train Accuracy: 0.8998
 Site-Clipart                       | Val  Loss: 1.2877 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.3572 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.6908 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 1.5088 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.3831 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.4714 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.4209 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9233
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9265
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.7143
 Best site-Art                       | Epoch:13 | Val Acc: 0.9661
 Best site-Art                       | Epoch:13 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.9800
 Best site-Product                   | Epoch:13 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 1.2591 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.6961 | Train Acc: 0.6569
 Site-Clipart                       | Train Loss: 1.4335 | Train Acc: 0.9392
 Site-Art                           | Train Loss: 1.3156 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.4046 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 1.1651 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2465 | Train Acc: 0.9903
Average Train Accuracy: 0.9145
 Site-Clipart                       | Val  Loss: 1.1993 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.2320 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 1.6556 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.4532 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.3397 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.4137 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3931 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9335
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9559
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.7653
 Best site-Art                       | Epoch:14 | Val Acc: 0.9492
 Best site-Art                       | Epoch:14 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-Product                   | Epoch:14 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 1.3279 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.6448 | Train Acc: 0.6863
 Site-Clipart                       | Train Loss: 1.4183 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 1.2281 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.2814 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 1.0898 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2001 | Train Acc: 0.9806
Average Train Accuracy: 0.9114
 Site-Clipart                       | Val  Loss: 1.1486 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.2256 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.5959 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.4106 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.2574 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.3688 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.2951 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9312
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 1.2807 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.6391 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.3870 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 1.1535 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.4965 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.0311 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1153 | Train Acc: 0.9903
Average Train Accuracy: 0.9207
 Site-Clipart                       | Val  Loss: 1.1009 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.1595 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.5678 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.3584 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.2604 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.3393 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.2626 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9246
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 1.1940 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.6020 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 1.3096 | Train Acc: 0.9324
 Site-Art                           | Train Loss: 1.1130 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.4204 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 1.0036 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0762 | Train Acc: 0.9806
Average Train Accuracy: 0.9174
 Site-Clipart                       | Val  Loss: 1.0435 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.0770 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.5392 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 1.3094 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 1.1567 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2761 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2220 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9450
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9265
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8061
 Best site-Art                       | Epoch:17 | Val Acc: 0.9831
 Best site-Art                       | Epoch:17 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:17 | Val Acc: 1.0000
 Best site-Product                   | Epoch:17 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 1.1146 | Train Acc: 0.8714
 Site-Clipart                       | Train Loss: 1.5478 | Train Acc: 0.7549
 Site-Clipart                       | Train Loss: 1.2914 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 1.1102 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.4406 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.9416 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0111 | Train Acc: 0.9806
Average Train Accuracy: 0.9111
 Site-Clipart                       | Val  Loss: 0.9930 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.0669 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.5007 | Val  Acc: 0.8265
 Site-Art                           | Val  Loss: 1.2462 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1147 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.2354 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.1505 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9389
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 1.1177 | Train Acc: 0.8714
 Site-Clipart                       | Train Loss: 1.5283 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.2817 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 1.0859 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.2893 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.8898 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9733 | Train Acc: 0.9806
Average Train Accuracy: 0.9077
 Site-Clipart                       | Val  Loss: 0.9512 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.9713 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.4784 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 1.2255 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.0927 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.1987 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.1497 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9405
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 1.1758 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.4770 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 1.1891 | Train Acc: 0.9392
 Site-Art                           | Train Loss: 1.0370 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.1535 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.8417 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.9246 | Train Acc: 0.9806
Average Train Accuracy: 0.9268
 Site-Clipart                       | Val  Loss: 0.9170 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.9334 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.4076 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 1.1883 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 1.0363 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1531 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.0884 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9473
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8061
 Best site-Art                       | Epoch:20 | Val Acc: 0.9831
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9800
 Best site-Product                   | Epoch:20 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 1.0778 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.4846 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 1.1592 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 1.0418 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.0067 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.7894 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8793 | Train Acc: 0.9903
Average Train Accuracy: 0.9320
 Site-Clipart                       | Val  Loss: 0.8528 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.9205 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.3795 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 1.1614 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.0077 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 1.1279 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.0679 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9475
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8673
 Best site-Art                       | Epoch:21 | Val Acc: 0.9661
 Best site-Art                       | Epoch:21 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9700
 Best site-Product                   | Epoch:21 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 1.0763 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.4288 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1746 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 1.0354 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.1564 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.7760 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8381 | Train Acc: 0.9806
Average Train Accuracy: 0.9200
 Site-Clipart                       | Val  Loss: 0.8031 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.8447 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 1.3599 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 1.0990 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.9370 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1064 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.0294 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9539
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9559
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8469
 Best site-Art                       | Epoch:22 | Val Acc: 0.9661
 Best site-Art                       | Epoch:22 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9800
 Best site-Product                   | Epoch:22 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.9232 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.4238 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 1.0880 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.9229 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.9323 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.7273 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.8218 | Train Acc: 0.9806
Average Train Accuracy: 0.9271
 Site-Clipart                       | Val  Loss: 0.7593 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.7967 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 1.2932 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.0968 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9259 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.0352 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 1.0216 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9562
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9706
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8571
 Best site-Art                       | Epoch:23 | Val Acc: 1.0000
 Best site-Art                       | Epoch:23 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:23 | Val Acc: 0.9900
 Best site-Product                   | Epoch:23 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 1.0240 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.3842 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 1.0861 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.8827 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.2861 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.6930 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7714 | Train Acc: 0.9806
Average Train Accuracy: 0.9332
 Site-Clipart                       | Val  Loss: 0.7383 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.7756 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.2924 | Val  Acc: 0.8163
 Site-Art                           | Val  Loss: 1.0186 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.8876 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0302 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.9447 | Val  Acc: 0.9275
Average Valid Accuracy: 0.9422
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.9992 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.3297 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 1.0341 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 0.8279 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.1911 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.6381 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7300 | Train Acc: 0.9806
Average Train Accuracy: 0.9267
 Site-Clipart                       | Val  Loss: 0.7132 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.7235 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 1.2390 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 1.0075 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.8664 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.9495 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8855 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9527
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.9079 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.3105 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 1.0523 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.8716 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 0.9170 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.6378 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7186 | Train Acc: 0.9806
Average Train Accuracy: 0.9261
 Site-Clipart                       | Val  Loss: 0.7068 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.7400 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.2225 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 0.9668 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8148 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.9344 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.8001 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9558
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.8642 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.3007 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.9790 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.7495 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.9718 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.5608 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6796 | Train Acc: 0.9806
Average Train Accuracy: 0.9350
 Site-Clipart                       | Val  Loss: 0.6163 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.6955 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.1805 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.9385 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.7722 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.9136 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.7981 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9565
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.8878
 Best site-Art                       | Epoch:27 | Val Acc: 0.9831
 Best site-Art                       | Epoch:27 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:27 | Val Acc: 0.9600
 Best site-Product                   | Epoch:27 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 1.1232 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.2567 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.9653 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.7903 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.9816 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.5519 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6344 | Train Acc: 0.9806
Average Train Accuracy: 0.9303
 Site-Clipart                       | Val  Loss: 0.5974 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6286 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.1776 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.9242 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.7431 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8702 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.8613 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9538
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.7006 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.2044 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 0.9445 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.7096 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.0494 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.5427 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5939 | Train Acc: 0.9806
Average Train Accuracy: 0.9294
 Site-Clipart                       | Val  Loss: 0.5947 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6237 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 1.1599 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.8916 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.7336 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.8455 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.7626 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9532
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.9463 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.2318 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.9121 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.6856 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.0943 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.5253 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5690 | Train Acc: 0.9806
Average Train Accuracy: 0.9288
 Site-Clipart                       | Val  Loss: 0.5421 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.5633 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.1218 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.8363 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.6911 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8254 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7264 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9653
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8980
 Best site-Art                       | Epoch:30 | Val Acc: 0.9831
 Best site-Art                       | Epoch:30 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:30 | Val Acc: 1.0000
 Best site-Product                   | Epoch:30 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/afl...
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.7367 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.2108 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.8841 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 0.6869 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.8973 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.4693 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5475 | Train Acc: 0.9806
Average Train Accuracy: 0.9234
 Site-Clipart                       | Val  Loss: 0.5355 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.5972 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 1.0849 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.8257 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.6645 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.8301 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.7010 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9530
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.9127 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.1517 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.8055 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 0.6415 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.8697 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.4496 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5343 | Train Acc: 0.9806
Average Train Accuracy: 0.9338
 Site-Clipart                       | Val  Loss: 0.5232 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.5327 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.0788 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.7795 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.6566 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.7671 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.6761 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9606
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.8081 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.1573 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.8559 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.6814 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.7587 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.4423 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4788 | Train Acc: 0.9806
Average Train Accuracy: 0.9385
 Site-Clipart                       | Val  Loss: 0.4796 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5118 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 1.0490 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.7653 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6178 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7528 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.6551 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9632
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.7628 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.1576 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.7973 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.7086 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.7546 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.4016 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4864 | Train Acc: 0.9903
Average Train Accuracy: 0.9337
 Site-Clipart                       | Val  Loss: 0.4628 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.5106 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.0452 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.7398 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.6201 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.7254 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.6634 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9602
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.7024 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.0965 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.7995 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.6111 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 0.5960 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.4112 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4449 | Train Acc: 0.9806
Average Train Accuracy: 0.9268
 Site-Clipart                       | Val  Loss: 0.4310 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4830 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9744 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.7335 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.5725 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7384 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5971 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9630
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.7155 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.0650 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.7567 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.5615 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.6412 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.3582 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4550 | Train Acc: 0.9806
Average Train Accuracy: 0.9394
 Site-Clipart                       | Val  Loss: 0.4469 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5187 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.9863 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.6962 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.5668 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.6674 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5889 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9609
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.7651 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.0582 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.7435 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.5807 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 0.6152 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.3565 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4182 | Train Acc: 0.9806
Average Train Accuracy: 0.9386
 Site-Clipart                       | Val  Loss: 0.4086 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4569 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9656 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 0.6739 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5393 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.6591 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5694 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9562
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.7082 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.0513 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.7756 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 0.4883 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.5631 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.3473 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4143 | Train Acc: 0.9806
Average Train Accuracy: 0.9355
 Site-Clipart                       | Val  Loss: 0.3797 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.4438 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9377 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.6812 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.5387 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.6379 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.6037 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9559
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.5570 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.0937 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.6376 | Train Acc: 0.9257
 Site-Art                           | Train Loss: 0.5207 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 0.9149 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.3256 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3875 | Train Acc: 0.9806
Average Train Accuracy: 0.9349
 Site-Clipart                       | Val  Loss: 0.3835 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.4285 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9454 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.6209 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4924 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.6154 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.5216 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9638
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.6543 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.0305 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.6775 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 0.5614 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.6593 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.3170 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.3799 | Train Acc: 0.9806
Average Train Accuracy: 0.9409
 Site-Clipart                       | Val  Loss: 0.3925 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.4332 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.9078 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.6130 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.5069 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.6058 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5750 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9559
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.6945 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.0466 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.6882 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.5652 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.6190 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.3063 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3469 | Train Acc: 0.9903
Average Train Accuracy: 0.9391
 Site-Clipart                       | Val  Loss: 0.3542 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3826 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.9151 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.6059 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.4866 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.5896 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5183 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9609
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.5303 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.0152 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.6708 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 0.5233 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 0.4662 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.2788 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3286 | Train Acc: 0.9806
Average Train Accuracy: 0.9346
 Site-Clipart                       | Val  Loss: 0.3703 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3871 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.8711 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.5815 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.4638 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5542 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.4931 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9537
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.5162 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.9862 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.6418 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.5051 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.4659 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.2517 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3283 | Train Acc: 0.9709
Average Train Accuracy: 0.9410
 Site-Clipart                       | Val  Loss: 0.3371 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.3858 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.8651 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 0.5641 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4474 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.5933 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.5096 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9603
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.6612 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.9504 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.6224 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.4265 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.4297 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.2388 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3013 | Train Acc: 0.9806
Average Train Accuracy: 0.9350
 Site-Clipart                       | Val  Loss: 0.3614 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3588 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.8513 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.5495 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.4209 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5322 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5395 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9534
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.5663 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.9449 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.6009 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.4706 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.4392 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.2169 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2941 | Train Acc: 0.9903
Average Train Accuracy: 0.9349
 Site-Clipart                       | Val  Loss: 0.3322 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.3328 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.8226 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.5440 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.4135 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.5537 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.5024 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9609
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.5139 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.9260 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.6128 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.4387 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.6635 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.2355 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2905 | Train Acc: 0.9903
Average Train Accuracy: 0.9393
 Site-Clipart                       | Val  Loss: 0.3165 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3799 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.8063 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 0.5282 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4014 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.5173 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.4518 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9593
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.4864 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.9198 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.5920 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.4834 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.3957 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.2156 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2647 | Train Acc: 0.9806
Average Train Accuracy: 0.9352
 Site-Clipart                       | Val  Loss: 0.3037 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.3257 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.8061 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.5101 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.3839 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.4918 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.4359 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9643
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.4155 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.9417 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.5957 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.4396 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 0.6040 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.2053 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2747 | Train Acc: 0.9806
Average Train Accuracy: 0.9325
 Site-Clipart                       | Val  Loss: 0.2880 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3315 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.7949 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.5097 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.3764 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.4890 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.4482 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9550
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.4616 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 0.8472 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.5691 | Train Acc: 0.9257
 Site-Art                           | Train Loss: 0.4356 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.6063 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.2157 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2357 | Train Acc: 0.9806
Average Train Accuracy: 0.9343
 Site-Clipart                       | Val  Loss: 0.3086 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3390 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.7588 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.5248 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.3776 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4904 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.4092 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9581
===2023-08-02 00:10:41===
===2023-08-02 00:10:44===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:30 | Test Acc: 0.5362
 Test site-Art                       (0)| Epoch:30 | Test Acc: 0.6522
 Test site-RealWorld                 (3)| Epoch:30 | Test Acc: 0.6111
 Test site-Product                   (3)| Epoch:30 | Test Acc: 0.5622
Clipart: 0.5362, Art: 0.6522, RealWorld: 0.6111, Product: 0.5622, 
Average Test Accuracy(group): 0.5904, Average Test Accuracy(individual): 0.5837,
domain std=0.0447, cluster std=0.0242, individual std=0.0498, 
