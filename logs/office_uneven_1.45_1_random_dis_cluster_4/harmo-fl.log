===2023-08-01 22:49:44===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.6604 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.9256 | Train Acc: 0.4608
 Site-Clipart                       | Train Loss: 1.7032 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 1.5756 | Train Acc: 0.8977
 Site-Art                           | Train Loss: 1.6502 | Train Acc: 0.9147
 Site-RealWorld                     | Train Loss: 1.4597 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.5221 | Train Acc: 0.9806
Average Train Accuracy: 0.8619
 Site-Clipart                       | Val  Loss: 1.5594 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.6153 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.9202 | Val  Acc: 0.5408
 Site-Art                           | Val  Loss: 1.7062 | Val  Acc: 0.9153
 Site-Art                           | Val  Loss: 1.6526 | Val  Acc: 0.9176
 Site-RealWorld                     | Val  Loss: 1.6919 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.6486 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8595
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.8088
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.5408
 Best site-Art                       | Epoch:0 | Val Acc: 0.9153
 Best site-Art                       | Epoch:0 | Val Acc: 0.9176
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.9700
 Best site-Product                   | Epoch:0 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 1.1029 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.5995 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.2740 | Train Acc: 0.9324
 Site-Art                           | Train Loss: 1.0238 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.2119 | Train Acc: 0.9457
 Site-RealWorld                     | Train Loss: 0.8433 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9221 | Train Acc: 0.9806
Average Train Accuracy: 0.9135
 Site-Clipart                       | Val  Loss: 1.0083 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.0723 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.5683 | Val  Acc: 0.6633
 Site-Art                           | Val  Loss: 1.2945 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.1602 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.2227 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.1194 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9083
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9118
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6633
 Best site-Art                       | Epoch:1 | Val Acc: 0.9492
 Best site-Art                       | Epoch:1 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.9700
 Best site-Product                   | Epoch:1 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 0.6418 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.4114 | Train Acc: 0.6863
 Site-Clipart                       | Train Loss: 1.0238 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 0.6770 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.8038 | Train Acc: 0.9457
 Site-RealWorld                     | Train Loss: 0.4560 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5382 | Train Acc: 0.9903
Average Train Accuracy: 0.9157
 Site-Clipart                       | Val  Loss: 0.6464 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.7128 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.2522 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 0.9281 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8070 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.8711 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.7951 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9334
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7959
 Best site-Art                       | Epoch:2 | Val Acc: 1.0000
 Best site-Art                       | Epoch:2 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9700
 Best site-Product                   | Epoch:2 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 0.5748 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.1907 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 0.8253 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.5226 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.8412 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.2556 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3062 | Train Acc: 0.9806
Average Train Accuracy: 0.9300
 Site-Clipart                       | Val  Loss: 0.4322 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.5057 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.1110 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 0.7416 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5855 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.6086 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.4408 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9484
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9118
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8061
 Best site-Art                       | Epoch:3 | Val Acc: 1.0000
 Best site-Art                       | Epoch:3 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9800
 Best site-Product                   | Epoch:3 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 0.4327 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.0652 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.5920 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.3064 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.4872 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.1680 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2243 | Train Acc: 0.9903
Average Train Accuracy: 0.9423
 Site-Clipart                       | Val  Loss: 0.3625 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3987 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 0.9442 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.5564 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.4402 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.4946 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.3940 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9442
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 0.3501 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.0292 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 0.4927 | Train Acc: 0.9257
 Site-Art                           | Train Loss: 0.2904 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.4692 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.0957 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1179 | Train Acc: 1.0000
Average Train Accuracy: 0.9382
 Site-Clipart                       | Val  Loss: 0.2549 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3072 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 0.8130 | Val  Acc: 0.8367
 Site-Art                           | Val  Loss: 0.4948 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.3477 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.3933 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.3136 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9463
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 0.3422 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.8965 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 0.4527 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 0.2186 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.3046 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.0656 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0734 | Train Acc: 1.0000
Average Train Accuracy: 0.9383
 Site-Clipart                       | Val  Loss: 0.2239 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.2432 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.7556 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 0.3877 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.2872 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.3344 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.2416 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9338
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 0.2805 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.7955 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.4501 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.1722 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.2417 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.0457 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0669 | Train Acc: 0.9903
Average Train Accuracy: 0.9370
 Site-Clipart                       | Val  Loss: 0.1668 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.2166 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.6476 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.2954 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.2528 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.2352 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2577 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9547
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8469
 Best site-Art                       | Epoch:7 | Val Acc: 0.9661
 Best site-Art                       | Epoch:7 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 0.1828 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.7746 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.3081 | Train Acc: 0.9730
 Site-Art                           | Train Loss: 0.1459 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.2536 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0263 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0390 | Train Acc: 1.0000
Average Train Accuracy: 0.9603
 Site-Clipart                       | Val  Loss: 0.1357 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1838 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.6041 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.2646 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.2014 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 0.2190 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.1783 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9592
 Best site-Clipart                   | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9559
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8571
 Best site-Art                       | Epoch:8 | Val Acc: 0.9831
 Best site-Art                       | Epoch:8 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9800
 Best site-Product                   | Epoch:8 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.2818 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.7200 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 0.3231 | Train Acc: 0.9324
 Site-Art                           | Train Loss: 0.1960 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.3908 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0317 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0468 | Train Acc: 0.9903
Average Train Accuracy: 0.9426
 Site-Clipart                       | Val  Loss: 0.1141 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1506 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.5416 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.2347 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.1521 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.1826 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1370 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9612
 Best site-Clipart                   | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9559
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8469
 Best site-Art                       | Epoch:9 | Val Acc: 0.9661
 Best site-Art                       | Epoch:9 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.2288 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.7244 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.2520 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.1283 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.3945 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0350 | Train Acc: 0.9903
Average Train Accuracy: 0.9488
 Site-Clipart                       | Val  Loss: 0.1106 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1613 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.5735 | Val  Acc: 0.8265
 Site-Art                           | Val  Loss: 0.2042 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.1541 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.1460 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.1397 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9576
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.2446 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.7723 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 0.2357 | Train Acc: 0.9730
 Site-Art                           | Train Loss: 0.1151 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.1426 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0120 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0267 | Train Acc: 0.9903
Average Train Accuracy: 0.9476
 Site-Clipart                       | Val  Loss: 0.1126 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1424 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.4674 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.1992 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.1277 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.1534 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1148 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9652
 Best site-Clipart                   | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9559
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8776
 Best site-Art                       | Epoch:11 | Val Acc: 0.9492
 Best site-Art                       | Epoch:11 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-Product                   | Epoch:11 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.3371 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 0.6574 | Train Acc: 0.7549
 Site-Clipart                       | Train Loss: 0.2094 | Train Acc: 0.9662
 Site-Art                           | Train Loss: 0.0971 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.1533 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.0228 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0359 | Train Acc: 0.9903
Average Train Accuracy: 0.9496
 Site-Clipart                       | Val  Loss: 0.0913 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.1307 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.4971 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.1409 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1228 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.1204 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.1127 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9672
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9706
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8571
 Best site-Art                       | Epoch:12 | Val Acc: 1.0000
 Best site-Art                       | Epoch:12 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9900
 Best site-Product                   | Epoch:12 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.2892 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.6243 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.2204 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.1724 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.1497 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0195 | Train Acc: 1.0000
Average Train Accuracy: 0.9594
 Site-Clipart                       | Val  Loss: 0.0852 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1218 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.4358 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.1604 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.1065 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.1048 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0652 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9757
 Best site-Clipart                   | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9853
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8878
 Best site-Art                       | Epoch:13 | Val Acc: 0.9831
 Best site-Art                       | Epoch:13 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:13 | Val Acc: 1.0000
 Best site-Product                   | Epoch:13 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.1451 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.6788 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.2126 | Train Acc: 0.9527
 Site-Art                           | Train Loss: 0.1124 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0876 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0097 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0136 | Train Acc: 1.0000
Average Train Accuracy: 0.9472
 Site-Clipart                       | Val  Loss: 0.0591 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0929 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.4306 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.1386 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.1079 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0748 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0930 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9713
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.2609 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.6332 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.1650 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.1109 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0855 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0240 | Train Acc: 1.0000
Average Train Accuracy: 0.9599
 Site-Clipart                       | Val  Loss: 0.0612 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1025 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.4026 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.1366 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.0891 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.0930 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0615 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9716
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.2259 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.6519 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 0.1963 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.0526 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0810 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0106 | Train Acc: 1.0000
Average Train Accuracy: 0.9540
 Site-Clipart                       | Val  Loss: 0.0753 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.0784 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.3257 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0942 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0950 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.1023 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0826 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9755
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.2039 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 0.5915 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.1540 | Train Acc: 0.9730
 Site-Art                           | Train Loss: 0.0631 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0735 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0075 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0139 | Train Acc: 1.0000
Average Train Accuracy: 0.9497
 Site-Clipart                       | Val  Loss: 0.0482 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0899 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3676 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0912 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0491 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0586 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0463 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9798
 Best site-Clipart                   | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9853
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8878
 Best site-Art                       | Epoch:17 | Val Acc: 1.0000
 Best site-Art                       | Epoch:17 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:17 | Val Acc: 1.0000
 Best site-Product                   | Epoch:17 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.1489 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.5982 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.1623 | Train Acc: 0.9730
 Site-Art                           | Train Loss: 0.0760 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0886 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0112 | Train Acc: 1.0000
Average Train Accuracy: 0.9605
 Site-Clipart                       | Val  Loss: 0.0453 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0943 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.4044 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.0718 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0590 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0878 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0772 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9790
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.3013 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 0.5824 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 0.1452 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.1547 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.0695 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0115 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0152 | Train Acc: 0.9903
Average Train Accuracy: 0.9455
 Site-Clipart                       | Val  Loss: 0.0436 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0536 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3968 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.0912 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0580 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0552 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0858 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9780
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.2262 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.6283 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 0.1058 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0926 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0528 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0057 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0090 | Train Acc: 1.0000
Average Train Accuracy: 0.9573
 Site-Clipart                       | Val  Loss: 0.0436 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0609 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3562 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0757 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0512 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0781 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9805
 Best site-Clipart                   | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8878
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9900
 Best site-Product                   | Epoch:20 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.1627 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.5628 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.1149 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1042 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0586 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0056 | Train Acc: 1.0000
Average Train Accuracy: 0.9619
 Site-Clipart                       | Val  Loss: 0.0337 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0792 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3517 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.0706 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0500 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0789 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0490 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9863
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9286
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9900
 Best site-Product                   | Epoch:21 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.1890 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.6388 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.1317 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.1198 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0631 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0055 | Train Acc: 1.0000
Average Train Accuracy: 0.9657
 Site-Clipart                       | Val  Loss: 0.0303 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0676 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4033 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.0798 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0753 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0426 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9780
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.1809 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.6028 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.1286 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0566 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0395 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0092 | Train Acc: 1.0000
Average Train Accuracy: 0.9674
 Site-Clipart                       | Val  Loss: 0.0559 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.0656 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3194 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0663 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0552 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0529 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1276 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9751
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.2574 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.6046 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.0946 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0712 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0949 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0056 | Train Acc: 1.0000
Average Train Accuracy: 0.9684
 Site-Clipart                       | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0553 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3698 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0503 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0594 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0698 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9840
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.2894 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 0.6029 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.0973 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0787 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.0609 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0072 | Train Acc: 1.0000
Average Train Accuracy: 0.9503
 Site-Clipart                       | Val  Loss: 0.0258 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0387 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3110 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0811 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0544 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0382 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9824
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.1585 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.5797 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.1147 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0866 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0389 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0064 | Train Acc: 1.0000
Average Train Accuracy: 0.9583
 Site-Clipart                       | Val  Loss: 0.0304 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0470 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3706 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.0370 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0437 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0552 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0346 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9723
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.2887 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.5922 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.0858 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0603 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0313 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0074 | Train Acc: 1.0000
Average Train Accuracy: 0.9616
 Site-Clipart                       | Val  Loss: 0.0183 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0447 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3174 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0349 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0618 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0414 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9798
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.5582 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.5488 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.0971 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0558 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0351 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0081 | Train Acc: 1.0000
Average Train Accuracy: 0.9617
 Site-Clipart                       | Val  Loss: 0.0218 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0491 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2970 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0642 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0439 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0482 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9855
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.1427 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.5271 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.0845 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0487 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0418 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0053 | Train Acc: 1.0000
Average Train Accuracy: 0.9609
 Site-Clipart                       | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0509 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3150 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0495 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0360 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0494 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0387 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9811
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.3312 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.6309 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.0879 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.0866 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0571 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0063 | Train Acc: 1.0000
Average Train Accuracy: 0.9550
 Site-Clipart                       | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0394 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.2877 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0435 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0271 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0370 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0381 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9842
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.1558 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 0.5205 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.1015 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0519 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0384 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0036 | Train Acc: 1.0000
Average Train Accuracy: 0.9603
 Site-Clipart                       | Val  Loss: 0.0251 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0462 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2973 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0366 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0281 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0668 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.0412 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9788
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.3419 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 0.4838 | Train Acc: 0.8529
 Site-Clipart                       | Train Loss: 0.0732 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0532 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0319 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0039 | Train Acc: 1.0000
Average Train Accuracy: 0.9631
 Site-Clipart                       | Val  Loss: 0.0397 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.0417 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2956 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0382 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0366 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0455 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0266 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9801
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.2133 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.5518 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.0705 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0774 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0284 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0031 | Train Acc: 1.0000
Average Train Accuracy: 0.9602
 Site-Clipart                       | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0295 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2913 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0357 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0342 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9848
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.2442 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.5307 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.0676 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0930 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0509 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0046 | Train Acc: 1.0000
Average Train Accuracy: 0.9588
 Site-Clipart                       | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0352 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2842 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.0304 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0239 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0307 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0841 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9877
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9286
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:34 | Val Acc: 1.0000
 Best site-Product                   | Epoch:34 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.2530 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.4778 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.0912 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0673 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.0255 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0049 | Train Acc: 1.0000
Average Train Accuracy: 0.9602
 Site-Clipart                       | Val  Loss: 0.0166 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0498 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2510 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0385 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0538 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0240 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9848
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.1786 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.4119 | Train Acc: 0.8725
 Site-Clipart                       | Train Loss: 0.0904 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0650 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0301 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0059 | Train Acc: 1.0000
Average Train Accuracy: 0.9724
 Site-Clipart                       | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0582 | Val  Acc: 0.9853
 Site-Clipart                       | Val  Loss: 0.3086 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.0260 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0271 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0313 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9798
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.3036 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.4533 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.0853 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0701 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0263 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0042 | Train Acc: 1.0000
Average Train Accuracy: 0.9652
 Site-Clipart                       | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0450 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2572 | Val  Acc: 0.9388
 Site-Art                           | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0294 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0718 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0345 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9878
 Best site-Clipart                   | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.9388
 Best site-Art                       | Epoch:37 | Val Acc: 1.0000
 Best site-Art                       | Epoch:37 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:37 | Val Acc: 0.9900
 Best site-Product                   | Epoch:37 | Val Acc: 0.9855
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.2030 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.4701 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.0933 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0338 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0235 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0046 | Train Acc: 1.0000
Average Train Accuracy: 0.9647
 Site-Clipart                       | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0583 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3095 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0321 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0595 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0602 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9834
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.1254 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.5173 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.0537 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0710 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0749 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0078 | Train Acc: 1.0000
Average Train Accuracy: 0.9682
 Site-Clipart                       | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0373 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2739 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0234 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.0428 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0276 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9860
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.1910 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.4711 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.0708 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0736 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0263 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0065 | Train Acc: 1.0000
Average Train Accuracy: 0.9661
 Site-Clipart                       | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0281 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2698 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0320 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0407 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0371 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9848
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.3476 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.4836 | Train Acc: 0.8725
 Site-Clipart                       | Train Loss: 0.0869 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0691 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0340 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0024 | Train Acc: 1.0000
Average Train Accuracy: 0.9710
 Site-Clipart                       | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0376 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2770 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0254 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0373 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9848
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.1165 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 0.5239 | Train Acc: 0.8529
 Site-Clipart                       | Train Loss: 0.0916 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0779 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0174 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0014 | Train Acc: 1.0000
Average Train Accuracy: 0.9632
 Site-Clipart                       | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2889 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0392 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0298 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0599 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0293 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9834
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.0941 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.4082 | Train Acc: 0.9020
 Site-Clipart                       | Train Loss: 0.0822 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0424 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0243 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0027 | Train Acc: 1.0000
Average Train Accuracy: 0.9763
 Site-Clipart                       | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0529 | Val  Acc: 0.9706
 Site-Clipart                       | Val  Loss: 0.2612 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0218 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0596 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0241 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9806
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.3786 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.4576 | Train Acc: 0.8627
 Site-Clipart                       | Train Loss: 0.0757 | Train Acc: 0.9865
 Site-Art                           | Train Loss: 0.0556 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0209 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0034 | Train Acc: 1.0000
Average Train Accuracy: 0.9650
 Site-Clipart                       | Val  Loss: 0.0275 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0339 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2767 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.0680 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0376 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0640 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9824
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.1661 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.4080 | Train Acc: 0.8725
 Site-Clipart                       | Train Loss: 0.0884 | Train Acc: 0.9797
 Site-Art                           | Train Loss: 0.0451 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0221 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0015 | Train Acc: 1.0000
Average Train Accuracy: 0.9687
 Site-Clipart                       | Val  Loss: 0.0255 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0403 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2909 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0266 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0643 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0586 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9834
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.1697 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 0.4198 | Train Acc: 0.8627
 Site-Clipart                       | Train Loss: 0.0855 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0446 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0349 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0031 | Train Acc: 1.0000
Average Train Accuracy: 0.9686
 Site-Clipart                       | Val  Loss: 0.0210 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0370 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2658 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0200 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0495 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0275 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9819
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.1362 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.4110 | Train Acc: 0.8725
 Site-Clipart                       | Train Loss: 0.0799 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0441 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0243 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0030 | Train Acc: 1.0000
Average Train Accuracy: 0.9747
 Site-Clipart                       | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0402 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2823 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.0483 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0254 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0514 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0310 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9839
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.1134 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.5051 | Train Acc: 0.8529
 Site-Clipart                       | Train Loss: 0.0780 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0626 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.0298 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0057 | Train Acc: 1.0000
Average Train Accuracy: 0.9676
 Site-Clipart                       | Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0519 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2489 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0349 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0556 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0611 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9848
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.2085 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 0.3909 | Train Acc: 0.8529
 Site-Clipart                       | Train Loss: 0.0634 | Train Acc: 0.9932
 Site-Art                           | Train Loss: 0.0735 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.0423 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0047 | Train Acc: 1.0000
Average Train Accuracy: 0.9621
 Site-Clipart                       | Val  Loss: 0.0215 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0312 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2614 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 0.0908 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0660 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.0506 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9824
===2023-08-01 23:44:59===
===2023-08-01 23:45:11===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:37 | Test Acc: 0.5489
 Test site-Art                       (0)| Epoch:37 | Test Acc: 0.6584
 Test site-RealWorld                 (3)| Epoch:37 | Test Acc: 0.6151
 Test site-Product                   (3)| Epoch:37 | Test Acc: 0.5721
Clipart: 0.5489, Art: 0.6584, RealWorld: 0.6151, Product: 0.5721, 
Average Test Accuracy(group): 0.5986, Average Test Accuracy(individual): 0.5930,
domain std=0.0419, cluster std=0.0226, individual std=0.0467, 
===2023-08-02 17:39:22===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 20
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[80,138,240,35,105,97,66,
client_nums=[3,2,1,1,]
len_dataset=[766,236,162,111,]
domain number = 4
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 1.1673 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 1.1399 | Train Acc: 0.9638
 Site-amazon                        | Train Loss: 1.1844 | Train Acc: 0.9417
 Site-webcam                        | Train Loss: 1.2914 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 1.3068 | Train Acc: 0.9238
 Site-caltech                       | Train Loss: 1.2091 | Train Acc: 0.9794
 Site-dslr                          | Train Loss: 1.3826 | Train Acc: 0.9242
Average Train Accuracy: 0.9442
 Site-amazon                        | Val  Loss: 1.2164 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.2140 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.1721 | Val  Acc: 0.9625
 Site-webcam                        | Val  Loss: 1.3514 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.2850 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.2026 | Val  Acc: 0.9375
 Site-dslr                          | Val  Loss: 1.3204 | Val  Acc: 0.9091
Average Valid Accuracy: 0.9300
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9245
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9348
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9625
 Best site-webcam                    | Epoch:0 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:0 | Val Acc: 0.9286
 Best site-caltech                   | Epoch:0 | Val Acc: 0.9375
 Best site-dslr                      | Epoch:0 | Val Acc: 0.9091
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 0.5530 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.4839 | Train Acc: 0.9710
 Site-amazon                        | Train Loss: 0.5277 | Train Acc: 0.9625
 Site-webcam                        | Train Loss: 0.6851 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 0.6563 | Train Acc: 0.9714
 Site-caltech                       | Train Loss: 0.5159 | Train Acc: 0.9794
 Site-dslr                          | Train Loss: 0.6124 | Train Acc: 0.9545
Average Train Accuracy: 0.9576
 Site-amazon                        | Val  Loss: 0.5265 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.5628 | Val  Acc: 0.9239
 Site-amazon                        | Val  Loss: 0.5518 | Val  Acc: 0.9375
 Site-webcam                        | Val  Loss: 0.7539 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.5943 | Val  Acc: 0.9429
 Site-caltech                       | Val  Loss: 0.5719 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.7376 | Val  Acc: 0.9318
Average Valid Accuracy: 0.9435
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9434
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9239
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9375
 Best site-webcam                    | Epoch:1 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:1 | Val Acc: 0.9429
 Best site-caltech                   | Epoch:1 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:1 | Val Acc: 0.9318
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 0.3963 | Train Acc: 0.9250
 Site-amazon                        | Train Loss: 0.3040 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 0.2587 | Train Acc: 0.9708
 Site-webcam                        | Train Loss: 0.4592 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.3571 | Train Acc: 0.9619
 Site-caltech                       | Train Loss: 0.2942 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.3325 | Train Acc: 0.9697
Average Train Accuracy: 0.9582
 Site-amazon                        | Val  Loss: 0.3274 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.3077 | Val  Acc: 0.9457
 Site-amazon                        | Val  Loss: 0.2928 | Val  Acc: 0.9500
 Site-webcam                        | Val  Loss: 0.4392 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 0.3557 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 0.2776 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.4646 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9557
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9457
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9500
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9571
 Best site-caltech                   | Epoch:2 | Val Acc: 0.9844
 Best site-dslr                      | Epoch:2 | Val Acc: 0.9773
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 0.3129 | Train Acc: 0.9375
 Site-amazon                        | Train Loss: 0.1312 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 0.1937 | Train Acc: 0.9667
 Site-webcam                        | Train Loss: 0.3643 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 0.2584 | Train Acc: 0.9810
 Site-caltech                       | Train Loss: 0.1716 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.3645 | Train Acc: 0.9545
Average Train Accuracy: 0.9603
 Site-amazon                        | Val  Loss: 0.1806 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.2124 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.1917 | Val  Acc: 0.9625
 Site-webcam                        | Val  Loss: 0.2526 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2565 | Val  Acc: 0.9143
 Site-caltech                       | Val  Loss: 0.1638 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.3357 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9652
 Best site-amazon                    | Epoch:3 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9625
 Best site-webcam                    | Epoch:3 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9143
 Best site-caltech                   | Epoch:3 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:3 | Val Acc: 0.9545
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 0.2367 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.1064 | Train Acc: 0.9855
 Site-amazon                        | Train Loss: 0.1340 | Train Acc: 0.9792
 Site-webcam                        | Train Loss: 0.3695 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.2159 | Train Acc: 0.9619
 Site-caltech                       | Train Loss: 0.1243 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.1372 | Train Acc: 0.9545
Average Train Accuracy: 0.9680
 Site-amazon                        | Val  Loss: 0.1659 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.1572 | Val  Acc: 0.9891
 Site-amazon                        | Val  Loss: 0.1464 | Val  Acc: 0.9688
 Site-webcam                        | Val  Loss: 0.2345 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.1404 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 0.1739 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.3485 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9653
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9891
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9688
 Best site-webcam                    | Epoch:4 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:4 | Val Acc: 0.9571
 Best site-caltech                   | Epoch:4 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:4 | Val Acc: 0.9545
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 0.2125 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0911 | Train Acc: 0.9928
 Site-amazon                        | Train Loss: 0.1163 | Train Acc: 0.9833
 Site-webcam                        | Train Loss: 0.2214 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.2005 | Train Acc: 0.9810
 Site-caltech                       | Train Loss: 0.0965 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.1339 | Train Acc: 0.9394
Average Train Accuracy: 0.9702
 Site-amazon                        | Val  Loss: 0.1046 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.1409 | Val  Acc: 0.9783
 Site-amazon                        | Val  Loss: 0.1025 | Val  Acc: 0.9875
 Site-webcam                        | Val  Loss: 0.1901 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.1141 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1065 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.2863 | Val  Acc: 0.9318
Average Valid Accuracy: 0.9720
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9811
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9783
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9875
 Best site-webcam                    | Epoch:5 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:5 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:5 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:5 | Val Acc: 0.9318
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 0.1309 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.0829 | Train Acc: 0.9855
 Site-amazon                        | Train Loss: 0.0769 | Train Acc: 0.9833
 Site-webcam                        | Train Loss: 0.2094 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.1347 | Train Acc: 0.9905
 Site-caltech                       | Train Loss: 0.1073 | Train Acc: 0.9794
 Site-dslr                          | Train Loss: 0.1831 | Train Acc: 0.9697
Average Train Accuracy: 0.9716
 Site-amazon                        | Val  Loss: 0.0844 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.1225 | Val  Acc: 0.9783
 Site-amazon                        | Val  Loss: 0.0969 | Val  Acc: 0.9812
 Site-webcam                        | Val  Loss: 0.1577 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.1265 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 0.1021 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.3240 | Val  Acc: 0.9318
Average Valid Accuracy: 0.9672
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 0.1279 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0664 | Train Acc: 0.9928
 Site-amazon                        | Train Loss: 0.0658 | Train Acc: 0.9917
 Site-webcam                        | Train Loss: 0.1812 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.1796 | Train Acc: 0.9619
 Site-caltech                       | Train Loss: 0.0927 | Train Acc: 0.9794
 Site-dslr                          | Train Loss: 0.1477 | Train Acc: 0.9848
Average Train Accuracy: 0.9737
 Site-amazon                        | Val  Loss: 0.0904 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.0947 | Val  Acc: 0.9891
 Site-amazon                        | Val  Loss: 0.0671 | Val  Acc: 0.9812
 Site-webcam                        | Val  Loss: 0.1208 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0948 | Val  Acc: 0.9714
 Site-caltech                       | Val  Loss: 0.0952 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.2807 | Val  Acc: 0.9318
Average Valid Accuracy: 0.9721
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9891
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9812
 Best site-webcam                    | Epoch:7 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9714
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:7 | Val Acc: 0.9318
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 0.1435 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0482 | Train Acc: 0.9855
 Site-amazon                        | Train Loss: 0.0585 | Train Acc: 0.9958
 Site-webcam                        | Train Loss: 0.3054 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 0.0929 | Train Acc: 0.9905
 Site-caltech                       | Train Loss: 0.0953 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.0702 | Train Acc: 0.9848
Average Train Accuracy: 0.9747
 Site-amazon                        | Val  Loss: 0.0761 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.0883 | Val  Acc: 0.9783
 Site-amazon                        | Val  Loss: 0.0714 | Val  Acc: 0.9875
 Site-webcam                        | Val  Loss: 0.1220 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.0730 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 0.0762 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.1061 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9778
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9811
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9783
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9875
 Best site-webcam                    | Epoch:8 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:8 | Val Acc: 0.9571
 Best site-caltech                   | Epoch:8 | Val Acc: 0.9844
 Best site-dslr                      | Epoch:8 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 0.0925 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0326 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0394 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2497 | Train Acc: 0.9714
 Site-webcam                        | Train Loss: 0.0775 | Train Acc: 0.9905
 Site-caltech                       | Train Loss: 0.0426 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0606 | Train Acc: 0.9697
Average Train Accuracy: 0.9849
 Site-amazon                        | Val  Loss: 0.1161 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.1122 | Val  Acc: 0.9783
 Site-amazon                        | Val  Loss: 0.0627 | Val  Acc: 0.9812
 Site-webcam                        | Val  Loss: 0.0547 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0549 | Val  Acc: 0.9857
 Site-caltech                       | Val  Loss: 0.0812 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.2082 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9781
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9783
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9812
 Best site-webcam                    | Epoch:9 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9857
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9844
 Best site-dslr                      | Epoch:9 | Val Acc: 0.9545
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 10 ============
 Site-amazon                        | Train Loss: 0.0773 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0289 | Train Acc: 0.9928
 Site-amazon                        | Train Loss: 0.0493 | Train Acc: 0.9917
 Site-webcam                        | Train Loss: 0.2061 | Train Acc: 0.9714
 Site-webcam                        | Train Loss: 0.0685 | Train Acc: 0.9810
 Site-caltech                       | Train Loss: 0.0464 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0760 | Train Acc: 0.9697
Average Train Accuracy: 0.9813
 Site-amazon                        | Val  Loss: 0.0540 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.0649 | Val  Acc: 0.9891
 Site-amazon                        | Val  Loss: 0.0570 | Val  Acc: 0.9812
 Site-webcam                        | Val  Loss: 0.0622 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0442 | Val  Acc: 0.9857
 Site-caltech                       | Val  Loss: 0.1383 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.0937 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9866
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9811
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9891
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9812
 Best site-webcam                    | Epoch:10 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9857
 Best site-caltech                   | Epoch:10 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:10 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 11 ============
 Site-amazon                        | Train Loss: 0.1141 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0471 | Train Acc: 0.9928
 Site-amazon                        | Train Loss: 0.0528 | Train Acc: 0.9833
 Site-webcam                        | Train Loss: 0.1394 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 0.0632 | Train Acc: 0.9810
 Site-caltech                       | Train Loss: 0.0655 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.2666 | Train Acc: 0.9848
Average Train Accuracy: 0.9726
 Site-amazon                        | Val  Loss: 0.0566 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.0453 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0551 | Val  Acc: 0.9875
 Site-webcam                        | Val  Loss: 0.1073 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0314 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1143 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.0750 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9911
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9811
 Best site-amazon                    | Epoch:11 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9875
 Best site-webcam                    | Epoch:11 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:11 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:11 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:11 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/harmo-fl...
============ Train epoch 12 ============
 Site-amazon                        | Train Loss: 0.1249 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.0153 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0340 | Train Acc: 0.9958
 Site-webcam                        | Train Loss: 0.2610 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.0620 | Train Acc: 0.9905
 Site-caltech                       | Train Loss: 0.0559 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.0408 | Train Acc: 0.9848
Average Train Accuracy: 0.9791
 Site-amazon                        | Val  Loss: 0.0599 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.0557 | Val  Acc: 0.9783
 Site-amazon                        | Val  Loss: 0.0319 | Val  Acc: 0.9938
 Site-webcam                        | Val  Loss: 0.0440 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0671 | Val  Acc: 0.9714
 Site-caltech                       | Val  Loss: 0.1385 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.2027 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9783
============ Train epoch 13 ============
 Site-amazon                        | Train Loss: 0.1238 | Train Acc: 0.9375
 Site-amazon                        | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.1943 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.1152 | Train Acc: 0.9714
 Site-caltech                       | Train Loss: 0.0430 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0516 | Train Acc: 1.0000
Average Train Accuracy: 0.9788
 Site-amazon                        | Val  Loss: 0.0213 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0414 | Val  Acc: 0.9891
 Site-amazon                        | Val  Loss: 0.0664 | Val  Acc: 0.9812
 Site-webcam                        | Val  Loss: 0.0424 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0398 | Val  Acc: 0.9857
 Site-caltech                       | Val  Loss: 0.0695 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.1672 | Val  Acc: 0.9318
Average Valid Accuracy: 0.9818
============ Train epoch 14 ============
 Site-amazon                        | Train Loss: 0.0767 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0265 | Train Acc: 0.9928
 Site-amazon                        | Train Loss: 0.0356 | Train Acc: 0.9958
 Site-webcam                        | Train Loss: 0.2554 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.0804 | Train Acc: 0.9714
 Site-caltech                       | Train Loss: 0.0397 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.0537 | Train Acc: 0.9697
Average Train Accuracy: 0.9750
 Site-amazon                        | Val  Loss: 0.0314 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0307 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0228 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0464 | Val  Acc: 0.9857
 Site-caltech                       | Val  Loss: 0.1241 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.0874 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9902
============ Train epoch 15 ============
 Site-amazon                        | Train Loss: 0.0882 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0174 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0232 | Train Acc: 0.9958
 Site-webcam                        | Train Loss: 0.2377 | Train Acc: 0.9714
 Site-webcam                        | Train Loss: 0.0499 | Train Acc: 0.9905
 Site-caltech                       | Train Loss: 0.0414 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.0354 | Train Acc: 1.0000
Average Train Accuracy: 0.9871
 Site-amazon                        | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0421 | Val  Acc: 0.9891
 Site-amazon                        | Val  Loss: 0.0383 | Val  Acc: 0.9938
 Site-webcam                        | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0278 | Val  Acc: 0.9857
 Site-caltech                       | Val  Loss: 0.0749 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.2451 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9878
============ Train epoch 16 ============
 Site-amazon                        | Train Loss: 0.1196 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.0241 | Train Acc: 0.9928
 Site-amazon                        | Train Loss: 0.0305 | Train Acc: 0.9875
 Site-webcam                        | Train Loss: 0.1219 | Train Acc: 0.9714
 Site-webcam                        | Train Loss: 0.1078 | Train Acc: 0.9714
 Site-caltech                       | Train Loss: 0.0389 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.0441 | Train Acc: 0.9697
Average Train Accuracy: 0.9761
 Site-amazon                        | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0355 | Val  Acc: 0.9891
 Site-amazon                        | Val  Loss: 0.0356 | Val  Acc: 0.9875
 Site-webcam                        | Val  Loss: 0.0896 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.0341 | Val  Acc: 0.9857
 Site-caltech                       | Val  Loss: 0.0676 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.1055 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9862
============ Train epoch 17 ============
 Site-amazon                        | Train Loss: 0.1241 | Train Acc: 0.9750
 Site-amazon                        | Train Loss: 0.0285 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0441 | Train Acc: 0.9917
 Site-webcam                        | Train Loss: 0.1752 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.0823 | Train Acc: 0.9810
 Site-caltech                       | Train Loss: 0.0388 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.0457 | Train Acc: 1.0000
Average Train Accuracy: 0.9829
 Site-amazon                        | Val  Loss: 0.0164 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0279 | Val  Acc: 0.9875
 Site-webcam                        | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1195 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.1487 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9873
============ Train epoch 18 ============
 Site-amazon                        | Train Loss: 0.0477 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.0108 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0118 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.1154 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.0497 | Train Acc: 0.9714
 Site-caltech                       | Train Loss: 0.0393 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0535 | Train Acc: 0.9545
Average Train Accuracy: 0.9759
 Site-amazon                        | Val  Loss: 0.0492 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0307 | Val  Acc: 0.9938
 Site-webcam                        | Val  Loss: 0.0239 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1527 | Val  Acc: 0.9531
 Site-dslr                          | Val  Loss: 0.2073 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9832
============ Train epoch 19 ============
 Site-amazon                        | Train Loss: 0.1329 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.1229 | Train Acc: 0.9928
 Site-amazon                        | Train Loss: 0.0133 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.1385 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.0384 | Train Acc: 0.9905
 Site-caltech                       | Train Loss: 0.0573 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 0.0963 | Train Acc: 0.9697
Average Train Accuracy: 0.9765
 Site-amazon                        | Val  Loss: 0.0173 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0174 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0667 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.0321 | Val  Acc: 0.9714
 Site-caltech                       | Val  Loss: 0.1593 | Val  Acc: 0.9531
 Site-dslr                          | Val  Loss: 0.1796 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9798
===2023-08-02 17:58:38===
===2023-08-02 17:58:40===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[80,138,240,35,105,97,66,
client_nums=[3,2,1,1,]
len_dataset=[766,236,162,111,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (1)| Epoch:11 | Test Acc: 0.9635
 Test site-webcam                    (0)| Epoch:11 | Test Acc: 0.9492
 Test site-caltech                   (3)| Epoch:11 | Test Acc: 0.9556
 Test site-dslr                      (2)| Epoch:11 | Test Acc: 1.0000
amazon: 0.9635, webcam: 0.9492, caltech: 0.9556, dslr: 1.0000, 
Average Test Accuracy(group): 0.9671, Average Test Accuracy(individual): 0.9635,
domain std=0.0197, cluster std=0.0197, individual std=0.0161, 
