===2023-08-02 00:36:39===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.2394 | Train Acc: 0.3143
 Site-Clipart                       | Train Loss: 2.3647 | Train Acc: 0.0000
 Site-Clipart                       | Train Loss: 2.2104 | Train Acc: 0.2770
 Site-Art                           | Train Loss: 2.2129 | Train Acc: 0.4773
 Site-Art                           | Train Loss: 2.1795 | Train Acc: 0.2558
 Site-RealWorld                     | Train Loss: 2.2274 | Train Acc: 0.4600
 Site-Product                       | Train Loss: 2.2479 | Train Acc: 0.3883
Average Train Accuracy: 0.3104
 Site-Clipart                       | Val  Loss: 2.2005 | Val  Acc: 0.2553
 Site-Clipart                       | Val  Loss: 2.2392 | Val  Acc: 0.1176
 Site-Clipart                       | Val  Loss: 2.3469 | Val  Acc: 0.0204
 Site-Art                           | Val  Loss: 2.2073 | Val  Acc: 0.3559
 Site-Art                           | Val  Loss: 2.2090 | Val  Acc: 0.2471
 Site-RealWorld                     | Val  Loss: 2.2465 | Val  Acc: 0.1600
 Site-Product                       | Val  Loss: 2.2859 | Val  Acc: 0.0725
Average Valid Accuracy: 0.1755
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.2553
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.1176
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.0204
 Best site-Art                       | Epoch:0 | Val Acc: 0.3559
 Best site-Art                       | Epoch:0 | Val Acc: 0.2471
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1600
 Best site-Product                   | Epoch:0 | Val Acc: 0.0725
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 2.1392 | Train Acc: 0.4714
 Site-Clipart                       | Train Loss: 2.3185 | Train Acc: 0.0686
 Site-Clipart                       | Train Loss: 2.1560 | Train Acc: 0.5338
 Site-Art                           | Train Loss: 2.1098 | Train Acc: 0.6591
 Site-Art                           | Train Loss: 2.1696 | Train Acc: 0.4109
 Site-RealWorld                     | Train Loss: 2.1313 | Train Acc: 0.7000
 Site-Product                       | Train Loss: 2.1648 | Train Acc: 0.6311
Average Train Accuracy: 0.4964
 Site-Clipart                       | Val  Loss: 2.1252 | Val  Acc: 0.5106
 Site-Clipart                       | Val  Loss: 2.1737 | Val  Acc: 0.3382
 Site-Clipart                       | Val  Loss: 2.3038 | Val  Acc: 0.0612
 Site-Art                           | Val  Loss: 2.1531 | Val  Acc: 0.4915
 Site-Art                           | Val  Loss: 2.1425 | Val  Acc: 0.5059
 Site-RealWorld                     | Val  Loss: 2.1784 | Val  Acc: 0.5200
 Site-Product                       | Val  Loss: 2.2005 | Val  Acc: 0.3043
Average Valid Accuracy: 0.3903
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5106
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.3382
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.0612
 Best site-Art                       | Epoch:1 | Val Acc: 0.4915
 Best site-Art                       | Epoch:1 | Val Acc: 0.5059
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.5200
 Best site-Product                   | Epoch:1 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 2.0454 | Train Acc: 0.6571
 Site-Clipart                       | Train Loss: 2.2722 | Train Acc: 0.1471
 Site-Clipart                       | Train Loss: 2.0877 | Train Acc: 0.7162
 Site-Art                           | Train Loss: 2.0408 | Train Acc: 0.7159
 Site-Art                           | Train Loss: 2.0346 | Train Acc: 0.5736
 Site-RealWorld                     | Train Loss: 2.0251 | Train Acc: 0.9200
 Site-Product                       | Train Loss: 2.0754 | Train Acc: 0.8544
Average Train Accuracy: 0.6549
 Site-Clipart                       | Val  Loss: 2.0514 | Val  Acc: 0.7447
 Site-Clipart                       | Val  Loss: 2.0868 | Val  Acc: 0.4853
 Site-Clipart                       | Val  Loss: 2.2429 | Val  Acc: 0.1633
 Site-Art                           | Val  Loss: 2.0857 | Val  Acc: 0.6441
 Site-Art                           | Val  Loss: 2.0666 | Val  Acc: 0.5765
 Site-RealWorld                     | Val  Loss: 2.1169 | Val  Acc: 0.6900
 Site-Product                       | Val  Loss: 2.1390 | Val  Acc: 0.6377
Average Valid Accuracy: 0.5631
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7447
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.4853
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.1633
 Best site-Art                       | Epoch:2 | Val Acc: 0.6441
 Best site-Art                       | Epoch:2 | Val Acc: 0.5765
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6900
 Best site-Product                   | Epoch:2 | Val Acc: 0.6377
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 2.0037 | Train Acc: 0.7429
 Site-Clipart                       | Train Loss: 2.2174 | Train Acc: 0.2647
 Site-Clipart                       | Train Loss: 2.0414 | Train Acc: 0.7432
 Site-Art                           | Train Loss: 1.9837 | Train Acc: 0.8295
 Site-Art                           | Train Loss: 2.0293 | Train Acc: 0.6899
 Site-RealWorld                     | Train Loss: 1.9445 | Train Acc: 0.9467
 Site-Product                       | Train Loss: 1.9832 | Train Acc: 0.8932
Average Train Accuracy: 0.7300
 Site-Clipart                       | Val  Loss: 1.9750 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 2.0102 | Val  Acc: 0.6176
 Site-Clipart                       | Val  Loss: 2.1995 | Val  Acc: 0.1633
 Site-Art                           | Val  Loss: 2.0435 | Val  Acc: 0.6949
 Site-Art                           | Val  Loss: 1.9967 | Val  Acc: 0.7882
 Site-RealWorld                     | Val  Loss: 2.0404 | Val  Acc: 0.7800
 Site-Product                       | Val  Loss: 2.0522 | Val  Acc: 0.7246
Average Valid Accuracy: 0.6660
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8936
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6176
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.1633
 Best site-Art                       | Epoch:3 | Val Acc: 0.6949
 Best site-Art                       | Epoch:3 | Val Acc: 0.7882
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7800
 Best site-Product                   | Epoch:3 | Val Acc: 0.7246
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.9187 | Train Acc: 0.8000
 Site-Clipart                       | Train Loss: 2.1695 | Train Acc: 0.3039
 Site-Clipart                       | Train Loss: 1.9687 | Train Acc: 0.8108
 Site-Art                           | Train Loss: 1.8769 | Train Acc: 0.8523
 Site-Art                           | Train Loss: 1.9939 | Train Acc: 0.8062
 Site-RealWorld                     | Train Loss: 1.8625 | Train Acc: 0.9533
 Site-Product                       | Train Loss: 1.9172 | Train Acc: 0.9126
Average Train Accuracy: 0.7770
 Site-Clipart                       | Val  Loss: 1.8949 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.9265 | Val  Acc: 0.6618
 Site-Clipart                       | Val  Loss: 2.1375 | Val  Acc: 0.2551
 Site-Art                           | Val  Loss: 1.9722 | Val  Acc: 0.7119
 Site-Art                           | Val  Loss: 1.9301 | Val  Acc: 0.8353
 Site-RealWorld                     | Val  Loss: 1.9857 | Val  Acc: 0.8300
 Site-Product                       | Val  Loss: 1.9852 | Val  Acc: 0.7536
Average Valid Accuracy: 0.7211
 Best site-Clipart                   | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.6618
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.2551
 Best site-Art                       | Epoch:4 | Val Acc: 0.7119
 Best site-Art                       | Epoch:4 | Val Acc: 0.8353
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8300
 Best site-Product                   | Epoch:4 | Val Acc: 0.7536
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.8197 | Train Acc: 0.8429
 Site-Clipart                       | Train Loss: 2.1388 | Train Acc: 0.3235
 Site-Clipart                       | Train Loss: 1.9089 | Train Acc: 0.8243
 Site-Art                           | Train Loss: 1.8199 | Train Acc: 0.8636
 Site-Art                           | Train Loss: 1.9866 | Train Acc: 0.8450
 Site-RealWorld                     | Train Loss: 1.7756 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.8194 | Train Acc: 0.9320
Average Train Accuracy: 0.8016
 Site-Clipart                       | Val  Loss: 1.8250 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.8711 | Val  Acc: 0.6618
 Site-Clipart                       | Val  Loss: 2.0843 | Val  Acc: 0.3265
 Site-Art                           | Val  Loss: 1.9396 | Val  Acc: 0.8136
 Site-Art                           | Val  Loss: 1.8590 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.9328 | Val  Acc: 0.8800
 Site-Product                       | Val  Loss: 1.9272 | Val  Acc: 0.8841
Average Valid Accuracy: 0.7783
 Best site-Clipart                   | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.6618
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.3265
 Best site-Art                       | Epoch:5 | Val Acc: 0.8136
 Best site-Art                       | Epoch:5 | Val Acc: 0.8824
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8800
 Best site-Product                   | Epoch:5 | Val Acc: 0.8841
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.8116 | Train Acc: 0.8714
 Site-Clipart                       | Train Loss: 2.0785 | Train Acc: 0.4020
 Site-Clipart                       | Train Loss: 1.8821 | Train Acc: 0.8311
 Site-Art                           | Train Loss: 1.7500 | Train Acc: 0.8523
 Site-Art                           | Train Loss: 1.8372 | Train Acc: 0.8450
 Site-RealWorld                     | Train Loss: 1.6920 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.7349 | Train Acc: 0.9709
Average Train Accuracy: 0.8237
 Site-Clipart                       | Val  Loss: 1.7388 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.7751 | Val  Acc: 0.6765
 Site-Clipart                       | Val  Loss: 2.0500 | Val  Acc: 0.4082
 Site-Art                           | Val  Loss: 1.8756 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.8015 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.8713 | Val  Acc: 0.8800
 Site-Product                       | Val  Loss: 1.8568 | Val  Acc: 0.8551
Average Valid Accuracy: 0.7867
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.6765
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.4082
 Best site-Art                       | Epoch:6 | Val Acc: 0.8475
 Best site-Art                       | Epoch:6 | Val Acc: 0.8824
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8800
 Best site-Product                   | Epoch:6 | Val Acc: 0.8551
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.6934 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 2.0255 | Train Acc: 0.4706
 Site-Clipart                       | Train Loss: 1.8153 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 1.6784 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.7345 | Train Acc: 0.9225
 Site-RealWorld                     | Train Loss: 1.6050 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.6606 | Train Acc: 0.9806
Average Train Accuracy: 0.8636
 Site-Clipart                       | Val  Loss: 1.6759 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.7224 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 2.0032 | Val  Acc: 0.4388
 Site-Art                           | Val  Loss: 1.8109 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.7506 | Val  Acc: 0.8941
 Site-RealWorld                     | Val  Loss: 1.8039 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 1.7894 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8290
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7941
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.4388
 Best site-Art                       | Epoch:7 | Val Acc: 0.9492
 Best site-Art                       | Epoch:7 | Val Acc: 0.8941
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9000
 Best site-Product                   | Epoch:7 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.5949 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 1.9878 | Train Acc: 0.4706
 Site-Clipart                       | Train Loss: 1.7289 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 1.6123 | Train Acc: 0.8977
 Site-Art                           | Train Loss: 1.8289 | Train Acc: 0.9147
 Site-RealWorld                     | Train Loss: 1.5235 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.5784 | Train Acc: 0.9709
Average Train Accuracy: 0.8568
 Site-Clipart                       | Val  Loss: 1.5931 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.6655 | Val  Acc: 0.7647
 Site-Clipart                       | Val  Loss: 1.9554 | Val  Acc: 0.5102
 Site-Art                           | Val  Loss: 1.7530 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.6838 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 1.7386 | Val  Acc: 0.9400
 Site-Product                       | Val  Loss: 1.7022 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8456
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7647
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.5102
 Best site-Art                       | Epoch:8 | Val Acc: 0.9492
 Best site-Art                       | Epoch:8 | Val Acc: 0.9059
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9400
 Best site-Product                   | Epoch:8 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 1.5986 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.9320 | Train Acc: 0.4902
 Site-Clipart                       | Train Loss: 1.6966 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 1.5591 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.8181 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.4640 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.5171 | Train Acc: 0.9612
Average Train Accuracy: 0.8741
 Site-Clipart                       | Val  Loss: 1.5266 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 1.5626 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.9122 | Val  Acc: 0.5000
 Site-Art                           | Val  Loss: 1.7143 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.6152 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.7035 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 1.6599 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8618
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8088
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.5000
 Best site-Art                       | Epoch:9 | Val Acc: 0.9492
 Best site-Art                       | Epoch:9 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9300
 Best site-Product                   | Epoch:9 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 1.5347 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.8966 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.6549 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 1.4742 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.8054 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 1.3765 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.4436 | Train Acc: 0.9709
Average Train Accuracy: 0.8802
 Site-Clipart                       | Val  Loss: 1.4572 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 1.5549 | Val  Acc: 0.7794
 Site-Clipart                       | Val  Loss: 1.8678 | Val  Acc: 0.5204
 Site-Art                           | Val  Loss: 1.6555 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.5728 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.6293 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.5764 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8679
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7794
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.5204
 Best site-Art                       | Epoch:10 | Val Acc: 0.9661
 Best site-Art                       | Epoch:10 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9500
 Best site-Product                   | Epoch:10 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 1.4963 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.8504 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.6028 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 1.4043 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.7225 | Train Acc: 0.9380
 Site-RealWorld                     | Train Loss: 1.3011 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.3570 | Train Acc: 0.9806
Average Train Accuracy: 0.8859
 Site-Clipart                       | Val  Loss: 1.4048 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.4553 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.8191 | Val  Acc: 0.5408
 Site-Art                           | Val  Loss: 1.6163 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.5105 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.5726 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.5314 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8736
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8088
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.5408
 Best site-Art                       | Epoch:11 | Val Acc: 0.9661
 Best site-Art                       | Epoch:11 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9500
 Best site-Product                   | Epoch:11 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 1.5213 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.8089 | Train Acc: 0.5392
 Site-Clipart                       | Train Loss: 1.5449 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 1.3450 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.6569 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.2714 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.2969 | Train Acc: 0.9806
Average Train Accuracy: 0.8940
 Site-Clipart                       | Val  Loss: 1.3400 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.3953 | Val  Acc: 0.8676
 Site-Clipart                       | Val  Loss: 1.7972 | Val  Acc: 0.6020
 Site-Art                           | Val  Loss: 1.5482 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.4495 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.5186 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.4850 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8903
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8676
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.6020
 Best site-Art                       | Epoch:12 | Val Acc: 0.9661
 Best site-Art                       | Epoch:12 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9800
 Best site-Product                   | Epoch:12 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 1.4347 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.7716 | Train Acc: 0.5686
 Site-Clipart                       | Train Loss: 1.5170 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 1.3290 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.5711 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 1.1693 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2292 | Train Acc: 0.9806
Average Train Accuracy: 0.8846
 Site-Clipart                       | Val  Loss: 1.2959 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.3754 | Val  Acc: 0.8382
 Site-Clipart                       | Val  Loss: 1.7409 | Val  Acc: 0.6122
 Site-Art                           | Val  Loss: 1.5180 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.3968 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.4725 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.4047 | Val  Acc: 0.9420
Average Valid Accuracy: 0.8927
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8382
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.6122
 Best site-Art                       | Epoch:13 | Val Acc: 0.9661
 Best site-Art                       | Epoch:13 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.9800
 Best site-Product                   | Epoch:13 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 1.1981 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.7373 | Train Acc: 0.6078
 Site-Clipart                       | Train Loss: 1.4492 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 1.2661 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.4220 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 1.1121 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1866 | Train Acc: 0.9903
Average Train Accuracy: 0.9033
 Site-Clipart                       | Val  Loss: 1.2101 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.2538 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.7077 | Val  Acc: 0.6429
 Site-Art                           | Val  Loss: 1.4700 | Val  Acc: 0.9322
 Site-Art                           | Val  Loss: 1.3609 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.4134 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.3712 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9069
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9265
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.6429
 Best site-Art                       | Epoch:14 | Val Acc: 0.9322
 Best site-Art                       | Epoch:14 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9800
 Best site-Product                   | Epoch:14 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 1.2658 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.6908 | Train Acc: 0.6176
 Site-Clipart                       | Train Loss: 1.4370 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 1.1699 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.2925 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 1.0314 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1344 | Train Acc: 0.9806
Average Train Accuracy: 0.9057
 Site-Clipart                       | Val  Loss: 1.1618 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.2510 | Val  Acc: 0.8382
 Site-Clipart                       | Val  Loss: 1.6537 | Val  Acc: 0.6735
 Site-Art                           | Val  Loss: 1.4286 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.2771 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.3680 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.2687 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9030
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 1.2186 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.6914 | Train Acc: 0.5980
 Site-Clipart                       | Train Loss: 1.4075 | Train Acc: 0.9257
 Site-Art                           | Train Loss: 1.0930 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.5151 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.9692 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0449 | Train Acc: 0.9903
Average Train Accuracy: 0.9072
 Site-Clipart                       | Val  Loss: 1.1179 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.1882 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.6306 | Val  Acc: 0.6429
 Site-Art                           | Val  Loss: 1.3777 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.2832 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.3380 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.2352 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9036
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 1.1216 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.6571 | Train Acc: 0.6275
 Site-Clipart                       | Train Loss: 1.3346 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 1.0478 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.4573 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.9381 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.9982 | Train Acc: 0.9806
Average Train Accuracy: 0.9097
 Site-Clipart                       | Val  Loss: 1.0624 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.1090 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.6081 | Val  Acc: 0.6735
 Site-Art                           | Val  Loss: 1.3327 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 1.1833 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.2770 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 1.1970 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9171
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8971
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.6735
 Best site-Art                       | Epoch:17 | Val Acc: 0.9831
 Best site-Art                       | Epoch:17 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:17 | Val Acc: 0.9900
 Best site-Product                   | Epoch:17 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 1.0367 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.6102 | Train Acc: 0.6275
 Site-Clipart                       | Train Loss: 1.3173 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 1.0421 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.4697 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.8744 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9318 | Train Acc: 0.9806
Average Train Accuracy: 0.9041
 Site-Clipart                       | Val  Loss: 1.0171 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 1.1065 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.5740 | Val  Acc: 0.7245
 Site-Art                           | Val  Loss: 1.2704 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1446 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.2357 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.1195 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9207
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8971
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.7245
 Best site-Art                       | Epoch:18 | Val Acc: 1.0000
 Best site-Art                       | Epoch:18 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.9500
 Best site-Product                   | Epoch:18 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 1.0349 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.5863 | Train Acc: 0.6373
 Site-Clipart                       | Train Loss: 1.3144 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 1.0157 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.3227 | Train Acc: 0.9380
 Site-RealWorld                     | Train Loss: 0.8188 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8873 | Train Acc: 0.9806
Average Train Accuracy: 0.9028
 Site-Clipart                       | Val  Loss: 0.9783 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.0109 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.5609 | Val  Acc: 0.6531
 Site-Art                           | Val  Loss: 1.2553 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.1266 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.2013 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.1159 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9065
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 1.0928 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 1.5407 | Train Acc: 0.6667
 Site-Clipart                       | Train Loss: 1.2226 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.9622 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.1916 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.7643 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.8348 | Train Acc: 0.9806
Average Train Accuracy: 0.9188
 Site-Clipart                       | Val  Loss: 0.9458 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.9757 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.4909 | Val  Acc: 0.7245
 Site-Art                           | Val  Loss: 1.2203 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.0716 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1571 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 1.0546 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9281
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9265
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.7245
 Best site-Art                       | Epoch:20 | Val Acc: 0.9661
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9800
 Best site-Product                   | Epoch:20 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.9861 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.5522 | Train Acc: 0.6373
 Site-Clipart                       | Train Loss: 1.1943 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.9661 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.0439 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.7141 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7841 | Train Acc: 0.9903
Average Train Accuracy: 0.9135
 Site-Clipart                       | Val  Loss: 0.8835 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.9650 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.4684 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.1964 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 1.0459 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.1310 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 1.0332 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9242
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.9837 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.4952 | Train Acc: 0.6863
 Site-Clipart                       | Train Loss: 1.2136 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.9562 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.2126 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.6982 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7407 | Train Acc: 0.9806
Average Train Accuracy: 0.9146
 Site-Clipart                       | Val  Loss: 0.8355 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.8921 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.4522 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.1384 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.9772 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.1108 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.9934 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9305
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9118
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.7755
 Best site-Art                       | Epoch:22 | Val Acc: 0.9661
 Best site-Art                       | Epoch:22 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9700
 Best site-Product                   | Epoch:22 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.8263 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.4987 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1308 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.8395 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.9567 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.6463 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.7208 | Train Acc: 0.9903
Average Train Accuracy: 0.9268
 Site-Clipart                       | Val  Loss: 0.7935 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.8448 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.3876 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 1.1365 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.9697 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.0410 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.9819 | Val  Acc: 0.9275
Average Valid Accuracy: 0.9288
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.9296 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.4609 | Train Acc: 0.6765
 Site-Clipart                       | Train Loss: 1.1301 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.7997 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.3261 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.6104 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6709 | Train Acc: 0.9903
Average Train Accuracy: 0.9267
 Site-Clipart                       | Val  Loss: 0.7720 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.8256 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.3934 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.0584 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.9308 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.0356 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.9026 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9261
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.8859 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.4130 | Train Acc: 0.6863
 Site-Clipart                       | Train Loss: 1.0789 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.7430 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.2437 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.5529 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6277 | Train Acc: 0.9806
Average Train Accuracy: 0.9169
 Site-Clipart                       | Val  Loss: 0.7493 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.7748 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.3419 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 1.0501 | Val  Acc: 0.9153
 Site-Art                           | Val  Loss: 0.9120 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.9556 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.8468 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9314
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.7959
 Best site-Art                       | Epoch:25 | Val Acc: 0.9153
 Best site-Art                       | Epoch:25 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:25 | Val Acc: 0.9800
 Best site-Product                   | Epoch:25 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.7952 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.3896 | Train Acc: 0.6765
 Site-Clipart                       | Train Loss: 1.0983 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.7870 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.9616 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.5529 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6115 | Train Acc: 0.9806
Average Train Accuracy: 0.9184
 Site-Clipart                       | Val  Loss: 0.7427 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.7952 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.3324 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.0103 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8597 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.9406 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.7535 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9274
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.7544 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.3870 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.0280 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.6599 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.0193 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.4781 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5730 | Train Acc: 0.9806
Average Train Accuracy: 0.9249
 Site-Clipart                       | Val  Loss: 0.6530 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.7490 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.2915 | Val  Acc: 0.8265
 Site-Art                           | Val  Loss: 0.9852 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.8191 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.9220 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.7540 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9467
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.8265
 Best site-Art                       | Epoch:27 | Val Acc: 0.9831
 Best site-Art                       | Epoch:27 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:27 | Val Acc: 0.9500
 Best site-Product                   | Epoch:27 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 1.0028 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.3428 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.0155 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.7029 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.0277 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.4683 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5321 | Train Acc: 0.9806
Average Train Accuracy: 0.9389
 Site-Clipart                       | Val  Loss: 0.6335 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6794 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.2909 | Val  Acc: 0.8265
 Site-Art                           | Val  Loss: 0.9698 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.7873 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8790 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.8191 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9373
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.5919 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.2847 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 0.9918 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.6218 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.1004 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.4584 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4918 | Train Acc: 0.9806
Average Train Accuracy: 0.9263
 Site-Clipart                       | Val  Loss: 0.6288 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6714 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.2790 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 0.9430 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.7803 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.8540 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.7109 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9337
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.8293 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.3217 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 0.9666 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.5970 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.1569 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.4419 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4619 | Train Acc: 0.9806
Average Train Accuracy: 0.9191
 Site-Clipart                       | Val  Loss: 0.5850 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.6213 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.2410 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 0.8844 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.7405 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.8365 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.6748 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9441
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.6261 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.3005 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 0.9355 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 0.5987 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.9571 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.3855 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4362 | Train Acc: 0.9903
Average Train Accuracy: 0.9238
 Site-Clipart                       | Val  Loss: 0.5677 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.6476 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.2034 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.8811 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.7170 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.8407 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.6435 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9422
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.8012 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.2458 | Train Acc: 0.7549
 Site-Clipart                       | Train Loss: 0.8559 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 0.5493 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.9326 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.3716 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4259 | Train Acc: 0.9806
Average Train Accuracy: 0.9341
 Site-Clipart                       | Val  Loss: 0.5559 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5874 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.2034 | Val  Acc: 0.8367
 Site-Art                           | Val  Loss: 0.8430 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.7148 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.7863 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.6190 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9372
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.6821 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.2470 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 0.9080 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.5937 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.8065 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.3596 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3750 | Train Acc: 0.9806
Average Train Accuracy: 0.9373
 Site-Clipart                       | Val  Loss: 0.5129 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5631 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.1725 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.8236 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.6707 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.7675 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.5979 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9481
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.8571
 Best site-Art                       | Epoch:33 | Val Acc: 0.9661
 Best site-Art                       | Epoch:33 | Val Acc: 0.9882
 Best site-RealWorld                 | Epoch:33 | Val Acc: 0.9700
 Best site-Product                   | Epoch:33 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.6488 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.2519 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 0.8465 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.6152 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.8105 | Train Acc: 0.9380
 Site-RealWorld                     | Train Loss: 0.3210 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3823 | Train Acc: 0.9903
Average Train Accuracy: 0.9186
 Site-Clipart                       | Val  Loss: 0.4974 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.5649 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.1732 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 0.7993 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6768 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.7448 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.6168 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9437
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.5890 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.1976 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 0.8537 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 0.5205 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.6443 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.3235 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3426 | Train Acc: 0.9806
Average Train Accuracy: 0.9256
 Site-Clipart                       | Val  Loss: 0.4705 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5356 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.0996 | Val  Acc: 0.8367
 Site-Art                           | Val  Loss: 0.7860 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.6224 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.7488 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.5474 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9455
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.6071 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.1580 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 0.8134 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.4686 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.6997 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.2771 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3524 | Train Acc: 0.9903
Average Train Accuracy: 0.9340
 Site-Clipart                       | Val  Loss: 0.4832 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5710 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.1164 | Val  Acc: 0.8265
 Site-Art                           | Val  Loss: 0.7588 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.6182 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.6839 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.5378 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9387
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.6397 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.1614 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 0.8009 | Train Acc: 0.9054
 Site-Art                           | Train Loss: 0.4914 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.6673 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.2843 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3210 | Train Acc: 0.9903
Average Train Accuracy: 0.9305
 Site-Clipart                       | Val  Loss: 0.4429 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5087 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.0969 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.7332 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.5893 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.6732 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5191 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9471
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.5874 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.1533 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 0.8342 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.4038 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.6154 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.2709 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3113 | Train Acc: 0.9903
Average Train Accuracy: 0.9237
 Site-Clipart                       | Val  Loss: 0.4105 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4966 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.0667 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 0.7398 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.5917 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.6570 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.5515 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9320
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.4547 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 1.1992 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 0.6865 | Train Acc: 0.9324
 Site-Art                           | Train Loss: 0.4401 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.9836 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.2509 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2910 | Train Acc: 0.9903
Average Train Accuracy: 0.9421
 Site-Clipart                       | Val  Loss: 0.4104 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.4799 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.0761 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 0.6831 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.5493 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.6341 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.4747 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9417
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.5444 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.1383 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 0.7293 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.4672 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.7354 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.2478 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2831 | Train Acc: 0.9806
Average Train Accuracy: 0.9326
 Site-Clipart                       | Val  Loss: 0.4191 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.4832 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.0436 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.6717 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.5595 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.6252 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5157 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9515
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.8469
 Best site-Art                       | Epoch:40 | Val Acc: 0.9661
 Best site-Art                       | Epoch:40 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:40 | Val Acc: 0.9800
 Best site-Product                   | Epoch:40 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.5696 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.1539 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 0.7447 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.4759 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.6795 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.2336 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2567 | Train Acc: 0.9903
Average Train Accuracy: 0.9303
 Site-Clipart                       | Val  Loss: 0.3882 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.4319 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.0456 | Val  Acc: 0.8367
 Site-Art                           | Val  Loss: 0.6636 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.5339 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.6026 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.4783 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9467
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.4299 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.1243 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 0.7352 | Train Acc: 0.9122
 Site-Art                           | Train Loss: 0.4395 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.5153 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.2112 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2420 | Train Acc: 0.9903
Average Train Accuracy: 0.9328
 Site-Clipart                       | Val  Loss: 0.4008 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4391 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 1.0011 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.6350 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.5175 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.5746 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.4504 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9433
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.3976 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 1.0933 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 0.6964 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.4260 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.5171 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.1834 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2382 | Train Acc: 0.9806
Average Train Accuracy: 0.9322
 Site-Clipart                       | Val  Loss: 0.3703 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.4373 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 0.9994 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.6218 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.5025 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.6090 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.4484 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9500
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.5444 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.0625 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.6811 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.3548 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.4859 | Train Acc: 0.9922
 Site-RealWorld                     | Train Loss: 0.1773 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2189 | Train Acc: 0.9806
Average Train Accuracy: 0.9397
 Site-Clipart                       | Val  Loss: 0.3940 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4118 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 0.9929 | Val  Acc: 0.8163
 Site-Art                           | Val  Loss: 0.6067 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.4687 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5572 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.4924 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9382
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.4535 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.0564 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.6558 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.3902 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.4898 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.1564 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2106 | Train Acc: 1.0000
Average Train Accuracy: 0.9393
 Site-Clipart                       | Val  Loss: 0.3646 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.3793 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9652 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 0.6013 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.4672 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5730 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.4544 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9515
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.8673
 Best site-Art                       | Epoch:45 | Val Acc: 0.9661
 Best site-Art                       | Epoch:45 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:45 | Val Acc: 0.9600
 Best site-Product                   | Epoch:45 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/term...
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.4061 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.0397 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.6668 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.3638 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.7292 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.1724 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2074 | Train Acc: 1.0000
Average Train Accuracy: 0.9408
 Site-Clipart                       | Val  Loss: 0.3406 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4276 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 0.9417 | Val  Acc: 0.8265
 Site-Art                           | Val  Loss: 0.5834 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.4483 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5377 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.4161 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9430
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.3734 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.0250 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.6501 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.4009 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.4484 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.1604 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.1869 | Train Acc: 0.9903
Average Train Accuracy: 0.9391
 Site-Clipart                       | Val  Loss: 0.3296 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 0.3726 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 0.9434 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.5702 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.4387 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.5169 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.3972 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9487
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.3171 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.0672 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 0.6539 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.3635 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.6798 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.1473 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2018 | Train Acc: 0.9806
Average Train Accuracy: 0.9238
 Site-Clipart                       | Val  Loss: 0.3174 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3801 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 0.9375 | Val  Acc: 0.8367
 Site-Art                           | Val  Loss: 0.5701 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.4273 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.5143 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.4024 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9400
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.3619 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 0.9537 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.6237 | Train Acc: 0.9189
 Site-Art                           | Train Loss: 0.3570 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 0.6690 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.1563 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1637 | Train Acc: 0.9806
Average Train Accuracy: 0.9461
 Site-Clipart                       | Val  Loss: 0.3289 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.3851 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 0.8945 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.5873 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.4251 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5154 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.3675 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9353
===2023-08-02 01:01:22===
===2023-08-02 01:01:25===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.5447
 Test site-Art                       (0)| Epoch:45 | Test Acc: 0.6522
 Test site-RealWorld                 (3)| Epoch:45 | Test Acc: 0.6071
 Test site-Product                   (3)| Epoch:45 | Test Acc: 0.5572
Clipart: 0.5447, Art: 0.6522, RealWorld: 0.6071, Product: 0.5572, 
Average Test Accuracy(group): 0.5903, Average Test Accuracy(individual): 0.5861,
domain std=0.0427, cluster std=0.0220, individual std=0.0465, 
