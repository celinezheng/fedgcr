===2023-08-01 21:18:33===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 3, 1, ]
cnt=[1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.0021 | Train Acc: 0.2429
 Site-Clipart                   (2) | Train Loss: 2.2525 | Train Acc: 0.0392
 Site-Clipart                   (2) | Train Loss: 1.7399 | Train Acc: 0.6216
 Site-Art                       (0) | Train Loss: 1.7975 | Train Acc: 0.4773
 Site-Art                       (2) | Train Loss: 1.9061 | Train Acc: 0.3488
 Site-RealWorld                 (0) | Train Loss: 1.8782 | Train Acc: 0.4000
 Site-Product                   (3) | Train Loss: 1.9430 | Train Acc: 0.2039
Average Train Accuracy: 0.3334
 Site-Clipart                   (1) | Val  Loss: 1.6430 | Val  Acc: 0.7234
 Site-Clipart                   (2) | Val  Loss: 1.7006 | Val  Acc: 0.5147
 Site-Clipart                   (2) | Val  Loss: 2.2567 | Val  Acc: 0.0612
 Site-Art                       (0) | Val  Loss: 1.7362 | Val  Acc: 0.5085
 Site-Art                       (2) | Val  Loss: 1.8956 | Val  Acc: 0.3176
 Site-RealWorld                 (0) | Val  Loss: 2.2202 | Val  Acc: 0.0600
 Site-Product                   (3) | Val  Loss: 2.3466 | Val  Acc: 0.1014
Average Valid Accuracy: 0.3267
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.7234
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.5147
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.0612
 Best site-Art                      (0)  | Epoch:0 | Val Acc: 0.5085
 Best site-Art                      (2)  | Epoch:0 | Val Acc: 0.3176
 Best site-RealWorld                (0)  | Epoch:0 | Val Acc: 0.0600
 Best site-Product                  (3)  | Epoch:0 | Val Acc: 0.1014
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 3, 2, 1, ]
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.2656 | Train Acc: 0.7714
 Site-Clipart                   (2) | Train Loss: 2.0962 | Train Acc: 0.0882
 Site-Clipart                   (2) | Train Loss: 1.8036 | Train Acc: 0.0878
 Site-Art                       (1) | Train Loss: 1.3549 | Train Acc: 0.7614
 Site-Art                       (1) | Train Loss: 1.8242 | Train Acc: 0.0698
 Site-RealWorld                 (1) | Train Loss: 1.3099 | Train Acc: 0.7600
 Site-Product                   (3) | Train Loss: 1.3157 | Train Acc: 0.6214
Average Train Accuracy: 0.4514
 Site-Clipart                   (0) | Val  Loss: 1.7418 | Val  Acc: 0.0638
 Site-Clipart                   (2) | Val  Loss: 1.6916 | Val  Acc: 0.1176
 Site-Clipart                   (2) | Val  Loss: 1.9821 | Val  Acc: 0.0714
 Site-Art                       (1) | Val  Loss: 1.8364 | Val  Acc: 0.0678
 Site-Art                       (1) | Val  Loss: 1.9002 | Val  Acc: 0.0471
 Site-RealWorld                 (1) | Val  Loss: 1.9756 | Val  Acc: 0.2600
 Site-Product                   (3) | Val  Loss: 2.0038 | Val  Acc: 0.6087
Average Valid Accuracy: 0.1766
============ Train epoch 2 ============
cnt=[3, 2, 1, 1, ]
cnt=[1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (3) | Train Loss: 1.7497 | Train Acc: 0.3000
 Site-Clipart                   (2) | Train Loss: 1.7190 | Train Acc: 0.4216
 Site-Clipart                   (1) | Train Loss: 1.3474 | Train Acc: 0.6689
 Site-Art                       (0) | Train Loss: 1.6607 | Train Acc: 0.4659
 Site-Art                       (1) | Train Loss: 1.3118 | Train Acc: 0.6512
 Site-RealWorld                 (0) | Train Loss: 1.6501 | Train Acc: 0.4400
 Site-Product                   (0) | Train Loss: 1.7080 | Train Acc: 0.2524
Average Train Accuracy: 0.4571
 Site-Clipart                   (3) | Val  Loss: 1.2075 | Val  Acc: 0.7660
 Site-Clipart                   (2) | Val  Loss: 1.1964 | Val  Acc: 0.8235
 Site-Clipart                   (1) | Val  Loss: 1.4558 | Val  Acc: 0.6122
 Site-Art                       (0) | Val  Loss: 1.3603 | Val  Acc: 0.6780
 Site-Art                       (1) | Val  Loss: 1.3930 | Val  Acc: 0.6235
 Site-RealWorld                 (0) | Val  Loss: 1.7353 | Val  Acc: 0.3100
 Site-Product                   (0) | Val  Loss: 2.0342 | Val  Acc: 0.2609
Average Valid Accuracy: 0.5820
 Best site-Clipart                  (3)  | Epoch:2 | Val Acc: 0.7660
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.8235
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.6122
 Best site-Art                      (0)  | Epoch:2 | Val Acc: 0.6780
 Best site-Art                      (1)  | Epoch:2 | Val Acc: 0.6235
 Best site-RealWorld                (0)  | Epoch:2 | Val Acc: 0.3100
 Best site-Product                  (0)  | Epoch:2 | Val Acc: 0.2609
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 1, 3, 1, ]
cnt=[3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (3) | Train Loss: 0.9250 | Train Acc: 0.9000
 Site-Clipart                   (2) | Train Loss: 1.7925 | Train Acc: 0.1471
 Site-Clipart                   (2) | Train Loss: 1.8506 | Train Acc: 0.2027
 Site-Art                       (0) | Train Loss: 1.0075 | Train Acc: 0.7273
 Site-Art                       (2) | Train Loss: 1.9329 | Train Acc: 0.1163
 Site-RealWorld                 (0) | Train Loss: 0.9382 | Train Acc: 0.8400
 Site-Product                   (1) | Train Loss: 0.9177 | Train Acc: 0.8641
Average Train Accuracy: 0.5425
 Site-Clipart                   (3) | Val  Loss: 1.5124 | Val  Acc: 0.3830
 Site-Clipart                   (2) | Val  Loss: 1.5750 | Val  Acc: 0.2941
 Site-Clipart                   (2) | Val  Loss: 1.8748 | Val  Acc: 0.0918
 Site-Art                       (0) | Val  Loss: 1.7921 | Val  Acc: 0.0678
 Site-Art                       (2) | Val  Loss: 1.6977 | Val  Acc: 0.2000
 Site-RealWorld                 (0) | Val  Loss: 1.6386 | Val  Acc: 0.3700
 Site-Product                   (1) | Val  Loss: 1.4228 | Val  Acc: 0.6232
Average Valid Accuracy: 0.2900
============ Train epoch 4 ============
cnt=[2, 3, 1, 1, ]
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (2) | Train Loss: 1.8712 | Train Acc: 0.1429
 Site-Clipart                   (1) | Train Loss: 1.4461 | Train Acc: 0.5098
 Site-Clipart                   (0) | Train Loss: 1.1068 | Train Acc: 0.7230
 Site-Art                       (1) | Train Loss: 1.6699 | Train Acc: 0.2727
 Site-Art                       (0) | Train Loss: 1.0473 | Train Acc: 0.7752
 Site-RealWorld                 (1) | Train Loss: 1.5989 | Train Acc: 0.3933
 Site-Product                   (3) | Train Loss: 1.7703 | Train Acc: 0.2136
Average Train Accuracy: 0.4329
 Site-Clipart                   (2) | Val  Loss: 0.8631 | Val  Acc: 0.8936
 Site-Clipart                   (1) | Val  Loss: 0.8519 | Val  Acc: 0.8971
 Site-Clipart                   (0) | Val  Loss: 1.1525 | Val  Acc: 0.7551
 Site-Art                       (1) | Val  Loss: 1.1210 | Val  Acc: 0.7288
 Site-Art                       (0) | Val  Loss: 1.0323 | Val  Acc: 0.8471
 Site-RealWorld                 (1) | Val  Loss: 1.4247 | Val  Acc: 0.4500
 Site-Product                   (3) | Val  Loss: 1.7617 | Val  Acc: 0.2464
Average Valid Accuracy: 0.6883
 Best site-Clipart                  (2)  | Epoch:4 | Val Acc: 0.8936
 Best site-Clipart                  (1)  | Epoch:4 | Val Acc: 0.8971
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7551
 Best site-Art                      (1)  | Epoch:4 | Val Acc: 0.7288
 Best site-Art                      (0)  | Epoch:4 | Val Acc: 0.8471
 Best site-RealWorld                (1)  | Epoch:4 | Val Acc: 0.4500
 Best site-Product                  (3)  | Epoch:4 | Val Acc: 0.2464
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 2, 2, ]
cnt=[3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 0.7262 | Train Acc: 0.9286
 Site-Clipart                   (1) | Train Loss: 1.5685 | Train Acc: 0.2941
 Site-Clipart                   (2) | Train Loss: 1.8174 | Train Acc: 0.2973
 Site-Art                       (3) | Train Loss: 0.7859 | Train Acc: 0.8750
 Site-Art                       (2) | Train Loss: 1.8122 | Train Acc: 0.2248
 Site-RealWorld                 (3) | Train Loss: 0.6907 | Train Acc: 0.9200
 Site-Product                   (0) | Train Loss: 0.7125 | Train Acc: 0.9709
Average Train Accuracy: 0.6444
 Site-Clipart                   (0) | Val  Loss: 1.3545 | Val  Acc: 0.6383
 Site-Clipart                   (1) | Val  Loss: 1.4158 | Val  Acc: 0.4559
 Site-Clipart                   (2) | Val  Loss: 1.6684 | Val  Acc: 0.2551
 Site-Art                       (3) | Val  Loss: 1.7316 | Val  Acc: 0.2373
 Site-Art                       (2) | Val  Loss: 1.4936 | Val  Acc: 0.3412
 Site-RealWorld                 (3) | Val  Loss: 1.2941 | Val  Acc: 0.6500
 Site-Product                   (0) | Val  Loss: 1.0892 | Val  Acc: 0.8986
Average Valid Accuracy: 0.4966
============ Train epoch 6 ============
cnt=[3, 2, 1, 1, ]
cnt=[3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (2) | Train Loss: 1.6496 | Train Acc: 0.4143
 Site-Clipart                   (0) | Train Loss: 1.3742 | Train Acc: 0.5784
 Site-Clipart                   (1) | Train Loss: 0.9981 | Train Acc: 0.7838
 Site-Art                       (0) | Train Loss: 1.5405 | Train Acc: 0.5000
 Site-Art                       (1) | Train Loss: 1.0690 | Train Acc: 0.7829
 Site-RealWorld                 (0) | Train Loss: 1.3419 | Train Acc: 0.6600
 Site-Product                   (3) | Train Loss: 1.5258 | Train Acc: 0.4757
Average Train Accuracy: 0.5993
 Site-Clipart                   (2) | Val  Loss: 0.5802 | Val  Acc: 0.9574
 Site-Clipart                   (0) | Val  Loss: 0.6573 | Val  Acc: 0.8676
 Site-Clipart                   (1) | Val  Loss: 1.1107 | Val  Acc: 0.7143
 Site-Art                       (0) | Val  Loss: 0.8860 | Val  Acc: 0.8305
 Site-Art                       (1) | Val  Loss: 0.8286 | Val  Acc: 0.8118
 Site-RealWorld                 (0) | Val  Loss: 1.2791 | Val  Acc: 0.6400
 Site-Product                   (3) | Val  Loss: 1.5619 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7758
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.9574
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8676
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.7143
 Best site-Art                      (0)  | Epoch:6 | Val Acc: 0.8305
 Best site-Art                      (1)  | Epoch:6 | Val Acc: 0.8118
 Best site-RealWorld                (0)  | Epoch:6 | Val Acc: 0.6400
 Best site-Product                  (3)  | Epoch:6 | Val Acc: 0.6087
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 2, 1, 1, ]
cnt=[1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (0) | Train Loss: 0.6771 | Train Acc: 0.9429
 Site-Clipart                   (3) | Train Loss: 1.3800 | Train Acc: 0.5588
 Site-Clipart                   (1) | Train Loss: 1.3995 | Train Acc: 0.5541
 Site-Art                       (0) | Train Loss: 0.7707 | Train Acc: 0.8977
 Site-Art                       (1) | Train Loss: 1.2910 | Train Acc: 0.5736
 Site-RealWorld                 (0) | Train Loss: 0.6407 | Train Acc: 0.9667
 Site-Product                   (2) | Train Loss: 0.6284 | Train Acc: 0.9709
Average Train Accuracy: 0.7807
 Site-Clipart                   (0) | Val  Loss: 0.8472 | Val  Acc: 0.8723
 Site-Clipart                   (3) | Val  Loss: 0.9891 | Val  Acc: 0.7794
 Site-Clipart                   (1) | Val  Loss: 1.3952 | Val  Acc: 0.5510
 Site-Art                       (0) | Val  Loss: 1.2943 | Val  Acc: 0.5424
 Site-Art                       (1) | Val  Loss: 1.0891 | Val  Acc: 0.6824
 Site-RealWorld                 (0) | Val  Loss: 1.1483 | Val  Acc: 0.7700
 Site-Product                   (2) | Val  Loss: 1.0715 | Val  Acc: 0.8986
Average Valid Accuracy: 0.7280
============ Train epoch 8 ============
cnt=[2, 3, 1, 1, ]
cnt=[1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (1) | Train Loss: 1.2360 | Train Acc: 0.6571
 Site-Clipart                   (2) | Train Loss: 1.2169 | Train Acc: 0.6275
 Site-Clipart                   (0) | Train Loss: 0.7989 | Train Acc: 0.7973
 Site-Art                       (1) | Train Loss: 1.2521 | Train Acc: 0.6818
 Site-Art                       (0) | Train Loss: 0.7863 | Train Acc: 0.8682
 Site-RealWorld                 (1) | Train Loss: 1.0372 | Train Acc: 0.8333
 Site-Product                   (3) | Train Loss: 1.1453 | Train Acc: 0.8447
Average Train Accuracy: 0.7586
 Site-Clipart                   (1) | Val  Loss: 0.4891 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.6258 | Val  Acc: 0.9412
 Site-Clipart                   (0) | Val  Loss: 0.9375 | Val  Acc: 0.8265
 Site-Art                       (1) | Val  Loss: 0.8305 | Val  Acc: 0.8644
 Site-Art                       (0) | Val  Loss: 0.6886 | Val  Acc: 0.9412
 Site-RealWorld                 (1) | Val  Loss: 1.0851 | Val  Acc: 0.8200
 Site-Product                   (3) | Val  Loss: 1.3463 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8792
 Best site-Clipart                  (1)  | Epoch:8 | Val Acc: 0.9787
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.9412
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8265
 Best site-Art                      (1)  | Epoch:8 | Val Acc: 0.8644
 Best site-Art                      (0)  | Epoch:8 | Val Acc: 0.9412
 Best site-RealWorld                (1)  | Epoch:8 | Val Acc: 0.8200
 Best site-Product                  (3)  | Epoch:8 | Val Acc: 0.7826
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 3, 1, 1, ]
cnt=[2, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (1) | Train Loss: 0.5028 | Train Acc: 0.9714
 Site-Clipart                   (2) | Train Loss: 1.1761 | Train Acc: 0.7059
 Site-Clipart                   (0) | Train Loss: 1.3437 | Train Acc: 0.5405
 Site-Art                       (1) | Train Loss: 0.6433 | Train Acc: 0.9091
 Site-Art                       (0) | Train Loss: 1.2360 | Train Acc: 0.6667
 Site-RealWorld                 (1) | Train Loss: 0.4847 | Train Acc: 0.9667
 Site-Product                   (3) | Train Loss: 0.4666 | Train Acc: 0.9806
Average Train Accuracy: 0.8201
 Site-Clipart                   (1) | Val  Loss: 0.8364 | Val  Acc: 0.8723
 Site-Clipart                   (2) | Val  Loss: 0.8554 | Val  Acc: 0.7794
 Site-Clipart                   (0) | Val  Loss: 1.1358 | Val  Acc: 0.7143
 Site-Art                       (1) | Val  Loss: 1.2916 | Val  Acc: 0.5763
 Site-Art                       (0) | Val  Loss: 1.0548 | Val  Acc: 0.8235
 Site-RealWorld                 (1) | Val  Loss: 0.8987 | Val  Acc: 0.8900
 Site-Product                   (3) | Val  Loss: 0.8667 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8038
============ Train epoch 10 ============
cnt=[2, 3, 1, 1, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (1) | Train Loss: 1.3456 | Train Acc: 0.7429
 Site-Clipart                   (2) | Train Loss: 1.0232 | Train Acc: 0.7157
 Site-Clipart                   (0) | Train Loss: 0.7336 | Train Acc: 0.8378
 Site-Art                       (1) | Train Loss: 1.1749 | Train Acc: 0.7045
 Site-Art                       (0) | Train Loss: 0.7220 | Train Acc: 0.8837
 Site-RealWorld                 (1) | Train Loss: 0.8886 | Train Acc: 0.8867
 Site-Product                   (3) | Train Loss: 1.0768 | Train Acc: 0.8252
Average Train Accuracy: 0.7995
 Site-Clipart                   (1) | Val  Loss: 0.4120 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.5058 | Val  Acc: 0.9118
 Site-Clipart                   (0) | Val  Loss: 0.7419 | Val  Acc: 0.9082
 Site-Art                       (1) | Val  Loss: 0.6968 | Val  Acc: 0.9153
 Site-Art                       (0) | Val  Loss: 0.5797 | Val  Acc: 0.9529
 Site-RealWorld                 (1) | Val  Loss: 0.8449 | Val  Acc: 0.9400
 Site-Product                   (3) | Val  Loss: 1.2052 | Val  Acc: 0.7826
Average Valid Accuracy: 0.9128
 Best site-Clipart                  (1)  | Epoch:10 | Val Acc: 0.9787
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.9118
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.9082
 Best site-Art                      (1)  | Epoch:10 | Val Acc: 0.9153
 Best site-Art                      (0)  | Epoch:10 | Val Acc: 0.9529
 Best site-RealWorld                (1)  | Epoch:10 | Val Acc: 0.9400
 Best site-Product                  (3)  | Epoch:10 | Val Acc: 0.7826
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 1, 2, ]
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (1) | Train Loss: 0.4157 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 1.0928 | Train Acc: 0.6863
 Site-Clipart                   (0) | Train Loss: 1.1505 | Train Acc: 0.6622
 Site-Art                       (1) | Train Loss: 0.6512 | Train Acc: 0.8977
 Site-Art                       (0) | Train Loss: 1.0075 | Train Acc: 0.8140
 Site-RealWorld                 (3) | Train Loss: 0.3609 | Train Acc: 0.9733
 Site-Product                   (3) | Train Loss: 0.3696 | Train Acc: 0.9806
Average Train Accuracy: 0.8591
 Site-Clipart                   (1) | Val  Loss: 0.5910 | Val  Acc: 0.9362
 Site-Clipart                   (2) | Val  Loss: 0.6914 | Val  Acc: 0.8235
 Site-Clipart                   (0) | Val  Loss: 1.0620 | Val  Acc: 0.7245
 Site-Art                       (1) | Val  Loss: 1.0343 | Val  Acc: 0.8305
 Site-Art                       (0) | Val  Loss: 0.8361 | Val  Acc: 0.9059
 Site-RealWorld                 (3) | Val  Loss: 0.7746 | Val  Acc: 0.9500
 Site-Product                   (3) | Val  Loss: 0.7010 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8794
============ Train epoch 12 ============
cnt=[1, 2, 3, 1, ]
cnt=[1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (2) | Train Loss: 1.0583 | Train Acc: 0.8429
 Site-Clipart                   (3) | Train Loss: 0.9727 | Train Acc: 0.7549
 Site-Clipart                   (1) | Train Loss: 0.6070 | Train Acc: 0.8851
 Site-Art                       (2) | Train Loss: 1.0529 | Train Acc: 0.7159
 Site-Art                       (1) | Train Loss: 0.5494 | Train Acc: 0.9147
 Site-RealWorld                 (2) | Train Loss: 0.7113 | Train Acc: 0.9267
 Site-Product                   (0) | Train Loss: 0.8424 | Train Acc: 0.9515
Average Train Accuracy: 0.8560
 Site-Clipart                   (2) | Val  Loss: 0.2821 | Val  Acc: 1.0000
 Site-Clipart                   (3) | Val  Loss: 0.3642 | Val  Acc: 0.9265
 Site-Clipart                   (1) | Val  Loss: 0.7253 | Val  Acc: 0.9082
 Site-Art                       (2) | Val  Loss: 0.5991 | Val  Acc: 0.9322
 Site-Art                       (1) | Val  Loss: 0.4641 | Val  Acc: 0.9647
 Site-RealWorld                 (2) | Val  Loss: 0.7041 | Val  Acc: 0.9600
 Site-Product                   (0) | Val  Loss: 1.0070 | Val  Acc: 0.8406
Average Valid Accuracy: 0.9332
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 1.0000
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.9265
 Best site-Clipart                  (1)  | Epoch:12 | Val Acc: 0.9082
 Best site-Art                      (2)  | Epoch:12 | Val Acc: 0.9322
 Best site-Art                      (1)  | Epoch:12 | Val Acc: 0.9647
 Best site-RealWorld                (2)  | Epoch:12 | Val Acc: 0.9600
 Best site-Product                  (0)  | Epoch:12 | Val Acc: 0.8406
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 2, 1, 2, ]
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (0) | Train Loss: 0.4874 | Train Acc: 1.0000
 Site-Clipart                   (1) | Train Loss: 0.9640 | Train Acc: 0.8039
 Site-Clipart                   (2) | Train Loss: 0.8480 | Train Acc: 0.7635
 Site-Art                       (0) | Train Loss: 0.5142 | Train Acc: 0.9091
 Site-Art                       (1) | Train Loss: 0.6760 | Train Acc: 0.8450
 Site-RealWorld                 (3) | Train Loss: 0.3119 | Train Acc: 0.9800
 Site-Product                   (3) | Train Loss: 0.2946 | Train Acc: 0.9903
Average Train Accuracy: 0.8988
 Site-Clipart                   (0) | Val  Loss: 0.3180 | Val  Acc: 1.0000
 Site-Clipart                   (1) | Val  Loss: 0.5211 | Val  Acc: 0.8824
 Site-Clipart                   (2) | Val  Loss: 0.8871 | Val  Acc: 0.8571
 Site-Art                       (0) | Val  Loss: 0.8992 | Val  Acc: 0.7797
 Site-Art                       (1) | Val  Loss: 0.6265 | Val  Acc: 0.9412
 Site-RealWorld                 (3) | Val  Loss: 0.6593 | Val  Acc: 0.9200
 Site-Product                   (3) | Val  Loss: 0.5551 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9073
============ Train epoch 14 ============
cnt=[4, 1, 1, 1, ]
cnt=[3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.5134 | Train Acc: 0.9286
 Site-Clipart                   (2) | Train Loss: 0.7723 | Train Acc: 0.8235
 Site-Clipart                   (1) | Train Loss: 0.6051 | Train Acc: 0.8716
 Site-Art                       (0) | Train Loss: 0.7396 | Train Acc: 0.8636
 Site-Art                       (3) | Train Loss: 0.7503 | Train Acc: 0.9380
 Site-RealWorld                 (0) | Train Loss: 0.4323 | Train Acc: 0.9867
 Site-Product                   (0) | Train Loss: 0.4965 | Train Acc: 0.9806
Average Train Accuracy: 0.9132
 Site-Clipart                   (0) | Val  Loss: 0.2281 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.2864 | Val  Acc: 0.9118
 Site-Clipart                   (1) | Val  Loss: 0.5627 | Val  Acc: 0.9592
 Site-Art                       (0) | Val  Loss: 0.6130 | Val  Acc: 0.9322
 Site-Art                       (3) | Val  Loss: 0.4634 | Val  Acc: 0.9294
 Site-RealWorld                 (0) | Val  Loss: 0.4976 | Val  Acc: 0.9900
 Site-Product                   (0) | Val  Loss: 0.6312 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9604
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart                  (2)  | Epoch:14 | Val Acc: 0.9118
 Best site-Clipart                  (1)  | Epoch:14 | Val Acc: 0.9592
 Best site-Art                      (0)  | Epoch:14 | Val Acc: 0.9322
 Best site-Art                      (3)  | Epoch:14 | Val Acc: 0.9294
 Best site-RealWorld                (0)  | Epoch:14 | Val Acc: 0.9900
 Best site-Product                  (0)  | Epoch:14 | Val Acc: 1.0000
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 2, 2, 1, ]
cnt=[3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (2) | Train Loss: 0.5724 | Train Acc: 0.9714
 Site-Clipart                   (3) | Train Loss: 0.7512 | Train Acc: 0.8235
 Site-Clipart                   (1) | Train Loss: 0.5271 | Train Acc: 0.8919
 Site-Art                       (2) | Train Loss: 0.6281 | Train Acc: 0.8977
 Site-Art                       (1) | Train Loss: 0.4328 | Train Acc: 0.9147
 Site-RealWorld                 (0) | Train Loss: 0.3495 | Train Acc: 0.9800
 Site-Product                   (0) | Train Loss: 0.4571 | Train Acc: 0.9709
Average Train Accuracy: 0.9215
 Site-Clipart                   (2) | Val  Loss: 0.2141 | Val  Acc: 1.0000
 Site-Clipart                   (3) | Val  Loss: 0.3513 | Val  Acc: 0.9265
 Site-Clipart                   (1) | Val  Loss: 0.5146 | Val  Acc: 0.9592
 Site-Art                       (2) | Val  Loss: 0.5471 | Val  Acc: 0.9153
 Site-Art                       (1) | Val  Loss: 0.4143 | Val  Acc: 0.9529
 Site-RealWorld                 (0) | Val  Loss: 0.4409 | Val  Acc: 0.9800
 Site-Product                   (0) | Val  Loss: 0.4921 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9578
============ Train epoch 16 ============
cnt=[1, 4, 1, 1, ]
cnt=[1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (1) | Train Loss: 0.3113 | Train Acc: 0.9714
 Site-Clipart                   (2) | Train Loss: 0.6338 | Train Acc: 0.8725
 Site-Clipart                   (0) | Train Loss: 0.6032 | Train Acc: 0.8311
 Site-Art                       (1) | Train Loss: 0.4546 | Train Acc: 0.9432
 Site-Art                       (3) | Train Loss: 0.6050 | Train Acc: 0.9302
 Site-RealWorld                 (1) | Train Loss: 0.2212 | Train Acc: 0.9867
 Site-Product                   (1) | Train Loss: 0.3076 | Train Acc: 0.9806
Average Train Accuracy: 0.9308
 Site-Clipart                   (1) | Val  Loss: 0.2292 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.2922 | Val  Acc: 0.9265
 Site-Clipart                   (0) | Val  Loss: 0.5287 | Val  Acc: 0.9490
 Site-Art                       (1) | Val  Loss: 0.6905 | Val  Acc: 0.8983
 Site-Art                       (3) | Val  Loss: 0.3875 | Val  Acc: 0.9765
 Site-RealWorld                 (1) | Val  Loss: 0.3652 | Val  Acc: 0.9900
 Site-Product                   (1) | Val  Loss: 0.3122 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9598
============ Train epoch 17 ============
cnt=[2, 2, 1, 2, ]
cnt=[2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (1) | Train Loss: 0.3793 | Train Acc: 0.9714
 Site-Clipart                   (2) | Train Loss: 0.6753 | Train Acc: 0.8039
 Site-Clipart                   (0) | Train Loss: 0.4374 | Train Acc: 0.8919
 Site-Art                       (1) | Train Loss: 0.4329 | Train Acc: 0.9432
 Site-Art                       (0) | Train Loss: 0.3688 | Train Acc: 0.9302
 Site-RealWorld                 (3) | Train Loss: 0.2488 | Train Acc: 0.9867
 Site-Product                   (3) | Train Loss: 0.2935 | Train Acc: 0.9903
Average Train Accuracy: 0.9311
 Site-Clipart                   (1) | Val  Loss: 0.1929 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.2466 | Val  Acc: 0.9118
 Site-Clipart                   (0) | Val  Loss: 0.4104 | Val  Acc: 0.9388
 Site-Art                       (1) | Val  Loss: 0.4458 | Val  Acc: 0.9661
 Site-Art                       (0) | Val  Loss: 0.3268 | Val  Acc: 0.9529
 Site-RealWorld                 (3) | Val  Loss: 0.3113 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.4200 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9650
 Best site-Clipart                  (1)  | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.9118
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.9388
 Best site-Art                      (1)  | Epoch:17 | Val Acc: 0.9661
 Best site-Art                      (0)  | Epoch:17 | Val Acc: 0.9529
 Best site-RealWorld                (3)  | Epoch:17 | Val Acc: 1.0000
 Best site-Product                  (3)  | Epoch:17 | Val Acc: 0.9855
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (3) | Train Loss: 0.2496 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.4844 | Train Acc: 0.9118
 Site-Clipart                   (1) | Train Loss: 0.5677 | Train Acc: 0.8649
 Site-Art                       (3) | Train Loss: 0.4552 | Train Acc: 0.9318
 Site-Art                       (1) | Train Loss: 0.3586 | Train Acc: 0.9612
 Site-RealWorld                 (0) | Train Loss: 0.1938 | Train Acc: 0.9800
 Site-Product                   (0) | Train Loss: 0.2841 | Train Acc: 0.9806
Average Train Accuracy: 0.9451
 Site-Clipart                   (3) | Val  Loss: 0.1745 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.2696 | Val  Acc: 0.9265
 Site-Clipart                   (1) | Val  Loss: 0.3566 | Val  Acc: 0.9490
 Site-Art                       (3) | Val  Loss: 0.5275 | Val  Acc: 0.9322
 Site-Art                       (1) | Val  Loss: 0.3038 | Val  Acc: 0.9647
 Site-RealWorld                 (0) | Val  Loss: 0.2543 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.2802 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9675
 Best site-Clipart                  (3)  | Epoch:18 | Val Acc: 1.0000
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.9265
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.9490
 Best site-Art                      (3)  | Epoch:18 | Val Acc: 0.9322
 Best site-Art                      (1)  | Epoch:18 | Val Acc: 0.9647
 Best site-RealWorld                (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-Product                  (0)  | Epoch:18 | Val Acc: 1.0000
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 19 ============
cnt=[4, 1, 1, 1, ]
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (0) | Train Loss: 0.3506 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.5732 | Train Acc: 0.8922
 Site-Clipart                   (1) | Train Loss: 0.3631 | Train Acc: 0.9595
 Site-Art                       (0) | Train Loss: 0.4018 | Train Acc: 0.9318
 Site-Art                       (3) | Train Loss: 0.3285 | Train Acc: 0.9147
 Site-RealWorld                 (0) | Train Loss: 0.2101 | Train Acc: 0.9733
 Site-Product                   (0) | Train Loss: 0.2234 | Train Acc: 0.9903
Average Train Accuracy: 0.9496
 Site-Clipart                   (0) | Val  Loss: 0.1797 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.2339 | Val  Acc: 0.9118
 Site-Clipart                   (1) | Val  Loss: 0.4560 | Val  Acc: 0.9490
 Site-Art                       (0) | Val  Loss: 0.3115 | Val  Acc: 0.9831
 Site-Art                       (3) | Val  Loss: 0.3359 | Val  Acc: 0.9412
 Site-RealWorld                 (0) | Val  Loss: 0.3173 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.3437 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9642
============ Train epoch 20 ============
cnt=[1, 2, 1, 3, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (3) | Train Loss: 0.2609 | Train Acc: 0.9714
 Site-Clipart                   (2) | Train Loss: 0.4799 | Train Acc: 0.9020
 Site-Clipart                   (1) | Train Loss: 0.4328 | Train Acc: 0.9189
 Site-Art                       (0) | Train Loss: 0.3010 | Train Acc: 0.9659
 Site-Art                       (1) | Train Loss: 0.3150 | Train Acc: 0.9457
 Site-RealWorld                 (3) | Train Loss: 0.1762 | Train Acc: 0.9800
 Site-Product                   (3) | Train Loss: 0.2013 | Train Acc: 1.0000
Average Train Accuracy: 0.9549
 Site-Clipart                   (3) | Val  Loss: 0.1326 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.2435 | Val  Acc: 0.9265
 Site-Clipart                   (1) | Val  Loss: 0.4084 | Val  Acc: 0.9490
 Site-Art                       (0) | Val  Loss: 0.4401 | Val  Acc: 0.9153
 Site-Art                       (1) | Val  Loss: 0.2937 | Val  Acc: 0.9412
 Site-RealWorld                 (3) | Val  Loss: 0.2570 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.2158 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9617
============ Train epoch 21 ============
cnt=[4, 1, 1, 1, ]
cnt=[1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.1896 | Train Acc: 0.9714
 Site-Clipart                   (2) | Train Loss: 0.4428 | Train Acc: 0.9216
 Site-Clipart                   (3) | Train Loss: 0.3043 | Train Acc: 0.9392
 Site-Art                       (0) | Train Loss: 0.3673 | Train Acc: 0.9659
 Site-Art                       (1) | Train Loss: 0.4314 | Train Acc: 0.9147
 Site-RealWorld                 (0) | Train Loss: 0.1636 | Train Acc: 0.9800
 Site-Product                   (0) | Train Loss: 0.2124 | Train Acc: 0.9806
Average Train Accuracy: 0.9533
 Site-Clipart                   (0) | Val  Loss: 0.1324 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.2436 | Val  Acc: 0.9265
 Site-Clipart                   (3) | Val  Loss: 0.2817 | Val  Acc: 0.9694
 Site-Art                       (0) | Val  Loss: 0.3473 | Val  Acc: 0.9661
 Site-Art                       (1) | Val  Loss: 0.2420 | Val  Acc: 0.9529
 Site-RealWorld                 (0) | Val  Loss: 0.2358 | Val  Acc: 0.9900
 Site-Product                   (0) | Val  Loss: 0.2271 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9691
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.9787
 Best site-Clipart                  (2)  | Epoch:21 | Val Acc: 0.9265
 Best site-Clipart                  (3)  | Epoch:21 | Val Acc: 0.9694
 Best site-Art                      (0)  | Epoch:21 | Val Acc: 0.9661
 Best site-Art                      (1)  | Epoch:21 | Val Acc: 0.9529
 Best site-RealWorld                (0)  | Epoch:21 | Val Acc: 0.9900
 Best site-Product                  (0)  | Epoch:21 | Val Acc: 1.0000
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 22 ============
cnt=[1, 4, 1, 1, ]
cnt=[1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (1) | Train Loss: 0.2293 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.4255 | Train Acc: 0.9118
 Site-Clipart                   (0) | Train Loss: 0.3453 | Train Acc: 0.9392
 Site-Art                       (1) | Train Loss: 0.3386 | Train Acc: 0.9773
 Site-Art                       (3) | Train Loss: 0.2438 | Train Acc: 0.9612
 Site-RealWorld                 (1) | Train Loss: 0.1795 | Train Acc: 0.9867
 Site-Product                   (1) | Train Loss: 0.2001 | Train Acc: 0.9903
Average Train Accuracy: 0.9646
 Site-Clipart                   (1) | Val  Loss: 0.1415 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.1600 | Val  Acc: 0.9412
 Site-Clipart                   (0) | Val  Loss: 0.2528 | Val  Acc: 0.9490
 Site-Art                       (1) | Val  Loss: 0.3043 | Val  Acc: 0.9492
 Site-Art                       (3) | Val  Loss: 0.2620 | Val  Acc: 0.9529
 Site-RealWorld                 (1) | Val  Loss: 0.2023 | Val  Acc: 0.9900
 Site-Product                   (1) | Val  Loss: 0.2224 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9659
============ Train epoch 23 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (1) | Train Loss: 0.1623 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.4090 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.3368 | Train Acc: 0.9189
 Site-Art                       (1) | Train Loss: 0.2611 | Train Acc: 0.9545
 Site-Art                       (0) | Train Loss: 0.2611 | Train Acc: 0.9302
 Site-RealWorld                 (3) | Train Loss: 0.1464 | Train Acc: 0.9800
 Site-Product                   (3) | Train Loss: 0.1796 | Train Acc: 0.9806
Average Train Accuracy: 0.9559
 Site-Clipart                   (1) | Val  Loss: 0.1181 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1801 | Val  Acc: 0.9559
 Site-Clipart                   (0) | Val  Loss: 0.2744 | Val  Acc: 0.9694
 Site-Art                       (1) | Val  Loss: 0.2989 | Val  Acc: 0.9831
 Site-Art                       (0) | Val  Loss: 0.2419 | Val  Acc: 0.9529
 Site-RealWorld                 (3) | Val  Loss: 0.2026 | Val  Acc: 0.9900
 Site-Product                   (3) | Val  Loss: 0.2133 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9767
 Best site-Clipart                  (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.9559
 Best site-Clipart                  (0)  | Epoch:23 | Val Acc: 0.9694
 Best site-Art                      (1)  | Epoch:23 | Val Acc: 0.9831
 Best site-Art                      (0)  | Epoch:23 | Val Acc: 0.9529
 Best site-RealWorld                (3)  | Epoch:23 | Val Acc: 0.9900
 Best site-Product                  (3)  | Epoch:23 | Val Acc: 0.9855
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 4, 1, 1, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (1) | Train Loss: 0.2428 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.4121 | Train Acc: 0.9510
 Site-Clipart                   (3) | Train Loss: 0.2941 | Train Acc: 0.9459
 Site-Art                       (1) | Train Loss: 0.2938 | Train Acc: 0.9773
 Site-Art                       (0) | Train Loss: 0.2172 | Train Acc: 0.9302
 Site-RealWorld                 (1) | Train Loss: 0.1436 | Train Acc: 0.9800
 Site-Product                   (1) | Train Loss: 0.1586 | Train Acc: 0.9903
Average Train Accuracy: 0.9678
 Site-Clipart                   (1) | Val  Loss: 0.0848 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1399 | Val  Acc: 0.9853
 Site-Clipart                   (3) | Val  Loss: 0.2581 | Val  Acc: 0.9796
 Site-Art                       (1) | Val  Loss: 0.2241 | Val  Acc: 1.0000
 Site-Art                       (0) | Val  Loss: 0.2139 | Val  Acc: 0.9647
 Site-RealWorld                 (1) | Val  Loss: 0.2021 | Val  Acc: 0.9900
 Site-Product                   (1) | Val  Loss: 0.1656 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9864
 Best site-Clipart                  (1)  | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart                  (2)  | Epoch:24 | Val Acc: 0.9853
 Best site-Clipart                  (3)  | Epoch:24 | Val Acc: 0.9796
 Best site-Art                      (1)  | Epoch:24 | Val Acc: 1.0000
 Best site-Art                      (0)  | Epoch:24 | Val Acc: 0.9647
 Best site-RealWorld                (1)  | Epoch:24 | Val Acc: 0.9900
 Best site-Product                  (1)  | Epoch:24 | Val Acc: 0.9855
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 1, 2, ]
cnt=[2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (0) | Train Loss: 0.1465 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.3848 | Train Acc: 0.9216
 Site-Clipart                   (1) | Train Loss: 0.2491 | Train Acc: 0.9527
 Site-Art                       (0) | Train Loss: 0.2489 | Train Acc: 0.9659
 Site-Art                       (1) | Train Loss: 0.3535 | Train Acc: 0.9225
 Site-RealWorld                 (3) | Train Loss: 0.1185 | Train Acc: 1.0000
 Site-Product                   (3) | Train Loss: 0.1652 | Train Acc: 0.9903
Average Train Accuracy: 0.9627
 Site-Clipart                   (0) | Val  Loss: 0.1034 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.1632 | Val  Acc: 0.9265
 Site-Clipart                   (1) | Val  Loss: 0.2578 | Val  Acc: 0.9796
 Site-Art                       (0) | Val  Loss: 0.2692 | Val  Acc: 1.0000
 Site-Art                       (1) | Val  Loss: 0.2106 | Val  Acc: 0.9529
 Site-RealWorld                 (3) | Val  Loss: 0.1656 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.1455 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9768
============ Train epoch 26 ============
cnt=[1, 2, 1, 3, ]
cnt=[3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (3) | Train Loss: 0.2457 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.3158 | Train Acc: 0.9314
 Site-Clipart                   (1) | Train Loss: 0.2682 | Train Acc: 0.9392
 Site-Art                       (0) | Train Loss: 0.2647 | Train Acc: 0.9659
 Site-Art                       (1) | Train Loss: 0.2074 | Train Acc: 0.9612
 Site-RealWorld                 (3) | Train Loss: 0.1242 | Train Acc: 0.9733
 Site-Product                   (3) | Train Loss: 0.1567 | Train Acc: 0.9903
Average Train Accuracy: 0.9659
 Site-Clipart                   (3) | Val  Loss: 0.1047 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1507 | Val  Acc: 0.9412
 Site-Clipart                   (1) | Val  Loss: 0.1683 | Val  Acc: 0.9898
 Site-Art                       (0) | Val  Loss: 0.2652 | Val  Acc: 0.9661
 Site-Art                       (1) | Val  Loss: 0.1982 | Val  Acc: 0.9647
 Site-RealWorld                 (3) | Val  Loss: 0.1420 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.1469 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9782
============ Train epoch 27 ============
cnt=[4, 1, 1, 1, ]
cnt=[1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (0) | Train Loss: 0.0839 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.3192 | Train Acc: 0.9314
 Site-Clipart                   (1) | Train Loss: 0.3185 | Train Acc: 0.9122
 Site-Art                       (0) | Train Loss: 0.1995 | Train Acc: 0.9659
 Site-Art                       (3) | Train Loss: 0.2128 | Train Acc: 0.9380
 Site-RealWorld                 (0) | Train Loss: 0.1079 | Train Acc: 0.9733
 Site-Product                   (0) | Train Loss: 0.1180 | Train Acc: 0.9903
Average Train Accuracy: 0.9567
 Site-Clipart                   (0) | Val  Loss: 0.1037 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.1443 | Val  Acc: 0.9559
 Site-Clipart                   (1) | Val  Loss: 0.1995 | Val  Acc: 0.9898
 Site-Art                       (0) | Val  Loss: 0.2204 | Val  Acc: 1.0000
 Site-Art                       (3) | Val  Loss: 0.2002 | Val  Acc: 0.9765
 Site-RealWorld                 (0) | Val  Loss: 0.1566 | Val  Acc: 0.9800
 Site-Product                   (0) | Val  Loss: 0.1693 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9830
============ Train epoch 28 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (3) | Train Loss: 0.1913 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.3258 | Train Acc: 0.9608
 Site-Clipart                   (1) | Train Loss: 0.2188 | Train Acc: 0.9662
 Site-Art                       (3) | Train Loss: 0.2558 | Train Acc: 0.9545
 Site-Art                       (1) | Train Loss: 0.2218 | Train Acc: 0.9147
 Site-RealWorld                 (0) | Train Loss: 0.1120 | Train Acc: 0.9867
 Site-Product                   (0) | Train Loss: 0.1356 | Train Acc: 0.9806
Average Train Accuracy: 0.9662
 Site-Clipart                   (3) | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1221 | Val  Acc: 0.9559
 Site-Clipart                   (1) | Val  Loss: 0.2120 | Val  Acc: 0.9898
 Site-Art                       (3) | Val  Loss: 0.1975 | Val  Acc: 0.9661
 Site-Art                       (1) | Val  Loss: 0.1750 | Val  Acc: 0.9647
 Site-RealWorld                 (0) | Val  Loss: 0.1757 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.2034 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9824
============ Train epoch 29 ============
cnt=[1, 4, 1, 1, ]
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (1) | Train Loss: 0.1368 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.2598 | Train Acc: 0.9510
 Site-Clipart                   (3) | Train Loss: 0.2620 | Train Acc: 0.9459
 Site-Art                       (1) | Train Loss: 0.2163 | Train Acc: 0.9545
 Site-Art                       (0) | Train Loss: 0.2198 | Train Acc: 0.9535
 Site-RealWorld                 (1) | Train Loss: 0.1069 | Train Acc: 0.9800
 Site-Product                   (1) | Train Loss: 0.1132 | Train Acc: 0.9903
Average Train Accuracy: 0.9659
 Site-Clipart                   (1) | Val  Loss: 0.0819 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.1137 | Val  Acc: 0.9559
 Site-Clipart                   (3) | Val  Loss: 0.2120 | Val  Acc: 0.9898
 Site-Art                       (1) | Val  Loss: 0.2560 | Val  Acc: 0.9661
 Site-Art                       (0) | Val  Loss: 0.1691 | Val  Acc: 0.9765
 Site-RealWorld                 (1) | Val  Loss: 0.1511 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.1266 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9810
============ Train epoch 30 ============
cnt=[2, 2, 1, 2, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (0) | Train Loss: 0.1137 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.2657 | Train Acc: 0.9706
 Site-Clipart                   (1) | Train Loss: 0.2093 | Train Acc: 0.9459
 Site-Art                       (0) | Train Loss: 0.2052 | Train Acc: 0.9886
 Site-Art                       (1) | Train Loss: 0.2105 | Train Acc: 0.9302
 Site-RealWorld                 (3) | Train Loss: 0.1087 | Train Acc: 0.9800
 Site-Product                   (3) | Train Loss: 0.1143 | Train Acc: 0.9903
Average Train Accuracy: 0.9722
 Site-Clipart                   (0) | Val  Loss: 0.0779 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1165 | Val  Acc: 0.9706
 Site-Clipart                   (1) | Val  Loss: 0.1833 | Val  Acc: 1.0000
 Site-Art                       (0) | Val  Loss: 0.2103 | Val  Acc: 0.9661
 Site-Art                       (1) | Val  Loss: 0.1663 | Val  Acc: 0.9765
 Site-RealWorld                 (3) | Val  Loss: 0.1420 | Val  Acc: 0.9900
 Site-Product                   (3) | Val  Loss: 0.1198 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9862
============ Train epoch 31 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (0) | Train Loss: 0.0883 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.2384 | Train Acc: 0.9608
 Site-Clipart                   (1) | Train Loss: 0.2265 | Train Acc: 0.9189
 Site-Art                       (0) | Train Loss: 0.1993 | Train Acc: 0.9773
 Site-Art                       (1) | Train Loss: 0.1750 | Train Acc: 0.9302
 Site-RealWorld                 (3) | Train Loss: 0.1017 | Train Acc: 0.9800
 Site-Product                   (3) | Train Loss: 0.1267 | Train Acc: 0.9903
Average Train Accuracy: 0.9654
 Site-Clipart                   (0) | Val  Loss: 0.0593 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1106 | Val  Acc: 0.9706
 Site-Clipart                   (1) | Val  Loss: 0.1798 | Val  Acc: 0.9796
 Site-Art                       (0) | Val  Loss: 0.1867 | Val  Acc: 0.9661
 Site-Art                       (1) | Val  Loss: 0.1501 | Val  Acc: 0.9647
 Site-RealWorld                 (3) | Val  Loss: 0.1332 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.1234 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9809
============ Train epoch 32 ============
cnt=[4, 1, 1, 1, ]
cnt=[1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (0) | Train Loss: 0.0982 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.3079 | Train Acc: 0.9706
 Site-Clipart                   (1) | Train Loss: 0.1735 | Train Acc: 0.9662
 Site-Art                       (0) | Train Loss: 0.2689 | Train Acc: 0.9773
 Site-Art                       (3) | Train Loss: 0.1860 | Train Acc: 0.9302
 Site-RealWorld                 (0) | Train Loss: 0.0873 | Train Acc: 0.9867
 Site-Product                   (0) | Train Loss: 0.0917 | Train Acc: 1.0000
Average Train Accuracy: 0.9738
 Site-Clipart                   (0) | Val  Loss: 0.0953 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.1287 | Val  Acc: 0.9559
 Site-Clipart                   (1) | Val  Loss: 0.2183 | Val  Acc: 0.9592
 Site-Art                       (0) | Val  Loss: 0.1444 | Val  Acc: 0.9831
 Site-Art                       (3) | Val  Loss: 0.1477 | Val  Acc: 0.9647
 Site-RealWorld                 (0) | Val  Loss: 0.1288 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.1680 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9753
============ Train epoch 33 ============
cnt=[1, 4, 1, 1, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (1) | Train Loss: 0.0761 | Train Acc: 1.0000
 Site-Clipart                   (0) | Train Loss: 0.1987 | Train Acc: 0.9804
 Site-Clipart                   (2) | Train Loss: 0.2458 | Train Acc: 0.9459
 Site-Art                       (1) | Train Loss: 0.1777 | Train Acc: 0.9773
 Site-Art                       (3) | Train Loss: 0.1573 | Train Acc: 0.9690
 Site-RealWorld                 (1) | Train Loss: 0.0893 | Train Acc: 0.9933
 Site-Product                   (1) | Train Loss: 0.1229 | Train Acc: 0.9806
Average Train Accuracy: 0.9781
 Site-Clipart                   (1) | Val  Loss: 0.0673 | Val  Acc: 1.0000
 Site-Clipart                   (0) | Val  Loss: 0.1244 | Val  Acc: 0.9412
 Site-Clipart                   (2) | Val  Loss: 0.1652 | Val  Acc: 0.9898
 Site-Art                       (1) | Val  Loss: 0.2328 | Val  Acc: 0.9831
 Site-Art                       (3) | Val  Loss: 0.1735 | Val  Acc: 0.9765
 Site-RealWorld                 (1) | Val  Loss: 0.0927 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.0872 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9844
============ Train epoch 34 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (0) | Train Loss: 0.0782 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.2472 | Train Acc: 0.9608
 Site-Clipart                   (1) | Train Loss: 0.1813 | Train Acc: 0.9595
 Site-Art                       (0) | Train Loss: 0.2202 | Train Acc: 0.9545
 Site-Art                       (1) | Train Loss: 0.1583 | Train Acc: 0.9535
 Site-RealWorld                 (3) | Train Loss: 0.1149 | Train Acc: 0.9867
 Site-Product                   (3) | Train Loss: 0.1109 | Train Acc: 0.9903
Average Train Accuracy: 0.9722
 Site-Clipart                   (0) | Val  Loss: 0.0629 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1192 | Val  Acc: 0.9265
 Site-Clipart                   (1) | Val  Loss: 0.1679 | Val  Acc: 0.9796
 Site-Art                       (0) | Val  Loss: 0.1174 | Val  Acc: 1.0000
 Site-Art                       (1) | Val  Loss: 0.1449 | Val  Acc: 0.9647
 Site-RealWorld                 (3) | Val  Loss: 0.1172 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.1918 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9795
============ Train epoch 35 ============
cnt=[4, 1, 1, 1, ]
cnt=[4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (0) | Train Loss: 0.0723 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.2439 | Train Acc: 0.9510
 Site-Clipart                   (3) | Train Loss: 0.1590 | Train Acc: 0.9730
 Site-Art                       (0) | Train Loss: 0.1848 | Train Acc: 0.9773
 Site-Art                       (1) | Train Loss: 0.1580 | Train Acc: 0.9535
 Site-RealWorld                 (0) | Train Loss: 0.0946 | Train Acc: 0.9867
 Site-Product                   (0) | Train Loss: 0.0742 | Train Acc: 0.9903
Average Train Accuracy: 0.9739
 Site-Clipart                   (0) | Val  Loss: 0.0462 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-Clipart                   (3) | Val  Loss: 0.1469 | Val  Acc: 1.0000
 Site-Art                       (0) | Val  Loss: 0.1514 | Val  Acc: 0.9661
 Site-Art                       (1) | Val  Loss: 0.1375 | Val  Acc: 0.9529
 Site-RealWorld                 (0) | Val  Loss: 0.1030 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.1083 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9864
============ Train epoch 36 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (3) | Train Loss: 0.1240 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.1909 | Train Acc: 0.9706
 Site-Clipart                   (1) | Train Loss: 0.1998 | Train Acc: 0.9730
 Site-Art                       (3) | Train Loss: 0.1506 | Train Acc: 0.9773
 Site-Art                       (1) | Train Loss: 0.1591 | Train Acc: 0.9612
 Site-RealWorld                 (0) | Train Loss: 0.0812 | Train Acc: 0.9867
 Site-Product                   (0) | Train Loss: 0.0880 | Train Acc: 1.0000
Average Train Accuracy: 0.9812
 Site-Clipart                   (3) | Val  Loss: 0.0427 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1089 | Val  Acc: 0.9412
 Site-Clipart                   (1) | Val  Loss: 0.1420 | Val  Acc: 0.9898
 Site-Art                       (3) | Val  Loss: 0.1841 | Val  Acc: 0.9831
 Site-Art                       (1) | Val  Loss: 0.1251 | Val  Acc: 0.9765
 Site-RealWorld                 (0) | Val  Loss: 0.0944 | Val  Acc: 0.9900
 Site-Product                   (0) | Val  Loss: 0.1287 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9809
============ Train epoch 37 ============
cnt=[2, 2, 1, 2, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (0) | Train Loss: 0.1060 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.2222 | Train Acc: 0.9804
 Site-Clipart                   (1) | Train Loss: 0.1631 | Train Acc: 0.9730
 Site-Art                       (0) | Train Loss: 0.1957 | Train Acc: 0.9545
 Site-Art                       (1) | Train Loss: 0.2118 | Train Acc: 0.9612
 Site-RealWorld                 (3) | Train Loss: 0.0701 | Train Acc: 1.0000
 Site-Product                   (3) | Train Loss: 0.1014 | Train Acc: 0.9903
Average Train Accuracy: 0.9779
 Site-Clipart                   (0) | Val  Loss: 0.0544 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.1107 | Val  Acc: 0.9559
 Site-Clipart                   (1) | Val  Loss: 0.1873 | Val  Acc: 0.9694
 Site-Art                       (0) | Val  Loss: 0.1091 | Val  Acc: 1.0000
 Site-Art                       (1) | Val  Loss: 0.1304 | Val  Acc: 0.9765
 Site-RealWorld                 (3) | Val  Loss: 0.1026 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.1114 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9788
============ Train epoch 38 ============
cnt=[2, 2, 1, 2, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (1) | Train Loss: 0.0698 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.1768 | Train Acc: 0.9902
 Site-Clipart                   (0) | Train Loss: 0.1387 | Train Acc: 0.9865
 Site-Art                       (1) | Train Loss: 0.1937 | Train Acc: 0.9659
 Site-Art                       (0) | Train Loss: 0.1342 | Train Acc: 0.9690
 Site-RealWorld                 (3) | Train Loss: 0.0766 | Train Acc: 0.9933
 Site-Product                   (3) | Train Loss: 0.0718 | Train Acc: 1.0000
Average Train Accuracy: 0.9844
 Site-Clipart                   (1) | Val  Loss: 0.0558 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.0955 | Val  Acc: 0.9412
 Site-Clipart                   (0) | Val  Loss: 0.1541 | Val  Acc: 0.9796
 Site-Art                       (1) | Val  Loss: 0.1210 | Val  Acc: 0.9831
 Site-Art                       (0) | Val  Loss: 0.1243 | Val  Acc: 0.9529
 Site-RealWorld                 (3) | Val  Loss: 0.0937 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.1392 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9744
============ Train epoch 39 ============
cnt=[2, 2, 1, 2, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (3) | Train Loss: 0.0904 | Train Acc: 0.9714
 Site-Clipart                   (2) | Train Loss: 0.1881 | Train Acc: 0.9804
 Site-Clipart                   (0) | Train Loss: 0.1430 | Train Acc: 0.9797
 Site-Art                       (3) | Train Loss: 0.1420 | Train Acc: 1.0000
 Site-Art                       (0) | Train Loss: 0.1367 | Train Acc: 0.9690
 Site-RealWorld                 (1) | Train Loss: 0.0689 | Train Acc: 0.9933
 Site-Product                   (1) | Train Loss: 0.0826 | Train Acc: 0.9903
Average Train Accuracy: 0.9835
 Site-Clipart                   (3) | Val  Loss: 0.0647 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.1082 | Val  Acc: 0.9559
 Site-Clipart                   (0) | Val  Loss: 0.1204 | Val  Acc: 1.0000
 Site-Art                       (3) | Val  Loss: 0.1363 | Val  Acc: 0.9831
 Site-Art                       (0) | Val  Loss: 0.1058 | Val  Acc: 0.9765
 Site-RealWorld                 (1) | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.1190 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9828
============ Train epoch 40 ============
cnt=[4, 1, 1, 1, ]
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (0) | Train Loss: 0.0554 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.1717 | Train Acc: 0.9804
 Site-Clipart                   (3) | Train Loss: 0.1845 | Train Acc: 0.9730
 Site-Art                       (0) | Train Loss: 0.1493 | Train Acc: 0.9886
 Site-Art                       (1) | Train Loss: 0.1347 | Train Acc: 0.9380
 Site-RealWorld                 (0) | Train Loss: 0.0654 | Train Acc: 0.9933
 Site-Product                   (0) | Train Loss: 0.0764 | Train Acc: 0.9903
Average Train Accuracy: 0.9805
 Site-Clipart                   (0) | Val  Loss: 0.0732 | Val  Acc: 0.9787
 Site-Clipart                   (2) | Val  Loss: 0.0805 | Val  Acc: 1.0000
 Site-Clipart                   (3) | Val  Loss: 0.1224 | Val  Acc: 0.9898
 Site-Art                       (0) | Val  Loss: 0.1372 | Val  Acc: 1.0000
 Site-Art                       (1) | Val  Loss: 0.1154 | Val  Acc: 0.9765
 Site-RealWorld                 (0) | Val  Loss: 0.0804 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.1094 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9901
 Best site-Clipart                  (0)  | Epoch:40 | Val Acc: 0.9787
 Best site-Clipart                  (2)  | Epoch:40 | Val Acc: 1.0000
 Best site-Clipart                  (3)  | Epoch:40 | Val Acc: 0.9898
 Best site-Art                      (0)  | Epoch:40 | Val Acc: 1.0000
 Best site-Art                      (1)  | Epoch:40 | Val Acc: 0.9765
 Best site-RealWorld                (0)  | Epoch:40 | Val Acc: 1.0000
 Best site-Product                  (0)  | Epoch:40 | Val Acc: 0.9855
 Test site-Clipart                   (0)| Epoch:40 | Test Acc: 0.5574
 Test site-Art                       (0)| Epoch:40 | Test Acc: 0.6584
 Test site-RealWorld                 (0)| Epoch:40 | Test Acc: 0.6071
 Test site-Product                   (0)| Epoch:40 | Test Acc: 0.5473
Clipart: 0.5574, Art: 0.6584, RealWorld: 0.6071, Product: 0.5473, 
Average Test Accuracy(group): 0.5926, Average Test Accuracy(individual): 0.5919,
domain std=0.0442, cluster std=0.0412, individual std=0.0457, 
Average Test Accuracy: 0.5926
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[4, 1, 1, 1, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.1208 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.2623 | Train Acc: 0.9314
 Site-Clipart                   (1) | Train Loss: 0.1227 | Train Acc: 0.9730
 Site-Art                       (0) | Train Loss: 0.1743 | Train Acc: 0.9773
 Site-Art                       (3) | Train Loss: 0.1401 | Train Acc: 0.9225
 Site-RealWorld                 (0) | Train Loss: 0.0725 | Train Acc: 0.9867
 Site-Product                   (0) | Train Loss: 0.0964 | Train Acc: 0.9806
Average Train Accuracy: 0.9653
 Site-Clipart                   (0) | Val  Loss: 0.0549 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1109 | Val  Acc: 0.9412
 Site-Clipart                   (1) | Val  Loss: 0.1574 | Val  Acc: 0.9796
 Site-Art                       (0) | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-Art                       (3) | Val  Loss: 0.1479 | Val  Acc: 0.9647
 Site-RealWorld                 (0) | Val  Loss: 0.1140 | Val  Acc: 0.9800
 Site-Product                   (0) | Val  Loss: 0.1427 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9787
 Test site-Clipart                   (0)| Epoch:40 | Test Acc: 0.5574
 Test site-Art                       (0)| Epoch:40 | Test Acc: 0.6398
 Test site-RealWorld                 (0)| Epoch:40 | Test Acc: 0.6071
 Test site-Product                   (0)| Epoch:40 | Test Acc: 0.5622
Clipart: 0.5574, Art: 0.6398, RealWorld: 0.6071, Product: 0.5622, 
Average Test Accuracy(group): 0.5916, Average Test Accuracy(individual): 0.5887,
domain std=0.0339, cluster std=0.0337, individual std=0.0362, 
Average Test Accuracy: 0.5916
============ Train epoch 42 ============
cnt=[1, 4, 1, 1, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (1) | Train Loss: 0.0573 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.1759 | Train Acc: 0.9608
 Site-Clipart                   (0) | Train Loss: 0.1549 | Train Acc: 0.9730
 Site-Art                       (1) | Train Loss: 0.1283 | Train Acc: 0.9886
 Site-Art                       (3) | Train Loss: 0.1280 | Train Acc: 0.9690
 Site-RealWorld                 (1) | Train Loss: 0.0786 | Train Acc: 0.9800
 Site-Product                   (1) | Train Loss: 0.0816 | Train Acc: 0.9806
Average Train Accuracy: 0.9768
 Site-Clipart                   (1) | Val  Loss: 0.0515 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.0920 | Val  Acc: 0.9412
 Site-Clipart                   (0) | Val  Loss: 0.1150 | Val  Acc: 0.9898
 Site-Art                       (1) | Val  Loss: 0.1531 | Val  Acc: 0.9661
 Site-Art                       (3) | Val  Loss: 0.1246 | Val  Acc: 0.9647
 Site-RealWorld                 (1) | Val  Loss: 0.0775 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.1299 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9782
 Test site-Clipart                   (1)| Epoch:40 | Test Acc: 0.5532
 Test site-Art                       (1)| Epoch:40 | Test Acc: 0.6584
 Test site-RealWorld                 (1)| Epoch:40 | Test Acc: 0.6111
 Test site-Product                   (1)| Epoch:40 | Test Acc: 0.5522
Clipart: 0.5532, Art: 0.6584, RealWorld: 0.6111, Product: 0.5522, 
Average Test Accuracy(group): 0.5937, Average Test Accuracy(individual): 0.5914,
domain std=0.0443, cluster std=0.0430, individual std=0.0467, 
Average Test Accuracy: 0.5937
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 2, 2, 2, ]
cnt=[4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (1) | Train Loss: 0.0575 | Train Acc: 0.9857
 Site-Clipart                   (0) | Train Loss: 0.1547 | Train Acc: 0.9804
 Site-Clipart                   (2) | Train Loss: 0.1557 | Train Acc: 0.9595
 Site-Art                       (1) | Train Loss: 0.1336 | Train Acc: 0.9773
 Site-Art                       (2) | Train Loss: 0.3567 | Train Acc: 0.9380
 Site-RealWorld                 (3) | Train Loss: 0.0672 | Train Acc: 0.9933
 Site-Product                   (3) | Train Loss: 0.0700 | Train Acc: 0.9903
Average Train Accuracy: 0.9749
 Site-Clipart                   (1) | Val  Loss: 0.0584 | Val  Acc: 1.0000
 Site-Clipart                   (0) | Val  Loss: 0.0869 | Val  Acc: 0.9559
 Site-Clipart                   (2) | Val  Loss: 0.1260 | Val  Acc: 1.0000
 Site-Art                       (1) | Val  Loss: 0.1387 | Val  Acc: 0.9831
 Site-Art                       (2) | Val  Loss: 0.1044 | Val  Acc: 0.9765
 Site-RealWorld                 (3) | Val  Loss: 0.0705 | Val  Acc: 0.9900
 Site-Product                   (3) | Val  Loss: 0.0682 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9865
 Test site-Clipart                   (1)| Epoch:42 | Test Acc: 0.5532
 Test site-Art                       (1)| Epoch:42 | Test Acc: 0.6584
 Test site-RealWorld                 (3)| Epoch:42 | Test Acc: 0.6111
 Test site-Product                   (3)| Epoch:42 | Test Acc: 0.5522
Clipart: 0.5532, Art: 0.6584, RealWorld: 0.6111, Product: 0.5522, 
Average Test Accuracy(group): 0.5937, Average Test Accuracy(individual): 0.5914,
domain std=0.0443, cluster std=0.0217, individual std=0.0467, 
Average Test Accuracy: 0.5937
============ Train epoch 44 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (0) | Train Loss: 0.2329 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.1923 | Train Acc: 0.9706
 Site-Clipart                   (1) | Train Loss: 0.1237 | Train Acc: 0.9932
 Site-Art                       (0) | Train Loss: 0.2078 | Train Acc: 0.9545
 Site-Art                       (1) | Train Loss: 0.1221 | Train Acc: 0.9457
 Site-RealWorld                 (3) | Train Loss: 0.0654 | Train Acc: 0.9933
 Site-Product                   (3) | Train Loss: 0.0679 | Train Acc: 0.9903
Average Train Accuracy: 0.9782
 Site-Clipart                   (0) | Val  Loss: 0.0489 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.0647 | Val  Acc: 1.0000
 Site-Clipart                   (1) | Val  Loss: 0.1238 | Val  Acc: 0.9694
 Site-Art                       (0) | Val  Loss: 0.1315 | Val  Acc: 0.9661
 Site-Art                       (1) | Val  Loss: 0.1056 | Val  Acc: 0.9765
 Site-RealWorld                 (3) | Val  Loss: 0.0848 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.1281 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9854
 Test site-Clipart                   (0)| Epoch:42 | Test Acc: 0.5532
 Test site-Art                       (0)| Epoch:42 | Test Acc: 0.6460
 Test site-RealWorld                 (3)| Epoch:42 | Test Acc: 0.6071
 Test site-Product                   (3)| Epoch:42 | Test Acc: 0.5572
Clipart: 0.5532, Art: 0.6460, RealWorld: 0.6071, Product: 0.5572, 
Average Test Accuracy(group): 0.5909, Average Test Accuracy(individual): 0.5880,
domain std=0.0383, cluster std=0.0190, individual std=0.0408, 
Average Test Accuracy: 0.5909
============ Train epoch 45 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (0) | Train Loss: 0.0500 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.1643 | Train Acc: 0.9902
 Site-Clipart                   (1) | Train Loss: 0.1533 | Train Acc: 0.9662
 Site-Art                       (0) | Train Loss: 0.1019 | Train Acc: 0.9886
 Site-Art                       (1) | Train Loss: 0.1454 | Train Acc: 0.9767
 Site-RealWorld                 (3) | Train Loss: 0.0528 | Train Acc: 0.9933
 Site-Product                   (3) | Train Loss: 0.0454 | Train Acc: 1.0000
Average Train Accuracy: 0.9879
 Site-Clipart                   (0) | Val  Loss: 0.0371 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1049 | Val  Acc: 0.9706
 Site-Clipart                   (1) | Val  Loss: 0.1274 | Val  Acc: 0.9898
 Site-Art                       (0) | Val  Loss: 0.1243 | Val  Acc: 0.9831
 Site-Art                       (1) | Val  Loss: 0.1052 | Val  Acc: 0.9882
 Site-RealWorld                 (3) | Val  Loss: 0.0874 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.0940 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9882
 Test site-Clipart                   (0)| Epoch:42 | Test Acc: 0.5574
 Test site-Art                       (0)| Epoch:42 | Test Acc: 0.6584
 Test site-RealWorld                 (3)| Epoch:42 | Test Acc: 0.6111
 Test site-Product                   (3)| Epoch:42 | Test Acc: 0.5572
Clipart: 0.5574, Art: 0.6584, RealWorld: 0.6111, Product: 0.5572, 
Average Test Accuracy(group): 0.5960, Average Test Accuracy(individual): 0.5939,
domain std=0.0422, cluster std=0.0208, individual std=0.0446, 
Average Test Accuracy: 0.5960
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 4, 1, 1, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (1) | Train Loss: 0.0558 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.1760 | Train Acc: 0.9804
 Site-Clipart                   (3) | Train Loss: 0.1228 | Train Acc: 1.0000
 Site-Art                       (1) | Train Loss: 0.1442 | Train Acc: 0.9773
 Site-Art                       (0) | Train Loss: 0.1194 | Train Acc: 0.9767
 Site-RealWorld                 (1) | Train Loss: 0.0578 | Train Acc: 0.9933
 Site-Product                   (1) | Train Loss: 0.0451 | Train Acc: 1.0000
Average Train Accuracy: 0.9897
 Site-Clipart                   (1) | Val  Loss: 0.0349 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.0856 | Val  Acc: 0.9706
 Site-Clipart                   (3) | Val  Loss: 0.1057 | Val  Acc: 0.9796
 Site-Art                       (1) | Val  Loss: 0.1189 | Val  Acc: 0.9831
 Site-Art                       (0) | Val  Loss: 0.1044 | Val  Acc: 0.9882
 Site-RealWorld                 (1) | Val  Loss: 0.0756 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.1082 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9846
 Test site-Clipart                   (1)| Epoch:45 | Test Acc: 0.5617
 Test site-Art                       (1)| Epoch:45 | Test Acc: 0.6584
 Test site-RealWorld                 (1)| Epoch:45 | Test Acc: 0.6071
 Test site-Product                   (1)| Epoch:45 | Test Acc: 0.5522
Clipart: 0.5617, Art: 0.6584, RealWorld: 0.6071, Product: 0.5522, 
Average Test Accuracy(group): 0.5949, Average Test Accuracy(individual): 0.5945,
domain std=0.0421, cluster std=0.0395, individual std=0.0436, 
Average Test Accuracy: 0.5949
============ Train epoch 47 ============
cnt=[2, 2, 1, 2, ]
cnt=[1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (0) | Train Loss: 0.0579 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.1662 | Train Acc: 0.9608
 Site-Clipart                   (1) | Train Loss: 0.1669 | Train Acc: 0.9595
 Site-Art                       (0) | Train Loss: 0.1235 | Train Acc: 0.9886
 Site-Art                       (1) | Train Loss: 0.1074 | Train Acc: 0.9922
 Site-RealWorld                 (3) | Train Loss: 0.0613 | Train Acc: 0.9867
 Site-Product                   (3) | Train Loss: 0.0694 | Train Acc: 0.9903
Average Train Accuracy: 0.9805
 Site-Clipart                   (0) | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.0927 | Val  Acc: 0.9412
 Site-Clipart                   (1) | Val  Loss: 0.0908 | Val  Acc: 0.9898
 Site-Art                       (0) | Val  Loss: 0.1087 | Val  Acc: 0.9831
 Site-Art                       (1) | Val  Loss: 0.1054 | Val  Acc: 0.9765
 Site-RealWorld                 (3) | Val  Loss: 0.0621 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.0832 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9844
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.5574
 Test site-Art                       (0)| Epoch:45 | Test Acc: 0.6584
 Test site-RealWorld                 (3)| Epoch:45 | Test Acc: 0.6071
 Test site-Product                   (3)| Epoch:45 | Test Acc: 0.5423
Clipart: 0.5574, Art: 0.6584, RealWorld: 0.6071, Product: 0.5423, 
Average Test Accuracy(group): 0.5913, Average Test Accuracy(individual): 0.5912,
domain std=0.0456, cluster std=0.0218, individual std=0.0464, 
Average Test Accuracy: 0.5913
============ Train epoch 48 ============
cnt=[4, 1, 1, 1, ]
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.0844 | Train Acc: 0.9857
 Site-Clipart                   (2) | Train Loss: 0.1275 | Train Acc: 0.9804
 Site-Clipart                   (1) | Train Loss: 0.1411 | Train Acc: 0.9797
 Site-Art                       (0) | Train Loss: 0.1514 | Train Acc: 0.9773
 Site-Art                       (3) | Train Loss: 0.1141 | Train Acc: 0.9457
 Site-RealWorld                 (0) | Train Loss: 0.0614 | Train Acc: 0.9867
 Site-Product                   (0) | Train Loss: 0.0695 | Train Acc: 0.9903
Average Train Accuracy: 0.9780
 Site-Clipart                   (0) | Val  Loss: 0.0394 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.1002 | Val  Acc: 0.9559
 Site-Clipart                   (1) | Val  Loss: 0.1236 | Val  Acc: 0.9694
 Site-Art                       (0) | Val  Loss: 0.0888 | Val  Acc: 1.0000
 Site-Art                       (3) | Val  Loss: 0.0997 | Val  Acc: 0.9647
 Site-RealWorld                 (0) | Val  Loss: 0.0759 | Val  Acc: 0.9900
 Site-Product                   (0) | Val  Loss: 0.1457 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9787
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.5617
 Test site-Art                       (0)| Epoch:45 | Test Acc: 0.6522
 Test site-RealWorld                 (0)| Epoch:45 | Test Acc: 0.6071
 Test site-Product                   (0)| Epoch:45 | Test Acc: 0.5572
Clipart: 0.5617, Art: 0.6522, RealWorld: 0.6071, Product: 0.5572, 
Average Test Accuracy(group): 0.5946, Average Test Accuracy(individual): 0.5934,
domain std=0.0386, cluster std=0.0370, individual std=0.0404, 
Average Test Accuracy: 0.5946
============ Train epoch 49 ============
cnt=[1, 4, 1, 1, ]
cnt=[1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (1) | Train Loss: 0.1120 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.1712 | Train Acc: 0.9706
 Site-Clipart                   (3) | Train Loss: 0.1086 | Train Acc: 0.9797
 Site-Art                       (1) | Train Loss: 0.1388 | Train Acc: 0.9545
 Site-Art                       (0) | Train Loss: 0.6271 | Train Acc: 0.9380
 Site-RealWorld                 (1) | Train Loss: 0.0512 | Train Acc: 0.9933
 Site-Product                   (1) | Train Loss: 0.0384 | Train Acc: 1.0000
Average Train Accuracy: 0.9766
 Site-Clipart                   (1) | Val  Loss: 0.0472 | Val  Acc: 1.0000
 Site-Clipart                   (2) | Val  Loss: 0.0598 | Val  Acc: 1.0000
 Site-Clipart                   (3) | Val  Loss: 0.1228 | Val  Acc: 0.9898
 Site-Art                       (1) | Val  Loss: 0.0942 | Val  Acc: 0.9831
 Site-Art                       (0) | Val  Loss: 0.1005 | Val  Acc: 0.9647
 Site-RealWorld                 (1) | Val  Loss: 0.0821 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.1185 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9869
 Test site-Clipart                   (1)| Epoch:45 | Test Acc: 0.5574
 Test site-Art                       (1)| Epoch:45 | Test Acc: 0.6522
 Test site-RealWorld                 (1)| Epoch:45 | Test Acc: 0.6071
 Test site-Product                   (1)| Epoch:45 | Test Acc: 0.5572
Clipart: 0.5574, Art: 0.6522, RealWorld: 0.6071, Product: 0.5572, 
Average Test Accuracy(group): 0.5935, Average Test Accuracy(individual): 0.5916,
domain std=0.0395, cluster std=0.0387, individual std=0.0419, 
Average Test Accuracy: 0.5935
===2023-08-01 22:22:12===
===2023-08-01 22:22:27===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.5574
 Test site-Art                       (0)| Epoch:45 | Test Acc: 0.6584
 Test site-RealWorld                 (3)| Epoch:45 | Test Acc: 0.6111
 Test site-Product                   (3)| Epoch:45 | Test Acc: 0.5572
Clipart: 0.5574, Art: 0.6584, RealWorld: 0.6111, Product: 0.5572, 
Average Test Accuracy(group): 0.5960, Average Test Accuracy(individual): 0.5939,
domain std=0.0422, cluster std=0.0208, individual std=0.0446, 
===2023-08-02 17:11:40===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 20
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[80,138,240,35,105,97,66,
client_nums=[3,2,1,1,]
len_dataset=[766,236,162,111,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-amazon                    (2) | Train Loss: 2.0498 | Train Acc: 0.3750
 Site-amazon                    (2) | Train Loss: 2.0492 | Train Acc: 0.3986
 Site-amazon                    (2) | Train Loss: 2.0440 | Train Acc: 0.3792
 Site-webcam                    (3) | Train Loss: 2.0745 | Train Acc: 0.3143
 Site-webcam                    (3) | Train Loss: 2.0485 | Train Acc: 0.3810
 Site-caltech                   (0) | Train Loss: 2.0461 | Train Acc: 0.3402
 Site-dslr                      (1) | Train Loss: 2.0909 | Train Acc: 0.3182
Average Train Accuracy: 0.3580
 Site-amazon                    (2) | Val  Loss: 2.0208 | Val  Acc: 0.4717
 Site-amazon                    (2) | Val  Loss: 2.0521 | Val  Acc: 0.4457
 Site-amazon                    (2) | Val  Loss: 2.0227 | Val  Acc: 0.4437
 Site-webcam                    (3) | Val  Loss: 2.0446 | Val  Acc: 0.2609
 Site-webcam                    (3) | Val  Loss: 2.0385 | Val  Acc: 0.4571
 Site-caltech                   (0) | Val  Loss: 2.0937 | Val  Acc: 0.3594
 Site-dslr                      (1) | Val  Loss: 2.1258 | Val  Acc: 0.2500
Average Valid Accuracy: 0.3841
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.4717
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.4457
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.4437
 Best site-webcam                   (3)  | Epoch:0 | Val Acc: 0.2609
 Best site-webcam                   (3)  | Epoch:0 | Val Acc: 0.4571
 Best site-caltech                  (0)  | Epoch:0 | Val Acc: 0.3594
 Best site-dslr                     (1)  | Epoch:0 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-amazon                    (1) | Train Loss: 1.6512 | Train Acc: 0.7000
 Site-amazon                    (1) | Train Loss: 1.6214 | Train Acc: 0.7754
 Site-amazon                    (1) | Train Loss: 1.6748 | Train Acc: 0.7333
 Site-webcam                    (3) | Train Loss: 1.7006 | Train Acc: 0.7143
 Site-webcam                    (0) | Train Loss: 1.7039 | Train Acc: 0.7048
 Site-caltech                   (1) | Train Loss: 1.6232 | Train Acc: 0.7732
 Site-dslr                      (2) | Train Loss: 1.7469 | Train Acc: 0.7273
Average Train Accuracy: 0.7326
 Site-amazon                    (1) | Val  Loss: 1.6248 | Val  Acc: 0.7736
 Site-amazon                    (1) | Val  Loss: 1.6715 | Val  Acc: 0.7391
 Site-amazon                    (1) | Val  Loss: 1.6451 | Val  Acc: 0.7438
 Site-webcam                    (3) | Val  Loss: 1.7228 | Val  Acc: 0.6522
 Site-webcam                    (0) | Val  Loss: 1.7866 | Val  Acc: 0.7571
 Site-caltech                   (1) | Val  Loss: 1.6650 | Val  Acc: 0.7344
 Site-dslr                      (2) | Val  Loss: 1.7319 | Val  Acc: 0.6818
Average Valid Accuracy: 0.7260
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.7736
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.7391
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.7438
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.6522
 Best site-webcam                   (0)  | Epoch:1 | Val Acc: 0.7571
 Best site-caltech                  (1)  | Epoch:1 | Val Acc: 0.7344
 Best site-dslr                     (2)  | Epoch:1 | Val Acc: 0.6818
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-amazon                    (0) | Train Loss: 1.3557 | Train Acc: 0.8250
 Site-amazon                    (0) | Train Loss: 1.2826 | Train Acc: 0.9058
 Site-amazon                    (3) | Train Loss: 1.2783 | Train Acc: 0.8708
 Site-webcam                    (2) | Train Loss: 1.2928 | Train Acc: 0.9714
 Site-webcam                    (2) | Train Loss: 1.3750 | Train Acc: 0.7905
 Site-caltech                   (3) | Train Loss: 1.2758 | Train Acc: 0.8660
 Site-dslr                      (1) | Train Loss: 1.3158 | Train Acc: 0.8636
Average Train Accuracy: 0.8705
 Site-amazon                    (0) | Val  Loss: 1.3074 | Val  Acc: 0.7547
 Site-amazon                    (0) | Val  Loss: 1.3267 | Val  Acc: 0.8152
 Site-amazon                    (3) | Val  Loss: 1.2799 | Val  Acc: 0.8375
 Site-webcam                    (2) | Val  Loss: 1.3367 | Val  Acc: 0.7826
 Site-webcam                    (2) | Val  Loss: 1.4070 | Val  Acc: 0.8286
 Site-caltech                   (3) | Val  Loss: 1.2968 | Val  Acc: 0.8906
 Site-dslr                      (1) | Val  Loss: 1.3515 | Val  Acc: 0.8409
Average Valid Accuracy: 0.8214
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7547
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.8152
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.8375
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.7826
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.8286
 Best site-caltech                  (3)  | Epoch:2 | Val Acc: 0.8906
 Best site-dslr                     (1)  | Epoch:2 | Val Acc: 0.8409
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-amazon                    (2) | Train Loss: 1.0073 | Train Acc: 0.8875
 Site-amazon                    (2) | Train Loss: 0.9223 | Train Acc: 0.9493
 Site-amazon                    (0) | Train Loss: 0.9646 | Train Acc: 0.9000
 Site-webcam                    (1) | Train Loss: 0.9954 | Train Acc: 0.9429
 Site-webcam                    (1) | Train Loss: 1.0863 | Train Acc: 0.8857
 Site-caltech                   (0) | Train Loss: 0.9878 | Train Acc: 0.9278
 Site-dslr                      (3) | Train Loss: 0.9364 | Train Acc: 0.8788
Average Train Accuracy: 0.9103
 Site-amazon                    (2) | Val  Loss: 0.9984 | Val  Acc: 0.8868
 Site-amazon                    (2) | Val  Loss: 1.0374 | Val  Acc: 0.8804
 Site-amazon                    (0) | Val  Loss: 0.9642 | Val  Acc: 0.9125
 Site-webcam                    (1) | Val  Loss: 1.1063 | Val  Acc: 0.9565
 Site-webcam                    (1) | Val  Loss: 1.0814 | Val  Acc: 0.9000
 Site-caltech                   (0) | Val  Loss: 1.0340 | Val  Acc: 0.9688
 Site-dslr                      (3) | Val  Loss: 1.1038 | Val  Acc: 0.8409
Average Valid Accuracy: 0.9066
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.8868
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.8804
 Best site-amazon                   (0)  | Epoch:3 | Val Acc: 0.9125
 Best site-webcam                   (1)  | Epoch:3 | Val Acc: 0.9565
 Best site-webcam                   (1)  | Epoch:3 | Val Acc: 0.9000
 Best site-caltech                  (0)  | Epoch:3 | Val Acc: 0.9688
 Best site-dslr                     (3)  | Epoch:3 | Val Acc: 0.8409
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-amazon                    (2) | Train Loss: 0.8534 | Train Acc: 0.8875
 Site-amazon                    (2) | Train Loss: 0.6611 | Train Acc: 0.9420
 Site-amazon                    (0) | Train Loss: 0.7464 | Train Acc: 0.9125
 Site-webcam                    (3) | Train Loss: 0.7897 | Train Acc: 0.9429
 Site-webcam                    (3) | Train Loss: 0.8274 | Train Acc: 0.9238
 Site-caltech                   (0) | Train Loss: 0.7693 | Train Acc: 0.9485
 Site-dslr                      (1) | Train Loss: 1.0268 | Train Acc: 0.9091
Average Train Accuracy: 0.9237
 Site-amazon                    (2) | Val  Loss: 0.7511 | Val  Acc: 0.9434
 Site-amazon                    (2) | Val  Loss: 0.7870 | Val  Acc: 0.9130
 Site-amazon                    (0) | Val  Loss: 0.7083 | Val  Acc: 0.9187
 Site-webcam                    (3) | Val  Loss: 0.9425 | Val  Acc: 0.9130
 Site-webcam                    (3) | Val  Loss: 0.8302 | Val  Acc: 0.9429
 Site-caltech                   (0) | Val  Loss: 0.8098 | Val  Acc: 0.9688
 Site-dslr                      (1) | Val  Loss: 0.8468 | Val  Acc: 0.9091
Average Valid Accuracy: 0.9298
 Best site-amazon                   (2)  | Epoch:4 | Val Acc: 0.9434
 Best site-amazon                   (2)  | Epoch:4 | Val Acc: 0.9130
 Best site-amazon                   (0)  | Epoch:4 | Val Acc: 0.9187
 Best site-webcam                   (3)  | Epoch:4 | Val Acc: 0.9130
 Best site-webcam                   (3)  | Epoch:4 | Val Acc: 0.9429
 Best site-caltech                  (0)  | Epoch:4 | Val Acc: 0.9688
 Best site-dslr                     (1)  | Epoch:4 | Val Acc: 0.9091
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-amazon                    (1) | Train Loss: 0.6700 | Train Acc: 0.9250
 Site-amazon                    (1) | Train Loss: 0.5323 | Train Acc: 0.9710
 Site-amazon                    (3) | Train Loss: 0.5565 | Train Acc: 0.9417
 Site-webcam                    (2) | Train Loss: 0.6572 | Train Acc: 0.9429
 Site-webcam                    (2) | Train Loss: 0.6825 | Train Acc: 0.9619
 Site-caltech                   (3) | Train Loss: 0.6315 | Train Acc: 0.9381
 Site-dslr                      (0) | Train Loss: 0.7421 | Train Acc: 0.9545
Average Train Accuracy: 0.9479
 Site-amazon                    (1) | Val  Loss: 0.5979 | Val  Acc: 0.9434
 Site-amazon                    (1) | Val  Loss: 0.6153 | Val  Acc: 0.9130
 Site-amazon                    (3) | Val  Loss: 0.5708 | Val  Acc: 0.9375
 Site-webcam                    (2) | Val  Loss: 0.6987 | Val  Acc: 0.9130
 Site-webcam                    (2) | Val  Loss: 0.6303 | Val  Acc: 0.9429
 Site-caltech                   (3) | Val  Loss: 0.5914 | Val  Acc: 0.9688
 Site-dslr                      (0) | Val  Loss: 0.6694 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9423
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.9434
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.9130
 Best site-amazon                   (3)  | Epoch:5 | Val Acc: 0.9375
 Best site-webcam                   (2)  | Epoch:5 | Val Acc: 0.9130
 Best site-webcam                   (2)  | Epoch:5 | Val Acc: 0.9429
 Best site-caltech                  (3)  | Epoch:5 | Val Acc: 0.9688
 Best site-dslr                     (0)  | Epoch:5 | Val Acc: 0.9773
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-amazon                    (1) | Train Loss: 0.5920 | Train Acc: 0.8875
 Site-amazon                    (1) | Train Loss: 0.4079 | Train Acc: 0.9638
 Site-amazon                    (3) | Train Loss: 0.4455 | Train Acc: 0.9542
 Site-webcam                    (0) | Train Loss: 0.5143 | Train Acc: 0.9714
 Site-webcam                    (0) | Train Loss: 0.5918 | Train Acc: 0.9143
 Site-caltech                   (3) | Train Loss: 0.5268 | Train Acc: 0.9072
 Site-dslr                      (2) | Train Loss: 0.5693 | Train Acc: 0.9545
Average Train Accuracy: 0.9361
 Site-amazon                    (1) | Val  Loss: 0.5074 | Val  Acc: 0.9623
 Site-amazon                    (1) | Val  Loss: 0.5074 | Val  Acc: 0.9239
 Site-amazon                    (3) | Val  Loss: 0.4385 | Val  Acc: 0.9500
 Site-webcam                    (0) | Val  Loss: 0.5152 | Val  Acc: 1.0000
 Site-webcam                    (0) | Val  Loss: 0.5348 | Val  Acc: 0.9571
 Site-caltech                   (3) | Val  Loss: 0.5251 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.5448 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9615
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.9623
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.9239
 Best site-amazon                   (3)  | Epoch:6 | Val Acc: 0.9500
 Best site-webcam                   (0)  | Epoch:6 | Val Acc: 1.0000
 Best site-webcam                   (0)  | Epoch:6 | Val Acc: 0.9571
 Best site-caltech                  (3)  | Epoch:6 | Val Acc: 0.9375
 Best site-dslr                     (2)  | Epoch:6 | Val Acc: 1.0000
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-amazon                    (3) | Train Loss: 0.3888 | Train Acc: 0.9125
 Site-amazon                    (3) | Train Loss: 0.3197 | Train Acc: 0.9855
 Site-amazon                    (3) | Train Loss: 0.3896 | Train Acc: 0.9542
 Site-webcam                    (2) | Train Loss: 0.4223 | Train Acc: 0.9714
 Site-webcam                    (2) | Train Loss: 0.4793 | Train Acc: 0.9714
 Site-caltech                   (0) | Train Loss: 0.4225 | Train Acc: 0.9381
 Site-dslr                      (1) | Train Loss: 0.3388 | Train Acc: 0.9545
Average Train Accuracy: 0.9554
 Site-amazon                    (3) | Val  Loss: 0.3722 | Val  Acc: 1.0000
 Site-amazon                    (3) | Val  Loss: 0.4064 | Val  Acc: 0.9565
 Site-amazon                    (3) | Val  Loss: 0.3886 | Val  Acc: 0.9375
 Site-webcam                    (2) | Val  Loss: 0.4677 | Val  Acc: 1.0000
 Site-webcam                    (2) | Val  Loss: 0.4306 | Val  Acc: 0.8857
 Site-caltech                   (0) | Val  Loss: 0.4192 | Val  Acc: 0.9688
 Site-dslr                      (1) | Val  Loss: 0.4763 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9641
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 1.0000
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 0.9565
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 0.9375
 Best site-webcam                   (2)  | Epoch:7 | Val Acc: 1.0000
 Best site-webcam                   (2)  | Epoch:7 | Val Acc: 0.8857
 Best site-caltech                  (0)  | Epoch:7 | Val Acc: 0.9688
 Best site-dslr                     (1)  | Epoch:7 | Val Acc: 1.0000
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-amazon                    (1) | Train Loss: 0.5298 | Train Acc: 0.9250
 Site-amazon                    (1) | Train Loss: 0.3009 | Train Acc: 0.9710
 Site-amazon                    (1) | Train Loss: 0.3370 | Train Acc: 0.9417
 Site-webcam                    (3) | Train Loss: 0.3622 | Train Acc: 0.9429
 Site-webcam                    (0) | Train Loss: 0.3777 | Train Acc: 0.9714
 Site-caltech                   (1) | Train Loss: 0.3419 | Train Acc: 0.9485
 Site-dslr                      (2) | Train Loss: 0.2914 | Train Acc: 0.9394
Average Train Accuracy: 0.9485
 Site-amazon                    (1) | Val  Loss: 0.3139 | Val  Acc: 0.9811
 Site-amazon                    (1) | Val  Loss: 0.3691 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 0.3241 | Val  Acc: 0.9313
 Site-webcam                    (3) | Val  Loss: 0.3521 | Val  Acc: 0.9565
 Site-webcam                    (0) | Val  Loss: 0.3165 | Val  Acc: 0.9714
 Site-caltech                   (1) | Val  Loss: 0.3572 | Val  Acc: 0.9531
 Site-dslr                      (2) | Val  Loss: 0.4200 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9579
============ Train epoch 9 ============
cnt=[3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-amazon                    (0) | Train Loss: 0.3355 | Train Acc: 0.9250
 Site-amazon                    (0) | Train Loss: 0.2521 | Train Acc: 0.9565
 Site-amazon                    (0) | Train Loss: 0.2807 | Train Acc: 0.9458
 Site-webcam                    (1) | Train Loss: 0.3111 | Train Acc: 0.9429
 Site-webcam                    (1) | Train Loss: 0.3315 | Train Acc: 0.9619
 Site-caltech                   (3) | Train Loss: 0.3246 | Train Acc: 0.9381
 Site-dslr                      (2) | Train Loss: 0.3095 | Train Acc: 0.9545
Average Train Accuracy: 0.9464
 Site-amazon                    (0) | Val  Loss: 0.2838 | Val  Acc: 0.9811
 Site-amazon                    (0) | Val  Loss: 0.3337 | Val  Acc: 0.9239
 Site-amazon                    (0) | Val  Loss: 0.3335 | Val  Acc: 0.9313
 Site-webcam                    (1) | Val  Loss: 0.2977 | Val  Acc: 0.9565
 Site-webcam                    (1) | Val  Loss: 0.2608 | Val  Acc: 0.9714
 Site-caltech                   (3) | Val  Loss: 0.3159 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.3631 | Val  Acc: 0.9318
Average Valid Accuracy: 0.9477
============ Train epoch 10 ============
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-amazon                    (1) | Train Loss: 0.2789 | Train Acc: 0.9125
 Site-amazon                    (1) | Train Loss: 0.2493 | Train Acc: 0.9710
 Site-amazon                    (1) | Train Loss: 0.2654 | Train Acc: 0.9500
 Site-webcam                    (0) | Train Loss: 0.2384 | Train Acc: 1.0000
 Site-webcam                    (3) | Train Loss: 0.3096 | Train Acc: 0.9429
 Site-caltech                   (2) | Train Loss: 0.2667 | Train Acc: 0.9794
 Site-dslr                      (0) | Train Loss: 0.2322 | Train Acc: 0.9545
Average Train Accuracy: 0.9586
 Site-amazon                    (1) | Val  Loss: 0.2463 | Val  Acc: 0.9811
 Site-amazon                    (1) | Val  Loss: 0.2654 | Val  Acc: 0.9457
 Site-amazon                    (1) | Val  Loss: 0.2428 | Val  Acc: 0.9437
 Site-webcam                    (0) | Val  Loss: 0.2907 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 0.2315 | Val  Acc: 0.9714
 Site-caltech                   (2) | Val  Loss: 0.2316 | Val  Acc: 0.9688
 Site-dslr                      (0) | Val  Loss: 0.2890 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9697
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9811
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9457
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9437
 Best site-webcam                   (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-webcam                   (3)  | Epoch:10 | Val Acc: 0.9714
 Best site-caltech                  (2)  | Epoch:10 | Val Acc: 0.9688
 Best site-dslr                     (0)  | Epoch:10 | Val Acc: 0.9773
 Test site-amazon                    (1)| Epoch:10 | Test Acc: 0.9531
 Test site-webcam                    (0)| Epoch:10 | Test Acc: 0.9322
 Test site-caltech                   (2)| Epoch:10 | Test Acc: 0.9467
 Test site-dslr                      (0)| Epoch:10 | Test Acc: 1.0000
amazon: 0.9531, webcam: 0.9322, caltech: 0.9467, dslr: 1.0000, 
Average Test Accuracy(group): 0.9580, Average Test Accuracy(individual): 0.9529,
domain std=0.0254, cluster std=0.0122, individual std=0.0211, 
Average Test Accuracy: 0.9580
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-amazon                    (2) | Train Loss: 0.3930 | Train Acc: 0.9250
 Site-amazon                    (2) | Train Loss: 0.2076 | Train Acc: 0.9855
 Site-amazon                    (2) | Train Loss: 0.2054 | Train Acc: 0.9667
 Site-webcam                    (3) | Train Loss: 0.2468 | Train Acc: 1.0000
 Site-webcam                    (3) | Train Loss: 0.2540 | Train Acc: 0.9619
 Site-caltech                   (0) | Train Loss: 0.2541 | Train Acc: 0.9691
 Site-dslr                      (1) | Train Loss: 0.1767 | Train Acc: 0.9697
Average Train Accuracy: 0.9683
 Site-amazon                    (2) | Val  Loss: 0.2028 | Val  Acc: 0.9623
 Site-amazon                    (2) | Val  Loss: 0.2664 | Val  Acc: 0.9239
 Site-amazon                    (2) | Val  Loss: 0.2054 | Val  Acc: 0.9437
 Site-webcam                    (3) | Val  Loss: 0.2268 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 0.2071 | Val  Acc: 0.9714
 Site-caltech                   (0) | Val  Loss: 0.2264 | Val  Acc: 0.9688
 Site-dslr                      (1) | Val  Loss: 0.2347 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9672
 Test site-amazon                    (2)| Epoch:10 | Test Acc: 0.9531
 Test site-webcam                    (3)| Epoch:10 | Test Acc: 0.9322
 Test site-caltech                   (0)| Epoch:10 | Test Acc: 0.9467
 Test site-dslr                      (1)| Epoch:10 | Test Acc: 1.0000
amazon: 0.9531, webcam: 0.9322, caltech: 0.9467, dslr: 1.0000, 
Average Test Accuracy(group): 0.9580, Average Test Accuracy(individual): 0.9529,
domain std=0.0254, cluster std=0.0254, individual std=0.0211, 
Average Test Accuracy: 0.9580
============ Train epoch 12 ============
cnt=[1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-amazon                    (1) | Train Loss: 0.2345 | Train Acc: 0.9375
 Site-amazon                    (1) | Train Loss: 0.1579 | Train Acc: 0.9638
 Site-amazon                    (1) | Train Loss: 0.1904 | Train Acc: 0.9625
 Site-webcam                    (0) | Train Loss: 0.2651 | Train Acc: 0.9429
 Site-webcam                    (3) | Train Loss: 0.2266 | Train Acc: 0.9714
 Site-caltech                   (1) | Train Loss: 0.2238 | Train Acc: 0.9588
 Site-dslr                      (2) | Train Loss: 0.2446 | Train Acc: 0.9242
Average Train Accuracy: 0.9516
 Site-amazon                    (1) | Val  Loss: 0.2055 | Val  Acc: 0.9811
 Site-amazon                    (1) | Val  Loss: 0.2365 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 0.2140 | Val  Acc: 0.9500
 Site-webcam                    (0) | Val  Loss: 0.2100 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 0.1798 | Val  Acc: 0.9571
 Site-caltech                   (1) | Val  Loss: 0.2647 | Val  Acc: 0.9062
 Site-dslr                      (2) | Val  Loss: 0.2462 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9581
 Test site-amazon                    (1)| Epoch:10 | Test Acc: 0.9583
 Test site-webcam                    (0)| Epoch:10 | Test Acc: 0.9322
 Test site-caltech                   (1)| Epoch:10 | Test Acc: 0.9556
 Test site-dslr                      (2)| Epoch:10 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9322, caltech: 0.9556, dslr: 1.0000, 
Average Test Accuracy(group): 0.9615, Average Test Accuracy(individual): 0.9564,
domain std=0.0244, cluster std=0.0277, individual std=0.0210, 
Average Test Accuracy: 0.9615
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-amazon                    (1) | Train Loss: 0.3397 | Train Acc: 0.9250
 Site-amazon                    (1) | Train Loss: 0.1319 | Train Acc: 0.9710
 Site-amazon                    (1) | Train Loss: 0.1804 | Train Acc: 0.9625
 Site-webcam                    (0) | Train Loss: 0.2772 | Train Acc: 0.9714
 Site-webcam                    (0) | Train Loss: 0.2091 | Train Acc: 0.9810
 Site-caltech                   (3) | Train Loss: 0.1823 | Train Acc: 0.9794
 Site-dslr                      (2) | Train Loss: 0.2400 | Train Acc: 0.9697
Average Train Accuracy: 0.9657
 Site-amazon                    (1) | Val  Loss: 0.2082 | Val  Acc: 0.9623
 Site-amazon                    (1) | Val  Loss: 0.2429 | Val  Acc: 0.9239
 Site-amazon                    (1) | Val  Loss: 0.1884 | Val  Acc: 0.9500
 Site-webcam                    (0) | Val  Loss: 0.2066 | Val  Acc: 1.0000
 Site-webcam                    (0) | Val  Loss: 0.1714 | Val  Acc: 0.9714
 Site-caltech                   (3) | Val  Loss: 0.2287 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.2132 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9603
 Test site-amazon                    (1)| Epoch:12 | Test Acc: 0.9583
 Test site-webcam                    (0)| Epoch:12 | Test Acc: 0.9492
 Test site-caltech                   (3)| Epoch:12 | Test Acc: 0.9600
 Test site-dslr                      (2)| Epoch:12 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9492, caltech: 0.9600, dslr: 1.0000, 
Average Test Accuracy(group): 0.9669, Average Test Accuracy(individual): 0.9619,
domain std=0.0196, cluster std=0.0196, individual std=0.0161, 
Average Test Accuracy: 0.9669
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-amazon                    (1) | Train Loss: 0.3533 | Train Acc: 0.9375
 Site-amazon                    (1) | Train Loss: 0.1857 | Train Acc: 0.9783
 Site-amazon                    (3) | Train Loss: 0.1618 | Train Acc: 0.9667
 Site-webcam                    (2) | Train Loss: 0.1994 | Train Acc: 0.9714
 Site-webcam                    (2) | Train Loss: 0.1679 | Train Acc: 0.9810
 Site-caltech                   (0) | Train Loss: 0.1748 | Train Acc: 0.9588
 Site-dslr                      (2) | Train Loss: 0.2333 | Train Acc: 0.9848
Average Train Accuracy: 0.9683
 Site-amazon                    (1) | Val  Loss: 0.1646 | Val  Acc: 0.9623
 Site-amazon                    (1) | Val  Loss: 0.1955 | Val  Acc: 0.9457
 Site-amazon                    (3) | Val  Loss: 0.2036 | Val  Acc: 0.9375
 Site-webcam                    (2) | Val  Loss: 0.2329 | Val  Acc: 0.9565
 Site-webcam                    (2) | Val  Loss: 0.1642 | Val  Acc: 0.9714
 Site-caltech                   (0) | Val  Loss: 0.2295 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.2100 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9554
 Test site-amazon                    (1)| Epoch:13 | Test Acc: 0.9583
 Test site-webcam                    (2)| Epoch:13 | Test Acc: 0.9492
 Test site-caltech                   (0)| Epoch:13 | Test Acc: 0.9600
 Test site-dslr                      (2)| Epoch:13 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9492, caltech: 0.9600, dslr: 1.0000, 
Average Test Accuracy(group): 0.9669, Average Test Accuracy(individual): 0.9619,
domain std=0.0196, cluster std=0.0032, individual std=0.0161, 
Average Test Accuracy: 0.9669
============ Train epoch 15 ============
cnt=[1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-amazon                    (1) | Train Loss: 0.2843 | Train Acc: 0.9375
 Site-amazon                    (3) | Train Loss: 0.1217 | Train Acc: 0.9638
 Site-amazon                    (1) | Train Loss: 0.1616 | Train Acc: 0.9667
 Site-webcam                    (2) | Train Loss: 0.2203 | Train Acc: 0.9429
 Site-webcam                    (2) | Train Loss: 0.1848 | Train Acc: 0.9810
 Site-caltech                   (1) | Train Loss: 0.2235 | Train Acc: 0.9588
 Site-dslr                      (0) | Train Loss: 0.1421 | Train Acc: 0.9545
Average Train Accuracy: 0.9579
 Site-amazon                    (1) | Val  Loss: 0.1617 | Val  Acc: 0.9811
 Site-amazon                    (3) | Val  Loss: 0.2319 | Val  Acc: 0.9457
 Site-amazon                    (1) | Val  Loss: 0.1666 | Val  Acc: 0.9563
 Site-webcam                    (2) | Val  Loss: 0.1804 | Val  Acc: 0.9565
 Site-webcam                    (2) | Val  Loss: 0.1188 | Val  Acc: 0.9857
 Site-caltech                   (1) | Val  Loss: 0.1579 | Val  Acc: 0.9688
 Site-dslr                      (0) | Val  Loss: 0.2230 | Val  Acc: 0.9318
Average Valid Accuracy: 0.9608
 Test site-amazon                    (1)| Epoch:13 | Test Acc: 0.9583
 Test site-webcam                    (2)| Epoch:13 | Test Acc: 0.9492
 Test site-caltech                   (1)| Epoch:13 | Test Acc: 0.9556
 Test site-dslr                      (0)| Epoch:13 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9492, caltech: 0.9556, dslr: 1.0000, 
Average Test Accuracy(group): 0.9658, Average Test Accuracy(individual): 0.9613,
domain std=0.0200, cluster std=0.0198, individual std=0.0163, 
Average Test Accuracy: 0.9658
============ Train epoch 16 ============
cnt=[1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-amazon                    (1) | Train Loss: 0.3371 | Train Acc: 0.9500
 Site-amazon                    (1) | Train Loss: 0.1564 | Train Acc: 0.9855
 Site-amazon                    (1) | Train Loss: 0.1516 | Train Acc: 0.9708
 Site-webcam                    (3) | Train Loss: 0.1947 | Train Acc: 1.0000
 Site-webcam                    (0) | Train Loss: 0.2040 | Train Acc: 0.9714
 Site-caltech                   (3) | Train Loss: 0.1716 | Train Acc: 0.9691
 Site-dslr                      (2) | Train Loss: 0.3439 | Train Acc: 0.9545
Average Train Accuracy: 0.9716
 Site-amazon                    (1) | Val  Loss: 0.1721 | Val  Acc: 0.9623
 Site-amazon                    (1) | Val  Loss: 0.1843 | Val  Acc: 0.9674
 Site-amazon                    (1) | Val  Loss: 0.1894 | Val  Acc: 0.9375
 Site-webcam                    (3) | Val  Loss: 0.1709 | Val  Acc: 0.9565
 Site-webcam                    (0) | Val  Loss: 0.1410 | Val  Acc: 0.9571
 Site-caltech                   (3) | Val  Loss: 0.2088 | Val  Acc: 0.9219
 Site-dslr                      (2) | Val  Loss: 0.1843 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9575
 Test site-amazon                    (1)| Epoch:13 | Test Acc: 0.9531
 Test site-webcam                    (3)| Epoch:13 | Test Acc: 0.9492
 Test site-caltech                   (3)| Epoch:13 | Test Acc: 0.9556
 Test site-dslr                      (2)| Epoch:13 | Test Acc: 1.0000
amazon: 0.9531, webcam: 0.9492, caltech: 0.9556, dslr: 1.0000, 
Average Test Accuracy(group): 0.9645, Average Test Accuracy(individual): 0.9590,
domain std=0.0206, cluster std=0.0210, individual std=0.0169, 
Average Test Accuracy: 0.9645
============ Train epoch 17 ============
cnt=[2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-amazon                    (1) | Train Loss: 0.1809 | Train Acc: 0.9500
 Site-amazon                    (1) | Train Loss: 0.1054 | Train Acc: 0.9783
 Site-amazon                    (1) | Train Loss: 0.1488 | Train Acc: 0.9750
 Site-webcam                    (0) | Train Loss: 0.2206 | Train Acc: 0.9429
 Site-webcam                    (0) | Train Loss: 0.1862 | Train Acc: 0.9714
 Site-caltech                   (3) | Train Loss: 0.1941 | Train Acc: 0.9485
 Site-dslr                      (2) | Train Loss: 0.2504 | Train Acc: 0.9697
Average Train Accuracy: 0.9622
 Site-amazon                    (1) | Val  Loss: 0.1566 | Val  Acc: 0.9623
 Site-amazon                    (1) | Val  Loss: 0.2233 | Val  Acc: 0.9565
 Site-amazon                    (1) | Val  Loss: 0.1784 | Val  Acc: 0.9500
 Site-webcam                    (0) | Val  Loss: 0.1594 | Val  Acc: 1.0000
 Site-webcam                    (0) | Val  Loss: 0.1184 | Val  Acc: 0.9714
 Site-caltech                   (3) | Val  Loss: 0.1699 | Val  Acc: 0.9531
 Site-dslr                      (2) | Val  Loss: 0.2223 | Val  Acc: 0.9318
Average Valid Accuracy: 0.9607
 Test site-amazon                    (1)| Epoch:13 | Test Acc: 0.9583
 Test site-webcam                    (0)| Epoch:13 | Test Acc: 0.9831
 Test site-caltech                   (3)| Epoch:13 | Test Acc: 0.9556
 Test site-dslr                      (2)| Epoch:13 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9831, caltech: 0.9556, dslr: 1.0000, 
Average Test Accuracy(group): 0.9742, Average Test Accuracy(individual): 0.9710,
domain std=0.0183, cluster std=0.0183, individual std=0.0163, 
Average Test Accuracy: 0.9742
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/ccop_q=1...
============ Train epoch 18 ============
cnt=[3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-amazon                    (0) | Train Loss: 0.2107 | Train Acc: 0.9375
 Site-amazon                    (2) | Train Loss: 0.1197 | Train Acc: 0.9638
 Site-amazon                    (0) | Train Loss: 0.1537 | Train Acc: 0.9708
 Site-webcam                    (1) | Train Loss: 0.1924 | Train Acc: 0.9714
 Site-webcam                    (1) | Train Loss: 0.1412 | Train Acc: 0.9714
 Site-caltech                   (0) | Train Loss: 0.1801 | Train Acc: 0.9381
 Site-dslr                      (3) | Train Loss: 0.1181 | Train Acc: 0.9697
Average Train Accuracy: 0.9604
 Site-amazon                    (0) | Val  Loss: 0.1662 | Val  Acc: 0.9811
 Site-amazon                    (2) | Val  Loss: 0.1953 | Val  Acc: 0.9674
 Site-amazon                    (0) | Val  Loss: 0.1556 | Val  Acc: 0.9625
 Site-webcam                    (1) | Val  Loss: 0.1419 | Val  Acc: 1.0000
 Site-webcam                    (1) | Val  Loss: 0.1147 | Val  Acc: 0.9714
 Site-caltech                   (0) | Val  Loss: 0.1950 | Val  Acc: 0.9219
 Site-dslr                      (3) | Val  Loss: 0.1470 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9720
 Best site-amazon                   (0)  | Epoch:18 | Val Acc: 0.9811
 Best site-amazon                   (2)  | Epoch:18 | Val Acc: 0.9674
 Best site-amazon                   (0)  | Epoch:18 | Val Acc: 0.9625
 Best site-webcam                   (1)  | Epoch:18 | Val Acc: 1.0000
 Best site-webcam                   (1)  | Epoch:18 | Val Acc: 0.9714
 Best site-caltech                  (0)  | Epoch:18 | Val Acc: 0.9219
 Best site-dslr                     (3)  | Epoch:18 | Val Acc: 1.0000
 Test site-amazon                    (0)| Epoch:18 | Test Acc: 0.9583
 Test site-webcam                    (1)| Epoch:18 | Test Acc: 0.9831
 Test site-caltech                   (0)| Epoch:18 | Test Acc: 0.9556
 Test site-dslr                      (3)| Epoch:18 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9831, caltech: 0.9556, dslr: 1.0000, 
Average Test Accuracy(group): 0.9742, Average Test Accuracy(individual): 0.9710,
domain std=0.0183, cluster std=0.0179, individual std=0.0163, 
Average Test Accuracy: 0.9742
============ Train epoch 19 ============
cnt=[3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-amazon                    (0) | Train Loss: 0.1792 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.1031 | Train Acc: 0.9783
 Site-amazon                    (0) | Train Loss: 0.1382 | Train Acc: 0.9667
 Site-webcam                    (1) | Train Loss: 0.1747 | Train Acc: 0.9714
 Site-webcam                    (1) | Train Loss: 0.1233 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.1637 | Train Acc: 0.9588
 Site-dslr                      (2) | Train Loss: 0.1685 | Train Acc: 0.9697
Average Train Accuracy: 0.9689
 Site-amazon                    (0) | Val  Loss: 0.1318 | Val  Acc: 0.9623
 Site-amazon                    (0) | Val  Loss: 0.1617 | Val  Acc: 0.9783
 Site-amazon                    (0) | Val  Loss: 0.1493 | Val  Acc: 0.9437
 Site-webcam                    (1) | Val  Loss: 0.1067 | Val  Acc: 1.0000
 Site-webcam                    (1) | Val  Loss: 0.1180 | Val  Acc: 0.9857
 Site-caltech                   (3) | Val  Loss: 0.1397 | Val  Acc: 0.9844
 Site-dslr                      (2) | Val  Loss: 0.1563 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9759
 Best site-amazon                   (0)  | Epoch:19 | Val Acc: 0.9623
 Best site-amazon                   (0)  | Epoch:19 | Val Acc: 0.9783
 Best site-amazon                   (0)  | Epoch:19 | Val Acc: 0.9437
 Best site-webcam                   (1)  | Epoch:19 | Val Acc: 1.0000
 Best site-webcam                   (1)  | Epoch:19 | Val Acc: 0.9857
 Best site-caltech                  (3)  | Epoch:19 | Val Acc: 0.9844
 Best site-dslr                     (2)  | Epoch:19 | Val Acc: 0.9773
 Test site-amazon                    (0)| Epoch:19 | Test Acc: 0.9583
 Test site-webcam                    (1)| Epoch:19 | Test Acc: 0.9831
 Test site-caltech                   (3)| Epoch:19 | Test Acc: 0.9556
 Test site-dslr                      (2)| Epoch:19 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9831, caltech: 0.9556, dslr: 1.0000, 
Average Test Accuracy(group): 0.9742, Average Test Accuracy(individual): 0.9710,
domain std=0.0183, cluster std=0.0183, individual std=0.0163, 
Average Test Accuracy: 0.9742
===2023-08-02 17:31:10===
===2023-08-02 17:31:13===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[80,138,240,35,105,97,66,
client_nums=[3,2,1,1,]
len_dataset=[766,236,162,111,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (1)| Epoch:17 | Test Acc: 0.9583
 Test site-webcam                    (0)| Epoch:17 | Test Acc: 0.9831
 Test site-caltech                   (3)| Epoch:17 | Test Acc: 0.9556
 Test site-dslr                      (2)| Epoch:17 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9831, caltech: 0.9556, dslr: 1.0000, 
Average Test Accuracy(group): 0.9742, Average Test Accuracy(individual): 0.9710,
domain std=0.0183, cluster std=0.0183, individual std=0.0163, 
