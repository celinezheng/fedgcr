===2023-08-01 22:22:59===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.2614 | Train Acc: 0.2143
 Site-Clipart                       | Train Loss: 2.1793 | Train Acc: 0.4608
 Site-Clipart                       | Train Loss: 2.2416 | Train Acc: 0.1622
 Site-Art                           | Train Loss: 2.2320 | Train Acc: 0.3295
 Site-Art                           | Train Loss: 2.2631 | Train Acc: 0.1473
 Site-RealWorld                     | Train Loss: 2.2036 | Train Acc: 0.4133
 Site-Product                       | Train Loss: 2.2079 | Train Acc: 0.3981
Average Train Accuracy: 0.3036
 Site-Clipart                       | Val  Loss: 2.2372 | Val  Acc: 0.1064
 Site-Clipart                       | Val  Loss: 2.2123 | Val  Acc: 0.1912
 Site-Clipart                       | Val  Loss: 2.1722 | Val  Acc: 0.4694
 Site-Art                           | Val  Loss: 2.2677 | Val  Acc: 0.1356
 Site-Art                           | Val  Loss: 2.2356 | Val  Acc: 0.1294
 Site-RealWorld                     | Val  Loss: 2.2169 | Val  Acc: 0.4000
 Site-Product                       | Val  Loss: 2.1699 | Val  Acc: 0.4348
Average Valid Accuracy: 0.2667
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.1064
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.1912
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4694
 Best site-Art                       | Epoch:0 | Val Acc: 0.1356
 Best site-Art                       | Epoch:0 | Val Acc: 0.1294
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.4000
 Best site-Product                   | Epoch:0 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 2.2034 | Train Acc: 0.3429
 Site-Clipart                       | Train Loss: 2.1211 | Train Acc: 0.5686
 Site-Clipart                       | Train Loss: 2.1711 | Train Acc: 0.4189
 Site-Art                           | Train Loss: 2.1452 | Train Acc: 0.5227
 Site-Art                           | Train Loss: 2.2308 | Train Acc: 0.3566
 Site-RealWorld                     | Train Loss: 2.1205 | Train Acc: 0.7933
 Site-Product                       | Train Loss: 2.1154 | Train Acc: 0.8544
Average Train Accuracy: 0.5511
 Site-Clipart                       | Val  Loss: 2.1569 | Val  Acc: 0.4894
 Site-Clipart                       | Val  Loss: 2.1299 | Val  Acc: 0.5588
 Site-Clipart                       | Val  Loss: 2.1315 | Val  Acc: 0.6020
 Site-Art                           | Val  Loss: 2.2133 | Val  Acc: 0.3220
 Site-Art                           | Val  Loss: 2.1757 | Val  Acc: 0.3529
 Site-RealWorld                     | Val  Loss: 2.1610 | Val  Acc: 0.5800
 Site-Product                       | Val  Loss: 2.0949 | Val  Acc: 0.7391
Average Valid Accuracy: 0.5206
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.4894
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5588
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6020
 Best site-Art                       | Epoch:1 | Val Acc: 0.3220
 Best site-Art                       | Epoch:1 | Val Acc: 0.3529
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.5800
 Best site-Product                   | Epoch:1 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 2.0798 | Train Acc: 0.5429
 Site-Clipart                       | Train Loss: 2.0860 | Train Acc: 0.5980
 Site-Clipart                       | Train Loss: 2.1140 | Train Acc: 0.5405
 Site-Art                           | Train Loss: 2.0776 | Train Acc: 0.7159
 Site-Art                           | Train Loss: 2.1640 | Train Acc: 0.5426
 Site-RealWorld                     | Train Loss: 2.0068 | Train Acc: 0.9133
 Site-Product                       | Train Loss: 2.0329 | Train Acc: 0.9126
Average Train Accuracy: 0.6808
 Site-Clipart                       | Val  Loss: 2.0709 | Val  Acc: 0.7447
 Site-Clipart                       | Val  Loss: 2.0532 | Val  Acc: 0.7059
 Site-Clipart                       | Val  Loss: 2.0938 | Val  Acc: 0.6735
 Site-Art                           | Val  Loss: 2.1361 | Val  Acc: 0.5254
 Site-Art                           | Val  Loss: 2.0914 | Val  Acc: 0.6235
 Site-RealWorld                     | Val  Loss: 2.0928 | Val  Acc: 0.6300
 Site-Product                       | Val  Loss: 2.0314 | Val  Acc: 0.8261
Average Valid Accuracy: 0.6756
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7447
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7059
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6735
 Best site-Art                       | Epoch:2 | Val Acc: 0.5254
 Best site-Art                       | Epoch:2 | Val Acc: 0.6235
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6300
 Best site-Product                   | Epoch:2 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 1.9790 | Train Acc: 0.7429
 Site-Clipart                       | Train Loss: 2.0238 | Train Acc: 0.7549
 Site-Clipart                       | Train Loss: 2.0647 | Train Acc: 0.6419
 Site-Art                           | Train Loss: 1.9962 | Train Acc: 0.7955
 Site-Art                           | Train Loss: 2.0471 | Train Acc: 0.6357
 Site-RealWorld                     | Train Loss: 1.9263 | Train Acc: 0.9533
 Site-Product                       | Train Loss: 1.9463 | Train Acc: 0.9612
Average Train Accuracy: 0.7836
 Site-Clipart                       | Val  Loss: 1.9915 | Val  Acc: 0.7872
 Site-Clipart                       | Val  Loss: 1.9777 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 2.0341 | Val  Acc: 0.7347
 Site-Art                           | Val  Loss: 2.0788 | Val  Acc: 0.6949
 Site-Art                           | Val  Loss: 2.0352 | Val  Acc: 0.7176
 Site-RealWorld                     | Val  Loss: 2.0148 | Val  Acc: 0.7600
 Site-Product                       | Val  Loss: 1.9419 | Val  Acc: 0.8551
Average Valid Accuracy: 0.7655
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7872
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8088
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7347
 Best site-Art                       | Epoch:3 | Val Acc: 0.6949
 Best site-Art                       | Epoch:3 | Val Acc: 0.7176
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7600
 Best site-Product                   | Epoch:3 | Val Acc: 0.8551
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.9320 | Train Acc: 0.7286
 Site-Clipart                       | Train Loss: 1.9873 | Train Acc: 0.7549
 Site-Clipart                       | Train Loss: 2.0014 | Train Acc: 0.6554
 Site-Art                           | Train Loss: 1.9246 | Train Acc: 0.8750
 Site-Art                           | Train Loss: 2.0533 | Train Acc: 0.7132
 Site-RealWorld                     | Train Loss: 1.8471 | Train Acc: 0.9400
 Site-Product                       | Train Loss: 1.8576 | Train Acc: 0.9612
Average Train Accuracy: 0.8040
 Site-Clipart                       | Val  Loss: 1.9189 | Val  Acc: 0.8298
 Site-Clipart                       | Val  Loss: 1.9176 | Val  Acc: 0.8529
 Site-Clipart                       | Val  Loss: 1.9852 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 2.0278 | Val  Acc: 0.6610
 Site-Art                           | Val  Loss: 1.9706 | Val  Acc: 0.7529
 Site-RealWorld                     | Val  Loss: 1.9586 | Val  Acc: 0.8000
 Site-Product                       | Val  Loss: 1.8733 | Val  Acc: 0.8551
Average Valid Accuracy: 0.7896
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8298
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8529
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7755
 Best site-Art                       | Epoch:4 | Val Acc: 0.6610
 Best site-Art                       | Epoch:4 | Val Acc: 0.7529
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8000
 Best site-Product                   | Epoch:4 | Val Acc: 0.8551
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.8325 | Train Acc: 0.7857
 Site-Clipart                       | Train Loss: 1.9457 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 1.9419 | Train Acc: 0.7297
 Site-Art                           | Train Loss: 1.8656 | Train Acc: 0.8864
 Site-Art                           | Train Loss: 1.9804 | Train Acc: 0.7752
 Site-RealWorld                     | Train Loss: 1.7538 | Train Acc: 0.9600
 Site-Product                       | Train Loss: 1.7659 | Train Acc: 0.9806
Average Train Accuracy: 0.8417
 Site-Clipart                       | Val  Loss: 1.8374 | Val  Acc: 0.8511
 Site-Clipart                       | Val  Loss: 1.8306 | Val  Acc: 0.8676
 Site-Clipart                       | Val  Loss: 1.9285 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.9638 | Val  Acc: 0.7288
 Site-Art                           | Val  Loss: 1.9037 | Val  Acc: 0.7529
 Site-RealWorld                     | Val  Loss: 1.8991 | Val  Acc: 0.8200
 Site-Product                       | Val  Loss: 1.8146 | Val  Acc: 0.8841
Average Valid Accuracy: 0.8129
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8511
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8676
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7857
 Best site-Art                       | Epoch:5 | Val Acc: 0.7288
 Best site-Art                       | Epoch:5 | Val Acc: 0.7529
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8200
 Best site-Product                   | Epoch:5 | Val Acc: 0.8841
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.8110 | Train Acc: 0.8571
 Site-Clipart                       | Train Loss: 1.8962 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.8740 | Train Acc: 0.7703
 Site-Art                           | Train Loss: 1.7838 | Train Acc: 0.8409
 Site-Art                           | Train Loss: 1.8438 | Train Acc: 0.8140
 Site-RealWorld                     | Train Loss: 1.6629 | Train Acc: 0.9667
 Site-Product                       | Train Loss: 1.7027 | Train Acc: 0.9709
Average Train Accuracy: 0.8507
 Site-Clipart                       | Val  Loss: 1.7649 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.7576 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.8901 | Val  Acc: 0.8265
 Site-Art                           | Val  Loss: 1.9079 | Val  Acc: 0.8136
 Site-Art                           | Val  Loss: 1.8241 | Val  Acc: 0.8706
 Site-RealWorld                     | Val  Loss: 1.8483 | Val  Acc: 0.8700
 Site-Product                       | Val  Loss: 1.7453 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8773
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8971
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8265
 Best site-Art                       | Epoch:6 | Val Acc: 0.8136
 Best site-Art                       | Epoch:6 | Val Acc: 0.8706
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8700
 Best site-Product                   | Epoch:6 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.7176 | Train Acc: 0.8571
 Site-Clipart                       | Train Loss: 1.8598 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 1.8172 | Train Acc: 0.7838
 Site-Art                           | Train Loss: 1.7165 | Train Acc: 0.8977
 Site-Art                           | Train Loss: 1.7520 | Train Acc: 0.8450
 Site-RealWorld                     | Train Loss: 1.6025 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.6146 | Train Acc: 0.9709
Average Train Accuracy: 0.8774
 Site-Clipart                       | Val  Loss: 1.6939 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.6787 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.8471 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.8506 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.7829 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.7994 | Val  Acc: 0.8500
 Site-Product                       | Val  Loss: 1.6878 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8844
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9149
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9118
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8571
 Best site-Art                       | Epoch:7 | Val Acc: 0.8475
 Best site-Art                       | Epoch:7 | Val Acc: 0.8824
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8500
 Best site-Product                   | Epoch:7 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.6721 | Train Acc: 0.8714
 Site-Clipart                       | Train Loss: 1.8233 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 1.7665 | Train Acc: 0.8243
 Site-Art                           | Train Loss: 1.6434 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.8362 | Train Acc: 0.8295
 Site-RealWorld                     | Train Loss: 1.5096 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.5472 | Train Acc: 0.9612
Average Train Accuracy: 0.8842
 Site-Clipart                       | Val  Loss: 1.6198 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.6267 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.8005 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 1.8031 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.7203 | Val  Acc: 0.8941
 Site-RealWorld                     | Val  Loss: 1.7125 | Val  Acc: 0.9100
 Site-Product                       | Val  Loss: 1.6206 | Val  Acc: 0.9130
Average Valid Accuracy: 0.9010
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8971
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8878
 Best site-Art                       | Epoch:8 | Val Acc: 0.8475
 Best site-Art                       | Epoch:8 | Val Acc: 0.8941
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9100
 Best site-Product                   | Epoch:8 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 1.6098 | Train Acc: 0.8571
 Site-Clipart                       | Train Loss: 1.7737 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 1.7248 | Train Acc: 0.7568
 Site-Art                           | Train Loss: 1.5916 | Train Acc: 0.8977
 Site-Art                           | Train Loss: 1.7114 | Train Acc: 0.8760
 Site-RealWorld                     | Train Loss: 1.4285 | Train Acc: 0.9733
 Site-Product                       | Train Loss: 1.4850 | Train Acc: 0.9709
Average Train Accuracy: 0.8765
 Site-Clipart                       | Val  Loss: 1.5697 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.5651 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.7597 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 1.7568 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.6599 | Val  Acc: 0.8941
 Site-RealWorld                     | Val  Loss: 1.6691 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 1.5522 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8940
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 1.4845 | Train Acc: 0.8571
 Site-Clipart                       | Train Loss: 1.7424 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 1.6909 | Train Acc: 0.7770
 Site-Art                           | Train Loss: 1.4972 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.7278 | Train Acc: 0.9147
 Site-RealWorld                     | Train Loss: 1.3596 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.4017 | Train Acc: 0.9612
Average Train Accuracy: 0.8934
 Site-Clipart                       | Val  Loss: 1.5193 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.4939 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.7048 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.6929 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.5991 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.6027 | Val  Acc: 0.9400
 Site-Product                       | Val  Loss: 1.4716 | Val  Acc: 0.9275
Average Valid Accuracy: 0.9098
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9149
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9118
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8571
 Best site-Art                       | Epoch:10 | Val Acc: 0.8644
 Best site-Art                       | Epoch:10 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9400
 Best site-Product                   | Epoch:10 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 1.5314 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.6868 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 1.6488 | Train Acc: 0.8243
 Site-Art                           | Train Loss: 1.4240 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.7133 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.2626 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.3413 | Train Acc: 0.9806
Average Train Accuracy: 0.9096
 Site-Clipart                       | Val  Loss: 1.4355 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.4141 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.7026 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.6555 | Val  Acc: 0.8814
 Site-Art                           | Val  Loss: 1.5497 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.5643 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.4346 | Val  Acc: 0.9275
Average Valid Accuracy: 0.9188
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9265
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8571
 Best site-Art                       | Epoch:11 | Val Acc: 0.8814
 Best site-Art                       | Epoch:11 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9500
 Best site-Product                   | Epoch:11 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 1.4044 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.6736 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 1.5786 | Train Acc: 0.8378
 Site-Art                           | Train Loss: 1.4055 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.4774 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.2227 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.2649 | Train Acc: 0.9903
Average Train Accuracy: 0.9073
 Site-Clipart                       | Val  Loss: 1.3856 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.3853 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.6404 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 1.5996 | Val  Acc: 0.8814
 Site-Art                           | Val  Loss: 1.4891 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.5091 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.3974 | Val  Acc: 0.9275
Average Valid Accuracy: 0.9178
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 1.4145 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 1.6190 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.5212 | Train Acc: 0.8243
 Site-Art                           | Train Loss: 1.3216 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.7161 | Train Acc: 0.9225
 Site-RealWorld                     | Train Loss: 1.1456 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.1981 | Train Acc: 0.9806
Average Train Accuracy: 0.9069
 Site-Clipart                       | Val  Loss: 1.3392 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.3504 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.6054 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 1.5561 | Val  Acc: 0.8814
 Site-Art                           | Val  Loss: 1.4481 | Val  Acc: 0.9294
 Site-RealWorld                     | Val  Loss: 1.4745 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.3252 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9212
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9118
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8980
 Best site-Art                       | Epoch:13 | Val Acc: 0.8814
 Best site-Art                       | Epoch:13 | Val Acc: 0.9294
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.9500
 Best site-Product                   | Epoch:13 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 1.3736 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.5814 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 1.5125 | Train Acc: 0.8108
 Site-Art                           | Train Loss: 1.2343 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.4334 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.0923 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.1275 | Train Acc: 0.9806
Average Train Accuracy: 0.9109
 Site-Clipart                       | Val  Loss: 1.2498 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.2501 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.5752 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 1.4927 | Val  Acc: 0.9322
 Site-Art                           | Val  Loss: 1.3737 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.4145 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.2382 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9459
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9574
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9265
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8878
 Best site-Art                       | Epoch:14 | Val Acc: 0.9322
 Best site-Art                       | Epoch:14 | Val Acc: 0.9765
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9700
 Best site-Product                   | Epoch:14 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 1.2731 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.5480 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 1.4185 | Train Acc: 0.8581
 Site-Art                           | Train Loss: 1.2625 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.4271 | Train Acc: 0.9457
 Site-RealWorld                     | Train Loss: 1.0261 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.0675 | Train Acc: 0.9903
Average Train Accuracy: 0.9136
 Site-Clipart                       | Val  Loss: 1.2039 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.1985 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.5382 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 1.4746 | Val  Acc: 0.8983
 Site-Art                           | Val  Loss: 1.3406 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.3733 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.1851 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9343
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 1.1718 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.5347 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 1.3980 | Train Acc: 0.8581
 Site-Art                           | Train Loss: 1.1686 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.5071 | Train Acc: 0.9225
 Site-RealWorld                     | Train Loss: 0.9878 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.0288 | Train Acc: 0.9903
Average Train Accuracy: 0.9177
 Site-Clipart                       | Val  Loss: 1.1446 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.1368 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.4943 | Val  Acc: 0.9184
 Site-Art                           | Val  Loss: 1.4122 | Val  Acc: 0.9322
 Site-Art                           | Val  Loss: 1.3040 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.3427 | Val  Acc: 0.9400
 Site-Product                       | Val  Loss: 1.2369 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9422
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 1.1866 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.4936 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 1.3825 | Train Acc: 0.8514
 Site-Art                           | Train Loss: 1.1498 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.2712 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.9035 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.9776 | Train Acc: 0.9709
Average Train Accuracy: 0.9123
 Site-Clipart                       | Val  Loss: 1.1169 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.0915 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.4914 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 1.3712 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.2523 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.2781 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.1222 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9362
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 1.0711 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.4622 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.3270 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 1.0930 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.4596 | Train Acc: 0.9380
 Site-RealWorld                     | Train Loss: 0.8462 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 0.9150 | Train Acc: 0.9806
Average Train Accuracy: 0.9174
 Site-Clipart                       | Val  Loss: 1.0486 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.0771 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.4426 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 1.3472 | Val  Acc: 0.8983
 Site-Art                           | Val  Loss: 1.1976 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.2334 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 1.0851 | Val  Acc: 0.9275
Average Valid Accuracy: 0.9288
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 1.1245 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.4374 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 1.2594 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 1.0154 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.1198 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.8225 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8947 | Train Acc: 0.9806
Average Train Accuracy: 0.9300
 Site-Clipart                       | Val  Loss: 1.0015 | Val  Acc: 0.9787
 Site-Clipart                       | Val  Loss: 1.0164 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.3986 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 1.2910 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 1.1521 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.2071 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 1.0289 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9609
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9787
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8980
 Best site-Art                       | Epoch:19 | Val Acc: 0.9831
 Best site-Art                       | Epoch:19 | Val Acc: 0.9647
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9900
 Best site-Product                   | Epoch:19 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 1.1030 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.4036 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 1.2184 | Train Acc: 0.8446
 Site-Art                           | Train Loss: 0.9312 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.2502 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.7577 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8062 | Train Acc: 0.9903
Average Train Accuracy: 0.9216
 Site-Clipart                       | Val  Loss: 0.9800 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 0.9895 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.3945 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 1.2334 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.1311 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.1914 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 0.9990 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9349
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.9532 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.3933 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 1.2053 | Train Acc: 0.8581
 Site-Art                           | Train Loss: 0.9104 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.0980 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.6968 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.7681 | Train Acc: 0.9806
Average Train Accuracy: 0.9223
 Site-Clipart                       | Val  Loss: 0.9079 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.9254 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.3469 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 1.1912 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 1.0728 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.1117 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.9366 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9445
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.8940 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.3526 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 1.1541 | Train Acc: 0.8514
 Site-Art                           | Train Loss: 0.8695 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.2646 | Train Acc: 0.9457
 Site-RealWorld                     | Train Loss: 0.6807 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.7087 | Train Acc: 0.9903
Average Train Accuracy: 0.9260
 Site-Clipart                       | Val  Loss: 0.8898 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.9133 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.3413 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 1.1576 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 1.0122 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 1.1030 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 0.9605 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9516
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.9765 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.3306 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 1.1441 | Train Acc: 0.8446
 Site-Art                           | Train Loss: 0.8718 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.2160 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.6474 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.7049 | Train Acc: 0.9709
Average Train Accuracy: 0.9163
 Site-Clipart                       | Val  Loss: 0.8503 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.8222 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.2961 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 1.1559 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 0.9837 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.0594 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.9574 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9266
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.8688 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.3282 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 1.1238 | Train Acc: 0.8311
 Site-Art                           | Train Loss: 0.8191 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 0.9667 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.6046 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.6278 | Train Acc: 0.9806
Average Train Accuracy: 0.9166
 Site-Clipart                       | Val  Loss: 0.8106 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.8327 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.2662 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 1.1105 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.9569 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 1.0336 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.9434 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9409
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.8816 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.3039 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.1491 | Train Acc: 0.8446
 Site-Art                           | Train Loss: 0.7771 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.0727 | Train Acc: 0.9457
 Site-RealWorld                     | Train Loss: 0.5722 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.6254 | Train Acc: 0.9806
Average Train Accuracy: 0.9297
 Site-Clipart                       | Val  Loss: 0.7642 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.7712 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.2829 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 1.0351 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.9180 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.9789 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.8443 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9489
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.8327 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.2906 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.0063 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 0.7163 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.1935 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.5404 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5931 | Train Acc: 0.9806
Average Train Accuracy: 0.9332
 Site-Clipart                       | Val  Loss: 0.7239 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.7573 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.2314 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 1.0543 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.9091 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.9279 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7670 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9471
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.8199 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.2719 | Train Acc: 0.7549
 Site-Clipart                       | Train Loss: 1.0180 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 0.7118 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.1359 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.4645 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5315 | Train Acc: 0.9903
Average Train Accuracy: 0.9233
 Site-Clipart                       | Val  Loss: 0.6786 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.7098 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.2262 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.9891 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.8917 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.9322 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.7877 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9543
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.7520 | Train Acc: 0.9000
 Site-Clipart                       | Train Loss: 1.2696 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 1.0074 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.7099 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.0891 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.4728 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5134 | Train Acc: 0.9903
Average Train Accuracy: 0.9228
 Site-Clipart                       | Val  Loss: 0.6576 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6860 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.1760 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.9976 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.8458 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.9193 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.7294 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9433
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.7373 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.2448 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.9883 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.6366 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 0.8155 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.4420 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.4697 | Train Acc: 0.9903
Average Train Accuracy: 0.9315
 Site-Clipart                       | Val  Loss: 0.6507 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6538 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.1498 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.9661 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.8093 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.8452 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.7329 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9564
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.6800 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.2177 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.9302 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.6705 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 0.9401 | Train Acc: 0.9457
 Site-RealWorld                     | Train Loss: 0.4384 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4406 | Train Acc: 0.9903
Average Train Accuracy: 0.9319
 Site-Clipart                       | Val  Loss: 0.6213 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.6197 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.1304 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.9163 | Val  Acc: 0.9322
 Site-Art                           | Val  Loss: 0.8197 | Val  Acc: 0.9294
 Site-RealWorld                     | Val  Loss: 0.8425 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.6556 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9417
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.7255 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.1935 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.9242 | Train Acc: 0.8378
 Site-Art                           | Train Loss: 0.5996 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.0122 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.3923 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4590 | Train Acc: 0.9903
Average Train Accuracy: 0.9264
 Site-Clipart                       | Val  Loss: 0.5673 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6305 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 1.1224 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.9311 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.7474 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.8493 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.6423 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9531
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.7908 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.2049 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.8714 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.5752 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.9227 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.3856 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4164 | Train Acc: 0.9903
Average Train Accuracy: 0.9448
 Site-Clipart                       | Val  Loss: 0.5747 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.6008 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.0981 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.8562 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.7261 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.7912 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.6461 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9519
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.9417 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.1636 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.9218 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 0.5677 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.8994 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.3530 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3816 | Train Acc: 0.9903
Average Train Accuracy: 0.9370
 Site-Clipart                       | Val  Loss: 0.5260 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5756 | Val  Acc: 0.9559
 Site-Clipart                       | Val  Loss: 1.0789 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.8364 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.7154 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 0.7780 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5826 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9442
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.6143 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.0960 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.8257 | Train Acc: 0.8446
 Site-Art                           | Train Loss: 0.5408 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.7113 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.3762 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3663 | Train Acc: 0.9903
Average Train Accuracy: 0.9351
 Site-Clipart                       | Val  Loss: 0.5049 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5593 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.0884 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.8151 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.6834 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.7681 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5847 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9469
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.5607 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.1519 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.8698 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.5084 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.0605 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.3075 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3340 | Train Acc: 0.9806
Average Train Accuracy: 0.9304
 Site-Clipart                       | Val  Loss: 0.4764 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5334 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 1.0636 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.7721 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.6654 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.7400 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.5847 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9462
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.5401 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.1045 | Train Acc: 0.7941
 Site-Clipart                       | Train Loss: 0.7696 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 0.4842 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.7972 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.2882 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.3341 | Train Acc: 0.9903
Average Train Accuracy: 0.9294
 Site-Clipart                       | Val  Loss: 0.4718 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5145 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.0871 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.7908 | Val  Acc: 0.9322
 Site-Art                           | Val  Loss: 0.6341 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.7299 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5740 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9375
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.6360 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.1147 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.8311 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.4628 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.6901 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.2845 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.3111 | Train Acc: 0.9903
Average Train Accuracy: 0.9364
 Site-Clipart                       | Val  Loss: 0.4998 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.5055 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 1.0386 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.7610 | Val  Acc: 0.9322
 Site-Art                           | Val  Loss: 0.6320 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.7169 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5706 | Val  Acc: 0.9420
Average Valid Accuracy: 0.9426
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.4420 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.0542 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 0.7852 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 0.4585 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 0.8557 | Train Acc: 0.9380
 Site-RealWorld                     | Train Loss: 0.2748 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3091 | Train Acc: 0.9806
Average Train Accuracy: 0.9304
 Site-Clipart                       | Val  Loss: 0.4521 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4918 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 1.0214 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.6837 | Val  Acc: 0.9831
 Site-Art                           | Val  Loss: 0.5803 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6660 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.5112 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9531
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.4782 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.1012 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 0.7712 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.4257 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.7177 | Train Acc: 0.9690
 Site-RealWorld                     | Train Loss: 0.2379 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2740 | Train Acc: 0.9903
Average Train Accuracy: 0.9331
 Site-Clipart                       | Val  Loss: 0.4199 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4871 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 0.9841 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.7076 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.5905 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.6641 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.4488 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9468
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.4745 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.1029 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.7122 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.4439 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.9088 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.2324 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.2489 | Train Acc: 0.9903
Average Train Accuracy: 0.9347
 Site-Clipart                       | Val  Loss: 0.4479 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4356 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9838 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.7022 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.5692 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.6203 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.6217 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9533
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.7043 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.1133 | Train Acc: 0.7843
 Site-Clipart                       | Train Loss: 0.7588 | Train Acc: 0.8649
 Site-Art                           | Train Loss: 0.4772 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.5609 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.2175 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2596 | Train Acc: 0.9903
Average Train Accuracy: 0.9326
 Site-Clipart                       | Val  Loss: 0.3871 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4385 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 0.9971 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.6764 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.5379 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.6665 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.5323 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9369
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.4186 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.0709 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.7127 | Train Acc: 0.8784
 Site-Art                           | Train Loss: 0.4085 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 0.6319 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.2161 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2570 | Train Acc: 0.9903
Average Train Accuracy: 0.9347
 Site-Clipart                       | Val  Loss: 0.4001 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3992 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9507 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.6339 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.5369 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.5839 | Val  Acc: 0.9900
 Site-Product                       | Val  Loss: 0.5049 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9505
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.5093 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 1.0302 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.6627 | Train Acc: 0.9257
 Site-Art                           | Train Loss: 0.3994 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.7696 | Train Acc: 0.9457
 Site-RealWorld                     | Train Loss: 0.2020 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.2156 | Train Acc: 0.9903
Average Train Accuracy: 0.9460
 Site-Clipart                       | Val  Loss: 0.3597 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4087 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9472 | Val  Acc: 0.8776
 Site-Art                           | Val  Loss: 0.6286 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.5047 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5918 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.4546 | Val  Acc: 0.9710
Average Valid Accuracy: 0.9504
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.4402 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.0075 | Train Acc: 0.8431
 Site-Clipart                       | Train Loss: 0.6962 | Train Acc: 0.8919
 Site-Art                           | Train Loss: 0.3832 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.4970 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.1942 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.2267 | Train Acc: 0.9903
Average Train Accuracy: 0.9466
 Site-Clipart                       | Val  Loss: 0.3712 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3967 | Val  Acc: 0.9118
 Site-Clipart                       | Val  Loss: 0.9224 | Val  Acc: 0.8980
 Site-Art                           | Val  Loss: 0.6440 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.5008 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5629 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5098 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9565
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.3917 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.0514 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.6861 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 0.4486 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.4834 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.1860 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2086 | Train Acc: 0.9903
Average Train Accuracy: 0.9357
 Site-Clipart                       | Val  Loss: 0.3326 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.4096 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 0.9482 | Val  Acc: 0.8469
 Site-Art                           | Val  Loss: 0.6493 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 0.5017 | Val  Acc: 0.9882
 Site-RealWorld                     | Val  Loss: 0.5902 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.3692 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9434
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.4495 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 0.9996 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.6496 | Train Acc: 0.8716
 Site-Art                           | Train Loss: 0.3622 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.4633 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.2016 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.1834 | Train Acc: 0.9903
Average Train Accuracy: 0.9334
 Site-Clipart                       | Val  Loss: 0.3462 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.3811 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 0.9248 | Val  Acc: 0.8878
 Site-Art                           | Val  Loss: 0.5778 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.4650 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5553 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.4508 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9498
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.4897 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 0.9895 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.5969 | Train Acc: 0.8986
 Site-Art                           | Train Loss: 0.3873 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 0.8846 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.1852 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.1969 | Train Acc: 0.9903
Average Train Accuracy: 0.9401
 Site-Clipart                       | Val  Loss: 0.3473 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.3992 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 0.9233 | Val  Acc: 0.8673
 Site-Art                           | Val  Loss: 0.5709 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.4746 | Val  Acc: 0.9765
 Site-RealWorld                     | Val  Loss: 0.5559 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.3609 | Val  Acc: 0.9855
Average Valid Accuracy: 0.9412
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.3701 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.0059 | Train Acc: 0.8039
 Site-Clipart                       | Train Loss: 0.5635 | Train Acc: 0.9257
 Site-Art                           | Train Loss: 0.3560 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 0.6588 | Train Acc: 0.9612
 Site-RealWorld                     | Train Loss: 0.1682 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.1872 | Train Acc: 0.9903
Average Train Accuracy: 0.9429
 Site-Clipart                       | Val  Loss: 0.3087 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3795 | Val  Acc: 0.8971
 Site-Clipart                       | Val  Loss: 0.9133 | Val  Acc: 0.9082
 Site-Art                           | Val  Loss: 0.5591 | Val  Acc: 0.9322
 Site-Art                           | Val  Loss: 0.4566 | Val  Acc: 0.9647
 Site-RealWorld                     | Val  Loss: 0.5304 | Val  Acc: 0.9800
 Site-Product                       | Val  Loss: 0.4351 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9423
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.4649 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.0020 | Train Acc: 0.8137
 Site-Clipart                       | Train Loss: 0.7023 | Train Acc: 0.8851
 Site-Art                           | Train Loss: 0.3477 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.8381 | Train Acc: 0.9845
 Site-RealWorld                     | Train Loss: 0.1353 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1580 | Train Acc: 0.9903
Average Train Accuracy: 0.9424
 Site-Clipart                       | Val  Loss: 0.3001 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 0.3713 | Val  Acc: 0.9265
 Site-Clipart                       | Val  Loss: 0.8811 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.5293 | Val  Acc: 0.9661
 Site-Art                           | Val  Loss: 0.4478 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 0.5303 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.4088 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9395
===2023-08-01 22:49:08===
===2023-08-01 22:49:14===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:19 | Test Acc: 0.5149
 Test site-Art                       (0)| Epoch:19 | Test Acc: 0.6522
 Test site-RealWorld                 (3)| Epoch:19 | Test Acc: 0.5952
 Test site-Product                   (3)| Epoch:19 | Test Acc: 0.5522
Clipart: 0.5149, Art: 0.6522, RealWorld: 0.5952, Product: 0.5522, 
Average Test Accuracy(group): 0.5786, Average Test Accuracy(individual): 0.5709,
domain std=0.0511, cluster std=0.0286, individual std=0.0580, 
===2023-08-02 17:31:29===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 20
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[80,138,240,35,105,97,66,
client_nums=[3,2,1,1,]
len_dataset=[766,236,162,111,]
domain number = 4
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 2.1749 | Train Acc: 0.5000
 Site-amazon                        | Train Loss: 2.1816 | Train Acc: 0.5217
 Site-amazon                        | Train Loss: 2.1670 | Train Acc: 0.5208
 Site-webcam                        | Train Loss: 2.1712 | Train Acc: 0.5429
 Site-webcam                        | Train Loss: 2.1620 | Train Acc: 0.5048
 Site-caltech                       | Train Loss: 2.1723 | Train Acc: 0.5258
 Site-dslr                          | Train Loss: 2.0972 | Train Acc: 0.4091
Average Train Accuracy: 0.5036
 Site-amazon                        | Val  Loss: 2.1583 | Val  Acc: 0.5660
 Site-amazon                        | Val  Loss: 2.1566 | Val  Acc: 0.5543
 Site-amazon                        | Val  Loss: 2.1633 | Val  Acc: 0.5062
 Site-webcam                        | Val  Loss: 2.1457 | Val  Acc: 0.6522
 Site-webcam                        | Val  Loss: 2.1582 | Val  Acc: 0.5286
 Site-caltech                       | Val  Loss: 2.1889 | Val  Acc: 0.4688
 Site-dslr                          | Val  Loss: 2.1882 | Val  Acc: 0.3409
Average Valid Accuracy: 0.5167
 Best site-amazon                    | Epoch:0 | Val Acc: 0.5660
 Best site-amazon                    | Epoch:0 | Val Acc: 0.5543
 Best site-amazon                    | Epoch:0 | Val Acc: 0.5062
 Best site-webcam                    | Epoch:0 | Val Acc: 0.6522
 Best site-webcam                    | Epoch:0 | Val Acc: 0.5286
 Best site-caltech                   | Epoch:0 | Val Acc: 0.4688
 Best site-dslr                      | Epoch:0 | Val Acc: 0.3409
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 2.0475 | Train Acc: 0.8250
 Site-amazon                        | Train Loss: 2.0369 | Train Acc: 0.8768
 Site-amazon                        | Train Loss: 2.0377 | Train Acc: 0.8833
 Site-webcam                        | Train Loss: 2.0443 | Train Acc: 0.8286
 Site-webcam                        | Train Loss: 2.0475 | Train Acc: 0.7905
 Site-caltech                       | Train Loss: 2.0538 | Train Acc: 0.7629
 Site-dslr                          | Train Loss: 2.0807 | Train Acc: 0.7424
Average Train Accuracy: 0.8156
 Site-amazon                        | Val  Loss: 2.0464 | Val  Acc: 0.8302
 Site-amazon                        | Val  Loss: 2.0320 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 2.0256 | Val  Acc: 0.8938
 Site-webcam                        | Val  Loss: 2.0443 | Val  Acc: 0.8261
 Site-webcam                        | Val  Loss: 2.0487 | Val  Acc: 0.8000
 Site-caltech                       | Val  Loss: 2.0585 | Val  Acc: 0.8281
 Site-dslr                          | Val  Loss: 2.0768 | Val  Acc: 0.7045
Average Valid Accuracy: 0.8249
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8302
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8913
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8938
 Best site-webcam                    | Epoch:1 | Val Acc: 0.8261
 Best site-webcam                    | Epoch:1 | Val Acc: 0.8000
 Best site-caltech                   | Epoch:1 | Val Acc: 0.8281
 Best site-dslr                      | Epoch:1 | Val Acc: 0.7045
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 1.9394 | Train Acc: 0.8875
 Site-amazon                        | Train Loss: 1.8996 | Train Acc: 0.9493
 Site-amazon                        | Train Loss: 1.9074 | Train Acc: 0.9292
 Site-webcam                        | Train Loss: 1.9413 | Train Acc: 0.8286
 Site-webcam                        | Train Loss: 1.9404 | Train Acc: 0.8857
 Site-caltech                       | Train Loss: 1.9331 | Train Acc: 0.8969
 Site-dslr                          | Train Loss: 1.9079 | Train Acc: 0.8939
Average Train Accuracy: 0.8959
 Site-amazon                        | Val  Loss: 1.9221 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.8996 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.9033 | Val  Acc: 0.9375
 Site-webcam                        | Val  Loss: 1.9295 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 1.9234 | Val  Acc: 0.9143
 Site-caltech                       | Val  Loss: 1.9268 | Val  Acc: 0.9062
 Site-dslr                          | Val  Loss: 1.9609 | Val  Acc: 0.9091
Average Valid Accuracy: 0.9106
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9245
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9375
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8696
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9143
 Best site-caltech                   | Epoch:2 | Val Acc: 0.9062
 Best site-dslr                      | Epoch:2 | Val Acc: 0.9091
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 1.7917 | Train Acc: 0.9125
 Site-amazon                        | Train Loss: 1.7558 | Train Acc: 0.9565
 Site-amazon                        | Train Loss: 1.7847 | Train Acc: 0.9458
 Site-webcam                        | Train Loss: 1.8179 | Train Acc: 0.8857
 Site-webcam                        | Train Loss: 1.8278 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 1.8072 | Train Acc: 0.9278
 Site-dslr                          | Train Loss: 1.7921 | Train Acc: 0.9242
Average Train Accuracy: 0.9293
 Site-amazon                        | Val  Loss: 1.8013 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.7983 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 1.7824 | Val  Acc: 0.9375
 Site-webcam                        | Val  Loss: 1.8112 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.8253 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 1.8235 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 1.8500 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9407
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9245
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8913
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9375
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9571
 Best site-caltech                   | Epoch:3 | Val Acc: 0.9844
 Best site-dslr                      | Epoch:3 | Val Acc: 0.9773
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 1.6912 | Train Acc: 0.9375
 Site-amazon                        | Train Loss: 1.6358 | Train Acc: 0.9638
 Site-amazon                        | Train Loss: 1.6732 | Train Acc: 0.9542
 Site-webcam                        | Train Loss: 1.7141 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 1.7139 | Train Acc: 0.9619
 Site-caltech                       | Train Loss: 1.7026 | Train Acc: 0.9381
 Site-dslr                          | Train Loss: 1.6567 | Train Acc: 0.9697
Average Train Accuracy: 0.9485
 Site-amazon                        | Val  Loss: 1.6777 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.6695 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.6510 | Val  Acc: 0.9563
 Site-webcam                        | Val  Loss: 1.7242 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 1.7211 | Val  Acc: 0.9143
 Site-caltech                       | Val  Loss: 1.6918 | Val  Acc: 0.9375
 Site-dslr                          | Val  Loss: 1.7434 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9242
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 1.5311 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.5333 | Train Acc: 0.9565
 Site-amazon                        | Train Loss: 1.5470 | Train Acc: 0.9667
 Site-webcam                        | Train Loss: 1.6206 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 1.6059 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.5726 | Train Acc: 0.9485
 Site-dslr                          | Train Loss: 1.5401 | Train Acc: 0.9545
Average Train Accuracy: 0.9503
 Site-amazon                        | Val  Loss: 1.5612 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 1.5479 | Val  Acc: 0.9457
 Site-amazon                        | Val  Loss: 1.5559 | Val  Acc: 0.9313
 Site-webcam                        | Val  Loss: 1.6206 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.6018 | Val  Acc: 0.9429
 Site-caltech                       | Val  Loss: 1.5961 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 1.6326 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9611
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9457
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9313
 Best site-webcam                    | Epoch:5 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:5 | Val Acc: 0.9429
 Best site-caltech                   | Epoch:5 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:5 | Val Acc: 0.9773
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 1.4623 | Train Acc: 0.9375
 Site-amazon                        | Train Loss: 1.4051 | Train Acc: 0.9638
 Site-amazon                        | Train Loss: 1.4420 | Train Acc: 0.9583
 Site-webcam                        | Train Loss: 1.4886 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 1.5079 | Train Acc: 0.9619
 Site-caltech                       | Train Loss: 1.4702 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 1.4202 | Train Acc: 0.9242
Average Train Accuracy: 0.9496
 Site-amazon                        | Val  Loss: 1.4348 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 1.4481 | Val  Acc: 0.9239
 Site-amazon                        | Val  Loss: 1.4345 | Val  Acc: 0.9625
 Site-webcam                        | Val  Loss: 1.5239 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 1.5140 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 1.4986 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 1.5485 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9633
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9811
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9239
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9625
 Best site-webcam                    | Epoch:6 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:6 | Val Acc: 0.9571
 Best site-caltech                   | Epoch:6 | Val Acc: 0.9844
 Best site-dslr                      | Epoch:6 | Val Acc: 0.9773
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 1.4002 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.3178 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 1.3360 | Train Acc: 0.9542
 Site-webcam                        | Train Loss: 1.4234 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 1.4173 | Train Acc: 0.9714
 Site-caltech                       | Train Loss: 1.3830 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 1.2967 | Train Acc: 0.9394
Average Train Accuracy: 0.9567
 Site-amazon                        | Val  Loss: 1.3459 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 1.3348 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.3382 | Val  Acc: 0.9375
 Site-webcam                        | Val  Loss: 1.4199 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 1.4357 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 1.3883 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 1.4127 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9563
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 1.2256 | Train Acc: 0.9250
 Site-amazon                        | Train Loss: 1.1807 | Train Acc: 0.9638
 Site-amazon                        | Train Loss: 1.2278 | Train Acc: 0.9625
 Site-webcam                        | Train Loss: 1.3233 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 1.3237 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 1.2849 | Train Acc: 0.9691
 Site-dslr                          | Train Loss: 1.3957 | Train Acc: 0.9545
Average Train Accuracy: 0.9529
 Site-amazon                        | Val  Loss: 1.2411 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 1.2477 | Val  Acc: 0.9457
 Site-amazon                        | Val  Loss: 1.2288 | Val  Acc: 0.9500
 Site-webcam                        | Val  Loss: 1.3505 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.3135 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 1.2935 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 1.3499 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9502
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 1.1335 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.0827 | Train Acc: 0.9855
 Site-amazon                        | Train Loss: 1.1503 | Train Acc: 0.9417
 Site-webcam                        | Train Loss: 1.2651 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 1.2177 | Train Acc: 0.9619
 Site-caltech                       | Train Loss: 1.1972 | Train Acc: 0.9691
 Site-dslr                          | Train Loss: 1.2824 | Train Acc: 0.9545
Average Train Accuracy: 0.9579
 Site-amazon                        | Val  Loss: 1.1433 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 1.1446 | Val  Acc: 0.9239
 Site-amazon                        | Val  Loss: 1.1234 | Val  Acc: 0.9500
 Site-webcam                        | Val  Loss: 1.2007 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.2178 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 1.1947 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 1.2666 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9655
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9811
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9239
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9500
 Best site-webcam                    | Epoch:9 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9571
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:9 | Val Acc: 0.9773
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 10 ============
 Site-amazon                        | Train Loss: 1.1596 | Train Acc: 0.9250
 Site-amazon                        | Train Loss: 1.0266 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 1.0428 | Train Acc: 0.9667
 Site-webcam                        | Train Loss: 1.1396 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 1.1511 | Train Acc: 0.9429
 Site-caltech                       | Train Loss: 1.1123 | Train Acc: 0.9794
 Site-dslr                          | Train Loss: 1.3965 | Train Acc: 0.9697
Average Train Accuracy: 0.9578
 Site-amazon                        | Val  Loss: 1.0928 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 1.0490 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.0594 | Val  Acc: 0.9500
 Site-webcam                        | Val  Loss: 1.1888 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.1885 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 1.0907 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 1.2096 | Val  Acc: 0.9545
Average Valid Accuracy: 0.9540
============ Train epoch 11 ============
 Site-amazon                        | Train Loss: 0.9906 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.9688 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 0.9667 | Train Acc: 0.9583
 Site-webcam                        | Train Loss: 1.0996 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 1.0657 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 1.0043 | Train Acc: 0.9897
 Site-dslr                          | Train Loss: 1.1874 | Train Acc: 0.9394
Average Train Accuracy: 0.9587
 Site-amazon                        | Val  Loss: 1.0071 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.9914 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 0.9714 | Val  Acc: 0.9313
 Site-webcam                        | Val  Loss: 1.0435 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.1279 | Val  Acc: 0.9429
 Site-caltech                       | Val  Loss: 1.0404 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 1.0667 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9623
============ Train epoch 12 ============
 Site-amazon                        | Train Loss: 0.9658 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.8279 | Train Acc: 0.9855
 Site-amazon                        | Train Loss: 0.8870 | Train Acc: 0.9667
 Site-webcam                        | Train Loss: 1.0487 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 1.0127 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 0.9059 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.9612 | Train Acc: 0.9545
Average Train Accuracy: 0.9605
 Site-amazon                        | Val  Loss: 0.9120 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.9034 | Val  Acc: 0.9239
 Site-amazon                        | Val  Loss: 0.8821 | Val  Acc: 0.9500
 Site-webcam                        | Val  Loss: 1.0339 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.9747 | Val  Acc: 0.9429
 Site-caltech                       | Val  Loss: 0.9368 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 1.0056 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9605
============ Train epoch 13 ============
 Site-amazon                        | Train Loss: 0.8702 | Train Acc: 0.9375
 Site-amazon                        | Train Loss: 0.7222 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 0.8216 | Train Acc: 0.9708
 Site-webcam                        | Train Loss: 0.9492 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.9177 | Train Acc: 0.9619
 Site-caltech                       | Train Loss: 0.8828 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.9674 | Train Acc: 0.9545
Average Train Accuracy: 0.9578
 Site-amazon                        | Val  Loss: 0.8330 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.8438 | Val  Acc: 0.9457
 Site-amazon                        | Val  Loss: 0.8194 | Val  Acc: 0.9437
 Site-webcam                        | Val  Loss: 0.9361 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.9784 | Val  Acc: 0.9143
 Site-caltech                       | Val  Loss: 0.8688 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.9294 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9616
============ Train epoch 14 ============
 Site-amazon                        | Train Loss: 0.7243 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.7776 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 0.7542 | Train Acc: 0.9583
 Site-webcam                        | Train Loss: 0.8754 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 0.8545 | Train Acc: 0.9810
 Site-caltech                       | Train Loss: 0.8014 | Train Acc: 0.9794
 Site-dslr                          | Train Loss: 0.9999 | Train Acc: 0.9545
Average Train Accuracy: 0.9594
 Site-amazon                        | Val  Loss: 0.7741 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.7683 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 0.7363 | Val  Acc: 0.9688
 Site-webcam                        | Val  Loss: 0.8887 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.8706 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 0.7956 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.8670 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9667
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9811
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9348
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9688
 Best site-webcam                    | Epoch:14 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:14 | Val Acc: 0.9571
 Best site-caltech                   | Epoch:14 | Val Acc: 0.9688
 Best site-dslr                      | Epoch:14 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 15 ============
 Site-amazon                        | Train Loss: 0.7343 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.6562 | Train Acc: 0.9710
 Site-amazon                        | Train Loss: 0.6908 | Train Acc: 0.9667
 Site-webcam                        | Train Loss: 0.8217 | Train Acc: 0.9714
 Site-webcam                        | Train Loss: 0.7853 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.7114 | Train Acc: 0.9794
 Site-dslr                          | Train Loss: 0.9469 | Train Acc: 0.9545
Average Train Accuracy: 0.9704
 Site-amazon                        | Val  Loss: 0.7149 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.7316 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 0.6952 | Val  Acc: 0.9500
 Site-webcam                        | Val  Loss: 0.7718 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.8184 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 0.7358 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.8067 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9609
============ Train epoch 16 ============
 Site-amazon                        | Train Loss: 0.6307 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.6018 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 0.6195 | Train Acc: 0.9625
 Site-webcam                        | Train Loss: 0.7616 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.7613 | Train Acc: 0.9810
 Site-caltech                       | Train Loss: 0.6810 | Train Acc: 0.9691
 Site-dslr                          | Train Loss: 0.6095 | Train Acc: 0.9394
Average Train Accuracy: 0.9604
 Site-amazon                        | Val  Loss: 0.6702 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.6617 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.6300 | Val  Acc: 0.9500
 Site-webcam                        | Val  Loss: 0.7572 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.8074 | Val  Acc: 0.9571
 Site-caltech                       | Val  Loss: 0.6725 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.7892 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9697
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9500
 Best site-webcam                    | Epoch:16 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:16 | Val Acc: 0.9571
 Best site-caltech                   | Epoch:16 | Val Acc: 0.9844
 Best site-dslr                      | Epoch:16 | Val Acc: 0.9773
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/fedavg...
============ Train epoch 17 ============
 Site-amazon                        | Train Loss: 0.5478 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.5201 | Train Acc: 0.9855
 Site-amazon                        | Train Loss: 0.5875 | Train Acc: 0.9625
 Site-webcam                        | Train Loss: 0.7527 | Train Acc: 0.9143
 Site-webcam                        | Train Loss: 0.7591 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.6232 | Train Acc: 0.9691
 Site-dslr                          | Train Loss: 0.8993 | Train Acc: 0.9545
Average Train Accuracy: 0.9545
 Site-amazon                        | Val  Loss: 0.5776 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.6241 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 0.5759 | Val  Acc: 0.9625
 Site-webcam                        | Val  Loss: 0.7799 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.7173 | Val  Acc: 0.9714
 Site-caltech                       | Val  Loss: 0.6241 | Val  Acc: 0.9844
 Site-dslr                          | Val  Loss: 0.7237 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9642
============ Train epoch 18 ============
 Site-amazon                        | Train Loss: 0.5793 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.4524 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 0.5420 | Train Acc: 0.9625
 Site-webcam                        | Train Loss: 0.7061 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.6360 | Train Acc: 0.9810
 Site-caltech                       | Train Loss: 0.5482 | Train Acc: 0.9691
 Site-dslr                          | Train Loss: 1.0245 | Train Acc: 0.9545
Average Train Accuracy: 0.9644
 Site-amazon                        | Val  Loss: 0.5844 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.5751 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.5231 | Val  Acc: 0.9563
 Site-webcam                        | Val  Loss: 0.6631 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.6257 | Val  Acc: 0.9857
 Site-caltech                       | Val  Loss: 0.5723 | Val  Acc: 0.9688
 Site-dslr                          | Val  Loss: 0.6666 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9662
============ Train epoch 19 ============
 Site-amazon                        | Train Loss: 0.5273 | Train Acc: 0.9625
 Site-amazon                        | Train Loss: 0.4253 | Train Acc: 0.9783
 Site-amazon                        | Train Loss: 0.4879 | Train Acc: 0.9708
 Site-webcam                        | Train Loss: 0.6691 | Train Acc: 0.9429
 Site-webcam                        | Train Loss: 0.6115 | Train Acc: 0.9714
 Site-caltech                       | Train Loss: 0.5497 | Train Acc: 0.9794
 Site-dslr                          | Train Loss: 0.4722 | Train Acc: 0.9697
Average Train Accuracy: 0.9679
 Site-amazon                        | Val  Loss: 0.5211 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.5106 | Val  Acc: 0.9457
 Site-amazon                        | Val  Loss: 0.4921 | Val  Acc: 0.9688
 Site-webcam                        | Val  Loss: 0.6364 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.6280 | Val  Acc: 0.9714
 Site-caltech                       | Val  Loss: 0.5376 | Val  Acc: 0.9531
 Site-dslr                          | Val  Loss: 0.6428 | Val  Acc: 0.9773
Average Valid Accuracy: 0.9594
===2023-08-02 17:39:04===
===2023-08-02 17:39:07===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[80,138,240,35,105,97,66,
client_nums=[3,2,1,1,]
len_dataset=[766,236,162,111,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (1)| Epoch:16 | Test Acc: 0.9583
 Test site-webcam                    (0)| Epoch:16 | Test Acc: 0.9492
 Test site-caltech                   (3)| Epoch:16 | Test Acc: 0.9644
 Test site-dslr                      (2)| Epoch:16 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9492, caltech: 0.9644, dslr: 1.0000, 
Average Test Accuracy(group): 0.9680, Average Test Accuracy(individual): 0.9625,
domain std=0.0193, cluster std=0.0193, individual std=0.0161, 
