===2023-08-02 00:11:11===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
============ Train epoch 0 ============
denominator: 17790.90625
 Site-Clipart                       | Train Loss: 2.2626 | Train Acc: 0.2143
 Site-Clipart                       | Train Loss: 2.1877 | Train Acc: 0.4412
 Site-Clipart                       | Train Loss: 2.2626 | Train Acc: 0.1149
 Site-Art                           | Train Loss: 2.2374 | Train Acc: 0.2955
 Site-Art                           | Train Loss: 2.2786 | Train Acc: 0.1085
 Site-RealWorld                     | Train Loss: 2.2133 | Train Acc: 0.3533
 Site-Product                       | Train Loss: 2.2150 | Train Acc: 0.3495
Average Train Accuracy: 0.2682
 Site-Clipart                       | Val  Loss: 2.2645 | Val  Acc: 0.0638
 Site-Clipart                       | Val  Loss: 2.2382 | Val  Acc: 0.1176
 Site-Clipart                       | Val  Loss: 2.1851 | Val  Acc: 0.4388
 Site-Art                           | Val  Loss: 2.2876 | Val  Acc: 0.0508
 Site-Art                           | Val  Loss: 2.2568 | Val  Acc: 0.1176
 Site-RealWorld                     | Val  Loss: 2.2290 | Val  Acc: 0.3700
 Site-Product                       | Val  Loss: 2.1800 | Val  Acc: 0.4058
Average Valid Accuracy: 0.2235
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.0638
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.1176
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4388
 Best site-Art                       | Epoch:0 | Val Acc: 0.0508
 Best site-Art                       | Epoch:0 | Val Acc: 0.1176
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.3700
 Best site-Product                   | Epoch:0 | Val Acc: 0.4058
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 1 ============
denominator: 17426.40625
 Site-Clipart                       | Train Loss: 2.2013 | Train Acc: 0.3714
 Site-Clipart                       | Train Loss: 2.1374 | Train Acc: 0.5490
 Site-Clipart                       | Train Loss: 2.2161 | Train Acc: 0.2230
 Site-Art                           | Train Loss: 2.1576 | Train Acc: 0.5227
 Site-Art                           | Train Loss: 2.2606 | Train Acc: 0.1783
 Site-RealWorld                     | Train Loss: 2.1404 | Train Acc: 0.7733
 Site-Product                       | Train Loss: 2.1308 | Train Acc: 0.8350
Average Train Accuracy: 0.4932
 Site-Clipart                       | Val  Loss: 2.2124 | Val  Acc: 0.2128
 Site-Clipart                       | Val  Loss: 2.1821 | Val  Acc: 0.2941
 Site-Clipart                       | Val  Loss: 2.1553 | Val  Acc: 0.5102
 Site-Art                           | Val  Loss: 2.2529 | Val  Acc: 0.2034
 Site-Art                           | Val  Loss: 2.2178 | Val  Acc: 0.2824
 Site-RealWorld                     | Val  Loss: 2.1842 | Val  Acc: 0.5400
 Site-Product                       | Val  Loss: 2.1166 | Val  Acc: 0.7101
Average Valid Accuracy: 0.3933
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.2128
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.2941
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5102
 Best site-Art                       | Epoch:1 | Val Acc: 0.2034
 Best site-Art                       | Epoch:1 | Val Acc: 0.2824
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.5400
 Best site-Product                   | Epoch:1 | Val Acc: 0.7101
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 2 ============
denominator: 16922.03515625
 Site-Clipart                       | Train Loss: 2.0822 | Train Acc: 0.5429
 Site-Clipart                       | Train Loss: 2.1109 | Train Acc: 0.5686
 Site-Clipart                       | Train Loss: 2.1781 | Train Acc: 0.3784
 Site-Art                           | Train Loss: 2.0951 | Train Acc: 0.6818
 Site-Art                           | Train Loss: 2.2080 | Train Acc: 0.3566
 Site-RealWorld                     | Train Loss: 2.0381 | Train Acc: 0.8933
 Site-Product                       | Train Loss: 2.0567 | Train Acc: 0.8835
Average Train Accuracy: 0.6150
 Site-Clipart                       | Val  Loss: 2.1542 | Val  Acc: 0.5319
 Site-Clipart                       | Val  Loss: 2.1278 | Val  Acc: 0.4853
 Site-Clipart                       | Val  Loss: 2.1287 | Val  Acc: 0.6122
 Site-Art                           | Val  Loss: 2.1966 | Val  Acc: 0.3390
 Site-Art                           | Val  Loss: 2.1538 | Val  Acc: 0.4118
 Site-RealWorld                     | Val  Loss: 2.1275 | Val  Acc: 0.6300
 Site-Product                       | Val  Loss: 2.0628 | Val  Acc: 0.8261
Average Valid Accuracy: 0.5480
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.5319
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.4853
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6122
 Best site-Art                       | Epoch:2 | Val Acc: 0.3390
 Best site-Art                       | Epoch:2 | Val Acc: 0.4118
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6300
 Best site-Product                   | Epoch:2 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 3 ============
denominator: 16545.65625
 Site-Clipart                       | Train Loss: 1.9864 | Train Acc: 0.7857
 Site-Clipart                       | Train Loss: 2.0566 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 2.1496 | Train Acc: 0.4932
 Site-Art                           | Train Loss: 2.0221 | Train Acc: 0.7727
 Site-Art                           | Train Loss: 2.1132 | Train Acc: 0.4496
 Site-RealWorld                     | Train Loss: 1.9698 | Train Acc: 0.9133
 Site-Product                       | Train Loss: 1.9804 | Train Acc: 0.9515
Average Train Accuracy: 0.7246
 Site-Clipart                       | Val  Loss: 2.1005 | Val  Acc: 0.6383
 Site-Clipart                       | Val  Loss: 2.0793 | Val  Acc: 0.6912
 Site-Clipart                       | Val  Loss: 2.0829 | Val  Acc: 0.6837
 Site-Art                           | Val  Loss: 2.1596 | Val  Acc: 0.5593
 Site-Art                           | Val  Loss: 2.1181 | Val  Acc: 0.5529
 Site-RealWorld                     | Val  Loss: 2.0638 | Val  Acc: 0.7100
 Site-Product                       | Val  Loss: 1.9855 | Val  Acc: 0.8406
Average Valid Accuracy: 0.6680
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6383
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6912
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6837
 Best site-Art                       | Epoch:3 | Val Acc: 0.5593
 Best site-Art                       | Epoch:3 | Val Acc: 0.5529
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7100
 Best site-Product                   | Epoch:3 | Val Acc: 0.8406
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 4 ============
denominator: 16198.3515625
 Site-Clipart                       | Train Loss: 1.9416 | Train Acc: 0.7571
 Site-Clipart                       | Train Loss: 2.0266 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 2.1053 | Train Acc: 0.5270
 Site-Art                           | Train Loss: 1.9562 | Train Acc: 0.8523
 Site-Art                           | Train Loss: 2.1410 | Train Acc: 0.5504
 Site-RealWorld                     | Train Loss: 1.9003 | Train Acc: 0.9267
 Site-Product                       | Train Loss: 1.9010 | Train Acc: 0.9612
Average Train Accuracy: 0.7586
 Site-Clipart                       | Val  Loss: 2.0526 | Val  Acc: 0.7447
 Site-Clipart                       | Val  Loss: 2.0440 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 2.0454 | Val  Acc: 0.6939
 Site-Art                           | Val  Loss: 2.1279 | Val  Acc: 0.5254
 Site-Art                           | Val  Loss: 2.0737 | Val  Acc: 0.6000
 Site-RealWorld                     | Val  Loss: 2.0187 | Val  Acc: 0.7600
 Site-Product                       | Val  Loss: 1.9301 | Val  Acc: 0.8551
Average Valid Accuracy: 0.7042
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7447
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.6939
 Best site-Art                       | Epoch:4 | Val Acc: 0.5254
 Best site-Art                       | Epoch:4 | Val Acc: 0.6000
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.7600
 Best site-Product                   | Epoch:4 | Val Acc: 0.8551
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 5 ============
denominator: 15701.333984375
 Site-Clipart                       | Train Loss: 1.8508 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 1.9930 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 2.0683 | Train Acc: 0.5811
 Site-Art                           | Train Loss: 1.9051 | Train Acc: 0.8864
 Site-Art                           | Train Loss: 2.0885 | Train Acc: 0.5814
 Site-RealWorld                     | Train Loss: 1.8197 | Train Acc: 0.9600
 Site-Product                       | Train Loss: 1.8216 | Train Acc: 0.9806
Average Train Accuracy: 0.8057
 Site-Clipart                       | Val  Loss: 2.0004 | Val  Acc: 0.7660
 Site-Clipart                       | Val  Loss: 1.9844 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 2.0023 | Val  Acc: 0.7347
 Site-Art                           | Val  Loss: 2.0840 | Val  Acc: 0.5593
 Site-Art                           | Val  Loss: 2.0316 | Val  Acc: 0.6235
 Site-RealWorld                     | Val  Loss: 1.9732 | Val  Acc: 0.7600
 Site-Product                       | Val  Loss: 1.8846 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7296
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7660
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7941
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7347
 Best site-Art                       | Epoch:5 | Val Acc: 0.5593
 Best site-Art                       | Epoch:5 | Val Acc: 0.6235
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7600
 Best site-Product                   | Epoch:5 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 6 ============
denominator: 15300.736328125
 Site-Clipart                       | Train Loss: 1.8228 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.9520 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 2.0230 | Train Acc: 0.5811
 Site-Art                           | Train Loss: 1.8324 | Train Acc: 0.8636
 Site-Art                           | Train Loss: 1.9873 | Train Acc: 0.6589
 Site-RealWorld                     | Train Loss: 1.7399 | Train Acc: 0.9667
 Site-Product                       | Train Loss: 1.7691 | Train Acc: 0.9709
Average Train Accuracy: 0.8116
 Site-Clipart                       | Val  Loss: 1.9553 | Val  Acc: 0.8298
 Site-Clipart                       | Val  Loss: 1.9394 | Val  Acc: 0.7794
 Site-Clipart                       | Val  Loss: 1.9738 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 2.0492 | Val  Acc: 0.6441
 Site-Art                           | Val  Loss: 1.9731 | Val  Acc: 0.7294
 Site-RealWorld                     | Val  Loss: 1.9328 | Val  Acc: 0.7700
 Site-Product                       | Val  Loss: 1.8294 | Val  Acc: 0.9275
Average Valid Accuracy: 0.7823
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8298
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7794
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7959
 Best site-Art                       | Epoch:6 | Val Acc: 0.6441
 Best site-Art                       | Epoch:6 | Val Acc: 0.7294
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7700
 Best site-Product                   | Epoch:6 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 7 ============
denominator: 15000.1005859375
 Site-Clipart                       | Train Loss: 1.7366 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 1.9238 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.9908 | Train Acc: 0.6149
 Site-Art                           | Train Loss: 1.7728 | Train Acc: 0.8977
 Site-Art                           | Train Loss: 1.9098 | Train Acc: 0.6899
 Site-RealWorld                     | Train Loss: 1.6918 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.6898 | Train Acc: 0.9709
Average Train Accuracy: 0.8259
 Site-Clipart                       | Val  Loss: 1.9102 | Val  Acc: 0.8085
 Site-Clipart                       | Val  Loss: 1.8908 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.9457 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 2.0084 | Val  Acc: 0.6780
 Site-Art                           | Val  Loss: 1.9495 | Val  Acc: 0.7529
 Site-RealWorld                     | Val  Loss: 1.8944 | Val  Acc: 0.7700
 Site-Product                       | Val  Loss: 1.7741 | Val  Acc: 0.9275
Average Valid Accuracy: 0.7917
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8085
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8088
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7959
 Best site-Art                       | Epoch:7 | Val Acc: 0.6780
 Best site-Art                       | Epoch:7 | Val Acc: 0.7529
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.7700
 Best site-Product                   | Epoch:7 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 8 ============
denominator: 14641.3564453125
 Site-Clipart                       | Train Loss: 1.6927 | Train Acc: 0.8857
 Site-Clipart                       | Train Loss: 1.8989 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.9570 | Train Acc: 0.6554
 Site-Art                           | Train Loss: 1.7097 | Train Acc: 0.9205
 Site-Art                           | Train Loss: 1.9920 | Train Acc: 0.7364
 Site-RealWorld                     | Train Loss: 1.6133 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.6348 | Train Acc: 0.9612
Average Train Accuracy: 0.8360
 Site-Clipart                       | Val  Loss: 1.8591 | Val  Acc: 0.8085
 Site-Clipart                       | Val  Loss: 1.8494 | Val  Acc: 0.7353
 Site-Clipart                       | Val  Loss: 1.9098 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 1.9808 | Val  Acc: 0.6780
 Site-Art                           | Val  Loss: 1.9050 | Val  Acc: 0.8118
 Site-RealWorld                     | Val  Loss: 1.8252 | Val  Acc: 0.8000
 Site-Product                       | Val  Loss: 1.7278 | Val  Acc: 0.9275
Average Valid Accuracy: 0.7939
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8085
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7353
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7959
 Best site-Art                       | Epoch:8 | Val Acc: 0.6780
 Best site-Art                       | Epoch:8 | Val Acc: 0.8118
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8000
 Best site-Product                   | Epoch:8 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 9 ============
denominator: 14222.484375
 Site-Clipart                       | Train Loss: 1.6351 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.8542 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.9299 | Train Acc: 0.6149
 Site-Art                           | Train Loss: 1.6629 | Train Acc: 0.8977
 Site-Art                           | Train Loss: 1.9108 | Train Acc: 0.7364
 Site-RealWorld                     | Train Loss: 1.5447 | Train Acc: 0.9600
 Site-Product                       | Train Loss: 1.5801 | Train Acc: 0.9709
Average Train Accuracy: 0.8286
 Site-Clipart                       | Val  Loss: 1.8315 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.8122 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.8779 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.9526 | Val  Acc: 0.6441
 Site-Art                           | Val  Loss: 1.8658 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.7935 | Val  Acc: 0.8300
 Site-Product                       | Val  Loss: 1.6751 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8048
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8723
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8088
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.7653
 Best site-Art                       | Epoch:9 | Val Acc: 0.6441
 Best site-Art                       | Epoch:9 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8300
 Best site-Product                   | Epoch:9 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 10 ============
denominator: 13901.7333984375
 Site-Clipart                       | Train Loss: 1.5318 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.8316 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 1.9142 | Train Acc: 0.6284
 Site-Art                           | Train Loss: 1.5849 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.9174 | Train Acc: 0.7752
 Site-RealWorld                     | Train Loss: 1.4850 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.5108 | Train Acc: 0.9612
Average Train Accuracy: 0.8553
 Site-Clipart                       | Val  Loss: 1.7995 | Val  Acc: 0.8511
 Site-Clipart                       | Val  Loss: 1.7669 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.8369 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 1.9109 | Val  Acc: 0.7288
 Site-Art                           | Val  Loss: 1.8248 | Val  Acc: 0.7882
 Site-RealWorld                     | Val  Loss: 1.7439 | Val  Acc: 0.8200
 Site-Product                       | Val  Loss: 1.6016 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8166
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8511
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7941
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8061
 Best site-Art                       | Epoch:10 | Val Acc: 0.7288
 Best site-Art                       | Epoch:10 | Val Acc: 0.7882
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8200
 Best site-Product                   | Epoch:10 | Val Acc: 0.9275
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 11 ============
denominator: 13532.5087890625
 Site-Clipart                       | Train Loss: 1.5583 | Train Acc: 0.9143
 Site-Clipart                       | Train Loss: 1.7874 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 1.8908 | Train Acc: 0.6689
 Site-Art                           | Train Loss: 1.5200 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.9265 | Train Acc: 0.8217
 Site-RealWorld                     | Train Loss: 1.4039 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.4612 | Train Acc: 0.9806
Average Train Accuracy: 0.8690
 Site-Clipart                       | Val  Loss: 1.7430 | Val  Acc: 0.8511
 Site-Clipart                       | Val  Loss: 1.7090 | Val  Acc: 0.8382
 Site-Clipart                       | Val  Loss: 1.8384 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.8880 | Val  Acc: 0.7458
 Site-Art                           | Val  Loss: 1.7930 | Val  Acc: 0.8353
 Site-RealWorld                     | Val  Loss: 1.7127 | Val  Acc: 0.8600
 Site-Product                       | Val  Loss: 1.5782 | Val  Acc: 0.9420
Average Valid Accuracy: 0.8340
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8511
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8382
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.7653
 Best site-Art                       | Epoch:11 | Val Acc: 0.7458
 Best site-Art                       | Epoch:11 | Val Acc: 0.8353
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8600
 Best site-Product                   | Epoch:11 | Val Acc: 0.9420
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 12 ============
denominator: 13137.9013671875
 Site-Clipart                       | Train Loss: 1.4701 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.7763 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.8419 | Train Acc: 0.6149
 Site-Art                           | Train Loss: 1.5074 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.7444 | Train Acc: 0.7674
 Site-RealWorld                     | Train Loss: 1.3760 | Train Acc: 0.9667
 Site-Product                       | Train Loss: 1.3947 | Train Acc: 0.9903
Average Train Accuracy: 0.8521
 Site-Clipart                       | Val  Loss: 1.7113 | Val  Acc: 0.8511
 Site-Clipart                       | Val  Loss: 1.6961 | Val  Acc: 0.8235
 Site-Clipart                       | Val  Loss: 1.7939 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 1.8507 | Val  Acc: 0.7458
 Site-Art                           | Val  Loss: 1.7512 | Val  Acc: 0.8471
 Site-RealWorld                     | Val  Loss: 1.6713 | Val  Acc: 0.8400
 Site-Product                       | Val  Loss: 1.5490 | Val  Acc: 0.9275
Average Valid Accuracy: 0.8330
============ Train epoch 13 ============
denominator: 12920.5380859375
 Site-Clipart                       | Train Loss: 1.4546 | Train Acc: 0.9286
 Site-Clipart                       | Train Loss: 1.7342 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.8105 | Train Acc: 0.6892
 Site-Art                           | Train Loss: 1.4401 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.9441 | Train Acc: 0.7984
 Site-RealWorld                     | Train Loss: 1.3155 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.3441 | Train Acc: 0.9806
Average Train Accuracy: 0.8650
 Site-Clipart                       | Val  Loss: 1.6840 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.6739 | Val  Acc: 0.7794
 Site-Clipart                       | Val  Loss: 1.7636 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.8279 | Val  Acc: 0.7797
 Site-Art                           | Val  Loss: 1.7236 | Val  Acc: 0.8353
 Site-RealWorld                     | Val  Loss: 1.6433 | Val  Acc: 0.8600
 Site-Product                       | Val  Loss: 1.4943 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8355
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8723
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.7794
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.7653
 Best site-Art                       | Epoch:13 | Val Acc: 0.7797
 Best site-Art                       | Epoch:13 | Val Acc: 0.8353
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8600
 Best site-Product                   | Epoch:13 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 14 ============
denominator: 12842.4677734375
 Site-Clipart                       | Train Loss: 1.4326 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.7064 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.8104 | Train Acc: 0.6554
 Site-Art                           | Train Loss: 1.3677 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.7265 | Train Acc: 0.8062
 Site-RealWorld                     | Train Loss: 1.2701 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.2861 | Train Acc: 0.9806
Average Train Accuracy: 0.8664
 Site-Clipart                       | Val  Loss: 1.6274 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 1.6094 | Val  Acc: 0.8529
 Site-Clipart                       | Val  Loss: 1.7467 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 1.7870 | Val  Acc: 0.7966
 Site-Art                           | Val  Loss: 1.6753 | Val  Acc: 0.9176
 Site-RealWorld                     | Val  Loss: 1.6011 | Val  Acc: 0.9100
 Site-Product                       | Val  Loss: 1.4165 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8652
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8936
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8529
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.7143
 Best site-Art                       | Epoch:14 | Val Acc: 0.7966
 Best site-Art                       | Epoch:14 | Val Acc: 0.9176
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9100
 Best site-Product                   | Epoch:14 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 15 ============
denominator: 12623.3408203125
 Site-Clipart                       | Train Loss: 1.3367 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.6826 | Train Acc: 0.7549
 Site-Clipart                       | Train Loss: 1.7466 | Train Acc: 0.7162
 Site-Art                           | Train Loss: 1.3836 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.7147 | Train Acc: 0.8217
 Site-RealWorld                     | Train Loss: 1.2162 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 1.2370 | Train Acc: 1.0000
Average Train Accuracy: 0.8828
 Site-Clipart                       | Val  Loss: 1.5987 | Val  Acc: 0.8511
 Site-Clipart                       | Val  Loss: 1.5779 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.7188 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 1.7755 | Val  Acc: 0.7797
 Site-Art                           | Val  Loss: 1.6564 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 1.5712 | Val  Acc: 0.8500
 Site-Product                       | Val  Loss: 1.3811 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8517
============ Train epoch 16 ============
denominator: 12243.0537109375
 Site-Clipart                       | Train Loss: 1.2564 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.6716 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 1.7351 | Train Acc: 0.6892
 Site-Art                           | Train Loss: 1.3170 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.7964 | Train Acc: 0.8062
 Site-RealWorld                     | Train Loss: 1.1837 | Train Acc: 0.9733
 Site-Product                       | Train Loss: 1.2087 | Train Acc: 0.9903
Average Train Accuracy: 0.8658
 Site-Clipart                       | Val  Loss: 1.5583 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 1.5266 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.6927 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 1.7377 | Val  Acc: 0.7966
 Site-Art                           | Val  Loss: 1.6304 | Val  Acc: 0.9294
 Site-RealWorld                     | Val  Loss: 1.5491 | Val  Acc: 0.9200
 Site-Product                       | Val  Loss: 1.4201 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8841
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8936
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.7959
 Best site-Art                       | Epoch:16 | Val Acc: 0.7966
 Best site-Art                       | Epoch:16 | Val Acc: 0.9294
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9200
 Best site-Product                   | Epoch:16 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 17 ============
denominator: 11896.119140625
 Site-Clipart                       | Train Loss: 1.2584 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.6372 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.7302 | Train Acc: 0.6757
 Site-Art                           | Train Loss: 1.2951 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.6187 | Train Acc: 0.8295
 Site-RealWorld                     | Train Loss: 1.1150 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.1650 | Train Acc: 0.9806
Average Train Accuracy: 0.8732
 Site-Clipart                       | Val  Loss: 1.5446 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.5025 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.6914 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.7141 | Val  Acc: 0.8136
 Site-Art                           | Val  Loss: 1.6008 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 1.4998 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 1.3341 | Val  Acc: 0.9420
Average Valid Accuracy: 0.8597
============ Train epoch 18 ============
denominator: 11803.009765625
 Site-Clipart                       | Train Loss: 1.1475 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.6116 | Train Acc: 0.7745
 Site-Clipart                       | Train Loss: 1.6968 | Train Acc: 0.6689
 Site-Art                           | Train Loss: 1.2503 | Train Acc: 0.9318
 Site-Art                           | Train Loss: 1.7435 | Train Acc: 0.8682
 Site-RealWorld                     | Train Loss: 1.0682 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 1.1128 | Train Acc: 0.9903
Average Train Accuracy: 0.8816
 Site-Clipart                       | Val  Loss: 1.4986 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.4964 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.6553 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.6982 | Val  Acc: 0.7627
 Site-Art                           | Val  Loss: 1.5671 | Val  Acc: 0.8706
 Site-RealWorld                     | Val  Loss: 1.4647 | Val  Acc: 0.9200
 Site-Product                       | Val  Loss: 1.2940 | Val  Acc: 0.9420
Average Valid Accuracy: 0.8467
============ Train epoch 19 ============
denominator: 11461.89453125
 Site-Clipart                       | Train Loss: 1.2082 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.5976 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.6495 | Train Acc: 0.7095
 Site-Art                           | Train Loss: 1.1808 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.4592 | Train Acc: 0.8450
 Site-RealWorld                     | Train Loss: 1.0517 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 1.0955 | Train Acc: 0.9806
Average Train Accuracy: 0.8785
 Site-Clipart                       | Val  Loss: 1.4725 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.4594 | Val  Acc: 0.8235
 Site-Clipart                       | Val  Loss: 1.6212 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 1.6683 | Val  Acc: 0.8305
 Site-Art                           | Val  Loss: 1.5376 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 1.4484 | Val  Acc: 0.9200
 Site-Product                       | Val  Loss: 1.2542 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8742
============ Train epoch 20 ============
denominator: 11240.376953125
 Site-Clipart                       | Train Loss: 1.1849 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.5672 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 1.6275 | Train Acc: 0.7095
 Site-Art                           | Train Loss: 1.1106 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.6293 | Train Acc: 0.8527
 Site-RealWorld                     | Train Loss: 0.9997 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0233 | Train Acc: 0.9903
Average Train Accuracy: 0.8833
 Site-Clipart                       | Val  Loss: 1.4597 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.4384 | Val  Acc: 0.8235
 Site-Clipart                       | Val  Loss: 1.6260 | Val  Acc: 0.7449
 Site-Art                           | Val  Loss: 1.6266 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.5209 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.4390 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 1.2436 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8655
============ Train epoch 21 ============
denominator: 10978.3046875
 Site-Clipart                       | Train Loss: 1.0607 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.5655 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 1.6242 | Train Acc: 0.6757
 Site-Art                           | Train Loss: 1.0992 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.5194 | Train Acc: 0.8295
 Site-RealWorld                     | Train Loss: 0.9439 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 0.9927 | Train Acc: 0.9903
Average Train Accuracy: 0.8702
 Site-Clipart                       | Val  Loss: 1.4109 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.3920 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.5936 | Val  Acc: 0.7449
 Site-Art                           | Val  Loss: 1.6042 | Val  Acc: 0.8305
 Site-Art                           | Val  Loss: 1.4847 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.3779 | Val  Acc: 0.9200
 Site-Product                       | Val  Loss: 1.1960 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8675
============ Train epoch 22 ============
denominator: 10931.6484375
 Site-Clipart                       | Train Loss: 1.0104 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.5311 | Train Acc: 0.6863
 Site-Clipart                       | Train Loss: 1.5966 | Train Acc: 0.6892
 Site-Art                           | Train Loss: 1.0632 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.6322 | Train Acc: 0.8295
 Site-RealWorld                     | Train Loss: 0.9313 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.9429 | Train Acc: 0.9903
Average Train Accuracy: 0.8767
 Site-Clipart                       | Val  Loss: 1.3986 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.4098 | Val  Acc: 0.8529
 Site-Clipart                       | Val  Loss: 1.5865 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.5850 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.4404 | Val  Acc: 0.9294
 Site-RealWorld                     | Val  Loss: 1.3748 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 1.2126 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8881
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9149
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8529
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.7551
 Best site-Art                       | Epoch:22 | Val Acc: 0.8644
 Best site-Art                       | Epoch:22 | Val Acc: 0.9294
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9000
 Best site-Product                   | Epoch:22 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 23 ============
denominator: 10895.4580078125
 Site-Clipart                       | Train Loss: 1.0936 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.5136 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 1.5839 | Train Acc: 0.6757
 Site-Art                           | Train Loss: 1.0728 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.6356 | Train Acc: 0.8760
 Site-RealWorld                     | Train Loss: 0.9085 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.9441 | Train Acc: 0.9806
Average Train Accuracy: 0.8824
 Site-Clipart                       | Val  Loss: 1.3712 | Val  Acc: 0.8511
 Site-Clipart                       | Val  Loss: 1.3203 | Val  Acc: 0.8529
 Site-Clipart                       | Val  Loss: 1.5526 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.5867 | Val  Acc: 0.8305
 Site-Art                           | Val  Loss: 1.4190 | Val  Acc: 0.8941
 Site-RealWorld                     | Val  Loss: 1.3482 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 1.1884 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8722
============ Train epoch 24 ============
denominator: 10761.9326171875
 Site-Clipart                       | Train Loss: 0.9833 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 1.5110 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.5744 | Train Acc: 0.6757
 Site-Art                           | Train Loss: 1.0242 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.4189 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 0.8708 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 0.8777 | Train Acc: 0.9903
Average Train Accuracy: 0.8831
 Site-Clipart                       | Val  Loss: 1.3448 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 1.3429 | Val  Acc: 0.7647
 Site-Clipart                       | Val  Loss: 1.5365 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.5591 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.4082 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 1.3230 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 1.1713 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8720
============ Train epoch 25 ============
denominator: 10489.5625
 Site-Clipart                       | Train Loss: 0.9914 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.4941 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.6076 | Train Acc: 0.7095
 Site-Art                           | Train Loss: 1.0009 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.5037 | Train Acc: 0.8527
 Site-RealWorld                     | Train Loss: 0.8426 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.8827 | Train Acc: 0.9806
Average Train Accuracy: 0.8876
 Site-Clipart                       | Val  Loss: 1.3173 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.2818 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.5537 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.5081 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.3817 | Val  Acc: 0.9294
 Site-RealWorld                     | Val  Loss: 1.2819 | Val  Acc: 0.9700
 Site-Product                       | Val  Loss: 1.1080 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8885
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9149
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.7941
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.7755
 Best site-Art                       | Epoch:25 | Val Acc: 0.8644
 Best site-Art                       | Epoch:25 | Val Acc: 0.9294
 Best site-RealWorld                 | Epoch:25 | Val Acc: 0.9700
 Best site-Product                   | Epoch:25 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 26 ============
denominator: 10333.671875
 Site-Clipart                       | Train Loss: 0.9566 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.4910 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 1.5024 | Train Acc: 0.7027
 Site-Art                           | Train Loss: 0.9302 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.5641 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 0.8143 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8529 | Train Acc: 0.9903
Average Train Accuracy: 0.8914
 Site-Clipart                       | Val  Loss: 1.2827 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.2869 | Val  Acc: 0.7794
 Site-Clipart                       | Val  Loss: 1.5151 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.5281 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.3738 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.2403 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.0569 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8654
============ Train epoch 27 ============
denominator: 10077.9296875
 Site-Clipart                       | Train Loss: 0.9636 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.4690 | Train Acc: 0.6961
 Site-Clipart                       | Train Loss: 1.5135 | Train Acc: 0.7162
 Site-Art                           | Train Loss: 0.9507 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.5691 | Train Acc: 0.8760
 Site-RealWorld                     | Train Loss: 0.7514 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.8034 | Train Acc: 0.9903
Average Train Accuracy: 0.8870
 Site-Clipart                       | Val  Loss: 1.2445 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.2414 | Val  Acc: 0.7794
 Site-Clipart                       | Val  Loss: 1.5124 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.4831 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.3690 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 1.2527 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 1.0651 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8763
============ Train epoch 28 ============
denominator: 9865.861328125
 Site-Clipart                       | Train Loss: 0.8789 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.4722 | Train Acc: 0.6863
 Site-Clipart                       | Train Loss: 1.5094 | Train Acc: 0.7095
 Site-Art                           | Train Loss: 0.9437 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.5076 | Train Acc: 0.8760
 Site-RealWorld                     | Train Loss: 0.7518 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.7908 | Train Acc: 0.9903
Average Train Accuracy: 0.8826
 Site-Clipart                       | Val  Loss: 1.2353 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 1.2214 | Val  Acc: 0.8676
 Site-Clipart                       | Val  Loss: 1.4749 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.4848 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.3373 | Val  Acc: 0.8706
 Site-RealWorld                     | Val  Loss: 1.2380 | Val  Acc: 0.9200
 Site-Product                       | Val  Loss: 1.0085 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8796
============ Train epoch 29 ============
denominator: 9546.6630859375
 Site-Clipart                       | Train Loss: 0.8755 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.4437 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 1.5022 | Train Acc: 0.6892
 Site-Art                           | Train Loss: 0.8738 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.3271 | Train Acc: 0.8992
 Site-RealWorld                     | Train Loss: 0.7334 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 0.7472 | Train Acc: 0.9903
Average Train Accuracy: 0.8837
 Site-Clipart                       | Val  Loss: 1.2314 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.1931 | Val  Acc: 0.8382
 Site-Clipart                       | Val  Loss: 1.4535 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.4687 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.3006 | Val  Acc: 0.9176
 Site-RealWorld                     | Val  Loss: 1.1925 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 1.0191 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8828
============ Train epoch 30 ============
denominator: 9753.7841796875
 Site-Clipart                       | Train Loss: 0.8393 | Train Acc: 0.9429
 Site-Clipart                       | Train Loss: 1.4303 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.4591 | Train Acc: 0.7162
 Site-Art                           | Train Loss: 0.9035 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.4279 | Train Acc: 0.8527
 Site-RealWorld                     | Train Loss: 0.7215 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7221 | Train Acc: 0.9903
Average Train Accuracy: 0.8846
 Site-Clipart                       | Val  Loss: 1.2060 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 1.1655 | Val  Acc: 0.8235
 Site-Clipart                       | Val  Loss: 1.4436 | Val  Acc: 0.8061
 Site-Art                           | Val  Loss: 1.4412 | Val  Acc: 0.8305
 Site-Art                           | Val  Loss: 1.3163 | Val  Acc: 0.8588
 Site-RealWorld                     | Val  Loss: 1.1896 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.9635 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8753
============ Train epoch 31 ============
denominator: 9403.0341796875
 Site-Clipart                       | Train Loss: 0.8682 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.4140 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.4557 | Train Acc: 0.7027
 Site-Art                           | Train Loss: 0.8309 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.4668 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 0.6787 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.7295 | Train Acc: 0.9903
Average Train Accuracy: 0.8881
 Site-Clipart                       | Val  Loss: 1.1720 | Val  Acc: 0.9574
 Site-Clipart                       | Val  Loss: 1.1902 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.4412 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.4583 | Val  Acc: 0.7627
 Site-Art                           | Val  Loss: 1.2568 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.1903 | Val  Acc: 0.9400
 Site-Product                       | Val  Loss: 0.9371 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8676
============ Train epoch 32 ============
denominator: 9128.9931640625
 Site-Clipart                       | Train Loss: 0.9148 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 1.4092 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 1.4236 | Train Acc: 0.7027
 Site-Art                           | Train Loss: 0.8326 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.4240 | Train Acc: 0.8760
 Site-RealWorld                     | Train Loss: 0.6771 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.6998 | Train Acc: 0.9903
Average Train Accuracy: 0.8890
 Site-Clipart                       | Val  Loss: 1.1722 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.1516 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.4212 | Val  Acc: 0.7959
 Site-Art                           | Val  Loss: 1.3934 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.2411 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.1397 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 0.9338 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8810
============ Train epoch 33 ============
denominator: 9211.634765625
 Site-Clipart                       | Train Loss: 1.0365 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.3905 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.4683 | Train Acc: 0.6554
 Site-Art                           | Train Loss: 0.8180 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.4041 | Train Acc: 0.9225
 Site-RealWorld                     | Train Loss: 0.6450 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.6637 | Train Acc: 0.9903
Average Train Accuracy: 0.8906
 Site-Clipart                       | Val  Loss: 1.1247 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.1245 | Val  Acc: 0.8235
 Site-Clipart                       | Val  Loss: 1.4069 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.3838 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.2363 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.1367 | Val  Acc: 0.9200
 Site-Product                       | Val  Loss: 0.8975 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8833
============ Train epoch 34 ============
denominator: 8978.3349609375
 Site-Clipart                       | Train Loss: 0.7828 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.3377 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.3884 | Train Acc: 0.6689
 Site-Art                           | Train Loss: 0.7908 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.2605 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 0.6688 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.6517 | Train Acc: 0.9903
Average Train Accuracy: 0.8910
 Site-Clipart                       | Val  Loss: 1.1074 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 1.1132 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.4200 | Val  Acc: 0.7347
 Site-Art                           | Val  Loss: 1.3789 | Val  Acc: 0.8305
 Site-Art                           | Val  Loss: 1.2094 | Val  Acc: 0.8941
 Site-RealWorld                     | Val  Loss: 1.1387 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.8990 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8669
============ Train epoch 35 ============
denominator: 9218.662109375
 Site-Clipart                       | Train Loss: 0.7030 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.3805 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.4344 | Train Acc: 0.6959
 Site-Art                           | Train Loss: 0.7591 | Train Acc: 0.9545
 Site-Art                           | Train Loss: 1.5306 | Train Acc: 0.8527
 Site-RealWorld                     | Train Loss: 0.5952 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6132 | Train Acc: 0.9903
Average Train Accuracy: 0.8857
 Site-Clipart                       | Val  Loss: 1.0783 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.0837 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.3999 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.3516 | Val  Acc: 0.8305
 Site-Art                           | Val  Loss: 1.1939 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.1111 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 0.8813 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8742
============ Train epoch 36 ============
denominator: 8895.0224609375
 Site-Clipart                       | Train Loss: 0.7049 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.3490 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 1.3553 | Train Acc: 0.6757
 Site-Art                           | Train Loss: 0.7350 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.3684 | Train Acc: 0.8915
 Site-RealWorld                     | Train Loss: 0.5771 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 0.6225 | Train Acc: 0.9903
Average Train Accuracy: 0.8805
 Site-Clipart                       | Val  Loss: 1.0901 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.0698 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.4178 | Val  Acc: 0.7041
 Site-Art                           | Val  Loss: 1.3635 | Val  Acc: 0.7966
 Site-Art                           | Val  Loss: 1.1756 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 1.0992 | Val  Acc: 0.9200
 Site-Product                       | Val  Loss: 0.8795 | Val  Acc: 0.9420
Average Valid Accuracy: 0.8539
============ Train epoch 37 ============
denominator: 8595.3115234375
 Site-Clipart                       | Train Loss: 0.7764 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.3458 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 1.4102 | Train Acc: 0.6824
 Site-Art                           | Train Loss: 0.7209 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 1.2610 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 0.5730 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.5981 | Train Acc: 0.9903
Average Train Accuracy: 0.8865
 Site-Clipart                       | Val  Loss: 1.1069 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 1.0539 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.3808 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.3314 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.1743 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.0959 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 0.8689 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8593
============ Train epoch 38 ============
denominator: 8475.04296875
 Site-Clipart                       | Train Loss: 0.6303 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.3048 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 1.3671 | Train Acc: 0.7095
 Site-Art                           | Train Loss: 0.7095 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.3661 | Train Acc: 0.8992
 Site-RealWorld                     | Train Loss: 0.5620 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.5965 | Train Acc: 0.9903
Average Train Accuracy: 0.8922
 Site-Clipart                       | Val  Loss: 1.0597 | Val  Acc: 0.8936
 Site-Clipart                       | Val  Loss: 1.0307 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.3669 | Val  Acc: 0.7347
 Site-Art                           | Val  Loss: 1.2798 | Val  Acc: 0.9492
 Site-Art                           | Val  Loss: 1.1330 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 1.0529 | Val  Acc: 0.9400
 Site-Product                       | Val  Loss: 0.8147 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8929
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.8936
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.8088
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.7347
 Best site-Art                       | Epoch:38 | Val Acc: 0.9492
 Best site-Art                       | Epoch:38 | Val Acc: 0.9529
 Best site-RealWorld                 | Epoch:38 | Val Acc: 0.9400
 Best site-Product                   | Epoch:38 | Val Acc: 0.9710
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.45_1/q-ffl...
============ Train epoch 39 ============
denominator: 8653.267578125
 Site-Clipart                       | Train Loss: 0.6532 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.3343 | Train Acc: 0.6961
 Site-Clipart                       | Train Loss: 1.3583 | Train Acc: 0.6824
 Site-Art                           | Train Loss: 0.6755 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 1.3176 | Train Acc: 0.9225
 Site-RealWorld                     | Train Loss: 0.5347 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5540 | Train Acc: 0.9903
Average Train Accuracy: 0.8910
 Site-Clipart                       | Val  Loss: 1.0359 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 1.0581 | Val  Acc: 0.8235
 Site-Clipart                       | Val  Loss: 1.3407 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.3040 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.1448 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 1.0570 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 0.7761 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8873
============ Train epoch 40 ============
denominator: 8412.3359375
 Site-Clipart                       | Train Loss: 0.6715 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.3395 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 1.3179 | Train Acc: 0.6959
 Site-Art                           | Train Loss: 0.7009 | Train Acc: 0.9432
 Site-Art                           | Train Loss: 1.4409 | Train Acc: 0.8915
 Site-RealWorld                     | Train Loss: 0.5189 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.5331 | Train Acc: 0.9903
Average Train Accuracy: 0.8853
 Site-Clipart                       | Val  Loss: 1.0514 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 0.9827 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.3414 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.3038 | Val  Acc: 0.8305
 Site-Art                           | Val  Loss: 1.1140 | Val  Acc: 0.8588
 Site-RealWorld                     | Val  Loss: 1.0133 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 0.8803 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8645
============ Train epoch 41 ============
denominator: 8231.3447265625
 Site-Clipart                       | Train Loss: 0.8118 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.3482 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.3467 | Train Acc: 0.7162
 Site-Art                           | Train Loss: 0.7309 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.1303 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 0.5081 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5434 | Train Acc: 0.9903
Average Train Accuracy: 0.8938
 Site-Clipart                       | Val  Loss: 0.9962 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 1.0064 | Val  Acc: 0.8382
 Site-Clipart                       | Val  Loss: 1.3481 | Val  Acc: 0.7449
 Site-Art                           | Val  Loss: 1.2761 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.0956 | Val  Acc: 0.9176
 Site-RealWorld                     | Val  Loss: 1.0528 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 0.8333 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8806
============ Train epoch 42 ============
denominator: 8313.0576171875
 Site-Clipart                       | Train Loss: 0.5897 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.3215 | Train Acc: 0.6765
 Site-Clipart                       | Train Loss: 1.3147 | Train Acc: 0.7027
 Site-Art                           | Train Loss: 0.6535 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.1720 | Train Acc: 0.8992
 Site-RealWorld                     | Train Loss: 0.5030 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.5497 | Train Acc: 0.9903
Average Train Accuracy: 0.8836
 Site-Clipart                       | Val  Loss: 0.9879 | Val  Acc: 0.8723
 Site-Clipart                       | Val  Loss: 0.9517 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.3188 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.2454 | Val  Acc: 0.8814
 Site-Art                           | Val  Loss: 1.0980 | Val  Acc: 0.9294
 Site-RealWorld                     | Val  Loss: 0.9916 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.8119 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8791
============ Train epoch 43 ============
denominator: 8116.072265625
 Site-Clipart                       | Train Loss: 0.6838 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 1.2838 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.2708 | Train Acc: 0.7162
 Site-Art                           | Train Loss: 0.6561 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.3296 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 0.4906 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.4989 | Train Acc: 0.9903
Average Train Accuracy: 0.8948
 Site-Clipart                       | Val  Loss: 0.9555 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.9550 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.3212 | Val  Acc: 0.7347
 Site-Art                           | Val  Loss: 1.2380 | Val  Acc: 0.8475
 Site-Art                           | Val  Loss: 1.0614 | Val  Acc: 0.9529
 Site-RealWorld                     | Val  Loss: 0.9931 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.7549 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8838
============ Train epoch 44 ============
denominator: 8036.46484375
 Site-Clipart                       | Train Loss: 0.6065 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.2647 | Train Acc: 0.7353
 Site-Clipart                       | Train Loss: 1.3070 | Train Acc: 0.7095
 Site-Art                           | Train Loss: 0.6520 | Train Acc: 0.9886
 Site-Art                           | Train Loss: 1.0786 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 0.4720 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.5017 | Train Acc: 0.9903
Average Train Accuracy: 0.8927
 Site-Clipart                       | Val  Loss: 0.9849 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.9446 | Val  Acc: 0.8529
 Site-Clipart                       | Val  Loss: 1.3028 | Val  Acc: 0.7041
 Site-Art                           | Val  Loss: 1.2588 | Val  Acc: 0.8983
 Site-Art                           | Val  Loss: 1.0585 | Val  Acc: 0.9059
 Site-RealWorld                     | Val  Loss: 0.9804 | Val  Acc: 0.9400
 Site-Product                       | Val  Loss: 0.8211 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8890
============ Train epoch 45 ============
denominator: 8310.7021484375
 Site-Clipart                       | Train Loss: 0.5733 | Train Acc: 0.9857
 Site-Clipart                       | Train Loss: 1.2981 | Train Acc: 0.7157
 Site-Clipart                       | Train Loss: 1.3028 | Train Acc: 0.6892
 Site-Art                           | Train Loss: 0.6988 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.0540 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 0.4719 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4780 | Train Acc: 0.9903
Average Train Accuracy: 0.8917
 Site-Clipart                       | Val  Loss: 0.9237 | Val  Acc: 0.9362
 Site-Clipart                       | Val  Loss: 0.9617 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.3084 | Val  Acc: 0.6939
 Site-Art                           | Val  Loss: 1.2631 | Val  Acc: 0.8136
 Site-Art                           | Val  Loss: 1.0618 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.9977 | Val  Acc: 0.9300
 Site-Product                       | Val  Loss: 0.7322 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8727
============ Train epoch 46 ============
denominator: 7960.71240234375
 Site-Clipart                       | Train Loss: 0.6177 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.2566 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.2806 | Train Acc: 0.7095
 Site-Art                           | Train Loss: 0.6204 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 0.9615 | Train Acc: 0.8760
 Site-RealWorld                     | Train Loss: 0.4797 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.4495 | Train Acc: 0.9903
Average Train Accuracy: 0.8865
 Site-Clipart                       | Val  Loss: 0.9410 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 0.9346 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.2962 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.1969 | Val  Acc: 0.8305
 Site-Art                           | Val  Loss: 1.0383 | Val  Acc: 0.8941
 Site-RealWorld                     | Val  Loss: 0.9729 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.7669 | Val  Acc: 0.9855
Average Valid Accuracy: 0.8799
============ Train epoch 47 ============
denominator: 7825.99609375
 Site-Clipart                       | Train Loss: 0.6415 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.2667 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.2385 | Train Acc: 0.7162
 Site-Art                           | Train Loss: 0.6481 | Train Acc: 0.9773
 Site-Art                           | Train Loss: 1.4195 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 0.4635 | Train Acc: 0.9800
 Site-Product                       | Train Loss: 0.4735 | Train Acc: 0.9903
Average Train Accuracy: 0.8893
 Site-Clipart                       | Val  Loss: 0.9389 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 0.9486 | Val  Acc: 0.8235
 Site-Clipart                       | Val  Loss: 1.3056 | Val  Acc: 0.7653
 Site-Art                           | Val  Loss: 1.2073 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.0302 | Val  Acc: 0.9176
 Site-RealWorld                     | Val  Loss: 0.9590 | Val  Acc: 0.9600
 Site-Product                       | Val  Loss: 0.7038 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8881
============ Train epoch 48 ============
denominator: 7962.92626953125
 Site-Clipart                       | Train Loss: 0.5670 | Train Acc: 0.9571
 Site-Clipart                       | Train Loss: 1.2626 | Train Acc: 0.7451
 Site-Clipart                       | Train Loss: 1.2082 | Train Acc: 0.6959
 Site-Art                           | Train Loss: 0.5932 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.3108 | Train Acc: 0.8915
 Site-RealWorld                     | Train Loss: 0.4404 | Train Acc: 0.9867
 Site-Product                       | Train Loss: 0.4630 | Train Acc: 0.9903
Average Train Accuracy: 0.8904
 Site-Clipart                       | Val  Loss: 0.9023 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 0.9209 | Val  Acc: 0.8088
 Site-Clipart                       | Val  Loss: 1.3000 | Val  Acc: 0.7755
 Site-Art                           | Val  Loss: 1.1900 | Val  Acc: 0.8644
 Site-Art                           | Val  Loss: 1.0153 | Val  Acc: 0.8941
 Site-RealWorld                     | Val  Loss: 0.9430 | Val  Acc: 0.9400
 Site-Product                       | Val  Loss: 0.7349 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8792
============ Train epoch 49 ============
denominator: 7602.3681640625
 Site-Clipart                       | Train Loss: 0.6576 | Train Acc: 0.9714
 Site-Clipart                       | Train Loss: 1.2580 | Train Acc: 0.7255
 Site-Clipart                       | Train Loss: 1.3267 | Train Acc: 0.6622
 Site-Art                           | Train Loss: 0.6071 | Train Acc: 0.9659
 Site-Art                           | Train Loss: 1.3700 | Train Acc: 0.9225
 Site-RealWorld                     | Train Loss: 0.4028 | Train Acc: 0.9933
 Site-Product                       | Train Loss: 0.4311 | Train Acc: 0.9903
Average Train Accuracy: 0.8902
 Site-Clipart                       | Val  Loss: 0.8834 | Val  Acc: 0.9149
 Site-Clipart                       | Val  Loss: 0.9123 | Val  Acc: 0.7941
 Site-Clipart                       | Val  Loss: 1.2728 | Val  Acc: 0.7551
 Site-Art                           | Val  Loss: 1.1762 | Val  Acc: 0.8814
 Site-Art                           | Val  Loss: 1.0077 | Val  Acc: 0.9176
 Site-RealWorld                     | Val  Loss: 0.9500 | Val  Acc: 0.9200
 Site-Product                       | Val  Loss: 0.7205 | Val  Acc: 0.9710
Average Valid Accuracy: 0.8792
===2023-08-02 00:36:09===
===2023-08-02 00:36:12===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[70,102,148,88,129,150,103,
client_nums=[3,2,1,1,]
len_dataset=[537,364,251,173,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:38 | Test Acc: 0.4851
 Test site-Art                       (0)| Epoch:38 | Test Acc: 0.6335
 Test site-RealWorld                 (3)| Epoch:38 | Test Acc: 0.5794
 Test site-Product                   (3)| Epoch:38 | Test Acc: 0.5423
Clipart: 0.4851, Art: 0.6335, RealWorld: 0.5794, Product: 0.5423, 
Average Test Accuracy(group): 0.5601, Average Test Accuracy(individual): 0.5492,
domain std=0.0541, cluster std=0.0324, individual std=0.0627, 
