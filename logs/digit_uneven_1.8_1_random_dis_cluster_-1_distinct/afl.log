===2023-07-02 00:35:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0196 | Train Acc: 0.6476
 Site-USPS                          | Train Loss: 2.0120 | Train Acc: 0.5833
 Site-SynthDigits                   | Train Loss: 2.2466 | Train Acc: 0.2295
 Site-MNIST_M                       | Train Loss: 2.2783 | Train Acc: 0.1527
 Site-SVHN                          | Train Loss: 2.2805 | Train Acc: 0.1071
Average Train Accuracy: 0.3441
 Site-MNIST                         | Val  Loss: 2.0205 | Val  Acc: 0.6599
 Site-USPS                          | Val  Loss: 2.0038 | Val  Acc: 0.5818
 Site-SynthDigits                   | Val  Loss: 2.2487 | Val  Acc: 0.1978
 Site-MNIST_M                       | Val  Loss: 2.2815 | Val  Acc: 0.1400
 Site-SVHN                          | Val  Loss: 2.2729 | Val  Acc: 0.1429
Average Valid Accuracy: 0.3445
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6599
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5818
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1978
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1400
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.7591 | Train Acc: 0.7359
 Site-USPS                          | Train Loss: 1.7749 | Train Acc: 0.6697
 Site-SynthDigits                   | Train Loss: 2.1808 | Train Acc: 0.2923
 Site-MNIST_M                       | Train Loss: 2.2545 | Train Acc: 0.2266
 Site-SVHN                          | Train Loss: 2.2689 | Train Acc: 0.1429
Average Train Accuracy: 0.4135
 Site-MNIST                         | Val  Loss: 1.7534 | Val  Acc: 0.7475
 Site-USPS                          | Val  Loss: 1.7627 | Val  Acc: 0.6424
 Site-SynthDigits                   | Val  Loss: 2.1805 | Val  Acc: 0.2857
 Site-MNIST_M                       | Val  Loss: 2.2534 | Val  Acc: 0.2000
 Site-SVHN                          | Val  Loss: 2.2616 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4180
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7475
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6424
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2857
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2000
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.5478 | Train Acc: 0.7763
 Site-USPS                          | Train Loss: 1.5552 | Train Acc: 0.7227
 Site-SynthDigits                   | Train Loss: 2.1242 | Train Acc: 0.3033
 Site-MNIST_M                       | Train Loss: 2.2031 | Train Acc: 0.2709
 Site-SVHN                          | Train Loss: 2.2549 | Train Acc: 0.1518
Average Train Accuracy: 0.4450
 Site-MNIST                         | Val  Loss: 1.5425 | Val  Acc: 0.7677
 Site-USPS                          | Val  Loss: 1.5409 | Val  Acc: 0.7212
 Site-SynthDigits                   | Val  Loss: 2.1191 | Val  Acc: 0.3297
 Site-MNIST_M                       | Val  Loss: 2.2242 | Val  Acc: 0.2200
 Site-SVHN                          | Val  Loss: 2.2488 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4434
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7677
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7212
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3297
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2200
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.3659 | Train Acc: 0.7948
 Site-USPS                          | Train Loss: 1.3848 | Train Acc: 0.7697
 Site-SynthDigits                   | Train Loss: 2.0734 | Train Acc: 0.3169
 Site-MNIST_M                       | Train Loss: 2.2005 | Train Acc: 0.2759
 Site-SVHN                          | Train Loss: 2.2310 | Train Acc: 0.1786
Average Train Accuracy: 0.4672
 Site-MNIST                         | Val  Loss: 1.3530 | Val  Acc: 0.7744
 Site-USPS                          | Val  Loss: 1.3575 | Val  Acc: 0.7879
 Site-SynthDigits                   | Val  Loss: 2.0637 | Val  Acc: 0.3407
 Site-MNIST_M                       | Val  Loss: 2.1969 | Val  Acc: 0.2200
 Site-SVHN                          | Val  Loss: 2.2273 | Val  Acc: 0.2857
Average Valid Accuracy: 0.4817
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7744
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7879
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3407
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2200
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.2020 | Train Acc: 0.8167
 Site-USPS                          | Train Loss: 1.2211 | Train Acc: 0.7909
 Site-SynthDigits                   | Train Loss: 2.0295 | Train Acc: 0.3197
 Site-MNIST_M                       | Train Loss: 2.1629 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.2224 | Train Acc: 0.1964
Average Train Accuracy: 0.4819
 Site-MNIST                         | Val  Loss: 1.1889 | Val  Acc: 0.7980
 Site-USPS                          | Val  Loss: 1.1917 | Val  Acc: 0.8000
 Site-SynthDigits                   | Val  Loss: 2.0198 | Val  Acc: 0.3516
 Site-MNIST_M                       | Val  Loss: 2.1688 | Val  Acc: 0.2600
 Site-SVHN                          | Val  Loss: 2.2121 | Val  Acc: 0.2857
Average Valid Accuracy: 0.4991
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7980
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8000
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3516
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2600
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.0997 | Train Acc: 0.8158
 Site-USPS                          | Train Loss: 1.0812 | Train Acc: 0.8258
 Site-SynthDigits                   | Train Loss: 1.9891 | Train Acc: 0.3333
 Site-MNIST_M                       | Train Loss: 2.1120 | Train Acc: 0.3054
 Site-SVHN                          | Train Loss: 2.2122 | Train Acc: 0.2054
Average Train Accuracy: 0.4971
 Site-MNIST                         | Val  Loss: 1.0817 | Val  Acc: 0.7980
 Site-USPS                          | Val  Loss: 1.0460 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.9715 | Val  Acc: 0.3736
 Site-MNIST_M                       | Val  Loss: 2.1376 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.2067 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5172
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7980
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3736
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.9706 | Train Acc: 0.8209
 Site-USPS                          | Train Loss: 0.9940 | Train Acc: 0.8273
 Site-SynthDigits                   | Train Loss: 1.9537 | Train Acc: 0.3579
 Site-MNIST_M                       | Train Loss: 2.0798 | Train Acc: 0.3350
 Site-SVHN                          | Train Loss: 2.1962 | Train Acc: 0.1964
Average Train Accuracy: 0.5075
 Site-MNIST                         | Val  Loss: 0.9541 | Val  Acc: 0.8182
 Site-USPS                          | Val  Loss: 0.9629 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.9359 | Val  Acc: 0.3846
 Site-MNIST_M                       | Val  Loss: 2.1188 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1952 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5234
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8182
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3846
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.8892 | Train Acc: 0.8335
 Site-USPS                          | Train Loss: 0.8944 | Train Acc: 0.8379
 Site-SynthDigits                   | Train Loss: 1.9180 | Train Acc: 0.3661
 Site-MNIST_M                       | Train Loss: 2.0674 | Train Acc: 0.3498
 Site-SVHN                          | Train Loss: 2.1927 | Train Acc: 0.2411
Average Train Accuracy: 0.5257
 Site-MNIST                         | Val  Loss: 0.8655 | Val  Acc: 0.8249
 Site-USPS                          | Val  Loss: 0.8750 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.9000 | Val  Acc: 0.3846
 Site-MNIST_M                       | Val  Loss: 2.0858 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1837 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5324
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8249
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3846
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.8132 | Train Acc: 0.8436
 Site-USPS                          | Train Loss: 0.8274 | Train Acc: 0.8379
 Site-SynthDigits                   | Train Loss: 1.8869 | Train Acc: 0.3798
 Site-MNIST_M                       | Train Loss: 1.9967 | Train Acc: 0.3695
 Site-SVHN                          | Train Loss: 2.1867 | Train Acc: 0.2411
Average Train Accuracy: 0.5344
 Site-MNIST                         | Val  Loss: 0.7882 | Val  Acc: 0.8418
 Site-USPS                          | Val  Loss: 0.8089 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.8784 | Val  Acc: 0.3956
 Site-MNIST_M                       | Val  Loss: 2.0641 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1839 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5420
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8418
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3956
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.7513 | Train Acc: 0.8444
 Site-USPS                          | Train Loss: 0.7605 | Train Acc: 0.8530
 Site-SynthDigits                   | Train Loss: 1.8673 | Train Acc: 0.4016
 Site-MNIST_M                       | Train Loss: 2.0201 | Train Acc: 0.3793
 Site-SVHN                          | Train Loss: 2.1854 | Train Acc: 0.2500
Average Train Accuracy: 0.5457
 Site-MNIST                         | Val  Loss: 0.7274 | Val  Acc: 0.8384
 Site-USPS                          | Val  Loss: 0.7448 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.8531 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 2.0134 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1739 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5432
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8384
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.6916 | Train Acc: 0.8486
 Site-USPS                          | Train Loss: 0.7190 | Train Acc: 0.8636
 Site-SynthDigits                   | Train Loss: 1.8548 | Train Acc: 0.4208
 Site-MNIST_M                       | Train Loss: 1.9799 | Train Acc: 0.3744
 Site-SVHN                          | Train Loss: 2.1785 | Train Acc: 0.2500
Average Train Accuracy: 0.5515
 Site-MNIST                         | Val  Loss: 0.6699 | Val  Acc: 0.8552
 Site-USPS                          | Val  Loss: 0.7012 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.8326 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.9928 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1697 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5487
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8552
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.6504 | Train Acc: 0.8570
 Site-USPS                          | Train Loss: 0.6839 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.8272 | Train Acc: 0.4399
 Site-MNIST_M                       | Train Loss: 1.9455 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.1658 | Train Acc: 0.2411
Average Train Accuracy: 0.5601
 Site-MNIST                         | Val  Loss: 0.6251 | Val  Acc: 0.8620
 Site-USPS                          | Val  Loss: 0.6633 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.8196 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.9644 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1693 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5513
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8620
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8606
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.6154 | Train Acc: 0.8595
 Site-USPS                          | Train Loss: 0.6500 | Train Acc: 0.8697
 Site-SynthDigits                   | Train Loss: 1.7902 | Train Acc: 0.4235
 Site-MNIST_M                       | Train Loss: 1.9102 | Train Acc: 0.3793
 Site-SVHN                          | Train Loss: 2.1588 | Train Acc: 0.2232
Average Train Accuracy: 0.5511
 Site-MNIST                         | Val  Loss: 0.5920 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.6208 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.7941 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.9403 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1549 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5438
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.5693 | Train Acc: 0.8747
 Site-USPS                          | Train Loss: 0.6050 | Train Acc: 0.8788
 Site-SynthDigits                   | Train Loss: 1.7847 | Train Acc: 0.4344
 Site-MNIST_M                       | Train Loss: 1.8977 | Train Acc: 0.3842
 Site-SVHN                          | Train Loss: 2.1478 | Train Acc: 0.2411
Average Train Accuracy: 0.5626
 Site-MNIST                         | Val  Loss: 0.5413 | Val  Acc: 0.8822
 Site-USPS                          | Val  Loss: 0.5956 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7858 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.9261 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1470 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5546
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8822
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4176
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.5390 | Train Acc: 0.8780
 Site-USPS                          | Train Loss: 0.5868 | Train Acc: 0.8788
 Site-SynthDigits                   | Train Loss: 1.7640 | Train Acc: 0.4372
 Site-MNIST_M                       | Train Loss: 1.8848 | Train Acc: 0.4138
 Site-SVHN                          | Train Loss: 2.1468 | Train Acc: 0.2411
Average Train Accuracy: 0.5698
 Site-MNIST                         | Val  Loss: 0.5135 | Val  Acc: 0.8788
 Site-USPS                          | Val  Loss: 0.5712 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7780 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8863 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1413 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5517
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.5128 | Train Acc: 0.8823
 Site-USPS                          | Train Loss: 0.5785 | Train Acc: 0.8788
 Site-SynthDigits                   | Train Loss: 1.7508 | Train Acc: 0.4426
 Site-MNIST_M                       | Train Loss: 1.8607 | Train Acc: 0.4138
 Site-SVHN                          | Train Loss: 2.1373 | Train Acc: 0.2500
Average Train Accuracy: 0.5735
 Site-MNIST                         | Val  Loss: 0.4878 | Val  Acc: 0.8855
 Site-USPS                          | Val  Loss: 0.5405 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7556 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.8711 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1355 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5574
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8855
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.4841 | Train Acc: 0.8932
 Site-USPS                          | Train Loss: 0.5234 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.7353 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 1.8976 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.1245 | Train Acc: 0.2411
Average Train Accuracy: 0.5758
 Site-MNIST                         | Val  Loss: 0.4542 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.5240 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.7473 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.8700 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1291 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5607
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8956
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.4602 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.5091 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.7251 | Train Acc: 0.4563
 Site-MNIST_M                       | Train Loss: 1.8136 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.1249 | Train Acc: 0.2321
Average Train Accuracy: 0.5777
 Site-MNIST                         | Val  Loss: 0.4314 | Val  Acc: 0.8990
 Site-USPS                          | Val  Loss: 0.5056 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.7361 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.8485 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1284 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5635
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8990
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.4359 | Train Acc: 0.8999
 Site-USPS                          | Train Loss: 0.4857 | Train Acc: 0.8833
 Site-SynthDigits                   | Train Loss: 1.7055 | Train Acc: 0.4399
 Site-MNIST_M                       | Train Loss: 1.8211 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.1187 | Train Acc: 0.2321
Average Train Accuracy: 0.5787
 Site-MNIST                         | Val  Loss: 0.4126 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4848 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7294 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8319 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.1242 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5644
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4066
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.4168 | Train Acc: 0.9016
 Site-USPS                          | Train Loss: 0.4862 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.6772 | Train Acc: 0.4672
 Site-MNIST_M                       | Train Loss: 1.7696 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.1124 | Train Acc: 0.2321
Average Train Accuracy: 0.5848
 Site-MNIST                         | Val  Loss: 0.3932 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4734 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.7091 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.8111 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1270 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5724
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4725
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.4109 | Train Acc: 0.9024
 Site-USPS                          | Train Loss: 0.4499 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.6729 | Train Acc: 0.4727
 Site-MNIST_M                       | Train Loss: 1.7895 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.0999 | Train Acc: 0.2500
Average Train Accuracy: 0.5870
 Site-MNIST                         | Val  Loss: 0.3823 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4512 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.6915 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.8122 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1126 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5773
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4615
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.3932 | Train Acc: 0.9092
 Site-USPS                          | Train Loss: 0.4362 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.6552 | Train Acc: 0.4727
 Site-MNIST_M                       | Train Loss: 1.7265 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.0903 | Train Acc: 0.2411
Average Train Accuracy: 0.5920
 Site-MNIST                         | Val  Loss: 0.3654 | Val  Acc: 0.9057
 Site-USPS                          | Val  Loss: 0.4326 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.6829 | Val  Acc: 0.4835
 Site-MNIST_M                       | Val  Loss: 1.8047 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1117 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5952
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9057
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8970
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4835
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.3728 | Train Acc: 0.9100
 Site-USPS                          | Train Loss: 0.4395 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.6465 | Train Acc: 0.4836
 Site-MNIST_M                       | Train Loss: 1.8097 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 2.0872 | Train Acc: 0.2500
Average Train Accuracy: 0.5932
 Site-MNIST                         | Val  Loss: 0.3468 | Val  Acc: 0.9057
 Site-USPS                          | Val  Loss: 0.4277 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.6729 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.7925 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1129 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5816
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.3536 | Train Acc: 0.9193
 Site-USPS                          | Train Loss: 0.4260 | Train Acc: 0.8970
 Site-SynthDigits                   | Train Loss: 1.6414 | Train Acc: 0.4699
 Site-MNIST_M                       | Train Loss: 1.8034 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.1100 | Train Acc: 0.2321
Average Train Accuracy: 0.5913
 Site-MNIST                         | Val  Loss: 0.3309 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.4262 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.6826 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7786 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.1252 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5756
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.3482 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.4211 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.6252 | Train Acc: 0.4727
 Site-MNIST_M                       | Train Loss: 1.7648 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.1046 | Train Acc: 0.2321
Average Train Accuracy: 0.5949
 Site-MNIST                         | Val  Loss: 0.3222 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.4141 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.6594 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.7791 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1245 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5693
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.3347 | Train Acc: 0.9226
 Site-USPS                          | Train Loss: 0.3995 | Train Acc: 0.9061
 Site-SynthDigits                   | Train Loss: 1.6183 | Train Acc: 0.4809
 Site-MNIST_M                       | Train Loss: 1.7647 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.1010 | Train Acc: 0.2411
Average Train Accuracy: 0.5998
 Site-MNIST                         | Val  Loss: 0.3089 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.4016 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.6529 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7607 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1224 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5743
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.3264 | Train Acc: 0.9218
 Site-USPS                          | Train Loss: 0.3915 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.5978 | Train Acc: 0.4809
 Site-MNIST_M                       | Train Loss: 1.7571 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.0751 | Train Acc: 0.2232
Average Train Accuracy: 0.5954
 Site-MNIST                         | Val  Loss: 0.3029 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.3912 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.6291 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.7440 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.1189 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5737
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.3135 | Train Acc: 0.9235
 Site-USPS                          | Train Loss: 0.3920 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.6011 | Train Acc: 0.4891
 Site-MNIST_M                       | Train Loss: 1.7176 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.0685 | Train Acc: 0.2232
Average Train Accuracy: 0.5977
 Site-MNIST                         | Val  Loss: 0.2896 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.3867 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.6318 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.7516 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1103 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5862
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.2985 | Train Acc: 0.9352
 Site-USPS                          | Train Loss: 0.3819 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.5737 | Train Acc: 0.4891
 Site-MNIST_M                       | Train Loss: 1.7268 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.0991 | Train Acc: 0.2411
Average Train Accuracy: 0.6036
 Site-MNIST                         | Val  Loss: 0.2759 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3779 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.6227 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.7336 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1250 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5888
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.2981 | Train Acc: 0.9310
 Site-USPS                          | Train Loss: 0.3852 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.5681 | Train Acc: 0.4863
 Site-MNIST_M                       | Train Loss: 1.6957 | Train Acc: 0.4532
 Site-SVHN                          | Train Loss: 2.0826 | Train Acc: 0.2411
Average Train Accuracy: 0.6038
 Site-MNIST                         | Val  Loss: 0.2737 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3691 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.6091 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7100 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1269 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5847
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.2872 | Train Acc: 0.9327
 Site-USPS                          | Train Loss: 0.3609 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.5599 | Train Acc: 0.4945
 Site-MNIST_M                       | Train Loss: 1.7410 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.0816 | Train Acc: 0.2411
Average Train Accuracy: 0.6048
 Site-MNIST                         | Val  Loss: 0.2631 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3582 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.6038 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.7146 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1159 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5944
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.2714 | Train Acc: 0.9411
 Site-USPS                          | Train Loss: 0.3627 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.5632 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.6824 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.0680 | Train Acc: 0.2500
Average Train Accuracy: 0.6103
 Site-MNIST                         | Val  Loss: 0.2503 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3582 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.6076 | Val  Acc: 0.4835
 Site-MNIST_M                       | Val  Loss: 1.6814 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1278 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5960
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4835
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.2640 | Train Acc: 0.9411
 Site-USPS                          | Train Loss: 0.3526 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.5532 | Train Acc: 0.4891
 Site-MNIST_M                       | Train Loss: 1.6626 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.0856 | Train Acc: 0.2500
Average Train Accuracy: 0.6084
 Site-MNIST                         | Val  Loss: 0.2427 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3544 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5959 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.6910 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1301 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5898
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.2525 | Train Acc: 0.9445
 Site-USPS                          | Train Loss: 0.3334 | Train Acc: 0.9152
 Site-SynthDigits                   | Train Loss: 1.5445 | Train Acc: 0.5055
 Site-MNIST_M                       | Train Loss: 1.6585 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.0703 | Train Acc: 0.2589
Average Train Accuracy: 0.6145
 Site-MNIST                         | Val  Loss: 0.2338 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3451 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5918 | Val  Acc: 0.4835
 Site-MNIST_M                       | Val  Loss: 1.6643 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1208 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5986
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9461
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4835
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.2482 | Train Acc: 0.9470
 Site-USPS                          | Train Loss: 0.3439 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.5404 | Train Acc: 0.5055
 Site-MNIST_M                       | Train Loss: 1.6248 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.0767 | Train Acc: 0.2411
Average Train Accuracy: 0.6108
 Site-MNIST                         | Val  Loss: 0.2278 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3430 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5913 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.6818 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1389 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5913
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.2461 | Train Acc: 0.9445
 Site-USPS                          | Train Loss: 0.3327 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.5401 | Train Acc: 0.5055
 Site-MNIST_M                       | Train Loss: 1.6343 | Train Acc: 0.4532
 Site-SVHN                          | Train Loss: 2.0588 | Train Acc: 0.2232
Average Train Accuracy: 0.6095
 Site-MNIST                         | Val  Loss: 0.2236 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3334 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5763 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6690 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1221 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5930
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.2382 | Train Acc: 0.9487
 Site-USPS                          | Train Loss: 0.3188 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.5232 | Train Acc: 0.5109
 Site-MNIST_M                       | Train Loss: 1.6504 | Train Acc: 0.4532
 Site-SVHN                          | Train Loss: 2.0752 | Train Acc: 0.2589
Average Train Accuracy: 0.6177
 Site-MNIST                         | Val  Loss: 0.2174 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3310 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5674 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6493 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1288 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6028
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9562
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.4945
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.2363 | Train Acc: 0.9470
 Site-USPS                          | Train Loss: 0.3117 | Train Acc: 0.9152
 Site-SynthDigits                   | Train Loss: 1.5180 | Train Acc: 0.5109
 Site-MNIST_M                       | Train Loss: 1.6229 | Train Acc: 0.4680
 Site-SVHN                          | Train Loss: 2.0873 | Train Acc: 0.2500
Average Train Accuracy: 0.6182
 Site-MNIST                         | Val  Loss: 0.2146 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3226 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5490 | Val  Acc: 0.4835
 Site-MNIST_M                       | Val  Loss: 1.6504 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1341 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5980
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.2268 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.3252 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.5046 | Train Acc: 0.5164
 Site-MNIST_M                       | Train Loss: 1.6477 | Train Acc: 0.4631
 Site-SVHN                          | Train Loss: 2.0679 | Train Acc: 0.2500
Average Train Accuracy: 0.6191
 Site-MNIST                         | Val  Loss: 0.2080 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3172 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5471 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6212 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1309 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5919
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.2277 | Train Acc: 0.9504
 Site-USPS                          | Train Loss: 0.3130 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.4926 | Train Acc: 0.5082
 Site-MNIST_M                       | Train Loss: 1.6247 | Train Acc: 0.4631
 Site-SVHN                          | Train Loss: 2.0592 | Train Acc: 0.2411
Average Train Accuracy: 0.6162
 Site-MNIST                         | Val  Loss: 0.2064 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3062 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5390 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6148 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1250 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5972
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.2153 | Train Acc: 0.9554
 Site-USPS                          | Train Loss: 0.3166 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.4993 | Train Acc: 0.5109
 Site-MNIST_M                       | Train Loss: 1.5990 | Train Acc: 0.4729
 Site-SVHN                          | Train Loss: 2.0546 | Train Acc: 0.2768
Average Train Accuracy: 0.6268
 Site-MNIST                         | Val  Loss: 0.1940 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3108 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5379 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6224 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1245 | Val  Acc: 0.1786
Average Valid Accuracy: 0.6044
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.5055
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.4600
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/afl...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.2154 | Train Acc: 0.9537
 Site-USPS                          | Train Loss: 0.2963 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.4762 | Train Acc: 0.5164
 Site-MNIST_M                       | Train Loss: 1.5875 | Train Acc: 0.4729
 Site-SVHN                          | Train Loss: 2.0483 | Train Acc: 0.2679
Average Train Accuracy: 0.6258
 Site-MNIST                         | Val  Loss: 0.1929 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3039 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5226 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6135 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1299 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5973
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.2097 | Train Acc: 0.9537
 Site-USPS                          | Train Loss: 0.3189 | Train Acc: 0.9197
 Site-SynthDigits                   | Train Loss: 1.4631 | Train Acc: 0.5109
 Site-MNIST_M                       | Train Loss: 1.6205 | Train Acc: 0.4631
 Site-SVHN                          | Train Loss: 2.0409 | Train Acc: 0.2679
Average Train Accuracy: 0.6231
 Site-MNIST                         | Val  Loss: 0.1896 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2990 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5140 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6042 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1341 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5963
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1982 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2948 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.4661 | Train Acc: 0.5246
 Site-MNIST_M                       | Train Loss: 1.5780 | Train Acc: 0.4680
 Site-SVHN                          | Train Loss: 2.0370 | Train Acc: 0.2857
Average Train Accuracy: 0.6318
 Site-MNIST                         | Val  Loss: 0.1806 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2932 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5220 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6162 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1193 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5992
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1949 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2934 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.4659 | Train Acc: 0.5246
 Site-MNIST_M                       | Train Loss: 1.5967 | Train Acc: 0.4680
 Site-SVHN                          | Train Loss: 2.0350 | Train Acc: 0.2679
Average Train Accuracy: 0.6279
 Site-MNIST                         | Val  Loss: 0.1761 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2910 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5094 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6077 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1198 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5992
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1915 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2848 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.4519 | Train Acc: 0.5246
 Site-MNIST_M                       | Train Loss: 1.6534 | Train Acc: 0.4778
 Site-SVHN                          | Train Loss: 2.0320 | Train Acc: 0.2589
Average Train Accuracy: 0.6284
 Site-MNIST                         | Val  Loss: 0.1744 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2872 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5079 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6053 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1325 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5980
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1882 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2856 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.4497 | Train Acc: 0.5355
 Site-MNIST_M                       | Train Loss: 1.5691 | Train Acc: 0.4631
 Site-SVHN                          | Train Loss: 2.0598 | Train Acc: 0.2679
Average Train Accuracy: 0.6291
 Site-MNIST                         | Val  Loss: 0.1709 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2807 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.4982 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6010 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.1357 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6018
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1842 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2698 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.4343 | Train Acc: 0.5355
 Site-MNIST_M                       | Train Loss: 1.6102 | Train Acc: 0.4532
 Site-SVHN                          | Train Loss: 2.0408 | Train Acc: 0.2589
Average Train Accuracy: 0.6258
 Site-MNIST                         | Val  Loss: 0.1662 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2789 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.4805 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.5769 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.1287 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6025
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1812 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2735 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.4495 | Train Acc: 0.5273
 Site-MNIST_M                       | Train Loss: 1.5892 | Train Acc: 0.4680
 Site-SVHN                          | Train Loss: 2.0472 | Train Acc: 0.2589
Average Train Accuracy: 0.6278
 Site-MNIST                         | Val  Loss: 0.1625 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2771 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.4859 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6195 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1479 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5963
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1753 | Train Acc: 0.9605
 Site-USPS                          | Train Loss: 0.2738 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.4311 | Train Acc: 0.5410
 Site-MNIST_M                       | Train Loss: 1.6120 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.0297 | Train Acc: 0.2589
Average Train Accuracy: 0.6263
 Site-MNIST                         | Val  Loss: 0.1577 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2769 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.4717 | Val  Acc: 0.5165
 Site-MNIST_M                       | Val  Loss: 1.5573 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1487 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6002
===2023-07-02 01:04:07===
===2023-07-02 01:04:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:40 | Test Acc: 0.9160
 Test site-USPS                      | Epoch:40 | Test Acc: 0.9183
 Test site-SynthDigits               | Epoch:40 | Test Acc: 0.4852
 Test site-MNIST_M                   | Epoch:40 | Test Acc: 0.3689
 Test site-SVHN                      | Epoch:40 | Test Acc: 0.2482
MNIST: 0.9160, USPS: 0.9183, SynthDigits: 0.4852, MNIST_M: 0.3689, SVHN: 0.2482, 
Average Test Accuracy(group): 0.5873, Average Test Accuracy(individual): 0.5873,
domain std=0.2795, cluster std=-1.0000, individual std=0.2795, 
