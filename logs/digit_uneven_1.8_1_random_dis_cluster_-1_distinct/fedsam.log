===2023-07-02 05:32:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 0.9123 | Train Acc: 0.8192
 Site-USPS                          | Train Loss: 1.0609 | Train Acc: 0.6924
 Site-SynthDigits                   | Train Loss: 2.0293 | Train Acc: 0.2486
 Site-MNIST_M                       | Train Loss: 2.1340 | Train Acc: 0.2709
 Site-SVHN                          | Train Loss: 2.2404 | Train Acc: 0.1250
Average Train Accuracy: 0.4312
 Site-MNIST                         | Val  Loss: 0.8992 | Val  Acc: 0.8047
 Site-USPS                          | Val  Loss: 1.0412 | Val  Acc: 0.7152
 Site-SynthDigits                   | Val  Loss: 2.0609 | Val  Acc: 0.2747
 Site-MNIST_M                       | Val  Loss: 2.1267 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.2330 | Val  Acc: 0.1071
Average Valid Accuracy: 0.4443
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8047
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7152
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2747
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3200
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.5176 | Train Acc: 0.8696
 Site-USPS                          | Train Loss: 0.6370 | Train Acc: 0.8091
 Site-SynthDigits                   | Train Loss: 1.9025 | Train Acc: 0.3497
 Site-MNIST_M                       | Train Loss: 1.9761 | Train Acc: 0.3251
 Site-SVHN                          | Train Loss: 2.2052 | Train Acc: 0.1875
Average Train Accuracy: 0.5082
 Site-MNIST                         | Val  Loss: 0.5025 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.6210 | Val  Acc: 0.8121
 Site-SynthDigits                   | Val  Loss: 1.8932 | Val  Acc: 0.3297
 Site-MNIST_M                       | Val  Loss: 2.0016 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.2670 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5051
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8653
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8121
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3297
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.3718 | Train Acc: 0.8974
 Site-USPS                          | Train Loss: 0.5470 | Train Acc: 0.8076
 Site-SynthDigits                   | Train Loss: 1.8196 | Train Acc: 0.3989
 Site-MNIST_M                       | Train Loss: 1.8928 | Train Acc: 0.3498
 Site-SVHN                          | Train Loss: 2.2094 | Train Acc: 0.1429
Average Train Accuracy: 0.5193
 Site-MNIST                         | Val  Loss: 0.3563 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.5501 | Val  Acc: 0.8303
 Site-SynthDigits                   | Val  Loss: 1.8080 | Val  Acc: 0.3516
 Site-MNIST_M                       | Val  Loss: 1.8807 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.2973 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5209
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8956
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8303
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3516
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.3031 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.4650 | Train Acc: 0.8500
 Site-SynthDigits                   | Train Loss: 1.7741 | Train Acc: 0.4098
 Site-MNIST_M                       | Train Loss: 1.9396 | Train Acc: 0.3645
 Site-SVHN                          | Train Loss: 2.2494 | Train Acc: 0.1696
Average Train Accuracy: 0.5421
 Site-MNIST                         | Val  Loss: 0.2869 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.4731 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.7543 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.8578 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.4187 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5356
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9259
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8364
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.2378 | Train Acc: 0.9336
 Site-USPS                          | Train Loss: 0.4319 | Train Acc: 0.8727
 Site-SynthDigits                   | Train Loss: 1.6934 | Train Acc: 0.4590
 Site-MNIST_M                       | Train Loss: 1.8367 | Train Acc: 0.3498
 Site-SVHN                          | Train Loss: 2.2253 | Train Acc: 0.1786
Average Train Accuracy: 0.5587
 Site-MNIST                         | Val  Loss: 0.2306 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.4555 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.6740 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.7918 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.3787 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5677
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8485
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4945
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.2245 | Train Acc: 0.9352
 Site-USPS                          | Train Loss: 0.3473 | Train Acc: 0.8955
 Site-SynthDigits                   | Train Loss: 1.7265 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 1.7686 | Train Acc: 0.3350
 Site-SVHN                          | Train Loss: 2.2292 | Train Acc: 0.1607
Average Train Accuracy: 0.5554
 Site-MNIST                         | Val  Loss: 0.2109 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3649 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.6947 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.8088 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.4366 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5480
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.1832 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.3748 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.7012 | Train Acc: 0.4563
 Site-MNIST_M                       | Train Loss: 1.7190 | Train Acc: 0.3645
 Site-SVHN                          | Train Loss: 2.2547 | Train Acc: 0.1607
Average Train Accuracy: 0.5652
 Site-MNIST                         | Val  Loss: 0.1712 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.4079 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.6795 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.8143 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.5118 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5587
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.1700 | Train Acc: 0.9546
 Site-USPS                          | Train Loss: 0.3120 | Train Acc: 0.9000
 Site-SynthDigits                   | Train Loss: 1.6049 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.8444 | Train Acc: 0.3645
 Site-SVHN                          | Train Loss: 2.2263 | Train Acc: 0.1875
Average Train Accuracy: 0.5813
 Site-MNIST                         | Val  Loss: 0.1514 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3311 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.5809 | Val  Acc: 0.5275
 Site-MNIST_M                       | Val  Loss: 1.7280 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.4186 | Val  Acc: 0.0357
Average Valid Accuracy: 0.5713
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9562
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8970
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5275
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.0357
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.1407 | Train Acc: 0.9706
 Site-USPS                          | Train Loss: 0.2964 | Train Acc: 0.8985
 Site-SynthDigits                   | Train Loss: 1.5553 | Train Acc: 0.5109
 Site-MNIST_M                       | Train Loss: 1.7179 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.2314 | Train Acc: 0.1786
Average Train Accuracy: 0.5895
 Site-MNIST                         | Val  Loss: 0.1284 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.3184 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.5340 | Val  Acc: 0.5275
 Site-MNIST_M                       | Val  Loss: 1.7058 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.4354 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5865
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9764
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8970
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5275
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4600
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.1207 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.2770 | Train Acc: 0.9152
 Site-SynthDigits                   | Train Loss: 1.5887 | Train Acc: 0.5164
 Site-MNIST_M                       | Train Loss: 1.7717 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.1930 | Train Acc: 0.2143
Average Train Accuracy: 0.6054
 Site-MNIST                         | Val  Loss: 0.1133 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2920 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5586 | Val  Acc: 0.5385
 Site-MNIST_M                       | Val  Loss: 1.7660 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.3554 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5916
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9731
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5385
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4600
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.1251 | Train Acc: 0.9680
 Site-USPS                          | Train Loss: 0.2092 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.5365 | Train Acc: 0.5109
 Site-MNIST_M                       | Train Loss: 1.6720 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.2150 | Train Acc: 0.2232
Average Train Accuracy: 0.6145
 Site-MNIST                         | Val  Loss: 0.1133 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2299 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.4953 | Val  Acc: 0.5604
 Site-MNIST_M                       | Val  Loss: 1.7131 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.4543 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6082
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9663
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9273
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5604
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4800
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.1081 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.2111 | Train Acc: 0.9424
 Site-SynthDigits                   | Train Loss: 1.4853 | Train Acc: 0.5328
 Site-MNIST_M                       | Train Loss: 1.6405 | Train Acc: 0.3990
 Site-SVHN                          | Train Loss: 2.2115 | Train Acc: 0.1964
Average Train Accuracy: 0.6086
 Site-MNIST                         | Val  Loss: 0.1007 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2154 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.4704 | Val  Acc: 0.5714
 Site-MNIST_M                       | Val  Loss: 1.6913 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.4641 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6014
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.1021 | Train Acc: 0.9765
 Site-USPS                          | Train Loss: 0.1895 | Train Acc: 0.9515
 Site-SynthDigits                   | Train Loss: 1.4646 | Train Acc: 0.5191
 Site-MNIST_M                       | Train Loss: 1.5461 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.1971 | Train Acc: 0.2411
Average Train Accuracy: 0.6214
 Site-MNIST                         | Val  Loss: 0.1003 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.1910 | Val  Acc: 0.9515
 Site-SynthDigits                   | Val  Loss: 1.4314 | Val  Acc: 0.5934
 Site-MNIST_M                       | Val  Loss: 1.6790 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.4868 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6097
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9764
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9515
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5934
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.0942 | Train Acc: 0.9748
 Site-USPS                          | Train Loss: 0.1844 | Train Acc: 0.9470
 Site-SynthDigits                   | Train Loss: 1.4436 | Train Acc: 0.5328
 Site-MNIST_M                       | Train Loss: 1.5405 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2156 | Train Acc: 0.2500
Average Train Accuracy: 0.6227
 Site-MNIST                         | Val  Loss: 0.0918 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.1692 | Val  Acc: 0.9515
 Site-SynthDigits                   | Val  Loss: 1.4368 | Val  Acc: 0.5275
 Site-MNIST_M                       | Val  Loss: 1.7206 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.3916 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5905
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.0798 | Train Acc: 0.9815
 Site-USPS                          | Train Loss: 0.1752 | Train Acc: 0.9455
 Site-SynthDigits                   | Train Loss: 1.4607 | Train Acc: 0.5383
 Site-MNIST_M                       | Train Loss: 1.6642 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.2717 | Train Acc: 0.2143
Average Train Accuracy: 0.6167
 Site-MNIST                         | Val  Loss: 0.0755 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.1846 | Val  Acc: 0.9515
 Site-SynthDigits                   | Val  Loss: 1.3944 | Val  Acc: 0.5495
 Site-MNIST_M                       | Val  Loss: 1.6912 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.5106 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5858
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.0675 | Train Acc: 0.9891
 Site-USPS                          | Train Loss: 0.1887 | Train Acc: 0.9394
 Site-SynthDigits                   | Train Loss: 1.4181 | Train Acc: 0.5355
 Site-MNIST_M                       | Train Loss: 1.6703 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2093 | Train Acc: 0.2232
Average Train Accuracy: 0.6192
 Site-MNIST                         | Val  Loss: 0.0659 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.2211 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.3886 | Val  Acc: 0.5604
 Site-MNIST_M                       | Val  Loss: 1.7171 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.4763 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5950
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.0680 | Train Acc: 0.9899
 Site-USPS                          | Train Loss: 0.1462 | Train Acc: 0.9652
 Site-SynthDigits                   | Train Loss: 1.4102 | Train Acc: 0.5492
 Site-MNIST_M                       | Train Loss: 1.7295 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.2026 | Train Acc: 0.2589
Average Train Accuracy: 0.6413
 Site-MNIST                         | Val  Loss: 0.0615 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.1500 | Val  Acc: 0.9576
 Site-SynthDigits                   | Val  Loss: 1.3935 | Val  Acc: 0.5824
 Site-MNIST_M                       | Val  Loss: 1.6679 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.4583 | Val  Acc: 0.0714
Average Valid Accuracy: 0.6076
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.0643 | Train Acc: 0.9916
 Site-USPS                          | Train Loss: 0.1356 | Train Acc: 0.9682
 Site-SynthDigits                   | Train Loss: 1.3711 | Train Acc: 0.5820
 Site-MNIST_M                       | Train Loss: 1.5366 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 2.2536 | Train Acc: 0.2054
Average Train Accuracy: 0.6351
 Site-MNIST                         | Val  Loss: 0.0575 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1376 | Val  Acc: 0.9515
 Site-SynthDigits                   | Val  Loss: 1.3329 | Val  Acc: 0.6264
 Site-MNIST_M                       | Val  Loss: 1.5875 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.5684 | Val  Acc: 0.0714
Average Valid Accuracy: 0.6165
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9515
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6264
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.0592 | Train Acc: 0.9899
 Site-USPS                          | Train Loss: 0.1241 | Train Acc: 0.9606
 Site-SynthDigits                   | Train Loss: 1.3410 | Train Acc: 0.5738
 Site-MNIST_M                       | Train Loss: 1.5762 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.2377 | Train Acc: 0.2321
Average Train Accuracy: 0.6409
 Site-MNIST                         | Val  Loss: 0.0594 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1279 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.3201 | Val  Acc: 0.5934
 Site-MNIST_M                       | Val  Loss: 1.6901 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.4166 | Val  Acc: 0.0714
Average Valid Accuracy: 0.6063
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.0502 | Train Acc: 0.9933
 Site-USPS                          | Train Loss: 0.1354 | Train Acc: 0.9682
 Site-SynthDigits                   | Train Loss: 1.3215 | Train Acc: 0.5628
 Site-MNIST_M                       | Train Loss: 1.5309 | Train Acc: 0.4335
 Site-SVHN                          | Train Loss: 2.2066 | Train Acc: 0.2768
Average Train Accuracy: 0.6469
 Site-MNIST                         | Val  Loss: 0.0477 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1358 | Val  Acc: 0.9576
 Site-SynthDigits                   | Val  Loss: 1.3196 | Val  Acc: 0.5604
 Site-MNIST_M                       | Val  Loss: 1.6787 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.3949 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6108
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.0457 | Train Acc: 0.9933
 Site-USPS                          | Train Loss: 0.1204 | Train Acc: 0.9727
 Site-SynthDigits                   | Train Loss: 1.3242 | Train Acc: 0.5792
 Site-MNIST_M                       | Train Loss: 1.5827 | Train Acc: 0.4335
 Site-SVHN                          | Train Loss: 2.2408 | Train Acc: 0.2411
Average Train Accuracy: 0.6440
 Site-MNIST                         | Val  Loss: 0.0417 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.1404 | Val  Acc: 0.9576
 Site-SynthDigits                   | Val  Loss: 1.3061 | Val  Acc: 0.5934
 Site-MNIST_M                       | Val  Loss: 1.5875 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.4674 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6176
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9899
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9576
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5934
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.0429 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.1225 | Train Acc: 0.9652
 Site-SynthDigits                   | Train Loss: 1.2872 | Train Acc: 0.5929
 Site-MNIST_M                       | Train Loss: 1.5395 | Train Acc: 0.4581
 Site-SVHN                          | Train Loss: 2.2348 | Train Acc: 0.2411
Average Train Accuracy: 0.6504
 Site-MNIST                         | Val  Loss: 0.0401 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1315 | Val  Acc: 0.9576
 Site-SynthDigits                   | Val  Loss: 1.2728 | Val  Acc: 0.6044
 Site-MNIST_M                       | Val  Loss: 1.5839 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.4577 | Val  Acc: 0.0714
Average Valid Accuracy: 0.6213
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9576
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6044
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4800
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.0406 | Train Acc: 0.9933
 Site-USPS                          | Train Loss: 0.1159 | Train Acc: 0.9667
 Site-SynthDigits                   | Train Loss: 1.2789 | Train Acc: 0.5902
 Site-MNIST_M                       | Train Loss: 1.5557 | Train Acc: 0.4680
 Site-SVHN                          | Train Loss: 2.2912 | Train Acc: 0.2143
Average Train Accuracy: 0.6465
 Site-MNIST                         | Val  Loss: 0.0362 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1460 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.2523 | Val  Acc: 0.6374
 Site-MNIST_M                       | Val  Loss: 1.5297 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.5744 | Val  Acc: 0.0714
Average Valid Accuracy: 0.6215
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9455
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6374
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.4600
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.0357 | Train Acc: 0.9958
 Site-USPS                          | Train Loss: 0.1056 | Train Acc: 0.9727
 Site-SynthDigits                   | Train Loss: 1.2364 | Train Acc: 0.6120
 Site-MNIST_M                       | Train Loss: 1.5974 | Train Acc: 0.4680
 Site-SVHN                          | Train Loss: 2.3102 | Train Acc: 0.2321
Average Train Accuracy: 0.6561
 Site-MNIST                         | Val  Loss: 0.0309 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.1162 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.1781 | Val  Acc: 0.6374
 Site-MNIST_M                       | Val  Loss: 1.5717 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.5024 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6410
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9966
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9636
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.6374
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.0356 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0918 | Train Acc: 0.9773
 Site-SynthDigits                   | Train Loss: 1.2370 | Train Acc: 0.6148
 Site-MNIST_M                       | Train Loss: 1.5303 | Train Acc: 0.4680
 Site-SVHN                          | Train Loss: 2.3226 | Train Acc: 0.2321
Average Train Accuracy: 0.6574
 Site-MNIST                         | Val  Loss: 0.0316 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.0966 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.1917 | Val  Acc: 0.6374
 Site-MNIST_M                       | Val  Loss: 1.5122 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.5453 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6458
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9758
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6374
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4800
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.0313 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.1050 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 1.2126 | Train Acc: 0.6093
 Site-MNIST_M                       | Train Loss: 1.5166 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.3011 | Train Acc: 0.2143
Average Train Accuracy: 0.6488
 Site-MNIST                         | Val  Loss: 0.0273 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.1030 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.1693 | Val  Acc: 0.6154
 Site-MNIST_M                       | Val  Loss: 1.5480 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.5226 | Val  Acc: 0.0714
Average Valid Accuracy: 0.6254
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.0311 | Train Acc: 0.9941
 Site-USPS                          | Train Loss: 0.0904 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 1.1911 | Train Acc: 0.6202
 Site-MNIST_M                       | Train Loss: 1.7052 | Train Acc: 0.4729
 Site-SVHN                          | Train Loss: 2.2454 | Train Acc: 0.2411
Average Train Accuracy: 0.6608
 Site-MNIST                         | Val  Loss: 0.0271 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.1063 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.1385 | Val  Acc: 0.6484
 Site-MNIST_M                       | Val  Loss: 1.5715 | Val  Acc: 0.5200
 Site-SVHN                          | Val  Loss: 2.4788 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6477
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9933
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9697
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6484
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5200
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.0290 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0763 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 1.2385 | Train Acc: 0.6066
 Site-MNIST_M                       | Train Loss: 1.4994 | Train Acc: 0.4729
 Site-SVHN                          | Train Loss: 2.3080 | Train Acc: 0.2143
Average Train Accuracy: 0.6532
 Site-MNIST                         | Val  Loss: 0.0242 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0821 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.1565 | Val  Acc: 0.6593
 Site-MNIST_M                       | Val  Loss: 1.5876 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.5220 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6426
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.0318 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0811 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.1758 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.5890 | Train Acc: 0.4877
 Site-SVHN                          | Train Loss: 2.3113 | Train Acc: 0.2232
Average Train Accuracy: 0.6629
 Site-MNIST                         | Val  Loss: 0.0281 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0828 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.0933 | Val  Acc: 0.7033
 Site-MNIST_M                       | Val  Loss: 1.5569 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.5514 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6554
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9966
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9697
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.7033
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.0229 | Train Acc: 0.9975
 Site-USPS                          | Train Loss: 0.0825 | Train Acc: 0.9818
 Site-SynthDigits                   | Train Loss: 1.1741 | Train Acc: 0.6230
 Site-MNIST_M                       | Train Loss: 1.4461 | Train Acc: 0.4877
 Site-SVHN                          | Train Loss: 2.2991 | Train Acc: 0.2143
Average Train Accuracy: 0.6608
 Site-MNIST                         | Val  Loss: 0.0193 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0800 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.0798 | Val  Acc: 0.6703
 Site-MNIST_M                       | Val  Loss: 1.4788 | Val  Acc: 0.5200
 Site-SVHN                          | Val  Loss: 2.6008 | Val  Acc: 0.0714
Average Valid Accuracy: 0.6456
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.0207 | Train Acc: 0.9975
 Site-USPS                          | Train Loss: 0.0680 | Train Acc: 0.9818
 Site-SynthDigits                   | Train Loss: 1.1699 | Train Acc: 0.6393
 Site-MNIST_M                       | Train Loss: 1.4646 | Train Acc: 0.5271
 Site-SVHN                          | Train Loss: 2.2907 | Train Acc: 0.2232
Average Train Accuracy: 0.6738
 Site-MNIST                         | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0707 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.1121 | Val  Acc: 0.6484
 Site-MNIST_M                       | Val  Loss: 1.4701 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 2.5572 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6583
 Best site-MNIST                     | Epoch:30 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9758
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6484
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5600
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.0177 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0808 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 1.1375 | Train Acc: 0.6366
 Site-MNIST_M                       | Train Loss: 1.4952 | Train Acc: 0.4828
 Site-SVHN                          | Train Loss: 2.3136 | Train Acc: 0.2143
Average Train Accuracy: 0.6617
 Site-MNIST                         | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0807 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.0712 | Val  Acc: 0.6484
 Site-MNIST_M                       | Val  Loss: 1.5410 | Val  Acc: 0.5200
 Site-SVHN                          | Val  Loss: 2.6029 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6490
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.0172 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0589 | Train Acc: 0.9818
 Site-SynthDigits                   | Train Loss: 1.1481 | Train Acc: 0.6257
 Site-MNIST_M                       | Train Loss: 1.3941 | Train Acc: 0.5320
 Site-SVHN                          | Train Loss: 2.2754 | Train Acc: 0.2500
Average Train Accuracy: 0.6777
 Site-MNIST                         | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0646 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.0672 | Val  Acc: 0.6374
 Site-MNIST_M                       | Val  Loss: 1.4414 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 2.5898 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6660
 Best site-MNIST                     | Epoch:32 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9697
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6374
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5800
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.0144 | Train Acc: 0.9983
 Site-USPS                          | Train Loss: 0.0616 | Train Acc: 0.9773
 Site-SynthDigits                   | Train Loss: 1.0888 | Train Acc: 0.6393
 Site-MNIST_M                       | Train Loss: 1.4554 | Train Acc: 0.5271
 Site-SVHN                          | Train Loss: 2.3082 | Train Acc: 0.2500
Average Train Accuracy: 0.6784
 Site-MNIST                         | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0735 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.0465 | Val  Acc: 0.6703
 Site-MNIST_M                       | Val  Loss: 1.5099 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 2.5528 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6674
 Best site-MNIST                     | Epoch:33 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9636
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6703
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5600
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.0144 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0646 | Train Acc: 0.9833
 Site-SynthDigits                   | Train Loss: 1.1240 | Train Acc: 0.6311
 Site-MNIST_M                       | Train Loss: 1.3833 | Train Acc: 0.5025
 Site-SVHN                          | Train Loss: 2.3561 | Train Acc: 0.2232
Average Train Accuracy: 0.6679
 Site-MNIST                         | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0664 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.0595 | Val  Acc: 0.6593
 Site-MNIST_M                       | Val  Loss: 1.4922 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.5921 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6472
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.0136 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0609 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 1.1307 | Train Acc: 0.6311
 Site-MNIST_M                       | Train Loss: 1.4055 | Train Acc: 0.4926
 Site-SVHN                          | Train Loss: 2.3841 | Train Acc: 0.2232
Average Train Accuracy: 0.6662
 Site-MNIST                         | Val  Loss: 0.0129 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0772 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.0635 | Val  Acc: 0.6374
 Site-MNIST_M                       | Val  Loss: 1.5839 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.6120 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6413
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.0141 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0488 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 1.0919 | Train Acc: 0.6421
 Site-MNIST_M                       | Train Loss: 1.4800 | Train Acc: 0.5271
 Site-SVHN                          | Train Loss: 2.3839 | Train Acc: 0.2232
Average Train Accuracy: 0.6762
 Site-MNIST                         | Val  Loss: 0.0123 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0594 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 0.9978 | Val  Acc: 0.6703
 Site-MNIST_M                       | Val  Loss: 1.4330 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 2.6445 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6698
 Best site-MNIST                     | Epoch:36 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9758
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.6703
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5600
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.0127 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0461 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 1.1025 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.4653 | Train Acc: 0.5172
 Site-SVHN                          | Train Loss: 2.4392 | Train Acc: 0.2054
Average Train Accuracy: 0.6685
 Site-MNIST                         | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0508 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 0.9809 | Val  Acc: 0.6813
 Site-MNIST_M                       | Val  Loss: 1.4424 | Val  Acc: 0.5400
 Site-SVHN                          | Val  Loss: 2.6954 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6633
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.0124 | Train Acc: 0.9983
 Site-USPS                          | Train Loss: 0.0510 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 1.0621 | Train Acc: 0.6721
 Site-MNIST_M                       | Train Loss: 1.3751 | Train Acc: 0.5369
 Site-SVHN                          | Train Loss: 2.3902 | Train Acc: 0.2054
Average Train Accuracy: 0.6798
 Site-MNIST                         | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0546 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 0.9707 | Val  Acc: 0.6923
 Site-MNIST_M                       | Val  Loss: 1.4155 | Val  Acc: 0.5400
 Site-SVHN                          | Val  Loss: 2.6222 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6643
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.0107 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0494 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 1.0176 | Train Acc: 0.6858
 Site-MNIST_M                       | Train Loss: 1.4882 | Train Acc: 0.5320
 Site-SVHN                          | Train Loss: 2.4179 | Train Acc: 0.2321
Average Train Accuracy: 0.6877
 Site-MNIST                         | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0600 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 0.9236 | Val  Acc: 0.6703
 Site-MNIST_M                       | Val  Loss: 1.4629 | Val  Acc: 0.5200
 Site-SVHN                          | Val  Loss: 2.6180 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6559
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.0088 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0414 | Train Acc: 0.9939
 Site-SynthDigits                   | Train Loss: 1.0045 | Train Acc: 0.6858
 Site-MNIST_M                       | Train Loss: 1.4726 | Train Acc: 0.5271
 Site-SVHN                          | Train Loss: 2.3687 | Train Acc: 0.2589
Average Train Accuracy: 0.6930
 Site-MNIST                         | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0435 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.9246 | Val  Acc: 0.7143
 Site-MNIST_M                       | Val  Loss: 1.4529 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 2.5379 | Val  Acc: 0.1786
Average Valid Accuracy: 0.6894
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9939
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7143
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5600
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.0080 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.0431 | Train Acc: 0.9879
 Site-SynthDigits                   | Train Loss: 1.0279 | Train Acc: 0.6721
 Site-MNIST_M                       | Train Loss: 1.3565 | Train Acc: 0.5517
 Site-SVHN                          | Train Loss: 2.2814 | Train Acc: 0.2768
Average Train Accuracy: 0.6977
 Site-MNIST                         | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0461 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 0.9190 | Val  Acc: 0.7033
 Site-MNIST_M                       | Val  Loss: 1.4164 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 2.5880 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6971
 Best site-MNIST                     | Epoch:41 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9879
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.7033
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5800
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.0441 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 1.0150 | Train Acc: 0.6694
 Site-MNIST_M                       | Train Loss: 1.4086 | Train Acc: 0.5369
 Site-SVHN                          | Train Loss: 2.4025 | Train Acc: 0.2232
Average Train Accuracy: 0.6832
 Site-MNIST                         | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0481 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 0.9064 | Val  Acc: 0.7143
 Site-MNIST_M                       | Val  Loss: 1.4563 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 2.6227 | Val  Acc: 0.1786
Average Valid Accuracy: 0.6897
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.0078 | Train Acc: 0.9992
 Site-USPS                          | Train Loss: 0.0553 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.0009 | Train Acc: 0.6667
 Site-MNIST_M                       | Train Loss: 1.4931 | Train Acc: 0.5025
 Site-SVHN                          | Train Loss: 2.4733 | Train Acc: 0.2411
Average Train Accuracy: 0.6776
 Site-MNIST                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0548 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 0.9284 | Val  Acc: 0.7033
 Site-MNIST_M                       | Val  Loss: 1.5324 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.6539 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6775
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.0414 | Train Acc: 0.9879
 Site-SynthDigits                   | Train Loss: 1.0102 | Train Acc: 0.6803
 Site-MNIST_M                       | Train Loss: 1.4807 | Train Acc: 0.5419
 Site-SVHN                          | Train Loss: 2.4486 | Train Acc: 0.2321
Average Train Accuracy: 0.6884
 Site-MNIST                         | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0422 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 0.9145 | Val  Acc: 0.7143
 Site-MNIST_M                       | Val  Loss: 1.4662 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 2.6315 | Val  Acc: 0.1071
Average Valid Accuracy: 0.6779
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.0062 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.0337 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 0.9991 | Train Acc: 0.6803
 Site-MNIST_M                       | Train Loss: 1.5754 | Train Acc: 0.5616
 Site-SVHN                          | Train Loss: 2.4535 | Train Acc: 0.2321
Average Train Accuracy: 0.6933
 Site-MNIST                         | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0355 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.9130 | Val  Acc: 0.7143
 Site-MNIST_M                       | Val  Loss: 1.3933 | Val  Acc: 0.6200
 Site-SVHN                          | Val  Loss: 2.6677 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6942
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.0360 | Train Acc: 0.9939
 Site-SynthDigits                   | Train Loss: 0.9733 | Train Acc: 0.6940
 Site-MNIST_M                       | Train Loss: 1.3620 | Train Acc: 0.5665
 Site-SVHN                          | Train Loss: 2.4933 | Train Acc: 0.2143
Average Train Accuracy: 0.6937
 Site-MNIST                         | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0420 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.9040 | Val  Acc: 0.7363
 Site-MNIST_M                       | Val  Loss: 1.4030 | Val  Acc: 0.6200
 Site-SVHN                          | Val  Loss: 2.6532 | Val  Acc: 0.1786
Average Valid Accuracy: 0.7058
 Best site-MNIST                     | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9939
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.7363
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6200
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedsam...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.0056 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.0377 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 0.9427 | Train Acc: 0.7049
 Site-MNIST_M                       | Train Loss: 1.4647 | Train Acc: 0.5616
 Site-SVHN                          | Train Loss: 2.4386 | Train Acc: 0.2411
Average Train Accuracy: 0.6988
 Site-MNIST                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0518 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 0.8655 | Val  Acc: 0.7363
 Site-MNIST_M                       | Val  Loss: 1.3516 | Val  Acc: 0.6000
 Site-SVHN                          | Val  Loss: 2.7434 | Val  Acc: 0.2143
Average Valid Accuracy: 0.7053
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.0056 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.0313 | Train Acc: 0.9970
 Site-SynthDigits                   | Train Loss: 0.9687 | Train Acc: 0.6858
 Site-MNIST_M                       | Train Loss: 1.5654 | Train Acc: 0.5714
 Site-SVHN                          | Train Loss: 2.4142 | Train Acc: 0.2143
Average Train Accuracy: 0.6937
 Site-MNIST                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.8720 | Val  Acc: 0.7253
 Site-MNIST_M                       | Val  Loss: 1.3488 | Val  Acc: 0.6000
 Site-SVHN                          | Val  Loss: 2.6657 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6936
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.0312 | Train Acc: 0.9939
 Site-SynthDigits                   | Train Loss: 0.9245 | Train Acc: 0.7022
 Site-MNIST_M                       | Train Loss: 1.5047 | Train Acc: 0.5616
 Site-SVHN                          | Train Loss: 2.4393 | Train Acc: 0.2143
Average Train Accuracy: 0.6944
 Site-MNIST                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0378 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 0.8394 | Val  Acc: 0.7582
 Site-MNIST_M                       | Val  Loss: 1.3258 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 2.8029 | Val  Acc: 0.1786
Average Valid Accuracy: 0.7009
===2023-07-02 06:16:24===
===2023-07-02 06:16:26===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:46 | Test Acc: 0.9443
 Test site-USPS                      | Epoch:46 | Test Acc: 0.9484
 Test site-SynthDigits               | Epoch:46 | Test Acc: 0.5410
 Test site-MNIST_M                   | Epoch:46 | Test Acc: 0.3269
 Test site-SVHN                      | Epoch:46 | Test Acc: 0.2091
MNIST: 0.9443, USPS: 0.9484, SynthDigits: 0.5410, MNIST_M: 0.3269, SVHN: 0.2091, 
Average Test Accuracy(group): 0.5939, Average Test Accuracy(individual): 0.5939,
domain std=0.3068, cluster std=-1.0000, individual std=0.3068, 
