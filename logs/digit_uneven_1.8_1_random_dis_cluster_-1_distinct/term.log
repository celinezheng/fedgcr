===2023-07-02 01:43:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0118 | Train Acc: 0.6501
 Site-USPS                          | Train Loss: 2.0046 | Train Acc: 0.5818
 Site-SynthDigits                   | Train Loss: 2.2456 | Train Acc: 0.2295
 Site-MNIST_M                       | Train Loss: 2.2779 | Train Acc: 0.1527
 Site-SVHN                          | Train Loss: 2.2805 | Train Acc: 0.1071
Average Train Accuracy: 0.3443
 Site-MNIST                         | Val  Loss: 2.0127 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.9960 | Val  Acc: 0.5818
 Site-SynthDigits                   | Val  Loss: 2.2476 | Val  Acc: 0.1978
 Site-MNIST_M                       | Val  Loss: 2.2815 | Val  Acc: 0.1400
 Site-SVHN                          | Val  Loss: 2.2723 | Val  Acc: 0.1429
Average Valid Accuracy: 0.3458
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5818
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1978
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1400
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.7377 | Train Acc: 0.7368
 Site-USPS                          | Train Loss: 1.7525 | Train Acc: 0.6803
 Site-SynthDigits                   | Train Loss: 2.1776 | Train Acc: 0.2869
 Site-MNIST_M                       | Train Loss: 2.2543 | Train Acc: 0.2217
 Site-SVHN                          | Train Loss: 2.2688 | Train Acc: 0.1429
Average Train Accuracy: 0.4137
 Site-MNIST                         | Val  Loss: 1.7313 | Val  Acc: 0.7508
 Site-USPS                          | Val  Loss: 1.7391 | Val  Acc: 0.6606
 Site-SynthDigits                   | Val  Loss: 2.1770 | Val  Acc: 0.2747
 Site-MNIST_M                       | Val  Loss: 2.2534 | Val  Acc: 0.2000
 Site-SVHN                          | Val  Loss: 2.2607 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4201
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7508
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6606
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2747
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2000
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.5124 | Train Acc: 0.7796
 Site-USPS                          | Train Loss: 1.5186 | Train Acc: 0.7379
 Site-SynthDigits                   | Train Loss: 2.1188 | Train Acc: 0.2896
 Site-MNIST_M                       | Train Loss: 2.2003 | Train Acc: 0.2611
 Site-SVHN                          | Train Loss: 2.2542 | Train Acc: 0.1339
Average Train Accuracy: 0.4404
 Site-MNIST                         | Val  Loss: 1.5078 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 1.5087 | Val  Acc: 0.7394
 Site-SynthDigits                   | Val  Loss: 2.1143 | Val  Acc: 0.3187
 Site-MNIST_M                       | Val  Loss: 2.2245 | Val  Acc: 0.1800
 Site-SVHN                          | Val  Loss: 2.2484 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4355
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7394
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3187
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1800
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.3159 | Train Acc: 0.7965
 Site-USPS                          | Train Loss: 1.3453 | Train Acc: 0.7758
 Site-SynthDigits                   | Train Loss: 2.0671 | Train Acc: 0.3033
 Site-MNIST_M                       | Train Loss: 2.2044 | Train Acc: 0.2611
 Site-SVHN                          | Train Loss: 2.2313 | Train Acc: 0.1786
Average Train Accuracy: 0.4630
 Site-MNIST                         | Val  Loss: 1.3050 | Val  Acc: 0.7912
 Site-USPS                          | Val  Loss: 1.3216 | Val  Acc: 0.7939
 Site-SynthDigits                   | Val  Loss: 2.0583 | Val  Acc: 0.3297
 Site-MNIST_M                       | Val  Loss: 2.2027 | Val  Acc: 0.2000
 Site-SVHN                          | Val  Loss: 2.2248 | Val  Acc: 0.3214
Average Valid Accuracy: 0.4873
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7912
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7939
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3297
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2000
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.1361 | Train Acc: 0.8209
 Site-USPS                          | Train Loss: 1.1657 | Train Acc: 0.8030
 Site-SynthDigits                   | Train Loss: 2.0227 | Train Acc: 0.3224
 Site-MNIST_M                       | Train Loss: 2.1630 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.2299 | Train Acc: 0.1607
Average Train Accuracy: 0.4785
 Site-MNIST                         | Val  Loss: 1.1248 | Val  Acc: 0.8114
 Site-USPS                          | Val  Loss: 1.1403 | Val  Acc: 0.8121
 Site-SynthDigits                   | Val  Loss: 2.0183 | Val  Acc: 0.3516
 Site-MNIST_M                       | Val  Loss: 2.1770 | Val  Acc: 0.2600
 Site-SVHN                          | Val  Loss: 2.2251 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4970
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8114
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8121
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3516
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2600
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.0100 | Train Acc: 0.8301
 Site-USPS                          | Train Loss: 1.0333 | Train Acc: 0.8227
 Site-SynthDigits                   | Train Loss: 1.9814 | Train Acc: 0.3251
 Site-MNIST_M                       | Train Loss: 2.1127 | Train Acc: 0.3005
 Site-SVHN                          | Train Loss: 2.2122 | Train Acc: 0.1786
Average Train Accuracy: 0.4914
 Site-MNIST                         | Val  Loss: 0.9900 | Val  Acc: 0.8283
 Site-USPS                          | Val  Loss: 1.0057 | Val  Acc: 0.8303
 Site-SynthDigits                   | Val  Loss: 1.9718 | Val  Acc: 0.3736
 Site-MNIST_M                       | Val  Loss: 2.1545 | Val  Acc: 0.2800
 Site-SVHN                          | Val  Loss: 2.2098 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5053
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8283
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8303
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3736
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2800
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.8940 | Train Acc: 0.8335
 Site-USPS                          | Train Loss: 0.9247 | Train Acc: 0.8333
 Site-SynthDigits                   | Train Loss: 1.9502 | Train Acc: 0.3361
 Site-MNIST_M                       | Train Loss: 2.0852 | Train Acc: 0.3251
 Site-SVHN                          | Train Loss: 2.2095 | Train Acc: 0.2054
Average Train Accuracy: 0.5067
 Site-MNIST                         | Val  Loss: 0.8783 | Val  Acc: 0.8418
 Site-USPS                          | Val  Loss: 0.8962 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.9405 | Val  Acc: 0.3626
 Site-MNIST_M                       | Val  Loss: 2.1330 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.2052 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5202
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8418
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3626
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.8107 | Train Acc: 0.8436
 Site-USPS                          | Train Loss: 0.8232 | Train Acc: 0.8439
 Site-SynthDigits                   | Train Loss: 1.9156 | Train Acc: 0.3607
 Site-MNIST_M                       | Train Loss: 2.0813 | Train Acc: 0.3153
 Site-SVHN                          | Train Loss: 2.2110 | Train Acc: 0.2054
Average Train Accuracy: 0.5138
 Site-MNIST                         | Val  Loss: 0.7862 | Val  Acc: 0.8384
 Site-USPS                          | Val  Loss: 0.8074 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.9108 | Val  Acc: 0.3846
 Site-MNIST_M                       | Val  Loss: 2.1025 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.1987 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5128
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.7319 | Train Acc: 0.8562
 Site-USPS                          | Train Loss: 0.7598 | Train Acc: 0.8485
 Site-SynthDigits                   | Train Loss: 1.8890 | Train Acc: 0.3634
 Site-MNIST_M                       | Train Loss: 2.0086 | Train Acc: 0.3399
 Site-SVHN                          | Train Loss: 2.2096 | Train Acc: 0.1964
Average Train Accuracy: 0.5209
 Site-MNIST                         | Val  Loss: 0.7065 | Val  Acc: 0.8586
 Site-USPS                          | Val  Loss: 0.7461 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.8916 | Val  Acc: 0.3846
 Site-MNIST_M                       | Val  Loss: 2.0875 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1969 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5261
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8586
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8485
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3846
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.6687 | Train Acc: 0.8612
 Site-USPS                          | Train Loss: 0.6949 | Train Acc: 0.8621
 Site-SynthDigits                   | Train Loss: 1.8779 | Train Acc: 0.3880
 Site-MNIST_M                       | Train Loss: 2.0444 | Train Acc: 0.3547
 Site-SVHN                          | Train Loss: 2.2112 | Train Acc: 0.2143
Average Train Accuracy: 0.5361
 Site-MNIST                         | Val  Loss: 0.6443 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.6826 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.8710 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 2.0722 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1953 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5342
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8653
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8606
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4066
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.6180 | Train Acc: 0.8671
 Site-USPS                          | Train Loss: 0.6451 | Train Acc: 0.8667
 Site-SynthDigits                   | Train Loss: 1.8665 | Train Acc: 0.3880
 Site-MNIST_M                       | Train Loss: 2.0073 | Train Acc: 0.3547
 Site-SVHN                          | Train Loss: 2.2085 | Train Acc: 0.2321
Average Train Accuracy: 0.5417
 Site-MNIST                         | Val  Loss: 0.5973 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.6309 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.8508 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 2.0396 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1866 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5336
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.5770 | Train Acc: 0.8789
 Site-USPS                          | Train Loss: 0.6159 | Train Acc: 0.8667
 Site-SynthDigits                   | Train Loss: 1.8500 | Train Acc: 0.3989
 Site-MNIST_M                       | Train Loss: 1.9759 | Train Acc: 0.3547
 Site-SVHN                          | Train Loss: 2.1983 | Train Acc: 0.2321
Average Train Accuracy: 0.5463
 Site-MNIST                         | Val  Loss: 0.5506 | Val  Acc: 0.8721
 Site-USPS                          | Val  Loss: 0.6016 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.8476 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 2.0303 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1959 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5328
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.5505 | Train Acc: 0.8696
 Site-USPS                          | Train Loss: 0.5834 | Train Acc: 0.8758
 Site-SynthDigits                   | Train Loss: 1.8083 | Train Acc: 0.4098
 Site-MNIST_M                       | Train Loss: 1.9339 | Train Acc: 0.3695
 Site-SVHN                          | Train Loss: 2.2007 | Train Acc: 0.2143
Average Train Accuracy: 0.5478
 Site-MNIST                         | Val  Loss: 0.5256 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.5564 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8183 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.9980 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1832 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5389
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8687
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.4990 | Train Acc: 0.8966
 Site-USPS                          | Train Loss: 0.5543 | Train Acc: 0.8712
 Site-SynthDigits                   | Train Loss: 1.8362 | Train Acc: 0.4071
 Site-MNIST_M                       | Train Loss: 1.9325 | Train Acc: 0.3202
 Site-SVHN                          | Train Loss: 2.2037 | Train Acc: 0.2232
Average Train Accuracy: 0.5437
 Site-MNIST                         | Val  Loss: 0.4713 | Val  Acc: 0.8923
 Site-USPS                          | Val  Loss: 0.5552 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8510 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 2.0241 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.2157 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5312
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.4792 | Train Acc: 0.8932
 Site-USPS                          | Train Loss: 0.5196 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.7990 | Train Acc: 0.4208
 Site-MNIST_M                       | Train Loss: 1.9462 | Train Acc: 0.3547
 Site-SVHN                          | Train Loss: 2.2041 | Train Acc: 0.2054
Average Train Accuracy: 0.5512
 Site-MNIST                         | Val  Loss: 0.4523 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.5110 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.8131 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.9763 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.1946 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5352
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.4455 | Train Acc: 0.9016
 Site-USPS                          | Train Loss: 0.5168 | Train Acc: 0.8833
 Site-SynthDigits                   | Train Loss: 1.7974 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 1.9003 | Train Acc: 0.3645
 Site-SVHN                          | Train Loss: 2.2030 | Train Acc: 0.2054
Average Train Accuracy: 0.5568
 Site-MNIST                         | Val  Loss: 0.4208 | Val  Acc: 0.9057
 Site-USPS                          | Val  Loss: 0.4877 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.8101 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.9627 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.1983 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5507
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9057
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.3200
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.4164 | Train Acc: 0.9193
 Site-USPS                          | Train Loss: 0.4745 | Train Acc: 0.8727
 Site-SynthDigits                   | Train Loss: 1.7979 | Train Acc: 0.4180
 Site-MNIST_M                       | Train Loss: 1.9510 | Train Acc: 0.3498
 Site-SVHN                          | Train Loss: 2.1869 | Train Acc: 0.1964
Average Train Accuracy: 0.5512
 Site-MNIST                         | Val  Loss: 0.3877 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.4876 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8143 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.9772 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.2056 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5457
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.3998 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.4485 | Train Acc: 0.8909
 Site-SynthDigits                   | Train Loss: 1.7835 | Train Acc: 0.4262
 Site-MNIST_M                       | Train Loss: 1.8569 | Train Acc: 0.3744
 Site-SVHN                          | Train Loss: 2.2001 | Train Acc: 0.1964
Average Train Accuracy: 0.5609
 Site-MNIST                         | Val  Loss: 0.3714 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.4505 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.8011 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.9372 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.1987 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5381
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.3692 | Train Acc: 0.9260
 Site-USPS                          | Train Loss: 0.4294 | Train Acc: 0.8924
 Site-SynthDigits                   | Train Loss: 1.7764 | Train Acc: 0.4262
 Site-MNIST_M                       | Train Loss: 1.8818 | Train Acc: 0.3498
 Site-SVHN                          | Train Loss: 2.1989 | Train Acc: 0.1696
Average Train Accuracy: 0.5528
 Site-MNIST                         | Val  Loss: 0.3489 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.4415 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.8019 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.9292 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.2065 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5275
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.3595 | Train Acc: 0.9235
 Site-USPS                          | Train Loss: 0.4125 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.7363 | Train Acc: 0.4153
 Site-MNIST_M                       | Train Loss: 1.8404 | Train Acc: 0.3498
 Site-SVHN                          | Train Loss: 2.1907 | Train Acc: 0.1786
Average Train Accuracy: 0.5549
 Site-MNIST                         | Val  Loss: 0.3370 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.4116 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.7695 | Val  Acc: 0.3956
 Site-MNIST_M                       | Val  Loss: 1.9205 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.1787 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5286
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.3526 | Train Acc: 0.9243
 Site-USPS                          | Train Loss: 0.3880 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.7348 | Train Acc: 0.4344
 Site-MNIST_M                       | Train Loss: 1.8222 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.1854 | Train Acc: 0.2232
Average Train Accuracy: 0.5767
 Site-MNIST                         | Val  Loss: 0.3267 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.3981 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7482 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8800 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1895 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5551
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9226
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8970
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4176
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.3376 | Train Acc: 0.9260
 Site-USPS                          | Train Loss: 0.3759 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.7176 | Train Acc: 0.4344
 Site-MNIST_M                       | Train Loss: 1.7650 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.1759 | Train Acc: 0.2232
Average Train Accuracy: 0.5783
 Site-MNIST                         | Val  Loss: 0.3106 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.3789 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.7412 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.8813 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1782 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5664
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9259
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.3244 | Train Acc: 0.9294
 Site-USPS                          | Train Loss: 0.3736 | Train Acc: 0.9106
 Site-SynthDigits                   | Train Loss: 1.7112 | Train Acc: 0.4344
 Site-MNIST_M                       | Train Loss: 1.8760 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.1732 | Train Acc: 0.2321
Average Train Accuracy: 0.5801
 Site-MNIST                         | Val  Loss: 0.2982 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.3717 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7300 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.8869 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1790 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5676
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9259
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.3070 | Train Acc: 0.9344
 Site-USPS                          | Train Loss: 0.3587 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.6943 | Train Acc: 0.4454
 Site-MNIST_M                       | Train Loss: 1.8797 | Train Acc: 0.3842
 Site-SVHN                          | Train Loss: 2.2092 | Train Acc: 0.1964
Average Train Accuracy: 0.5745
 Site-MNIST                         | Val  Loss: 0.2851 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3667 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7283 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8626 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2070 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5603
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.2925 | Train Acc: 0.9378
 Site-USPS                          | Train Loss: 0.3635 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.6956 | Train Acc: 0.4426
 Site-MNIST_M                       | Train Loss: 1.8177 | Train Acc: 0.3695
 Site-SVHN                          | Train Loss: 2.2008 | Train Acc: 0.1786
Average Train Accuracy: 0.5675
 Site-MNIST                         | Val  Loss: 0.2687 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3660 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7258 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8687 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.2194 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5373
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.2843 | Train Acc: 0.9394
 Site-USPS                          | Train Loss: 0.3403 | Train Acc: 0.9197
 Site-SynthDigits                   | Train Loss: 1.6824 | Train Acc: 0.4426
 Site-MNIST_M                       | Train Loss: 1.8460 | Train Acc: 0.3793
 Site-SVHN                          | Train Loss: 2.1933 | Train Acc: 0.1964
Average Train Accuracy: 0.5755
 Site-MNIST                         | Val  Loss: 0.2617 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3428 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7081 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8531 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2041 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5538
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.2736 | Train Acc: 0.9403
 Site-USPS                          | Train Loss: 0.3277 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.6801 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.8234 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.1753 | Train Acc: 0.2054
Average Train Accuracy: 0.5818
 Site-MNIST                         | Val  Loss: 0.2536 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3324 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7126 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8356 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2189 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5523
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.2631 | Train Acc: 0.9437
 Site-USPS                          | Train Loss: 0.3244 | Train Acc: 0.9197
 Site-SynthDigits                   | Train Loss: 1.6741 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 1.7964 | Train Acc: 0.3744
 Site-SVHN                          | Train Loss: 2.1752 | Train Acc: 0.2054
Average Train Accuracy: 0.5788
 Site-MNIST                         | Val  Loss: 0.2422 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3276 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7069 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8594 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2165 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5576
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.2613 | Train Acc: 0.9403
 Site-USPS                          | Train Loss: 0.3202 | Train Acc: 0.9197
 Site-SynthDigits                   | Train Loss: 1.6372 | Train Acc: 0.4645
 Site-MNIST_M                       | Train Loss: 1.7938 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.2180 | Train Acc: 0.2054
Average Train Accuracy: 0.5848
 Site-MNIST                         | Val  Loss: 0.2408 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3161 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6771 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7942 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2428 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5705
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.2613 | Train Acc: 0.9369
 Site-USPS                          | Train Loss: 0.3202 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.6439 | Train Acc: 0.4590
 Site-MNIST_M                       | Train Loss: 1.7697 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.2062 | Train Acc: 0.2143
Average Train Accuracy: 0.5851
 Site-MNIST                         | Val  Loss: 0.2387 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3090 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6800 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8076 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2452 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5675
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.2409 | Train Acc: 0.9479
 Site-USPS                          | Train Loss: 0.3024 | Train Acc: 0.9273
 Site-SynthDigits                   | Train Loss: 1.6372 | Train Acc: 0.4699
 Site-MNIST_M                       | Train Loss: 1.8105 | Train Acc: 0.3990
 Site-SVHN                          | Train Loss: 2.2053 | Train Acc: 0.2321
Average Train Accuracy: 0.5952
 Site-MNIST                         | Val  Loss: 0.2217 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.2998 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6832 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7861 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2401 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5732
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9529
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.2326 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.3012 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.6385 | Train Acc: 0.4536
 Site-MNIST_M                       | Train Loss: 1.7443 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.1978 | Train Acc: 0.2321
Average Train Accuracy: 0.5901
 Site-MNIST                         | Val  Loss: 0.2137 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3004 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6685 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.7668 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2525 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5771
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9495
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4066
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.2197 | Train Acc: 0.9512
 Site-USPS                          | Train Loss: 0.2926 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.6401 | Train Acc: 0.4617
 Site-MNIST_M                       | Train Loss: 1.7283 | Train Acc: 0.3842
 Site-SVHN                          | Train Loss: 2.2021 | Train Acc: 0.2232
Average Train Accuracy: 0.5889
 Site-MNIST                         | Val  Loss: 0.2015 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2987 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.6812 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.7964 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2502 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5690
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.2187 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.2695 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.6092 | Train Acc: 0.4563
 Site-MNIST_M                       | Train Loss: 1.7313 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.1896 | Train Acc: 0.2411
Average Train Accuracy: 0.5947
 Site-MNIST                         | Val  Loss: 0.2009 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2824 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6444 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.7586 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2385 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5835
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.2134 | Train Acc: 0.9495
 Site-USPS                          | Train Loss: 0.2791 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.6065 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 1.6873 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.1933 | Train Acc: 0.2321
Average Train Accuracy: 0.5918
 Site-MNIST                         | Val  Loss: 0.1949 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2822 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6416 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.7674 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2450 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5764
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.2126 | Train Acc: 0.9537
 Site-USPS                          | Train Loss: 0.2734 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.6113 | Train Acc: 0.4645
 Site-MNIST_M                       | Train Loss: 1.6832 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.1947 | Train Acc: 0.2232
Average Train Accuracy: 0.5913
 Site-MNIST                         | Val  Loss: 0.1919 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2744 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6467 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7415 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2579 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5823
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.2031 | Train Acc: 0.9537
 Site-USPS                          | Train Loss: 0.2618 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.5954 | Train Acc: 0.4754
 Site-MNIST_M                       | Train Loss: 1.7251 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.2047 | Train Acc: 0.2232
Average Train Accuracy: 0.5976
 Site-MNIST                         | Val  Loss: 0.1845 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2734 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6232 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.7353 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2539 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5832
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.2011 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2501 | Train Acc: 0.9273
 Site-SynthDigits                   | Train Loss: 1.6019 | Train Acc: 0.4590
 Site-MNIST_M                       | Train Loss: 1.7019 | Train Acc: 0.3793
 Site-SVHN                          | Train Loss: 2.2243 | Train Acc: 0.2321
Average Train Accuracy: 0.5910
 Site-MNIST                         | Val  Loss: 0.1822 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2627 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6297 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.7587 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2703 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5708
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1895 | Train Acc: 0.9605
 Site-USPS                          | Train Loss: 0.2640 | Train Acc: 0.9273
 Site-SynthDigits                   | Train Loss: 1.5891 | Train Acc: 0.4645
 Site-MNIST_M                       | Train Loss: 1.7442 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.2080 | Train Acc: 0.2143
Average Train Accuracy: 0.5941
 Site-MNIST                         | Val  Loss: 0.1749 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2618 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6237 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.7311 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2628 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5774
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1864 | Train Acc: 0.9613
 Site-USPS                          | Train Loss: 0.2569 | Train Acc: 0.9303
 Site-SynthDigits                   | Train Loss: 1.5815 | Train Acc: 0.4699
 Site-MNIST_M                       | Train Loss: 1.6897 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.2132 | Train Acc: 0.2232
Average Train Accuracy: 0.5948
 Site-MNIST                         | Val  Loss: 0.1693 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2522 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6331 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.7034 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2737 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5781
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1838 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2516 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.5787 | Train Acc: 0.4590
 Site-MNIST_M                       | Train Loss: 1.6738 | Train Acc: 0.3990
 Site-SVHN                          | Train Loss: 2.2059 | Train Acc: 0.2321
Average Train Accuracy: 0.5960
 Site-MNIST                         | Val  Loss: 0.1644 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2484 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.5983 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.7399 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2636 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5756
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1747 | Train Acc: 0.9622
 Site-USPS                          | Train Loss: 0.2389 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.5701 | Train Acc: 0.4727
 Site-MNIST_M                       | Train Loss: 1.6559 | Train Acc: 0.3842
 Site-SVHN                          | Train Loss: 2.2083 | Train Acc: 0.2589
Average Train Accuracy: 0.6026
 Site-MNIST                         | Val  Loss: 0.1566 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2495 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6324 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7293 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2970 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5726
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1724 | Train Acc: 0.9630
 Site-USPS                          | Train Loss: 0.2549 | Train Acc: 0.9379
 Site-SynthDigits                   | Train Loss: 1.5641 | Train Acc: 0.4617
 Site-MNIST_M                       | Train Loss: 1.7331 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.1889 | Train Acc: 0.2411
Average Train Accuracy: 0.5986
 Site-MNIST                         | Val  Loss: 0.1554 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2495 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.5796 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.7730 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.2484 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5904
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9731
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9273
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.4615
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1610 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.2419 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.5592 | Train Acc: 0.4781
 Site-MNIST_M                       | Train Loss: 1.6690 | Train Acc: 0.3990
 Site-SVHN                          | Train Loss: 2.1920 | Train Acc: 0.2589
Average Train Accuracy: 0.6075
 Site-MNIST                         | Val  Loss: 0.1470 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.2424 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6225 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7438 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2770 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5804
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1578 | Train Acc: 0.9689
 Site-USPS                          | Train Loss: 0.2452 | Train Acc: 0.9364
 Site-SynthDigits                   | Train Loss: 1.5703 | Train Acc: 0.4727
 Site-MNIST_M                       | Train Loss: 1.7006 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.1998 | Train Acc: 0.2500
Average Train Accuracy: 0.6074
 Site-MNIST                         | Val  Loss: 0.1441 | Val  Acc: 0.9798
 Site-USPS                          | Val  Loss: 0.2459 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6214 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.7292 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2798 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5854
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1593 | Train Acc: 0.9647
 Site-USPS                          | Train Loss: 0.2306 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.5538 | Train Acc: 0.4809
 Site-MNIST_M                       | Train Loss: 1.7285 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.1971 | Train Acc: 0.2589
Average Train Accuracy: 0.6126
 Site-MNIST                         | Val  Loss: 0.1451 | Val  Acc: 0.9798
 Site-USPS                          | Val  Loss: 0.2394 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6005 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.7234 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2844 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5916
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9798
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9273
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.4725
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1561 | Train Acc: 0.9672
 Site-USPS                          | Train Loss: 0.2279 | Train Acc: 0.9379
 Site-SynthDigits                   | Train Loss: 1.5435 | Train Acc: 0.4836
 Site-MNIST_M                       | Train Loss: 1.6442 | Train Acc: 0.3990
 Site-SVHN                          | Train Loss: 2.2313 | Train Acc: 0.2411
Average Train Accuracy: 0.6058
 Site-MNIST                         | Val  Loss: 0.1418 | Val  Acc: 0.9798
 Site-USPS                          | Val  Loss: 0.2277 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.5839 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7120 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2987 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5823
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1505 | Train Acc: 0.9672
 Site-USPS                          | Train Loss: 0.2128 | Train Acc: 0.9409
 Site-SynthDigits                   | Train Loss: 1.5315 | Train Acc: 0.4973
 Site-MNIST_M                       | Train Loss: 1.6653 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.2210 | Train Acc: 0.2500
Average Train Accuracy: 0.6119
 Site-MNIST                         | Val  Loss: 0.1351 | Val  Acc: 0.9798
 Site-USPS                          | Val  Loss: 0.2212 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.5705 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6750 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.3141 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5972
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9798
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.4945
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/term...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1469 | Train Acc: 0.9706
 Site-USPS                          | Train Loss: 0.2140 | Train Acc: 0.9455
 Site-SynthDigits                   | Train Loss: 1.5423 | Train Acc: 0.4809
 Site-MNIST_M                       | Train Loss: 1.6788 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2181 | Train Acc: 0.2411
Average Train Accuracy: 0.6094
 Site-MNIST                         | Val  Loss: 0.1316 | Val  Acc: 0.9798
 Site-USPS                          | Val  Loss: 0.2163 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.5851 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.7297 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.3294 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5825
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1408 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.2128 | Train Acc: 0.9439
 Site-SynthDigits                   | Train Loss: 1.5253 | Train Acc: 0.4973
 Site-MNIST_M                       | Train Loss: 1.7155 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.2061 | Train Acc: 0.2500
Average Train Accuracy: 0.6133
 Site-MNIST                         | Val  Loss: 0.1271 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.2186 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.5709 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.6993 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.3339 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5959
===2023-07-02 02:12:21===
===2023-07-02 02:12:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.9243
 Test site-USPS                      | Epoch:47 | Test Acc: 0.9312
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.4731
 Test site-MNIST_M                   | Epoch:47 | Test Acc: 0.3617
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2357
MNIST: 0.9243, USPS: 0.9312, SynthDigits: 0.4731, MNIST_M: 0.3617, SVHN: 0.2357, 
Average Test Accuracy(group): 0.5852, Average Test Accuracy(individual): 0.5852,
domain std=0.2896, cluster std=-1.0000, individual std=0.2896, 
