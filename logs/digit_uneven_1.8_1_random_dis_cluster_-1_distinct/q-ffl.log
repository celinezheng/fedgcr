===2023-07-02 01:09:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
denominator: 14545.66015625
 Site-MNIST                         | Train Loss: 2.1677 | Train Acc: 0.5071
 Site-USPS                          | Train Loss: 2.1700 | Train Acc: 0.5136
 Site-SynthDigits                   | Train Loss: 2.2696 | Train Acc: 0.1694
 Site-MNIST_M                       | Train Loss: 2.2864 | Train Acc: 0.1478
 Site-SVHN                          | Train Loss: 2.2822 | Train Acc: 0.1161
Average Train Accuracy: 0.2908
 Site-MNIST                         | Val  Loss: 2.1654 | Val  Acc: 0.5219
 Site-USPS                          | Val  Loss: 2.1668 | Val  Acc: 0.5394
 Site-SynthDigits                   | Val  Loss: 2.2716 | Val  Acc: 0.1758
 Site-MNIST_M                       | Val  Loss: 2.2684 | Val  Acc: 0.1400
 Site-SVHN                          | Val  Loss: 2.2779 | Val  Acc: 0.0714
Average Valid Accuracy: 0.2897
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5219
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5394
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1758
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1400
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 1 ============
denominator: 14160.8310546875
 Site-MNIST                         | Train Loss: 2.0400 | Train Acc: 0.6619
 Site-USPS                          | Train Loss: 2.0383 | Train Acc: 0.6803
 Site-SynthDigits                   | Train Loss: 2.2311 | Train Acc: 0.2322
 Site-MNIST_M                       | Train Loss: 2.2649 | Train Acc: 0.1626
 Site-SVHN                          | Train Loss: 2.2681 | Train Acc: 0.1339
Average Train Accuracy: 0.3742
 Site-MNIST                         | Val  Loss: 2.0357 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 2.0344 | Val  Acc: 0.7455
 Site-SynthDigits                   | Val  Loss: 2.2309 | Val  Acc: 0.2527
 Site-MNIST_M                       | Val  Loss: 2.2464 | Val  Acc: 0.1200
 Site-SVHN                          | Val  Loss: 2.2618 | Val  Acc: 0.1429
Average Valid Accuracy: 0.3855
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7455
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2527
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1200
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 2 ============
denominator: 13802.638671875
 Site-MNIST                         | Train Loss: 1.9198 | Train Acc: 0.6989
 Site-USPS                          | Train Loss: 1.9081 | Train Acc: 0.7303
 Site-SynthDigits                   | Train Loss: 2.1924 | Train Acc: 0.2760
 Site-MNIST_M                       | Train Loss: 2.2255 | Train Acc: 0.1921
 Site-SVHN                          | Train Loss: 2.2549 | Train Acc: 0.1518
Average Train Accuracy: 0.4098
 Site-MNIST                         | Val  Loss: 1.9144 | Val  Acc: 0.7003
 Site-USPS                          | Val  Loss: 1.8913 | Val  Acc: 0.7515
 Site-SynthDigits                   | Val  Loss: 2.1884 | Val  Acc: 0.2967
 Site-MNIST_M                       | Val  Loss: 2.2246 | Val  Acc: 0.1600
 Site-SVHN                          | Val  Loss: 2.2439 | Val  Acc: 0.1071
Average Valid Accuracy: 0.4031
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7003
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7515
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2967
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1600
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 3 ============
denominator: 13459.7861328125
 Site-MNIST                         | Train Loss: 1.8072 | Train Acc: 0.7149
 Site-USPS                          | Train Loss: 1.7682 | Train Acc: 0.7470
 Site-SynthDigits                   | Train Loss: 2.1502 | Train Acc: 0.2978
 Site-MNIST_M                       | Train Loss: 2.2003 | Train Acc: 0.2414
 Site-SVHN                          | Train Loss: 2.2429 | Train Acc: 0.1875
Average Train Accuracy: 0.4377
 Site-MNIST                         | Val  Loss: 1.7977 | Val  Acc: 0.7172
 Site-USPS                          | Val  Loss: 1.7620 | Val  Acc: 0.7455
 Site-SynthDigits                   | Val  Loss: 2.1468 | Val  Acc: 0.3077
 Site-MNIST_M                       | Val  Loss: 2.1997 | Val  Acc: 0.2200
 Site-SVHN                          | Val  Loss: 2.2231 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4409
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7172
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7455
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3077
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2200
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 4 ============
denominator: 13182.408203125
 Site-MNIST                         | Train Loss: 1.6873 | Train Acc: 0.7241
 Site-USPS                          | Train Loss: 1.6449 | Train Acc: 0.7636
 Site-SynthDigits                   | Train Loss: 2.1135 | Train Acc: 0.3169
 Site-MNIST_M                       | Train Loss: 2.1791 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.2264 | Train Acc: 0.1875
Average Train Accuracy: 0.4556
 Site-MNIST                         | Val  Loss: 1.6766 | Val  Acc: 0.7374
 Site-USPS                          | Val  Loss: 1.6267 | Val  Acc: 0.7273
 Site-SynthDigits                   | Val  Loss: 2.1052 | Val  Acc: 0.3516
 Site-MNIST_M                       | Val  Loss: 2.1762 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.2093 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4630
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7374
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7273
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3516
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3200
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 5 ============
denominator: 12844.7861328125
 Site-MNIST                         | Train Loss: 1.5802 | Train Acc: 0.7477
 Site-USPS                          | Train Loss: 1.5229 | Train Acc: 0.7697
 Site-SynthDigits                   | Train Loss: 2.0748 | Train Acc: 0.3251
 Site-MNIST_M                       | Train Loss: 2.1470 | Train Acc: 0.3251
 Site-SVHN                          | Train Loss: 2.2162 | Train Acc: 0.1875
Average Train Accuracy: 0.4710
 Site-MNIST                         | Val  Loss: 1.5685 | Val  Acc: 0.7542
 Site-USPS                          | Val  Loss: 1.4936 | Val  Acc: 0.7515
 Site-SynthDigits                   | Val  Loss: 2.0657 | Val  Acc: 0.3736
 Site-MNIST_M                       | Val  Loss: 2.1553 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1975 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4836
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7542
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7515
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3736
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 6 ============
denominator: 12474.326171875
 Site-MNIST                         | Train Loss: 1.4708 | Train Acc: 0.7662
 Site-USPS                          | Train Loss: 1.3939 | Train Acc: 0.7985
 Site-SynthDigits                   | Train Loss: 2.0385 | Train Acc: 0.3388
 Site-MNIST_M                       | Train Loss: 2.0948 | Train Acc: 0.3596
 Site-SVHN                          | Train Loss: 2.1990 | Train Acc: 0.2054
Average Train Accuracy: 0.4937
 Site-MNIST                         | Val  Loss: 1.4586 | Val  Acc: 0.7677
 Site-USPS                          | Val  Loss: 1.3733 | Val  Acc: 0.7879
 Site-SynthDigits                   | Val  Loss: 2.0261 | Val  Acc: 0.3956
 Site-MNIST_M                       | Val  Loss: 2.1315 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1852 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5059
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7677
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7879
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3956
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 7 ============
denominator: 12167.634765625
 Site-MNIST                         | Train Loss: 1.3683 | Train Acc: 0.7754
 Site-USPS                          | Train Loss: 1.2855 | Train Acc: 0.8379
 Site-SynthDigits                   | Train Loss: 1.9998 | Train Acc: 0.3497
 Site-MNIST_M                       | Train Loss: 2.1151 | Train Acc: 0.3842
 Site-SVHN                          | Train Loss: 2.1827 | Train Acc: 0.2500
Average Train Accuracy: 0.5195
 Site-MNIST                         | Val  Loss: 1.3521 | Val  Acc: 0.7710
 Site-USPS                          | Val  Loss: 1.2634 | Val  Acc: 0.8121
 Site-SynthDigits                   | Val  Loss: 1.9853 | Val  Acc: 0.3956
 Site-MNIST_M                       | Val  Loss: 2.1054 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.1702 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5369
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7710
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8121
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3956
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 8 ============
denominator: 11841.8466796875
 Site-MNIST                         | Train Loss: 1.2737 | Train Acc: 0.7704
 Site-USPS                          | Train Loss: 1.1776 | Train Acc: 0.8273
 Site-SynthDigits                   | Train Loss: 1.9646 | Train Acc: 0.3497
 Site-MNIST_M                       | Train Loss: 2.0547 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.1704 | Train Acc: 0.2500
Average Train Accuracy: 0.5183
 Site-MNIST                         | Val  Loss: 1.2618 | Val  Acc: 0.7811
 Site-USPS                          | Val  Loss: 1.1653 | Val  Acc: 0.8121
 Site-SynthDigits                   | Val  Loss: 1.9502 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 2.0738 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1474 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5371
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7811
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8121
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4066
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 9 ============
denominator: 11484.8544921875
 Site-MNIST                         | Train Loss: 1.1914 | Train Acc: 0.7738
 Site-USPS                          | Train Loss: 1.1031 | Train Acc: 0.8455
 Site-SynthDigits                   | Train Loss: 1.9299 | Train Acc: 0.3661
 Site-MNIST_M                       | Train Loss: 2.0229 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 2.1532 | Train Acc: 0.2500
Average Train Accuracy: 0.5328
 Site-MNIST                         | Val  Loss: 1.1784 | Val  Acc: 0.7744
 Site-USPS                          | Val  Loss: 1.0802 | Val  Acc: 0.8182
 Site-SynthDigits                   | Val  Loss: 1.9164 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 2.0456 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1262 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5472
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7744
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8182
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4176
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 10 ============
denominator: 11264.87109375
 Site-MNIST                         | Train Loss: 1.1155 | Train Acc: 0.7822
 Site-USPS                          | Train Loss: 1.0302 | Train Acc: 0.8591
 Site-SynthDigits                   | Train Loss: 1.8956 | Train Acc: 0.4044
 Site-MNIST_M                       | Train Loss: 2.0069 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.1396 | Train Acc: 0.2768
Average Train Accuracy: 0.5522
 Site-MNIST                         | Val  Loss: 1.1038 | Val  Acc: 0.7946
 Site-USPS                          | Val  Loss: 0.9954 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.8796 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 2.0111 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.1097 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5642
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7946
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8364
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 11 ============
denominator: 11010.314453125
 Site-MNIST                         | Train Loss: 1.0469 | Train Acc: 0.7855
 Site-USPS                          | Train Loss: 0.9414 | Train Acc: 0.8652
 Site-SynthDigits                   | Train Loss: 1.8618 | Train Acc: 0.4208
 Site-MNIST_M                       | Train Loss: 1.9262 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.1284 | Train Acc: 0.2857
Average Train Accuracy: 0.5611
 Site-MNIST                         | Val  Loss: 1.0296 | Val  Acc: 0.7980
 Site-USPS                          | Val  Loss: 0.9275 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.8502 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.9781 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.0979 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5739
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7980
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8485
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4615
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 12 ============
denominator: 10765.8271484375
 Site-MNIST                         | Train Loss: 0.9815 | Train Acc: 0.7914
 Site-USPS                          | Train Loss: 0.8978 | Train Acc: 0.8712
 Site-SynthDigits                   | Train Loss: 1.8320 | Train Acc: 0.4262
 Site-MNIST_M                       | Train Loss: 1.9436 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.1177 | Train Acc: 0.2768
Average Train Accuracy: 0.5618
 Site-MNIST                         | Val  Loss: 0.9629 | Val  Acc: 0.7980
 Site-USPS                          | Val  Loss: 0.8652 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.8162 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.9556 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.0825 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5717
============ Train epoch 13 ============
denominator: 10489.083984375
 Site-MNIST                         | Train Loss: 0.9280 | Train Acc: 0.7906
 Site-USPS                          | Train Loss: 0.8469 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.8011 | Train Acc: 0.4317
 Site-MNIST_M                       | Train Loss: 1.9024 | Train Acc: 0.4581
 Site-SVHN                          | Train Loss: 2.1089 | Train Acc: 0.3036
Average Train Accuracy: 0.5716
 Site-MNIST                         | Val  Loss: 0.9047 | Val  Acc: 0.8047
 Site-USPS                          | Val  Loss: 0.8116 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.7900 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.9251 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.0756 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5737
============ Train epoch 14 ============
denominator: 10340.1123046875
 Site-MNIST                         | Train Loss: 0.8853 | Train Acc: 0.7948
 Site-USPS                          | Train Loss: 0.7698 | Train Acc: 0.8788
 Site-SynthDigits                   | Train Loss: 1.7691 | Train Acc: 0.4399
 Site-MNIST_M                       | Train Loss: 1.8794 | Train Acc: 0.4877
 Site-SVHN                          | Train Loss: 2.0914 | Train Acc: 0.2946
Average Train Accuracy: 0.5792
 Site-MNIST                         | Val  Loss: 0.8554 | Val  Acc: 0.8047
 Site-USPS                          | Val  Loss: 0.7635 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.7664 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.8948 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.0634 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5715
============ Train epoch 15 ============
denominator: 10141.193359375
 Site-MNIST                         | Train Loss: 0.8334 | Train Acc: 0.8007
 Site-USPS                          | Train Loss: 0.7381 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.7529 | Train Acc: 0.4617
 Site-MNIST_M                       | Train Loss: 1.7789 | Train Acc: 0.5025
 Site-SVHN                          | Train Loss: 2.0853 | Train Acc: 0.2768
Average Train Accuracy: 0.5847
 Site-MNIST                         | Val  Loss: 0.8101 | Val  Acc: 0.8081
 Site-USPS                          | Val  Loss: 0.7171 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.7390 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.8669 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.0494 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5843
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8081
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5055
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 16 ============
denominator: 9978.7607421875
 Site-MNIST                         | Train Loss: 0.7889 | Train Acc: 0.8099
 Site-USPS                          | Train Loss: 0.6926 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.7323 | Train Acc: 0.4563
 Site-MNIST_M                       | Train Loss: 1.8182 | Train Acc: 0.4926
 Site-SVHN                          | Train Loss: 2.0766 | Train Acc: 0.2857
Average Train Accuracy: 0.5853
 Site-MNIST                         | Val  Loss: 0.7598 | Val  Acc: 0.8182
 Site-USPS                          | Val  Loss: 0.6824 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.7196 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.8450 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.0469 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5748
============ Train epoch 17 ============
denominator: 9838.076171875
 Site-MNIST                         | Train Loss: 0.7542 | Train Acc: 0.8141
 Site-USPS                          | Train Loss: 0.6687 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.7019 | Train Acc: 0.4617
 Site-MNIST_M                       | Train Loss: 1.8031 | Train Acc: 0.5123
 Site-SVHN                          | Train Loss: 2.0722 | Train Acc: 0.2857
Average Train Accuracy: 0.5911
 Site-MNIST                         | Val  Loss: 0.7193 | Val  Acc: 0.8215
 Site-USPS                          | Val  Loss: 0.6545 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.6942 | Val  Acc: 0.4835
 Site-MNIST_M                       | Val  Loss: 1.8279 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.0350 | Val  Acc: 0.3571
Average Valid Accuracy: 0.5910
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8215
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4835
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 18 ============
denominator: 9689.03515625
 Site-MNIST                         | Train Loss: 0.7201 | Train Acc: 0.8200
 Site-USPS                          | Train Loss: 0.6272 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.6809 | Train Acc: 0.4809
 Site-MNIST_M                       | Train Loss: 1.7625 | Train Acc: 0.5074
 Site-SVHN                          | Train Loss: 2.0654 | Train Acc: 0.2946
Average Train Accuracy: 0.5976
 Site-MNIST                         | Val  Loss: 0.6838 | Val  Acc: 0.8249
 Site-USPS                          | Val  Loss: 0.6196 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.6743 | Val  Acc: 0.5165
 Site-MNIST_M                       | Val  Loss: 1.7955 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.0303 | Val  Acc: 0.3929
Average Valid Accuracy: 0.6014
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8249
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5165
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3929
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 19 ============
denominator: 9526.705078125
 Site-MNIST                         | Train Loss: 0.6862 | Train Acc: 0.8251
 Site-USPS                          | Train Loss: 0.5837 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.6588 | Train Acc: 0.4809
 Site-MNIST_M                       | Train Loss: 1.7770 | Train Acc: 0.5369
 Site-SVHN                          | Train Loss: 2.0471 | Train Acc: 0.3214
Average Train Accuracy: 0.6098
 Site-MNIST                         | Val  Loss: 0.6523 | Val  Acc: 0.8283
 Site-USPS                          | Val  Loss: 0.5947 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.6547 | Val  Acc: 0.5275
 Site-MNIST_M                       | Val  Loss: 1.7827 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.0095 | Val  Acc: 0.3929
Average Valid Accuracy: 0.6043
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8283
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5275
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3929
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 20 ============
denominator: 9406.775390625
 Site-MNIST                         | Train Loss: 0.6463 | Train Acc: 0.8310
 Site-USPS                          | Train Loss: 0.5523 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.6361 | Train Acc: 0.4809
 Site-MNIST_M                       | Train Loss: 1.7249 | Train Acc: 0.5517
 Site-SVHN                          | Train Loss: 2.0414 | Train Acc: 0.3214
Average Train Accuracy: 0.6146
 Site-MNIST                         | Val  Loss: 0.6145 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.5660 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.6367 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.7610 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.0117 | Val  Acc: 0.3929
Average Valid Accuracy: 0.6085
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8316
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5055
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3929
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 21 ============
denominator: 9323.669921875
 Site-MNIST                         | Train Loss: 0.6219 | Train Acc: 0.8318
 Site-USPS                          | Train Loss: 0.5548 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.6147 | Train Acc: 0.4836
 Site-MNIST_M                       | Train Loss: 1.7821 | Train Acc: 0.5517
 Site-SVHN                          | Train Loss: 2.0353 | Train Acc: 0.2857
Average Train Accuracy: 0.6081
 Site-MNIST                         | Val  Loss: 0.5908 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.5459 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.6153 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.7283 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 1.9920 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5961
============ Train epoch 22 ============
denominator: 9194.642578125
 Site-MNIST                         | Train Loss: 0.5978 | Train Acc: 0.8394
 Site-USPS                          | Train Loss: 0.5332 | Train Acc: 0.8894
 Site-SynthDigits                   | Train Loss: 1.5971 | Train Acc: 0.4891
 Site-MNIST_M                       | Train Loss: 1.7248 | Train Acc: 0.5468
 Site-SVHN                          | Train Loss: 2.0205 | Train Acc: 0.2768
Average Train Accuracy: 0.6083
 Site-MNIST                         | Val  Loss: 0.5627 | Val  Acc: 0.8519
 Site-USPS                          | Val  Loss: 0.5217 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.6002 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.7142 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 1.9919 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5884
============ Train epoch 23 ============
denominator: 9102.0849609375
 Site-MNIST                         | Train Loss: 0.5717 | Train Acc: 0.8452
 Site-USPS                          | Train Loss: 0.5104 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.5800 | Train Acc: 0.4945
 Site-MNIST_M                       | Train Loss: 1.7001 | Train Acc: 0.5567
 Site-SVHN                          | Train Loss: 2.0214 | Train Acc: 0.2946
Average Train Accuracy: 0.6158
 Site-MNIST                         | Val  Loss: 0.5375 | Val  Acc: 0.8552
 Site-USPS                          | Val  Loss: 0.5075 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5878 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6892 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 1.9796 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5970
============ Train epoch 24 ============
denominator: 8916.31640625
 Site-MNIST                         | Train Loss: 0.5460 | Train Acc: 0.8612
 Site-USPS                          | Train Loss: 0.4789 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.5656 | Train Acc: 0.4945
 Site-MNIST_M                       | Train Loss: 1.6383 | Train Acc: 0.5468
 Site-SVHN                          | Train Loss: 2.0073 | Train Acc: 0.3036
Average Train Accuracy: 0.6185
 Site-MNIST                         | Val  Loss: 0.5115 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.4910 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5711 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6706 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 1.9668 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5935
============ Train epoch 25 ============
denominator: 8895.828125
 Site-MNIST                         | Train Loss: 0.5313 | Train Acc: 0.8595
 Site-USPS                          | Train Loss: 0.4622 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.5568 | Train Acc: 0.5027
 Site-MNIST_M                       | Train Loss: 1.6606 | Train Acc: 0.5714
 Site-SVHN                          | Train Loss: 2.0049 | Train Acc: 0.2679
Average Train Accuracy: 0.6191
 Site-MNIST                         | Val  Loss: 0.4944 | Val  Acc: 0.8754
 Site-USPS                          | Val  Loss: 0.4701 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.5578 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6540 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 1.9629 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5930
============ Train epoch 26 ============
denominator: 8716.38671875
 Site-MNIST                         | Train Loss: 0.5196 | Train Acc: 0.8579
 Site-USPS                          | Train Loss: 0.4445 | Train Acc: 0.8970
 Site-SynthDigits                   | Train Loss: 1.5364 | Train Acc: 0.5109
 Site-MNIST_M                       | Train Loss: 1.6289 | Train Acc: 0.5665
 Site-SVHN                          | Train Loss: 1.9941 | Train Acc: 0.2946
Average Train Accuracy: 0.6254
 Site-MNIST                         | Val  Loss: 0.4814 | Val  Acc: 0.8721
 Site-USPS                          | Val  Loss: 0.4535 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.5368 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6423 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 1.9361 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5883
============ Train epoch 27 ============
denominator: 8710.59375
 Site-MNIST                         | Train Loss: 0.4911 | Train Acc: 0.8663
 Site-USPS                          | Train Loss: 0.4263 | Train Acc: 0.8970
 Site-SynthDigits                   | Train Loss: 1.5238 | Train Acc: 0.5082
 Site-MNIST_M                       | Train Loss: 1.5953 | Train Acc: 0.5764
 Site-SVHN                          | Train Loss: 1.9830 | Train Acc: 0.2768
Average Train Accuracy: 0.6249
 Site-MNIST                         | Val  Loss: 0.4551 | Val  Acc: 0.8788
 Site-USPS                          | Val  Loss: 0.4463 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.5271 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6156 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9438 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6016
============ Train epoch 28 ============
denominator: 8597.9599609375
 Site-MNIST                         | Train Loss: 0.4775 | Train Acc: 0.8705
 Site-USPS                          | Train Loss: 0.4196 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.5084 | Train Acc: 0.5137
 Site-MNIST_M                       | Train Loss: 1.6441 | Train Acc: 0.5764
 Site-SVHN                          | Train Loss: 1.9774 | Train Acc: 0.2946
Average Train Accuracy: 0.6313
 Site-MNIST                         | Val  Loss: 0.4366 | Val  Acc: 0.8822
 Site-USPS                          | Val  Loss: 0.4318 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.5174 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.5991 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9442 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6057
============ Train epoch 29 ============
denominator: 8513.2255859375
 Site-MNIST                         | Train Loss: 0.4762 | Train Acc: 0.8680
 Site-USPS                          | Train Loss: 0.4052 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.5045 | Train Acc: 0.5219
 Site-MNIST_M                       | Train Loss: 1.5782 | Train Acc: 0.5714
 Site-SVHN                          | Train Loss: 1.9689 | Train Acc: 0.2946
Average Train Accuracy: 0.6321
 Site-MNIST                         | Val  Loss: 0.4358 | Val  Acc: 0.8788
 Site-USPS                          | Val  Loss: 0.4111 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.4956 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.6059 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 1.9205 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5958
============ Train epoch 30 ============
denominator: 8349.8857421875
 Site-MNIST                         | Train Loss: 0.4465 | Train Acc: 0.8823
 Site-USPS                          | Train Loss: 0.3963 | Train Acc: 0.9030
 Site-SynthDigits                   | Train Loss: 1.4897 | Train Acc: 0.5082
 Site-MNIST_M                       | Train Loss: 1.5819 | Train Acc: 0.5862
 Site-SVHN                          | Train Loss: 1.9685 | Train Acc: 0.2857
Average Train Accuracy: 0.6331
 Site-MNIST                         | Val  Loss: 0.4092 | Val  Acc: 0.8990
 Site-USPS                          | Val  Loss: 0.4025 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.4913 | Val  Acc: 0.4835
 Site-MNIST_M                       | Val  Loss: 1.5679 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 1.9151 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5995
============ Train epoch 31 ============
denominator: 8303.666015625
 Site-MNIST                         | Train Loss: 0.4282 | Train Acc: 0.8865
 Site-USPS                          | Train Loss: 0.4002 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4662 | Train Acc: 0.5219
 Site-MNIST_M                       | Train Loss: 1.5435 | Train Acc: 0.5813
 Site-SVHN                          | Train Loss: 1.9539 | Train Acc: 0.2857
Average Train Accuracy: 0.6369
 Site-MNIST                         | Val  Loss: 0.3935 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.3888 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.4807 | Val  Acc: 0.5275
 Site-MNIST_M                       | Val  Loss: 1.5565 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 1.9067 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6060
============ Train epoch 32 ============
denominator: 8151.677734375
 Site-MNIST                         | Train Loss: 0.4276 | Train Acc: 0.8814
 Site-USPS                          | Train Loss: 0.3729 | Train Acc: 0.9106
 Site-SynthDigits                   | Train Loss: 1.4571 | Train Acc: 0.5301
 Site-MNIST_M                       | Train Loss: 1.5081 | Train Acc: 0.5961
 Site-SVHN                          | Train Loss: 1.9466 | Train Acc: 0.2857
Average Train Accuracy: 0.6408
 Site-MNIST                         | Val  Loss: 0.3881 | Val  Acc: 0.9057
 Site-USPS                          | Val  Loss: 0.3855 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.4637 | Val  Acc: 0.5165
 Site-MNIST_M                       | Val  Loss: 1.5200 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8953 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6210
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9057
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8970
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5165
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 33 ============
denominator: 8174.33935546875
 Site-MNIST                         | Train Loss: 0.4013 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.3489 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.4515 | Train Acc: 0.5273
 Site-MNIST_M                       | Train Loss: 1.4830 | Train Acc: 0.5961
 Site-SVHN                          | Train Loss: 1.9548 | Train Acc: 0.3036
Average Train Accuracy: 0.6486
 Site-MNIST                         | Val  Loss: 0.3655 | Val  Acc: 0.9057
 Site-USPS                          | Val  Loss: 0.3684 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.4611 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.5126 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 1.8945 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6061
============ Train epoch 34 ============
denominator: 8018.91845703125
 Site-MNIST                         | Train Loss: 0.3989 | Train Acc: 0.8898
 Site-USPS                          | Train Loss: 0.3674 | Train Acc: 0.9152
 Site-SynthDigits                   | Train Loss: 1.4456 | Train Acc: 0.5383
 Site-MNIST_M                       | Train Loss: 1.5279 | Train Acc: 0.6158
 Site-SVHN                          | Train Loss: 1.9274 | Train Acc: 0.2946
Average Train Accuracy: 0.6507
 Site-MNIST                         | Val  Loss: 0.3600 | Val  Acc: 0.8990
 Site-USPS                          | Val  Loss: 0.3597 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.4396 | Val  Acc: 0.5165
 Site-MNIST_M                       | Val  Loss: 1.4893 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8844 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6137
============ Train epoch 35 ============
denominator: 7940.73291015625
 Site-MNIST                         | Train Loss: 0.3810 | Train Acc: 0.8940
 Site-USPS                          | Train Loss: 0.3476 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.4297 | Train Acc: 0.5546
 Site-MNIST_M                       | Train Loss: 1.4331 | Train Acc: 0.6207
 Site-SVHN                          | Train Loss: 1.9341 | Train Acc: 0.3125
Average Train Accuracy: 0.6609
 Site-MNIST                         | Val  Loss: 0.3454 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.3561 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.4386 | Val  Acc: 0.5275
 Site-MNIST_M                       | Val  Loss: 1.4706 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 1.9037 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6299
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9091
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5275
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5600
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 36 ============
denominator: 8054.4638671875
 Site-MNIST                         | Train Loss: 0.3721 | Train Acc: 0.9033
 Site-USPS                          | Train Loss: 0.3317 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.4209 | Train Acc: 0.5464
 Site-MNIST_M                       | Train Loss: 1.4677 | Train Acc: 0.6108
 Site-SVHN                          | Train Loss: 1.9196 | Train Acc: 0.3304
Average Train Accuracy: 0.6627
 Site-MNIST                         | Val  Loss: 0.3346 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.3447 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.4285 | Val  Acc: 0.5165
 Site-MNIST_M                       | Val  Loss: 1.4747 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8916 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6261
============ Train epoch 37 ============
denominator: 7971.5625
 Site-MNIST                         | Train Loss: 0.3635 | Train Acc: 0.9016
 Site-USPS                          | Train Loss: 0.3308 | Train Acc: 0.9288
 Site-SynthDigits                   | Train Loss: 1.4011 | Train Acc: 0.5464
 Site-MNIST_M                       | Train Loss: 1.4342 | Train Acc: 0.6404
 Site-SVHN                          | Train Loss: 1.9356 | Train Acc: 0.2768
Average Train Accuracy: 0.6588
 Site-MNIST                         | Val  Loss: 0.3263 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.3349 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.4209 | Val  Acc: 0.5165
 Site-MNIST_M                       | Val  Loss: 1.4453 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 1.8765 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6297
============ Train epoch 38 ============
denominator: 7844.140625
 Site-MNIST                         | Train Loss: 0.3581 | Train Acc: 0.9033
 Site-USPS                          | Train Loss: 0.3118 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.3870 | Train Acc: 0.5710
 Site-MNIST_M                       | Train Loss: 1.4958 | Train Acc: 0.6158
 Site-SVHN                          | Train Loss: 1.9076 | Train Acc: 0.3036
Average Train Accuracy: 0.6636
 Site-MNIST                         | Val  Loss: 0.3184 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.3290 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.4008 | Val  Acc: 0.5604
 Site-MNIST_M                       | Val  Loss: 1.4357 | Val  Acc: 0.5200
 Site-SVHN                          | Val  Loss: 1.8895 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6246
============ Train epoch 39 ============
denominator: 7832.94189453125
 Site-MNIST                         | Train Loss: 0.3542 | Train Acc: 0.9016
 Site-USPS                          | Train Loss: 0.3173 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.3575 | Train Acc: 0.5683
 Site-MNIST_M                       | Train Loss: 1.3673 | Train Acc: 0.6256
 Site-SVHN                          | Train Loss: 1.9128 | Train Acc: 0.2946
Average Train Accuracy: 0.6629
 Site-MNIST                         | Val  Loss: 0.3174 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.3214 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.3895 | Val  Acc: 0.5385
 Site-MNIST_M                       | Val  Loss: 1.4285 | Val  Acc: 0.5200
 Site-SVHN                          | Val  Loss: 1.8589 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6273
============ Train epoch 40 ============
denominator: 7683.240234375
 Site-MNIST                         | Train Loss: 0.3346 | Train Acc: 0.9108
 Site-USPS                          | Train Loss: 0.3030 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.3693 | Train Acc: 0.5628
 Site-MNIST_M                       | Train Loss: 1.4214 | Train Acc: 0.6355
 Site-SVHN                          | Train Loss: 1.9048 | Train Acc: 0.3125
Average Train Accuracy: 0.6695
 Site-MNIST                         | Val  Loss: 0.3017 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3173 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.3836 | Val  Acc: 0.5165
 Site-MNIST_M                       | Val  Loss: 1.4058 | Val  Acc: 0.6200
 Site-SVHN                          | Val  Loss: 1.8572 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6541
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.5165
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6200
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 41 ============
denominator: 7776.2685546875
 Site-MNIST                         | Train Loss: 0.3333 | Train Acc: 0.9117
 Site-USPS                          | Train Loss: 0.2950 | Train Acc: 0.9288
 Site-SynthDigits                   | Train Loss: 1.3596 | Train Acc: 0.5792
 Site-MNIST_M                       | Train Loss: 1.3395 | Train Acc: 0.6453
 Site-SVHN                          | Train Loss: 1.8962 | Train Acc: 0.2768
Average Train Accuracy: 0.6684
 Site-MNIST                         | Val  Loss: 0.2992 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3095 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.3671 | Val  Acc: 0.5495
 Site-MNIST_M                       | Val  Loss: 1.3932 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 1.8541 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6366
============ Train epoch 42 ============
denominator: 7615.833984375
 Site-MNIST                         | Train Loss: 0.3290 | Train Acc: 0.9100
 Site-USPS                          | Train Loss: 0.2865 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.3402 | Train Acc: 0.5792
 Site-MNIST_M                       | Train Loss: 1.2944 | Train Acc: 0.6453
 Site-SVHN                          | Train Loss: 1.9059 | Train Acc: 0.3036
Average Train Accuracy: 0.6743
 Site-MNIST                         | Val  Loss: 0.2928 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.3033 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.3568 | Val  Acc: 0.5495
 Site-MNIST_M                       | Val  Loss: 1.3698 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 1.8473 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6512
============ Train epoch 43 ============
denominator: 7524.171875
 Site-MNIST                         | Train Loss: 0.3197 | Train Acc: 0.9159
 Site-USPS                          | Train Loss: 0.2829 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.3394 | Train Acc: 0.5929
 Site-MNIST_M                       | Train Loss: 1.3830 | Train Acc: 0.6552
 Site-SVHN                          | Train Loss: 1.8878 | Train Acc: 0.3125
Average Train Accuracy: 0.6823
 Site-MNIST                         | Val  Loss: 0.2849 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.2918 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.3478 | Val  Acc: 0.5604
 Site-MNIST_M                       | Val  Loss: 1.3605 | Val  Acc: 0.6600
 Site-SVHN                          | Val  Loss: 1.8444 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6650
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9394
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5604
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6600
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 44 ============
denominator: 7513.07958984375
 Site-MNIST                         | Train Loss: 0.3077 | Train Acc: 0.9193
 Site-USPS                          | Train Loss: 0.2937 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.3160 | Train Acc: 0.5847
 Site-MNIST_M                       | Train Loss: 1.3553 | Train Acc: 0.6404
 Site-SVHN                          | Train Loss: 1.8849 | Train Acc: 0.3125
Average Train Accuracy: 0.6777
 Site-MNIST                         | Val  Loss: 0.2763 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.2913 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.3494 | Val  Acc: 0.5495
 Site-MNIST_M                       | Val  Loss: 1.3550 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 1.8208 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6553
============ Train epoch 45 ============
denominator: 7534.24755859375
 Site-MNIST                         | Train Loss: 0.3027 | Train Acc: 0.9176
 Site-USPS                          | Train Loss: 0.2770 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.3133 | Train Acc: 0.5902
 Site-MNIST_M                       | Train Loss: 1.3627 | Train Acc: 0.6502
 Site-SVHN                          | Train Loss: 1.8821 | Train Acc: 0.2946
Average Train Accuracy: 0.6775
 Site-MNIST                         | Val  Loss: 0.2683 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.2817 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.3362 | Val  Acc: 0.5275
 Site-MNIST_M                       | Val  Loss: 1.3295 | Val  Acc: 0.6400
 Site-SVHN                          | Val  Loss: 1.8175 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6772
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9461
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5275
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.6400
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/q-ffl...
============ Train epoch 46 ============
denominator: 7505.5439453125
 Site-MNIST                         | Train Loss: 0.3054 | Train Acc: 0.9134
 Site-USPS                          | Train Loss: 0.2858 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.3095 | Train Acc: 0.5874
 Site-MNIST_M                       | Train Loss: 1.3084 | Train Acc: 0.6355
 Site-SVHN                          | Train Loss: 1.8729 | Train Acc: 0.2679
Average Train Accuracy: 0.6672
 Site-MNIST                         | Val  Loss: 0.2713 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.2784 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.3146 | Val  Acc: 0.5604
 Site-MNIST_M                       | Val  Loss: 1.3224 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 1.8051 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6532
============ Train epoch 47 ============
denominator: 7450.775390625
 Site-MNIST                         | Train Loss: 0.2967 | Train Acc: 0.9184
 Site-USPS                          | Train Loss: 0.2603 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.2922 | Train Acc: 0.6011
 Site-MNIST_M                       | Train Loss: 1.3193 | Train Acc: 0.6502
 Site-SVHN                          | Train Loss: 1.8588 | Train Acc: 0.2857
Average Train Accuracy: 0.6778
 Site-MNIST                         | Val  Loss: 0.2586 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.2736 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.3089 | Val  Acc: 0.5385
 Site-MNIST_M                       | Val  Loss: 1.3072 | Val  Acc: 0.6200
 Site-SVHN                          | Val  Loss: 1.8259 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6611
============ Train epoch 48 ============
denominator: 7346.8154296875
 Site-MNIST                         | Train Loss: 0.2895 | Train Acc: 0.9176
 Site-USPS                          | Train Loss: 0.2606 | Train Acc: 0.9303
 Site-SynthDigits                   | Train Loss: 1.2741 | Train Acc: 0.6148
 Site-MNIST_M                       | Train Loss: 1.3255 | Train Acc: 0.6502
 Site-SVHN                          | Train Loss: 1.8584 | Train Acc: 0.2946
Average Train Accuracy: 0.6815
 Site-MNIST                         | Val  Loss: 0.2547 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.2662 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.2999 | Val  Acc: 0.6154
 Site-MNIST_M                       | Val  Loss: 1.2982 | Val  Acc: 0.6000
 Site-SVHN                          | Val  Loss: 1.7859 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6722
============ Train epoch 49 ============
denominator: 7308.150390625
 Site-MNIST                         | Train Loss: 0.2858 | Train Acc: 0.9159
 Site-USPS                          | Train Loss: 0.2514 | Train Acc: 0.9394
 Site-SynthDigits                   | Train Loss: 1.2691 | Train Acc: 0.6038
 Site-MNIST_M                       | Train Loss: 1.2433 | Train Acc: 0.6502
 Site-SVHN                          | Train Loss: 1.8459 | Train Acc: 0.2768
Average Train Accuracy: 0.6772
 Site-MNIST                         | Val  Loss: 0.2496 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.2618 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.2825 | Val  Acc: 0.5714
 Site-MNIST_M                       | Val  Loss: 1.2787 | Val  Acc: 0.6200
 Site-SVHN                          | Val  Loss: 1.8258 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6647
===2023-07-02 01:38:14===
===2023-07-02 01:38:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:45 | Test Acc: 0.8986
 Test site-USPS                      | Epoch:45 | Test Acc: 0.9204
 Test site-SynthDigits               | Epoch:45 | Test Acc: 0.5442
 Test site-MNIST_M                   | Epoch:45 | Test Acc: 0.4203
 Test site-SVHN                      | Epoch:45 | Test Acc: 0.2780
MNIST: 0.8986, USPS: 0.9204, SynthDigits: 0.5442, MNIST_M: 0.4203, SVHN: 0.2780, 
Average Test Accuracy(group): 0.6123, Average Test Accuracy(individual): 0.6123,
domain std=0.2570, cluster std=-1.0000, individual std=0.2570, 
