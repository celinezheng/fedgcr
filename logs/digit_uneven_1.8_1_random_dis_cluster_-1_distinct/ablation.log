===2023-07-02 01:49:34===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (1) | Train Loss: 2.0086 | Train Acc: 0.6434
 Site-USPS                      (2) | Train Loss: 1.9958 | Train Acc: 0.6000
 Site-SynthDigits               (3) | Train Loss: 2.2460 | Train Acc: 0.2268
 Site-MNIST_M                   (0) | Train Loss: 2.2690 | Train Acc: 0.1576
 Site-SVHN                      (3) | Train Loss: 2.2794 | Train Acc: 0.0982
Average Train Accuracy: 0.3452
 Site-MNIST                     (1) | Val  Loss: 2.0093 | Val  Acc: 0.6431
 Site-USPS                      (2) | Val  Loss: 1.9901 | Val  Acc: 0.5939
 Site-SynthDigits               (3) | Val  Loss: 2.2468 | Val  Acc: 0.2088
 Site-MNIST_M                   (0) | Val  Loss: 2.2803 | Val  Acc: 0.1400
 Site-SVHN                      (3) | Val  Loss: 2.2728 | Val  Acc: 0.1429
Average Valid Accuracy: 0.3457
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6431
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5939
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2088
 Best site-MNIST_M                  (0)  | Epoch:0 | Val Acc: 0.1400
 Best site-SVHN                     (3)  | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 1 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (1) | Train Loss: 1.7574 | Train Acc: 0.7334
 Site-USPS                      (1) | Train Loss: 1.7446 | Train Acc: 0.6955
 Site-SynthDigits               (0) | Train Loss: 2.1805 | Train Acc: 0.2705
 Site-MNIST_M                   (2) | Train Loss: 2.2565 | Train Acc: 0.2512
 Site-SVHN                      (3) | Train Loss: 2.2650 | Train Acc: 0.1339
Average Train Accuracy: 0.4169
 Site-MNIST                     (1) | Val  Loss: 1.7553 | Val  Acc: 0.7340
 Site-USPS                      (1) | Val  Loss: 1.7280 | Val  Acc: 0.6606
 Site-SynthDigits               (0) | Val  Loss: 2.1757 | Val  Acc: 0.2747
 Site-MNIST_M                   (2) | Val  Loss: 2.2549 | Val  Acc: 0.2000
 Site-SVHN                      (3) | Val  Loss: 2.2584 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4167
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7340
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.6606
 Best site-SynthDigits              (0)  | Epoch:1 | Val Acc: 0.2747
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.2000
 Best site-SVHN                     (3)  | Epoch:1 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 2 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 1.5304 | Train Acc: 0.7687
 Site-USPS                      (0) | Train Loss: 1.5507 | Train Acc: 0.7136
 Site-SynthDigits               (3) | Train Loss: 2.1277 | Train Acc: 0.2760
 Site-MNIST_M                   (1) | Train Loss: 2.2061 | Train Acc: 0.2759
 Site-SVHN                      (2) | Train Loss: 2.2521 | Train Acc: 0.1607
Average Train Accuracy: 0.4390
 Site-MNIST                     (0) | Val  Loss: 1.5230 | Val  Acc: 0.7609
 Site-USPS                      (0) | Val  Loss: 1.5302 | Val  Acc: 0.7273
 Site-SynthDigits               (3) | Val  Loss: 2.1196 | Val  Acc: 0.2857
 Site-MNIST_M                   (1) | Val  Loss: 2.2294 | Val  Acc: 0.1800
 Site-SVHN                      (2) | Val  Loss: 2.2443 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4408
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7609
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7273
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.2857
 Best site-MNIST_M                  (1)  | Epoch:2 | Val Acc: 0.1800
 Best site-SVHN                     (2)  | Epoch:2 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 3 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (1) | Train Loss: 1.3820 | Train Acc: 0.7788
 Site-USPS                      (1) | Train Loss: 1.3855 | Train Acc: 0.7636
 Site-SynthDigits               (3) | Train Loss: 2.0683 | Train Acc: 0.3060
 Site-MNIST_M                   (0) | Train Loss: 2.1548 | Train Acc: 0.2808
 Site-SVHN                      (2) | Train Loss: 2.2394 | Train Acc: 0.1964
Average Train Accuracy: 0.4651
 Site-MNIST                     (1) | Val  Loss: 1.3707 | Val  Acc: 0.7744
 Site-USPS                      (1) | Val  Loss: 1.3556 | Val  Acc: 0.7697
 Site-SynthDigits               (3) | Val  Loss: 2.0672 | Val  Acc: 0.3297
 Site-MNIST_M                   (0) | Val  Loss: 2.2043 | Val  Acc: 0.2400
 Site-SVHN                      (2) | Val  Loss: 2.2322 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4728
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.7744
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.7697
 Best site-SynthDigits              (3)  | Epoch:3 | Val Acc: 0.3297
 Best site-MNIST_M                  (0)  | Epoch:3 | Val Acc: 0.2400
 Best site-SVHN                     (2)  | Epoch:3 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 4 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 1.2300 | Train Acc: 0.8057
 Site-USPS                      (3) | Train Loss: 1.2563 | Train Acc: 0.7970
 Site-SynthDigits               (2) | Train Loss: 2.0232 | Train Acc: 0.3443
 Site-MNIST_M                   (1) | Train Loss: 2.1501 | Train Acc: 0.3054
 Site-SVHN                      (1) | Train Loss: 2.2287 | Train Acc: 0.1786
Average Train Accuracy: 0.4862
 Site-MNIST                     (0) | Val  Loss: 1.2211 | Val  Acc: 0.7912
 Site-USPS                      (3) | Val  Loss: 1.2275 | Val  Acc: 0.8000
 Site-SynthDigits               (2) | Val  Loss: 2.0162 | Val  Acc: 0.3736
 Site-MNIST_M                   (1) | Val  Loss: 2.1820 | Val  Acc: 0.2400
 Site-SVHN                      (1) | Val  Loss: 2.2263 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4838
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.7912
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8000
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.3736
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.2400
 Best site-SVHN                     (1)  | Epoch:4 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 5 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 1.1263 | Train Acc: 0.8200
 Site-USPS                      (0) | Train Loss: 1.1419 | Train Acc: 0.8303
 Site-SynthDigits               (2) | Train Loss: 1.9786 | Train Acc: 0.3689
 Site-MNIST_M                   (3) | Train Loss: 2.1218 | Train Acc: 0.3054
 Site-SVHN                      (1) | Train Loss: 2.2181 | Train Acc: 0.2054
Average Train Accuracy: 0.5060
 Site-MNIST                     (0) | Val  Loss: 1.1105 | Val  Acc: 0.8148
 Site-USPS                      (0) | Val  Loss: 1.1071 | Val  Acc: 0.8303
 Site-SynthDigits               (2) | Val  Loss: 1.9701 | Val  Acc: 0.3956
 Site-MNIST_M                   (3) | Val  Loss: 2.1548 | Val  Acc: 0.2800
 Site-SVHN                      (1) | Val  Loss: 2.2085 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5070
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8148
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8303
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.3956
 Best site-MNIST_M                  (3)  | Epoch:5 | Val Acc: 0.2800
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 6 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (0) | Train Loss: 1.0502 | Train Acc: 0.8099
 Site-USPS                      (0) | Train Loss: 1.0539 | Train Acc: 0.8212
 Site-SynthDigits               (2) | Train Loss: 1.9329 | Train Acc: 0.3689
 Site-MNIST_M                   (1) | Train Loss: 2.1173 | Train Acc: 0.3448
 Site-SVHN                      (3) | Train Loss: 2.2081 | Train Acc: 0.2143
Average Train Accuracy: 0.5118
 Site-MNIST                     (0) | Val  Loss: 1.0377 | Val  Acc: 0.8013
 Site-USPS                      (0) | Val  Loss: 1.0036 | Val  Acc: 0.8121
 Site-SynthDigits               (2) | Val  Loss: 1.9259 | Val  Acc: 0.4066
 Site-MNIST_M                   (1) | Val  Loss: 2.1243 | Val  Acc: 0.3400
 Site-SVHN                      (3) | Val  Loss: 2.2002 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5149
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8013
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.8121
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.4066
 Best site-MNIST_M                  (1)  | Epoch:6 | Val Acc: 0.3400
 Best site-SVHN                     (3)  | Epoch:6 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 7 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (1) | Train Loss: 0.9746 | Train Acc: 0.8200
 Site-USPS                      (1) | Train Loss: 0.9731 | Train Acc: 0.8379
 Site-SynthDigits               (2) | Train Loss: 1.8959 | Train Acc: 0.4208
 Site-MNIST_M                   (0) | Train Loss: 2.0788 | Train Acc: 0.3547
 Site-SVHN                      (3) | Train Loss: 2.1909 | Train Acc: 0.2143
Average Train Accuracy: 0.5295
 Site-MNIST                     (1) | Val  Loss: 0.9555 | Val  Acc: 0.8114
 Site-USPS                      (1) | Val  Loss: 0.9401 | Val  Acc: 0.8364
 Site-SynthDigits               (2) | Val  Loss: 1.8892 | Val  Acc: 0.4176
 Site-MNIST_M                   (0) | Val  Loss: 2.1087 | Val  Acc: 0.3200
 Site-SVHN                      (3) | Val  Loss: 2.1949 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5128
============ Train epoch 8 ============
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (2) | Train Loss: 0.9375 | Train Acc: 0.8175
 Site-USPS                      (2) | Train Loss: 0.8966 | Train Acc: 0.8409
 Site-SynthDigits               (0) | Train Loss: 1.8613 | Train Acc: 0.4344
 Site-MNIST_M                   (3) | Train Loss: 2.0111 | Train Acc: 0.3695
 Site-SVHN                      (1) | Train Loss: 2.1883 | Train Acc: 0.2143
Average Train Accuracy: 0.5353
 Site-MNIST                     (2) | Val  Loss: 0.9180 | Val  Acc: 0.8114
 Site-USPS                      (2) | Val  Loss: 0.8758 | Val  Acc: 0.8485
 Site-SynthDigits               (0) | Val  Loss: 1.8460 | Val  Acc: 0.4505
 Site-MNIST_M                   (3) | Val  Loss: 2.0704 | Val  Acc: 0.3400
 Site-SVHN                      (1) | Val  Loss: 2.1791 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5187
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8114
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.8485
 Best site-SynthDigits              (0)  | Epoch:8 | Val Acc: 0.4505
 Best site-MNIST_M                  (3)  | Epoch:8 | Val Acc: 0.3400
 Best site-SVHN                     (1)  | Epoch:8 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 9 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.8859 | Train Acc: 0.8175
 Site-USPS                      (0) | Train Loss: 0.8595 | Train Acc: 0.8515
 Site-SynthDigits               (2) | Train Loss: 1.8241 | Train Acc: 0.4508
 Site-MNIST_M                   (3) | Train Loss: 2.0133 | Train Acc: 0.3695
 Site-SVHN                      (1) | Train Loss: 2.1783 | Train Acc: 0.2143
Average Train Accuracy: 0.5407
 Site-MNIST                     (0) | Val  Loss: 0.8623 | Val  Acc: 0.8215
 Site-USPS                      (0) | Val  Loss: 0.8337 | Val  Acc: 0.8545
 Site-SynthDigits               (2) | Val  Loss: 1.8138 | Val  Acc: 0.4505
 Site-MNIST_M                   (3) | Val  Loss: 2.0602 | Val  Acc: 0.3400
 Site-SVHN                      (1) | Val  Loss: 2.1699 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5290
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8215
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8545
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.4505
 Best site-MNIST_M                  (3)  | Epoch:9 | Val Acc: 0.3400
 Best site-SVHN                     (1)  | Epoch:9 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 10 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (0) | Train Loss: 0.8604 | Train Acc: 0.8141
 Site-USPS                      (0) | Train Loss: 0.8220 | Train Acc: 0.8530
 Site-SynthDigits               (2) | Train Loss: 1.7818 | Train Acc: 0.4781
 Site-MNIST_M                   (1) | Train Loss: 1.9655 | Train Acc: 0.3990
 Site-SVHN                      (3) | Train Loss: 2.1718 | Train Acc: 0.2143
Average Train Accuracy: 0.5517
 Site-MNIST                     (0) | Val  Loss: 0.8357 | Val  Acc: 0.8215
 Site-USPS                      (0) | Val  Loss: 0.7937 | Val  Acc: 0.8545
 Site-SynthDigits               (2) | Val  Loss: 1.7760 | Val  Acc: 0.4835
 Site-MNIST_M                   (1) | Val  Loss: 2.0097 | Val  Acc: 0.3600
 Site-SVHN                      (3) | Val  Loss: 2.1673 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5396
 Best site-MNIST                    (0)  | Epoch:10 | Val Acc: 0.8215
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8545
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.4835
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.3600
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 11 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (0) | Train Loss: 0.8142 | Train Acc: 0.8158
 Site-USPS                      (0) | Train Loss: 0.7798 | Train Acc: 0.8621
 Site-SynthDigits               (3) | Train Loss: 1.7481 | Train Acc: 0.4863
 Site-MNIST_M                   (2) | Train Loss: 1.9608 | Train Acc: 0.3990
 Site-SVHN                      (1) | Train Loss: 2.1663 | Train Acc: 0.2143
Average Train Accuracy: 0.5555
 Site-MNIST                     (0) | Val  Loss: 0.7909 | Val  Acc: 0.8148
 Site-USPS                      (0) | Val  Loss: 0.7614 | Val  Acc: 0.8667
 Site-SynthDigits               (3) | Val  Loss: 1.7463 | Val  Acc: 0.4615
 Site-MNIST_M                   (2) | Val  Loss: 1.9854 | Val  Acc: 0.3800
 Site-SVHN                      (1) | Val  Loss: 2.1606 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5403
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8148
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8667
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.4615
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.3800
 Best site-SVHN                     (1)  | Epoch:11 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 12 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (1) | Train Loss: 0.7728 | Train Acc: 0.8209
 Site-USPS                      (1) | Train Loss: 0.7614 | Train Acc: 0.8667
 Site-SynthDigits               (2) | Train Loss: 1.7204 | Train Acc: 0.5027
 Site-MNIST_M                   (3) | Train Loss: 1.9123 | Train Acc: 0.4039
 Site-SVHN                      (0) | Train Loss: 2.1521 | Train Acc: 0.2411
Average Train Accuracy: 0.5671
 Site-MNIST                     (1) | Val  Loss: 0.7557 | Val  Acc: 0.8182
 Site-USPS                      (1) | Val  Loss: 0.7322 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.7124 | Val  Acc: 0.5055
 Site-MNIST_M                   (3) | Val  Loss: 1.9565 | Val  Acc: 0.3800
 Site-SVHN                      (0) | Val  Loss: 2.1492 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5510
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8182
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8727
 Best site-SynthDigits              (2)  | Epoch:12 | Val Acc: 0.5055
 Best site-MNIST_M                  (3)  | Epoch:12 | Val Acc: 0.3800
 Best site-SVHN                     (0)  | Epoch:12 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 13 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (1) | Train Loss: 0.7543 | Train Acc: 0.8251
 Site-USPS                      (1) | Train Loss: 0.7347 | Train Acc: 0.8652
 Site-SynthDigits               (2) | Train Loss: 1.6933 | Train Acc: 0.5055
 Site-MNIST_M                   (0) | Train Loss: 1.8496 | Train Acc: 0.4138
 Site-SVHN                      (3) | Train Loss: 2.1394 | Train Acc: 0.2679
Average Train Accuracy: 0.5755
 Site-MNIST                     (1) | Val  Loss: 0.7322 | Val  Acc: 0.8316
 Site-USPS                      (1) | Val  Loss: 0.7036 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.6832 | Val  Acc: 0.5055
 Site-MNIST_M                   (0) | Val  Loss: 1.9341 | Val  Acc: 0.3800
 Site-SVHN                      (3) | Val  Loss: 2.1294 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5608
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.8316
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8727
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.5055
 Best site-MNIST_M                  (0)  | Epoch:13 | Val Acc: 0.3800
 Best site-SVHN                     (3)  | Epoch:13 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 14 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (1) | Train Loss: 0.7197 | Train Acc: 0.8335
 Site-USPS                      (1) | Train Loss: 0.6886 | Train Acc: 0.8636
 Site-SynthDigits               (3) | Train Loss: 1.6633 | Train Acc: 0.5082
 Site-MNIST_M                   (2) | Train Loss: 1.8860 | Train Acc: 0.4236
 Site-SVHN                      (0) | Train Loss: 2.1398 | Train Acc: 0.2589
Average Train Accuracy: 0.5776
 Site-MNIST                     (1) | Val  Loss: 0.6968 | Val  Acc: 0.8384
 Site-USPS                      (1) | Val  Loss: 0.6792 | Val  Acc: 0.8667
 Site-SynthDigits               (3) | Val  Loss: 1.6631 | Val  Acc: 0.4835
 Site-MNIST_M                   (2) | Val  Loss: 1.9197 | Val  Acc: 0.4000
 Site-SVHN                      (0) | Val  Loss: 2.1297 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5534
============ Train epoch 15 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (1) | Train Loss: 0.6957 | Train Acc: 0.8352
 Site-USPS                      (1) | Train Loss: 0.6711 | Train Acc: 0.8667
 Site-SynthDigits               (2) | Train Loss: 1.6420 | Train Acc: 0.5219
 Site-MNIST_M                   (0) | Train Loss: 1.8238 | Train Acc: 0.4335
 Site-SVHN                      (3) | Train Loss: 2.1320 | Train Acc: 0.2411
Average Train Accuracy: 0.5796
 Site-MNIST                     (1) | Val  Loss: 0.6729 | Val  Acc: 0.8418
 Site-USPS                      (1) | Val  Loss: 0.6512 | Val  Acc: 0.8667
 Site-SynthDigits               (2) | Val  Loss: 1.6408 | Val  Acc: 0.4945
 Site-MNIST_M                   (0) | Val  Loss: 1.8999 | Val  Acc: 0.4200
 Site-SVHN                      (3) | Val  Loss: 2.1186 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5603
============ Train epoch 16 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.6785 | Train Acc: 0.8377
 Site-USPS                      (1) | Train Loss: 0.6710 | Train Acc: 0.8606
 Site-SynthDigits               (2) | Train Loss: 1.6126 | Train Acc: 0.5301
 Site-MNIST_M                   (3) | Train Loss: 1.8761 | Train Acc: 0.4335
 Site-SVHN                      (0) | Train Loss: 2.1177 | Train Acc: 0.2500
Average Train Accuracy: 0.5824
 Site-MNIST                     (1) | Val  Loss: 0.6517 | Val  Acc: 0.8384
 Site-USPS                      (1) | Val  Loss: 0.6460 | Val  Acc: 0.8606
 Site-SynthDigits               (2) | Val  Loss: 1.6114 | Val  Acc: 0.5055
 Site-MNIST_M                   (3) | Val  Loss: 1.8654 | Val  Acc: 0.4000
 Site-SVHN                      (0) | Val  Loss: 2.1124 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5566
============ Train epoch 17 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (0) | Train Loss: 0.6617 | Train Acc: 0.8318
 Site-USPS                      (0) | Train Loss: 0.6399 | Train Acc: 0.8682
 Site-SynthDigits               (2) | Train Loss: 1.5913 | Train Acc: 0.5328
 Site-MNIST_M                   (1) | Train Loss: 1.8509 | Train Acc: 0.4384
 Site-SVHN                      (3) | Train Loss: 2.1038 | Train Acc: 0.2411
Average Train Accuracy: 0.5825
 Site-MNIST                     (0) | Val  Loss: 0.6348 | Val  Acc: 0.8384
 Site-USPS                      (0) | Val  Loss: 0.6161 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 1.5893 | Val  Acc: 0.4945
 Site-MNIST_M                   (1) | Val  Loss: 1.8548 | Val  Acc: 0.4200
 Site-SVHN                      (3) | Val  Loss: 2.0981 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5620
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8384
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8788
 Best site-SynthDigits              (2)  | Epoch:17 | Val Acc: 0.4945
 Best site-MNIST_M                  (1)  | Epoch:17 | Val Acc: 0.4200
 Best site-SVHN                     (3)  | Epoch:17 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 18 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.6455 | Train Acc: 0.8335
 Site-USPS                      (0) | Train Loss: 0.6356 | Train Acc: 0.8667
 Site-SynthDigits               (1) | Train Loss: 1.5553 | Train Acc: 0.5492
 Site-MNIST_M                   (2) | Train Loss: 1.8213 | Train Acc: 0.4483
 Site-SVHN                      (3) | Train Loss: 2.0861 | Train Acc: 0.2500
Average Train Accuracy: 0.5895
 Site-MNIST                     (0) | Val  Loss: 0.6199 | Val  Acc: 0.8485
 Site-USPS                      (0) | Val  Loss: 0.6041 | Val  Acc: 0.8727
 Site-SynthDigits               (1) | Val  Loss: 1.5619 | Val  Acc: 0.5165
 Site-MNIST_M                   (2) | Val  Loss: 1.8268 | Val  Acc: 0.4400
 Site-SVHN                      (3) | Val  Loss: 2.0910 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5713
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.8485
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8727
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.5165
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.4400
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 19 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.6369 | Train Acc: 0.8326
 Site-USPS                      (0) | Train Loss: 0.6242 | Train Acc: 0.8636
 Site-SynthDigits               (3) | Train Loss: 1.5429 | Train Acc: 0.5546
 Site-MNIST_M                   (2) | Train Loss: 1.7850 | Train Acc: 0.4532
 Site-SVHN                      (1) | Train Loss: 2.0744 | Train Acc: 0.2500
Average Train Accuracy: 0.5908
 Site-MNIST                     (0) | Val  Loss: 0.6079 | Val  Acc: 0.8451
 Site-USPS                      (0) | Val  Loss: 0.5915 | Val  Acc: 0.8606
 Site-SynthDigits               (3) | Val  Loss: 1.5446 | Val  Acc: 0.5275
 Site-MNIST_M                   (2) | Val  Loss: 1.8073 | Val  Acc: 0.4400
 Site-SVHN                      (1) | Val  Loss: 2.0836 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5704
============ Train epoch 20 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (1) | Train Loss: 0.6165 | Train Acc: 0.8419
 Site-USPS                      (1) | Train Loss: 0.6069 | Train Acc: 0.8727
 Site-SynthDigits               (2) | Train Loss: 1.5220 | Train Acc: 0.5683
 Site-MNIST_M                   (3) | Train Loss: 1.8087 | Train Acc: 0.4729
 Site-SVHN                      (0) | Train Loss: 2.0720 | Train Acc: 0.2946
Average Train Accuracy: 0.6101
 Site-MNIST                     (1) | Val  Loss: 0.5901 | Val  Acc: 0.8384
 Site-USPS                      (1) | Val  Loss: 0.5799 | Val  Acc: 0.8848
 Site-SynthDigits               (2) | Val  Loss: 1.5209 | Val  Acc: 0.5495
 Site-MNIST_M                   (3) | Val  Loss: 1.8055 | Val  Acc: 0.4600
 Site-SVHN                      (0) | Val  Loss: 2.0692 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5965
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.8384
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.8848
 Best site-SynthDigits              (2)  | Epoch:20 | Val Acc: 0.5495
 Best site-MNIST_M                  (3)  | Epoch:20 | Val Acc: 0.4600
 Best site-SVHN                     (0)  | Epoch:20 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 21 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.6086 | Train Acc: 0.8402
 Site-USPS                      (1) | Train Loss: 0.6088 | Train Acc: 0.8667
 Site-SynthDigits               (2) | Train Loss: 1.4898 | Train Acc: 0.5710
 Site-MNIST_M                   (3) | Train Loss: 1.7218 | Train Acc: 0.4729
 Site-SVHN                      (0) | Train Loss: 2.0708 | Train Acc: 0.3036
Average Train Accuracy: 0.6109
 Site-MNIST                     (1) | Val  Loss: 0.5809 | Val  Acc: 0.8418
 Site-USPS                      (1) | Val  Loss: 0.5699 | Val  Acc: 0.8667
 Site-SynthDigits               (2) | Val  Loss: 1.4991 | Val  Acc: 0.5604
 Site-MNIST_M                   (3) | Val  Loss: 1.7736 | Val  Acc: 0.4600
 Site-SVHN                      (0) | Val  Loss: 2.0632 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6101
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.8418
 Best site-USPS                     (1)  | Epoch:21 | Val Acc: 0.8667
 Best site-SynthDigits              (2)  | Epoch:21 | Val Acc: 0.5604
 Best site-MNIST_M                  (3)  | Epoch:21 | Val Acc: 0.4600
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 22 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (1) | Train Loss: 0.5892 | Train Acc: 0.8427
 Site-USPS                      (1) | Train Loss: 0.5871 | Train Acc: 0.8773
 Site-SynthDigits               (2) | Train Loss: 1.4772 | Train Acc: 0.5765
 Site-MNIST_M                   (0) | Train Loss: 1.6855 | Train Acc: 0.4778
 Site-SVHN                      (3) | Train Loss: 2.0661 | Train Acc: 0.3036
Average Train Accuracy: 0.6156
 Site-MNIST                     (1) | Val  Loss: 0.5595 | Val  Acc: 0.8350
 Site-USPS                      (1) | Val  Loss: 0.5533 | Val  Acc: 0.8848
 Site-SynthDigits               (2) | Val  Loss: 1.4861 | Val  Acc: 0.5714
 Site-MNIST_M                   (0) | Val  Loss: 1.7605 | Val  Acc: 0.4600
 Site-SVHN                      (3) | Val  Loss: 2.0546 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6145
 Best site-MNIST                    (1)  | Epoch:22 | Val Acc: 0.8350
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.8848
 Best site-SynthDigits              (2)  | Epoch:22 | Val Acc: 0.5714
 Best site-MNIST_M                  (0)  | Epoch:22 | Val Acc: 0.4600
 Best site-SVHN                     (3)  | Epoch:22 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 23 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (1) | Train Loss: 0.5834 | Train Acc: 0.8478
 Site-USPS                      (1) | Train Loss: 0.5801 | Train Acc: 0.8773
 Site-SynthDigits               (0) | Train Loss: 1.4490 | Train Acc: 0.5738
 Site-MNIST_M                   (2) | Train Loss: 1.7036 | Train Acc: 0.4926
 Site-SVHN                      (3) | Train Loss: 2.0559 | Train Acc: 0.2679
Average Train Accuracy: 0.6119
 Site-MNIST                     (1) | Val  Loss: 0.5505 | Val  Acc: 0.8451
 Site-USPS                      (1) | Val  Loss: 0.5421 | Val  Acc: 0.8848
 Site-SynthDigits               (0) | Val  Loss: 1.4642 | Val  Acc: 0.5714
 Site-MNIST_M                   (2) | Val  Loss: 1.7455 | Val  Acc: 0.4600
 Site-SVHN                      (3) | Val  Loss: 2.0506 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6023
============ Train epoch 24 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.5640 | Train Acc: 0.8520
 Site-USPS                      (0) | Train Loss: 0.5680 | Train Acc: 0.8758
 Site-SynthDigits               (2) | Train Loss: 1.4452 | Train Acc: 0.5847
 Site-MNIST_M                   (1) | Train Loss: 1.6426 | Train Acc: 0.4926
 Site-SVHN                      (3) | Train Loss: 2.0363 | Train Acc: 0.2857
Average Train Accuracy: 0.6182
 Site-MNIST                     (0) | Val  Loss: 0.5340 | Val  Acc: 0.8586
 Site-USPS                      (0) | Val  Loss: 0.5295 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 1.4545 | Val  Acc: 0.5714
 Site-MNIST_M                   (1) | Val  Loss: 1.7210 | Val  Acc: 0.4600
 Site-SVHN                      (3) | Val  Loss: 2.0488 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6109
============ Train epoch 25 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (0) | Train Loss: 0.5602 | Train Acc: 0.8469
 Site-USPS                      (3) | Train Loss: 0.5484 | Train Acc: 0.8727
 Site-SynthDigits               (2) | Train Loss: 1.4144 | Train Acc: 0.5820
 Site-MNIST_M                   (1) | Train Loss: 1.6383 | Train Acc: 0.5025
 Site-SVHN                      (1) | Train Loss: 2.0425 | Train Acc: 0.2768
Average Train Accuracy: 0.6162
 Site-MNIST                     (0) | Val  Loss: 0.5305 | Val  Acc: 0.8451
 Site-USPS                      (3) | Val  Loss: 0.5196 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.4320 | Val  Acc: 0.5714
 Site-MNIST_M                   (1) | Val  Loss: 1.7215 | Val  Acc: 0.4600
 Site-SVHN                      (1) | Val  Loss: 2.0343 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5999
============ Train epoch 26 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (1) | Train Loss: 0.5524 | Train Acc: 0.8444
 Site-USPS                      (1) | Train Loss: 0.5610 | Train Acc: 0.8788
 Site-SynthDigits               (0) | Train Loss: 1.4073 | Train Acc: 0.5902
 Site-MNIST_M                   (3) | Train Loss: 1.6619 | Train Acc: 0.5025
 Site-SVHN                      (2) | Train Loss: 2.0284 | Train Acc: 0.2946
Average Train Accuracy: 0.6221
 Site-MNIST                     (1) | Val  Loss: 0.5217 | Val  Acc: 0.8485
 Site-USPS                      (1) | Val  Loss: 0.5086 | Val  Acc: 0.8848
 Site-SynthDigits               (0) | Val  Loss: 1.4128 | Val  Acc: 0.5824
 Site-MNIST_M                   (3) | Val  Loss: 1.7012 | Val  Acc: 0.4600
 Site-SVHN                      (2) | Val  Loss: 2.0246 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6123
============ Train epoch 27 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.5409 | Train Acc: 0.8511
 Site-USPS                      (1) | Train Loss: 0.5379 | Train Acc: 0.8727
 Site-SynthDigits               (0) | Train Loss: 1.3843 | Train Acc: 0.5956
 Site-MNIST_M                   (3) | Train Loss: 1.6379 | Train Acc: 0.5172
 Site-SVHN                      (2) | Train Loss: 2.0242 | Train Acc: 0.2679
Average Train Accuracy: 0.6209
 Site-MNIST                     (1) | Val  Loss: 0.5094 | Val  Acc: 0.8552
 Site-USPS                      (1) | Val  Loss: 0.5043 | Val  Acc: 0.8727
 Site-SynthDigits               (0) | Val  Loss: 1.3991 | Val  Acc: 0.5714
 Site-MNIST_M                   (3) | Val  Loss: 1.6777 | Val  Acc: 0.5000
 Site-SVHN                      (2) | Val  Loss: 2.0271 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6027
============ Train epoch 28 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.5246 | Train Acc: 0.8528
 Site-USPS                      (1) | Train Loss: 0.5163 | Train Acc: 0.8727
 Site-SynthDigits               (2) | Train Loss: 1.3612 | Train Acc: 0.5984
 Site-MNIST_M                   (0) | Train Loss: 1.5990 | Train Acc: 0.5271
 Site-SVHN                      (3) | Train Loss: 2.0014 | Train Acc: 0.2679
Average Train Accuracy: 0.6238
 Site-MNIST                     (1) | Val  Loss: 0.4950 | Val  Acc: 0.8552
 Site-USPS                      (1) | Val  Loss: 0.4935 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.3845 | Val  Acc: 0.5824
 Site-MNIST_M                   (0) | Val  Loss: 1.6706 | Val  Acc: 0.5000
 Site-SVHN                      (3) | Val  Loss: 2.0107 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6121
============ Train epoch 29 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.5212 | Train Acc: 0.8570
 Site-USPS                      (0) | Train Loss: 0.5139 | Train Acc: 0.8803
 Site-SynthDigits               (2) | Train Loss: 1.3472 | Train Acc: 0.6066
 Site-MNIST_M                   (1) | Train Loss: 1.6003 | Train Acc: 0.5222
 Site-SVHN                      (3) | Train Loss: 2.0032 | Train Acc: 0.2857
Average Train Accuracy: 0.6304
 Site-MNIST                     (0) | Val  Loss: 0.4861 | Val  Acc: 0.8586
 Site-USPS                      (0) | Val  Loss: 0.4905 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 1.3660 | Val  Acc: 0.5824
 Site-MNIST_M                   (1) | Val  Loss: 1.6584 | Val  Acc: 0.4800
 Site-SVHN                      (3) | Val  Loss: 2.0028 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6028
============ Train epoch 30 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.5136 | Train Acc: 0.8587
 Site-USPS                      (1) | Train Loss: 0.5039 | Train Acc: 0.8833
 Site-SynthDigits               (2) | Train Loss: 1.3377 | Train Acc: 0.6093
 Site-MNIST_M                   (0) | Train Loss: 1.6492 | Train Acc: 0.5320
 Site-SVHN                      (3) | Train Loss: 1.9976 | Train Acc: 0.2857
Average Train Accuracy: 0.6338
 Site-MNIST                     (1) | Val  Loss: 0.4793 | Val  Acc: 0.8620
 Site-USPS                      (1) | Val  Loss: 0.4831 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.3539 | Val  Acc: 0.5824
 Site-MNIST_M                   (0) | Val  Loss: 1.6345 | Val  Acc: 0.5200
 Site-SVHN                      (3) | Val  Loss: 1.9925 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6174
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8620
 Best site-USPS                     (1)  | Epoch:30 | Val Acc: 0.8727
 Best site-SynthDigits              (2)  | Epoch:30 | Val Acc: 0.5824
 Best site-MNIST_M                  (0)  | Epoch:30 | Val Acc: 0.5200
 Best site-SVHN                     (3)  | Epoch:30 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 31 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (3) | Train Loss: 0.5019 | Train Acc: 0.8646
 Site-USPS                      (0) | Train Loss: 0.5074 | Train Acc: 0.8833
 Site-SynthDigits               (2) | Train Loss: 1.3149 | Train Acc: 0.6202
 Site-MNIST_M                   (1) | Train Loss: 1.5699 | Train Acc: 0.5419
 Site-SVHN                      (1) | Train Loss: 1.9959 | Train Acc: 0.2946
Average Train Accuracy: 0.6409
 Site-MNIST                     (3) | Val  Loss: 0.4686 | Val  Acc: 0.8721
 Site-USPS                      (0) | Val  Loss: 0.4739 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 1.3386 | Val  Acc: 0.5824
 Site-MNIST_M                   (1) | Val  Loss: 1.6214 | Val  Acc: 0.5400
 Site-SVHN                      (1) | Val  Loss: 1.9948 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6247
 Best site-MNIST                    (3)  | Epoch:31 | Val Acc: 0.8721
 Best site-USPS                     (0)  | Epoch:31 | Val Acc: 0.8788
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.5824
 Best site-MNIST_M                  (1)  | Epoch:31 | Val Acc: 0.5400
 Best site-SVHN                     (1)  | Epoch:31 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 32 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (1) | Train Loss: 0.4888 | Train Acc: 0.8688
 Site-USPS                      (1) | Train Loss: 0.4946 | Train Acc: 0.8818
 Site-SynthDigits               (0) | Train Loss: 1.3167 | Train Acc: 0.6120
 Site-MNIST_M                   (3) | Train Loss: 1.5586 | Train Acc: 0.5665
 Site-SVHN                      (2) | Train Loss: 1.9865 | Train Acc: 0.3036
Average Train Accuracy: 0.6465
 Site-MNIST                     (1) | Val  Loss: 0.4579 | Val  Acc: 0.8721
 Site-USPS                      (1) | Val  Loss: 0.4663 | Val  Acc: 0.8727
 Site-SynthDigits               (0) | Val  Loss: 1.3233 | Val  Acc: 0.5934
 Site-MNIST_M                   (3) | Val  Loss: 1.6083 | Val  Acc: 0.5400
 Site-SVHN                      (2) | Val  Loss: 1.9832 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6256
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.8721
 Best site-USPS                     (1)  | Epoch:32 | Val Acc: 0.8727
 Best site-SynthDigits              (0)  | Epoch:32 | Val Acc: 0.5934
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.5400
 Best site-SVHN                     (2)  | Epoch:32 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 33 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (1) | Train Loss: 0.4851 | Train Acc: 0.8629
 Site-USPS                      (1) | Train Loss: 0.5008 | Train Acc: 0.8803
 Site-SynthDigits               (2) | Train Loss: 1.2811 | Train Acc: 0.6284
 Site-MNIST_M                   (3) | Train Loss: 1.5862 | Train Acc: 0.5665
 Site-SVHN                      (0) | Train Loss: 1.9760 | Train Acc: 0.2946
Average Train Accuracy: 0.6466
 Site-MNIST                     (1) | Val  Loss: 0.4596 | Val  Acc: 0.8620
 Site-USPS                      (1) | Val  Loss: 0.4661 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.3002 | Val  Acc: 0.6264
 Site-MNIST_M                   (3) | Val  Loss: 1.5916 | Val  Acc: 0.5400
 Site-SVHN                      (0) | Val  Loss: 1.9750 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6302
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.8620
 Best site-USPS                     (1)  | Epoch:33 | Val Acc: 0.8727
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.6264
 Best site-MNIST_M                  (3)  | Epoch:33 | Val Acc: 0.5400
 Best site-SVHN                     (0)  | Epoch:33 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 34 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.4824 | Train Acc: 0.8621
 Site-USPS                      (1) | Train Loss: 0.4935 | Train Acc: 0.8833
 Site-SynthDigits               (2) | Train Loss: 1.2775 | Train Acc: 0.6366
 Site-MNIST_M                   (0) | Train Loss: 1.5365 | Train Acc: 0.5911
 Site-SVHN                      (3) | Train Loss: 1.9619 | Train Acc: 0.2946
Average Train Accuracy: 0.6536
 Site-MNIST                     (1) | Val  Loss: 0.4512 | Val  Acc: 0.8586
 Site-USPS                      (1) | Val  Loss: 0.4605 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.2853 | Val  Acc: 0.6154
 Site-MNIST_M                   (0) | Val  Loss: 1.5704 | Val  Acc: 0.5600
 Site-SVHN                      (3) | Val  Loss: 1.9685 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6313
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.8586
 Best site-USPS                     (1)  | Epoch:34 | Val Acc: 0.8727
 Best site-SynthDigits              (2)  | Epoch:34 | Val Acc: 0.6154
 Best site-MNIST_M                  (0)  | Epoch:34 | Val Acc: 0.5600
 Best site-SVHN                     (3)  | Epoch:34 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 35 ============
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (3) | Train Loss: 0.4687 | Train Acc: 0.8764
 Site-USPS                      (1) | Train Loss: 0.4763 | Train Acc: 0.8788
 Site-SynthDigits               (0) | Train Loss: 1.2590 | Train Acc: 0.6366
 Site-MNIST_M                   (2) | Train Loss: 1.5378 | Train Acc: 0.5961
 Site-SVHN                      (2) | Train Loss: 1.9657 | Train Acc: 0.3036
Average Train Accuracy: 0.6583
 Site-MNIST                     (3) | Val  Loss: 0.4383 | Val  Acc: 0.8721
 Site-USPS                      (1) | Val  Loss: 0.4506 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 1.2815 | Val  Acc: 0.6374
 Site-MNIST_M                   (2) | Val  Loss: 1.5646 | Val  Acc: 0.5600
 Site-SVHN                      (2) | Val  Loss: 1.9610 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6396
 Best site-MNIST                    (3)  | Epoch:35 | Val Acc: 0.8721
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.8788
 Best site-SynthDigits              (0)  | Epoch:35 | Val Acc: 0.6374
 Best site-MNIST_M                  (2)  | Epoch:35 | Val Acc: 0.5600
 Best site-SVHN                     (2)  | Epoch:35 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 36 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (0) | Train Loss: 0.4715 | Train Acc: 0.8772
 Site-USPS                      (0) | Train Loss: 0.4774 | Train Acc: 0.8742
 Site-SynthDigits               (2) | Train Loss: 1.2562 | Train Acc: 0.6421
 Site-MNIST_M                   (3) | Train Loss: 1.4668 | Train Acc: 0.6059
 Site-SVHN                      (1) | Train Loss: 1.9556 | Train Acc: 0.3036
Average Train Accuracy: 0.6606
 Site-MNIST                     (0) | Val  Loss: 0.4358 | Val  Acc: 0.8687
 Site-USPS                      (0) | Val  Loss: 0.4465 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.2649 | Val  Acc: 0.6374
 Site-MNIST_M                   (3) | Val  Loss: 1.5584 | Val  Acc: 0.5600
 Site-SVHN                      (1) | Val  Loss: 1.9558 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6378
============ Train epoch 37 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (1) | Train Loss: 0.4700 | Train Acc: 0.8738
 Site-USPS                      (1) | Train Loss: 0.4699 | Train Acc: 0.8909
 Site-SynthDigits               (0) | Train Loss: 1.2352 | Train Acc: 0.6448
 Site-MNIST_M                   (2) | Train Loss: 1.5055 | Train Acc: 0.6010
 Site-SVHN                      (3) | Train Loss: 1.9474 | Train Acc: 0.3393
Average Train Accuracy: 0.6700
 Site-MNIST                     (1) | Val  Loss: 0.4326 | Val  Acc: 0.8653
 Site-USPS                      (1) | Val  Loss: 0.4365 | Val  Acc: 0.8909
 Site-SynthDigits               (0) | Val  Loss: 1.2529 | Val  Acc: 0.6264
 Site-MNIST_M                   (2) | Val  Loss: 1.5489 | Val  Acc: 0.5600
 Site-SVHN                      (3) | Val  Loss: 1.9370 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6385
============ Train epoch 38 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.4549 | Train Acc: 0.8780
 Site-USPS                      (1) | Train Loss: 0.4618 | Train Acc: 0.8879
 Site-SynthDigits               (0) | Train Loss: 1.2245 | Train Acc: 0.6503
 Site-MNIST_M                   (3) | Train Loss: 1.4920 | Train Acc: 0.6207
 Site-SVHN                      (2) | Train Loss: 1.9384 | Train Acc: 0.3125
Average Train Accuracy: 0.6699
 Site-MNIST                     (1) | Val  Loss: 0.4224 | Val  Acc: 0.8721
 Site-USPS                      (1) | Val  Loss: 0.4356 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 1.2455 | Val  Acc: 0.6374
 Site-MNIST_M                   (3) | Val  Loss: 1.5260 | Val  Acc: 0.5600
 Site-SVHN                      (2) | Val  Loss: 1.9307 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6396
============ Train epoch 39 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (1) | Train Loss: 0.4494 | Train Acc: 0.8738
 Site-USPS                      (3) | Train Loss: 0.4770 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 1.2140 | Train Acc: 0.6503
 Site-MNIST_M                   (0) | Train Loss: 1.4780 | Train Acc: 0.6207
 Site-SVHN                      (0) | Train Loss: 1.9375 | Train Acc: 0.3036
Average Train Accuracy: 0.6669
 Site-MNIST                     (1) | Val  Loss: 0.4182 | Val  Acc: 0.8687
 Site-USPS                      (3) | Val  Loss: 0.4279 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.2325 | Val  Acc: 0.6264
 Site-MNIST_M                   (0) | Val  Loss: 1.5118 | Val  Acc: 0.5600
 Site-SVHN                      (0) | Val  Loss: 1.9240 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6356
============ Train epoch 40 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (0) | Train Loss: 0.4435 | Train Acc: 0.8780
 Site-USPS                      (0) | Train Loss: 0.4670 | Train Acc: 0.8848
 Site-SynthDigits               (3) | Train Loss: 1.2029 | Train Acc: 0.6585
 Site-MNIST_M                   (1) | Train Loss: 1.4633 | Train Acc: 0.6355
 Site-SVHN                      (2) | Train Loss: 1.9293 | Train Acc: 0.3036
Average Train Accuracy: 0.6721
 Site-MNIST                     (0) | Val  Loss: 0.4103 | Val  Acc: 0.8721
 Site-USPS                      (0) | Val  Loss: 0.4205 | Val  Acc: 0.8727
 Site-SynthDigits               (3) | Val  Loss: 1.2230 | Val  Acc: 0.6374
 Site-MNIST_M                   (1) | Val  Loss: 1.5001 | Val  Acc: 0.5600
 Site-SVHN                      (2) | Val  Loss: 1.9171 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6384
============ Train epoch 41 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.4395 | Train Acc: 0.8780
 Site-USPS                      (1) | Train Loss: 0.4633 | Train Acc: 0.8818
 Site-SynthDigits               (2) | Train Loss: 1.1785 | Train Acc: 0.6557
 Site-MNIST_M                   (0) | Train Loss: 1.4818 | Train Acc: 0.6256
 Site-SVHN                      (3) | Train Loss: 1.9044 | Train Acc: 0.3214
Average Train Accuracy: 0.6725
 Site-MNIST                     (1) | Val  Loss: 0.4082 | Val  Acc: 0.8721
 Site-USPS                      (1) | Val  Loss: 0.4213 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 1.2082 | Val  Acc: 0.6264
 Site-MNIST_M                   (0) | Val  Loss: 1.4914 | Val  Acc: 0.5600
 Site-SVHN                      (3) | Val  Loss: 1.9073 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6374
============ Train epoch 42 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (0) | Train Loss: 0.4430 | Train Acc: 0.8738
 Site-USPS                      (0) | Train Loss: 0.4528 | Train Acc: 0.8879
 Site-SynthDigits               (2) | Train Loss: 1.1770 | Train Acc: 0.6694
 Site-MNIST_M                   (3) | Train Loss: 1.4564 | Train Acc: 0.6355
 Site-SVHN                      (1) | Train Loss: 1.9042 | Train Acc: 0.3304
Average Train Accuracy: 0.6794
 Site-MNIST                     (0) | Val  Loss: 0.4074 | Val  Acc: 0.8653
 Site-USPS                      (0) | Val  Loss: 0.4165 | Val  Acc: 0.8848
 Site-SynthDigits               (2) | Val  Loss: 1.1954 | Val  Acc: 0.6593
 Site-MNIST_M                   (3) | Val  Loss: 1.4759 | Val  Acc: 0.5600
 Site-SVHN                      (1) | Val  Loss: 1.9010 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6439
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.8653
 Best site-USPS                     (0)  | Epoch:42 | Val Acc: 0.8848
 Best site-SynthDigits              (2)  | Epoch:42 | Val Acc: 0.6593
 Best site-MNIST_M                  (3)  | Epoch:42 | Val Acc: 0.5600
 Best site-SVHN                     (1)  | Epoch:42 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 43 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (1) | Train Loss: 0.4291 | Train Acc: 0.8789
 Site-USPS                      (1) | Train Loss: 0.4365 | Train Acc: 0.8909
 Site-SynthDigits               (0) | Train Loss: 1.1724 | Train Acc: 0.6694
 Site-MNIST_M                   (3) | Train Loss: 1.4110 | Train Acc: 0.6256
 Site-SVHN                      (2) | Train Loss: 1.9059 | Train Acc: 0.3393
Average Train Accuracy: 0.6808
 Site-MNIST                     (1) | Val  Loss: 0.3972 | Val  Acc: 0.8721
 Site-USPS                      (1) | Val  Loss: 0.4070 | Val  Acc: 0.8909
 Site-SynthDigits               (0) | Val  Loss: 1.1871 | Val  Acc: 0.6484
 Site-MNIST_M                   (3) | Val  Loss: 1.4706 | Val  Acc: 0.5600
 Site-SVHN                      (2) | Val  Loss: 1.8947 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6443
 Best site-MNIST                    (1)  | Epoch:43 | Val Acc: 0.8721
 Best site-USPS                     (1)  | Epoch:43 | Val Acc: 0.8909
 Best site-SynthDigits              (0)  | Epoch:43 | Val Acc: 0.6484
 Best site-MNIST_M                  (3)  | Epoch:43 | Val Acc: 0.5600
 Best site-SVHN                     (2)  | Epoch:43 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 44 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.4200 | Train Acc: 0.8797
 Site-USPS                      (0) | Train Loss: 0.4305 | Train Acc: 0.8970
 Site-SynthDigits               (2) | Train Loss: 1.1449 | Train Acc: 0.6776
 Site-MNIST_M                   (3) | Train Loss: 1.3771 | Train Acc: 0.6453
 Site-SVHN                      (1) | Train Loss: 1.8851 | Train Acc: 0.3393
Average Train Accuracy: 0.6878
 Site-MNIST                     (0) | Val  Loss: 0.3929 | Val  Acc: 0.8653
 Site-USPS                      (0) | Val  Loss: 0.4018 | Val  Acc: 0.9030
 Site-SynthDigits               (2) | Val  Loss: 1.1709 | Val  Acc: 0.6484
 Site-MNIST_M                   (3) | Val  Loss: 1.4650 | Val  Acc: 0.5800
 Site-SVHN                      (1) | Val  Loss: 1.8788 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6493
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.8653
 Best site-USPS                     (0)  | Epoch:44 | Val Acc: 0.9030
 Best site-SynthDigits              (2)  | Epoch:44 | Val Acc: 0.6484
 Best site-MNIST_M                  (3)  | Epoch:44 | Val Acc: 0.5800
 Best site-SVHN                     (1)  | Epoch:44 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 45 ============
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (1) | Train Loss: 0.4193 | Train Acc: 0.8823
 Site-USPS                      (1) | Train Loss: 0.4283 | Train Acc: 0.8939
 Site-SynthDigits               (2) | Train Loss: 1.1432 | Train Acc: 0.6913
 Site-MNIST_M                   (3) | Train Loss: 1.4649 | Train Acc: 0.6355
 Site-SVHN                      (0) | Train Loss: 1.8722 | Train Acc: 0.3571
Average Train Accuracy: 0.6920
 Site-MNIST                     (1) | Val  Loss: 0.3869 | Val  Acc: 0.8788
 Site-USPS                      (1) | Val  Loss: 0.3981 | Val  Acc: 0.8909
 Site-SynthDigits               (2) | Val  Loss: 1.1629 | Val  Acc: 0.6593
 Site-MNIST_M                   (3) | Val  Loss: 1.4531 | Val  Acc: 0.5600
 Site-SVHN                      (0) | Val  Loss: 1.8751 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6550
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.8788
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8909
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.6593
 Best site-MNIST_M                  (3)  | Epoch:45 | Val Acc: 0.5600
 Best site-SVHN                     (0)  | Epoch:45 | Val Acc: 0.2857
 Test site-MNIST                     (1)| Epoch:45 | Test Acc: 0.8671
 Test site-USPS                      (1)| Epoch:45 | Test Acc: 0.9011
 Test site-SynthDigits               (2)| Epoch:45 | Test Acc: 0.5892
 Test site-MNIST_M                   (3)| Epoch:45 | Test Acc: 0.3917
 Test site-SVHN                      (0)| Epoch:45 | Test Acc: 0.2776
MNIST: 0.8671, USPS: 0.9011, SynthDigits: 0.5892, MNIST_M: 0.3917, SVHN: 0.2776, 
Average Test Accuracy(group): 0.6054, Average Test Accuracy(individual): 0.6054,
domain std=0.2487, cluster std=0.2300, individual std=0.2487, 
Average Test Accuracy: 0.6054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 46 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (0) | Train Loss: 0.4189 | Train Acc: 0.8823
 Site-USPS                      (0) | Train Loss: 0.4223 | Train Acc: 0.8955
 Site-SynthDigits               (2) | Train Loss: 1.1308 | Train Acc: 0.6885
 Site-MNIST_M                   (1) | Train Loss: 1.4307 | Train Acc: 0.6502
 Site-SVHN                      (3) | Train Loss: 1.8696 | Train Acc: 0.3482
Average Train Accuracy: 0.6929
 Site-MNIST                     (0) | Val  Loss: 0.3886 | Val  Acc: 0.8754
 Site-USPS                      (0) | Val  Loss: 0.3968 | Val  Acc: 0.8970
 Site-SynthDigits               (2) | Val  Loss: 1.1514 | Val  Acc: 0.6593
 Site-MNIST_M                   (1) | Val  Loss: 1.4309 | Val  Acc: 0.5600
 Site-SVHN                      (3) | Val  Loss: 1.8669 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6483
 Test site-MNIST                     (0)| Epoch:45 | Test Acc: 0.8663
 Test site-USPS                      (0)| Epoch:45 | Test Acc: 0.8946
 Test site-SynthDigits               (2)| Epoch:45 | Test Acc: 0.5925
 Test site-MNIST_M                   (1)| Epoch:45 | Test Acc: 0.3920
 Test site-SVHN                      (3)| Epoch:45 | Test Acc: 0.2766
MNIST: 0.8663, USPS: 0.8946, SynthDigits: 0.5925, MNIST_M: 0.3920, SVHN: 0.2766, 
Average Test Accuracy(group): 0.6044, Average Test Accuracy(individual): 0.6044,
domain std=0.2472, cluster std=0.2291, individual std=0.2472, 
Average Test Accuracy: 0.6044
============ Train epoch 47 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (0) | Train Loss: 0.4064 | Train Acc: 0.8856
 Site-USPS                      (0) | Train Loss: 0.4435 | Train Acc: 0.8970
 Site-SynthDigits               (2) | Train Loss: 1.1189 | Train Acc: 0.6885
 Site-MNIST_M                   (1) | Train Loss: 1.4091 | Train Acc: 0.6502
 Site-SVHN                      (3) | Train Loss: 1.8541 | Train Acc: 0.3393
Average Train Accuracy: 0.6921
 Site-MNIST                     (0) | Val  Loss: 0.3775 | Val  Acc: 0.8855
 Site-USPS                      (0) | Val  Loss: 0.3921 | Val  Acc: 0.8970
 Site-SynthDigits               (2) | Val  Loss: 1.1461 | Val  Acc: 0.6593
 Site-MNIST_M                   (1) | Val  Loss: 1.4256 | Val  Acc: 0.5800
 Site-SVHN                      (3) | Val  Loss: 1.8456 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6544
 Test site-MNIST                     (0)| Epoch:45 | Test Acc: 0.8689
 Test site-USPS                      (0)| Epoch:45 | Test Acc: 0.8989
 Test site-SynthDigits               (2)| Epoch:45 | Test Acc: 0.5917
 Test site-MNIST_M                   (1)| Epoch:45 | Test Acc: 0.3946
 Test site-SVHN                      (3)| Epoch:45 | Test Acc: 0.2792
MNIST: 0.8689, USPS: 0.8989, SynthDigits: 0.5917, MNIST_M: 0.3946, SVHN: 0.2792, 
Average Test Accuracy(group): 0.6067, Average Test Accuracy(individual): 0.6067,
domain std=0.2476, cluster std=0.2292, individual std=0.2476, 
Average Test Accuracy: 0.6067
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/ablation...
============ Train epoch 48 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (0) | Train Loss: 0.4070 | Train Acc: 0.8839
 Site-USPS                      (0) | Train Loss: 0.4302 | Train Acc: 0.8955
 Site-SynthDigits               (2) | Train Loss: 1.1100 | Train Acc: 0.6913
 Site-MNIST_M                   (1) | Train Loss: 1.3809 | Train Acc: 0.6601
 Site-SVHN                      (3) | Train Loss: 1.8546 | Train Acc: 0.3393
Average Train Accuracy: 0.6940
 Site-MNIST                     (0) | Val  Loss: 0.3779 | Val  Acc: 0.8822
 Site-USPS                      (0) | Val  Loss: 0.3937 | Val  Acc: 0.9030
 Site-SynthDigits               (2) | Val  Loss: 1.1344 | Val  Acc: 0.6593
 Site-MNIST_M                   (1) | Val  Loss: 1.4117 | Val  Acc: 0.5800
 Site-SVHN                      (3) | Val  Loss: 1.8461 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6549
 Test site-MNIST                     (0)| Epoch:47 | Test Acc: 0.8671
 Test site-USPS                      (0)| Epoch:47 | Test Acc: 0.8946
 Test site-SynthDigits               (2)| Epoch:47 | Test Acc: 0.5957
 Test site-MNIST_M                   (1)| Epoch:47 | Test Acc: 0.3951
 Test site-SVHN                      (3)| Epoch:47 | Test Acc: 0.2774
MNIST: 0.8671, USPS: 0.8946, SynthDigits: 0.5957, MNIST_M: 0.3951, SVHN: 0.2774, 
Average Test Accuracy(group): 0.6060, Average Test Accuracy(individual): 0.6060,
domain std=0.2466, cluster std=0.2287, individual std=0.2466, 
Average Test Accuracy: 0.6060
============ Train epoch 49 ============
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (3) | Train Loss: 0.4030 | Train Acc: 0.8881
 Site-USPS                      (1) | Train Loss: 0.4233 | Train Acc: 0.8909
 Site-SynthDigits               (2) | Train Loss: 1.1005 | Train Acc: 0.6995
 Site-MNIST_M                   (0) | Train Loss: 1.3184 | Train Acc: 0.6601
 Site-SVHN                      (0) | Train Loss: 1.8466 | Train Acc: 0.3482
Average Train Accuracy: 0.6974
 Site-MNIST                     (3) | Val  Loss: 0.3693 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3900 | Val  Acc: 0.8970
 Site-SynthDigits               (2) | Val  Loss: 1.1316 | Val  Acc: 0.6703
 Site-MNIST_M                   (0) | Val  Loss: 1.3921 | Val  Acc: 0.5800
 Site-SVHN                      (0) | Val  Loss: 1.8444 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6572
 Best site-MNIST                    (3)  | Epoch:49 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.8970
 Best site-SynthDigits              (2)  | Epoch:49 | Val Acc: 0.6703
 Best site-MNIST_M                  (0)  | Epoch:49 | Val Acc: 0.5800
 Best site-SVHN                     (0)  | Epoch:49 | Val Acc: 0.2500
 Test site-MNIST                     (3)| Epoch:49 | Test Acc: 0.8709
 Test site-USPS                      (1)| Epoch:49 | Test Acc: 0.8989
 Test site-SynthDigits               (2)| Epoch:49 | Test Acc: 0.5945
 Test site-MNIST_M                   (0)| Epoch:49 | Test Acc: 0.3917
 Test site-SVHN                      (0)| Epoch:49 | Test Acc: 0.2772
MNIST: 0.8709, USPS: 0.8989, SynthDigits: 0.5945, MNIST_M: 0.3917, SVHN: 0.2772, 
Average Test Accuracy(group): 0.6066, Average Test Accuracy(individual): 0.6066,
domain std=0.2490, cluster std=0.2297, individual std=0.2490, 
Average Test Accuracy: 0.6066
===2023-07-02 02:45:56===
===2023-07-02 02:45:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.8689
 Test site-USPS                      | Epoch:47 | Test Acc: 0.8989
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.5917
 Test site-MNIST_M                   | Epoch:47 | Test Acc: 0.3946
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2792
MNIST: 0.8689, USPS: 0.8989, SynthDigits: 0.5917, MNIST_M: 0.3946, SVHN: 0.2792, 
Average Test Accuracy(group): 0.6067, Average Test Accuracy(individual): 0.6067,
domain std=0.2476, cluster std=-1.0000, individual std=0.2476, 
