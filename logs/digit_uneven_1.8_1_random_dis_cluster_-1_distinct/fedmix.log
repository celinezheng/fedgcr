===2023-07-02 04:35:27===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0070 | Train Acc: 0.6770
 Site-USPS                          | Train Loss: 2.0050 | Train Acc: 0.6015
 Site-SynthDigits                   | Train Loss: 2.2444 | Train Acc: 0.2268
 Site-MNIST_M                       | Train Loss: 2.2890 | Train Acc: 0.1330
 Site-SVHN                          | Train Loss: 2.2835 | Train Acc: 0.1250
Average Train Accuracy: 0.3527
 Site-MNIST                         | Val  Loss: 2.0076 | Val  Acc: 0.6566
 Site-USPS                          | Val  Loss: 1.9955 | Val  Acc: 0.5939
 Site-SynthDigits                   | Val  Loss: 2.2476 | Val  Acc: 0.2198
 Site-MNIST_M                       | Val  Loss: 2.2823 | Val  Acc: 0.1200
 Site-SVHN                          | Val  Loss: 2.2702 | Val  Acc: 0.1786
Average Valid Accuracy: 0.3538
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6566
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5939
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2198
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1200
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.7546 | Train Acc: 0.7325
 Site-USPS                          | Train Loss: 1.7506 | Train Acc: 0.6697
 Site-SynthDigits                   | Train Loss: 2.1773 | Train Acc: 0.2623
 Site-MNIST_M                       | Train Loss: 2.2484 | Train Acc: 0.2414
 Site-SVHN                          | Train Loss: 2.2682 | Train Acc: 0.1339
Average Train Accuracy: 0.4080
 Site-MNIST                         | Val  Loss: 1.7482 | Val  Acc: 0.7273
 Site-USPS                          | Val  Loss: 1.7338 | Val  Acc: 0.6424
 Site-SynthDigits                   | Val  Loss: 2.1751 | Val  Acc: 0.2857
 Site-MNIST_M                       | Val  Loss: 2.2627 | Val  Acc: 0.1800
 Site-SVHN                          | Val  Loss: 2.2499 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4099
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7273
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6424
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2857
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1800
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.5201 | Train Acc: 0.7603
 Site-USPS                          | Train Loss: 1.5184 | Train Acc: 0.7121
 Site-SynthDigits                   | Train Loss: 2.1135 | Train Acc: 0.2842
 Site-MNIST_M                       | Train Loss: 2.1992 | Train Acc: 0.2759
 Site-SVHN                          | Train Loss: 2.2569 | Train Acc: 0.1429
Average Train Accuracy: 0.4351
 Site-MNIST                         | Val  Loss: 1.5084 | Val  Acc: 0.7710
 Site-USPS                          | Val  Loss: 1.5023 | Val  Acc: 0.6970
 Site-SynthDigits                   | Val  Loss: 2.1126 | Val  Acc: 0.2967
 Site-MNIST_M                       | Val  Loss: 2.2324 | Val  Acc: 0.2200
 Site-SVHN                          | Val  Loss: 2.2363 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4398
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7710
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6970
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2967
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2200
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.3059 | Train Acc: 0.7923
 Site-USPS                          | Train Loss: 1.3694 | Train Acc: 0.7318
 Site-SynthDigits                   | Train Loss: 2.0641 | Train Acc: 0.2951
 Site-MNIST_M                       | Train Loss: 2.1955 | Train Acc: 0.2611
 Site-SVHN                          | Train Loss: 2.2478 | Train Acc: 0.1607
Average Train Accuracy: 0.4482
 Site-MNIST                         | Val  Loss: 1.2918 | Val  Acc: 0.7912
 Site-USPS                          | Val  Loss: 1.3369 | Val  Acc: 0.7333
 Site-SynthDigits                   | Val  Loss: 2.0691 | Val  Acc: 0.3297
 Site-MNIST_M                       | Val  Loss: 2.2066 | Val  Acc: 0.2600
 Site-SVHN                          | Val  Loss: 2.2283 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4586
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7912
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7333
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3297
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2600
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.1599 | Train Acc: 0.8225
 Site-USPS                          | Train Loss: 1.2085 | Train Acc: 0.7697
 Site-SynthDigits                   | Train Loss: 2.0165 | Train Acc: 0.2896
 Site-MNIST_M                       | Train Loss: 2.1403 | Train Acc: 0.2611
 Site-SVHN                          | Train Loss: 2.2366 | Train Acc: 0.1518
Average Train Accuracy: 0.4589
 Site-MNIST                         | Val  Loss: 1.1426 | Val  Acc: 0.8215
 Site-USPS                          | Val  Loss: 1.1773 | Val  Acc: 0.7758
 Site-SynthDigits                   | Val  Loss: 2.0148 | Val  Acc: 0.3077
 Site-MNIST_M                       | Val  Loss: 2.1750 | Val  Acc: 0.2800
 Site-SVHN                          | Val  Loss: 2.2198 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4727
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8215
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7758
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3077
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2800
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.0126 | Train Acc: 0.8343
 Site-USPS                          | Train Loss: 1.0815 | Train Acc: 0.7864
 Site-SynthDigits                   | Train Loss: 1.9729 | Train Acc: 0.3115
 Site-MNIST_M                       | Train Loss: 2.1296 | Train Acc: 0.2660
 Site-SVHN                          | Train Loss: 2.2267 | Train Acc: 0.1875
Average Train Accuracy: 0.4771
 Site-MNIST                         | Val  Loss: 0.9951 | Val  Acc: 0.8249
 Site-USPS                          | Val  Loss: 1.0671 | Val  Acc: 0.7818
 Site-SynthDigits                   | Val  Loss: 1.9807 | Val  Acc: 0.3297
 Site-MNIST_M                       | Val  Loss: 2.1492 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.2084 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5044
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8249
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7818
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3297
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3000
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.9066 | Train Acc: 0.8444
 Site-USPS                          | Train Loss: 0.9755 | Train Acc: 0.8121
 Site-SynthDigits                   | Train Loss: 1.9528 | Train Acc: 0.3306
 Site-MNIST_M                       | Train Loss: 2.0706 | Train Acc: 0.3005
 Site-SVHN                          | Train Loss: 2.2229 | Train Acc: 0.1964
Average Train Accuracy: 0.4968
 Site-MNIST                         | Val  Loss: 0.8862 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.9558 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.9463 | Val  Acc: 0.3407
 Site-MNIST_M                       | Val  Loss: 2.1248 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.2070 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5093
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8316
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3407
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3000
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.8232 | Train Acc: 0.8452
 Site-USPS                          | Train Loss: 0.8846 | Train Acc: 0.8348
 Site-SynthDigits                   | Train Loss: 1.9076 | Train Acc: 0.3388
 Site-MNIST_M                       | Train Loss: 2.0440 | Train Acc: 0.2956
 Site-SVHN                          | Train Loss: 2.2146 | Train Acc: 0.2054
Average Train Accuracy: 0.5040
 Site-MNIST                         | Val  Loss: 0.8003 | Val  Acc: 0.8350
 Site-USPS                          | Val  Loss: 0.8545 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.9224 | Val  Acc: 0.3516
 Site-MNIST_M                       | Val  Loss: 2.1043 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.2036 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5043
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.7468 | Train Acc: 0.8545
 Site-USPS                          | Train Loss: 0.7838 | Train Acc: 0.8394
 Site-SynthDigits                   | Train Loss: 1.9050 | Train Acc: 0.3497
 Site-MNIST_M                       | Train Loss: 2.0229 | Train Acc: 0.3005
 Site-SVHN                          | Train Loss: 2.2078 | Train Acc: 0.1875
Average Train Accuracy: 0.5063
 Site-MNIST                         | Val  Loss: 0.7208 | Val  Acc: 0.8519
 Site-USPS                          | Val  Loss: 0.7767 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.9019 | Val  Acc: 0.3846
 Site-MNIST_M                       | Val  Loss: 2.0934 | Val  Acc: 0.2800
 Site-SVHN                          | Val  Loss: 2.1964 | Val  Acc: 0.1071
Average Valid Accuracy: 0.4920
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.6711 | Train Acc: 0.8671
 Site-USPS                          | Train Loss: 0.7509 | Train Acc: 0.8394
 Site-SynthDigits                   | Train Loss: 1.8806 | Train Acc: 0.3607
 Site-MNIST_M                       | Train Loss: 2.0536 | Train Acc: 0.3054
 Site-SVHN                          | Train Loss: 2.2161 | Train Acc: 0.1875
Average Train Accuracy: 0.5120
 Site-MNIST                         | Val  Loss: 0.6487 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.7324 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.8881 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 2.0638 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.1996 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5050
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.6283 | Train Acc: 0.8705
 Site-USPS                          | Train Loss: 0.6842 | Train Acc: 0.8545
 Site-SynthDigits                   | Train Loss: 1.8465 | Train Acc: 0.3825
 Site-MNIST_M                       | Train Loss: 2.0053 | Train Acc: 0.3251
 Site-SVHN                          | Train Loss: 2.2181 | Train Acc: 0.1696
Average Train Accuracy: 0.5205
 Site-MNIST                         | Val  Loss: 0.6017 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.6738 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.8615 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 2.0621 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.1985 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5107
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8653
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4066
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3200
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.5861 | Train Acc: 0.8705
 Site-USPS                          | Train Loss: 0.6433 | Train Acc: 0.8652
 Site-SynthDigits                   | Train Loss: 1.8301 | Train Acc: 0.4016
 Site-MNIST_M                       | Train Loss: 1.9309 | Train Acc: 0.3251
 Site-SVHN                          | Train Loss: 2.2114 | Train Acc: 0.1696
Average Train Accuracy: 0.5264
 Site-MNIST                         | Val  Loss: 0.5612 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.6233 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.8484 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 2.0355 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.1963 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5185
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8653
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4176
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3000
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.5419 | Train Acc: 0.8831
 Site-USPS                          | Train Loss: 0.6179 | Train Acc: 0.8545
 Site-SynthDigits                   | Train Loss: 1.8178 | Train Acc: 0.4044
 Site-MNIST_M                       | Train Loss: 2.0087 | Train Acc: 0.3399
 Site-SVHN                          | Train Loss: 2.2222 | Train Acc: 0.1696
Average Train Accuracy: 0.5303
 Site-MNIST                         | Val  Loss: 0.5267 | Val  Acc: 0.8754
 Site-USPS                          | Val  Loss: 0.6002 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.8377 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 2.0340 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.1965 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5171
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.5282 | Train Acc: 0.8806
 Site-USPS                          | Train Loss: 0.5731 | Train Acc: 0.8773
 Site-SynthDigits                   | Train Loss: 1.8112 | Train Acc: 0.3962
 Site-MNIST_M                       | Train Loss: 1.9508 | Train Acc: 0.3251
 Site-SVHN                          | Train Loss: 2.1987 | Train Acc: 0.1875
Average Train Accuracy: 0.5333
 Site-MNIST                         | Val  Loss: 0.5109 | Val  Acc: 0.8687
 Site-USPS                          | Val  Loss: 0.5615 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.8187 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 2.0168 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.2011 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5157
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.4991 | Train Acc: 0.8932
 Site-USPS                          | Train Loss: 0.5622 | Train Acc: 0.8773
 Site-SynthDigits                   | Train Loss: 1.7808 | Train Acc: 0.4044
 Site-MNIST_M                       | Train Loss: 1.9148 | Train Acc: 0.3448
 Site-SVHN                          | Train Loss: 2.2103 | Train Acc: 0.1607
Average Train Accuracy: 0.5361
 Site-MNIST                         | Val  Loss: 0.4808 | Val  Acc: 0.8822
 Site-USPS                          | Val  Loss: 0.5460 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8014 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 2.0010 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.2014 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5171
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.4654 | Train Acc: 0.8974
 Site-USPS                          | Train Loss: 0.5171 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.7540 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 1.9492 | Train Acc: 0.3695
 Site-SVHN                          | Train Loss: 2.2149 | Train Acc: 0.1786
Average Train Accuracy: 0.5518
 Site-MNIST                         | Val  Loss: 0.4489 | Val  Acc: 0.8855
 Site-USPS                          | Val  Loss: 0.5075 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.7853 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.9831 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.1961 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5358
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8855
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8909
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.3200
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.4478 | Train Acc: 0.8999
 Site-USPS                          | Train Loss: 0.5046 | Train Acc: 0.8773
 Site-SynthDigits                   | Train Loss: 1.7489 | Train Acc: 0.4180
 Site-MNIST_M                       | Train Loss: 1.8951 | Train Acc: 0.3547
 Site-SVHN                          | Train Loss: 2.2014 | Train Acc: 0.1696
Average Train Accuracy: 0.5439
 Site-MNIST                         | Val  Loss: 0.4309 | Val  Acc: 0.8855
 Site-USPS                          | Val  Loss: 0.4902 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7807 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.9733 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.1965 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5298
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.4151 | Train Acc: 0.9066
 Site-USPS                          | Train Loss: 0.4826 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.7288 | Train Acc: 0.4153
 Site-MNIST_M                       | Train Loss: 1.8804 | Train Acc: 0.3547
 Site-SVHN                          | Train Loss: 2.2193 | Train Acc: 0.1696
Average Train Accuracy: 0.5462
 Site-MNIST                         | Val  Loss: 0.3966 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.4628 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.7707 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.9643 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1997 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5396
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8956
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8909
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.4030 | Train Acc: 0.9125
 Site-USPS                          | Train Loss: 0.4637 | Train Acc: 0.8924
 Site-SynthDigits                   | Train Loss: 1.7214 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 1.7999 | Train Acc: 0.3645
 Site-SVHN                          | Train Loss: 2.2106 | Train Acc: 0.1607
Average Train Accuracy: 0.5518
 Site-MNIST                         | Val  Loss: 0.3827 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4446 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.7582 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.9346 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.2034 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5434
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9024
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4286
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.3984 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.4344 | Train Acc: 0.9000
 Site-SynthDigits                   | Train Loss: 1.7084 | Train Acc: 0.4126
 Site-MNIST_M                       | Train Loss: 1.8924 | Train Acc: 0.3744
 Site-SVHN                          | Train Loss: 2.2313 | Train Acc: 0.1607
Average Train Accuracy: 0.5507
 Site-MNIST                         | Val  Loss: 0.3831 | Val  Acc: 0.8956
 Site-USPS                          | Val  Loss: 0.4260 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7461 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.9050 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.2101 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5430
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.3567 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.4490 | Train Acc: 0.9030
 Site-SynthDigits                   | Train Loss: 1.7331 | Train Acc: 0.4235
 Site-MNIST_M                       | Train Loss: 1.8357 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.2159 | Train Acc: 0.1607
Average Train Accuracy: 0.5603
 Site-MNIST                         | Val  Loss: 0.3439 | Val  Acc: 0.9091
 Site-USPS                          | Val  Loss: 0.4227 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.7736 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.9064 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2063 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5424
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.3614 | Train Acc: 0.9176
 Site-USPS                          | Train Loss: 0.4360 | Train Acc: 0.9030
 Site-SynthDigits                   | Train Loss: 1.6975 | Train Acc: 0.4399
 Site-MNIST_M                       | Train Loss: 1.8435 | Train Acc: 0.3842
 Site-SVHN                          | Train Loss: 2.2001 | Train Acc: 0.1607
Average Train Accuracy: 0.5611
 Site-MNIST                         | Val  Loss: 0.3468 | Val  Acc: 0.9057
 Site-USPS                          | Val  Loss: 0.4067 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7413 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.8877 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2143 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5459
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9057
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8970
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.3424 | Train Acc: 0.9218
 Site-USPS                          | Train Loss: 0.4053 | Train Acc: 0.9061
 Site-SynthDigits                   | Train Loss: 1.6889 | Train Acc: 0.4536
 Site-MNIST_M                       | Train Loss: 1.8151 | Train Acc: 0.3793
 Site-SVHN                          | Train Loss: 2.2100 | Train Acc: 0.1339
Average Train Accuracy: 0.5589
 Site-MNIST                         | Val  Loss: 0.3273 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.3856 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.7423 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.8832 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2081 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5386
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.3307 | Train Acc: 0.9251
 Site-USPS                          | Train Loss: 0.3833 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.6740 | Train Acc: 0.4344
 Site-MNIST_M                       | Train Loss: 1.8610 | Train Acc: 0.4138
 Site-SVHN                          | Train Loss: 2.2271 | Train Acc: 0.1607
Average Train Accuracy: 0.5695
 Site-MNIST                         | Val  Loss: 0.3177 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.3704 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.7366 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.8551 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2138 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5484
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9125
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.3144 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.3717 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.6883 | Train Acc: 0.4454
 Site-MNIST_M                       | Train Loss: 1.8551 | Train Acc: 0.4138
 Site-SVHN                          | Train Loss: 2.2215 | Train Acc: 0.1696
Average Train Accuracy: 0.5745
 Site-MNIST                         | Val  Loss: 0.2977 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.3616 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.7520 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.8637 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2215 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5483
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.2965 | Train Acc: 0.9319
 Site-USPS                          | Train Loss: 0.3891 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.6810 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.8186 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.2052 | Train Acc: 0.1786
Average Train Accuracy: 0.5767
 Site-MNIST                         | Val  Loss: 0.2818 | Val  Acc: 0.9192
 Site-USPS                          | Val  Loss: 0.3564 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.7475 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8620 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2194 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5530
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9192
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9212
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.4176
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.2952 | Train Acc: 0.9344
 Site-USPS                          | Train Loss: 0.3449 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.6678 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.8114 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.2206 | Train Acc: 0.1518
Average Train Accuracy: 0.5739
 Site-MNIST                         | Val  Loss: 0.2794 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3435 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.7273 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.8349 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.2218 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5629
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.2674 | Train Acc: 0.9470
 Site-USPS                          | Train Loss: 0.3598 | Train Acc: 0.9197
 Site-SynthDigits                   | Train Loss: 1.6770 | Train Acc: 0.4344
 Site-MNIST_M                       | Train Loss: 1.8573 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2350 | Train Acc: 0.1518
Average Train Accuracy: 0.5724
 Site-MNIST                         | Val  Loss: 0.2548 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3475 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.7477 | Val  Acc: 0.3846
 Site-MNIST_M                       | Val  Loss: 1.8413 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2206 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5511
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.2811 | Train Acc: 0.9361
 Site-USPS                          | Train Loss: 0.3336 | Train Acc: 0.9227
 Site-SynthDigits                   | Train Loss: 1.6534 | Train Acc: 0.4563
 Site-MNIST_M                       | Train Loss: 1.8539 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2235 | Train Acc: 0.1518
Average Train Accuracy: 0.5751
 Site-MNIST                         | Val  Loss: 0.2629 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3212 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.7114 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8177 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.2333 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5587
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.2592 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.3300 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.6472 | Train Acc: 0.4454
 Site-MNIST_M                       | Train Loss: 1.7329 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.2112 | Train Acc: 0.1518
Average Train Accuracy: 0.5726
 Site-MNIST                         | Val  Loss: 0.2422 | Val  Acc: 0.9461
 Site-USPS                          | Val  Loss: 0.3229 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.7344 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8446 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2182 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5494
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.2484 | Train Acc: 0.9479
 Site-USPS                          | Train Loss: 0.3206 | Train Acc: 0.9273
 Site-SynthDigits                   | Train Loss: 1.6394 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 1.7088 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2331 | Train Acc: 0.1429
Average Train Accuracy: 0.5755
 Site-MNIST                         | Val  Loss: 0.2333 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3158 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.7188 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8313 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2296 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5563
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.2413 | Train Acc: 0.9537
 Site-USPS                          | Train Loss: 0.3300 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.6201 | Train Acc: 0.4617
 Site-MNIST_M                       | Train Loss: 1.7134 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.2234 | Train Acc: 0.1518
Average Train Accuracy: 0.5820
 Site-MNIST                         | Val  Loss: 0.2277 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3013 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.7009 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8356 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.2229 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5628
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.2364 | Train Acc: 0.9554
 Site-USPS                          | Train Loss: 0.3090 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.6240 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.7442 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.2247 | Train Acc: 0.1518
Average Train Accuracy: 0.5770
 Site-MNIST                         | Val  Loss: 0.2205 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.2994 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.7118 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8456 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2294 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5570
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.2222 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2949 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.6283 | Train Acc: 0.4536
 Site-MNIST_M                       | Train Loss: 1.7396 | Train Acc: 0.3793
 Site-SVHN                          | Train Loss: 2.2215 | Train Acc: 0.1607
Average Train Accuracy: 0.5768
 Site-MNIST                         | Val  Loss: 0.2089 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2896 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.7025 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.8467 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2288 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5671
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4396
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.2129 | Train Acc: 0.9605
 Site-USPS                          | Train Loss: 0.3118 | Train Acc: 0.9288
 Site-SynthDigits                   | Train Loss: 1.6158 | Train Acc: 0.4617
 Site-MNIST_M                       | Train Loss: 1.7205 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.2218 | Train Acc: 0.1518
Average Train Accuracy: 0.5784
 Site-MNIST                         | Val  Loss: 0.2023 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2816 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.7021 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.8407 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2310 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5577
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.2108 | Train Acc: 0.9630
 Site-USPS                          | Train Loss: 0.2864 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.6109 | Train Acc: 0.4645
 Site-MNIST_M                       | Train Loss: 1.7956 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.2162 | Train Acc: 0.1696
Average Train Accuracy: 0.5842
 Site-MNIST                         | Val  Loss: 0.1980 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2777 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.7044 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.8463 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2424 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5739
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9630
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.4505
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.2119 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2885 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.5989 | Train Acc: 0.4590
 Site-MNIST_M                       | Train Loss: 1.7300 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.2395 | Train Acc: 0.1607
Average Train Accuracy: 0.5812
 Site-MNIST                         | Val  Loss: 0.1997 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.2599 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6872 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.8371 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2425 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5652
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.2012 | Train Acc: 0.9638
 Site-USPS                          | Train Loss: 0.2844 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.5932 | Train Acc: 0.4754
 Site-MNIST_M                       | Train Loss: 1.8475 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2255 | Train Acc: 0.1875
Average Train Accuracy: 0.5938
 Site-MNIST                         | Val  Loss: 0.1871 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2612 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6849 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.8399 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2486 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5814
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9596
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9273
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4615
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1959 | Train Acc: 0.9622
 Site-USPS                          | Train Loss: 0.2833 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.5920 | Train Acc: 0.4754
 Site-MNIST_M                       | Train Loss: 1.7546 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2509 | Train Acc: 0.1429
Average Train Accuracy: 0.5848
 Site-MNIST                         | Val  Loss: 0.1832 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2548 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6801 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.8256 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2629 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5709
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1849 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.2659 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.5992 | Train Acc: 0.4836
 Site-MNIST_M                       | Train Loss: 1.7206 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.2298 | Train Acc: 0.1607
Average Train Accuracy: 0.5876
 Site-MNIST                         | Val  Loss: 0.1716 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2554 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.6897 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.8380 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.2556 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5537
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1830 | Train Acc: 0.9672
 Site-USPS                          | Train Loss: 0.2474 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.5679 | Train Acc: 0.4945
 Site-MNIST_M                       | Train Loss: 1.7266 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.2201 | Train Acc: 0.1786
Average Train Accuracy: 0.5985
 Site-MNIST                         | Val  Loss: 0.1712 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2383 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6688 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.8276 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2468 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5834
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9697
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9273
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.4615
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1794 | Train Acc: 0.9672
 Site-USPS                          | Train Loss: 0.2578 | Train Acc: 0.9364
 Site-SynthDigits                   | Train Loss: 1.5569 | Train Acc: 0.4918
 Site-MNIST_M                       | Train Loss: 1.7239 | Train Acc: 0.4138
 Site-SVHN                          | Train Loss: 2.2325 | Train Acc: 0.1696
Average Train Accuracy: 0.5958
 Site-MNIST                         | Val  Loss: 0.1671 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2373 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6547 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.8222 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2570 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5803
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1686 | Train Acc: 0.9689
 Site-USPS                          | Train Loss: 0.2455 | Train Acc: 0.9409
 Site-SynthDigits                   | Train Loss: 1.5850 | Train Acc: 0.4945
 Site-MNIST_M                       | Train Loss: 1.7511 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.2219 | Train Acc: 0.1696
Average Train Accuracy: 0.5995
 Site-MNIST                         | Val  Loss: 0.1573 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.2289 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.6522 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.8402 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2554 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5860
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9764
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.4615
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1668 | Train Acc: 0.9697
 Site-USPS                          | Train Loss: 0.2380 | Train Acc: 0.9379
 Site-SynthDigits                   | Train Loss: 1.5553 | Train Acc: 0.4973
 Site-MNIST_M                       | Train Loss: 1.6444 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.2290 | Train Acc: 0.1786
Average Train Accuracy: 0.6014
 Site-MNIST                         | Val  Loss: 0.1558 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.2226 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.6518 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.8453 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2637 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5788
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1631 | Train Acc: 0.9672
 Site-USPS                          | Train Loss: 0.2355 | Train Acc: 0.9409
 Site-SynthDigits                   | Train Loss: 1.5630 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.7084 | Train Acc: 0.4138
 Site-SVHN                          | Train Loss: 2.2236 | Train Acc: 0.1875
Average Train Accuracy: 0.6019
 Site-MNIST                         | Val  Loss: 0.1532 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2153 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.6379 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.8466 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2785 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5806
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1563 | Train Acc: 0.9706
 Site-USPS                          | Train Loss: 0.2269 | Train Acc: 0.9424
 Site-SynthDigits                   | Train Loss: 1.5593 | Train Acc: 0.5055
 Site-MNIST_M                       | Train Loss: 1.6860 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.2370 | Train Acc: 0.1875
Average Train Accuracy: 0.6049
 Site-MNIST                         | Val  Loss: 0.1479 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.2097 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.6482 | Val  Acc: 0.4835
 Site-MNIST_M                       | Val  Loss: 1.8510 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2701 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5999
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9764
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9455
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.4835
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1641 | Train Acc: 0.9706
 Site-USPS                          | Train Loss: 0.2181 | Train Acc: 0.9379
 Site-SynthDigits                   | Train Loss: 1.5178 | Train Acc: 0.5055
 Site-MNIST_M                       | Train Loss: 1.7337 | Train Acc: 0.3990
 Site-SVHN                          | Train Loss: 2.2231 | Train Acc: 0.2143
Average Train Accuracy: 0.6054
 Site-MNIST                         | Val  Loss: 0.1561 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.1957 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.5835 | Val  Acc: 0.5055
 Site-MNIST_M                       | Val  Loss: 1.8280 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2670 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6063
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9764
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9394
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5055
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedmix...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1465 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.2501 | Train Acc: 0.9455
 Site-SynthDigits                   | Train Loss: 1.5336 | Train Acc: 0.4945
 Site-MNIST_M                       | Train Loss: 1.6612 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 2.2150 | Train Acc: 0.1964
Average Train Accuracy: 0.6073
 Site-MNIST                         | Val  Loss: 0.1373 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.2036 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.6230 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.8096 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2670 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5887
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1440 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.2191 | Train Acc: 0.9470
 Site-SynthDigits                   | Train Loss: 1.5504 | Train Acc: 0.5082
 Site-MNIST_M                       | Train Loss: 1.7852 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.2360 | Train Acc: 0.2143
Average Train Accuracy: 0.6121
 Site-MNIST                         | Val  Loss: 0.1352 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.1935 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6125 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.8224 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2720 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6002
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1413 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.2040 | Train Acc: 0.9470
 Site-SynthDigits                   | Train Loss: 1.5553 | Train Acc: 0.4973
 Site-MNIST_M                       | Train Loss: 1.6271 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.2220 | Train Acc: 0.2054
Average Train Accuracy: 0.6089
 Site-MNIST                         | Val  Loss: 0.1316 | Val  Acc: 0.9798
 Site-USPS                          | Val  Loss: 0.1926 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6140 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.8239 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.3028 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5777
===2023-07-02 05:27:23===
===2023-07-02 05:27:26===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:46 | Test Acc: 0.9206
 Test site-USPS                      | Epoch:46 | Test Acc: 0.9161
 Test site-SynthDigits               | Epoch:46 | Test Acc: 0.4854
 Test site-MNIST_M                   | Epoch:46 | Test Acc: 0.3600
 Test site-SVHN                      | Epoch:46 | Test Acc: 0.2121
MNIST: 0.9206, USPS: 0.9161, SynthDigits: 0.4854, MNIST_M: 0.3600, SVHN: 0.2121, 
Average Test Accuracy(group): 0.5788, Average Test Accuracy(individual): 0.5788,
domain std=0.2904, cluster std=-1.0000, individual std=0.2904, 
