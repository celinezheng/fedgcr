===2023-07-01 18:47:33===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.3470 | Train Acc: 0.7384
 Site-USPS                      (1) | Train Loss: 1.4371 | Train Acc: 0.7273
 Site-SynthDigits               (3) | Train Loss: 2.0738 | Train Acc: 0.2486
 Site-MNIST_M                   (0) | Train Loss: 2.1783 | Train Acc: 0.1823
 Site-SVHN                      (0) | Train Loss: 2.2450 | Train Acc: 0.1429
Average Train Accuracy: 0.4079
 Site-MNIST                     (2) | Val  Loss: 1.3245 | Val  Acc: 0.7441
 Site-USPS                      (1) | Val  Loss: 1.4007 | Val  Acc: 0.7394
 Site-SynthDigits               (3) | Val  Loss: 2.1054 | Val  Acc: 0.2747
 Site-MNIST_M                   (0) | Val  Loss: 2.2007 | Val  Acc: 0.0800
 Site-SVHN                      (0) | Val  Loss: 2.1169 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4105
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.7441
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.7394
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2747
 Best site-MNIST_M                  (0)  | Epoch:0 | Val Acc: 0.0800
 Best site-SVHN                     (0)  | Epoch:0 | Val Acc: 0.2143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (2) | Train Loss: 0.9696 | Train Acc: 0.8217
 Site-USPS                      (0) | Train Loss: 1.0332 | Train Acc: 0.8091
 Site-SynthDigits               (3) | Train Loss: 1.8951 | Train Acc: 0.3333
 Site-MNIST_M                   (1) | Train Loss: 2.0659 | Train Acc: 0.2414
 Site-SVHN                      (1) | Train Loss: 2.1872 | Train Acc: 0.1696
Average Train Accuracy: 0.4750
 Site-MNIST                     (2) | Val  Loss: 0.9539 | Val  Acc: 0.8182
 Site-USPS                      (0) | Val  Loss: 1.0078 | Val  Acc: 0.8182
 Site-SynthDigits               (3) | Val  Loss: 1.9155 | Val  Acc: 0.3736
 Site-MNIST_M                   (1) | Val  Loss: 2.0177 | Val  Acc: 0.2000
 Site-SVHN                      (1) | Val  Loss: 2.0844 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4849
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8182
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.8182
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.3736
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.2000
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.2143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 0.8319 | Train Acc: 0.8452
 Site-USPS                      (0) | Train Loss: 0.8739 | Train Acc: 0.8409
 Site-SynthDigits               (3) | Train Loss: 1.7434 | Train Acc: 0.4016
 Site-MNIST_M                   (2) | Train Loss: 1.9829 | Train Acc: 0.2956
 Site-SVHN                      (1) | Train Loss: 2.1331 | Train Acc: 0.1875
Average Train Accuracy: 0.5142
 Site-MNIST                     (0) | Val  Loss: 0.8183 | Val  Acc: 0.8418
 Site-USPS                      (0) | Val  Loss: 0.8406 | Val  Acc: 0.8727
 Site-SynthDigits               (3) | Val  Loss: 1.7380 | Val  Acc: 0.4396
 Site-MNIST_M                   (2) | Val  Loss: 1.9303 | Val  Acc: 0.2600
 Site-SVHN                      (1) | Val  Loss: 2.0645 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5257
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8418
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8727
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.4396
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.2600
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.7568 | Train Acc: 0.8469
 Site-USPS                      (0) | Train Loss: 0.7980 | Train Acc: 0.8409
 Site-SynthDigits               (2) | Train Loss: 1.6309 | Train Acc: 0.4727
 Site-MNIST_M                   (3) | Train Loss: 1.8648 | Train Acc: 0.3399
 Site-SVHN                      (1) | Train Loss: 2.0856 | Train Acc: 0.2143
Average Train Accuracy: 0.5429
 Site-MNIST                     (0) | Val  Loss: 0.7486 | Val  Acc: 0.8418
 Site-USPS                      (0) | Val  Loss: 0.7500 | Val  Acc: 0.8727
 Site-SynthDigits               (2) | Val  Loss: 1.6295 | Val  Acc: 0.4615
 Site-MNIST_M                   (3) | Val  Loss: 1.8208 | Val  Acc: 0.4200
 Site-SVHN                      (1) | Val  Loss: 2.0332 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5692
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8418
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8727
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.4615
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.4200
 Best site-SVHN                     (1)  | Epoch:3 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (2) | Train Loss: 0.6956 | Train Acc: 0.8495
 Site-USPS                      (2) | Train Loss: 0.7047 | Train Acc: 0.8515
 Site-SynthDigits               (0) | Train Loss: 1.5349 | Train Acc: 0.4891
 Site-MNIST_M                   (3) | Train Loss: 1.7305 | Train Acc: 0.4039
 Site-SVHN                      (1) | Train Loss: 2.0630 | Train Acc: 0.2232
Average Train Accuracy: 0.5634
 Site-MNIST                     (2) | Val  Loss: 0.6833 | Val  Acc: 0.8485
 Site-USPS                      (2) | Val  Loss: 0.6611 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 1.5467 | Val  Acc: 0.4945
 Site-MNIST_M                   (3) | Val  Loss: 1.7487 | Val  Acc: 0.4200
 Site-SVHN                      (1) | Val  Loss: 2.0239 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5784
 Best site-MNIST                    (2)  | Epoch:4 | Val Acc: 0.8485
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.8788
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.4945
 Best site-MNIST_M                  (3)  | Epoch:4 | Val Acc: 0.4200
 Best site-SVHN                     (1)  | Epoch:4 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.6313 | Train Acc: 0.8537
 Site-USPS                      (0) | Train Loss: 0.6515 | Train Acc: 0.8591
 Site-SynthDigits               (2) | Train Loss: 1.4583 | Train Acc: 0.5219
 Site-MNIST_M                   (1) | Train Loss: 1.6974 | Train Acc: 0.4631
 Site-SVHN                      (3) | Train Loss: 2.0287 | Train Acc: 0.2321
Average Train Accuracy: 0.5860
 Site-MNIST                     (0) | Val  Loss: 0.6270 | Val  Acc: 0.8653
 Site-USPS                      (0) | Val  Loss: 0.6183 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 1.4644 | Val  Acc: 0.5165
 Site-MNIST_M                   (1) | Val  Loss: 1.6686 | Val  Acc: 0.5200
 Site-SVHN                      (3) | Val  Loss: 2.0125 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6061
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8653
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8788
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5165
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.5200
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.5981 | Train Acc: 0.8595
 Site-USPS                      (1) | Train Loss: 0.6255 | Train Acc: 0.8606
 Site-SynthDigits               (2) | Train Loss: 1.3645 | Train Acc: 0.5656
 Site-MNIST_M                   (3) | Train Loss: 1.6654 | Train Acc: 0.4877
 Site-SVHN                      (0) | Train Loss: 2.0103 | Train Acc: 0.2589
Average Train Accuracy: 0.6065
 Site-MNIST                     (1) | Val  Loss: 0.5890 | Val  Acc: 0.8653
 Site-USPS                      (1) | Val  Loss: 0.5812 | Val  Acc: 0.8909
 Site-SynthDigits               (2) | Val  Loss: 1.3822 | Val  Acc: 0.5165
 Site-MNIST_M                   (3) | Val  Loss: 1.5856 | Val  Acc: 0.5600
 Site-SVHN                      (0) | Val  Loss: 1.9835 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6165
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8653
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8909
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.5165
 Best site-MNIST_M                  (3)  | Epoch:6 | Val Acc: 0.5600
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (1) | Train Loss: 0.5598 | Train Acc: 0.8621
 Site-USPS                      (1) | Train Loss: 0.5786 | Train Acc: 0.8591
 Site-SynthDigits               (3) | Train Loss: 1.3063 | Train Acc: 0.5874
 Site-MNIST_M                   (2) | Train Loss: 1.5554 | Train Acc: 0.5074
 Site-SVHN                      (0) | Train Loss: 1.9336 | Train Acc: 0.2679
Average Train Accuracy: 0.6168
 Site-MNIST                     (1) | Val  Loss: 0.5558 | Val  Acc: 0.8687
 Site-USPS                      (1) | Val  Loss: 0.5524 | Val  Acc: 0.8848
 Site-SynthDigits               (3) | Val  Loss: 1.3249 | Val  Acc: 0.5714
 Site-MNIST_M                   (2) | Val  Loss: 1.4940 | Val  Acc: 0.5800
 Site-SVHN                      (0) | Val  Loss: 1.9518 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6453
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8687
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8848
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.5714
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.5800
 Best site-SVHN                     (0)  | Epoch:7 | Val Acc: 0.3214
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (1) | Train Loss: 0.5233 | Train Acc: 0.8654
 Site-USPS                      (1) | Train Loss: 0.5526 | Train Acc: 0.8742
 Site-SynthDigits               (3) | Train Loss: 1.2261 | Train Acc: 0.6148
 Site-MNIST_M                   (2) | Train Loss: 1.4730 | Train Acc: 0.5567
 Site-SVHN                      (0) | Train Loss: 1.9495 | Train Acc: 0.3214
Average Train Accuracy: 0.6465
 Site-MNIST                     (1) | Val  Loss: 0.5188 | Val  Acc: 0.8721
 Site-USPS                      (1) | Val  Loss: 0.5223 | Val  Acc: 0.8970
 Site-SynthDigits               (3) | Val  Loss: 1.2421 | Val  Acc: 0.6154
 Site-MNIST_M                   (2) | Val  Loss: 1.4344 | Val  Acc: 0.6200
 Site-SVHN                      (0) | Val  Loss: 1.9404 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6580
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8721
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8970
 Best site-SynthDigits              (3)  | Epoch:8 | Val Acc: 0.6154
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.6200
 Best site-SVHN                     (0)  | Epoch:8 | Val Acc: 0.2857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.4842 | Train Acc: 0.8823
 Site-USPS                      (0) | Train Loss: 0.5292 | Train Acc: 0.8697
 Site-SynthDigits               (2) | Train Loss: 1.1672 | Train Acc: 0.6448
 Site-MNIST_M                   (1) | Train Loss: 1.4611 | Train Acc: 0.5813
 Site-SVHN                      (3) | Train Loss: 1.8609 | Train Acc: 0.3482
Average Train Accuracy: 0.6653
 Site-MNIST                     (0) | Val  Loss: 0.4814 | Val  Acc: 0.8855
 Site-USPS                      (0) | Val  Loss: 0.5005 | Val  Acc: 0.8848
 Site-SynthDigits               (2) | Val  Loss: 1.1778 | Val  Acc: 0.6154
 Site-MNIST_M                   (1) | Val  Loss: 1.3787 | Val  Acc: 0.6400
 Site-SVHN                      (3) | Val  Loss: 1.9190 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6623
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8855
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8848
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.6154
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.6400
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.2857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (1) | Train Loss: 0.4526 | Train Acc: 0.8873
 Site-USPS                      (1) | Train Loss: 0.5036 | Train Acc: 0.8727
 Site-SynthDigits               (2) | Train Loss: 1.1017 | Train Acc: 0.6721
 Site-MNIST_M                   (3) | Train Loss: 1.3676 | Train Acc: 0.6010
 Site-SVHN                      (0) | Train Loss: 1.8312 | Train Acc: 0.3393
Average Train Accuracy: 0.6745
 Site-MNIST                     (1) | Val  Loss: 0.4533 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.4766 | Val  Acc: 0.8970
 Site-SynthDigits               (2) | Val  Loss: 1.1138 | Val  Acc: 0.6374
 Site-MNIST_M                   (3) | Val  Loss: 1.3314 | Val  Acc: 0.7000
 Site-SVHN                      (0) | Val  Loss: 1.8568 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6889
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.8970
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.6374
 Best site-MNIST_M                  (3)  | Epoch:10 | Val Acc: 0.7000
 Best site-SVHN                     (0)  | Epoch:10 | Val Acc: 0.3214
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (1) | Train Loss: 0.4217 | Train Acc: 0.8999
 Site-USPS                      (1) | Train Loss: 0.5023 | Train Acc: 0.8742
 Site-SynthDigits               (2) | Train Loss: 1.0630 | Train Acc: 0.6776
 Site-MNIST_M                   (0) | Train Loss: 1.3498 | Train Acc: 0.6355
 Site-SVHN                      (3) | Train Loss: 1.7793 | Train Acc: 0.3571
Average Train Accuracy: 0.6889
 Site-MNIST                     (1) | Val  Loss: 0.4210 | Val  Acc: 0.9091
 Site-USPS                      (1) | Val  Loss: 0.4608 | Val  Acc: 0.8970
 Site-SynthDigits               (2) | Val  Loss: 1.0743 | Val  Acc: 0.6593
 Site-MNIST_M                   (0) | Val  Loss: 1.2756 | Val  Acc: 0.7200
 Site-SVHN                      (3) | Val  Loss: 1.7987 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7085
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.9091
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8970
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.6593
 Best site-MNIST_M                  (0)  | Epoch:11 | Val Acc: 0.7200
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (0) | Train Loss: 0.4080 | Train Acc: 0.9016
 Site-USPS                      (0) | Train Loss: 0.4715 | Train Acc: 0.8833
 Site-SynthDigits               (2) | Train Loss: 1.0106 | Train Acc: 0.7022
 Site-MNIST_M                   (3) | Train Loss: 1.2526 | Train Acc: 0.6552
 Site-SVHN                      (1) | Train Loss: 1.7531 | Train Acc: 0.3929
Average Train Accuracy: 0.7070
 Site-MNIST                     (0) | Val  Loss: 0.4075 | Val  Acc: 0.9125
 Site-USPS                      (0) | Val  Loss: 0.4377 | Val  Acc: 0.9030
 Site-SynthDigits               (2) | Val  Loss: 1.0130 | Val  Acc: 0.6813
 Site-MNIST_M                   (3) | Val  Loss: 1.2150 | Val  Acc: 0.7200
 Site-SVHN                      (1) | Val  Loss: 1.7461 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7148
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9125
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.9030
 Best site-SynthDigits              (2)  | Epoch:12 | Val Acc: 0.6813
 Best site-MNIST_M                  (3)  | Epoch:12 | Val Acc: 0.7200
 Best site-SVHN                     (1)  | Epoch:12 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.3897 | Train Acc: 0.9016
 Site-USPS                      (2) | Train Loss: 0.4584 | Train Acc: 0.8924
 Site-SynthDigits               (0) | Train Loss: 0.9563 | Train Acc: 0.7268
 Site-MNIST_M                   (1) | Train Loss: 1.2154 | Train Acc: 0.6650
 Site-SVHN                      (3) | Train Loss: 1.7227 | Train Acc: 0.4375
Average Train Accuracy: 0.7247
 Site-MNIST                     (2) | Val  Loss: 0.3883 | Val  Acc: 0.9158
 Site-USPS                      (2) | Val  Loss: 0.4225 | Val  Acc: 0.8909
 Site-SynthDigits               (0) | Val  Loss: 0.9601 | Val  Acc: 0.7143
 Site-MNIST_M                   (1) | Val  Loss: 1.1642 | Val  Acc: 0.7400
 Site-SVHN                      (3) | Val  Loss: 1.6807 | Val  Acc: 0.3929
Average Valid Accuracy: 0.7308
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9158
 Best site-USPS                     (2)  | Epoch:13 | Val Acc: 0.8909
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.7143
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.7400
 Best site-SVHN                     (3)  | Epoch:13 | Val Acc: 0.3929
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (1) | Train Loss: 0.3687 | Train Acc: 0.9100
 Site-USPS                      (1) | Train Loss: 0.4342 | Train Acc: 0.8955
 Site-SynthDigits               (2) | Train Loss: 0.9070 | Train Acc: 0.7486
 Site-MNIST_M                   (0) | Train Loss: 1.1189 | Train Acc: 0.6798
 Site-SVHN                      (3) | Train Loss: 1.6370 | Train Acc: 0.4375
Average Train Accuracy: 0.7343
 Site-MNIST                     (1) | Val  Loss: 0.3661 | Val  Acc: 0.9192
 Site-USPS                      (1) | Val  Loss: 0.4112 | Val  Acc: 0.9091
 Site-SynthDigits               (2) | Val  Loss: 0.9107 | Val  Acc: 0.7473
 Site-MNIST_M                   (0) | Val  Loss: 1.1166 | Val  Acc: 0.7600
 Site-SVHN                      (3) | Val  Loss: 1.6253 | Val  Acc: 0.4286
Average Valid Accuracy: 0.7528
 Best site-MNIST                    (1)  | Epoch:14 | Val Acc: 0.9192
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.9091
 Best site-SynthDigits              (2)  | Epoch:14 | Val Acc: 0.7473
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.7600
 Best site-SVHN                     (3)  | Epoch:14 | Val Acc: 0.4286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (1) | Train Loss: 0.3519 | Train Acc: 0.9125
 Site-USPS                      (1) | Train Loss: 0.4472 | Train Acc: 0.8970
 Site-SynthDigits               (2) | Train Loss: 0.8636 | Train Acc: 0.7650
 Site-MNIST_M                   (0) | Train Loss: 1.1368 | Train Acc: 0.6946
 Site-SVHN                      (3) | Train Loss: 1.5874 | Train Acc: 0.4554
Average Train Accuracy: 0.7449
 Site-MNIST                     (1) | Val  Loss: 0.3478 | Val  Acc: 0.9226
 Site-USPS                      (1) | Val  Loss: 0.4081 | Val  Acc: 0.8970
 Site-SynthDigits               (2) | Val  Loss: 0.8619 | Val  Acc: 0.7802
 Site-MNIST_M                   (0) | Val  Loss: 1.0724 | Val  Acc: 0.7400
 Site-SVHN                      (3) | Val  Loss: 1.5706 | Val  Acc: 0.3929
Average Valid Accuracy: 0.7465
============ Train epoch 16 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (2) | Train Loss: 0.3321 | Train Acc: 0.9167
 Site-USPS                      (2) | Train Loss: 0.4057 | Train Acc: 0.9015
 Site-SynthDigits               (0) | Train Loss: 0.8288 | Train Acc: 0.7596
 Site-MNIST_M                   (1) | Train Loss: 1.0090 | Train Acc: 0.6995
 Site-SVHN                      (3) | Train Loss: 1.5849 | Train Acc: 0.5000
Average Train Accuracy: 0.7555
 Site-MNIST                     (2) | Val  Loss: 0.3309 | Val  Acc: 0.9259
 Site-USPS                      (2) | Val  Loss: 0.3862 | Val  Acc: 0.8970
 Site-SynthDigits               (0) | Val  Loss: 0.8303 | Val  Acc: 0.7912
 Site-MNIST_M                   (1) | Val  Loss: 1.0521 | Val  Acc: 0.7600
 Site-SVHN                      (3) | Val  Loss: 1.4997 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7748
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9259
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.8970
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.7912
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7600
 Best site-SVHN                     (3)  | Epoch:16 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (1) | Train Loss: 0.3203 | Train Acc: 0.9209
 Site-USPS                      (1) | Train Loss: 0.3965 | Train Acc: 0.9000
 Site-SynthDigits               (2) | Train Loss: 0.7841 | Train Acc: 0.7705
 Site-MNIST_M                   (0) | Train Loss: 1.0877 | Train Acc: 0.7094
 Site-SVHN                      (3) | Train Loss: 1.4806 | Train Acc: 0.5179
Average Train Accuracy: 0.7637
 Site-MNIST                     (1) | Val  Loss: 0.3205 | Val  Acc: 0.9259
 Site-USPS                      (1) | Val  Loss: 0.3752 | Val  Acc: 0.8848
 Site-SynthDigits               (2) | Val  Loss: 0.7918 | Val  Acc: 0.7912
 Site-MNIST_M                   (0) | Val  Loss: 1.0194 | Val  Acc: 0.7800
 Site-SVHN                      (3) | Val  Loss: 1.4579 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7764
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9259
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8848
 Best site-SynthDigits              (2)  | Epoch:17 | Val Acc: 0.7912
 Best site-MNIST_M                  (0)  | Epoch:17 | Val Acc: 0.7800
 Best site-SVHN                     (3)  | Epoch:17 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.3084 | Train Acc: 0.9235
 Site-USPS                      (0) | Train Loss: 0.3774 | Train Acc: 0.8970
 Site-SynthDigits               (2) | Train Loss: 0.7612 | Train Acc: 0.7732
 Site-MNIST_M                   (1) | Train Loss: 1.0434 | Train Acc: 0.7291
 Site-SVHN                      (3) | Train Loss: 1.4822 | Train Acc: 0.5179
Average Train Accuracy: 0.7681
 Site-MNIST                     (0) | Val  Loss: 0.3077 | Val  Acc: 0.9259
 Site-USPS                      (0) | Val  Loss: 0.3667 | Val  Acc: 0.8909
 Site-SynthDigits               (2) | Val  Loss: 0.7669 | Val  Acc: 0.7912
 Site-MNIST_M                   (1) | Val  Loss: 0.9778 | Val  Acc: 0.7800
 Site-SVHN                      (3) | Val  Loss: 1.4399 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7776
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9259
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8909
 Best site-SynthDigits              (2)  | Epoch:18 | Val Acc: 0.7912
 Best site-MNIST_M                  (1)  | Epoch:18 | Val Acc: 0.7800
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 19 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (2) | Train Loss: 0.2920 | Train Acc: 0.9277
 Site-USPS                      (2) | Train Loss: 0.3714 | Train Acc: 0.8985
 Site-SynthDigits               (0) | Train Loss: 0.7363 | Train Acc: 0.8005
 Site-MNIST_M                   (1) | Train Loss: 0.9337 | Train Acc: 0.7291
 Site-SVHN                      (3) | Train Loss: 1.4738 | Train Acc: 0.5179
Average Train Accuracy: 0.7747
 Site-MNIST                     (2) | Val  Loss: 0.2930 | Val  Acc: 0.9293
 Site-USPS                      (2) | Val  Loss: 0.3624 | Val  Acc: 0.8909
 Site-SynthDigits               (0) | Val  Loss: 0.7448 | Val  Acc: 0.8022
 Site-MNIST_M                   (1) | Val  Loss: 0.9301 | Val  Acc: 0.7800
 Site-SVHN                      (3) | Val  Loss: 1.4081 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7805
 Best site-MNIST                    (2)  | Epoch:19 | Val Acc: 0.9293
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.8909
 Best site-SynthDigits              (0)  | Epoch:19 | Val Acc: 0.8022
 Best site-MNIST_M                  (1)  | Epoch:19 | Val Acc: 0.7800
 Best site-SVHN                     (3)  | Epoch:19 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (0) | Train Loss: 0.2841 | Train Acc: 0.9260
 Site-USPS                      (0) | Train Loss: 0.3693 | Train Acc: 0.9091
 Site-SynthDigits               (3) | Train Loss: 0.6863 | Train Acc: 0.8087
 Site-MNIST_M                   (1) | Train Loss: 0.9603 | Train Acc: 0.7586
 Site-SVHN                      (2) | Train Loss: 1.4038 | Train Acc: 0.5089
Average Train Accuracy: 0.7823
 Site-MNIST                     (0) | Val  Loss: 0.2839 | Val  Acc: 0.9293
 Site-USPS                      (0) | Val  Loss: 0.3538 | Val  Acc: 0.8848
 Site-SynthDigits               (3) | Val  Loss: 0.7040 | Val  Acc: 0.8242
 Site-MNIST_M                   (1) | Val  Loss: 0.8886 | Val  Acc: 0.8200
 Site-SVHN                      (2) | Val  Loss: 1.3621 | Val  Acc: 0.4643
Average Valid Accuracy: 0.7845
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9293
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.8848
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8242
 Best site-MNIST_M                  (1)  | Epoch:20 | Val Acc: 0.8200
 Best site-SVHN                     (2)  | Epoch:20 | Val Acc: 0.4643
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (0) | Train Loss: 0.2724 | Train Acc: 0.9344
 Site-USPS                      (0) | Train Loss: 0.3583 | Train Acc: 0.9152
 Site-SynthDigits               (2) | Train Loss: 0.6722 | Train Acc: 0.8169
 Site-MNIST_M                   (3) | Train Loss: 0.8947 | Train Acc: 0.7586
 Site-SVHN                      (1) | Train Loss: 1.3874 | Train Acc: 0.4911
Average Train Accuracy: 0.7832
 Site-MNIST                     (0) | Val  Loss: 0.2705 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.3496 | Val  Acc: 0.8909
 Site-SynthDigits               (2) | Val  Loss: 0.6758 | Val  Acc: 0.8242
 Site-MNIST_M                   (3) | Val  Loss: 0.8602 | Val  Acc: 0.8400
 Site-SVHN                      (1) | Val  Loss: 1.3718 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7975
 Best site-MNIST                    (0)  | Epoch:21 | Val Acc: 0.9327
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.8909
 Best site-SynthDigits              (2)  | Epoch:21 | Val Acc: 0.8242
 Best site-MNIST_M                  (3)  | Epoch:21 | Val Acc: 0.8400
 Best site-SVHN                     (1)  | Epoch:21 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (0) | Train Loss: 0.2520 | Train Acc: 0.9428
 Site-USPS                      (0) | Train Loss: 0.3685 | Train Acc: 0.9000
 Site-SynthDigits               (2) | Train Loss: 0.6603 | Train Acc: 0.8279
 Site-MNIST_M                   (1) | Train Loss: 0.9712 | Train Acc: 0.7586
 Site-SVHN                      (3) | Train Loss: 1.3233 | Train Acc: 0.5714
Average Train Accuracy: 0.8001
 Site-MNIST                     (0) | Val  Loss: 0.2509 | Val  Acc: 0.9394
 Site-USPS                      (0) | Val  Loss: 0.3596 | Val  Acc: 0.8909
 Site-SynthDigits               (2) | Val  Loss: 0.6761 | Val  Acc: 0.8242
 Site-MNIST_M                   (1) | Val  Loss: 0.8396 | Val  Acc: 0.8000
 Site-SVHN                      (3) | Val  Loss: 1.2849 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8052
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9394
 Best site-USPS                     (0)  | Epoch:22 | Val Acc: 0.8909
 Best site-SynthDigits              (2)  | Epoch:22 | Val Acc: 0.8242
 Best site-MNIST_M                  (1)  | Epoch:22 | Val Acc: 0.8000
 Best site-SVHN                     (3)  | Epoch:22 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (0) | Train Loss: 0.2470 | Train Acc: 0.9445
 Site-USPS                      (0) | Train Loss: 0.3453 | Train Acc: 0.9045
 Site-SynthDigits               (2) | Train Loss: 0.6361 | Train Acc: 0.8306
 Site-MNIST_M                   (3) | Train Loss: 0.8475 | Train Acc: 0.7685
 Site-SVHN                      (1) | Train Loss: 1.3160 | Train Acc: 0.5893
Average Train Accuracy: 0.8075
 Site-MNIST                     (0) | Val  Loss: 0.2466 | Val  Acc: 0.9360
 Site-USPS                      (0) | Val  Loss: 0.3356 | Val  Acc: 0.8970
 Site-SynthDigits               (2) | Val  Loss: 0.6434 | Val  Acc: 0.8462
 Site-MNIST_M                   (3) | Val  Loss: 0.8105 | Val  Acc: 0.8200
 Site-SVHN                      (1) | Val  Loss: 1.2700 | Val  Acc: 0.6071
Average Valid Accuracy: 0.8213
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9360
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.8970
 Best site-SynthDigits              (2)  | Epoch:23 | Val Acc: 0.8462
 Best site-MNIST_M                  (3)  | Epoch:23 | Val Acc: 0.8200
 Best site-SVHN                     (1)  | Epoch:23 | Val Acc: 0.6071
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.2390 | Train Acc: 0.9453
 Site-USPS                      (0) | Train Loss: 0.3327 | Train Acc: 0.9167
 Site-SynthDigits               (2) | Train Loss: 0.6200 | Train Acc: 0.8415
 Site-MNIST_M                   (1) | Train Loss: 0.8497 | Train Acc: 0.7685
 Site-SVHN                      (3) | Train Loss: 1.2614 | Train Acc: 0.5982
Average Train Accuracy: 0.8140
 Site-MNIST                     (0) | Val  Loss: 0.2402 | Val  Acc: 0.9428
 Site-USPS                      (0) | Val  Loss: 0.3150 | Val  Acc: 0.9091
 Site-SynthDigits               (2) | Val  Loss: 0.6231 | Val  Acc: 0.8571
 Site-MNIST_M                   (1) | Val  Loss: 0.7792 | Val  Acc: 0.8200
 Site-SVHN                      (3) | Val  Loss: 1.2259 | Val  Acc: 0.6071
Average Valid Accuracy: 0.8272
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9428
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.9091
 Best site-SynthDigits              (2)  | Epoch:24 | Val Acc: 0.8571
 Best site-MNIST_M                  (1)  | Epoch:24 | Val Acc: 0.8200
 Best site-SVHN                     (3)  | Epoch:24 | Val Acc: 0.6071
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (2) | Train Loss: 0.2299 | Train Acc: 0.9470
 Site-USPS                      (2) | Train Loss: 0.3188 | Train Acc: 0.9182
 Site-SynthDigits               (1) | Train Loss: 0.5954 | Train Acc: 0.8470
 Site-MNIST_M                   (0) | Train Loss: 0.8609 | Train Acc: 0.7882
 Site-SVHN                      (3) | Train Loss: 1.2275 | Train Acc: 0.5982
Average Train Accuracy: 0.8197
 Site-MNIST                     (2) | Val  Loss: 0.2338 | Val  Acc: 0.9495
 Site-USPS                      (2) | Val  Loss: 0.3091 | Val  Acc: 0.9030
 Site-SynthDigits               (1) | Val  Loss: 0.5983 | Val  Acc: 0.8571
 Site-MNIST_M                   (0) | Val  Loss: 0.7539 | Val  Acc: 0.8200
 Site-SVHN                      (3) | Val  Loss: 1.1920 | Val  Acc: 0.6071
Average Valid Accuracy: 0.8274
 Best site-MNIST                    (2)  | Epoch:25 | Val Acc: 0.9495
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.9030
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.8571
 Best site-MNIST_M                  (0)  | Epoch:25 | Val Acc: 0.8200
 Best site-SVHN                     (3)  | Epoch:25 | Val Acc: 0.6071
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (0) | Train Loss: 0.2218 | Train Acc: 0.9470
 Site-USPS                      (0) | Train Loss: 0.2974 | Train Acc: 0.9167
 Site-SynthDigits               (1) | Train Loss: 0.5636 | Train Acc: 0.8716
 Site-MNIST_M                   (2) | Train Loss: 0.8281 | Train Acc: 0.8030
 Site-SVHN                      (3) | Train Loss: 1.2287 | Train Acc: 0.6161
Average Train Accuracy: 0.8309
 Site-MNIST                     (0) | Val  Loss: 0.2259 | Val  Acc: 0.9529
 Site-USPS                      (0) | Val  Loss: 0.3042 | Val  Acc: 0.9030
 Site-SynthDigits               (1) | Val  Loss: 0.5839 | Val  Acc: 0.8901
 Site-MNIST_M                   (2) | Val  Loss: 0.7309 | Val  Acc: 0.8200
 Site-SVHN                      (3) | Val  Loss: 1.1706 | Val  Acc: 0.6071
Average Valid Accuracy: 0.8346
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9529
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9030
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.8901
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.8200
 Best site-SVHN                     (3)  | Epoch:26 | Val Acc: 0.6071
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.2163 | Train Acc: 0.9470
 Site-USPS                      (1) | Train Loss: 0.3148 | Train Acc: 0.9197
 Site-SynthDigits               (3) | Train Loss: 0.5616 | Train Acc: 0.8716
 Site-MNIST_M                   (2) | Train Loss: 0.7548 | Train Acc: 0.7931
 Site-SVHN                      (0) | Train Loss: 1.1666 | Train Acc: 0.6429
Average Train Accuracy: 0.8349
 Site-MNIST                     (1) | Val  Loss: 0.2164 | Val  Acc: 0.9529
 Site-USPS                      (1) | Val  Loss: 0.3149 | Val  Acc: 0.9030
 Site-SynthDigits               (3) | Val  Loss: 0.5757 | Val  Acc: 0.8681
 Site-MNIST_M                   (2) | Val  Loss: 0.7160 | Val  Acc: 0.8400
 Site-SVHN                      (0) | Val  Loss: 1.1142 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8271
============ Train epoch 28 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.2096 | Train Acc: 0.9504
 Site-USPS                      (1) | Train Loss: 0.3067 | Train Acc: 0.9136
 Site-SynthDigits               (3) | Train Loss: 0.5460 | Train Acc: 0.8689
 Site-MNIST_M                   (2) | Train Loss: 0.8002 | Train Acc: 0.7980
 Site-SVHN                      (0) | Train Loss: 1.1609 | Train Acc: 0.6161
Average Train Accuracy: 0.8294
 Site-MNIST                     (1) | Val  Loss: 0.2135 | Val  Acc: 0.9562
 Site-USPS                      (1) | Val  Loss: 0.3035 | Val  Acc: 0.8970
 Site-SynthDigits               (3) | Val  Loss: 0.5539 | Val  Acc: 0.8901
 Site-MNIST_M                   (2) | Val  Loss: 0.6985 | Val  Acc: 0.8200
 Site-SVHN                      (0) | Val  Loss: 1.1130 | Val  Acc: 0.6071
Average Valid Accuracy: 0.8341
============ Train epoch 29 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.2045 | Train Acc: 0.9512
 Site-USPS                      (0) | Train Loss: 0.2976 | Train Acc: 0.9212
 Site-SynthDigits               (2) | Train Loss: 0.5296 | Train Acc: 0.8798
 Site-MNIST_M                   (3) | Train Loss: 0.7446 | Train Acc: 0.7833
 Site-SVHN                      (1) | Train Loss: 1.1280 | Train Acc: 0.6339
Average Train Accuracy: 0.8339
 Site-MNIST                     (0) | Val  Loss: 0.2067 | Val  Acc: 0.9562
 Site-USPS                      (0) | Val  Loss: 0.2896 | Val  Acc: 0.9152
 Site-SynthDigits               (2) | Val  Loss: 0.5382 | Val  Acc: 0.8791
 Site-MNIST_M                   (3) | Val  Loss: 0.6632 | Val  Acc: 0.8200
 Site-SVHN                      (1) | Val  Loss: 1.0830 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8427
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9562
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9152
 Best site-SynthDigits              (2)  | Epoch:29 | Val Acc: 0.8791
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.8200
 Best site-SVHN                     (1)  | Epoch:29 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 30 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2013 | Train Acc: 0.9537
 Site-USPS                      (1) | Train Loss: 0.2835 | Train Acc: 0.9212
 Site-SynthDigits               (3) | Train Loss: 0.5101 | Train Acc: 0.8825
 Site-MNIST_M                   (2) | Train Loss: 0.7398 | Train Acc: 0.8030
 Site-SVHN                      (0) | Train Loss: 1.1079 | Train Acc: 0.6339
Average Train Accuracy: 0.8389
 Site-MNIST                     (1) | Val  Loss: 0.2026 | Val  Acc: 0.9529
 Site-USPS                      (1) | Val  Loss: 0.2762 | Val  Acc: 0.9091
 Site-SynthDigits               (3) | Val  Loss: 0.5220 | Val  Acc: 0.8901
 Site-MNIST_M                   (2) | Val  Loss: 0.6602 | Val  Acc: 0.8600
 Site-SVHN                      (0) | Val  Loss: 1.0685 | Val  Acc: 0.6071
Average Valid Accuracy: 0.8438
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9529
 Best site-USPS                     (1)  | Epoch:30 | Val Acc: 0.9091
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8901
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8600
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.6071
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.1980 | Train Acc: 0.9529
 Site-USPS                      (3) | Train Loss: 0.2728 | Train Acc: 0.9273
 Site-SynthDigits               (0) | Train Loss: 0.4965 | Train Acc: 0.8907
 Site-MNIST_M                   (2) | Train Loss: 0.6682 | Train Acc: 0.8227
 Site-SVHN                      (0) | Train Loss: 1.1140 | Train Acc: 0.6518
Average Train Accuracy: 0.8491
 Site-MNIST                     (1) | Val  Loss: 0.2007 | Val  Acc: 0.9529
 Site-USPS                      (3) | Val  Loss: 0.2628 | Val  Acc: 0.9091
 Site-SynthDigits               (0) | Val  Loss: 0.5033 | Val  Acc: 0.8791
 Site-MNIST_M                   (2) | Val  Loss: 0.6399 | Val  Acc: 0.8600
 Site-SVHN                      (0) | Val  Loss: 1.0616 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8488
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9529
 Best site-USPS                     (3)  | Epoch:31 | Val Acc: 0.9091
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.8791
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.8600
 Best site-SVHN                     (0)  | Epoch:31 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 32 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (1) | Train Loss: 0.1897 | Train Acc: 0.9579
 Site-USPS                      (1) | Train Loss: 0.2673 | Train Acc: 0.9242
 Site-SynthDigits               (0) | Train Loss: 0.4832 | Train Acc: 0.8907
 Site-MNIST_M                   (3) | Train Loss: 0.6882 | Train Acc: 0.8227
 Site-SVHN                      (2) | Train Loss: 1.0494 | Train Acc: 0.6875
Average Train Accuracy: 0.8566
 Site-MNIST                     (1) | Val  Loss: 0.1921 | Val  Acc: 0.9596
 Site-USPS                      (1) | Val  Loss: 0.2617 | Val  Acc: 0.9212
 Site-SynthDigits               (0) | Val  Loss: 0.4918 | Val  Acc: 0.9011
 Site-MNIST_M                   (3) | Val  Loss: 0.6233 | Val  Acc: 0.9000
 Site-SVHN                      (2) | Val  Loss: 1.0021 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8650
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9596
 Best site-USPS                     (1)  | Epoch:32 | Val Acc: 0.9212
 Best site-SynthDigits              (0)  | Epoch:32 | Val Acc: 0.9011
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.9000
 Best site-SVHN                     (2)  | Epoch:32 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 33 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (3) | Train Loss: 0.1819 | Train Acc: 0.9596
 Site-USPS                      (0) | Train Loss: 0.2680 | Train Acc: 0.9288
 Site-SynthDigits               (1) | Train Loss: 0.4709 | Train Acc: 0.8907
 Site-MNIST_M                   (2) | Train Loss: 0.7204 | Train Acc: 0.8276
 Site-SVHN                      (1) | Train Loss: 1.0698 | Train Acc: 0.6429
Average Train Accuracy: 0.8499
 Site-MNIST                     (3) | Val  Loss: 0.1882 | Val  Acc: 0.9562
 Site-USPS                      (0) | Val  Loss: 0.2563 | Val  Acc: 0.9273
 Site-SynthDigits               (1) | Val  Loss: 0.4694 | Val  Acc: 0.9121
 Site-MNIST_M                   (2) | Val  Loss: 0.6102 | Val  Acc: 0.8800
 Site-SVHN                      (1) | Val  Loss: 1.0224 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8494
============ Train epoch 34 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.1778 | Train Acc: 0.9605
 Site-USPS                      (1) | Train Loss: 0.2579 | Train Acc: 0.9273
 Site-SynthDigits               (3) | Train Loss: 0.4670 | Train Acc: 0.9098
 Site-MNIST_M                   (2) | Train Loss: 0.6592 | Train Acc: 0.8325
 Site-SVHN                      (0) | Train Loss: 1.0132 | Train Acc: 0.6964
Average Train Accuracy: 0.8653
 Site-MNIST                     (1) | Val  Loss: 0.1847 | Val  Acc: 0.9596
 Site-USPS                      (1) | Val  Loss: 0.2587 | Val  Acc: 0.9152
 Site-SynthDigits               (3) | Val  Loss: 0.4627 | Val  Acc: 0.9121
 Site-MNIST_M                   (2) | Val  Loss: 0.6012 | Val  Acc: 0.8800
 Site-SVHN                      (0) | Val  Loss: 0.9487 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8691
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9596
 Best site-USPS                     (1)  | Epoch:34 | Val Acc: 0.9152
 Best site-SynthDigits              (3)  | Epoch:34 | Val Acc: 0.9121
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8800
 Best site-SVHN                     (0)  | Epoch:34 | Val Acc: 0.6786
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 35 ============
cnt=[1, 1, 1, 2, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (2) | Train Loss: 0.1791 | Train Acc: 0.9613
 Site-USPS                      (1) | Train Loss: 0.2373 | Train Acc: 0.9348
 Site-SynthDigits               (3) | Train Loss: 0.4373 | Train Acc: 0.9153
 Site-MNIST_M                   (0) | Train Loss: 0.6630 | Train Acc: 0.8571
 Site-SVHN                      (3) | Train Loss: 1.0325 | Train Acc: 0.6696
Average Train Accuracy: 0.8676
 Site-MNIST                     (2) | Val  Loss: 0.1837 | Val  Acc: 0.9562
 Site-USPS                      (1) | Val  Loss: 0.2411 | Val  Acc: 0.9333
 Site-SynthDigits               (3) | Val  Loss: 0.4398 | Val  Acc: 0.9231
 Site-MNIST_M                   (0) | Val  Loss: 0.5886 | Val  Acc: 0.9000
 Site-SVHN                      (3) | Val  Loss: 0.9555 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8711
 Best site-MNIST                    (2)  | Epoch:35 | Val Acc: 0.9562
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.9333
 Best site-SynthDigits              (3)  | Epoch:35 | Val Acc: 0.9231
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.9000
 Best site-SVHN                     (3)  | Epoch:35 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 36 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (3) | Train Loss: 0.1743 | Train Acc: 0.9563
 Site-USPS                      (0) | Train Loss: 0.2475 | Train Acc: 0.9318
 Site-SynthDigits               (1) | Train Loss: 0.4266 | Train Acc: 0.9235
 Site-MNIST_M                   (2) | Train Loss: 0.5873 | Train Acc: 0.8571
 Site-SVHN                      (1) | Train Loss: 0.9907 | Train Acc: 0.6964
Average Train Accuracy: 0.8730
 Site-MNIST                     (3) | Val  Loss: 0.1797 | Val  Acc: 0.9562
 Site-USPS                      (0) | Val  Loss: 0.2337 | Val  Acc: 0.9273
 Site-SynthDigits               (1) | Val  Loss: 0.4285 | Val  Acc: 0.9121
 Site-MNIST_M                   (2) | Val  Loss: 0.5533 | Val  Acc: 0.9000
 Site-SVHN                      (1) | Val  Loss: 0.9420 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8677
============ Train epoch 37 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.1738 | Train Acc: 0.9596
 Site-USPS                      (2) | Train Loss: 0.2430 | Train Acc: 0.9379
 Site-SynthDigits               (1) | Train Loss: 0.4126 | Train Acc: 0.9235
 Site-MNIST_M                   (0) | Train Loss: 0.6401 | Train Acc: 0.8571
 Site-SVHN                      (1) | Train Loss: 0.9668 | Train Acc: 0.7232
Average Train Accuracy: 0.8803
 Site-MNIST                     (3) | Val  Loss: 0.1783 | Val  Acc: 0.9562
 Site-USPS                      (2) | Val  Loss: 0.2226 | Val  Acc: 0.9212
 Site-SynthDigits               (1) | Val  Loss: 0.4157 | Val  Acc: 0.9231
 Site-MNIST_M                   (0) | Val  Loss: 0.5504 | Val  Acc: 0.9000
 Site-SVHN                      (1) | Val  Loss: 0.9048 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8758
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9562
 Best site-USPS                     (2)  | Epoch:37 | Val Acc: 0.9212
 Best site-SynthDigits              (1)  | Epoch:37 | Val Acc: 0.9231
 Best site-MNIST_M                  (0)  | Epoch:37 | Val Acc: 0.9000
 Best site-SVHN                     (1)  | Epoch:37 | Val Acc: 0.6786
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.1697 | Train Acc: 0.9588
 Site-USPS                      (3) | Train Loss: 0.2239 | Train Acc: 0.9439
 Site-SynthDigits               (0) | Train Loss: 0.4048 | Train Acc: 0.9317
 Site-MNIST_M                   (2) | Train Loss: 0.6036 | Train Acc: 0.8719
 Site-SVHN                      (0) | Train Loss: 0.9538 | Train Acc: 0.7232
Average Train Accuracy: 0.8859
 Site-MNIST                     (1) | Val  Loss: 0.1730 | Val  Acc: 0.9562
 Site-USPS                      (3) | Val  Loss: 0.2219 | Val  Acc: 0.9394
 Site-SynthDigits               (0) | Val  Loss: 0.4090 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.5297 | Val  Acc: 0.9000
 Site-SVHN                      (0) | Val  Loss: 0.9108 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8795
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9562
 Best site-USPS                     (3)  | Epoch:38 | Val Acc: 0.9394
 Best site-SynthDigits              (0)  | Epoch:38 | Val Acc: 0.9231
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.9000
 Best site-SVHN                     (0)  | Epoch:38 | Val Acc: 0.6786
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (1) | Train Loss: 0.1693 | Train Acc: 0.9605
 Site-USPS                      (3) | Train Loss: 0.2134 | Train Acc: 0.9424
 Site-SynthDigits               (0) | Train Loss: 0.3894 | Train Acc: 0.9344
 Site-MNIST_M                   (2) | Train Loss: 0.5798 | Train Acc: 0.8670
 Site-SVHN                      (0) | Train Loss: 0.9426 | Train Acc: 0.7411
Average Train Accuracy: 0.8891
 Site-MNIST                     (1) | Val  Loss: 0.1698 | Val  Acc: 0.9596
 Site-USPS                      (3) | Val  Loss: 0.2128 | Val  Acc: 0.9273
 Site-SynthDigits               (0) | Val  Loss: 0.3890 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.5167 | Val  Acc: 0.8800
 Site-SVHN                      (0) | Val  Loss: 0.8903 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8737
============ Train epoch 40 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.1622 | Train Acc: 0.9630
 Site-USPS                      (3) | Train Loss: 0.2153 | Train Acc: 0.9394
 Site-SynthDigits               (0) | Train Loss: 0.3813 | Train Acc: 0.9344
 Site-MNIST_M                   (2) | Train Loss: 0.5670 | Train Acc: 0.8818
 Site-SVHN                      (0) | Train Loss: 0.9302 | Train Acc: 0.7321
Average Train Accuracy: 0.8901
 Site-MNIST                     (1) | Val  Loss: 0.1658 | Val  Acc: 0.9630
 Site-USPS                      (3) | Val  Loss: 0.2113 | Val  Acc: 0.9333
 Site-SynthDigits               (0) | Val  Loss: 0.3767 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.5058 | Val  Acc: 0.9200
 Site-SVHN                      (0) | Val  Loss: 0.8705 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8907
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9630
 Best site-USPS                     (3)  | Epoch:40 | Val Acc: 0.9333
 Best site-SynthDigits              (0)  | Epoch:40 | Val Acc: 0.9231
 Best site-MNIST_M                  (2)  | Epoch:40 | Val Acc: 0.9200
 Best site-SVHN                     (0)  | Epoch:40 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 41 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.1605 | Train Acc: 0.9622
 Site-USPS                      (1) | Train Loss: 0.2192 | Train Acc: 0.9379
 Site-SynthDigits               (0) | Train Loss: 0.3783 | Train Acc: 0.9290
 Site-MNIST_M                   (2) | Train Loss: 0.6357 | Train Acc: 0.9064
 Site-SVHN                      (3) | Train Loss: 0.8763 | Train Acc: 0.7857
Average Train Accuracy: 0.9042
 Site-MNIST                     (1) | Val  Loss: 0.1616 | Val  Acc: 0.9663
 Site-USPS                      (1) | Val  Loss: 0.2128 | Val  Acc: 0.9333
 Site-SynthDigits               (0) | Val  Loss: 0.3813 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.5056 | Val  Acc: 0.9200
 Site-SVHN                      (3) | Val  Loss: 0.7977 | Val  Acc: 0.7857
Average Valid Accuracy: 0.9057
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9663
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.9333
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.9231
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.9200
 Best site-SVHN                     (3)  | Epoch:41 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 42 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (3) | Train Loss: 0.1552 | Train Acc: 0.9622
 Site-USPS                      (2) | Train Loss: 0.1943 | Train Acc: 0.9515
 Site-SynthDigits               (1) | Train Loss: 0.3729 | Train Acc: 0.9317
 Site-MNIST_M                   (0) | Train Loss: 0.5689 | Train Acc: 0.8966
 Site-SVHN                      (1) | Train Loss: 0.8984 | Train Acc: 0.7321
Average Train Accuracy: 0.8948
 Site-MNIST                     (3) | Val  Loss: 0.1586 | Val  Acc: 0.9697
 Site-USPS                      (2) | Val  Loss: 0.1993 | Val  Acc: 0.9515
 Site-SynthDigits               (1) | Val  Loss: 0.3674 | Val  Acc: 0.9121
 Site-MNIST_M                   (0) | Val  Loss: 0.4836 | Val  Acc: 0.9200
 Site-SVHN                      (1) | Val  Loss: 0.8609 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8864
============ Train epoch 43 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.1530 | Train Acc: 0.9647
 Site-USPS                      (3) | Train Loss: 0.1951 | Train Acc: 0.9500
 Site-SynthDigits               (1) | Train Loss: 0.3513 | Train Acc: 0.9344
 Site-MNIST_M                   (2) | Train Loss: 0.4674 | Train Acc: 0.8966
 Site-SVHN                      (1) | Train Loss: 0.9063 | Train Acc: 0.7054
Average Train Accuracy: 0.8902
 Site-MNIST                     (0) | Val  Loss: 0.1553 | Val  Acc: 0.9663
 Site-USPS                      (3) | Val  Loss: 0.1994 | Val  Acc: 0.9515
 Site-SynthDigits               (1) | Val  Loss: 0.3491 | Val  Acc: 0.9121
 Site-MNIST_M                   (2) | Val  Loss: 0.4622 | Val  Acc: 0.9400
 Site-SVHN                      (1) | Val  Loss: 0.8555 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8826
============ Train epoch 44 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.1497 | Train Acc: 0.9680
 Site-USPS                      (0) | Train Loss: 0.2154 | Train Acc: 0.9470
 Site-SynthDigits               (3) | Train Loss: 0.3525 | Train Acc: 0.9426
 Site-MNIST_M                   (2) | Train Loss: 0.5192 | Train Acc: 0.8966
 Site-SVHN                      (1) | Train Loss: 0.8237 | Train Acc: 0.7857
Average Train Accuracy: 0.9080
 Site-MNIST                     (0) | Val  Loss: 0.1507 | Val  Acc: 0.9697
 Site-USPS                      (0) | Val  Loss: 0.2064 | Val  Acc: 0.9333
 Site-SynthDigits               (3) | Val  Loss: 0.3530 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.4664 | Val  Acc: 0.9200
 Site-SVHN                      (1) | Val  Loss: 0.7525 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8992
============ Train epoch 45 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (0) | Train Loss: 0.1490 | Train Acc: 0.9647
 Site-USPS                      (0) | Train Loss: 0.1982 | Train Acc: 0.9545
 Site-SynthDigits               (3) | Train Loss: 0.3482 | Train Acc: 0.9372
 Site-MNIST_M                   (2) | Train Loss: 0.5433 | Train Acc: 0.9113
 Site-SVHN                      (1) | Train Loss: 0.7781 | Train Acc: 0.7857
Average Train Accuracy: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.1484 | Val  Acc: 0.9663
 Site-USPS                      (0) | Val  Loss: 0.1983 | Val  Acc: 0.9455
 Site-SynthDigits               (3) | Val  Loss: 0.3465 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.4545 | Val  Acc: 0.9200
 Site-SVHN                      (1) | Val  Loss: 0.7351 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9010
 Test site-MNIST                     (0)| Epoch:41 | Test Acc: 0.9460
 Test site-USPS                      (0)| Epoch:41 | Test Acc: 0.9355
 Test site-SynthDigits               (3)| Epoch:41 | Test Acc: 0.8608
 Test site-MNIST_M                   (2)| Epoch:41 | Test Acc: 0.6680
 Test site-SVHN                      (1)| Epoch:41 | Test Acc: 0.5888
MNIST: 0.9460, USPS: 0.9355, SynthDigits: 0.8608, MNIST_M: 0.6680, SVHN: 0.5888, 
Average Test Accuracy(group): 0.7998, Average Test Accuracy(individual): 0.7998,
domain std=0.1452, cluster std=0.1419, individual std=0.1452, 
Average Test Accuracy: 0.7998
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (3) | Train Loss: 0.1435 | Train Acc: 0.9638
 Site-USPS                      (0) | Train Loss: 0.1905 | Train Acc: 0.9591
 Site-SynthDigits               (1) | Train Loss: 0.3354 | Train Acc: 0.9372
 Site-MNIST_M                   (2) | Train Loss: 0.5347 | Train Acc: 0.8916
 Site-SVHN                      (1) | Train Loss: 0.8125 | Train Acc: 0.7768
Average Train Accuracy: 0.9057
 Site-MNIST                     (3) | Val  Loss: 0.1480 | Val  Acc: 0.9630
 Site-USPS                      (0) | Val  Loss: 0.1860 | Val  Acc: 0.9515
 Site-SynthDigits               (1) | Val  Loss: 0.3381 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.4447 | Val  Acc: 0.9400
 Site-SVHN                      (1) | Val  Loss: 0.7648 | Val  Acc: 0.7857
Average Valid Accuracy: 0.9127
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9630
 Best site-USPS                     (0)  | Epoch:46 | Val Acc: 0.9515
 Best site-SynthDigits              (1)  | Epoch:46 | Val Acc: 0.9231
 Best site-MNIST_M                  (2)  | Epoch:46 | Val Acc: 0.9400
 Best site-SVHN                     (1)  | Epoch:46 | Val Acc: 0.7857
 Test site-MNIST                     (3)| Epoch:46 | Test Acc: 0.9440
 Test site-USPS                      (0)| Epoch:46 | Test Acc: 0.9333
 Test site-SynthDigits               (1)| Epoch:46 | Test Acc: 0.8598
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.6751
 Test site-SVHN                      (1)| Epoch:46 | Test Acc: 0.5836
MNIST: 0.9440, USPS: 0.9333, SynthDigits: 0.8598, MNIST_M: 0.6751, SVHN: 0.5836, 
Average Test Accuracy(group): 0.7992, Average Test Accuracy(individual): 0.7992,
domain std=0.1446, cluster std=0.1213, individual std=0.1446, 
Average Test Accuracy: 0.7992
============ Train epoch 47 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (1) | Train Loss: 0.1434 | Train Acc: 0.9647
 Site-USPS                      (3) | Train Loss: 0.1904 | Train Acc: 0.9561
 Site-SynthDigits               (0) | Train Loss: 0.3212 | Train Acc: 0.9399
 Site-MNIST_M                   (2) | Train Loss: 0.4958 | Train Acc: 0.9163
 Site-SVHN                      (0) | Train Loss: 0.8286 | Train Acc: 0.7411
Average Train Accuracy: 0.9036
 Site-MNIST                     (1) | Val  Loss: 0.1452 | Val  Acc: 0.9630
 Site-USPS                      (3) | Val  Loss: 0.1884 | Val  Acc: 0.9515
 Site-SynthDigits               (0) | Val  Loss: 0.3243 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.4283 | Val  Acc: 0.9200
 Site-SVHN                      (0) | Val  Loss: 0.7705 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9015
 Test site-MNIST                     (1)| Epoch:46 | Test Acc: 0.9466
 Test site-USPS                      (3)| Epoch:46 | Test Acc: 0.9355
 Test site-SynthDigits               (0)| Epoch:46 | Test Acc: 0.8640
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.6783
 Test site-SVHN                      (0)| Epoch:46 | Test Acc: 0.5868
MNIST: 0.9466, USPS: 0.9355, SynthDigits: 0.8640, MNIST_M: 0.6783, SVHN: 0.5868, 
Average Test Accuracy(group): 0.8022, Average Test Accuracy(individual): 0.8022,
domain std=0.1443, cluster std=0.1208, individual std=0.1443, 
Average Test Accuracy: 0.8022
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 48 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (3) | Train Loss: 0.1402 | Train Acc: 0.9689
 Site-USPS                      (0) | Train Loss: 0.1859 | Train Acc: 0.9576
 Site-SynthDigits               (2) | Train Loss: 0.3239 | Train Acc: 0.9508
 Site-MNIST_M                   (1) | Train Loss: 0.4618 | Train Acc: 0.9458
 Site-SVHN                      (2) | Train Loss: 0.8054 | Train Acc: 0.7589
Average Train Accuracy: 0.9164
 Site-MNIST                     (3) | Val  Loss: 0.1425 | Val  Acc: 0.9630
 Site-USPS                      (0) | Val  Loss: 0.1895 | Val  Acc: 0.9515
 Site-SynthDigits               (2) | Val  Loss: 0.3208 | Val  Acc: 0.9231
 Site-MNIST_M                   (1) | Val  Loss: 0.4112 | Val  Acc: 0.9400
 Site-SVHN                      (2) | Val  Loss: 0.7768 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8912
 Test site-MNIST                     (3)| Epoch:47 | Test Acc: 0.9463
 Test site-USPS                      (0)| Epoch:47 | Test Acc: 0.9398
 Test site-SynthDigits               (2)| Epoch:47 | Test Acc: 0.8665
 Test site-MNIST_M                   (1)| Epoch:47 | Test Acc: 0.6846
 Test site-SVHN                      (2)| Epoch:47 | Test Acc: 0.5878
MNIST: 0.9463, USPS: 0.9398, SynthDigits: 0.8665, MNIST_M: 0.6846, SVHN: 0.5878, 
Average Test Accuracy(group): 0.8050, Average Test Accuracy(individual): 0.8050,
domain std=0.1439, cluster std=0.1196, individual std=0.1439, 
Average Test Accuracy: 0.8050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (3) | Train Loss: 0.1394 | Train Acc: 0.9664
 Site-USPS                      (1) | Train Loss: 0.1756 | Train Acc: 0.9606
 Site-SynthDigits               (0) | Train Loss: 0.3166 | Train Acc: 0.9454
 Site-MNIST_M                   (2) | Train Loss: 0.4207 | Train Acc: 0.9261
 Site-SVHN                      (0) | Train Loss: 0.7823 | Train Acc: 0.7768
Average Train Accuracy: 0.9150
 Site-MNIST                     (3) | Val  Loss: 0.1404 | Val  Acc: 0.9663
 Site-USPS                      (1) | Val  Loss: 0.1791 | Val  Acc: 0.9455
 Site-SynthDigits               (0) | Val  Loss: 0.3163 | Val  Acc: 0.9231
 Site-MNIST_M                   (2) | Val  Loss: 0.4034 | Val  Acc: 0.9400
 Site-SVHN                      (0) | Val  Loss: 0.7311 | Val  Acc: 0.7857
Average Valid Accuracy: 0.9121
 Test site-MNIST                     (3)| Epoch:48 | Test Acc: 0.9466
 Test site-USPS                      (1)| Epoch:48 | Test Acc: 0.9398
 Test site-SynthDigits               (0)| Epoch:48 | Test Acc: 0.8653
 Test site-MNIST_M                   (2)| Epoch:48 | Test Acc: 0.6797
 Test site-SVHN                      (0)| Epoch:48 | Test Acc: 0.5937
MNIST: 0.9466, USPS: 0.9398, SynthDigits: 0.8653, MNIST_M: 0.6797, SVHN: 0.5937, 
Average Test Accuracy(group): 0.8050, Average Test Accuracy(individual): 0.8050,
domain std=0.1430, cluster std=0.1206, individual std=0.1430, 
Average Test Accuracy: 0.8050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon_distinct/ccop_q=1...
===2023-07-01 20:43:29===
===2023-07-01 20:43:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     (3)| Epoch:49 | Test Acc: 0.9466
 Test site-USPS                      (1)| Epoch:49 | Test Acc: 0.9398
 Test site-SynthDigits               (0)| Epoch:49 | Test Acc: 0.8653
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.6797
 Test site-SVHN                      (0)| Epoch:49 | Test Acc: 0.5937
MNIST: 0.9466, USPS: 0.9398, SynthDigits: 0.8653, MNIST_M: 0.6797, SVHN: 0.5937, 
Average Test Accuracy(group): 0.8050, Average Test Accuracy(individual): 0.8050,
domain std=0.1430, cluster std=0.1206, individual std=0.1430, 
