===2023-07-02 00:00:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.9844 | Train Acc: 0.6577
 Site-USPS                          | Train Loss: 2.0080 | Train Acc: 0.6591
 Site-SynthDigits                   | Train Loss: 2.2420 | Train Acc: 0.2077
 Site-MNIST_M                       | Train Loss: 2.2732 | Train Acc: 0.1429
 Site-SVHN                          | Train Loss: 2.2830 | Train Acc: 0.1250
Average Train Accuracy: 0.3585
 Site-MNIST                         | Val  Loss: 1.9807 | Val  Acc: 0.6734
 Site-USPS                          | Val  Loss: 1.9960 | Val  Acc: 0.6970
 Site-SynthDigits                   | Val  Loss: 2.2421 | Val  Acc: 0.1978
 Site-MNIST_M                       | Val  Loss: 2.2643 | Val  Acc: 0.1000
 Site-SVHN                          | Val  Loss: 2.2771 | Val  Acc: 0.0357
Average Valid Accuracy: 0.3408
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6734
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6970
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1978
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1000
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.0357
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.7051 | Train Acc: 0.7410
 Site-USPS                          | Train Loss: 1.7324 | Train Acc: 0.7273
 Site-SynthDigits                   | Train Loss: 2.1785 | Train Acc: 0.2459
 Site-MNIST_M                       | Train Loss: 2.2376 | Train Acc: 0.2463
 Site-SVHN                          | Train Loss: 2.2696 | Train Acc: 0.1696
Average Train Accuracy: 0.4260
 Site-MNIST                         | Val  Loss: 1.6944 | Val  Acc: 0.7475
 Site-USPS                          | Val  Loss: 1.7202 | Val  Acc: 0.7212
 Site-SynthDigits                   | Val  Loss: 2.1758 | Val  Acc: 0.2967
 Site-MNIST_M                       | Val  Loss: 2.2289 | Val  Acc: 0.2400
 Site-SVHN                          | Val  Loss: 2.2625 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4368
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7475
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7212
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2967
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2400
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.4537 | Train Acc: 0.7864
 Site-USPS                          | Train Loss: 1.4998 | Train Acc: 0.7652
 Site-SynthDigits                   | Train Loss: 2.1185 | Train Acc: 0.2623
 Site-MNIST_M                       | Train Loss: 2.1636 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.2562 | Train Acc: 0.1786
Average Train Accuracy: 0.4556
 Site-MNIST                         | Val  Loss: 1.4424 | Val  Acc: 0.7912
 Site-USPS                          | Val  Loss: 1.4672 | Val  Acc: 0.7576
 Site-SynthDigits                   | Val  Loss: 2.1104 | Val  Acc: 0.3297
 Site-MNIST_M                       | Val  Loss: 2.1990 | Val  Acc: 0.2800
 Site-SVHN                          | Val  Loss: 2.2482 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4746
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7912
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7576
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3297
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2800
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.2493 | Train Acc: 0.8150
 Site-USPS                          | Train Loss: 1.2765 | Train Acc: 0.7970
 Site-SynthDigits                   | Train Loss: 2.0638 | Train Acc: 0.2732
 Site-MNIST_M                       | Train Loss: 2.1256 | Train Acc: 0.3350
 Site-SVHN                          | Train Loss: 2.2515 | Train Acc: 0.1786
Average Train Accuracy: 0.4797
 Site-MNIST                         | Val  Loss: 1.2329 | Val  Acc: 0.8114
 Site-USPS                          | Val  Loss: 1.2627 | Val  Acc: 0.7818
 Site-SynthDigits                   | Val  Loss: 2.0571 | Val  Acc: 0.3187
 Site-MNIST_M                       | Val  Loss: 2.1595 | Val  Acc: 0.3200
 Site-SVHN                          | Val  Loss: 2.2349 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4964
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8114
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7818
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3187
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3200
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.0855 | Train Acc: 0.8200
 Site-USPS                          | Train Loss: 1.1186 | Train Acc: 0.8076
 Site-SynthDigits                   | Train Loss: 2.0171 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 2.1001 | Train Acc: 0.3448
 Site-SVHN                          | Train Loss: 2.2405 | Train Acc: 0.1786
Average Train Accuracy: 0.4903
 Site-MNIST                         | Val  Loss: 1.0689 | Val  Acc: 0.8182
 Site-USPS                          | Val  Loss: 1.0913 | Val  Acc: 0.8061
 Site-SynthDigits                   | Val  Loss: 2.0100 | Val  Acc: 0.3187
 Site-MNIST_M                       | Val  Loss: 2.1107 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2168 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5146
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8182
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8061
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3187
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.9435 | Train Acc: 0.8343
 Site-USPS                          | Train Loss: 0.9984 | Train Acc: 0.8197
 Site-SynthDigits                   | Train Loss: 1.9664 | Train Acc: 0.3142
 Site-MNIST_M                       | Train Loss: 2.0253 | Train Acc: 0.3547
 Site-SVHN                          | Train Loss: 2.2311 | Train Acc: 0.1875
Average Train Accuracy: 0.5021
 Site-MNIST                         | Val  Loss: 0.9245 | Val  Acc: 0.8418
 Site-USPS                          | Val  Loss: 0.9668 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.9734 | Val  Acc: 0.3516
 Site-MNIST_M                       | Val  Loss: 2.0756 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2028 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5327
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8418
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3516
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.8301 | Train Acc: 0.8486
 Site-USPS                          | Train Loss: 0.8820 | Train Acc: 0.8379
 Site-SynthDigits                   | Train Loss: 1.9307 | Train Acc: 0.3169
 Site-MNIST_M                       | Train Loss: 1.9685 | Train Acc: 0.3744
 Site-SVHN                          | Train Loss: 2.2254 | Train Acc: 0.1696
Average Train Accuracy: 0.5095
 Site-MNIST                         | Val  Loss: 0.8087 | Val  Acc: 0.8418
 Site-USPS                          | Val  Loss: 0.8712 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.9520 | Val  Acc: 0.3626
 Site-MNIST_M                       | Val  Loss: 2.0359 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1926 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5465
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8418
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3626
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.7494 | Train Acc: 0.8562
 Site-USPS                          | Train Loss: 0.8026 | Train Acc: 0.8485
 Site-SynthDigits                   | Train Loss: 1.9017 | Train Acc: 0.3443
 Site-MNIST_M                       | Train Loss: 2.0166 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.2112 | Train Acc: 0.1607
Average Train Accuracy: 0.5198
 Site-MNIST                         | Val  Loss: 0.7259 | Val  Acc: 0.8519
 Site-USPS                          | Val  Loss: 0.7910 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.9314 | Val  Acc: 0.3846
 Site-MNIST_M                       | Val  Loss: 2.0092 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1854 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5541
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8519
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8485
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3846
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.6673 | Train Acc: 0.8688
 Site-USPS                          | Train Loss: 0.7235 | Train Acc: 0.8455
 Site-SynthDigits                   | Train Loss: 1.8822 | Train Acc: 0.3443
 Site-MNIST_M                       | Train Loss: 1.9632 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.2085 | Train Acc: 0.1607
Average Train Accuracy: 0.5217
 Site-MNIST                         | Val  Loss: 0.6502 | Val  Acc: 0.8620
 Site-USPS                          | Val  Loss: 0.7235 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.9159 | Val  Acc: 0.3956
 Site-MNIST_M                       | Val  Loss: 1.9844 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1850 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5556
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8620
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3956
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3800
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.6055 | Train Acc: 0.8780
 Site-USPS                          | Train Loss: 0.6845 | Train Acc: 0.8545
 Site-SynthDigits                   | Train Loss: 1.8589 | Train Acc: 0.3443
 Site-MNIST_M                       | Train Loss: 1.9465 | Train Acc: 0.3744
 Site-SVHN                          | Train Loss: 2.1974 | Train Acc: 0.1696
Average Train Accuracy: 0.5242
 Site-MNIST                         | Val  Loss: 0.5882 | Val  Acc: 0.8653
 Site-USPS                          | Val  Loss: 0.6695 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.8998 | Val  Acc: 0.3956
 Site-MNIST_M                       | Val  Loss: 1.9632 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1649 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5578
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8653
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3956
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3400
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.5607 | Train Acc: 0.8848
 Site-USPS                          | Train Loss: 0.6526 | Train Acc: 0.8530
 Site-SynthDigits                   | Train Loss: 1.8379 | Train Acc: 0.3607
 Site-MNIST_M                       | Train Loss: 1.9245 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.1986 | Train Acc: 0.1518
Average Train Accuracy: 0.5279
 Site-MNIST                         | Val  Loss: 0.5449 | Val  Acc: 0.8788
 Site-USPS                          | Val  Loss: 0.6267 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.8814 | Val  Acc: 0.3956
 Site-MNIST_M                       | Val  Loss: 1.9334 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1727 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5645
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8788
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3956
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.5278 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.5950 | Train Acc: 0.8606
 Site-SynthDigits                   | Train Loss: 1.8083 | Train Acc: 0.3661
 Site-MNIST_M                       | Train Loss: 1.8231 | Train Acc: 0.3793
 Site-SVHN                          | Train Loss: 2.1968 | Train Acc: 0.1250
Average Train Accuracy: 0.5237
 Site-MNIST                         | Val  Loss: 0.5079 | Val  Acc: 0.8855
 Site-USPS                          | Val  Loss: 0.5880 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.8688 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.9072 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1632 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5510
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.4863 | Train Acc: 0.8940
 Site-USPS                          | Train Loss: 0.5812 | Train Acc: 0.8621
 Site-SynthDigits                   | Train Loss: 1.7993 | Train Acc: 0.3852
 Site-MNIST_M                       | Train Loss: 1.9130 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.1993 | Train Acc: 0.1696
Average Train Accuracy: 0.5400
 Site-MNIST                         | Val  Loss: 0.4671 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.5555 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8649 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.9013 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1602 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5569
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.4627 | Train Acc: 0.8957
 Site-USPS                          | Train Loss: 0.5545 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.7818 | Train Acc: 0.3907
 Site-MNIST_M                       | Train Loss: 1.8683 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.2052 | Train Acc: 0.1696
Average Train Accuracy: 0.5427
 Site-MNIST                         | Val  Loss: 0.4403 | Val  Acc: 0.8923
 Site-USPS                          | Val  Loss: 0.5209 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.8575 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8753 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1564 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5575
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.4320 | Train Acc: 0.9066
 Site-USPS                          | Train Loss: 0.5157 | Train Acc: 0.8758
 Site-SynthDigits                   | Train Loss: 1.7557 | Train Acc: 0.3825
 Site-MNIST_M                       | Train Loss: 1.8718 | Train Acc: 0.3793
 Site-SVHN                          | Train Loss: 2.1974 | Train Acc: 0.1696
Average Train Accuracy: 0.5428
 Site-MNIST                         | Val  Loss: 0.4083 | Val  Acc: 0.9057
 Site-USPS                          | Val  Loss: 0.5107 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.8399 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8633 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1615 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5686
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9057
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4066
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.3600
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.4088 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.4973 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.7446 | Train Acc: 0.4098
 Site-MNIST_M                       | Train Loss: 1.7785 | Train Acc: 0.3744
 Site-SVHN                          | Train Loss: 2.2050 | Train Acc: 0.1607
Average Train Accuracy: 0.5471
 Site-MNIST                         | Val  Loss: 0.3889 | Val  Acc: 0.9024
 Site-USPS                          | Val  Loss: 0.4843 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.8213 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8492 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1649 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5518
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.3797 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.4875 | Train Acc: 0.8833
 Site-SynthDigits                   | Train Loss: 1.7443 | Train Acc: 0.4016
 Site-MNIST_M                       | Train Loss: 1.8259 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.1964 | Train Acc: 0.1607
Average Train Accuracy: 0.5512
 Site-MNIST                         | Val  Loss: 0.3572 | Val  Acc: 0.9226
 Site-USPS                          | Val  Loss: 0.4838 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.8204 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.8280 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1707 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5629
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.3642 | Train Acc: 0.9260
 Site-USPS                          | Train Loss: 0.4721 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.7293 | Train Acc: 0.4208
 Site-MNIST_M                       | Train Loss: 1.8039 | Train Acc: 0.3892
 Site-SVHN                          | Train Loss: 2.2070 | Train Acc: 0.1518
Average Train Accuracy: 0.5551
 Site-MNIST                         | Val  Loss: 0.3420 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.4625 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.8004 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.8105 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1672 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5577
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.3507 | Train Acc: 0.9218
 Site-USPS                          | Train Loss: 0.4548 | Train Acc: 0.8894
 Site-SynthDigits                   | Train Loss: 1.7079 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 1.7717 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2092 | Train Acc: 0.1429
Average Train Accuracy: 0.5584
 Site-MNIST                         | Val  Loss: 0.3264 | Val  Acc: 0.9259
 Site-USPS                          | Val  Loss: 0.4470 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.7950 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.7974 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1896 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5520
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.3317 | Train Acc: 0.9243
 Site-USPS                          | Train Loss: 0.4072 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.6972 | Train Acc: 0.4180
 Site-MNIST_M                       | Train Loss: 1.8078 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.2002 | Train Acc: 0.1607
Average Train Accuracy: 0.5582
 Site-MNIST                         | Val  Loss: 0.3112 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.4157 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.7863 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.7975 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1720 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5429
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.3107 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.4112 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.6821 | Train Acc: 0.4235
 Site-MNIST_M                       | Train Loss: 1.7725 | Train Acc: 0.3941
 Site-SVHN                          | Train Loss: 2.2067 | Train Acc: 0.1518
Average Train Accuracy: 0.5587
 Site-MNIST                         | Val  Loss: 0.2897 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.4182 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.7868 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.7827 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.1778 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5505
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.3118 | Train Acc: 0.9285
 Site-USPS                          | Train Loss: 0.4016 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.6614 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 1.8496 | Train Acc: 0.3990
 Site-SVHN                          | Train Loss: 2.2056 | Train Acc: 0.1607
Average Train Accuracy: 0.5643
 Site-MNIST                         | Val  Loss: 0.2891 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3846 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.7648 | Val  Acc: 0.4066
 Site-MNIST_M                       | Val  Loss: 1.7977 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1849 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5526
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.2886 | Train Acc: 0.9327
 Site-USPS                          | Train Loss: 0.4077 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.6555 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.7835 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2052 | Train Acc: 0.1607
Average Train Accuracy: 0.5710
 Site-MNIST                         | Val  Loss: 0.2678 | Val  Acc: 0.9360
 Site-USPS                          | Val  Loss: 0.3958 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7648 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.7575 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1829 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5541
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.2756 | Train Acc: 0.9327
 Site-USPS                          | Train Loss: 0.3839 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.6465 | Train Acc: 0.4454
 Site-MNIST_M                       | Train Loss: 1.7681 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.2135 | Train Acc: 0.1429
Average Train Accuracy: 0.5682
 Site-MNIST                         | Val  Loss: 0.2570 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3761 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7509 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.7577 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1866 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5473
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.2652 | Train Acc: 0.9361
 Site-USPS                          | Train Loss: 0.3799 | Train Acc: 0.9030
 Site-SynthDigits                   | Train Loss: 1.6442 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.7242 | Train Acc: 0.3842
 Site-SVHN                          | Train Loss: 2.2144 | Train Acc: 0.1339
Average Train Accuracy: 0.5611
 Site-MNIST                         | Val  Loss: 0.2456 | Val  Acc: 0.9394
 Site-USPS                          | Val  Loss: 0.3881 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.7531 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.7471 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2008 | Val  Acc: 0.0714
Average Valid Accuracy: 0.5387
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.2600 | Train Acc: 0.9403
 Site-USPS                          | Train Loss: 0.3455 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.6378 | Train Acc: 0.4372
 Site-MNIST_M                       | Train Loss: 1.7734 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.2146 | Train Acc: 0.1518
Average Train Accuracy: 0.5685
 Site-MNIST                         | Val  Loss: 0.2387 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3389 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7442 | Val  Acc: 0.4176
 Site-MNIST_M                       | Val  Loss: 1.7597 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2041 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5502
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.2483 | Train Acc: 0.9428
 Site-USPS                          | Train Loss: 0.3563 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.6233 | Train Acc: 0.4454
 Site-MNIST_M                       | Train Loss: 1.7427 | Train Acc: 0.3990
 Site-SVHN                          | Train Loss: 2.1982 | Train Acc: 0.1696
Average Train Accuracy: 0.5732
 Site-MNIST                         | Val  Loss: 0.2284 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.3631 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.7412 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7347 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1935 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5558
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.2554 | Train Acc: 0.9403
 Site-USPS                          | Train Loss: 0.3133 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.6175 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.7009 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 2.2185 | Train Acc: 0.1518
Average Train Accuracy: 0.5771
 Site-MNIST                         | Val  Loss: 0.2322 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3208 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7114 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.7181 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2154 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5691
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9428
 Best site-USPS                      | Epoch:27 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4505
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.2293 | Train Acc: 0.9487
 Site-USPS                          | Train Loss: 0.3484 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.6190 | Train Acc: 0.4563
 Site-MNIST_M                       | Train Loss: 1.7772 | Train Acc: 0.4089
 Site-SVHN                          | Train Loss: 2.2181 | Train Acc: 0.1607
Average Train Accuracy: 0.5773
 Site-MNIST                         | Val  Loss: 0.2073 | Val  Acc: 0.9562
 Site-USPS                          | Val  Loss: 0.3496 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.7345 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.7092 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.2114 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5684
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.2399 | Train Acc: 0.9453
 Site-USPS                          | Train Loss: 0.2983 | Train Acc: 0.9197
 Site-SynthDigits                   | Train Loss: 1.6010 | Train Acc: 0.4536
 Site-MNIST_M                       | Train Loss: 1.7184 | Train Acc: 0.4335
 Site-SVHN                          | Train Loss: 2.2123 | Train Acc: 0.1429
Average Train Accuracy: 0.5790
 Site-MNIST                         | Val  Loss: 0.2189 | Val  Acc: 0.9495
 Site-USPS                          | Val  Loss: 0.2899 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6986 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7114 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.2143 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5663
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.2142 | Train Acc: 0.9546
 Site-USPS                          | Train Loss: 0.3164 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.6049 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 1.7028 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.2180 | Train Acc: 0.1607
Average Train Accuracy: 0.5831
 Site-MNIST                         | Val  Loss: 0.1962 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3139 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7144 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6980 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2181 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5641
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.2073 | Train Acc: 0.9546
 Site-USPS                          | Train Loss: 0.3221 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.5670 | Train Acc: 0.4590
 Site-MNIST_M                       | Train Loss: 1.6834 | Train Acc: 0.4187
 Site-SVHN                          | Train Loss: 2.2313 | Train Acc: 0.1607
Average Train Accuracy: 0.5828
 Site-MNIST                         | Val  Loss: 0.1901 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.3054 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.7021 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.6866 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2150 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5662
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.2007 | Train Acc: 0.9554
 Site-USPS                          | Train Loss: 0.3043 | Train Acc: 0.9273
 Site-SynthDigits                   | Train Loss: 1.5730 | Train Acc: 0.4672
 Site-MNIST_M                       | Train Loss: 1.6426 | Train Acc: 0.4335
 Site-SVHN                          | Train Loss: 2.2032 | Train Acc: 0.1786
Average Train Accuracy: 0.5924
 Site-MNIST                         | Val  Loss: 0.1819 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.3030 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.7016 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6792 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.2223 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5824
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9663
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9212
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.4615
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.4200
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.1913 | Train Acc: 0.9613
 Site-USPS                          | Train Loss: 0.2839 | Train Acc: 0.9273
 Site-SynthDigits                   | Train Loss: 1.5985 | Train Acc: 0.4399
 Site-MNIST_M                       | Train Loss: 1.6712 | Train Acc: 0.4138
 Site-SVHN                          | Train Loss: 2.2209 | Train Acc: 0.1786
Average Train Accuracy: 0.5842
 Site-MNIST                         | Val  Loss: 0.1739 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2852 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.7229 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.7139 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2159 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5706
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1933 | Train Acc: 0.9563
 Site-USPS                          | Train Loss: 0.2832 | Train Acc: 0.9364
 Site-SynthDigits                   | Train Loss: 1.5929 | Train Acc: 0.4563
 Site-MNIST_M                       | Train Loss: 1.7321 | Train Acc: 0.4335
 Site-SVHN                          | Train Loss: 2.2034 | Train Acc: 0.1607
Average Train Accuracy: 0.5886
 Site-MNIST                         | Val  Loss: 0.1752 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2606 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.6907 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.6799 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2269 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5877
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9663
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9212
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.4725
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1826 | Train Acc: 0.9605
 Site-USPS                          | Train Loss: 0.2891 | Train Acc: 0.9288
 Site-SynthDigits                   | Train Loss: 1.5649 | Train Acc: 0.4536
 Site-MNIST_M                       | Train Loss: 1.6159 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.2242 | Train Acc: 0.1607
Average Train Accuracy: 0.5884
 Site-MNIST                         | Val  Loss: 0.1654 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2796 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.6846 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.6620 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2529 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5697
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.1806 | Train Acc: 0.9613
 Site-USPS                          | Train Loss: 0.2650 | Train Acc: 0.9409
 Site-SynthDigits                   | Train Loss: 1.5659 | Train Acc: 0.4645
 Site-MNIST_M                       | Train Loss: 1.6799 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.2215 | Train Acc: 0.1607
Average Train Accuracy: 0.5932
 Site-MNIST                         | Val  Loss: 0.1632 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2616 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6718 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6598 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2476 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5809
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1796 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2661 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.5530 | Train Acc: 0.4699
 Site-MNIST_M                       | Train Loss: 1.6213 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 2.2275 | Train Acc: 0.1786
Average Train Accuracy: 0.5935
 Site-MNIST                         | Val  Loss: 0.1643 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2578 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6738 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.6558 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.2596 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5727
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1767 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2486 | Train Acc: 0.9409
 Site-SynthDigits                   | Train Loss: 1.5459 | Train Acc: 0.4645
 Site-MNIST_M                       | Train Loss: 1.7091 | Train Acc: 0.4335
 Site-SVHN                          | Train Loss: 2.2213 | Train Acc: 0.1696
Average Train Accuracy: 0.5935
 Site-MNIST                         | Val  Loss: 0.1591 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.2438 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.6582 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6388 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2562 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5880
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9663
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.4615
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1660 | Train Acc: 0.9605
 Site-USPS                          | Train Loss: 0.2578 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.5370 | Train Acc: 0.4672
 Site-MNIST_M                       | Train Loss: 1.5697 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.2337 | Train Acc: 0.1786
Average Train Accuracy: 0.5956
 Site-MNIST                         | Val  Loss: 0.1512 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2543 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6690 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6454 | Val  Acc: 0.4200
 Site-SVHN                          | Val  Loss: 2.2698 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5771
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1622 | Train Acc: 0.9622
 Site-USPS                          | Train Loss: 0.2411 | Train Acc: 0.9439
 Site-SynthDigits                   | Train Loss: 1.5314 | Train Acc: 0.4672
 Site-MNIST_M                       | Train Loss: 1.6486 | Train Acc: 0.4532
 Site-SVHN                          | Train Loss: 2.2505 | Train Acc: 0.1696
Average Train Accuracy: 0.5992
 Site-MNIST                         | Val  Loss: 0.1481 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2356 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.6511 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.6263 | Val  Acc: 0.4400
 Site-SVHN                          | Val  Loss: 2.2719 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5917
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9697
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.4725
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.4400
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/fedavg...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1601 | Train Acc: 0.9622
 Site-USPS                          | Train Loss: 0.2310 | Train Acc: 0.9455
 Site-SynthDigits                   | Train Loss: 1.5245 | Train Acc: 0.4727
 Site-MNIST_M                       | Train Loss: 1.5944 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.2357 | Train Acc: 0.1875
Average Train Accuracy: 0.5983
 Site-MNIST                         | Val  Loss: 0.1467 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2275 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6346 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.6248 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.2683 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5739
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1601 | Train Acc: 0.9613
 Site-USPS                          | Train Loss: 0.2230 | Train Acc: 0.9439
 Site-SynthDigits                   | Train Loss: 1.5034 | Train Acc: 0.4727
 Site-MNIST_M                       | Train Loss: 1.5453 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.2486 | Train Acc: 0.2054
Average Train Accuracy: 0.6053
 Site-MNIST                         | Val  Loss: 0.1443 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2227 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.6251 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.6185 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2819 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5902
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1524 | Train Acc: 0.9647
 Site-USPS                          | Train Loss: 0.2372 | Train Acc: 0.9394
 Site-SynthDigits                   | Train Loss: 1.5082 | Train Acc: 0.4891
 Site-MNIST_M                       | Train Loss: 1.6435 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.2307 | Train Acc: 0.1786
Average Train Accuracy: 0.6020
 Site-MNIST                         | Val  Loss: 0.1387 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2293 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.6464 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.6133 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2687 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5721
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1394 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.2500 | Train Acc: 0.9409
 Site-SynthDigits                   | Train Loss: 1.5262 | Train Acc: 0.4672
 Site-MNIST_M                       | Train Loss: 1.6303 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.2356 | Train Acc: 0.1696
Average Train Accuracy: 0.5965
 Site-MNIST                         | Val  Loss: 0.1268 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.2356 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6524 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6177 | Val  Acc: 0.3600
 Site-SVHN                          | Val  Loss: 2.2757 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5747
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1461 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.2251 | Train Acc: 0.9455
 Site-SynthDigits                   | Train Loss: 1.4936 | Train Acc: 0.4891
 Site-MNIST_M                       | Train Loss: 1.6448 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.2184 | Train Acc: 0.1696
Average Train Accuracy: 0.6038
 Site-MNIST                         | Val  Loss: 0.1326 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2126 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6257 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.5979 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.2826 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5856
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1404 | Train Acc: 0.9672
 Site-USPS                          | Train Loss: 0.2277 | Train Acc: 0.9485
 Site-SynthDigits                   | Train Loss: 1.5208 | Train Acc: 0.4836
 Site-MNIST_M                       | Train Loss: 1.6394 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.2234 | Train Acc: 0.1875
Average Train Accuracy: 0.6021
 Site-MNIST                         | Val  Loss: 0.1298 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2080 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6275 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.6101 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.2793 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5612
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1341 | Train Acc: 0.9689
 Site-USPS                          | Train Loss: 0.2286 | Train Acc: 0.9424
 Site-SynthDigits                   | Train Loss: 1.5057 | Train Acc: 0.4836
 Site-MNIST_M                       | Train Loss: 1.6123 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.2582 | Train Acc: 0.1964
Average Train Accuracy: 0.6069
 Site-MNIST                         | Val  Loss: 0.1209 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2219 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6473 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6005 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.3100 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5905
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1320 | Train Acc: 0.9689
 Site-USPS                          | Train Loss: 0.2226 | Train Acc: 0.9424
 Site-SynthDigits                   | Train Loss: 1.4947 | Train Acc: 0.4809
 Site-MNIST_M                       | Train Loss: 1.6088 | Train Acc: 0.4384
 Site-SVHN                          | Train Loss: 2.2501 | Train Acc: 0.1875
Average Train Accuracy: 0.6036
 Site-MNIST                         | Val  Loss: 0.1192 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.2149 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6418 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.5906 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.3159 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5756
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1296 | Train Acc: 0.9672
 Site-USPS                          | Train Loss: 0.2138 | Train Acc: 0.9439
 Site-SynthDigits                   | Train Loss: 1.4838 | Train Acc: 0.4891
 Site-MNIST_M                       | Train Loss: 1.5316 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.2297 | Train Acc: 0.1964
Average Train Accuracy: 0.6080
 Site-MNIST                         | Val  Loss: 0.1157 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.2032 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.6172 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.5860 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.3134 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5868
===2023-07-02 00:29:56===
===2023-07-02 00:29:58===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:40 | Test Acc: 0.9220
 Test site-USPS                      | Epoch:40 | Test Acc: 0.9161
 Test site-SynthDigits               | Epoch:40 | Test Acc: 0.4725
 Test site-MNIST_M                   | Epoch:40 | Test Acc: 0.3866
 Test site-SVHN                      | Epoch:40 | Test Acc: 0.2000
MNIST: 0.9220, USPS: 0.9161, SynthDigits: 0.4725, MNIST_M: 0.3866, SVHN: 0.2000, 
Average Test Accuracy(group): 0.5795, Average Test Accuracy(individual): 0.5795,
domain std=0.2910, cluster std=-1.0000, individual std=0.2910, 
