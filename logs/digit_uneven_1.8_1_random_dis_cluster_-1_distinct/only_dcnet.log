===2023-07-01 22:27:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 60
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 1.3470 | Train Acc: 0.7384
 Site-USPS                          | Train Loss: 1.4371 | Train Acc: 0.7273
 Site-SynthDigits                   | Train Loss: 2.0738 | Train Acc: 0.2486
 Site-MNIST_M                       | Train Loss: 2.1783 | Train Acc: 0.1823
 Site-SVHN                          | Train Loss: 2.2450 | Train Acc: 0.1429
Average Train Accuracy: 0.4079
 Site-MNIST                         | Val  Loss: 1.3245 | Val  Acc: 0.7441
 Site-USPS                          | Val  Loss: 1.4007 | Val  Acc: 0.7394
 Site-SynthDigits                   | Val  Loss: 2.1054 | Val  Acc: 0.2747
 Site-MNIST_M                       | Val  Loss: 2.2007 | Val  Acc: 0.0800
 Site-SVHN                          | Val  Loss: 2.1169 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4105
 Best site-MNIST                         | Epoch:0 | Val Acc: 0.7441
 Best site-USPS                          | Epoch:0 | Val Acc: 0.7394
 Best site-SynthDigits                   | Epoch:0 | Val Acc: 0.2747
 Best site-MNIST_M                       | Epoch:0 | Val Acc: 0.0800
 Best site-SVHN                          | Epoch:0 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 1 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.8645 | Train Acc: 0.8402
 Site-USPS                          | Train Loss: 0.9535 | Train Acc: 0.8227
 Site-SynthDigits                   | Train Loss: 1.9234 | Train Acc: 0.3279
 Site-MNIST_M                       | Train Loss: 2.0744 | Train Acc: 0.2414
 Site-SVHN                          | Train Loss: 2.2207 | Train Acc: 0.1429
Average Train Accuracy: 0.4750
 Site-MNIST                         | Val  Loss: 0.8503 | Val  Acc: 0.8384
 Site-USPS                          | Val  Loss: 0.9386 | Val  Acc: 0.8303
 Site-SynthDigits                   | Val  Loss: 1.9451 | Val  Acc: 0.3626
 Site-MNIST_M                       | Val  Loss: 2.0316 | Val  Acc: 0.2200
 Site-SVHN                          | Val  Loss: 2.0826 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4931
 Best site-MNIST                         | Epoch:1 | Val Acc: 0.8384
 Best site-USPS                          | Epoch:1 | Val Acc: 0.8303
 Best site-SynthDigits                   | Epoch:1 | Val Acc: 0.3626
 Best site-MNIST_M                       | Epoch:1 | Val Acc: 0.2200
 Best site-SVHN                          | Epoch:1 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 2 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.6555 | Train Acc: 0.8797
 Site-USPS                          | Train Loss: 0.7325 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.8408 | Train Acc: 0.3470
 Site-MNIST_M                       | Train Loss: 2.0274 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.2226 | Train Acc: 0.1518
Average Train Accuracy: 0.5065
 Site-MNIST                         | Val  Loss: 0.6457 | Val  Acc: 0.8822
 Site-USPS                          | Val  Loss: 0.7341 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.8481 | Val  Acc: 0.3956
 Site-MNIST_M                       | Val  Loss: 1.9787 | Val  Acc: 0.2800
 Site-SVHN                          | Val  Loss: 2.1245 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5290
 Best site-MNIST                         | Epoch:2 | Val Acc: 0.8822
 Best site-USPS                          | Epoch:2 | Val Acc: 0.8727
 Best site-SynthDigits                   | Epoch:2 | Val Acc: 0.3956
 Best site-MNIST_M                       | Epoch:2 | Val Acc: 0.2800
 Best site-SVHN                          | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 3 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.5451 | Train Acc: 0.8814
 Site-USPS                          | Train Loss: 0.6352 | Train Acc: 0.8561
 Site-SynthDigits                   | Train Loss: 1.7196 | Train Acc: 0.4098
 Site-MNIST_M                       | Train Loss: 1.9569 | Train Acc: 0.3005
 Site-SVHN                          | Train Loss: 2.1993 | Train Acc: 0.1607
Average Train Accuracy: 0.5217
 Site-MNIST                         | Val  Loss: 0.5465 | Val  Acc: 0.8754
 Site-USPS                          | Val  Loss: 0.6144 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7277 | Val  Acc: 0.4286
 Site-MNIST_M                       | Val  Loss: 1.8880 | Val  Acc: 0.3000
 Site-SVHN                          | Val  Loss: 2.1082 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5466
 Best site-MNIST                         | Epoch:3 | Val Acc: 0.8754
 Best site-USPS                          | Epoch:3 | Val Acc: 0.8788
 Best site-SynthDigits                   | Epoch:3 | Val Acc: 0.4286
 Best site-MNIST_M                       | Epoch:3 | Val Acc: 0.3000
 Best site-SVHN                          | Epoch:3 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 4 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.4830 | Train Acc: 0.8923
 Site-USPS                          | Train Loss: 0.5531 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.6494 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 1.7996 | Train Acc: 0.3153
 Site-SVHN                          | Train Loss: 2.2277 | Train Acc: 0.1518
Average Train Accuracy: 0.5325
 Site-MNIST                         | Val  Loss: 0.4781 | Val  Acc: 0.8822
 Site-USPS                          | Val  Loss: 0.5254 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6532 | Val  Acc: 0.4505
 Site-MNIST_M                       | Val  Loss: 1.8481 | Val  Acc: 0.3400
 Site-SVHN                          | Val  Loss: 2.1434 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5676
 Best site-MNIST                         | Epoch:4 | Val Acc: 0.8822
 Best site-USPS                          | Epoch:4 | Val Acc: 0.9152
 Best site-SynthDigits                   | Epoch:4 | Val Acc: 0.4505
 Best site-MNIST_M                       | Epoch:4 | Val Acc: 0.3400
 Best site-SVHN                          | Epoch:4 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 5 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.4086 | Train Acc: 0.9066
 Site-USPS                          | Train Loss: 0.4865 | Train Acc: 0.8970
 Site-SynthDigits                   | Train Loss: 1.6181 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.7769 | Train Acc: 0.3695
 Site-SVHN                          | Train Loss: 2.2182 | Train Acc: 0.1875
Average Train Accuracy: 0.5617
 Site-MNIST                         | Val  Loss: 0.4110 | Val  Acc: 0.8990
 Site-USPS                          | Val  Loss: 0.4805 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.6211 | Val  Acc: 0.4396
 Site-MNIST_M                       | Val  Loss: 1.7674 | Val  Acc: 0.3800
 Site-SVHN                          | Val  Loss: 2.1557 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5767
 Best site-MNIST                         | Epoch:5 | Val Acc: 0.8990
 Best site-USPS                          | Epoch:5 | Val Acc: 0.9152
 Best site-SynthDigits                   | Epoch:5 | Val Acc: 0.4396
 Best site-MNIST_M                       | Epoch:5 | Val Acc: 0.3800
 Best site-SVHN                          | Epoch:5 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 6 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.3628 | Train Acc: 0.9117
 Site-USPS                          | Train Loss: 0.4457 | Train Acc: 0.8985
 Site-SynthDigits                   | Train Loss: 1.5545 | Train Acc: 0.4645
 Site-MNIST_M                       | Train Loss: 1.8203 | Train Acc: 0.3842
 Site-SVHN                          | Train Loss: 2.2508 | Train Acc: 0.1875
Average Train Accuracy: 0.5693
 Site-MNIST                         | Val  Loss: 0.3581 | Val  Acc: 0.9125
 Site-USPS                          | Val  Loss: 0.4333 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5778 | Val  Acc: 0.4725
 Site-MNIST_M                       | Val  Loss: 1.7545 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 2.1791 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5817
 Best site-MNIST                         | Epoch:6 | Val Acc: 0.9125
 Best site-USPS                          | Epoch:6 | Val Acc: 0.9091
 Best site-SynthDigits                   | Epoch:6 | Val Acc: 0.4725
 Best site-MNIST_M                       | Epoch:6 | Val Acc: 0.4000
 Best site-SVHN                          | Epoch:6 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 7 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.3230 | Train Acc: 0.9285
 Site-USPS                          | Train Loss: 0.3979 | Train Acc: 0.9030
 Site-SynthDigits                   | Train Loss: 1.5156 | Train Acc: 0.4699
 Site-MNIST_M                       | Train Loss: 1.7649 | Train Acc: 0.4039
 Site-SVHN                          | Train Loss: 2.1820 | Train Acc: 0.1786
Average Train Accuracy: 0.5768
 Site-MNIST                         | Val  Loss: 0.3249 | Val  Acc: 0.9293
 Site-USPS                          | Val  Loss: 0.4050 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5456 | Val  Acc: 0.4615
 Site-MNIST_M                       | Val  Loss: 1.6974 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1458 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5961
 Best site-MNIST                         | Epoch:7 | Val Acc: 0.9293
 Best site-USPS                          | Epoch:7 | Val Acc: 0.9152
 Best site-SynthDigits                   | Epoch:7 | Val Acc: 0.4615
 Best site-MNIST_M                       | Epoch:7 | Val Acc: 0.4600
 Best site-SVHN                          | Epoch:7 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 8 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.2973 | Train Acc: 0.9319
 Site-USPS                          | Train Loss: 0.3765 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.4451 | Train Acc: 0.4863
 Site-MNIST_M                       | Train Loss: 1.6380 | Train Acc: 0.4483
 Site-SVHN                          | Train Loss: 2.2373 | Train Acc: 0.1964
Average Train Accuracy: 0.5941
 Site-MNIST                         | Val  Loss: 0.2966 | Val  Acc: 0.9428
 Site-USPS                          | Val  Loss: 0.3761 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.4767 | Val  Acc: 0.4835
 Site-MNIST_M                       | Val  Loss: 1.6742 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.1842 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6084
 Best site-MNIST                         | Epoch:8 | Val Acc: 0.9428
 Best site-USPS                          | Epoch:8 | Val Acc: 0.9212
 Best site-SynthDigits                   | Epoch:8 | Val Acc: 0.4835
 Best site-MNIST_M                       | Epoch:8 | Val Acc: 0.4800
 Best site-SVHN                          | Epoch:8 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 9 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.2643 | Train Acc: 0.9428
 Site-USPS                          | Train Loss: 0.3608 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.3936 | Train Acc: 0.5410
 Site-MNIST_M                       | Train Loss: 1.6803 | Train Acc: 0.4433
 Site-SVHN                          | Train Loss: 2.1700 | Train Acc: 0.2143
Average Train Accuracy: 0.6098
 Site-MNIST                         | Val  Loss: 0.2684 | Val  Acc: 0.9529
 Site-USPS                          | Val  Loss: 0.3536 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.4123 | Val  Acc: 0.4945
 Site-MNIST_M                       | Val  Loss: 1.6363 | Val  Acc: 0.4600
 Site-SVHN                          | Val  Loss: 2.1814 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6086
 Best site-MNIST                         | Epoch:9 | Val Acc: 0.9529
 Best site-USPS                          | Epoch:9 | Val Acc: 0.9212
 Best site-SynthDigits                   | Epoch:9 | Val Acc: 0.4945
 Best site-MNIST_M                       | Epoch:9 | Val Acc: 0.4600
 Best site-SVHN                          | Epoch:9 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 10 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.2378 | Train Acc: 0.9479
 Site-USPS                          | Train Loss: 0.3287 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.3492 | Train Acc: 0.5328
 Site-MNIST_M                       | Train Loss: 1.5832 | Train Acc: 0.4581
 Site-SVHN                          | Train Loss: 2.1682 | Train Acc: 0.2411
Average Train Accuracy: 0.6187
 Site-MNIST                         | Val  Loss: 0.2440 | Val  Acc: 0.9663
 Site-USPS                          | Val  Loss: 0.3267 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.3740 | Val  Acc: 0.5275
 Site-MNIST_M                       | Val  Loss: 1.6365 | Val  Acc: 0.4800
 Site-SVHN                          | Val  Loss: 2.1487 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6231
 Best site-MNIST                         | Epoch:10 | Val Acc: 0.9663
 Best site-USPS                          | Epoch:10 | Val Acc: 0.9273
 Best site-SynthDigits                   | Epoch:10 | Val Acc: 0.5275
 Best site-MNIST_M                       | Epoch:10 | Val Acc: 0.4800
 Best site-SVHN                          | Epoch:10 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 11 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.2221 | Train Acc: 0.9529
 Site-USPS                          | Train Loss: 0.3246 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.3213 | Train Acc: 0.5410
 Site-MNIST_M                       | Train Loss: 1.5901 | Train Acc: 0.4729
 Site-SVHN                          | Train Loss: 2.1398 | Train Acc: 0.2321
Average Train Accuracy: 0.6246
 Site-MNIST                         | Val  Loss: 0.2242 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.3067 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.3406 | Val  Acc: 0.5385
 Site-MNIST_M                       | Val  Loss: 1.5771 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.1620 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6370
 Best site-MNIST                         | Epoch:11 | Val Acc: 0.9630
 Best site-USPS                          | Epoch:11 | Val Acc: 0.9333
 Best site-SynthDigits                   | Epoch:11 | Val Acc: 0.5385
 Best site-MNIST_M                       | Epoch:11 | Val Acc: 0.5000
 Best site-SVHN                          | Epoch:11 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 12 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.2109 | Train Acc: 0.9537
 Site-USPS                          | Train Loss: 0.2896 | Train Acc: 0.9242
 Site-SynthDigits                   | Train Loss: 1.2653 | Train Acc: 0.5792
 Site-MNIST_M                       | Train Loss: 1.5051 | Train Acc: 0.5025
 Site-SVHN                          | Train Loss: 2.1345 | Train Acc: 0.2679
Average Train Accuracy: 0.6455
 Site-MNIST                         | Val  Loss: 0.2122 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2765 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.2766 | Val  Acc: 0.5385
 Site-MNIST_M                       | Val  Loss: 1.5344 | Val  Acc: 0.5200
 Site-SVHN                          | Val  Loss: 2.1336 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6481
 Best site-MNIST                         | Epoch:12 | Val Acc: 0.9630
 Best site-USPS                          | Epoch:12 | Val Acc: 0.9333
 Best site-SynthDigits                   | Epoch:12 | Val Acc: 0.5385
 Best site-MNIST_M                       | Epoch:12 | Val Acc: 0.5200
 Best site-SVHN                          | Epoch:12 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 13 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.1965 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2835 | Train Acc: 0.9288
 Site-SynthDigits                   | Train Loss: 1.2285 | Train Acc: 0.5956
 Site-MNIST_M                       | Train Loss: 1.5432 | Train Acc: 0.4828
 Site-SVHN                          | Train Loss: 2.1290 | Train Acc: 0.2679
Average Train Accuracy: 0.6464
 Site-MNIST                         | Val  Loss: 0.1964 | Val  Acc: 0.9596
 Site-USPS                          | Val  Loss: 0.2679 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.2492 | Val  Acc: 0.5714
 Site-MNIST_M                       | Val  Loss: 1.5156 | Val  Acc: 0.5200
 Site-SVHN                          | Val  Loss: 2.1184 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6683
 Best site-MNIST                         | Epoch:13 | Val Acc: 0.9596
 Best site-USPS                          | Epoch:13 | Val Acc: 0.9333
 Best site-SynthDigits                   | Epoch:13 | Val Acc: 0.5714
 Best site-MNIST_M                       | Epoch:13 | Val Acc: 0.5200
 Best site-SVHN                          | Epoch:13 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 14 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.1822 | Train Acc: 0.9579
 Site-USPS                          | Train Loss: 0.2723 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.1950 | Train Acc: 0.5820
 Site-MNIST_M                       | Train Loss: 1.4244 | Train Acc: 0.5123
 Site-SVHN                          | Train Loss: 2.0664 | Train Acc: 0.2768
Average Train Accuracy: 0.6510
 Site-MNIST                         | Val  Loss: 0.1825 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2654 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.2143 | Val  Acc: 0.5824
 Site-MNIST_M                       | Val  Loss: 1.4649 | Val  Acc: 0.5400
 Site-SVHN                          | Val  Loss: 2.0815 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6609
============ Train epoch 15 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.1731 | Train Acc: 0.9638
 Site-USPS                          | Train Loss: 0.2662 | Train Acc: 0.9303
 Site-SynthDigits                   | Train Loss: 1.1670 | Train Acc: 0.6120
 Site-MNIST_M                       | Train Loss: 1.4574 | Train Acc: 0.5025
 Site-SVHN                          | Train Loss: 2.0293 | Train Acc: 0.2946
Average Train Accuracy: 0.6607
 Site-MNIST                         | Val  Loss: 0.1726 | Val  Acc: 0.9630
 Site-USPS                          | Val  Loss: 0.2439 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.1819 | Val  Acc: 0.6154
 Site-MNIST_M                       | Val  Loss: 1.4497 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 2.0424 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6858
 Best site-MNIST                         | Epoch:15 | Val Acc: 0.9630
 Best site-USPS                          | Epoch:15 | Val Acc: 0.9333
 Best site-SynthDigits                   | Epoch:15 | Val Acc: 0.6154
 Best site-MNIST_M                       | Epoch:15 | Val Acc: 0.5600
 Best site-SVHN                          | Epoch:15 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 16 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.1636 | Train Acc: 0.9680
 Site-USPS                          | Train Loss: 0.2388 | Train Acc: 0.9364
 Site-SynthDigits                   | Train Loss: 1.1564 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.3291 | Train Acc: 0.5025
 Site-SVHN                          | Train Loss: 2.1072 | Train Acc: 0.2589
Average Train Accuracy: 0.6588
 Site-MNIST                         | Val  Loss: 0.1642 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.2219 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.1799 | Val  Acc: 0.6154
 Site-MNIST_M                       | Val  Loss: 1.4439 | Val  Acc: 0.5600
 Site-SVHN                          | Val  Loss: 2.0205 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6897
 Best site-MNIST                         | Epoch:16 | Val Acc: 0.9764
 Best site-USPS                          | Epoch:16 | Val Acc: 0.9394
 Best site-SynthDigits                   | Epoch:16 | Val Acc: 0.6154
 Best site-MNIST_M                       | Epoch:16 | Val Acc: 0.5600
 Best site-SVHN                          | Epoch:16 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 17 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.1554 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.2272 | Train Acc: 0.9439
 Site-SynthDigits                   | Train Loss: 1.0888 | Train Acc: 0.6721
 Site-MNIST_M                       | Train Loss: 1.4406 | Train Acc: 0.5074
 Site-SVHN                          | Train Loss: 2.0289 | Train Acc: 0.2857
Average Train Accuracy: 0.6761
 Site-MNIST                         | Val  Loss: 0.1554 | Val  Acc: 0.9798
 Site-USPS                          | Val  Loss: 0.2028 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.1156 | Val  Acc: 0.6593
 Site-MNIST_M                       | Val  Loss: 1.4006 | Val  Acc: 0.5400
 Site-SVHN                          | Val  Loss: 2.0058 | Val  Acc: 0.3929
Average Valid Accuracy: 0.7035
 Best site-MNIST                         | Epoch:17 | Val Acc: 0.9798
 Best site-USPS                          | Epoch:17 | Val Acc: 0.9455
 Best site-SynthDigits                   | Epoch:17 | Val Acc: 0.6593
 Best site-MNIST_M                       | Epoch:17 | Val Acc: 0.5400
 Best site-SVHN                          | Epoch:17 | Val Acc: 0.3929
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 18 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.1533 | Train Acc: 0.9697
 Site-USPS                          | Train Loss: 0.2101 | Train Acc: 0.9424
 Site-SynthDigits                   | Train Loss: 1.0764 | Train Acc: 0.6557
 Site-MNIST_M                       | Train Loss: 1.3777 | Train Acc: 0.5567
 Site-SVHN                          | Train Loss: 2.0910 | Train Acc: 0.2768
Average Train Accuracy: 0.6803
 Site-MNIST                         | Val  Loss: 0.1513 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.1899 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.0891 | Val  Acc: 0.6813
 Site-MNIST_M                       | Val  Loss: 1.3614 | Val  Acc: 0.6000
 Site-SVHN                          | Val  Loss: 2.0251 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6966
============ Train epoch 19 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.1390 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.2057 | Train Acc: 0.9500
 Site-SynthDigits                   | Train Loss: 1.0496 | Train Acc: 0.6803
 Site-MNIST_M                       | Train Loss: 1.2807 | Train Acc: 0.5468
 Site-SVHN                          | Train Loss: 2.0854 | Train Acc: 0.2768
Average Train Accuracy: 0.6851
 Site-MNIST                         | Val  Loss: 0.1395 | Val  Acc: 0.9731
 Site-USPS                          | Val  Loss: 0.1872 | Val  Acc: 0.9515
 Site-SynthDigits                   | Val  Loss: 1.0704 | Val  Acc: 0.6923
 Site-MNIST_M                       | Val  Loss: 1.3110 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 1.9865 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6965
============ Train epoch 20 ============
cnt=[1, 1, 1, 2, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.1322 | Train Acc: 0.9739
 Site-USPS                          | Train Loss: 0.1924 | Train Acc: 0.9485
 Site-SynthDigits                   | Train Loss: 0.9882 | Train Acc: 0.6967
 Site-MNIST_M                       | Train Loss: 1.3055 | Train Acc: 0.5665
 Site-SVHN                          | Train Loss: 2.0186 | Train Acc: 0.2768
Average Train Accuracy: 0.6925
 Site-MNIST                         | Val  Loss: 0.1316 | Val  Acc: 0.9798
 Site-USPS                          | Val  Loss: 0.1762 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.0184 | Val  Acc: 0.6813
 Site-MNIST_M                       | Val  Loss: 1.2604 | Val  Acc: 0.5800
 Site-SVHN                          | Val  Loss: 1.9776 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6981
============ Train epoch 21 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.1274 | Train Acc: 0.9765
 Site-USPS                          | Train Loss: 0.1849 | Train Acc: 0.9606
 Site-SynthDigits                   | Train Loss: 0.9692 | Train Acc: 0.6967
 Site-MNIST_M                       | Train Loss: 1.2316 | Train Acc: 0.5567
 Site-SVHN                          | Train Loss: 2.0715 | Train Acc: 0.2768
Average Train Accuracy: 0.6934
 Site-MNIST                         | Val  Loss: 0.1237 | Val  Acc: 0.9697
 Site-USPS                          | Val  Loss: 0.1758 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 0.9824 | Val  Acc: 0.7363
 Site-MNIST_M                       | Val  Loss: 1.2422 | Val  Acc: 0.6000
 Site-SVHN                          | Val  Loss: 2.0530 | Val  Acc: 0.3214
Average Valid Accuracy: 0.7206
 Best site-MNIST                         | Epoch:21 | Val Acc: 0.9697
 Best site-USPS                          | Epoch:21 | Val Acc: 0.9758
 Best site-SynthDigits                   | Epoch:21 | Val Acc: 0.7363
 Best site-MNIST_M                       | Epoch:21 | Val Acc: 0.6000
 Best site-SVHN                          | Epoch:21 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 22 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, ]
 Site-MNIST                         | Train Loss: 0.1202 | Train Acc: 0.9781
 Site-USPS                          | Train Loss: 0.1921 | Train Acc: 0.9606
 Site-SynthDigits                   | Train Loss: 0.9676 | Train Acc: 0.6940
 Site-MNIST_M                       | Train Loss: 1.3195 | Train Acc: 0.5862
 Site-SVHN                          | Train Loss: 1.9902 | Train Acc: 0.2768
Average Train Accuracy: 0.6991
 Site-MNIST                         | Val  Loss: 0.1183 | Val  Acc: 0.9764
 Site-USPS                          | Val  Loss: 0.1790 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 0.9849 | Val  Acc: 0.7363
 Site-MNIST_M                       | Val  Loss: 1.2183 | Val  Acc: 0.6200
 Site-SVHN                          | Val  Loss: 1.9759 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7176
============ Train epoch 23 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.1126 | Train Acc: 0.9798
 Site-USPS                          | Train Loss: 0.1807 | Train Acc: 0.9606
 Site-SynthDigits                   | Train Loss: 0.9425 | Train Acc: 0.7049
 Site-MNIST_M                       | Train Loss: 1.1929 | Train Acc: 0.6108
 Site-SVHN                          | Train Loss: 1.9880 | Train Acc: 0.3214
Average Train Accuracy: 0.7155
 Site-MNIST                         | Val  Loss: 0.1103 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1596 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 0.9677 | Val  Acc: 0.7363
 Site-MNIST_M                       | Val  Loss: 1.1916 | Val  Acc: 0.6200
 Site-SVHN                          | Val  Loss: 1.9253 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7178
============ Train epoch 24 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.1103 | Train Acc: 0.9832
 Site-USPS                          | Train Loss: 0.1663 | Train Acc: 0.9697
 Site-SynthDigits                   | Train Loss: 0.9256 | Train Acc: 0.7104
 Site-MNIST_M                       | Train Loss: 1.2225 | Train Acc: 0.6010
 Site-SVHN                          | Train Loss: 2.0223 | Train Acc: 0.3036
Average Train Accuracy: 0.7136
 Site-MNIST                         | Val  Loss: 0.1080 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1453 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 0.9342 | Val  Acc: 0.7582
 Site-MNIST_M                       | Val  Loss: 1.1651 | Val  Acc: 0.6400
 Site-SVHN                          | Val  Loss: 1.9302 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7298
 Best site-MNIST                         | Epoch:24 | Val Acc: 0.9832
 Best site-USPS                          | Epoch:24 | Val Acc: 0.9818
 Best site-SynthDigits                   | Epoch:24 | Val Acc: 0.7582
 Best site-MNIST_M                       | Epoch:24 | Val Acc: 0.6400
 Best site-SVHN                          | Epoch:24 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 25 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.1031 | Train Acc: 0.9832
 Site-USPS                          | Train Loss: 0.1526 | Train Acc: 0.9742
 Site-SynthDigits                   | Train Loss: 0.8897 | Train Acc: 0.7240
 Site-MNIST_M                       | Train Loss: 1.2464 | Train Acc: 0.6453
 Site-SVHN                          | Train Loss: 2.0081 | Train Acc: 0.2768
Average Train Accuracy: 0.7207
 Site-MNIST                         | Val  Loss: 0.1027 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1340 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 0.8851 | Val  Acc: 0.7692
 Site-MNIST_M                       | Val  Loss: 1.1325 | Val  Acc: 0.6800
 Site-SVHN                          | Val  Loss: 1.9625 | Val  Acc: 0.2500
Average Valid Accuracy: 0.7328
 Best site-MNIST                         | Epoch:25 | Val Acc: 0.9832
 Best site-USPS                          | Epoch:25 | Val Acc: 0.9818
 Best site-SynthDigits                   | Epoch:25 | Val Acc: 0.7692
 Best site-MNIST_M                       | Epoch:25 | Val Acc: 0.6800
 Best site-SVHN                          | Epoch:25 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 26 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0979 | Train Acc: 0.9832
 Site-USPS                          | Train Loss: 0.1400 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 0.8498 | Train Acc: 0.7350
 Site-MNIST_M                       | Train Loss: 1.2355 | Train Acc: 0.6355
 Site-SVHN                          | Train Loss: 2.0302 | Train Acc: 0.2946
Average Train Accuracy: 0.7248
 Site-MNIST                         | Val  Loss: 0.0970 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1331 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 0.8639 | Val  Acc: 0.7692
 Site-MNIST_M                       | Val  Loss: 1.0860 | Val  Acc: 0.6600
 Site-SVHN                          | Val  Loss: 1.9536 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7360
 Best site-MNIST                         | Epoch:26 | Val Acc: 0.9832
 Best site-USPS                          | Epoch:26 | Val Acc: 0.9818
 Best site-SynthDigits                   | Epoch:26 | Val Acc: 0.7692
 Best site-MNIST_M                       | Epoch:26 | Val Acc: 0.6600
 Best site-SVHN                          | Epoch:26 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 27 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0993 | Train Acc: 0.9823
 Site-USPS                          | Train Loss: 0.1435 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 0.8329 | Train Acc: 0.7514
 Site-MNIST_M                       | Train Loss: 1.1191 | Train Acc: 0.6502
 Site-SVHN                          | Train Loss: 2.0067 | Train Acc: 0.3304
Average Train Accuracy: 0.7380
 Site-MNIST                         | Val  Loss: 0.0963 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1318 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 0.8505 | Val  Acc: 0.7692
 Site-MNIST_M                       | Val  Loss: 1.0693 | Val  Acc: 0.6600
 Site-SVHN                          | Val  Loss: 1.8956 | Val  Acc: 0.2500
Average Valid Accuracy: 0.7288
============ Train epoch 28 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
 Site-MNIST                         | Train Loss: 0.0916 | Train Acc: 0.9840
 Site-USPS                          | Train Loss: 0.1417 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 0.8454 | Train Acc: 0.7432
 Site-MNIST_M                       | Train Loss: 1.1414 | Train Acc: 0.6749
 Site-SVHN                          | Train Loss: 2.0166 | Train Acc: 0.3125
Average Train Accuracy: 0.7387
 Site-MNIST                         | Val  Loss: 0.0899 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.1214 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 0.8410 | Val  Acc: 0.7912
 Site-MNIST_M                       | Val  Loss: 1.0633 | Val  Acc: 0.6800
 Site-SVHN                          | Val  Loss: 1.8958 | Val  Acc: 0.3214
Average Valid Accuracy: 0.7515
 Best site-MNIST                         | Epoch:28 | Val Acc: 0.9832
 Best site-USPS                          | Epoch:28 | Val Acc: 0.9818
 Best site-SynthDigits                   | Epoch:28 | Val Acc: 0.7912
 Best site-MNIST_M                       | Epoch:28 | Val Acc: 0.6800
 Best site-SVHN                          | Epoch:28 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 29 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0880 | Train Acc: 0.9874
 Site-USPS                          | Train Loss: 0.1396 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 0.8007 | Train Acc: 0.7732
 Site-MNIST_M                       | Train Loss: 1.1166 | Train Acc: 0.6749
 Site-SVHN                          | Train Loss: 1.9736 | Train Acc: 0.3214
Average Train Accuracy: 0.7471
 Site-MNIST                         | Val  Loss: 0.0849 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.1165 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 0.8233 | Val  Acc: 0.7912
 Site-MNIST_M                       | Val  Loss: 1.0285 | Val  Acc: 0.7000
 Site-SVHN                          | Val  Loss: 1.8764 | Val  Acc: 0.2500
Average Valid Accuracy: 0.7419
============ Train epoch 30 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0861 | Train Acc: 0.9899
 Site-USPS                          | Train Loss: 0.1267 | Train Acc: 0.9818
 Site-SynthDigits                   | Train Loss: 0.8037 | Train Acc: 0.7568
 Site-MNIST_M                       | Train Loss: 1.0610 | Train Acc: 0.6749
 Site-SVHN                          | Train Loss: 1.9559 | Train Acc: 0.2946
Average Train Accuracy: 0.7396
 Site-MNIST                         | Val  Loss: 0.0842 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.1020 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.8089 | Val  Acc: 0.7912
 Site-MNIST_M                       | Val  Loss: 1.0403 | Val  Acc: 0.6800
 Site-SVHN                          | Val  Loss: 1.8834 | Val  Acc: 0.3929
Average Valid Accuracy: 0.7689
 Best site-MNIST                         | Epoch:30 | Val Acc: 0.9865
 Best site-USPS                          | Epoch:30 | Val Acc: 0.9939
 Best site-SynthDigits                   | Epoch:30 | Val Acc: 0.7912
 Best site-MNIST_M                       | Epoch:30 | Val Acc: 0.6800
 Best site-SVHN                          | Epoch:30 | Val Acc: 0.3929
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 31 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0827 | Train Acc: 0.9865
 Site-USPS                          | Train Loss: 0.1253 | Train Acc: 0.9833
 Site-SynthDigits                   | Train Loss: 0.7864 | Train Acc: 0.7705
 Site-MNIST_M                       | Train Loss: 1.0014 | Train Acc: 0.6847
 Site-SVHN                          | Train Loss: 1.9474 | Train Acc: 0.3304
Average Train Accuracy: 0.7511
 Site-MNIST                         | Val  Loss: 0.0809 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0987 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.7875 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 1.0211 | Val  Acc: 0.7000
 Site-SVHN                          | Val  Loss: 1.8211 | Val  Acc: 0.3929
Average Valid Accuracy: 0.7751
 Best site-MNIST                         | Epoch:31 | Val Acc: 0.9865
 Best site-USPS                          | Epoch:31 | Val Acc: 0.9939
 Best site-SynthDigits                   | Epoch:31 | Val Acc: 0.8022
 Best site-MNIST_M                       | Epoch:31 | Val Acc: 0.7000
 Best site-SVHN                          | Epoch:31 | Val Acc: 0.3929
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 32 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0790 | Train Acc: 0.9874
 Site-USPS                          | Train Loss: 0.1185 | Train Acc: 0.9818
 Site-SynthDigits                   | Train Loss: 0.7600 | Train Acc: 0.7732
 Site-MNIST_M                       | Train Loss: 0.9971 | Train Acc: 0.7044
 Site-SVHN                          | Train Loss: 1.9174 | Train Acc: 0.3393
Average Train Accuracy: 0.7572
 Site-MNIST                         | Val  Loss: 0.0778 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0966 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.7752 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 0.9848 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.8362 | Val  Acc: 0.3214
Average Valid Accuracy: 0.7688
============ Train epoch 33 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0759 | Train Acc: 0.9891
 Site-USPS                          | Train Loss: 0.1149 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 0.7509 | Train Acc: 0.7923
 Site-MNIST_M                       | Train Loss: 1.0313 | Train Acc: 0.6897
 Site-SVHN                          | Train Loss: 1.9547 | Train Acc: 0.3393
Average Train Accuracy: 0.7593
 Site-MNIST                         | Val  Loss: 0.0775 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.0942 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.7611 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 0.9784 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.8294 | Val  Acc: 0.3214
Average Valid Accuracy: 0.7681
============ Train epoch 34 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0737 | Train Acc: 0.9899
 Site-USPS                          | Train Loss: 0.1059 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 0.7541 | Train Acc: 0.7596
 Site-MNIST_M                       | Train Loss: 0.9588 | Train Acc: 0.7094
 Site-SVHN                          | Train Loss: 1.9348 | Train Acc: 0.3304
Average Train Accuracy: 0.7548
 Site-MNIST                         | Val  Loss: 0.0749 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0916 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 0.7483 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 0.9441 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.8257 | Val  Acc: 0.3214
Average Valid Accuracy: 0.7683
============ Train epoch 35 ============
cnt=[1, 1, 1, 2, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0718 | Train Acc: 0.9916
 Site-USPS                          | Train Loss: 0.1058 | Train Acc: 0.9833
 Site-SynthDigits                   | Train Loss: 0.7016 | Train Acc: 0.8087
 Site-MNIST_M                       | Train Loss: 1.0433 | Train Acc: 0.7094
 Site-SVHN                          | Train Loss: 1.8808 | Train Acc: 0.3482
Average Train Accuracy: 0.7682
 Site-MNIST                         | Val  Loss: 0.0721 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0902 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.7375 | Val  Acc: 0.8132
 Site-MNIST_M                       | Val  Loss: 0.9333 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.6959 | Val  Acc: 0.3929
Average Valid Accuracy: 0.7860
 Best site-MNIST                         | Epoch:35 | Val Acc: 0.9899
 Best site-USPS                          | Epoch:35 | Val Acc: 0.9939
 Best site-SynthDigits                   | Epoch:35 | Val Acc: 0.8132
 Best site-MNIST_M                       | Epoch:35 | Val Acc: 0.7400
 Best site-SVHN                          | Epoch:35 | Val Acc: 0.3929
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 36 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0680 | Train Acc: 0.9941
 Site-USPS                          | Train Loss: 0.1128 | Train Acc: 0.9879
 Site-SynthDigits                   | Train Loss: 0.6916 | Train Acc: 0.7978
 Site-MNIST_M                       | Train Loss: 0.8903 | Train Acc: 0.7192
 Site-SVHN                          | Train Loss: 1.8621 | Train Acc: 0.3750
Average Train Accuracy: 0.7748
 Site-MNIST                         | Val  Loss: 0.0676 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0850 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.7108 | Val  Acc: 0.8242
 Site-MNIST_M                       | Val  Loss: 0.9190 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.7126 | Val  Acc: 0.4286
Average Valid Accuracy: 0.7953
 Best site-MNIST                         | Epoch:36 | Val Acc: 0.9899
 Best site-USPS                          | Epoch:36 | Val Acc: 0.9939
 Best site-SynthDigits                   | Epoch:36 | Val Acc: 0.8242
 Best site-MNIST_M                       | Epoch:36 | Val Acc: 0.7400
 Best site-SVHN                          | Epoch:36 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 37 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0693 | Train Acc: 0.9907
 Site-USPS                          | Train Loss: 0.1123 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 0.6688 | Train Acc: 0.7978
 Site-MNIST_M                       | Train Loss: 0.9812 | Train Acc: 0.6749
 Site-SVHN                          | Train Loss: 1.8473 | Train Acc: 0.3571
Average Train Accuracy: 0.7620
 Site-MNIST                         | Val  Loss: 0.0670 | Val  Acc: 0.9832
 Site-USPS                          | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.7089 | Val  Acc: 0.8352
 Site-MNIST_M                       | Val  Loss: 0.9162 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.6855 | Val  Acc: 0.4286
Average Valid Accuracy: 0.7974
 Best site-MNIST                         | Epoch:37 | Val Acc: 0.9832
 Best site-USPS                          | Epoch:37 | Val Acc: 1.0000
 Best site-SynthDigits                   | Epoch:37 | Val Acc: 0.8352
 Best site-MNIST_M                       | Epoch:37 | Val Acc: 0.7400
 Best site-SVHN                          | Epoch:37 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 38 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0657 | Train Acc: 0.9916
 Site-USPS                          | Train Loss: 0.0979 | Train Acc: 0.9879
 Site-SynthDigits                   | Train Loss: 0.7129 | Train Acc: 0.7814
 Site-MNIST_M                       | Train Loss: 0.9245 | Train Acc: 0.7340
 Site-SVHN                          | Train Loss: 1.8884 | Train Acc: 0.3482
Average Train Accuracy: 0.7686
 Site-MNIST                         | Val  Loss: 0.0619 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0774 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.7172 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 0.9005 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.7438 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7772
============ Train epoch 39 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0630 | Train Acc: 0.9933
 Site-USPS                          | Train Loss: 0.0948 | Train Acc: 0.9879
 Site-SynthDigits                   | Train Loss: 0.6779 | Train Acc: 0.8142
 Site-MNIST_M                       | Train Loss: 0.9380 | Train Acc: 0.6995
 Site-SVHN                          | Train Loss: 1.8478 | Train Acc: 0.3571
Average Train Accuracy: 0.7704
 Site-MNIST                         | Val  Loss: 0.0596 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6887 | Val  Acc: 0.8352
 Site-MNIST_M                       | Val  Loss: 0.8951 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.7360 | Val  Acc: 0.4643
Average Valid Accuracy: 0.8052
 Best site-MNIST                         | Epoch:39 | Val Acc: 0.9865
 Best site-USPS                          | Epoch:39 | Val Acc: 1.0000
 Best site-SynthDigits                   | Epoch:39 | Val Acc: 0.8352
 Best site-MNIST_M                       | Epoch:39 | Val Acc: 0.7400
 Best site-SVHN                          | Epoch:39 | Val Acc: 0.4643
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 40 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0620 | Train Acc: 0.9933
 Site-USPS                          | Train Loss: 0.0937 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 0.6362 | Train Acc: 0.8197
 Site-MNIST_M                       | Train Loss: 0.9198 | Train Acc: 0.7044
 Site-SVHN                          | Train Loss: 1.7934 | Train Acc: 0.4107
Average Train Accuracy: 0.7835
 Site-MNIST                         | Val  Loss: 0.0608 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0729 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6689 | Val  Acc: 0.8462
 Site-MNIST_M                       | Val  Loss: 0.8465 | Val  Acc: 0.7600
 Site-SVHN                          | Val  Loss: 1.6547 | Val  Acc: 0.4643
Average Valid Accuracy: 0.8121
 Best site-MNIST                         | Epoch:40 | Val Acc: 0.9899
 Best site-USPS                          | Epoch:40 | Val Acc: 1.0000
 Best site-SynthDigits                   | Epoch:40 | Val Acc: 0.8462
 Best site-MNIST_M                       | Epoch:40 | Val Acc: 0.7600
 Best site-SVHN                          | Epoch:40 | Val Acc: 0.4643
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 41 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0604 | Train Acc: 0.9933
 Site-USPS                          | Train Loss: 0.0892 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 0.6344 | Train Acc: 0.8142
 Site-MNIST_M                       | Train Loss: 0.9807 | Train Acc: 0.7291
 Site-SVHN                          | Train Loss: 1.7474 | Train Acc: 0.4375
Average Train Accuracy: 0.7933
 Site-MNIST                         | Val  Loss: 0.0586 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0707 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6685 | Val  Acc: 0.8352
 Site-MNIST_M                       | Val  Loss: 0.8275 | Val  Acc: 0.7600
 Site-SVHN                          | Val  Loss: 1.5466 | Val  Acc: 0.4643
Average Valid Accuracy: 0.8099
============ Train epoch 42 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0573 | Train Acc: 0.9941
 Site-USPS                          | Train Loss: 0.0834 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 0.6258 | Train Acc: 0.8251
 Site-MNIST_M                       | Train Loss: 0.9179 | Train Acc: 0.7094
 Site-SVHN                          | Train Loss: 1.7569 | Train Acc: 0.3839
Average Train Accuracy: 0.7810
 Site-MNIST                         | Val  Loss: 0.0549 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0672 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6584 | Val  Acc: 0.8132
 Site-MNIST_M                       | Val  Loss: 0.8199 | Val  Acc: 0.7600
 Site-SVHN                          | Val  Loss: 1.5304 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8262
 Best site-MNIST                         | Epoch:42 | Val Acc: 0.9865
 Best site-USPS                          | Epoch:42 | Val Acc: 1.0000
 Best site-SynthDigits                   | Epoch:42 | Val Acc: 0.8132
 Best site-MNIST_M                       | Epoch:42 | Val Acc: 0.7600
 Best site-SVHN                          | Epoch:42 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 43 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0568 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0829 | Train Acc: 0.9909
 Site-SynthDigits                   | Train Loss: 0.6052 | Train Acc: 0.8251
 Site-MNIST_M                       | Train Loss: 0.7792 | Train Acc: 0.7241
 Site-SVHN                          | Train Loss: 1.7374 | Train Acc: 0.4464
Average Train Accuracy: 0.7963
 Site-MNIST                         | Val  Loss: 0.0537 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0638 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6437 | Val  Acc: 0.8462
 Site-MNIST_M                       | Val  Loss: 0.8176 | Val  Acc: 0.7600
 Site-SVHN                          | Val  Loss: 1.5538 | Val  Acc: 0.5357
Average Valid Accuracy: 0.8257
============ Train epoch 44 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0566 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0851 | Train Acc: 0.9909
 Site-SynthDigits                   | Train Loss: 0.5963 | Train Acc: 0.8251
 Site-MNIST_M                       | Train Loss: 0.8432 | Train Acc: 0.7192
 Site-SVHN                          | Train Loss: 1.8388 | Train Acc: 0.3661
Average Train Accuracy: 0.7793
 Site-MNIST                         | Val  Loss: 0.0522 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0617 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6358 | Val  Acc: 0.8462
 Site-MNIST_M                       | Val  Loss: 0.7990 | Val  Acc: 0.7400
 Site-SVHN                          | Val  Loss: 1.6065 | Val  Acc: 0.4643
Average Valid Accuracy: 0.8074
============ Train epoch 45 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0551 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0832 | Train Acc: 0.9909
 Site-SynthDigits                   | Train Loss: 0.5790 | Train Acc: 0.8279
 Site-MNIST_M                       | Train Loss: 0.8314 | Train Acc: 0.7537
 Site-SVHN                          | Train Loss: 1.7832 | Train Acc: 0.4018
Average Train Accuracy: 0.7938
 Site-MNIST                         | Val  Loss: 0.0506 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0669 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6201 | Val  Acc: 0.8462
 Site-MNIST_M                       | Val  Loss: 0.7738 | Val  Acc: 0.7600
 Site-SVHN                          | Val  Loss: 1.5688 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8192
============ Train epoch 46 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0540 | Train Acc: 0.9958
 Site-USPS                          | Train Loss: 0.0764 | Train Acc: 0.9955
 Site-SynthDigits                   | Train Loss: 0.5642 | Train Acc: 0.8361
 Site-MNIST_M                       | Train Loss: 0.7648 | Train Acc: 0.7488
 Site-SVHN                          | Train Loss: 1.7252 | Train Acc: 0.4196
Average Train Accuracy: 0.7991
 Site-MNIST                         | Val  Loss: 0.0493 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0590 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6044 | Val  Acc: 0.8462
 Site-MNIST_M                       | Val  Loss: 0.7690 | Val  Acc: 0.7600
 Site-SVHN                          | Val  Loss: 1.5563 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8192
============ Train epoch 47 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0522 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0868 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 0.5742 | Train Acc: 0.8388
 Site-MNIST_M                       | Train Loss: 0.8443 | Train Acc: 0.7537
 Site-SVHN                          | Train Loss: 1.7499 | Train Acc: 0.4464
Average Train Accuracy: 0.8053
 Site-MNIST                         | Val  Loss: 0.0498 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0625 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5772 | Val  Acc: 0.8571
 Site-MNIST_M                       | Val  Loss: 0.7601 | Val  Acc: 0.7600
 Site-SVHN                          | Val  Loss: 1.6144 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8214
============ Train epoch 48 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0513 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0752 | Train Acc: 0.9955
 Site-SynthDigits                   | Train Loss: 0.5910 | Train Acc: 0.8251
 Site-MNIST_M                       | Train Loss: 0.8101 | Train Acc: 0.7635
 Site-SVHN                          | Train Loss: 1.7522 | Train Acc: 0.4107
Average Train Accuracy: 0.7980
 Site-MNIST                         | Val  Loss: 0.0483 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0622 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.6071 | Val  Acc: 0.8571
 Site-MNIST_M                       | Val  Loss: 0.7601 | Val  Acc: 0.7800
 Site-SVHN                          | Val  Loss: 1.6182 | Val  Acc: 0.4643
Average Valid Accuracy: 0.8183
============ Train epoch 49 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0491 | Train Acc: 0.9958
 Site-USPS                          | Train Loss: 0.0706 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 0.5439 | Train Acc: 0.8361
 Site-MNIST_M                       | Train Loss: 0.8402 | Train Acc: 0.7488
 Site-SVHN                          | Train Loss: 1.7841 | Train Acc: 0.4286
Average Train Accuracy: 0.8003
 Site-MNIST                         | Val  Loss: 0.0468 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0552 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5773 | Val  Acc: 0.8462
 Site-MNIST_M                       | Val  Loss: 0.7700 | Val  Acc: 0.7800
 Site-SVHN                          | Val  Loss: 1.6499 | Val  Acc: 0.5357
Average Valid Accuracy: 0.8304
 Best site-MNIST                         | Epoch:49 | Val Acc: 0.9899
 Best site-USPS                          | Epoch:49 | Val Acc: 1.0000
 Best site-SynthDigits                   | Epoch:49 | Val Acc: 0.8462
 Best site-MNIST_M                       | Epoch:49 | Val Acc: 0.7800
 Best site-SVHN                          | Epoch:49 | Val Acc: 0.5357
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 50 ============
cnt=[1, 1, 1, 2, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0477 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0736 | Train Acc: 0.9939
 Site-SynthDigits                   | Train Loss: 0.5570 | Train Acc: 0.8388
 Site-MNIST_M                       | Train Loss: 0.7339 | Train Acc: 0.7586
 Site-SVHN                          | Train Loss: 1.7284 | Train Acc: 0.3839
Average Train Accuracy: 0.7940
 Site-MNIST                         | Val  Loss: 0.0443 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0542 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5605 | Val  Acc: 0.8681
 Site-MNIST_M                       | Val  Loss: 0.7472 | Val  Acc: 0.7800
 Site-SVHN                          | Val  Loss: 1.6367 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8419
 Best site-MNIST                         | Epoch:50 | Val Acc: 0.9899
 Best site-USPS                          | Epoch:50 | Val Acc: 1.0000
 Best site-SynthDigits                   | Epoch:50 | Val Acc: 0.8681
 Best site-MNIST_M                       | Epoch:50 | Val Acc: 0.7800
 Best site-SVHN                          | Epoch:50 | Val Acc: 0.5714
 Test site-MNIST                     (1)| Epoch:50 | Test Acc: 0.9571
 Test site-USPS                      (0)| Epoch:50 | Test Acc: 0.9484
 Test site-SynthDigits               (3)| Epoch:50 | Test Acc: 0.7885
 Test site-MNIST_M                   (2)| Epoch:50 | Test Acc: 0.6217
 Test site-SVHN                      (3)| Epoch:50 | Test Acc: 0.4313
MNIST: 0.9571, USPS: 0.9484, SynthDigits: 0.7885, MNIST_M: 0.6217, SVHN: 0.4313, 
Average Test Accuracy(group): 0.7494, Average Test Accuracy(individual): 0.7494,
domain std=0.2009, cluster std=0.1686, individual std=0.2009, 
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 51 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0467 | Train Acc: 0.9941
 Site-USPS                          | Train Loss: 0.0712 | Train Acc: 0.9939
 Site-SynthDigits                   | Train Loss: 0.5286 | Train Acc: 0.8579
 Site-MNIST_M                       | Train Loss: 0.7917 | Train Acc: 0.7685
 Site-SVHN                          | Train Loss: 1.7322 | Train Acc: 0.4107
Average Train Accuracy: 0.8050
 Site-MNIST                         | Val  Loss: 0.0437 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0576 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5545 | Val  Acc: 0.8571
 Site-MNIST_M                       | Val  Loss: 0.7139 | Val  Acc: 0.8000
 Site-SVHN                          | Val  Loss: 1.6678 | Val  Acc: 0.4643
Average Valid Accuracy: 0.8223
============ Train epoch 52 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0452 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0742 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 0.5011 | Train Acc: 0.8607
 Site-MNIST_M                       | Train Loss: 0.7773 | Train Acc: 0.7291
 Site-SVHN                          | Train Loss: 1.7380 | Train Acc: 0.4375
Average Train Accuracy: 0.8026
 Site-MNIST                         | Val  Loss: 0.0431 | Val  Acc: 0.9966
 Site-USPS                          | Val  Loss: 0.0538 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.5310 | Val  Acc: 0.8571
 Site-MNIST_M                       | Val  Loss: 0.7263 | Val  Acc: 0.8200
 Site-SVHN                          | Val  Loss: 1.5795 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8478
 Best site-MNIST                         | Epoch:52 | Val Acc: 0.9966
 Best site-USPS                          | Epoch:52 | Val Acc: 0.9939
 Best site-SynthDigits                   | Epoch:52 | Val Acc: 0.8571
 Best site-MNIST_M                       | Epoch:52 | Val Acc: 0.8200
 Best site-SVHN                          | Epoch:52 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 53 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0455 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0739 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 0.4899 | Train Acc: 0.8743
 Site-MNIST_M                       | Train Loss: 0.7296 | Train Acc: 0.7783
 Site-SVHN                          | Train Loss: 1.7601 | Train Acc: 0.4196
Average Train Accuracy: 0.8123
 Site-MNIST                         | Val  Loss: 0.0434 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.0526 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.5333 | Val  Acc: 0.8681
 Site-MNIST_M                       | Val  Loss: 0.7137 | Val  Acc: 0.8200
 Site-SVHN                          | Val  Loss: 1.5771 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8494
 Best site-MNIST                         | Epoch:53 | Val Acc: 0.9933
 Best site-USPS                          | Epoch:53 | Val Acc: 0.9939
 Best site-SynthDigits                   | Epoch:53 | Val Acc: 0.8681
 Best site-MNIST_M                       | Epoch:53 | Val Acc: 0.8200
 Best site-SVHN                          | Epoch:53 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 54 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0450 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0672 | Train Acc: 0.9955
 Site-SynthDigits                   | Train Loss: 0.5081 | Train Acc: 0.8552
 Site-MNIST_M                       | Train Loss: 0.8072 | Train Acc: 0.7635
 Site-SVHN                          | Train Loss: 1.6765 | Train Acc: 0.4107
Average Train Accuracy: 0.8040
 Site-MNIST                         | Val  Loss: 0.0422 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.0494 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5345 | Val  Acc: 0.8571
 Site-MNIST_M                       | Val  Loss: 0.7276 | Val  Acc: 0.8200
 Site-SVHN                          | Val  Loss: 1.5587 | Val  Acc: 0.5357
Average Valid Accuracy: 0.8412
============ Train epoch 55 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
 Site-MNIST                         | Train Loss: 0.0426 | Train Acc: 0.9950
 Site-USPS                          | Train Loss: 0.0715 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 0.4931 | Train Acc: 0.8770
 Site-MNIST_M                       | Train Loss: 0.7547 | Train Acc: 0.7685
 Site-SVHN                          | Train Loss: 1.6204 | Train Acc: 0.3839
Average Train Accuracy: 0.8028
 Site-MNIST                         | Val  Loss: 0.0395 | Val  Acc: 0.9899
 Site-USPS                          | Val  Loss: 0.0541 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.5264 | Val  Acc: 0.8681
 Site-MNIST_M                       | Val  Loss: 0.6897 | Val  Acc: 0.8200
 Site-SVHN                          | Val  Loss: 1.5415 | Val  Acc: 0.6071
Average Valid Accuracy: 0.8558
 Best site-MNIST                         | Epoch:55 | Val Acc: 0.9899
 Best site-USPS                          | Epoch:55 | Val Acc: 0.9939
 Best site-SynthDigits                   | Epoch:55 | Val Acc: 0.8681
 Best site-MNIST_M                       | Epoch:55 | Val Acc: 0.8200
 Best site-SVHN                          | Epoch:55 | Val Acc: 0.6071
 Test site-MNIST                     (1)| Epoch:55 | Test Acc: 0.9569
 Test site-USPS                      (2)| Epoch:55 | Test Acc: 0.9462
 Test site-SynthDigits               (0)| Epoch:55 | Test Acc: 0.7971
 Test site-MNIST_M                   (3)| Epoch:55 | Test Acc: 0.6211
 Test site-SVHN                      (0)| Epoch:55 | Test Acc: 0.4339
MNIST: 0.9569, USPS: 0.9462, SynthDigits: 0.7971, MNIST_M: 0.6211, SVHN: 0.4339, 
Average Test Accuracy(group): 0.7511, Average Test Accuracy(individual): 0.7511,
domain std=0.2000, cluster std=0.1667, individual std=0.2000, 
Average Test Accuracy: 0.7511
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 56 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0426 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0677 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 0.4801 | Train Acc: 0.8661
 Site-MNIST_M                       | Train Loss: 0.8236 | Train Acc: 0.7586
 Site-SVHN                          | Train Loss: 1.6680 | Train Acc: 0.4375
Average Train Accuracy: 0.8103
 Site-MNIST                         | Val  Loss: 0.0383 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.0505 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.5109 | Val  Acc: 0.8791
 Site-MNIST_M                       | Val  Loss: 0.6872 | Val  Acc: 0.8000
 Site-SVHN                          | Val  Loss: 1.5362 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8476
 Test site-MNIST                     (1)| Epoch:55 | Test Acc: 0.9566
 Test site-USPS                      (2)| Epoch:55 | Test Acc: 0.9505
 Test site-SynthDigits               (0)| Epoch:55 | Test Acc: 0.8047
 Test site-MNIST_M                   (3)| Epoch:55 | Test Acc: 0.6209
 Test site-SVHN                      (0)| Epoch:55 | Test Acc: 0.4416
MNIST: 0.9566, USPS: 0.9505, SynthDigits: 0.8047, MNIST_M: 0.6209, SVHN: 0.4416, 
Average Test Accuracy(group): 0.7548, Average Test Accuracy(individual): 0.7548,
domain std=0.1988, cluster std=0.1658, individual std=0.1988, 
Average Test Accuracy: 0.7548
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 57 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0393 | Train Acc: 0.9975
 Site-USPS                          | Train Loss: 0.0651 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 0.4781 | Train Acc: 0.8607
 Site-MNIST_M                       | Train Loss: 0.7770 | Train Acc: 0.7734
 Site-SVHN                          | Train Loss: 1.6970 | Train Acc: 0.4554
Average Train Accuracy: 0.8159
 Site-MNIST                         | Val  Loss: 0.0357 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.0528 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5275 | Val  Acc: 0.8571
 Site-MNIST_M                       | Val  Loss: 0.6914 | Val  Acc: 0.8200
 Site-SVHN                          | Val  Loss: 1.5169 | Val  Acc: 0.5357
Average Valid Accuracy: 0.8412
 Test site-MNIST                     (0)| Epoch:56 | Test Acc: 0.9571
 Test site-USPS                      (2)| Epoch:56 | Test Acc: 0.9441
 Test site-SynthDigits               (1)| Epoch:56 | Test Acc: 0.8010
 Test site-MNIST_M                   (3)| Epoch:56 | Test Acc: 0.6191
 Test site-SVHN                      (1)| Epoch:56 | Test Acc: 0.4422
MNIST: 0.9571, USPS: 0.9441, SynthDigits: 0.8010, MNIST_M: 0.6191, SVHN: 0.4422, 
Average Test Accuracy(group): 0.7527, Average Test Accuracy(individual): 0.7527,
domain std=0.1975, cluster std=0.1652, individual std=0.1975, 
Average Test Accuracy: 0.7527
============ Train epoch 58 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0403 | Train Acc: 0.9966
 Site-USPS                          | Train Loss: 0.0592 | Train Acc: 0.9955
 Site-SynthDigits                   | Train Loss: 0.4649 | Train Acc: 0.8825
 Site-MNIST_M                       | Train Loss: 0.7293 | Train Acc: 0.7833
 Site-SVHN                          | Train Loss: 1.6763 | Train Acc: 0.4375
Average Train Accuracy: 0.8191
 Site-MNIST                         | Val  Loss: 0.0356 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.0471 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5128 | Val  Acc: 0.8571
 Site-MNIST_M                       | Val  Loss: 0.6726 | Val  Acc: 0.8000
 Site-SVHN                          | Val  Loss: 1.4939 | Val  Acc: 0.5357
Average Valid Accuracy: 0.8372
 Test site-MNIST                     (1)| Epoch:56 | Test Acc: 0.9560
 Test site-USPS                      (3)| Epoch:56 | Test Acc: 0.9484
 Test site-SynthDigits               (0)| Epoch:56 | Test Acc: 0.8082
 Test site-MNIST_M                   (2)| Epoch:56 | Test Acc: 0.6171
 Test site-SVHN                      (0)| Epoch:56 | Test Acc: 0.4476
MNIST: 0.9560, USPS: 0.9484, SynthDigits: 0.8082, MNIST_M: 0.6171, SVHN: 0.4476, 
Average Test Accuracy(group): 0.7555, Average Test Accuracy(individual): 0.7555,
domain std=0.1970, cluster std=0.1649, individual std=0.1970, 
Average Test Accuracy: 0.7555
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
============ Train epoch 59 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
 Site-MNIST                         | Train Loss: 0.0400 | Train Acc: 0.9975
 Site-USPS                          | Train Loss: 0.0625 | Train Acc: 0.9939
 Site-SynthDigits                   | Train Loss: 0.4474 | Train Acc: 0.8907
 Site-MNIST_M                       | Train Loss: 0.6961 | Train Acc: 0.7833
 Site-SVHN                          | Train Loss: 1.6126 | Train Acc: 0.4464
Average Train Accuracy: 0.8224
 Site-MNIST                         | Val  Loss: 0.0347 | Val  Acc: 0.9933
 Site-USPS                          | Val  Loss: 0.0505 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.4979 | Val  Acc: 0.8791
 Site-MNIST_M                       | Val  Loss: 0.6501 | Val  Acc: 0.8200
 Site-SVHN                          | Val  Loss: 1.4593 | Val  Acc: 0.5357
Average Valid Accuracy: 0.8456
 Test site-MNIST                     (2)| Epoch:58 | Test Acc: 0.9580
 Test site-USPS                      (3)| Epoch:58 | Test Acc: 0.9441
 Test site-SynthDigits               (1)| Epoch:58 | Test Acc: 0.8060
 Test site-MNIST_M                   (0)| Epoch:58 | Test Acc: 0.6206
 Test site-SVHN                      (1)| Epoch:58 | Test Acc: 0.4545
MNIST: 0.9580, USPS: 0.9441, SynthDigits: 0.8060, MNIST_M: 0.6206, SVHN: 0.4545, 
Average Test Accuracy(group): 0.7566, Average Test Accuracy(individual): 0.7566,
domain std=0.1939, cluster std=0.1629, individual std=0.1939, 
Average Test Accuracy: 0.7566
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_distinct/only_dcnet...
===2023-07-02 00:46:40===
===2023-07-02 00:46:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:59 | Test Acc: 0.9580
 Test site-USPS                      | Epoch:59 | Test Acc: 0.9441
 Test site-SynthDigits               | Epoch:59 | Test Acc: 0.8060
 Test site-MNIST_M                   | Epoch:59 | Test Acc: 0.6206
 Test site-SVHN                      | Epoch:59 | Test Acc: 0.4545
MNIST: 0.9580, USPS: 0.9441, SynthDigits: 0.8060, MNIST_M: 0.6206, SVHN: 0.4545, 
Average Test Accuracy(group): 0.7566, Average Test Accuracy(individual): 0.7566,
domain std=0.1939, cluster std=-1.0000, individual std=0.1939, 
