===2023-08-02 16:16:48===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 20
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[35,52,78,117,175,17,38,85,13,68,48,
client_nums=[5,3,2,1,]
len_dataset=[766,236,138,81,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-amazon                    (1) | Train Loss: 2.0803 | Train Acc: 0.3429
 Site-amazon                    (1) | Train Loss: 2.2181 | Train Acc: 0.2115
 Site-amazon                    (1) | Train Loss: 2.1996 | Train Acc: 0.3462
 Site-amazon                    (1) | Train Loss: 2.1331 | Train Acc: 0.2821
 Site-amazon                    (1) | Train Loss: 2.1089 | Train Acc: 0.3771
 Site-webcam                    (0) | Train Loss: 2.1116 | Train Acc: 0.2941
 Site-webcam                    (2) | Train Loss: 2.1845 | Train Acc: 0.1842
 Site-webcam                    (2) | Train Loss: 2.1262 | Train Acc: 0.2588
 Site-caltech                   (3) | Train Loss: 2.1270 | Train Acc: 0.3846
 Site-caltech                   (1) | Train Loss: 2.1012 | Train Acc: 0.3088
 Site-dslr                      (2) | Train Loss: 2.0976 | Train Acc: 0.3125
Average Train Accuracy: 0.3003
 Site-amazon                    (1) | Val  Loss: 2.0777 | Val  Acc: 0.5652
 Site-amazon                    (1) | Val  Loss: 2.0794 | Val  Acc: 0.4706
 Site-amazon                    (1) | Val  Loss: 2.2088 | Val  Acc: 0.2308
 Site-amazon                    (1) | Val  Loss: 2.1734 | Val  Acc: 0.2821
 Site-amazon                    (1) | Val  Loss: 2.1068 | Val  Acc: 0.3504
 Site-webcam                    (0) | Val  Loss: 2.0710 | Val  Acc: 0.4545
 Site-webcam                    (2) | Val  Loss: 2.1557 | Val  Acc: 0.2800
 Site-webcam                    (2) | Val  Loss: 2.1584 | Val  Acc: 0.1930
 Site-caltech                   (3) | Val  Loss: 2.0750 | Val  Acc: 0.4444
 Site-caltech                   (1) | Val  Loss: 2.1438 | Val  Acc: 0.2889
 Site-dslr                      (2) | Val  Loss: 2.1548 | Val  Acc: 0.2500
Average Valid Accuracy: 0.3464
 Best site-amazon                   (1)  | Epoch:0 | Val Acc: 0.5652
 Best site-amazon                   (1)  | Epoch:0 | Val Acc: 0.4706
 Best site-amazon                   (1)  | Epoch:0 | Val Acc: 0.2308
 Best site-amazon                   (1)  | Epoch:0 | Val Acc: 0.2821
 Best site-amazon                   (1)  | Epoch:0 | Val Acc: 0.3504
 Best site-webcam                   (0)  | Epoch:0 | Val Acc: 0.4545
 Best site-webcam                   (2)  | Epoch:0 | Val Acc: 0.2800
 Best site-webcam                   (2)  | Epoch:0 | Val Acc: 0.1930
 Best site-caltech                  (3)  | Epoch:0 | Val Acc: 0.4444
 Best site-caltech                  (1)  | Epoch:0 | Val Acc: 0.2889
 Best site-dslr                     (2)  | Epoch:0 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-amazon                    (0) | Train Loss: 1.8653 | Train Acc: 0.6000
 Site-amazon                    (0) | Train Loss: 1.9727 | Train Acc: 0.5962
 Site-amazon                    (0) | Train Loss: 1.8436 | Train Acc: 0.6410
 Site-amazon                    (0) | Train Loss: 1.9151 | Train Acc: 0.6667
 Site-amazon                    (0) | Train Loss: 1.8770 | Train Acc: 0.6857
 Site-webcam                    (3) | Train Loss: 1.9652 | Train Acc: 0.5294
 Site-webcam                    (1) | Train Loss: 1.9456 | Train Acc: 0.5789
 Site-webcam                    (1) | Train Loss: 1.8890 | Train Acc: 0.6353
 Site-caltech                   (2) | Train Loss: 1.9279 | Train Acc: 0.6154
 Site-caltech                   (0) | Train Loss: 1.8798 | Train Acc: 0.5735
 Site-dslr                      (1) | Train Loss: 1.8606 | Train Acc: 0.5208
Average Train Accuracy: 0.6039
 Site-amazon                    (0) | Val  Loss: 1.9365 | Val  Acc: 0.6957
 Site-amazon                    (0) | Val  Loss: 1.9072 | Val  Acc: 0.7059
 Site-amazon                    (0) | Val  Loss: 1.9975 | Val  Acc: 0.5000
 Site-amazon                    (0) | Val  Loss: 1.9525 | Val  Acc: 0.6026
 Site-amazon                    (0) | Val  Loss: 1.8793 | Val  Acc: 0.7179
 Site-webcam                    (3) | Val  Loss: 1.8125 | Val  Acc: 0.7273
 Site-webcam                    (1) | Val  Loss: 1.8618 | Val  Acc: 0.7200
 Site-webcam                    (1) | Val  Loss: 1.9416 | Val  Acc: 0.5614
 Site-caltech                   (2) | Val  Loss: 1.9134 | Val  Acc: 0.6667
 Site-caltech                   (0) | Val  Loss: 1.8779 | Val  Acc: 0.6000
 Site-dslr                      (1) | Val  Loss: 1.8965 | Val  Acc: 0.4688
Average Valid Accuracy: 0.6333
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.6957
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.7059
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.5000
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.6026
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.7179
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.7273
 Best site-webcam                   (1)  | Epoch:1 | Val Acc: 0.7200
 Best site-webcam                   (1)  | Epoch:1 | Val Acc: 0.5614
 Best site-caltech                  (2)  | Epoch:1 | Val Acc: 0.6667
 Best site-caltech                  (0)  | Epoch:1 | Val Acc: 0.6000
 Best site-dslr                     (1)  | Epoch:1 | Val Acc: 0.4688
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 2, 4, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-amazon                    (0) | Train Loss: 1.5728 | Train Acc: 0.8857
 Site-amazon                    (3) | Train Loss: 1.6773 | Train Acc: 0.6731
 Site-amazon                    (3) | Train Loss: 1.5502 | Train Acc: 0.7821
 Site-amazon                    (3) | Train Loss: 1.5784 | Train Acc: 0.7949
 Site-amazon                    (3) | Train Loss: 1.6003 | Train Acc: 0.8000
 Site-webcam                    (2) | Train Loss: 1.6402 | Train Acc: 0.8824
 Site-webcam                    (2) | Train Loss: 1.6728 | Train Acc: 0.7632
 Site-webcam                    (2) | Train Loss: 1.6362 | Train Acc: 0.7412
 Site-caltech                   (1) | Train Loss: 1.5888 | Train Acc: 0.7692
 Site-caltech                   (1) | Train Loss: 1.5732 | Train Acc: 0.7794
 Site-dslr                      (2) | Train Loss: 1.6068 | Train Acc: 0.8125
Average Train Accuracy: 0.7894
 Site-amazon                    (0) | Val  Loss: 1.6009 | Val  Acc: 0.7826
 Site-amazon                    (3) | Val  Loss: 1.6152 | Val  Acc: 0.7353
 Site-amazon                    (3) | Val  Loss: 1.6913 | Val  Acc: 0.6538
 Site-amazon                    (3) | Val  Loss: 1.5969 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 1.5417 | Val  Acc: 0.8205
 Site-webcam                    (2) | Val  Loss: 1.6180 | Val  Acc: 0.7273
 Site-webcam                    (2) | Val  Loss: 1.6360 | Val  Acc: 0.7200
 Site-webcam                    (2) | Val  Loss: 1.6813 | Val  Acc: 0.7018
 Site-caltech                   (1) | Val  Loss: 1.5614 | Val  Acc: 0.7778
 Site-caltech                   (1) | Val  Loss: 1.6129 | Val  Acc: 0.6889
 Site-dslr                      (2) | Val  Loss: 1.6364 | Val  Acc: 0.7812
Average Valid Accuracy: 0.7417
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7826
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.7353
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.6538
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.7692
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.8205
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.7273
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.7200
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.7018
 Best site-caltech                  (1)  | Epoch:2 | Val Acc: 0.7778
 Best site-caltech                  (1)  | Epoch:2 | Val Acc: 0.6889
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.7812
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-amazon                    (1) | Train Loss: 1.2992 | Train Acc: 0.8857
 Site-amazon                    (1) | Train Loss: 1.4465 | Train Acc: 0.8077
 Site-amazon                    (1) | Train Loss: 1.3470 | Train Acc: 0.8333
 Site-amazon                    (1) | Train Loss: 1.3143 | Train Acc: 0.8718
 Site-amazon                    (1) | Train Loss: 1.2794 | Train Acc: 0.8686
 Site-webcam                    (2) | Train Loss: 1.4430 | Train Acc: 0.9412
 Site-webcam                    (2) | Train Loss: 1.3766 | Train Acc: 0.9211
 Site-webcam                    (2) | Train Loss: 1.3606 | Train Acc: 0.8824
 Site-caltech                   (3) | Train Loss: 1.3764 | Train Acc: 0.8462
 Site-caltech                   (1) | Train Loss: 1.2826 | Train Acc: 0.8971
 Site-dslr                      (0) | Train Loss: 1.3884 | Train Acc: 0.8542
Average Train Accuracy: 0.8736
 Site-amazon                    (1) | Val  Loss: 1.3494 | Val  Acc: 0.6957
 Site-amazon                    (1) | Val  Loss: 1.2615 | Val  Acc: 0.8529
 Site-amazon                    (1) | Val  Loss: 1.4182 | Val  Acc: 0.7885
 Site-amazon                    (1) | Val  Loss: 1.3481 | Val  Acc: 0.8718
 Site-amazon                    (1) | Val  Loss: 1.2473 | Val  Acc: 0.9145
 Site-webcam                    (2) | Val  Loss: 1.3562 | Val  Acc: 0.8182
 Site-webcam                    (2) | Val  Loss: 1.3121 | Val  Acc: 0.9600
 Site-webcam                    (2) | Val  Loss: 1.3781 | Val  Acc: 0.8246
 Site-caltech                   (3) | Val  Loss: 1.3447 | Val  Acc: 0.7778
 Site-caltech                   (1) | Val  Loss: 1.2995 | Val  Acc: 0.9333
 Site-dslr                      (0) | Val  Loss: 1.3231 | Val  Acc: 0.9062
Average Valid Accuracy: 0.8494
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.6957
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.8529
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.7885
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.8718
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.9145
 Best site-webcam                   (2)  | Epoch:3 | Val Acc: 0.8182
 Best site-webcam                   (2)  | Epoch:3 | Val Acc: 0.9600
 Best site-webcam                   (2)  | Epoch:3 | Val Acc: 0.8246
 Best site-caltech                  (3)  | Epoch:3 | Val Acc: 0.7778
 Best site-caltech                  (1)  | Epoch:3 | Val Acc: 0.9333
 Best site-dslr                     (0)  | Epoch:3 | Val Acc: 0.9062
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-amazon                    (0) | Train Loss: 1.0685 | Train Acc: 0.9429
 Site-amazon                    (0) | Train Loss: 1.2347 | Train Acc: 0.7692
 Site-amazon                    (0) | Train Loss: 1.1519 | Train Acc: 0.8846
 Site-amazon                    (0) | Train Loss: 1.0751 | Train Acc: 0.8889
 Site-amazon                    (0) | Train Loss: 1.0537 | Train Acc: 0.9086
 Site-webcam                    (1) | Train Loss: 1.1777 | Train Acc: 0.9412
 Site-webcam                    (2) | Train Loss: 1.2294 | Train Acc: 0.8947
 Site-webcam                    (2) | Train Loss: 1.1995 | Train Acc: 0.8824
 Site-caltech                   (2) | Train Loss: 1.1333 | Train Acc: 0.8462
 Site-caltech                   (3) | Train Loss: 1.0572 | Train Acc: 0.9118
 Site-dslr                      (1) | Train Loss: 1.1514 | Train Acc: 0.9375
Average Train Accuracy: 0.8916
 Site-amazon                    (0) | Val  Loss: 1.1223 | Val  Acc: 0.9130
 Site-amazon                    (0) | Val  Loss: 1.0450 | Val  Acc: 0.8824
 Site-amazon                    (0) | Val  Loss: 1.1816 | Val  Acc: 0.8654
 Site-amazon                    (0) | Val  Loss: 1.1193 | Val  Acc: 0.8974
 Site-amazon                    (0) | Val  Loss: 1.0273 | Val  Acc: 0.8803
 Site-webcam                    (1) | Val  Loss: 1.0937 | Val  Acc: 0.9091
 Site-webcam                    (2) | Val  Loss: 1.1368 | Val  Acc: 0.8800
 Site-webcam                    (2) | Val  Loss: 1.2111 | Val  Acc: 0.8246
 Site-caltech                   (2) | Val  Loss: 1.0548 | Val  Acc: 0.8889
 Site-caltech                   (3) | Val  Loss: 1.0793 | Val  Acc: 0.9333
 Site-dslr                      (1) | Val  Loss: 1.0851 | Val  Acc: 0.9375
Average Valid Accuracy: 0.8920
 Best site-amazon                   (0)  | Epoch:4 | Val Acc: 0.9130
 Best site-amazon                   (0)  | Epoch:4 | Val Acc: 0.8824
 Best site-amazon                   (0)  | Epoch:4 | Val Acc: 0.8654
 Best site-amazon                   (0)  | Epoch:4 | Val Acc: 0.8974
 Best site-amazon                   (0)  | Epoch:4 | Val Acc: 0.8803
 Best site-webcam                   (1)  | Epoch:4 | Val Acc: 0.9091
 Best site-webcam                   (2)  | Epoch:4 | Val Acc: 0.8800
 Best site-webcam                   (2)  | Epoch:4 | Val Acc: 0.8246
 Best site-caltech                  (2)  | Epoch:4 | Val Acc: 0.8889
 Best site-caltech                  (3)  | Epoch:4 | Val Acc: 0.9333
 Best site-dslr                     (1)  | Epoch:4 | Val Acc: 0.9375
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-amazon                    (1) | Train Loss: 0.8637 | Train Acc: 0.9714
 Site-amazon                    (1) | Train Loss: 1.0377 | Train Acc: 0.8462
 Site-amazon                    (1) | Train Loss: 0.9248 | Train Acc: 0.9487
 Site-amazon                    (1) | Train Loss: 0.8850 | Train Acc: 0.8889
 Site-amazon                    (1) | Train Loss: 0.8590 | Train Acc: 0.9371
 Site-webcam                    (0) | Train Loss: 0.9837 | Train Acc: 0.9412
 Site-webcam                    (3) | Train Loss: 1.0670 | Train Acc: 0.9211
 Site-webcam                    (0) | Train Loss: 0.9225 | Train Acc: 0.9647
 Site-caltech                   (2) | Train Loss: 1.0126 | Train Acc: 0.9231
 Site-caltech                   (1) | Train Loss: 1.0662 | Train Acc: 0.9559
 Site-dslr                      (2) | Train Loss: 0.9765 | Train Acc: 0.8750
Average Train Accuracy: 0.9248
 Site-amazon                    (1) | Val  Loss: 0.9711 | Val  Acc: 0.8696
 Site-amazon                    (1) | Val  Loss: 0.8380 | Val  Acc: 0.9412
 Site-amazon                    (1) | Val  Loss: 1.0505 | Val  Acc: 0.8654
 Site-amazon                    (1) | Val  Loss: 0.9775 | Val  Acc: 0.8974
 Site-amazon                    (1) | Val  Loss: 0.8393 | Val  Acc: 0.9145
 Site-webcam                    (0) | Val  Loss: 0.9041 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 1.0035 | Val  Acc: 0.8800
 Site-webcam                    (0) | Val  Loss: 1.0379 | Val  Acc: 0.8772
 Site-caltech                   (2) | Val  Loss: 0.8344 | Val  Acc: 0.8889
 Site-caltech                   (1) | Val  Loss: 0.8916 | Val  Acc: 0.9111
 Site-dslr                      (2) | Val  Loss: 0.8780 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9104
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.8696
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.9412
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.8654
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.8974
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.9145
 Best site-webcam                   (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-webcam                   (3)  | Epoch:5 | Val Acc: 0.8800
 Best site-webcam                   (0)  | Epoch:5 | Val Acc: 0.8772
 Best site-caltech                  (2)  | Epoch:5 | Val Acc: 0.8889
 Best site-caltech                  (1)  | Epoch:5 | Val Acc: 0.9111
 Best site-dslr                     (2)  | Epoch:5 | Val Acc: 0.9688
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-amazon                    (1) | Train Loss: 0.6813 | Train Acc: 0.9429
 Site-amazon                    (1) | Train Loss: 0.8795 | Train Acc: 0.8846
 Site-amazon                    (1) | Train Loss: 0.7687 | Train Acc: 0.9359
 Site-amazon                    (1) | Train Loss: 0.7137 | Train Acc: 0.9145
 Site-amazon                    (1) | Train Loss: 0.6979 | Train Acc: 0.9429
 Site-webcam                    (0) | Train Loss: 0.8073 | Train Acc: 0.9412
 Site-webcam                    (2) | Train Loss: 0.8448 | Train Acc: 0.9211
 Site-webcam                    (2) | Train Loss: 0.8142 | Train Acc: 0.9647
 Site-caltech                   (3) | Train Loss: 0.8726 | Train Acc: 0.8462
 Site-caltech                   (1) | Train Loss: 1.0646 | Train Acc: 0.9412
 Site-dslr                      (0) | Train Loss: 0.8201 | Train Acc: 0.9583
Average Train Accuracy: 0.9267
 Site-amazon                    (1) | Val  Loss: 0.7664 | Val  Acc: 0.8696
 Site-amazon                    (1) | Val  Loss: 0.7758 | Val  Acc: 0.9118
 Site-amazon                    (1) | Val  Loss: 0.8608 | Val  Acc: 0.8077
 Site-amazon                    (1) | Val  Loss: 0.7843 | Val  Acc: 0.8974
 Site-amazon                    (1) | Val  Loss: 0.7045 | Val  Acc: 0.9316
 Site-webcam                    (0) | Val  Loss: 0.8377 | Val  Acc: 1.0000
 Site-webcam                    (2) | Val  Loss: 0.8442 | Val  Acc: 0.8400
 Site-webcam                    (2) | Val  Loss: 0.8714 | Val  Acc: 0.8596
 Site-caltech                   (3) | Val  Loss: 0.7190 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.7822 | Val  Acc: 0.9111
 Site-dslr                      (0) | Val  Loss: 0.7633 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9117
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.8696
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.9118
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.8077
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.8974
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.9316
 Best site-webcam                   (0)  | Epoch:6 | Val Acc: 1.0000
 Best site-webcam                   (2)  | Epoch:6 | Val Acc: 0.8400
 Best site-webcam                   (2)  | Epoch:6 | Val Acc: 0.8596
 Best site-caltech                  (3)  | Epoch:6 | Val Acc: 1.0000
 Best site-caltech                  (1)  | Epoch:6 | Val Acc: 0.9111
 Best site-dslr                     (0)  | Epoch:6 | Val Acc: 1.0000
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-amazon                    (0) | Train Loss: 0.5429 | Train Acc: 0.9714
 Site-amazon                    (0) | Train Loss: 0.8017 | Train Acc: 0.8269
 Site-amazon                    (0) | Train Loss: 0.5606 | Train Acc: 0.9359
 Site-amazon                    (0) | Train Loss: 0.6256 | Train Acc: 0.9231
 Site-amazon                    (2) | Train Loss: 0.5745 | Train Acc: 0.9429
 Site-webcam                    (3) | Train Loss: 0.6910 | Train Acc: 1.0000
 Site-webcam                    (3) | Train Loss: 0.7453 | Train Acc: 0.9211
 Site-webcam                    (3) | Train Loss: 0.6539 | Train Acc: 0.9529
 Site-caltech                   (2) | Train Loss: 0.7708 | Train Acc: 0.8462
 Site-caltech                   (0) | Train Loss: 0.6626 | Train Acc: 0.9559
 Site-dslr                      (1) | Train Loss: 0.7085 | Train Acc: 0.9375
Average Train Accuracy: 0.9285
 Site-amazon                    (0) | Val  Loss: 0.6613 | Val  Acc: 0.9130
 Site-amazon                    (0) | Val  Loss: 0.6292 | Val  Acc: 0.8824
 Site-amazon                    (0) | Val  Loss: 0.7663 | Val  Acc: 0.8654
 Site-amazon                    (0) | Val  Loss: 0.6356 | Val  Acc: 0.9359
 Site-amazon                    (2) | Val  Loss: 0.5421 | Val  Acc: 0.9744
 Site-webcam                    (3) | Val  Loss: 0.8063 | Val  Acc: 0.9091
 Site-webcam                    (3) | Val  Loss: 0.6303 | Val  Acc: 0.9600
 Site-webcam                    (3) | Val  Loss: 0.7642 | Val  Acc: 0.8947
 Site-caltech                   (2) | Val  Loss: 0.7017 | Val  Acc: 0.8889
 Site-caltech                   (0) | Val  Loss: 0.6503 | Val  Acc: 0.9556
 Site-dslr                      (1) | Val  Loss: 0.6835 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9226
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 0.9130
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 0.8824
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 0.8654
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 0.9359
 Best site-amazon                   (2)  | Epoch:7 | Val Acc: 0.9744
 Best site-webcam                   (3)  | Epoch:7 | Val Acc: 0.9091
 Best site-webcam                   (3)  | Epoch:7 | Val Acc: 0.9600
 Best site-webcam                   (3)  | Epoch:7 | Val Acc: 0.8947
 Best site-caltech                  (2)  | Epoch:7 | Val Acc: 0.8889
 Best site-caltech                  (0)  | Epoch:7 | Val Acc: 0.9556
 Best site-dslr                     (1)  | Epoch:7 | Val Acc: 0.9688
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-amazon                    (0) | Train Loss: 0.4967 | Train Acc: 0.9429
 Site-amazon                    (2) | Train Loss: 0.6722 | Train Acc: 0.9038
 Site-amazon                    (2) | Train Loss: 0.5432 | Train Acc: 0.9487
 Site-amazon                    (0) | Train Loss: 0.5205 | Train Acc: 0.9145
 Site-amazon                    (0) | Train Loss: 0.4769 | Train Acc: 0.9714
 Site-webcam                    (1) | Train Loss: 0.6176 | Train Acc: 0.9412
 Site-webcam                    (1) | Train Loss: 0.6043 | Train Acc: 0.9211
 Site-webcam                    (1) | Train Loss: 0.5910 | Train Acc: 0.9647
 Site-caltech                   (0) | Train Loss: 0.6022 | Train Acc: 0.8462
 Site-caltech                   (0) | Train Loss: 0.4178 | Train Acc: 0.9118
 Site-dslr                      (3) | Train Loss: 0.6026 | Train Acc: 0.9167
Average Train Accuracy: 0.9257
 Site-amazon                    (0) | Val  Loss: 0.5853 | Val  Acc: 0.9130
 Site-amazon                    (2) | Val  Loss: 0.5775 | Val  Acc: 0.8824
 Site-amazon                    (2) | Val  Loss: 0.6459 | Val  Acc: 0.9038
 Site-amazon                    (0) | Val  Loss: 0.5643 | Val  Acc: 0.9103
 Site-amazon                    (0) | Val  Loss: 0.4759 | Val  Acc: 0.9487
 Site-webcam                    (1) | Val  Loss: 0.6073 | Val  Acc: 0.9091
 Site-webcam                    (1) | Val  Loss: 0.6354 | Val  Acc: 0.8800
 Site-webcam                    (1) | Val  Loss: 0.6143 | Val  Acc: 0.9649
 Site-caltech                   (0) | Val  Loss: 0.6235 | Val  Acc: 0.8889
 Site-caltech                   (0) | Val  Loss: 0.5278 | Val  Acc: 0.9778
 Site-dslr                      (3) | Val  Loss: 0.5935 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9225
============ Train epoch 9 ============
cnt=[3, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-amazon                    (2) | Train Loss: 0.3964 | Train Acc: 0.9714
 Site-amazon                    (0) | Train Loss: 0.6248 | Train Acc: 0.8846
 Site-amazon                    (2) | Train Loss: 0.4755 | Train Acc: 0.9487
 Site-amazon                    (2) | Train Loss: 0.4175 | Train Acc: 0.9402
 Site-amazon                    (2) | Train Loss: 0.4138 | Train Acc: 0.9543
 Site-webcam                    (1) | Train Loss: 0.4715 | Train Acc: 1.0000
 Site-webcam                    (1) | Train Loss: 0.5340 | Train Acc: 0.9211
 Site-webcam                    (1) | Train Loss: 0.5127 | Train Acc: 0.9176
 Site-caltech                   (0) | Train Loss: 0.5653 | Train Acc: 0.8462
 Site-caltech                   (0) | Train Loss: 0.4306 | Train Acc: 0.9706
 Site-dslr                      (3) | Train Loss: 0.5635 | Train Acc: 0.9583
Average Train Accuracy: 0.9375
 Site-amazon                    (2) | Val  Loss: 0.4838 | Val  Acc: 0.9130
 Site-amazon                    (0) | Val  Loss: 0.4422 | Val  Acc: 0.9118
 Site-amazon                    (2) | Val  Loss: 0.5449 | Val  Acc: 0.9038
 Site-amazon                    (2) | Val  Loss: 0.4816 | Val  Acc: 0.9231
 Site-amazon                    (2) | Val  Loss: 0.3907 | Val  Acc: 0.9744
 Site-webcam                    (1) | Val  Loss: 0.5369 | Val  Acc: 0.9091
 Site-webcam                    (1) | Val  Loss: 0.6003 | Val  Acc: 0.9200
 Site-webcam                    (1) | Val  Loss: 0.5160 | Val  Acc: 0.9474
 Site-caltech                   (0) | Val  Loss: 0.4760 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.5060 | Val  Acc: 0.9333
 Site-dslr                      (3) | Val  Loss: 0.4698 | Val  Acc: 0.9375
Average Valid Accuracy: 0.9339
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.9130
 Best site-amazon                   (0)  | Epoch:9 | Val Acc: 0.9118
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.9038
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.9231
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.9744
 Best site-webcam                   (1)  | Epoch:9 | Val Acc: 0.9091
 Best site-webcam                   (1)  | Epoch:9 | Val Acc: 0.9200
 Best site-webcam                   (1)  | Epoch:9 | Val Acc: 0.9474
 Best site-caltech                  (0)  | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                  (0)  | Epoch:9 | Val Acc: 0.9333
 Best site-dslr                     (3)  | Epoch:9 | Val Acc: 0.9375
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-amazon                    (1) | Train Loss: 0.3171 | Train Acc: 0.9714
 Site-amazon                    (1) | Train Loss: 0.5413 | Train Acc: 0.9231
 Site-amazon                    (1) | Train Loss: 0.3608 | Train Acc: 0.9744
 Site-amazon                    (1) | Train Loss: 0.4025 | Train Acc: 0.9231
 Site-amazon                    (1) | Train Loss: 0.3419 | Train Acc: 0.9657
 Site-webcam                    (0) | Train Loss: 0.5090 | Train Acc: 0.9412
 Site-webcam                    (0) | Train Loss: 0.5026 | Train Acc: 0.9211
 Site-webcam                    (0) | Train Loss: 0.4377 | Train Acc: 0.9412
 Site-caltech                   (3) | Train Loss: 0.4799 | Train Acc: 0.9231
 Site-caltech                   (1) | Train Loss: 0.3067 | Train Acc: 0.9559
 Site-dslr                      (2) | Train Loss: 0.4560 | Train Acc: 0.9375
Average Train Accuracy: 0.9434
 Site-amazon                    (1) | Val  Loss: 0.3736 | Val  Acc: 0.9565
 Site-amazon                    (1) | Val  Loss: 0.4073 | Val  Acc: 0.9118
 Site-amazon                    (1) | Val  Loss: 0.5193 | Val  Acc: 0.9038
 Site-amazon                    (1) | Val  Loss: 0.4116 | Val  Acc: 0.9359
 Site-amazon                    (1) | Val  Loss: 0.3602 | Val  Acc: 0.9487
 Site-webcam                    (0) | Val  Loss: 0.3275 | Val  Acc: 1.0000
 Site-webcam                    (0) | Val  Loss: 0.3698 | Val  Acc: 1.0000
 Site-webcam                    (0) | Val  Loss: 0.5182 | Val  Acc: 0.9123
 Site-caltech                   (3) | Val  Loss: 0.4363 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.4270 | Val  Acc: 0.9556
 Site-dslr                      (2) | Val  Loss: 0.3643 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9568
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9565
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9118
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9038
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9359
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9487
 Best site-webcam                   (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-webcam                   (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-webcam                   (0)  | Epoch:10 | Val Acc: 0.9123
 Best site-caltech                  (3)  | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                  (1)  | Epoch:10 | Val Acc: 0.9556
 Best site-dslr                     (2)  | Epoch:10 | Val Acc: 1.0000
 Test site-amazon                    (1)| Epoch:10 | Test Acc: 0.9427
 Test site-webcam                    (0)| Epoch:10 | Test Acc: 0.9153
 Test site-caltech                   (3)| Epoch:10 | Test Acc: 0.9378
 Test site-dslr                      (2)| Epoch:10 | Test Acc: 1.0000
amazon: 0.9427, webcam: 0.9153, caltech: 0.9378, dslr: 1.0000, 
Average Test Accuracy(group): 0.9489, Average Test Accuracy(individual): 0.9395,
domain std=0.0312, cluster std=0.0313, individual std=0.0223, 
Average Test Accuracy: 0.9489
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 2, 3, 5, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-amazon                    (0) | Train Loss: 0.3010 | Train Acc: 0.9714
 Site-amazon                    (3) | Train Loss: 0.5253 | Train Acc: 0.8846
 Site-amazon                    (3) | Train Loss: 0.3508 | Train Acc: 0.9487
 Site-amazon                    (3) | Train Loss: 0.3492 | Train Acc: 0.9402
 Site-amazon                    (3) | Train Loss: 0.2821 | Train Acc: 0.9600
 Site-webcam                    (2) | Train Loss: 0.4344 | Train Acc: 1.0000
 Site-webcam                    (1) | Train Loss: 0.4635 | Train Acc: 0.9211
 Site-webcam                    (2) | Train Loss: 0.4244 | Train Acc: 0.9765
 Site-caltech                   (3) | Train Loss: 0.4650 | Train Acc: 0.8462
 Site-caltech                   (2) | Train Loss: 0.2453 | Train Acc: 0.9706
 Site-dslr                      (1) | Train Loss: 0.4360 | Train Acc: 0.9375
Average Train Accuracy: 0.9415
 Site-amazon                    (0) | Val  Loss: 0.3368 | Val  Acc: 0.9565
 Site-amazon                    (3) | Val  Loss: 0.3724 | Val  Acc: 0.9412
 Site-amazon                    (3) | Val  Loss: 0.4851 | Val  Acc: 0.9038
 Site-amazon                    (3) | Val  Loss: 0.3562 | Val  Acc: 0.9359
 Site-amazon                    (3) | Val  Loss: 0.2849 | Val  Acc: 0.9658
 Site-webcam                    (2) | Val  Loss: 0.3200 | Val  Acc: 1.0000
 Site-webcam                    (1) | Val  Loss: 0.4629 | Val  Acc: 0.9600
 Site-webcam                    (2) | Val  Loss: 0.4100 | Val  Acc: 0.9825
 Site-caltech                   (3) | Val  Loss: 0.4590 | Val  Acc: 0.8889
 Site-caltech                   (2) | Val  Loss: 0.3525 | Val  Acc: 0.9778
 Site-dslr                      (1) | Val  Loss: 0.3700 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9528
 Test site-amazon                    (0)| Epoch:10 | Test Acc: 0.9427
 Test site-webcam                    (2)| Epoch:10 | Test Acc: 0.9153
 Test site-caltech                   (3)| Epoch:10 | Test Acc: 0.9422
 Test site-dslr                      (1)| Epoch:10 | Test Acc: 1.0000
amazon: 0.9427, webcam: 0.9153, caltech: 0.9422, dslr: 1.0000, 
Average Test Accuracy(group): 0.9500, Average Test Accuracy(individual): 0.9403,
domain std=0.0309, cluster std=0.0118, individual std=0.0223, 
Average Test Accuracy: 0.9500
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 12 ============
cnt=[1, 6, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-amazon                    (1) | Train Loss: 0.2192 | Train Acc: 0.9714
 Site-amazon                    (1) | Train Loss: 0.4376 | Train Acc: 0.9231
 Site-amazon                    (1) | Train Loss: 0.3461 | Train Acc: 0.9487
 Site-amazon                    (1) | Train Loss: 0.3259 | Train Acc: 0.9060
 Site-amazon                    (1) | Train Loss: 0.2840 | Train Acc: 0.9600
 Site-webcam                    (2) | Train Loss: 0.3927 | Train Acc: 0.9412
 Site-webcam                    (3) | Train Loss: 0.4142 | Train Acc: 0.9211
 Site-webcam                    (3) | Train Loss: 0.3507 | Train Acc: 0.9529
 Site-caltech                   (0) | Train Loss: 0.4146 | Train Acc: 0.8462
 Site-caltech                   (1) | Train Loss: 0.2250 | Train Acc: 0.9559
 Site-dslr                      (2) | Train Loss: 0.4099 | Train Acc: 0.9583
Average Train Accuracy: 0.9350
 Site-amazon                    (1) | Val  Loss: 0.3338 | Val  Acc: 0.9130
 Site-amazon                    (1) | Val  Loss: 0.3740 | Val  Acc: 0.9118
 Site-amazon                    (1) | Val  Loss: 0.4322 | Val  Acc: 0.8654
 Site-amazon                    (1) | Val  Loss: 0.3868 | Val  Acc: 0.9231
 Site-amazon                    (1) | Val  Loss: 0.2496 | Val  Acc: 0.9573
 Site-webcam                    (2) | Val  Loss: 0.2724 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 0.3414 | Val  Acc: 0.9600
 Site-webcam                    (3) | Val  Loss: 0.3427 | Val  Acc: 0.9825
 Site-caltech                   (0) | Val  Loss: 0.3485 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.3135 | Val  Acc: 0.9556
 Site-dslr                      (2) | Val  Loss: 0.3050 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9488
 Test site-amazon                    (1)| Epoch:11 | Test Acc: 0.9479
 Test site-webcam                    (2)| Epoch:11 | Test Acc: 0.9322
 Test site-caltech                   (0)| Epoch:11 | Test Acc: 0.9422
 Test site-dslr                      (2)| Epoch:11 | Test Acc: 1.0000
amazon: 0.9479, webcam: 0.9322, caltech: 0.9422, dslr: 1.0000, 
Average Test Accuracy(group): 0.9556, Average Test Accuracy(individual): 0.9473,
domain std=0.0263, cluster std=0.0123, individual std=0.0179, 
Average Test Accuracy: 0.9556
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-amazon                    (0) | Train Loss: 0.2452 | Train Acc: 0.9429
 Site-amazon                    (2) | Train Loss: 0.4634 | Train Acc: 0.8654
 Site-amazon                    (2) | Train Loss: 0.3430 | Train Acc: 0.9231
 Site-amazon                    (2) | Train Loss: 0.2719 | Train Acc: 0.9487
 Site-amazon                    (2) | Train Loss: 0.2367 | Train Acc: 0.9714
 Site-webcam                    (1) | Train Loss: 0.3821 | Train Acc: 0.9412
 Site-webcam                    (1) | Train Loss: 0.3936 | Train Acc: 0.9211
 Site-webcam                    (1) | Train Loss: 0.3566 | Train Acc: 0.9412
 Site-caltech                   (0) | Train Loss: 0.5188 | Train Acc: 0.9231
 Site-caltech                   (0) | Train Loss: 0.2858 | Train Acc: 0.9559
 Site-dslr                      (3) | Train Loss: 0.3648 | Train Acc: 0.9583
Average Train Accuracy: 0.9357
 Site-amazon                    (0) | Val  Loss: 0.3406 | Val  Acc: 0.9565
 Site-amazon                    (2) | Val  Loss: 0.2875 | Val  Acc: 0.9118
 Site-amazon                    (2) | Val  Loss: 0.4270 | Val  Acc: 0.8846
 Site-amazon                    (2) | Val  Loss: 0.3516 | Val  Acc: 0.9487
 Site-amazon                    (2) | Val  Loss: 0.2313 | Val  Acc: 0.9573
 Site-webcam                    (1) | Val  Loss: 0.4189 | Val  Acc: 0.9091
 Site-webcam                    (1) | Val  Loss: 0.3499 | Val  Acc: 1.0000
 Site-webcam                    (1) | Val  Loss: 0.3538 | Val  Acc: 0.9474
 Site-caltech                   (0) | Val  Loss: 0.3331 | Val  Acc: 0.8889
 Site-caltech                   (0) | Val  Loss: 0.2694 | Val  Acc: 1.0000
 Site-dslr                      (3) | Val  Loss: 0.3141 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9430
 Test site-amazon                    (0)| Epoch:12 | Test Acc: 0.9479
 Test site-webcam                    (1)| Epoch:12 | Test Acc: 0.9322
 Test site-caltech                   (0)| Epoch:12 | Test Acc: 0.9422
 Test site-dslr                      (3)| Epoch:12 | Test Acc: 1.0000
amazon: 0.9479, webcam: 0.9322, caltech: 0.9422, dslr: 1.0000, 
Average Test Accuracy(group): 0.9556, Average Test Accuracy(individual): 0.9473,
domain std=0.0263, cluster std=0.0260, individual std=0.0179, 
Average Test Accuracy: 0.9556
============ Train epoch 14 ============
cnt=[5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-amazon                    (1) | Train Loss: 0.2383 | Train Acc: 0.9714
 Site-amazon                    (0) | Train Loss: 0.4181 | Train Acc: 0.9231
 Site-amazon                    (0) | Train Loss: 0.2413 | Train Acc: 0.9487
 Site-amazon                    (0) | Train Loss: 0.2858 | Train Acc: 0.9231
 Site-amazon                    (0) | Train Loss: 0.2332 | Train Acc: 0.9657
 Site-webcam                    (3) | Train Loss: 0.3469 | Train Acc: 0.9412
 Site-webcam                    (1) | Train Loss: 0.3322 | Train Acc: 0.9474
 Site-webcam                    (1) | Train Loss: 0.3212 | Train Acc: 0.9765
 Site-caltech                   (3) | Train Loss: 0.3480 | Train Acc: 0.8462
 Site-caltech                   (0) | Train Loss: 0.1982 | Train Acc: 0.9412
 Site-dslr                      (2) | Train Loss: 0.3431 | Train Acc: 0.9583
Average Train Accuracy: 0.9402
 Site-amazon                    (1) | Val  Loss: 0.3320 | Val  Acc: 0.8696
 Site-amazon                    (0) | Val  Loss: 0.2279 | Val  Acc: 0.9412
 Site-amazon                    (0) | Val  Loss: 0.3582 | Val  Acc: 0.9038
 Site-amazon                    (0) | Val  Loss: 0.3684 | Val  Acc: 0.8974
 Site-amazon                    (0) | Val  Loss: 0.2085 | Val  Acc: 0.9744
 Site-webcam                    (3) | Val  Loss: 0.2615 | Val  Acc: 0.9091
 Site-webcam                    (1) | Val  Loss: 0.3198 | Val  Acc: 0.9600
 Site-webcam                    (1) | Val  Loss: 0.2861 | Val  Acc: 0.9825
 Site-caltech                   (3) | Val  Loss: 0.2687 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.2706 | Val  Acc: 0.9556
 Site-dslr                      (2) | Val  Loss: 0.2512 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9420
 Test site-amazon                    (1)| Epoch:12 | Test Acc: 0.9479
 Test site-webcam                    (3)| Epoch:12 | Test Acc: 0.9322
 Test site-caltech                   (3)| Epoch:12 | Test Acc: 0.9422
 Test site-dslr                      (2)| Epoch:12 | Test Acc: 1.0000
amazon: 0.9479, webcam: 0.9322, caltech: 0.9422, dslr: 1.0000, 
Average Test Accuracy(group): 0.9556, Average Test Accuracy(individual): 0.9473,
domain std=0.0263, cluster std=0.0261, individual std=0.0179, 
Average Test Accuracy: 0.9556
============ Train epoch 15 ============
cnt=[3, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-amazon                    (1) | Train Loss: 0.1698 | Train Acc: 0.9714
 Site-amazon                    (1) | Train Loss: 0.4065 | Train Acc: 0.8846
 Site-amazon                    (1) | Train Loss: 0.2506 | Train Acc: 0.9744
 Site-amazon                    (1) | Train Loss: 0.2426 | Train Acc: 0.9487
 Site-amazon                    (1) | Train Loss: 0.2120 | Train Acc: 0.9657
 Site-webcam                    (0) | Train Loss: 0.3155 | Train Acc: 1.0000
 Site-webcam                    (3) | Train Loss: 0.3405 | Train Acc: 0.9474
 Site-webcam                    (3) | Train Loss: 0.2510 | Train Acc: 0.9765
 Site-caltech                   (0) | Train Loss: 0.3162 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.1731 | Train Acc: 0.9706
 Site-dslr                      (2) | Train Loss: 0.3213 | Train Acc: 0.9375
Average Train Accuracy: 0.9615
 Site-amazon                    (1) | Val  Loss: 0.2551 | Val  Acc: 0.9565
 Site-amazon                    (1) | Val  Loss: 0.2559 | Val  Acc: 0.9412
 Site-amazon                    (1) | Val  Loss: 0.3475 | Val  Acc: 0.9231
 Site-amazon                    (1) | Val  Loss: 0.2635 | Val  Acc: 0.9103
 Site-amazon                    (1) | Val  Loss: 0.1994 | Val  Acc: 0.9744
 Site-webcam                    (0) | Val  Loss: 0.2340 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 0.2535 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 0.3026 | Val  Acc: 0.9825
 Site-caltech                   (0) | Val  Loss: 0.2954 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.2248 | Val  Acc: 0.9556
 Site-dslr                      (2) | Val  Loss: 0.2490 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9676
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.9565
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.9412
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.9231
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.9103
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.9744
 Best site-webcam                   (0)  | Epoch:15 | Val Acc: 1.0000
 Best site-webcam                   (3)  | Epoch:15 | Val Acc: 1.0000
 Best site-webcam                   (3)  | Epoch:15 | Val Acc: 0.9825
 Best site-caltech                  (0)  | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                  (0)  | Epoch:15 | Val Acc: 0.9556
 Best site-dslr                     (2)  | Epoch:15 | Val Acc: 1.0000
 Test site-amazon                    (1)| Epoch:15 | Test Acc: 0.9479
 Test site-webcam                    (0)| Epoch:15 | Test Acc: 0.9322
 Test site-caltech                   (0)| Epoch:15 | Test Acc: 0.9422
 Test site-dslr                      (2)| Epoch:15 | Test Acc: 1.0000
amazon: 0.9479, webcam: 0.9322, caltech: 0.9422, dslr: 1.0000, 
Average Test Accuracy(group): 0.9556, Average Test Accuracy(individual): 0.9473,
domain std=0.0263, cluster std=0.0267, individual std=0.0179, 
Average Test Accuracy: 0.9556
============ Train epoch 16 ============
cnt=[3, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-amazon                    (2) | Train Loss: 0.1658 | Train Acc: 0.9714
 Site-amazon                    (2) | Train Loss: 0.3911 | Train Acc: 0.9038
 Site-amazon                    (0) | Train Loss: 0.1717 | Train Acc: 0.9359
 Site-amazon                    (0) | Train Loss: 0.2223 | Train Acc: 0.9573
 Site-amazon                    (2) | Train Loss: 0.1857 | Train Acc: 0.9714
 Site-webcam                    (1) | Train Loss: 0.3291 | Train Acc: 0.8824
 Site-webcam                    (1) | Train Loss: 0.3120 | Train Acc: 0.9211
 Site-webcam                    (1) | Train Loss: 0.2269 | Train Acc: 0.9765
 Site-caltech                   (1) | Train Loss: 0.3228 | Train Acc: 0.9231
 Site-caltech                   (0) | Train Loss: 0.1766 | Train Acc: 0.9559
 Site-dslr                      (3) | Train Loss: 0.2807 | Train Acc: 0.9375
Average Train Accuracy: 0.9397
 Site-amazon                    (2) | Val  Loss: 0.2052 | Val  Acc: 0.9565
 Site-amazon                    (2) | Val  Loss: 0.3062 | Val  Acc: 0.9118
 Site-amazon                    (0) | Val  Loss: 0.3574 | Val  Acc: 0.9231
 Site-amazon                    (0) | Val  Loss: 0.2397 | Val  Acc: 0.9359
 Site-amazon                    (2) | Val  Loss: 0.1675 | Val  Acc: 0.9829
 Site-webcam                    (1) | Val  Loss: 0.2427 | Val  Acc: 0.9091
 Site-webcam                    (1) | Val  Loss: 0.2559 | Val  Acc: 1.0000
 Site-webcam                    (1) | Val  Loss: 0.2814 | Val  Acc: 0.9474
 Site-caltech                   (1) | Val  Loss: 0.3671 | Val  Acc: 0.8889
 Site-caltech                   (0) | Val  Loss: 0.2374 | Val  Acc: 0.9778
 Site-dslr                      (3) | Val  Loss: 0.2114 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9456
 Test site-amazon                    (2)| Epoch:15 | Test Acc: 0.9479
 Test site-webcam                    (1)| Epoch:15 | Test Acc: 0.9322
 Test site-caltech                   (1)| Epoch:15 | Test Acc: 0.9422
 Test site-dslr                      (3)| Epoch:15 | Test Acc: 1.0000
amazon: 0.9479, webcam: 0.9322, caltech: 0.9422, dslr: 1.0000, 
Average Test Accuracy(group): 0.9556, Average Test Accuracy(individual): 0.9473,
domain std=0.0263, cluster std=0.0252, individual std=0.0179, 
Average Test Accuracy: 0.9556
============ Train epoch 17 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-amazon                    (0) | Train Loss: 0.1421 | Train Acc: 0.9714
 Site-amazon                    (0) | Train Loss: 0.3856 | Train Acc: 0.9231
 Site-amazon                    (0) | Train Loss: 0.2223 | Train Acc: 0.9615
 Site-amazon                    (0) | Train Loss: 0.2328 | Train Acc: 0.9402
 Site-amazon                    (0) | Train Loss: 0.1865 | Train Acc: 0.9657
 Site-webcam                    (1) | Train Loss: 0.2244 | Train Acc: 1.0000
 Site-webcam                    (2) | Train Loss: 0.2957 | Train Acc: 0.9474
 Site-webcam                    (2) | Train Loss: 0.1761 | Train Acc: 0.9647
 Site-caltech                   (1) | Train Loss: 0.3607 | Train Acc: 0.8462
 Site-caltech                   (2) | Train Loss: 0.1357 | Train Acc: 0.9559
 Site-dslr                      (3) | Train Loss: 0.2445 | Train Acc: 0.9583
Average Train Accuracy: 0.9486
 Site-amazon                    (0) | Val  Loss: 0.2217 | Val  Acc: 0.9565
 Site-amazon                    (0) | Val  Loss: 0.2794 | Val  Acc: 0.9412
 Site-amazon                    (0) | Val  Loss: 0.3037 | Val  Acc: 0.9038
 Site-amazon                    (0) | Val  Loss: 0.2412 | Val  Acc: 0.9487
 Site-amazon                    (0) | Val  Loss: 0.1821 | Val  Acc: 0.9402
 Site-webcam                    (1) | Val  Loss: 0.2328 | Val  Acc: 1.0000
 Site-webcam                    (2) | Val  Loss: 0.3305 | Val  Acc: 0.8800
 Site-webcam                    (2) | Val  Loss: 0.2530 | Val  Acc: 0.9649
 Site-caltech                   (1) | Val  Loss: 0.2910 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.2494 | Val  Acc: 0.9556
 Site-dslr                      (3) | Val  Loss: 0.2363 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9509
 Test site-amazon                    (0)| Epoch:15 | Test Acc: 0.9479
 Test site-webcam                    (1)| Epoch:15 | Test Acc: 0.9322
 Test site-caltech                   (1)| Epoch:15 | Test Acc: 0.9422
 Test site-dslr                      (3)| Epoch:15 | Test Acc: 1.0000
amazon: 0.9479, webcam: 0.9322, caltech: 0.9422, dslr: 1.0000, 
Average Test Accuracy(group): 0.9556, Average Test Accuracy(individual): 0.9473,
domain std=0.0263, cluster std=0.0263, individual std=0.0179, 
Average Test Accuracy: 0.9556
============ Train epoch 18 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-amazon                    (2) | Train Loss: 0.1343 | Train Acc: 0.9714
 Site-amazon                    (0) | Train Loss: 0.3728 | Train Acc: 0.9038
 Site-amazon                    (2) | Train Loss: 0.1958 | Train Acc: 0.9615
 Site-amazon                    (0) | Train Loss: 0.1852 | Train Acc: 0.9487
 Site-amazon                    (0) | Train Loss: 0.1662 | Train Acc: 0.9714
 Site-webcam                    (3) | Train Loss: 0.2656 | Train Acc: 0.9412
 Site-webcam                    (1) | Train Loss: 0.2512 | Train Acc: 0.9474
 Site-webcam                    (1) | Train Loss: 0.2881 | Train Acc: 0.9412
 Site-caltech                   (0) | Train Loss: 0.2940 | Train Acc: 0.9231
 Site-caltech                   (0) | Train Loss: 0.1491 | Train Acc: 0.9706
 Site-dslr                      (1) | Train Loss: 0.2345 | Train Acc: 0.9375
Average Train Accuracy: 0.9471
 Site-amazon                    (2) | Val  Loss: 0.2927 | Val  Acc: 0.9565
 Site-amazon                    (0) | Val  Loss: 0.1797 | Val  Acc: 0.9706
 Site-amazon                    (2) | Val  Loss: 0.3054 | Val  Acc: 0.9231
 Site-amazon                    (0) | Val  Loss: 0.2554 | Val  Acc: 0.9487
 Site-amazon                    (0) | Val  Loss: 0.1568 | Val  Acc: 0.9658
 Site-webcam                    (3) | Val  Loss: 0.2301 | Val  Acc: 1.0000
 Site-webcam                    (1) | Val  Loss: 0.2464 | Val  Acc: 0.9600
 Site-webcam                    (1) | Val  Loss: 0.2300 | Val  Acc: 0.9825
 Site-caltech                   (0) | Val  Loss: 0.2780 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.1849 | Val  Acc: 0.9778
 Site-dslr                      (1) | Val  Loss: 0.1957 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9685
 Best site-amazon                   (2)  | Epoch:18 | Val Acc: 0.9565
 Best site-amazon                   (0)  | Epoch:18 | Val Acc: 0.9706
 Best site-amazon                   (2)  | Epoch:18 | Val Acc: 0.9231
 Best site-amazon                   (0)  | Epoch:18 | Val Acc: 0.9487
 Best site-amazon                   (0)  | Epoch:18 | Val Acc: 0.9658
 Best site-webcam                   (3)  | Epoch:18 | Val Acc: 1.0000
 Best site-webcam                   (1)  | Epoch:18 | Val Acc: 0.9600
 Best site-webcam                   (1)  | Epoch:18 | Val Acc: 0.9825
 Best site-caltech                  (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-caltech                  (0)  | Epoch:18 | Val Acc: 0.9778
 Best site-dslr                     (1)  | Epoch:18 | Val Acc: 0.9688
 Test site-amazon                    (2)| Epoch:18 | Test Acc: 0.9531
 Test site-webcam                    (3)| Epoch:18 | Test Acc: 0.9322
 Test site-caltech                   (0)| Epoch:18 | Test Acc: 0.9467
 Test site-dslr                      (1)| Epoch:18 | Test Acc: 1.0000
amazon: 0.9531, webcam: 0.9322, caltech: 0.9467, dslr: 1.0000, 
Average Test Accuracy(group): 0.9580, Average Test Accuracy(individual): 0.9505,
domain std=0.0254, cluster std=0.0091, individual std=0.0179, 
Average Test Accuracy: 0.9580
 Saving the gmap checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-amazon                    (0) | Train Loss: 0.1449 | Train Acc: 0.9714
 Site-amazon                    (2) | Train Loss: 0.3937 | Train Acc: 0.9038
 Site-amazon                    (2) | Train Loss: 0.2333 | Train Acc: 0.9487
 Site-amazon                    (0) | Train Loss: 0.1776 | Train Acc: 0.9573
 Site-amazon                    (3) | Train Loss: 0.1354 | Train Acc: 0.9714
 Site-webcam                    (1) | Train Loss: 0.2814 | Train Acc: 0.8824
 Site-webcam                    (1) | Train Loss: 0.2061 | Train Acc: 0.9737
 Site-webcam                    (1) | Train Loss: 0.2114 | Train Acc: 0.9647
 Site-caltech                   (1) | Train Loss: 0.2833 | Train Acc: 0.8462
 Site-caltech                   (3) | Train Loss: 0.3105 | Train Acc: 0.9559
 Site-dslr                      (1) | Train Loss: 0.2216 | Train Acc: 1.0000
Average Train Accuracy: 0.9432
 Site-amazon                    (0) | Val  Loss: 0.1917 | Val  Acc: 0.9565
 Site-amazon                    (2) | Val  Loss: 0.1513 | Val  Acc: 1.0000
 Site-amazon                    (2) | Val  Loss: 0.2736 | Val  Acc: 0.9231
 Site-amazon                    (0) | Val  Loss: 0.2430 | Val  Acc: 0.9103
 Site-amazon                    (3) | Val  Loss: 0.1653 | Val  Acc: 0.9744
 Site-webcam                    (1) | Val  Loss: 0.1903 | Val  Acc: 1.0000
 Site-webcam                    (1) | Val  Loss: 0.1565 | Val  Acc: 1.0000
 Site-webcam                    (1) | Val  Loss: 0.2098 | Val  Acc: 0.9825
 Site-caltech                   (1) | Val  Loss: 0.2388 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.2087 | Val  Acc: 0.9556
 Site-dslr                      (1) | Val  Loss: 0.1453 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9729
 Best site-amazon                   (0)  | Epoch:19 | Val Acc: 0.9565
 Best site-amazon                   (2)  | Epoch:19 | Val Acc: 1.0000
 Best site-amazon                   (2)  | Epoch:19 | Val Acc: 0.9231
 Best site-amazon                   (0)  | Epoch:19 | Val Acc: 0.9103
 Best site-amazon                   (3)  | Epoch:19 | Val Acc: 0.9744
 Best site-webcam                   (1)  | Epoch:19 | Val Acc: 1.0000
 Best site-webcam                   (1)  | Epoch:19 | Val Acc: 1.0000
 Best site-webcam                   (1)  | Epoch:19 | Val Acc: 0.9825
 Best site-caltech                  (1)  | Epoch:19 | Val Acc: 1.0000
 Best site-caltech                  (3)  | Epoch:19 | Val Acc: 0.9556
 Best site-dslr                     (1)  | Epoch:19 | Val Acc: 1.0000
 Test site-amazon                    (0)| Epoch:19 | Test Acc: 0.9531
 Test site-webcam                    (1)| Epoch:19 | Test Acc: 0.9322
 Test site-caltech                   (1)| Epoch:19 | Test Acc: 0.9467
 Test site-dslr                      (1)| Epoch:19 | Test Acc: 1.0000
amazon: 0.9531, webcam: 0.9322, caltech: 0.9467, dslr: 1.0000, 
Average Test Accuracy(group): 0.9580, Average Test Accuracy(individual): 0.9505,
domain std=0.0254, cluster std=0.0020, individual std=0.0179, 
Average Test Accuracy: 0.9580
===2023-08-02 16:40:09===
===2023-08-02 16:40:12===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[35,52,78,117,175,17,38,85,13,68,48,
client_nums=[5,3,2,1,]
len_dataset=[766,236,138,81,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (2)| Epoch:18 | Test Acc: 0.9531
 Test site-webcam                    (3)| Epoch:18 | Test Acc: 0.9322
 Test site-caltech                   (0)| Epoch:18 | Test Acc: 0.9467
 Test site-dslr                      (1)| Epoch:18 | Test Acc: 1.0000
amazon: 0.9531, webcam: 0.9322, caltech: 0.9467, dslr: 1.0000, 
Average Test Accuracy(group): 0.9580, Average Test Accuracy(individual): 0.9505,
domain std=0.0254, cluster std=0.0091, individual std=0.0179, 
