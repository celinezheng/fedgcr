===2023-08-01 20:19:25===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[17,29,49,83,142,33,57,97,41,69,64,
client_nums=[5,3,2,1,]
len_dataset=[537,315,185,108,]
domain number = 4
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.9833 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 2.0324 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 2.2427 | Train Acc: 0.0408
 Site-Clipart                       | Train Loss: 2.0508 | Train Acc: 0.3855
 Site-Clipart                       | Train Loss: 1.6588 | Train Acc: 0.9296
 Site-Art                           | Train Loss: 1.8668 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 2.0834 | Train Acc: 0.4912
 Site-Art                           | Train Loss: 1.7432 | Train Acc: 0.8866
 Site-RealWorld                     | Train Loss: 1.8619 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.9709 | Train Acc: 0.5507
 Site-Product                       | Train Loss: 1.9641 | Train Acc: 0.8594
Average Train Accuracy: 0.6570
 Site-Clipart                       | Val  Loss: 1.6450 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.5560 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.6296 | Val  Acc: 0.8125
 Site-Clipart                       | Val  Loss: 1.8266 | Val  Acc: 0.5636
 Site-Clipart                       | Val  Loss: 1.9971 | Val  Acc: 0.3617
 Site-Art                           | Val  Loss: 1.5966 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.7585 | Val  Acc: 0.8158
 Site-Art                           | Val  Loss: 1.6738 | Val  Acc: 0.6462
 Site-RealWorld                     | Val  Loss: 2.1076 | Val  Acc: 0.2593
 Site-RealWorld                     | Val  Loss: 2.0443 | Val  Acc: 0.4348
 Site-Product                       | Val  Loss: 2.1042 | Val  Acc: 0.4651
Average Valid Accuracy: 0.6690
 Best site-Clipart                   | Epoch:0 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:0 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.8125
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.5636
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3617
 Best site-Art                       | Epoch:0 | Val Acc: 1.0000
 Best site-Art                       | Epoch:0 | Val Acc: 0.8158
 Best site-Art                       | Epoch:0 | Val Acc: 0.6462
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.2593
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.4348
 Best site-Product                   | Epoch:0 | Val Acc: 0.4651
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 1.7870 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.8751 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 2.1229 | Train Acc: 0.1429
 Site-Clipart                       | Train Loss: 1.7113 | Train Acc: 0.5060
 Site-Clipart                       | Train Loss: 1.2451 | Train Acc: 0.9718
 Site-Art                           | Train Loss: 1.5186 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.8890 | Train Acc: 0.5614
 Site-Art                           | Train Loss: 1.3074 | Train Acc: 0.9691
 Site-RealWorld                     | Train Loss: 1.5461 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.8502 | Train Acc: 0.7391
 Site-Product                       | Train Loss: 1.6737 | Train Acc: 0.8750
Average Train Accuracy: 0.7028
 Site-Clipart                       | Val  Loss: 1.1608 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.0039 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.1147 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 1.3902 | Val  Acc: 0.8000
 Site-Clipart                       | Val  Loss: 1.6101 | Val  Acc: 0.6383
 Site-Art                           | Val  Loss: 1.0252 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3434 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.2867 | Val  Acc: 0.7385
 Site-RealWorld                     | Val  Loss: 1.9005 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.7766 | Val  Acc: 0.6957
 Site-Product                       | Val  Loss: 1.8958 | Val  Acc: 0.6047
Average Valid Accuracy: 0.8245
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:1 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6383
 Best site-Art                       | Epoch:1 | Val Acc: 1.0000
 Best site-Art                       | Epoch:1 | Val Acc: 0.9737
 Best site-Art                       | Epoch:1 | Val Acc: 0.7385
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.7407
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.6957
 Best site-Product                   | Epoch:1 | Val Acc: 0.6047
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 1.6262 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.7225 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 2.0134 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.4230 | Train Acc: 0.5542
 Site-Clipart                       | Train Loss: 0.8337 | Train Acc: 0.9718
 Site-Art                           | Train Loss: 1.2404 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.7059 | Train Acc: 0.6140
 Site-Art                           | Train Loss: 0.9439 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.2492 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.6678 | Train Acc: 0.7826
 Site-Product                       | Train Loss: 1.3996 | Train Acc: 0.9219
Average Train Accuracy: 0.7295
 Site-Clipart                       | Val  Loss: 0.8102 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6496 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.7558 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 1.0813 | Val  Acc: 0.8909
 Site-Clipart                       | Val  Loss: 1.3720 | Val  Acc: 0.6277
 Site-Art                           | Val  Loss: 0.6016 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0101 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.0462 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.6965 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.5609 | Val  Acc: 0.7391
 Site-Product                       | Val  Loss: 1.6955 | Val  Acc: 0.6744
Average Valid Accuracy: 0.8545
 Best site-Clipart                   | Epoch:2 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:2 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8909
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6277
 Best site-Art                       | Epoch:2 | Val Acc: 1.0000
 Best site-Art                       | Epoch:2 | Val Acc: 0.9737
 Best site-Art                       | Epoch:2 | Val Acc: 0.7846
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.7407
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.7391
 Best site-Product                   | Epoch:2 | Val Acc: 0.6744
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 1.4206 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.6548 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9794 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 1.2391 | Train Acc: 0.6747
 Site-Clipart                       | Train Loss: 0.6402 | Train Acc: 0.9789
 Site-Art                           | Train Loss: 0.9603 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.5609 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 0.7432 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.9475 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3527 | Train Acc: 0.8551
 Site-Product                       | Train Loss: 1.1696 | Train Acc: 0.9531
Average Train Accuracy: 0.7637
 Site-Clipart                       | Val  Loss: 0.5818 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4709 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5112 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.8250 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.1495 | Val  Acc: 0.7340
 Site-Art                           | Val  Loss: 0.4302 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8176 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.8026 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.5076 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 1.4030 | Val  Acc: 0.7391
 Site-Product                       | Val  Loss: 1.5236 | Val  Acc: 0.7442
Average Valid Accuracy: 0.8840
 Best site-Clipart                   | Epoch:3 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:3 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7340
 Best site-Art                       | Epoch:3 | Val Acc: 1.0000
 Best site-Art                       | Epoch:3 | Val Acc: 0.9737
 Best site-Art                       | Epoch:3 | Val Acc: 0.7846
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.8519
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7391
 Best site-Product                   | Epoch:3 | Val Acc: 0.7442
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.3512 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.4891 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9801 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.1337 | Train Acc: 0.6867
 Site-Clipart                       | Train Loss: 0.4878 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.8202 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.4828 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 0.5704 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7785 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.1908 | Train Acc: 0.7971
 Site-Product                       | Train Loss: 0.9418 | Train Acc: 0.9531
Average Train Accuracy: 0.7576
 Site-Clipart                       | Val  Loss: 0.4775 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3460 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4228 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.6749 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.9659 | Val  Acc: 0.7447
 Site-Art                           | Val  Loss: 0.2894 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6311 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6463 | Val  Acc: 0.8154
 Site-RealWorld                     | Val  Loss: 1.3338 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.1827 | Val  Acc: 0.8478
 Site-Product                       | Val  Loss: 1.3173 | Val  Acc: 0.7674
Average Valid Accuracy: 0.9004
 Best site-Clipart                   | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7447
 Best site-Art                       | Epoch:4 | Val Acc: 1.0000
 Best site-Art                       | Epoch:4 | Val Acc: 1.0000
 Best site-Art                       | Epoch:4 | Val Acc: 0.8154
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8148
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8478
 Best site-Product                   | Epoch:4 | Val Acc: 0.7674
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.2307 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.4487 | Train Acc: 0.5517
 Site-Clipart                       | Train Loss: 1.9901 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 1.0221 | Train Acc: 0.6506
 Site-Clipart                       | Train Loss: 0.3816 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.6208 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.3303 | Train Acc: 0.6491
 Site-Art                           | Train Loss: 0.4721 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.5983 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9579 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 0.7972 | Train Acc: 0.9531
Average Train Accuracy: 0.7682
 Site-Clipart                       | Val  Loss: 0.4496 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2994 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3307 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.5702 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.8935 | Val  Acc: 0.7340
 Site-Art                           | Val  Loss: 0.1948 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5198 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.5259 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.1915 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 1.0221 | Val  Acc: 0.8696
 Site-Product                       | Val  Loss: 1.2081 | Val  Acc: 0.7674
Average Valid Accuracy: 0.8948
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.1731 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.3276 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.8648 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 0.9581 | Train Acc: 0.7108
 Site-Clipart                       | Train Loss: 0.2945 | Train Acc: 0.9718
 Site-Art                           | Train Loss: 0.5236 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.2343 | Train Acc: 0.6842
 Site-Art                           | Train Loss: 0.3697 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.5082 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.8184 | Train Acc: 0.8551
 Site-Product                       | Train Loss: 0.6366 | Train Acc: 0.9688
Average Train Accuracy: 0.7857
 Site-Clipart                       | Val  Loss: 0.3877 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2823 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.2809 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.4716 | Val  Acc: 0.8909
 Site-Clipart                       | Val  Loss: 0.7770 | Val  Acc: 0.7340
 Site-Art                           | Val  Loss: 0.1842 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3870 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4490 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.0111 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.8518 | Val  Acc: 0.9130
 Site-Product                       | Val  Loss: 1.0799 | Val  Acc: 0.7907
Average Valid Accuracy: 0.9056
 Best site-Clipart                   | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8909
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7340
 Best site-Art                       | Epoch:6 | Val Acc: 1.0000
 Best site-Art                       | Epoch:6 | Val Acc: 1.0000
 Best site-Art                       | Epoch:6 | Val Acc: 0.7846
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9130
 Best site-Product                   | Epoch:6 | Val Acc: 0.7907
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.0908 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.3423 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.9485 | Train Acc: 0.2449
 Site-Clipart                       | Train Loss: 0.8562 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 0.2520 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4305 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.2071 | Train Acc: 0.6491
 Site-Art                           | Train Loss: 0.3299 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.4080 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.7639 | Train Acc: 0.9130
 Site-Product                       | Train Loss: 0.5657 | Train Acc: 0.9531
Average Train Accuracy: 0.8023
 Site-Clipart                       | Val  Loss: 0.3464 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2053 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2459 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.4270 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.6959 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.1134 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3270 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3942 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.9332 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 0.7374 | Val  Acc: 0.8696
 Site-Product                       | Val  Loss: 0.9711 | Val  Acc: 0.7907
Average Valid Accuracy: 0.9102
 Best site-Clipart                   | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7766
 Best site-Art                       | Epoch:7 | Val Acc: 1.0000
 Best site-Art                       | Epoch:7 | Val Acc: 1.0000
 Best site-Art                       | Epoch:7 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8519
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8696
 Best site-Product                   | Epoch:7 | Val Acc: 0.7907
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.0804 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.3198 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 1.8189 | Train Acc: 0.2653
 Site-Clipart                       | Train Loss: 0.8364 | Train Acc: 0.7229
 Site-Clipart                       | Train Loss: 0.2314 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.4528 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.1244 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 0.2431 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.3536 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.7664 | Train Acc: 0.9275
 Site-Product                       | Train Loss: 0.4616 | Train Acc: 0.9688
Average Train Accuracy: 0.7874
 Site-Clipart                       | Val  Loss: 0.2421 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1747 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2341 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.4001 | Val  Acc: 0.8727
 Site-Clipart                       | Val  Loss: 0.6627 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.0846 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2502 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3677 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.8207 | Val  Acc: 0.9259
 Site-RealWorld                     | Val  Loss: 0.6559 | Val  Acc: 0.9348
 Site-Product                       | Val  Loss: 0.9186 | Val  Acc: 0.7674
Average Valid Accuracy: 0.9175
 Best site-Clipart                   | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8727
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7766
 Best site-Art                       | Epoch:8 | Val Acc: 1.0000
 Best site-Art                       | Epoch:8 | Val Acc: 1.0000
 Best site-Art                       | Epoch:8 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9259
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9348
 Best site-Product                   | Epoch:8 | Val Acc: 0.7674
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 1.0479 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.3445 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 1.9325 | Train Acc: 0.2653
 Site-Clipart                       | Train Loss: 0.6614 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 0.1962 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.3844 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.0093 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.1999 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2735 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6526 | Train Acc: 0.9275
 Site-Product                       | Train Loss: 0.3966 | Train Acc: 0.9531
Average Train Accuracy: 0.8112
 Site-Clipart                       | Val  Loss: 0.2475 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1705 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2033 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.3335 | Val  Acc: 0.8727
 Site-Clipart                       | Val  Loss: 0.6354 | Val  Acc: 0.7340
 Site-Art                           | Val  Loss: 0.0611 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2320 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3102 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.7163 | Val  Acc: 0.9259
 Site-RealWorld                     | Val  Loss: 0.5696 | Val  Acc: 0.9348
 Site-Product                       | Val  Loss: 0.8435 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9206
 Best site-Clipart                   | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8727
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.7340
 Best site-Art                       | Epoch:9 | Val Acc: 1.0000
 Best site-Art                       | Epoch:9 | Val Acc: 1.0000
 Best site-Art                       | Epoch:9 | Val Acc: 0.8769
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9259
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9348
 Best site-Product                   | Epoch:9 | Val Acc: 0.8140
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 1.0972 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.1502 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.8780 | Train Acc: 0.2653
 Site-Clipart                       | Train Loss: 0.8529 | Train Acc: 0.6867
 Site-Clipart                       | Train Loss: 0.1361 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.2835 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9892 | Train Acc: 0.7193
 Site-Art                           | Train Loss: 0.1722 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.2274 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.5458 | Train Acc: 0.9275
 Site-Product                       | Train Loss: 0.3097 | Train Acc: 0.9531
Average Train Accuracy: 0.7877
 Site-Clipart                       | Val  Loss: 0.1817 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1315 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1500 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2800 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.5624 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.0786 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1932 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2695 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.5357 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.4956 | Val  Acc: 0.9130
 Site-Product                       | Val  Loss: 0.7282 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9342
 Best site-Clipart                   | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7766
 Best site-Art                       | Epoch:10 | Val Acc: 1.0000
 Best site-Art                       | Epoch:10 | Val Acc: 1.0000
 Best site-Art                       | Epoch:10 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9130
 Best site-Product                   | Epoch:10 | Val Acc: 0.8140
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 1.0378 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.3068 | Train Acc: 0.5517
 Site-Clipart                       | Train Loss: 1.7957 | Train Acc: 0.3265
 Site-Clipart                       | Train Loss: 0.8290 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.1448 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.2620 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9936 | Train Acc: 0.6491
 Site-Art                           | Train Loss: 0.1471 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2168 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.3898 | Train Acc: 0.9565
 Site-Product                       | Train Loss: 0.2955 | Train Acc: 0.9531
Average Train Accuracy: 0.7912
 Site-Clipart                       | Val  Loss: 0.1853 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1191 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1442 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.2979 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.5318 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.0672 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1572 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2874 | Val  Acc: 0.8308
 Site-RealWorld                     | Val  Loss: 0.4616 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.3778 | Val  Acc: 0.9565
 Site-Product                       | Val  Loss: 0.6358 | Val  Acc: 0.8605
Average Valid Accuracy: 0.9368
 Best site-Clipart                   | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.7979
 Best site-Art                       | Epoch:11 | Val Acc: 1.0000
 Best site-Art                       | Epoch:11 | Val Acc: 1.0000
 Best site-Art                       | Epoch:11 | Val Acc: 0.8308
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9565
 Best site-Product                   | Epoch:11 | Val Acc: 0.8605
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.8046 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.2965 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.7227 | Train Acc: 0.3878
 Site-Clipart                       | Train Loss: 0.7175 | Train Acc: 0.7108
 Site-Clipart                       | Train Loss: 0.1225 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.2334 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8820 | Train Acc: 0.7193
 Site-Art                           | Train Loss: 0.1140 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1793 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.2819 | Train Acc: 0.9420
 Site-Product                       | Train Loss: 0.2249 | Train Acc: 0.9844
Average Train Accuracy: 0.8269
 Site-Clipart                       | Val  Loss: 0.1987 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0876 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1477 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.2736 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.4776 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 0.0502 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1061 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2321 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.4625 | Val  Acc: 0.9259
 Site-RealWorld                     | Val  Loss: 0.3059 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.5999 | Val  Acc: 0.8372
Average Valid Accuracy: 0.9335
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.8622 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.0213 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.8148 | Train Acc: 0.3673
 Site-Clipart                       | Train Loss: 0.6387 | Train Acc: 0.7831
 Site-Clipart                       | Train Loss: 0.1055 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.2533 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8845 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.1048 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1886 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 0.2353 | Train Acc: 0.9275
 Site-Product                       | Train Loss: 0.1810 | Train Acc: 0.9844
Average Train Accuracy: 0.8365
 Site-Clipart                       | Val  Loss: 0.1186 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0929 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1424 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.2645 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.5178 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 0.0400 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1094 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2385 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.5198 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 0.2909 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5260 | Val  Acc: 0.8837
Average Valid Accuracy: 0.9365
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.9048 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.0747 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.7548 | Train Acc: 0.3673
 Site-Clipart                       | Train Loss: 0.6559 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 0.1350 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.2106 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9179 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 0.0946 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0873 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2146 | Train Acc: 0.9565
 Site-Product                       | Train Loss: 0.2257 | Train Acc: 0.9531
Average Train Accuracy: 0.8284
 Site-Clipart                       | Val  Loss: 0.1863 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0861 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1052 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2698 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.5365 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0984 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2226 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.3188 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.2671 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5435 | Val  Acc: 0.8372
Average Valid Accuracy: 0.9393
 Best site-Clipart                   | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.7766
 Best site-Art                       | Epoch:14 | Val Acc: 1.0000
 Best site-Art                       | Epoch:14 | Val Acc: 1.0000
 Best site-Art                       | Epoch:14 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-Product                   | Epoch:14 | Val Acc: 0.8372
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.9145 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1749 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.7204 | Train Acc: 0.3673
 Site-Clipart                       | Train Loss: 0.6380 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 0.1035 | Train Acc: 0.9789
 Site-Art                           | Train Loss: 0.2074 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8724 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.0961 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0803 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2008 | Train Acc: 0.9565
 Site-Product                       | Train Loss: 0.1606 | Train Acc: 0.9688
Average Train Accuracy: 0.8355
 Site-Clipart                       | Val  Loss: 0.0895 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0642 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1022 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2340 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.4595 | Val  Acc: 0.7553
 Site-Art                           | Val  Loss: 0.0536 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1046 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2073 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.2863 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2029 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5688 | Val  Acc: 0.8372
Average Valid Accuracy: 0.9440
 Best site-Clipart                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.7553
 Best site-Art                       | Epoch:15 | Val Acc: 1.0000
 Best site-Art                       | Epoch:15 | Val Acc: 1.0000
 Best site-Art                       | Epoch:15 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 0.8372
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.7457 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1948 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.7189 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.6490 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 0.0740 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.2624 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.7457 | Train Acc: 0.7368
 Site-Art                           | Train Loss: 0.0771 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0548 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2936 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.1279 | Train Acc: 0.9844
Average Train Accuracy: 0.8402
 Site-Clipart                       | Val  Loss: 0.0827 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0557 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0938 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.1834 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.4555 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.0474 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0821 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1872 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.2639 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.1892 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.4416 | Val  Acc: 0.8605
Average Valid Accuracy: 0.9476
 Best site-Clipart                   | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8085
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 0.8769
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-Product                   | Epoch:16 | Val Acc: 0.8605
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.8456 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1636 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.9373 | Train Acc: 0.3878
 Site-Clipart                       | Train Loss: 0.5444 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 0.0870 | Train Acc: 0.9789
 Site-Art                           | Train Loss: 0.1656 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8021 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.0617 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0564 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1976 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.1140 | Train Acc: 0.9844
Average Train Accuracy: 0.8298
 Site-Clipart                       | Val  Loss: 0.0846 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0542 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1060 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.2074 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.4401 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0585 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2041 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.2423 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.1665 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3597 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9518
 Best site-Clipart                   | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8191
 Best site-Art                       | Epoch:17 | Val Acc: 1.0000
 Best site-Art                       | Epoch:17 | Val Acc: 1.0000
 Best site-Art                       | Epoch:17 | Val Acc: 0.8615
 Best site-RealWorld                 | Epoch:17 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:17 | Val Acc: 1.0000
 Best site-Product                   | Epoch:17 | Val Acc: 0.9302
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 1.0263 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.0045 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.6284 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.5810 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0968 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1779 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7833 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.0552 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0578 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1621 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.0764 | Train Acc: 1.0000
Average Train Accuracy: 0.8517
 Site-Clipart                       | Val  Loss: 0.0842 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0536 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0757 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.1724 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.4745 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.0251 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0507 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1852 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.2018 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2190 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.3466 | Val  Acc: 0.8837
Average Valid Accuracy: 0.9456
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.8706 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1122 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.7224 | Train Acc: 0.4694
 Site-Clipart                       | Train Loss: 0.4974 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0825 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1695 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7948 | Train Acc: 0.7193
 Site-Art                           | Train Loss: 0.0486 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0695 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1635 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.1171 | Train Acc: 0.9688
Average Train Accuracy: 0.8449
 Site-Clipart                       | Val  Loss: 0.0735 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0440 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1635 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3969 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0626 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1779 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.1816 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.1158 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.4048 | Val  Acc: 0.8605
Average Valid Accuracy: 0.9530
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8191
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-Art                       | Epoch:19 | Val Acc: 0.8769
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-Product                   | Epoch:19 | Val Acc: 0.8605
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.8817 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.0007 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.7847 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.6543 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 0.0636 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1833 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7889 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.0418 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0475 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1275 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.0715 | Train Acc: 0.9844
Average Train Accuracy: 0.8483
 Site-Clipart                       | Val  Loss: 0.0415 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0414 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0810 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1835 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.4302 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2092 | Val  Acc: 0.8154
 Site-RealWorld                     | Val  Loss: 0.1861 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.1367 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.3593 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9454
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.9746 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.0915 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.7115 | Train Acc: 0.4898
 Site-Clipart                       | Train Loss: 0.5823 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 0.0530 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1495 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7455 | Train Acc: 0.7193
 Site-Art                           | Train Loss: 0.0387 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0762 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.1021 | Train Acc: 0.9565
 Site-Product                       | Train Loss: 0.1018 | Train Acc: 0.9688
Average Train Accuracy: 0.8344
 Site-Clipart                       | Val  Loss: 0.0447 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0350 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1479 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.4034 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0422 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1794 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.1311 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1202 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.2679 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9581
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.7979
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9783
 Best site-Product                   | Epoch:21 | Val Acc: 0.9535
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.7990 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1846 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.6790 | Train Acc: 0.4286
 Site-Clipart                       | Train Loss: 0.4715 | Train Acc: 0.7831
 Site-Clipart                       | Train Loss: 0.0486 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1286 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7628 | Train Acc: 0.7368
 Site-Art                           | Train Loss: 0.0393 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0316 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1022 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.0736 | Train Acc: 0.9844
Average Train Accuracy: 0.8568
 Site-Clipart                       | Val  Loss: 0.0654 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0635 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1454 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3579 | Val  Acc: 0.8511
 Site-Art                           | Val  Loss: 0.0334 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0384 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1636 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.1695 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1030 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.3097 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9634
 Best site-Clipart                   | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8511
 Best site-Art                       | Epoch:22 | Val Acc: 1.0000
 Best site-Art                       | Epoch:22 | Val Acc: 1.0000
 Best site-Art                       | Epoch:22 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:22 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9783
 Best site-Product                   | Epoch:22 | Val Acc: 0.9767
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.8820 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1629 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.7706 | Train Acc: 0.4286
 Site-Clipart                       | Train Loss: 0.5513 | Train Acc: 0.8313
 Site-Clipart                       | Train Loss: 0.0439 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0988 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7920 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 0.0381 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0445 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0829 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0994 | Train Acc: 0.9844
Average Train Accuracy: 0.8451
 Site-Clipart                       | Val  Loss: 0.0463 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0443 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1178 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.3772 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.0255 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0321 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1546 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.1321 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.0616 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2703 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9596
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.8933 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 0.9949 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.4882 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.4752 | Train Acc: 0.8193
 Site-Clipart                       | Train Loss: 0.0579 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1423 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6605 | Train Acc: 0.7544
 Site-Art                           | Train Loss: 0.0379 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0203 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0822 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.0598 | Train Acc: 0.9844
Average Train Accuracy: 0.8609
 Site-Clipart                       | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0385 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0394 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1313 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3393 | Val  Acc: 0.8511
 Site-Art                           | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0252 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1431 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0980 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0616 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3204 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9649
 Best site-Clipart                   | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8511
 Best site-Art                       | Epoch:24 | Val Acc: 1.0000
 Best site-Art                       | Epoch:24 | Val Acc: 1.0000
 Best site-Art                       | Epoch:24 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:24 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:24 | Val Acc: 1.0000
 Best site-Product                   | Epoch:24 | Val Acc: 0.9070
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 1.1486 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.0162 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.6245 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.4608 | Train Acc: 0.7952
 Site-Clipart                       | Train Loss: 0.0562 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1366 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7298 | Train Acc: 0.7544
 Site-Art                           | Train Loss: 0.0263 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0444 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0602 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0438 | Train Acc: 1.0000
Average Train Accuracy: 0.8576
 Site-Clipart                       | Val  Loss: 0.0194 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0389 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1124 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.3902 | Val  Acc: 0.8298
 Site-Art                           | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0285 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1324 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.1274 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.0985 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2988 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9613
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.9816 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1169 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.6663 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.5382 | Train Acc: 0.7952
 Site-Clipart                       | Train Loss: 0.0591 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1764 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.6742 | Train Acc: 0.7368
 Site-Art                           | Train Loss: 0.0246 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0594 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0847 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0566 | Train Acc: 0.9844
Average Train Accuracy: 0.8504
 Site-Clipart                       | Val  Loss: 0.0338 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0546 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.1185 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3416 | Val  Acc: 0.8511
 Site-Art                           | Val  Loss: 0.0112 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0302 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1257 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0503 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0770 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3080 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9646
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 1.1106 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.0931 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.7924 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.4492 | Train Acc: 0.8313
 Site-Clipart                       | Train Loss: 0.0323 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6882 | Train Acc: 0.7719
 Site-Art                           | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0356 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0854 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0550 | Train Acc: 0.9844
Average Train Accuracy: 0.8584
 Site-Clipart                       | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0310 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1455 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3448 | Val  Acc: 0.8404
 Site-Art                           | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1527 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.0597 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0790 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2417 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9637
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.7066 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.8575 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.4894 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.4425 | Train Acc: 0.7952
 Site-Clipart                       | Train Loss: 0.0520 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0949 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6438 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0193 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0426 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0688 | Train Acc: 0.9844
Average Train Accuracy: 0.8792
 Site-Clipart                       | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0427 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1200 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3312 | Val  Acc: 0.8404
 Site-Art                           | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1381 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0580 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0627 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2653 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9661
 Best site-Clipart                   | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8404
 Best site-Art                       | Epoch:28 | Val Acc: 1.0000
 Best site-Art                       | Epoch:28 | Val Acc: 1.0000
 Best site-Art                       | Epoch:28 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-Product                   | Epoch:28 | Val Acc: 0.9302
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.9905 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.0812 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.6383 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.4579 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0378 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.0781 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6393 | Train Acc: 0.8070
 Site-Art                           | Train Loss: 0.0185 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0219 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0342 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0602 | Train Acc: 0.9844
Average Train Accuracy: 0.8741
 Site-Clipart                       | Val  Loss: 0.0143 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0368 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1225 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.2899 | Val  Acc: 0.8723
 Site-Art                           | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1237 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.0624 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0392 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1882 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9678
 Best site-Clipart                   | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9818
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8723
 Best site-Art                       | Epoch:29 | Val Acc: 1.0000
 Best site-Art                       | Epoch:29 | Val Acc: 1.0000
 Best site-Art                       | Epoch:29 | Val Acc: 0.8615
 Best site-RealWorld                 | Epoch:29 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:29 | Val Acc: 1.0000
 Best site-Product                   | Epoch:29 | Val Acc: 0.9302
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.9662 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1119 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.9070 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.4346 | Train Acc: 0.8554
 Site-Clipart                       | Train Loss: 0.0336 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1577 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6514 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0275 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.0831 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 0.0483 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0594 | Train Acc: 0.9844
Average Train Accuracy: 0.8542
 Site-Clipart                       | Val  Loss: 0.0159 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1459 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3133 | Val  Acc: 0.8511
 Site-Art                           | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1444 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.1007 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0371 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2144 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9691
 Best site-Clipart                   | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8511
 Best site-Art                       | Epoch:30 | Val Acc: 1.0000
 Best site-Art                       | Epoch:30 | Val Acc: 1.0000
 Best site-Art                       | Epoch:30 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:30 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:30 | Val Acc: 1.0000
 Best site-Product                   | Epoch:30 | Val Acc: 0.9535
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.9594 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 0.9807 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.5637 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.4080 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0254 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0627 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5590 | Train Acc: 0.8070
 Site-Art                           | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0613 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.0548 | Train Acc: 0.9844
Average Train Accuracy: 0.8649
 Site-Clipart                       | Val  Loss: 0.0258 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0201 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1145 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2999 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0065 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0317 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1237 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2163 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9701
 Best site-Clipart                   | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:31 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:31 | Val Acc: 0.8617
 Best site-Art                       | Epoch:31 | Val Acc: 1.0000
 Best site-Art                       | Epoch:31 | Val Acc: 1.0000
 Best site-Art                       | Epoch:31 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-Product                   | Epoch:31 | Val Acc: 0.9535
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.7322 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.2205 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.5857 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.4319 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0263 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.3114 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.6436 | Train Acc: 0.8070
 Site-Art                           | Train Loss: 0.0186 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0448 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0488 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0426 | Train Acc: 0.9844
Average Train Accuracy: 0.8648
 Site-Clipart                       | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0112 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1816 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3346 | Val  Acc: 0.8298
 Site-Art                           | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0209 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1201 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0420 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2003 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9655
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.8025 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1327 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.5297 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.4164 | Train Acc: 0.7831
 Site-Clipart                       | Train Loss: 0.0279 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0171 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7622 | Train Acc: 0.7544
 Site-Art                           | Train Loss: 0.0142 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0153 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1129 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0793 | Train Acc: 0.9688
Average Train Accuracy: 0.8606
 Site-Clipart                       | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0196 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1468 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2692 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1291 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.0562 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2195 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9653
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 1.0999 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1601 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.4365 | Train Acc: 0.5510
 Site-Clipart                       | Train Loss: 0.4575 | Train Acc: 0.8795
 Site-Clipart                       | Train Loss: 0.0360 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1719 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7098 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0136 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0103 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0337 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0371 | Train Acc: 0.9844
Average Train Accuracy: 0.8749
 Site-Clipart                       | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1118 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2767 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0954 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0464 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1773 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9755
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8617
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-Art                       | Epoch:34 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:34 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:34 | Val Acc: 1.0000
 Best site-Product                   | Epoch:34 | Val Acc: 0.9767
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 1.0121 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.3089 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.7844 | Train Acc: 0.4898
 Site-Clipart                       | Train Loss: 0.5110 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 0.0217 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1162 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5426 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0107 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0220 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0288 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0553 | Train Acc: 0.9688
Average Train Accuracy: 0.8588
 Site-Clipart                       | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0235 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1237 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3319 | Val  Acc: 0.8298
 Site-Art                           | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1015 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0422 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2019 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9665
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.8560 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.1413 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.4029 | Train Acc: 0.5714
 Site-Clipart                       | Train Loss: 0.3475 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0271 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1277 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6504 | Train Acc: 0.8070
 Site-Art                           | Train Loss: 0.0084 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0142 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1800 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0175 | Train Acc: 1.0000
Average Train Accuracy: 0.8834
 Site-Clipart                       | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0195 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1224 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2850 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0144 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1296 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0338 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1924 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9701
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 1.0597 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 0.9669 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.7037 | Train Acc: 0.5714
 Site-Clipart                       | Train Loss: 0.4007 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0177 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2242 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6244 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0145 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0132 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0344 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0450 | Train Acc: 0.9844
Average Train Accuracy: 0.8702
 Site-Clipart                       | Val  Loss: 0.0196 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0146 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0329 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0629 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2646 | Val  Acc: 0.8936
 Site-Art                           | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0105 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1159 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0441 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0218 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2280 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9763
 Best site-Clipart                   | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.8936
 Best site-Art                       | Epoch:37 | Val Acc: 1.0000
 Best site-Art                       | Epoch:37 | Val Acc: 1.0000
 Best site-Art                       | Epoch:37 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:37 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:37 | Val Acc: 1.0000
 Best site-Product                   | Epoch:37 | Val Acc: 0.9535
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.8017 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.4263 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.4591 | Train Acc: 0.5510
 Site-Clipart                       | Train Loss: 0.3457 | Train Acc: 0.8916
 Site-Clipart                       | Train Loss: 0.0234 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6131 | Train Acc: 0.8246
 Site-Art                           | Train Loss: 0.0087 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0213 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0348 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0261 | Train Acc: 0.9844
Average Train Accuracy: 0.8717
 Site-Clipart                       | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1232 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3252 | Val  Acc: 0.8298
 Site-Art                           | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1305 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0807 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.0168 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2815 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9617
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.6841 | Train Acc: 0.8824
 Site-Clipart                       | Train Loss: 0.9822 | Train Acc: 0.8276
 Site-Clipart                       | Train Loss: 1.6925 | Train Acc: 0.4898
 Site-Clipart                       | Train Loss: 0.4586 | Train Acc: 0.8193
 Site-Clipart                       | Train Loss: 0.0187 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1345 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5701 | Train Acc: 0.8596
 Site-Art                           | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0872 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 0.0336 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0190 | Train Acc: 1.0000
Average Train Accuracy: 0.8909
 Site-Clipart                       | Val  Loss: 0.0065 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0084 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0405 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0515 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.3121 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1362 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.0439 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1946 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9704
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.9853 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.0157 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.6390 | Train Acc: 0.5918
 Site-Clipart                       | Train Loss: 0.3782 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0105 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0372 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6547 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0061 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0102 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0219 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0558 | Train Acc: 0.9844
Average Train Accuracy: 0.8787
 Site-Clipart                       | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0192 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1158 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.2602 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1065 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0426 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2087 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9663
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 1.2641 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.3969 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.6311 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.2906 | Train Acc: 0.8795
 Site-Clipart                       | Train Loss: 0.0159 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0865 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5359 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0122 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0439 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0243 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0455 | Train Acc: 0.9844
Average Train Accuracy: 0.8675
 Site-Clipart                       | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2015 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.2420 | Val  Acc: 0.9043
 Site-Art                           | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1056 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0251 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0220 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1302 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9758
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 1.1712 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.0444 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.6379 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.4328 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0222 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1376 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6380 | Train Acc: 0.7544
 Site-Art                           | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0529 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0208 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0323 | Train Acc: 0.9844
Average Train Accuracy: 0.8723
 Site-Clipart                       | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0456 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.0903 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2944 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1005 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2465 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9627
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 1.0222 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.9656 | Train Acc: 0.8276
 Site-Clipart                       | Train Loss: 1.7352 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.4369 | Train Acc: 0.8313
 Site-Clipart                       | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0557 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5232 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0132 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0154 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0335 | Train Acc: 0.9844
Average Train Accuracy: 0.8864
 Site-Clipart                       | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0839 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2869 | Val  Acc: 0.8723
 Site-Art                           | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1570 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0249 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2257 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9737
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.9943 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1716 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.4902 | Train Acc: 0.5918
 Site-Clipart                       | Train Loss: 0.4073 | Train Acc: 0.8675
 Site-Clipart                       | Train Loss: 0.0242 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1301 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7103 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0587 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.1307 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0320 | Train Acc: 0.9844
Average Train Accuracy: 0.8722
 Site-Clipart                       | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0872 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2570 | Val  Acc: 0.8830
 Site-Art                           | Val  Loss: 0.0308 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0083 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1164 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0198 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0164 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2001 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9734
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 1.0531 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1137 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.7467 | Train Acc: 0.5918
 Site-Clipart                       | Train Loss: 0.3597 | Train Acc: 0.8675
 Site-Clipart                       | Train Loss: 0.0137 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1254 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6333 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0702 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.1214 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0272 | Train Acc: 0.9844
Average Train Accuracy: 0.8770
 Site-Clipart                       | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0846 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2530 | Val  Acc: 0.8830
 Site-Art                           | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1007 | Val  Acc: 0.9385
 Site-RealWorld                     | Val  Loss: 0.0451 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0174 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1487 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9783
 Best site-Clipart                   | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.8830
 Best site-Art                       | Epoch:45 | Val Acc: 1.0000
 Best site-Art                       | Epoch:45 | Val Acc: 1.0000
 Best site-Art                       | Epoch:45 | Val Acc: 0.9385
 Best site-RealWorld                 | Epoch:45 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:45 | Val Acc: 1.0000
 Best site-Product                   | Epoch:45 | Val Acc: 0.9767
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedsam...
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.7467 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 0.7090 | Train Acc: 0.8276
 Site-Clipart                       | Train Loss: 1.4506 | Train Acc: 0.5918
 Site-Clipart                       | Train Loss: 0.5585 | Train Acc: 0.8795
 Site-Clipart                       | Train Loss: 0.0154 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1445 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6702 | Train Acc: 0.8070
 Site-Art                           | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0140 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0148 | Train Acc: 1.0000
Average Train Accuracy: 0.8873
 Site-Clipart                       | Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0708 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.2631 | Val  Acc: 0.8936
 Site-Art                           | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1102 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0591 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.0472 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.2079 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9721
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 1.1035 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 0.9245 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.3712 | Train Acc: 0.6122
 Site-Clipart                       | Train Loss: 0.3458 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0163 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0432 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5600 | Train Acc: 0.8246
 Site-Art                           | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0157 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0838 | Train Acc: 0.9688
Average Train Accuracy: 0.8821
 Site-Clipart                       | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0764 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.3136 | Val  Acc: 0.8298
 Site-Art                           | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0651 | Val  Acc: 0.9538
 Site-RealWorld                     | Val  Loss: 0.0496 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0198 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1891 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9744
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 1.0395 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.9547 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.3640 | Train Acc: 0.6122
 Site-Clipart                       | Train Loss: 0.2830 | Train Acc: 0.8795
 Site-Clipart                       | Train Loss: 0.0168 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2507 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.6458 | Train Acc: 0.8070
 Site-Art                           | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0268 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0278 | Train Acc: 0.9844
Average Train Accuracy: 0.8945
 Site-Clipart                       | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0074 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0585 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2624 | Val  Acc: 0.8723
 Site-Art                           | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1007 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0187 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2393 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9682
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.7826 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.9927 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.4356 | Train Acc: 0.6327
 Site-Clipart                       | Train Loss: 0.2998 | Train Acc: 0.8675
 Site-Clipart                       | Train Loss: 0.0107 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0199 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5253 | Train Acc: 0.8772
 Site-Art                           | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0151 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0322 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0075 | Train Acc: 1.0000
Average Train Accuracy: 0.9054
 Site-Clipart                       | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1324 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2212 | Val  Acc: 0.8936
 Site-Art                           | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0851 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1445 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9779
===2023-08-01 20:48:02===
===2023-08-01 20:48:18===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[17,29,49,83,142,33,57,97,41,69,64,
client_nums=[5,3,2,1,]
len_dataset=[537,315,185,108,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (1)| Epoch:45 | Test Acc: 0.5447
 Test site-Art                       (1)| Epoch:45 | Test Acc: 0.6335
 Test site-RealWorld                 (1)| Epoch:45 | Test Acc: 0.6111
 Test site-Product                   (1)| Epoch:45 | Test Acc: 0.5721
Clipart: 0.5447, Art: 0.6335, RealWorld: 0.6111, Product: 0.5721, 
Average Test Accuracy(group): 0.5904, Average Test Accuracy(individual): 0.5835,
domain std=0.0343, cluster std=0.0189, individual std=0.0390, 
