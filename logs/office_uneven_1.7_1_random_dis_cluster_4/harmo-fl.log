===2023-08-01 17:43:06===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[17,29,49,83,142,33,57,97,41,69,64,
client_nums=[5,3,2,1,]
len_dataset=[537,315,185,108,]
domain number = 4
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.9883 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 2.0338 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 2.2464 | Train Acc: 0.0612
 Site-Clipart                       | Train Loss: 2.0511 | Train Acc: 0.3494
 Site-Clipart                       | Train Loss: 1.6608 | Train Acc: 0.9296
 Site-Art                           | Train Loss: 1.8758 | Train Acc: 0.8788
 Site-Art                           | Train Loss: 2.0850 | Train Acc: 0.4912
 Site-Art                           | Train Loss: 1.7406 | Train Acc: 0.8351
 Site-RealWorld                     | Train Loss: 1.8760 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.9733 | Train Acc: 0.5362
 Site-Product                       | Train Loss: 1.9735 | Train Acc: 0.8594
Average Train Accuracy: 0.6522
 Site-Clipart                       | Val  Loss: 1.6189 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.5452 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 1.6079 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 1.8155 | Val  Acc: 0.5818
 Site-Clipart                       | Val  Loss: 1.9877 | Val  Acc: 0.4149
 Site-Art                           | Val  Loss: 1.5698 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.7605 | Val  Acc: 0.7895
 Site-Art                           | Val  Loss: 1.6862 | Val  Acc: 0.6154
 Site-RealWorld                     | Val  Loss: 2.0956 | Val  Acc: 0.4074
 Site-RealWorld                     | Val  Loss: 2.0411 | Val  Acc: 0.5435
 Site-Product                       | Val  Loss: 2.1070 | Val  Acc: 0.4884
Average Valid Accuracy: 0.6995
 Best site-Clipart                   | Epoch:0 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.9062
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.5818
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4149
 Best site-Art                       | Epoch:0 | Val Acc: 1.0000
 Best site-Art                       | Epoch:0 | Val Acc: 0.7895
 Best site-Art                       | Epoch:0 | Val Acc: 0.6154
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.4074
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.5435
 Best site-Product                   | Epoch:0 | Val Acc: 0.4884
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 1.8017 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.8871 | Train Acc: 0.5517
 Site-Clipart                       | Train Loss: 2.1556 | Train Acc: 0.1224
 Site-Clipart                       | Train Loss: 1.7111 | Train Acc: 0.5181
 Site-Clipart                       | Train Loss: 1.2288 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 1.5372 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.9149 | Train Acc: 0.5263
 Site-Art                           | Train Loss: 1.2928 | Train Acc: 0.9691
 Site-RealWorld                     | Train Loss: 1.5561 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.8409 | Train Acc: 0.7536
 Site-Product                       | Train Loss: 1.6881 | Train Acc: 0.8906
Average Train Accuracy: 0.7031
 Site-Clipart                       | Val  Loss: 1.1492 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.9818 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 1.1027 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 1.3840 | Val  Acc: 0.8364
 Site-Clipart                       | Val  Loss: 1.6037 | Val  Acc: 0.6170
 Site-Art                           | Val  Loss: 0.9919 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3207 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.2810 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 1.9064 | Val  Acc: 0.7037
 Site-RealWorld                     | Val  Loss: 1.7778 | Val  Acc: 0.6739
 Site-Product                       | Val  Loss: 1.9072 | Val  Acc: 0.6279
Average Valid Accuracy: 0.8289
 Best site-Clipart                   | Epoch:1 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8364
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6170
 Best site-Art                       | Epoch:1 | Val Acc: 1.0000
 Best site-Art                       | Epoch:1 | Val Acc: 0.9737
 Best site-Art                       | Epoch:1 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.7037
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.6739
 Best site-Product                   | Epoch:1 | Val Acc: 0.6279
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 1.6195 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.7113 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 2.0344 | Train Acc: 0.1633
 Site-Clipart                       | Train Loss: 1.4277 | Train Acc: 0.5301
 Site-Clipart                       | Train Loss: 0.8391 | Train Acc: 0.9718
 Site-Art                           | Train Loss: 1.2437 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.7276 | Train Acc: 0.6140
 Site-Art                           | Train Loss: 0.9303 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.2567 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.6195 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.4136 | Train Acc: 0.9375
Average Train Accuracy: 0.7419
 Site-Clipart                       | Val  Loss: 0.7738 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6407 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.7465 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 1.0574 | Val  Acc: 0.8909
 Site-Clipart                       | Val  Loss: 1.3637 | Val  Acc: 0.6383
 Site-Art                           | Val  Loss: 0.5904 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9965 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0285 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.6797 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.5390 | Val  Acc: 0.8043
 Site-Product                       | Val  Loss: 1.6755 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8700
 Best site-Clipart                   | Epoch:2 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8909
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6383
 Best site-Art                       | Epoch:2 | Val Acc: 1.0000
 Best site-Art                       | Epoch:2 | Val Acc: 1.0000
 Best site-Art                       | Epoch:2 | Val Acc: 0.7846
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.8148
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.8043
 Best site-Product                   | Epoch:2 | Val Acc: 0.7209
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 1.4019 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.6447 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 2.0474 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 1.2619 | Train Acc: 0.6627
 Site-Clipart                       | Train Loss: 0.6457 | Train Acc: 0.9789
 Site-Art                           | Train Loss: 0.9843 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.5808 | Train Acc: 0.6140
 Site-Art                           | Train Loss: 0.7295 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.9662 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3695 | Train Acc: 0.8551
 Site-Product                       | Train Loss: 1.2046 | Train Acc: 0.9375
Average Train Accuracy: 0.7605
 Site-Clipart                       | Val  Loss: 0.5417 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4497 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5072 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.8326 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.1379 | Val  Acc: 0.7340
 Site-Art                           | Val  Loss: 0.4075 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7808 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.7928 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.5123 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 1.3926 | Val  Acc: 0.7609
 Site-Product                       | Val  Loss: 1.5388 | Val  Acc: 0.7442
Average Valid Accuracy: 0.8876
 Best site-Clipart                   | Epoch:3 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:3 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7340
 Best site-Art                       | Epoch:3 | Val Acc: 1.0000
 Best site-Art                       | Epoch:3 | Val Acc: 0.9737
 Best site-Art                       | Epoch:3 | Val Acc: 0.7846
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.8889
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7609
 Best site-Product                   | Epoch:3 | Val Acc: 0.7442
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.3361 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.4913 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 2.0868 | Train Acc: 0.1633
 Site-Clipart                       | Train Loss: 1.1526 | Train Acc: 0.6747
 Site-Clipart                       | Train Loss: 0.4965 | Train Acc: 0.9789
 Site-Art                           | Train Loss: 0.8170 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.5129 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 0.5617 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7891 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.1888 | Train Acc: 0.8551
 Site-Product                       | Train Loss: 0.9517 | Train Acc: 0.9688
Average Train Accuracy: 0.7584
 Site-Clipart                       | Val  Loss: 0.4476 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3289 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4095 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.6888 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.9675 | Val  Acc: 0.7447
 Site-Art                           | Val  Loss: 0.2690 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6311 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6298 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.3396 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 1.1564 | Val  Acc: 0.9348
 Site-Product                       | Val  Loss: 1.3185 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9146
 Best site-Clipart                   | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7447
 Best site-Art                       | Epoch:4 | Val Acc: 1.0000
 Best site-Art                       | Epoch:4 | Val Acc: 1.0000
 Best site-Art                       | Epoch:4 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8889
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9348
 Best site-Product                   | Epoch:4 | Val Acc: 0.8140
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.1979 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.4746 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 2.0699 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 1.0337 | Train Acc: 0.6506
 Site-Clipart                       | Train Loss: 0.3881 | Train Acc: 0.9789
 Site-Art                           | Train Loss: 0.6452 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.3548 | Train Acc: 0.6491
 Site-Art                           | Train Loss: 0.4676 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6069 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.9405 | Train Acc: 0.8986
 Site-Product                       | Train Loss: 0.8226 | Train Acc: 0.9375
Average Train Accuracy: 0.7845
 Site-Clipart                       | Val  Loss: 0.4105 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2925 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3283 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.5805 | Val  Acc: 0.8909
 Site-Clipart                       | Val  Loss: 0.9080 | Val  Acc: 0.6915
 Site-Art                           | Val  Loss: 0.1917 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4876 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5319 | Val  Acc: 0.8154
 Site-RealWorld                     | Val  Loss: 1.1687 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 0.9951 | Val  Acc: 0.9130
 Site-Product                       | Val  Loss: 1.2521 | Val  Acc: 0.7907
Average Valid Accuracy: 0.8992
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.1183 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.3269 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.9458 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 0.9917 | Train Acc: 0.6988
 Site-Clipart                       | Train Loss: 0.3197 | Train Acc: 0.9789
 Site-Art                           | Train Loss: 0.5068 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.2228 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.3688 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 0.5320 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.8302 | Train Acc: 0.9130
 Site-Product                       | Train Loss: 0.6441 | Train Acc: 0.9688
Average Train Accuracy: 0.7883
 Site-Clipart                       | Val  Loss: 0.3400 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2738 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2897 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.4893 | Val  Acc: 0.8909
 Site-Clipart                       | Val  Loss: 0.7890 | Val  Acc: 0.7128
 Site-Art                           | Val  Loss: 0.1965 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3864 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4476 | Val  Acc: 0.8154
 Site-RealWorld                     | Val  Loss: 1.0068 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.8353 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 1.0715 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9192
 Best site-Clipart                   | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8909
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7128
 Best site-Art                       | Epoch:6 | Val Acc: 1.0000
 Best site-Art                       | Epoch:6 | Val Acc: 1.0000
 Best site-Art                       | Epoch:6 | Val Acc: 0.8154
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9783
 Best site-Product                   | Epoch:6 | Val Acc: 0.8140
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.0746 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.3546 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 2.0184 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 0.8650 | Train Acc: 0.7229
 Site-Clipart                       | Train Loss: 0.2537 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.4164 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.2732 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 0.3209 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.4258 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.7571 | Train Acc: 0.8986
 Site-Product                       | Train Loss: 0.5829 | Train Acc: 0.9688
Average Train Accuracy: 0.7941
 Site-Clipart                       | Val  Loss: 0.2781 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2024 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2443 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.4349 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.7147 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.0917 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3055 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4030 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.9286 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 0.7163 | Val  Acc: 0.9130
 Site-Product                       | Val  Loss: 0.9898 | Val  Acc: 0.7907
Average Valid Accuracy: 0.9156
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.0068 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.3121 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 1.9896 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 0.8323 | Train Acc: 0.6867
 Site-Clipart                       | Train Loss: 0.2375 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.4550 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.1302 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 0.2525 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.3586 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.6940 | Train Acc: 0.9565
 Site-Product                       | Train Loss: 0.4879 | Train Acc: 0.9688
Average Train Accuracy: 0.7934
 Site-Clipart                       | Val  Loss: 0.2188 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1644 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2292 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.4215 | Val  Acc: 0.8909
 Site-Clipart                       | Val  Loss: 0.6934 | Val  Acc: 0.7021
 Site-Art                           | Val  Loss: 0.0875 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2551 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3560 | Val  Acc: 0.8308
 Site-RealWorld                     | Val  Loss: 0.8228 | Val  Acc: 0.9259
 Site-RealWorld                     | Val  Loss: 0.6196 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9159 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9211
 Best site-Clipart                   | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8909
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7021
 Best site-Art                       | Epoch:8 | Val Acc: 1.0000
 Best site-Art                       | Epoch:8 | Val Acc: 1.0000
 Best site-Art                       | Epoch:8 | Val Acc: 0.8308
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9259
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-Product                   | Epoch:8 | Val Acc: 0.8140
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 1.0379 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.3663 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 2.0881 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 0.6648 | Train Acc: 0.7108
 Site-Clipart                       | Train Loss: 0.2000 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.3730 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.0406 | Train Acc: 0.6842
 Site-Art                           | Train Loss: 0.2026 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2668 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6350 | Train Acc: 0.9275
 Site-Product                       | Train Loss: 0.4145 | Train Acc: 0.9688
Average Train Accuracy: 0.8067
 Site-Clipart                       | Val  Loss: 0.2164 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1474 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1904 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.3413 | Val  Acc: 0.8727
 Site-Clipart                       | Val  Loss: 0.6699 | Val  Acc: 0.7553
 Site-Art                           | Val  Loss: 0.0596 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2184 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3053 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.6852 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.5422 | Val  Acc: 0.9565
 Site-Product                       | Val  Loss: 0.9052 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9279
 Best site-Clipart                   | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8727
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.7553
 Best site-Art                       | Epoch:9 | Val Acc: 1.0000
 Best site-Art                       | Epoch:9 | Val Acc: 1.0000
 Best site-Art                       | Epoch:9 | Val Acc: 0.8769
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9565
 Best site-Product                   | Epoch:9 | Val Acc: 0.8140
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 1.0536 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.2129 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 2.1267 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 0.8851 | Train Acc: 0.6747
 Site-Clipart                       | Train Loss: 0.1375 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.3040 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.0380 | Train Acc: 0.6842
 Site-Art                           | Train Loss: 0.1729 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.2317 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.5637 | Train Acc: 0.9275
 Site-Product                       | Train Loss: 0.3563 | Train Acc: 0.9688
Average Train Accuracy: 0.7828
 Site-Clipart                       | Val  Loss: 0.1741 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1007 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1560 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2987 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.5919 | Val  Acc: 0.7660
 Site-Art                           | Val  Loss: 0.0672 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1786 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2826 | Val  Acc: 0.8308
 Site-RealWorld                     | Val  Loss: 0.5484 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.4685 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.7668 | Val  Acc: 0.8372
Average Valid Accuracy: 0.9382
 Best site-Clipart                   | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7660
 Best site-Art                       | Epoch:10 | Val Acc: 1.0000
 Best site-Art                       | Epoch:10 | Val Acc: 1.0000
 Best site-Art                       | Epoch:10 | Val Acc: 0.8308
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9783
 Best site-Product                   | Epoch:10 | Val Acc: 0.8372
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 1.0904 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.3534 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 2.0108 | Train Acc: 0.2449
 Site-Clipart                       | Train Loss: 0.8406 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.1460 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.2438 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.0712 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 0.1457 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2254 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.3997 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.3386 | Train Acc: 0.9375
Average Train Accuracy: 0.7805
 Site-Clipart                       | Val  Loss: 0.1418 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0963 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1578 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.3310 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.5575 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.0552 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1519 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2956 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.4773 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.3859 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.7153 | Val  Acc: 0.8605
Average Valid Accuracy: 0.9411
 Best site-Clipart                   | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8085
 Best site-Art                       | Epoch:11 | Val Acc: 1.0000
 Best site-Art                       | Epoch:11 | Val Acc: 1.0000
 Best site-Art                       | Epoch:11 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9783
 Best site-Product                   | Epoch:11 | Val Acc: 0.8605
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.8731 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.3023 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 2.0225 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 0.7218 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 0.1189 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.2324 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9240 | Train Acc: 0.7193
 Site-Art                           | Train Loss: 0.1168 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1985 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.2940 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.2679 | Train Acc: 0.9688
Average Train Accuracy: 0.8161
 Site-Clipart                       | Val  Loss: 0.1930 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1423 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.2897 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.5151 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.0448 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1183 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2378 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.4790 | Val  Acc: 0.9259
 Site-RealWorld                     | Val  Loss: 0.3190 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.6451 | Val  Acc: 0.8837
Average Valid Accuracy: 0.9381
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.9350 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1028 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 2.0878 | Train Acc: 0.2857
 Site-Clipart                       | Train Loss: 0.7133 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.1050 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2194 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9208 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.1187 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1994 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 0.2349 | Train Acc: 0.9420
 Site-Product                       | Train Loss: 0.2018 | Train Acc: 0.9688
Average Train Accuracy: 0.8232
 Site-Clipart                       | Val  Loss: 0.0920 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0837 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1484 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.2949 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.5524 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1076 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2428 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.5350 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 0.2919 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.5932 | Val  Acc: 0.8372
Average Valid Accuracy: 0.9308
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.9186 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1750 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 2.0479 | Train Acc: 0.2449
 Site-Clipart                       | Train Loss: 0.6756 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 0.1298 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.1897 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9444 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 0.1063 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1236 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2373 | Train Acc: 0.9565
 Site-Product                       | Train Loss: 0.2513 | Train Acc: 0.9688
Average Train Accuracy: 0.8134
 Site-Clipart                       | Val  Loss: 0.1632 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0727 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1004 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2964 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.5445 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.0576 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1033 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2255 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.3250 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2944 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6269 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9405
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 1.0213 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.2820 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 2.0943 | Train Acc: 0.2857
 Site-Clipart                       | Train Loss: 0.6700 | Train Acc: 0.7229
 Site-Clipart                       | Train Loss: 0.1032 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.2123 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8948 | Train Acc: 0.7193
 Site-Art                           | Train Loss: 0.0965 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1110 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2099 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.1948 | Train Acc: 0.9688
Average Train Accuracy: 0.8042
 Site-Clipart                       | Val  Loss: 0.0712 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0607 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1105 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2405 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.4788 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.0395 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1065 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2100 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.3122 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2168 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6528 | Val  Acc: 0.8372
Average Valid Accuracy: 0.9490
 Best site-Clipart                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.7979
 Best site-Art                       | Epoch:15 | Val Acc: 1.0000
 Best site-Art                       | Epoch:15 | Val Acc: 1.0000
 Best site-Art                       | Epoch:15 | Val Acc: 0.8769
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 0.8372
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.7813 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.2884 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 2.0473 | Train Acc: 0.3061
 Site-Clipart                       | Train Loss: 0.6311 | Train Acc: 0.7952
 Site-Clipart                       | Train Loss: 0.0789 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2305 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.7733 | Train Acc: 0.7544
 Site-Art                           | Train Loss: 0.0753 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0734 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2909 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.1405 | Train Acc: 0.9844
Average Train Accuracy: 0.8341
 Site-Clipart                       | Val  Loss: 0.0841 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0633 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0939 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1924 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.4712 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.0575 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1928 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.3304 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.2006 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.4584 | Val  Acc: 0.8605
Average Valid Accuracy: 0.9510
 Best site-Clipart                   | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8191
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 0.8769
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9783
 Best site-Product                   | Epoch:16 | Val Acc: 0.8605
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.8113 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.3887 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 2.1879 | Train Acc: 0.2857
 Site-Clipart                       | Train Loss: 0.5426 | Train Acc: 0.7831
 Site-Clipart                       | Train Loss: 0.0892 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1619 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8335 | Train Acc: 0.7193
 Site-Art                           | Train Loss: 0.0656 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0745 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1934 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.1385 | Train Acc: 0.9688
Average Train Accuracy: 0.8211
 Site-Clipart                       | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0475 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0975 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2179 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.4670 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0696 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2203 | Val  Acc: 0.8308
 Site-RealWorld                     | Val  Loss: 0.2593 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.1759 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.3884 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9478
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 1.0538 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.3016 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 2.0114 | Train Acc: 0.3673
 Site-Clipart                       | Train Loss: 0.6720 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0969 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1891 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8532 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 0.0577 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0695 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1665 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0926 | Train Acc: 1.0000
Average Train Accuracy: 0.8316
 Site-Clipart                       | Val  Loss: 0.0620 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0570 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1883 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.4751 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.0248 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0527 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1777 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.2192 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.2214 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.4292 | Val  Acc: 0.8605
Average Valid Accuracy: 0.9480
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.8986 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.2438 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 2.2196 | Train Acc: 0.2857
 Site-Clipart                       | Train Loss: 0.5377 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.0818 | Train Acc: 0.9859
 Site-Art                           | Train Loss: 0.1642 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7744 | Train Acc: 0.7368
 Site-Art                           | Train Loss: 0.0550 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0953 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1695 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.1508 | Train Acc: 0.9688
Average Train Accuracy: 0.8272
 Site-Clipart                       | Val  Loss: 0.0639 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0299 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0647 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1858 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.4281 | Val  Acc: 0.8404
 Site-Art                           | Val  Loss: 0.0199 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1800 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.1858 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.1173 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.4654 | Val  Acc: 0.8837
Average Valid Accuracy: 0.9571
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8404
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-Art                       | Epoch:19 | Val Acc: 0.8769
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9630
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-Product                   | Epoch:19 | Val Acc: 0.8837
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 1.0123 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.2802 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 2.0642 | Train Acc: 0.3469
 Site-Clipart                       | Train Loss: 0.6815 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 0.0718 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1589 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8372 | Train Acc: 0.7018
 Site-Art                           | Train Loss: 0.0483 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0538 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1407 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0950 | Train Acc: 0.9688
Average Train Accuracy: 0.8161
 Site-Clipart                       | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0812 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2249 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.4440 | Val  Acc: 0.8404
 Site-Art                           | Val  Loss: 0.0160 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2067 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 0.2027 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.1424 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3970 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9531
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.9878 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1855 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.9358 | Train Acc: 0.3878
 Site-Clipart                       | Train Loss: 0.6006 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.0493 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1464 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7507 | Train Acc: 0.7368
 Site-Art                           | Train Loss: 0.0446 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0850 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1051 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.1360 | Train Acc: 0.9688
Average Train Accuracy: 0.8324
 Site-Clipart                       | Val  Loss: 0.0426 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0326 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0457 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1675 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.4503 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1759 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.1226 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1445 | Val  Acc: 0.9783
 Site-Product                       | Val  Loss: 0.3153 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9572
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.7979
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 0.8769
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9783
 Best site-Product                   | Epoch:21 | Val Acc: 0.9302
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.8763 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.2638 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 2.0215 | Train Acc: 0.3673
 Site-Clipart                       | Train Loss: 0.4721 | Train Acc: 0.7831
 Site-Clipart                       | Train Loss: 0.0521 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1168 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8051 | Train Acc: 0.7193
 Site-Art                           | Train Loss: 0.0427 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0427 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1058 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.0869 | Train Acc: 0.9844
Average Train Accuracy: 0.8346
 Site-Clipart                       | Val  Loss: 0.0794 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0258 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0724 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1709 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3932 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0356 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1571 | Val  Acc: 0.8615
 Site-RealWorld                     | Val  Loss: 0.1992 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.0923 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3388 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9532
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.9279 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.2637 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 2.2813 | Train Acc: 0.2857
 Site-Clipart                       | Train Loss: 0.5827 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0414 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1052 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8214 | Train Acc: 0.6842
 Site-Art                           | Train Loss: 0.0424 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0823 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0926 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.1226 | Train Acc: 0.9688
Average Train Accuracy: 0.8248
 Site-Clipart                       | Val  Loss: 0.0337 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0565 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1474 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.4209 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0382 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1463 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.1329 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0779 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3138 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9617
 Best site-Clipart                   | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9818
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.7979
 Best site-Art                       | Epoch:23 | Val Acc: 1.0000
 Best site-Art                       | Epoch:23 | Val Acc: 1.0000
 Best site-Art                       | Epoch:23 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:23 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:23 | Val Acc: 1.0000
 Best site-Product                   | Epoch:23 | Val Acc: 0.9070
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.9112 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.0432 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.8215 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.5349 | Train Acc: 0.8193
 Site-Clipart                       | Train Loss: 0.0429 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1300 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6784 | Train Acc: 0.7544
 Site-Art                           | Train Loss: 0.0435 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0483 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1037 | Train Acc: 0.9565
 Site-Product                       | Train Loss: 0.0733 | Train Acc: 0.9844
Average Train Accuracy: 0.8481
 Site-Clipart                       | Val  Loss: 0.0219 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0407 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1661 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3891 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1534 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.1042 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0801 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3780 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9606
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.9996 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1645 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.9986 | Train Acc: 0.2653
 Site-Clipart                       | Train Loss: 0.4850 | Train Acc: 0.7952
 Site-Clipart                       | Train Loss: 0.0461 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1154 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7624 | Train Acc: 0.7544
 Site-Art                           | Train Loss: 0.0302 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0531 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0621 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0561 | Train Acc: 1.0000
Average Train Accuracy: 0.8399
 Site-Clipart                       | Val  Loss: 0.0339 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0540 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1304 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.4322 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1415 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.1444 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1015 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3489 | Val  Acc: 0.8605
Average Valid Accuracy: 0.9570
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.9136 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.1048 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 2.0413 | Train Acc: 0.3673
 Site-Clipart                       | Train Loss: 0.5431 | Train Acc: 0.8313
 Site-Clipart                       | Train Loss: 0.0584 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1740 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.6546 | Train Acc: 0.7719
 Site-Art                           | Train Loss: 0.0279 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0701 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0879 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0565 | Train Acc: 0.9844
Average Train Accuracy: 0.8470
 Site-Clipart                       | Val  Loss: 0.0338 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0192 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0579 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.1264 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3931 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0285 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1294 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0997 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0982 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3586 | Val  Acc: 0.8837
Average Valid Accuracy: 0.9575
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.8817 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.0602 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 2.2012 | Train Acc: 0.3673
 Site-Clipart                       | Train Loss: 0.4569 | Train Acc: 0.8554
 Site-Clipart                       | Train Loss: 0.0314 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0291 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7355 | Train Acc: 0.7719
 Site-Art                           | Train Loss: 0.0242 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0456 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0703 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0568 | Train Acc: 0.9844
Average Train Accuracy: 0.8522
 Site-Clipart                       | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0379 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1379 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3771 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0661 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.1413 | Val  Acc: 0.8769
 Site-RealWorld                     | Val  Loss: 0.0752 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0868 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2551 | Val  Acc: 0.9070
Average Valid Accuracy: 0.9604
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.6506 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.0064 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.8905 | Train Acc: 0.4286
 Site-Clipart                       | Train Loss: 0.4754 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0553 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0993 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6276 | Train Acc: 0.8246
 Site-Art                           | Train Loss: 0.0266 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0225 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0607 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.0716 | Train Acc: 0.9844
Average Train Accuracy: 0.8668
 Site-Clipart                       | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1584 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3886 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1198 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0971 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0638 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2700 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9636
 Best site-Clipart                   | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8085
 Best site-Art                       | Epoch:28 | Val Acc: 1.0000
 Best site-Art                       | Epoch:28 | Val Acc: 1.0000
 Best site-Art                       | Epoch:28 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-Product                   | Epoch:28 | Val Acc: 0.9535
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.8987 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.9953 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.9484 | Train Acc: 0.3878
 Site-Clipart                       | Train Loss: 0.4604 | Train Acc: 0.8193
 Site-Clipart                       | Train Loss: 0.0355 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.0712 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6342 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0222 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0645 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0456 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0548 | Train Acc: 0.9844
Average Train Accuracy: 0.8619
 Site-Clipart                       | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0239 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0347 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1340 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.3129 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1243 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.0587 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0541 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2154 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9718
 Best site-Clipart                   | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9818
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8617
 Best site-Art                       | Epoch:29 | Val Acc: 1.0000
 Best site-Art                       | Epoch:29 | Val Acc: 1.0000
 Best site-Art                       | Epoch:29 | Val Acc: 0.8923
 Best site-RealWorld                 | Epoch:29 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:29 | Val Acc: 1.0000
 Best site-Product                   | Epoch:29 | Val Acc: 0.9535
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.7691 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1053 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 2.0918 | Train Acc: 0.4082
 Site-Clipart                       | Train Loss: 0.4695 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0316 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1026 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6352 | Train Acc: 0.7368
 Site-Art                           | Train Loss: 0.0242 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1045 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 0.0523 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0580 | Train Acc: 0.9844
Average Train Accuracy: 0.8530
 Site-Clipart                       | Val  Loss: 0.0215 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0133 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1602 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3359 | Val  Acc: 0.8723
 Site-Art                           | Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1453 | Val  Acc: 0.8923
 Site-RealWorld                     | Val  Loss: 0.1427 | Val  Acc: 0.9259
 Site-RealWorld                     | Val  Loss: 0.0517 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2260 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9627
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.7870 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.8896 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.8337 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.4279 | Train Acc: 0.8193
 Site-Clipart                       | Train Loss: 0.0292 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0659 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5259 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0169 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0345 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0759 | Train Acc: 0.9710
 Site-Product                       | Train Loss: 0.0518 | Train Acc: 0.9844
Average Train Accuracy: 0.8749
 Site-Clipart                       | Val  Loss: 0.0203 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0264 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1513 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.3279 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0374 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1105 | Val  Acc: 0.9385
 Site-RealWorld                     | Val  Loss: 0.0624 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0411 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2739 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9689
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.7372 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.1206 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.8401 | Train Acc: 0.4082
 Site-Clipart                       | Train Loss: 0.4487 | Train Acc: 0.8554
 Site-Clipart                       | Train Loss: 0.0292 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2302 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.5941 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0227 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0724 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0753 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0609 | Train Acc: 0.9844
Average Train Accuracy: 0.8636
 Site-Clipart                       | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1761 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3355 | Val  Acc: 0.8511
 Site-Art                           | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1188 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0804 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0647 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1955 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9689
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.6584 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.0105 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.7444 | Train Acc: 0.3469
 Site-Clipart                       | Train Loss: 0.4456 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 0.0257 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6679 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0171 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0376 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1065 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0795 | Train Acc: 0.9688
Average Train Accuracy: 0.8567
 Site-Clipart                       | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0261 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1615 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.2860 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1171 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0906 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.0369 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2514 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9662
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.8517 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1865 | Train Acc: 0.6552
 Site-Clipart                       | Train Loss: 1.6902 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.4903 | Train Acc: 0.8554
 Site-Clipart                       | Train Loss: 0.0318 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1455 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7144 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 0.0173 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0171 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0365 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0314 | Train Acc: 1.0000
Average Train Accuracy: 0.8621
 Site-Clipart                       | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1326 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3042 | Val  Acc: 0.8723
 Site-Art                           | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0979 | Val  Acc: 0.9385
 Site-RealWorld                     | Val  Loss: 0.1000 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0523 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2004 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9753
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8723
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-Art                       | Epoch:34 | Val Acc: 0.9385
 Best site-RealWorld                 | Epoch:34 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:34 | Val Acc: 1.0000
 Best site-Product                   | Epoch:34 | Val Acc: 0.9535
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.8498 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 1.1424 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.8043 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.5345 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 0.0200 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1208 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.4918 | Train Acc: 0.8596
 Site-Art                           | Train Loss: 0.0163 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0256 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0390 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0663 | Train Acc: 0.9844
Average Train Accuracy: 0.8601
 Site-Clipart                       | Val  Loss: 0.0175 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1753 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3568 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0231 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0996 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0579 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0454 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1817 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9664
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.7252 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.0227 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.4341 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.3772 | Train Acc: 0.8313
 Site-Clipart                       | Train Loss: 0.0231 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1050 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5779 | Train Acc: 0.7719
 Site-Art                           | Train Loss: 0.0109 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0411 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2060 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0191 | Train Acc: 1.0000
Average Train Accuracy: 0.8711
 Site-Clipart                       | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1323 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3279 | Val  Acc: 0.8723
 Site-Art                           | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1303 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0576 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2286 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9739
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.7467 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.9175 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.6974 | Train Acc: 0.4286
 Site-Clipart                       | Train Loss: 0.4214 | Train Acc: 0.7952
 Site-Clipart                       | Train Loss: 0.0201 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1755 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5236 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0182 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0203 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0505 | Train Acc: 0.9855
 Site-Product                       | Train Loss: 0.0584 | Train Acc: 0.9844
Average Train Accuracy: 0.8716
 Site-Clipart                       | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0861 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2897 | Val  Acc: 0.8830
 Site-Art                           | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1048 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0709 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0351 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2608 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9746
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.6461 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 1.2343 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.6243 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.3757 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0234 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0355 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5239 | Train Acc: 0.8596
 Site-Art                           | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0541 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0473 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0358 | Train Acc: 1.0000
Average Train Accuracy: 0.8839
 Site-Clipart                       | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0228 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0184 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1381 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.3463 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1190 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0734 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2965 | Val  Acc: 0.8837
Average Valid Accuracy: 0.9591
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.5776 | Train Acc: 0.8824
 Site-Clipart                       | Train Loss: 0.8177 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.6954 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.4156 | Train Acc: 0.8313
 Site-Clipart                       | Train Loss: 0.0194 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1082 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5179 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0773 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 0.0343 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0226 | Train Acc: 1.0000
Average Train Accuracy: 0.8835
 Site-Clipart                       | Val  Loss: 0.0219 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0720 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.3440 | Val  Acc: 0.8404
 Site-Art                           | Val  Loss: 0.0312 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0250 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1190 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0580 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2080 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9712
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.7858 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.7251 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.5678 | Train Acc: 0.4694
 Site-Clipart                       | Train Loss: 0.3253 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0293 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5313 | Train Acc: 0.8246
 Site-Art                           | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0375 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0310 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0457 | Train Acc: 0.9844
Average Train Accuracy: 0.8800
 Site-Clipart                       | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1175 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 0.2609 | Val  Acc: 0.8936
 Site-Art                           | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0895 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0622 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0528 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1927 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9741
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.8890 | Train Acc: 0.7059
 Site-Clipart                       | Train Loss: 1.0209 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.7787 | Train Acc: 0.4082
 Site-Clipart                       | Train Loss: 0.3909 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 0.0162 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0533 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.4845 | Train Acc: 0.8596
 Site-Art                           | Train Loss: 0.0160 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0565 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0341 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0407 | Train Acc: 0.9844
Average Train Accuracy: 0.8577
 Site-Clipart                       | Val  Loss: 0.0102 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0225 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2408 | Val  Acc: 0.8727
 Site-Clipart                       | Val  Loss: 0.2971 | Val  Acc: 0.8830
 Site-Art                           | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0988 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0438 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0389 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1184 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9687
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.7798 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.7912 | Train Acc: 0.6897
 Site-Clipart                       | Train Loss: 1.5186 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.3984 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0240 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0990 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5256 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0106 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0285 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0350 | Train Acc: 1.0000
Average Train Accuracy: 0.8745
 Site-Clipart                       | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0374 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0948 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3103 | Val  Acc: 0.8511
 Site-Art                           | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0912 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0441 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2151 | Val  Acc: 0.9302
Average Valid Accuracy: 0.9698
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.7339 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.7094 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.7006 | Train Acc: 0.4490
 Site-Clipart                       | Train Loss: 0.4794 | Train Acc: 0.8313
 Site-Clipart                       | Train Loss: 0.0156 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0570 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4716 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0080 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0277 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0232 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0322 | Train Acc: 1.0000
Average Train Accuracy: 0.8800
 Site-Clipart                       | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0956 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.3335 | Val  Acc: 0.8723
 Site-Art                           | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0123 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1249 | Val  Acc: 0.9077
 Site-RealWorld                     | Val  Loss: 0.0419 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0475 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1674 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9762
 Best site-Clipart                   | Epoch:43 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:43 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:43 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9818
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.8723
 Best site-Art                       | Epoch:43 | Val Acc: 1.0000
 Best site-Art                       | Epoch:43 | Val Acc: 1.0000
 Best site-Art                       | Epoch:43 | Val Acc: 0.9077
 Best site-RealWorld                 | Epoch:43 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:43 | Val Acc: 1.0000
 Best site-Product                   | Epoch:43 | Val Acc: 0.9767
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.6235 | Train Acc: 0.8824
 Site-Clipart                       | Train Loss: 0.7319 | Train Acc: 0.7586
 Site-Clipart                       | Train Loss: 1.4525 | Train Acc: 0.5306
 Site-Clipart                       | Train Loss: 0.3914 | Train Acc: 0.8554
 Site-Clipart                       | Train Loss: 0.0525 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.0491 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6186 | Train Acc: 0.8070
 Site-Art                           | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0890 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0403 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0383 | Train Acc: 1.0000
Average Train Accuracy: 0.8911
 Site-Clipart                       | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0878 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.2852 | Val  Acc: 0.8723
 Site-Art                           | Val  Loss: 0.0393 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1092 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0270 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0282 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1784 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9739
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.6888 | Train Acc: 0.7647
 Site-Clipart                       | Train Loss: 0.8433 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.4973 | Train Acc: 0.5102
 Site-Clipart                       | Train Loss: 0.4075 | Train Acc: 0.8434
 Site-Clipart                       | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0838 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5108 | Train Acc: 0.8772
 Site-Art                           | Train Loss: 0.0088 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0877 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 0.0570 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0362 | Train Acc: 0.9844
Average Train Accuracy: 0.8772
 Site-Clipart                       | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1244 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3096 | Val  Acc: 0.8830
 Site-Art                           | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0812 | Val  Acc: 0.9692
 Site-RealWorld                     | Val  Loss: 0.0437 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1391 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9811
 Best site-Clipart                   | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.8830
 Best site-Art                       | Epoch:45 | Val Acc: 1.0000
 Best site-Art                       | Epoch:45 | Val Acc: 1.0000
 Best site-Art                       | Epoch:45 | Val Acc: 0.9692
 Best site-RealWorld                 | Epoch:45 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:45 | Val Acc: 1.0000
 Best site-Product                   | Epoch:45 | Val Acc: 0.9767
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.5123 | Train Acc: 0.8824
 Site-Clipart                       | Train Loss: 0.5838 | Train Acc: 0.8621
 Site-Clipart                       | Train Loss: 1.3913 | Train Acc: 0.5714
 Site-Clipart                       | Train Loss: 0.5681 | Train Acc: 0.8554
 Site-Clipart                       | Train Loss: 0.0254 | Train Acc: 0.9930
 Site-Art                           | Train Loss: 0.1575 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.5670 | Train Acc: 0.8246
 Site-Art                           | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0274 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0285 | Train Acc: 1.0000
Average Train Accuracy: 0.9053
 Site-Clipart                       | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0821 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3129 | Val  Acc: 0.8617
 Site-Art                           | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1031 | Val  Acc: 0.9538
 Site-RealWorld                     | Val  Loss: 0.0658 | Val  Acc: 0.9630
 Site-RealWorld                     | Val  Loss: 0.0371 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1690 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9744
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.6675 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.5571 | Train Acc: 0.8621
 Site-Clipart                       | Train Loss: 1.2432 | Train Acc: 0.5918
 Site-Clipart                       | Train Loss: 0.4196 | Train Acc: 0.8313
 Site-Clipart                       | Train Loss: 0.0166 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0472 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4813 | Train Acc: 0.8596
 Site-Art                           | Train Loss: 0.0089 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0248 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0247 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0747 | Train Acc: 0.9688
Average Train Accuracy: 0.9034
 Site-Clipart                       | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0062 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1075 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.3891 | Val  Acc: 0.8404
 Site-Art                           | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0691 | Val  Acc: 0.9692
 Site-RealWorld                     | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0326 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1749 | Val  Acc: 0.9767
Average Valid Accuracy: 0.9773
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.6598 | Train Acc: 0.8235
 Site-Clipart                       | Train Loss: 0.7669 | Train Acc: 0.7241
 Site-Clipart                       | Train Loss: 1.2645 | Train Acc: 0.5918
 Site-Clipart                       | Train Loss: 0.3771 | Train Acc: 0.8193
 Site-Clipart                       | Train Loss: 0.0174 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1805 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.4942 | Train Acc: 0.8421
 Site-Art                           | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0203 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0470 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0366 | Train Acc: 0.9844
Average Train Accuracy: 0.8868
 Site-Clipart                       | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0737 | Val  Acc: 0.9818
 Site-Clipart                       | Val  Loss: 0.3083 | Val  Acc: 0.8511
 Site-Art                           | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0938 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.0394 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1642 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9736
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.5360 | Train Acc: 0.9412
 Site-Clipart                       | Train Loss: 0.6660 | Train Acc: 0.7931
 Site-Clipart                       | Train Loss: 1.3102 | Train Acc: 0.5714
 Site-Clipart                       | Train Loss: 0.3405 | Train Acc: 0.8675
 Site-Clipart                       | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0196 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4385 | Train Acc: 0.8596
 Site-Art                           | Train Loss: 0.0142 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0445 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0325 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0162 | Train Acc: 1.0000
Average Train Accuracy: 0.9121
 Site-Clipart                       | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1371 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.2637 | Val  Acc: 0.8830
 Site-Art                           | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0838 | Val  Acc: 0.9385
 Site-RealWorld                     | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0193 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1369 | Val  Acc: 0.9535
Average Valid Accuracy: 0.9713
===2023-08-01 18:33:05===
===2023-08-01 18:33:20===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[17,29,49,83,142,33,57,97,41,69,64,
client_nums=[5,3,2,1,]
len_dataset=[537,315,185,108,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (1)| Epoch:45 | Test Acc: 0.5404
 Test site-Art                       (1)| Epoch:45 | Test Acc: 0.6211
 Test site-RealWorld                 (1)| Epoch:45 | Test Acc: 0.6151
 Test site-Product                   (1)| Epoch:45 | Test Acc: 0.5821
Clipart: 0.5404, Art: 0.6211, RealWorld: 0.6151, Product: 0.5821, 
Average Test Accuracy(group): 0.5897, Average Test Accuracy(individual): 0.5798,
domain std=0.0321, cluster std=0.0183, individual std=0.0374, 
===2023-08-02 12:46:53===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[11,19,33,56,96,22,38,66,27,47,43,
client_nums=[5,3,2,1,]
len_dataset=[364,214,125,73,]
domain number = 4
============ Train epoch 0 ============
 Site-Art                           | Train Loss: 1.7730 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.7978 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.9035 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 2.1456 | Train Acc: 0.4464
 Site-Art                           | Train Loss: 1.9524 | Train Acc: 0.8125
 Site-RealWorld                     | Train Loss: 1.7788 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7649 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.9415 | Train Acc: 0.9697
 Site-Product                       | Train Loss: 1.8395 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.9024 | Train Acc: 0.9362
 Site-Clipart                       | Train Loss: 1.8595 | Train Acc: 0.9070
Average Train Accuracy: 0.8860
 Site-Art                           | Val  Loss: 1.8439 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.8936 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 1.8970 | Val  Acc: 0.7727
 Site-Art                           | Val  Loss: 2.0252 | Val  Acc: 0.6486
 Site-Art                           | Val  Loss: 2.1186 | Val  Acc: 0.4688
 Site-RealWorld                     | Val  Loss: 1.9266 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 1.9119 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8490 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.9329 | Val  Acc: 0.9444
 Site-Product                       | Val  Loss: 1.8613 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.9215 | Val  Acc: 0.8966
Average Valid Accuracy: 0.8516
 Best site-Art                       | Epoch:0 | Val Acc: 0.8571
 Best site-Art                       | Epoch:0 | Val Acc: 0.8462
 Best site-Art                       | Epoch:0 | Val Acc: 0.7727
 Best site-Art                       | Epoch:0 | Val Acc: 0.6486
 Best site-Art                       | Epoch:0 | Val Acc: 0.4688
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:0 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 1.0000
 Best site-Product                   | Epoch:0 | Val Acc: 0.9444
 Best site-Product                   | Epoch:0 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.8966
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 1 ============
 Site-Art                           | Train Loss: 1.4151 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.3964 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.5476 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.9800 | Train Acc: 0.6071
 Site-Art                           | Train Loss: 1.6536 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.3165 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3718 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4556 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.4104 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.5144 | Train Acc: 0.9574
 Site-Clipart                       | Train Loss: 1.5043 | Train Acc: 1.0000
Average Train Accuracy: 0.9381
 Site-Art                           | Val  Loss: 1.5399 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5559 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5717 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.8225 | Val  Acc: 0.6757
 Site-Art                           | Val  Loss: 1.9464 | Val  Acc: 0.5625
 Site-RealWorld                     | Val  Loss: 1.4811 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4822 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4265 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5357 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4321 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.5833 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9235
 Best site-Art                       | Epoch:1 | Val Acc: 1.0000
 Best site-Art                       | Epoch:1 | Val Acc: 1.0000
 Best site-Art                       | Epoch:1 | Val Acc: 0.9545
 Best site-Art                       | Epoch:1 | Val Acc: 0.6757
 Best site-Art                       | Epoch:1 | Val Acc: 0.5625
 Best site-RealWorld                 | Epoch:1 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 1.0000
 Best site-Product                   | Epoch:1 | Val Acc: 1.0000
 Best site-Product                   | Epoch:1 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.9655
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 2 ============
 Site-Art                           | Train Loss: 1.0188 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.0340 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.2747 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.8266 | Train Acc: 0.6071
 Site-Art                           | Train Loss: 1.4086 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.9288 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9824 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1486 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0432 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1249 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.2001 | Train Acc: 0.9535
Average Train Accuracy: 0.9433
 Site-Art                           | Val  Loss: 1.2169 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2803 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.2934 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.5985 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.8055 | Val  Acc: 0.6406
 Site-RealWorld                     | Val  Loss: 1.1684 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1650 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0844 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1761 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0868 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.2621 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9365
 Best site-Art                       | Epoch:2 | Val Acc: 1.0000
 Best site-Art                       | Epoch:2 | Val Acc: 0.9231
 Best site-Art                       | Epoch:2 | Val Acc: 0.9545
 Best site-Art                       | Epoch:2 | Val Acc: 0.7838
 Best site-Art                       | Epoch:2 | Val Acc: 0.6406
 Best site-RealWorld                 | Epoch:2 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 1.0000
 Best site-Product                   | Epoch:2 | Val Acc: 1.0000
 Best site-Product                   | Epoch:2 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:2 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 3 ============
 Site-Art                           | Train Loss: 0.7423 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7698 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.9721 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.7148 | Train Acc: 0.6071
 Site-Art                           | Train Loss: 1.1948 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.6422 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7229 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8616 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7391 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8729 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.9108 | Train Acc: 0.9767
Average Train Accuracy: 0.9546
 Site-Art                           | Val  Loss: 0.9767 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9713 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0081 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4357 | Val  Acc: 0.8108
 Site-Art                           | Val  Loss: 1.6882 | Val  Acc: 0.6250
 Site-RealWorld                     | Val  Loss: 0.8824 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8693 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7699 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8911 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8103 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.0767 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9487
 Best site-Art                       | Epoch:3 | Val Acc: 1.0000
 Best site-Art                       | Epoch:3 | Val Acc: 1.0000
 Best site-Art                       | Epoch:3 | Val Acc: 1.0000
 Best site-Art                       | Epoch:3 | Val Acc: 0.8108
 Best site-Art                       | Epoch:3 | Val Acc: 0.6250
 Best site-RealWorld                 | Epoch:3 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 1.0000
 Best site-Product                   | Epoch:3 | Val Acc: 1.0000
 Best site-Product                   | Epoch:3 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:3 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 4 ============
 Site-Art                           | Train Loss: 0.5584 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4942 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8243 | Train Acc: 0.8788
 Site-Art                           | Train Loss: 1.6038 | Train Acc: 0.5893
 Site-Art                           | Train Loss: 0.9514 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.4643 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.4730 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6418 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5191 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6462 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.7236 | Train Acc: 1.0000
Average Train Accuracy: 0.9478
 Site-Art                           | Val  Loss: 0.7206 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7675 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8338 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2873 | Val  Acc: 0.8108
 Site-Art                           | Val  Loss: 1.5562 | Val  Acc: 0.6406
 Site-RealWorld                     | Val  Loss: 0.6100 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6108 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5236 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6282 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5704 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.7955 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9501
 Best site-Art                       | Epoch:4 | Val Acc: 1.0000
 Best site-Art                       | Epoch:4 | Val Acc: 1.0000
 Best site-Art                       | Epoch:4 | Val Acc: 1.0000
 Best site-Art                       | Epoch:4 | Val Acc: 0.8108
 Best site-Art                       | Epoch:4 | Val Acc: 0.6406
 Best site-RealWorld                 | Epoch:4 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:4 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:4 | Val Acc: 1.0000
 Best site-Product                   | Epoch:4 | Val Acc: 1.0000
 Best site-Product                   | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:4 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 5 ============
 Site-Art                           | Train Loss: 0.3791 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.3827 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6556 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.4793 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 0.8309 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.3426 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.3075 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.5008 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3351 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4468 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.5405 | Train Acc: 1.0000
Average Train Accuracy: 0.9541
 Site-Art                           | Val  Loss: 0.5560 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6732 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.6578 | Val  Acc: 0.9091
 Site-Art                           | Val  Loss: 1.1176 | Val  Acc: 0.8919
 Site-Art                           | Val  Loss: 1.4865 | Val  Acc: 0.6094
 Site-RealWorld                     | Val  Loss: 0.4635 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4215 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3738 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.4529 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3916 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6330 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9394
============ Train epoch 6 ============
 Site-Art                           | Train Loss: 0.3381 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2925 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4838 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.4368 | Train Acc: 0.6071
 Site-Art                           | Train Loss: 0.6806 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.1980 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2560 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2462 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2257 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3354 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.4125 | Train Acc: 1.0000
Average Train Accuracy: 0.9540
 Site-Art                           | Val  Loss: 0.4648 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5019 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.5103 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0175 | Val  Acc: 0.8108
 Site-Art                           | Val  Loss: 1.3426 | Val  Acc: 0.6562
 Site-RealWorld                     | Val  Loss: 0.3011 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3037 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2901 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3207 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2644 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5113 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9446
============ Train epoch 7 ============
 Site-Art                           | Train Loss: 0.3068 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.1912 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4302 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.3428 | Train Acc: 0.6964
 Site-Art                           | Train Loss: 0.5777 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.1529 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1680 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.3846 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1686 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2725 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.3787 | Train Acc: 1.0000
Average Train Accuracy: 0.9557
 Site-Art                           | Val  Loss: 0.3941 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3929 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4404 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9310 | Val  Acc: 0.8378
 Site-Art                           | Val  Loss: 1.2392 | Val  Acc: 0.7500
 Site-RealWorld                     | Val  Loss: 0.2130 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2177 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2155 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2793 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1945 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3980 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9625
 Best site-Art                       | Epoch:7 | Val Acc: 1.0000
 Best site-Art                       | Epoch:7 | Val Acc: 1.0000
 Best site-Art                       | Epoch:7 | Val Acc: 1.0000
 Best site-Art                       | Epoch:7 | Val Acc: 0.8378
 Best site-Art                       | Epoch:7 | Val Acc: 0.7500
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:7 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 8 ============
 Site-Art                           | Train Loss: 0.1439 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1384 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.3781 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.2238 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 0.5238 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.0949 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1489 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1052 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0931 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1890 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.2939 | Train Acc: 1.0000
Average Train Accuracy: 0.9595
 Site-Art                           | Val  Loss: 0.3097 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3756 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.4012 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 0.8267 | Val  Acc: 0.8108
 Site-Art                           | Val  Loss: 1.1860 | Val  Acc: 0.7188
 Site-RealWorld                     | Val  Loss: 0.1720 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1803 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1316 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1973 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1216 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3478 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9461
============ Train epoch 9 ============
 Site-Art                           | Train Loss: 0.1689 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1239 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2575 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.2015 | Train Acc: 0.6607
 Site-Art                           | Train Loss: 0.3892 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.0803 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0725 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1204 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0579 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1208 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.2201 | Train Acc: 1.0000
Average Train Accuracy: 0.9654
 Site-Art                           | Val  Loss: 0.2396 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2883 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2895 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 0.7647 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.1062 | Val  Acc: 0.7812
 Site-RealWorld                     | Val  Loss: 0.1601 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1464 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0954 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1334 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1017 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2454 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9563
============ Train epoch 10 ============
 Site-Art                           | Train Loss: 0.0599 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0714 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2407 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1471 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 0.3371 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.0398 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0613 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0736 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0402 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1092 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.1881 | Train Acc: 1.0000
Average Train Accuracy: 0.9660
 Site-Art                           | Val  Loss: 0.1680 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1546 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2118 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6117 | Val  Acc: 0.8649
 Site-Art                           | Val  Loss: 1.0678 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 0.0996 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1068 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0718 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0906 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0697 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2053 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9636
 Best site-Art                       | Epoch:10 | Val Acc: 1.0000
 Best site-Art                       | Epoch:10 | Val Acc: 1.0000
 Best site-Art                       | Epoch:10 | Val Acc: 1.0000
 Best site-Art                       | Epoch:10 | Val Acc: 0.8649
 Best site-Art                       | Epoch:10 | Val Acc: 0.7344
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-Product                   | Epoch:10 | Val Acc: 1.0000
 Best site-Product                   | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:10 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 11 ============
 Site-Art                           | Train Loss: 0.1347 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0728 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2512 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.0733 | Train Acc: 0.7500
 Site-Art                           | Train Loss: 0.3053 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0277 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0400 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0668 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0313 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0887 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.1628 | Train Acc: 1.0000
Average Train Accuracy: 0.9716
 Site-Art                           | Val  Loss: 0.1518 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1501 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2281 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 0.5845 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 1.0061 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 0.0748 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0573 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0502 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0830 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0561 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2142 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9668
 Best site-Art                       | Epoch:11 | Val Acc: 1.0000
 Best site-Art                       | Epoch:11 | Val Acc: 1.0000
 Best site-Art                       | Epoch:11 | Val Acc: 0.9545
 Best site-Art                       | Epoch:11 | Val Acc: 0.9459
 Best site-Art                       | Epoch:11 | Val Acc: 0.7344
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-Product                   | Epoch:11 | Val Acc: 1.0000
 Best site-Product                   | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:11 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 12 ============
 Site-Art                           | Train Loss: 0.1860 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.0548 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1982 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.0426 | Train Acc: 0.7679
 Site-Art                           | Train Loss: 0.2438 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.0183 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0700 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0342 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0745 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.1303 | Train Acc: 1.0000
Average Train Accuracy: 0.9603
 Site-Art                           | Val  Loss: 0.1326 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2301 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.2367 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5106 | Val  Acc: 0.9189
 Site-Art                           | Val  Loss: 0.9903 | Val  Acc: 0.7812
 Site-RealWorld                     | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0423 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0672 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0397 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1498 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9657
============ Train epoch 13 ============
 Site-Art                           | Train Loss: 0.0324 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0619 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.2154 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.0503 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 0.2366 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.0240 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0345 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0311 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0694 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.1022 | Train Acc: 1.0000
Average Train Accuracy: 0.9666
 Site-Art                           | Val  Loss: 0.0965 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1236 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1456 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3933 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.9202 | Val  Acc: 0.7500
 Site-RealWorld                     | Val  Loss: 0.0426 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0315 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0483 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0389 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1405 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9724
 Best site-Art                       | Epoch:13 | Val Acc: 1.0000
 Best site-Art                       | Epoch:13 | Val Acc: 1.0000
 Best site-Art                       | Epoch:13 | Val Acc: 1.0000
 Best site-Art                       | Epoch:13 | Val Acc: 0.9459
 Best site-Art                       | Epoch:13 | Val Acc: 0.7500
 Best site-RealWorld                 | Epoch:13 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:13 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:13 | Val Acc: 1.0000
 Best site-Product                   | Epoch:13 | Val Acc: 1.0000
 Best site-Product                   | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:13 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 14 ============
 Site-Art                           | Train Loss: 0.0665 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0614 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1825 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9619 | Train Acc: 0.8036
 Site-Art                           | Train Loss: 0.1843 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.0748 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.0189 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0358 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0646 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.1115 | Train Acc: 1.0000
Average Train Accuracy: 0.9714
 Site-Art                           | Val  Loss: 0.0811 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1921 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.1375 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4197 | Val  Acc: 0.9189
 Site-Art                           | Val  Loss: 0.8643 | Val  Acc: 0.8125
 Site-RealWorld                     | Val  Loss: 0.0363 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0356 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0197 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1342 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9686
============ Train epoch 15 ============
 Site-Art                           | Train Loss: 0.1266 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0193 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1517 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9500 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 0.1937 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.0088 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0104 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0199 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0097 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0642 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.0955 | Train Acc: 1.0000
Average Train Accuracy: 0.9739
 Site-Art                           | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1473 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.1043 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3398 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.7788 | Val  Acc: 0.8125
 Site-RealWorld                     | Val  Loss: 0.0267 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0249 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0283 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.1202 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9710
============ Train epoch 16 ============
 Site-Art                           | Train Loss: 0.0510 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0627 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1436 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.9488 | Train Acc: 0.7679
 Site-Art                           | Train Loss: 0.1417 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0109 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0472 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0230 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0064 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0300 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0743 | Train Acc: 1.0000
Average Train Accuracy: 0.9779
 Site-Art                           | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0798 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1020 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3391 | Val  Acc: 0.9189
 Site-Art                           | Val  Loss: 0.7726 | Val  Acc: 0.7969
 Site-RealWorld                     | Val  Loss: 0.0260 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0146 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0474 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0164 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0842 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9742
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 0.9189
 Best site-Art                       | Epoch:16 | Val Acc: 0.7969
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-Product                   | Epoch:16 | Val Acc: 1.0000
 Best site-Product                   | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:16 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 17 ============
 Site-Art                           | Train Loss: 0.1247 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1444 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.0067 | Train Acc: 0.7321
 Site-Art                           | Train Loss: 0.1366 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0251 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0121 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0146 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0417 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0801 | Train Acc: 1.0000
Average Train Accuracy: 0.9609
 Site-Art                           | Val  Loss: 0.0487 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1282 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1036 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 0.3192 | Val  Acc: 0.9189
 Site-Art                           | Val  Loss: 0.8420 | Val  Acc: 0.7969
 Site-RealWorld                     | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0153 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0177 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0943 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9700
============ Train epoch 18 ============
 Site-Art                           | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1516 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.9372 | Train Acc: 0.7679
 Site-Art                           | Train Loss: 0.1201 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0076 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0083 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0139 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0237 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0769 | Train Acc: 1.0000
Average Train Accuracy: 0.9752
 Site-Art                           | Val  Loss: 0.0444 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0554 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1127 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3472 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.8303 | Val  Acc: 0.7812
 Site-RealWorld                     | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0153 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0947 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9752
 Best site-Art                       | Epoch:18 | Val Acc: 1.0000
 Best site-Art                       | Epoch:18 | Val Acc: 1.0000
 Best site-Art                       | Epoch:18 | Val Acc: 1.0000
 Best site-Art                       | Epoch:18 | Val Acc: 0.9459
 Best site-Art                       | Epoch:18 | Val Acc: 0.7812
 Best site-RealWorld                 | Epoch:18 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:18 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:18 | Val Acc: 1.0000
 Best site-Product                   | Epoch:18 | Val Acc: 1.0000
 Best site-Product                   | Epoch:18 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:18 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 19 ============
 Site-Art                           | Train Loss: 0.1179 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.0121 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1172 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8281 | Train Acc: 0.8214
 Site-Art                           | Train Loss: 0.0935 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0786 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.0066 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0491 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0335 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0516 | Train Acc: 1.0000
Average Train Accuracy: 0.9677
 Site-Art                           | Val  Loss: 0.1037 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1044 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3268 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.7519 | Val  Acc: 0.7969
 Site-RealWorld                     | Val  Loss: 0.0144 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0144 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0598 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9766
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-Art                       | Epoch:19 | Val Acc: 0.9459
 Best site-Art                       | Epoch:19 | Val Acc: 0.7969
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-Product                   | Epoch:19 | Val Acc: 1.0000
 Best site-Product                   | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:19 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 20 ============
 Site-Art                           | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0211 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1073 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.9340 | Train Acc: 0.7321
 Site-Art                           | Train Loss: 0.1014 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0050 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0069 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0109 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0357 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.0612 | Train Acc: 1.0000
Average Train Accuracy: 0.9737
 Site-Art                           | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0746 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2542 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.7798 | Val  Acc: 0.8281
 Site-RealWorld                     | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0178 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0902 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9795
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-Art                       | Epoch:20 | Val Acc: 0.9459
 Best site-Art                       | Epoch:20 | Val Acc: 0.8281
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-Product                   | Epoch:20 | Val Acc: 1.0000
 Best site-Product                   | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:20 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 21 ============
 Site-Art                           | Train Loss: 0.1348 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.0133 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1252 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.8235 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 0.0707 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0083 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0052 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0301 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0566 | Train Acc: 1.0000
Average Train Accuracy: 0.9695
 Site-Art                           | Val  Loss: 0.0295 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0511 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0575 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2447 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.6843 | Val  Acc: 0.8281
 Site-RealWorld                     | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0110 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0431 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9819
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 0.9730
 Best site-Art                       | Epoch:21 | Val Acc: 0.8281
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-Product                   | Epoch:21 | Val Acc: 1.0000
 Best site-Product                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 22 ============
 Site-Art                           | Train Loss: 0.0417 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0252 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1346 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.8740 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 0.0838 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0141 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0374 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.0595 | Train Acc: 1.0000
Average Train Accuracy: 0.9712
 Site-Art                           | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0792 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0474 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2150 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.7583 | Val  Acc: 0.7969
 Site-RealWorld                     | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0124 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0751 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9791
============ Train epoch 23 ============
 Site-Art                           | Train Loss: 0.0719 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1231 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.7945 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 0.0768 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0217 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0534 | Train Acc: 1.0000
Average Train Accuracy: 0.9741
 Site-Art                           | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0551 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0757 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2537 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.7363 | Val  Acc: 0.8125
 Site-RealWorld                     | Val  Loss: 0.0105 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0601 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9780
============ Train epoch 24 ============
 Site-Art                           | Train Loss: 0.1142 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.0117 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1092 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.7699 | Train Acc: 0.8393
 Site-Art                           | Train Loss: 0.0657 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0106 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0430 | Train Acc: 1.0000
Average Train Accuracy: 0.9707
 Site-Art                           | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0600 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2284 | Val  Acc: 0.9189
 Site-Art                           | Val  Loss: 0.6934 | Val  Acc: 0.8281
 Site-RealWorld                     | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0540 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9770
============ Train epoch 25 ============
 Site-Art                           | Train Loss: 0.0487 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1292 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7808 | Train Acc: 0.8393
 Site-Art                           | Train Loss: 0.0537 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0128 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0285 | Train Acc: 1.0000
Average Train Accuracy: 0.9854
 Site-Art                           | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0568 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1937 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.6040 | Val  Acc: 0.8906
 Site-RealWorld                     | Val  Loss: 0.0064 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0679 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9851
 Best site-Art                       | Epoch:25 | Val Acc: 1.0000
 Best site-Art                       | Epoch:25 | Val Acc: 1.0000
 Best site-Art                       | Epoch:25 | Val Acc: 1.0000
 Best site-Art                       | Epoch:25 | Val Acc: 0.9459
 Best site-Art                       | Epoch:25 | Val Acc: 0.8906
 Best site-RealWorld                 | Epoch:25 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:25 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:25 | Val Acc: 1.0000
 Best site-Product                   | Epoch:25 | Val Acc: 1.0000
 Best site-Product                   | Epoch:25 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:25 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 26 ============
 Site-Art                           | Train Loss: 0.0683 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0284 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1331 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7257 | Train Acc: 0.8393
 Site-Art                           | Train Loss: 0.0508 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0334 | Train Acc: 1.0000
Average Train Accuracy: 0.9826
 Site-Art                           | Val  Loss: 0.0310 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0468 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0529 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1191 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.6448 | Val  Acc: 0.8125
 Site-RealWorld                     | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0675 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9805
============ Train epoch 27 ============
 Site-Art                           | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0086 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1020 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6815 | Train Acc: 0.8393
 Site-Art                           | Train Loss: 0.0508 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0360 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.0231 | Train Acc: 1.0000
Average Train Accuracy: 0.9798
 Site-Art                           | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0393 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2150 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.5824 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0374 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9837
============ Train epoch 28 ============
 Site-Art                           | Train Loss: 0.0182 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0245 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1624 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.6345 | Train Acc: 0.8393
 Site-Art                           | Train Loss: 0.0566 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0101 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0301 | Train Acc: 1.0000
Average Train Accuracy: 0.9799
 Site-Art                           | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0312 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1841 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5810 | Val  Acc: 0.8438
 Site-RealWorld                     | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0228 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0441 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9858
 Best site-Art                       | Epoch:28 | Val Acc: 1.0000
 Best site-Art                       | Epoch:28 | Val Acc: 1.0000
 Best site-Art                       | Epoch:28 | Val Acc: 1.0000
 Best site-Art                       | Epoch:28 | Val Acc: 1.0000
 Best site-Art                       | Epoch:28 | Val Acc: 0.8438
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-Product                   | Epoch:28 | Val Acc: 1.0000
 Best site-Product                   | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:28 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 29 ============
 Site-Art                           | Train Loss: 0.0436 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1102 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.7392 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 0.0602 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0284 | Train Acc: 1.0000
Average Train Accuracy: 0.9768
 Site-Art                           | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0200 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0247 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1905 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.5290 | Val  Acc: 0.9062
 Site-RealWorld                     | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0446 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9866
 Best site-Art                       | Epoch:29 | Val Acc: 1.0000
 Best site-Art                       | Epoch:29 | Val Acc: 1.0000
 Best site-Art                       | Epoch:29 | Val Acc: 1.0000
 Best site-Art                       | Epoch:29 | Val Acc: 0.9459
 Best site-Art                       | Epoch:29 | Val Acc: 0.9062
 Best site-RealWorld                 | Epoch:29 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:29 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:29 | Val Acc: 1.0000
 Best site-Product                   | Epoch:29 | Val Acc: 1.0000
 Best site-Product                   | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:29 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 30 ============
 Site-Art                           | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0201 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1348 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.6970 | Train Acc: 0.8214
 Site-Art                           | Train Loss: 0.0419 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0072 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0272 | Train Acc: 1.0000
Average Train Accuracy: 0.9773
 Site-Art                           | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0242 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1598 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.5456 | Val  Acc: 0.8594
 Site-RealWorld                     | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0941 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9848
============ Train epoch 31 ============
 Site-Art                           | Train Loss: 0.0247 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1019 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6293 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.0400 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0285 | Train Acc: 1.0000
Average Train Accuracy: 0.9861
 Site-Art                           | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0102 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0186 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1671 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.4776 | Val  Acc: 0.8906
 Site-RealWorld                     | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0521 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9876
 Best site-Art                       | Epoch:31 | Val Acc: 1.0000
 Best site-Art                       | Epoch:31 | Val Acc: 1.0000
 Best site-Art                       | Epoch:31 | Val Acc: 1.0000
 Best site-Art                       | Epoch:31 | Val Acc: 0.9730
 Best site-Art                       | Epoch:31 | Val Acc: 0.8906
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-Product                   | Epoch:31 | Val Acc: 1.0000
 Best site-Product                   | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:31 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 32 ============
 Site-Art                           | Train Loss: 0.0617 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0235 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0640 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5741 | Train Acc: 0.8929
 Site-Art                           | Train Loss: 0.0239 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0083 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0160 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0306 | Train Acc: 1.0000
Average Train Accuracy: 0.9903
 Site-Art                           | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1811 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.4943 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0525 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9837
============ Train epoch 33 ============
 Site-Art                           | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0909 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5921 | Train Acc: 0.8750
 Site-Art                           | Train Loss: 0.0342 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0103 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0218 | Train Acc: 1.0000
Average Train Accuracy: 0.9886
 Site-Art                           | Val  Loss: 0.0266 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2320 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.5376 | Val  Acc: 0.8281
 Site-RealWorld                     | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0521 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9795
============ Train epoch 34 ============
 Site-Art                           | Train Loss: 0.0537 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1051 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.6824 | Train Acc: 0.8036
 Site-Art                           | Train Loss: 0.0231 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0189 | Train Acc: 1.0000
Average Train Accuracy: 0.9766
 Site-Art                           | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0173 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0133 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1719 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.4625 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0193 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0307 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9862
============ Train epoch 35 ============
 Site-Art                           | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0604 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5695 | Train Acc: 0.8750
 Site-Art                           | Train Loss: 0.0478 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0206 | Train Acc: 1.0000
Average Train Accuracy: 0.9877
 Site-Art                           | Val  Loss: 0.0625 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1542 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.5052 | Val  Acc: 0.8594
 Site-RealWorld                     | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0284 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9823
============ Train epoch 36 ============
 Site-Art                           | Train Loss: 0.0200 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0793 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.6174 | Train Acc: 0.8214
 Site-Art                           | Train Loss: 0.0434 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0093 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0205 | Train Acc: 1.0000
Average Train Accuracy: 0.9810
 Site-Art                           | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1908 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.4718 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0422 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9837
============ Train epoch 37 ============
 Site-Art                           | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0611 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5569 | Train Acc: 0.8750
 Site-Art                           | Train Loss: 0.0264 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0322 | Train Acc: 1.0000
Average Train Accuracy: 0.9886
 Site-Art                           | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0199 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2603 | Val  Acc: 0.8919
 Site-Art                           | Val  Loss: 0.4885 | Val  Acc: 0.8438
 Site-RealWorld                     | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0437 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9760
============ Train epoch 38 ============
 Site-Art                           | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0628 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5526 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.0244 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0138 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0132 | Train Acc: 1.0000
Average Train Accuracy: 0.9870
 Site-Art                           | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2590 | Val  Acc: 0.9189
 Site-Art                           | Val  Loss: 0.4786 | Val  Acc: 0.8438
 Site-RealWorld                     | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0556 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9784
============ Train epoch 39 ============
 Site-Art                           | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0686 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5367 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.0251 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0159 | Train Acc: 1.0000
Average Train Accuracy: 0.9870
 Site-Art                           | Val  Loss: 0.0098 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1732 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.4833 | Val  Acc: 0.8281
 Site-RealWorld                     | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0471 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9819
============ Train epoch 40 ============
 Site-Art                           | Train Loss: 0.0183 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0130 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0872 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5319 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.0410 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0190 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.0214 | Train Acc: 1.0000
Average Train Accuracy: 0.9851
 Site-Art                           | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0183 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2308 | Val  Acc: 0.8919
 Site-Art                           | Val  Loss: 0.4975 | Val  Acc: 0.8594
 Site-RealWorld                     | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0461 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9774
============ Train epoch 41 ============
 Site-Art                           | Train Loss: 0.0289 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0376 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0966 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.4893 | Train Acc: 0.8929
 Site-Art                           | Train Loss: 0.0200 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0072 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0139 | Train Acc: 1.0000
Average Train Accuracy: 0.9848
 Site-Art                           | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0213 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1860 | Val  Acc: 0.9189
 Site-Art                           | Val  Loss: 0.4066 | Val  Acc: 0.9219
 Site-RealWorld                     | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0484 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9855
============ Train epoch 42 ============
 Site-Art                           | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0121 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1109 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.5289 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.0244 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0216 | Train Acc: 1.0000
Average Train Accuracy: 0.9815
 Site-Art                           | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1668 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.4107 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0374 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9894
 Best site-Art                       | Epoch:42 | Val Acc: 1.0000
 Best site-Art                       | Epoch:42 | Val Acc: 1.0000
 Best site-Art                       | Epoch:42 | Val Acc: 1.0000
 Best site-Art                       | Epoch:42 | Val Acc: 0.9459
 Best site-Art                       | Epoch:42 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-Product                   | Epoch:42 | Val Acc: 1.0000
 Best site-Product                   | Epoch:42 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:42 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 43 ============
 Site-Art                           | Train Loss: 0.0813 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0737 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4125 | Train Acc: 0.8929
 Site-Art                           | Train Loss: 0.0257 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0168 | Train Acc: 1.0000
Average Train Accuracy: 0.9903
 Site-Art                           | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0062 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0231 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1723 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.4176 | Val  Acc: 0.8906
 Site-RealWorld                     | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0400 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9876
============ Train epoch 44 ============
 Site-Art                           | Train Loss: 0.0330 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0959 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4984 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.0638 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0161 | Train Acc: 1.0000
Average Train Accuracy: 0.9861
 Site-Art                           | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1602 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.4690 | Val  Acc: 0.8594
 Site-RealWorld                     | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0342 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9823
============ Train epoch 45 ============
 Site-Art                           | Train Loss: 0.0282 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0732 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5267 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.0395 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0186 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.0169 | Train Acc: 1.0000
Average Train Accuracy: 0.9841
 Site-Art                           | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0198 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0238 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2350 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.4602 | Val  Acc: 0.8594
 Site-RealWorld                     | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0296 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9823
============ Train epoch 46 ============
 Site-Art                           | Train Loss: 0.0148 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0628 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.4319 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.0245 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0155 | Train Acc: 1.0000
Average Train Accuracy: 0.9870
 Site-Art                           | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0146 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1162 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.3160 | Val  Acc: 0.9531
 Site-RealWorld                     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0281 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9933
 Best site-Art                       | Epoch:46 | Val Acc: 1.0000
 Best site-Art                       | Epoch:46 | Val Acc: 1.0000
 Best site-Art                       | Epoch:46 | Val Acc: 1.0000
 Best site-Art                       | Epoch:46 | Val Acc: 0.9730
 Best site-Art                       | Epoch:46 | Val Acc: 0.9531
 Best site-RealWorld                 | Epoch:46 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:46 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:46 | Val Acc: 1.0000
 Best site-Product                   | Epoch:46 | Val Acc: 1.0000
 Best site-Product                   | Epoch:46 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:46 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 47 ============
 Site-Art                           | Train Loss: 0.0508 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0174 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0848 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.4990 | Train Acc: 0.8214
 Site-Art                           | Train Loss: 0.0310 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0161 | Train Acc: 1.0000
Average Train Accuracy: 0.9810
 Site-Art                           | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0238 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1058 | Val  Acc: 0.9730
 Site-Art                           | Val  Loss: 0.3615 | Val  Acc: 0.9219
 Site-RealWorld                     | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0173 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0246 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9904
============ Train epoch 48 ============
 Site-Art                           | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1148 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 0.4402 | Train Acc: 0.8750
 Site-Art                           | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0090 | Train Acc: 1.0000
Average Train Accuracy: 0.9831
 Site-Art                           | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1449 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.3622 | Val  Acc: 0.9062
 Site-RealWorld                     | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0292 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9866
============ Train epoch 49 ============
 Site-Art                           | Train Loss: 0.0879 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.1652 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 0.3884 | Train Acc: 0.9464
 Site-Art                           | Train Loss: 0.0262 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.0194 | Train Acc: 1.0000
Average Train Accuracy: 0.9924
 Site-Art                           | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.1854 | Val  Acc: 0.9459
 Site-Art                           | Val  Loss: 0.3228 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.0492 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9894
===2023-08-02 13:27:07===
===2023-08-02 13:27:10===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[11,19,33,56,96,22,38,66,27,47,43,
client_nums=[5,3,2,1,]
len_dataset=[364,214,125,73,]
domain number = 4
Loading snapshots...
 Test site-Art                       (0)| Epoch:46 | Test Acc: 0.6460
 Test site-RealWorld                 (0)| Epoch:46 | Test Acc: 0.6111
 Test site-Product                   (0)| Epoch:46 | Test Acc: 0.5473
 Test site-Clipart                   (1)| Epoch:46 | Test Acc: 0.4553
Art: 0.6460, RealWorld: 0.6111, Product: 0.5473, Clipart: 0.4553, 
Average Test Accuracy(group): 0.5649, Average Test Accuracy(individual): 0.6012,
domain std=0.0725, cluster std=0.0332, individual std=0.0583, 
===2023-08-02 16:50:58===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 20
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[35,52,78,117,175,17,38,85,13,68,48,
client_nums=[5,3,2,1,]
len_dataset=[766,236,138,81,]
domain number = 4
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 1.4315 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.5061 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 1.4847 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.4621 | Train Acc: 0.9316
 Site-amazon                        | Train Loss: 1.4515 | Train Acc: 0.9600
 Site-webcam                        | Train Loss: 1.5827 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 1.5539 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 1.5361 | Train Acc: 0.9412
 Site-caltech                       | Train Loss: 1.5201 | Train Acc: 0.9231
 Site-caltech                       | Train Loss: 1.4856 | Train Acc: 0.9412
 Site-dslr                          | Train Loss: 1.5565 | Train Acc: 0.9167
Average Train Accuracy: 0.9401
 Site-amazon                        | Val  Loss: 1.5035 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.4688 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.4947 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 1.4709 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 1.4383 | Val  Acc: 0.9487
 Site-webcam                        | Val  Loss: 1.5813 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 1.6277 | Val  Acc: 0.8400
 Site-webcam                        | Val  Loss: 1.5676 | Val  Acc: 0.9123
 Site-caltech                       | Val  Loss: 1.4965 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 1.4577 | Val  Acc: 0.9556
 Site-dslr                          | Val  Loss: 1.5618 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9149
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9412
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9487
 Best site-webcam                    | Epoch:0 | Val Acc: 0.8182
 Best site-webcam                    | Epoch:0 | Val Acc: 0.8400
 Best site-webcam                    | Epoch:0 | Val Acc: 0.9123
 Best site-caltech                   | Epoch:0 | Val Acc: 0.8889
 Best site-caltech                   | Epoch:0 | Val Acc: 0.9556
 Best site-dslr                      | Epoch:0 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 0.7850 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.9075 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.8513 | Train Acc: 0.9744
 Site-amazon                        | Train Loss: 0.8148 | Train Acc: 0.9573
 Site-amazon                        | Train Loss: 0.8305 | Train Acc: 0.9543
 Site-webcam                        | Train Loss: 1.0412 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.9677 | Train Acc: 0.9474
 Site-webcam                        | Train Loss: 0.9601 | Train Acc: 0.9294
 Site-caltech                       | Train Loss: 0.9147 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.8080 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.9624 | Train Acc: 0.9375
Average Train Accuracy: 0.9515
 Site-amazon                        | Val  Loss: 0.9485 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 0.8744 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 0.8956 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.9025 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 0.8162 | Val  Acc: 0.9316
 Site-webcam                        | Val  Loss: 1.1125 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.0342 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.9539 | Val  Acc: 0.9123
 Site-caltech                       | Val  Loss: 0.9785 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8474 | Val  Acc: 0.9556
 Site-dslr                          | Val  Loss: 0.9458 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9373
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9412
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9316
 Best site-webcam                    | Epoch:1 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:1 | Val Acc: 0.9200
 Best site-webcam                    | Epoch:1 | Val Acc: 0.9123
 Best site-caltech                   | Epoch:1 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:1 | Val Acc: 0.9556
 Best site-dslr                      | Epoch:1 | Val Acc: 0.9688
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 0.4028 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.5645 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.5712 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 0.4865 | Train Acc: 0.9573
 Site-amazon                        | Train Loss: 0.4852 | Train Acc: 0.9486
 Site-webcam                        | Train Loss: 0.7274 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.6062 | Train Acc: 0.9474
 Site-webcam                        | Train Loss: 0.6209 | Train Acc: 0.9412
 Site-caltech                       | Train Loss: 0.6252 | Train Acc: 0.9231
 Site-caltech                       | Train Loss: 0.7462 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.6355 | Train Acc: 0.9375
Average Train Accuracy: 0.9507
 Site-amazon                        | Val  Loss: 0.5458 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.4988 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.5175 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.5843 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 0.4632 | Val  Acc: 0.9487
 Site-webcam                        | Val  Loss: 0.7680 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 0.7355 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.5888 | Val  Acc: 0.9825
 Site-caltech                       | Val  Loss: 0.5570 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.4551 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.6533 | Val  Acc: 0.9375
Average Valid Accuracy: 0.9466
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9706
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9423
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9487
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8182
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9200
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9825
 Best site-caltech                   | Epoch:2 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:2 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:2 | Val Acc: 0.9375
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 0.2479 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.4328 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 0.3007 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.3090 | Train Acc: 0.9573
 Site-amazon                        | Train Loss: 0.2870 | Train Acc: 0.9600
 Site-webcam                        | Train Loss: 0.5274 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.3495 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.4047 | Train Acc: 0.9647
 Site-caltech                       | Train Loss: 0.3512 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2255 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.4804 | Train Acc: 0.9375
Average Train Accuracy: 0.9547
 Site-amazon                        | Val  Loss: 0.3709 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 0.3201 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.3508 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.3591 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 0.2783 | Val  Acc: 0.9573
 Site-webcam                        | Val  Loss: 0.4135 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.5723 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.4330 | Val  Acc: 0.9298
 Site-caltech                       | Val  Loss: 0.3160 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2916 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3678 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9525
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9706
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9423
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9573
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9200
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9298
 Best site-caltech                   | Epoch:3 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:3 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:3 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 0.1741 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.3572 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.2013 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.1877 | Train Acc: 0.9829
 Site-amazon                        | Train Loss: 0.2011 | Train Acc: 0.9600
 Site-webcam                        | Train Loss: 0.5108 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.3015 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.3227 | Train Acc: 0.9647
 Site-caltech                       | Train Loss: 0.2504 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1519 | Train Acc: 0.9853
 Site-dslr                          | Train Loss: 0.2944 | Train Acc: 0.9583
Average Train Accuracy: 0.9621
 Site-amazon                        | Val  Loss: 0.2521 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.2370 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.2593 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 0.3287 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 0.1876 | Val  Acc: 0.9658
 Site-webcam                        | Val  Loss: 0.2714 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.4561 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 0.3052 | Val  Acc: 0.9825
 Site-caltech                       | Val  Loss: 0.2936 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2267 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.3505 | Val  Acc: 0.9375
Average Valid Accuracy: 0.9647
 Best site-amazon                    | Epoch:4 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9706
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9615
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9658
 Best site-webcam                    | Epoch:4 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:4 | Val Acc: 0.8800
 Best site-webcam                    | Epoch:4 | Val Acc: 0.9825
 Best site-caltech                   | Epoch:4 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:4 | Val Acc: 0.9778
 Best site-dslr                      | Epoch:4 | Val Acc: 0.9375
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 0.1516 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.3340 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.1376 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.1661 | Train Acc: 0.9658
 Site-amazon                        | Train Loss: 0.1505 | Train Acc: 0.9886
 Site-webcam                        | Train Loss: 0.5681 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.2290 | Train Acc: 0.9474
 Site-webcam                        | Train Loss: 0.2280 | Train Acc: 0.9412
 Site-caltech                       | Train Loss: 0.1267 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1084 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2742 | Train Acc: 0.9583
Average Train Accuracy: 0.9599
 Site-amazon                        | Val  Loss: 0.3371 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.1780 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.2067 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.2924 | Val  Acc: 0.9744
 Site-amazon                        | Val  Loss: 0.1432 | Val  Acc: 0.9658
 Site-webcam                        | Val  Loss: 0.3528 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.2559 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2446 | Val  Acc: 0.9649
 Site-caltech                       | Val  Loss: 0.2371 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1717 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.2067 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9664
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9706
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9423
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9744
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9658
 Best site-webcam                    | Epoch:5 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:5 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:5 | Val Acc: 0.9649
 Best site-caltech                   | Epoch:5 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:5 | Val Acc: 0.9778
 Best site-dslr                      | Epoch:5 | Val Acc: 0.9688
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 0.0807 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2966 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.1496 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.1140 | Train Acc: 0.9744
 Site-amazon                        | Train Loss: 0.1031 | Train Acc: 0.9886
 Site-webcam                        | Train Loss: 0.4787 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.2396 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.2170 | Train Acc: 0.9412
 Site-caltech                       | Train Loss: 0.1393 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2645 | Train Acc: 0.9853
 Site-dslr                          | Train Loss: 0.2272 | Train Acc: 0.9375
Average Train Accuracy: 0.9624
 Site-amazon                        | Val  Loss: 0.1478 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1849 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 0.2544 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.2825 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 0.1099 | Val  Acc: 0.9744
 Site-webcam                        | Val  Loss: 0.1668 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2697 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 0.2031 | Val  Acc: 0.9825
 Site-caltech                       | Val  Loss: 0.2841 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 0.1473 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.2285 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9634
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 0.0644 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.3006 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.1951 | Train Acc: 0.9872
 Site-amazon                        | Train Loss: 0.1190 | Train Acc: 0.9573
 Site-amazon                        | Train Loss: 0.0787 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.4890 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.1268 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.1565 | Train Acc: 0.9647
 Site-caltech                       | Train Loss: 0.1164 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1392 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.2236 | Train Acc: 0.9583
Average Train Accuracy: 0.9693
 Site-amazon                        | Val  Loss: 0.1215 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1513 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.1888 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 0.1483 | Val  Acc: 0.9487
 Site-amazon                        | Val  Loss: 0.1112 | Val  Acc: 0.9829
 Site-webcam                        | Val  Loss: 0.2370 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.1769 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2743 | Val  Acc: 0.9298
 Site-caltech                       | Val  Loss: 0.2222 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1425 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.1818 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9681
 Best site-amazon                    | Epoch:7 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9706
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9615
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9487
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9829
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:7 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9298
 Best site-caltech                   | Epoch:7 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9778
 Best site-dslr                      | Epoch:7 | Val Acc: 0.9688
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 0.0878 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.2824 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0704 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0832 | Train Acc: 0.9744
 Site-amazon                        | Train Loss: 0.0666 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2344 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.1844 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.1196 | Train Acc: 0.9882
 Site-caltech                       | Train Loss: 0.1028 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0768 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2279 | Train Acc: 0.9583
Average Train Accuracy: 0.9772
 Site-amazon                        | Val  Loss: 0.1426 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0933 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.2097 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.1551 | Val  Acc: 0.9744
 Site-amazon                        | Val  Loss: 0.1076 | Val  Acc: 0.9744
 Site-webcam                        | Val  Loss: 0.4324 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 0.2650 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.1284 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2170 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0993 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1529 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9635
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 0.0320 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2841 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0780 | Train Acc: 0.9872
 Site-amazon                        | Train Loss: 0.0781 | Train Acc: 0.9915
 Site-amazon                        | Train Loss: 0.0676 | Train Acc: 0.9829
 Site-webcam                        | Train Loss: 0.4974 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.1960 | Train Acc: 0.9211
 Site-webcam                        | Train Loss: 0.1387 | Train Acc: 0.9765
 Site-caltech                       | Train Loss: 0.1384 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0463 | Train Acc: 0.9853
 Site-dslr                          | Train Loss: 0.1874 | Train Acc: 0.9375
Average Train Accuracy: 0.9642
 Site-amazon                        | Val  Loss: 0.1038 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1147 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.1165 | Val  Acc: 0.9808
 Site-amazon                        | Val  Loss: 0.0936 | Val  Acc: 0.9872
 Site-amazon                        | Val  Loss: 0.1087 | Val  Acc: 0.9744
 Site-webcam                        | Val  Loss: 0.2102 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2837 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 0.2272 | Val  Acc: 0.9123
 Site-caltech                       | Val  Loss: 0.1712 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1132 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.1112 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9785
 Best site-amazon                    | Epoch:9 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9706
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9808
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9872
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9744
 Best site-webcam                    | Epoch:9 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9600
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9123
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9778
 Best site-dslr                      | Epoch:9 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 10 ============
 Site-amazon                        | Train Loss: 0.0668 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.2681 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 0.1006 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0927 | Train Acc: 0.9744
 Site-amazon                        | Train Loss: 0.0640 | Train Acc: 0.9943
 Site-webcam                        | Train Loss: 0.2561 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.0912 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.1135 | Train Acc: 0.9765
 Site-caltech                       | Train Loss: 0.0894 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0497 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1788 | Train Acc: 0.9375
Average Train Accuracy: 0.9744
 Site-amazon                        | Val  Loss: 0.0831 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0740 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1077 | Val  Acc: 0.9808
 Site-amazon                        | Val  Loss: 0.2234 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 0.0639 | Val  Acc: 0.9829
 Site-webcam                        | Val  Loss: 0.2094 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.1664 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 0.1581 | Val  Acc: 0.9649
 Site-caltech                       | Val  Loss: 0.1349 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1036 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.0993 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9761
============ Train epoch 11 ============
 Site-amazon                        | Train Loss: 0.1343 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.2250 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0427 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0695 | Train Acc: 0.9915
 Site-amazon                        | Train Loss: 0.0416 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.4528 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.1233 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.0866 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1417 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0472 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1224 | Train Acc: 0.9792
Average Train Accuracy: 0.9764
 Site-amazon                        | Val  Loss: 0.0775 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0507 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0885 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0841 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 0.0693 | Val  Acc: 0.9915
 Site-webcam                        | Val  Loss: 0.1280 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.1251 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 0.1029 | Val  Acc: 0.9825
 Site-caltech                       | Val  Loss: 0.0765 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0971 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.1835 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9856
 Best site-amazon                    | Epoch:11 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:11 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:11 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9615
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9915
 Best site-webcam                    | Epoch:11 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:11 | Val Acc: 0.9600
 Best site-webcam                    | Epoch:11 | Val Acc: 0.9825
 Best site-caltech                   | Epoch:11 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:11 | Val Acc: 0.9778
 Best site-dslr                      | Epoch:11 | Val Acc: 0.9688
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 12 ============
 Site-amazon                        | Train Loss: 0.0457 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.2291 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0431 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0581 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0439 | Train Acc: 0.9943
 Site-webcam                        | Train Loss: 0.2918 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.1216 | Train Acc: 0.9474
 Site-webcam                        | Train Loss: 0.0903 | Train Acc: 0.9882
 Site-caltech                       | Train Loss: 0.0558 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1247 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1447 | Train Acc: 0.9583
Average Train Accuracy: 0.9766
 Site-amazon                        | Val  Loss: 0.0812 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1329 | Val  Acc: 0.9808
 Site-amazon                        | Val  Loss: 0.2033 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 0.0642 | Val  Acc: 0.9829
 Site-webcam                        | Val  Loss: 0.1558 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.1375 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.1397 | Val  Acc: 0.9649
 Site-caltech                       | Val  Loss: 0.1577 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 0.0934 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.1096 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9657
============ Train epoch 13 ============
 Site-amazon                        | Train Loss: 0.0330 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2352 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0307 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0618 | Train Acc: 0.9829
 Site-amazon                        | Train Loss: 0.0363 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2525 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.0901 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.0442 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0776 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0329 | Train Acc: 0.9853
 Site-dslr                          | Train Loss: 0.1041 | Train Acc: 0.9792
Average Train Accuracy: 0.9769
 Site-amazon                        | Val  Loss: 0.0349 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0466 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0627 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0721 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.1786 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.2236 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.1571 | Val  Acc: 0.9825
 Site-caltech                       | Val  Loss: 0.0500 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1087 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.1133 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9808
============ Train epoch 14 ============
 Site-amazon                        | Train Loss: 0.0222 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2515 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0443 | Train Acc: 0.9872
 Site-amazon                        | Train Loss: 0.0692 | Train Acc: 0.9829
 Site-amazon                        | Train Loss: 0.0320 | Train Acc: 0.9943
 Site-webcam                        | Train Loss: 0.5145 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.1498 | Train Acc: 0.9211
 Site-webcam                        | Train Loss: 0.0986 | Train Acc: 0.9765
 Site-caltech                       | Train Loss: 0.0963 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0292 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1189 | Train Acc: 0.9583
Average Train Accuracy: 0.9677
 Site-amazon                        | Val  Loss: 0.0388 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0470 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0724 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0971 | Val  Acc: 0.9872
 Site-amazon                        | Val  Loss: 0.0520 | Val  Acc: 0.9829
 Site-webcam                        | Val  Loss: 0.1131 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.1744 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 0.1461 | Val  Acc: 0.9649
 Site-caltech                       | Val  Loss: 0.0810 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0830 | Val  Acc: 0.9556
 Site-dslr                          | Val  Loss: 0.0945 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9781
============ Train epoch 15 ============
 Site-amazon                        | Train Loss: 0.0454 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.2607 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0546 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0836 | Train Acc: 0.9829
 Site-amazon                        | Train Loss: 0.0231 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.4650 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.1028 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.0734 | Train Acc: 0.9765
 Site-caltech                       | Train Loss: 0.0687 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0393 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0963 | Train Acc: 0.9792
Average Train Accuracy: 0.9788
 Site-amazon                        | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0433 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0811 | Val  Acc: 0.9808
 Site-amazon                        | Val  Loss: 0.1934 | Val  Acc: 0.9872
 Site-amazon                        | Val  Loss: 0.0565 | Val  Acc: 0.9915
 Site-webcam                        | Val  Loss: 0.0309 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2934 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 0.0789 | Val  Acc: 0.9825
 Site-caltech                       | Val  Loss: 0.1119 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1212 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.0838 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9818
============ Train epoch 16 ============
 Site-amazon                        | Train Loss: 0.0149 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2567 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0638 | Train Acc: 0.9744
 Site-amazon                        | Train Loss: 0.0405 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0212 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2305 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.1361 | Train Acc: 0.9474
 Site-webcam                        | Train Loss: 0.0478 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0799 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0278 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0853 | Train Acc: 0.9792
Average Train Accuracy: 0.9751
 Site-amazon                        | Val  Loss: 0.0249 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0337 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0617 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0841 | Val  Acc: 0.9872
 Site-amazon                        | Val  Loss: 0.0643 | Val  Acc: 0.9915
 Site-webcam                        | Val  Loss: 0.0800 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0942 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 0.1271 | Val  Acc: 0.9649
 Site-caltech                       | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0531 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.0848 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9892
 Best site-amazon                    | Epoch:16 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:16 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:16 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9872
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9915
 Best site-webcam                    | Epoch:16 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:16 | Val Acc: 0.9600
 Best site-webcam                    | Epoch:16 | Val Acc: 0.9649
 Best site-caltech                   | Epoch:16 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:16 | Val Acc: 0.9778
 Best site-dslr                      | Epoch:16 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 17 ============
 Site-amazon                        | Train Loss: 0.0236 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2576 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0199 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0186 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.4418 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.0925 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.0472 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0543 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0284 | Train Acc: 0.9853
 Site-dslr                          | Train Loss: 0.0816 | Train Acc: 1.0000
Average Train Accuracy: 0.9803
 Site-amazon                        | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0299 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0422 | Val  Acc: 0.9915
 Site-webcam                        | Val  Loss: 0.1035 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.1276 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0601 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0736 | Val  Acc: 0.9556
 Site-dslr                          | Val  Loss: 0.1704 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9851
============ Train epoch 18 ============
 Site-amazon                        | Train Loss: 0.0134 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2398 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.0179 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0196 | Train Acc: 0.9943
 Site-webcam                        | Train Loss: 0.2169 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.0752 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.0464 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0757 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0223 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0788 | Train Acc: 1.0000
Average Train Accuracy: 0.9889
 Site-amazon                        | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0249 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1031 | Val  Acc: 0.9808
 Site-amazon                        | Val  Loss: 0.0743 | Val  Acc: 0.9744
 Site-amazon                        | Val  Loss: 0.0203 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0133 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0458 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0673 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0724 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1710 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9931
 Best site-amazon                    | Epoch:18 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:18 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:18 | Val Acc: 0.9808
 Best site-amazon                    | Epoch:18 | Val Acc: 0.9744
 Best site-amazon                    | Epoch:18 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:18 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:18 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:18 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:18 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:18 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:18 | Val Acc: 0.9688
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 19 ============
 Site-amazon                        | Train Loss: 0.0874 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.2545 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 0.0210 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0385 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0184 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.3613 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.0642 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.0398 | Train Acc: 0.9882
 Site-caltech                       | Train Loss: 0.0706 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.0188 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1139 | Train Acc: 0.9375
Average Train Accuracy: 0.9783
 Site-amazon                        | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1909 | Val  Acc: 0.9872
 Site-amazon                        | Val  Loss: 0.0419 | Val  Acc: 0.9915
 Site-webcam                        | Val  Loss: 0.2476 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0892 | Val  Acc: 0.9649
 Site-caltech                       | Val  Loss: 0.0857 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0415 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1606 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9755
===2023-08-02 17:11:13===
===2023-08-02 17:11:16===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[35,52,78,117,175,17,38,85,13,68,48,
client_nums=[5,3,2,1,]
len_dataset=[766,236,138,81,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (2)| Epoch:18 | Test Acc: 0.9583
 Test site-webcam                    (3)| Epoch:18 | Test Acc: 0.9492
 Test site-caltech                   (0)| Epoch:18 | Test Acc: 0.9600
 Test site-dslr                      (1)| Epoch:18 | Test Acc: 1.0000
amazon: 0.9583, webcam: 0.9492, caltech: 0.9600, dslr: 1.0000, 
Average Test Accuracy(group): 0.9669, Average Test Accuracy(individual): 0.9599,
domain std=0.0196, cluster std=0.0060, individual std=0.0134, 
