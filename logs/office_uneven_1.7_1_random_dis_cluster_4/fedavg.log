===2023-08-01 17:17:18===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[17,29,49,83,142,33,57,97,41,69,64,
client_nums=[5,3,2,1,]
len_dataset=[537,315,185,108,]
domain number = 4
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.2903 | Train Acc: 0.0000
 Site-Clipart                       | Train Loss: 2.2655 | Train Acc: 0.0345
 Site-Clipart                       | Train Loss: 2.2899 | Train Acc: 0.0612
 Site-Clipart                       | Train Loss: 2.1822 | Train Acc: 0.3735
 Site-Clipart                       | Train Loss: 2.2424 | Train Acc: 0.1338
 Site-Art                           | Train Loss: 2.2903 | Train Acc: 0.0909
 Site-Art                           | Train Loss: 2.2845 | Train Acc: 0.1404
 Site-Art                           | Train Loss: 2.2502 | Train Acc: 0.1237
 Site-RealWorld                     | Train Loss: 2.2922 | Train Acc: 0.0244
 Site-RealWorld                     | Train Loss: 2.2808 | Train Acc: 0.0725
 Site-Product                       | Train Loss: 2.2738 | Train Acc: 0.0781
Average Train Accuracy: 0.1030
 Site-Clipart                       | Val  Loss: 2.2586 | Val  Acc: 0.0000
 Site-Clipart                       | Val  Loss: 2.2420 | Val  Acc: 0.1053
 Site-Clipart                       | Val  Loss: 2.2338 | Val  Acc: 0.1250
 Site-Clipart                       | Val  Loss: 2.1889 | Val  Acc: 0.4000
 Site-Clipart                       | Val  Loss: 2.1702 | Val  Acc: 0.4362
 Site-Art                           | Val  Loss: 2.2459 | Val  Acc: 0.0909
 Site-Art                           | Val  Loss: 2.2567 | Val  Acc: 0.1579
 Site-Art                           | Val  Loss: 2.3068 | Val  Acc: 0.2615
 Site-RealWorld                     | Val  Loss: 2.2775 | Val  Acc: 0.1111
 Site-RealWorld                     | Val  Loss: 2.2664 | Val  Acc: 0.1739
 Site-Product                       | Val  Loss: 2.2809 | Val  Acc: 0.1860
Average Valid Accuracy: 0.1862
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.0000
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.1053
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.1250
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4000
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4362
 Best site-Art                       | Epoch:0 | Val Acc: 0.0909
 Best site-Art                       | Epoch:0 | Val Acc: 0.1579
 Best site-Art                       | Epoch:0 | Val Acc: 0.2615
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1111
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1739
 Best site-Product                   | Epoch:0 | Val Acc: 0.1860
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 2.2645 | Train Acc: 0.1765
 Site-Clipart                       | Train Loss: 2.2518 | Train Acc: 0.2414
 Site-Clipart                       | Train Loss: 2.2661 | Train Acc: 0.1020
 Site-Clipart                       | Train Loss: 2.1128 | Train Acc: 0.5904
 Site-Clipart                       | Train Loss: 2.1808 | Train Acc: 0.3803
 Site-Art                           | Train Loss: 2.2578 | Train Acc: 0.2727
 Site-Art                           | Train Loss: 2.2624 | Train Acc: 0.1930
 Site-Art                           | Train Loss: 2.1913 | Train Acc: 0.3711
 Site-RealWorld                     | Train Loss: 2.2388 | Train Acc: 0.2195
 Site-RealWorld                     | Train Loss: 2.2515 | Train Acc: 0.2319
 Site-Product                       | Train Loss: 2.2417 | Train Acc: 0.3438
Average Train Accuracy: 0.2839
 Site-Clipart                       | Val  Loss: 2.1956 | Val  Acc: 0.1818
 Site-Clipart                       | Val  Loss: 2.1666 | Val  Acc: 0.4211
 Site-Clipart                       | Val  Loss: 2.1579 | Val  Acc: 0.5000
 Site-Clipart                       | Val  Loss: 2.1420 | Val  Acc: 0.5273
 Site-Clipart                       | Val  Loss: 2.1319 | Val  Acc: 0.5745
 Site-Art                           | Val  Loss: 2.1497 | Val  Acc: 0.5000
 Site-Art                           | Val  Loss: 2.1718 | Val  Acc: 0.3684
 Site-Art                           | Val  Loss: 2.2438 | Val  Acc: 0.2923
 Site-RealWorld                     | Val  Loss: 2.2546 | Val  Acc: 0.1111
 Site-RealWorld                     | Val  Loss: 2.2317 | Val  Acc: 0.3478
 Site-Product                       | Val  Loss: 2.2381 | Val  Acc: 0.3023
Average Valid Accuracy: 0.3751
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.1818
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.4211
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5273
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5745
 Best site-Art                       | Epoch:1 | Val Acc: 0.5000
 Best site-Art                       | Epoch:1 | Val Acc: 0.3684
 Best site-Art                       | Epoch:1 | Val Acc: 0.2923
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.1111
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.3478
 Best site-Product                   | Epoch:1 | Val Acc: 0.3023
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 2.2311 | Train Acc: 0.1765
 Site-Clipart                       | Train Loss: 2.2255 | Train Acc: 0.3103
 Site-Clipart                       | Train Loss: 2.2622 | Train Acc: 0.1020
 Site-Clipart                       | Train Loss: 2.0858 | Train Acc: 0.6627
 Site-Clipart                       | Train Loss: 2.0972 | Train Acc: 0.5563
 Site-Art                           | Train Loss: 2.2149 | Train Acc: 0.4848
 Site-Art                           | Train Loss: 2.2306 | Train Acc: 0.2982
 Site-Art                           | Train Loss: 2.1426 | Train Acc: 0.4536
 Site-RealWorld                     | Train Loss: 2.2040 | Train Acc: 0.4878
 Site-RealWorld                     | Train Loss: 2.2025 | Train Acc: 0.3623
 Site-Product                       | Train Loss: 2.2002 | Train Acc: 0.5938
Average Train Accuracy: 0.4080
 Site-Clipart                       | Val  Loss: 2.1269 | Val  Acc: 0.4545
 Site-Clipart                       | Val  Loss: 2.0885 | Val  Acc: 0.6316
 Site-Clipart                       | Val  Loss: 2.0877 | Val  Acc: 0.6875
 Site-Clipart                       | Val  Loss: 2.0860 | Val  Acc: 0.7636
 Site-Clipart                       | Val  Loss: 2.0822 | Val  Acc: 0.6915
 Site-Art                           | Val  Loss: 2.0952 | Val  Acc: 0.7273
 Site-Art                           | Val  Loss: 2.1434 | Val  Acc: 0.5789
 Site-Art                           | Val  Loss: 2.1658 | Val  Acc: 0.4000
 Site-RealWorld                     | Val  Loss: 2.2344 | Val  Acc: 0.2222
 Site-RealWorld                     | Val  Loss: 2.2118 | Val  Acc: 0.3696
 Site-Product                       | Val  Loss: 2.2154 | Val  Acc: 0.3023
Average Valid Accuracy: 0.5299
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.4545
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6316
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6875
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7636
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6915
 Best site-Art                       | Epoch:2 | Val Acc: 0.7273
 Best site-Art                       | Epoch:2 | Val Acc: 0.5789
 Best site-Art                       | Epoch:2 | Val Acc: 0.4000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.2222
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3696
 Best site-Product                   | Epoch:2 | Val Acc: 0.3023
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 2.2104 | Train Acc: 0.2353
 Site-Clipart                       | Train Loss: 2.2021 | Train Acc: 0.2759
 Site-Clipart                       | Train Loss: 2.2492 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 2.0640 | Train Acc: 0.6024
 Site-Clipart                       | Train Loss: 2.0577 | Train Acc: 0.5915
 Site-Art                           | Train Loss: 2.1683 | Train Acc: 0.5455
 Site-Art                           | Train Loss: 2.2045 | Train Acc: 0.3509
 Site-Art                           | Train Loss: 2.0771 | Train Acc: 0.6495
 Site-RealWorld                     | Train Loss: 2.1600 | Train Acc: 0.7317
 Site-RealWorld                     | Train Loss: 2.2303 | Train Acc: 0.5362
 Site-Product                       | Train Loss: 2.1625 | Train Acc: 0.7500
Average Train Accuracy: 0.4957
 Site-Clipart                       | Val  Loss: 2.0690 | Val  Acc: 0.5455
 Site-Clipart                       | Val  Loss: 2.0156 | Val  Acc: 0.7368
 Site-Clipart                       | Val  Loss: 2.0093 | Val  Acc: 0.7812
 Site-Clipart                       | Val  Loss: 2.0297 | Val  Acc: 0.7636
 Site-Clipart                       | Val  Loss: 2.0312 | Val  Acc: 0.7234
 Site-Art                           | Val  Loss: 2.0109 | Val  Acc: 0.8636
 Site-Art                           | Val  Loss: 2.0960 | Val  Acc: 0.6316
 Site-Art                           | Val  Loss: 2.1454 | Val  Acc: 0.4615
 Site-RealWorld                     | Val  Loss: 2.2151 | Val  Acc: 0.4815
 Site-RealWorld                     | Val  Loss: 2.1715 | Val  Acc: 0.5652
 Site-Product                       | Val  Loss: 2.2016 | Val  Acc: 0.4651
Average Valid Accuracy: 0.6381
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.5455
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7368
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7812
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7636
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7234
 Best site-Art                       | Epoch:3 | Val Acc: 0.8636
 Best site-Art                       | Epoch:3 | Val Acc: 0.6316
 Best site-Art                       | Epoch:3 | Val Acc: 0.4615
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.4815
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.5652
 Best site-Product                   | Epoch:3 | Val Acc: 0.4651
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 2.1971 | Train Acc: 0.2941
 Site-Clipart                       | Train Loss: 2.1807 | Train Acc: 0.3103
 Site-Clipart                       | Train Loss: 2.2345 | Train Acc: 0.1633
 Site-Clipart                       | Train Loss: 2.0012 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 1.9696 | Train Acc: 0.7465
 Site-Art                           | Train Loss: 2.1304 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 2.1913 | Train Acc: 0.3684
 Site-Art                           | Train Loss: 2.0256 | Train Acc: 0.7423
 Site-RealWorld                     | Train Loss: 2.1252 | Train Acc: 0.8293
 Site-RealWorld                     | Train Loss: 2.1672 | Train Acc: 0.4783
 Site-Product                       | Train Loss: 2.1348 | Train Acc: 0.7656
Average Train Accuracy: 0.5567
 Site-Clipart                       | Val  Loss: 1.9537 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 1.9281 | Val  Acc: 0.7895
 Site-Clipart                       | Val  Loss: 1.9309 | Val  Acc: 0.8125
 Site-Clipart                       | Val  Loss: 1.9726 | Val  Acc: 0.8364
 Site-Clipart                       | Val  Loss: 2.0003 | Val  Acc: 0.7340
 Site-Art                           | Val  Loss: 1.9183 | Val  Acc: 0.9091
 Site-Art                           | Val  Loss: 2.0318 | Val  Acc: 0.6842
 Site-Art                           | Val  Loss: 2.0760 | Val  Acc: 0.5538
 Site-RealWorld                     | Val  Loss: 2.1713 | Val  Acc: 0.4815
 Site-RealWorld                     | Val  Loss: 2.1634 | Val  Acc: 0.4348
 Site-Product                       | Val  Loss: 2.1528 | Val  Acc: 0.5581
Average Valid Accuracy: 0.6920
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7895
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8125
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8364
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7340
 Best site-Art                       | Epoch:4 | Val Acc: 0.9091
 Best site-Art                       | Epoch:4 | Val Acc: 0.6842
 Best site-Art                       | Epoch:4 | Val Acc: 0.5538
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.4815
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.4348
 Best site-Product                   | Epoch:4 | Val Acc: 0.5581
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 2.1472 | Train Acc: 0.4118
 Site-Clipart                       | Train Loss: 2.1507 | Train Acc: 0.3793
 Site-Clipart                       | Train Loss: 2.2075 | Train Acc: 0.1020
 Site-Clipart                       | Train Loss: 1.9695 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 1.9127 | Train Acc: 0.7887
 Site-Art                           | Train Loss: 2.0850 | Train Acc: 0.7879
 Site-Art                           | Train Loss: 2.1659 | Train Acc: 0.4737
 Site-Art                           | Train Loss: 1.9643 | Train Acc: 0.8247
 Site-RealWorld                     | Train Loss: 2.0767 | Train Acc: 0.8537
 Site-RealWorld                     | Train Loss: 2.1319 | Train Acc: 0.5507
 Site-Product                       | Train Loss: 2.0983 | Train Acc: 0.7812
Average Train Accuracy: 0.6114
 Site-Clipart                       | Val  Loss: 1.9278 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 1.8836 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.8628 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 1.9206 | Val  Acc: 0.8909
 Site-Clipart                       | Val  Loss: 1.9610 | Val  Acc: 0.7660
 Site-Art                           | Val  Loss: 1.8694 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.9787 | Val  Acc: 0.8158
 Site-Art                           | Val  Loss: 2.0524 | Val  Acc: 0.6308
 Site-RealWorld                     | Val  Loss: 2.1618 | Val  Acc: 0.4444
 Site-RealWorld                     | Val  Loss: 2.1160 | Val  Acc: 0.6522
 Site-Product                       | Val  Loss: 2.1653 | Val  Acc: 0.4186
Average Valid Accuracy: 0.7400
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8421
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.9062
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8909
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7660
 Best site-Art                       | Epoch:5 | Val Acc: 0.9545
 Best site-Art                       | Epoch:5 | Val Acc: 0.8158
 Best site-Art                       | Epoch:5 | Val Acc: 0.6308
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.4444
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.6522
 Best site-Product                   | Epoch:5 | Val Acc: 0.4186
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 2.1320 | Train Acc: 0.4118
 Site-Clipart                       | Train Loss: 2.1548 | Train Acc: 0.2759
 Site-Clipart                       | Train Loss: 2.2005 | Train Acc: 0.1020
 Site-Clipart                       | Train Loss: 1.9541 | Train Acc: 0.7229
 Site-Clipart                       | Train Loss: 1.8753 | Train Acc: 0.7535
 Site-Art                           | Train Loss: 2.0621 | Train Acc: 0.7576
 Site-Art                           | Train Loss: 2.1584 | Train Acc: 0.3684
 Site-Art                           | Train Loss: 1.9121 | Train Acc: 0.8454
 Site-RealWorld                     | Train Loss: 2.0420 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 2.1164 | Train Acc: 0.6522
 Site-Product                       | Train Loss: 2.0645 | Train Acc: 0.8281
Average Train Accuracy: 0.6041
 Site-Clipart                       | Val  Loss: 1.8516 | Val  Acc: 0.7273
 Site-Clipart                       | Val  Loss: 1.8013 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.8046 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 1.8686 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.9375 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 1.7888 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.9287 | Val  Acc: 0.9211
 Site-Art                           | Val  Loss: 1.9836 | Val  Acc: 0.7231
 Site-RealWorld                     | Val  Loss: 2.1439 | Val  Acc: 0.4074
 Site-RealWorld                     | Val  Loss: 2.0965 | Val  Acc: 0.6522
 Site-Product                       | Val  Loss: 2.1199 | Val  Acc: 0.5814
Average Valid Accuracy: 0.7637
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7273
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8421
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9062
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7766
 Best site-Art                       | Epoch:6 | Val Acc: 0.9545
 Best site-Art                       | Epoch:6 | Val Acc: 0.9211
 Best site-Art                       | Epoch:6 | Val Acc: 0.7231
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.4074
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.6522
 Best site-Product                   | Epoch:6 | Val Acc: 0.5814
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 2.0840 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 2.1078 | Train Acc: 0.3793
 Site-Clipart                       | Train Loss: 2.1670 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.9069 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 1.8176 | Train Acc: 0.7958
 Site-Art                           | Train Loss: 1.9929 | Train Acc: 0.8485
 Site-Art                           | Train Loss: 2.1054 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 1.8615 | Train Acc: 0.9175
 Site-RealWorld                     | Train Loss: 1.9975 | Train Acc: 0.9024
 Site-RealWorld                     | Train Loss: 2.0863 | Train Acc: 0.7101
 Site-Product                       | Train Loss: 2.0270 | Train Acc: 0.8750
Average Train Accuracy: 0.6823
 Site-Clipart                       | Val  Loss: 1.7610 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 1.7342 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.7332 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 1.8047 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.8942 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 1.7134 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.8874 | Val  Acc: 0.8947
 Site-Art                           | Val  Loss: 1.9719 | Val  Acc: 0.7538
 Site-RealWorld                     | Val  Loss: 2.1005 | Val  Acc: 0.6296
 Site-RealWorld                     | Val  Loss: 2.0576 | Val  Acc: 0.6522
 Site-Product                       | Val  Loss: 2.1000 | Val  Acc: 0.6512
Average Valid Accuracy: 0.8009
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8421
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9062
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7979
 Best site-Art                       | Epoch:7 | Val Acc: 0.9545
 Best site-Art                       | Epoch:7 | Val Acc: 0.8947
 Best site-Art                       | Epoch:7 | Val Acc: 0.7538
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.6296
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.6522
 Best site-Product                   | Epoch:7 | Val Acc: 0.6512
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 2.0754 | Train Acc: 0.4706
 Site-Clipart                       | Train Loss: 2.1028 | Train Acc: 0.3448
 Site-Clipart                       | Train Loss: 2.1645 | Train Acc: 0.1020
 Site-Clipart                       | Train Loss: 1.8800 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 1.7643 | Train Acc: 0.8944
 Site-Art                           | Train Loss: 1.9938 | Train Acc: 0.7879
 Site-Art                           | Train Loss: 2.0906 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 1.7975 | Train Acc: 0.9278
 Site-RealWorld                     | Train Loss: 1.9729 | Train Acc: 0.9024
 Site-RealWorld                     | Train Loss: 2.0473 | Train Acc: 0.6957
 Site-Product                       | Train Loss: 1.9988 | Train Acc: 0.9062
Average Train Accuracy: 0.6668
 Site-Clipart                       | Val  Loss: 1.7402 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.6446 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.6597 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.7869 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.8686 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 1.6355 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.8341 | Val  Acc: 0.8947
 Site-Art                           | Val  Loss: 1.8776 | Val  Acc: 0.7231
 Site-RealWorld                     | Val  Loss: 2.0684 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 2.0395 | Val  Acc: 0.6304
 Site-Product                       | Val  Loss: 2.0731 | Val  Acc: 0.6279
Average Valid Accuracy: 0.8108
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8421
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7872
 Best site-Art                       | Epoch:8 | Val Acc: 0.9545
 Best site-Art                       | Epoch:8 | Val Acc: 0.8947
 Best site-Art                       | Epoch:8 | Val Acc: 0.7231
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.6304
 Best site-Product                   | Epoch:8 | Val Acc: 0.6279
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 2.0556 | Train Acc: 0.4118
 Site-Clipart                       | Train Loss: 2.0822 | Train Acc: 0.3793
 Site-Clipart                       | Train Loss: 2.1651 | Train Acc: 0.1020
 Site-Clipart                       | Train Loss: 1.8361 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 1.6867 | Train Acc: 0.8732
 Site-Art                           | Train Loss: 1.9398 | Train Acc: 0.8485
 Site-Art                           | Train Loss: 2.0767 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 1.7457 | Train Acc: 0.9588
 Site-RealWorld                     | Train Loss: 1.9300 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 2.0230 | Train Acc: 0.6667
 Site-Product                       | Train Loss: 1.9557 | Train Acc: 0.9531
Average Train Accuracy: 0.6760
 Site-Clipart                       | Val  Loss: 1.6530 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 1.5788 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 1.5884 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 1.7276 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.8057 | Val  Acc: 0.8404
 Site-Art                           | Val  Loss: 1.5914 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.7892 | Val  Acc: 0.8947
 Site-Art                           | Val  Loss: 1.7819 | Val  Acc: 0.7231
 Site-RealWorld                     | Val  Loss: 2.0702 | Val  Acc: 0.5556
 Site-RealWorld                     | Val  Loss: 2.0148 | Val  Acc: 0.7609
 Site-Product                       | Val  Loss: 2.0577 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8205
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9062
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8404
 Best site-Art                       | Epoch:9 | Val Acc: 0.9545
 Best site-Art                       | Epoch:9 | Val Acc: 0.8947
 Best site-Art                       | Epoch:9 | Val Acc: 0.7231
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.5556
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.7609
 Best site-Product                   | Epoch:9 | Val Acc: 0.6977
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 2.0229 | Train Acc: 0.4118
 Site-Clipart                       | Train Loss: 2.0599 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 2.1330 | Train Acc: 0.1429
 Site-Clipart                       | Train Loss: 1.8310 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 1.6310 | Train Acc: 0.8873
 Site-Art                           | Train Loss: 1.8957 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 2.0407 | Train Acc: 0.5614
 Site-Art                           | Train Loss: 1.6934 | Train Acc: 0.9175
 Site-RealWorld                     | Train Loss: 1.8832 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 2.0122 | Train Acc: 0.7101
 Site-Product                       | Train Loss: 1.9390 | Train Acc: 0.8906
Average Train Accuracy: 0.6868
 Site-Clipart                       | Val  Loss: 1.6164 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 1.5122 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.5524 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.6881 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.7847 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 1.5389 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.7173 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 1.7449 | Val  Acc: 0.7231
 Site-RealWorld                     | Val  Loss: 2.0530 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.9847 | Val  Acc: 0.6739
 Site-Product                       | Val  Loss: 2.0433 | Val  Acc: 0.6047
Average Valid Accuracy: 0.8219
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8191
 Best site-Art                       | Epoch:10 | Val Acc: 0.9545
 Best site-Art                       | Epoch:10 | Val Acc: 0.9474
 Best site-Art                       | Epoch:10 | Val Acc: 0.7231
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.7407
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.6739
 Best site-Product                   | Epoch:10 | Val Acc: 0.6047
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 2.0251 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 2.0454 | Train Acc: 0.4138
 Site-Clipart                       | Train Loss: 2.1200 | Train Acc: 0.1633
 Site-Clipart                       | Train Loss: 1.7794 | Train Acc: 0.7952
 Site-Clipart                       | Train Loss: 1.5931 | Train Acc: 0.8521
 Site-Art                           | Train Loss: 1.8746 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 2.0234 | Train Acc: 0.5614
 Site-Art                           | Train Loss: 1.6435 | Train Acc: 0.9381
 Site-RealWorld                     | Train Loss: 1.8575 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.9713 | Train Acc: 0.7246
 Site-Product                       | Train Loss: 1.9043 | Train Acc: 0.9375
Average Train Accuracy: 0.6964
 Site-Clipart                       | Val  Loss: 1.5551 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.4523 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.4742 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.6337 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.7480 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 1.4333 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6902 | Val  Acc: 0.9211
 Site-Art                           | Val  Loss: 1.6571 | Val  Acc: 0.7231
 Site-RealWorld                     | Val  Loss: 2.0134 | Val  Acc: 0.6296
 Site-RealWorld                     | Val  Loss: 1.9638 | Val  Acc: 0.7391
 Site-Product                       | Val  Loss: 2.0039 | Val  Acc: 0.6279
Average Valid Accuracy: 0.8289
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8085
 Best site-Art                       | Epoch:11 | Val Acc: 1.0000
 Best site-Art                       | Epoch:11 | Val Acc: 0.9211
 Best site-Art                       | Epoch:11 | Val Acc: 0.7231
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.6296
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.7391
 Best site-Product                   | Epoch:11 | Val Acc: 0.6279
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 2.0042 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 2.0245 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 2.1172 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.7447 | Train Acc: 0.7229
 Site-Clipart                       | Train Loss: 1.5536 | Train Acc: 0.8803
 Site-Art                           | Train Loss: 1.8383 | Train Acc: 0.8485
 Site-Art                           | Train Loss: 2.0074 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 1.6096 | Train Acc: 0.9485
 Site-RealWorld                     | Train Loss: 1.8312 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.9828 | Train Acc: 0.7101
 Site-Product                       | Train Loss: 1.8835 | Train Acc: 0.8906
Average Train Accuracy: 0.6980
 Site-Clipart                       | Val  Loss: 1.4909 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.4132 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.4537 | Val  Acc: 0.8750
 Site-Clipart                       | Val  Loss: 1.5798 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.7133 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 1.3609 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6450 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 1.6466 | Val  Acc: 0.7385
 Site-RealWorld                     | Val  Loss: 1.9965 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 1.9014 | Val  Acc: 0.8043
 Site-Product                       | Val  Loss: 1.9738 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8387
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8421
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.7766
 Best site-Art                       | Epoch:12 | Val Acc: 1.0000
 Best site-Art                       | Epoch:12 | Val Acc: 0.9474
 Best site-Art                       | Epoch:12 | Val Acc: 0.7385
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8043
 Best site-Product                   | Epoch:12 | Val Acc: 0.7209
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 1.9695 | Train Acc: 0.4706
 Site-Clipart                       | Train Loss: 2.0056 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 2.0943 | Train Acc: 0.1633
 Site-Clipart                       | Train Loss: 1.6915 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 1.4362 | Train Acc: 0.9155
 Site-Art                           | Train Loss: 1.8176 | Train Acc: 0.8788
 Site-Art                           | Train Loss: 1.9914 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 1.5612 | Train Acc: 0.9691
 Site-RealWorld                     | Train Loss: 1.7857 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.8754 | Train Acc: 0.7391
 Site-Product                       | Train Loss: 1.8473 | Train Acc: 0.8750
Average Train Accuracy: 0.6990
 Site-Clipart                       | Val  Loss: 1.3933 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.3145 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.3724 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.5306 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.6775 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 1.3193 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6012 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6300 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.9887 | Val  Acc: 0.5926
 Site-RealWorld                     | Val  Loss: 1.8900 | Val  Acc: 0.7174
 Site-Product                       | Val  Loss: 1.9546 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8461
 Best site-Clipart                   | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8421
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.7872
 Best site-Art                       | Epoch:13 | Val Acc: 1.0000
 Best site-Art                       | Epoch:13 | Val Acc: 1.0000
 Best site-Art                       | Epoch:13 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.5926
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.7174
 Best site-Product                   | Epoch:13 | Val Acc: 0.7209
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 1.9434 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 2.0190 | Train Acc: 0.4138
 Site-Clipart                       | Train Loss: 2.0885 | Train Acc: 0.1429
 Site-Clipart                       | Train Loss: 1.6705 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 1.4164 | Train Acc: 0.8732
 Site-Art                           | Train Loss: 1.7630 | Train Acc: 0.8788
 Site-Art                           | Train Loss: 1.9662 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 1.5133 | Train Acc: 0.9485
 Site-RealWorld                     | Train Loss: 1.7475 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.9377 | Train Acc: 0.6957
 Site-Product                       | Train Loss: 1.8201 | Train Acc: 0.9062
Average Train Accuracy: 0.7028
 Site-Clipart                       | Val  Loss: 1.3755 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.2823 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.3327 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 1.4896 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.6372 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 1.2732 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5520 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 1.6242 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 1.9499 | Val  Acc: 0.6296
 Site-RealWorld                     | Val  Loss: 1.8839 | Val  Acc: 0.7174
 Site-Product                       | Val  Loss: 1.9295 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8484
 Best site-Clipart                   | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9062
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8191
 Best site-Art                       | Epoch:14 | Val Acc: 1.0000
 Best site-Art                       | Epoch:14 | Val Acc: 0.9474
 Best site-Art                       | Epoch:14 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.6296
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.7174
 Best site-Product                   | Epoch:14 | Val Acc: 0.7209
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 1.9070 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.9575 | Train Acc: 0.3793
 Site-Clipart                       | Train Loss: 2.0569 | Train Acc: 0.2449
 Site-Clipart                       | Train Loss: 1.6434 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 1.3689 | Train Acc: 0.9155
 Site-Art                           | Train Loss: 1.7184 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.9497 | Train Acc: 0.5789
 Site-Art                           | Train Loss: 1.4728 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.7184 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.8584 | Train Acc: 0.7681
 Site-Product                       | Train Loss: 1.7844 | Train Acc: 0.9375
Average Train Accuracy: 0.7292
 Site-Clipart                       | Val  Loss: 1.3807 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.2313 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.2399 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.4843 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.6333 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 1.1916 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5084 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.5905 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.9045 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.8488 | Val  Acc: 0.8043
 Site-Product                       | Val  Loss: 1.9214 | Val  Acc: 0.6512
Average Valid Accuracy: 0.8636
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.7872
 Best site-Art                       | Epoch:15 | Val Acc: 1.0000
 Best site-Art                       | Epoch:15 | Val Acc: 0.9737
 Best site-Art                       | Epoch:15 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.7778
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.8043
 Best site-Product                   | Epoch:15 | Val Acc: 0.6512
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 1.9191 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.9435 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 2.0651 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 1.6442 | Train Acc: 0.8072
 Site-Clipart                       | Train Loss: 1.3135 | Train Acc: 0.9225
 Site-Art                           | Train Loss: 1.6884 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.9505 | Train Acc: 0.5614
 Site-Art                           | Train Loss: 1.4097 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.6723 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.7946 | Train Acc: 0.7391
 Site-Product                       | Train Loss: 1.7651 | Train Acc: 0.9062
Average Train Accuracy: 0.7257
 Site-Clipart                       | Val  Loss: 1.2732 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.1645 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.1961 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.4249 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.5783 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 1.1078 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4741 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 1.4410 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.8894 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.8200 | Val  Acc: 0.7826
 Site-Product                       | Val  Loss: 1.8947 | Val  Acc: 0.6047
Average Valid Accuracy: 0.8447
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 1.8793 | Train Acc: 0.4706
 Site-Clipart                       | Train Loss: 1.9275 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 2.0430 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 1.5996 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 1.3195 | Train Acc: 0.8803
 Site-Art                           | Train Loss: 1.6714 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.9133 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 1.3928 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.6465 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.8018 | Train Acc: 0.8116
 Site-Product                       | Train Loss: 1.7309 | Train Acc: 0.9219
Average Train Accuracy: 0.7262
 Site-Clipart                       | Val  Loss: 1.2301 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.1160 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.1562 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.3778 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.5548 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 1.0797 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4352 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 1.3736 | Val  Acc: 0.7385
 Site-RealWorld                     | Val  Loss: 1.8931 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.8098 | Val  Acc: 0.7391
 Site-Product                       | Val  Loss: 1.8904 | Val  Acc: 0.6512
Average Valid Accuracy: 0.8492
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 1.8802 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.9215 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 2.0467 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.5919 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 1.2329 | Train Acc: 0.9155
 Site-Art                           | Train Loss: 1.6419 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.8930 | Train Acc: 0.5789
 Site-Art                           | Train Loss: 1.3229 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 1.6149 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.7837 | Train Acc: 0.7971
 Site-Product                       | Train Loss: 1.6979 | Train Acc: 0.9219
Average Train Accuracy: 0.7287
 Site-Clipart                       | Val  Loss: 1.1913 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.0820 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.0956 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.3505 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.5201 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 1.0580 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3650 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3081 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 1.8483 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.7814 | Val  Acc: 0.8696
 Site-Product                       | Val  Loss: 1.8589 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8791
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9455
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8085
 Best site-Art                       | Epoch:18 | Val Acc: 1.0000
 Best site-Art                       | Epoch:18 | Val Acc: 1.0000
 Best site-Art                       | Epoch:18 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.8148
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.8696
 Best site-Product                   | Epoch:18 | Val Acc: 0.7209
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 1.8160 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.9152 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 2.0192 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.5653 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 1.1831 | Train Acc: 0.9155
 Site-Art                           | Train Loss: 1.5953 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.8723 | Train Acc: 0.6140
 Site-Art                           | Train Loss: 1.2898 | Train Acc: 0.9588
 Site-RealWorld                     | Train Loss: 1.5869 | Train Acc: 0.9024
 Site-RealWorld                     | Train Loss: 1.7208 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.6736 | Train Acc: 0.9219
Average Train Accuracy: 0.7405
 Site-Clipart                       | Val  Loss: 1.1529 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 0.9977 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.1080 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.2937 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.5146 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 0.9934 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3582 | Val  Acc: 0.9211
 Site-Art                           | Val  Loss: 1.3675 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 1.8495 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.7484 | Val  Acc: 0.7826
 Site-Product                       | Val  Loss: 1.8394 | Val  Acc: 0.6744
Average Valid Accuracy: 0.8445
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 1.8536 | Train Acc: 0.4118
 Site-Clipart                       | Train Loss: 1.9051 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 2.0380 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.4866 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 1.1530 | Train Acc: 0.9225
 Site-Art                           | Train Loss: 1.5650 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.8812 | Train Acc: 0.5789
 Site-Art                           | Train Loss: 1.2710 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 1.5444 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.7930 | Train Acc: 0.7971
 Site-Product                       | Train Loss: 1.6530 | Train Acc: 0.9062
Average Train Accuracy: 0.7197
 Site-Clipart                       | Val  Loss: 1.0811 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 0.9485 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 1.0011 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.2667 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.4774 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.9384 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3208 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.3467 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.8319 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.7319 | Val  Acc: 0.8261
 Site-Product                       | Val  Loss: 1.8134 | Val  Acc: 0.7442
Average Valid Accuracy: 0.8701
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 1.8113 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.8334 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 2.0346 | Train Acc: 0.1429
 Site-Clipart                       | Train Loss: 1.4920 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 1.1006 | Train Acc: 0.9296
 Site-Art                           | Train Loss: 1.5285 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.8074 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 1.2041 | Train Acc: 0.9691
 Site-RealWorld                     | Train Loss: 1.5268 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.7328 | Train Acc: 0.8406
 Site-Product                       | Train Loss: 1.6056 | Train Acc: 0.9219
Average Train Accuracy: 0.7399
 Site-Clipart                       | Val  Loss: 1.0210 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.9263 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.9566 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.2607 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.4453 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.8845 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2767 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.2859 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.7841 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.7054 | Val  Acc: 0.7826
 Site-Product                       | Val  Loss: 1.7780 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8809
 Best site-Clipart                   | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9273
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8085
 Best site-Art                       | Epoch:21 | Val Acc: 1.0000
 Best site-Art                       | Epoch:21 | Val Acc: 0.9737
 Best site-Art                       | Epoch:21 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.8148
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.7826
 Best site-Product                   | Epoch:21 | Val Acc: 0.6977
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 1.7837 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.8632 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 1.9956 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.5186 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 1.0574 | Train Acc: 0.9085
 Site-Art                           | Train Loss: 1.5273 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.8261 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 1.1661 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.5063 | Train Acc: 0.9024
 Site-RealWorld                     | Train Loss: 1.6955 | Train Acc: 0.7391
 Site-Product                       | Train Loss: 1.5938 | Train Acc: 0.9219
Average Train Accuracy: 0.7200
 Site-Clipart                       | Val  Loss: 1.0231 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.8710 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.9192 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.1899 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.4311 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.8492 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2618 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.2441 | Val  Acc: 0.7538
 Site-RealWorld                     | Val  Loss: 1.7673 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.6717 | Val  Acc: 0.8913
 Site-Product                       | Val  Loss: 1.8060 | Val  Acc: 0.6512
Average Valid Accuracy: 0.8749
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 1.7938 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.8280 | Train Acc: 0.5862
 Site-Clipart                       | Train Loss: 1.9876 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.4581 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 1.0891 | Train Acc: 0.9085
 Site-Art                           | Train Loss: 1.4797 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.8207 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 1.1410 | Train Acc: 0.9691
 Site-RealWorld                     | Train Loss: 1.4430 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.6386 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.5592 | Train Acc: 0.9375
Average Train Accuracy: 0.7446
 Site-Clipart                       | Val  Loss: 0.9777 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 0.8275 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.8935 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.1454 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.4015 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.8256 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2033 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2688 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 1.7761 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.6857 | Val  Acc: 0.7391
 Site-Product                       | Val  Loss: 1.7541 | Val  Acc: 0.6744
Average Valid Accuracy: 0.8504
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 1.7670 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.8365 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 2.0107 | Train Acc: 0.1429
 Site-Clipart                       | Train Loss: 1.4712 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.9881 | Train Acc: 0.9014
 Site-Art                           | Train Loss: 1.4377 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.8295 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 1.1358 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 1.4348 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.6364 | Train Acc: 0.7826
 Site-Product                       | Train Loss: 1.5185 | Train Acc: 0.9219
Average Train Accuracy: 0.7249
 Site-Clipart                       | Val  Loss: 0.9448 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.7847 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.8964 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.1611 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.3945 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.7787 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1594 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1319 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.7262 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.6413 | Val  Acc: 0.8478
 Site-Product                       | Val  Loss: 1.7491 | Val  Acc: 0.7674
Average Valid Accuracy: 0.8959
 Best site-Clipart                   | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9375
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.7766
 Best site-Art                       | Epoch:24 | Val Acc: 1.0000
 Best site-Art                       | Epoch:24 | Val Acc: 1.0000
 Best site-Art                       | Epoch:24 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:24 | Val Acc: 0.8148
 Best site-RealWorld                 | Epoch:24 | Val Acc: 0.8478
 Best site-Product                   | Epoch:24 | Val Acc: 0.7674
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 1.7525 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.8070 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 1.9878 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 1.4071 | Train Acc: 0.7831
 Site-Clipart                       | Train Loss: 0.9570 | Train Acc: 0.9085
 Site-Art                           | Train Loss: 1.4290 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.7656 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 1.0980 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3916 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.5692 | Train Acc: 0.7826
 Site-Product                       | Train Loss: 1.5132 | Train Acc: 0.9375
Average Train Accuracy: 0.7385
 Site-Clipart                       | Val  Loss: 0.9315 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.7219 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.8512 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.1168 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.3517 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.7491 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1250 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.0916 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.7597 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.6329 | Val  Acc: 0.8261
 Site-Product                       | Val  Loss: 1.7147 | Val  Acc: 0.7674
Average Valid Accuracy: 0.8805
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 1.7381 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.8145 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 1.9932 | Train Acc: 0.1429
 Site-Clipart                       | Train Loss: 1.3903 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.9664 | Train Acc: 0.9155
 Site-Art                           | Train Loss: 1.4114 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.7507 | Train Acc: 0.6491
 Site-Art                           | Train Loss: 1.0508 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 1.3903 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.5687 | Train Acc: 0.7971
 Site-Product                       | Train Loss: 1.4814 | Train Acc: 0.9375
Average Train Accuracy: 0.7337
 Site-Clipart                       | Val  Loss: 0.9046 | Val  Acc: 0.8182
 Site-Clipart                       | Val  Loss: 0.7398 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.7928 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.0709 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.3590 | Val  Acc: 0.7979
 Site-Art                           | Val  Loss: 0.6823 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1225 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.1115 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.7499 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.5892 | Val  Acc: 0.7826
 Site-Product                       | Val  Loss: 1.7080 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8566
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 1.7212 | Train Acc: 0.4706
 Site-Clipart                       | Train Loss: 1.7971 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9350 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.3484 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 0.9018 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 1.3651 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.7645 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 1.0295 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.3639 | Train Acc: 0.9024
 Site-RealWorld                     | Train Loss: 1.5881 | Train Acc: 0.8116
 Site-Product                       | Train Loss: 1.4757 | Train Acc: 0.9062
Average Train Accuracy: 0.7265
 Site-Clipart                       | Val  Loss: 0.8604 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.6950 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.7657 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 1.0782 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.3189 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 0.6384 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0560 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 1.0904 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.7028 | Val  Acc: 0.7037
 Site-RealWorld                     | Val  Loss: 1.5710 | Val  Acc: 0.8261
 Site-Product                       | Val  Loss: 1.6820 | Val  Acc: 0.6744
Average Valid Accuracy: 0.8643
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 1.7481 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.8126 | Train Acc: 0.5517
 Site-Clipart                       | Train Loss: 1.9788 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.3486 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.9144 | Train Acc: 0.9507
 Site-Art                           | Train Loss: 1.3230 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.7162 | Train Acc: 0.6140
 Site-Art                           | Train Loss: 1.0287 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 1.3188 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.7226 | Train Acc: 0.8116
 Site-Product                       | Train Loss: 1.4482 | Train Acc: 0.9219
Average Train Accuracy: 0.7451
 Site-Clipart                       | Val  Loss: 0.8476 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6874 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.7672 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 1.0519 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.3112 | Val  Acc: 0.7660
 Site-Art                           | Val  Loss: 0.6508 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0450 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 0.9780 | Val  Acc: 0.7385
 Site-RealWorld                     | Val  Loss: 1.6750 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.5160 | Val  Acc: 0.8696
 Site-Product                       | Val  Loss: 1.6851 | Val  Acc: 0.6047
Average Valid Accuracy: 0.8693
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 1.7241 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.7483 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9765 | Train Acc: 0.2449
 Site-Clipart                       | Train Loss: 1.3252 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 0.8283 | Train Acc: 0.9296
 Site-Art                           | Train Loss: 1.3664 | Train Acc: 0.8788
 Site-Art                           | Train Loss: 1.7199 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 0.9810 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 1.2774 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.4208 | Train Acc: 0.8551
 Site-Product                       | Train Loss: 1.3863 | Train Acc: 0.9688
Average Train Accuracy: 0.7449
 Site-Clipart                       | Val  Loss: 0.8078 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6591 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.7077 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.9976 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.2702 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 0.6358 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0450 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.9992 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.6750 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.5305 | Val  Acc: 0.8261
 Site-Product                       | Val  Loss: 1.6508 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8814
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 1.6822 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.7576 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 1.9342 | Train Acc: 0.2449
 Site-Clipart                       | Train Loss: 1.3013 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 0.7975 | Train Acc: 0.9437
 Site-Art                           | Train Loss: 1.2921 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.6773 | Train Acc: 0.6140
 Site-Art                           | Train Loss: 0.9387 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.2674 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.5272 | Train Acc: 0.8116
 Site-Product                       | Train Loss: 1.3757 | Train Acc: 0.9375
Average Train Accuracy: 0.7446
 Site-Clipart                       | Val  Loss: 0.7593 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5989 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.6698 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 1.0072 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.2649 | Val  Acc: 0.7660
 Site-Art                           | Val  Loss: 0.5604 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0031 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 0.9430 | Val  Acc: 0.7385
 Site-RealWorld                     | Val  Loss: 1.6663 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.5246 | Val  Acc: 0.7826
 Site-Product                       | Val  Loss: 1.6586 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8689
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 1.6221 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.7729 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 1.9478 | Train Acc: 0.2449
 Site-Clipart                       | Train Loss: 1.2976 | Train Acc: 0.7590
 Site-Clipart                       | Train Loss: 0.7417 | Train Acc: 0.9507
 Site-Art                           | Train Loss: 1.2314 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.6824 | Train Acc: 0.5789
 Site-Art                           | Train Loss: 0.8896 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.2513 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.5805 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.3612 | Train Acc: 0.9375
Average Train Accuracy: 0.7392
 Site-Clipart                       | Val  Loss: 0.7129 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5596 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6811 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 0.9598 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.2210 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.5283 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9624 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.9498 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.6010 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.4917 | Val  Acc: 0.8913
 Site-Product                       | Val  Loss: 1.6415 | Val  Acc: 0.6744
Average Valid Accuracy: 0.8939
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 1.6590 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.7499 | Train Acc: 0.5517
 Site-Clipart                       | Train Loss: 1.9370 | Train Acc: 0.2653
 Site-Clipart                       | Train Loss: 1.3144 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.7618 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 1.1987 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.6552 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 0.8565 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1954 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.4943 | Train Acc: 0.8406
 Site-Product                       | Train Loss: 1.3455 | Train Acc: 0.9531
Average Train Accuracy: 0.7624
 Site-Clipart                       | Val  Loss: 0.7433 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.5290 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6535 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.9602 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.2116 | Val  Acc: 0.7660
 Site-Art                           | Val  Loss: 0.4902 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9504 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 0.8911 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 1.5916 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.5127 | Val  Acc: 0.8043
 Site-Product                       | Val  Loss: 1.6365 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8764
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 1.6158 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.7438 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9556 | Train Acc: 0.2653
 Site-Clipart                       | Train Loss: 1.2864 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.7653 | Train Acc: 0.9648
 Site-Art                           | Train Loss: 1.1711 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.6573 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 0.8733 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 1.1628 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.3517 | Train Acc: 0.8551
 Site-Product                       | Train Loss: 1.3237 | Train Acc: 0.9062
Average Train Accuracy: 0.7533
 Site-Clipart                       | Val  Loss: 0.6943 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5348 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6201 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.9372 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.1969 | Val  Acc: 0.8191
 Site-Art                           | Val  Loss: 0.4444 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9310 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.9089 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.5813 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 1.4576 | Val  Acc: 0.8043
 Site-Product                       | Val  Loss: 1.5946 | Val  Acc: 0.7209
Average Valid Accuracy: 0.9002
 Best site-Clipart                   | Epoch:33 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:33 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.8191
 Best site-Art                       | Epoch:33 | Val Acc: 1.0000
 Best site-Art                       | Epoch:33 | Val Acc: 0.9737
 Best site-Art                       | Epoch:33 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:33 | Val Acc: 0.8519
 Best site-RealWorld                 | Epoch:33 | Val Acc: 0.8043
 Best site-Product                   | Epoch:33 | Val Acc: 0.7209
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 1.6148 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.6979 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 1.9970 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.2674 | Train Acc: 0.7711
 Site-Clipart                       | Train Loss: 0.7218 | Train Acc: 0.9155
 Site-Art                           | Train Loss: 1.2021 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.6550 | Train Acc: 0.5614
 Site-Art                           | Train Loss: 0.8038 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1499 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.4046 | Train Acc: 0.8841
 Site-Product                       | Train Loss: 1.2967 | Train Acc: 0.9375
Average Train Accuracy: 0.7477
 Site-Clipart                       | Val  Loss: 0.6451 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4906 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.6055 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.9226 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.1845 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 0.4352 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9036 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.9171 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.5580 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.4246 | Val  Acc: 0.8913
 Site-Product                       | Val  Loss: 1.5713 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8895
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 1.5774 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.7059 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 1.9638 | Train Acc: 0.1837
 Site-Clipart                       | Train Loss: 1.2446 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 0.6718 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 1.1387 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.6165 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 0.8338 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.1176 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.5236 | Train Acc: 0.9275
 Site-Product                       | Train Loss: 1.2941 | Train Acc: 0.9219
Average Train Accuracy: 0.7549
 Site-Clipart                       | Val  Loss: 0.5940 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4905 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.6276 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 0.8991 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.1700 | Val  Acc: 0.8085
 Site-Art                           | Val  Loss: 0.4222 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8783 | Val  Acc: 0.9474
 Site-Art                           | Val  Loss: 0.8232 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.5598 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 1.4217 | Val  Acc: 0.8043
 Site-Product                       | Val  Loss: 1.5641 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8879
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 1.5669 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.6798 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9882 | Train Acc: 0.1633
 Site-Clipart                       | Train Loss: 1.2883 | Train Acc: 0.6867
 Site-Clipart                       | Train Loss: 0.6862 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 1.0799 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.6324 | Train Acc: 0.5263
 Site-Art                           | Train Loss: 0.7649 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0820 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.3712 | Train Acc: 0.8406
 Site-Product                       | Train Loss: 1.2427 | Train Acc: 0.9219
Average Train Accuracy: 0.7407
 Site-Clipart                       | Val  Loss: 0.6085 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4543 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5822 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.9083 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.1225 | Val  Acc: 0.7553
 Site-Art                           | Val  Loss: 0.3756 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8282 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.8556 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.5615 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.4422 | Val  Acc: 0.8261
 Site-Product                       | Val  Loss: 1.5620 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8893
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 1.5148 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.6686 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 1.9364 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.2845 | Train Acc: 0.7349
 Site-Clipart                       | Train Loss: 0.6550 | Train Acc: 0.9718
 Site-Art                           | Train Loss: 1.0864 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.6028 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 0.7576 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.0809 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.4798 | Train Acc: 0.8551
 Site-Product                       | Train Loss: 1.2169 | Train Acc: 0.9375
Average Train Accuracy: 0.7609
 Site-Clipart                       | Val  Loss: 0.5913 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4350 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5467 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.8722 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.1435 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.3552 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8471 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.7631 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.5616 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.4069 | Val  Acc: 0.8261
 Site-Product                       | Val  Loss: 1.5214 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8882
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 1.5269 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.6458 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9582 | Train Acc: 0.1633
 Site-Clipart                       | Train Loss: 1.2135 | Train Acc: 0.6867
 Site-Clipart                       | Train Loss: 0.7110 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 1.0683 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.5808 | Train Acc: 0.5789
 Site-Art                           | Train Loss: 0.7295 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 1.0687 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.3501 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.2265 | Train Acc: 0.9062
Average Train Accuracy: 0.7413
 Site-Clipart                       | Val  Loss: 0.5664 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4411 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5065 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.8236 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.0957 | Val  Acc: 0.7447
 Site-Art                           | Val  Loss: 0.3512 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7917 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7513 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 1.4523 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 1.3483 | Val  Acc: 0.8913
 Site-Product                       | Val  Loss: 1.4531 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9128
 Best site-Clipart                   | Epoch:38 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:38 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9688
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9636
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.7447
 Best site-Art                       | Epoch:38 | Val Acc: 1.0000
 Best site-Art                       | Epoch:38 | Val Acc: 1.0000
 Best site-Art                       | Epoch:38 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:38 | Val Acc: 0.8889
 Best site-RealWorld                 | Epoch:38 | Val Acc: 0.8913
 Best site-Product                   | Epoch:38 | Val Acc: 0.8140
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 1.5034 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.6228 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.8823 | Train Acc: 0.2653
 Site-Clipart                       | Train Loss: 1.2176 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.6254 | Train Acc: 0.9648
 Site-Art                           | Train Loss: 1.0441 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.5735 | Train Acc: 0.5614
 Site-Art                           | Train Loss: 0.6689 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 0.9966 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3424 | Train Acc: 0.7971
 Site-Product                       | Train Loss: 1.1811 | Train Acc: 0.9219
Average Train Accuracy: 0.7556
 Site-Clipart                       | Val  Loss: 0.5607 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3893 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.5215 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.8561 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 1.0652 | Val  Acc: 0.7553
 Site-Art                           | Val  Loss: 0.3657 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7962 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.8257 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.5298 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.3768 | Val  Acc: 0.8478
 Site-Product                       | Val  Loss: 1.5079 | Val  Acc: 0.7442
Average Valid Accuracy: 0.8896
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 1.5647 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.6044 | Train Acc: 0.5517
 Site-Clipart                       | Train Loss: 1.9529 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.2370 | Train Acc: 0.7108
 Site-Clipart                       | Train Loss: 0.5878 | Train Acc: 0.9507
 Site-Art                           | Train Loss: 1.0365 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.5428 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 0.7105 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 1.0162 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.4193 | Train Acc: 0.8551
 Site-Product                       | Train Loss: 1.1488 | Train Acc: 0.9531
Average Train Accuracy: 0.7456
 Site-Clipart                       | Val  Loss: 0.5087 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4046 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4905 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.8116 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.0917 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.3046 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7762 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.7223 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.4672 | Val  Acc: 0.7407
 Site-RealWorld                     | Val  Loss: 1.3052 | Val  Acc: 0.8913
 Site-Product                       | Val  Loss: 1.5088 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8899
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 1.5010 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.6275 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.8949 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.1934 | Train Acc: 0.7108
 Site-Clipart                       | Train Loss: 0.5732 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 0.9647 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.5009 | Train Acc: 0.6491
 Site-Art                           | Train Loss: 0.6924 | Train Acc: 0.9691
 Site-RealWorld                     | Train Loss: 0.9783 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.3705 | Train Acc: 0.8116
 Site-Product                       | Train Loss: 1.1441 | Train Acc: 0.9531
Average Train Accuracy: 0.7520
 Site-Clipart                       | Val  Loss: 0.5542 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3760 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4899 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.8164 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.0784 | Val  Acc: 0.7872
 Site-Art                           | Val  Loss: 0.2989 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7333 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7443 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.4753 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.3073 | Val  Acc: 0.8261
 Site-Product                       | Val  Loss: 1.4386 | Val  Acc: 0.7442
Average Valid Accuracy: 0.8971
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 1.4490 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.5440 | Train Acc: 0.5517
 Site-Clipart                       | Train Loss: 1.9258 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.1701 | Train Acc: 0.7229
 Site-Clipart                       | Train Loss: 0.5478 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 0.9931 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.5461 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 0.6722 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.9858 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.3045 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.1179 | Train Acc: 0.9219
Average Train Accuracy: 0.7621
 Site-Clipart                       | Val  Loss: 0.5471 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3710 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4876 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.7891 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.0565 | Val  Acc: 0.7660
 Site-Art                           | Val  Loss: 0.3124 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7113 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.6877 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.4450 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.3319 | Val  Acc: 0.7609
 Site-Product                       | Val  Loss: 1.4530 | Val  Acc: 0.7674
Average Valid Accuracy: 0.8906
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 1.5546 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.6131 | Train Acc: 0.4483
 Site-Clipart                       | Train Loss: 1.9368 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.1500 | Train Acc: 0.7229
 Site-Clipart                       | Train Loss: 0.5484 | Train Acc: 0.9296
 Site-Art                           | Train Loss: 0.9683 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.5402 | Train Acc: 0.5439
 Site-Art                           | Train Loss: 0.6672 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.9373 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.3192 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.1241 | Train Acc: 0.9219
Average Train Accuracy: 0.7270
 Site-Clipart                       | Val  Loss: 0.5255 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3551 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4906 | Val  Acc: 0.9375
 Site-Clipart                       | Val  Loss: 0.7648 | Val  Acc: 0.9455
 Site-Clipart                       | Val  Loss: 1.0396 | Val  Acc: 0.7553
 Site-Art                           | Val  Loss: 0.3053 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7592 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.7371 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.4205 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.2669 | Val  Acc: 0.9130
 Site-Product                       | Val  Loss: 1.4726 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8896
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 1.4481 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.6257 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 1.9609 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.0868 | Train Acc: 0.7108
 Site-Clipart                       | Train Loss: 0.5519 | Train Acc: 0.9648
 Site-Art                           | Train Loss: 0.9468 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.4987 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 0.6330 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.9440 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.3599 | Train Acc: 0.8406
 Site-Product                       | Train Loss: 1.0912 | Train Acc: 0.9219
Average Train Accuracy: 0.7509
 Site-Clipart                       | Val  Loss: 0.4681 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3343 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4600 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.7411 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.0237 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.2959 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6842 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6469 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.4413 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.2677 | Val  Acc: 0.8696
 Site-Product                       | Val  Loss: 1.4321 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8992
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 1.5007 | Train Acc: 0.4706
 Site-Clipart                       | Train Loss: 1.6212 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9033 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.1064 | Train Acc: 0.7108
 Site-Clipart                       | Train Loss: 0.4987 | Train Acc: 0.9577
 Site-Art                           | Train Loss: 0.9136 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.5089 | Train Acc: 0.5965
 Site-Art                           | Train Loss: 0.6269 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 0.8767 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.2367 | Train Acc: 0.8841
 Site-Product                       | Train Loss: 1.0560 | Train Acc: 0.9375
Average Train Accuracy: 0.7435
 Site-Clipart                       | Val  Loss: 0.4676 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.3513 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4231 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.7166 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 1.0289 | Val  Acc: 0.7340
 Site-Art                           | Val  Loss: 0.2762 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6432 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.7019 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.3933 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 1.2181 | Val  Acc: 0.8696
 Site-Product                       | Val  Loss: 1.4387 | Val  Acc: 0.6977
Average Valid Accuracy: 0.8773
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 1.4255 | Train Acc: 0.5882
 Site-Clipart                       | Train Loss: 1.5381 | Train Acc: 0.5517
 Site-Clipart                       | Train Loss: 1.9206 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.0607 | Train Acc: 0.7470
 Site-Clipart                       | Train Loss: 0.5014 | Train Acc: 0.9507
 Site-Art                           | Train Loss: 0.9298 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.5083 | Train Acc: 0.6140
 Site-Art                           | Train Loss: 0.6071 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.8844 | Train Acc: 0.9268
 Site-RealWorld                     | Train Loss: 1.2811 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.0833 | Train Acc: 0.9062
Average Train Accuracy: 0.7513
 Site-Clipart                       | Val  Loss: 0.4521 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3064 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4138 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.7118 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 1.0153 | Val  Acc: 0.7234
 Site-Art                           | Val  Loss: 0.3014 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6383 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6419 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.3698 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 1.2092 | Val  Acc: 0.8913
 Site-Product                       | Val  Loss: 1.3867 | Val  Acc: 0.8140
Average Valid Accuracy: 0.9089
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 1.4806 | Train Acc: 0.4706
 Site-Clipart                       | Train Loss: 1.6162 | Train Acc: 0.4828
 Site-Clipart                       | Train Loss: 1.8345 | Train Acc: 0.2245
 Site-Clipart                       | Train Loss: 1.0797 | Train Acc: 0.7229
 Site-Clipart                       | Train Loss: 0.4922 | Train Acc: 0.9789
 Site-Art                           | Train Loss: 0.8904 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.4610 | Train Acc: 0.6491
 Site-Art                           | Train Loss: 0.5965 | Train Acc: 0.9897
 Site-RealWorld                     | Train Loss: 0.8640 | Train Acc: 0.9512
 Site-RealWorld                     | Train Loss: 1.2481 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.0417 | Train Acc: 0.9219
Average Train Accuracy: 0.7388
 Site-Clipart                       | Val  Loss: 0.4520 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3254 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4197 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.6926 | Val  Acc: 0.9273
 Site-Clipart                       | Val  Loss: 0.9886 | Val  Acc: 0.7660
 Site-Art                           | Val  Loss: 0.2320 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6356 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.6527 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 1.3262 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 1.2122 | Val  Acc: 0.8478
 Site-Product                       | Val  Loss: 1.3802 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8932
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 1.5100 | Train Acc: 0.5294
 Site-Clipart                       | Train Loss: 1.6316 | Train Acc: 0.5172
 Site-Clipart                       | Train Loss: 1.9424 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.0487 | Train Acc: 0.6988
 Site-Clipart                       | Train Loss: 0.4626 | Train Acc: 0.9718
 Site-Art                           | Train Loss: 0.8308 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.4640 | Train Acc: 0.6140
 Site-Art                           | Train Loss: 0.5689 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8212 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.2213 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.0163 | Train Acc: 0.9219
Average Train Accuracy: 0.7481
 Site-Clipart                       | Val  Loss: 0.4689 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.2929 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4289 | Val  Acc: 0.9062
 Site-Clipart                       | Val  Loss: 0.6805 | Val  Acc: 0.9636
 Site-Clipart                       | Val  Loss: 0.9931 | Val  Acc: 0.7447
 Site-Art                           | Val  Loss: 0.2142 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6103 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6290 | Val  Acc: 0.8154
 Site-RealWorld                     | Val  Loss: 1.3330 | Val  Acc: 0.8148
 Site-RealWorld                     | Val  Loss: 1.1995 | Val  Acc: 0.7826
 Site-Product                       | Val  Loss: 1.3802 | Val  Acc: 0.7442
Average Valid Accuracy: 0.8883
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 1.3893 | Train Acc: 0.6471
 Site-Clipart                       | Train Loss: 1.5064 | Train Acc: 0.6207
 Site-Clipart                       | Train Loss: 1.9569 | Train Acc: 0.2041
 Site-Clipart                       | Train Loss: 1.0443 | Train Acc: 0.6867
 Site-Clipart                       | Train Loss: 0.4555 | Train Acc: 0.9648
 Site-Art                           | Train Loss: 0.8891 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.4395 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 0.5824 | Train Acc: 0.9794
 Site-RealWorld                     | Train Loss: 0.8043 | Train Acc: 0.9756
 Site-RealWorld                     | Train Loss: 1.0364 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.0389 | Train Acc: 0.9219
Average Train Accuracy: 0.7638
 Site-Clipart                       | Val  Loss: 0.4404 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.3222 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.4010 | Val  Acc: 0.9688
 Site-Clipart                       | Val  Loss: 0.6684 | Val  Acc: 0.9091
 Site-Clipart                       | Val  Loss: 0.9709 | Val  Acc: 0.7766
 Site-Art                           | Val  Loss: 0.2070 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6158 | Val  Acc: 0.9737
 Site-Art                           | Val  Loss: 0.6040 | Val  Acc: 0.7846
 Site-RealWorld                     | Val  Loss: 1.3198 | Val  Acc: 0.8519
 Site-RealWorld                     | Val  Loss: 1.1795 | Val  Acc: 0.8696
 Site-Product                       | Val  Loss: 1.3438 | Val  Acc: 0.7209
Average Valid Accuracy: 0.8959
===2023-08-01 17:42:20===
===2023-08-01 17:42:33===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[17,29,49,83,142,33,57,97,41,69,64,
client_nums=[5,3,2,1,]
len_dataset=[537,315,185,108,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (1)| Epoch:38 | Test Acc: 0.4766
 Test site-Art                       (1)| Epoch:38 | Test Acc: 0.6211
 Test site-RealWorld                 (1)| Epoch:38 | Test Acc: 0.6071
 Test site-Product                   (1)| Epoch:38 | Test Acc: 0.5423
Clipart: 0.4766, Art: 0.6211, RealWorld: 0.6071, Product: 0.5423, 
Average Test Accuracy(group): 0.5618, Average Test Accuracy(individual): 0.5457,
domain std=0.0575, cluster std=0.0323, individual std=0.0664, 
===2023-08-02 12:24:07===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[11,19,33,56,96,22,38,66,27,47,43,
client_nums=[5,3,2,1,]
len_dataset=[364,214,125,73,]
domain number = 4
============ Train epoch 0 ============
 Site-Art                           | Train Loss: 2.2769 | Train Acc: 0.0000
 Site-Art                           | Train Loss: 2.2943 | Train Acc: 0.0526
 Site-Art                           | Train Loss: 2.2992 | Train Acc: 0.0909
 Site-Art                           | Train Loss: 2.2821 | Train Acc: 0.2143
 Site-Art                           | Train Loss: 2.2852 | Train Acc: 0.0625
 Site-RealWorld                     | Train Loss: 2.2778 | Train Acc: 0.0455
 Site-RealWorld                     | Train Loss: 2.2795 | Train Acc: 0.1053
 Site-RealWorld                     | Train Loss: 2.2401 | Train Acc: 0.1818
 Site-Product                       | Train Loss: 2.2669 | Train Acc: 0.0000
 Site-Product                       | Train Loss: 2.2649 | Train Acc: 0.2128
 Site-Clipart                       | Train Loss: 2.2657 | Train Acc: 0.1395
Average Train Accuracy: 0.1005
 Site-Art                           | Val  Loss: 2.3028 | Val  Acc: 0.0000
 Site-Art                           | Val  Loss: 2.2744 | Val  Acc: 0.0000
 Site-Art                           | Val  Loss: 2.2628 | Val  Acc: 0.0909
 Site-Art                           | Val  Loss: 2.2891 | Val  Acc: 0.0541
 Site-Art                           | Val  Loss: 2.2733 | Val  Acc: 0.1562
 Site-RealWorld                     | Val  Loss: 2.2558 | Val  Acc: 0.0667
 Site-RealWorld                     | Val  Loss: 2.2537 | Val  Acc: 0.1200
 Site-RealWorld                     | Val  Loss: 2.2595 | Val  Acc: 0.1628
 Site-Product                       | Val  Loss: 2.2822 | Val  Acc: 0.1111
 Site-Product                       | Val  Loss: 2.2559 | Val  Acc: 0.1613
 Site-Clipart                       | Val  Loss: 2.2974 | Val  Acc: 0.0345
Average Valid Accuracy: 0.0871
 Best site-Art                       | Epoch:0 | Val Acc: 0.0000
 Best site-Art                       | Epoch:0 | Val Acc: 0.0000
 Best site-Art                       | Epoch:0 | Val Acc: 0.0909
 Best site-Art                       | Epoch:0 | Val Acc: 0.0541
 Best site-Art                       | Epoch:0 | Val Acc: 0.1562
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0667
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1200
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1628
 Best site-Product                   | Epoch:0 | Val Acc: 0.1111
 Best site-Product                   | Epoch:0 | Val Acc: 0.1613
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.0345
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 1 ============
 Site-Art                           | Train Loss: 2.2183 | Train Acc: 0.3636
 Site-Art                           | Train Loss: 2.2312 | Train Acc: 0.5263
 Site-Art                           | Train Loss: 2.2657 | Train Acc: 0.2424
 Site-Art                           | Train Loss: 2.2372 | Train Acc: 0.2679
 Site-Art                           | Train Loss: 2.2514 | Train Acc: 0.1771
 Site-RealWorld                     | Train Loss: 2.2186 | Train Acc: 0.3636
 Site-RealWorld                     | Train Loss: 2.2247 | Train Acc: 0.3947
 Site-RealWorld                     | Train Loss: 2.2214 | Train Acc: 0.3939
 Site-Product                       | Train Loss: 2.2196 | Train Acc: 0.4074
 Site-Product                       | Train Loss: 2.2119 | Train Acc: 0.3617
 Site-Clipart                       | Train Loss: 2.2266 | Train Acc: 0.2791
Average Train Accuracy: 0.3434
 Site-Art                           | Val  Loss: 2.2534 | Val  Acc: 0.1429
 Site-Art                           | Val  Loss: 2.2439 | Val  Acc: 0.0769
 Site-Art                           | Val  Loss: 2.2489 | Val  Acc: 0.1364
 Site-Art                           | Val  Loss: 2.2641 | Val  Acc: 0.1351
 Site-Art                           | Val  Loss: 2.2509 | Val  Acc: 0.2656
 Site-RealWorld                     | Val  Loss: 2.2354 | Val  Acc: 0.2000
 Site-RealWorld                     | Val  Loss: 2.2049 | Val  Acc: 0.4000
 Site-RealWorld                     | Val  Loss: 2.2126 | Val  Acc: 0.3953
 Site-Product                       | Val  Loss: 2.2452 | Val  Acc: 0.2222
 Site-Product                       | Val  Loss: 2.2024 | Val  Acc: 0.5484
 Site-Clipart                       | Val  Loss: 2.2555 | Val  Acc: 0.1379
Average Valid Accuracy: 0.2419
 Best site-Art                       | Epoch:1 | Val Acc: 0.1429
 Best site-Art                       | Epoch:1 | Val Acc: 0.0769
 Best site-Art                       | Epoch:1 | Val Acc: 0.1364
 Best site-Art                       | Epoch:1 | Val Acc: 0.1351
 Best site-Art                       | Epoch:1 | Val Acc: 0.2656
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.4000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.3953
 Best site-Product                   | Epoch:1 | Val Acc: 0.2222
 Best site-Product                   | Epoch:1 | Val Acc: 0.5484
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.1379
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 2 ============
 Site-Art                           | Train Loss: 2.2064 | Train Acc: 0.4545
 Site-Art                           | Train Loss: 2.1993 | Train Acc: 0.5263
 Site-Art                           | Train Loss: 2.1992 | Train Acc: 0.4848
 Site-Art                           | Train Loss: 2.2310 | Train Acc: 0.3036
 Site-Art                           | Train Loss: 2.2204 | Train Acc: 0.2917
 Site-RealWorld                     | Train Loss: 2.1748 | Train Acc: 0.6818
 Site-RealWorld                     | Train Loss: 2.1723 | Train Acc: 0.7105
 Site-RealWorld                     | Train Loss: 2.1842 | Train Acc: 0.6970
 Site-Product                       | Train Loss: 2.1789 | Train Acc: 0.7037
 Site-Product                       | Train Loss: 2.1542 | Train Acc: 0.7021
 Site-Clipart                       | Train Loss: 2.1894 | Train Acc: 0.4186
Average Train Accuracy: 0.5432
 Site-Art                           | Val  Loss: 2.2114 | Val  Acc: 0.2857
 Site-Art                           | Val  Loss: 2.1817 | Val  Acc: 0.6154
 Site-Art                           | Val  Loss: 2.2030 | Val  Acc: 0.3636
 Site-Art                           | Val  Loss: 2.2442 | Val  Acc: 0.1892
 Site-Art                           | Val  Loss: 2.2246 | Val  Acc: 0.2500
 Site-RealWorld                     | Val  Loss: 2.1595 | Val  Acc: 0.6000
 Site-RealWorld                     | Val  Loss: 2.1594 | Val  Acc: 0.5200
 Site-RealWorld                     | Val  Loss: 2.1683 | Val  Acc: 0.6279
 Site-Product                       | Val  Loss: 2.1965 | Val  Acc: 0.4444
 Site-Product                       | Val  Loss: 2.1540 | Val  Acc: 0.7742
 Site-Clipart                       | Val  Loss: 2.2091 | Val  Acc: 0.3448
Average Valid Accuracy: 0.4559
 Best site-Art                       | Epoch:2 | Val Acc: 0.2857
 Best site-Art                       | Epoch:2 | Val Acc: 0.6154
 Best site-Art                       | Epoch:2 | Val Acc: 0.3636
 Best site-Art                       | Epoch:2 | Val Acc: 0.1892
 Best site-Art                       | Epoch:2 | Val Acc: 0.2500
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.5200
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6279
 Best site-Product                   | Epoch:2 | Val Acc: 0.4444
 Best site-Product                   | Epoch:2 | Val Acc: 0.7742
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 3 ============
 Site-Art                           | Train Loss: 2.1454 | Train Acc: 0.6364
 Site-Art                           | Train Loss: 2.1649 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 2.1789 | Train Acc: 0.4242
 Site-Art                           | Train Loss: 2.2075 | Train Acc: 0.3571
 Site-Art                           | Train Loss: 2.1895 | Train Acc: 0.4792
 Site-RealWorld                     | Train Loss: 2.1251 | Train Acc: 0.8182
 Site-RealWorld                     | Train Loss: 2.1302 | Train Acc: 0.7895
 Site-RealWorld                     | Train Loss: 2.1393 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 2.1141 | Train Acc: 0.9259
 Site-Product                       | Train Loss: 2.1176 | Train Acc: 0.7872
 Site-Clipart                       | Train Loss: 2.1543 | Train Acc: 0.6512
Average Train Accuracy: 0.6653
 Site-Art                           | Val  Loss: 2.1616 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 2.1670 | Val  Acc: 0.4615
 Site-Art                           | Val  Loss: 2.1618 | Val  Acc: 0.6364
 Site-Art                           | Val  Loss: 2.2089 | Val  Acc: 0.3514
 Site-Art                           | Val  Loss: 2.2075 | Val  Acc: 0.3750
 Site-RealWorld                     | Val  Loss: 2.1251 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 2.1152 | Val  Acc: 0.7600
 Site-RealWorld                     | Val  Loss: 2.1168 | Val  Acc: 0.8372
 Site-Product                       | Val  Loss: 2.1331 | Val  Acc: 0.6111
 Site-Product                       | Val  Loss: 2.1189 | Val  Acc: 0.7742
 Site-Clipart                       | Val  Loss: 2.1792 | Val  Acc: 0.4483
Average Valid Accuracy: 0.6033
 Best site-Art                       | Epoch:3 | Val Acc: 0.7143
 Best site-Art                       | Epoch:3 | Val Acc: 0.4615
 Best site-Art                       | Epoch:3 | Val Acc: 0.6364
 Best site-Art                       | Epoch:3 | Val Acc: 0.3514
 Best site-Art                       | Epoch:3 | Val Acc: 0.3750
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7600
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.8372
 Best site-Product                   | Epoch:3 | Val Acc: 0.6111
 Best site-Product                   | Epoch:3 | Val Acc: 0.7742
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 4 ============
 Site-Art                           | Train Loss: 2.0984 | Train Acc: 0.7273
 Site-Art                           | Train Loss: 2.1169 | Train Acc: 0.6316
 Site-Art                           | Train Loss: 2.1310 | Train Acc: 0.6364
 Site-Art                           | Train Loss: 2.1874 | Train Acc: 0.4464
 Site-Art                           | Train Loss: 2.1619 | Train Acc: 0.6146
 Site-RealWorld                     | Train Loss: 2.0652 | Train Acc: 0.9091
 Site-RealWorld                     | Train Loss: 2.0870 | Train Acc: 0.8421
 Site-RealWorld                     | Train Loss: 2.0937 | Train Acc: 0.8788
 Site-Product                       | Train Loss: 2.0678 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 2.0749 | Train Acc: 0.8936
 Site-Clipart                       | Train Loss: 2.1061 | Train Acc: 0.7442
Average Train Accuracy: 0.7567
 Site-Art                           | Val  Loss: 2.1517 | Val  Acc: 0.5714
 Site-Art                           | Val  Loss: 2.1052 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 2.1222 | Val  Acc: 0.6364
 Site-Art                           | Val  Loss: 2.1999 | Val  Acc: 0.3514
 Site-Art                           | Val  Loss: 2.1927 | Val  Acc: 0.4219
 Site-RealWorld                     | Val  Loss: 2.0652 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 2.0425 | Val  Acc: 0.8400
 Site-RealWorld                     | Val  Loss: 2.0633 | Val  Acc: 0.9302
 Site-Product                       | Val  Loss: 2.0882 | Val  Acc: 0.8333
 Site-Product                       | Val  Loss: 2.0779 | Val  Acc: 0.9355
 Site-Clipart                       | Val  Loss: 2.1492 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7012
 Best site-Art                       | Epoch:4 | Val Acc: 0.5714
 Best site-Art                       | Epoch:4 | Val Acc: 0.8462
 Best site-Art                       | Epoch:4 | Val Acc: 0.6364
 Best site-Art                       | Epoch:4 | Val Acc: 0.3514
 Best site-Art                       | Epoch:4 | Val Acc: 0.4219
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8400
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9302
 Best site-Product                   | Epoch:4 | Val Acc: 0.8333
 Best site-Product                   | Epoch:4 | Val Acc: 0.9355
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.4138
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 5 ============
 Site-Art                           | Train Loss: 2.0548 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 2.0440 | Train Acc: 0.7895
 Site-Art                           | Train Loss: 2.0888 | Train Acc: 0.6970
 Site-Art                           | Train Loss: 2.1844 | Train Acc: 0.3750
 Site-Art                           | Train Loss: 2.1261 | Train Acc: 0.6458
 Site-RealWorld                     | Train Loss: 1.9977 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 2.0415 | Train Acc: 0.8947
 Site-RealWorld                     | Train Loss: 2.0335 | Train Acc: 0.9242
 Site-Product                       | Train Loss: 2.0324 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 2.0399 | Train Acc: 0.8723
 Site-Clipart                       | Train Loss: 2.0686 | Train Acc: 0.8140
Average Train Accuracy: 0.8069
 Site-Art                           | Val  Loss: 2.1136 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 2.0776 | Val  Acc: 0.7692
 Site-Art                           | Val  Loss: 2.0826 | Val  Acc: 0.8182
 Site-Art                           | Val  Loss: 2.1569 | Val  Acc: 0.5405
 Site-Art                           | Val  Loss: 2.1756 | Val  Acc: 0.3750
 Site-RealWorld                     | Val  Loss: 2.0426 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 2.0214 | Val  Acc: 0.9200
 Site-RealWorld                     | Val  Loss: 2.0150 | Val  Acc: 0.9535
 Site-Product                       | Val  Loss: 2.0347 | Val  Acc: 0.9444
 Site-Product                       | Val  Loss: 2.0227 | Val  Acc: 0.9677
 Site-Clipart                       | Val  Loss: 2.0854 | Val  Acc: 0.7241
Average Valid Accuracy: 0.7873
 Best site-Art                       | Epoch:5 | Val Acc: 0.7143
 Best site-Art                       | Epoch:5 | Val Acc: 0.7692
 Best site-Art                       | Epoch:5 | Val Acc: 0.8182
 Best site-Art                       | Epoch:5 | Val Acc: 0.5405
 Best site-Art                       | Epoch:5 | Val Acc: 0.3750
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9200
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9535
 Best site-Product                   | Epoch:5 | Val Acc: 0.9444
 Best site-Product                   | Epoch:5 | Val Acc: 0.9677
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7241
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 6 ============
 Site-Art                           | Train Loss: 1.9943 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.9913 | Train Acc: 0.8947
 Site-Art                           | Train Loss: 2.0579 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 2.1635 | Train Acc: 0.4643
 Site-Art                           | Train Loss: 2.0877 | Train Acc: 0.7292
 Site-RealWorld                     | Train Loss: 1.9717 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.9806 | Train Acc: 0.9474
 Site-RealWorld                     | Train Loss: 1.9704 | Train Acc: 0.9394
 Site-Product                       | Train Loss: 1.9791 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.9814 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 2.0266 | Train Acc: 0.8605
Average Train Accuracy: 0.8674
 Site-Art                           | Val  Loss: 2.0585 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 2.0542 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 2.0480 | Val  Acc: 0.8636
 Site-Art                           | Val  Loss: 2.1424 | Val  Acc: 0.5405
 Site-Art                           | Val  Loss: 2.1510 | Val  Acc: 0.3750
 Site-RealWorld                     | Val  Loss: 1.9900 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 1.9710 | Val  Acc: 0.9600
 Site-RealWorld                     | Val  Loss: 1.9802 | Val  Acc: 0.9767
 Site-Product                       | Val  Loss: 1.9890 | Val  Acc: 0.9444
 Site-Product                       | Val  Loss: 1.9795 | Val  Acc: 0.9355
 Site-Clipart                       | Val  Loss: 2.0483 | Val  Acc: 0.8276
Average Valid Accuracy: 0.8306
 Best site-Art                       | Epoch:6 | Val Acc: 0.8571
 Best site-Art                       | Epoch:6 | Val Acc: 0.9231
 Best site-Art                       | Epoch:6 | Val Acc: 0.8636
 Best site-Art                       | Epoch:6 | Val Acc: 0.5405
 Best site-Art                       | Epoch:6 | Val Acc: 0.3750
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9600
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9767
 Best site-Product                   | Epoch:6 | Val Acc: 0.9444
 Best site-Product                   | Epoch:6 | Val Acc: 0.9355
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8276
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 7 ============
 Site-Art                           | Train Loss: 1.9511 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.9486 | Train Acc: 0.8947
 Site-Art                           | Train Loss: 2.0097 | Train Acc: 0.8485
 Site-Art                           | Train Loss: 2.1380 | Train Acc: 0.5179
 Site-Art                           | Train Loss: 2.0575 | Train Acc: 0.7812
 Site-RealWorld                     | Train Loss: 1.9161 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.9456 | Train Acc: 0.9474
 Site-RealWorld                     | Train Loss: 1.9061 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.9370 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.9555 | Train Acc: 0.9362
 Site-Clipart                       | Train Loss: 1.9949 | Train Acc: 0.8837
Average Train Accuracy: 0.8753
 Site-Art                           | Val  Loss: 1.9927 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.9932 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 2.0092 | Val  Acc: 0.8182
 Site-Art                           | Val  Loss: 2.0999 | Val  Acc: 0.5676
 Site-Art                           | Val  Loss: 2.1347 | Val  Acc: 0.5781
 Site-RealWorld                     | Val  Loss: 1.9513 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9337 | Val  Acc: 0.9200
 Site-RealWorld                     | Val  Loss: 1.9174 | Val  Acc: 0.9767
 Site-Product                       | Val  Loss: 1.9715 | Val  Acc: 0.9444
 Site-Product                       | Val  Loss: 1.9304 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 2.0080 | Val  Acc: 0.8276
Average Valid Accuracy: 0.8687
 Best site-Art                       | Epoch:7 | Val Acc: 1.0000
 Best site-Art                       | Epoch:7 | Val Acc: 0.9231
 Best site-Art                       | Epoch:7 | Val Acc: 0.8182
 Best site-Art                       | Epoch:7 | Val Acc: 0.5676
 Best site-Art                       | Epoch:7 | Val Acc: 0.5781
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9200
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9767
 Best site-Product                   | Epoch:7 | Val Acc: 0.9444
 Best site-Product                   | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8276
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 8 ============
 Site-Art                           | Train Loss: 1.9258 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 1.9034 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.9881 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 2.1310 | Train Acc: 0.5000
 Site-Art                           | Train Loss: 2.0280 | Train Acc: 0.8646
 Site-RealWorld                     | Train Loss: 1.8863 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.9110 | Train Acc: 0.9474
 Site-RealWorld                     | Train Loss: 1.8438 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 1.8801 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.9174 | Train Acc: 0.9574
 Site-Clipart                       | Train Loss: 1.9423 | Train Acc: 0.9070
Average Train Accuracy: 0.8818
 Site-Art                           | Val  Loss: 1.9921 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.9675 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.9775 | Val  Acc: 0.8636
 Site-Art                           | Val  Loss: 2.0948 | Val  Acc: 0.6486
 Site-Art                           | Val  Loss: 2.1195 | Val  Acc: 0.5156
 Site-RealWorld                     | Val  Loss: 1.9132 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 1.8952 | Val  Acc: 0.9600
 Site-RealWorld                     | Val  Loss: 1.8727 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.9233 | Val  Acc: 0.9444
 Site-Product                       | Val  Loss: 1.8837 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.9639 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8706
 Best site-Art                       | Epoch:8 | Val Acc: 0.8571
 Best site-Art                       | Epoch:8 | Val Acc: 0.9231
 Best site-Art                       | Epoch:8 | Val Acc: 0.8636
 Best site-Art                       | Epoch:8 | Val Acc: 0.6486
 Best site-Art                       | Epoch:8 | Val Acc: 0.5156
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9600
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-Product                   | Epoch:8 | Val Acc: 0.9444
 Best site-Product                   | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 9 ============
 Site-Art                           | Train Loss: 1.8400 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.8649 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.9571 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 2.1094 | Train Acc: 0.5000
 Site-Art                           | Train Loss: 1.9974 | Train Acc: 0.8438
 Site-RealWorld                     | Train Loss: 1.8148 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.8373 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7990 | Train Acc: 0.9697
 Site-Product                       | Train Loss: 1.8542 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.8590 | Train Acc: 0.9574
 Site-Clipart                       | Train Loss: 1.9153 | Train Acc: 0.9302
Average Train Accuracy: 0.9108
 Site-Art                           | Val  Loss: 1.9343 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.9328 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.9285 | Val  Acc: 0.9091
 Site-Art                           | Val  Loss: 2.0610 | Val  Acc: 0.5946
 Site-Art                           | Val  Loss: 2.1054 | Val  Acc: 0.5781
 Site-RealWorld                     | Val  Loss: 1.8593 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8309 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8243 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8584 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8526 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.9358 | Val  Acc: 0.9310
Average Valid Accuracy: 0.9103
 Best site-Art                       | Epoch:9 | Val Acc: 1.0000
 Best site-Art                       | Epoch:9 | Val Acc: 1.0000
 Best site-Art                       | Epoch:9 | Val Acc: 0.9091
 Best site-Art                       | Epoch:9 | Val Acc: 0.5946
 Best site-Art                       | Epoch:9 | Val Acc: 0.5781
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 10 ============
 Site-Art                           | Train Loss: 1.8331 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.8276 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.8891 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 2.0895 | Train Acc: 0.5714
 Site-Art                           | Train Loss: 1.9646 | Train Acc: 0.8438
 Site-RealWorld                     | Train Loss: 1.7769 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7975 | Train Acc: 0.9474
 Site-RealWorld                     | Train Loss: 1.7982 | Train Acc: 0.9697
 Site-Product                       | Train Loss: 1.8052 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.8260 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.8741 | Train Acc: 0.9070
Average Train Accuracy: 0.9124
 Site-Art                           | Val  Loss: 1.9063 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.8966 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.8903 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 2.0474 | Val  Acc: 0.7027
 Site-Art                           | Val  Loss: 2.0902 | Val  Acc: 0.5000
 Site-RealWorld                     | Val  Loss: 1.7969 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8068 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7788 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8158 | Val  Acc: 0.9444
 Site-Product                       | Val  Loss: 1.8058 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.8737 | Val  Acc: 0.9310
Average Valid Accuracy: 0.9051
============ Train epoch 11 ============
 Site-Art                           | Train Loss: 1.7797 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.7928 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.8690 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 2.0653 | Train Acc: 0.6250
 Site-Art                           | Train Loss: 1.9342 | Train Acc: 0.8854
 Site-RealWorld                     | Train Loss: 1.7364 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.7745 | Train Acc: 0.9474
 Site-RealWorld                     | Train Loss: 1.7199 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 1.7575 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.7862 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.8336 | Train Acc: 0.9070
Average Train Accuracy: 0.9265
 Site-Art                           | Val  Loss: 1.8512 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.8797 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.8726 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 2.0310 | Val  Acc: 0.7297
 Site-Art                           | Val  Loss: 2.0706 | Val  Acc: 0.6250
 Site-RealWorld                     | Val  Loss: 1.7685 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7519 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7302 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7709 | Val  Acc: 0.9444
 Site-Product                       | Val  Loss: 1.7650 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.8616 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9220
 Best site-Art                       | Epoch:11 | Val Acc: 1.0000
 Best site-Art                       | Epoch:11 | Val Acc: 0.9231
 Best site-Art                       | Epoch:11 | Val Acc: 0.9545
 Best site-Art                       | Epoch:11 | Val Acc: 0.7297
 Best site-Art                       | Epoch:11 | Val Acc: 0.6250
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-Product                   | Epoch:11 | Val Acc: 0.9444
 Best site-Product                   | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9655
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 12 ============
 Site-Art                           | Train Loss: 1.7375 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.7220 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.8345 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 2.0764 | Train Acc: 0.6071
 Site-Art                           | Train Loss: 1.9120 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.6965 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.7080 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7261 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 1.7159 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.7455 | Train Acc: 0.9574
 Site-Clipart                       | Train Loss: 1.7946 | Train Acc: 0.9535
Average Train Accuracy: 0.9376
 Site-Art                           | Val  Loss: 1.8141 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.8061 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.8409 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 2.0032 | Val  Acc: 0.6757
 Site-Art                           | Val  Loss: 2.0466 | Val  Acc: 0.6719
 Site-RealWorld                     | Val  Loss: 1.7252 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7112 | Val  Acc: 0.9600
 Site-RealWorld                     | Val  Loss: 1.7154 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7675 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6994 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.8009 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9259
 Best site-Art                       | Epoch:12 | Val Acc: 1.0000
 Best site-Art                       | Epoch:12 | Val Acc: 0.9231
 Best site-Art                       | Epoch:12 | Val Acc: 0.9545
 Best site-Art                       | Epoch:12 | Val Acc: 0.6757
 Best site-Art                       | Epoch:12 | Val Acc: 0.6719
 Best site-RealWorld                 | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9600
 Best site-RealWorld                 | Epoch:12 | Val Acc: 1.0000
 Best site-Product                   | Epoch:12 | Val Acc: 1.0000
 Best site-Product                   | Epoch:12 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:12 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 13 ============
 Site-Art                           | Train Loss: 1.6959 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.7229 | Train Acc: 0.8947
 Site-Art                           | Train Loss: 1.7818 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 2.0546 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.8749 | Train Acc: 0.8958
 Site-RealWorld                     | Train Loss: 1.6438 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.6601 | Train Acc: 0.9737
 Site-RealWorld                     | Train Loss: 1.6328 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 1.6753 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.7122 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.7551 | Train Acc: 0.9302
Average Train Accuracy: 0.9268
 Site-Art                           | Val  Loss: 1.7892 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.8219 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 1.8048 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.9642 | Val  Acc: 0.7027
 Site-Art                           | Val  Loss: 2.0244 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 1.6786 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6594 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6384 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7268 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6596 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.7578 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9187
============ Train epoch 14 ============
 Site-Art                           | Train Loss: 1.6521 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.6533 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.7585 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 2.0169 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.8526 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.6119 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.6384 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5387 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.6285 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.6488 | Train Acc: 0.9574
 Site-Clipart                       | Train Loss: 1.7058 | Train Acc: 0.9535
Average Train Accuracy: 0.9264
 Site-Art                           | Val  Loss: 1.7518 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.7846 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.7834 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.9625 | Val  Acc: 0.7027
 Site-Art                           | Val  Loss: 2.0234 | Val  Acc: 0.6562
 Site-RealWorld                     | Val  Loss: 1.6322 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6372 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5962 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6509 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6443 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.7477 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9306
 Best site-Art                       | Epoch:14 | Val Acc: 1.0000
 Best site-Art                       | Epoch:14 | Val Acc: 0.9231
 Best site-Art                       | Epoch:14 | Val Acc: 0.9545
 Best site-Art                       | Epoch:14 | Val Acc: 0.7027
 Best site-Art                       | Epoch:14 | Val Acc: 0.6562
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-Product                   | Epoch:14 | Val Acc: 1.0000
 Best site-Product                   | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:14 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 15 ============
 Site-Art                           | Train Loss: 1.5775 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.6306 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.6874 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.9918 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 1.8073 | Train Acc: 0.9479
 Site-RealWorld                     | Train Loss: 1.5351 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.6027 | Train Acc: 0.9737
 Site-RealWorld                     | Train Loss: 1.5526 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 1.5928 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.6372 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.6766 | Train Acc: 0.9535
Average Train Accuracy: 0.9486
 Site-Art                           | Val  Loss: 1.7182 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.7267 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.7338 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.9273 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 2.0082 | Val  Acc: 0.6719
 Site-RealWorld                     | Val  Loss: 1.5976 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5674 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5585 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6222 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5954 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.7052 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9344
 Best site-Art                       | Epoch:15 | Val Acc: 0.8571
 Best site-Art                       | Epoch:15 | Val Acc: 1.0000
 Best site-Art                       | Epoch:15 | Val Acc: 1.0000
 Best site-Art                       | Epoch:15 | Val Acc: 0.7838
 Best site-Art                       | Epoch:15 | Val Acc: 0.6719
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9655
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 16 ============
 Site-Art                           | Train Loss: 1.5812 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5599 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.6800 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.9949 | Train Acc: 0.6071
 Site-Art                           | Train Loss: 1.7850 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.5173 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5352 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5904 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 1.5392 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.5890 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.6532 | Train Acc: 0.9767
Average Train Accuracy: 0.9485
 Site-Art                           | Val  Loss: 1.6757 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6887 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.7347 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.9242 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.9656 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 1.5703 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5288 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5202 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5975 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5748 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.6894 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9562
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 1.0000
 Best site-Art                       | Epoch:16 | Val Acc: 0.7838
 Best site-Art                       | Epoch:16 | Val Acc: 0.7344
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-Product                   | Epoch:16 | Val Acc: 1.0000
 Best site-Product                   | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:16 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 17 ============
 Site-Art                           | Train Loss: 1.5080 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5726 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.6782 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.9824 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.7591 | Train Acc: 0.9479
 Site-RealWorld                     | Train Loss: 1.4789 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.4964 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4689 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.5088 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.5391 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.6290 | Train Acc: 0.9535
Average Train Accuracy: 0.9422
 Site-Art                           | Val  Loss: 1.6358 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6514 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6865 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.8727 | Val  Acc: 0.8378
 Site-Art                           | Val  Loss: 1.9704 | Val  Acc: 0.6719
 Site-RealWorld                     | Val  Loss: 1.5260 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5017 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4979 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5541 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5096 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.6498 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9513
============ Train epoch 18 ============
 Site-Art                           | Train Loss: 1.4667 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5056 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.6126 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.9762 | Train Acc: 0.6071
 Site-Art                           | Train Loss: 1.7191 | Train Acc: 0.9375
 Site-RealWorld                     | Train Loss: 1.4108 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4610 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4364 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.4655 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.4852 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 1.5941 | Train Acc: 0.9535
Average Train Accuracy: 0.9441
 Site-Art                           | Val  Loss: 1.6419 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6394 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 1.6328 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.8579 | Val  Acc: 0.6757
 Site-Art                           | Val  Loss: 1.9477 | Val  Acc: 0.6094
 Site-RealWorld                     | Val  Loss: 1.5162 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4624 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4626 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4927 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4415 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.6160 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9169
============ Train epoch 19 ============
 Site-Art                           | Train Loss: 1.4493 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.4619 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5727 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.9646 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.7084 | Train Acc: 0.9271
 Site-RealWorld                     | Train Loss: 1.3622 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4127 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3372 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 1.4203 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.4549 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.5500 | Train Acc: 0.9302
Average Train Accuracy: 0.9485
 Site-Art                           | Val  Loss: 1.5980 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5697 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.6282 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.8605 | Val  Acc: 0.7297
 Site-Art                           | Val  Loss: 1.9543 | Val  Acc: 0.6562
 Site-RealWorld                     | Val  Loss: 1.4604 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4655 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4117 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4905 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4269 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.5815 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9372
============ Train epoch 20 ============
 Site-Art                           | Train Loss: 1.3756 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.3798 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5527 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.9689 | Train Acc: 0.5893
 Site-Art                           | Train Loss: 1.6629 | Train Acc: 0.9479
 Site-RealWorld                     | Train Loss: 1.3225 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3809 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3535 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.3760 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.4168 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.5100 | Train Acc: 0.9535
Average Train Accuracy: 0.9435
 Site-Art                           | Val  Loss: 1.5492 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5571 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5458 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.8103 | Val  Acc: 0.8108
 Site-Art                           | Val  Loss: 1.9248 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 1.4295 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3609 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4063 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4149 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3802 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.5163 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9587
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-Art                       | Epoch:20 | Val Acc: 1.0000
 Best site-Art                       | Epoch:20 | Val Acc: 0.8108
 Best site-Art                       | Epoch:20 | Val Acc: 0.7344
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-Product                   | Epoch:20 | Val Acc: 1.0000
 Best site-Product                   | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:20 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 21 ============
 Site-Art                           | Train Loss: 1.3391 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.4033 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.5357 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.9209 | Train Acc: 0.6607
 Site-Art                           | Train Loss: 1.6542 | Train Acc: 0.9271
 Site-RealWorld                     | Train Loss: 1.2895 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3384 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3332 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.3347 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.3879 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 1.4773 | Train Acc: 0.9535
Average Train Accuracy: 0.9480
 Site-Art                           | Val  Loss: 1.5116 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5145 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5335 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.8077 | Val  Acc: 0.7568
 Site-Art                           | Val  Loss: 1.9121 | Val  Acc: 0.6719
 Site-RealWorld                     | Val  Loss: 1.3664 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3407 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3403 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3868 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3430 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.5178 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9481
============ Train epoch 22 ============
 Site-Art                           | Train Loss: 1.3389 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.3235 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5450 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.9236 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.6197 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.2421 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.2864 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2930 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2999 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.3715 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.4505 | Train Acc: 0.9767
Average Train Accuracy: 0.9501
 Site-Art                           | Val  Loss: 1.4511 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4808 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.5319 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.7767 | Val  Acc: 0.8108
 Site-Art                           | Val  Loss: 1.9168 | Val  Acc: 0.6562
 Site-RealWorld                     | Val  Loss: 1.3198 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3557 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2873 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3167 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3271 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.4447 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9404
============ Train epoch 23 ============
 Site-Art                           | Train Loss: 1.2693 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.3182 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.4242 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.9039 | Train Acc: 0.6607
 Site-Art                           | Train Loss: 1.5903 | Train Acc: 0.9271
 Site-RealWorld                     | Train Loss: 1.2113 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2690 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3459 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2718 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.3342 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.4236 | Train Acc: 0.9767
Average Train Accuracy: 0.9585
 Site-Art                           | Val  Loss: 1.4512 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4537 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4712 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.7766 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.8587 | Val  Acc: 0.7500
 Site-RealWorld                     | Val  Loss: 1.3363 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3021 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2435 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3187 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2752 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.4273 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9576
============ Train epoch 24 ============
 Site-Art                           | Train Loss: 1.2627 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.2655 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.4160 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.8798 | Train Acc: 0.7321
 Site-Art                           | Train Loss: 1.5638 | Train Acc: 0.9271
 Site-RealWorld                     | Train Loss: 1.1570 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2538 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3589 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2434 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2610 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.3481 | Train Acc: 0.9767
Average Train Accuracy: 0.9650
 Site-Art                           | Val  Loss: 1.4193 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.4406 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4814 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.7383 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.8710 | Val  Acc: 0.6875
 Site-RealWorld                     | Val  Loss: 1.2988 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2350 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2387 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2805 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2538 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.3757 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9389
============ Train epoch 25 ============
 Site-Art                           | Train Loss: 1.2217 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.2482 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.4098 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.8938 | Train Acc: 0.5893
 Site-Art                           | Train Loss: 1.5362 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 1.1305 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1984 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1543 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2051 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2714 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.3255 | Train Acc: 0.9767
Average Train Accuracy: 0.9482
 Site-Art                           | Val  Loss: 1.3829 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4064 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4068 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.7151 | Val  Acc: 0.7297
 Site-Art                           | Val  Loss: 1.8427 | Val  Acc: 0.7031
 Site-RealWorld                     | Val  Loss: 1.2472 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2062 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2174 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2235 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2089 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.3434 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9484
============ Train epoch 26 ============
 Site-Art                           | Train Loss: 1.1996 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.1862 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.3416 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.8564 | Train Acc: 0.6607
 Site-Art                           | Train Loss: 1.4873 | Train Acc: 0.9479
 Site-RealWorld                     | Train Loss: 1.1164 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.1682 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1775 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1571 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1980 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.2931 | Train Acc: 0.9767
Average Train Accuracy: 0.9452
 Site-Art                           | Val  Loss: 1.3094 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3248 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4079 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.7074 | Val  Acc: 0.7568
 Site-Art                           | Val  Loss: 1.8309 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 1.1914 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1435 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1497 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1958 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1994 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.3524 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9496
============ Train epoch 27 ============
 Site-Art                           | Train Loss: 1.1454 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1501 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.3620 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.8514 | Train Acc: 0.6250
 Site-Art                           | Train Loss: 1.4837 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 1.0649 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1249 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1035 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1292 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1628 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 1.2644 | Train Acc: 0.9535
Average Train Accuracy: 0.9533
 Site-Art                           | Val  Loss: 1.3373 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3648 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.3803 | Val  Acc: 0.9091
 Site-Art                           | Val  Loss: 1.6857 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.8272 | Val  Acc: 0.6875
 Site-RealWorld                     | Val  Loss: 1.1777 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1357 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1287 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1798 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1226 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.2794 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9367
============ Train epoch 28 ============
 Site-Art                           | Train Loss: 1.1359 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1382 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.2587 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.8231 | Train Acc: 0.6964
 Site-Art                           | Train Loss: 1.4482 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.0420 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.0620 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0056 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0818 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1547 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.2260 | Train Acc: 1.0000
Average Train Accuracy: 0.9625
 Site-Art                           | Val  Loss: 1.2659 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3249 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.3098 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6482 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.8016 | Val  Acc: 0.7031
 Site-RealWorld                     | Val  Loss: 1.1386 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0727 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0987 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1491 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1290 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.2769 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9464
============ Train epoch 29 ============
 Site-Art                           | Train Loss: 1.0904 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1390 | Train Acc: 0.9474
 Site-Art                           | Train Loss: 1.2316 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.8193 | Train Acc: 0.6964
 Site-Art                           | Train Loss: 1.4396 | Train Acc: 0.9375
 Site-RealWorld                     | Train Loss: 0.9783 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0479 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1686 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 1.0593 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0982 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.2276 | Train Acc: 0.9767
Average Train Accuracy: 0.9538
 Site-Art                           | Val  Loss: 1.2674 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2742 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2845 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6506 | Val  Acc: 0.7568
 Site-Art                           | Val  Loss: 1.8023 | Val  Acc: 0.7031
 Site-RealWorld                     | Val  Loss: 1.1288 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0978 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0484 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1193 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0648 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.1898 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9509
============ Train epoch 30 ============
 Site-Art                           | Train Loss: 1.0411 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.0312 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.2365 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.8058 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.4208 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.9543 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 1.0369 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0443 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0153 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0725 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.1725 | Train Acc: 0.9535
Average Train Accuracy: 0.9507
 Site-Art                           | Val  Loss: 1.2243 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2531 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 1.3224 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.6226 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.7875 | Val  Acc: 0.6094
 Site-RealWorld                     | Val  Loss: 1.0736 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1100 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0232 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0995 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0618 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.1837 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9267
============ Train epoch 31 ============
 Site-Art                           | Train Loss: 1.0585 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 1.0361 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.2281 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.7720 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 1.3894 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.9079 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0012 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9397 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 0.9918 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0453 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.1428 | Train Acc: 1.0000
Average Train Accuracy: 0.9499
 Site-Art                           | Val  Loss: 1.2230 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2263 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2539 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.6012 | Val  Acc: 0.8378
 Site-Art                           | Val  Loss: 1.7616 | Val  Acc: 0.6250
 Site-RealWorld                     | Val  Loss: 1.0320 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0409 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9840 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0729 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0042 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.1723 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9470
============ Train epoch 32 ============
 Site-Art                           | Train Loss: 0.9838 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.0552 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1590 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.7683 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 1.3588 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.8938 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.9636 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9747 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9525 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0279 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.1067 | Train Acc: 0.9535
Average Train Accuracy: 0.9539
 Site-Art                           | Val  Loss: 1.1906 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2232 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.2051 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5842 | Val  Acc: 0.8108
 Site-Art                           | Val  Loss: 1.7550 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 0.9880 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9774 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9680 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9829 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9599 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.1248 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9517
============ Train epoch 33 ============
 Site-Art                           | Train Loss: 0.9208 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.9751 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1496 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.7754 | Train Acc: 0.6964
 Site-Art                           | Train Loss: 1.3297 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.8583 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9020 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0110 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9341 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0109 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.1009 | Train Acc: 0.9767
Average Train Accuracy: 0.9655
 Site-Art                           | Val  Loss: 1.1530 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1843 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1774 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5579 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.7228 | Val  Acc: 0.6875
 Site-RealWorld                     | Val  Loss: 0.9852 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9845 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9437 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9677 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9624 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.1230 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9519
============ Train epoch 34 ============
 Site-Art                           | Train Loss: 0.9294 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.9344 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1258 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.7811 | Train Acc: 0.5893
 Site-Art                           | Train Loss: 1.3098 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.8592 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.8783 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9722 | Train Acc: 0.9848
 Site-Product                       | Train Loss: 0.8989 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9740 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 1.0518 | Train Acc: 0.9535
Average Train Accuracy: 0.9464
 Site-Art                           | Val  Loss: 1.0683 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1796 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.1767 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.5039 | Val  Acc: 0.8649
 Site-Art                           | Val  Loss: 1.7218 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 0.9226 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9478 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8753 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9370 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9179 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.0884 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9524
============ Train epoch 35 ============
 Site-Art                           | Train Loss: 0.9010 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.9313 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1363 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.7295 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 1.2778 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.8005 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8923 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8580 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8768 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9178 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 1.0260 | Train Acc: 0.9535
Average Train Accuracy: 0.9591
 Site-Art                           | Val  Loss: 1.0922 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1125 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.1544 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.5288 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.7061 | Val  Acc: 0.7656
 Site-RealWorld                     | Val  Loss: 0.9946 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9008 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8754 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9517 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8909 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.0712 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9479
============ Train epoch 36 ============
 Site-Art                           | Train Loss: 0.8661 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8882 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1113 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.7223 | Train Acc: 0.6964
 Site-Art                           | Train Loss: 1.2696 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.7758 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8150 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7714 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8243 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9338 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 1.0185 | Train Acc: 0.9767
Average Train Accuracy: 0.9628
 Site-Art                           | Val  Loss: 1.0933 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0939 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.0913 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5532 | Val  Acc: 0.7568
 Site-Art                           | Val  Loss: 1.6819 | Val  Acc: 0.7656
 Site-RealWorld                     | Val  Loss: 0.8968 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8970 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8350 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9262 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8687 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.0452 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9496
============ Train epoch 37 ============
 Site-Art                           | Train Loss: 0.8549 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8616 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.0387 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.7178 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.2333 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.7831 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.7784 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8974 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8269 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9042 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.9978 | Train Acc: 1.0000
Average Train Accuracy: 0.9586
 Site-Art                           | Val  Loss: 1.0445 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0913 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.1112 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4750 | Val  Acc: 0.7297
 Site-Art                           | Val  Loss: 1.6820 | Val  Acc: 0.7188
 Site-RealWorld                     | Val  Loss: 0.9067 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8607 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8025 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8836 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8239 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 1.0114 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9429
============ Train epoch 38 ============
 Site-Art                           | Train Loss: 0.7746 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8651 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.0260 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.7038 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 1.2107 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.7659 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7618 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7969 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7795 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8726 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.9643 | Train Acc: 0.9535
Average Train Accuracy: 0.9600
 Site-Art                           | Val  Loss: 1.0301 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0701 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.1079 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.4650 | Val  Acc: 0.8378
 Site-Art                           | Val  Loss: 1.6887 | Val  Acc: 0.6719
 Site-RealWorld                     | Val  Loss: 0.8442 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8001 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7882 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8411 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8072 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.9429 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9443
============ Train epoch 39 ============
 Site-Art                           | Train Loss: 0.7879 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7533 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.0323 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.6784 | Train Acc: 0.6964
 Site-Art                           | Train Loss: 1.1810 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.7043 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7392 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7247 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7361 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8138 | Train Acc: 0.9574
 Site-Clipart                       | Train Loss: 0.9495 | Train Acc: 0.9767
Average Train Accuracy: 0.9571
 Site-Art                           | Val  Loss: 1.0015 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.9724 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.0640 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4151 | Val  Acc: 0.8649
 Site-Art                           | Val  Loss: 1.6766 | Val  Acc: 0.7031
 Site-RealWorld                     | Val  Loss: 0.8464 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8272 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7730 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8469 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7840 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.9121 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9477
============ Train epoch 40 ============
 Site-Art                           | Train Loss: 0.7543 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7750 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.0015 | Train Acc: 0.9394
 Site-Art                           | Train Loss: 1.6632 | Train Acc: 0.6607
 Site-Art                           | Train Loss: 1.1619 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.6983 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.7267 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6877 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7242 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8082 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.9201 | Train Acc: 1.0000
Average Train Accuracy: 0.9538
 Site-Art                           | Val  Loss: 0.9615 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9984 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.0436 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4345 | Val  Acc: 0.8378
 Site-Art                           | Val  Loss: 1.6551 | Val  Acc: 0.6719
 Site-RealWorld                     | Val  Loss: 0.8438 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7673 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7343 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8112 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7512 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.9374 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9484
============ Train epoch 41 ============
 Site-Art                           | Train Loss: 0.7392 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7439 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.9850 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.6667 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.1715 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.6344 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6552 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8047 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7056 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8029 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.9038 | Train Acc: 1.0000
Average Train Accuracy: 0.9618
 Site-Art                           | Val  Loss: 1.0001 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.9383 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 1.0219 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.3974 | Val  Acc: 0.8378
 Site-Art                           | Val  Loss: 1.6425 | Val  Acc: 0.7188
 Site-RealWorld                     | Val  Loss: 0.7137 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7268 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7261 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7444 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7316 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.9221 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9356
============ Train epoch 42 ============
 Site-Art                           | Train Loss: 0.8049 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.6868 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.9134 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.6639 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 1.1509 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.6324 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6823 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6449 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6733 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7462 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.8683 | Train Acc: 1.0000
Average Train Accuracy: 0.9597
 Site-Art                           | Val  Loss: 0.9086 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9959 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9489 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.4353 | Val  Acc: 0.6757
 Site-Art                           | Val  Loss: 1.6072 | Val  Acc: 0.7031
 Site-RealWorld                     | Val  Loss: 0.8027 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6987 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7183 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7548 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7027 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.9104 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9435
============ Train epoch 43 ============
 Site-Art                           | Train Loss: 0.6842 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7296 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8665 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.6841 | Train Acc: 0.5893
 Site-Art                           | Train Loss: 1.0956 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.6140 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6200 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7115 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6640 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7259 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.8505 | Train Acc: 1.0000
Average Train Accuracy: 0.9569
 Site-Art                           | Val  Loss: 0.8691 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8942 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9392 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3992 | Val  Acc: 0.7568
 Site-Art                           | Val  Loss: 1.6011 | Val  Acc: 0.7500
 Site-RealWorld                     | Val  Loss: 0.7427 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7018 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6276 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7412 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6923 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.8565 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9552
============ Train epoch 44 ============
 Site-Art                           | Train Loss: 0.6207 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6726 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8883 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.6134 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 1.0963 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.5645 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6339 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6346 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6252 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6974 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.8667 | Train Acc: 0.9767
Average Train Accuracy: 0.9639
 Site-Art                           | Val  Loss: 0.8986 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9348 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.9654 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3521 | Val  Acc: 0.8649
 Site-Art                           | Val  Loss: 1.6098 | Val  Acc: 0.6875
 Site-RealWorld                     | Val  Loss: 0.7512 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6629 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6524 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6687 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6597 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.8627 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9523
============ Train epoch 45 ============
 Site-Art                           | Train Loss: 0.6410 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6384 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8314 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.6206 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.0635 | Train Acc: 0.9688
 Site-RealWorld                     | Train Loss: 0.5593 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6068 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.5634 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6108 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7010 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.8007 | Train Acc: 0.9767
Average Train Accuracy: 0.9606
 Site-Art                           | Val  Loss: 0.8698 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8291 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9013 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3669 | Val  Acc: 0.7838
 Site-Art                           | Val  Loss: 1.5654 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 0.6788 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6601 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6307 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6632 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6161 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.8156 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9562
============ Train epoch 46 ============
 Site-Art                           | Train Loss: 0.6703 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.5967 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8206 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5857 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 1.0420 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.5516 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.5827 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6178 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5713 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6670 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.7609 | Train Acc: 1.0000
Average Train Accuracy: 0.9587
 Site-Art                           | Val  Loss: 0.8092 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8414 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.8666 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3397 | Val  Acc: 0.8108
 Site-Art                           | Val  Loss: 1.6158 | Val  Acc: 0.6719
 Site-RealWorld                     | Val  Loss: 0.6545 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6371 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6203 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6960 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6069 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.7718 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9460
============ Train epoch 47 ============
 Site-Art                           | Train Loss: 0.6592 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6109 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8289 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5871 | Train Acc: 0.6786
 Site-Art                           | Train Loss: 1.0119 | Train Acc: 0.9792
 Site-RealWorld                     | Train Loss: 0.5332 | Train Acc: 0.9545
 Site-RealWorld                     | Train Loss: 0.5567 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7083 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5397 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6413 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 0.7691 | Train Acc: 0.9535
Average Train Accuracy: 0.9605
 Site-Art                           | Val  Loss: 0.7929 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8212 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8678 | Val  Acc: 0.9545
 Site-Art                           | Val  Loss: 1.2782 | Val  Acc: 0.8378
 Site-Art                           | Val  Loss: 1.5591 | Val  Acc: 0.7344
 Site-RealWorld                     | Val  Loss: 0.6511 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6422 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5865 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6187 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5913 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.7386 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9570
============ Train epoch 48 ============
 Site-Art                           | Train Loss: 0.6492 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.6140 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8292 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.6115 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 1.0173 | Train Acc: 0.9896
 Site-RealWorld                     | Train Loss: 0.4828 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.5610 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.5870 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5379 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6189 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.7393 | Train Acc: 0.9767
Average Train Accuracy: 0.9515
 Site-Art                           | Val  Loss: 0.8077 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8478 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.8764 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.2827 | Val  Acc: 0.8378
 Site-Art                           | Val  Loss: 1.5719 | Val  Acc: 0.7188
 Site-RealWorld                     | Val  Loss: 0.6385 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5962 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5804 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6043 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5811 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.7481 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9527
============ Train epoch 49 ============
 Site-Art                           | Train Loss: 0.6774 | Train Acc: 0.9091
 Site-Art                           | Train Loss: 0.6276 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.8007 | Train Acc: 0.9697
 Site-Art                           | Train Loss: 1.6139 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 0.9668 | Train Acc: 0.9479
 Site-RealWorld                     | Train Loss: 0.4603 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.5396 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6564 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5418 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6334 | Train Acc: 0.9787
 Site-Clipart                       | Train Loss: 0.7084 | Train Acc: 0.9767
Average Train Accuracy: 0.9477
 Site-Art                           | Val  Loss: 0.7471 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8265 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8311 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3238 | Val  Acc: 0.7568
 Site-Art                           | Val  Loss: 1.5301 | Val  Acc: 0.7031
 Site-RealWorld                     | Val  Loss: 0.5630 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5905 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5459 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5789 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5454 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.7588 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9509
===2023-08-02 12:46:20===
===2023-08-02 12:46:23===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[11,19,33,56,96,22,38,66,27,47,43,
client_nums=[5,3,2,1,]
len_dataset=[364,214,125,73,]
domain number = 4
Loading snapshots...
 Test site-Art                       (0)| Epoch:20 | Test Acc: 0.6273
 Test site-RealWorld                 (0)| Epoch:20 | Test Acc: 0.5476
 Test site-Product                   (0)| Epoch:20 | Test Acc: 0.4925
 Test site-Clipart                   (1)| Epoch:20 | Test Acc: 0.3915
Art: 0.6273, RealWorld: 0.5476, Product: 0.4925, Clipart: 0.3915, 
Average Test Accuracy(group): 0.5147, Average Test Accuracy(individual): 0.5596,
domain std=0.0858, cluster std=0.0469, individual std=0.0742, 
===2023-08-02 16:40:31===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 20
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[35,52,78,117,175,17,38,85,13,68,48,
client_nums=[5,3,2,1,]
len_dataset=[766,236,138,81,]
domain number = 4
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 2.2248 | Train Acc: 0.2857
 Site-amazon                        | Train Loss: 2.2410 | Train Acc: 0.2692
 Site-amazon                        | Train Loss: 2.2101 | Train Acc: 0.3718
 Site-amazon                        | Train Loss: 2.1999 | Train Acc: 0.3590
 Site-amazon                        | Train Loss: 2.2080 | Train Acc: 0.3886
 Site-webcam                        | Train Loss: 2.2316 | Train Acc: 0.2353
 Site-webcam                        | Train Loss: 2.2185 | Train Acc: 0.3421
 Site-webcam                        | Train Loss: 2.1895 | Train Acc: 0.3647
 Site-caltech                       | Train Loss: 2.2583 | Train Acc: 0.2308
 Site-caltech                       | Train Loss: 2.1908 | Train Acc: 0.3382
 Site-dslr                          | Train Loss: 2.2240 | Train Acc: 0.2500
Average Train Accuracy: 0.3123
 Site-amazon                        | Val  Loss: 2.2245 | Val  Acc: 0.3478
 Site-amazon                        | Val  Loss: 2.2078 | Val  Acc: 0.2941
 Site-amazon                        | Val  Loss: 2.1971 | Val  Acc: 0.3269
 Site-amazon                        | Val  Loss: 2.1889 | Val  Acc: 0.3205
 Site-amazon                        | Val  Loss: 2.1982 | Val  Acc: 0.4017
 Site-webcam                        | Val  Loss: 2.1780 | Val  Acc: 0.4545
 Site-webcam                        | Val  Loss: 2.2018 | Val  Acc: 0.2400
 Site-webcam                        | Val  Loss: 2.1993 | Val  Acc: 0.3509
 Site-caltech                       | Val  Loss: 2.2247 | Val  Acc: 0.5556
 Site-caltech                       | Val  Loss: 2.2129 | Val  Acc: 0.4222
 Site-dslr                          | Val  Loss: 2.2346 | Val  Acc: 0.2812
Average Valid Accuracy: 0.3632
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3478
 Best site-amazon                    | Epoch:0 | Val Acc: 0.2941
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3269
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3205
 Best site-amazon                    | Epoch:0 | Val Acc: 0.4017
 Best site-webcam                    | Epoch:0 | Val Acc: 0.4545
 Best site-webcam                    | Epoch:0 | Val Acc: 0.2400
 Best site-webcam                    | Epoch:0 | Val Acc: 0.3509
 Best site-caltech                   | Epoch:0 | Val Acc: 0.5556
 Best site-caltech                   | Epoch:0 | Val Acc: 0.4222
 Best site-dslr                      | Epoch:0 | Val Acc: 0.2812
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 2.1360 | Train Acc: 0.6286
 Site-amazon                        | Train Loss: 2.1587 | Train Acc: 0.5192
 Site-amazon                        | Train Loss: 2.1154 | Train Acc: 0.6667
 Site-amazon                        | Train Loss: 2.1057 | Train Acc: 0.7179
 Site-amazon                        | Train Loss: 2.1098 | Train Acc: 0.7200
 Site-webcam                        | Train Loss: 2.1380 | Train Acc: 0.7059
 Site-webcam                        | Train Loss: 2.1415 | Train Acc: 0.5000
 Site-webcam                        | Train Loss: 2.1133 | Train Acc: 0.7059
 Site-caltech                       | Train Loss: 2.1662 | Train Acc: 0.3846
 Site-caltech                       | Train Loss: 2.1208 | Train Acc: 0.7500
 Site-dslr                          | Train Loss: 2.1368 | Train Acc: 0.6250
Average Train Accuracy: 0.6294
 Site-amazon                        | Val  Loss: 2.1413 | Val  Acc: 0.5652
 Site-amazon                        | Val  Loss: 2.1193 | Val  Acc: 0.5882
 Site-amazon                        | Val  Loss: 2.1124 | Val  Acc: 0.6731
 Site-amazon                        | Val  Loss: 2.1095 | Val  Acc: 0.7179
 Site-amazon                        | Val  Loss: 2.1005 | Val  Acc: 0.7094
 Site-webcam                        | Val  Loss: 2.0942 | Val  Acc: 0.7273
 Site-webcam                        | Val  Loss: 2.1309 | Val  Acc: 0.6400
 Site-webcam                        | Val  Loss: 2.1262 | Val  Acc: 0.5965
 Site-caltech                       | Val  Loss: 2.1414 | Val  Acc: 0.7778
 Site-caltech                       | Val  Loss: 2.1166 | Val  Acc: 0.6889
 Site-dslr                          | Val  Loss: 2.1486 | Val  Acc: 0.3438
Average Valid Accuracy: 0.6389
 Best site-amazon                    | Epoch:1 | Val Acc: 0.5652
 Best site-amazon                    | Epoch:1 | Val Acc: 0.5882
 Best site-amazon                    | Epoch:1 | Val Acc: 0.6731
 Best site-amazon                    | Epoch:1 | Val Acc: 0.7179
 Best site-amazon                    | Epoch:1 | Val Acc: 0.7094
 Best site-webcam                    | Epoch:1 | Val Acc: 0.7273
 Best site-webcam                    | Epoch:1 | Val Acc: 0.6400
 Best site-webcam                    | Epoch:1 | Val Acc: 0.5965
 Best site-caltech                   | Epoch:1 | Val Acc: 0.7778
 Best site-caltech                   | Epoch:1 | Val Acc: 0.6889
 Best site-dslr                      | Epoch:1 | Val Acc: 0.3438
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 2.0317 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 2.0692 | Train Acc: 0.7692
 Site-amazon                        | Train Loss: 2.0266 | Train Acc: 0.8205
 Site-amazon                        | Train Loss: 2.0081 | Train Acc: 0.8547
 Site-amazon                        | Train Loss: 2.0266 | Train Acc: 0.8343
 Site-webcam                        | Train Loss: 2.0565 | Train Acc: 0.7647
 Site-webcam                        | Train Loss: 2.0466 | Train Acc: 0.8158
 Site-webcam                        | Train Loss: 2.0453 | Train Acc: 0.8471
 Site-caltech                       | Train Loss: 2.0919 | Train Acc: 0.6923
 Site-caltech                       | Train Loss: 2.0248 | Train Acc: 0.8676
 Site-dslr                          | Train Loss: 2.0506 | Train Acc: 0.7708
Average Train Accuracy: 0.8086
 Site-amazon                        | Val  Loss: 2.0385 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 2.0354 | Val  Acc: 0.8529
 Site-amazon                        | Val  Loss: 2.0233 | Val  Acc: 0.8654
 Site-amazon                        | Val  Loss: 2.0155 | Val  Acc: 0.8590
 Site-amazon                        | Val  Loss: 2.0099 | Val  Acc: 0.8462
 Site-webcam                        | Val  Loss: 2.0038 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 2.0518 | Val  Acc: 0.7600
 Site-webcam                        | Val  Loss: 2.0340 | Val  Acc: 0.8246
 Site-caltech                       | Val  Loss: 2.0539 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 2.0307 | Val  Acc: 0.8444
 Site-dslr                          | Val  Loss: 2.0635 | Val  Acc: 0.7188
Average Valid Accuracy: 0.8237
 Best site-amazon                    | Epoch:2 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8529
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8654
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8590
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8462
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8182
 Best site-webcam                    | Epoch:2 | Val Acc: 0.7600
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8246
 Best site-caltech                   | Epoch:2 | Val Acc: 0.8889
 Best site-caltech                   | Epoch:2 | Val Acc: 0.8444
 Best site-dslr                      | Epoch:2 | Val Acc: 0.7188
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 1.9234 | Train Acc: 0.9429
 Site-amazon                        | Train Loss: 1.9781 | Train Acc: 0.8269
 Site-amazon                        | Train Loss: 1.9177 | Train Acc: 0.8974
 Site-amazon                        | Train Loss: 1.9148 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.9370 | Train Acc: 0.8857
 Site-webcam                        | Train Loss: 1.9980 | Train Acc: 0.7647
 Site-webcam                        | Train Loss: 1.9561 | Train Acc: 0.8158
 Site-webcam                        | Train Loss: 1.9486 | Train Acc: 0.9059
 Site-caltech                       | Train Loss: 2.0121 | Train Acc: 0.8462
 Site-caltech                       | Train Loss: 1.9698 | Train Acc: 0.8676
 Site-dslr                          | Train Loss: 1.9849 | Train Acc: 0.8333
Average Train Accuracy: 0.8668
 Site-amazon                        | Val  Loss: 1.9529 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.9353 | Val  Acc: 0.8529
 Site-amazon                        | Val  Loss: 1.9375 | Val  Acc: 0.8654
 Site-amazon                        | Val  Loss: 1.9200 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 1.9087 | Val  Acc: 0.8974
 Site-webcam                        | Val  Loss: 1.9691 | Val  Acc: 0.7273
 Site-webcam                        | Val  Loss: 1.9683 | Val  Acc: 0.8400
 Site-webcam                        | Val  Loss: 1.9637 | Val  Acc: 0.8596
 Site-caltech                       | Val  Loss: 1.9712 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 1.9338 | Val  Acc: 0.9111
 Site-dslr                          | Val  Loss: 1.9852 | Val  Acc: 0.8438
Average Valid Accuracy: 0.8669
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8529
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8654
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8974
 Best site-webcam                    | Epoch:3 | Val Acc: 0.7273
 Best site-webcam                    | Epoch:3 | Val Acc: 0.8400
 Best site-webcam                    | Epoch:3 | Val Acc: 0.8596
 Best site-caltech                   | Epoch:3 | Val Acc: 0.8889
 Best site-caltech                   | Epoch:3 | Val Acc: 0.9111
 Best site-dslr                      | Epoch:3 | Val Acc: 0.8438
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 1.8486 | Train Acc: 0.9429
 Site-amazon                        | Train Loss: 1.8920 | Train Acc: 0.8462
 Site-amazon                        | Train Loss: 1.8380 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 1.8372 | Train Acc: 0.9402
 Site-amazon                        | Train Loss: 1.8399 | Train Acc: 0.9314
 Site-webcam                        | Train Loss: 1.9176 | Train Acc: 0.7647
 Site-webcam                        | Train Loss: 1.8790 | Train Acc: 0.8947
 Site-webcam                        | Train Loss: 1.8758 | Train Acc: 0.8824
 Site-caltech                       | Train Loss: 1.9149 | Train Acc: 0.9231
 Site-caltech                       | Train Loss: 1.8427 | Train Acc: 0.9412
 Site-dslr                          | Train Loss: 1.9181 | Train Acc: 0.8542
Average Train Accuracy: 0.8949
 Site-amazon                        | Val  Loss: 1.8619 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.8523 | Val  Acc: 0.8824
 Site-amazon                        | Val  Loss: 1.8589 | Val  Acc: 0.8846
 Site-amazon                        | Val  Loss: 1.8375 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 1.8154 | Val  Acc: 0.9316
 Site-webcam                        | Val  Loss: 1.8524 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.8940 | Val  Acc: 0.8000
 Site-webcam                        | Val  Loss: 1.8799 | Val  Acc: 0.8596
 Site-caltech                       | Val  Loss: 1.9048 | Val  Acc: 0.7778
 Site-caltech                       | Val  Loss: 1.8562 | Val  Acc: 0.9333
 Site-dslr                          | Val  Loss: 1.9011 | Val  Acc: 0.9688
Average Valid Accuracy: 0.8906
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:4 | Val Acc: 0.8824
 Best site-amazon                    | Epoch:4 | Val Acc: 0.8846
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9316
 Best site-webcam                    | Epoch:4 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:4 | Val Acc: 0.8000
 Best site-webcam                    | Epoch:4 | Val Acc: 0.8596
 Best site-caltech                   | Epoch:4 | Val Acc: 0.7778
 Best site-caltech                   | Epoch:4 | Val Acc: 0.9333
 Best site-dslr                      | Epoch:4 | Val Acc: 0.9688
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 1.7386 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.8129 | Train Acc: 0.9038
 Site-amazon                        | Train Loss: 1.7653 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.7447 | Train Acc: 0.9316
 Site-amazon                        | Train Loss: 1.7515 | Train Acc: 0.9600
 Site-webcam                        | Train Loss: 1.8343 | Train Acc: 0.8235
 Site-webcam                        | Train Loss: 1.8030 | Train Acc: 0.9211
 Site-webcam                        | Train Loss: 1.7801 | Train Acc: 0.9176
 Site-caltech                       | Train Loss: 1.8263 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.7486 | Train Acc: 0.9118
 Site-dslr                          | Train Loss: 1.8147 | Train Acc: 0.8958
Average Train Accuracy: 0.9259
 Site-amazon                        | Val  Loss: 1.7959 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 1.7696 | Val  Acc: 0.9118
 Site-amazon                        | Val  Loss: 1.7603 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 1.7577 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 1.7438 | Val  Acc: 0.9316
 Site-webcam                        | Val  Loss: 1.7845 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 1.8152 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 1.7972 | Val  Acc: 0.9123
 Site-caltech                       | Val  Loss: 1.8022 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 1.7627 | Val  Acc: 0.9333
 Site-dslr                          | Val  Loss: 1.8202 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9084
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8696
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9118
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9423
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9316
 Best site-webcam                    | Epoch:5 | Val Acc: 0.8182
 Best site-webcam                    | Epoch:5 | Val Acc: 0.8800
 Best site-webcam                    | Epoch:5 | Val Acc: 0.9123
 Best site-caltech                   | Epoch:5 | Val Acc: 0.8889
 Best site-caltech                   | Epoch:5 | Val Acc: 0.9333
 Best site-dslr                      | Epoch:5 | Val Acc: 0.9688
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 1.6676 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.7310 | Train Acc: 0.8846
 Site-amazon                        | Train Loss: 1.6702 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.6658 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.6787 | Train Acc: 0.9543
 Site-webcam                        | Train Loss: 1.7536 | Train Acc: 0.8235
 Site-webcam                        | Train Loss: 1.7374 | Train Acc: 0.9211
 Site-webcam                        | Train Loss: 1.7094 | Train Acc: 0.9294
 Site-caltech                       | Train Loss: 1.7399 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.7009 | Train Acc: 0.9118
 Site-dslr                          | Train Loss: 1.7420 | Train Acc: 0.8750
Average Train Accuracy: 0.9244
 Site-amazon                        | Val  Loss: 1.7082 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.6763 | Val  Acc: 0.9118
 Site-amazon                        | Val  Loss: 1.6633 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 1.6649 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 1.6479 | Val  Acc: 0.9402
 Site-webcam                        | Val  Loss: 1.6892 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.7364 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 1.7259 | Val  Acc: 0.8947
 Site-caltech                       | Val  Loss: 1.7958 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 1.6673 | Val  Acc: 0.9556
 Site-dslr                          | Val  Loss: 1.7407 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9297
 Best site-amazon                    | Epoch:6 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9118
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9423
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9402
 Best site-webcam                    | Epoch:6 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8800
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8947
 Best site-caltech                   | Epoch:6 | Val Acc: 0.8889
 Best site-caltech                   | Epoch:6 | Val Acc: 0.9556
 Best site-dslr                      | Epoch:6 | Val Acc: 0.9688
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 1.5748 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.6570 | Train Acc: 0.9038
 Site-amazon                        | Train Loss: 1.6007 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.5568 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.5757 | Train Acc: 0.9486
 Site-webcam                        | Train Loss: 1.6916 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 1.6382 | Train Acc: 0.9474
 Site-webcam                        | Train Loss: 1.6397 | Train Acc: 0.9176
 Site-caltech                       | Train Loss: 1.6559 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6962 | Train Acc: 0.9412
 Site-dslr                          | Train Loss: 1.6816 | Train Acc: 0.8958
Average Train Accuracy: 0.9369
 Site-amazon                        | Val  Loss: 1.6397 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.5921 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.6118 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 1.6118 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 1.5673 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 1.6039 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.6673 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 1.6475 | Val  Acc: 0.9298
 Site-caltech                       | Val  Loss: 1.6577 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6117 | Val  Acc: 0.9333
 Site-dslr                          | Val  Loss: 1.6688 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9381
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9412
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9231
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:7 | Val Acc: 0.8800
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9298
 Best site-caltech                   | Epoch:7 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9333
 Best site-dslr                      | Epoch:7 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 1.4687 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.5708 | Train Acc: 0.9038
 Site-amazon                        | Train Loss: 1.5380 | Train Acc: 0.9744
 Site-amazon                        | Train Loss: 1.4982 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 1.5004 | Train Acc: 0.9771
 Site-webcam                        | Train Loss: 1.6376 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 1.5587 | Train Acc: 0.9211
 Site-webcam                        | Train Loss: 1.5756 | Train Acc: 0.9412
 Site-caltech                       | Train Loss: 1.6123 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4747 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 1.6275 | Train Acc: 0.9167
Average Train Accuracy: 0.9438
 Site-amazon                        | Val  Loss: 1.5399 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.5349 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.5527 | Val  Acc: 0.9038
 Site-amazon                        | Val  Loss: 1.4943 | Val  Acc: 0.9487
 Site-amazon                        | Val  Loss: 1.4785 | Val  Acc: 0.9573
 Site-webcam                        | Val  Loss: 1.5531 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.5782 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 1.5792 | Val  Acc: 0.8772
 Site-caltech                       | Val  Loss: 1.6023 | Val  Acc: 0.7778
 Site-caltech                       | Val  Loss: 1.5240 | Val  Acc: 0.9333
 Site-dslr                          | Val  Loss: 1.6002 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9173
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 1.4134 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.4936 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 1.4555 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 1.4045 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.4222 | Train Acc: 0.9714
 Site-webcam                        | Train Loss: 1.5616 | Train Acc: 0.8235
 Site-webcam                        | Train Loss: 1.5077 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 1.5105 | Train Acc: 0.9294
 Site-caltech                       | Train Loss: 1.5239 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4616 | Train Acc: 0.9559
 Site-dslr                          | Train Loss: 1.5587 | Train Acc: 0.9375
Average Train Accuracy: 0.9501
 Site-amazon                        | Val  Loss: 1.4889 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 1.4365 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.4547 | Val  Acc: 0.9038
 Site-amazon                        | Val  Loss: 1.4505 | Val  Acc: 0.9487
 Site-amazon                        | Val  Loss: 1.4013 | Val  Acc: 0.9573
 Site-webcam                        | Val  Loss: 1.4548 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.5469 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 1.5098 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.5242 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4522 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 1.4812 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9395
 Best site-amazon                    | Epoch:9 | Val Acc: 0.8696
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9412
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9038
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9487
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9573
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:9 | Val Acc: 0.8800
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9778
 Best site-dslr                      | Epoch:9 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 10 ============
 Site-amazon                        | Train Loss: 1.3351 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.4186 | Train Acc: 0.9038
 Site-amazon                        | Train Loss: 1.3200 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 1.3494 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 1.3495 | Train Acc: 0.9829
 Site-webcam                        | Train Loss: 1.4963 | Train Acc: 0.8235
 Site-webcam                        | Train Loss: 1.4336 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 1.3752 | Train Acc: 0.9765
 Site-caltech                       | Train Loss: 1.4770 | Train Acc: 0.9231
 Site-caltech                       | Train Loss: 1.4140 | Train Acc: 0.9559
 Site-dslr                          | Train Loss: 1.4742 | Train Acc: 0.9583
Average Train Accuracy: 0.9412
 Site-amazon                        | Val  Loss: 1.4376 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.3904 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.3745 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 1.3549 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 1.3248 | Val  Acc: 0.9573
 Site-webcam                        | Val  Loss: 1.4297 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.4571 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 1.4501 | Val  Acc: 0.9298
 Site-caltech                       | Val  Loss: 1.4271 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3654 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 1.4572 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9539
 Best site-amazon                    | Epoch:10 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9412
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9615
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9359
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9573
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:10 | Val Acc: 0.8800
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9298
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 0.9778
 Best site-dslr                      | Epoch:10 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 11 ============
 Site-amazon                        | Train Loss: 1.2429 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.3397 | Train Acc: 0.9038
 Site-amazon                        | Train Loss: 1.2965 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.2719 | Train Acc: 0.9402
 Site-amazon                        | Train Loss: 1.2614 | Train Acc: 0.9714
 Site-webcam                        | Train Loss: 1.4159 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 1.3599 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 1.3776 | Train Acc: 0.9412
 Site-caltech                       | Train Loss: 1.3862 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3422 | Train Acc: 0.9559
 Site-dslr                          | Train Loss: 1.3921 | Train Acc: 0.8958
Average Train Accuracy: 0.9466
 Site-amazon                        | Val  Loss: 1.3225 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.3140 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 1.3090 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 1.2800 | Val  Acc: 0.9744
 Site-amazon                        | Val  Loss: 1.2452 | Val  Acc: 0.9487
 Site-webcam                        | Val  Loss: 1.3900 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.4101 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 1.3652 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.4112 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 1.2932 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 1.3489 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9459
============ Train epoch 12 ============
 Site-amazon                        | Train Loss: 1.2123 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.2922 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 1.2443 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.2098 | Train Acc: 0.9573
 Site-amazon                        | Train Loss: 1.2066 | Train Acc: 0.9771
 Site-webcam                        | Train Loss: 1.3592 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 1.3124 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 1.2573 | Train Acc: 0.9059
 Site-caltech                       | Train Loss: 1.3448 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1867 | Train Acc: 0.9412
 Site-dslr                          | Train Loss: 1.3550 | Train Acc: 0.9167
Average Train Accuracy: 0.9476
 Site-amazon                        | Val  Loss: 1.2682 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.2311 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 1.2751 | Val  Acc: 0.9038
 Site-amazon                        | Val  Loss: 1.2135 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 1.1787 | Val  Acc: 0.9487
 Site-webcam                        | Val  Loss: 1.3686 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 1.3616 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 1.3288 | Val  Acc: 0.8947
 Site-caltech                       | Val  Loss: 1.3621 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 1.2339 | Val  Acc: 0.9111
 Site-dslr                          | Val  Loss: 1.3013 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9213
============ Train epoch 13 ============
 Site-amazon                        | Train Loss: 1.1155 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.2582 | Train Acc: 0.9038
 Site-amazon                        | Train Loss: 1.1225 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.1357 | Train Acc: 0.9658
 Site-amazon                        | Train Loss: 1.1454 | Train Acc: 0.9714
 Site-webcam                        | Train Loss: 1.3187 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 1.2091 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 1.2144 | Train Acc: 0.9529
 Site-caltech                       | Train Loss: 1.2757 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2828 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 1.2777 | Train Acc: 0.9375
Average Train Accuracy: 0.9657
 Site-amazon                        | Val  Loss: 1.2138 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.1443 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.1709 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 1.1653 | Val  Acc: 0.9487
 Site-amazon                        | Val  Loss: 1.1076 | Val  Acc: 0.9316
 Site-webcam                        | Val  Loss: 1.2169 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.3145 | Val  Acc: 0.8400
 Site-webcam                        | Val  Loss: 1.2361 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.2790 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1746 | Val  Acc: 0.9333
 Site-dslr                          | Val  Loss: 1.2315 | Val  Acc: 0.9688
Average Valid Accuracy: 0.9485
============ Train epoch 14 ============
 Site-amazon                        | Train Loss: 1.0464 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.1789 | Train Acc: 0.9038
 Site-amazon                        | Train Loss: 1.1011 | Train Acc: 0.9487
 Site-amazon                        | Train Loss: 1.0584 | Train Acc: 0.9573
 Site-amazon                        | Train Loss: 1.0711 | Train Acc: 0.9771
 Site-webcam                        | Train Loss: 1.2243 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 1.1619 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 1.1675 | Train Acc: 0.9765
 Site-caltech                       | Train Loss: 1.2046 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1106 | Train Acc: 0.9559
 Site-dslr                          | Train Loss: 1.2102 | Train Acc: 0.9583
Average Train Accuracy: 0.9550
 Site-amazon                        | Val  Loss: 1.1501 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.1119 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.1296 | Val  Acc: 0.9615
 Site-amazon                        | Val  Loss: 1.0939 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 1.0532 | Val  Acc: 0.9487
 Site-webcam                        | Val  Loss: 1.1790 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.2586 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 1.2112 | Val  Acc: 0.9298
 Site-caltech                       | Val  Loss: 1.2316 | Val  Acc: 0.7778
 Site-caltech                       | Val  Loss: 1.0858 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 1.1735 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9317
============ Train epoch 15 ============
 Site-amazon                        | Train Loss: 1.0076 | Train Acc: 0.9429
 Site-amazon                        | Train Loss: 1.0836 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 1.0050 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.9934 | Train Acc: 0.9658
 Site-amazon                        | Train Loss: 1.0009 | Train Acc: 0.9771
 Site-webcam                        | Train Loss: 1.2150 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 1.1478 | Train Acc: 0.9474
 Site-webcam                        | Train Loss: 1.1380 | Train Acc: 0.9529
 Site-caltech                       | Train Loss: 1.1315 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1091 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 1.1553 | Train Acc: 0.9583
Average Train Accuracy: 0.9529
 Site-amazon                        | Val  Loss: 1.0668 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.0574 | Val  Acc: 0.9118
 Site-amazon                        | Val  Loss: 1.0645 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 1.0523 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.9812 | Val  Acc: 0.9573
 Site-webcam                        | Val  Loss: 1.1270 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.1729 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 1.1476 | Val  Acc: 0.8947
 Site-caltech                       | Val  Loss: 1.1590 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 1.0372 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 1.1060 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9508
============ Train epoch 16 ============
 Site-amazon                        | Train Loss: 0.9265 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.0429 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 0.9811 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.9653 | Train Acc: 0.9402
 Site-amazon                        | Train Loss: 0.9691 | Train Acc: 0.9543
 Site-webcam                        | Train Loss: 1.2183 | Train Acc: 0.8235
 Site-webcam                        | Train Loss: 1.0391 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 1.1021 | Train Acc: 0.9529
 Site-caltech                       | Train Loss: 1.0874 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9134 | Train Acc: 0.9559
 Site-dslr                          | Train Loss: 1.1260 | Train Acc: 0.9583
Average Train Accuracy: 0.9468
 Site-amazon                        | Val  Loss: 1.0311 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.9835 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.9923 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.9808 | Val  Acc: 0.9487
 Site-amazon                        | Val  Loss: 0.9211 | Val  Acc: 0.9402
 Site-webcam                        | Val  Loss: 1.1084 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.1155 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 1.0672 | Val  Acc: 0.9649
 Site-caltech                       | Val  Loss: 1.0951 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 0.9905 | Val  Acc: 0.9556
 Site-dslr                          | Val  Loss: 1.0524 | Val  Acc: 0.9375
Average Valid Accuracy: 0.9553
 Best site-amazon                    | Epoch:16 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9706
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9423
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9487
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9402
 Best site-webcam                    | Epoch:16 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:16 | Val Acc: 0.9600
 Best site-webcam                    | Epoch:16 | Val Acc: 0.9649
 Best site-caltech                   | Epoch:16 | Val Acc: 0.8889
 Best site-caltech                   | Epoch:16 | Val Acc: 0.9556
 Best site-dslr                      | Epoch:16 | Val Acc: 0.9375
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/fedavg...
============ Train epoch 17 ============
 Site-amazon                        | Train Loss: 0.9043 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 1.0134 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.9080 | Train Acc: 0.9744
 Site-amazon                        | Train Loss: 0.8838 | Train Acc: 0.9658
 Site-amazon                        | Train Loss: 0.8938 | Train Acc: 0.9829
 Site-webcam                        | Train Loss: 1.0497 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.9941 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 1.0374 | Train Acc: 0.9529
 Site-caltech                       | Train Loss: 1.0561 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.8486 | Train Acc: 0.9853
 Site-dslr                          | Train Loss: 1.0982 | Train Acc: 0.9375
Average Train Accuracy: 0.9632
 Site-amazon                        | Val  Loss: 1.0034 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.9121 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.9757 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.9258 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.8677 | Val  Acc: 0.9744
 Site-webcam                        | Val  Loss: 1.0052 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.0715 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 1.0534 | Val  Acc: 0.9123
 Site-caltech                       | Val  Loss: 1.0422 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 0.9536 | Val  Acc: 0.9333
 Site-dslr                          | Val  Loss: 1.0199 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9513
============ Train epoch 18 ============
 Site-amazon                        | Train Loss: 0.8190 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.9370 | Train Acc: 0.9231
 Site-amazon                        | Train Loss: 0.9395 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.8483 | Train Acc: 0.9573
 Site-amazon                        | Train Loss: 0.8565 | Train Acc: 0.9657
 Site-webcam                        | Train Loss: 1.0280 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.9300 | Train Acc: 0.9737
 Site-webcam                        | Train Loss: 0.9576 | Train Acc: 0.9765
 Site-caltech                       | Train Loss: 0.9726 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0391 | Train Acc: 0.9559
 Site-dslr                          | Train Loss: 1.0155 | Train Acc: 0.9375
Average Train Accuracy: 0.9550
 Site-amazon                        | Val  Loss: 0.9652 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.8674 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.8947 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.8740 | Val  Acc: 0.9487
 Site-amazon                        | Val  Loss: 0.8250 | Val  Acc: 0.9658
 Site-webcam                        | Val  Loss: 0.9848 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 0.9652 | Val  Acc: 0.9600
 Site-webcam                        | Val  Loss: 0.9939 | Val  Acc: 0.9825
 Site-caltech                       | Val  Loss: 1.0340 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 0.9153 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.9978 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9465
============ Train epoch 19 ============
 Site-amazon                        | Train Loss: 0.7686 | Train Acc: 0.9714
 Site-amazon                        | Train Loss: 0.9265 | Train Acc: 0.9038
 Site-amazon                        | Train Loss: 0.8031 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.7791 | Train Acc: 0.9658
 Site-amazon                        | Train Loss: 0.7866 | Train Acc: 0.9829
 Site-webcam                        | Train Loss: 0.9913 | Train Acc: 0.8824
 Site-webcam                        | Train Loss: 0.9254 | Train Acc: 0.9474
 Site-webcam                        | Train Loss: 0.9102 | Train Acc: 0.9412
 Site-caltech                       | Train Loss: 0.9387 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.8809 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.9693 | Train Acc: 0.9375
Average Train Accuracy: 0.9513
 Site-amazon                        | Val  Loss: 0.9155 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.8182 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.8682 | Val  Acc: 0.9423
 Site-amazon                        | Val  Loss: 0.8563 | Val  Acc: 0.9359
 Site-amazon                        | Val  Loss: 0.7668 | Val  Acc: 0.9487
 Site-webcam                        | Val  Loss: 0.9645 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.9782 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.9574 | Val  Acc: 0.9298
 Site-caltech                       | Val  Loss: 0.9880 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8265 | Val  Acc: 0.9778
 Site-dslr                          | Val  Loss: 0.9616 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9537
===2023-08-02 16:50:39===
===2023-08-02 16:50:42===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[35,52,78,117,175,17,38,85,13,68,48,
client_nums=[5,3,2,1,]
len_dataset=[766,236,138,81,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (2)| Epoch:16 | Test Acc: 0.9583
 Test site-webcam                    (3)| Epoch:16 | Test Acc: 0.9322
 Test site-caltech                   (0)| Epoch:16 | Test Acc: 0.9644
 Test site-dslr                      (1)| Epoch:16 | Test Acc: 0.9688
amazon: 0.9583, webcam: 0.9322, caltech: 0.9644, dslr: 0.9688, 
Average Test Accuracy(group): 0.9559, Average Test Accuracy(individual): 0.9533,
domain std=0.0142, cluster std=0.0115, individual std=0.0133, 
