===2023-08-16 17:45:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 4
============ Train epoch 0 ============
===2023-08-16 17:48:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 4
Loading snapshots...
===2023-08-17 03:11:20===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 4
============ Train epoch 0 ============
cnt=[4, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 1.9144 | Train Acc: 0.4586
 Site-Clipart                   (1) | Train Loss: 1.8981 | Train Acc: 0.4703
 Site-Real                      (0) | Train Loss: 1.8207 | Train Acc: 0.5669
 Site-Real                      (0) | Train Loss: 1.7587 | Train Acc: 0.6271
 Site-Painting                  (0) | Train Loss: 1.8565 | Train Acc: 0.5605
 Site-Painting                  (0) | Train Loss: 1.8258 | Train Acc: 0.5678
 Site-Sketch                    (1) | Train Loss: 1.8497 | Train Acc: 0.5478
 Site-Sketch                    (1) | Train Loss: 1.8690 | Train Acc: 0.4979
 Site-QuickDraw                 (2) | Train Loss: 2.2278 | Train Acc: 0.2038
 Site-QuickDraw                 (2) | Train Loss: 2.2161 | Train Acc: 0.2203
 Site-Infograph                 (3) | Train Loss: 2.1557 | Train Acc: 0.2675
 Site-Infograph                 (3) | Train Loss: 2.0861 | Train Acc: 0.3305
Average Train Accuracy: 0.4433
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4586
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4703
 Best site-Real                      | Epoch:0 | Val Acc: 0.5669
 Best site-Real                      | Epoch:0 | Val Acc: 0.6271
 Best site-Painting                  | Epoch:0 | Val Acc: 0.5605
 Best site-Painting                  | Epoch:0 | Val Acc: 0.5678
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.5478
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4979
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.2038
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.2203
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2675
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.3305
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 1 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (3) | Train Loss: 1.4990 | Train Acc: 0.6433
 Site-Clipart                   (3) | Train Loss: 1.4762 | Train Acc: 0.6801
 Site-Real                      (0) | Train Loss: 1.3080 | Train Acc: 0.7962
 Site-Real                      (0) | Train Loss: 1.2030 | Train Acc: 0.8305
 Site-Painting                  (0) | Train Loss: 1.3759 | Train Acc: 0.7134
 Site-Painting                  (0) | Train Loss: 1.3345 | Train Acc: 0.7373
 Site-Sketch                    (3) | Train Loss: 1.3573 | Train Acc: 0.7006
 Site-Sketch                    (3) | Train Loss: 1.4342 | Train Acc: 0.6441
 Site-QuickDraw                 (1) | Train Loss: 2.0486 | Train Acc: 0.2866
 Site-QuickDraw                 (1) | Train Loss: 2.0573 | Train Acc: 0.2924
 Site-Infograph                 (2) | Train Loss: 1.9830 | Train Acc: 0.3885
 Site-Infograph                 (2) | Train Loss: 1.8732 | Train Acc: 0.4131
Average Train Accuracy: 0.5938
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6433
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6801
 Best site-Real                      | Epoch:1 | Val Acc: 0.7962
 Best site-Real                      | Epoch:1 | Val Acc: 0.8305
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7134
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7373
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7006
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6441
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2866
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2924
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.3885
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4131
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.1713 | Train Acc: 0.7197
 Site-Clipart                   (0) | Train Loss: 1.1383 | Train Acc: 0.7458
 Site-Real                      (2) | Train Loss: 0.9557 | Train Acc: 0.8408
 Site-Real                      (2) | Train Loss: 0.8826 | Train Acc: 0.8792
 Site-Painting                  (2) | Train Loss: 1.0375 | Train Acc: 0.7962
 Site-Painting                  (2) | Train Loss: 1.0362 | Train Acc: 0.7881
 Site-Sketch                    (0) | Train Loss: 1.0418 | Train Acc: 0.7580
 Site-Sketch                    (0) | Train Loss: 1.0745 | Train Acc: 0.7500
 Site-QuickDraw                 (1) | Train Loss: 1.8494 | Train Acc: 0.4076
 Site-QuickDraw                 (1) | Train Loss: 1.8384 | Train Acc: 0.4322
 Site-Infograph                 (3) | Train Loss: 1.7649 | Train Acc: 0.4395
 Site-Infograph                 (3) | Train Loss: 1.6497 | Train Acc: 0.5212
Average Train Accuracy: 0.6732
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7197
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7458
 Best site-Real                      | Epoch:2 | Val Acc: 0.8408
 Best site-Real                      | Epoch:2 | Val Acc: 0.8792
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7962
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7881
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7580
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7500
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.4076
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.4322
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4395
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.5212
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 3 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 0.9845 | Train Acc: 0.7898
 Site-Clipart                   (0) | Train Loss: 0.9436 | Train Acc: 0.8114
 Site-Real                      (2) | Train Loss: 0.7693 | Train Acc: 0.8599
 Site-Real                      (2) | Train Loss: 0.6699 | Train Acc: 0.9068
 Site-Painting                  (2) | Train Loss: 0.8575 | Train Acc: 0.8025
 Site-Painting                  (2) | Train Loss: 0.8206 | Train Acc: 0.8390
 Site-Sketch                    (3) | Train Loss: 0.8887 | Train Acc: 0.7707
 Site-Sketch                    (3) | Train Loss: 0.9232 | Train Acc: 0.7754
 Site-QuickDraw                 (1) | Train Loss: 1.6610 | Train Acc: 0.5096
 Site-QuickDraw                 (1) | Train Loss: 1.6508 | Train Acc: 0.5191
 Site-Infograph                 (0) | Train Loss: 1.6637 | Train Acc: 0.4713
 Site-Infograph                 (0) | Train Loss: 1.5304 | Train Acc: 0.5212
Average Train Accuracy: 0.7147
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7898
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8114
 Best site-Real                      | Epoch:3 | Val Acc: 0.8599
 Best site-Real                      | Epoch:3 | Val Acc: 0.9068
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8025
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8390
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7707
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7754
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.5096
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.5191
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.4713
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5212
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 5, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (2) | Train Loss: 0.9029 | Train Acc: 0.7580
 Site-Clipart                   (2) | Train Loss: 0.8810 | Train Acc: 0.7733
 Site-Real                      (0) | Train Loss: 0.7046 | Train Acc: 0.8726
 Site-Real                      (0) | Train Loss: 0.5985 | Train Acc: 0.9047
 Site-Painting                  (3) | Train Loss: 0.7717 | Train Acc: 0.8153
 Site-Painting                  (3) | Train Loss: 0.7381 | Train Acc: 0.8305
 Site-Sketch                    (2) | Train Loss: 0.8143 | Train Acc: 0.7834
 Site-Sketch                    (2) | Train Loss: 0.8293 | Train Acc: 0.7881
 Site-QuickDraw                 (1) | Train Loss: 1.4972 | Train Acc: 0.5350
 Site-QuickDraw                 (1) | Train Loss: 1.5114 | Train Acc: 0.5424
 Site-Infograph                 (2) | Train Loss: 1.5583 | Train Acc: 0.5223
 Site-Infograph                 (3) | Train Loss: 1.4287 | Train Acc: 0.5847
Average Train Accuracy: 0.7259
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7580
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7733
 Best site-Real                      | Epoch:4 | Val Acc: 0.8726
 Best site-Real                      | Epoch:4 | Val Acc: 0.9047
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8153
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8305
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7834
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7881
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5350
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5424
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5223
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5847
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 5 ============
cnt=[6, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 0.7531 | Train Acc: 0.8153
 Site-Clipart                   (0) | Train Loss: 0.7435 | Train Acc: 0.8347
 Site-Real                      (3) | Train Loss: 0.5799 | Train Acc: 0.8726
 Site-Real                      (2) | Train Loss: 0.4987 | Train Acc: 0.9322
 Site-Painting                  (3) | Train Loss: 0.6905 | Train Acc: 0.8408
 Site-Painting                  (3) | Train Loss: 0.6588 | Train Acc: 0.8559
 Site-Sketch                    (0) | Train Loss: 0.7212 | Train Acc: 0.8089
 Site-Sketch                    (0) | Train Loss: 0.7328 | Train Acc: 0.8157
 Site-QuickDraw                 (1) | Train Loss: 1.3416 | Train Acc: 0.6178
 Site-QuickDraw                 (1) | Train Loss: 1.3067 | Train Acc: 0.6229
 Site-Infograph                 (0) | Train Loss: 1.5369 | Train Acc: 0.5096
 Site-Infograph                 (0) | Train Loss: 1.3836 | Train Acc: 0.5784
Average Train Accuracy: 0.7587
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8153
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8347
 Best site-Real                      | Epoch:5 | Val Acc: 0.8726
 Best site-Real                      | Epoch:5 | Val Acc: 0.9322
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8408
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8559
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8089
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8157
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6178
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6229
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5096
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5784
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 2, 3, 4, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (3) | Train Loss: 0.7399 | Train Acc: 0.8280
 Site-Clipart                   (3) | Train Loss: 0.6948 | Train Acc: 0.8369
 Site-Real                      (2) | Train Loss: 0.5354 | Train Acc: 0.8917
 Site-Real                      (2) | Train Loss: 0.4413 | Train Acc: 0.9301
 Site-Painting                  (2) | Train Loss: 0.6556 | Train Acc: 0.8153
 Site-Painting                  (0) | Train Loss: 0.5956 | Train Acc: 0.8686
 Site-Sketch                    (3) | Train Loss: 0.6176 | Train Acc: 0.8535
 Site-Sketch                    (3) | Train Loss: 0.6855 | Train Acc: 0.8008
 Site-QuickDraw                 (1) | Train Loss: 1.2356 | Train Acc: 0.6242
 Site-QuickDraw                 (1) | Train Loss: 1.2365 | Train Acc: 0.6292
 Site-Infograph                 (0) | Train Loss: 1.4582 | Train Acc: 0.5478
 Site-Infograph                 (0) | Train Loss: 1.3242 | Train Acc: 0.5911
Average Train Accuracy: 0.7681
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8280
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8369
 Best site-Real                      | Epoch:6 | Val Acc: 0.8917
 Best site-Real                      | Epoch:6 | Val Acc: 0.9301
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8153
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8686
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8535
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8008
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.6242
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.6292
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5478
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5911
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 2, 3, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (3) | Train Loss: 0.6718 | Train Acc: 0.8408
 Site-Clipart                   (3) | Train Loss: 0.6667 | Train Acc: 0.8157
 Site-Real                      (0) | Train Loss: 0.5075 | Train Acc: 0.9045
 Site-Real                      (0) | Train Loss: 0.4065 | Train Acc: 0.9237
 Site-Painting                  (0) | Train Loss: 0.6054 | Train Acc: 0.8344
 Site-Painting                  (3) | Train Loss: 0.5452 | Train Acc: 0.8750
 Site-Sketch                    (2) | Train Loss: 0.5886 | Train Acc: 0.8408
 Site-Sketch                    (3) | Train Loss: 0.6557 | Train Acc: 0.8136
 Site-QuickDraw                 (1) | Train Loss: 1.1012 | Train Acc: 0.6815
 Site-QuickDraw                 (1) | Train Loss: 1.1352 | Train Acc: 0.6992
 Site-Infograph                 (2) | Train Loss: 1.4205 | Train Acc: 0.5350
 Site-Infograph                 (2) | Train Loss: 1.2312 | Train Acc: 0.6398
Average Train Accuracy: 0.7837
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8408
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8157
 Best site-Real                      | Epoch:7 | Val Acc: 0.9045
 Best site-Real                      | Epoch:7 | Val Acc: 0.9237
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8344
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8750
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8408
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8136
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6815
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6992
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5350
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.6398
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.6646 | Train Acc: 0.8217
 Site-Clipart                   (0) | Train Loss: 0.6356 | Train Acc: 0.8305
 Site-Real                      (3) | Train Loss: 0.4738 | Train Acc: 0.9045
 Site-Real                      (3) | Train Loss: 0.3928 | Train Acc: 0.9195
 Site-Painting                  (3) | Train Loss: 0.5903 | Train Acc: 0.8280
 Site-Painting                  (3) | Train Loss: 0.5229 | Train Acc: 0.8771
 Site-Sketch                    (0) | Train Loss: 0.6373 | Train Acc: 0.8280
 Site-Sketch                    (0) | Train Loss: 0.6267 | Train Acc: 0.8178
 Site-QuickDraw                 (1) | Train Loss: 1.0858 | Train Acc: 0.6815
 Site-QuickDraw                 (1) | Train Loss: 1.0694 | Train Acc: 0.7076
 Site-Infograph                 (2) | Train Loss: 1.3477 | Train Acc: 0.6051
 Site-Infograph                 (2) | Train Loss: 1.2075 | Train Acc: 0.6292
Average Train Accuracy: 0.7875
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8217
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8305
 Best site-Real                      | Epoch:8 | Val Acc: 0.9045
 Best site-Real                      | Epoch:8 | Val Acc: 0.9195
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8280
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8771
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8280
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8178
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6815
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.7076
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.6051
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.6292
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.6013 | Train Acc: 0.8408
 Site-Clipart                   (2) | Train Loss: 0.6014 | Train Acc: 0.8136
 Site-Real                      (3) | Train Loss: 0.4398 | Train Acc: 0.9045
 Site-Real                      (3) | Train Loss: 0.3509 | Train Acc: 0.9280
 Site-Painting                  (1) | Train Loss: 0.5746 | Train Acc: 0.8599
 Site-Painting                  (1) | Train Loss: 0.5034 | Train Acc: 0.8835
 Site-Sketch                    (2) | Train Loss: 0.5298 | Train Acc: 0.8662
 Site-Sketch                    (2) | Train Loss: 0.5924 | Train Acc: 0.8136
 Site-QuickDraw                 (0) | Train Loss: 0.9803 | Train Acc: 0.7070
 Site-QuickDraw                 (0) | Train Loss: 0.9761 | Train Acc: 0.7331
 Site-Infograph                 (1) | Train Loss: 1.3698 | Train Acc: 0.5732
 Site-Infograph                 (1) | Train Loss: 1.2026 | Train Acc: 0.6229
Average Train Accuracy: 0.7955
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8408
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8136
 Best site-Real                      | Epoch:9 | Val Acc: 0.9045
 Best site-Real                      | Epoch:9 | Val Acc: 0.9280
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8599
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8835
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8662
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8136
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.7070
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.7331
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5732
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.6229
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:9 | Test Acc: 0.8327
 Test site-Real                      (3)| Epoch:9 | Test Acc: 0.9384
 Test site-Painting                  (1)| Epoch:9 | Test Acc: 0.9063
 Test site-Sketch                    (2)| Epoch:9 | Test Acc: 0.8646
 Test site-QuickDraw                 (0)| Epoch:9 | Test Acc: 0.7400
 Test site-Infograph                 (1)| Epoch:9 | Test Acc: 0.5799
Clipart: 0.8327, Real: 0.9384, Painting: 0.9063, Sketch: 0.8646, QuickDraw: 0.7400, Infograph: 0.5799, 
Average Test Accuracy(group): 0.8103, Average Test Accuracy(individual): 0.8103,
domain std=0.1205, cluster std=0.0823, individual std=0.1205, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (0) | Train Loss: 0.5830 | Train Acc: 0.8280
 Site-Clipart                   (0) | Train Loss: 0.5797 | Train Acc: 0.8475
 Site-Real                      (3) | Train Loss: 0.4161 | Train Acc: 0.9045
 Site-Real                      (3) | Train Loss: 0.3210 | Train Acc: 0.9470
 Site-Painting                  (2) | Train Loss: 0.5054 | Train Acc: 0.8535
 Site-Painting                  (2) | Train Loss: 0.4827 | Train Acc: 0.8814
 Site-Sketch                    (0) | Train Loss: 0.5310 | Train Acc: 0.8471
 Site-Sketch                    (0) | Train Loss: 0.5962 | Train Acc: 0.8242
 Site-QuickDraw                 (1) | Train Loss: 0.9546 | Train Acc: 0.7261
 Site-QuickDraw                 (1) | Train Loss: 0.9656 | Train Acc: 0.7331
 Site-Infograph                 (2) | Train Loss: 1.3695 | Train Acc: 0.5987
 Site-Infograph                 (2) | Train Loss: 1.1239 | Train Acc: 0.6356
Average Train Accuracy: 0.8022
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8280
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8475
 Best site-Real                      | Epoch:10 | Val Acc: 0.9045
 Best site-Real                      | Epoch:10 | Val Acc: 0.9470
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8535
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8471
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8242
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.7261
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.7331
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5987
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.6356
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 11 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.5692 | Train Acc: 0.8599
 Site-Clipart                   (0) | Train Loss: 0.5393 | Train Acc: 0.8453
 Site-Real                      (3) | Train Loss: 0.4108 | Train Acc: 0.9172
 Site-Real                      (3) | Train Loss: 0.3240 | Train Acc: 0.9407
 Site-Painting                  (3) | Train Loss: 0.5125 | Train Acc: 0.8535
 Site-Painting                  (3) | Train Loss: 0.4644 | Train Acc: 0.8856
 Site-Sketch                    (0) | Train Loss: 0.4923 | Train Acc: 0.8726
 Site-Sketch                    (0) | Train Loss: 0.5800 | Train Acc: 0.8199
 Site-QuickDraw                 (1) | Train Loss: 0.9367 | Train Acc: 0.7070
 Site-QuickDraw                 (1) | Train Loss: 0.8977 | Train Acc: 0.7627
 Site-Infograph                 (2) | Train Loss: 1.3351 | Train Acc: 0.6115
 Site-Infograph                 (2) | Train Loss: 1.1231 | Train Acc: 0.6441
Average Train Accuracy: 0.8100
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8599
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8453
 Best site-Real                      | Epoch:11 | Val Acc: 0.9172
 Best site-Real                      | Epoch:11 | Val Acc: 0.9407
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8535
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8856
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8726
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8199
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.7070
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.7627
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.6115
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.6441
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (1) | Train Loss: 0.5259 | Train Acc: 0.8790
 Site-Clipart                   (1) | Train Loss: 0.5203 | Train Acc: 0.8475
 Site-Real                      (2) | Train Loss: 0.4074 | Train Acc: 0.9045
 Site-Real                      (2) | Train Loss: 0.3074 | Train Acc: 0.9343
 Site-Painting                  (2) | Train Loss: 0.4909 | Train Acc: 0.8471
 Site-Painting                  (2) | Train Loss: 0.4440 | Train Acc: 0.8856
 Site-Sketch                    (1) | Train Loss: 0.5052 | Train Acc: 0.8662
 Site-Sketch                    (1) | Train Loss: 0.5434 | Train Acc: 0.8411
 Site-QuickDraw                 (0) | Train Loss: 0.9277 | Train Acc: 0.7197
 Site-QuickDraw                 (0) | Train Loss: 0.8469 | Train Acc: 0.7839
 Site-Infograph                 (3) | Train Loss: 1.3810 | Train Acc: 0.5669
 Site-Infograph                 (3) | Train Loss: 1.1043 | Train Acc: 0.6314
Average Train Accuracy: 0.8089
============ Train epoch 13 ============
cnt=[2, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.5959 | Train Acc: 0.8153
 Site-Clipart                   (2) | Train Loss: 0.5408 | Train Acc: 0.8453
 Site-Real                      (1) | Train Loss: 0.4314 | Train Acc: 0.9045
 Site-Real                      (1) | Train Loss: 0.3118 | Train Acc: 0.9322
 Site-Painting                  (1) | Train Loss: 0.4975 | Train Acc: 0.8408
 Site-Painting                  (1) | Train Loss: 0.4305 | Train Acc: 0.8835
 Site-Sketch                    (2) | Train Loss: 0.4998 | Train Acc: 0.8471
 Site-Sketch                    (2) | Train Loss: 0.5614 | Train Acc: 0.8347
 Site-QuickDraw                 (0) | Train Loss: 0.8586 | Train Acc: 0.7516
 Site-QuickDraw                 (0) | Train Loss: 0.8274 | Train Acc: 0.7797
 Site-Infograph                 (3) | Train Loss: 1.2494 | Train Acc: 0.6306
 Site-Infograph                 (3) | Train Loss: 1.0570 | Train Acc: 0.6547
Average Train Accuracy: 0.8100
============ Train epoch 14 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.5172 | Train Acc: 0.8790
 Site-Clipart                   (0) | Train Loss: 0.5267 | Train Acc: 0.8538
 Site-Real                      (3) | Train Loss: 0.3939 | Train Acc: 0.9045
 Site-Real                      (3) | Train Loss: 0.2984 | Train Acc: 0.9386
 Site-Painting                  (3) | Train Loss: 0.4784 | Train Acc: 0.8662
 Site-Painting                  (3) | Train Loss: 0.4271 | Train Acc: 0.8898
 Site-Sketch                    (0) | Train Loss: 0.4975 | Train Acc: 0.8471
 Site-Sketch                    (0) | Train Loss: 0.5298 | Train Acc: 0.8178
 Site-QuickDraw                 (1) | Train Loss: 0.8303 | Train Acc: 0.7452
 Site-QuickDraw                 (1) | Train Loss: 0.8207 | Train Acc: 0.7606
 Site-Infograph                 (2) | Train Loss: 1.1987 | Train Acc: 0.6051
 Site-Infograph                 (2) | Train Loss: 1.0380 | Train Acc: 0.6695
Average Train Accuracy: 0.8148
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8790
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8538
 Best site-Real                      | Epoch:14 | Val Acc: 0.9045
 Best site-Real                      | Epoch:14 | Val Acc: 0.9386
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8662
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8898
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8471
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8178
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.7452
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.7606
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.6051
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.6695
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (2) | Train Loss: 0.5148 | Train Acc: 0.8662
 Site-Clipart                   (2) | Train Loss: 0.4851 | Train Acc: 0.8517
 Site-Real                      (1) | Train Loss: 0.3942 | Train Acc: 0.9045
 Site-Real                      (1) | Train Loss: 0.2758 | Train Acc: 0.9407
 Site-Painting                  (1) | Train Loss: 0.4653 | Train Acc: 0.8790
 Site-Painting                  (1) | Train Loss: 0.4024 | Train Acc: 0.8877
 Site-Sketch                    (2) | Train Loss: 0.4936 | Train Acc: 0.8471
 Site-Sketch                    (2) | Train Loss: 0.5085 | Train Acc: 0.8432
 Site-QuickDraw                 (0) | Train Loss: 0.8265 | Train Acc: 0.7707
 Site-QuickDraw                 (0) | Train Loss: 0.8090 | Train Acc: 0.7648
 Site-Infograph                 (3) | Train Loss: 1.2596 | Train Acc: 0.6178
 Site-Infograph                 (3) | Train Loss: 1.0076 | Train Acc: 0.6674
Average Train Accuracy: 0.8201
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8662
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8517
 Best site-Real                      | Epoch:15 | Val Acc: 0.9045
 Best site-Real                      | Epoch:15 | Val Acc: 0.9407
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8790
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8877
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8471
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8432
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.7707
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.7648
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.6178
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.6674
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 16 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (3) | Train Loss: 0.5170 | Train Acc: 0.8726
 Site-Clipart                   (3) | Train Loss: 0.4789 | Train Acc: 0.8559
 Site-Real                      (0) | Train Loss: 0.4018 | Train Acc: 0.9045
 Site-Real                      (0) | Train Loss: 0.2775 | Train Acc: 0.9364
 Site-Painting                  (0) | Train Loss: 0.4811 | Train Acc: 0.8599
 Site-Painting                  (0) | Train Loss: 0.4296 | Train Acc: 0.8835
 Site-Sketch                    (3) | Train Loss: 0.4605 | Train Acc: 0.8535
 Site-Sketch                    (3) | Train Loss: 0.5230 | Train Acc: 0.8369
 Site-QuickDraw                 (1) | Train Loss: 0.8340 | Train Acc: 0.7261
 Site-QuickDraw                 (1) | Train Loss: 0.7638 | Train Acc: 0.8051
 Site-Infograph                 (2) | Train Loss: 1.2428 | Train Acc: 0.6561
 Site-Infograph                 (2) | Train Loss: 0.9912 | Train Acc: 0.6695
Average Train Accuracy: 0.8217
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8726
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8559
 Best site-Real                      | Epoch:16 | Val Acc: 0.9045
 Best site-Real                      | Epoch:16 | Val Acc: 0.9364
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8599
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8835
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.8535
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.8369
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.7261
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.8051
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.6561
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.6695
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (3) | Train Loss: 0.5297 | Train Acc: 0.8535
 Site-Clipart                   (3) | Train Loss: 0.4787 | Train Acc: 0.8602
 Site-Real                      (0) | Train Loss: 0.3981 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.2510 | Train Acc: 0.9555
 Site-Painting                  (0) | Train Loss: 0.4427 | Train Acc: 0.8726
 Site-Painting                  (0) | Train Loss: 0.3783 | Train Acc: 0.9047
 Site-Sketch                    (3) | Train Loss: 0.4694 | Train Acc: 0.8662
 Site-Sketch                    (3) | Train Loss: 0.4973 | Train Acc: 0.8475
 Site-QuickDraw                 (1) | Train Loss: 0.7968 | Train Acc: 0.7452
 Site-QuickDraw                 (1) | Train Loss: 0.7594 | Train Acc: 0.7775
 Site-Infograph                 (2) | Train Loss: 1.2382 | Train Acc: 0.5924
 Site-Infograph                 (2) | Train Loss: 0.9597 | Train Acc: 0.6801
Average Train Accuracy: 0.8222
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8535
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8602
 Best site-Real                      | Epoch:17 | Val Acc: 0.9108
 Best site-Real                      | Epoch:17 | Val Acc: 0.9555
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8726
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9047
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8662
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8475
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.7452
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.7775
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.5924
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.6801
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 18 ============
cnt=[6, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (2) | Train Loss: 0.4671 | Train Acc: 0.8981
 Site-Clipart                   (2) | Train Loss: 0.4673 | Train Acc: 0.8708
 Site-Real                      (0) | Train Loss: 0.3542 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.2365 | Train Acc: 0.9576
 Site-Painting                  (0) | Train Loss: 0.3813 | Train Acc: 0.9172
 Site-Painting                  (0) | Train Loss: 0.3832 | Train Acc: 0.8835
 Site-Sketch                    (3) | Train Loss: 0.4214 | Train Acc: 0.8854
 Site-Sketch                    (3) | Train Loss: 0.4788 | Train Acc: 0.8623
 Site-QuickDraw                 (1) | Train Loss: 0.8121 | Train Acc: 0.7261
 Site-QuickDraw                 (1) | Train Loss: 0.7306 | Train Acc: 0.7966
 Site-Infograph                 (0) | Train Loss: 1.2243 | Train Acc: 0.6306
 Site-Infograph                 (0) | Train Loss: 0.9611 | Train Acc: 0.6822
Average Train Accuracy: 0.8351
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8981
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8708
 Best site-Real                      | Epoch:18 | Val Acc: 0.9108
 Best site-Real                      | Epoch:18 | Val Acc: 0.9576
 Best site-Painting                  | Epoch:18 | Val Acc: 0.9172
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8835
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8623
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.7261
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.7966
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.6306
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.6822
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 19 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (0) | Train Loss: 0.5063 | Train Acc: 0.8599
 Site-Clipart                   (0) | Train Loss: 0.4412 | Train Acc: 0.8686
 Site-Real                      (3) | Train Loss: 0.3824 | Train Acc: 0.9108
 Site-Real                      (3) | Train Loss: 0.2454 | Train Acc: 0.9407
 Site-Painting                  (3) | Train Loss: 0.4322 | Train Acc: 0.8790
 Site-Painting                  (3) | Train Loss: 0.3986 | Train Acc: 0.8919
 Site-Sketch                    (0) | Train Loss: 0.4507 | Train Acc: 0.8599
 Site-Sketch                    (0) | Train Loss: 0.4583 | Train Acc: 0.8475
 Site-QuickDraw                 (1) | Train Loss: 0.8171 | Train Acc: 0.7261
 Site-QuickDraw                 (1) | Train Loss: 0.7169 | Train Acc: 0.7881
 Site-Infograph                 (2) | Train Loss: 1.2319 | Train Acc: 0.6178
 Site-Infograph                 (2) | Train Loss: 0.9179 | Train Acc: 0.7140
Average Train Accuracy: 0.8254
 Test site-Clipart                   (0)| Epoch:18 | Test Acc: 0.8479
 Test site-Real                      (3)| Epoch:18 | Test Acc: 0.9367
 Test site-Painting                  (3)| Epoch:18 | Test Acc: 0.9160
 Test site-Sketch                    (0)| Epoch:18 | Test Acc: 0.8736
 Test site-QuickDraw                 (1)| Epoch:18 | Test Acc: 0.7720
 Test site-Infograph                 (2)| Epoch:18 | Test Acc: 0.6073
Clipart: 0.8479, Real: 0.9367, Painting: 0.9160, Sketch: 0.8736, QuickDraw: 0.7720, Infograph: 0.6073, 
Average Test Accuracy(group): 0.8256, Average Test Accuracy(individual): 0.8256,
domain std=0.1109, cluster std=0.1197, individual std=0.1109, 
============ Train epoch 20 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (0) | Train Loss: 0.4808 | Train Acc: 0.8280
 Site-Clipart                   (0) | Train Loss: 0.4319 | Train Acc: 0.8771
 Site-Real                      (3) | Train Loss: 0.3707 | Train Acc: 0.9108
 Site-Real                      (3) | Train Loss: 0.2455 | Train Acc: 0.9407
 Site-Painting                  (3) | Train Loss: 0.4183 | Train Acc: 0.8917
 Site-Painting                  (3) | Train Loss: 0.3781 | Train Acc: 0.8877
 Site-Sketch                    (0) | Train Loss: 0.4744 | Train Acc: 0.8408
 Site-Sketch                    (0) | Train Loss: 0.4565 | Train Acc: 0.8559
 Site-QuickDraw                 (1) | Train Loss: 0.7995 | Train Acc: 0.7389
 Site-QuickDraw                 (1) | Train Loss: 0.6779 | Train Acc: 0.8114
 Site-Infograph                 (2) | Train Loss: 1.1821 | Train Acc: 0.6497
 Site-Infograph                 (2) | Train Loss: 0.9149 | Train Acc: 0.6970
Average Train Accuracy: 0.8275
============ Train epoch 21 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (2) | Train Loss: 0.4912 | Train Acc: 0.8535
 Site-Clipart                   (2) | Train Loss: 0.4707 | Train Acc: 0.8538
 Site-Real                      (0) | Train Loss: 0.3629 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.2460 | Train Acc: 0.9258
 Site-Painting                  (0) | Train Loss: 0.4424 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.3693 | Train Acc: 0.9047
 Site-Sketch                    (2) | Train Loss: 0.4989 | Train Acc: 0.8535
 Site-Sketch                    (2) | Train Loss: 0.4662 | Train Acc: 0.8538
 Site-QuickDraw                 (1) | Train Loss: 0.7394 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.7041 | Train Acc: 0.7966
 Site-Infograph                 (3) | Train Loss: 1.2225 | Train Acc: 0.6306
 Site-Infograph                 (3) | Train Loss: 0.9000 | Train Acc: 0.7246
Average Train Accuracy: 0.8319
============ Train epoch 22 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.4767 | Train Acc: 0.8981
 Site-Clipart                   (0) | Train Loss: 0.4452 | Train Acc: 0.8771
 Site-Real                      (3) | Train Loss: 0.3384 | Train Acc: 0.9108
 Site-Real                      (3) | Train Loss: 0.2306 | Train Acc: 0.9470
 Site-Painting                  (3) | Train Loss: 0.4542 | Train Acc: 0.8726
 Site-Painting                  (3) | Train Loss: 0.3910 | Train Acc: 0.8898
 Site-Sketch                    (0) | Train Loss: 0.4374 | Train Acc: 0.8471
 Site-Sketch                    (0) | Train Loss: 0.4420 | Train Acc: 0.8602
 Site-QuickDraw                 (1) | Train Loss: 0.7466 | Train Acc: 0.7898
 Site-QuickDraw                 (1) | Train Loss: 0.6619 | Train Acc: 0.8220
 Site-Infograph                 (2) | Train Loss: 1.1914 | Train Acc: 0.6115
 Site-Infograph                 (2) | Train Loss: 0.8880 | Train Acc: 0.7309
Average Train Accuracy: 0.8381
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8981
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8771
 Best site-Real                      | Epoch:22 | Val Acc: 0.9108
 Best site-Real                      | Epoch:22 | Val Acc: 0.9470
 Best site-Painting                  | Epoch:22 | Val Acc: 0.8726
 Best site-Painting                  | Epoch:22 | Val Acc: 0.8898
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.8471
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.8602
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.7898
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.8220
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.6115
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.7309
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 23 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.4757 | Train Acc: 0.8662
 Site-Clipart                   (2) | Train Loss: 0.4227 | Train Acc: 0.8792
 Site-Real                      (0) | Train Loss: 0.3350 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.2442 | Train Acc: 0.9449
 Site-Painting                  (0) | Train Loss: 0.3950 | Train Acc: 0.8854
 Site-Painting                  (0) | Train Loss: 0.3603 | Train Acc: 0.9153
 Site-Sketch                    (2) | Train Loss: 0.4904 | Train Acc: 0.8217
 Site-Sketch                    (2) | Train Loss: 0.4781 | Train Acc: 0.8411
 Site-QuickDraw                 (1) | Train Loss: 0.7056 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.6936 | Train Acc: 0.8072
 Site-Infograph                 (3) | Train Loss: 1.1544 | Train Acc: 0.6624
 Site-Infograph                 (3) | Train Loss: 0.8754 | Train Acc: 0.7267
Average Train Accuracy: 0.8381
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8662
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8792
 Best site-Real                      | Epoch:23 | Val Acc: 0.9236
 Best site-Real                      | Epoch:23 | Val Acc: 0.9449
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8854
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9153
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8217
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8411
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.7834
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.8072
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.6624
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.7267
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 24 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (0) | Train Loss: 0.4393 | Train Acc: 0.9108
 Site-Clipart                   (0) | Train Loss: 0.4332 | Train Acc: 0.8792
 Site-Real                      (3) | Train Loss: 0.3272 | Train Acc: 0.9236
 Site-Real                      (3) | Train Loss: 0.2396 | Train Acc: 0.9386
 Site-Painting                  (3) | Train Loss: 0.3998 | Train Acc: 0.8790
 Site-Painting                  (3) | Train Loss: 0.3405 | Train Acc: 0.9174
 Site-Sketch                    (0) | Train Loss: 0.4441 | Train Acc: 0.8535
 Site-Sketch                    (0) | Train Loss: 0.4271 | Train Acc: 0.8665
 Site-QuickDraw                 (1) | Train Loss: 0.7215 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.6574 | Train Acc: 0.8305
 Site-Infograph                 (2) | Train Loss: 1.0903 | Train Acc: 0.6815
 Site-Infograph                 (2) | Train Loss: 0.8754 | Train Acc: 0.7182
Average Train Accuracy: 0.8469
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9108
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8792
 Best site-Real                      | Epoch:24 | Val Acc: 0.9236
 Best site-Real                      | Epoch:24 | Val Acc: 0.9386
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8790
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9174
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8535
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8665
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7643
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.8305
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6815
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.7182
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.4316 | Train Acc: 0.8854
 Site-Clipart                   (3) | Train Loss: 0.4294 | Train Acc: 0.8686
 Site-Real                      (1) | Train Loss: 0.3297 | Train Acc: 0.9363
 Site-Real                      (1) | Train Loss: 0.2361 | Train Acc: 0.9407
 Site-Painting                  (1) | Train Loss: 0.4114 | Train Acc: 0.8790
 Site-Painting                  (1) | Train Loss: 0.3548 | Train Acc: 0.8983
 Site-Sketch                    (3) | Train Loss: 0.4438 | Train Acc: 0.8726
 Site-Sketch                    (3) | Train Loss: 0.4452 | Train Acc: 0.8559
 Site-QuickDraw                 (0) | Train Loss: 0.7128 | Train Acc: 0.7707
 Site-QuickDraw                 (0) | Train Loss: 0.6677 | Train Acc: 0.8263
 Site-Infograph                 (2) | Train Loss: 1.1362 | Train Acc: 0.6369
 Site-Infograph                 (2) | Train Loss: 0.8398 | Train Acc: 0.7394
Average Train Accuracy: 0.8425
============ Train epoch 26 ============
cnt=[2, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (2) | Train Loss: 0.4971 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.3883 | Train Acc: 0.8898
 Site-Real                      (1) | Train Loss: 0.3208 | Train Acc: 0.9299
 Site-Real                      (1) | Train Loss: 0.2326 | Train Acc: 0.9449
 Site-Painting                  (1) | Train Loss: 0.3990 | Train Acc: 0.8854
 Site-Painting                  (1) | Train Loss: 0.3485 | Train Acc: 0.9047
 Site-Sketch                    (2) | Train Loss: 0.4281 | Train Acc: 0.8662
 Site-Sketch                    (2) | Train Loss: 0.4480 | Train Acc: 0.8517
 Site-QuickDraw                 (0) | Train Loss: 0.7265 | Train Acc: 0.7834
 Site-QuickDraw                 (0) | Train Loss: 0.6434 | Train Acc: 0.8263
 Site-Infograph                 (3) | Train Loss: 1.1411 | Train Acc: 0.6688
 Site-Infograph                 (3) | Train Loss: 0.8285 | Train Acc: 0.7331
Average Train Accuracy: 0.8453
============ Train epoch 27 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (2) | Train Loss: 0.4525 | Train Acc: 0.8917
 Site-Clipart                   (2) | Train Loss: 0.3953 | Train Acc: 0.8898
 Site-Real                      (0) | Train Loss: 0.3154 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2385 | Train Acc: 0.9343
 Site-Painting                  (0) | Train Loss: 0.3553 | Train Acc: 0.8917
 Site-Painting                  (0) | Train Loss: 0.3194 | Train Acc: 0.9216
 Site-Sketch                    (2) | Train Loss: 0.3860 | Train Acc: 0.8854
 Site-Sketch                    (2) | Train Loss: 0.4074 | Train Acc: 0.8686
 Site-QuickDraw                 (1) | Train Loss: 0.6862 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.6384 | Train Acc: 0.8263
 Site-Infograph                 (3) | Train Loss: 1.1189 | Train Acc: 0.6624
 Site-Infograph                 (3) | Train Loss: 0.8035 | Train Acc: 0.7458
Average Train Accuracy: 0.8526
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.8917
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.8898
 Best site-Real                      | Epoch:27 | Val Acc: 0.9299
 Best site-Real                      | Epoch:27 | Val Acc: 0.9343
 Best site-Painting                  | Epoch:27 | Val Acc: 0.8917
 Best site-Painting                  | Epoch:27 | Val Acc: 0.9216
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.8686
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.7834
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.8263
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.6624
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.7458
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 2, 4, 4, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (3) | Train Loss: 0.4160 | Train Acc: 0.8854
 Site-Clipart                   (3) | Train Loss: 0.4042 | Train Acc: 0.8792
 Site-Real                      (2) | Train Loss: 0.3109 | Train Acc: 0.9299
 Site-Real                      (2) | Train Loss: 0.2244 | Train Acc: 0.9470
 Site-Painting                  (2) | Train Loss: 0.3632 | Train Acc: 0.9045
 Site-Painting                  (2) | Train Loss: 0.3459 | Train Acc: 0.9025
 Site-Sketch                    (3) | Train Loss: 0.3862 | Train Acc: 0.8790
 Site-Sketch                    (3) | Train Loss: 0.4322 | Train Acc: 0.8644
 Site-QuickDraw                 (1) | Train Loss: 0.6678 | Train Acc: 0.8025
 Site-QuickDraw                 (1) | Train Loss: 0.6049 | Train Acc: 0.8369
 Site-Infograph                 (0) | Train Loss: 1.0990 | Train Acc: 0.6879
 Site-Infograph                 (0) | Train Loss: 0.8238 | Train Acc: 0.7267
Average Train Accuracy: 0.8538
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8854
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8792
 Best site-Real                      | Epoch:28 | Val Acc: 0.9299
 Best site-Real                      | Epoch:28 | Val Acc: 0.9470
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9045
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9025
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8790
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8644
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.8025
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.8369
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.6879
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.7267
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (2) | Train Loss: 0.4567 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.3943 | Train Acc: 0.8898
 Site-Real                      (0) | Train Loss: 0.3407 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2270 | Train Acc: 0.9386
 Site-Painting                  (0) | Train Loss: 0.3661 | Train Acc: 0.9172
 Site-Painting                  (0) | Train Loss: 0.3397 | Train Acc: 0.9153
 Site-Sketch                    (2) | Train Loss: 0.4052 | Train Acc: 0.8599
 Site-Sketch                    (2) | Train Loss: 0.3908 | Train Acc: 0.8623
 Site-QuickDraw                 (1) | Train Loss: 0.7248 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.6022 | Train Acc: 0.8475
 Site-Infograph                 (3) | Train Loss: 1.0806 | Train Acc: 0.6624
 Site-Infograph                 (3) | Train Loss: 0.7488 | Train Acc: 0.7733
Average Train Accuracy: 0.8533
 Test site-Clipart                   (2)| Epoch:28 | Test Acc: 0.8441
 Test site-Real                      (0)| Epoch:28 | Test Acc: 0.9417
 Test site-Painting                  (0)| Epoch:28 | Test Acc: 0.9257
 Test site-Sketch                    (2)| Epoch:28 | Test Acc: 0.8736
 Test site-QuickDraw                 (1)| Epoch:28 | Test Acc: 0.7850
 Test site-Infograph                 (3)| Epoch:28 | Test Acc: 0.6225
Clipart: 0.8441, Real: 0.9417, Painting: 0.9257, Sketch: 0.8736, QuickDraw: 0.7850, Infograph: 0.6225, 
Average Test Accuracy(group): 0.8321, Average Test Accuracy(individual): 0.8321,
domain std=0.1071, cluster std=0.1152, individual std=0.1071, 
============ Train epoch 30 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (2) | Train Loss: 0.4173 | Train Acc: 0.8917
 Site-Clipart                   (2) | Train Loss: 0.3926 | Train Acc: 0.8898
 Site-Real                      (0) | Train Loss: 0.3136 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2140 | Train Acc: 0.9470
 Site-Painting                  (0) | Train Loss: 0.3473 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.3217 | Train Acc: 0.9089
 Site-Sketch                    (2) | Train Loss: 0.4001 | Train Acc: 0.8662
 Site-Sketch                    (2) | Train Loss: 0.4123 | Train Acc: 0.8665
 Site-QuickDraw                 (1) | Train Loss: 0.6747 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.6054 | Train Acc: 0.8347
 Site-Infograph                 (3) | Train Loss: 1.0743 | Train Acc: 0.7006
 Site-Infograph                 (3) | Train Loss: 0.7891 | Train Acc: 0.7585
Average Train Accuracy: 0.8547
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8917
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8898
 Best site-Real                      | Epoch:30 | Val Acc: 0.9299
 Best site-Real                      | Epoch:30 | Val Acc: 0.9470
 Best site-Painting                  | Epoch:30 | Val Acc: 0.8981
 Best site-Painting                  | Epoch:30 | Val Acc: 0.9089
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.8662
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.8665
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.7643
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.8347
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.7006
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.7585
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (1) | Train Loss: 0.4147 | Train Acc: 0.8726
 Site-Clipart                   (1) | Train Loss: 0.3812 | Train Acc: 0.8898
 Site-Real                      (2) | Train Loss: 0.2939 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.2009 | Train Acc: 0.9555
 Site-Painting                  (2) | Train Loss: 0.4019 | Train Acc: 0.8917
 Site-Painting                  (2) | Train Loss: 0.3523 | Train Acc: 0.9004
 Site-Sketch                    (1) | Train Loss: 0.3836 | Train Acc: 0.8854
 Site-Sketch                    (1) | Train Loss: 0.4001 | Train Acc: 0.8708
 Site-QuickDraw                 (0) | Train Loss: 0.6558 | Train Acc: 0.8217
 Site-QuickDraw                 (0) | Train Loss: 0.5756 | Train Acc: 0.8581
 Site-Infograph                 (3) | Train Loss: 1.1065 | Train Acc: 0.6497
 Site-Infograph                 (3) | Train Loss: 0.7643 | Train Acc: 0.7542
Average Train Accuracy: 0.8561
 Best site-Clipart                   | Epoch:31 | Val Acc: 0.8726
 Best site-Clipart                   | Epoch:31 | Val Acc: 0.8898
 Best site-Real                      | Epoch:31 | Val Acc: 0.9236
 Best site-Real                      | Epoch:31 | Val Acc: 0.9555
 Best site-Painting                  | Epoch:31 | Val Acc: 0.8917
 Best site-Painting                  | Epoch:31 | Val Acc: 0.9004
 Best site-Sketch                    | Epoch:31 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:31 | Val Acc: 0.8708
 Best site-QuickDraw                 | Epoch:31 | Val Acc: 0.8217
 Best site-QuickDraw                 | Epoch:31 | Val Acc: 0.8581
 Best site-Infograph                 | Epoch:31 | Val Acc: 0.6497
 Best site-Infograph                 | Epoch:31 | Val Acc: 0.7542
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 32 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.4083 | Train Acc: 0.8981
 Site-Clipart                   (2) | Train Loss: 0.3701 | Train Acc: 0.8962
 Site-Real                      (0) | Train Loss: 0.2946 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2140 | Train Acc: 0.9449
 Site-Painting                  (0) | Train Loss: 0.3803 | Train Acc: 0.9045
 Site-Painting                  (0) | Train Loss: 0.3494 | Train Acc: 0.8962
 Site-Sketch                    (2) | Train Loss: 0.3981 | Train Acc: 0.8599
 Site-Sketch                    (2) | Train Loss: 0.4182 | Train Acc: 0.8771
 Site-QuickDraw                 (1) | Train Loss: 0.6683 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.5923 | Train Acc: 0.8369
 Site-Infograph                 (3) | Train Loss: 1.0474 | Train Acc: 0.6433
 Site-Infograph                 (3) | Train Loss: 0.7426 | Train Acc: 0.7648
Average Train Accuracy: 0.8540
============ Train epoch 33 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (0) | Train Loss: 0.4020 | Train Acc: 0.8790
 Site-Clipart                   (0) | Train Loss: 0.3272 | Train Acc: 0.9047
 Site-Real                      (3) | Train Loss: 0.2954 | Train Acc: 0.9299
 Site-Real                      (3) | Train Loss: 0.1956 | Train Acc: 0.9597
 Site-Painting                  (3) | Train Loss: 0.3432 | Train Acc: 0.9045
 Site-Painting                  (3) | Train Loss: 0.3344 | Train Acc: 0.9025
 Site-Sketch                    (0) | Train Loss: 0.3638 | Train Acc: 0.8917
 Site-Sketch                    (0) | Train Loss: 0.4012 | Train Acc: 0.8686
 Site-QuickDraw                 (1) | Train Loss: 0.6568 | Train Acc: 0.7771
 Site-QuickDraw                 (1) | Train Loss: 0.5930 | Train Acc: 0.8390
 Site-Infograph                 (2) | Train Loss: 1.1081 | Train Acc: 0.6369
 Site-Infograph                 (2) | Train Loss: 0.7063 | Train Acc: 0.7881
Average Train Accuracy: 0.8568
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.8790
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9047
 Best site-Real                      | Epoch:33 | Val Acc: 0.9299
 Best site-Real                      | Epoch:33 | Val Acc: 0.9597
 Best site-Painting                  | Epoch:33 | Val Acc: 0.9045
 Best site-Painting                  | Epoch:33 | Val Acc: 0.9025
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.8917
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.8686
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.7771
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.8390
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.6369
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.7881
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 34 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (3) | Train Loss: 0.3846 | Train Acc: 0.8917
 Site-Clipart                   (3) | Train Loss: 0.3615 | Train Acc: 0.8856
 Site-Real                      (0) | Train Loss: 0.2873 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.2194 | Train Acc: 0.9513
 Site-Painting                  (0) | Train Loss: 0.3852 | Train Acc: 0.8917
 Site-Painting                  (0) | Train Loss: 0.3352 | Train Acc: 0.8941
 Site-Sketch                    (3) | Train Loss: 0.3471 | Train Acc: 0.8981
 Site-Sketch                    (3) | Train Loss: 0.3789 | Train Acc: 0.8771
 Site-QuickDraw                 (1) | Train Loss: 0.7035 | Train Acc: 0.8217
 Site-QuickDraw                 (1) | Train Loss: 0.5665 | Train Acc: 0.8475
 Site-Infograph                 (2) | Train Loss: 1.0683 | Train Acc: 0.6688
 Site-Infograph                 (2) | Train Loss: 0.7151 | Train Acc: 0.7860
Average Train Accuracy: 0.8614
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8917
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8856
 Best site-Real                      | Epoch:34 | Val Acc: 0.9236
 Best site-Real                      | Epoch:34 | Val Acc: 0.9513
 Best site-Painting                  | Epoch:34 | Val Acc: 0.8917
 Best site-Painting                  | Epoch:34 | Val Acc: 0.8941
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8981
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8771
 Best site-QuickDraw                 | Epoch:34 | Val Acc: 0.8217
 Best site-QuickDraw                 | Epoch:34 | Val Acc: 0.8475
 Best site-Infograph                 | Epoch:34 | Val Acc: 0.6688
 Best site-Infograph                 | Epoch:34 | Val Acc: 0.7860
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 35 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (0) | Train Loss: 0.4838 | Train Acc: 0.8471
 Site-Clipart                   (0) | Train Loss: 0.3523 | Train Acc: 0.8941
 Site-Real                      (3) | Train Loss: 0.3134 | Train Acc: 0.9236
 Site-Real                      (3) | Train Loss: 0.1914 | Train Acc: 0.9513
 Site-Painting                  (3) | Train Loss: 0.3514 | Train Acc: 0.9045
 Site-Painting                  (3) | Train Loss: 0.3269 | Train Acc: 0.9068
 Site-Sketch                    (0) | Train Loss: 0.3628 | Train Acc: 0.8981
 Site-Sketch                    (0) | Train Loss: 0.3933 | Train Acc: 0.8708
 Site-QuickDraw                 (1) | Train Loss: 0.6504 | Train Acc: 0.8153
 Site-QuickDraw                 (1) | Train Loss: 0.5610 | Train Acc: 0.8326
 Site-Infograph                 (2) | Train Loss: 1.0693 | Train Acc: 0.6752
 Site-Infograph                 (2) | Train Loss: 0.7106 | Train Acc: 0.7881
Average Train Accuracy: 0.8589
============ Train epoch 36 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (0) | Train Loss: 0.4044 | Train Acc: 0.8917
 Site-Clipart                   (0) | Train Loss: 0.3310 | Train Acc: 0.8962
 Site-Real                      (3) | Train Loss: 0.2819 | Train Acc: 0.9363
 Site-Real                      (3) | Train Loss: 0.2055 | Train Acc: 0.9534
 Site-Painting                  (3) | Train Loss: 0.3785 | Train Acc: 0.8790
 Site-Painting                  (3) | Train Loss: 0.3126 | Train Acc: 0.9174
 Site-Sketch                    (0) | Train Loss: 0.3627 | Train Acc: 0.8917
 Site-Sketch                    (0) | Train Loss: 0.3611 | Train Acc: 0.8835
 Site-QuickDraw                 (1) | Train Loss: 0.6438 | Train Acc: 0.8025
 Site-QuickDraw                 (1) | Train Loss: 0.5380 | Train Acc: 0.8581
 Site-Infograph                 (2) | Train Loss: 1.0805 | Train Acc: 0.6688
 Site-Infograph                 (2) | Train Loss: 0.7099 | Train Acc: 0.7691
Average Train Accuracy: 0.8623
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8917
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8962
 Best site-Real                      | Epoch:36 | Val Acc: 0.9363
 Best site-Real                      | Epoch:36 | Val Acc: 0.9534
 Best site-Painting                  | Epoch:36 | Val Acc: 0.8790
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9174
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8917
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8835
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.8025
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.8581
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.6688
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.7691
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (3) | Train Loss: 0.3906 | Train Acc: 0.8981
 Site-Clipart                   (3) | Train Loss: 0.3431 | Train Acc: 0.8962
 Site-Real                      (1) | Train Loss: 0.2749 | Train Acc: 0.9363
 Site-Real                      (1) | Train Loss: 0.1784 | Train Acc: 0.9682
 Site-Painting                  (1) | Train Loss: 0.3314 | Train Acc: 0.9172
 Site-Painting                  (1) | Train Loss: 0.3153 | Train Acc: 0.8983
 Site-Sketch                    (3) | Train Loss: 0.3517 | Train Acc: 0.8981
 Site-Sketch                    (3) | Train Loss: 0.3419 | Train Acc: 0.9025
 Site-QuickDraw                 (0) | Train Loss: 0.6318 | Train Acc: 0.8280
 Site-QuickDraw                 (0) | Train Loss: 0.5472 | Train Acc: 0.8432
 Site-Infograph                 (2) | Train Loss: 1.0329 | Train Acc: 0.6752
 Site-Infograph                 (2) | Train Loss: 0.7156 | Train Acc: 0.7754
Average Train Accuracy: 0.8697
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.8981
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.8962
 Best site-Real                      | Epoch:37 | Val Acc: 0.9363
 Best site-Real                      | Epoch:37 | Val Acc: 0.9682
 Best site-Painting                  | Epoch:37 | Val Acc: 0.9172
 Best site-Painting                  | Epoch:37 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:37 | Val Acc: 0.8981
 Best site-Sketch                    | Epoch:37 | Val Acc: 0.9025
 Best site-QuickDraw                 | Epoch:37 | Val Acc: 0.8280
 Best site-QuickDraw                 | Epoch:37 | Val Acc: 0.8432
 Best site-Infograph                 | Epoch:37 | Val Acc: 0.6752
 Best site-Infograph                 | Epoch:37 | Val Acc: 0.7754
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 38 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (3) | Train Loss: 0.3687 | Train Acc: 0.9045
 Site-Clipart                   (3) | Train Loss: 0.3395 | Train Acc: 0.9004
 Site-Real                      (0) | Train Loss: 0.2953 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.1956 | Train Acc: 0.9555
 Site-Painting                  (0) | Train Loss: 0.3947 | Train Acc: 0.8854
 Site-Painting                  (0) | Train Loss: 0.3210 | Train Acc: 0.9089
 Site-Sketch                    (3) | Train Loss: 0.3829 | Train Acc: 0.8981
 Site-Sketch                    (3) | Train Loss: 0.3919 | Train Acc: 0.8729
 Site-QuickDraw                 (1) | Train Loss: 0.6049 | Train Acc: 0.7580
 Site-QuickDraw                 (1) | Train Loss: 0.5451 | Train Acc: 0.8496
 Site-Infograph                 (2) | Train Loss: 1.0180 | Train Acc: 0.6815
 Site-Infograph                 (2) | Train Loss: 0.6691 | Train Acc: 0.8072
Average Train Accuracy: 0.8621
============ Train epoch 39 ============
cnt=[2, 2, 4, 4, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (2) | Train Loss: 0.3780 | Train Acc: 0.8917
 Site-Clipart                   (2) | Train Loss: 0.3300 | Train Acc: 0.9089
 Site-Real                      (3) | Train Loss: 0.2820 | Train Acc: 0.9299
 Site-Real                      (3) | Train Loss: 0.1866 | Train Acc: 0.9576
 Site-Painting                  (3) | Train Loss: 0.3364 | Train Acc: 0.9108
 Site-Painting                  (3) | Train Loss: 0.3113 | Train Acc: 0.8962
 Site-Sketch                    (2) | Train Loss: 0.3471 | Train Acc: 0.8981
 Site-Sketch                    (2) | Train Loss: 0.3468 | Train Acc: 0.8919
 Site-QuickDraw                 (1) | Train Loss: 0.6280 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.5302 | Train Acc: 0.8517
 Site-Infograph                 (0) | Train Loss: 1.0094 | Train Acc: 0.6815
 Site-Infograph                 (0) | Train Loss: 0.6860 | Train Acc: 0.7860
Average Train Accuracy: 0.8667
 Test site-Clipart                   (2)| Epoch:37 | Test Acc: 0.8669
 Test site-Real                      (3)| Epoch:37 | Test Acc: 0.9441
 Test site-Painting                  (3)| Epoch:37 | Test Acc: 0.9241
 Test site-Sketch                    (2)| Epoch:37 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:37 | Test Acc: 0.8040
 Test site-Infograph                 (0)| Epoch:37 | Test Acc: 0.6149
Clipart: 0.8669, Real: 0.9441, Painting: 0.9241, Sketch: 0.8917, QuickDraw: 0.8040, Infograph: 0.6149, 
Average Test Accuracy(group): 0.8410, Average Test Accuracy(individual): 0.8410,
domain std=0.1105, cluster std=0.1207, individual std=0.1105, 
============ Train epoch 40 ============
cnt=[2, 2, 4, 4, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (3) | Train Loss: 0.3874 | Train Acc: 0.8662
 Site-Clipart                   (3) | Train Loss: 0.3430 | Train Acc: 0.8898
 Site-Real                      (2) | Train Loss: 0.3273 | Train Acc: 0.9299
 Site-Real                      (2) | Train Loss: 0.2093 | Train Acc: 0.9449
 Site-Painting                  (2) | Train Loss: 0.4008 | Train Acc: 0.8662
 Site-Painting                  (2) | Train Loss: 0.3096 | Train Acc: 0.9004
 Site-Sketch                    (3) | Train Loss: 0.3840 | Train Acc: 0.8662
 Site-Sketch                    (3) | Train Loss: 0.3590 | Train Acc: 0.8941
 Site-QuickDraw                 (1) | Train Loss: 0.6216 | Train Acc: 0.8344
 Site-QuickDraw                 (1) | Train Loss: 0.5275 | Train Acc: 0.8496
 Site-Infograph                 (0) | Train Loss: 1.0780 | Train Acc: 0.6815
 Site-Infograph                 (0) | Train Loss: 0.6641 | Train Acc: 0.7903
Average Train Accuracy: 0.8595
============ Train epoch 41 ============
cnt=[2, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (3) | Train Loss: 0.4316 | Train Acc: 0.8662
 Site-Clipart                   (3) | Train Loss: 0.3161 | Train Acc: 0.9025
 Site-Real                      (1) | Train Loss: 0.3274 | Train Acc: 0.9108
 Site-Real                      (1) | Train Loss: 0.1858 | Train Acc: 0.9513
 Site-Painting                  (1) | Train Loss: 0.3105 | Train Acc: 0.8981
 Site-Painting                  (1) | Train Loss: 0.2999 | Train Acc: 0.9131
 Site-Sketch                    (3) | Train Loss: 0.3310 | Train Acc: 0.9045
 Site-Sketch                    (3) | Train Loss: 0.3734 | Train Acc: 0.8750
 Site-QuickDraw                 (0) | Train Loss: 0.5728 | Train Acc: 0.8280
 Site-QuickDraw                 (0) | Train Loss: 0.5079 | Train Acc: 0.8602
 Site-Infograph                 (2) | Train Loss: 0.9752 | Train Acc: 0.6688
 Site-Infograph                 (2) | Train Loss: 0.6695 | Train Acc: 0.7881
Average Train Accuracy: 0.8639
============ Train epoch 42 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (0) | Train Loss: 0.3649 | Train Acc: 0.9045
 Site-Clipart                   (0) | Train Loss: 0.3216 | Train Acc: 0.8983
 Site-Real                      (3) | Train Loss: 0.2932 | Train Acc: 0.9363
 Site-Real                      (3) | Train Loss: 0.1882 | Train Acc: 0.9597
 Site-Painting                  (3) | Train Loss: 0.3030 | Train Acc: 0.9108
 Site-Painting                  (3) | Train Loss: 0.3054 | Train Acc: 0.9195
 Site-Sketch                    (0) | Train Loss: 0.3594 | Train Acc: 0.8917
 Site-Sketch                    (0) | Train Loss: 0.3501 | Train Acc: 0.8814
 Site-QuickDraw                 (1) | Train Loss: 0.6223 | Train Acc: 0.8408
 Site-QuickDraw                 (1) | Train Loss: 0.5161 | Train Acc: 0.8517
 Site-Infograph                 (2) | Train Loss: 1.0382 | Train Acc: 0.6752
 Site-Infograph                 (2) | Train Loss: 0.6339 | Train Acc: 0.8114
Average Train Accuracy: 0.8734
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9045
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8983
 Best site-Real                      | Epoch:42 | Val Acc: 0.9363
 Best site-Real                      | Epoch:42 | Val Acc: 0.9597
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9108
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9195
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.8917
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.8814
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.8408
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.8517
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.6752
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.8114
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (0) | Train Loss: 0.3794 | Train Acc: 0.9045
 Site-Clipart                   (0) | Train Loss: 0.3319 | Train Acc: 0.9174
 Site-Real                      (3) | Train Loss: 0.2999 | Train Acc: 0.9236
 Site-Real                      (3) | Train Loss: 0.1836 | Train Acc: 0.9555
 Site-Painting                  (3) | Train Loss: 0.3322 | Train Acc: 0.9172
 Site-Painting                  (3) | Train Loss: 0.2930 | Train Acc: 0.9153
 Site-Sketch                    (0) | Train Loss: 0.3346 | Train Acc: 0.8981
 Site-Sketch                    (0) | Train Loss: 0.3602 | Train Acc: 0.8623
 Site-QuickDraw                 (1) | Train Loss: 0.5629 | Train Acc: 0.8217
 Site-QuickDraw                 (1) | Train Loss: 0.5216 | Train Acc: 0.8475
 Site-Infograph                 (2) | Train Loss: 1.0054 | Train Acc: 0.6815
 Site-Infograph                 (2) | Train Loss: 0.6320 | Train Acc: 0.8072
Average Train Accuracy: 0.8710
============ Train epoch 44 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (3) | Train Loss: 0.4220 | Train Acc: 0.8854
 Site-Clipart                   (3) | Train Loss: 0.3164 | Train Acc: 0.9131
 Site-Real                      (0) | Train Loss: 0.2813 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.1812 | Train Acc: 0.9534
 Site-Painting                  (0) | Train Loss: 0.3543 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.2906 | Train Acc: 0.9258
 Site-Sketch                    (3) | Train Loss: 0.3264 | Train Acc: 0.8981
 Site-Sketch                    (3) | Train Loss: 0.3266 | Train Acc: 0.8962
 Site-QuickDraw                 (1) | Train Loss: 0.6314 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.5146 | Train Acc: 0.8559
 Site-Infograph                 (2) | Train Loss: 1.0155 | Train Acc: 0.7197
 Site-Infograph                 (2) | Train Loss: 0.6232 | Train Acc: 0.8305
Average Train Accuracy: 0.8747
 Best site-Clipart                   | Epoch:44 | Val Acc: 0.8854
 Best site-Clipart                   | Epoch:44 | Val Acc: 0.9131
 Best site-Real                      | Epoch:44 | Val Acc: 0.9236
 Best site-Real                      | Epoch:44 | Val Acc: 0.9534
 Best site-Painting                  | Epoch:44 | Val Acc: 0.8981
 Best site-Painting                  | Epoch:44 | Val Acc: 0.9258
 Best site-Sketch                    | Epoch:44 | Val Acc: 0.8981
 Best site-Sketch                    | Epoch:44 | Val Acc: 0.8962
 Best site-QuickDraw                 | Epoch:44 | Val Acc: 0.7962
 Best site-QuickDraw                 | Epoch:44 | Val Acc: 0.8559
 Best site-Infograph                 | Epoch:44 | Val Acc: 0.7197
 Best site-Infograph                 | Epoch:44 | Val Acc: 0.8305
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (3) | Train Loss: 0.4050 | Train Acc: 0.8790
 Site-Clipart                   (3) | Train Loss: 0.3301 | Train Acc: 0.9153
 Site-Real                      (1) | Train Loss: 0.2927 | Train Acc: 0.9299
 Site-Real                      (1) | Train Loss: 0.1868 | Train Acc: 0.9576
 Site-Painting                  (1) | Train Loss: 0.2957 | Train Acc: 0.9108
 Site-Painting                  (1) | Train Loss: 0.2918 | Train Acc: 0.9174
 Site-Sketch                    (3) | Train Loss: 0.3680 | Train Acc: 0.8790
 Site-Sketch                    (3) | Train Loss: 0.2962 | Train Acc: 0.9089
 Site-QuickDraw                 (0) | Train Loss: 0.6024 | Train Acc: 0.8217
 Site-QuickDraw                 (0) | Train Loss: 0.5315 | Train Acc: 0.8347
 Site-Infograph                 (2) | Train Loss: 1.0246 | Train Acc: 0.6879
 Site-Infograph                 (2) | Train Loss: 0.6234 | Train Acc: 0.8178
Average Train Accuracy: 0.8717
============ Train epoch 46 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (3) | Train Loss: 0.3294 | Train Acc: 0.9045
 Site-Clipart                   (3) | Train Loss: 0.3312 | Train Acc: 0.9047
 Site-Real                      (0) | Train Loss: 0.2756 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.1861 | Train Acc: 0.9492
 Site-Painting                  (0) | Train Loss: 0.3180 | Train Acc: 0.9236
 Site-Painting                  (0) | Train Loss: 0.2706 | Train Acc: 0.9195
 Site-Sketch                    (3) | Train Loss: 0.3534 | Train Acc: 0.8854
 Site-Sketch                    (3) | Train Loss: 0.3385 | Train Acc: 0.8814
 Site-QuickDraw                 (1) | Train Loss: 0.6152 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.5066 | Train Acc: 0.8771
 Site-Infograph                 (2) | Train Loss: 0.9634 | Train Acc: 0.7006
 Site-Infograph                 (2) | Train Loss: 0.6425 | Train Acc: 0.8114
Average Train Accuracy: 0.8731
============ Train epoch 47 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (0) | Train Loss: 0.4078 | Train Acc: 0.8790
 Site-Clipart                   (0) | Train Loss: 0.3274 | Train Acc: 0.8835
 Site-Real                      (3) | Train Loss: 0.2828 | Train Acc: 0.9299
 Site-Real                      (3) | Train Loss: 0.1962 | Train Acc: 0.9449
 Site-Painting                  (3) | Train Loss: 0.2957 | Train Acc: 0.9108
 Site-Painting                  (3) | Train Loss: 0.2619 | Train Acc: 0.9237
 Site-Sketch                    (0) | Train Loss: 0.3624 | Train Acc: 0.8854
 Site-Sketch                    (0) | Train Loss: 0.3390 | Train Acc: 0.9047
 Site-QuickDraw                 (1) | Train Loss: 0.6214 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.5136 | Train Acc: 0.8453
 Site-Infograph                 (2) | Train Loss: 0.9528 | Train Acc: 0.7070
 Site-Infograph                 (2) | Train Loss: 0.5998 | Train Acc: 0.8475
Average Train Accuracy: 0.8704
============ Train epoch 48 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.4409 | Train Acc: 0.8408
 Site-Clipart                   (0) | Train Loss: 0.3071 | Train Acc: 0.9047
 Site-Real                      (3) | Train Loss: 0.2832 | Train Acc: 0.9299
 Site-Real                      (3) | Train Loss: 0.1792 | Train Acc: 0.9492
 Site-Painting                  (3) | Train Loss: 0.2914 | Train Acc: 0.9172
 Site-Painting                  (3) | Train Loss: 0.2853 | Train Acc: 0.9258
 Site-Sketch                    (0) | Train Loss: 0.3447 | Train Acc: 0.8790
 Site-Sketch                    (0) | Train Loss: 0.3519 | Train Acc: 0.8919
 Site-QuickDraw                 (1) | Train Loss: 0.5611 | Train Acc: 0.8153
 Site-QuickDraw                 (1) | Train Loss: 0.4898 | Train Acc: 0.8623
 Site-Infograph                 (2) | Train Loss: 1.0024 | Train Acc: 0.7070
 Site-Infograph                 (2) | Train Loss: 0.6135 | Train Acc: 0.8326
Average Train Accuracy: 0.8713
============ Train epoch 49 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (3) | Train Loss: 0.3657 | Train Acc: 0.8854
 Site-Clipart                   (3) | Train Loss: 0.3051 | Train Acc: 0.9025
 Site-Real                      (0) | Train Loss: 0.2624 | Train Acc: 0.9363
 Site-Real                      (0) | Train Loss: 0.1804 | Train Acc: 0.9555
 Site-Painting                  (0) | Train Loss: 0.3432 | Train Acc: 0.9045
 Site-Painting                  (0) | Train Loss: 0.2851 | Train Acc: 0.9131
 Site-Sketch                    (3) | Train Loss: 0.4001 | Train Acc: 0.8662
 Site-Sketch                    (3) | Train Loss: 0.3341 | Train Acc: 0.9004
 Site-QuickDraw                 (1) | Train Loss: 0.6138 | Train Acc: 0.8089
 Site-QuickDraw                 (1) | Train Loss: 0.5075 | Train Acc: 0.8475
 Site-Infograph                 (2) | Train Loss: 0.9579 | Train Acc: 0.7070
 Site-Infograph                 (2) | Train Loss: 0.5942 | Train Acc: 0.8347
Average Train Accuracy: 0.8718
 Test site-Clipart                   (3)| Epoch:44 | Test Acc: 0.8783
 Test site-Real                      (0)| Epoch:44 | Test Acc: 0.9425
 Test site-Painting                  (0)| Epoch:44 | Test Acc: 0.9305
 Test site-Sketch                    (3)| Epoch:44 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.8100
 Test site-Infograph                 (2)| Epoch:44 | Test Acc: 0.6180
Clipart: 0.8783, Real: 0.9425, Painting: 0.9305, Sketch: 0.8845, QuickDraw: 0.8100, Infograph: 0.6180, 
Average Test Accuracy(group): 0.8440, Average Test Accuracy(individual): 0.8440,
domain std=0.1097, cluster std=0.1204, individual std=0.1097, 
===2023-08-17 06:18:42===
===2023-08-17 06:18:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 4
Loading snapshots...
 Test site-Clipart                   (3)| Epoch:44 | Test Acc: 0.8802
 Test site-Real                      (0)| Epoch:44 | Test Acc: 0.9449
 Test site-Painting                  (0)| Epoch:44 | Test Acc: 0.9273
 Test site-Sketch                    (3)| Epoch:44 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.8000
 Test site-Infograph                 (2)| Epoch:44 | Test Acc: 0.6225
Clipart: 0.8802, Real: 0.9449, Painting: 0.9273, Sketch: 0.8917, QuickDraw: 0.8000, Infograph: 0.6225, 
Average Test Accuracy(group): 0.8445, Average Test Accuracy(individual): 0.8445,
domain std=0.1093, cluster std=0.1193, individual std=0.1093, 
