===2023-03-26 13:25:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 4
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.2027 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.2333 | Train Acc: 0.1982
 Site-USPS      | Train Loss: 1.7859 | Train Acc: 0.5225
 Site-USPS      | Train Loss: 1.8293 | Train Acc: 0.5225
 Site-SynthDigits| Train Loss: 2.0798 | Train Acc: 0.3243
 Site-SynthDigits| Train Loss: 2.1056 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.2066 | Train Acc: 0.1802
 Site-MNIST-M   | Train Loss: 2.2031 | Train Acc: 0.2252
 Site-SVHN      | Val  Loss: 2.2645 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.1992 | Val  Acc: 0.2432
 Site-USPS      | Val  Loss: 1.8004 | Val  Acc: 0.5405
 Site-USPS      | Val  Loss: 1.8043 | Val  Acc: 0.5541
 Site-SynthDigits| Val  Loss: 2.0855 | Val  Acc: 0.3378
 Site-SynthDigits| Val  Loss: 2.1060 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.2033 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1898 | Val  Acc: 0.2027
Average Valid Accuracy: 0.3142
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2432
 Best site-USPS       | Epoch:0 | Val Acc: 0.5405
 Best site-USPS       | Epoch:0 | Val Acc: 0.5541
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3378
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.0787 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 2.0884 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 1.3596 | Train Acc: 0.7748
 Site-USPS      | Train Loss: 1.4078 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 1.8483 | Train Acc: 0.4505
 Site-SynthDigits| Train Loss: 1.9136 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 2.0353 | Train Acc: 0.2883
 Site-MNIST-M   | Train Loss: 2.0469 | Train Acc: 0.3423
 Site-SVHN      | Val  Loss: 2.1158 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 2.0606 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 1.3786 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 1.3838 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 1.8977 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 1.8696 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 2.0241 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 2.0481 | Val  Acc: 0.2703
Average Valid Accuracy: 0.4662
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3784
 Best site-USPS       | Epoch:1 | Val Acc: 0.7568
 Best site-USPS       | Epoch:1 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 1.9381 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 1.9068 | Train Acc: 0.3694
 Site-USPS      | Train Loss: 0.9809 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 1.0361 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 1.5868 | Train Acc: 0.5405
 Site-SynthDigits| Train Loss: 1.6522 | Train Acc: 0.4505
 Site-MNIST-M   | Train Loss: 1.8496 | Train Acc: 0.4054
 Site-MNIST-M   | Train Loss: 1.8757 | Train Acc: 0.4234
 Site-SVHN      | Val  Loss: 1.9557 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.8611 | Val  Acc: 0.4324
 Site-USPS      | Val  Loss: 0.9978 | Val  Acc: 0.7703
 Site-USPS      | Val  Loss: 1.0242 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.6212 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 1.6389 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.8784 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 1.8258 | Val  Acc: 0.4595
Average Valid Accuracy: 0.5203
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4324
 Best site-USPS       | Epoch:2 | Val Acc: 0.7703
 Best site-USPS       | Epoch:2 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 1.7147 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 1.6421 | Train Acc: 0.4775
 Site-USPS      | Train Loss: 0.6522 | Train Acc: 0.8288
 Site-USPS      | Train Loss: 0.7610 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.3243 | Train Acc: 0.5495
 Site-SynthDigits| Train Loss: 1.3749 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.6424 | Train Acc: 0.4775
 Site-MNIST-M   | Train Loss: 1.7351 | Train Acc: 0.4685
 Site-SVHN      | Val  Loss: 1.7000 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.6430 | Val  Acc: 0.4189
 Site-USPS      | Val  Loss: 0.7417 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.7045 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.3144 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 1.4343 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.7123 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.6256 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5608
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4189
 Best site-USPS       | Epoch:3 | Val Acc: 0.7568
 Best site-USPS       | Epoch:3 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.5185 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 1.4440 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 0.3900 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.4585 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.1209 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 1.1467 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.3448 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.4763 | Train Acc: 0.5225
 Site-SVHN      | Val  Loss: 1.4928 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.4968 | Val  Acc: 0.4595
 Site-USPS      | Val  Loss: 0.4614 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.3942 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.1298 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 1.1812 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4036 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.3892 | Val  Acc: 0.5811
Average Valid Accuracy: 0.6351
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4595
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-USPS       | Epoch:4 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.2605 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 1.2533 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 0.3705 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.4206 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.8998 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 0.8524 | Train Acc: 0.7387
 Site-MNIST-M   | Train Loss: 1.0148 | Train Acc: 0.7748
 Site-MNIST-M   | Train Loss: 1.0739 | Train Acc: 0.7117
 Site-SVHN      | Val  Loss: 1.3245 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 1.2105 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 0.4224 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.3642 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.8466 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.9038 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 1.0371 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 0.9750 | Val  Acc: 0.7703
Average Valid Accuracy: 0.7416
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5676
 Best site-USPS       | Epoch:5 | Val Acc: 0.8514
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.1760 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.1725 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.3184 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3454 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.8170 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.8343 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 0.8759 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 0.9872 | Train Acc: 0.7297
 Site-SVHN      | Val  Loss: 1.2069 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 1.2015 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 0.3329 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.3183 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.8200 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 0.8682 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 0.9178 | Val  Acc: 0.7432
 Site-MNIST-M   | Val  Loss: 0.9017 | Val  Acc: 0.7703
Average Valid Accuracy: 0.7534
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6081
 Best site-USPS       | Epoch:6 | Val Acc: 0.8919
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7432
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 0.9531 | Train Acc: 0.6937
 Site-SVHN      | Train Loss: 0.9334 | Train Acc: 0.7477
 Site-USPS      | Train Loss: 0.2971 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3061 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.5612 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.4758 | Train Acc: 0.9009
 Site-MNIST-M   | Train Loss: 0.5349 | Train Acc: 0.9009
 Site-MNIST-M   | Train Loss: 0.6252 | Train Acc: 0.8739
 Site-SVHN      | Val  Loss: 1.0028 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 0.9105 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 0.3008 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.2753 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.4597 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.5168 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 0.5867 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 0.5589 | Val  Acc: 0.9189
Average Valid Accuracy: 0.8530
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7297
 Best site-USPS       | Epoch:7 | Val Acc: 0.8919
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 0.9222 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 0.8561 | Train Acc: 0.8018
 Site-USPS      | Train Loss: 0.2425 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.2380 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.5833 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.5432 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 0.4613 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 0.5675 | Train Acc: 0.9009
 Site-SVHN      | Val  Loss: 0.9043 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 0.8976 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.2297 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.2266 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.5610 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 0.5724 | Val  Acc: 0.8514
 Site-MNIST-M   | Val  Loss: 0.5275 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.4956 | Val  Acc: 0.9189
Average Valid Accuracy: 0.8547
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7568
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8514
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 0.5875 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 0.5704 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.2134 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.1820 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.3169 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.2438 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.2344 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.3211 | Train Acc: 0.9640
 Site-SVHN      | Val  Loss: 0.6290 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 0.5439 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.1677 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.1845 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.2437 | Val  Acc: 0.9865
 Site-SynthDigits| Val  Loss: 0.2689 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.2871 | Val  Acc: 0.9730
 Site-MNIST-M   | Val  Loss: 0.2840 | Val  Acc: 0.9730
Average Valid Accuracy: 0.9392
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8919
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-USPS       | Epoch:9 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9865
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST...
===2023-03-26 13:59:19===
===2023-03-26 13:59:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 4
Loading snapshots...
Test Accuracy of MNIST: 0.7221
Average Test Accuracy: 0.7221
