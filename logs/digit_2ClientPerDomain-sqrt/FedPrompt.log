===2023-03-25 00:26:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
===2023-03-25 00:26:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
===2023-03-25 00:26:22===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
===2023-03-25 00:27:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7379 | Train Acc: 0.5045
 Site-MNIST     | Train Loss: 1.7581 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 1.9840 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 2.0327 | Train Acc: 0.3333
 Site-USPS      | Train Loss: 1.6640 | Train Acc: 0.6937
 Site-USPS      | Train Loss: 1.7153 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 1.9835 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 2.0326 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.1935 | Train Acc: 0.1712
 Site-MNIST-M   | Train Loss: 2.1935 | Train Acc: 0.2432
 Site-MNIST     | Val  Loss: 1.7718 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.6780 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 2.0435 | Val  Acc: 0.2838
 Site-SVHN      | Val  Loss: 1.9718 | Val  Acc: 0.4324
 Site-USPS      | Val  Loss: 1.6976 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 1.6839 | Val  Acc: 0.7162
 Site-SynthDigits| Val  Loss: 2.0435 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 1.9718 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 2.1980 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1833 | Val  Acc: 0.1892
Average Valid Accuracy: 0.4324
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2838
 Best site-SVHN       | Epoch:0 | Val Acc: 0.4324
 Best site-USPS       | Epoch:0 | Val Acc: 0.6757
 Best site-USPS       | Epoch:0 | Val Acc: 0.7162
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3150 | Train Acc: 0.5856
 Site-MNIST     | Train Loss: 1.3825 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 1.6091 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 1.6858 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 1.2110 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 1.2825 | Train Acc: 0.7117
 Site-SynthDigits| Train Loss: 1.6083 | Train Acc: 0.6036
 Site-SynthDigits| Train Loss: 1.6831 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 2.0367 | Train Acc: 0.2523
 Site-MNIST-M   | Train Loss: 2.0640 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 1.4205 | Val  Acc: 0.5405
 Site-MNIST     | Val  Loss: 1.2468 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 1.7058 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6190 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.2439 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 1.2519 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.7058 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.6190 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 2.0701 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.0344 | Val  Acc: 0.2838
Average Valid Accuracy: 0.5459
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5405
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5676
 Best site-USPS       | Epoch:1 | Val Acc: 0.6892
 Best site-USPS       | Epoch:1 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8406 | Train Acc: 0.7477
 Site-MNIST     | Train Loss: 0.9366 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 1.2776 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.3059 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 0.7192 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.7852 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.2790 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.3078 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.7662 | Train Acc: 0.4414
 Site-MNIST-M   | Train Loss: 1.8373 | Train Acc: 0.3964
 Site-MNIST     | Val  Loss: 0.9627 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.8215 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 1.3654 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 1.2299 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 0.7677 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.7587 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.3654 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 1.2299 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 1.8299 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 1.7621 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6608
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:2 | Val Acc: 0.6486
 Best site-USPS       | Epoch:2 | Val Acc: 0.8243
 Best site-USPS       | Epoch:2 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6218 | Train Acc: 0.7928
 Site-MNIST     | Train Loss: 0.7354 | Train Acc: 0.7658
 Site-SVHN      | Train Loss: 0.9206 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 0.9454 | Train Acc: 0.7658
 Site-USPS      | Train Loss: 0.5752 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.6584 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 0.9230 | Train Acc: 0.7477
 Site-SynthDigits| Train Loss: 0.9421 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 1.5789 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 1.5913 | Train Acc: 0.4955
 Site-MNIST     | Val  Loss: 0.7590 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 0.6505 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 0.9797 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 0.9058 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 0.6405 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.6200 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 0.9797 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.9058 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 1.5886 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.5324 | Val  Acc: 0.4730
Average Valid Accuracy: 0.7162
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:3 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:3 | Val Acc: 0.7297
 Best site-USPS       | Epoch:3 | Val Acc: 0.7973
 Best site-USPS       | Epoch:3 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3898 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.4908 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 0.7997 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 0.7874 | Train Acc: 0.7477
 Site-USPS      | Train Loss: 0.4118 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.4537 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.7992 | Train Acc: 0.7477
 Site-SynthDigits| Train Loss: 0.7889 | Train Acc: 0.7477
 Site-MNIST-M   | Train Loss: 1.2670 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.3756 | Train Acc: 0.5315
 Site-MNIST     | Val  Loss: 0.4676 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.4596 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 0.8654 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 0.7210 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.4333 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.4365 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.8654 | Val  Acc: 0.7162
 Site-SynthDigits| Val  Loss: 0.7210 | Val  Acc: 0.7568
 Site-MNIST-M   | Val  Loss: 1.3497 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.2501 | Val  Acc: 0.6216
Average Valid Accuracy: 0.7635
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:4 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:4 | Val Acc: 0.7568
 Best site-USPS       | Epoch:4 | Val Acc: 0.8919
 Best site-USPS       | Epoch:4 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.7162
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.7568
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3490 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.4077 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 0.4588 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 0.4670 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3974 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.4631 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.4601 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.4697 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 1.0278 | Train Acc: 0.7207
 Site-MNIST-M   | Train Loss: 1.0747 | Train Acc: 0.6757
 Site-MNIST     | Val  Loss: 0.4015 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.4119 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 0.5034 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 0.4482 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.4237 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.4497 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.5034 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.4482 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 1.0514 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 1.0176 | Val  Acc: 0.7297
Average Valid Accuracy: 0.8527
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:5 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:5 | Val Acc: 0.9054
 Best site-USPS       | Epoch:5 | Val Acc: 0.8649
 Best site-USPS       | Epoch:5 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2615 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.3088 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 0.4628 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 0.4242 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.3389 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.3660 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.4620 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.4244 | Train Acc: 0.9279
 Site-MNIST-M   | Train Loss: 0.8030 | Train Acc: 0.7928
 Site-MNIST-M   | Train Loss: 0.8341 | Train Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.2867 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.3182 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 0.4810 | Val  Acc: 0.9324
 Site-SVHN      | Val  Loss: 0.4056 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.3317 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.3671 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.4810 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.4056 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 0.8286 | Val  Acc: 0.7838
 Site-MNIST-M   | Val  Loss: 0.7551 | Val  Acc: 0.8243
Average Valid Accuracy: 0.8892
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:6 | Val Acc: 0.9324
 Best site-SVHN       | Epoch:6 | Val Acc: 0.8919
 Best site-USPS       | Epoch:6 | Val Acc: 0.9054
 Best site-USPS       | Epoch:6 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7838
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2244 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2584 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 0.2288 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.2136 | Train Acc: 0.9910
 Site-USPS      | Train Loss: 0.3076 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.3513 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.2293 | Train Acc: 0.9910
 Site-SynthDigits| Train Loss: 0.2133 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.6038 | Train Acc: 0.8649
 Site-MNIST-M   | Train Loss: 0.6997 | Train Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.2484 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.2733 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 0.2283 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2266 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.2945 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.3733 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.2283 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2266 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.6634 | Val  Acc: 0.8378
 Site-MNIST-M   | Val  Loss: 0.6512 | Val  Acc: 0.8243
Average Valid Accuracy: 0.9284
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:7 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.9865
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-USPS       | Epoch:7 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:7 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8378
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1301 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1546 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.2095 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.2112 | Train Acc: 0.9910
 Site-USPS      | Train Loss: 0.2309 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.2127 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.2091 | Train Acc: 0.9910
 Site-SynthDigits| Train Loss: 0.2105 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.4115 | Train Acc: 0.9189
 Site-MNIST-M   | Train Loss: 0.5019 | Train Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.1447 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1609 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.2413 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.1971 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1687 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2602 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2413 | Val  Acc: 0.9865
 Site-SynthDigits| Val  Loss: 0.1971 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4726 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.4508 | Val  Acc: 0.9054
Average Valid Accuracy: 0.9608
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:8 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:8 | Val Acc: 1.0000
 Best site-USPS       | Epoch:8 | Val Acc: 0.9459
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9865
 Best site-SynthDigits | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1509 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1475 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 0.1204 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1148 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.2444 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.2442 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.1204 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1150 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.3342 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 0.4112 | Train Acc: 0.9099
 Site-MNIST     | Val  Loss: 0.1396 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.1668 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 0.1192 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1245 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1757 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.3117 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.1192 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1245 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3830 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.3809 | Val  Acc: 0.9054
Average Valid Accuracy: 0.9595
===2023-03-25 01:10:27===
===2023-03-25 01:10:28===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3Loading snapshots...
 Test site-MNIST     | Epoch:8 | Test Acc: 0.8664
 Test site-SVHN      | Epoch:8 | Test Acc: 0.6570
 Test site-USPS      | Epoch:8 | Test Acc: 0.8710
 Test site-SynthDigits| Epoch:8 | Test Acc: 0.6570
 Test site-MNIST-M   | Epoch:8 | Test Acc: 0.4264
Average Test Accuracy: 0.6956
===2023-03-25 11:19:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7852 | Train Acc: 0.5315
 Site-MNIST     | Train Loss: 1.7899 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 2.2108 | Train Acc: 0.1532
 Site-SVHN      | Train Loss: 2.2337 | Train Acc: 0.2072
 Site-USPS      | Train Loss: 1.7195 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 1.7728 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 2.0939 | Train Acc: 0.2432
 Site-SynthDigits| Train Loss: 2.1240 | Train Acc: 0.2342
 Site-MNIST-M   | Train Loss: 2.1956 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.1884 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.7955 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.7305 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 2.2707 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.1957 | Val  Acc: 0.2027
 Site-USPS      | Val  Loss: 1.7512 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 1.7434 | Val  Acc: 0.6892
 Site-SynthDigits| Val  Loss: 2.1178 | Val  Acc: 0.2297
 Site-SynthDigits| Val  Loss: 2.1002 | Val  Acc: 0.2297
 Site-MNIST-M   | Val  Loss: 2.1894 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1783 | Val  Acc: 0.1757
Average Valid Accuracy: 0.3676
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-USPS       | Epoch:0 | Val Acc: 0.6486
 Best site-USPS       | Epoch:0 | Val Acc: 0.6892
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2297
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2297
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3464 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.3811 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 2.1048 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1253 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.2464 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 1.3090 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.8758 | Train Acc: 0.3694
 Site-SynthDigits| Train Loss: 1.9161 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 2.0461 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.0159 | Train Acc: 0.3063
 Site-MNIST     | Val  Loss: 1.3927 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.2853 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 2.1728 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.0780 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 1.3034 | Val  Acc: 0.7838
 Site-USPS      | Val  Loss: 1.2713 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.9170 | Val  Acc: 0.3378
 Site-SynthDigits| Val  Loss: 1.8811 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 1.9947 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.0350 | Val  Acc: 0.2703
Average Valid Accuracy: 0.4946
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2703
 Best site-USPS       | Epoch:1 | Val Acc: 0.7838
 Best site-USPS       | Epoch:1 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3378
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0483 | Train Acc: 0.7207
 Site-MNIST     | Train Loss: 1.1244 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 2.0246 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 2.0145 | Train Acc: 0.3063
 Site-USPS      | Train Loss: 0.8684 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.9486 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.6165 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 1.6460 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 1.8587 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 1.8245 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 1.1726 | Val  Acc: 0.6622
 Site-MNIST     | Val  Loss: 0.9940 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 2.1449 | Val  Acc: 0.2162
 Site-SVHN      | Val  Loss: 1.8447 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 0.9481 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 0.9044 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.6492 | Val  Acc: 0.4865
 Site-SynthDigits| Val  Loss: 1.6313 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.8295 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 1.8083 | Val  Acc: 0.4189
Average Valid Accuracy: 0.5446
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6622
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2162
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8108
 Best site-USPS       | Epoch:2 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6482 | Train Acc: 0.7928
 Site-MNIST     | Train Loss: 0.7407 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 1.7762 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.8032 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.5068 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.5602 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.4263 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 1.4058 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 1.5690 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.6143 | Train Acc: 0.4865
 Site-MNIST     | Val  Loss: 0.7505 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 0.6582 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 1.8749 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.7264 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.5699 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.5247 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.4380 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 1.4060 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.5710 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5569 | Val  Acc: 0.5811
Average Valid Accuracy: 0.6230
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3784
 Best site-USPS       | Epoch:3 | Val Acc: 0.8649
 Best site-USPS       | Epoch:3 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.5131 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.6298 | Train Acc: 0.8288
 Site-SVHN      | Train Loss: 1.5694 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.6362 | Train Acc: 0.4685
 Site-USPS      | Train Loss: 0.4118 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.4719 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.1058 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.0925 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.2862 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.3963 | Train Acc: 0.5586
 Site-MNIST     | Val  Loss: 0.6560 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 0.5457 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.7096 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.5505 | Val  Acc: 0.4595
 Site-USPS      | Val  Loss: 0.4739 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.4259 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.1017 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 1.1118 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.3570 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.3002 | Val  Acc: 0.6216
Average Valid Accuracy: 0.6878
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4595
 Best site-USPS       | Epoch:4 | Val Acc: 0.8919
 Best site-USPS       | Epoch:4 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3082 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.3709 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.5225 | Train Acc: 0.3964
 Site-SVHN      | Train Loss: 1.6035 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.3165 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3572 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.0129 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 0.9647 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.1072 | Train Acc: 0.6847
 Site-MNIST-M   | Train Loss: 1.2309 | Train Acc: 0.6216
 Site-MNIST     | Val  Loss: 0.3399 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.3598 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.7018 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.5009 | Val  Acc: 0.4324
 Site-USPS      | Val  Loss: 0.3565 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.3199 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.0222 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 0.9284 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.1989 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.1083 | Val  Acc: 0.7027
Average Valid Accuracy: 0.7108
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4324
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-USPS       | Epoch:5 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2606 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.2978 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.1982 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.3532 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.2701 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2776 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.7432 | Train Acc: 0.7477
 Site-SynthDigits| Train Loss: 0.7419 | Train Acc: 0.7748
 Site-MNIST-M   | Train Loss: 0.9063 | Train Acc: 0.7387
 Site-MNIST-M   | Train Loss: 0.9986 | Train Acc: 0.7207
 Site-MNIST     | Val  Loss: 0.2810 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.2976 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.4030 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.2327 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.2628 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2705 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.7764 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.7243 | Val  Acc: 0.7838
 Site-MNIST-M   | Val  Loss: 0.9537 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 0.9059 | Val  Acc: 0.7703
Average Valid Accuracy: 0.7932
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-USPS       | Epoch:6 | Val Acc: 0.9459
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7838
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1830 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2056 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 1.0307 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 1.0961 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 0.2298 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2388 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.6477 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 0.6069 | Train Acc: 0.8288
 Site-MNIST-M   | Train Loss: 0.5882 | Train Acc: 0.8829
 Site-MNIST-M   | Train Loss: 0.7664 | Train Acc: 0.7748
 Site-MNIST     | Val  Loss: 0.1779 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.2150 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.1739 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 1.0230 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 0.2161 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2390 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.6527 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 0.5824 | Val  Acc: 0.8108
 Site-MNIST-M   | Val  Loss: 0.7272 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.6587 | Val  Acc: 0.8649
Average Valid Accuracy: 0.8324
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6757
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8108
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1516 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.1649 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.9253 | Train Acc: 0.7297
 Site-SVHN      | Train Loss: 0.9634 | Train Acc: 0.7387
 Site-USPS      | Train Loss: 0.1810 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.1777 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.4900 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.5130 | Train Acc: 0.8829
 Site-MNIST-M   | Train Loss: 0.5256 | Train Acc: 0.8829
 Site-MNIST-M   | Train Loss: 0.6255 | Train Acc: 0.7928
 Site-MNIST     | Val  Loss: 0.1451 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1792 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.0347 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 0.8941 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.1717 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.1705 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.5630 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.4770 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 0.5968 | Val  Acc: 0.7838
 Site-MNIST-M   | Val  Loss: 0.5584 | Val  Acc: 0.8514
Average Valid Accuracy: 0.8689
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7568
 Best site-USPS       | Epoch:8 | Val Acc: 0.9595
 Best site-USPS       | Epoch:8 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.7838
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1136 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1132 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.6629 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 0.7797 | Train Acc: 0.7568
 Site-USPS      | Train Loss: 0.1860 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.1536 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.4111 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.3604 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 0.3120 | Train Acc: 0.9550
 Site-MNIST-M   | Train Loss: 0.4209 | Train Acc: 0.9009
 Site-MNIST     | Val  Loss: 0.1036 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1182 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.8216 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 0.6863 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 0.1305 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1859 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.3850 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.3694 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.3904 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.3646 | Val  Acc: 0.9189
Average Valid Accuracy: 0.9149
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8108
 Best site-USPS       | Epoch:9 | Val Acc: 0.9730
 Best site-USPS       | Epoch:9 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/FedPrompt...
===2023-03-25 12:02:45===
===2023-03-25 12:02:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8771
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3844
 Test site-USPS      | Epoch:9 | Test Acc: 0.8710
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6780
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4357
Average Test Accuracy: 0.6492
