===2023-03-25 12:06:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7684 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.7748 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 2.1970 | Train Acc: 0.1532
 Site-SVHN      | Train Loss: 2.2216 | Train Acc: 0.1982
 Site-USPS      | Train Loss: 1.6619 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 1.7320 | Train Acc: 0.7117
 Site-SynthDigits| Train Loss: 2.0674 | Train Acc: 0.2973
 Site-SynthDigits| Train Loss: 2.0877 | Train Acc: 0.2793
 Site-MNIST-M   | Train Loss: 2.1995 | Train Acc: 0.1712
 Site-MNIST-M   | Train Loss: 2.1807 | Train Acc: 0.2252
 Site-MNIST     | Val  Loss: 1.7814 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.7127 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 2.2634 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.1826 | Val  Acc: 0.1622
 Site-USPS      | Val  Loss: 1.7071 | Val  Acc: 0.7432
 Site-USPS      | Val  Loss: 1.7009 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 2.0941 | Val  Acc: 0.2432
 Site-SynthDigits| Val  Loss: 2.0510 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.1784 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.1896 | Val  Acc: 0.1486
Average Valid Accuracy: 0.3919
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1622
 Best site-USPS       | Epoch:0 | Val Acc: 0.7432
 Best site-USPS       | Epoch:0 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2432
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2247 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 1.2924 | Train Acc: 0.7658
 Site-SVHN      | Train Loss: 2.0925 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.1052 | Train Acc: 0.2613
 Site-USPS      | Train Loss: 1.1258 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 1.2195 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.8014 | Train Acc: 0.4144
 Site-SynthDigits| Train Loss: 1.8209 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 2.0302 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.0374 | Train Acc: 0.3153
 Site-MNIST     | Val  Loss: 1.3010 | Val  Acc: 0.7432
 Site-MNIST     | Val  Loss: 1.1942 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 2.1704 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0541 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 1.2039 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 1.1775 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.8274 | Val  Acc: 0.3649
 Site-SynthDigits| Val  Loss: 1.7696 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.0252 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.0286 | Val  Acc: 0.2568
Average Valid Accuracy: 0.5135
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7432
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-USPS       | Epoch:1 | Val Acc: 0.7973
 Best site-USPS       | Epoch:1 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3649
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8987 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 0.9496 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 1.9482 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.9959 | Train Acc: 0.3243
 Site-USPS      | Train Loss: 0.7488 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.8178 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.6491 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.6713 | Train Acc: 0.4685
 Site-MNIST-M   | Train Loss: 1.8021 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.8126 | Train Acc: 0.4505
 Site-MNIST     | Val  Loss: 0.9449 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 0.8712 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 2.0361 | Val  Acc: 0.2838
 Site-SVHN      | Val  Loss: 1.9412 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 0.8060 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.7852 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.6698 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 1.6411 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.7765 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.8152 | Val  Acc: 0.4324
Average Valid Accuracy: 0.5824
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3514
 Best site-USPS       | Epoch:2 | Val Acc: 0.8919
 Best site-USPS       | Epoch:2 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6329 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 0.6795 | Train Acc: 0.8468
 Site-SVHN      | Train Loss: 1.9220 | Train Acc: 0.2613
 Site-SVHN      | Train Loss: 1.8697 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 0.5319 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.6039 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.3608 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 1.3768 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.5714 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.6484 | Train Acc: 0.4955
 Site-MNIST     | Val  Loss: 0.6840 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.6217 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.9549 | Val  Acc: 0.3243
 Site-SVHN      | Val  Loss: 1.8528 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 0.5805 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.5752 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.3684 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 1.3441 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.6186 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5933 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6270
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3243
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2838
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-USPS       | Epoch:3 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4061 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.4473 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.6681 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.6959 | Train Acc: 0.4505
 Site-USPS      | Train Loss: 0.3946 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.4392 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.2235 | Train Acc: 0.6036
 Site-SynthDigits| Train Loss: 1.2328 | Train Acc: 0.5856
 Site-MNIST-M   | Train Loss: 1.3070 | Train Acc: 0.6036
 Site-MNIST-M   | Train Loss: 1.3683 | Train Acc: 0.5676
 Site-MNIST     | Val  Loss: 0.4377 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.4133 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.7904 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.6002 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.4153 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.4254 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.2452 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 1.1806 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.3558 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.2787 | Val  Acc: 0.5676
Average Valid Accuracy: 0.6865
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4459
 Best site-USPS       | Epoch:4 | Val Acc: 0.9189
 Best site-USPS       | Epoch:4 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2778 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.3110 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 1.6049 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.6551 | Train Acc: 0.4505
 Site-USPS      | Train Loss: 0.3044 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.3425 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 1.0956 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 1.0796 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.1203 | Train Acc: 0.6757
 Site-MNIST-M   | Train Loss: 1.1806 | Train Acc: 0.5946
 Site-MNIST     | Val  Loss: 0.2899 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.2967 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.7838 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.5466 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.3248 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.3255 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.1401 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 0.9797 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 1.1786 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.0788 | Val  Acc: 0.6622
Average Valid Accuracy: 0.7108
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4459
 Best site-USPS       | Epoch:5 | Val Acc: 0.9324
 Best site-USPS       | Epoch:5 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2035 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.2315 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 1.4198 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.4346 | Train Acc: 0.5315
 Site-USPS      | Train Loss: 0.2596 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.2749 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.9001 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 0.8704 | Train Acc: 0.7207
 Site-MNIST-M   | Train Loss: 0.8707 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 0.9290 | Train Acc: 0.7748
 Site-MNIST     | Val  Loss: 0.2124 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.2327 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.5665 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.3328 | Val  Acc: 0.5270
 Site-USPS      | Val  Loss: 0.2577 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2699 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.9197 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 0.8074 | Val  Acc: 0.7432
 Site-MNIST-M   | Val  Loss: 0.9430 | Val  Acc: 0.7838
 Site-MNIST-M   | Val  Loss: 0.8207 | Val  Acc: 0.7973
Average Valid Accuracy: 0.7811
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5270
 Best site-USPS       | Epoch:6 | Val Acc: 0.9459
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7432
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7838
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1304 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1516 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 1.2037 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 1.2766 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 0.2022 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.1945 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.8258 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 0.8086 | Train Acc: 0.7387
 Site-MNIST-M   | Train Loss: 0.6524 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.6893 | Train Acc: 0.8559
 Site-MNIST     | Val  Loss: 0.1361 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1498 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 1.3969 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.1893 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 0.1826 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2010 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.8658 | Val  Acc: 0.7162
 Site-SynthDigits| Val  Loss: 0.7328 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.6959 | Val  Acc: 0.8514
 Site-MNIST-M   | Val  Loss: 0.6027 | Val  Acc: 0.8919
Average Valid Accuracy: 0.8216
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5676
 Best site-USPS       | Epoch:7 | Val Acc: 0.9459
 Best site-USPS       | Epoch:7 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7162
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8514
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0990 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1219 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 1.0654 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 1.1434 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 0.1949 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.1773 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.6147 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 0.6075 | Train Acc: 0.8198
 Site-MNIST-M   | Train Loss: 0.5015 | Train Acc: 0.9279
 Site-MNIST-M   | Train Loss: 0.5680 | Train Acc: 0.8829
 Site-MNIST     | Val  Loss: 0.1059 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1233 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 1.2539 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.0191 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 0.1738 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.1781 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.6686 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 0.5271 | Val  Acc: 0.8243
 Site-MNIST-M   | Val  Loss: 0.5703 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 0.4834 | Val  Acc: 0.9189
Average Valid Accuracy: 0.8500
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6486
 Best site-USPS       | Epoch:8 | Val Acc: 0.9459
 Best site-USPS       | Epoch:8 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8243
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0684 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0898 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.8347 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 0.7884 | Train Acc: 0.7477
 Site-USPS      | Train Loss: 0.1523 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1197 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.5343 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.4978 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 0.3456 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.3959 | Train Acc: 0.9369
 Site-MNIST     | Val  Loss: 0.0827 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0877 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8583 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 0.7372 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.1090 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1370 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.5283 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 0.4618 | Val  Acc: 0.8378
 Site-MNIST-M   | Val  Loss: 0.4087 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.3251 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8243
 Best site-USPS       | Epoch:9 | Val Acc: 0.9865
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8378
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain-sqrt/CoCoOP...
===2023-03-25 12:47:23===
===2023-03-25 12:47:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8636
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3053
 Test site-USPS      | Epoch:9 | Test Acc: 0.8925
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5802
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3600
Average Test Accuracy: 0.6003
