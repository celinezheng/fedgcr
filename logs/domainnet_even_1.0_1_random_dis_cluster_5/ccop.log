===2023-07-31 06:00:22===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[315,945,315,945,315,945,315,945,315,945,315,945,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (4) | Train Loss: 1.7635 | Train Acc: 0.5397
 Site-Clipart                   (4) | Train Loss: 1.7967 | Train Acc: 0.5386
 Site-Real                      (0) | Train Loss: 1.6298 | Train Acc: 0.6857
 Site-Real                      (0) | Train Loss: 1.6618 | Train Acc: 0.6381
 Site-Painting                  (0) | Train Loss: 1.7272 | Train Acc: 0.5587
 Site-Painting                  (0) | Train Loss: 1.6906 | Train Acc: 0.6222
 Site-Sketch                    (1) | Train Loss: 1.7192 | Train Acc: 0.5873
 Site-Sketch                    (1) | Train Loss: 1.7448 | Train Acc: 0.5630
 Site-QuickDraw                 (2) | Train Loss: 2.2019 | Train Acc: 0.2667
 Site-QuickDraw                 (2) | Train Loss: 2.1747 | Train Acc: 0.2741
 Site-Infograph                 (3) | Train Loss: 2.0836 | Train Acc: 0.3270
 Site-Infograph                 (3) | Train Loss: 2.0653 | Train Acc: 0.3164
Average Train Accuracy: 0.4931
 Site-Clipart                   (4) | Val  Loss: 1.8569 | Val  Acc: 0.4810
 Site-Clipart                   (4) | Val  Loss: 1.8031 | Val  Acc: 0.5159
 Site-Real                      (0) | Val  Loss: 1.7176 | Val  Acc: 0.6524
 Site-Real                      (0) | Val  Loss: 1.6707 | Val  Acc: 0.6429
 Site-Painting                  (0) | Val  Loss: 1.7120 | Val  Acc: 0.6143
 Site-Painting                  (0) | Val  Loss: 1.7128 | Val  Acc: 0.5952
 Site-Sketch                    (1) | Val  Loss: 1.8190 | Val  Acc: 0.5381
 Site-Sketch                    (1) | Val  Loss: 1.7484 | Val  Acc: 0.5587
 Site-QuickDraw                 (2) | Val  Loss: 2.1838 | Val  Acc: 0.2810
 Site-QuickDraw                 (2) | Val  Loss: 2.1778 | Val  Acc: 0.2905
 Site-Infograph                 (3) | Val  Loss: 2.0753 | Val  Acc: 0.3000
 Site-Infograph                 (3) | Val  Loss: 2.0723 | Val  Acc: 0.2968
Average Valid Accuracy: 0.4806
 Best site-Clipart                  (4)  | Epoch:0 | Val Acc: 0.4810
 Best site-Clipart                  (4)  | Epoch:0 | Val Acc: 0.5159
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6524
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6429
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.6143
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.5952
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.5381
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.5587
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.2810
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.2905
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.3000
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2968
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 1 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.2847 | Train Acc: 0.7016
 Site-Clipart                   (0) | Train Loss: 1.3294 | Train Acc: 0.6952
 Site-Real                      (4) | Train Loss: 1.0054 | Train Acc: 0.8698
 Site-Real                      (4) | Train Loss: 1.0297 | Train Acc: 0.8614
 Site-Painting                  (2) | Train Loss: 1.1269 | Train Acc: 0.7810
 Site-Painting                  (2) | Train Loss: 1.0963 | Train Acc: 0.8032
 Site-Sketch                    (0) | Train Loss: 1.2125 | Train Acc: 0.7206
 Site-Sketch                    (0) | Train Loss: 1.2381 | Train Acc: 0.6899
 Site-QuickDraw                 (1) | Train Loss: 2.0471 | Train Acc: 0.3238
 Site-QuickDraw                 (1) | Train Loss: 1.9953 | Train Acc: 0.3471
 Site-Infograph                 (3) | Train Loss: 1.7809 | Train Acc: 0.4698
 Site-Infograph                 (3) | Train Loss: 1.7764 | Train Acc: 0.4476
Average Train Accuracy: 0.6426
 Site-Clipart                   (0) | Val  Loss: 1.3534 | Val  Acc: 0.6952
 Site-Clipart                   (0) | Val  Loss: 1.3389 | Val  Acc: 0.6825
 Site-Real                      (4) | Val  Loss: 1.1529 | Val  Acc: 0.8381
 Site-Real                      (4) | Val  Loss: 1.0491 | Val  Acc: 0.8524
 Site-Painting                  (2) | Val  Loss: 1.1322 | Val  Acc: 0.7857
 Site-Painting                  (2) | Val  Loss: 1.1144 | Val  Acc: 0.7825
 Site-Sketch                    (0) | Val  Loss: 1.2747 | Val  Acc: 0.7095
 Site-Sketch                    (0) | Val  Loss: 1.2439 | Val  Acc: 0.6857
 Site-QuickDraw                 (1) | Val  Loss: 1.9739 | Val  Acc: 0.3619
 Site-QuickDraw                 (1) | Val  Loss: 1.9917 | Val  Acc: 0.3508
 Site-Infograph                 (3) | Val  Loss: 1.7839 | Val  Acc: 0.4857
 Site-Infograph                 (3) | Val  Loss: 1.8050 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6385
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.6952
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.6825
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.8381
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.8524
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.7857
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.7825
 Best site-Sketch                   (0)  | Epoch:1 | Val Acc: 0.7095
 Best site-Sketch                   (0)  | Epoch:1 | Val Acc: 0.6857
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.3619
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.3508
 Best site-Infograph                (3)  | Epoch:1 | Val Acc: 0.4857
 Best site-Infograph                (3)  | Epoch:1 | Val Acc: 0.4317
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 4, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (1) | Train Loss: 0.9821 | Train Acc: 0.8095
 Site-Clipart                   (1) | Train Loss: 1.0326 | Train Acc: 0.7820
 Site-Real                      (0) | Train Loss: 0.7628 | Train Acc: 0.8889
 Site-Real                      (0) | Train Loss: 0.7806 | Train Acc: 0.8899
 Site-Painting                  (3) | Train Loss: 0.9032 | Train Acc: 0.7810
 Site-Painting                  (3) | Train Loss: 0.8729 | Train Acc: 0.8127
 Site-Sketch                    (1) | Train Loss: 0.9741 | Train Acc: 0.7524
 Site-Sketch                    (1) | Train Loss: 0.9908 | Train Acc: 0.7481
 Site-QuickDraw                 (2) | Train Loss: 1.7743 | Train Acc: 0.4476
 Site-QuickDraw                 (2) | Train Loss: 1.7436 | Train Acc: 0.4772
 Site-Infograph                 (4) | Train Loss: 1.5983 | Train Acc: 0.5111
 Site-Infograph                 (4) | Train Loss: 1.6147 | Train Acc: 0.4857
Average Train Accuracy: 0.6989
 Site-Clipart                   (1) | Val  Loss: 1.0572 | Val  Acc: 0.7810
 Site-Clipart                   (1) | Val  Loss: 1.0225 | Val  Acc: 0.7889
 Site-Real                      (0) | Val  Loss: 0.8610 | Val  Acc: 0.8810
 Site-Real                      (0) | Val  Loss: 0.8029 | Val  Acc: 0.8762
 Site-Painting                  (3) | Val  Loss: 0.9036 | Val  Acc: 0.8000
 Site-Painting                  (3) | Val  Loss: 0.8786 | Val  Acc: 0.8079
 Site-Sketch                    (1) | Val  Loss: 1.0538 | Val  Acc: 0.7667
 Site-Sketch                    (1) | Val  Loss: 0.9895 | Val  Acc: 0.7556
 Site-QuickDraw                 (2) | Val  Loss: 1.7524 | Val  Acc: 0.5048
 Site-QuickDraw                 (2) | Val  Loss: 1.7362 | Val  Acc: 0.4698
 Site-Infograph                 (4) | Val  Loss: 1.5811 | Val  Acc: 0.5000
 Site-Infograph                 (4) | Val  Loss: 1.6364 | Val  Acc: 0.4603
Average Valid Accuracy: 0.6993
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.7810
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.7889
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.8810
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.8762
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.8000
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.8079
 Best site-Sketch                   (1)  | Epoch:2 | Val Acc: 0.7667
 Best site-Sketch                   (1)  | Epoch:2 | Val Acc: 0.7556
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.5048
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.4698
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.4603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (2) | Train Loss: 0.7986 | Train Acc: 0.8413
 Site-Clipart                   (2) | Train Loss: 0.8761 | Train Acc: 0.7788
 Site-Real                      (3) | Train Loss: 0.6297 | Train Acc: 0.8921
 Site-Real                      (3) | Train Loss: 0.6324 | Train Acc: 0.9026
 Site-Painting                  (0) | Train Loss: 0.7861 | Train Acc: 0.8032
 Site-Painting                  (0) | Train Loss: 0.7411 | Train Acc: 0.8286
 Site-Sketch                    (2) | Train Loss: 0.8253 | Train Acc: 0.7714
 Site-Sketch                    (2) | Train Loss: 0.8390 | Train Acc: 0.7873
 Site-QuickDraw                 (1) | Train Loss: 1.5443 | Train Acc: 0.5302
 Site-QuickDraw                 (1) | Train Loss: 1.5150 | Train Acc: 0.5852
 Site-Infograph                 (4) | Train Loss: 1.4715 | Train Acc: 0.5460
 Site-Infograph                 (4) | Train Loss: 1.5032 | Train Acc: 0.5228
Average Train Accuracy: 0.7325
 Site-Clipart                   (2) | Val  Loss: 0.9028 | Val  Acc: 0.8000
 Site-Clipart                   (2) | Val  Loss: 0.8792 | Val  Acc: 0.7968
 Site-Real                      (3) | Val  Loss: 0.7019 | Val  Acc: 0.9238
 Site-Real                      (3) | Val  Loss: 0.6489 | Val  Acc: 0.8968
 Site-Painting                  (0) | Val  Loss: 0.7747 | Val  Acc: 0.8238
 Site-Painting                  (0) | Val  Loss: 0.7459 | Val  Acc: 0.8238
 Site-Sketch                    (2) | Val  Loss: 0.9026 | Val  Acc: 0.7762
 Site-Sketch                    (2) | Val  Loss: 0.8575 | Val  Acc: 0.7762
 Site-QuickDraw                 (1) | Val  Loss: 1.4733 | Val  Acc: 0.6619
 Site-QuickDraw                 (1) | Val  Loss: 1.4889 | Val  Acc: 0.5889
 Site-Infograph                 (4) | Val  Loss: 1.4451 | Val  Acc: 0.5286
 Site-Infograph                 (4) | Val  Loss: 1.4904 | Val  Acc: 0.5159
Average Valid Accuracy: 0.7427
 Best site-Clipart                  (2)  | Epoch:3 | Val Acc: 0.8000
 Best site-Clipart                  (2)  | Epoch:3 | Val Acc: 0.7968
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.9238
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.8968
 Best site-Painting                 (0)  | Epoch:3 | Val Acc: 0.8238
 Best site-Painting                 (0)  | Epoch:3 | Val Acc: 0.8238
 Best site-Sketch                   (2)  | Epoch:3 | Val Acc: 0.7762
 Best site-Sketch                   (2)  | Epoch:3 | Val Acc: 0.7762
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.6619
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.5889
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.5286
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.5159
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 0.7420 | Train Acc: 0.8127
 Site-Clipart                   (0) | Train Loss: 0.7934 | Train Acc: 0.7873
 Site-Real                      (2) | Train Loss: 0.5177 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.5278 | Train Acc: 0.9069
 Site-Painting                  (4) | Train Loss: 0.7140 | Train Acc: 0.8159
 Site-Painting                  (4) | Train Loss: 0.6699 | Train Acc: 0.8360
 Site-Sketch                    (3) | Train Loss: 0.7417 | Train Acc: 0.7841
 Site-Sketch                    (3) | Train Loss: 0.7447 | Train Acc: 0.7905
 Site-QuickDraw                 (1) | Train Loss: 1.4053 | Train Acc: 0.5810
 Site-QuickDraw                 (1) | Train Loss: 1.3372 | Train Acc: 0.6127
 Site-Infograph                 (3) | Train Loss: 1.4121 | Train Acc: 0.5905
 Site-Infograph                 (3) | Train Loss: 1.4396 | Train Acc: 0.5333
Average Train Accuracy: 0.7476
 Site-Clipart                   (0) | Val  Loss: 0.8149 | Val  Acc: 0.8143
 Site-Clipart                   (0) | Val  Loss: 0.7723 | Val  Acc: 0.8111
 Site-Real                      (2) | Val  Loss: 0.6263 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.5416 | Val  Acc: 0.9143
 Site-Painting                  (4) | Val  Loss: 0.7460 | Val  Acc: 0.8000
 Site-Painting                  (4) | Val  Loss: 0.6577 | Val  Acc: 0.8444
 Site-Sketch                    (3) | Val  Loss: 0.7907 | Val  Acc: 0.8000
 Site-Sketch                    (3) | Val  Loss: 0.7396 | Val  Acc: 0.8079
 Site-QuickDraw                 (1) | Val  Loss: 1.2695 | Val  Acc: 0.6905
 Site-QuickDraw                 (1) | Val  Loss: 1.3391 | Val  Acc: 0.6095
 Site-Infograph                 (3) | Val  Loss: 1.3164 | Val  Acc: 0.5714
 Site-Infograph                 (3) | Val  Loss: 1.4399 | Val  Acc: 0.5524
Average Valid Accuracy: 0.7608
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.8143
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.8111
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.9143
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.9143
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.8000
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.8444
 Best site-Sketch                   (3)  | Epoch:4 | Val Acc: 0.8000
 Best site-Sketch                   (3)  | Epoch:4 | Val Acc: 0.8079
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.6095
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.5524
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (2) | Train Loss: 0.6729 | Train Acc: 0.8254
 Site-Clipart                   (2) | Train Loss: 0.7108 | Train Acc: 0.8169
 Site-Real                      (3) | Train Loss: 0.4672 | Train Acc: 0.9143
 Site-Real                      (3) | Train Loss: 0.4872 | Train Acc: 0.9101
 Site-Painting                  (2) | Train Loss: 0.6633 | Train Acc: 0.8063
 Site-Painting                  (2) | Train Loss: 0.5966 | Train Acc: 0.8466
 Site-Sketch                    (4) | Train Loss: 0.7091 | Train Acc: 0.7905
 Site-Sketch                    (4) | Train Loss: 0.6911 | Train Acc: 0.8032
 Site-QuickDraw                 (0) | Train Loss: 1.2889 | Train Acc: 0.5873
 Site-QuickDraw                 (0) | Train Loss: 1.2111 | Train Acc: 0.6656
 Site-Infograph                 (1) | Train Loss: 1.3241 | Train Acc: 0.6127
 Site-Infograph                 (1) | Train Loss: 1.3804 | Train Acc: 0.5492
Average Train Accuracy: 0.7607
 Site-Clipart                   (2) | Val  Loss: 0.7404 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.7073 | Val  Acc: 0.8206
 Site-Real                      (3) | Val  Loss: 0.5610 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.4887 | Val  Acc: 0.9127
 Site-Painting                  (2) | Val  Loss: 0.6515 | Val  Acc: 0.8333
 Site-Painting                  (2) | Val  Loss: 0.5877 | Val  Acc: 0.8587
 Site-Sketch                    (4) | Val  Loss: 0.7271 | Val  Acc: 0.7952
 Site-Sketch                    (4) | Val  Loss: 0.6920 | Val  Acc: 0.7937
 Site-QuickDraw                 (0) | Val  Loss: 1.1810 | Val  Acc: 0.6905
 Site-QuickDraw                 (0) | Val  Loss: 1.2128 | Val  Acc: 0.6667
 Site-Infograph                 (1) | Val  Loss: 1.2543 | Val  Acc: 0.5762
 Site-Infograph                 (1) | Val  Loss: 1.3636 | Val  Acc: 0.5667
Average Valid Accuracy: 0.7730
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.8206
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9127
 Best site-Painting                 (2)  | Epoch:5 | Val Acc: 0.8333
 Best site-Painting                 (2)  | Epoch:5 | Val Acc: 0.8587
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7952
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7937
 Best site-QuickDraw                (0)  | Epoch:5 | Val Acc: 0.6905
 Best site-QuickDraw                (0)  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph                (1)  | Epoch:5 | Val Acc: 0.5762
 Best site-Infograph                (1)  | Epoch:5 | Val Acc: 0.5667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (2) | Train Loss: 0.6237 | Train Acc: 0.8444
 Site-Clipart                   (2) | Train Loss: 0.6746 | Train Acc: 0.8095
 Site-Real                      (3) | Train Loss: 0.4168 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.4402 | Train Acc: 0.9259
 Site-Painting                  (4) | Train Loss: 0.6005 | Train Acc: 0.8286
 Site-Painting                  (4) | Train Loss: 0.5577 | Train Acc: 0.8550
 Site-Sketch                    (2) | Train Loss: 0.6345 | Train Acc: 0.8095
 Site-Sketch                    (2) | Train Loss: 0.6696 | Train Acc: 0.8021
 Site-QuickDraw                 (1) | Train Loss: 1.1907 | Train Acc: 0.6254
 Site-QuickDraw                 (1) | Train Loss: 1.1143 | Train Acc: 0.6783
 Site-Infograph                 (0) | Train Loss: 1.3303 | Train Acc: 0.5905
 Site-Infograph                 (0) | Train Loss: 1.3060 | Train Acc: 0.5683
Average Train Accuracy: 0.7715
 Site-Clipart                   (2) | Val  Loss: 0.7004 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.6673 | Val  Acc: 0.8222
 Site-Real                      (3) | Val  Loss: 0.5338 | Val  Acc: 0.9000
 Site-Real                      (3) | Val  Loss: 0.4340 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.6707 | Val  Acc: 0.8286
 Site-Painting                  (4) | Val  Loss: 0.5712 | Val  Acc: 0.8444
 Site-Sketch                    (2) | Val  Loss: 0.7067 | Val  Acc: 0.8286
 Site-Sketch                    (2) | Val  Loss: 0.6578 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 1.0646 | Val  Acc: 0.7048
 Site-QuickDraw                 (1) | Val  Loss: 1.0852 | Val  Acc: 0.7032
 Site-Infograph                 (0) | Val  Loss: 1.1652 | Val  Acc: 0.5952
 Site-Infograph                 (0) | Val  Loss: 1.2969 | Val  Acc: 0.5825
Average Valid Accuracy: 0.7810
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.8222
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.9000
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8286
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8444
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.8286
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.8000
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.7048
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.7032
 Best site-Infograph                (0)  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph                (0)  | Epoch:6 | Val Acc: 0.5825
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (0) | Train Loss: 0.5856 | Train Acc: 0.8508
 Site-Clipart                   (0) | Train Loss: 0.6531 | Train Acc: 0.8085
 Site-Real                      (4) | Train Loss: 0.3786 | Train Acc: 0.9238
 Site-Real                      (4) | Train Loss: 0.3936 | Train Acc: 0.9228
 Site-Painting                  (0) | Train Loss: 0.5747 | Train Acc: 0.8317
 Site-Painting                  (0) | Train Loss: 0.5256 | Train Acc: 0.8677
 Site-Sketch                    (3) | Train Loss: 0.6049 | Train Acc: 0.8190
 Site-Sketch                    (3) | Train Loss: 0.6324 | Train Acc: 0.8085
 Site-QuickDraw                 (1) | Train Loss: 1.1179 | Train Acc: 0.6603
 Site-QuickDraw                 (1) | Train Loss: 1.0258 | Train Acc: 0.7058
 Site-Infograph                 (2) | Train Loss: 1.2697 | Train Acc: 0.6190
 Site-Infograph                 (2) | Train Loss: 1.2587 | Train Acc: 0.5852
Average Train Accuracy: 0.7836
 Site-Clipart                   (0) | Val  Loss: 0.7106 | Val  Acc: 0.8095
 Site-Clipart                   (0) | Val  Loss: 0.6568 | Val  Acc: 0.8159
 Site-Real                      (4) | Val  Loss: 0.4672 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.4063 | Val  Acc: 0.9254
 Site-Painting                  (0) | Val  Loss: 0.5608 | Val  Acc: 0.8524
 Site-Painting                  (0) | Val  Loss: 0.5057 | Val  Acc: 0.8810
 Site-Sketch                    (3) | Val  Loss: 0.7203 | Val  Acc: 0.8000
 Site-Sketch                    (3) | Val  Loss: 0.6428 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.9497 | Val  Acc: 0.7667
 Site-QuickDraw                 (1) | Val  Loss: 1.0040 | Val  Acc: 0.7175
 Site-Infograph                 (2) | Val  Loss: 1.1032 | Val  Acc: 0.6476
 Site-Infograph                 (2) | Val  Loss: 1.2798 | Val  Acc: 0.5921
Average Valid Accuracy: 0.7959
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8095
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8159
 Best site-Real                     (4)  | Epoch:7 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:7 | Val Acc: 0.9254
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8524
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch                   (3)  | Epoch:7 | Val Acc: 0.8000
 Best site-Sketch                   (3)  | Epoch:7 | Val Acc: 0.8095
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.7667
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.7175
 Best site-Infograph                (2)  | Epoch:7 | Val Acc: 0.6476
 Best site-Infograph                (2)  | Epoch:7 | Val Acc: 0.5921
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 4, 2, 3, 1, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (1) | Train Loss: 0.5692 | Train Acc: 0.8508
 Site-Clipart                   (1) | Train Loss: 0.6271 | Train Acc: 0.8159
 Site-Real                      (4) | Train Loss: 0.3487 | Train Acc: 0.9333
 Site-Real                      (3) | Train Loss: 0.3734 | Train Acc: 0.9228
 Site-Painting                  (3) | Train Loss: 0.5227 | Train Acc: 0.8603
 Site-Painting                  (3) | Train Loss: 0.4964 | Train Acc: 0.8677
 Site-Sketch                    (1) | Train Loss: 0.5984 | Train Acc: 0.8032
 Site-Sketch                    (1) | Train Loss: 0.6176 | Train Acc: 0.8148
 Site-QuickDraw                 (0) | Train Loss: 1.0431 | Train Acc: 0.6889
 Site-QuickDraw                 (0) | Train Loss: 0.9677 | Train Acc: 0.7312
 Site-Infograph                 (2) | Train Loss: 1.2257 | Train Acc: 0.6286
 Site-Infograph                 (2) | Train Loss: 1.2273 | Train Acc: 0.5947
Average Train Accuracy: 0.7927
 Site-Clipart                   (1) | Val  Loss: 0.6587 | Val  Acc: 0.8429
 Site-Clipart                   (1) | Val  Loss: 0.6174 | Val  Acc: 0.8238
 Site-Real                      (4) | Val  Loss: 0.4385 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3642 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.5330 | Val  Acc: 0.8476
 Site-Painting                  (3) | Val  Loss: 0.4819 | Val  Acc: 0.8571
 Site-Sketch                    (1) | Val  Loss: 0.6151 | Val  Acc: 0.8238
 Site-Sketch                    (1) | Val  Loss: 0.6051 | Val  Acc: 0.8159
 Site-QuickDraw                 (0) | Val  Loss: 0.8897 | Val  Acc: 0.7952
 Site-QuickDraw                 (0) | Val  Loss: 0.9480 | Val  Acc: 0.7397
 Site-Infograph                 (2) | Val  Loss: 1.1429 | Val  Acc: 0.6238
 Site-Infograph                 (2) | Val  Loss: 1.2341 | Val  Acc: 0.5873
Average Valid Accuracy: 0.8015
 Best site-Clipart                  (1)  | Epoch:8 | Val Acc: 0.8429
 Best site-Clipart                  (1)  | Epoch:8 | Val Acc: 0.8238
 Best site-Real                     (4)  | Epoch:8 | Val Acc: 0.9333
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.9270
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8476
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-Sketch                   (1)  | Epoch:8 | Val Acc: 0.8238
 Best site-Sketch                   (1)  | Epoch:8 | Val Acc: 0.8159
 Best site-QuickDraw                (0)  | Epoch:8 | Val Acc: 0.7952
 Best site-QuickDraw                (0)  | Epoch:8 | Val Acc: 0.7397
 Best site-Infograph                (2)  | Epoch:8 | Val Acc: 0.6238
 Best site-Infograph                (2)  | Epoch:8 | Val Acc: 0.5873
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 9 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (0) | Train Loss: 0.5215 | Train Acc: 0.8762
 Site-Clipart                   (0) | Train Loss: 0.5799 | Train Acc: 0.8476
 Site-Real                      (4) | Train Loss: 0.3408 | Train Acc: 0.9302
 Site-Real                      (4) | Train Loss: 0.3319 | Train Acc: 0.9333
 Site-Painting                  (2) | Train Loss: 0.5248 | Train Acc: 0.8222
 Site-Painting                  (2) | Train Loss: 0.4667 | Train Acc: 0.8709
 Site-Sketch                    (0) | Train Loss: 0.5691 | Train Acc: 0.8349
 Site-Sketch                    (0) | Train Loss: 0.5863 | Train Acc: 0.8074
 Site-QuickDraw                 (1) | Train Loss: 1.0128 | Train Acc: 0.6952
 Site-QuickDraw                 (1) | Train Loss: 0.9445 | Train Acc: 0.7302
 Site-Infograph                 (3) | Train Loss: 1.2261 | Train Acc: 0.6063
 Site-Infograph                 (3) | Train Loss: 1.2074 | Train Acc: 0.6042
Average Train Accuracy: 0.7966
 Site-Clipart                   (0) | Val  Loss: 0.5932 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.5761 | Val  Acc: 0.8365
 Site-Real                      (4) | Val  Loss: 0.4080 | Val  Acc: 0.9429
 Site-Real                      (4) | Val  Loss: 0.3613 | Val  Acc: 0.9302
 Site-Painting                  (2) | Val  Loss: 0.5295 | Val  Acc: 0.8619
 Site-Painting                  (2) | Val  Loss: 0.4722 | Val  Acc: 0.8635
 Site-Sketch                    (0) | Val  Loss: 0.6416 | Val  Acc: 0.8238
 Site-Sketch                    (0) | Val  Loss: 0.5990 | Val  Acc: 0.8206
 Site-QuickDraw                 (1) | Val  Loss: 0.8263 | Val  Acc: 0.8143
 Site-QuickDraw                 (1) | Val  Loss: 0.9136 | Val  Acc: 0.7286
 Site-Infograph                 (3) | Val  Loss: 1.0820 | Val  Acc: 0.6381
 Site-Infograph                 (3) | Val  Loss: 1.1763 | Val  Acc: 0.6206
Average Valid Accuracy: 0.8119
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.8619
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.8365
 Best site-Real                     (4)  | Epoch:9 | Val Acc: 0.9429
 Best site-Real                     (4)  | Epoch:9 | Val Acc: 0.9302
 Best site-Painting                 (2)  | Epoch:9 | Val Acc: 0.8619
 Best site-Painting                 (2)  | Epoch:9 | Val Acc: 0.8635
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.8238
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.8206
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.8143
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.7286
 Best site-Infograph                (3)  | Epoch:9 | Val Acc: 0.6381
 Best site-Infograph                (3)  | Epoch:9 | Val Acc: 0.6206
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (3) | Train Loss: 0.4999 | Train Acc: 0.8794
 Site-Clipart                   (3) | Train Loss: 0.5438 | Train Acc: 0.8466
 Site-Real                      (0) | Train Loss: 0.3266 | Train Acc: 0.9333
 Site-Real                      (0) | Train Loss: 0.3441 | Train Acc: 0.9302
 Site-Painting                  (2) | Train Loss: 0.4945 | Train Acc: 0.8317
 Site-Painting                  (2) | Train Loss: 0.4537 | Train Acc: 0.8751
 Site-Sketch                    (3) | Train Loss: 0.5474 | Train Acc: 0.8222
 Site-Sketch                    (3) | Train Loss: 0.5887 | Train Acc: 0.8222
 Site-QuickDraw                 (1) | Train Loss: 0.9190 | Train Acc: 0.7111
 Site-QuickDraw                 (1) | Train Loss: 0.8882 | Train Acc: 0.7503
 Site-Infograph                 (4) | Train Loss: 1.1780 | Train Acc: 0.6603
 Site-Infograph                 (4) | Train Loss: 1.1636 | Train Acc: 0.6349
Average Train Accuracy: 0.8081
 Site-Clipart                   (3) | Val  Loss: 0.5667 | Val  Acc: 0.8762
 Site-Clipart                   (3) | Val  Loss: 0.5254 | Val  Acc: 0.8476
 Site-Real                      (0) | Val  Loss: 0.4403 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.3501 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.5268 | Val  Acc: 0.8667
 Site-Painting                  (2) | Val  Loss: 0.4684 | Val  Acc: 0.8730
 Site-Sketch                    (3) | Val  Loss: 0.6827 | Val  Acc: 0.8000
 Site-Sketch                    (3) | Val  Loss: 0.5792 | Val  Acc: 0.8079
 Site-QuickDraw                 (1) | Val  Loss: 0.8096 | Val  Acc: 0.7619
 Site-QuickDraw                 (1) | Val  Loss: 0.8660 | Val  Acc: 0.7635
 Site-Infograph                 (4) | Val  Loss: 1.0483 | Val  Acc: 0.6857
 Site-Infograph                 (4) | Val  Loss: 1.1701 | Val  Acc: 0.6127
Average Valid Accuracy: 0.8123
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8762
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8476
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9238
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:10 | Val Acc: 0.8667
 Best site-Painting                 (2)  | Epoch:10 | Val Acc: 0.8730
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8000
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8079
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.7619
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.7635
 Best site-Infograph                (4)  | Epoch:10 | Val Acc: 0.6857
 Best site-Infograph                (4)  | Epoch:10 | Val Acc: 0.6127
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 11 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.5021 | Train Acc: 0.8540
 Site-Clipart                   (0) | Train Loss: 0.5605 | Train Acc: 0.8360
 Site-Real                      (3) | Train Loss: 0.3107 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.3313 | Train Acc: 0.9238
 Site-Painting                  (2) | Train Loss: 0.4374 | Train Acc: 0.8603
 Site-Painting                  (2) | Train Loss: 0.4043 | Train Acc: 0.9026
 Site-Sketch                    (0) | Train Loss: 0.5191 | Train Acc: 0.8413
 Site-Sketch                    (0) | Train Loss: 0.5630 | Train Acc: 0.8138
 Site-QuickDraw                 (1) | Train Loss: 0.9459 | Train Acc: 0.7143
 Site-QuickDraw                 (1) | Train Loss: 0.8437 | Train Acc: 0.7651
 Site-Infograph                 (4) | Train Loss: 1.1477 | Train Acc: 0.6603
 Site-Infograph                 (4) | Train Loss: 1.1354 | Train Acc: 0.6392
Average Train Accuracy: 0.8123
 Site-Clipart                   (0) | Val  Loss: 0.5695 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.5360 | Val  Acc: 0.8397
 Site-Real                      (3) | Val  Loss: 0.4063 | Val  Acc: 0.9238
 Site-Real                      (3) | Val  Loss: 0.3385 | Val  Acc: 0.9222
 Site-Painting                  (2) | Val  Loss: 0.4710 | Val  Acc: 0.8714
 Site-Painting                  (2) | Val  Loss: 0.4289 | Val  Acc: 0.8714
 Site-Sketch                    (0) | Val  Loss: 0.6061 | Val  Acc: 0.8429
 Site-Sketch                    (0) | Val  Loss: 0.5691 | Val  Acc: 0.8238
 Site-QuickDraw                 (1) | Val  Loss: 0.8292 | Val  Acc: 0.7952
 Site-QuickDraw                 (1) | Val  Loss: 0.8099 | Val  Acc: 0.7714
 Site-Infograph                 (4) | Val  Loss: 1.0327 | Val  Acc: 0.6524
 Site-Infograph                 (4) | Val  Loss: 1.1361 | Val  Acc: 0.6302
Average Valid Accuracy: 0.8184
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8397
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9238
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9222
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8714
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8714
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8429
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8238
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.7952
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.7714
 Best site-Infograph                (4)  | Epoch:11 | Val Acc: 0.6524
 Best site-Infograph                (4)  | Epoch:11 | Val Acc: 0.6302
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 12 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (0) | Train Loss: 0.5019 | Train Acc: 0.8603
 Site-Clipart                   (0) | Train Loss: 0.5453 | Train Acc: 0.8423
 Site-Real                      (4) | Train Loss: 0.2963 | Train Acc: 0.9365
 Site-Real                      (4) | Train Loss: 0.3197 | Train Acc: 0.9323
 Site-Painting                  (3) | Train Loss: 0.4454 | Train Acc: 0.8794
 Site-Painting                  (3) | Train Loss: 0.4154 | Train Acc: 0.8931
 Site-Sketch                    (0) | Train Loss: 0.5265 | Train Acc: 0.8444
 Site-Sketch                    (0) | Train Loss: 0.5387 | Train Acc: 0.8307
 Site-QuickDraw                 (1) | Train Loss: 0.8902 | Train Acc: 0.7048
 Site-QuickDraw                 (1) | Train Loss: 0.8302 | Train Acc: 0.7683
 Site-Infograph                 (2) | Train Loss: 1.1656 | Train Acc: 0.6444
 Site-Infograph                 (2) | Train Loss: 1.1109 | Train Acc: 0.6370
Average Train Accuracy: 0.8145
 Site-Clipart                   (0) | Val  Loss: 0.5892 | Val  Acc: 0.8381
 Site-Clipart                   (0) | Val  Loss: 0.5275 | Val  Acc: 0.8444
 Site-Real                      (4) | Val  Loss: 0.3907 | Val  Acc: 0.9429
 Site-Real                      (4) | Val  Loss: 0.3123 | Val  Acc: 0.9317
 Site-Painting                  (3) | Val  Loss: 0.4733 | Val  Acc: 0.8857
 Site-Painting                  (3) | Val  Loss: 0.4151 | Val  Acc: 0.8778
 Site-Sketch                    (0) | Val  Loss: 0.6713 | Val  Acc: 0.7762
 Site-Sketch                    (0) | Val  Loss: 0.5552 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.7702 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.8021 | Val  Acc: 0.7619
 Site-Infograph                 (2) | Val  Loss: 0.9663 | Val  Acc: 0.6571
 Site-Infograph                 (2) | Val  Loss: 1.1342 | Val  Acc: 0.6317
Average Valid Accuracy: 0.8147
============ Train epoch 13 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.4697 | Train Acc: 0.8698
 Site-Clipart                   (2) | Train Loss: 0.5154 | Train Acc: 0.8476
 Site-Real                      (4) | Train Loss: 0.3065 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.3024 | Train Acc: 0.9302
 Site-Painting                  (3) | Train Loss: 0.4517 | Train Acc: 0.8635
 Site-Painting                  (3) | Train Loss: 0.3968 | Train Acc: 0.8942
 Site-Sketch                    (2) | Train Loss: 0.5470 | Train Acc: 0.8032
 Site-Sketch                    (2) | Train Loss: 0.5640 | Train Acc: 0.8190
 Site-QuickDraw                 (1) | Train Loss: 0.8465 | Train Acc: 0.7270
 Site-QuickDraw                 (1) | Train Loss: 0.7719 | Train Acc: 0.7746
 Site-Infograph                 (0) | Train Loss: 1.1483 | Train Acc: 0.6571
 Site-Infograph                 (0) | Train Loss: 1.1068 | Train Acc: 0.6328
Average Train Accuracy: 0.8116
 Site-Clipart                   (2) | Val  Loss: 0.5305 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.5248 | Val  Acc: 0.8460
 Site-Real                      (4) | Val  Loss: 0.3858 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.3037 | Val  Acc: 0.9349
 Site-Painting                  (3) | Val  Loss: 0.4720 | Val  Acc: 0.8714
 Site-Painting                  (3) | Val  Loss: 0.4166 | Val  Acc: 0.8952
 Site-Sketch                    (2) | Val  Loss: 0.6302 | Val  Acc: 0.8190
 Site-Sketch                    (2) | Val  Loss: 0.5628 | Val  Acc: 0.8270
 Site-QuickDraw                 (1) | Val  Loss: 0.7073 | Val  Acc: 0.8238
 Site-QuickDraw                 (1) | Val  Loss: 0.7516 | Val  Acc: 0.7921
 Site-Infograph                 (0) | Val  Loss: 0.9479 | Val  Acc: 0.6810
 Site-Infograph                 (0) | Val  Loss: 1.0744 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8300
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8460
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9349
 Best site-Painting                 (3)  | Epoch:13 | Val Acc: 0.8714
 Best site-Painting                 (3)  | Epoch:13 | Val Acc: 0.8952
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8190
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8270
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.8238
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.7921
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.6810
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (3) | Train Loss: 0.4601 | Train Acc: 0.8730
 Site-Clipart                   (3) | Train Loss: 0.5149 | Train Acc: 0.8476
 Site-Real                      (1) | Train Loss: 0.2791 | Train Acc: 0.9302
 Site-Real                      (1) | Train Loss: 0.2893 | Train Acc: 0.9323
 Site-Painting                  (4) | Train Loss: 0.4921 | Train Acc: 0.8540
 Site-Painting                  (4) | Train Loss: 0.4098 | Train Acc: 0.8899
 Site-Sketch                    (3) | Train Loss: 0.5286 | Train Acc: 0.8317
 Site-Sketch                    (3) | Train Loss: 0.5235 | Train Acc: 0.8328
 Site-QuickDraw                 (0) | Train Loss: 0.8073 | Train Acc: 0.7556
 Site-QuickDraw                 (0) | Train Loss: 0.7579 | Train Acc: 0.7915
 Site-Infograph                 (2) | Train Loss: 1.1339 | Train Acc: 0.6540
 Site-Infograph                 (2) | Train Loss: 1.0792 | Train Acc: 0.6328
Average Train Accuracy: 0.8188
 Site-Clipart                   (3) | Val  Loss: 0.4952 | Val  Acc: 0.9048
 Site-Clipart                   (3) | Val  Loss: 0.5230 | Val  Acc: 0.8333
 Site-Real                      (1) | Val  Loss: 0.3588 | Val  Acc: 0.9238
 Site-Real                      (1) | Val  Loss: 0.2895 | Val  Acc: 0.9333
 Site-Painting                  (4) | Val  Loss: 0.4477 | Val  Acc: 0.8714
 Site-Painting                  (4) | Val  Loss: 0.4206 | Val  Acc: 0.8714
 Site-Sketch                    (3) | Val  Loss: 0.6546 | Val  Acc: 0.8095
 Site-Sketch                    (3) | Val  Loss: 0.5506 | Val  Acc: 0.8127
 Site-QuickDraw                 (0) | Val  Loss: 0.6722 | Val  Acc: 0.8476
 Site-QuickDraw                 (0) | Val  Loss: 0.7211 | Val  Acc: 0.8095
 Site-Infograph                 (2) | Val  Loss: 0.9308 | Val  Acc: 0.6810
 Site-Infograph                 (2) | Val  Loss: 1.0474 | Val  Acc: 0.6524
Average Valid Accuracy: 0.8292
============ Train epoch 15 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (0) | Train Loss: 0.4439 | Train Acc: 0.8667
 Site-Clipart                   (0) | Train Loss: 0.5076 | Train Acc: 0.8444
 Site-Real                      (4) | Train Loss: 0.2782 | Train Acc: 0.9333
 Site-Real                      (4) | Train Loss: 0.2947 | Train Acc: 0.9333
 Site-Painting                  (3) | Train Loss: 0.4218 | Train Acc: 0.8730
 Site-Painting                  (3) | Train Loss: 0.4196 | Train Acc: 0.8899
 Site-Sketch                    (0) | Train Loss: 0.5270 | Train Acc: 0.8317
 Site-Sketch                    (0) | Train Loss: 0.5311 | Train Acc: 0.8296
 Site-QuickDraw                 (1) | Train Loss: 0.8160 | Train Acc: 0.7556
 Site-QuickDraw                 (1) | Train Loss: 0.7481 | Train Acc: 0.7683
 Site-Infograph                 (2) | Train Loss: 1.1275 | Train Acc: 0.6381
 Site-Infograph                 (2) | Train Loss: 1.0503 | Train Acc: 0.6593
Average Train Accuracy: 0.8186
 Site-Clipart                   (0) | Val  Loss: 0.5002 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.4758 | Val  Acc: 0.8603
 Site-Real                      (4) | Val  Loss: 0.3710 | Val  Acc: 0.9190
 Site-Real                      (4) | Val  Loss: 0.3022 | Val  Acc: 0.9302
 Site-Painting                  (3) | Val  Loss: 0.4702 | Val  Acc: 0.8714
 Site-Painting                  (3) | Val  Loss: 0.4140 | Val  Acc: 0.8889
 Site-Sketch                    (0) | Val  Loss: 0.6248 | Val  Acc: 0.8238
 Site-Sketch                    (0) | Val  Loss: 0.5518 | Val  Acc: 0.8254
 Site-QuickDraw                 (1) | Val  Loss: 0.6608 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.7535 | Val  Acc: 0.7746
 Site-Infograph                 (2) | Val  Loss: 0.9388 | Val  Acc: 0.7000
 Site-Infograph                 (2) | Val  Loss: 1.0402 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8288
============ Train epoch 16 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (3) | Train Loss: 0.4319 | Train Acc: 0.8698
 Site-Clipart                   (3) | Train Loss: 0.4910 | Train Acc: 0.8508
 Site-Real                      (0) | Train Loss: 0.2521 | Train Acc: 0.9460
 Site-Real                      (0) | Train Loss: 0.2833 | Train Acc: 0.9354
 Site-Painting                  (4) | Train Loss: 0.4436 | Train Acc: 0.8635
 Site-Painting                  (4) | Train Loss: 0.3708 | Train Acc: 0.8931
 Site-Sketch                    (3) | Train Loss: 0.4941 | Train Acc: 0.8381
 Site-Sketch                    (3) | Train Loss: 0.5147 | Train Acc: 0.8307
 Site-QuickDraw                 (1) | Train Loss: 0.7987 | Train Acc: 0.7556
 Site-QuickDraw                 (1) | Train Loss: 0.7219 | Train Acc: 0.7947
 Site-Infograph                 (2) | Train Loss: 1.1159 | Train Acc: 0.6603
 Site-Infograph                 (2) | Train Loss: 1.0413 | Train Acc: 0.6624
Average Train Accuracy: 0.8250
 Site-Clipart                   (3) | Val  Loss: 0.4493 | Val  Acc: 0.9143
 Site-Clipart                   (3) | Val  Loss: 0.4832 | Val  Acc: 0.8667
 Site-Real                      (0) | Val  Loss: 0.3720 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.2907 | Val  Acc: 0.9381
 Site-Painting                  (4) | Val  Loss: 0.5082 | Val  Acc: 0.8714
 Site-Painting                  (4) | Val  Loss: 0.3692 | Val  Acc: 0.8937
 Site-Sketch                    (3) | Val  Loss: 0.6532 | Val  Acc: 0.7952
 Site-Sketch                    (3) | Val  Loss: 0.5216 | Val  Acc: 0.8413
 Site-QuickDraw                 (1) | Val  Loss: 0.6846 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.7282 | Val  Acc: 0.7889
 Site-Infograph                 (2) | Val  Loss: 0.8962 | Val  Acc: 0.6905
 Site-Infograph                 (2) | Val  Loss: 1.0430 | Val  Acc: 0.6651
Average Valid Accuracy: 0.8364
 Best site-Clipart                  (3)  | Epoch:16 | Val Acc: 0.9143
 Best site-Clipart                  (3)  | Epoch:16 | Val Acc: 0.8667
 Best site-Real                     (0)  | Epoch:16 | Val Acc: 0.9238
 Best site-Real                     (0)  | Epoch:16 | Val Acc: 0.9381
 Best site-Painting                 (4)  | Epoch:16 | Val Acc: 0.8714
 Best site-Painting                 (4)  | Epoch:16 | Val Acc: 0.8937
 Best site-Sketch                   (3)  | Epoch:16 | Val Acc: 0.7952
 Best site-Sketch                   (3)  | Epoch:16 | Val Acc: 0.8413
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.8476
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.7889
 Best site-Infograph                (2)  | Epoch:16 | Val Acc: 0.6905
 Best site-Infograph                (2)  | Epoch:16 | Val Acc: 0.6651
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (0) | Train Loss: 0.4231 | Train Acc: 0.8667
 Site-Clipart                   (0) | Train Loss: 0.4629 | Train Acc: 0.8656
 Site-Real                      (4) | Train Loss: 0.2867 | Train Acc: 0.9333
 Site-Real                      (4) | Train Loss: 0.2920 | Train Acc: 0.9259
 Site-Painting                  (3) | Train Loss: 0.4463 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.3799 | Train Acc: 0.8942
 Site-Sketch                    (0) | Train Loss: 0.4924 | Train Acc: 0.8476
 Site-Sketch                    (0) | Train Loss: 0.5299 | Train Acc: 0.8222
 Site-QuickDraw                 (1) | Train Loss: 0.8336 | Train Acc: 0.7175
 Site-QuickDraw                 (1) | Train Loss: 0.7243 | Train Acc: 0.7820
 Site-Infograph                 (2) | Train Loss: 1.1212 | Train Acc: 0.6508
 Site-Infograph                 (2) | Train Loss: 1.0243 | Train Acc: 0.6688
Average Train Accuracy: 0.8193
 Site-Clipart                   (0) | Val  Loss: 0.5195 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.4820 | Val  Acc: 0.8556
 Site-Real                      (4) | Val  Loss: 0.4091 | Val  Acc: 0.9143
 Site-Real                      (4) | Val  Loss: 0.2845 | Val  Acc: 0.9333
 Site-Painting                  (3) | Val  Loss: 0.4587 | Val  Acc: 0.8619
 Site-Painting                  (3) | Val  Loss: 0.3698 | Val  Acc: 0.9000
 Site-Sketch                    (0) | Val  Loss: 0.6131 | Val  Acc: 0.8143
 Site-Sketch                    (0) | Val  Loss: 0.5279 | Val  Acc: 0.8270
 Site-QuickDraw                 (1) | Val  Loss: 0.6754 | Val  Acc: 0.8238
 Site-QuickDraw                 (1) | Val  Loss: 0.7131 | Val  Acc: 0.7746
 Site-Infograph                 (2) | Val  Loss: 0.8385 | Val  Acc: 0.7286
 Site-Infograph                 (2) | Val  Loss: 1.0150 | Val  Acc: 0.6825
Average Valid Accuracy: 0.8343
============ Train epoch 18 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (0) | Train Loss: 0.4178 | Train Acc: 0.8952
 Site-Clipart                   (0) | Train Loss: 0.4874 | Train Acc: 0.8497
 Site-Real                      (3) | Train Loss: 0.2704 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2864 | Train Acc: 0.9354
 Site-Painting                  (3) | Train Loss: 0.4095 | Train Acc: 0.8667
 Site-Painting                  (3) | Train Loss: 0.3745 | Train Acc: 0.9016
 Site-Sketch                    (4) | Train Loss: 0.4792 | Train Acc: 0.8413
 Site-Sketch                    (4) | Train Loss: 0.5071 | Train Acc: 0.8328
 Site-QuickDraw                 (1) | Train Loss: 0.8047 | Train Acc: 0.7587
 Site-QuickDraw                 (1) | Train Loss: 0.7019 | Train Acc: 0.8021
 Site-Infograph                 (2) | Train Loss: 1.1086 | Train Acc: 0.6540
 Site-Infograph                 (2) | Train Loss: 1.0124 | Train Acc: 0.6730
Average Train Accuracy: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.4899 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.4787 | Val  Acc: 0.8635
 Site-Real                      (3) | Val  Loss: 0.4227 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2771 | Val  Acc: 0.9444
 Site-Painting                  (3) | Val  Loss: 0.4762 | Val  Acc: 0.8667
 Site-Painting                  (3) | Val  Loss: 0.3785 | Val  Acc: 0.8873
 Site-Sketch                    (4) | Val  Loss: 0.5899 | Val  Acc: 0.8190
 Site-Sketch                    (4) | Val  Loss: 0.5334 | Val  Acc: 0.8238
 Site-QuickDraw                 (1) | Val  Loss: 0.6110 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.7074 | Val  Acc: 0.7730
 Site-Infograph                 (2) | Val  Loss: 0.8951 | Val  Acc: 0.7048
 Site-Infograph                 (2) | Val  Loss: 0.9924 | Val  Acc: 0.6952
Average Valid Accuracy: 0.8343
============ Train epoch 19 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (3) | Train Loss: 0.4400 | Train Acc: 0.8762
 Site-Clipart                   (3) | Train Loss: 0.4717 | Train Acc: 0.8593
 Site-Real                      (1) | Train Loss: 0.2575 | Train Acc: 0.9397
 Site-Real                      (1) | Train Loss: 0.2693 | Train Acc: 0.9280
 Site-Painting                  (4) | Train Loss: 0.3945 | Train Acc: 0.8762
 Site-Painting                  (4) | Train Loss: 0.3620 | Train Acc: 0.9058
 Site-Sketch                    (3) | Train Loss: 0.4942 | Train Acc: 0.8381
 Site-Sketch                    (3) | Train Loss: 0.5111 | Train Acc: 0.8265
 Site-QuickDraw                 (0) | Train Loss: 0.7882 | Train Acc: 0.7651
 Site-QuickDraw                 (0) | Train Loss: 0.6975 | Train Acc: 0.7767
 Site-Infograph                 (2) | Train Loss: 1.0943 | Train Acc: 0.6603
 Site-Infograph                 (2) | Train Loss: 0.9783 | Train Acc: 0.6847
Average Train Accuracy: 0.8280
 Site-Clipart                   (3) | Val  Loss: 0.5285 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.4771 | Val  Acc: 0.8603
 Site-Real                      (1) | Val  Loss: 0.3855 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.2773 | Val  Acc: 0.9302
 Site-Painting                  (4) | Val  Loss: 0.4484 | Val  Acc: 0.8667
 Site-Painting                  (4) | Val  Loss: 0.3832 | Val  Acc: 0.8952
 Site-Sketch                    (3) | Val  Loss: 0.6085 | Val  Acc: 0.8476
 Site-Sketch                    (3) | Val  Loss: 0.5137 | Val  Acc: 0.8286
 Site-QuickDraw                 (0) | Val  Loss: 0.6230 | Val  Acc: 0.8524
 Site-QuickDraw                 (0) | Val  Loss: 0.6793 | Val  Acc: 0.7921
 Site-Infograph                 (2) | Val  Loss: 0.8846 | Val  Acc: 0.7190
 Site-Infograph                 (2) | Val  Loss: 0.9809 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8390
 Best site-Clipart                  (3)  | Epoch:19 | Val Acc: 0.8571
 Best site-Clipart                  (3)  | Epoch:19 | Val Acc: 0.8603
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9302
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8667
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8952
 Best site-Sketch                   (3)  | Epoch:19 | Val Acc: 0.8476
 Best site-Sketch                   (3)  | Epoch:19 | Val Acc: 0.8286
 Best site-QuickDraw                (0)  | Epoch:19 | Val Acc: 0.8524
 Best site-QuickDraw                (0)  | Epoch:19 | Val Acc: 0.7921
 Best site-Infograph                (2)  | Epoch:19 | Val Acc: 0.7190
 Best site-Infograph                (2)  | Epoch:19 | Val Acc: 0.6857
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.4314 | Train Acc: 0.8603
 Site-Clipart                   (2) | Train Loss: 0.4601 | Train Acc: 0.8709
 Site-Real                      (4) | Train Loss: 0.2553 | Train Acc: 0.9302
 Site-Real                      (4) | Train Loss: 0.2560 | Train Acc: 0.9333
 Site-Painting                  (0) | Train Loss: 0.3640 | Train Acc: 0.9079
 Site-Painting                  (0) | Train Loss: 0.3502 | Train Acc: 0.9090
 Site-Sketch                    (2) | Train Loss: 0.4895 | Train Acc: 0.8317
 Site-Sketch                    (2) | Train Loss: 0.4824 | Train Acc: 0.8434
 Site-QuickDraw                 (1) | Train Loss: 0.7671 | Train Acc: 0.7524
 Site-QuickDraw                 (1) | Train Loss: 0.6874 | Train Acc: 0.7958
 Site-Infograph                 (3) | Train Loss: 1.0901 | Train Acc: 0.6762
 Site-Infograph                 (3) | Train Loss: 0.9585 | Train Acc: 0.6889
Average Train Accuracy: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.4666 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4723 | Val  Acc: 0.8540
 Site-Real                      (4) | Val  Loss: 0.3472 | Val  Acc: 0.9381
 Site-Real                      (4) | Val  Loss: 0.2613 | Val  Acc: 0.9365
 Site-Painting                  (0) | Val  Loss: 0.4035 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.3469 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.5435 | Val  Acc: 0.8333
 Site-Sketch                    (2) | Val  Loss: 0.4935 | Val  Acc: 0.8429
 Site-QuickDraw                 (1) | Val  Loss: 0.6306 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.6963 | Val  Acc: 0.7952
 Site-Infograph                 (3) | Val  Loss: 0.8819 | Val  Acc: 0.7333
 Site-Infograph                 (3) | Val  Loss: 0.9539 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8458
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8905
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8540
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9381
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9365
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.8905
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.9048
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8333
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8429
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.8286
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7952
 Best site-Infograph                (3)  | Epoch:20 | Val Acc: 0.7333
 Best site-Infograph                (3)  | Epoch:20 | Val Acc: 0.7016
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 21 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.4263 | Train Acc: 0.8730
 Site-Clipart                   (0) | Train Loss: 0.4543 | Train Acc: 0.8646
 Site-Real                      (4) | Train Loss: 0.2351 | Train Acc: 0.9460
 Site-Real                      (4) | Train Loss: 0.2558 | Train Acc: 0.9354
 Site-Painting                  (3) | Train Loss: 0.3746 | Train Acc: 0.8825
 Site-Painting                  (3) | Train Loss: 0.3362 | Train Acc: 0.9101
 Site-Sketch                    (0) | Train Loss: 0.4812 | Train Acc: 0.8349
 Site-Sketch                    (0) | Train Loss: 0.4786 | Train Acc: 0.8444
 Site-QuickDraw                 (1) | Train Loss: 0.7619 | Train Acc: 0.7587
 Site-QuickDraw                 (1) | Train Loss: 0.6661 | Train Acc: 0.8053
 Site-Infograph                 (2) | Train Loss: 1.0876 | Train Acc: 0.6667
 Site-Infograph                 (2) | Train Loss: 0.9446 | Train Acc: 0.6857
Average Train Accuracy: 0.8340
 Site-Clipart                   (0) | Val  Loss: 0.5118 | Val  Acc: 0.8810
 Site-Clipart                   (0) | Val  Loss: 0.4508 | Val  Acc: 0.8619
 Site-Real                      (4) | Val  Loss: 0.3660 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2634 | Val  Acc: 0.9381
 Site-Painting                  (3) | Val  Loss: 0.4398 | Val  Acc: 0.8952
 Site-Painting                  (3) | Val  Loss: 0.3494 | Val  Acc: 0.9032
 Site-Sketch                    (0) | Val  Loss: 0.5401 | Val  Acc: 0.8238
 Site-Sketch                    (0) | Val  Loss: 0.5027 | Val  Acc: 0.8397
 Site-QuickDraw                 (1) | Val  Loss: 0.6396 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.6603 | Val  Acc: 0.8095
 Site-Infograph                 (2) | Val  Loss: 0.8579 | Val  Acc: 0.7381
 Site-Infograph                 (2) | Val  Loss: 0.9573 | Val  Acc: 0.6952
Average Valid Accuracy: 0.8472
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8810
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8619
 Best site-Real                     (4)  | Epoch:21 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:21 | Val Acc: 0.9381
 Best site-Painting                 (3)  | Epoch:21 | Val Acc: 0.8952
 Best site-Painting                 (3)  | Epoch:21 | Val Acc: 0.9032
 Best site-Sketch                   (0)  | Epoch:21 | Val Acc: 0.8238
 Best site-Sketch                   (0)  | Epoch:21 | Val Acc: 0.8397
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.8476
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.8095
 Best site-Infograph                (2)  | Epoch:21 | Val Acc: 0.7381
 Best site-Infograph                (2)  | Epoch:21 | Val Acc: 0.6952
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.3919 | Train Acc: 0.8921
 Site-Clipart                   (0) | Train Loss: 0.4263 | Train Acc: 0.8720
 Site-Real                      (3) | Train Loss: 0.2437 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2662 | Train Acc: 0.9354
 Site-Painting                  (3) | Train Loss: 0.3641 | Train Acc: 0.8921
 Site-Painting                  (3) | Train Loss: 0.3585 | Train Acc: 0.9016
 Site-Sketch                    (4) | Train Loss: 0.4573 | Train Acc: 0.8571
 Site-Sketch                    (4) | Train Loss: 0.4788 | Train Acc: 0.8476
 Site-QuickDraw                 (1) | Train Loss: 0.7148 | Train Acc: 0.7651
 Site-QuickDraw                 (1) | Train Loss: 0.6771 | Train Acc: 0.7926
 Site-Infograph                 (2) | Train Loss: 1.0654 | Train Acc: 0.6698
 Site-Infograph                 (2) | Train Loss: 0.9484 | Train Acc: 0.6899
Average Train Accuracy: 0.8377
 Site-Clipart                   (0) | Val  Loss: 0.4715 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4350 | Val  Acc: 0.8746
 Site-Real                      (3) | Val  Loss: 0.3820 | Val  Acc: 0.9381
 Site-Real                      (3) | Val  Loss: 0.2670 | Val  Acc: 0.9349
 Site-Painting                  (3) | Val  Loss: 0.4110 | Val  Acc: 0.8857
 Site-Painting                  (3) | Val  Loss: 0.3583 | Val  Acc: 0.8937
 Site-Sketch                    (4) | Val  Loss: 0.5325 | Val  Acc: 0.8286
 Site-Sketch                    (4) | Val  Loss: 0.4649 | Val  Acc: 0.8524
 Site-QuickDraw                 (1) | Val  Loss: 0.6527 | Val  Acc: 0.8333
 Site-QuickDraw                 (1) | Val  Loss: 0.6526 | Val  Acc: 0.8048
 Site-Infograph                 (2) | Val  Loss: 0.8638 | Val  Acc: 0.7333
 Site-Infograph                 (2) | Val  Loss: 0.9670 | Val  Acc: 0.6968
Average Valid Accuracy: 0.8472
============ Train epoch 23 ============
cnt=[3, 2, 2, 2, 3, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (4) | Train Loss: 0.4159 | Train Acc: 0.8730
 Site-Clipart                   (4) | Train Loss: 0.4248 | Train Acc: 0.8751
 Site-Real                      (0) | Train Loss: 0.2591 | Train Acc: 0.9365
 Site-Real                      (4) | Train Loss: 0.2552 | Train Acc: 0.9376
 Site-Painting                  (0) | Train Loss: 0.3778 | Train Acc: 0.8794
 Site-Painting                  (0) | Train Loss: 0.3433 | Train Acc: 0.8995
 Site-Sketch                    (2) | Train Loss: 0.4516 | Train Acc: 0.8635
 Site-Sketch                    (2) | Train Loss: 0.4561 | Train Acc: 0.8635
 Site-QuickDraw                 (1) | Train Loss: 0.7528 | Train Acc: 0.7746
 Site-QuickDraw                 (1) | Train Loss: 0.6681 | Train Acc: 0.7989
 Site-Infograph                 (3) | Train Loss: 1.0575 | Train Acc: 0.6857
 Site-Infograph                 (3) | Train Loss: 0.9203 | Train Acc: 0.6984
Average Train Accuracy: 0.8405
 Site-Clipart                   (4) | Val  Loss: 0.4429 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4178 | Val  Acc: 0.8810
 Site-Real                      (0) | Val  Loss: 0.3692 | Val  Acc: 0.9190
 Site-Real                      (4) | Val  Loss: 0.2583 | Val  Acc: 0.9413
 Site-Painting                  (0) | Val  Loss: 0.4823 | Val  Acc: 0.8476
 Site-Painting                  (0) | Val  Loss: 0.3368 | Val  Acc: 0.8952
 Site-Sketch                    (2) | Val  Loss: 0.5276 | Val  Acc: 0.8286
 Site-Sketch                    (2) | Val  Loss: 0.4740 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.6200 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.6340 | Val  Acc: 0.8159
 Site-Infograph                 (3) | Val  Loss: 0.8321 | Val  Acc: 0.7143
 Site-Infograph                 (3) | Val  Loss: 0.9333 | Val  Acc: 0.6873
Average Valid Accuracy: 0.8406
============ Train epoch 24 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (2) | Train Loss: 0.4020 | Train Acc: 0.8857
 Site-Clipart                   (2) | Train Loss: 0.4218 | Train Acc: 0.8698
 Site-Real                      (3) | Train Loss: 0.2385 | Train Acc: 0.9429
 Site-Real                      (3) | Train Loss: 0.2471 | Train Acc: 0.9365
 Site-Painting                  (3) | Train Loss: 0.3396 | Train Acc: 0.8952
 Site-Painting                  (3) | Train Loss: 0.3417 | Train Acc: 0.8974
 Site-Sketch                    (4) | Train Loss: 0.4696 | Train Acc: 0.8476
 Site-Sketch                    (4) | Train Loss: 0.4746 | Train Acc: 0.8466
 Site-QuickDraw                 (1) | Train Loss: 0.7437 | Train Acc: 0.7524
 Site-QuickDraw                 (1) | Train Loss: 0.6581 | Train Acc: 0.7862
 Site-Infograph                 (0) | Train Loss: 1.0558 | Train Acc: 0.6794
 Site-Infograph                 (0) | Train Loss: 0.9217 | Train Acc: 0.7016
Average Train Accuracy: 0.8368
 Site-Clipart                   (2) | Val  Loss: 0.4423 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4321 | Val  Acc: 0.8698
 Site-Real                      (3) | Val  Loss: 0.3442 | Val  Acc: 0.9381
 Site-Real                      (3) | Val  Loss: 0.2516 | Val  Acc: 0.9333
 Site-Painting                  (3) | Val  Loss: 0.3901 | Val  Acc: 0.8952
 Site-Painting                  (3) | Val  Loss: 0.3464 | Val  Acc: 0.9111
 Site-Sketch                    (4) | Val  Loss: 0.5876 | Val  Acc: 0.8238
 Site-Sketch                    (4) | Val  Loss: 0.4617 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.6064 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.6363 | Val  Acc: 0.8127
 Site-Infograph                 (0) | Val  Loss: 0.8008 | Val  Acc: 0.7381
 Site-Infograph                 (0) | Val  Loss: 0.9038 | Val  Acc: 0.7159
Average Valid Accuracy: 0.8516
 Best site-Clipart                  (2)  | Epoch:24 | Val Acc: 0.8857
 Best site-Clipart                  (2)  | Epoch:24 | Val Acc: 0.8698
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9381
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9333
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.8952
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.9111
 Best site-Sketch                   (4)  | Epoch:24 | Val Acc: 0.8238
 Best site-Sketch                   (4)  | Epoch:24 | Val Acc: 0.8571
 Best site-QuickDraw                (1)  | Epoch:24 | Val Acc: 0.8381
 Best site-QuickDraw                (1)  | Epoch:24 | Val Acc: 0.8127
 Best site-Infograph                (0)  | Epoch:24 | Val Acc: 0.7381
 Best site-Infograph                (0)  | Epoch:24 | Val Acc: 0.7159
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.3922 | Train Acc: 0.8857
 Site-Clipart                   (3) | Train Loss: 0.4317 | Train Acc: 0.8698
 Site-Real                      (0) | Train Loss: 0.2473 | Train Acc: 0.9397
 Site-Real                      (0) | Train Loss: 0.2471 | Train Acc: 0.9333
 Site-Painting                  (4) | Train Loss: 0.3879 | Train Acc: 0.8698
 Site-Painting                  (4) | Train Loss: 0.3475 | Train Acc: 0.8974
 Site-Sketch                    (3) | Train Loss: 0.4461 | Train Acc: 0.8603
 Site-Sketch                    (3) | Train Loss: 0.4534 | Train Acc: 0.8466
 Site-QuickDraw                 (1) | Train Loss: 0.7088 | Train Acc: 0.7873
 Site-QuickDraw                 (1) | Train Loss: 0.6122 | Train Acc: 0.8307
 Site-Infograph                 (2) | Train Loss: 1.0659 | Train Acc: 0.6762
 Site-Infograph                 (2) | Train Loss: 0.9072 | Train Acc: 0.7101
Average Train Accuracy: 0.8422
 Site-Clipart                   (3) | Val  Loss: 0.4680 | Val  Acc: 0.8714
 Site-Clipart                   (3) | Val  Loss: 0.4313 | Val  Acc: 0.8619
 Site-Real                      (0) | Val  Loss: 0.3899 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2461 | Val  Acc: 0.9365
 Site-Painting                  (4) | Val  Loss: 0.4418 | Val  Acc: 0.8810
 Site-Painting                  (4) | Val  Loss: 0.3185 | Val  Acc: 0.9190
 Site-Sketch                    (3) | Val  Loss: 0.5325 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.4548 | Val  Acc: 0.8444
 Site-QuickDraw                 (1) | Val  Loss: 0.6069 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.6225 | Val  Acc: 0.8175
 Site-Infograph                 (2) | Val  Loss: 0.8105 | Val  Acc: 0.7381
 Site-Infograph                 (2) | Val  Loss: 0.9057 | Val  Acc: 0.7032
Average Valid Accuracy: 0.8513
============ Train epoch 26 ============
cnt=[2, 3, 2, 3, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (3) | Train Loss: 0.3649 | Train Acc: 0.8984
 Site-Clipart                   (1) | Train Loss: 0.3952 | Train Acc: 0.8815
 Site-Real                      (1) | Train Loss: 0.2472 | Train Acc: 0.9397
 Site-Real                      (1) | Train Loss: 0.2439 | Train Acc: 0.9386
 Site-Painting                  (4) | Train Loss: 0.3774 | Train Acc: 0.8794
 Site-Painting                  (4) | Train Loss: 0.3318 | Train Acc: 0.9058
 Site-Sketch                    (3) | Train Loss: 0.4201 | Train Acc: 0.8603
 Site-Sketch                    (3) | Train Loss: 0.4648 | Train Acc: 0.8434
 Site-QuickDraw                 (0) | Train Loss: 0.6897 | Train Acc: 0.7937
 Site-QuickDraw                 (0) | Train Loss: 0.6190 | Train Acc: 0.8275
 Site-Infograph                 (2) | Train Loss: 1.0749 | Train Acc: 0.6825
 Site-Infograph                 (2) | Train Loss: 0.9010 | Train Acc: 0.7069
Average Train Accuracy: 0.8465
 Site-Clipart                   (3) | Val  Loss: 0.3985 | Val  Acc: 0.9048
 Site-Clipart                   (1) | Val  Loss: 0.4071 | Val  Acc: 0.8683
 Site-Real                      (1) | Val  Loss: 0.3455 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.2511 | Val  Acc: 0.9365
 Site-Painting                  (4) | Val  Loss: 0.4006 | Val  Acc: 0.8667
 Site-Painting                  (4) | Val  Loss: 0.3250 | Val  Acc: 0.9175
 Site-Sketch                    (3) | Val  Loss: 0.5006 | Val  Acc: 0.8476
 Site-Sketch                    (3) | Val  Loss: 0.4499 | Val  Acc: 0.8556
 Site-QuickDraw                 (0) | Val  Loss: 0.5877 | Val  Acc: 0.8429
 Site-QuickDraw                 (0) | Val  Loss: 0.6270 | Val  Acc: 0.8111
 Site-Infograph                 (2) | Val  Loss: 0.7972 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.8886 | Val  Acc: 0.7159
Average Valid Accuracy: 0.8536
 Best site-Clipart                  (3)  | Epoch:26 | Val Acc: 0.9048
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8683
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 0.9365
 Best site-Painting                 (4)  | Epoch:26 | Val Acc: 0.8667
 Best site-Painting                 (4)  | Epoch:26 | Val Acc: 0.9175
 Best site-Sketch                   (3)  | Epoch:26 | Val Acc: 0.8476
 Best site-Sketch                   (3)  | Epoch:26 | Val Acc: 0.8556
 Best site-QuickDraw                (0)  | Epoch:26 | Val Acc: 0.8429
 Best site-QuickDraw                (0)  | Epoch:26 | Val Acc: 0.8111
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.7429
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.7159
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.3679 | Train Acc: 0.9016
 Site-Clipart                   (4) | Train Loss: 0.4043 | Train Acc: 0.8783
 Site-Real                      (3) | Train Loss: 0.2343 | Train Acc: 0.9333
 Site-Real                      (3) | Train Loss: 0.2404 | Train Acc: 0.9386
 Site-Painting                  (3) | Train Loss: 0.3381 | Train Acc: 0.8921
 Site-Painting                  (3) | Train Loss: 0.3189 | Train Acc: 0.9175
 Site-Sketch                    (0) | Train Loss: 0.4303 | Train Acc: 0.8635
 Site-Sketch                    (0) | Train Loss: 0.4393 | Train Acc: 0.8550
 Site-QuickDraw                 (1) | Train Loss: 0.7374 | Train Acc: 0.7746
 Site-QuickDraw                 (1) | Train Loss: 0.6347 | Train Acc: 0.8148
 Site-Infograph                 (2) | Train Loss: 1.0476 | Train Acc: 0.6571
 Site-Infograph                 (2) | Train Loss: 0.8838 | Train Acc: 0.7090
Average Train Accuracy: 0.8446
 Site-Clipart                   (4) | Val  Loss: 0.4091 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.3900 | Val  Acc: 0.8810
 Site-Real                      (3) | Val  Loss: 0.3586 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2501 | Val  Acc: 0.9333
 Site-Painting                  (3) | Val  Loss: 0.3963 | Val  Acc: 0.8762
 Site-Painting                  (3) | Val  Loss: 0.3181 | Val  Acc: 0.9048
 Site-Sketch                    (0) | Val  Loss: 0.5270 | Val  Acc: 0.8333
 Site-Sketch                    (0) | Val  Loss: 0.4547 | Val  Acc: 0.8508
 Site-QuickDraw                 (1) | Val  Loss: 0.5285 | Val  Acc: 0.8429
 Site-QuickDraw                 (1) | Val  Loss: 0.5768 | Val  Acc: 0.8444
 Site-Infograph                 (2) | Val  Loss: 0.8073 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.8727 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8544
 Best site-Clipart                  (4)  | Epoch:27 | Val Acc: 0.9000
 Best site-Clipart                  (4)  | Epoch:27 | Val Acc: 0.8810
 Best site-Real                     (3)  | Epoch:27 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:27 | Val Acc: 0.9333
 Best site-Painting                 (3)  | Epoch:27 | Val Acc: 0.8762
 Best site-Painting                 (3)  | Epoch:27 | Val Acc: 0.9048
 Best site-Sketch                   (0)  | Epoch:27 | Val Acc: 0.8333
 Best site-Sketch                   (0)  | Epoch:27 | Val Acc: 0.8508
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.8429
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.8444
 Best site-Infograph                (2)  | Epoch:27 | Val Acc: 0.7429
 Best site-Infograph                (2)  | Epoch:27 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (3) | Train Loss: 0.4012 | Train Acc: 0.8825
 Site-Clipart                   (3) | Train Loss: 0.4031 | Train Acc: 0.8741
 Site-Real                      (2) | Train Loss: 0.2511 | Train Acc: 0.9270
 Site-Real                      (2) | Train Loss: 0.2450 | Train Acc: 0.9386
 Site-Painting                  (4) | Train Loss: 0.3895 | Train Acc: 0.8857
 Site-Painting                  (4) | Train Loss: 0.3353 | Train Acc: 0.9122
 Site-Sketch                    (3) | Train Loss: 0.4229 | Train Acc: 0.8667
 Site-Sketch                    (3) | Train Loss: 0.4437 | Train Acc: 0.8508
 Site-QuickDraw                 (1) | Train Loss: 0.6640 | Train Acc: 0.7937
 Site-QuickDraw                 (1) | Train Loss: 0.6022 | Train Acc: 0.8201
 Site-Infograph                 (0) | Train Loss: 1.0393 | Train Acc: 0.6730
 Site-Infograph                 (0) | Train Loss: 0.8595 | Train Acc: 0.7312
Average Train Accuracy: 0.8463
 Site-Clipart                   (3) | Val  Loss: 0.4121 | Val  Acc: 0.8952
 Site-Clipart                   (3) | Val  Loss: 0.4054 | Val  Acc: 0.8810
 Site-Real                      (2) | Val  Loss: 0.3433 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2556 | Val  Acc: 0.9333
 Site-Painting                  (4) | Val  Loss: 0.3983 | Val  Acc: 0.8905
 Site-Painting                  (4) | Val  Loss: 0.3309 | Val  Acc: 0.9048
 Site-Sketch                    (3) | Val  Loss: 0.5261 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.4473 | Val  Acc: 0.8524
 Site-QuickDraw                 (1) | Val  Loss: 0.5705 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.5915 | Val  Acc: 0.8190
 Site-Infograph                 (0) | Val  Loss: 0.7872 | Val  Acc: 0.7524
 Site-Infograph                 (0) | Val  Loss: 0.8575 | Val  Acc: 0.7222
Average Valid Accuracy: 0.8574
 Best site-Clipart                  (3)  | Epoch:28 | Val Acc: 0.8952
 Best site-Clipart                  (3)  | Epoch:28 | Val Acc: 0.8810
 Best site-Real                     (2)  | Epoch:28 | Val Acc: 0.9238
 Best site-Real                     (2)  | Epoch:28 | Val Acc: 0.9333
 Best site-Painting                 (4)  | Epoch:28 | Val Acc: 0.8905
 Best site-Painting                 (4)  | Epoch:28 | Val Acc: 0.9048
 Best site-Sketch                   (3)  | Epoch:28 | Val Acc: 0.8571
 Best site-Sketch                   (3)  | Epoch:28 | Val Acc: 0.8524
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.8571
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.8190
 Best site-Infograph                (0)  | Epoch:28 | Val Acc: 0.7524
 Best site-Infograph                (0)  | Epoch:28 | Val Acc: 0.7222
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (3) | Train Loss: 0.3865 | Train Acc: 0.8952
 Site-Clipart                   (3) | Train Loss: 0.4164 | Train Acc: 0.8847
 Site-Real                      (0) | Train Loss: 0.2202 | Train Acc: 0.9397
 Site-Real                      (0) | Train Loss: 0.2364 | Train Acc: 0.9397
 Site-Painting                  (4) | Train Loss: 0.3262 | Train Acc: 0.9016
 Site-Painting                  (4) | Train Loss: 0.3179 | Train Acc: 0.9079
 Site-Sketch                    (3) | Train Loss: 0.4348 | Train Acc: 0.8508
 Site-Sketch                    (3) | Train Loss: 0.4382 | Train Acc: 0.8624
 Site-QuickDraw                 (1) | Train Loss: 0.6877 | Train Acc: 0.8032
 Site-QuickDraw                 (1) | Train Loss: 0.6146 | Train Acc: 0.8360
 Site-Infograph                 (2) | Train Loss: 1.0253 | Train Acc: 0.6762
 Site-Infograph                 (2) | Train Loss: 0.8603 | Train Acc: 0.7270
Average Train Accuracy: 0.8520
 Site-Clipart                   (3) | Val  Loss: 0.4486 | Val  Acc: 0.8952
 Site-Clipart                   (3) | Val  Loss: 0.4149 | Val  Acc: 0.8810
 Site-Real                      (0) | Val  Loss: 0.3213 | Val  Acc: 0.9476
 Site-Real                      (0) | Val  Loss: 0.2362 | Val  Acc: 0.9349
 Site-Painting                  (4) | Val  Loss: 0.4279 | Val  Acc: 0.8714
 Site-Painting                  (4) | Val  Loss: 0.3265 | Val  Acc: 0.9111
 Site-Sketch                    (3) | Val  Loss: 0.4505 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.4537 | Val  Acc: 0.8460
 Site-QuickDraw                 (1) | Val  Loss: 0.5511 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.5997 | Val  Acc: 0.8016
 Site-Infograph                 (2) | Val  Loss: 0.8097 | Val  Acc: 0.7667
 Site-Infograph                 (2) | Val  Loss: 0.8530 | Val  Acc: 0.7063
Average Valid Accuracy: 0.8563
============ Train epoch 30 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (4) | Train Loss: 0.3740 | Train Acc: 0.8698
 Site-Clipart                   (4) | Train Loss: 0.3961 | Train Acc: 0.8762
 Site-Real                      (2) | Train Loss: 0.2151 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.2233 | Train Acc: 0.9450
 Site-Painting                  (2) | Train Loss: 0.3456 | Train Acc: 0.8857
 Site-Painting                  (2) | Train Loss: 0.3221 | Train Acc: 0.9048
 Site-Sketch                    (3) | Train Loss: 0.4060 | Train Acc: 0.8698
 Site-Sketch                    (3) | Train Loss: 0.4416 | Train Acc: 0.8519
 Site-QuickDraw                 (1) | Train Loss: 0.7207 | Train Acc: 0.7651
 Site-QuickDraw                 (1) | Train Loss: 0.6194 | Train Acc: 0.8212
 Site-Infograph                 (0) | Train Loss: 1.0308 | Train Acc: 0.6825
 Site-Infograph                 (0) | Train Loss: 0.8370 | Train Acc: 0.7323
Average Train Accuracy: 0.8461
 Site-Clipart                   (4) | Val  Loss: 0.4422 | Val  Acc: 0.8952
 Site-Clipart                   (4) | Val  Loss: 0.3943 | Val  Acc: 0.8746
 Site-Real                      (2) | Val  Loss: 0.3531 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2439 | Val  Acc: 0.9365
 Site-Painting                  (2) | Val  Loss: 0.3735 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.3205 | Val  Acc: 0.9063
 Site-Sketch                    (3) | Val  Loss: 0.5305 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.4416 | Val  Acc: 0.8619
 Site-QuickDraw                 (1) | Val  Loss: 0.5202 | Val  Acc: 0.8810
 Site-QuickDraw                 (1) | Val  Loss: 0.5983 | Val  Acc: 0.8206
 Site-Infograph                 (0) | Val  Loss: 0.7469 | Val  Acc: 0.7476
 Site-Infograph                 (0) | Val  Loss: 0.8454 | Val  Acc: 0.7254
Average Valid Accuracy: 0.8628
 Best site-Clipart                  (4)  | Epoch:30 | Val Acc: 0.8952
 Best site-Clipart                  (4)  | Epoch:30 | Val Acc: 0.8746
 Best site-Real                     (2)  | Epoch:30 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:30 | Val Acc: 0.9365
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9143
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9063
 Best site-Sketch                   (3)  | Epoch:30 | Val Acc: 0.8571
 Best site-Sketch                   (3)  | Epoch:30 | Val Acc: 0.8619
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.8810
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.8206
 Best site-Infograph                (0)  | Epoch:30 | Val Acc: 0.7476
 Best site-Infograph                (0)  | Epoch:30 | Val Acc: 0.7254
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (3) | Train Loss: 0.3610 | Train Acc: 0.9016
 Site-Clipart                   (3) | Train Loss: 0.3821 | Train Acc: 0.8857
 Site-Real                      (2) | Train Loss: 0.2384 | Train Acc: 0.9429
 Site-Real                      (2) | Train Loss: 0.2442 | Train Acc: 0.9333
 Site-Painting                  (4) | Train Loss: 0.3167 | Train Acc: 0.8952
 Site-Painting                  (4) | Train Loss: 0.3106 | Train Acc: 0.9164
 Site-Sketch                    (3) | Train Loss: 0.4376 | Train Acc: 0.8540
 Site-Sketch                    (3) | Train Loss: 0.4013 | Train Acc: 0.8720
 Site-QuickDraw                 (1) | Train Loss: 0.6633 | Train Acc: 0.7778
 Site-QuickDraw                 (1) | Train Loss: 0.5787 | Train Acc: 0.8349
 Site-Infograph                 (0) | Train Loss: 1.0354 | Train Acc: 0.6667
 Site-Infograph                 (0) | Train Loss: 0.8469 | Train Acc: 0.7418
Average Train Accuracy: 0.8519
 Site-Clipart                   (3) | Val  Loss: 0.4115 | Val  Acc: 0.8857
 Site-Clipart                   (3) | Val  Loss: 0.3928 | Val  Acc: 0.8952
 Site-Real                      (2) | Val  Loss: 0.3427 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2353 | Val  Acc: 0.9381
 Site-Painting                  (4) | Val  Loss: 0.3860 | Val  Acc: 0.8952
 Site-Painting                  (4) | Val  Loss: 0.3251 | Val  Acc: 0.9175
 Site-Sketch                    (3) | Val  Loss: 0.5906 | Val  Acc: 0.8190
 Site-Sketch                    (3) | Val  Loss: 0.4402 | Val  Acc: 0.8619
 Site-QuickDraw                 (1) | Val  Loss: 0.5915 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.5686 | Val  Acc: 0.8317
 Site-Infograph                 (0) | Val  Loss: 0.7449 | Val  Acc: 0.7381
 Site-Infograph                 (0) | Val  Loss: 0.8375 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8581
============ Train epoch 32 ============
cnt=[2, 4, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (4) | Train Loss: 0.3836 | Train Acc: 0.8825
 Site-Clipart                   (4) | Train Loss: 0.3852 | Train Acc: 0.8921
 Site-Real                      (1) | Train Loss: 0.2241 | Train Acc: 0.9429
 Site-Real                      (1) | Train Loss: 0.2266 | Train Acc: 0.9365
 Site-Painting                  (1) | Train Loss: 0.3339 | Train Acc: 0.8921
 Site-Painting                  (1) | Train Loss: 0.3191 | Train Acc: 0.9026
 Site-Sketch                    (3) | Train Loss: 0.4500 | Train Acc: 0.8635
 Site-Sketch                    (3) | Train Loss: 0.4139 | Train Acc: 0.8667
 Site-QuickDraw                 (0) | Train Loss: 0.6482 | Train Acc: 0.8159
 Site-QuickDraw                 (0) | Train Loss: 0.5779 | Train Acc: 0.8349
 Site-Infograph                 (2) | Train Loss: 1.0160 | Train Acc: 0.6794
 Site-Infograph                 (2) | Train Loss: 0.8212 | Train Acc: 0.7323
Average Train Accuracy: 0.8534
 Site-Clipart                   (4) | Val  Loss: 0.4081 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.3896 | Val  Acc: 0.8841
 Site-Real                      (1) | Val  Loss: 0.3557 | Val  Acc: 0.9238
 Site-Real                      (1) | Val  Loss: 0.2349 | Val  Acc: 0.9413
 Site-Painting                  (1) | Val  Loss: 0.3844 | Val  Acc: 0.9000
 Site-Painting                  (1) | Val  Loss: 0.3383 | Val  Acc: 0.8937
 Site-Sketch                    (3) | Val  Loss: 0.5580 | Val  Acc: 0.8190
 Site-Sketch                    (3) | Val  Loss: 0.4142 | Val  Acc: 0.8619
 Site-QuickDraw                 (0) | Val  Loss: 0.5305 | Val  Acc: 0.8429
 Site-QuickDraw                 (0) | Val  Loss: 0.5778 | Val  Acc: 0.8254
 Site-Infograph                 (2) | Val  Loss: 0.7252 | Val  Acc: 0.7667
 Site-Infograph                 (2) | Val  Loss: 0.8467 | Val  Acc: 0.7444
Average Valid Accuracy: 0.8574
============ Train epoch 33 ============
cnt=[3, 2, 2, 3, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (3) | Train Loss: 0.3532 | Train Acc: 0.9016
 Site-Clipart                   (0) | Train Loss: 0.3731 | Train Acc: 0.8974
 Site-Real                      (0) | Train Loss: 0.2478 | Train Acc: 0.9333
 Site-Real                      (0) | Train Loss: 0.2381 | Train Acc: 0.9323
 Site-Painting                  (4) | Train Loss: 0.3444 | Train Acc: 0.8889
 Site-Painting                  (4) | Train Loss: 0.3120 | Train Acc: 0.9143
 Site-Sketch                    (3) | Train Loss: 0.4068 | Train Acc: 0.8730
 Site-Sketch                    (3) | Train Loss: 0.4299 | Train Acc: 0.8635
 Site-QuickDraw                 (1) | Train Loss: 0.6437 | Train Acc: 0.7905
 Site-QuickDraw                 (1) | Train Loss: 0.5811 | Train Acc: 0.8296
 Site-Infograph                 (2) | Train Loss: 1.0051 | Train Acc: 0.6794
 Site-Infograph                 (2) | Train Loss: 0.8091 | Train Acc: 0.7481
Average Train Accuracy: 0.8543
 Site-Clipart                   (3) | Val  Loss: 0.3834 | Val  Acc: 0.8810
 Site-Clipart                   (0) | Val  Loss: 0.3722 | Val  Acc: 0.8873
 Site-Real                      (0) | Val  Loss: 0.3573 | Val  Acc: 0.9381
 Site-Real                      (0) | Val  Loss: 0.2415 | Val  Acc: 0.9333
 Site-Painting                  (4) | Val  Loss: 0.3901 | Val  Acc: 0.8762
 Site-Painting                  (4) | Val  Loss: 0.3169 | Val  Acc: 0.9190
 Site-Sketch                    (3) | Val  Loss: 0.5303 | Val  Acc: 0.8476
 Site-Sketch                    (3) | Val  Loss: 0.4232 | Val  Acc: 0.8730
 Site-QuickDraw                 (1) | Val  Loss: 0.5111 | Val  Acc: 0.8714
 Site-QuickDraw                 (1) | Val  Loss: 0.5594 | Val  Acc: 0.8270
 Site-Infograph                 (2) | Val  Loss: 0.7479 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.8384 | Val  Acc: 0.7254
Average Valid Accuracy: 0.8602
============ Train epoch 34 ============
cnt=[2, 2, 2, 3, 3, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (4) | Train Loss: 0.3400 | Train Acc: 0.8984
 Site-Clipart                   (4) | Train Loss: 0.3887 | Train Acc: 0.8762
 Site-Real                      (3) | Train Loss: 0.2225 | Train Acc: 0.9397
 Site-Real                      (4) | Train Loss: 0.2262 | Train Acc: 0.9439
 Site-Painting                  (3) | Train Loss: 0.3346 | Train Acc: 0.8984
 Site-Painting                  (3) | Train Loss: 0.3105 | Train Acc: 0.9175
 Site-Sketch                    (0) | Train Loss: 0.4016 | Train Acc: 0.8794
 Site-Sketch                    (0) | Train Loss: 0.3967 | Train Acc: 0.8783
 Site-QuickDraw                 (1) | Train Loss: 0.6741 | Train Acc: 0.7905
 Site-QuickDraw                 (1) | Train Loss: 0.5606 | Train Acc: 0.8317
 Site-Infograph                 (2) | Train Loss: 1.0287 | Train Acc: 0.6762
 Site-Infograph                 (2) | Train Loss: 0.8119 | Train Acc: 0.7418
Average Train Accuracy: 0.8560
 Site-Clipart                   (4) | Val  Loss: 0.3893 | Val  Acc: 0.9190
 Site-Clipart                   (4) | Val  Loss: 0.3743 | Val  Acc: 0.8905
 Site-Real                      (3) | Val  Loss: 0.3087 | Val  Acc: 0.9476
 Site-Real                      (4) | Val  Loss: 0.2225 | Val  Acc: 0.9397
 Site-Painting                  (3) | Val  Loss: 0.3692 | Val  Acc: 0.8714
 Site-Painting                  (3) | Val  Loss: 0.3186 | Val  Acc: 0.9143
 Site-Sketch                    (0) | Val  Loss: 0.5401 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.4026 | Val  Acc: 0.8730
 Site-QuickDraw                 (1) | Val  Loss: 0.5199 | Val  Acc: 0.8762
 Site-QuickDraw                 (1) | Val  Loss: 0.5525 | Val  Acc: 0.8397
 Site-Infograph                 (2) | Val  Loss: 0.6982 | Val  Acc: 0.7905
 Site-Infograph                 (2) | Val  Loss: 0.8117 | Val  Acc: 0.7540
Average Valid Accuracy: 0.8704
 Best site-Clipart                  (4)  | Epoch:34 | Val Acc: 0.9190
 Best site-Clipart                  (4)  | Epoch:34 | Val Acc: 0.8905
 Best site-Real                     (3)  | Epoch:34 | Val Acc: 0.9476
 Best site-Real                     (4)  | Epoch:34 | Val Acc: 0.9397
 Best site-Painting                 (3)  | Epoch:34 | Val Acc: 0.8714
 Best site-Painting                 (3)  | Epoch:34 | Val Acc: 0.9143
 Best site-Sketch                   (0)  | Epoch:34 | Val Acc: 0.8286
 Best site-Sketch                   (0)  | Epoch:34 | Val Acc: 0.8730
 Best site-QuickDraw                (1)  | Epoch:34 | Val Acc: 0.8762
 Best site-QuickDraw                (1)  | Epoch:34 | Val Acc: 0.8397
 Best site-Infograph                (2)  | Epoch:34 | Val Acc: 0.7905
 Best site-Infograph                (2)  | Epoch:34 | Val Acc: 0.7540
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (0) | Train Loss: 0.3532 | Train Acc: 0.9016
 Site-Clipart                   (0) | Train Loss: 0.3787 | Train Acc: 0.8836
 Site-Real                      (3) | Train Loss: 0.1930 | Train Acc: 0.9460
 Site-Real                      (3) | Train Loss: 0.2264 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.3435 | Train Acc: 0.8857
 Site-Painting                  (3) | Train Loss: 0.2895 | Train Acc: 0.9153
 Site-Sketch                    (4) | Train Loss: 0.4073 | Train Acc: 0.8635
 Site-Sketch                    (4) | Train Loss: 0.4064 | Train Acc: 0.8783
 Site-QuickDraw                 (1) | Train Loss: 0.6488 | Train Acc: 0.7841
 Site-QuickDraw                 (1) | Train Loss: 0.5798 | Train Acc: 0.8296
 Site-Infograph                 (2) | Train Loss: 1.0083 | Train Acc: 0.6762
 Site-Infograph                 (2) | Train Loss: 0.8182 | Train Acc: 0.7407
Average Train Accuracy: 0.8537
 Site-Clipart                   (0) | Val  Loss: 0.4173 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.3724 | Val  Acc: 0.8746
 Site-Real                      (3) | Val  Loss: 0.2936 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2140 | Val  Acc: 0.9460
 Site-Painting                  (3) | Val  Loss: 0.3273 | Val  Acc: 0.8952
 Site-Painting                  (3) | Val  Loss: 0.3110 | Val  Acc: 0.9206
 Site-Sketch                    (4) | Val  Loss: 0.5672 | Val  Acc: 0.8524
 Site-Sketch                    (4) | Val  Loss: 0.4258 | Val  Acc: 0.8651
 Site-QuickDraw                 (1) | Val  Loss: 0.4995 | Val  Acc: 0.8619
 Site-QuickDraw                 (1) | Val  Loss: 0.5769 | Val  Acc: 0.8222
 Site-Infograph                 (2) | Val  Loss: 0.6995 | Val  Acc: 0.7571
 Site-Infograph                 (2) | Val  Loss: 0.7901 | Val  Acc: 0.7587
Average Valid Accuracy: 0.8648
============ Train epoch 36 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (2) | Train Loss: 0.3507 | Train Acc: 0.8921
 Site-Clipart                   (2) | Train Loss: 0.3715 | Train Acc: 0.8931
 Site-Real                      (3) | Train Loss: 0.2065 | Train Acc: 0.9397
 Site-Real                      (3) | Train Loss: 0.2109 | Train Acc: 0.9471
 Site-Painting                  (3) | Train Loss: 0.3382 | Train Acc: 0.8952
 Site-Painting                  (3) | Train Loss: 0.2979 | Train Acc: 0.9143
 Site-Sketch                    (4) | Train Loss: 0.4106 | Train Acc: 0.8794
 Site-Sketch                    (4) | Train Loss: 0.3966 | Train Acc: 0.8688
 Site-QuickDraw                 (1) | Train Loss: 0.6540 | Train Acc: 0.8000
 Site-QuickDraw                 (1) | Train Loss: 0.5798 | Train Acc: 0.8169
 Site-Infograph                 (0) | Train Loss: 1.0133 | Train Acc: 0.6794
 Site-Infograph                 (0) | Train Loss: 0.8022 | Train Acc: 0.7471
Average Train Accuracy: 0.8561
 Site-Clipart                   (2) | Val  Loss: 0.3933 | Val  Acc: 0.9048
 Site-Clipart                   (2) | Val  Loss: 0.3572 | Val  Acc: 0.8984
 Site-Real                      (3) | Val  Loss: 0.2803 | Val  Acc: 0.9381
 Site-Real                      (3) | Val  Loss: 0.2071 | Val  Acc: 0.9444
 Site-Painting                  (3) | Val  Loss: 0.3390 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.3100 | Val  Acc: 0.9175
 Site-Sketch                    (4) | Val  Loss: 0.5177 | Val  Acc: 0.8429
 Site-Sketch                    (4) | Val  Loss: 0.3956 | Val  Acc: 0.8540
 Site-QuickDraw                 (1) | Val  Loss: 0.6074 | Val  Acc: 0.8429
 Site-QuickDraw                 (1) | Val  Loss: 0.5517 | Val  Acc: 0.8460
 Site-Infograph                 (0) | Val  Loss: 0.7093 | Val  Acc: 0.7667
 Site-Infograph                 (0) | Val  Loss: 0.7861 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8677
============ Train epoch 37 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.3553 | Train Acc: 0.8984
 Site-Clipart                   (4) | Train Loss: 0.3932 | Train Acc: 0.8762
 Site-Real                      (2) | Train Loss: 0.2207 | Train Acc: 0.9429
 Site-Real                      (2) | Train Loss: 0.2137 | Train Acc: 0.9460
 Site-Painting                  (2) | Train Loss: 0.3215 | Train Acc: 0.8952
 Site-Painting                  (2) | Train Loss: 0.2851 | Train Acc: 0.9185
 Site-Sketch                    (3) | Train Loss: 0.4175 | Train Acc: 0.8730
 Site-Sketch                    (3) | Train Loss: 0.3897 | Train Acc: 0.8709
 Site-QuickDraw                 (1) | Train Loss: 0.6134 | Train Acc: 0.8159
 Site-QuickDraw                 (1) | Train Loss: 0.5790 | Train Acc: 0.8286
 Site-Infograph                 (0) | Train Loss: 1.0371 | Train Acc: 0.6635
 Site-Infograph                 (0) | Train Loss: 0.7977 | Train Acc: 0.7460
Average Train Accuracy: 0.8563
 Site-Clipart                   (4) | Val  Loss: 0.4271 | Val  Acc: 0.8905
 Site-Clipart                   (4) | Val  Loss: 0.3766 | Val  Acc: 0.8905
 Site-Real                      (2) | Val  Loss: 0.3524 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2212 | Val  Acc: 0.9492
 Site-Painting                  (2) | Val  Loss: 0.4337 | Val  Acc: 0.8810
 Site-Painting                  (2) | Val  Loss: 0.3216 | Val  Acc: 0.9063
 Site-Sketch                    (3) | Val  Loss: 0.4951 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.3790 | Val  Acc: 0.8794
 Site-QuickDraw                 (1) | Val  Loss: 0.5223 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.5300 | Val  Acc: 0.8460
 Site-Infograph                 (0) | Val  Loss: 0.7359 | Val  Acc: 0.7762
 Site-Infograph                 (0) | Val  Loss: 0.7779 | Val  Acc: 0.7540
Average Valid Accuracy: 0.8676
============ Train epoch 38 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (0) | Train Loss: 0.3225 | Train Acc: 0.9016
 Site-Clipart                   (0) | Train Loss: 0.3915 | Train Acc: 0.8815
 Site-Real                      (3) | Train Loss: 0.2184 | Train Acc: 0.9429
 Site-Real                      (3) | Train Loss: 0.2372 | Train Acc: 0.9312
 Site-Painting                  (3) | Train Loss: 0.3178 | Train Acc: 0.8921
 Site-Painting                  (3) | Train Loss: 0.2978 | Train Acc: 0.9185
 Site-Sketch                    (4) | Train Loss: 0.4167 | Train Acc: 0.8571
 Site-Sketch                    (4) | Train Loss: 0.4190 | Train Acc: 0.8624
 Site-QuickDraw                 (1) | Train Loss: 0.6396 | Train Acc: 0.8000
 Site-QuickDraw                 (1) | Train Loss: 0.5583 | Train Acc: 0.8296
 Site-Infograph                 (2) | Train Loss: 0.9629 | Train Acc: 0.7333
 Site-Infograph                 (2) | Train Loss: 0.7867 | Train Acc: 0.7534
Average Train Accuracy: 0.8586
 Site-Clipart                   (0) | Val  Loss: 0.3776 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3796 | Val  Acc: 0.8873
 Site-Real                      (3) | Val  Loss: 0.3249 | Val  Acc: 0.9429
 Site-Real                      (3) | Val  Loss: 0.2332 | Val  Acc: 0.9365
 Site-Painting                  (3) | Val  Loss: 0.3755 | Val  Acc: 0.8714
 Site-Painting                  (3) | Val  Loss: 0.3183 | Val  Acc: 0.9111
 Site-Sketch                    (4) | Val  Loss: 0.4945 | Val  Acc: 0.8619
 Site-Sketch                    (4) | Val  Loss: 0.4031 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.5038 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.5320 | Val  Acc: 0.8413
 Site-Infograph                 (2) | Val  Loss: 0.7038 | Val  Acc: 0.7810
 Site-Infograph                 (2) | Val  Loss: 0.7864 | Val  Acc: 0.7540
Average Valid Accuracy: 0.8684
============ Train epoch 39 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (4) | Train Loss: 0.3437 | Train Acc: 0.8952
 Site-Clipart                   (4) | Train Loss: 0.3618 | Train Acc: 0.8910
 Site-Real                      (0) | Train Loss: 0.2482 | Train Acc: 0.9365
 Site-Real                      (0) | Train Loss: 0.2095 | Train Acc: 0.9418
 Site-Painting                  (0) | Train Loss: 0.3113 | Train Acc: 0.8984
 Site-Painting                  (0) | Train Loss: 0.2944 | Train Acc: 0.9185
 Site-Sketch                    (3) | Train Loss: 0.3845 | Train Acc: 0.8730
 Site-Sketch                    (3) | Train Loss: 0.3928 | Train Acc: 0.8709
 Site-QuickDraw                 (1) | Train Loss: 0.6608 | Train Acc: 0.7937
 Site-QuickDraw                 (1) | Train Loss: 0.5507 | Train Acc: 0.8360
 Site-Infograph                 (2) | Train Loss: 0.9839 | Train Acc: 0.6730
 Site-Infograph                 (2) | Train Loss: 0.7780 | Train Acc: 0.7481
Average Train Accuracy: 0.8563
 Site-Clipart                   (4) | Val  Loss: 0.3669 | Val  Acc: 0.9238
 Site-Clipart                   (4) | Val  Loss: 0.3662 | Val  Acc: 0.8825
 Site-Real                      (0) | Val  Loss: 0.3106 | Val  Acc: 0.9571
 Site-Real                      (0) | Val  Loss: 0.2075 | Val  Acc: 0.9397
 Site-Painting                  (0) | Val  Loss: 0.3590 | Val  Acc: 0.9143
 Site-Painting                  (0) | Val  Loss: 0.2904 | Val  Acc: 0.9127
 Site-Sketch                    (3) | Val  Loss: 0.5540 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.3981 | Val  Acc: 0.8524
 Site-QuickDraw                 (1) | Val  Loss: 0.5322 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.5457 | Val  Acc: 0.8587
 Site-Infograph                 (2) | Val  Loss: 0.6755 | Val  Acc: 0.8000
 Site-Infograph                 (2) | Val  Loss: 0.7596 | Val  Acc: 0.7619
Average Valid Accuracy: 0.8757
 Best site-Clipart                  (4)  | Epoch:39 | Val Acc: 0.9238
 Best site-Clipart                  (4)  | Epoch:39 | Val Acc: 0.8825
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9571
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9397
 Best site-Painting                 (0)  | Epoch:39 | Val Acc: 0.9143
 Best site-Painting                 (0)  | Epoch:39 | Val Acc: 0.9127
 Best site-Sketch                   (3)  | Epoch:39 | Val Acc: 0.8571
 Best site-Sketch                   (3)  | Epoch:39 | Val Acc: 0.8524
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.8476
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.8587
 Best site-Infograph                (2)  | Epoch:39 | Val Acc: 0.8000
 Best site-Infograph                (2)  | Epoch:39 | Val Acc: 0.7619
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 40 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (4) | Train Loss: 0.3457 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3623 | Train Acc: 0.8931
 Site-Real                      (0) | Train Loss: 0.2305 | Train Acc: 0.9397
 Site-Real                      (0) | Train Loss: 0.2146 | Train Acc: 0.9407
 Site-Painting                  (0) | Train Loss: 0.3333 | Train Acc: 0.8921
 Site-Painting                  (0) | Train Loss: 0.2901 | Train Acc: 0.9122
 Site-Sketch                    (3) | Train Loss: 0.4137 | Train Acc: 0.8603
 Site-Sketch                    (3) | Train Loss: 0.3911 | Train Acc: 0.8762
 Site-QuickDraw                 (1) | Train Loss: 0.6814 | Train Acc: 0.7714
 Site-QuickDraw                 (1) | Train Loss: 0.5716 | Train Acc: 0.8233
 Site-Infograph                 (2) | Train Loss: 1.0108 | Train Acc: 0.6921
 Site-Infograph                 (2) | Train Loss: 0.7843 | Train Acc: 0.7598
Average Train Accuracy: 0.8541
 Site-Clipart                   (4) | Val  Loss: 0.3864 | Val  Acc: 0.9333
 Site-Clipart                   (4) | Val  Loss: 0.3494 | Val  Acc: 0.8778
 Site-Real                      (0) | Val  Loss: 0.3384 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2238 | Val  Acc: 0.9444
 Site-Painting                  (0) | Val  Loss: 0.3762 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.3073 | Val  Acc: 0.9079
 Site-Sketch                    (3) | Val  Loss: 0.5529 | Val  Acc: 0.8333
 Site-Sketch                    (3) | Val  Loss: 0.4091 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.5120 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.5514 | Val  Acc: 0.8143
 Site-Infograph                 (2) | Val  Loss: 0.6654 | Val  Acc: 0.7905
 Site-Infograph                 (2) | Val  Loss: 0.7795 | Val  Acc: 0.7556
Average Valid Accuracy: 0.8671
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8802
 Test site-Real                      (0)| Epoch:39 | Test Acc: 0.9474
 Test site-Painting                  (0)| Epoch:39 | Test Acc: 0.9305
 Test site-Sketch                    (3)| Epoch:39 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7910
 Test site-Infograph                 (2)| Epoch:39 | Test Acc: 0.6362
Clipart: 0.8802, Real: 0.9474, Painting: 0.9305, Sketch: 0.8845, QuickDraw: 0.7910, Infograph: 0.6362, 
Average Test Accuracy(group): 0.8450, Average Test Accuracy(individual): 0.8450,
domain std=0.1058, cluster std=0.1062, individual std=0.1058, 
===2023-07-31 10:51:13===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[315,945,315,945,315,945,315,945,315,945,315,945,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 5
Loading snapshots...
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8821
 Test site-Real                      (0)| Epoch:39 | Test Acc: 0.9449
 Test site-Painting                  (0)| Epoch:39 | Test Acc: 0.9289
 Test site-Sketch                    (3)| Epoch:39 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7960
 Test site-Infograph                 (2)| Epoch:39 | Test Acc: 0.6362
Clipart: 0.8821, Real: 0.9449, Painting: 0.9289, Sketch: 0.8845, QuickDraw: 0.7960, Infograph: 0.6362, 
Average Test Accuracy(group): 0.8454, Average Test Accuracy(individual): 0.8454,
domain std=0.1048, cluster std=0.1056, individual std=0.1048, 
