===2023-07-03 02:28:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.7736 | Train Acc: 0.6892
 Site-USPS                          | Train Loss: 1.6766 | Train Acc: 0.6723
 Site-SynthDigits                   | Train Loss: 2.1164 | Train Acc: 0.3446
 Site-MNIST_M                       | Train Loss: 2.1608 | Train Acc: 0.3750
 Site-SVHN                          | Train Loss: 2.1712 | Train Acc: 0.2230
Average Train Accuracy: 0.4608
 Site-MNIST                         | Val  Loss: 1.6829 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.7507 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 2.1509 | Val  Acc: 0.3243
 Site-MNIST_M                       | Val  Loss: 2.1311 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.2053 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4649
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6216
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.3525 | Train Acc: 0.7635
 Site-USPS                          | Train Loss: 1.2794 | Train Acc: 0.7872
 Site-SynthDigits                   | Train Loss: 1.9056 | Train Acc: 0.4966
===2023-07-03 09:07:58===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.7736 | Train Acc: 0.6892
 Site-USPS                          | Train Loss: 1.6766 | Train Acc: 0.6723
 Site-SynthDigits                   | Train Loss: 2.1164 | Train Acc: 0.3446
 Site-MNIST_M                       | Train Loss: 2.1608 | Train Acc: 0.3750
 Site-SVHN                          | Train Loss: 2.1712 | Train Acc: 0.2230
Average Train Accuracy: 0.4608
 Site-MNIST                         | Val  Loss: 1.6829 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.7507 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 2.1509 | Val  Acc: 0.3243
 Site-MNIST_M                       | Val  Loss: 2.1311 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.2053 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4649
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6216
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.3525 | Train Acc: 0.7635
 Site-USPS                          | Train Loss: 1.2794 | Train Acc: 0.7872
 Site-SynthDigits                   | Train Loss: 1.9056 | Train Acc: 0.4966
 Site-MNIST_M                       | Train Loss: 2.0260 | Train Acc: 0.4020
 Site-SVHN                          | Train Loss: 2.0829 | Train Acc: 0.3074
Average Train Accuracy: 0.5514
 Site-MNIST                         | Val  Loss: 1.2355 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.3730 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.9156 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.9931 | Val  Acc: 0.4189
 Site-SVHN                          | Val  Loss: 2.1225 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5541
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4189
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.1000 | Train Acc: 0.7635
 Site-USPS                          | Train Loss: 1.0392 | Train Acc: 0.7568
 Site-SynthDigits                   | Train Loss: 1.7649 | Train Acc: 0.5135
 Site-MNIST_M                       | Train Loss: 1.9240 | Train Acc: 0.4358
 Site-SVHN                          | Train Loss: 2.0099 | Train Acc: 0.3277
Average Train Accuracy: 0.5595
 Site-MNIST                         | Val  Loss: 0.9830 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.1562 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 1.7899 | Val  Acc: 0.4730
 Site-MNIST_M                       | Val  Loss: 1.8646 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 2.0363 | Val  Acc: 0.3784
Average Valid Accuracy: 0.5676
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7162
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4730
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.9311 | Train Acc: 0.8074
 Site-USPS                          | Train Loss: 0.7972 | Train Acc: 0.8277
 Site-SynthDigits                   | Train Loss: 1.5924 | Train Acc: 0.5304
 Site-MNIST_M                       | Train Loss: 1.7263 | Train Acc: 0.5203
 Site-SVHN                          | Train Loss: 1.9382 | Train Acc: 0.3919
Average Train Accuracy: 0.6155
 Site-MNIST                         | Val  Loss: 0.8407 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8774 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.6703 | Val  Acc: 0.5135
 Site-MNIST_M                       | Val  Loss: 1.7051 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 2.0573 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6108
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8243
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.7731 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.7266 | Train Acc: 0.8446
 Site-SynthDigits                   | Train Loss: 1.5195 | Train Acc: 0.5676
 Site-MNIST_M                       | Train Loss: 1.6629 | Train Acc: 0.5709
 Site-SVHN                          | Train Loss: 1.8805 | Train Acc: 0.4054
Average Train Accuracy: 0.6453
 Site-MNIST                         | Val  Loss: 0.7047 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.8055 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.6481 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.6546 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.9760 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6541
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5405
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5811
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.6797 | Train Acc: 0.8547
 Site-USPS                          | Train Loss: 0.6206 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.4208 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.5173 | Train Acc: 0.5912
 Site-SVHN                          | Train Loss: 1.8098 | Train Acc: 0.4155
Average Train Accuracy: 0.6669
 Site-MNIST                         | Val  Loss: 0.6210 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.6476 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.4795 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.5503 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.9432 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6730
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6081
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5811
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.6169 | Train Acc: 0.8547
 Site-USPS                          | Train Loss: 0.5530 | Train Acc: 0.8919
 Site-SynthDigits                   | Train Loss: 1.3553 | Train Acc: 0.6216
 Site-MNIST_M                       | Train Loss: 1.4717 | Train Acc: 0.6047
 Site-SVHN                          | Train Loss: 1.7607 | Train Acc: 0.4358
Average Train Accuracy: 0.6818
 Site-MNIST                         | Val  Loss: 0.5700 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.5960 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.5104 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.5186 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.8752 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6919
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9189
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6216
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.6351
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.5574 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.5010 | Train Acc: 0.8953
 Site-SynthDigits                   | Train Loss: 1.2845 | Train Acc: 0.6419
 Site-MNIST_M                       | Train Loss: 1.3582 | Train Acc: 0.6520
 Site-SVHN                          | Train Loss: 1.6845 | Train Acc: 0.4459
Average Train Accuracy: 0.6973
 Site-MNIST                         | Val  Loss: 0.5376 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.5325 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.3995 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.3886 | Val  Acc: 0.6622
 Site-SVHN                          | Val  Loss: 1.8819 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7000
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6351
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.6622
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.4784 | Train Acc: 0.8953
 Site-USPS                          | Train Loss: 0.4535 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.2261 | Train Acc: 0.6385
 Site-MNIST_M                       | Train Loss: 1.2767 | Train Acc: 0.6926
 Site-SVHN                          | Train Loss: 1.6391 | Train Acc: 0.4493
Average Train Accuracy: 0.7128
 Site-MNIST                         | Val  Loss: 0.4845 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.5136 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.3739 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.3306 | Val  Acc: 0.7162
 Site-SVHN                          | Val  Loss: 1.8213 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7243
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6486
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.7162
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.4682 | Train Acc: 0.8649
 Site-USPS                          | Train Loss: 0.3996 | Train Acc: 0.9155
 Site-SynthDigits                   | Train Loss: 1.1843 | Train Acc: 0.6486
 Site-MNIST_M                       | Train Loss: 1.2477 | Train Acc: 0.6993
 Site-SVHN                          | Train Loss: 1.6354 | Train Acc: 0.4527
Average Train Accuracy: 0.7162
 Site-MNIST                         | Val  Loss: 0.4753 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.4116 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 1.3085 | Val  Acc: 0.6757
 Site-MNIST_M                       | Val  Loss: 1.2683 | Val  Acc: 0.7568
 Site-SVHN                          | Val  Loss: 1.8025 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7351
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.6757
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.7568
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.4276 | Train Acc: 0.8784
 Site-USPS                          | Train Loss: 0.3767 | Train Acc: 0.9122
 Site-SynthDigits                   | Train Loss: 1.1571 | Train Acc: 0.6655
 Site-MNIST_M                       | Train Loss: 1.1672 | Train Acc: 0.7297
 Site-SVHN                          | Train Loss: 1.5891 | Train Acc: 0.5034
Average Train Accuracy: 0.7378
 Site-MNIST                         | Val  Loss: 0.4405 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.4233 | Val  Acc: 0.9324
 Site-SynthDigits                   | Val  Loss: 1.2917 | Val  Acc: 0.6757
 Site-MNIST_M                       | Val  Loss: 1.1963 | Val  Acc: 0.7432
 Site-SVHN                          | Val  Loss: 1.7936 | Val  Acc: 0.5405
Average Valid Accuracy: 0.7405
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9324
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.6757
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.7432
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5405
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.3741 | Train Acc: 0.9122
 Site-USPS                          | Train Loss: 0.3552 | Train Acc: 0.9257
 Site-SynthDigits                   | Train Loss: 1.1245 | Train Acc: 0.6689
 Site-MNIST_M                       | Train Loss: 1.1018 | Train Acc: 0.7230
 Site-SVHN                          | Train Loss: 1.5395 | Train Acc: 0.5270
Average Train Accuracy: 0.7514
 Site-MNIST                         | Val  Loss: 0.3750 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.3843 | Val  Acc: 0.9324
 Site-SynthDigits                   | Val  Loss: 1.3036 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.1418 | Val  Acc: 0.7568
 Site-SVHN                          | Val  Loss: 1.7411 | Val  Acc: 0.5676
Average Valid Accuracy: 0.7541
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9324
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6622
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.7568
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.3537 | Train Acc: 0.8986
 Site-USPS                          | Train Loss: 0.3521 | Train Acc: 0.9223
 Site-SynthDigits                   | Train Loss: 1.0470 | Train Acc: 0.7095
 Site-MNIST_M                       | Train Loss: 1.0496 | Train Acc: 0.7432
 Site-SVHN                          | Train Loss: 1.4796 | Train Acc: 0.5541
Average Train Accuracy: 0.7655
 Site-MNIST                         | Val  Loss: 0.3757 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.3844 | Val  Acc: 0.9324
 Site-SynthDigits                   | Val  Loss: 1.1560 | Val  Acc: 0.7027
 Site-MNIST_M                       | Val  Loss: 1.0889 | Val  Acc: 0.7973
 Site-SVHN                          | Val  Loss: 1.6385 | Val  Acc: 0.5676
Average Valid Accuracy: 0.7703
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9324
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.7027
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.7973
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.3473 | Train Acc: 0.9122
 Site-USPS                          | Train Loss: 0.2973 | Train Acc: 0.9426
 Site-SynthDigits                   | Train Loss: 1.0335 | Train Acc: 0.7061
 Site-MNIST_M                       | Train Loss: 1.0175 | Train Acc: 0.7601
 Site-SVHN                          | Train Loss: 1.4670 | Train Acc: 0.5507
Average Train Accuracy: 0.7743
 Site-MNIST                         | Val  Loss: 0.3709 | Val  Acc: 0.8784
 Site-USPS                          | Val  Loss: 0.3354 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 1.2032 | Val  Acc: 0.6892
 Site-MNIST_M                       | Val  Loss: 1.0535 | Val  Acc: 0.8108
 Site-SVHN                          | Val  Loss: 1.6447 | Val  Acc: 0.5946
Average Valid Accuracy: 0.7838
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8784
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6892
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.8108
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.3021 | Train Acc: 0.9223
 Site-USPS                          | Train Loss: 0.2957 | Train Acc: 0.9257
 Site-SynthDigits                   | Train Loss: 1.0084 | Train Acc: 0.7297
 Site-MNIST_M                       | Train Loss: 0.9478 | Train Acc: 0.7770
 Site-SVHN                          | Train Loss: 1.4327 | Train Acc: 0.5709
Average Train Accuracy: 0.7851
 Site-MNIST                         | Val  Loss: 0.3251 | Val  Acc: 0.8919
 Site-USPS                          | Val  Loss: 0.3018 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 1.0610 | Val  Acc: 0.7297
 Site-MNIST_M                       | Val  Loss: 0.9887 | Val  Acc: 0.8108
 Site-SVHN                          | Val  Loss: 1.5996 | Val  Acc: 0.6081
Average Valid Accuracy: 0.7973
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8919
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.7297
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.8108
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.2977 | Train Acc: 0.9223
 Site-USPS                          | Train Loss: 0.2745 | Train Acc: 0.9358
 Site-SynthDigits                   | Train Loss: 0.9182 | Train Acc: 0.7601
 Site-MNIST_M                       | Train Loss: 0.9476 | Train Acc: 0.7973
 Site-SVHN                          | Train Loss: 1.4007 | Train Acc: 0.5912
Average Train Accuracy: 0.8014
 Site-MNIST                         | Val  Loss: 0.3456 | Val  Acc: 0.8784
 Site-USPS                          | Val  Loss: 0.3236 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 1.0186 | Val  Acc: 0.7432
 Site-MNIST_M                       | Val  Loss: 0.9924 | Val  Acc: 0.8243
 Site-SVHN                          | Val  Loss: 1.5542 | Val  Acc: 0.5946
Average Valid Accuracy: 0.7973
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.2637 | Train Acc: 0.9358
 Site-USPS                          | Train Loss: 0.2507 | Train Acc: 0.9493
 Site-SynthDigits                   | Train Loss: 0.9213 | Train Acc: 0.7500
 Site-MNIST_M                       | Train Loss: 0.8590 | Train Acc: 0.7939
 Site-SVHN                          | Train Loss: 1.3804 | Train Acc: 0.6014
Average Train Accuracy: 0.8061
 Site-MNIST                         | Val  Loss: 0.2726 | Val  Acc: 0.9054
 Site-USPS                          | Val  Loss: 0.2836 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 1.0122 | Val  Acc: 0.7432
 Site-MNIST_M                       | Val  Loss: 0.8910 | Val  Acc: 0.8243
 Site-SVHN                          | Val  Loss: 1.5364 | Val  Acc: 0.6081
Average Valid Accuracy: 0.8054
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9054
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7432
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.8243
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.2671 | Train Acc: 0.9291
 Site-USPS                          | Train Loss: 0.2374 | Train Acc: 0.9595
 Site-SynthDigits                   | Train Loss: 0.8639 | Train Acc: 0.7669
 Site-MNIST_M                       | Train Loss: 0.8382 | Train Acc: 0.8142
 Site-SVHN                          | Train Loss: 1.3335 | Train Acc: 0.6081
Average Train Accuracy: 0.8155
 Site-MNIST                         | Val  Loss: 0.2998 | Val  Acc: 0.8919
 Site-USPS                          | Val  Loss: 0.2853 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.9682 | Val  Acc: 0.7162
 Site-MNIST_M                       | Val  Loss: 0.8933 | Val  Acc: 0.8649
 Site-SVHN                          | Val  Loss: 1.4689 | Val  Acc: 0.6216
Average Valid Accuracy: 0.8081
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8919
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7162
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.8649
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.6216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.2260 | Train Acc: 0.9426
 Site-USPS                          | Train Loss: 0.2274 | Train Acc: 0.9561
 Site-SynthDigits                   | Train Loss: 0.8629 | Train Acc: 0.7669
 Site-MNIST_M                       | Train Loss: 0.8063 | Train Acc: 0.8277
 Site-SVHN                          | Train Loss: 1.3222 | Train Acc: 0.6351
Average Train Accuracy: 0.8257
 Site-MNIST                         | Val  Loss: 0.2531 | Val  Acc: 0.9054
 Site-USPS                          | Val  Loss: 0.2805 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.9553 | Val  Acc: 0.7703
 Site-MNIST_M                       | Val  Loss: 0.8534 | Val  Acc: 0.8514
 Site-SVHN                          | Val  Loss: 1.4437 | Val  Acc: 0.6622
Average Valid Accuracy: 0.8270
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9054
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7703
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.8514
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.6622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.2225 | Train Acc: 0.9527
 Site-USPS                          | Train Loss: 0.2164 | Train Acc: 0.9595
 Site-SynthDigits                   | Train Loss: 0.8453 | Train Acc: 0.7804
 Site-MNIST_M                       | Train Loss: 0.7637 | Train Acc: 0.8514
 Site-SVHN                          | Train Loss: 1.2644 | Train Acc: 0.6520
Average Train Accuracy: 0.8392
 Site-MNIST                         | Val  Loss: 0.2528 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.2746 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.9394 | Val  Acc: 0.7432
 Site-MNIST_M                       | Val  Loss: 0.8059 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 1.4166 | Val  Acc: 0.6892
Average Valid Accuracy: 0.8459
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9189
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7432
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.9324
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.6892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.2263 | Train Acc: 0.9459
 Site-USPS                          | Train Loss: 0.1985 | Train Acc: 0.9527
 Site-SynthDigits                   | Train Loss: 0.7868 | Train Acc: 0.8041
 Site-MNIST_M                       | Train Loss: 0.7388 | Train Acc: 0.8581
 Site-SVHN                          | Train Loss: 1.2390 | Train Acc: 0.6453
Average Train Accuracy: 0.8412
 Site-MNIST                         | Val  Loss: 0.2362 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.2349 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.8718 | Val  Acc: 0.8108
 Site-MNIST_M                       | Val  Loss: 0.7737 | Val  Acc: 0.8919
 Site-SVHN                          | Val  Loss: 1.4046 | Val  Acc: 0.6757
Average Valid Accuracy: 0.8486
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9189
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.8108
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.8919
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.6757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.2191 | Train Acc: 0.9459
 Site-USPS                          | Train Loss: 0.1840 | Train Acc: 0.9527
 Site-SynthDigits                   | Train Loss: 0.7765 | Train Acc: 0.8108
 Site-MNIST_M                       | Train Loss: 0.6930 | Train Acc: 0.8953
 Site-SVHN                          | Train Loss: 1.2062 | Train Acc: 0.6723
Average Train Accuracy: 0.8554
 Site-MNIST                         | Val  Loss: 0.2141 | Val  Acc: 0.9324
 Site-USPS                          | Val  Loss: 0.2296 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.8775 | Val  Acc: 0.7838
 Site-MNIST_M                       | Val  Loss: 0.7448 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 1.3501 | Val  Acc: 0.7162
Average Valid Accuracy: 0.8622
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9324
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.7838
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.9324
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.7162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.2041 | Train Acc: 0.9561
 Site-USPS                          | Train Loss: 0.1805 | Train Acc: 0.9561
 Site-SynthDigits                   | Train Loss: 0.7555 | Train Acc: 0.8209
 Site-MNIST_M                       | Train Loss: 0.6679 | Train Acc: 0.8885
 Site-SVHN                          | Train Loss: 1.1736 | Train Acc: 0.7027
Average Train Accuracy: 0.8649
 Site-MNIST                         | Val  Loss: 0.2074 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.2165 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.8516 | Val  Acc: 0.8243
 Site-MNIST_M                       | Val  Loss: 0.6981 | Val  Acc: 0.9054
 Site-SVHN                          | Val  Loss: 1.3266 | Val  Acc: 0.6892
Average Valid Accuracy: 0.8568
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.1895 | Train Acc: 0.9426
 Site-USPS                          | Train Loss: 0.1782 | Train Acc: 0.9527
 Site-SynthDigits                   | Train Loss: 0.7554 | Train Acc: 0.8209
 Site-MNIST_M                       | Train Loss: 0.6429 | Train Acc: 0.8750
 Site-SVHN                          | Train Loss: 1.1525 | Train Acc: 0.7061
Average Train Accuracy: 0.8595
 Site-MNIST                         | Val  Loss: 0.2138 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.2282 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.8613 | Val  Acc: 0.7703
 Site-MNIST_M                       | Val  Loss: 0.6708 | Val  Acc: 0.8919
 Site-SVHN                          | Val  Loss: 1.3355 | Val  Acc: 0.7027
Average Valid Accuracy: 0.8459
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.1823 | Train Acc: 0.9628
 Site-USPS                          | Train Loss: 0.1654 | Train Acc: 0.9696
 Site-SynthDigits                   | Train Loss: 0.7216 | Train Acc: 0.8243
 Site-MNIST_M                       | Train Loss: 0.6077 | Train Acc: 0.8750
 Site-SVHN                          | Train Loss: 1.1253 | Train Acc: 0.6892
Average Train Accuracy: 0.8642
 Site-MNIST                         | Val  Loss: 0.2085 | Val  Acc: 0.9324
 Site-USPS                          | Val  Loss: 0.2023 | Val  Acc: 0.9595
 Site-SynthDigits                   | Val  Loss: 0.8051 | Val  Acc: 0.8649
 Site-MNIST_M                       | Val  Loss: 0.6367 | Val  Acc: 0.9189
 Site-SVHN                          | Val  Loss: 1.2895 | Val  Acc: 0.6892
Average Valid Accuracy: 0.8730
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9324
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9595
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.8649
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.9189
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.6892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.1734 | Train Acc: 0.9527
 Site-USPS                          | Train Loss: 0.1473 | Train Acc: 0.9662
 Site-SynthDigits                   | Train Loss: 0.6786 | Train Acc: 0.8514
 Site-MNIST_M                       | Train Loss: 0.5990 | Train Acc: 0.8953
 Site-SVHN                          | Train Loss: 1.1038 | Train Acc: 0.7162
Average Train Accuracy: 0.8764
 Site-MNIST                         | Val  Loss: 0.1998 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.1945 | Val  Acc: 0.9595
 Site-SynthDigits                   | Val  Loss: 0.7928 | Val  Acc: 0.8243
 Site-MNIST_M                       | Val  Loss: 0.6137 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 1.2670 | Val  Acc: 0.7162
Average Valid Accuracy: 0.8703
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.1661 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1382 | Train Acc: 0.9696
 Site-SynthDigits                   | Train Loss: 0.6700 | Train Acc: 0.8311
 Site-MNIST_M                       | Train Loss: 0.5686 | Train Acc: 0.8953
 Site-SVHN                          | Train Loss: 1.0492 | Train Acc: 0.7196
Average Train Accuracy: 0.8750
 Site-MNIST                         | Val  Loss: 0.1910 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.2014 | Val  Acc: 0.9595
 Site-SynthDigits                   | Val  Loss: 0.7532 | Val  Acc: 0.8243
 Site-MNIST_M                       | Val  Loss: 0.6150 | Val  Acc: 0.9459
 Site-SVHN                          | Val  Loss: 1.2280 | Val  Acc: 0.7297
Average Valid Accuracy: 0.8757
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9189
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9595
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.8243
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.9459
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.1603 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1437 | Train Acc: 0.9764
 Site-SynthDigits                   | Train Loss: 0.6809 | Train Acc: 0.8446
 Site-MNIST_M                       | Train Loss: 0.5437 | Train Acc: 0.9189
 Site-SVHN                          | Train Loss: 1.0414 | Train Acc: 0.7128
Average Train Accuracy: 0.8824
 Site-MNIST                         | Val  Loss: 0.1748 | Val  Acc: 0.9459
 Site-USPS                          | Val  Loss: 0.1811 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.7324 | Val  Acc: 0.8378
 Site-MNIST_M                       | Val  Loss: 0.5771 | Val  Acc: 0.9459
 Site-SVHN                          | Val  Loss: 1.1842 | Val  Acc: 0.7432
Average Valid Accuracy: 0.8919
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9459
 Best site-USPS                      | Epoch:27 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.8378
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.9459
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.7432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.1478 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1430 | Train Acc: 0.9764
 Site-SynthDigits                   | Train Loss: 0.6458 | Train Acc: 0.8716
 Site-MNIST_M                       | Train Loss: 0.5119 | Train Acc: 0.9054
 Site-SVHN                          | Train Loss: 1.0243 | Train Acc: 0.7432
Average Train Accuracy: 0.8912
 Site-MNIST                         | Val  Loss: 0.1705 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.1636 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6633 | Val  Acc: 0.8649
 Site-MNIST_M                       | Val  Loss: 0.5345 | Val  Acc: 0.9595
 Site-SVHN                          | Val  Loss: 1.1908 | Val  Acc: 0.7297
Average Valid Accuracy: 0.8919
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.1490 | Train Acc: 0.9628
 Site-USPS                          | Train Loss: 0.1396 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.6197 | Train Acc: 0.8750
 Site-MNIST_M                       | Train Loss: 0.4865 | Train Acc: 0.9155
 Site-SVHN                          | Train Loss: 0.9940 | Train Acc: 0.7568
Average Train Accuracy: 0.8966
 Site-MNIST                         | Val  Loss: 0.1641 | Val  Acc: 0.9324
 Site-USPS                          | Val  Loss: 0.1713 | Val  Acc: 0.9730
 Site-SynthDigits                   | Val  Loss: 0.6513 | Val  Acc: 0.8784
 Site-MNIST_M                       | Val  Loss: 0.5414 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 1.1136 | Val  Acc: 0.7568
Average Valid Accuracy: 0.8946
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9324
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9730
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.8784
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.9324
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.7568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.1403 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1209 | Train Acc: 0.9797
 Site-SynthDigits                   | Train Loss: 0.5986 | Train Acc: 0.8750
 Site-MNIST_M                       | Train Loss: 0.4839 | Train Acc: 0.9324
 Site-SVHN                          | Train Loss: 0.9904 | Train Acc: 0.7635
Average Train Accuracy: 0.9020
 Site-MNIST                         | Val  Loss: 0.1755 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.1521 | Val  Acc: 0.9730
 Site-SynthDigits                   | Val  Loss: 0.6725 | Val  Acc: 0.8649
 Site-MNIST_M                       | Val  Loss: 0.5228 | Val  Acc: 0.9730
 Site-SVHN                          | Val  Loss: 1.1205 | Val  Acc: 0.7703
Average Valid Accuracy: 0.9000
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9189
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9730
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.8649
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.9730
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.7703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.1331 | Train Acc: 0.9628
 Site-USPS                          | Train Loss: 0.1224 | Train Acc: 0.9764
 Site-SynthDigits                   | Train Loss: 0.5863 | Train Acc: 0.8885
 Site-MNIST_M                       | Train Loss: 0.4599 | Train Acc: 0.9392
 Site-SVHN                          | Train Loss: 0.9499 | Train Acc: 0.7703
Average Train Accuracy: 0.9074
 Site-MNIST                         | Val  Loss: 0.1620 | Val  Acc: 0.9324
 Site-USPS                          | Val  Loss: 0.1465 | Val  Acc: 0.9730
 Site-SynthDigits                   | Val  Loss: 0.6279 | Val  Acc: 0.9054
 Site-MNIST_M                       | Val  Loss: 0.4901 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 1.0886 | Val  Acc: 0.7838
Average Valid Accuracy: 0.9162
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9324
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9730
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.9054
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.9865
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.7838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.1323 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.1209 | Train Acc: 0.9831
 Site-SynthDigits                   | Train Loss: 0.5578 | Train Acc: 0.8885
 Site-MNIST_M                       | Train Loss: 0.4363 | Train Acc: 0.9493
 Site-SVHN                          | Train Loss: 0.9147 | Train Acc: 0.7770
Average Train Accuracy: 0.9149
 Site-MNIST                         | Val  Loss: 0.1563 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1595 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6109 | Val  Acc: 0.9189
 Site-MNIST_M                       | Val  Loss: 0.4731 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 1.0290 | Val  Acc: 0.8108
Average Valid Accuracy: 0.9351
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9730
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.9189
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.9865
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.8108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.1253 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.1122 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.5532 | Train Acc: 0.8919
 Site-MNIST_M                       | Train Loss: 0.4120 | Train Acc: 0.9527
 Site-SVHN                          | Train Loss: 0.9312 | Train Acc: 0.8007
Average Train Accuracy: 0.9216
 Site-MNIST                         | Val  Loss: 0.1394 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1504 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6116 | Val  Acc: 0.9324
 Site-MNIST_M                       | Val  Loss: 0.4447 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 1.0591 | Val  Acc: 0.7973
Average Valid Accuracy: 0.9351
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1274 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.1042 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.5506 | Train Acc: 0.9054
 Site-MNIST_M                       | Train Loss: 0.4207 | Train Acc: 0.9426
 Site-SVHN                          | Train Loss: 0.8872 | Train Acc: 0.7939
Average Train Accuracy: 0.9209
 Site-MNIST                         | Val  Loss: 0.1397 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1449 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6168 | Val  Acc: 0.9189
 Site-MNIST_M                       | Val  Loss: 0.4509 | Val  Acc: 0.9730
 Site-SVHN                          | Val  Loss: 1.0498 | Val  Acc: 0.7973
Average Valid Accuracy: 0.9270
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1303 | Train Acc: 0.9696
 Site-USPS                          | Train Loss: 0.1025 | Train Acc: 0.9831
 Site-SynthDigits                   | Train Loss: 0.5353 | Train Acc: 0.8851
 Site-MNIST_M                       | Train Loss: 0.3708 | Train Acc: 0.9595
 Site-SVHN                          | Train Loss: 0.8766 | Train Acc: 0.8041
Average Train Accuracy: 0.9203
 Site-MNIST                         | Val  Loss: 0.1324 | Val  Acc: 0.9459
 Site-USPS                          | Val  Loss: 0.1357 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.5791 | Val  Acc: 0.8649
 Site-MNIST_M                       | Val  Loss: 0.3962 | Val  Acc: 0.9730
 Site-SVHN                          | Val  Loss: 1.0254 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9216
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.1206 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.0949 | Train Acc: 0.9764
 Site-SynthDigits                   | Train Loss: 0.5021 | Train Acc: 0.9257
 Site-MNIST_M                       | Train Loss: 0.3744 | Train Acc: 0.9595
 Site-SVHN                          | Train Loss: 0.8696 | Train Acc: 0.8074
Average Train Accuracy: 0.9284
 Site-MNIST                         | Val  Loss: 0.1352 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1280 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.5751 | Val  Acc: 0.9189
 Site-MNIST_M                       | Val  Loss: 0.4040 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 1.0030 | Val  Acc: 0.7703
Average Valid Accuracy: 0.9270
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1097 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.0975 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.5036 | Train Acc: 0.9189
 Site-MNIST_M                       | Train Loss: 0.3529 | Train Acc: 0.9628
 Site-SVHN                          | Train Loss: 0.8536 | Train Acc: 0.8176
Average Train Accuracy: 0.9331
 Site-MNIST                         | Val  Loss: 0.1481 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1085 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5464 | Val  Acc: 0.9054
 Site-MNIST_M                       | Val  Loss: 0.3762 | Val  Acc: 0.9730
 Site-SVHN                          | Val  Loss: 1.0203 | Val  Acc: 0.8108
Average Valid Accuracy: 0.9297
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1164 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.0978 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.4993 | Train Acc: 0.9020
 Site-MNIST_M                       | Train Loss: 0.3307 | Train Acc: 0.9696
 Site-SVHN                          | Train Loss: 0.8216 | Train Acc: 0.8108
Average Train Accuracy: 0.9284
 Site-MNIST                         | Val  Loss: 0.1345 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1332 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.5003 | Val  Acc: 0.9054
 Site-MNIST_M                       | Val  Loss: 0.3399 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 0.9650 | Val  Acc: 0.7838
Average Valid Accuracy: 0.9243
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.0930 | Train Acc: 0.9865
 Site-USPS                          | Train Loss: 0.0884 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.4961 | Train Acc: 0.9223
 Site-MNIST_M                       | Train Loss: 0.3280 | Train Acc: 0.9764
 Site-SVHN                          | Train Loss: 0.8276 | Train Acc: 0.8243
Average Train Accuracy: 0.9392
 Site-MNIST                         | Val  Loss: 0.1095 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1211 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.5112 | Val  Acc: 0.9324
 Site-MNIST_M                       | Val  Loss: 0.3156 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 1.0226 | Val  Acc: 0.7973
Average Valid Accuracy: 0.9351
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1022 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.0911 | Train Acc: 0.9831
 Site-SynthDigits                   | Train Loss: 0.4609 | Train Acc: 0.9223
 Site-MNIST_M                       | Train Loss: 0.3175 | Train Acc: 0.9730
 Site-SVHN                          | Train Loss: 0.7849 | Train Acc: 0.8345
Average Train Accuracy: 0.9378
 Site-MNIST                         | Val  Loss: 0.1125 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1269 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.4688 | Val  Acc: 0.9324
 Site-MNIST_M                       | Val  Loss: 0.3357 | Val  Acc: 0.9595
 Site-SVHN                          | Val  Loss: 0.9020 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9378
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9730
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.9324
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.9595
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.8378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.0980 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.0821 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.4614 | Train Acc: 0.9291
 Site-MNIST_M                       | Train Loss: 0.3093 | Train Acc: 0.9730
 Site-SVHN                          | Train Loss: 0.8102 | Train Acc: 0.8243
Average Train Accuracy: 0.9378
 Site-MNIST                         | Val  Loss: 0.1163 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.0931 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.4876 | Val  Acc: 0.9189
 Site-MNIST_M                       | Val  Loss: 0.2878 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 0.9784 | Val  Acc: 0.7838
Average Valid Accuracy: 0.9324
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.0956 | Train Acc: 0.9865
 Site-USPS                          | Train Loss: 0.0841 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.4562 | Train Acc: 0.9358
 Site-MNIST_M                       | Train Loss: 0.2842 | Train Acc: 0.9831
 Site-SVHN                          | Train Loss: 0.7780 | Train Acc: 0.8480
Average Train Accuracy: 0.9480
 Site-MNIST                         | Val  Loss: 0.1008 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1167 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.4757 | Val  Acc: 0.9459
 Site-MNIST_M                       | Val  Loss: 0.2820 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 0.9185 | Val  Acc: 0.8514
Average Valid Accuracy: 0.9486
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9730
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.9459
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.9865
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.8514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.0872 | Train Acc: 0.9831
 Site-USPS                          | Train Loss: 0.0792 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.4428 | Train Acc: 0.9122
 Site-MNIST_M                       | Train Loss: 0.2871 | Train Acc: 0.9831
 Site-SVHN                          | Train Loss: 0.7658 | Train Acc: 0.8514
Average Train Accuracy: 0.9432
 Site-MNIST                         | Val  Loss: 0.1125 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.0961 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.4632 | Val  Acc: 0.9459
 Site-MNIST_M                       | Val  Loss: 0.2758 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 0.9043 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9459
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.0894 | Train Acc: 0.9797
 Site-USPS                          | Train Loss: 0.0713 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.4521 | Train Acc: 0.9155
 Site-MNIST_M                       | Train Loss: 0.2499 | Train Acc: 0.9865
 Site-SVHN                          | Train Loss: 0.7475 | Train Acc: 0.8412
Average Train Accuracy: 0.9426
 Site-MNIST                         | Val  Loss: 0.1029 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.0941 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.4672 | Val  Acc: 0.9324
 Site-MNIST_M                       | Val  Loss: 0.2347 | Val  Acc: 1.0000
 Site-SVHN                          | Val  Loss: 0.8993 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9486
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.0826 | Train Acc: 0.9831
 Site-USPS                          | Train Loss: 0.0706 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.4051 | Train Acc: 0.9392
 Site-MNIST_M                       | Train Loss: 0.2475 | Train Acc: 0.9865
 Site-SVHN                          | Train Loss: 0.7235 | Train Acc: 0.8682
Average Train Accuracy: 0.9534
 Site-MNIST                         | Val  Loss: 0.0953 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.0925 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.4547 | Val  Acc: 0.9324
 Site-MNIST_M                       | Val  Loss: 0.2414 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 0.8849 | Val  Acc: 0.8514
Average Valid Accuracy: 0.9459
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.0769 | Train Acc: 0.9865
 Site-USPS                          | Train Loss: 0.0666 | Train Acc: 0.9932
 Site-SynthDigits                   | Train Loss: 0.4321 | Train Acc: 0.9088
 Site-MNIST_M                       | Train Loss: 0.2432 | Train Acc: 0.9899
 Site-SVHN                          | Train Loss: 0.7081 | Train Acc: 0.8649
Average Train Accuracy: 0.9486
 Site-MNIST                         | Val  Loss: 0.0904 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0924 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.4481 | Val  Acc: 0.9189
 Site-MNIST_M                       | Val  Loss: 0.2302 | Val  Acc: 1.0000
 Site-SVHN                          | Val  Loss: 0.8475 | Val  Acc: 0.8514
Average Valid Accuracy: 0.9486
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.0748 | Train Acc: 0.9899
 Site-USPS                          | Train Loss: 0.0706 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.4147 | Train Acc: 0.9291
 Site-MNIST_M                       | Train Loss: 0.2232 | Train Acc: 0.9865
 Site-SVHN                          | Train Loss: 0.6996 | Train Acc: 0.8716
Average Train Accuracy: 0.9534
 Site-MNIST                         | Val  Loss: 0.0798 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0969 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.4370 | Val  Acc: 0.9324
 Site-MNIST_M                       | Val  Loss: 0.2368 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 0.8032 | Val  Acc: 0.8649
Average Valid Accuracy: 0.9514
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9865
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.9324
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.9865
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.8649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.0721 | Train Acc: 0.9899
 Site-USPS                          | Train Loss: 0.0626 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.3973 | Train Acc: 0.9493
 Site-MNIST_M                       | Train Loss: 0.2299 | Train Acc: 0.9899
 Site-SVHN                          | Train Loss: 0.7029 | Train Acc: 0.8750
Average Train Accuracy: 0.9588
 Site-MNIST                         | Val  Loss: 0.0828 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0855 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.4357 | Val  Acc: 0.9595
 Site-MNIST_M                       | Val  Loss: 0.1948 | Val  Acc: 1.0000
 Site-SVHN                          | Val  Loss: 0.8540 | Val  Acc: 0.8649
Average Valid Accuracy: 0.9595
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9865
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.9595
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 1.0000
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.8649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedsam...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.0696 | Train Acc: 0.9865
 Site-USPS                          | Train Loss: 0.0603 | Train Acc: 0.9932
 Site-SynthDigits                   | Train Loss: 0.4016 | Train Acc: 0.9358
 Site-MNIST_M                       | Train Loss: 0.2241 | Train Acc: 0.9899
 Site-SVHN                          | Train Loss: 0.6656 | Train Acc: 0.8615
Average Train Accuracy: 0.9534
 Site-MNIST                         | Val  Loss: 0.0845 | Val  Acc: 0.9865
 Site-USPS                          | Val  Loss: 0.0833 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.4225 | Val  Acc: 0.9324
 Site-MNIST_M                       | Val  Loss: 0.2173 | Val  Acc: 1.0000
 Site-SVHN                          | Val  Loss: 0.8464 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9514
===2023-07-03 10:02:57===
===2023-07-03 10:02:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.8993
 Test site-USPS                      | Epoch:48 | Test Acc: 0.8871
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.6486
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.4557
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.3506
MNIST: 0.8993, USPS: 0.8871, SynthDigits: 0.6486, MNIST_M: 0.4557, SVHN: 0.3506, 
Average Test Accuracy(group): 0.6483, Average Test Accuracy(individual): 0.6483,
domain std=0.2217, cluster std=-1.0000, individual std=0.2217, 
