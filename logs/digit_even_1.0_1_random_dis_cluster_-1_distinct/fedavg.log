===2023-07-02 22:07:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.2281 | Train Acc: 0.3243
 Site-USPS                          | Train Loss: 2.2331 | Train Acc: 0.2905
 Site-SynthDigits                   | Train Loss: 2.2792 | Train Acc: 0.1554
 Site-MNIST_M                       | Train Loss: 2.2857 | Train Acc: 0.1486
 Site-SVHN                          | Train Loss: 2.2688 | Train Acc: 0.1791
Average Train Accuracy: 0.2196
 Site-MNIST                         | Val  Loss: 2.2032 | Val  Acc: 0.3514
 Site-USPS                          | Val  Loss: 2.2434 | Val  Acc: 0.2432
 Site-SynthDigits                   | Val  Loss: 2.3070 | Val  Acc: 0.2162
 Site-MNIST_M                       | Val  Loss: 2.2683 | Val  Acc: 0.1486
 Site-SVHN                          | Val  Loss: 2.2578 | Val  Acc: 0.1757
Average Valid Accuracy: 0.2270
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3514
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2432
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2162
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 2.1564 | Train Acc: 0.5135
 Site-USPS                          | Train Loss: 2.1571 | Train Acc: 0.4595
 Site-SynthDigits                   | Train Loss: 2.2579 | Train Acc: 0.2162
 Site-MNIST_M                       | Train Loss: 2.2643 | Train Acc: 0.1824
 Site-SVHN                          | Train Loss: 2.2487 | Train Acc: 0.2365
Average Train Accuracy: 0.3216
 Site-MNIST                         | Val  Loss: 2.1165 | Val  Acc: 0.6081
 Site-USPS                          | Val  Loss: 2.1795 | Val  Acc: 0.3649
 Site-SynthDigits                   | Val  Loss: 2.2893 | Val  Acc: 0.2297
 Site-MNIST_M                       | Val  Loss: 2.2383 | Val  Acc: 0.2027
 Site-SVHN                          | Val  Loss: 2.2362 | Val  Acc: 0.2703
Average Valid Accuracy: 0.3351
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6081
 Best site-USPS                      | Epoch:1 | Val Acc: 0.3649
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2297
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2027
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 2.0956 | Train Acc: 0.6115
 Site-USPS                          | Train Loss: 2.0902 | Train Acc: 0.5608
 Site-SynthDigits                   | Train Loss: 2.2292 | Train Acc: 0.2872
 Site-MNIST_M                       | Train Loss: 2.2477 | Train Acc: 0.1926
 Site-SVHN                          | Train Loss: 2.2330 | Train Acc: 0.2601
Average Train Accuracy: 0.3824
 Site-MNIST                         | Val  Loss: 2.0375 | Val  Acc: 0.6757
 Site-USPS                          | Val  Loss: 2.1163 | Val  Acc: 0.4730
 Site-SynthDigits                   | Val  Loss: 2.2540 | Val  Acc: 0.3108
 Site-MNIST_M                       | Val  Loss: 2.2154 | Val  Acc: 0.2162
 Site-SVHN                          | Val  Loss: 2.2232 | Val  Acc: 0.2838
Average Valid Accuracy: 0.3919
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6757
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4730
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3108
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2162
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 2.0264 | Train Acc: 0.6081
 Site-USPS                          | Train Loss: 2.0192 | Train Acc: 0.5980
 Site-SynthDigits                   | Train Loss: 2.1976 | Train Acc: 0.3209
 Site-MNIST_M                       | Train Loss: 2.2241 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2176 | Train Acc: 0.2669
Average Train Accuracy: 0.4068
 Site-MNIST                         | Val  Loss: 1.9617 | Val  Acc: 0.7027
 Site-USPS                          | Val  Loss: 2.0560 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 2.2178 | Val  Acc: 0.2838
 Site-MNIST_M                       | Val  Loss: 2.1907 | Val  Acc: 0.2703
 Site-SVHN                          | Val  Loss: 2.2134 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4189
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7027
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2838
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2703
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.9686 | Train Acc: 0.6318
 Site-USPS                          | Train Loss: 1.9368 | Train Acc: 0.6419
 Site-SynthDigits                   | Train Loss: 2.1692 | Train Acc: 0.3446
 Site-MNIST_M                       | Train Loss: 2.2042 | Train Acc: 0.2703
 Site-SVHN                          | Train Loss: 2.2054 | Train Acc: 0.2669
Average Train Accuracy: 0.4311
 Site-MNIST                         | Val  Loss: 1.8894 | Val  Acc: 0.7162
 Site-USPS                          | Val  Loss: 1.9820 | Val  Acc: 0.5541
 Site-SynthDigits                   | Val  Loss: 2.1898 | Val  Acc: 0.3243
 Site-MNIST_M                       | Val  Loss: 2.1704 | Val  Acc: 0.3243
 Site-SVHN                          | Val  Loss: 2.2002 | Val  Acc: 0.3243
Average Valid Accuracy: 0.4486
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7162
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5541
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3243
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3243
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.9087 | Train Acc: 0.6588
 Site-USPS                          | Train Loss: 1.8755 | Train Acc: 0.6520
 Site-SynthDigits                   | Train Loss: 2.1402 | Train Acc: 0.3547
 Site-MNIST_M                       | Train Loss: 2.1861 | Train Acc: 0.2973
 Site-SVHN                          | Train Loss: 2.1858 | Train Acc: 0.2703
Average Train Accuracy: 0.4466
 Site-MNIST                         | Val  Loss: 1.8145 | Val  Acc: 0.7162
 Site-USPS                          | Val  Loss: 1.9245 | Val  Acc: 0.6081
 Site-SynthDigits                   | Val  Loss: 2.1541 | Val  Acc: 0.3243
 Site-MNIST_M                       | Val  Loss: 2.1511 | Val  Acc: 0.3378
 Site-SVHN                          | Val  Loss: 2.1856 | Val  Acc: 0.3243
Average Valid Accuracy: 0.4622
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7162
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6081
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3243
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3378
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.8389 | Train Acc: 0.6824
 Site-USPS                          | Train Loss: 1.8071 | Train Acc: 0.6791
 Site-SynthDigits                   | Train Loss: 2.1122 | Train Acc: 0.3986
 Site-MNIST_M                       | Train Loss: 2.1683 | Train Acc: 0.3007
 Site-SVHN                          | Train Loss: 2.1759 | Train Acc: 0.2804
Average Train Accuracy: 0.4682
 Site-MNIST                         | Val  Loss: 1.7463 | Val  Acc: 0.7432
 Site-USPS                          | Val  Loss: 1.8596 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 2.1271 | Val  Acc: 0.3649
 Site-MNIST_M                       | Val  Loss: 2.1312 | Val  Acc: 0.3378
 Site-SVHN                          | Val  Loss: 2.1704 | Val  Acc: 0.3378
Average Valid Accuracy: 0.4865
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7432
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3649
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3378
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.7848 | Train Acc: 0.6892
 Site-USPS                          | Train Loss: 1.7435 | Train Acc: 0.6926
 Site-SynthDigits                   | Train Loss: 2.0791 | Train Acc: 0.4358
 Site-MNIST_M                       | Train Loss: 2.1520 | Train Acc: 0.3378
 Site-SVHN                          | Train Loss: 2.1571 | Train Acc: 0.2905
Average Train Accuracy: 0.4892
 Site-MNIST                         | Val  Loss: 1.6792 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.7973 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 2.1082 | Val  Acc: 0.3919
 Site-MNIST_M                       | Val  Loss: 2.1102 | Val  Acc: 0.3919
 Site-SVHN                          | Val  Loss: 2.1542 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5108
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6757
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3919
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3919
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.7257 | Train Acc: 0.6791
 Site-USPS                          | Train Loss: 1.6909 | Train Acc: 0.6858
 Site-SynthDigits                   | Train Loss: 2.0565 | Train Acc: 0.4527
 Site-MNIST_M                       | Train Loss: 2.1314 | Train Acc: 0.3615
 Site-SVHN                          | Train Loss: 2.1419 | Train Acc: 0.2838
Average Train Accuracy: 0.4926
 Site-MNIST                         | Val  Loss: 1.6198 | Val  Acc: 0.7297
 Site-USPS                          | Val  Loss: 1.7594 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 2.0719 | Val  Acc: 0.4054
 Site-MNIST_M                       | Val  Loss: 2.0841 | Val  Acc: 0.3919
 Site-SVHN                          | Val  Loss: 2.1399 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5108
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.6734 | Train Acc: 0.6959
 Site-USPS                          | Train Loss: 1.6192 | Train Acc: 0.7027
 Site-SynthDigits                   | Train Loss: 2.0282 | Train Acc: 0.4662
 Site-MNIST_M                       | Train Loss: 2.1179 | Train Acc: 0.3649
 Site-SVHN                          | Train Loss: 2.1315 | Train Acc: 0.3007
Average Train Accuracy: 0.5061
 Site-MNIST                         | Val  Loss: 1.5664 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.6803 | Val  Acc: 0.6892
 Site-SynthDigits                   | Val  Loss: 2.0496 | Val  Acc: 0.3919
 Site-MNIST_M                       | Val  Loss: 2.0713 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.1291 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5243
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:9 | Val Acc: 0.6892
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3919
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 1.6155 | Train Acc: 0.6959
 Site-USPS                          | Train Loss: 1.5796 | Train Acc: 0.7061
 Site-SynthDigits                   | Train Loss: 1.9973 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 2.1018 | Train Acc: 0.3885
 Site-SVHN                          | Train Loss: 2.1218 | Train Acc: 0.2973
Average Train Accuracy: 0.5176
 Site-MNIST                         | Val  Loss: 1.5024 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.6524 | Val  Acc: 0.6892
 Site-SynthDigits                   | Val  Loss: 2.0165 | Val  Acc: 0.4324
 Site-MNIST_M                       | Val  Loss: 2.0511 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.1145 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5351
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:10 | Val Acc: 0.6892
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4324
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 1.5803 | Train Acc: 0.7230
 Site-USPS                          | Train Loss: 1.5186 | Train Acc: 0.7297
 Site-SynthDigits                   | Train Loss: 1.9721 | Train Acc: 0.5270
 Site-MNIST_M                       | Train Loss: 2.0854 | Train Acc: 0.3919
 Site-SVHN                          | Train Loss: 2.0996 | Train Acc: 0.2973
Average Train Accuracy: 0.5338
 Site-MNIST                         | Val  Loss: 1.4592 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.5922 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.9825 | Val  Acc: 0.4595
 Site-MNIST_M                       | Val  Loss: 2.0368 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 2.1015 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5514
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4595
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 1.5358 | Train Acc: 0.7534
 Site-USPS                          | Train Loss: 1.4613 | Train Acc: 0.7568
 Site-SynthDigits                   | Train Loss: 1.9378 | Train Acc: 0.5372
 Site-MNIST_M                       | Train Loss: 2.0689 | Train Acc: 0.3818
 Site-SVHN                          | Train Loss: 2.0960 | Train Acc: 0.3108
Average Train Accuracy: 0.5480
 Site-MNIST                         | Val  Loss: 1.4095 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.5333 | Val  Acc: 0.7432
 Site-SynthDigits                   | Val  Loss: 1.9588 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 2.0262 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.0911 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5595
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7432
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 1.4933 | Train Acc: 0.7466
 Site-USPS                          | Train Loss: 1.4231 | Train Acc: 0.7703
 Site-SynthDigits                   | Train Loss: 1.9161 | Train Acc: 0.5169
 Site-MNIST_M                       | Train Loss: 2.0557 | Train Acc: 0.3885
 Site-SVHN                          | Train Loss: 2.0858 | Train Acc: 0.3176
Average Train Accuracy: 0.5480
 Site-MNIST                         | Val  Loss: 1.3656 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.4911 | Val  Acc: 0.7432
 Site-SynthDigits                   | Val  Loss: 1.9297 | Val  Acc: 0.4730
 Site-MNIST_M                       | Val  Loss: 2.0150 | Val  Acc: 0.4459
 Site-SVHN                          | Val  Loss: 2.0804 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5541
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 1.4458 | Train Acc: 0.7534
 Site-USPS                          | Train Loss: 1.3577 | Train Acc: 0.7703
 Site-SynthDigits                   | Train Loss: 1.8826 | Train Acc: 0.5135
 Site-MNIST_M                       | Train Loss: 2.0386 | Train Acc: 0.4291
 Site-SVHN                          | Train Loss: 2.0672 | Train Acc: 0.3176
Average Train Accuracy: 0.5568
 Site-MNIST                         | Val  Loss: 1.3185 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.4340 | Val  Acc: 0.7432
 Site-SynthDigits                   | Val  Loss: 1.9043 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.9924 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 2.0611 | Val  Acc: 0.3243
Average Valid Accuracy: 0.5703
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7432
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 1.3949 | Train Acc: 0.7534
 Site-USPS                          | Train Loss: 1.3265 | Train Acc: 0.7703
 Site-SynthDigits                   | Train Loss: 1.8579 | Train Acc: 0.5405
 Site-MNIST_M                       | Train Loss: 2.0188 | Train Acc: 0.4088
 Site-SVHN                          | Train Loss: 2.0548 | Train Acc: 0.3142
Average Train Accuracy: 0.5574
 Site-MNIST                         | Val  Loss: 1.2710 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.3971 | Val  Acc: 0.7703
 Site-SynthDigits                   | Val  Loss: 1.8788 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.9732 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 2.0462 | Val  Acc: 0.3108
Average Valid Accuracy: 0.5730
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7703
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5541
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 1.3610 | Train Acc: 0.7568
 Site-USPS                          | Train Loss: 1.2718 | Train Acc: 0.7838
 Site-SynthDigits                   | Train Loss: 1.8402 | Train Acc: 0.5338
 Site-MNIST_M                       | Train Loss: 1.9967 | Train Acc: 0.4020
 Site-SVHN                          | Train Loss: 2.0329 | Train Acc: 0.3378
Average Train Accuracy: 0.5628
 Site-MNIST                         | Val  Loss: 1.2253 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.3572 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.8638 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.9538 | Val  Acc: 0.4730
 Site-SVHN                          | Val  Loss: 2.0355 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5784
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7568
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5405
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4730
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 1.3313 | Train Acc: 0.7736
 Site-USPS                          | Train Loss: 1.1996 | Train Acc: 0.7973
 Site-SynthDigits                   | Train Loss: 1.8132 | Train Acc: 0.5203
 Site-MNIST_M                       | Train Loss: 1.9813 | Train Acc: 0.4324
 Site-SVHN                          | Train Loss: 2.0298 | Train Acc: 0.3345
Average Train Accuracy: 0.5716
 Site-MNIST                         | Val  Loss: 1.1925 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.2922 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.8420 | Val  Acc: 0.5135
 Site-MNIST_M                       | Val  Loss: 1.9404 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.0275 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5892
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7838
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5135
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 1.2834 | Train Acc: 0.7804
 Site-USPS                          | Train Loss: 1.2002 | Train Acc: 0.7905
 Site-SynthDigits                   | Train Loss: 1.7885 | Train Acc: 0.5203
 Site-MNIST_M                       | Train Loss: 1.9503 | Train Acc: 0.4493
 Site-SVHN                          | Train Loss: 2.0220 | Train Acc: 0.3277
Average Train Accuracy: 0.5736
 Site-MNIST                         | Val  Loss: 1.1584 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.2742 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.8044 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.8872 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 2.0112 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5811
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 1.2487 | Train Acc: 0.7973
 Site-USPS                          | Train Loss: 1.1288 | Train Acc: 0.8108
 Site-SynthDigits                   | Train Loss: 1.7585 | Train Acc: 0.5439
 Site-MNIST_M                       | Train Loss: 1.9326 | Train Acc: 0.4595
 Site-SVHN                          | Train Loss: 2.0054 | Train Acc: 0.3378
Average Train Accuracy: 0.5899
 Site-MNIST                         | Val  Loss: 1.1280 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 1.2075 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.7701 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.9155 | Val  Acc: 0.4730
 Site-SVHN                          | Val  Loss: 1.9968 | Val  Acc: 0.3514
Average Valid Accuracy: 0.6027
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7973
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5946
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4730
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 1.2072 | Train Acc: 0.8007
 Site-USPS                          | Train Loss: 1.0940 | Train Acc: 0.8209
 Site-SynthDigits                   | Train Loss: 1.7335 | Train Acc: 0.5405
 Site-MNIST_M                       | Train Loss: 1.9175 | Train Acc: 0.4595
 Site-SVHN                          | Train Loss: 1.9934 | Train Acc: 0.3446
Average Train Accuracy: 0.5932
 Site-MNIST                         | Val  Loss: 1.0982 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.1698 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.7316 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.8918 | Val  Acc: 0.4730
 Site-SVHN                          | Val  Loss: 1.9820 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5946
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 1.1775 | Train Acc: 0.8074
 Site-USPS                          | Train Loss: 1.0506 | Train Acc: 0.8311
 Site-SynthDigits                   | Train Loss: 1.7174 | Train Acc: 0.5642
 Site-MNIST_M                       | Train Loss: 1.8901 | Train Acc: 0.4899
 Site-SVHN                          | Train Loss: 1.9824 | Train Acc: 0.3412
Average Train Accuracy: 0.6068
 Site-MNIST                         | Val  Loss: 1.0624 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 1.1290 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.7297 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.8445 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.9652 | Val  Acc: 0.3378
Average Valid Accuracy: 0.6243
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8514
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6216
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 1.1564 | Train Acc: 0.7973
 Site-USPS                          | Train Loss: 1.0356 | Train Acc: 0.8311
 Site-SynthDigits                   | Train Loss: 1.6952 | Train Acc: 0.5541
 Site-MNIST_M                       | Train Loss: 1.8740 | Train Acc: 0.4966
 Site-SVHN                          | Train Loss: 1.9628 | Train Acc: 0.3547
Average Train Accuracy: 0.6068
 Site-MNIST                         | Val  Loss: 1.0412 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.1028 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6842 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.8547 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.9591 | Val  Acc: 0.3649
Average Valid Accuracy: 0.6189
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 1.1118 | Train Acc: 0.8108
 Site-USPS                          | Train Loss: 0.9989 | Train Acc: 0.8345
 Site-SynthDigits                   | Train Loss: 1.6702 | Train Acc: 0.5608
 Site-MNIST_M                       | Train Loss: 1.8523 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 1.9446 | Train Acc: 0.3514
Average Train Accuracy: 0.6115
 Site-MNIST                         | Val  Loss: 1.0147 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.0717 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6616 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.8374 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9452 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6189
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 1.0667 | Train Acc: 0.8243
 Site-USPS                          | Train Loss: 0.9582 | Train Acc: 0.8412
 Site-SynthDigits                   | Train Loss: 1.6550 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.8404 | Train Acc: 0.5101
 Site-SVHN                          | Train Loss: 1.9421 | Train Acc: 0.3581
Average Train Accuracy: 0.6230
 Site-MNIST                         | Val  Loss: 0.9736 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.0367 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.6841 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.8251 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.9327 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6378
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8514
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6216
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5541
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 1.0600 | Train Acc: 0.8142
 Site-USPS                          | Train Loss: 0.9539 | Train Acc: 0.8412
 Site-SynthDigits                   | Train Loss: 1.6368 | Train Acc: 0.5743
 Site-MNIST_M                       | Train Loss: 1.8139 | Train Acc: 0.5068
 Site-SVHN                          | Train Loss: 1.9306 | Train Acc: 0.3682
Average Train Accuracy: 0.6209
 Site-MNIST                         | Val  Loss: 0.9708 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 1.0176 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6164 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.8169 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.9252 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6324
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 1.0081 | Train Acc: 0.8142
 Site-USPS                          | Train Loss: 0.8987 | Train Acc: 0.8615
 Site-SynthDigits                   | Train Loss: 1.6161 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.7906 | Train Acc: 0.5203
 Site-SVHN                          | Train Loss: 1.9258 | Train Acc: 0.3716
Average Train Accuracy: 0.6297
 Site-MNIST                         | Val  Loss: 0.9306 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.9688 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.6305 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.7870 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.9260 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6378
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6216
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5270
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 1.0024 | Train Acc: 0.8311
 Site-USPS                          | Train Loss: 0.8997 | Train Acc: 0.8514
 Site-SynthDigits                   | Train Loss: 1.5820 | Train Acc: 0.5709
 Site-MNIST_M                       | Train Loss: 1.7811 | Train Acc: 0.5169
 Site-SVHN                          | Train Loss: 1.9101 | Train Acc: 0.3784
Average Train Accuracy: 0.6297
 Site-MNIST                         | Val  Loss: 0.9211 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.9560 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.5705 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.7929 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.9060 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6189
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.9684 | Train Acc: 0.8277
 Site-USPS                          | Train Loss: 0.8585 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.5891 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.7668 | Train Acc: 0.5372
 Site-SVHN                          | Train Loss: 1.9078 | Train Acc: 0.3716
Average Train Accuracy: 0.6365
 Site-MNIST                         | Val  Loss: 0.8953 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.9143 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.5783 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.7655 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.9070 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6486
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6216
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5270
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.9458 | Train Acc: 0.8311
 Site-USPS                          | Train Loss: 0.8517 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.5499 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.7472 | Train Acc: 0.5439
 Site-SVHN                          | Train Loss: 1.8870 | Train Acc: 0.3784
Average Train Accuracy: 0.6419
 Site-MNIST                         | Val  Loss: 0.8774 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.8979 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.5442 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.7363 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8853 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6486
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.9235 | Train Acc: 0.8311
 Site-USPS                          | Train Loss: 0.8069 | Train Acc: 0.8581
 Site-SynthDigits                   | Train Loss: 1.5327 | Train Acc: 0.5878
 Site-MNIST_M                       | Train Loss: 1.7309 | Train Acc: 0.5405
 Site-SVHN                          | Train Loss: 1.8822 | Train Acc: 0.3851
Average Train Accuracy: 0.6405
 Site-MNIST                         | Val  Loss: 0.8479 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8628 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.5303 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.7429 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8868 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6459
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.8955 | Train Acc: 0.8311
 Site-USPS                          | Train Loss: 0.7741 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.5340 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.7116 | Train Acc: 0.5811
 Site-SVHN                          | Train Loss: 1.8761 | Train Acc: 0.3953
Average Train Accuracy: 0.6527
 Site-MNIST                         | Val  Loss: 0.8336 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.8545 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.5283 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.7185 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.8806 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6568
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6216
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5405
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.8807 | Train Acc: 0.8277
 Site-USPS                          | Train Loss: 0.7720 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.5071 | Train Acc: 0.5878
 Site-MNIST_M                       | Train Loss: 1.7065 | Train Acc: 0.5473
 Site-SVHN                          | Train Loss: 1.8643 | Train Acc: 0.4020
Average Train Accuracy: 0.6480
 Site-MNIST                         | Val  Loss: 0.8157 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.8130 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.4971 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.7068 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.8625 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6649
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6622
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5270
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.8616 | Train Acc: 0.8345
 Site-USPS                          | Train Loss: 0.7777 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.4977 | Train Acc: 0.5946
 Site-MNIST_M                       | Train Loss: 1.6868 | Train Acc: 0.5608
 Site-SVHN                          | Train Loss: 1.8545 | Train Acc: 0.4054
Average Train Accuracy: 0.6520
 Site-MNIST                         | Val  Loss: 0.7961 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8398 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.5118 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.7096 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.8431 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6514
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.8532 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.7224 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.4895 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.6803 | Train Acc: 0.5777
 Site-SVHN                          | Train Loss: 1.8375 | Train Acc: 0.4155
Average Train Accuracy: 0.6561
 Site-MNIST                         | Val  Loss: 0.7877 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.7849 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4966 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.6753 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.8311 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6486
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.8260 | Train Acc: 0.8480
 Site-USPS                          | Train Loss: 0.7332 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.4604 | Train Acc: 0.5912
 Site-MNIST_M                       | Train Loss: 1.6547 | Train Acc: 0.5541
 Site-SVHN                          | Train Loss: 1.8274 | Train Acc: 0.4054
Average Train Accuracy: 0.6547
 Site-MNIST                         | Val  Loss: 0.7736 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.7944 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4612 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.6816 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8163 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6568
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.7846 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.7002 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.4639 | Train Acc: 0.5912
 Site-MNIST_M                       | Train Loss: 1.6443 | Train Acc: 0.5878
 Site-SVHN                          | Train Loss: 1.8370 | Train Acc: 0.4088
Average Train Accuracy: 0.6601
 Site-MNIST                         | Val  Loss: 0.7518 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.7577 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.4870 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.6406 | Val  Acc: 0.5676
 Site-SVHN                          | Val  Loss: 1.8217 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6541
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.7950 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.7045 | Train Acc: 0.8851
 Site-SynthDigits                   | Train Loss: 1.4201 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.6212 | Train Acc: 0.5709
 Site-SVHN                          | Train Loss: 1.8267 | Train Acc: 0.4189
Average Train Accuracy: 0.6649
 Site-MNIST                         | Val  Loss: 0.7428 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.7452 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.4392 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.6623 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.7939 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6649
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.7894 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.6712 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.4264 | Train Acc: 0.6115
 Site-MNIST_M                       | Train Loss: 1.5958 | Train Acc: 0.5878
 Site-SVHN                          | Train Loss: 1.8090 | Train Acc: 0.4122
Average Train Accuracy: 0.6669
 Site-MNIST                         | Val  Loss: 0.7408 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.7264 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.4430 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.6241 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.7981 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6595
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.7635 | Train Acc: 0.8480
 Site-USPS                          | Train Loss: 0.6506 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.4328 | Train Acc: 0.5946
 Site-MNIST_M                       | Train Loss: 1.6097 | Train Acc: 0.5743
 Site-SVHN                          | Train Loss: 1.8056 | Train Acc: 0.4054
Average Train Accuracy: 0.6622
 Site-MNIST                         | Val  Loss: 0.7223 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.7055 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.4287 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.6341 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.7926 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6595
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.7427 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.6275 | Train Acc: 0.8851
 Site-SynthDigits                   | Train Loss: 1.4039 | Train Acc: 0.5912
 Site-MNIST_M                       | Train Loss: 1.5889 | Train Acc: 0.5811
 Site-SVHN                          | Train Loss: 1.7959 | Train Acc: 0.4223
Average Train Accuracy: 0.6662
 Site-MNIST                         | Val  Loss: 0.7147 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.6927 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.4306 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.6216 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.7710 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6541
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.7294 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.6279 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.3886 | Train Acc: 0.6182
 Site-MNIST_M                       | Train Loss: 1.5798 | Train Acc: 0.5878
 Site-SVHN                          | Train Loss: 1.7788 | Train Acc: 0.4223
Average Train Accuracy: 0.6723
 Site-MNIST                         | Val  Loss: 0.6936 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6902 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.4020 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.6093 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.7543 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6784
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6486
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5405
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.7193 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.5993 | Train Acc: 0.8919
 Site-SynthDigits                   | Train Loss: 1.3988 | Train Acc: 0.6149
 Site-MNIST_M                       | Train Loss: 1.5575 | Train Acc: 0.6014
 Site-SVHN                          | Train Loss: 1.7825 | Train Acc: 0.4426
Average Train Accuracy: 0.6804
 Site-MNIST                         | Val  Loss: 0.6807 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.6576 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.4136 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.5881 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.7618 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6757
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.6974 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.5743 | Train Acc: 0.8919
 Site-SynthDigits                   | Train Loss: 1.3690 | Train Acc: 0.6149
 Site-MNIST_M                       | Train Loss: 1.5587 | Train Acc: 0.6047
 Site-SVHN                          | Train Loss: 1.7812 | Train Acc: 0.4392
Average Train Accuracy: 0.6818
 Site-MNIST                         | Val  Loss: 0.6864 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.6366 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.3883 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.5655 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.7395 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6865
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6486
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5541
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.6812 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.5766 | Train Acc: 0.8986
 Site-SynthDigits                   | Train Loss: 1.3702 | Train Acc: 0.6081
 Site-MNIST_M                       | Train Loss: 1.5328 | Train Acc: 0.5946
 Site-SVHN                          | Train Loss: 1.7651 | Train Acc: 0.4459
Average Train Accuracy: 0.6811
 Site-MNIST                         | Val  Loss: 0.6787 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.6241 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.3944 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.5704 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.7365 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6811
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.6705 | Train Acc: 0.8649
 Site-USPS                          | Train Loss: 0.5699 | Train Acc: 0.8953
 Site-SynthDigits                   | Train Loss: 1.3416 | Train Acc: 0.6149
 Site-MNIST_M                       | Train Loss: 1.5294 | Train Acc: 0.6047
 Site-SVHN                          | Train Loss: 1.7686 | Train Acc: 0.4358
Average Train Accuracy: 0.6831
 Site-MNIST                         | Val  Loss: 0.6679 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6203 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.3571 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.5665 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7117 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6865
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.6646 | Train Acc: 0.8615
 Site-USPS                          | Train Loss: 0.5622 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.3351 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.5010 | Train Acc: 0.6351
 Site-SVHN                          | Train Loss: 1.7560 | Train Acc: 0.4392
Average Train Accuracy: 0.6932
 Site-MNIST                         | Val  Loss: 0.6583 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.6072 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.3705 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.5518 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.7191 | Val  Acc: 0.5135
Average Valid Accuracy: 0.7000
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9189
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6622
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5946
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.6438 | Train Acc: 0.8649
 Site-USPS                          | Train Loss: 0.5405 | Train Acc: 0.8953
 Site-SynthDigits                   | Train Loss: 1.3369 | Train Acc: 0.6182
 Site-MNIST_M                       | Train Loss: 1.4970 | Train Acc: 0.6115
 Site-SVHN                          | Train Loss: 1.7450 | Train Acc: 0.4426
Average Train Accuracy: 0.6865
 Site-MNIST                         | Val  Loss: 0.6372 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.5961 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.3454 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.5618 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7042 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6946
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.6355 | Train Acc: 0.8784
 Site-USPS                          | Train Loss: 0.5517 | Train Acc: 0.8953
 Site-SynthDigits                   | Train Loss: 1.3282 | Train Acc: 0.6385
 Site-MNIST_M                       | Train Loss: 1.4901 | Train Acc: 0.6047
 Site-SVHN                          | Train Loss: 1.7372 | Train Acc: 0.4527
Average Train Accuracy: 0.6939
 Site-MNIST                         | Val  Loss: 0.6350 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.5862 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.3334 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.5615 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7026 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6973
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.6334 | Train Acc: 0.8682
 Site-USPS                          | Train Loss: 0.5172 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.3192 | Train Acc: 0.6318
 Site-MNIST_M                       | Train Loss: 1.4720 | Train Acc: 0.6014
 Site-SVHN                          | Train Loss: 1.7371 | Train Acc: 0.4459
Average Train Accuracy: 0.6899
 Site-MNIST                         | Val  Loss: 0.6299 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.5818 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.3045 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.5324 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.6746 | Val  Acc: 0.5135
Average Valid Accuracy: 0.7054
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6622
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedavg...
===2023-07-02 22:43:57===
===2023-07-02 22:43:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.7943
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8710
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.5487
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.3971
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2977
MNIST: 0.7943, USPS: 0.8710, SynthDigits: 0.5487, MNIST_M: 0.3971, SVHN: 0.2977, 
Average Test Accuracy(group): 0.5818, Average Test Accuracy(individual): 0.5818,
domain std=0.2212, cluster std=-1.0000, individual std=0.2212, 
