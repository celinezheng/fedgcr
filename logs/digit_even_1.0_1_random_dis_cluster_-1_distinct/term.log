===2023-07-03 00:04:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.2341 | Train Acc: 0.2432
 Site-USPS                          | Train Loss: 2.2205 | Train Acc: 0.4088
 Site-SynthDigits                   | Train Loss: 2.2800 | Train Acc: 0.1892
 Site-MNIST_M                       | Train Loss: 2.2981 | Train Acc: 0.1182
 Site-SVHN                          | Train Loss: 2.2741 | Train Acc: 0.1486
Average Train Accuracy: 0.2216
 Site-MNIST                         | Val  Loss: 2.2168 | Val  Acc: 0.3514
 Site-USPS                          | Val  Loss: 2.2281 | Val  Acc: 0.4189
 Site-SynthDigits                   | Val  Loss: 2.2900 | Val  Acc: 0.1757
 Site-MNIST_M                       | Val  Loss: 2.3287 | Val  Acc: 0.1486
 Site-SVHN                          | Val  Loss: 2.2903 | Val  Acc: 0.1757
Average Valid Accuracy: 0.2541
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3514
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4189
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1757
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 2.1584 | Train Acc: 0.5034
 Site-USPS                          | Train Loss: 2.1465 | Train Acc: 0.5541
 Site-SynthDigits                   | Train Loss: 2.2552 | Train Acc: 0.2669
 Site-MNIST_M                       | Train Loss: 2.2782 | Train Acc: 0.1588
 Site-SVHN                          | Train Loss: 2.2555 | Train Acc: 0.1892
Average Train Accuracy: 0.3345
 Site-MNIST                         | Val  Loss: 2.1318 | Val  Acc: 0.6216
 Site-USPS                          | Val  Loss: 2.1625 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 2.2642 | Val  Acc: 0.2568
 Site-MNIST_M                       | Val  Loss: 2.3045 | Val  Acc: 0.2162
 Site-SVHN                          | Val  Loss: 2.2713 | Val  Acc: 0.2027
Average Valid Accuracy: 0.3622
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6216
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5135
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2568
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2162
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 2.0924 | Train Acc: 0.5203
 Site-USPS                          | Train Loss: 2.0692 | Train Acc: 0.6081
 Site-SynthDigits                   | Train Loss: 2.2283 | Train Acc: 0.3277
 Site-MNIST_M                       | Train Loss: 2.2582 | Train Acc: 0.1926
 Site-SVHN                          | Train Loss: 2.2365 | Train Acc: 0.2196
Average Train Accuracy: 0.3736
 Site-MNIST                         | Val  Loss: 2.0553 | Val  Acc: 0.6216
 Site-USPS                          | Val  Loss: 2.0946 | Val  Acc: 0.5541
 Site-SynthDigits                   | Val  Loss: 2.2393 | Val  Acc: 0.2703
 Site-MNIST_M                       | Val  Loss: 2.2781 | Val  Acc: 0.2703
 Site-SVHN                          | Val  Loss: 2.2488 | Val  Acc: 0.2568
Average Valid Accuracy: 0.3946
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6216
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5541
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2703
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2703
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 2.0299 | Train Acc: 0.5642
 Site-USPS                          | Train Loss: 1.9955 | Train Acc: 0.6284
 Site-SynthDigits                   | Train Loss: 2.1995 | Train Acc: 0.3716
 Site-MNIST_M                       | Train Loss: 2.2398 | Train Acc: 0.2432
 Site-SVHN                          | Train Loss: 2.2218 | Train Acc: 0.2297
Average Train Accuracy: 0.4074
 Site-MNIST                         | Val  Loss: 1.9782 | Val  Acc: 0.6892
 Site-USPS                          | Val  Loss: 2.0262 | Val  Acc: 0.5811
 Site-SynthDigits                   | Val  Loss: 2.2113 | Val  Acc: 0.2973
 Site-MNIST_M                       | Val  Loss: 2.2517 | Val  Acc: 0.3108
 Site-SVHN                          | Val  Loss: 2.2339 | Val  Acc: 0.2838
Average Valid Accuracy: 0.4324
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6892
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5811
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2973
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3108
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.9660 | Train Acc: 0.6182
 Site-USPS                          | Train Loss: 1.9198 | Train Acc: 0.6486
 Site-SynthDigits                   | Train Loss: 2.1779 | Train Acc: 0.3750
 Site-MNIST_M                       | Train Loss: 2.2262 | Train Acc: 0.2973
 Site-SVHN                          | Train Loss: 2.2025 | Train Acc: 0.2399
Average Train Accuracy: 0.4358
 Site-MNIST                         | Val  Loss: 1.9106 | Val  Acc: 0.7162
 Site-USPS                          | Val  Loss: 1.9548 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 2.1828 | Val  Acc: 0.2973
 Site-MNIST_M                       | Val  Loss: 2.2291 | Val  Acc: 0.3649
 Site-SVHN                          | Val  Loss: 2.2139 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4541
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7162
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5946
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2973
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3649
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.9151 | Train Acc: 0.6115
 Site-USPS                          | Train Loss: 1.8537 | Train Acc: 0.6486
 Site-SynthDigits                   | Train Loss: 2.1453 | Train Acc: 0.4189
 Site-MNIST_M                       | Train Loss: 2.2040 | Train Acc: 0.3277
 Site-SVHN                          | Train Loss: 2.1841 | Train Acc: 0.2500
Average Train Accuracy: 0.4514
 Site-MNIST                         | Val  Loss: 1.8486 | Val  Acc: 0.7027
 Site-USPS                          | Val  Loss: 1.8922 | Val  Acc: 0.6081
 Site-SynthDigits                   | Val  Loss: 2.1502 | Val  Acc: 0.3784
 Site-MNIST_M                       | Val  Loss: 2.2021 | Val  Acc: 0.3649
 Site-SVHN                          | Val  Loss: 2.1968 | Val  Acc: 0.3108
Average Valid Accuracy: 0.4730
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7027
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6081
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3784
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3649
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.8605 | Train Acc: 0.6419
 Site-USPS                          | Train Loss: 1.7754 | Train Acc: 0.6858
 Site-SynthDigits                   | Train Loss: 2.1157 | Train Acc: 0.4561
 Site-MNIST_M                       | Train Loss: 2.1835 | Train Acc: 0.3446
 Site-SVHN                          | Train Loss: 2.1731 | Train Acc: 0.2534
Average Train Accuracy: 0.4764
 Site-MNIST                         | Val  Loss: 1.7848 | Val  Acc: 0.7162
 Site-USPS                          | Val  Loss: 1.8237 | Val  Acc: 0.6622
 Site-SynthDigits                   | Val  Loss: 2.1250 | Val  Acc: 0.4459
 Site-MNIST_M                       | Val  Loss: 2.1756 | Val  Acc: 0.3784
 Site-SVHN                          | Val  Loss: 2.1784 | Val  Acc: 0.3108
Average Valid Accuracy: 0.5027
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7162
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6622
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4459
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3784
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.8116 | Train Acc: 0.6622
 Site-USPS                          | Train Loss: 1.7161 | Train Acc: 0.7128
 Site-SynthDigits                   | Train Loss: 2.0832 | Train Acc: 0.4595
 Site-MNIST_M                       | Train Loss: 2.1579 | Train Acc: 0.3581
 Site-SVHN                          | Train Loss: 2.1468 | Train Acc: 0.2770
Average Train Accuracy: 0.4939
 Site-MNIST                         | Val  Loss: 1.7323 | Val  Acc: 0.7162
 Site-USPS                          | Val  Loss: 1.7567 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 2.0829 | Val  Acc: 0.4459
 Site-MNIST_M                       | Val  Loss: 2.1554 | Val  Acc: 0.3514
 Site-SVHN                          | Val  Loss: 2.1621 | Val  Acc: 0.2973
Average Valid Accuracy: 0.5027
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.7597 | Train Acc: 0.6757
 Site-USPS                          | Train Loss: 1.6493 | Train Acc: 0.7196
 Site-SynthDigits                   | Train Loss: 2.0548 | Train Acc: 0.4831
 Site-MNIST_M                       | Train Loss: 2.1304 | Train Acc: 0.3649
 Site-SVHN                          | Train Loss: 2.1419 | Train Acc: 0.2804
Average Train Accuracy: 0.5047
 Site-MNIST                         | Val  Loss: 1.6716 | Val  Acc: 0.7297
 Site-USPS                          | Val  Loss: 1.7032 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 2.0466 | Val  Acc: 0.4730
 Site-MNIST_M                       | Val  Loss: 2.1196 | Val  Acc: 0.3514
 Site-SVHN                          | Val  Loss: 2.1537 | Val  Acc: 0.3108
Average Valid Accuracy: 0.5162
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7297
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7162
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4730
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3514
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.6977 | Train Acc: 0.6824
 Site-USPS                          | Train Loss: 1.5911 | Train Acc: 0.7095
 Site-SynthDigits                   | Train Loss: 2.0241 | Train Acc: 0.4899
 Site-MNIST_M                       | Train Loss: 2.1189 | Train Acc: 0.3818
 Site-SVHN                          | Train Loss: 2.1250 | Train Acc: 0.2804
Average Train Accuracy: 0.5088
 Site-MNIST                         | Val  Loss: 1.6013 | Val  Acc: 0.7297
 Site-USPS                          | Val  Loss: 1.6484 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 2.0228 | Val  Acc: 0.4730
 Site-MNIST_M                       | Val  Loss: 2.0923 | Val  Acc: 0.3784
 Site-SVHN                          | Val  Loss: 2.1361 | Val  Acc: 0.3243
Average Valid Accuracy: 0.5162
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 1.6287 | Train Acc: 0.6993
 Site-USPS                          | Train Loss: 1.5451 | Train Acc: 0.7061
 Site-SynthDigits                   | Train Loss: 2.0018 | Train Acc: 0.4966
 Site-MNIST_M                       | Train Loss: 2.0928 | Train Acc: 0.4054
 Site-SVHN                          | Train Loss: 2.1221 | Train Acc: 0.2804
Average Train Accuracy: 0.5176
 Site-MNIST                         | Val  Loss: 1.5321 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.6037 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 2.0006 | Val  Acc: 0.5135
 Site-MNIST_M                       | Val  Loss: 2.0717 | Val  Acc: 0.3649
 Site-SVHN                          | Val  Loss: 2.1183 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5351
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5135
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3649
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 1.5936 | Train Acc: 0.7128
 Site-USPS                          | Train Loss: 1.4925 | Train Acc: 0.7297
 Site-SynthDigits                   | Train Loss: 1.9582 | Train Acc: 0.5101
 Site-MNIST_M                       | Train Loss: 2.0701 | Train Acc: 0.4088
 Site-SVHN                          | Train Loss: 2.1008 | Train Acc: 0.3041
Average Train Accuracy: 0.5331
 Site-MNIST                         | Val  Loss: 1.4977 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.5454 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.9556 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 2.0538 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.1383 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5541
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 1.5307 | Train Acc: 0.7297
 Site-USPS                          | Train Loss: 1.4372 | Train Acc: 0.7331
 Site-SynthDigits                   | Train Loss: 1.9383 | Train Acc: 0.5203
 Site-MNIST_M                       | Train Loss: 2.0603 | Train Acc: 0.4291
 Site-SVHN                          | Train Loss: 2.0816 | Train Acc: 0.2905
Average Train Accuracy: 0.5405
 Site-MNIST                         | Val  Loss: 1.4301 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.4946 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 1.9340 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 2.0309 | Val  Acc: 0.3919
 Site-SVHN                          | Val  Loss: 2.1031 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5459
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 1.4850 | Train Acc: 0.7297
 Site-USPS                          | Train Loss: 1.4197 | Train Acc: 0.7297
 Site-SynthDigits                   | Train Loss: 1.9047 | Train Acc: 0.5270
 Site-MNIST_M                       | Train Loss: 2.0371 | Train Acc: 0.4324
 Site-SVHN                          | Train Loss: 2.0721 | Train Acc: 0.3176
Average Train Accuracy: 0.5473
 Site-MNIST                         | Val  Loss: 1.3827 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.4629 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.8924 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 2.0174 | Val  Acc: 0.3919
 Site-SVHN                          | Val  Loss: 2.1144 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5486
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 1.4372 | Train Acc: 0.7432
 Site-USPS                          | Train Loss: 1.3518 | Train Acc: 0.7500
 Site-SynthDigits                   | Train Loss: 1.8848 | Train Acc: 0.5338
 Site-MNIST_M                       | Train Loss: 2.0075 | Train Acc: 0.4459
 Site-SVHN                          | Train Loss: 2.0550 | Train Acc: 0.3108
Average Train Accuracy: 0.5568
 Site-MNIST                         | Val  Loss: 1.3373 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.4023 | Val  Acc: 0.7703
 Site-SynthDigits                   | Val  Loss: 1.8743 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.9801 | Val  Acc: 0.4054
 Site-SVHN                          | Val  Loss: 2.0940 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5703
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7703
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5405
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4054
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 1.3898 | Train Acc: 0.7500
 Site-USPS                          | Train Loss: 1.3095 | Train Acc: 0.7466
 Site-SynthDigits                   | Train Loss: 1.8471 | Train Acc: 0.5405
 Site-MNIST_M                       | Train Loss: 1.9898 | Train Acc: 0.4493
 Site-SVHN                          | Train Loss: 2.0554 | Train Acc: 0.3243
Average Train Accuracy: 0.5622
 Site-MNIST                         | Val  Loss: 1.2931 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.3705 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.8323 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.9707 | Val  Acc: 0.4189
 Site-SVHN                          | Val  Loss: 2.0920 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5595
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 1.3494 | Train Acc: 0.7736
 Site-USPS                          | Train Loss: 1.2604 | Train Acc: 0.7703
 Site-SynthDigits                   | Train Loss: 1.8277 | Train Acc: 0.5439
 Site-MNIST_M                       | Train Loss: 1.9611 | Train Acc: 0.4459
 Site-SVHN                          | Train Loss: 2.0369 | Train Acc: 0.3176
Average Train Accuracy: 0.5703
 Site-MNIST                         | Val  Loss: 1.2446 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.3231 | Val  Acc: 0.7703
 Site-SynthDigits                   | Val  Loss: 1.8246 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.9346 | Val  Acc: 0.4054
 Site-SVHN                          | Val  Loss: 2.0810 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5676
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 1.3229 | Train Acc: 0.7635
 Site-USPS                          | Train Loss: 1.2425 | Train Acc: 0.7872
 Site-SynthDigits                   | Train Loss: 1.7869 | Train Acc: 0.5439
 Site-MNIST_M                       | Train Loss: 1.9565 | Train Acc: 0.4662
 Site-SVHN                          | Train Loss: 2.0242 | Train Acc: 0.3480
Average Train Accuracy: 0.5818
 Site-MNIST                         | Val  Loss: 1.2128 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.2872 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.7757 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.9501 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.0390 | Val  Acc: 0.4189
Average Valid Accuracy: 0.5784
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5270
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 1.2614 | Train Acc: 0.7703
 Site-USPS                          | Train Loss: 1.1814 | Train Acc: 0.7905
 Site-SynthDigits                   | Train Loss: 1.7650 | Train Acc: 0.5473
 Site-MNIST_M                       | Train Loss: 1.9281 | Train Acc: 0.4628
 Site-SVHN                          | Train Loss: 2.0215 | Train Acc: 0.3446
Average Train Accuracy: 0.5831
 Site-MNIST                         | Val  Loss: 1.1644 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.2417 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.7614 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.9135 | Val  Acc: 0.4459
 Site-SVHN                          | Val  Loss: 2.0535 | Val  Acc: 0.3919
Average Valid Accuracy: 0.5838
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7838
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5270
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4459
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 1.2269 | Train Acc: 0.7736
 Site-USPS                          | Train Loss: 1.1141 | Train Acc: 0.8041
 Site-SynthDigits                   | Train Loss: 1.7621 | Train Acc: 0.5473
 Site-MNIST_M                       | Train Loss: 1.9060 | Train Acc: 0.4865
 Site-SVHN                          | Train Loss: 2.0086 | Train Acc: 0.3345
Average Train Accuracy: 0.5892
 Site-MNIST                         | Val  Loss: 1.1364 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.1830 | Val  Acc: 0.8108
 Site-SynthDigits                   | Val  Loss: 1.7547 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.8742 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 2.0526 | Val  Acc: 0.3919
Average Valid Accuracy: 0.5973
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8108
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 1.2142 | Train Acc: 0.7601
 Site-USPS                          | Train Loss: 1.1247 | Train Acc: 0.8007
 Site-SynthDigits                   | Train Loss: 1.7144 | Train Acc: 0.5405
 Site-MNIST_M                       | Train Loss: 1.8941 | Train Acc: 0.4764
 Site-SVHN                          | Train Loss: 1.9921 | Train Acc: 0.3514
Average Train Accuracy: 0.5858
 Site-MNIST                         | Val  Loss: 1.1021 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.1638 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.7076 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.8778 | Val  Acc: 0.4459
 Site-SVHN                          | Val  Loss: 2.0186 | Val  Acc: 0.3919
Average Valid Accuracy: 0.5865
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 1.1697 | Train Acc: 0.7905
 Site-USPS                          | Train Loss: 1.0940 | Train Acc: 0.8074
 Site-SynthDigits                   | Train Loss: 1.6874 | Train Acc: 0.5507
 Site-MNIST_M                       | Train Loss: 1.8730 | Train Acc: 0.4899
 Site-SVHN                          | Train Loss: 1.9904 | Train Acc: 0.3615
Average Train Accuracy: 0.6000
 Site-MNIST                         | Val  Loss: 1.0706 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.1394 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.6751 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.8601 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 1.9946 | Val  Acc: 0.4054
Average Valid Accuracy: 0.5946
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 1.1265 | Train Acc: 0.7872
 Site-USPS                          | Train Loss: 1.0595 | Train Acc: 0.8142
 Site-SynthDigits                   | Train Loss: 1.6824 | Train Acc: 0.5642
 Site-MNIST_M                       | Train Loss: 1.8589 | Train Acc: 0.4932
 Site-SVHN                          | Train Loss: 1.9670 | Train Acc: 0.3514
Average Train Accuracy: 0.6020
 Site-MNIST                         | Val  Loss: 1.0437 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.0927 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.6571 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.8401 | Val  Acc: 0.4459
 Site-SVHN                          | Val  Loss: 1.9997 | Val  Acc: 0.4054
Average Valid Accuracy: 0.5973
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 1.1052 | Train Acc: 0.7939
 Site-USPS                          | Train Loss: 1.0347 | Train Acc: 0.8209
 Site-SynthDigits                   | Train Loss: 1.6526 | Train Acc: 0.5642
 Site-MNIST_M                       | Train Loss: 1.8343 | Train Acc: 0.4966
 Site-SVHN                          | Train Loss: 1.9566 | Train Acc: 0.3615
Average Train Accuracy: 0.6074
 Site-MNIST                         | Val  Loss: 1.0102 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.0729 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.6253 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.8323 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 1.9605 | Val  Acc: 0.4189
Average Valid Accuracy: 0.5973
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 1.0749 | Train Acc: 0.8142
 Site-USPS                          | Train Loss: 0.9826 | Train Acc: 0.8311
 Site-SynthDigits                   | Train Loss: 1.6394 | Train Acc: 0.5608
 Site-MNIST_M                       | Train Loss: 1.8169 | Train Acc: 0.5169
 Site-SVHN                          | Train Loss: 1.9503 | Train Acc: 0.3615
Average Train Accuracy: 0.6169
 Site-MNIST                         | Val  Loss: 0.9789 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.0251 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6294 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.8017 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 1.9795 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6189
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 1.0502 | Train Acc: 0.7973
 Site-USPS                          | Train Loss: 0.9638 | Train Acc: 0.8412
 Site-SynthDigits                   | Train Loss: 1.6048 | Train Acc: 0.5709
 Site-MNIST_M                       | Train Loss: 1.7945 | Train Acc: 0.5068
 Site-SVHN                          | Train Loss: 1.9407 | Train Acc: 0.3682
Average Train Accuracy: 0.6169
 Site-MNIST                         | Val  Loss: 0.9567 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.0130 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.5980 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.7883 | Val  Acc: 0.4730
 Site-SVHN                          | Val  Loss: 1.9417 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6108
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 1.0132 | Train Acc: 0.8074
 Site-USPS                          | Train Loss: 0.9333 | Train Acc: 0.8378
 Site-SynthDigits                   | Train Loss: 1.5996 | Train Acc: 0.5676
 Site-MNIST_M                       | Train Loss: 1.7761 | Train Acc: 0.5236
 Site-SVHN                          | Train Loss: 1.9203 | Train Acc: 0.3750
Average Train Accuracy: 0.6223
 Site-MNIST                         | Val  Loss: 0.9298 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.9780 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.5754 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.7732 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.9306 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6270
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8514
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.4865
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.9829 | Train Acc: 0.8041
 Site-USPS                          | Train Loss: 0.9178 | Train Acc: 0.8378
 Site-SynthDigits                   | Train Loss: 1.5917 | Train Acc: 0.5743
 Site-MNIST_M                       | Train Loss: 1.7612 | Train Acc: 0.5304
 Site-SVHN                          | Train Loss: 1.9296 | Train Acc: 0.3682
Average Train Accuracy: 0.6230
 Site-MNIST                         | Val  Loss: 0.9112 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.9458 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.5616 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.7539 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.9196 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6162
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.9726 | Train Acc: 0.8074
 Site-USPS                          | Train Loss: 0.8851 | Train Acc: 0.8480
 Site-SynthDigits                   | Train Loss: 1.5799 | Train Acc: 0.5709
 Site-MNIST_M                       | Train Loss: 1.7348 | Train Acc: 0.5372
 Site-SVHN                          | Train Loss: 1.9008 | Train Acc: 0.3986
Average Train Accuracy: 0.6324
 Site-MNIST                         | Val  Loss: 0.8936 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.9246 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.5462 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.7503 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8784 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6270
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.9432 | Train Acc: 0.8176
 Site-USPS                          | Train Loss: 0.8941 | Train Acc: 0.8345
 Site-SynthDigits                   | Train Loss: 1.5271 | Train Acc: 0.5709
 Site-MNIST_M                       | Train Loss: 1.7299 | Train Acc: 0.5169
 Site-SVHN                          | Train Loss: 1.8977 | Train Acc: 0.3919
Average Train Accuracy: 0.6264
 Site-MNIST                         | Val  Loss: 0.8712 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 0.9289 | Val  Acc: 0.8108
 Site-SynthDigits                   | Val  Loss: 1.5158 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.7493 | Val  Acc: 0.4730
 Site-SVHN                          | Val  Loss: 1.8769 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6108
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.9223 | Train Acc: 0.8277
 Site-USPS                          | Train Loss: 0.8253 | Train Acc: 0.8514
 Site-SynthDigits                   | Train Loss: 1.5294 | Train Acc: 0.5676
 Site-MNIST_M                       | Train Loss: 1.7028 | Train Acc: 0.5541
 Site-SVHN                          | Train Loss: 1.8962 | Train Acc: 0.3953
Average Train Accuracy: 0.6392
 Site-MNIST                         | Val  Loss: 0.8530 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.8688 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.5126 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.7218 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8539 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6351
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.8957 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.8230 | Train Acc: 0.8412
 Site-SynthDigits                   | Train Loss: 1.5079 | Train Acc: 0.5642
 Site-MNIST_M                       | Train Loss: 1.6979 | Train Acc: 0.5541
 Site-SVHN                          | Train Loss: 1.8862 | Train Acc: 0.4020
Average Train Accuracy: 0.6399
 Site-MNIST                         | Val  Loss: 0.8269 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.8639 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.4973 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.7079 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8593 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6324
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.8818 | Train Acc: 0.8209
 Site-USPS                          | Train Loss: 0.8070 | Train Acc: 0.8514
 Site-SynthDigits                   | Train Loss: 1.4895 | Train Acc: 0.5676
 Site-MNIST_M                       | Train Loss: 1.6750 | Train Acc: 0.5473
 Site-SVHN                          | Train Loss: 1.8691 | Train Acc: 0.3986
Average Train Accuracy: 0.6372
 Site-MNIST                         | Val  Loss: 0.8204 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.8420 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4717 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.6938 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8542 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6324
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.8500 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.7978 | Train Acc: 0.8514
 Site-SynthDigits                   | Train Loss: 1.4735 | Train Acc: 0.5777
 Site-MNIST_M                       | Train Loss: 1.6654 | Train Acc: 0.5541
 Site-SVHN                          | Train Loss: 1.8759 | Train Acc: 0.3953
Average Train Accuracy: 0.6432
 Site-MNIST                         | Val  Loss: 0.7943 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.8342 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.4571 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.6841 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8328 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6270
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.8475 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.7510 | Train Acc: 0.8615
 Site-SynthDigits                   | Train Loss: 1.4653 | Train Acc: 0.5946
 Site-MNIST_M                       | Train Loss: 1.6380 | Train Acc: 0.5845
 Site-SVHN                          | Train Loss: 1.8534 | Train Acc: 0.3851
Average Train Accuracy: 0.6527
 Site-MNIST                         | Val  Loss: 0.7792 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.7865 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4499 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.6404 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.8214 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6459
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.5946
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5541
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.8401 | Train Acc: 0.8345
 Site-USPS                          | Train Loss: 0.7526 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.4437 | Train Acc: 0.5912
 Site-MNIST_M                       | Train Loss: 1.6303 | Train Acc: 0.5608
 Site-SVHN                          | Train Loss: 1.8485 | Train Acc: 0.3885
Average Train Accuracy: 0.6480
 Site-MNIST                         | Val  Loss: 0.7690 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.7933 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.4064 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.6545 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8102 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6405
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.8169 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.7190 | Train Acc: 0.8581
 Site-SynthDigits                   | Train Loss: 1.4350 | Train Acc: 0.5912
 Site-MNIST_M                       | Train Loss: 1.6061 | Train Acc: 0.5811
 Site-SVHN                          | Train Loss: 1.8441 | Train Acc: 0.3851
Average Train Accuracy: 0.6507
 Site-MNIST                         | Val  Loss: 0.7511 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.7561 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4182 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.6055 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.8070 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6405
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.7940 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.7289 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.4088 | Train Acc: 0.5980
 Site-MNIST_M                       | Train Loss: 1.5936 | Train Acc: 0.5709
 Site-SVHN                          | Train Loss: 1.8285 | Train Acc: 0.4020
Average Train Accuracy: 0.6568
 Site-MNIST                         | Val  Loss: 0.7345 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.7641 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.3895 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.6143 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.7850 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6514
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8514
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6081
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5405
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.7886 | Train Acc: 0.8345
 Site-USPS                          | Train Loss: 0.6936 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.4223 | Train Acc: 0.5946
 Site-MNIST_M                       | Train Loss: 1.5855 | Train Acc: 0.5878
 Site-SVHN                          | Train Loss: 1.8208 | Train Acc: 0.4088
Average Train Accuracy: 0.6588
 Site-MNIST                         | Val  Loss: 0.7277 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.7223 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.3889 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5902 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.7865 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6514
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5541
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.7526 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.6937 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.3973 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.5734 | Train Acc: 0.5709
 Site-SVHN                          | Train Loss: 1.8183 | Train Acc: 0.3986
Average Train Accuracy: 0.6568
 Site-MNIST                         | Val  Loss: 0.7117 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.7253 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.3663 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.5763 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.7729 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6568
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8514
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6081
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5405
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.7386 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.6734 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.4003 | Train Acc: 0.5980
 Site-MNIST_M                       | Train Loss: 1.5520 | Train Acc: 0.5912
 Site-SVHN                          | Train Loss: 1.8206 | Train Acc: 0.4054
Average Train Accuracy: 0.6615
 Site-MNIST                         | Val  Loss: 0.6957 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.7028 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.3682 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5844 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.7782 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6486
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.7241 | Train Acc: 0.8615
 Site-USPS                          | Train Loss: 0.6576 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.3681 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.5383 | Train Acc: 0.5980
 Site-SVHN                          | Train Loss: 1.8093 | Train Acc: 0.4020
Average Train Accuracy: 0.6696
 Site-MNIST                         | Val  Loss: 0.6793 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6864 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.3517 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5450 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.7470 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6676
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5541
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.7135 | Train Acc: 0.8615
 Site-USPS                          | Train Loss: 0.6498 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.3673 | Train Acc: 0.6149
 Site-MNIST_M                       | Train Loss: 1.5388 | Train Acc: 0.5912
 Site-SVHN                          | Train Loss: 1.7962 | Train Acc: 0.4054
Average Train Accuracy: 0.6689
 Site-MNIST                         | Val  Loss: 0.6730 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6917 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.3443 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.5725 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.7724 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6649
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.7075 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.6302 | Train Acc: 0.8851
 Site-SynthDigits                   | Train Loss: 1.3723 | Train Acc: 0.6014
 Site-MNIST_M                       | Train Loss: 1.5140 | Train Acc: 0.6216
 Site-SVHN                          | Train Loss: 1.7793 | Train Acc: 0.4054
Average Train Accuracy: 0.6743
 Site-MNIST                         | Val  Loss: 0.6643 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6383 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.3590 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.5339 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.7550 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6595
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.6957 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.6359 | Train Acc: 0.8784
 Site-SynthDigits                   | Train Loss: 1.3445 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.5058 | Train Acc: 0.6047
 Site-SVHN                          | Train Loss: 1.7876 | Train Acc: 0.4122
Average Train Accuracy: 0.6757
 Site-MNIST                         | Val  Loss: 0.6535 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.6666 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.3323 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.5596 | Val  Acc: 0.5676
 Site-SVHN                          | Val  Loss: 1.7487 | Val  Acc: 0.5270
Average Valid Accuracy: 0.6784
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6216
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5676
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.5270
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.6880 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.6063 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.3320 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.4923 | Train Acc: 0.6419
 Site-SVHN                          | Train Loss: 1.7554 | Train Acc: 0.4324
Average Train Accuracy: 0.6851
 Site-MNIST                         | Val  Loss: 0.6443 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6176 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.3286 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.5320 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.7313 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6811
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5946
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.5946
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.6721 | Train Acc: 0.8649
 Site-USPS                          | Train Loss: 0.5901 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.3254 | Train Acc: 0.6216
 Site-MNIST_M                       | Train Loss: 1.4824 | Train Acc: 0.6385
 Site-SVHN                          | Train Loss: 1.7588 | Train Acc: 0.4088
Average Train Accuracy: 0.6845
 Site-MNIST                         | Val  Loss: 0.6356 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.6199 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.3107 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.5146 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.7317 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6892
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6081
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.6547 | Train Acc: 0.8480
 Site-USPS                          | Train Loss: 0.5857 | Train Acc: 0.8953
 Site-SynthDigits                   | Train Loss: 1.3155 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.4689 | Train Acc: 0.6284
 Site-SVHN                          | Train Loss: 1.7585 | Train Acc: 0.4257
Average Train Accuracy: 0.6845
 Site-MNIST                         | Val  Loss: 0.6281 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.5959 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.3162 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.4775 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7357 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6838
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.6505 | Train Acc: 0.8649
 Site-USPS                          | Train Loss: 0.5858 | Train Acc: 0.8784
 Site-SynthDigits                   | Train Loss: 1.2987 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.4581 | Train Acc: 0.6351
 Site-SVHN                          | Train Loss: 1.7356 | Train Acc: 0.4324
Average Train Accuracy: 0.6878
 Site-MNIST                         | Val  Loss: 0.6218 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.5974 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.2797 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.4779 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7277 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6865
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.6251 | Train Acc: 0.8716
 Site-USPS                          | Train Loss: 0.5699 | Train Acc: 0.8986
 Site-SynthDigits                   | Train Loss: 1.3065 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.4536 | Train Acc: 0.6419
 Site-SVHN                          | Train Loss: 1.7292 | Train Acc: 0.4257
Average Train Accuracy: 0.6932
 Site-MNIST                         | Val  Loss: 0.6054 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.5789 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.2805 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.4621 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.7120 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7000
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6486
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6216
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/term...
===2023-07-03 00:39:40===
===2023-07-03 00:39:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8086
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8656
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.5522
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.4157
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2957
MNIST: 0.8086, USPS: 0.8656, SynthDigits: 0.5522, MNIST_M: 0.4157, SVHN: 0.2957, 
Average Test Accuracy(group): 0.5876, Average Test Accuracy(individual): 0.5876,
domain std=0.2200, cluster std=-1.0000, individual std=0.2200, 
