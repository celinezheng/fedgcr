===2023-07-03 00:42:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.8632 | Train Acc: 0.6655
 Site-USPS                          | Train Loss: 1.7106 | Train Acc: 0.7399
 Site-SynthDigits                   | Train Loss: 2.1045 | Train Acc: 0.3243
 Site-MNIST_M                       | Train Loss: 2.1573 | Train Acc: 0.3514
 Site-SVHN                          | Train Loss: 2.1660 | Train Acc: 0.2264
Average Train Accuracy: 0.4615
 Site-MNIST                         | Val  Loss: 1.7854 | Val  Acc: 0.6757
 Site-USPS                          | Val  Loss: 1.7761 | Val  Acc: 0.6351
 Site-SynthDigits                   | Val  Loss: 2.1188 | Val  Acc: 0.2703
 Site-MNIST_M                       | Val  Loss: 2.1380 | Val  Acc: 0.3784
 Site-SVHN                          | Val  Loss: 2.1712 | Val  Acc: 0.1892
Average Valid Accuracy: 0.4297
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6757
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6351
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2703
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3784
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.4798 | Train Acc: 0.7466
 Site-USPS                          | Train Loss: 1.3459 | Train Acc: 0.7331
 Site-SynthDigits                   | Train Loss: 1.8997 | Train Acc: 0.4595
 Site-MNIST_M                       | Train Loss: 2.0203 | Train Acc: 0.3851
 Site-SVHN                          | Train Loss: 2.0863 | Train Acc: 0.2973
Average Train Accuracy: 0.5243
 Site-MNIST                         | Val  Loss: 1.3778 | Val  Acc: 0.7027
 Site-USPS                          | Val  Loss: 1.4429 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 1.9562 | Val  Acc: 0.4189
 Site-MNIST_M                       | Val  Loss: 2.0002 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 2.0949 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5270
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7027
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7162
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4189
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.2449 | Train Acc: 0.7635
 Site-USPS                          | Train Loss: 1.0553 | Train Acc: 0.7939
 Site-SynthDigits                   | Train Loss: 1.7586 | Train Acc: 0.4932
 Site-MNIST_M                       | Train Loss: 1.9591 | Train Acc: 0.4088
 Site-SVHN                          | Train Loss: 2.0108 | Train Acc: 0.3041
Average Train Accuracy: 0.5527
 Site-MNIST                         | Val  Loss: 1.1418 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.1534 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.7990 | Val  Acc: 0.4459
 Site-MNIST_M                       | Val  Loss: 1.9140 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 2.0282 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5703
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7838
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4459
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4865
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.0231 | Train Acc: 0.7770
 Site-USPS                          | Train Loss: 0.8252 | Train Acc: 0.8209
 Site-SynthDigits                   | Train Loss: 1.5934 | Train Acc: 0.5541
 Site-MNIST_M                       | Train Loss: 1.7617 | Train Acc: 0.4899
 Site-SVHN                          | Train Loss: 1.9227 | Train Acc: 0.3649
Average Train Accuracy: 0.6014
 Site-MNIST                         | Val  Loss: 0.9230 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8989 | Val  Acc: 0.8108
 Site-SynthDigits                   | Val  Loss: 1.6362 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.7083 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.9740 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6297
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8108
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5405
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5946
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.8590 | Train Acc: 0.8074
 Site-USPS                          | Train Loss: 0.7374 | Train Acc: 0.8243
 Site-SynthDigits                   | Train Loss: 1.5021 | Train Acc: 0.5845
 Site-MNIST_M                       | Train Loss: 1.6716 | Train Acc: 0.5101
 Site-SVHN                          | Train Loss: 1.8664 | Train Acc: 0.4155
Average Train Accuracy: 0.6284
 Site-MNIST                         | Val  Loss: 0.7678 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8123 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.5779 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.5919 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.9119 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6514
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7973
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.7699 | Train Acc: 0.8108
 Site-USPS                          | Train Loss: 0.6186 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.4125 | Train Acc: 0.5845
 Site-MNIST_M                       | Train Loss: 1.5662 | Train Acc: 0.5777
 Site-SVHN                          | Train Loss: 1.8035 | Train Acc: 0.3818
Average Train Accuracy: 0.6439
 Site-MNIST                         | Val  Loss: 0.6916 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.6555 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.3736 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.5466 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.8530 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6514
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.6524 | Train Acc: 0.8615
 Site-USPS                          | Train Loss: 0.5612 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.3256 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.4832 | Train Acc: 0.5574
 Site-SVHN                          | Train Loss: 1.7478 | Train Acc: 0.4155
Average Train Accuracy: 0.6669
 Site-MNIST                         | Val  Loss: 0.5809 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.6092 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.3499 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.4834 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.7915 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6811
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6351
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.5934 | Train Acc: 0.8615
 Site-USPS                          | Train Loss: 0.4787 | Train Acc: 0.8953
 Site-SynthDigits                   | Train Loss: 1.2927 | Train Acc: 0.6149
 Site-MNIST_M                       | Train Loss: 1.3866 | Train Acc: 0.6419
 Site-SVHN                          | Train Loss: 1.7108 | Train Acc: 0.4223
Average Train Accuracy: 0.6872
 Site-MNIST                         | Val  Loss: 0.5416 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.5142 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.3232 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.3591 | Val  Acc: 0.6892
 Site-SVHN                          | Val  Loss: 1.8104 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6973
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6081
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.6892
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.5214 | Train Acc: 0.8885
 Site-USPS                          | Train Loss: 0.4587 | Train Acc: 0.8919
 Site-SynthDigits                   | Train Loss: 1.2182 | Train Acc: 0.6453
 Site-MNIST_M                       | Train Loss: 1.3382 | Train Acc: 0.6351
 Site-SVHN                          | Train Loss: 1.6433 | Train Acc: 0.4730
Average Train Accuracy: 0.7068
 Site-MNIST                         | Val  Loss: 0.4822 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.5080 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.3229 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.3420 | Val  Acc: 0.6892
 Site-SVHN                          | Val  Loss: 1.7211 | Val  Acc: 0.5405
Average Valid Accuracy: 0.7216
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6351
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.6892
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.5405
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.5043 | Train Acc: 0.8784
 Site-USPS                          | Train Loss: 0.3952 | Train Acc: 0.9088
 Site-SynthDigits                   | Train Loss: 1.1813 | Train Acc: 0.6554
 Site-MNIST_M                       | Train Loss: 1.2679 | Train Acc: 0.6892
 Site-SVHN                          | Train Loss: 1.6176 | Train Acc: 0.4595
Average Train Accuracy: 0.7182
 Site-MNIST                         | Val  Loss: 0.4806 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.4069 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.2593 | Val  Acc: 0.6892
 Site-MNIST_M                       | Val  Loss: 1.2440 | Val  Acc: 0.7568
 Site-SVHN                          | Val  Loss: 1.7297 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7351
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.6892
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.7568
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.4399 | Train Acc: 0.8953
 Site-USPS                          | Train Loss: 0.3809 | Train Acc: 0.9054
 Site-SynthDigits                   | Train Loss: 1.1513 | Train Acc: 0.6520
 Site-MNIST_M                       | Train Loss: 1.1842 | Train Acc: 0.7128
 Site-SVHN                          | Train Loss: 1.5925 | Train Acc: 0.4899
Average Train Accuracy: 0.7311
 Site-MNIST                         | Val  Loss: 0.4280 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4177 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.2486 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.1743 | Val  Acc: 0.7432
 Site-SVHN                          | Val  Loss: 1.7140 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7324
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.4186 | Train Acc: 0.8953
 Site-USPS                          | Train Loss: 0.3490 | Train Acc: 0.9223
 Site-SynthDigits                   | Train Loss: 1.0930 | Train Acc: 0.6926
 Site-MNIST_M                       | Train Loss: 1.1551 | Train Acc: 0.7061
 Site-SVHN                          | Train Loss: 1.5307 | Train Acc: 0.5135
Average Train Accuracy: 0.7459
 Site-MNIST                         | Val  Loss: 0.4046 | Val  Acc: 0.8919
 Site-USPS                          | Val  Loss: 0.3623 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.2322 | Val  Acc: 0.6757
 Site-MNIST_M                       | Val  Loss: 1.1384 | Val  Acc: 0.7703
 Site-SVHN                          | Val  Loss: 1.6796 | Val  Acc: 0.5405
Average Valid Accuracy: 0.7568
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8919
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6757
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.7703
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.5405
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.3808 | Train Acc: 0.8986
 Site-USPS                          | Train Loss: 0.3386 | Train Acc: 0.9155
 Site-SynthDigits                   | Train Loss: 1.0392 | Train Acc: 0.6858
 Site-MNIST_M                       | Train Loss: 1.1040 | Train Acc: 0.7230
 Site-SVHN                          | Train Loss: 1.4869 | Train Acc: 0.5304
Average Train Accuracy: 0.7507
 Site-MNIST                         | Val  Loss: 0.3894 | Val  Acc: 0.9054
 Site-USPS                          | Val  Loss: 0.3617 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.1460 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.0949 | Val  Acc: 0.7838
 Site-SVHN                          | Val  Loss: 1.5699 | Val  Acc: 0.5811
Average Valid Accuracy: 0.7676
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9054
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6622
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.7838
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.3629 | Train Acc: 0.9020
 Site-USPS                          | Train Loss: 0.3059 | Train Acc: 0.9291
 Site-SynthDigits                   | Train Loss: 1.0219 | Train Acc: 0.7027
 Site-MNIST_M                       | Train Loss: 1.0612 | Train Acc: 0.7601
 Site-SVHN                          | Train Loss: 1.4652 | Train Acc: 0.5304
Average Train Accuracy: 0.7649
 Site-MNIST                         | Val  Loss: 0.3528 | Val  Acc: 0.8919
 Site-USPS                          | Val  Loss: 0.3185 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.1403 | Val  Acc: 0.7027
 Site-MNIST_M                       | Val  Loss: 1.0479 | Val  Acc: 0.7838
 Site-SVHN                          | Val  Loss: 1.5596 | Val  Acc: 0.5541
Average Valid Accuracy: 0.7703
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8919
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9189
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.7027
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.7838
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.3411 | Train Acc: 0.8986
 Site-USPS                          | Train Loss: 0.2874 | Train Acc: 0.9561
 Site-SynthDigits                   | Train Loss: 0.9888 | Train Acc: 0.7162
 Site-MNIST_M                       | Train Loss: 1.0114 | Train Acc: 0.7466
 Site-SVHN                          | Train Loss: 1.4333 | Train Acc: 0.5304
Average Train Accuracy: 0.7696
 Site-MNIST                         | Val  Loss: 0.3431 | Val  Acc: 0.8784
 Site-USPS                          | Val  Loss: 0.2867 | Val  Acc: 0.9595
 Site-SynthDigits                   | Val  Loss: 1.0391 | Val  Acc: 0.7568
 Site-MNIST_M                       | Val  Loss: 1.0124 | Val  Acc: 0.7568
 Site-SVHN                          | Val  Loss: 1.5209 | Val  Acc: 0.5541
Average Valid Accuracy: 0.7811
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8784
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9595
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.7568
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.7568
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.3134 | Train Acc: 0.9223
 Site-USPS                          | Train Loss: 0.2755 | Train Acc: 0.9459
 Site-SynthDigits                   | Train Loss: 0.9384 | Train Acc: 0.7365
 Site-MNIST_M                       | Train Loss: 0.9987 | Train Acc: 0.7534
 Site-SVHN                          | Train Loss: 1.4043 | Train Acc: 0.5878
Average Train Accuracy: 0.7892
 Site-MNIST                         | Val  Loss: 0.3157 | Val  Acc: 0.8919
 Site-USPS                          | Val  Loss: 0.3075 | Val  Acc: 0.9324
 Site-SynthDigits                   | Val  Loss: 1.0327 | Val  Acc: 0.7432
 Site-MNIST_M                       | Val  Loss: 1.0192 | Val  Acc: 0.7838
 Site-SVHN                          | Val  Loss: 1.4721 | Val  Acc: 0.6081
Average Valid Accuracy: 0.7919
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8919
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9324
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.7432
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.7838
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.2887 | Train Acc: 0.9358
 Site-USPS                          | Train Loss: 0.2542 | Train Acc: 0.9493
 Site-SynthDigits                   | Train Loss: 0.9147 | Train Acc: 0.7399
 Site-MNIST_M                       | Train Loss: 0.9000 | Train Acc: 0.7804
 Site-SVHN                          | Train Loss: 1.3665 | Train Acc: 0.5845
Average Train Accuracy: 0.7980
 Site-MNIST                         | Val  Loss: 0.2853 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.2719 | Val  Acc: 0.9324
 Site-SynthDigits                   | Val  Loss: 0.9866 | Val  Acc: 0.7162
 Site-MNIST_M                       | Val  Loss: 0.9380 | Val  Acc: 0.8108
 Site-SVHN                          | Val  Loss: 1.4086 | Val  Acc: 0.5946
Average Valid Accuracy: 0.7946
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9189
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9324
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7162
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.8108
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.2886 | Train Acc: 0.9358
 Site-USPS                          | Train Loss: 0.2363 | Train Acc: 0.9628
 Site-SynthDigits                   | Train Loss: 0.8778 | Train Acc: 0.7432
 Site-MNIST_M                       | Train Loss: 0.8807 | Train Acc: 0.7905
 Site-SVHN                          | Train Loss: 1.3379 | Train Acc: 0.6047
Average Train Accuracy: 0.8074
 Site-MNIST                         | Val  Loss: 0.2861 | Val  Acc: 0.9054
 Site-USPS                          | Val  Loss: 0.2713 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.9677 | Val  Acc: 0.7027
 Site-MNIST_M                       | Val  Loss: 0.9169 | Val  Acc: 0.8108
 Site-SVHN                          | Val  Loss: 1.3865 | Val  Acc: 0.6216
Average Valid Accuracy: 0.7973
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9054
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7027
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.8108
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.6216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.2447 | Train Acc: 0.9493
 Site-USPS                          | Train Loss: 0.2176 | Train Acc: 0.9662
 Site-SynthDigits                   | Train Loss: 0.8575 | Train Acc: 0.7568
 Site-MNIST_M                       | Train Loss: 0.8611 | Train Acc: 0.7973
 Site-SVHN                          | Train Loss: 1.3339 | Train Acc: 0.6081
Average Train Accuracy: 0.8155
 Site-MNIST                         | Val  Loss: 0.2588 | Val  Acc: 0.9324
 Site-USPS                          | Val  Loss: 0.2360 | Val  Acc: 0.9459
 Site-SynthDigits                   | Val  Loss: 0.9645 | Val  Acc: 0.7162
 Site-MNIST_M                       | Val  Loss: 0.8842 | Val  Acc: 0.7973
 Site-SVHN                          | Val  Loss: 1.4063 | Val  Acc: 0.6351
Average Valid Accuracy: 0.8054
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9324
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9459
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7162
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.7973
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.2343 | Train Acc: 0.9493
 Site-USPS                          | Train Loss: 0.2160 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.8492 | Train Acc: 0.7736
 Site-MNIST_M                       | Train Loss: 0.8098 | Train Acc: 0.8277
 Site-SVHN                          | Train Loss: 1.2700 | Train Acc: 0.6284
Average Train Accuracy: 0.8304
 Site-MNIST                         | Val  Loss: 0.2436 | Val  Acc: 0.9459
 Site-USPS                          | Val  Loss: 0.2553 | Val  Acc: 0.9595
 Site-SynthDigits                   | Val  Loss: 0.9557 | Val  Acc: 0.7432
 Site-MNIST_M                       | Val  Loss: 0.8318 | Val  Acc: 0.8243
 Site-SVHN                          | Val  Loss: 1.3584 | Val  Acc: 0.6486
Average Valid Accuracy: 0.8243
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9459
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9595
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7432
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.8243
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.6486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.2471 | Train Acc: 0.9358
 Site-USPS                          | Train Loss: 0.1908 | Train Acc: 0.9797
 Site-SynthDigits                   | Train Loss: 0.8103 | Train Acc: 0.7736
 Site-MNIST_M                       | Train Loss: 0.8095 | Train Acc: 0.8311
 Site-SVHN                          | Train Loss: 1.2527 | Train Acc: 0.6385
Average Train Accuracy: 0.8318
 Site-MNIST                         | Val  Loss: 0.2575 | Val  Acc: 0.9054
 Site-USPS                          | Val  Loss: 0.1930 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.9256 | Val  Acc: 0.7297
 Site-MNIST_M                       | Val  Loss: 0.8295 | Val  Acc: 0.8514
 Site-SVHN                          | Val  Loss: 1.3277 | Val  Acc: 0.6892
Average Valid Accuracy: 0.8324
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9054
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.7297
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.8514
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.6892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.2297 | Train Acc: 0.9459
 Site-USPS                          | Train Loss: 0.1848 | Train Acc: 0.9696
 Site-SynthDigits                   | Train Loss: 0.7984 | Train Acc: 0.7770
 Site-MNIST_M                       | Train Loss: 0.7740 | Train Acc: 0.8378
 Site-SVHN                          | Train Loss: 1.2246 | Train Acc: 0.6757
Average Train Accuracy: 0.8412
 Site-MNIST                         | Val  Loss: 0.2253 | Val  Acc: 0.9324
 Site-USPS                          | Val  Loss: 0.2072 | Val  Acc: 0.9595
 Site-SynthDigits                   | Val  Loss: 0.8969 | Val  Acc: 0.7838
 Site-MNIST_M                       | Val  Loss: 0.8013 | Val  Acc: 0.8378
 Site-SVHN                          | Val  Loss: 1.2621 | Val  Acc: 0.6892
Average Valid Accuracy: 0.8405
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9324
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9595
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.7838
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.8378
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.6892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.2215 | Train Acc: 0.9426
 Site-USPS                          | Train Loss: 0.1884 | Train Acc: 0.9628
 Site-SynthDigits                   | Train Loss: 0.7849 | Train Acc: 0.7939
 Site-MNIST_M                       | Train Loss: 0.7474 | Train Acc: 0.8547
 Site-SVHN                          | Train Loss: 1.2146 | Train Acc: 0.6419
Average Train Accuracy: 0.8392
 Site-MNIST                         | Val  Loss: 0.2229 | Val  Acc: 0.9324
 Site-USPS                          | Val  Loss: 0.1873 | Val  Acc: 0.9595
 Site-SynthDigits                   | Val  Loss: 0.8882 | Val  Acc: 0.7703
 Site-MNIST_M                       | Val  Loss: 0.7784 | Val  Acc: 0.8649
 Site-SVHN                          | Val  Loss: 1.2799 | Val  Acc: 0.6757
Average Valid Accuracy: 0.8405
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.2041 | Train Acc: 0.9561
 Site-USPS                          | Train Loss: 0.1690 | Train Acc: 0.9696
 Site-SynthDigits                   | Train Loss: 0.7874 | Train Acc: 0.7939
 Site-MNIST_M                       | Train Loss: 0.7110 | Train Acc: 0.8649
 Site-SVHN                          | Train Loss: 1.1761 | Train Acc: 0.6723
Average Train Accuracy: 0.8514
 Site-MNIST                         | Val  Loss: 0.2175 | Val  Acc: 0.9459
 Site-USPS                          | Val  Loss: 0.1666 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.8888 | Val  Acc: 0.7703
 Site-MNIST_M                       | Val  Loss: 0.7273 | Val  Acc: 0.8784
 Site-SVHN                          | Val  Loss: 1.2639 | Val  Acc: 0.6622
Average Valid Accuracy: 0.8486
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9459
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.7703
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.8784
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.6622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.2031 | Train Acc: 0.9493
 Site-USPS                          | Train Loss: 0.1624 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.7542 | Train Acc: 0.8108
 Site-MNIST_M                       | Train Loss: 0.6843 | Train Acc: 0.8615
 Site-SVHN                          | Train Loss: 1.1518 | Train Acc: 0.6757
Average Train Accuracy: 0.8541
 Site-MNIST                         | Val  Loss: 0.2167 | Val  Acc: 0.9189
 Site-USPS                          | Val  Loss: 0.1687 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.8526 | Val  Acc: 0.7703
 Site-MNIST_M                       | Val  Loss: 0.6851 | Val  Acc: 0.8784
 Site-SVHN                          | Val  Loss: 1.2199 | Val  Acc: 0.7027
Average Valid Accuracy: 0.8514
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9189
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.7703
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.8784
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.7027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.1961 | Train Acc: 0.9527
 Site-USPS                          | Train Loss: 0.1635 | Train Acc: 0.9628
 Site-SynthDigits                   | Train Loss: 0.6948 | Train Acc: 0.8209
 Site-MNIST_M                       | Train Loss: 0.6724 | Train Acc: 0.8581
 Site-SVHN                          | Train Loss: 1.1306 | Train Acc: 0.6858
Average Train Accuracy: 0.8561
 Site-MNIST                         | Val  Loss: 0.2000 | Val  Acc: 0.9324
 Site-USPS                          | Val  Loss: 0.2023 | Val  Acc: 0.9595
 Site-SynthDigits                   | Val  Loss: 0.7822 | Val  Acc: 0.7838
 Site-MNIST_M                       | Val  Loss: 0.7011 | Val  Acc: 0.8784
 Site-SVHN                          | Val  Loss: 1.1530 | Val  Acc: 0.7432
Average Valid Accuracy: 0.8595
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9324
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9595
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.7838
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.8784
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.7432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.1686 | Train Acc: 0.9662
 Site-USPS                          | Train Loss: 0.1382 | Train Acc: 0.9831
 Site-SynthDigits                   | Train Loss: 0.7187 | Train Acc: 0.8007
 Site-MNIST_M                       | Train Loss: 0.6442 | Train Acc: 0.8682
 Site-SVHN                          | Train Loss: 1.0918 | Train Acc: 0.7061
Average Train Accuracy: 0.8649
 Site-MNIST                         | Val  Loss: 0.1839 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1755 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.7967 | Val  Acc: 0.7568
 Site-MNIST_M                       | Val  Loss: 0.6758 | Val  Acc: 0.8784
 Site-SVHN                          | Val  Loss: 1.1388 | Val  Acc: 0.7432
Average Valid Accuracy: 0.8649
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9595
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.7568
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.8784
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.7432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.1642 | Train Acc: 0.9628
 Site-USPS                          | Train Loss: 0.1486 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.7193 | Train Acc: 0.8041
 Site-MNIST_M                       | Train Loss: 0.6135 | Train Acc: 0.8851
 Site-SVHN                          | Train Loss: 1.0685 | Train Acc: 0.7230
Average Train Accuracy: 0.8696
 Site-MNIST                         | Val  Loss: 0.1728 | Val  Acc: 0.9459
 Site-USPS                          | Val  Loss: 0.1705 | Val  Acc: 0.9730
 Site-SynthDigits                   | Val  Loss: 0.7656 | Val  Acc: 0.7703
 Site-MNIST_M                       | Val  Loss: 0.6497 | Val  Acc: 0.9054
 Site-SVHN                          | Val  Loss: 1.1153 | Val  Acc: 0.7297
Average Valid Accuracy: 0.8649
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.1589 | Train Acc: 0.9662
 Site-USPS                          | Train Loss: 0.1464 | Train Acc: 0.9797
 Site-SynthDigits                   | Train Loss: 0.6830 | Train Acc: 0.8176
 Site-MNIST_M                       | Train Loss: 0.5675 | Train Acc: 0.9088
 Site-SVHN                          | Train Loss: 1.0540 | Train Acc: 0.7297
Average Train Accuracy: 0.8804
 Site-MNIST                         | Val  Loss: 0.1644 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1622 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.7067 | Val  Acc: 0.7973
 Site-MNIST_M                       | Val  Loss: 0.5767 | Val  Acc: 0.9189
 Site-SVHN                          | Val  Loss: 1.1068 | Val  Acc: 0.7838
Average Valid Accuracy: 0.8892
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9595
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.7973
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.9189
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.7838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.1564 | Train Acc: 0.9662
 Site-USPS                          | Train Loss: 0.1381 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.6670 | Train Acc: 0.8176
 Site-MNIST_M                       | Train Loss: 0.5435 | Train Acc: 0.9054
 Site-SVHN                          | Train Loss: 1.0337 | Train Acc: 0.7365
Average Train Accuracy: 0.8797
 Site-MNIST                         | Val  Loss: 0.1615 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1456 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.7073 | Val  Acc: 0.7838
 Site-MNIST_M                       | Val  Loss: 0.5598 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 1.0434 | Val  Acc: 0.8243
Average Valid Accuracy: 0.8973
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9595
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.7838
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.9324
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.8243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.1517 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1300 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.6458 | Train Acc: 0.8209
 Site-MNIST_M                       | Train Loss: 0.5291 | Train Acc: 0.9189
 Site-SVHN                          | Train Loss: 1.0180 | Train Acc: 0.7568
Average Train Accuracy: 0.8858
 Site-MNIST                         | Val  Loss: 0.1604 | Val  Acc: 0.9459
 Site-USPS                          | Val  Loss: 0.1398 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.7205 | Val  Acc: 0.7838
 Site-MNIST_M                       | Val  Loss: 0.5473 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 1.0179 | Val  Acc: 0.8108
Average Valid Accuracy: 0.8919
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.1487 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.1297 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.6301 | Train Acc: 0.8547
 Site-MNIST_M                       | Train Loss: 0.5304 | Train Acc: 0.9088
 Site-SVHN                          | Train Loss: 1.0045 | Train Acc: 0.7669
Average Train Accuracy: 0.8953
 Site-MNIST                         | Val  Loss: 0.1501 | Val  Acc: 0.9459
 Site-USPS                          | Val  Loss: 0.1407 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6748 | Val  Acc: 0.8108
 Site-MNIST_M                       | Val  Loss: 0.5623 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 1.0293 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9027
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9459
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.8108
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.9324
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.8378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.1416 | Train Acc: 0.9696
 Site-USPS                          | Train Loss: 0.1272 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.6101 | Train Acc: 0.8649
 Site-MNIST_M                       | Train Loss: 0.4895 | Train Acc: 0.9257
 Site-SVHN                          | Train Loss: 0.9817 | Train Acc: 0.7601
Average Train Accuracy: 0.8986
 Site-MNIST                         | Val  Loss: 0.1488 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1390 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6570 | Val  Acc: 0.8243
 Site-MNIST_M                       | Val  Loss: 0.4994 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 0.9875 | Val  Acc: 0.7973
Average Valid Accuracy: 0.9027
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.1337 | Train Acc: 0.9831
 Site-USPS                          | Train Loss: 0.1238 | Train Acc: 0.9764
 Site-SynthDigits                   | Train Loss: 0.5984 | Train Acc: 0.8682
 Site-MNIST_M                       | Train Loss: 0.4732 | Train Acc: 0.9324
 Site-SVHN                          | Train Loss: 0.9864 | Train Acc: 0.7770
Average Train Accuracy: 0.9074
 Site-MNIST                         | Val  Loss: 0.1300 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1561 | Val  Acc: 0.9730
 Site-SynthDigits                   | Val  Loss: 0.6371 | Val  Acc: 0.8243
 Site-MNIST_M                       | Val  Loss: 0.5158 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 1.0161 | Val  Acc: 0.8243
Average Valid Accuracy: 0.9054
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9730
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9730
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.8243
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.9324
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.8243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1314 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.1076 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.6137 | Train Acc: 0.8547
 Site-MNIST_M                       | Train Loss: 0.4740 | Train Acc: 0.9358
 Site-SVHN                          | Train Loss: 0.9629 | Train Acc: 0.7601
Average Train Accuracy: 0.9020
 Site-MNIST                         | Val  Loss: 0.1274 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1150 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6480 | Val  Acc: 0.8243
 Site-MNIST_M                       | Val  Loss: 0.4818 | Val  Acc: 0.9459
 Site-SVHN                          | Val  Loss: 1.0032 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9108
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9595
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8243
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.9459
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.8378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1389 | Train Acc: 0.9696
 Site-USPS                          | Train Loss: 0.1043 | Train Acc: 0.9797
 Site-SynthDigits                   | Train Loss: 0.5825 | Train Acc: 0.8682
 Site-MNIST_M                       | Train Loss: 0.4500 | Train Acc: 0.9358
 Site-SVHN                          | Train Loss: 0.9430 | Train Acc: 0.7872
Average Train Accuracy: 0.9081
 Site-MNIST                         | Val  Loss: 0.1337 | Val  Acc: 0.9459
 Site-USPS                          | Val  Loss: 0.1149 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6325 | Val  Acc: 0.8378
 Site-MNIST_M                       | Val  Loss: 0.4745 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 0.9807 | Val  Acc: 0.8514
Average Valid Accuracy: 0.9108
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.1282 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.0998 | Train Acc: 0.9764
 Site-SynthDigits                   | Train Loss: 0.5520 | Train Acc: 0.8750
 Site-MNIST_M                       | Train Loss: 0.4468 | Train Acc: 0.9291
 Site-SVHN                          | Train Loss: 0.9262 | Train Acc: 0.7770
Average Train Accuracy: 0.9068
 Site-MNIST                         | Val  Loss: 0.1190 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1100 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6416 | Val  Acc: 0.8243
 Site-MNIST_M                       | Val  Loss: 0.4534 | Val  Acc: 0.9324
 Site-SVHN                          | Val  Loss: 0.9277 | Val  Acc: 0.8243
Average Valid Accuracy: 0.9054
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1087 | Train Acc: 0.9797
 Site-USPS                          | Train Loss: 0.1008 | Train Acc: 0.9831
 Site-SynthDigits                   | Train Loss: 0.5684 | Train Acc: 0.8615
 Site-MNIST_M                       | Train Loss: 0.4196 | Train Acc: 0.9392
 Site-SVHN                          | Train Loss: 0.9093 | Train Acc: 0.8007
Average Train Accuracy: 0.9128
 Site-MNIST                         | Val  Loss: 0.1096 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.0993 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.6252 | Val  Acc: 0.8243
 Site-MNIST_M                       | Val  Loss: 0.4407 | Val  Acc: 0.9459
 Site-SVHN                          | Val  Loss: 0.9361 | Val  Acc: 0.8649
Average Valid Accuracy: 0.9189
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9730
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9865
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.8243
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.9459
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.8649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1178 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.1084 | Train Acc: 0.9730
 Site-SynthDigits                   | Train Loss: 0.5359 | Train Acc: 0.8784
 Site-MNIST_M                       | Train Loss: 0.4157 | Train Acc: 0.9459
 Site-SVHN                          | Train Loss: 0.8914 | Train Acc: 0.7872
Average Train Accuracy: 0.9122
 Site-MNIST                         | Val  Loss: 0.1078 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1185 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.5577 | Val  Acc: 0.8649
 Site-MNIST_M                       | Val  Loss: 0.4259 | Val  Acc: 0.9459
 Site-SVHN                          | Val  Loss: 0.9271 | Val  Acc: 0.8108
Average Valid Accuracy: 0.9135
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1047 | Train Acc: 0.9797
 Site-USPS                          | Train Loss: 0.0956 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.5341 | Train Acc: 0.8986
 Site-MNIST_M                       | Train Loss: 0.4019 | Train Acc: 0.9426
 Site-SVHN                          | Train Loss: 0.8733 | Train Acc: 0.7872
Average Train Accuracy: 0.9189
 Site-MNIST                         | Val  Loss: 0.1028 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.1122 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5727 | Val  Acc: 0.8649
 Site-MNIST_M                       | Val  Loss: 0.4051 | Val  Acc: 0.9459
 Site-SVHN                          | Val  Loss: 0.8741 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9243
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9730
 Best site-USPS                      | Epoch:39 | Val Acc: 1.0000
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.8649
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.9459
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.8378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1053 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.0888 | Train Acc: 0.9831
 Site-SynthDigits                   | Train Loss: 0.5304 | Train Acc: 0.8986
 Site-MNIST_M                       | Train Loss: 0.3926 | Train Acc: 0.9493
 Site-SVHN                          | Train Loss: 0.8728 | Train Acc: 0.7939
Average Train Accuracy: 0.9203
 Site-MNIST                         | Val  Loss: 0.1049 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1066 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.5622 | Val  Acc: 0.8649
 Site-MNIST_M                       | Val  Loss: 0.4036 | Val  Acc: 0.9459
 Site-SVHN                          | Val  Loss: 0.8655 | Val  Acc: 0.8243
Average Valid Accuracy: 0.9162
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1113 | Train Acc: 0.9797
 Site-USPS                          | Train Loss: 0.0892 | Train Acc: 0.9797
 Site-SynthDigits                   | Train Loss: 0.5074 | Train Acc: 0.8986
 Site-MNIST_M                       | Train Loss: 0.3826 | Train Acc: 0.9493
 Site-SVHN                          | Train Loss: 0.8530 | Train Acc: 0.8176
Average Train Accuracy: 0.9250
 Site-MNIST                         | Val  Loss: 0.1097 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.0892 | Val  Acc: 0.9865
 Site-SynthDigits                   | Val  Loss: 0.5745 | Val  Acc: 0.8514
 Site-MNIST_M                       | Val  Loss: 0.3807 | Val  Acc: 0.9595
 Site-SVHN                          | Val  Loss: 0.8553 | Val  Acc: 0.8243
Average Valid Accuracy: 0.9162
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1050 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.0880 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.5044 | Train Acc: 0.9122
 Site-MNIST_M                       | Train Loss: 0.3689 | Train Acc: 0.9527
 Site-SVHN                          | Train Loss: 0.8606 | Train Acc: 0.7973
Average Train Accuracy: 0.9257
 Site-MNIST                         | Val  Loss: 0.0986 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1101 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5458 | Val  Acc: 0.8919
 Site-MNIST_M                       | Val  Loss: 0.3604 | Val  Acc: 0.9459
 Site-SVHN                          | Val  Loss: 0.8476 | Val  Acc: 0.8108
Average Valid Accuracy: 0.9216
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.0984 | Train Acc: 0.9831
 Site-USPS                          | Train Loss: 0.0879 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.4990 | Train Acc: 0.8919
 Site-MNIST_M                       | Train Loss: 0.3463 | Train Acc: 0.9662
 Site-SVHN                          | Train Loss: 0.8340 | Train Acc: 0.8108
Average Train Accuracy: 0.9284
 Site-MNIST                         | Val  Loss: 0.0998 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.0927 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5358 | Val  Acc: 0.8378
 Site-MNIST_M                       | Val  Loss: 0.3503 | Val  Acc: 0.9730
 Site-SVHN                          | Val  Loss: 0.8537 | Val  Acc: 0.8243
Average Valid Accuracy: 0.9189
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.0950 | Train Acc: 0.9797
 Site-USPS                          | Train Loss: 0.0799 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.4761 | Train Acc: 0.9054
 Site-MNIST_M                       | Train Loss: 0.3592 | Train Acc: 0.9595
 Site-SVHN                          | Train Loss: 0.8138 | Train Acc: 0.8074
Average Train Accuracy: 0.9277
 Site-MNIST                         | Val  Loss: 0.0937 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.1095 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5522 | Val  Acc: 0.8514
 Site-MNIST_M                       | Val  Loss: 0.3536 | Val  Acc: 0.9595
 Site-SVHN                          | Val  Loss: 0.8139 | Val  Acc: 0.7973
Average Valid Accuracy: 0.9135
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.0889 | Train Acc: 0.9831
 Site-USPS                          | Train Loss: 0.0770 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.4727 | Train Acc: 0.9155
 Site-MNIST_M                       | Train Loss: 0.3214 | Train Acc: 0.9662
 Site-SVHN                          | Train Loss: 0.8125 | Train Acc: 0.8277
Average Train Accuracy: 0.9365
 Site-MNIST                         | Val  Loss: 0.0921 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.0946 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5198 | Val  Acc: 0.8919
 Site-MNIST_M                       | Val  Loss: 0.3232 | Val  Acc: 0.9865
 Site-SVHN                          | Val  Loss: 0.8319 | Val  Acc: 0.8378
Average Valid Accuracy: 0.9378
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9730
 Best site-USPS                      | Epoch:45 | Val Acc: 1.0000
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.8919
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.9865
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.8378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.0853 | Train Acc: 0.9831
 Site-USPS                          | Train Loss: 0.0737 | Train Acc: 0.9932
 Site-SynthDigits                   | Train Loss: 0.4807 | Train Acc: 0.9155
 Site-MNIST_M                       | Train Loss: 0.3193 | Train Acc: 0.9595
 Site-SVHN                          | Train Loss: 0.7817 | Train Acc: 0.8176
Average Train Accuracy: 0.9338
 Site-MNIST                         | Val  Loss: 0.0832 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.0978 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.5479 | Val  Acc: 0.8649
 Site-MNIST_M                       | Val  Loss: 0.3122 | Val  Acc: 0.9730
 Site-SVHN                          | Val  Loss: 0.7831 | Val  Acc: 0.7973
Average Valid Accuracy: 0.9216
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.0883 | Train Acc: 0.9831
 Site-USPS                          | Train Loss: 0.0777 | Train Acc: 0.9831
 Site-SynthDigits                   | Train Loss: 0.4475 | Train Acc: 0.9257
 Site-MNIST_M                       | Train Loss: 0.3144 | Train Acc: 0.9595
 Site-SVHN                          | Train Loss: 0.7783 | Train Acc: 0.8446
Average Train Accuracy: 0.9392
 Site-MNIST                         | Val  Loss: 0.0902 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.4999 | Val  Acc: 0.8919
 Site-MNIST_M                       | Val  Loss: 0.3143 | Val  Acc: 0.9730
 Site-SVHN                          | Val  Loss: 0.7986 | Val  Acc: 0.8649
Average Valid Accuracy: 0.9378
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.0857 | Train Acc: 0.9865
 Site-USPS                          | Train Loss: 0.0684 | Train Acc: 0.9865
 Site-SynthDigits                   | Train Loss: 0.4496 | Train Acc: 0.9257
 Site-MNIST_M                       | Train Loss: 0.3030 | Train Acc: 0.9764
 Site-SVHN                          | Train Loss: 0.7886 | Train Acc: 0.8446
Average Train Accuracy: 0.9439
 Site-MNIST                         | Val  Loss: 0.0877 | Val  Acc: 0.9595
 Site-USPS                          | Val  Loss: 0.0663 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.4950 | Val  Acc: 0.9054
 Site-MNIST_M                       | Val  Loss: 0.2815 | Val  Acc: 1.0000
 Site-SVHN                          | Val  Loss: 0.7820 | Val  Acc: 0.8649
Average Valid Accuracy: 0.9459
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9595
 Best site-USPS                      | Epoch:48 | Val Acc: 1.0000
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.9054
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 1.0000
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.8649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.0818 | Train Acc: 0.9899
 Site-USPS                          | Train Loss: 0.0654 | Train Acc: 0.9899
 Site-SynthDigits                   | Train Loss: 0.4482 | Train Acc: 0.9291
 Site-MNIST_M                       | Train Loss: 0.2923 | Train Acc: 0.9797
 Site-SVHN                          | Train Loss: 0.7580 | Train Acc: 0.8649
Average Train Accuracy: 0.9507
 Site-MNIST                         | Val  Loss: 0.0825 | Val  Acc: 0.9730
 Site-USPS                          | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.4690 | Val  Acc: 0.8919
 Site-MNIST_M                       | Val  Loss: 0.2814 | Val  Acc: 1.0000
 Site-SVHN                          | Val  Loss: 0.7942 | Val  Acc: 0.8784
Average Valid Accuracy: 0.9486
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9730
 Best site-USPS                      | Epoch:49 | Val Acc: 1.0000
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.8919
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 1.0000
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.8784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/harmo-fl...
===2023-07-03 02:21:26===
===2023-07-03 02:21:28===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8921
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8978
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.6382
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.4400
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.3421
MNIST: 0.8921, USPS: 0.8978, SynthDigits: 0.6382, MNIST_M: 0.4400, SVHN: 0.3421, 
Average Test Accuracy(group): 0.6421, Average Test Accuracy(individual): 0.6421,
domain std=0.2275, cluster std=-1.0000, individual std=0.2275, 
