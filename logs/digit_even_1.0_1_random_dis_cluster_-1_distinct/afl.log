===2023-07-02 22:46:58===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.2350 | Train Acc: 0.2399
 Site-USPS                          | Train Loss: 2.2215 | Train Acc: 0.4088
 Site-SynthDigits                   | Train Loss: 2.2799 | Train Acc: 0.1892
 Site-MNIST_M                       | Train Loss: 2.2979 | Train Acc: 0.1216
 Site-SVHN                          | Train Loss: 2.2740 | Train Acc: 0.1453
Average Train Accuracy: 0.2209
 Site-MNIST                         | Val  Loss: 2.2178 | Val  Acc: 0.3514
 Site-USPS                          | Val  Loss: 2.2291 | Val  Acc: 0.4189
 Site-SynthDigits                   | Val  Loss: 2.2899 | Val  Acc: 0.1757
 Site-MNIST_M                       | Val  Loss: 2.3285 | Val  Acc: 0.1486
 Site-SVHN                          | Val  Loss: 2.2902 | Val  Acc: 0.1757
Average Valid Accuracy: 0.2541
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3514
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4189
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1757
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 2.1599 | Train Acc: 0.5000
 Site-USPS                          | Train Loss: 2.1492 | Train Acc: 0.5608
 Site-SynthDigits                   | Train Loss: 2.2552 | Train Acc: 0.2736
 Site-MNIST_M                       | Train Loss: 2.2779 | Train Acc: 0.1554
 Site-SVHN                          | Train Loss: 2.2552 | Train Acc: 0.1892
Average Train Accuracy: 0.3358
 Site-MNIST                         | Val  Loss: 2.1346 | Val  Acc: 0.6081
 Site-USPS                          | Val  Loss: 2.1650 | Val  Acc: 0.5270
 Site-SynthDigits                   | Val  Loss: 2.2632 | Val  Acc: 0.2703
 Site-MNIST_M                       | Val  Loss: 2.3035 | Val  Acc: 0.2162
 Site-SVHN                          | Val  Loss: 2.2712 | Val  Acc: 0.2027
Average Valid Accuracy: 0.3649
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6081
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5270
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2703
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2162
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 2.0962 | Train Acc: 0.5372
 Site-USPS                          | Train Loss: 2.0739 | Train Acc: 0.6014
 Site-SynthDigits                   | Train Loss: 2.2282 | Train Acc: 0.3277
 Site-MNIST_M                       | Train Loss: 2.2581 | Train Acc: 0.1993
 Site-SVHN                          | Train Loss: 2.2360 | Train Acc: 0.2162
Average Train Accuracy: 0.3764
 Site-MNIST                         | Val  Loss: 2.0612 | Val  Acc: 0.6351
 Site-USPS                          | Val  Loss: 2.0982 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 2.2390 | Val  Acc: 0.2703
 Site-MNIST_M                       | Val  Loss: 2.2796 | Val  Acc: 0.2703
 Site-SVHN                          | Val  Loss: 2.2489 | Val  Acc: 0.2568
Average Valid Accuracy: 0.3946
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6351
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2703
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2703
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 2.0391 | Train Acc: 0.5574
 Site-USPS                          | Train Loss: 1.9978 | Train Acc: 0.6486
 Site-SynthDigits                   | Train Loss: 2.2016 | Train Acc: 0.3716
 Site-MNIST_M                       | Train Loss: 2.2388 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2179 | Train Acc: 0.2365
Average Train Accuracy: 0.4108
 Site-MNIST                         | Val  Loss: 1.9892 | Val  Acc: 0.6622
 Site-USPS                          | Val  Loss: 2.0286 | Val  Acc: 0.6081
 Site-SynthDigits                   | Val  Loss: 2.2124 | Val  Acc: 0.3108
 Site-MNIST_M                       | Val  Loss: 2.2501 | Val  Acc: 0.3108
 Site-SVHN                          | Val  Loss: 2.2249 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4378
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6622
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6081
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3108
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3108
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.9835 | Train Acc: 0.6014
 Site-USPS                          | Train Loss: 1.9240 | Train Acc: 0.6791
 Site-SynthDigits                   | Train Loss: 2.1756 | Train Acc: 0.3716
 Site-MNIST_M                       | Train Loss: 2.2219 | Train Acc: 0.2973
 Site-SVHN                          | Train Loss: 2.1981 | Train Acc: 0.2399
Average Train Accuracy: 0.4378
 Site-MNIST                         | Val  Loss: 1.9302 | Val  Acc: 0.6892
 Site-USPS                          | Val  Loss: 1.9567 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 2.1751 | Val  Acc: 0.3378
 Site-MNIST_M                       | Val  Loss: 2.2266 | Val  Acc: 0.3378
 Site-SVHN                          | Val  Loss: 2.2046 | Val  Acc: 0.2838
Average Valid Accuracy: 0.4595
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6892
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3378
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3378
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.9322 | Train Acc: 0.5980
 Site-USPS                          | Train Loss: 1.8660 | Train Acc: 0.6689
 Site-SynthDigits                   | Train Loss: 2.1412 | Train Acc: 0.4020
 Site-MNIST_M                       | Train Loss: 2.1933 | Train Acc: 0.3142
 Site-SVHN                          | Train Loss: 2.1774 | Train Acc: 0.2669
Average Train Accuracy: 0.4500
 Site-MNIST                         | Val  Loss: 1.8712 | Val  Acc: 0.6757
 Site-USPS                          | Val  Loss: 1.8987 | Val  Acc: 0.6622
 Site-SynthDigits                   | Val  Loss: 2.1383 | Val  Acc: 0.3784
 Site-MNIST_M                       | Val  Loss: 2.1948 | Val  Acc: 0.3108
 Site-SVHN                          | Val  Loss: 2.1918 | Val  Acc: 0.2838
Average Valid Accuracy: 0.4622
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6757
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6622
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3784
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3108
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.8756 | Train Acc: 0.6149
 Site-USPS                          | Train Loss: 1.7974 | Train Acc: 0.6723
 Site-SynthDigits                   | Train Loss: 2.1111 | Train Acc: 0.4527
 Site-MNIST_M                       | Train Loss: 2.1741 | Train Acc: 0.3446
 Site-SVHN                          | Train Loss: 2.1683 | Train Acc: 0.2669
Average Train Accuracy: 0.4703
 Site-MNIST                         | Val  Loss: 1.8039 | Val  Acc: 0.6757
 Site-USPS                          | Val  Loss: 1.8402 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 2.1154 | Val  Acc: 0.4459
 Site-MNIST_M                       | Val  Loss: 2.1711 | Val  Acc: 0.3784
 Site-SVHN                          | Val  Loss: 2.1742 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4892
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6757
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4459
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3784
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.8212 | Train Acc: 0.6351
 Site-USPS                          | Train Loss: 1.7367 | Train Acc: 0.7095
 Site-SynthDigits                   | Train Loss: 2.0874 | Train Acc: 0.4561
 Site-MNIST_M                       | Train Loss: 2.1500 | Train Acc: 0.3953
 Site-SVHN                          | Train Loss: 2.1426 | Train Acc: 0.2568
Average Train Accuracy: 0.4905
 Site-MNIST                         | Val  Loss: 1.7471 | Val  Acc: 0.7297
 Site-USPS                          | Val  Loss: 1.7815 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 2.0984 | Val  Acc: 0.4189
 Site-MNIST_M                       | Val  Loss: 2.1453 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.1523 | Val  Acc: 0.2973
Average Valid Accuracy: 0.5162
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7297
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4189
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.7745 | Train Acc: 0.6588
 Site-USPS                          | Train Loss: 1.6813 | Train Acc: 0.6959
 Site-SynthDigits                   | Train Loss: 2.0551 | Train Acc: 0.4797
 Site-MNIST_M                       | Train Loss: 2.1211 | Train Acc: 0.3885
 Site-SVHN                          | Train Loss: 2.1383 | Train Acc: 0.2838
Average Train Accuracy: 0.5014
 Site-MNIST                         | Val  Loss: 1.6908 | Val  Acc: 0.7162
 Site-USPS                          | Val  Loss: 1.7309 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 2.0473 | Val  Acc: 0.4730
 Site-MNIST_M                       | Val  Loss: 2.1111 | Val  Acc: 0.3919
 Site-SVHN                          | Val  Loss: 2.1498 | Val  Acc: 0.3243
Average Valid Accuracy: 0.5162
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.7215 | Train Acc: 0.6723
 Site-USPS                          | Train Loss: 1.6253 | Train Acc: 0.7196
 Site-SynthDigits                   | Train Loss: 2.0219 | Train Acc: 0.4764
 Site-MNIST_M                       | Train Loss: 2.1096 | Train Acc: 0.4020
 Site-SVHN                          | Train Loss: 2.1215 | Train Acc: 0.2736
Average Train Accuracy: 0.5088
 Site-MNIST                         | Val  Loss: 1.6296 | Val  Acc: 0.7297
 Site-USPS                          | Val  Loss: 1.6800 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 2.0242 | Val  Acc: 0.4730
 Site-MNIST_M                       | Val  Loss: 2.0876 | Val  Acc: 0.3919
 Site-SVHN                          | Val  Loss: 2.1349 | Val  Acc: 0.3243
Average Valid Accuracy: 0.5270
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7297
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7162
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4730
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3919
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 1.6595 | Train Acc: 0.6689
 Site-USPS                          | Train Loss: 1.5834 | Train Acc: 0.6824
 Site-SynthDigits                   | Train Loss: 2.0010 | Train Acc: 0.4899
 Site-MNIST_M                       | Train Loss: 2.0827 | Train Acc: 0.4155
 Site-SVHN                          | Train Loss: 2.1160 | Train Acc: 0.2804
Average Train Accuracy: 0.5074
 Site-MNIST                         | Val  Loss: 1.5651 | Val  Acc: 0.7432
 Site-USPS                          | Val  Loss: 1.6377 | Val  Acc: 0.6622
 Site-SynthDigits                   | Val  Loss: 1.9985 | Val  Acc: 0.4865
 Site-MNIST_M                       | Val  Loss: 2.0687 | Val  Acc: 0.3784
 Site-SVHN                          | Val  Loss: 2.1100 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5216
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 1.6270 | Train Acc: 0.6959
 Site-USPS                          | Train Loss: 1.5526 | Train Acc: 0.7061
 Site-SynthDigits                   | Train Loss: 1.9541 | Train Acc: 0.5169
 Site-MNIST_M                       | Train Loss: 2.0616 | Train Acc: 0.4054
 Site-SVHN                          | Train Loss: 2.0951 | Train Acc: 0.3007
Average Train Accuracy: 0.5250
 Site-MNIST                         | Val  Loss: 1.5350 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.5984 | Val  Acc: 0.6892
 Site-SynthDigits                   | Val  Loss: 1.9426 | Val  Acc: 0.4865
 Site-MNIST_M                       | Val  Loss: 2.0607 | Val  Acc: 0.3649
 Site-SVHN                          | Val  Loss: 2.1308 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5324
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:11 | Val Acc: 0.6892
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4865
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3649
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 1.5668 | Train Acc: 0.7027
 Site-USPS                          | Train Loss: 1.4864 | Train Acc: 0.7230
 Site-SynthDigits                   | Train Loss: 1.9374 | Train Acc: 0.5101
 Site-MNIST_M                       | Train Loss: 2.0485 | Train Acc: 0.4392
 Site-SVHN                          | Train Loss: 2.0734 | Train Acc: 0.2973
Average Train Accuracy: 0.5345
 Site-MNIST                         | Val  Loss: 1.4687 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.5396 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.9335 | Val  Acc: 0.5135
 Site-MNIST_M                       | Val  Loss: 2.0258 | Val  Acc: 0.3784
 Site-SVHN                          | Val  Loss: 2.0944 | Val  Acc: 0.3243
Average Valid Accuracy: 0.5405
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5135
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3784
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 1.5262 | Train Acc: 0.7095
 Site-USPS                          | Train Loss: 1.4912 | Train Acc: 0.6926
 Site-SynthDigits                   | Train Loss: 1.8976 | Train Acc: 0.5338
 Site-MNIST_M                       | Train Loss: 2.0280 | Train Acc: 0.4291
 Site-SVHN                          | Train Loss: 2.0636 | Train Acc: 0.3108
Average Train Accuracy: 0.5351
 Site-MNIST                         | Val  Loss: 1.4292 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.5317 | Val  Acc: 0.6622
 Site-SynthDigits                   | Val  Loss: 1.8777 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 2.0218 | Val  Acc: 0.3514
 Site-SVHN                          | Val  Loss: 2.1024 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5243
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 1.4806 | Train Acc: 0.7399
 Site-USPS                          | Train Loss: 1.4008 | Train Acc: 0.7500
 Site-SynthDigits                   | Train Loss: 1.8810 | Train Acc: 0.5574
 Site-MNIST_M                       | Train Loss: 1.9937 | Train Acc: 0.4662
 Site-SVHN                          | Train Loss: 2.0437 | Train Acc: 0.3074
Average Train Accuracy: 0.5642
 Site-MNIST                         | Val  Loss: 1.3869 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.4528 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.8721 | Val  Acc: 0.5135
 Site-MNIST_M                       | Val  Loss: 1.9698 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.0844 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5622
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5135
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 1.4363 | Train Acc: 0.7162
 Site-USPS                          | Train Loss: 1.3869 | Train Acc: 0.7162
 Site-SynthDigits                   | Train Loss: 1.8403 | Train Acc: 0.5541
 Site-MNIST_M                       | Train Loss: 1.9763 | Train Acc: 0.4527
 Site-SVHN                          | Train Loss: 2.0444 | Train Acc: 0.3311
Average Train Accuracy: 0.5541
 Site-MNIST                         | Val  Loss: 1.3433 | Val  Acc: 0.7432
 Site-USPS                          | Val  Loss: 1.4477 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 1.8183 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.9674 | Val  Acc: 0.4054
 Site-SVHN                          | Val  Loss: 2.0614 | Val  Acc: 0.3784
Average Valid Accuracy: 0.5486
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 1.4049 | Train Acc: 0.7534
 Site-USPS                          | Train Loss: 1.3353 | Train Acc: 0.7534
 Site-SynthDigits                   | Train Loss: 1.8067 | Train Acc: 0.5608
 Site-MNIST_M                       | Train Loss: 1.9479 | Train Acc: 0.4764
 Site-SVHN                          | Train Loss: 2.0188 | Train Acc: 0.3277
Average Train Accuracy: 0.5743
 Site-MNIST                         | Val  Loss: 1.3064 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.3924 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 1.7957 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.9463 | Val  Acc: 0.4189
 Site-SVHN                          | Val  Loss: 2.0389 | Val  Acc: 0.3919
Average Valid Accuracy: 0.5622
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 1.3725 | Train Acc: 0.7466
 Site-USPS                          | Train Loss: 1.3095 | Train Acc: 0.7432
 Site-SynthDigits                   | Train Loss: 1.7817 | Train Acc: 0.5574
 Site-MNIST_M                       | Train Loss: 1.9323 | Train Acc: 0.4764
 Site-SVHN                          | Train Loss: 2.0089 | Train Acc: 0.3480
Average Train Accuracy: 0.5743
 Site-MNIST                         | Val  Loss: 1.2653 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.3583 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.7636 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.9280 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.0268 | Val  Acc: 0.4054
Average Valid Accuracy: 0.5703
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5541
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 1.3213 | Train Acc: 0.7500
 Site-USPS                          | Train Loss: 1.2577 | Train Acc: 0.7770
 Site-SynthDigits                   | Train Loss: 1.7550 | Train Acc: 0.5574
 Site-MNIST_M                       | Train Loss: 1.9058 | Train Acc: 0.4831
 Site-SVHN                          | Train Loss: 2.0039 | Train Acc: 0.3514
Average Train Accuracy: 0.5838
 Site-MNIST                         | Val  Loss: 1.2253 | Val  Acc: 0.7432
 Site-USPS                          | Val  Loss: 1.3157 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.7456 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.9017 | Val  Acc: 0.4459
 Site-SVHN                          | Val  Loss: 2.0103 | Val  Acc: 0.4189
Average Valid Accuracy: 0.5838
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7432
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7568
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5541
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4459
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 1.2872 | Train Acc: 0.7635
 Site-USPS                          | Train Loss: 1.2022 | Train Acc: 0.7939
 Site-SynthDigits                   | Train Loss: 1.7403 | Train Acc: 0.5574
 Site-MNIST_M                       | Train Loss: 1.8885 | Train Acc: 0.4865
 Site-SVHN                          | Train Loss: 1.9882 | Train Acc: 0.3547
Average Train Accuracy: 0.5912
 Site-MNIST                         | Val  Loss: 1.1970 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.2672 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.7227 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.8752 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 1.9794 | Val  Acc: 0.4054
Average Valid Accuracy: 0.5838
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 1.2797 | Train Acc: 0.7500
 Site-USPS                          | Train Loss: 1.2196 | Train Acc: 0.7534
 Site-SynthDigits                   | Train Loss: 1.6979 | Train Acc: 0.5642
 Site-MNIST_M                       | Train Loss: 1.8766 | Train Acc: 0.4899
 Site-SVHN                          | Train Loss: 1.9726 | Train Acc: 0.3615
Average Train Accuracy: 0.5838
 Site-MNIST                         | Val  Loss: 1.1650 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.2595 | Val  Acc: 0.6892
 Site-SynthDigits                   | Val  Loss: 1.6758 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.8818 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 1.9549 | Val  Acc: 0.3919
Average Valid Accuracy: 0.5730
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 1.2304 | Train Acc: 0.7804
 Site-USPS                          | Train Loss: 1.1574 | Train Acc: 0.8041
 Site-SynthDigits                   | Train Loss: 1.6899 | Train Acc: 0.5574
 Site-MNIST_M                       | Train Loss: 1.8489 | Train Acc: 0.5101
 Site-SVHN                          | Train Loss: 1.9724 | Train Acc: 0.3581
Average Train Accuracy: 0.6020
 Site-MNIST                         | Val  Loss: 1.1270 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.2123 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.6810 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.8372 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 1.9857 | Val  Acc: 0.4189
Average Valid Accuracy: 0.5973
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7838
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 1.1890 | Train Acc: 0.7939
 Site-USPS                          | Train Loss: 1.1471 | Train Acc: 0.7939
 Site-SynthDigits                   | Train Loss: 1.6641 | Train Acc: 0.5709
 Site-MNIST_M                       | Train Loss: 1.8396 | Train Acc: 0.5101
 Site-SVHN                          | Train Loss: 1.9445 | Train Acc: 0.3716
Average Train Accuracy: 0.6081
 Site-MNIST                         | Val  Loss: 1.0974 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.1807 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.6388 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.8362 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.9376 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6054
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7568
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.4865
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 1.1696 | Train Acc: 0.7872
 Site-USPS                          | Train Loss: 1.1007 | Train Acc: 0.8007
 Site-SynthDigits                   | Train Loss: 1.6436 | Train Acc: 0.5777
 Site-MNIST_M                       | Train Loss: 1.8078 | Train Acc: 0.5068
 Site-SVHN                          | Train Loss: 1.9312 | Train Acc: 0.3750
Average Train Accuracy: 0.6095
 Site-MNIST                         | Val  Loss: 1.0669 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.1390 | Val  Acc: 0.7703
 Site-SynthDigits                   | Val  Loss: 1.6137 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.8140 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.9194 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6081
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7703
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.4865
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 1.1460 | Train Acc: 0.8074
 Site-USPS                          | Train Loss: 1.0733 | Train Acc: 0.8142
 Site-SynthDigits                   | Train Loss: 1.6194 | Train Acc: 0.5845
 Site-MNIST_M                       | Train Loss: 1.7970 | Train Acc: 0.5135
 Site-SVHN                          | Train Loss: 1.9256 | Train Acc: 0.3716
Average Train Accuracy: 0.6182
 Site-MNIST                         | Val  Loss: 1.0413 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.1251 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.6021 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.7893 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.9081 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6162
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7973
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4865
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 1.1192 | Train Acc: 0.7939
 Site-USPS                          | Train Loss: 1.0403 | Train Acc: 0.8074
 Site-SynthDigits                   | Train Loss: 1.5930 | Train Acc: 0.5912
 Site-MNIST_M                       | Train Loss: 1.7718 | Train Acc: 0.5203
 Site-SVHN                          | Train Loss: 1.9170 | Train Acc: 0.3784
Average Train Accuracy: 0.6182
 Site-MNIST                         | Val  Loss: 1.0159 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.0978 | Val  Acc: 0.7703
 Site-SynthDigits                   | Val  Loss: 1.5772 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.7718 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9115 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6027
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 1.0869 | Train Acc: 0.8041
 Site-USPS                          | Train Loss: 1.0396 | Train Acc: 0.8007
 Site-SynthDigits                   | Train Loss: 1.5730 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.7575 | Train Acc: 0.5236
 Site-SVHN                          | Train Loss: 1.8944 | Train Acc: 0.3885
Average Train Accuracy: 0.6196
 Site-MNIST                         | Val  Loss: 0.9910 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.0885 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.5338 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.7777 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8726 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6027
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 1.0526 | Train Acc: 0.8041
 Site-USPS                          | Train Loss: 1.0038 | Train Acc: 0.8277
 Site-SynthDigits                   | Train Loss: 1.5733 | Train Acc: 0.5878
 Site-MNIST_M                       | Train Loss: 1.7351 | Train Acc: 0.5405
 Site-SVHN                          | Train Loss: 1.8914 | Train Acc: 0.4020
Average Train Accuracy: 0.6324
 Site-MNIST                         | Val  Loss: 0.9707 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.0363 | Val  Acc: 0.8108
 Site-SynthDigits                   | Val  Loss: 1.5310 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.7439 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.8560 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6270
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8108
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5405
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 1.0468 | Train Acc: 0.7939
 Site-USPS                          | Train Loss: 0.9830 | Train Acc: 0.8176
 Site-SynthDigits                   | Train Loss: 1.5566 | Train Acc: 0.6014
 Site-MNIST_M                       | Train Loss: 1.7147 | Train Acc: 0.5405
 Site-SVHN                          | Train Loss: 1.8649 | Train Acc: 0.3919
Average Train Accuracy: 0.6291
 Site-MNIST                         | Val  Loss: 0.9560 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.0246 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.5044 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.7316 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.8507 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6135
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 1.0222 | Train Acc: 0.8041
 Site-USPS                          | Train Loss: 0.9815 | Train Acc: 0.8074
 Site-SynthDigits                   | Train Loss: 1.5054 | Train Acc: 0.5878
 Site-MNIST_M                       | Train Loss: 1.7089 | Train Acc: 0.5270
 Site-SVHN                          | Train Loss: 1.8673 | Train Acc: 0.4088
Average Train Accuracy: 0.6270
 Site-MNIST                         | Val  Loss: 0.9352 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.0296 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.4779 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.7401 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8516 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6081
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.9966 | Train Acc: 0.8108
 Site-USPS                          | Train Loss: 0.9291 | Train Acc: 0.8209
 Site-SynthDigits                   | Train Loss: 1.4990 | Train Acc: 0.6014
 Site-MNIST_M                       | Train Loss: 1.6869 | Train Acc: 0.5473
 Site-SVHN                          | Train Loss: 1.8589 | Train Acc: 0.4088
Average Train Accuracy: 0.6378
 Site-MNIST                         | Val  Loss: 0.9116 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 0.9828 | Val  Acc: 0.7703
 Site-SynthDigits                   | Val  Loss: 1.4615 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.7075 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8276 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6162
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.9767 | Train Acc: 0.8176
 Site-USPS                          | Train Loss: 0.9283 | Train Acc: 0.8209
 Site-SynthDigits                   | Train Loss: 1.4802 | Train Acc: 0.5980
 Site-MNIST_M                       | Train Loss: 1.6789 | Train Acc: 0.5372
 Site-SVHN                          | Train Loss: 1.8454 | Train Acc: 0.4122
Average Train Accuracy: 0.6372
 Site-MNIST                         | Val  Loss: 0.8888 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.9746 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.4378 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.6993 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8235 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6216
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.9535 | Train Acc: 0.8209
 Site-USPS                          | Train Loss: 0.8961 | Train Acc: 0.8277
 Site-SynthDigits                   | Train Loss: 1.4616 | Train Acc: 0.5878
 Site-MNIST_M                       | Train Loss: 1.6549 | Train Acc: 0.5709
 Site-SVHN                          | Train Loss: 1.8240 | Train Acc: 0.4088
Average Train Accuracy: 0.6432
 Site-MNIST                         | Val  Loss: 0.8743 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.9395 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.4244 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.6701 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.7989 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6297
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7838
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5541
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5405
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.9323 | Train Acc: 0.8176
 Site-USPS                          | Train Loss: 0.8892 | Train Acc: 0.8378
 Site-SynthDigits                   | Train Loss: 1.4507 | Train Acc: 0.5912
 Site-MNIST_M                       | Train Loss: 1.6403 | Train Acc: 0.5676
 Site-SVHN                          | Train Loss: 1.8332 | Train Acc: 0.4088
Average Train Accuracy: 0.6446
 Site-MNIST                         | Val  Loss: 0.8632 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.9252 | Val  Acc: 0.8108
 Site-SynthDigits                   | Val  Loss: 1.4061 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.6597 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.7922 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6351
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8108
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5541
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.9274 | Train Acc: 0.8243
 Site-USPS                          | Train Loss: 0.8465 | Train Acc: 0.8480
 Site-SynthDigits                   | Train Loss: 1.4390 | Train Acc: 0.5878
 Site-MNIST_M                       | Train Loss: 1.6137 | Train Acc: 0.5980
 Site-SVHN                          | Train Loss: 1.8075 | Train Acc: 0.4054
Average Train Accuracy: 0.6527
 Site-MNIST                         | Val  Loss: 0.8424 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.8954 | Val  Acc: 0.8108
 Site-SynthDigits                   | Val  Loss: 1.4091 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.6287 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7735 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6351
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.9118 | Train Acc: 0.8277
 Site-USPS                          | Train Loss: 0.8410 | Train Acc: 0.8446
 Site-SynthDigits                   | Train Loss: 1.4255 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.6043 | Train Acc: 0.5743
 Site-SVHN                          | Train Loss: 1.7991 | Train Acc: 0.4122
Average Train Accuracy: 0.6527
 Site-MNIST                         | Val  Loss: 0.8261 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8942 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.3815 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.6328 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7671 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6541
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5811
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.8996 | Train Acc: 0.8209
 Site-USPS                          | Train Loss: 0.8251 | Train Acc: 0.8412
 Site-SynthDigits                   | Train Loss: 1.4054 | Train Acc: 0.6081
 Site-MNIST_M                       | Train Loss: 1.5841 | Train Acc: 0.5811
 Site-SVHN                          | Train Loss: 1.7934 | Train Acc: 0.4291
Average Train Accuracy: 0.6561
 Site-MNIST                         | Val  Loss: 0.8134 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.8753 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.3674 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.6062 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7558 | Val  Acc: 0.5270
Average Valid Accuracy: 0.6595
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8243
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5811
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.5270
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.8741 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.8200 | Train Acc: 0.8514
 Site-SynthDigits                   | Train Loss: 1.3909 | Train Acc: 0.5980
 Site-MNIST_M                       | Train Loss: 1.5678 | Train Acc: 0.5878
 Site-SVHN                          | Train Loss: 1.7765 | Train Acc: 0.4257
Average Train Accuracy: 0.6608
 Site-MNIST                         | Val  Loss: 0.7966 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8535 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.3539 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.5964 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7408 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6568
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.8652 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.7806 | Train Acc: 0.8480
 Site-SynthDigits                   | Train Loss: 1.4058 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.5565 | Train Acc: 0.6081
 Site-SVHN                          | Train Loss: 1.7688 | Train Acc: 0.4392
Average Train Accuracy: 0.6676
 Site-MNIST                         | Val  Loss: 0.7878 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.8197 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.3564 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5709 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.7410 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6541
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.8377 | Train Acc: 0.8311
 Site-USPS                          | Train Loss: 0.7986 | Train Acc: 0.8581
 Site-SynthDigits                   | Train Loss: 1.3741 | Train Acc: 0.6149
 Site-MNIST_M                       | Train Loss: 1.5524 | Train Acc: 0.5743
 Site-SVHN                          | Train Loss: 1.7660 | Train Acc: 0.4324
Average Train Accuracy: 0.6622
 Site-MNIST                         | Val  Loss: 0.7799 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8404 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.3234 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.5746 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.7408 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6649
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5946
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5946
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.8182 | Train Acc: 0.8547
 Site-USPS                          | Train Loss: 0.7623 | Train Acc: 0.8581
 Site-SynthDigits                   | Train Loss: 1.3704 | Train Acc: 0.6081
 Site-MNIST_M                       | Train Loss: 1.5255 | Train Acc: 0.6047
 Site-SVHN                          | Train Loss: 1.7695 | Train Acc: 0.4291
Average Train Accuracy: 0.6709
 Site-MNIST                         | Val  Loss: 0.7607 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.8031 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.3246 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5525 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.7324 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6649
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.8132 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.7599 | Train Acc: 0.8581
 Site-SynthDigits                   | Train Loss: 1.3390 | Train Acc: 0.5946
 Site-MNIST_M                       | Train Loss: 1.5150 | Train Acc: 0.6047
 Site-SVHN                          | Train Loss: 1.7558 | Train Acc: 0.4493
Average Train Accuracy: 0.6703
 Site-MNIST                         | Val  Loss: 0.7528 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.7982 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.2887 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5364 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.7063 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6676
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5946
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.7963 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.7422 | Train Acc: 0.8615
 Site-SynthDigits                   | Train Loss: 1.3406 | Train Acc: 0.6351
 Site-MNIST_M                       | Train Loss: 1.5110 | Train Acc: 0.6081
 Site-SVHN                          | Train Loss: 1.7367 | Train Acc: 0.4527
Average Train Accuracy: 0.6791
 Site-MNIST                         | Val  Loss: 0.7438 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.7932 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.3025 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.5352 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.7208 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6811
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6486
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6216
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.7950 | Train Acc: 0.8311
 Site-USPS                          | Train Loss: 0.7224 | Train Acc: 0.8615
 Site-SynthDigits                   | Train Loss: 1.3387 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.4848 | Train Acc: 0.6419
 Site-SVHN                          | Train Loss: 1.7176 | Train Acc: 0.4527
Average Train Accuracy: 0.6784
 Site-MNIST                         | Val  Loss: 0.7329 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.7385 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.2833 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5010 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6733 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6730
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.7771 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.7370 | Train Acc: 0.8649
 Site-SynthDigits                   | Train Loss: 1.3120 | Train Acc: 0.6385
 Site-MNIST_M                       | Train Loss: 1.4770 | Train Acc: 0.6115
 Site-SVHN                          | Train Loss: 1.7210 | Train Acc: 0.4291
Average Train Accuracy: 0.6777
 Site-MNIST                         | Val  Loss: 0.7209 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.7735 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.2762 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.5124 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6986 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6892
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8514
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6351
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6351
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.7772 | Train Acc: 0.8547
 Site-USPS                          | Train Loss: 0.6954 | Train Acc: 0.8615
 Site-SynthDigits                   | Train Loss: 1.2922 | Train Acc: 0.6149
 Site-MNIST_M                       | Train Loss: 1.4604 | Train Acc: 0.6318
 Site-SVHN                          | Train Loss: 1.6947 | Train Acc: 0.4561
Average Train Accuracy: 0.6838
 Site-MNIST                         | Val  Loss: 0.7151 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.7218 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.2577 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.4785 | Val  Acc: 0.6486
 Site-SVHN                          | Val  Loss: 1.6684 | Val  Acc: 0.5541
Average Valid Accuracy: 0.6973
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8514
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5946
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.6486
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.7555 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.6856 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.2832 | Train Acc: 0.6419
 Site-MNIST_M                       | Train Loss: 1.4629 | Train Acc: 0.6284
 Site-SVHN                          | Train Loss: 1.6943 | Train Acc: 0.4628
Average Train Accuracy: 0.6892
 Site-MNIST                         | Val  Loss: 0.7040 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.7313 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.2469 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.4881 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6838 | Val  Acc: 0.5541
Average Valid Accuracy: 0.7027
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6351
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6351
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.7371 | Train Acc: 0.8547
 Site-USPS                          | Train Loss: 0.6695 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.2904 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.4319 | Train Acc: 0.6453
 Site-SVHN                          | Train Loss: 1.6980 | Train Acc: 0.4696
Average Train Accuracy: 0.6939
 Site-MNIST                         | Val  Loss: 0.6984 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6882 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.2382 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.4634 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6497 | Val  Acc: 0.5541
Average Valid Accuracy: 0.7027
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.7297 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.6821 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.2530 | Train Acc: 0.6453
 Site-MNIST_M                       | Train Loss: 1.4385 | Train Acc: 0.6385
 Site-SVHN                          | Train Loss: 1.6809 | Train Acc: 0.4628
Average Train Accuracy: 0.6926
 Site-MNIST                         | Val  Loss: 0.6860 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.7076 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.2155 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.4591 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.6695 | Val  Acc: 0.5676
Average Valid Accuracy: 0.7108
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.6486
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6216
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/afl...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.7088 | Train Acc: 0.8716
 Site-USPS                          | Train Loss: 0.6565 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.2693 | Train Acc: 0.6419
 Site-MNIST_M                       | Train Loss: 1.4259 | Train Acc: 0.6622
 Site-SVHN                          | Train Loss: 1.6559 | Train Acc: 0.4730
Average Train Accuracy: 0.7041
 Site-MNIST                         | Val  Loss: 0.6713 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.6790 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.2208 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.4477 | Val  Acc: 0.6486
 Site-SVHN                          | Val  Loss: 1.6409 | Val  Acc: 0.5541
Average Valid Accuracy: 0.7081
===2023-07-02 23:22:37===
===2023-07-02 23:22:39===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.7821
 Test site-USPS                      | Epoch:48 | Test Acc: 0.8387
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5662
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.4171
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.3083
MNIST: 0.7821, USPS: 0.8387, SynthDigits: 0.5662, MNIST_M: 0.4171, SVHN: 0.3083, 
Average Test Accuracy(group): 0.5825, Average Test Accuracy(individual): 0.5825,
domain std=0.2041, cluster std=-1.0000, individual std=0.2041, 
