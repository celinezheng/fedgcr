===2023-07-03 10:07:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-07-03 10:08:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
===2023-07-03 11:15:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-07-03 19:00:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.9440 | Train Acc: 0.4459
 Site-USPS                      (1) | Train Loss: 1.8871 | Train Acc: 0.4595
 Site-SynthDigits               (1) | Train Loss: 2.1983 | Train Acc: 0.2196
 Site-MNIST_M                   (0) | Train Loss: 2.2335 | Train Acc: 0.1993
 Site-SVHN                      (3) | Train Loss: 2.2113 | Train Acc: 0.2061
Average Train Accuracy: 0.3061
 Site-MNIST                     (2) | Val  Loss: 1.8888 | Val  Acc: 0.5270
 Site-USPS                      (1) | Val  Loss: 1.9169 | Val  Acc: 0.4189
 Site-SynthDigits               (1) | Val  Loss: 2.1710 | Val  Acc: 0.2297
 Site-MNIST_M                   (0) | Val  Loss: 2.2162 | Val  Acc: 0.1757
 Site-SVHN                      (3) | Val  Loss: 2.2038 | Val  Acc: 0.2027
Average Valid Accuracy: 0.3108
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5270
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.4189
 Best site-SynthDigits              (1)  | Epoch:0 | Val Acc: 0.2297
 Best site-MNIST_M                  (0)  | Epoch:0 | Val Acc: 0.1757
 Best site-SVHN                     (3)  | Epoch:0 | Val Acc: 0.2027
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.6507 | Train Acc: 0.6318
 Site-USPS                      (0) | Train Loss: 1.5820 | Train Acc: 0.7061
 Site-SynthDigits               (3) | Train Loss: 2.0477 | Train Acc: 0.2973
 Site-MNIST_M                   (2) | Train Loss: 2.1336 | Train Acc: 0.2331
 Site-SVHN                      (1) | Train Loss: 2.1407 | Train Acc: 0.2230
Average Train Accuracy: 0.4182
 Site-MNIST                     (0) | Val  Loss: 1.5885 | Val  Acc: 0.6757
 Site-USPS                      (0) | Val  Loss: 1.6062 | Val  Acc: 0.7027
 Site-SynthDigits               (3) | Val  Loss: 1.9941 | Val  Acc: 0.3378
 Site-MNIST_M                   (2) | Val  Loss: 2.1451 | Val  Acc: 0.1892
 Site-SVHN                      (1) | Val  Loss: 2.1354 | Val  Acc: 0.1622
Average Valid Accuracy: 0.4135
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.6757
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7027
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.3378
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.1892
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.1622
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 1.4403 | Train Acc: 0.6689
 Site-USPS                      (3) | Train Loss: 1.3485 | Train Acc: 0.7669
 Site-SynthDigits               (1) | Train Loss: 1.8734 | Train Acc: 0.3480
 Site-MNIST_M                   (2) | Train Loss: 1.9667 | Train Acc: 0.3277
 Site-SVHN                      (1) | Train Loss: 2.0297 | Train Acc: 0.2973
Average Train Accuracy: 0.4818
 Site-MNIST                     (0) | Val  Loss: 1.4057 | Val  Acc: 0.7027
 Site-USPS                      (3) | Val  Loss: 1.3858 | Val  Acc: 0.7703
 Site-SynthDigits               (1) | Val  Loss: 1.8975 | Val  Acc: 0.3919
 Site-MNIST_M                   (2) | Val  Loss: 1.9888 | Val  Acc: 0.3649
 Site-SVHN                      (1) | Val  Loss: 2.0146 | Val  Acc: 0.2297
Average Valid Accuracy: 0.4919
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7027
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.7703
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.3919
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.3649
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2297
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 1.3260 | Train Acc: 0.6993
 Site-USPS                      (3) | Train Loss: 1.2137 | Train Acc: 0.7703
 Site-SynthDigits               (1) | Train Loss: 1.7436 | Train Acc: 0.4426
 Site-MNIST_M                   (2) | Train Loss: 1.8402 | Train Acc: 0.4223
 Site-SVHN                      (1) | Train Loss: 1.9313 | Train Acc: 0.3547
Average Train Accuracy: 0.5378
 Site-MNIST                     (0) | Val  Loss: 1.2544 | Val  Acc: 0.7027
 Site-USPS                      (3) | Val  Loss: 1.2388 | Val  Acc: 0.7432
 Site-SynthDigits               (1) | Val  Loss: 1.8368 | Val  Acc: 0.4459
 Site-MNIST_M                   (2) | Val  Loss: 1.8287 | Val  Acc: 0.4189
 Site-SVHN                      (1) | Val  Loss: 1.9347 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5297
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7027
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7432
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4459
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.4189
 Best site-SVHN                     (1)  | Epoch:3 | Val Acc: 0.3378
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 1.1131 | Train Acc: 0.7770
 Site-USPS                      (2) | Train Loss: 1.0382 | Train Acc: 0.8209
 Site-SynthDigits               (0) | Train Loss: 1.6041 | Train Acc: 0.5068
 Site-MNIST_M                   (1) | Train Loss: 1.7308 | Train Acc: 0.4493
 Site-SVHN                      (3) | Train Loss: 1.8681 | Train Acc: 0.3649
Average Train Accuracy: 0.5838
 Site-MNIST                     (0) | Val  Loss: 1.0931 | Val  Acc: 0.7703
 Site-USPS                      (2) | Val  Loss: 1.0878 | Val  Acc: 0.8378
 Site-SynthDigits               (0) | Val  Loss: 1.6594 | Val  Acc: 0.5135
 Site-MNIST_M                   (1) | Val  Loss: 1.7391 | Val  Acc: 0.4865
 Site-SVHN                      (3) | Val  Loss: 1.8750 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5946
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.7703
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.8378
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.5135
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.4865
 Best site-SVHN                     (3)  | Epoch:4 | Val Acc: 0.3649
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (1) | Train Loss: 1.0310 | Train Acc: 0.7838
 Site-USPS                      (0) | Train Loss: 0.9752 | Train Acc: 0.8277
 Site-SynthDigits               (1) | Train Loss: 1.4529 | Train Acc: 0.5439
 Site-MNIST_M                   (2) | Train Loss: 1.5930 | Train Acc: 0.5236
 Site-SVHN                      (3) | Train Loss: 1.7386 | Train Acc: 0.3953
Average Train Accuracy: 0.6149
 Site-MNIST                     (1) | Val  Loss: 0.9938 | Val  Acc: 0.7838
 Site-USPS                      (0) | Val  Loss: 0.9977 | Val  Acc: 0.8378
 Site-SynthDigits               (1) | Val  Loss: 1.5662 | Val  Acc: 0.5270
 Site-MNIST_M                   (2) | Val  Loss: 1.6119 | Val  Acc: 0.6081
 Site-SVHN                      (3) | Val  Loss: 1.7901 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6297
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.7838
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8378
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.5270
 Best site-MNIST_M                  (2)  | Epoch:5 | Val Acc: 0.6081
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.3919
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 1, 1, 2, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (3) | Train Loss: 0.9603 | Train Acc: 0.8007
 Site-USPS                      (1) | Train Loss: 0.8539 | Train Acc: 0.8277
 Site-SynthDigits               (3) | Train Loss: 1.3844 | Train Acc: 0.5878
 Site-MNIST_M                   (2) | Train Loss: 1.5493 | Train Acc: 0.5709
 Site-SVHN                      (0) | Train Loss: 1.6875 | Train Acc: 0.4493
Average Train Accuracy: 0.6473
 Site-MNIST                     (3) | Val  Loss: 0.9213 | Val  Acc: 0.7838
 Site-USPS                      (1) | Val  Loss: 0.9139 | Val  Acc: 0.8378
 Site-SynthDigits               (3) | Val  Loss: 1.5143 | Val  Acc: 0.5135
 Site-MNIST_M                   (2) | Val  Loss: 1.5054 | Val  Acc: 0.6351
 Site-SVHN                      (0) | Val  Loss: 1.6965 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6486
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.7838
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8378
 Best site-SynthDigits              (3)  | Epoch:6 | Val Acc: 0.5135
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.6351
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.4730
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (1) | Train Loss: 0.8599 | Train Acc: 0.7905
 Site-USPS                      (3) | Train Loss: 0.7998 | Train Acc: 0.8412
 Site-SynthDigits               (1) | Train Loss: 1.2934 | Train Acc: 0.5878
 Site-MNIST_M                   (2) | Train Loss: 1.4319 | Train Acc: 0.5912
 Site-SVHN                      (0) | Train Loss: 1.6370 | Train Acc: 0.4628
Average Train Accuracy: 0.6547
 Site-MNIST                     (1) | Val  Loss: 0.8488 | Val  Acc: 0.7432
 Site-USPS                      (3) | Val  Loss: 0.8517 | Val  Acc: 0.8514
 Site-SynthDigits               (1) | Val  Loss: 1.4209 | Val  Acc: 0.5541
 Site-MNIST_M                   (2) | Val  Loss: 1.3874 | Val  Acc: 0.6351
 Site-SVHN                      (0) | Val  Loss: 1.5908 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6541
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.7432
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8514
 Best site-SynthDigits              (1)  | Epoch:7 | Val Acc: 0.5541
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.6351
 Best site-SVHN                     (0)  | Epoch:7 | Val Acc: 0.4865
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (2) | Train Loss: 0.7848 | Train Acc: 0.8277
 Site-USPS                      (3) | Train Loss: 0.7361 | Train Acc: 0.8446
 Site-SynthDigits               (2) | Train Loss: 1.2112 | Train Acc: 0.6520
 Site-MNIST_M                   (1) | Train Loss: 1.3401 | Train Acc: 0.6385
 Site-SVHN                      (0) | Train Loss: 1.5057 | Train Acc: 0.4966
Average Train Accuracy: 0.6919
 Site-MNIST                     (2) | Val  Loss: 0.7817 | Val  Acc: 0.7838
 Site-USPS                      (3) | Val  Loss: 0.7876 | Val  Acc: 0.8784
 Site-SynthDigits               (2) | Val  Loss: 1.3362 | Val  Acc: 0.5946
 Site-MNIST_M                   (1) | Val  Loss: 1.3180 | Val  Acc: 0.7162
 Site-SVHN                      (0) | Val  Loss: 1.4884 | Val  Acc: 0.5676
Average Valid Accuracy: 0.7081
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.7838
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.8784
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.5946
 Best site-MNIST_M                  (1)  | Epoch:8 | Val Acc: 0.7162
 Best site-SVHN                     (0)  | Epoch:8 | Val Acc: 0.5676
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (1) | Train Loss: 0.7413 | Train Acc: 0.8209
 Site-USPS                      (0) | Train Loss: 0.6795 | Train Acc: 0.8446
 Site-SynthDigits               (1) | Train Loss: 1.1966 | Train Acc: 0.6689
 Site-MNIST_M                   (2) | Train Loss: 1.2938 | Train Acc: 0.6520
 Site-SVHN                      (3) | Train Loss: 1.4865 | Train Acc: 0.5034
Average Train Accuracy: 0.6980
 Site-MNIST                     (1) | Val  Loss: 0.7241 | Val  Acc: 0.7838
 Site-USPS                      (0) | Val  Loss: 0.7468 | Val  Acc: 0.8514
 Site-SynthDigits               (1) | Val  Loss: 1.2959 | Val  Acc: 0.6622
 Site-MNIST_M                   (2) | Val  Loss: 1.2210 | Val  Acc: 0.7297
 Site-SVHN                      (3) | Val  Loss: 1.4042 | Val  Acc: 0.5676
Average Valid Accuracy: 0.7189
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.7838
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8514
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.6622
 Best site-MNIST_M                  (2)  | Epoch:9 | Val Acc: 0.7297
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5676
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (1) | Train Loss: 0.6887 | Train Acc: 0.8311
 Site-USPS                      (3) | Train Loss: 0.6720 | Train Acc: 0.8412
 Site-SynthDigits               (1) | Train Loss: 1.0556 | Train Acc: 0.7162
 Site-MNIST_M                   (2) | Train Loss: 1.1910 | Train Acc: 0.6757
 Site-SVHN                      (0) | Train Loss: 1.4910 | Train Acc: 0.5203
Average Train Accuracy: 0.7169
 Site-MNIST                     (1) | Val  Loss: 0.6833 | Val  Acc: 0.7973
 Site-USPS                      (3) | Val  Loss: 0.7092 | Val  Acc: 0.8514
 Site-SynthDigits               (1) | Val  Loss: 1.2026 | Val  Acc: 0.6757
 Site-MNIST_M                   (2) | Val  Loss: 1.1791 | Val  Acc: 0.7973
 Site-SVHN                      (0) | Val  Loss: 1.3569 | Val  Acc: 0.5946
Average Valid Accuracy: 0.7432
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.7973
 Best site-USPS                     (3)  | Epoch:10 | Val Acc: 0.8514
 Best site-SynthDigits              (1)  | Epoch:10 | Val Acc: 0.6757
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.7973
 Best site-SVHN                     (0)  | Epoch:10 | Val Acc: 0.5946
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (1) | Train Loss: 0.6202 | Train Acc: 0.8446
 Site-USPS                      (2) | Train Loss: 0.6519 | Train Acc: 0.8514
 Site-SynthDigits               (1) | Train Loss: 0.9907 | Train Acc: 0.7297
 Site-MNIST_M                   (0) | Train Loss: 1.1587 | Train Acc: 0.6723
 Site-SVHN                      (3) | Train Loss: 1.3428 | Train Acc: 0.5541
Average Train Accuracy: 0.7304
 Site-MNIST                     (1) | Val  Loss: 0.6302 | Val  Acc: 0.8243
 Site-USPS                      (2) | Val  Loss: 0.6618 | Val  Acc: 0.9054
 Site-SynthDigits               (1) | Val  Loss: 1.1455 | Val  Acc: 0.6622
 Site-MNIST_M                   (0) | Val  Loss: 1.1316 | Val  Acc: 0.7568
 Site-SVHN                      (3) | Val  Loss: 1.2663 | Val  Acc: 0.6081
Average Valid Accuracy: 0.7514
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8243
 Best site-USPS                     (2)  | Epoch:11 | Val Acc: 0.9054
 Best site-SynthDigits              (1)  | Epoch:11 | Val Acc: 0.6622
 Best site-MNIST_M                  (0)  | Epoch:11 | Val Acc: 0.7568
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.6081
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (2) | Train Loss: 0.6017 | Train Acc: 0.8412
 Site-USPS                      (0) | Train Loss: 0.5975 | Train Acc: 0.8649
 Site-SynthDigits               (0) | Train Loss: 0.9692 | Train Acc: 0.7568
 Site-MNIST_M                   (1) | Train Loss: 1.1065 | Train Acc: 0.6993
 Site-SVHN                      (3) | Train Loss: 1.3363 | Train Acc: 0.5507
Average Train Accuracy: 0.7426
 Site-MNIST                     (2) | Val  Loss: 0.6055 | Val  Acc: 0.8108
 Site-USPS                      (0) | Val  Loss: 0.6363 | Val  Acc: 0.9054
 Site-SynthDigits               (0) | Val  Loss: 1.1108 | Val  Acc: 0.7297
 Site-MNIST_M                   (1) | Val  Loss: 1.0538 | Val  Acc: 0.8108
 Site-SVHN                      (3) | Val  Loss: 1.2181 | Val  Acc: 0.6216
Average Valid Accuracy: 0.7757
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8108
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.9054
 Best site-SynthDigits              (0)  | Epoch:12 | Val Acc: 0.7297
 Best site-MNIST_M                  (1)  | Epoch:12 | Val Acc: 0.8108
 Best site-SVHN                     (3)  | Epoch:12 | Val Acc: 0.6216
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (3) | Train Loss: 0.6114 | Train Acc: 0.8412
 Site-USPS                      (0) | Train Loss: 0.5579 | Train Acc: 0.8649
 Site-SynthDigits               (0) | Train Loss: 0.9606 | Train Acc: 0.7568
 Site-MNIST_M                   (1) | Train Loss: 1.0853 | Train Acc: 0.7399
 Site-SVHN                      (2) | Train Loss: 1.3289 | Train Acc: 0.5743
Average Train Accuracy: 0.7554
 Site-MNIST                     (3) | Val  Loss: 0.5823 | Val  Acc: 0.8108
 Site-USPS                      (0) | Val  Loss: 0.5919 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 1.0816 | Val  Acc: 0.7162
 Site-MNIST_M                   (1) | Val  Loss: 1.0228 | Val  Acc: 0.8243
 Site-SVHN                      (2) | Val  Loss: 1.1770 | Val  Acc: 0.6486
Average Valid Accuracy: 0.7784
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.8108
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.7162
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.8243
 Best site-SVHN                     (2)  | Epoch:13 | Val Acc: 0.6486
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (3) | Train Loss: 0.5391 | Train Acc: 0.8547
 Site-USPS                      (1) | Train Loss: 0.5428 | Train Acc: 0.8716
 Site-SynthDigits               (1) | Train Loss: 0.9265 | Train Acc: 0.7770
 Site-MNIST_M                   (0) | Train Loss: 1.0517 | Train Acc: 0.7027
 Site-SVHN                      (2) | Train Loss: 1.2471 | Train Acc: 0.6149
Average Train Accuracy: 0.7642
 Site-MNIST                     (3) | Val  Loss: 0.5510 | Val  Acc: 0.8378
 Site-USPS                      (1) | Val  Loss: 0.5812 | Val  Acc: 0.9054
 Site-SynthDigits               (1) | Val  Loss: 1.0544 | Val  Acc: 0.7568
 Site-MNIST_M                   (0) | Val  Loss: 1.0078 | Val  Acc: 0.7703
 Site-SVHN                      (2) | Val  Loss: 1.1197 | Val  Acc: 0.7027
Average Valid Accuracy: 0.7946
 Best site-MNIST                    (3)  | Epoch:14 | Val Acc: 0.8378
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.9054
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7568
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.7703
 Best site-SVHN                     (2)  | Epoch:14 | Val Acc: 0.7027
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (2) | Train Loss: 0.5123 | Train Acc: 0.8547
 Site-USPS                      (1) | Train Loss: 0.5350 | Train Acc: 0.8784
 Site-SynthDigits               (1) | Train Loss: 0.8349 | Train Acc: 0.7939
 Site-MNIST_M                   (0) | Train Loss: 1.0352 | Train Acc: 0.7466
 Site-SVHN                      (3) | Train Loss: 1.1827 | Train Acc: 0.6182
Average Train Accuracy: 0.7784
 Site-MNIST                     (2) | Val  Loss: 0.5253 | Val  Acc: 0.8378
 Site-USPS                      (1) | Val  Loss: 0.5448 | Val  Acc: 0.8784
 Site-SynthDigits               (1) | Val  Loss: 1.0018 | Val  Acc: 0.7838
 Site-MNIST_M                   (0) | Val  Loss: 0.9589 | Val  Acc: 0.8243
 Site-SVHN                      (3) | Val  Loss: 1.1033 | Val  Acc: 0.6622
Average Valid Accuracy: 0.7973
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8378
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8784
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.7838
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.8243
 Best site-SVHN                     (3)  | Epoch:15 | Val Acc: 0.6622
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.5503 | Train Acc: 0.8547
 Site-USPS                      (0) | Train Loss: 0.4878 | Train Acc: 0.8818
 Site-SynthDigits               (0) | Train Loss: 0.8247 | Train Acc: 0.7905
 Site-MNIST_M                   (3) | Train Loss: 0.9615 | Train Acc: 0.7703
 Site-SVHN                      (2) | Train Loss: 1.2006 | Train Acc: 0.6419
Average Train Accuracy: 0.7878
 Site-MNIST                     (1) | Val  Loss: 0.5260 | Val  Acc: 0.8243
 Site-USPS                      (0) | Val  Loss: 0.5205 | Val  Acc: 0.9054
 Site-SynthDigits               (0) | Val  Loss: 0.9722 | Val  Acc: 0.7838
 Site-MNIST_M                   (3) | Val  Loss: 0.8800 | Val  Acc: 0.8649
 Site-SVHN                      (2) | Val  Loss: 1.0703 | Val  Acc: 0.6892
Average Valid Accuracy: 0.8135
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.8243
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.9054
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.7838
 Best site-MNIST_M                  (3)  | Epoch:16 | Val Acc: 0.8649
 Best site-SVHN                     (2)  | Epoch:16 | Val Acc: 0.6892
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (0) | Train Loss: 0.4636 | Train Acc: 0.8682
 Site-USPS                      (1) | Train Loss: 0.4964 | Train Acc: 0.8919
 Site-SynthDigits               (3) | Train Loss: 0.7483 | Train Acc: 0.8108
 Site-MNIST_M                   (0) | Train Loss: 0.9409 | Train Acc: 0.7635
 Site-SVHN                      (2) | Train Loss: 1.1349 | Train Acc: 0.6655
Average Train Accuracy: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4826 | Val  Acc: 0.8378
 Site-USPS                      (1) | Val  Loss: 0.5131 | Val  Acc: 0.8919
 Site-SynthDigits               (3) | Val  Loss: 0.8920 | Val  Acc: 0.7973
 Site-MNIST_M                   (0) | Val  Loss: 0.8922 | Val  Acc: 0.7838
 Site-SVHN                      (2) | Val  Loss: 0.9945 | Val  Acc: 0.7162
Average Valid Accuracy: 0.8054
============ Train epoch 18 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (3) | Train Loss: 0.4677 | Train Acc: 0.8581
 Site-USPS                      (0) | Train Loss: 0.4564 | Train Acc: 0.8986
 Site-SynthDigits               (0) | Train Loss: 0.7854 | Train Acc: 0.7973
 Site-MNIST_M                   (1) | Train Loss: 0.8830 | Train Acc: 0.7872
 Site-SVHN                      (2) | Train Loss: 1.0778 | Train Acc: 0.6858
Average Train Accuracy: 0.8054
 Site-MNIST                     (3) | Val  Loss: 0.4729 | Val  Acc: 0.8243
 Site-USPS                      (0) | Val  Loss: 0.4816 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.8992 | Val  Acc: 0.7838
 Site-MNIST_M                   (1) | Val  Loss: 0.7997 | Val  Acc: 0.8649
 Site-SVHN                      (2) | Val  Loss: 0.9912 | Val  Acc: 0.7432
Average Valid Accuracy: 0.8216
 Best site-MNIST                    (3)  | Epoch:18 | Val Acc: 0.8243
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.7838
 Best site-MNIST_M                  (1)  | Epoch:18 | Val Acc: 0.8649
 Best site-SVHN                     (2)  | Epoch:18 | Val Acc: 0.7432
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (3) | Train Loss: 0.4327 | Train Acc: 0.8784
 Site-USPS                      (0) | Train Loss: 0.4526 | Train Acc: 0.8919
 Site-SynthDigits               (0) | Train Loss: 0.7201 | Train Acc: 0.8243
 Site-MNIST_M                   (1) | Train Loss: 0.8660 | Train Acc: 0.7905
 Site-SVHN                      (2) | Train Loss: 1.0493 | Train Acc: 0.6892
Average Train Accuracy: 0.8149
 Site-MNIST                     (3) | Val  Loss: 0.4460 | Val  Acc: 0.8649
 Site-USPS                      (0) | Val  Loss: 0.4703 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.8620 | Val  Acc: 0.7838
 Site-MNIST_M                   (1) | Val  Loss: 0.7930 | Val  Acc: 0.8649
 Site-SVHN                      (2) | Val  Loss: 0.9541 | Val  Acc: 0.7027
Average Valid Accuracy: 0.8216
============ Train epoch 20 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (3) | Train Loss: 0.4080 | Train Acc: 0.8885
 Site-USPS                      (0) | Train Loss: 0.4342 | Train Acc: 0.9088
 Site-SynthDigits               (0) | Train Loss: 0.7360 | Train Acc: 0.8209
 Site-MNIST_M                   (1) | Train Loss: 0.8507 | Train Acc: 0.7939
 Site-SVHN                      (2) | Train Loss: 0.9686 | Train Acc: 0.6993
Average Train Accuracy: 0.8223
 Site-MNIST                     (3) | Val  Loss: 0.4296 | Val  Acc: 0.8649
 Site-USPS                      (0) | Val  Loss: 0.4479 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.8185 | Val  Acc: 0.7973
 Site-MNIST_M                   (1) | Val  Loss: 0.7871 | Val  Acc: 0.8649
 Site-SVHN                      (2) | Val  Loss: 0.9183 | Val  Acc: 0.7027
Average Valid Accuracy: 0.8243
 Best site-MNIST                    (3)  | Epoch:20 | Val Acc: 0.8649
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:20 | Val Acc: 0.7973
 Best site-MNIST_M                  (1)  | Epoch:20 | Val Acc: 0.8649
 Best site-SVHN                     (2)  | Epoch:20 | Val Acc: 0.7027
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (3) | Train Loss: 0.4073 | Train Acc: 0.8885
 Site-USPS                      (0) | Train Loss: 0.4473 | Train Acc: 0.9088
 Site-SynthDigits               (0) | Train Loss: 0.7107 | Train Acc: 0.8311
 Site-MNIST_M                   (1) | Train Loss: 0.8139 | Train Acc: 0.8108
 Site-SVHN                      (2) | Train Loss: 1.0237 | Train Acc: 0.7230
Average Train Accuracy: 0.8324
 Site-MNIST                     (3) | Val  Loss: 0.4215 | Val  Acc: 0.8649
 Site-USPS                      (0) | Val  Loss: 0.4384 | Val  Acc: 0.9054
 Site-SynthDigits               (0) | Val  Loss: 0.7844 | Val  Acc: 0.8108
 Site-MNIST_M                   (1) | Val  Loss: 0.7255 | Val  Acc: 0.8649
 Site-SVHN                      (2) | Val  Loss: 0.8885 | Val  Acc: 0.7703
Average Valid Accuracy: 0.8432
 Best site-MNIST                    (3)  | Epoch:21 | Val Acc: 0.8649
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.9054
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8108
 Best site-MNIST_M                  (1)  | Epoch:21 | Val Acc: 0.8649
 Best site-SVHN                     (2)  | Epoch:21 | Val Acc: 0.7703
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (3) | Train Loss: 0.4131 | Train Acc: 0.8919
 Site-USPS                      (0) | Train Loss: 0.4139 | Train Acc: 0.9088
 Site-SynthDigits               (0) | Train Loss: 0.6483 | Train Acc: 0.8311
 Site-MNIST_M                   (1) | Train Loss: 0.7692 | Train Acc: 0.8176
 Site-SVHN                      (2) | Train Loss: 0.9799 | Train Acc: 0.6959
Average Train Accuracy: 0.8291
 Site-MNIST                     (3) | Val  Loss: 0.4084 | Val  Acc: 0.8649
 Site-USPS                      (0) | Val  Loss: 0.4185 | Val  Acc: 0.9054
 Site-SynthDigits               (0) | Val  Loss: 0.7731 | Val  Acc: 0.8108
 Site-MNIST_M                   (1) | Val  Loss: 0.6939 | Val  Acc: 0.8784
 Site-SVHN                      (2) | Val  Loss: 0.8830 | Val  Acc: 0.7703
Average Valid Accuracy: 0.8459
 Best site-MNIST                    (3)  | Epoch:22 | Val Acc: 0.8649
 Best site-USPS                     (0)  | Epoch:22 | Val Acc: 0.9054
 Best site-SynthDigits              (0)  | Epoch:22 | Val Acc: 0.8108
 Best site-MNIST_M                  (1)  | Epoch:22 | Val Acc: 0.8784
 Best site-SVHN                     (2)  | Epoch:22 | Val Acc: 0.7703
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (3) | Train Loss: 0.3978 | Train Acc: 0.9020
 Site-USPS                      (0) | Train Loss: 0.3914 | Train Acc: 0.9088
 Site-SynthDigits               (0) | Train Loss: 0.6537 | Train Acc: 0.8446
 Site-MNIST_M                   (1) | Train Loss: 0.7612 | Train Acc: 0.8041
 Site-SVHN                      (2) | Train Loss: 0.8932 | Train Acc: 0.7601
Average Train Accuracy: 0.8439
 Site-MNIST                     (3) | Val  Loss: 0.4041 | Val  Acc: 0.8784
 Site-USPS                      (0) | Val  Loss: 0.4106 | Val  Acc: 0.9054
 Site-SynthDigits               (0) | Val  Loss: 0.7247 | Val  Acc: 0.8243
 Site-MNIST_M                   (1) | Val  Loss: 0.6960 | Val  Acc: 0.8784
 Site-SVHN                      (2) | Val  Loss: 0.8399 | Val  Acc: 0.7568
Average Valid Accuracy: 0.8486
 Best site-MNIST                    (3)  | Epoch:23 | Val Acc: 0.8784
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.9054
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8243
 Best site-MNIST_M                  (1)  | Epoch:23 | Val Acc: 0.8784
 Best site-SVHN                     (2)  | Epoch:23 | Val Acc: 0.7568
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.3690 | Train Acc: 0.9020
 Site-USPS                      (2) | Train Loss: 0.3855 | Train Acc: 0.9155
 Site-SynthDigits               (2) | Train Loss: 0.6332 | Train Acc: 0.8480
 Site-MNIST_M                   (3) | Train Loss: 0.7191 | Train Acc: 0.8243
 Site-SVHN                      (1) | Train Loss: 0.8878 | Train Acc: 0.7568
Average Train Accuracy: 0.8493
 Site-MNIST                     (0) | Val  Loss: 0.3890 | Val  Acc: 0.8919
 Site-USPS                      (2) | Val  Loss: 0.4009 | Val  Acc: 0.9054
 Site-SynthDigits               (2) | Val  Loss: 0.7072 | Val  Acc: 0.8108
 Site-MNIST_M                   (3) | Val  Loss: 0.6491 | Val  Acc: 0.8784
 Site-SVHN                      (1) | Val  Loss: 0.7965 | Val  Acc: 0.7973
Average Valid Accuracy: 0.8568
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.8919
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.9054
 Best site-SynthDigits              (2)  | Epoch:24 | Val Acc: 0.8108
 Best site-MNIST_M                  (3)  | Epoch:24 | Val Acc: 0.8784
 Best site-SVHN                     (1)  | Epoch:24 | Val Acc: 0.7973
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 1, 1, 2, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (2) | Train Loss: 0.3707 | Train Acc: 0.8986
 Site-USPS                      (3) | Train Loss: 0.3658 | Train Acc: 0.9155
 Site-SynthDigits               (3) | Train Loss: 0.6391 | Train Acc: 0.8412
 Site-MNIST_M                   (0) | Train Loss: 0.6898 | Train Acc: 0.8446
 Site-SVHN                      (1) | Train Loss: 0.8616 | Train Acc: 0.7399
Average Train Accuracy: 0.8480
 Site-MNIST                     (2) | Val  Loss: 0.3811 | Val  Acc: 0.8649
 Site-USPS                      (3) | Val  Loss: 0.3871 | Val  Acc: 0.9054
 Site-SynthDigits               (3) | Val  Loss: 0.7036 | Val  Acc: 0.8243
 Site-MNIST_M                   (0) | Val  Loss: 0.5971 | Val  Acc: 0.8919
 Site-SVHN                      (1) | Val  Loss: 0.7776 | Val  Acc: 0.8108
Average Valid Accuracy: 0.8595
 Best site-MNIST                    (2)  | Epoch:25 | Val Acc: 0.8649
 Best site-USPS                     (3)  | Epoch:25 | Val Acc: 0.9054
 Best site-SynthDigits              (3)  | Epoch:25 | Val Acc: 0.8243
 Best site-MNIST_M                  (0)  | Epoch:25 | Val Acc: 0.8919
 Best site-SVHN                     (1)  | Epoch:25 | Val Acc: 0.8108
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (0) | Train Loss: 0.3286 | Train Acc: 0.9020
 Site-USPS                      (1) | Train Loss: 0.3582 | Train Acc: 0.9088
 Site-SynthDigits               (1) | Train Loss: 0.6079 | Train Acc: 0.8514
 Site-MNIST_M                   (3) | Train Loss: 0.7165 | Train Acc: 0.8311
 Site-SVHN                      (2) | Train Loss: 0.8248 | Train Acc: 0.7635
Average Train Accuracy: 0.8514
 Site-MNIST                     (0) | Val  Loss: 0.3591 | Val  Acc: 0.8784
 Site-USPS                      (1) | Val  Loss: 0.3878 | Val  Acc: 0.9054
 Site-SynthDigits               (1) | Val  Loss: 0.6873 | Val  Acc: 0.7973
 Site-MNIST_M                   (3) | Val  Loss: 0.6088 | Val  Acc: 0.8784
 Site-SVHN                      (2) | Val  Loss: 0.7654 | Val  Acc: 0.7838
Average Valid Accuracy: 0.8486
============ Train epoch 27 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.3789 | Train Acc: 0.8986
 Site-USPS                      (2) | Train Loss: 0.3512 | Train Acc: 0.9155
 Site-SynthDigits               (2) | Train Loss: 0.5794 | Train Acc: 0.8547
 Site-MNIST_M                   (3) | Train Loss: 0.6413 | Train Acc: 0.8682
 Site-SVHN                      (0) | Train Loss: 0.8475 | Train Acc: 0.7500
Average Train Accuracy: 0.8574
 Site-MNIST                     (1) | Val  Loss: 0.3665 | Val  Acc: 0.8649
 Site-USPS                      (2) | Val  Loss: 0.3735 | Val  Acc: 0.9054
 Site-SynthDigits               (2) | Val  Loss: 0.6681 | Val  Acc: 0.8378
 Site-MNIST_M                   (3) | Val  Loss: 0.5702 | Val  Acc: 0.9054
 Site-SVHN                      (0) | Val  Loss: 0.7592 | Val  Acc: 0.7973
Average Valid Accuracy: 0.8622
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.8649
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.9054
 Best site-SynthDigits              (2)  | Epoch:27 | Val Acc: 0.8378
 Best site-MNIST_M                  (3)  | Epoch:27 | Val Acc: 0.9054
 Best site-SVHN                     (0)  | Epoch:27 | Val Acc: 0.7973
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 28 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.3981 | Train Acc: 0.9054
 Site-USPS                      (2) | Train Loss: 0.3452 | Train Acc: 0.9189
 Site-SynthDigits               (2) | Train Loss: 0.5567 | Train Acc: 0.8682
 Site-MNIST_M                   (3) | Train Loss: 0.6302 | Train Acc: 0.8615
 Site-SVHN                      (0) | Train Loss: 0.8219 | Train Acc: 0.7736
Average Train Accuracy: 0.8655
 Site-MNIST                     (1) | Val  Loss: 0.3504 | Val  Acc: 0.8784
 Site-USPS                      (2) | Val  Loss: 0.3652 | Val  Acc: 0.9054
 Site-SynthDigits               (2) | Val  Loss: 0.6466 | Val  Acc: 0.8243
 Site-MNIST_M                   (3) | Val  Loss: 0.5751 | Val  Acc: 0.8919
 Site-SVHN                      (0) | Val  Loss: 0.7255 | Val  Acc: 0.8108
Average Valid Accuracy: 0.8622
============ Train epoch 29 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.3522 | Train Acc: 0.9088
 Site-USPS                      (2) | Train Loss: 0.3285 | Train Acc: 0.9189
 Site-SynthDigits               (2) | Train Loss: 0.5465 | Train Acc: 0.8581
 Site-MNIST_M                   (3) | Train Loss: 0.6571 | Train Acc: 0.8750
 Site-SVHN                      (1) | Train Loss: 0.8048 | Train Acc: 0.7905
Average Train Accuracy: 0.8703
 Site-MNIST                     (0) | Val  Loss: 0.3368 | Val  Acc: 0.8784
 Site-USPS                      (2) | Val  Loss: 0.3446 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.6244 | Val  Acc: 0.8243
 Site-MNIST_M                   (3) | Val  Loss: 0.5594 | Val  Acc: 0.8919
 Site-SVHN                      (1) | Val  Loss: 0.7022 | Val  Acc: 0.8514
Average Valid Accuracy: 0.8730
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.8784
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:29 | Val Acc: 0.8243
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.8919
 Best site-SVHN                     (1)  | Epoch:29 | Val Acc: 0.8514
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 30 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2931 | Train Acc: 0.9122
 Site-USPS                      (2) | Train Loss: 0.3223 | Train Acc: 0.9223
 Site-SynthDigits               (2) | Train Loss: 0.5475 | Train Acc: 0.8581
 Site-MNIST_M                   (3) | Train Loss: 0.6126 | Train Acc: 0.8885
 Site-SVHN                      (0) | Train Loss: 0.7808 | Train Acc: 0.7939
Average Train Accuracy: 0.8750
 Site-MNIST                     (1) | Val  Loss: 0.3239 | Val  Acc: 0.8784
 Site-USPS                      (2) | Val  Loss: 0.3273 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.6055 | Val  Acc: 0.8378
 Site-MNIST_M                   (3) | Val  Loss: 0.5366 | Val  Acc: 0.9189
 Site-SVHN                      (0) | Val  Loss: 0.6865 | Val  Acc: 0.8514
Average Valid Accuracy: 0.8811
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8784
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:30 | Val Acc: 0.8378
 Best site-MNIST_M                  (3)  | Epoch:30 | Val Acc: 0.9189
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.8514
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 31 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.2993 | Train Acc: 0.9088
 Site-USPS                      (2) | Train Loss: 0.3205 | Train Acc: 0.9189
 Site-SynthDigits               (2) | Train Loss: 0.5339 | Train Acc: 0.8615
 Site-MNIST_M                   (3) | Train Loss: 0.5936 | Train Acc: 0.8885
 Site-SVHN                      (0) | Train Loss: 0.7696 | Train Acc: 0.7905
Average Train Accuracy: 0.8736
 Site-MNIST                     (1) | Val  Loss: 0.3127 | Val  Acc: 0.8784
 Site-USPS                      (2) | Val  Loss: 0.3545 | Val  Acc: 0.9054
 Site-SynthDigits               (2) | Val  Loss: 0.6018 | Val  Acc: 0.8378
 Site-MNIST_M                   (3) | Val  Loss: 0.5117 | Val  Acc: 0.9324
 Site-SVHN                      (0) | Val  Loss: 0.6672 | Val  Acc: 0.8243
Average Valid Accuracy: 0.8757
============ Train epoch 32 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (3) | Train Loss: 0.3039 | Train Acc: 0.9155
 Site-USPS                      (0) | Train Loss: 0.3413 | Train Acc: 0.9223
 Site-SynthDigits               (0) | Train Loss: 0.5270 | Train Acc: 0.8615
 Site-MNIST_M                   (1) | Train Loss: 0.5699 | Train Acc: 0.8953
 Site-SVHN                      (2) | Train Loss: 0.7310 | Train Acc: 0.8041
Average Train Accuracy: 0.8797
 Site-MNIST                     (3) | Val  Loss: 0.3072 | Val  Acc: 0.8784
 Site-USPS                      (0) | Val  Loss: 0.3129 | Val  Acc: 0.9054
 Site-SynthDigits               (0) | Val  Loss: 0.5912 | Val  Acc: 0.8378
 Site-MNIST_M                   (1) | Val  Loss: 0.4765 | Val  Acc: 0.9054
 Site-SVHN                      (2) | Val  Loss: 0.6673 | Val  Acc: 0.8514
Average Valid Accuracy: 0.8757
============ Train epoch 33 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (3) | Train Loss: 0.2752 | Train Acc: 0.9291
 Site-USPS                      (0) | Train Loss: 0.3075 | Train Acc: 0.9189
 Site-SynthDigits               (0) | Train Loss: 0.5312 | Train Acc: 0.8682
 Site-MNIST_M                   (1) | Train Loss: 0.5729 | Train Acc: 0.8885
 Site-SVHN                      (2) | Train Loss: 0.7309 | Train Acc: 0.8209
Average Train Accuracy: 0.8851
 Site-MNIST                     (3) | Val  Loss: 0.3020 | Val  Acc: 0.8919
 Site-USPS                      (0) | Val  Loss: 0.2991 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.5668 | Val  Acc: 0.8514
 Site-MNIST_M                   (1) | Val  Loss: 0.4891 | Val  Acc: 0.9324
 Site-SVHN                      (2) | Val  Loss: 0.6447 | Val  Acc: 0.8514
Average Valid Accuracy: 0.8892
 Best site-MNIST                    (3)  | Epoch:33 | Val Acc: 0.8919
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:33 | Val Acc: 0.8514
 Best site-MNIST_M                  (1)  | Epoch:33 | Val Acc: 0.9324
 Best site-SVHN                     (2)  | Epoch:33 | Val Acc: 0.8514
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 1, 1, 2, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.2734 | Train Acc: 0.9223
 Site-USPS                      (3) | Train Loss: 0.3069 | Train Acc: 0.9189
 Site-SynthDigits               (3) | Train Loss: 0.4955 | Train Acc: 0.8716
 Site-MNIST_M                   (2) | Train Loss: 0.5532 | Train Acc: 0.9020
 Site-SVHN                      (0) | Train Loss: 0.6932 | Train Acc: 0.8277
Average Train Accuracy: 0.8885
 Site-MNIST                     (1) | Val  Loss: 0.2966 | Val  Acc: 0.8919
 Site-USPS                      (3) | Val  Loss: 0.3253 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.5467 | Val  Acc: 0.8378
 Site-MNIST_M                   (2) | Val  Loss: 0.4719 | Val  Acc: 0.9324
 Site-SVHN                      (0) | Val  Loss: 0.6066 | Val  Acc: 0.8649
Average Valid Accuracy: 0.8892
============ Train epoch 35 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (2) | Train Loss: 0.2653 | Train Acc: 0.9189
 Site-USPS                      (1) | Train Loss: 0.2984 | Train Acc: 0.9223
 Site-SynthDigits               (1) | Train Loss: 0.4706 | Train Acc: 0.8851
 Site-MNIST_M                   (0) | Train Loss: 0.4985 | Train Acc: 0.9155
 Site-SVHN                      (3) | Train Loss: 0.6530 | Train Acc: 0.8412
Average Train Accuracy: 0.8966
 Site-MNIST                     (2) | Val  Loss: 0.2884 | Val  Acc: 0.8919
 Site-USPS                      (1) | Val  Loss: 0.3201 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.5339 | Val  Acc: 0.8378
 Site-MNIST_M                   (0) | Val  Loss: 0.4338 | Val  Acc: 0.9459
 Site-SVHN                      (3) | Val  Loss: 0.5982 | Val  Acc: 0.8784
Average Valid Accuracy: 0.8946
 Best site-MNIST                    (2)  | Epoch:35 | Val Acc: 0.8919
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:35 | Val Acc: 0.8378
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.9459
 Best site-SVHN                     (3)  | Epoch:35 | Val Acc: 0.8784
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (3) | Train Loss: 0.2910 | Train Acc: 0.9155
 Site-USPS                      (0) | Train Loss: 0.3076 | Train Acc: 0.9223
 Site-SynthDigits               (0) | Train Loss: 0.4537 | Train Acc: 0.8818
 Site-MNIST_M                   (1) | Train Loss: 0.5033 | Train Acc: 0.9291
 Site-SVHN                      (2) | Train Loss: 0.6447 | Train Acc: 0.8412
Average Train Accuracy: 0.8980
 Site-MNIST                     (3) | Val  Loss: 0.2918 | Val  Acc: 0.8919
 Site-USPS                      (0) | Val  Loss: 0.3019 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.5310 | Val  Acc: 0.8378
 Site-MNIST_M                   (1) | Val  Loss: 0.4318 | Val  Acc: 0.9459
 Site-SVHN                      (2) | Val  Loss: 0.5906 | Val  Acc: 0.8784
Average Valid Accuracy: 0.8946
============ Train epoch 37 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.2596 | Train Acc: 0.9155
 Site-USPS                      (1) | Train Loss: 0.2715 | Train Acc: 0.9223
 Site-SynthDigits               (1) | Train Loss: 0.4560 | Train Acc: 0.8953
 Site-MNIST_M                   (0) | Train Loss: 0.5046 | Train Acc: 0.9189
 Site-SVHN                      (2) | Train Loss: 0.6504 | Train Acc: 0.8412
Average Train Accuracy: 0.8986
 Site-MNIST                     (3) | Val  Loss: 0.2860 | Val  Acc: 0.8784
 Site-USPS                      (1) | Val  Loss: 0.2899 | Val  Acc: 0.9054
 Site-SynthDigits               (1) | Val  Loss: 0.4938 | Val  Acc: 0.8784
 Site-MNIST_M                   (0) | Val  Loss: 0.4264 | Val  Acc: 0.9595
 Site-SVHN                      (2) | Val  Loss: 0.5620 | Val  Acc: 0.8919
Average Valid Accuracy: 0.9027
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.8784
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 0.9054
 Best site-SynthDigits              (1)  | Epoch:37 | Val Acc: 0.8784
 Best site-MNIST_M                  (0)  | Epoch:37 | Val Acc: 0.9595
 Best site-SVHN                     (2)  | Epoch:37 | Val Acc: 0.8919
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 38 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (3) | Train Loss: 0.2743 | Train Acc: 0.9223
 Site-USPS                      (1) | Train Loss: 0.2789 | Train Acc: 0.9223
 Site-SynthDigits               (1) | Train Loss: 0.4611 | Train Acc: 0.8851
 Site-MNIST_M                   (2) | Train Loss: 0.5048 | Train Acc: 0.9189
 Site-SVHN                      (0) | Train Loss: 0.6211 | Train Acc: 0.8547
Average Train Accuracy: 0.9007
 Site-MNIST                     (3) | Val  Loss: 0.2796 | Val  Acc: 0.8919
 Site-USPS                      (1) | Val  Loss: 0.2867 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.4934 | Val  Acc: 0.8649
 Site-MNIST_M                   (2) | Val  Loss: 0.4403 | Val  Acc: 0.9730
 Site-SVHN                      (0) | Val  Loss: 0.5460 | Val  Acc: 0.8919
Average Valid Accuracy: 0.9081
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.8919
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:38 | Val Acc: 0.8649
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.9730
 Best site-SVHN                     (0)  | Epoch:38 | Val Acc: 0.8919
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (2) | Train Loss: 0.2538 | Train Acc: 0.9189
 Site-USPS                      (0) | Train Loss: 0.2597 | Train Acc: 0.9257
 Site-SynthDigits               (0) | Train Loss: 0.4519 | Train Acc: 0.8885
 Site-MNIST_M                   (1) | Train Loss: 0.4678 | Train Acc: 0.9291
 Site-SVHN                      (3) | Train Loss: 0.6087 | Train Acc: 0.8615
Average Train Accuracy: 0.9047
 Site-MNIST                     (2) | Val  Loss: 0.2705 | Val  Acc: 0.8919
 Site-USPS                      (0) | Val  Loss: 0.2692 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.4855 | Val  Acc: 0.8514
 Site-MNIST_M                   (1) | Val  Loss: 0.4088 | Val  Acc: 0.9730
 Site-SVHN                      (3) | Val  Loss: 0.5488 | Val  Acc: 0.8919
Average Valid Accuracy: 0.9054
============ Train epoch 40 ============
cnt=[1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.2563 | Train Acc: 0.9257
 Site-USPS                      (2) | Train Loss: 0.2792 | Train Acc: 0.9257
 Site-SynthDigits               (2) | Train Loss: 0.4265 | Train Acc: 0.8986
 Site-MNIST_M                   (3) | Train Loss: 0.4714 | Train Acc: 0.9257
 Site-SVHN                      (0) | Train Loss: 0.6265 | Train Acc: 0.8480
Average Train Accuracy: 0.9047
 Site-MNIST                     (1) | Val  Loss: 0.2626 | Val  Acc: 0.9054
 Site-USPS                      (2) | Val  Loss: 0.2623 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.4672 | Val  Acc: 0.8649
 Site-MNIST_M                   (3) | Val  Loss: 0.3941 | Val  Acc: 0.9595
 Site-SVHN                      (0) | Val  Loss: 0.5411 | Val  Acc: 0.8784
Average Valid Accuracy: 0.9054
============ Train epoch 41 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (2) | Train Loss: 0.2480 | Train Acc: 0.9257
 Site-USPS                      (0) | Train Loss: 0.2705 | Train Acc: 0.9291
 Site-SynthDigits               (0) | Train Loss: 0.4222 | Train Acc: 0.8986
 Site-MNIST_M                   (1) | Train Loss: 0.4565 | Train Acc: 0.9459
 Site-SVHN                      (3) | Train Loss: 0.5542 | Train Acc: 0.8750
Average Train Accuracy: 0.9149
 Site-MNIST                     (2) | Val  Loss: 0.2550 | Val  Acc: 0.8919
 Site-USPS                      (0) | Val  Loss: 0.2547 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.4613 | Val  Acc: 0.8784
 Site-MNIST_M                   (1) | Val  Loss: 0.3900 | Val  Acc: 0.9595
 Site-SVHN                      (3) | Val  Loss: 0.5081 | Val  Acc: 0.9054
Average Valid Accuracy: 0.9108
 Best site-MNIST                    (2)  | Epoch:41 | Val Acc: 0.8919
 Best site-USPS                     (0)  | Epoch:41 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.8784
 Best site-MNIST_M                  (1)  | Epoch:41 | Val Acc: 0.9595
 Best site-SVHN                     (3)  | Epoch:41 | Val Acc: 0.9054
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 42 ============
cnt=[1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (3) | Train Loss: 0.2363 | Train Acc: 0.9291
 Site-USPS                      (1) | Train Loss: 0.2601 | Train Acc: 0.9291
 Site-SynthDigits               (1) | Train Loss: 0.3933 | Train Acc: 0.8953
 Site-MNIST_M                   (0) | Train Loss: 0.4347 | Train Acc: 0.9392
 Site-SVHN                      (2) | Train Loss: 0.5711 | Train Acc: 0.8784
Average Train Accuracy: 0.9142
 Site-MNIST                     (3) | Val  Loss: 0.2563 | Val  Acc: 0.9054
 Site-USPS                      (1) | Val  Loss: 0.2391 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.4593 | Val  Acc: 0.8649
 Site-MNIST_M                   (0) | Val  Loss: 0.3740 | Val  Acc: 0.9730
 Site-SVHN                      (2) | Val  Loss: 0.5036 | Val  Acc: 0.9054
Average Valid Accuracy: 0.9135
 Best site-MNIST                    (3)  | Epoch:42 | Val Acc: 0.9054
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.8649
 Best site-MNIST_M                  (0)  | Epoch:42 | Val Acc: 0.9730
 Best site-SVHN                     (2)  | Epoch:42 | Val Acc: 0.9054
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.2332 | Train Acc: 0.9257
 Site-USPS                      (2) | Train Loss: 0.2381 | Train Acc: 0.9291
 Site-SynthDigits               (2) | Train Loss: 0.4058 | Train Acc: 0.8953
 Site-MNIST_M                   (3) | Train Loss: 0.4216 | Train Acc: 0.9392
 Site-SVHN                      (1) | Train Loss: 0.5691 | Train Acc: 0.8818
Average Train Accuracy: 0.9142
 Site-MNIST                     (0) | Val  Loss: 0.2440 | Val  Acc: 0.9054
 Site-USPS                      (2) | Val  Loss: 0.2446 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.4583 | Val  Acc: 0.8649
 Site-MNIST_M                   (3) | Val  Loss: 0.3517 | Val  Acc: 0.9730
 Site-SVHN                      (1) | Val  Loss: 0.5063 | Val  Acc: 0.8919
Average Valid Accuracy: 0.9108
============ Train epoch 44 ============
cnt=[1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.2343 | Train Acc: 0.9358
 Site-USPS                      (1) | Train Loss: 0.2475 | Train Acc: 0.9358
 Site-SynthDigits               (1) | Train Loss: 0.3887 | Train Acc: 0.8851
 Site-MNIST_M                   (2) | Train Loss: 0.4190 | Train Acc: 0.9426
 Site-SVHN                      (3) | Train Loss: 0.5688 | Train Acc: 0.8784
Average Train Accuracy: 0.9155
 Site-MNIST                     (0) | Val  Loss: 0.2413 | Val  Acc: 0.9054
 Site-USPS                      (1) | Val  Loss: 0.2381 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.4404 | Val  Acc: 0.8514
 Site-MNIST_M                   (2) | Val  Loss: 0.3537 | Val  Acc: 0.9730
 Site-SVHN                      (3) | Val  Loss: 0.4862 | Val  Acc: 0.9054
Average Valid Accuracy: 0.9108
============ Train epoch 45 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (3) | Train Loss: 0.2333 | Train Acc: 0.9324
 Site-USPS                      (0) | Train Loss: 0.2299 | Train Acc: 0.9324
 Site-SynthDigits               (0) | Train Loss: 0.4069 | Train Acc: 0.8986
 Site-MNIST_M                   (2) | Train Loss: 0.4012 | Train Acc: 0.9392
 Site-SVHN                      (1) | Train Loss: 0.5115 | Train Acc: 0.8986
Average Train Accuracy: 0.9203
 Site-MNIST                     (3) | Val  Loss: 0.2380 | Val  Acc: 0.9054
 Site-USPS                      (0) | Val  Loss: 0.2482 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.4339 | Val  Acc: 0.8514
 Site-MNIST_M                   (2) | Val  Loss: 0.3497 | Val  Acc: 0.9730
 Site-SVHN                      (1) | Val  Loss: 0.4661 | Val  Acc: 0.9324
Average Valid Accuracy: 0.9162
 Best site-MNIST                    (3)  | Epoch:45 | Val Acc: 0.9054
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:45 | Val Acc: 0.8514
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.9730
 Best site-SVHN                     (1)  | Epoch:45 | Val Acc: 0.9324
 Test site-MNIST                     (3)| Epoch:45 | Test Acc: 0.8821
 Test site-USPS                      (0)| Epoch:45 | Test Acc: 0.9140
 Test site-SynthDigits               (0)| Epoch:45 | Test Acc: 0.8593
 Test site-MNIST_M                   (2)| Epoch:45 | Test Acc: 0.6757
 Test site-SVHN                      (1)| Epoch:45 | Test Acc: 0.6156
MNIST: 0.8821, USPS: 0.9140, SynthDigits: 0.8593, MNIST_M: 0.6757, SVHN: 0.6156, 
Average Test Accuracy(group): 0.7893, Average Test Accuracy(individual): 0.7893,
domain std=0.1201, cluster std=0.1212, individual std=0.1201, 
Average Test Accuracy: 0.7893
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (3) | Train Loss: 0.2395 | Train Acc: 0.9358
 Site-USPS                      (0) | Train Loss: 0.2207 | Train Acc: 0.9358
 Site-SynthDigits               (0) | Train Loss: 0.3668 | Train Acc: 0.8986
 Site-MNIST_M                   (2) | Train Loss: 0.4236 | Train Acc: 0.9459
 Site-SVHN                      (1) | Train Loss: 0.5177 | Train Acc: 0.8986
Average Train Accuracy: 0.9230
 Site-MNIST                     (3) | Val  Loss: 0.2220 | Val  Acc: 0.9189
 Site-USPS                      (0) | Val  Loss: 0.2252 | Val  Acc: 0.9324
 Site-SynthDigits               (0) | Val  Loss: 0.4325 | Val  Acc: 0.8649
 Site-MNIST_M                   (2) | Val  Loss: 0.3207 | Val  Acc: 0.9730
 Site-SVHN                      (1) | Val  Loss: 0.4656 | Val  Acc: 0.9189
Average Valid Accuracy: 0.9216
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9189
 Best site-USPS                     (0)  | Epoch:46 | Val Acc: 0.9324
 Best site-SynthDigits              (0)  | Epoch:46 | Val Acc: 0.8649
 Best site-MNIST_M                  (2)  | Epoch:46 | Val Acc: 0.9730
 Best site-SVHN                     (1)  | Epoch:46 | Val Acc: 0.9189
 Test site-MNIST                     (3)| Epoch:46 | Test Acc: 0.8886
 Test site-USPS                      (0)| Epoch:46 | Test Acc: 0.9032
 Test site-SynthDigits               (0)| Epoch:46 | Test Acc: 0.8572
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.6807
 Test site-SVHN                      (1)| Epoch:46 | Test Acc: 0.6161
MNIST: 0.8886, USPS: 0.9032, SynthDigits: 0.8572, MNIST_M: 0.6807, SVHN: 0.6161, 
Average Test Accuracy(group): 0.7892, Average Test Accuracy(individual): 0.7892,
domain std=0.1177, cluster std=0.1202, individual std=0.1177, 
Average Test Accuracy: 0.7892
============ Train epoch 47 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (3) | Train Loss: 0.2141 | Train Acc: 0.9392
 Site-USPS                      (0) | Train Loss: 0.2217 | Train Acc: 0.9358
 Site-SynthDigits               (0) | Train Loss: 0.3861 | Train Acc: 0.8953
 Site-MNIST_M                   (1) | Train Loss: 0.3868 | Train Acc: 0.9527
 Site-SVHN                      (2) | Train Loss: 0.5106 | Train Acc: 0.9054
Average Train Accuracy: 0.9257
 Site-MNIST                     (3) | Val  Loss: 0.2141 | Val  Acc: 0.9189
 Site-USPS                      (0) | Val  Loss: 0.2281 | Val  Acc: 0.9324
 Site-SynthDigits               (0) | Val  Loss: 0.4154 | Val  Acc: 0.8649
 Site-MNIST_M                   (1) | Val  Loss: 0.3387 | Val  Acc: 0.9730
 Site-SVHN                      (2) | Val  Loss: 0.4409 | Val  Acc: 0.9324
Average Valid Accuracy: 0.9243
 Best site-MNIST                    (3)  | Epoch:47 | Val Acc: 0.9189
 Best site-USPS                     (0)  | Epoch:47 | Val Acc: 0.9324
 Best site-SynthDigits              (0)  | Epoch:47 | Val Acc: 0.8649
 Best site-MNIST_M                  (1)  | Epoch:47 | Val Acc: 0.9730
 Best site-SVHN                     (2)  | Epoch:47 | Val Acc: 0.9324
 Test site-MNIST                     (3)| Epoch:47 | Test Acc: 0.8907
 Test site-USPS                      (0)| Epoch:47 | Test Acc: 0.9140
 Test site-SynthDigits               (0)| Epoch:47 | Test Acc: 0.8561
 Test site-MNIST_M                   (1)| Epoch:47 | Test Acc: 0.6750
 Test site-SVHN                      (2)| Epoch:47 | Test Acc: 0.6146
MNIST: 0.8907, USPS: 0.9140, SynthDigits: 0.8561, MNIST_M: 0.6750, SVHN: 0.6146, 
Average Test Accuracy(group): 0.7901, Average Test Accuracy(individual): 0.7901,
domain std=0.1216, cluster std=0.1234, individual std=0.1216, 
Average Test Accuracy: 0.7901
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (3) | Train Loss: 0.2286 | Train Acc: 0.9392
 Site-USPS                      (0) | Train Loss: 0.2265 | Train Acc: 0.9324
 Site-SynthDigits               (0) | Train Loss: 0.3465 | Train Acc: 0.9054
 Site-MNIST_M                   (1) | Train Loss: 0.3772 | Train Acc: 0.9493
 Site-SVHN                      (2) | Train Loss: 0.4897 | Train Acc: 0.8986
Average Train Accuracy: 0.9250
 Site-MNIST                     (3) | Val  Loss: 0.2105 | Val  Acc: 0.9189
 Site-USPS                      (0) | Val  Loss: 0.2390 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.4119 | Val  Acc: 0.8378
 Site-MNIST_M                   (1) | Val  Loss: 0.3163 | Val  Acc: 0.9865
 Site-SVHN                      (2) | Val  Loss: 0.4487 | Val  Acc: 0.9054
Average Valid Accuracy: 0.9135
 Test site-MNIST                     (3)| Epoch:47 | Test Acc: 0.8900
 Test site-USPS                      (0)| Epoch:47 | Test Acc: 0.9086
 Test site-SynthDigits               (0)| Epoch:47 | Test Acc: 0.8591
 Test site-MNIST_M                   (1)| Epoch:47 | Test Acc: 0.6786
 Test site-SVHN                      (2)| Epoch:47 | Test Acc: 0.6156
MNIST: 0.8900, USPS: 0.9086, SynthDigits: 0.8591, MNIST_M: 0.6786, SVHN: 0.6156, 
Average Test Accuracy(group): 0.7904, Average Test Accuracy(individual): 0.7904,
domain std=0.1197, cluster std=0.1220, individual std=0.1197, 
Average Test Accuracy: 0.7904
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (3) | Train Loss: 0.2427 | Train Acc: 0.9392
 Site-USPS                      (0) | Train Loss: 0.2409 | Train Acc: 0.9358
 Site-SynthDigits               (0) | Train Loss: 0.3506 | Train Acc: 0.9054
 Site-MNIST_M                   (1) | Train Loss: 0.3667 | Train Acc: 0.9493
 Site-SVHN                      (2) | Train Loss: 0.4787 | Train Acc: 0.9020
Average Train Accuracy: 0.9264
 Site-MNIST                     (3) | Val  Loss: 0.2108 | Val  Acc: 0.9189
 Site-USPS                      (0) | Val  Loss: 0.2172 | Val  Acc: 0.9324
 Site-SynthDigits               (0) | Val  Loss: 0.4005 | Val  Acc: 0.8649
 Site-MNIST_M                   (1) | Val  Loss: 0.3070 | Val  Acc: 0.9730
 Site-SVHN                      (2) | Val  Loss: 0.4282 | Val  Acc: 0.9189
Average Valid Accuracy: 0.9216
 Test site-MNIST                     (3)| Epoch:48 | Test Acc: 0.8907
 Test site-USPS                      (0)| Epoch:48 | Test Acc: 0.9086
 Test site-SynthDigits               (0)| Epoch:48 | Test Acc: 0.8585
 Test site-MNIST_M                   (1)| Epoch:48 | Test Acc: 0.6814
 Test site-SVHN                      (2)| Epoch:48 | Test Acc: 0.6196
MNIST: 0.8907, USPS: 0.9086, SynthDigits: 0.8585, MNIST_M: 0.6814, SVHN: 0.6196, 
Average Test Accuracy(group): 0.7918, Average Test Accuracy(individual): 0.7918,
domain std=0.1181, cluster std=0.1203, individual std=0.1181, 
Average Test Accuracy: 0.7918
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_clscon_distinct/ccop_q=1...
===2023-07-03 21:11:21===
===2023-07-03 21:11:22===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8907
 Test site-USPS                      | Epoch:49 | Test Acc: 0.9086
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.8585
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.6814
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.6196
MNIST: 0.8907, USPS: 0.9086, SynthDigits: 0.8585, MNIST_M: 0.6814, SVHN: 0.6196, 
Average Test Accuracy(group): 0.7918, Average Test Accuracy(individual): 0.7918,
domain std=0.1181, cluster std=-1.0000, individual std=0.1181, 
