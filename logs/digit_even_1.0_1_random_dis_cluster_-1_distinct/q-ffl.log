===2023-07-02 23:25:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
denominator: 13626.2666015625
 Site-MNIST                         | Train Loss: 2.2396 | Train Acc: 0.2669
 Site-USPS                          | Train Loss: 2.2458 | Train Acc: 0.2601
 Site-SynthDigits                   | Train Loss: 2.2832 | Train Acc: 0.1453
 Site-MNIST_M                       | Train Loss: 2.2893 | Train Acc: 0.1453
 Site-SVHN                          | Train Loss: 2.2729 | Train Acc: 0.1757
Average Train Accuracy: 0.1986
 Site-MNIST                         | Val  Loss: 2.2183 | Val  Acc: 0.2838
 Site-USPS                          | Val  Loss: 2.2542 | Val  Acc: 0.2432
 Site-SynthDigits                   | Val  Loss: 2.3103 | Val  Acc: 0.1892
 Site-MNIST_M                       | Val  Loss: 2.2738 | Val  Acc: 0.1486
 Site-SVHN                          | Val  Loss: 2.2627 | Val  Acc: 0.1757
Average Valid Accuracy: 0.2081
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.2838
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2432
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1892
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 1 ============
denominator: 13473.615234375
 Site-MNIST                         | Train Loss: 2.1786 | Train Acc: 0.4730
 Site-USPS                          | Train Loss: 2.1817 | Train Acc: 0.4088
 Site-SynthDigits                   | Train Loss: 2.2660 | Train Acc: 0.2061
 Site-MNIST_M                       | Train Loss: 2.2718 | Train Acc: 0.1791
 Site-SVHN                          | Train Loss: 2.2558 | Train Acc: 0.2196
Average Train Accuracy: 0.2973
 Site-MNIST                         | Val  Loss: 2.1441 | Val  Acc: 0.5811
 Site-USPS                          | Val  Loss: 2.2013 | Val  Acc: 0.3514
 Site-SynthDigits                   | Val  Loss: 2.2942 | Val  Acc: 0.2162
 Site-MNIST_M                       | Val  Loss: 2.2472 | Val  Acc: 0.1757
 Site-SVHN                          | Val  Loss: 2.2436 | Val  Acc: 0.2432
Average Valid Accuracy: 0.3135
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5811
 Best site-USPS                      | Epoch:1 | Val Acc: 0.3514
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2162
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1757
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 2 ============
denominator: 13281.763671875
 Site-MNIST                         | Train Loss: 2.1260 | Train Acc: 0.5811
 Site-USPS                          | Train Loss: 2.1286 | Train Acc: 0.5574
 Site-SynthDigits                   | Train Loss: 2.2409 | Train Acc: 0.2568
 Site-MNIST_M                       | Train Loss: 2.2557 | Train Acc: 0.1959
 Site-SVHN                          | Train Loss: 2.2405 | Train Acc: 0.2466
Average Train Accuracy: 0.3676
 Site-MNIST                         | Val  Loss: 2.0760 | Val  Acc: 0.6757
 Site-USPS                          | Val  Loss: 2.1526 | Val  Acc: 0.4730
 Site-SynthDigits                   | Val  Loss: 2.2663 | Val  Acc: 0.2838
 Site-MNIST_M                       | Val  Loss: 2.2256 | Val  Acc: 0.2162
 Site-SVHN                          | Val  Loss: 2.2300 | Val  Acc: 0.2703
Average Valid Accuracy: 0.3838
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6757
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4730
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2838
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2162
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 3 ============
denominator: 13067.05078125
 Site-MNIST                         | Train Loss: 2.0666 | Train Acc: 0.5912
 Site-USPS                          | Train Loss: 2.0668 | Train Acc: 0.5845
 Site-SynthDigits                   | Train Loss: 2.2150 | Train Acc: 0.3074
 Site-MNIST_M                       | Train Loss: 2.2371 | Train Acc: 0.2162
 Site-SVHN                          | Train Loss: 2.2269 | Train Acc: 0.2568
Average Train Accuracy: 0.3912
 Site-MNIST                         | Val  Loss: 2.0120 | Val  Acc: 0.6757
 Site-USPS                          | Val  Loss: 2.1002 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 2.2348 | Val  Acc: 0.2703
 Site-MNIST_M                       | Val  Loss: 2.2045 | Val  Acc: 0.2568
 Site-SVHN                          | Val  Loss: 2.2209 | Val  Acc: 0.2838
Average Valid Accuracy: 0.4054
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6757
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2703
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2568
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 4 ============
denominator: 12889.5986328125
 Site-MNIST                         | Train Loss: 2.0144 | Train Acc: 0.6182
 Site-USPS                          | Train Loss: 1.9989 | Train Acc: 0.6216
 Site-SynthDigits                   | Train Loss: 2.1895 | Train Acc: 0.3412
 Site-MNIST_M                       | Train Loss: 2.2165 | Train Acc: 0.2601
 Site-SVHN                          | Train Loss: 2.2167 | Train Acc: 0.2601
Average Train Accuracy: 0.4203
 Site-MNIST                         | Val  Loss: 1.9454 | Val  Acc: 0.7162
 Site-USPS                          | Val  Loss: 2.0422 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 2.2075 | Val  Acc: 0.3243
 Site-MNIST_M                       | Val  Loss: 2.1860 | Val  Acc: 0.2973
 Site-SVHN                          | Val  Loss: 2.2102 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4405
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7162
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3243
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2973
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 5 ============
denominator: 12754.892578125
 Site-MNIST                         | Train Loss: 1.9672 | Train Acc: 0.6453
 Site-USPS                          | Train Loss: 1.9296 | Train Acc: 0.6554
 Site-SynthDigits                   | Train Loss: 2.1676 | Train Acc: 0.3446
 Site-MNIST_M                       | Train Loss: 2.1997 | Train Acc: 0.2770
 Site-SVHN                          | Train Loss: 2.1981 | Train Acc: 0.2635
Average Train Accuracy: 0.4372
 Site-MNIST                         | Val  Loss: 1.8859 | Val  Acc: 0.7027
 Site-USPS                          | Val  Loss: 1.9720 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 2.1815 | Val  Acc: 0.3243
 Site-MNIST_M                       | Val  Loss: 2.1627 | Val  Acc: 0.3108
 Site-SVHN                          | Val  Loss: 2.1937 | Val  Acc: 0.3243
Average Valid Accuracy: 0.4514
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7027
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5946
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3243
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3108
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 6 ============
denominator: 12524.2958984375
 Site-MNIST                         | Train Loss: 1.9024 | Train Acc: 0.6588
 Site-USPS                          | Train Loss: 1.8743 | Train Acc: 0.6622
 Site-SynthDigits                   | Train Loss: 2.1419 | Train Acc: 0.3581
 Site-MNIST_M                       | Train Loss: 2.1866 | Train Acc: 0.2939
 Site-SVHN                          | Train Loss: 2.1898 | Train Acc: 0.2703
Average Train Accuracy: 0.4486
 Site-MNIST                         | Val  Loss: 1.8189 | Val  Acc: 0.7162
 Site-USPS                          | Val  Loss: 1.9218 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 2.1610 | Val  Acc: 0.3243
 Site-MNIST_M                       | Val  Loss: 2.1461 | Val  Acc: 0.3243
 Site-SVHN                          | Val  Loss: 2.1812 | Val  Acc: 0.3378
Average Valid Accuracy: 0.4649
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7162
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6216
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3243
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3243
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 7 ============
denominator: 12382.70703125
 Site-MNIST                         | Train Loss: 1.8515 | Train Acc: 0.6791
 Site-USPS                          | Train Loss: 1.8259 | Train Acc: 0.6723
 Site-SynthDigits                   | Train Loss: 2.1107 | Train Acc: 0.3986
 Site-MNIST_M                       | Train Loss: 2.1717 | Train Acc: 0.3007
 Site-SVHN                          | Train Loss: 2.1746 | Train Acc: 0.2838
Average Train Accuracy: 0.4669
 Site-MNIST                         | Val  Loss: 1.7616 | Val  Acc: 0.7432
 Site-USPS                          | Val  Loss: 1.8785 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 2.1350 | Val  Acc: 0.3649
 Site-MNIST_M                       | Val  Loss: 2.1333 | Val  Acc: 0.3514
 Site-SVHN                          | Val  Loss: 2.1686 | Val  Acc: 0.3378
Average Valid Accuracy: 0.4892
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7432
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3649
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3514
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 8 ============
denominator: 12218.55078125
 Site-MNIST                         | Train Loss: 1.7946 | Train Acc: 0.6791
 Site-USPS                          | Train Loss: 1.7648 | Train Acc: 0.6824
 Site-SynthDigits                   | Train Loss: 2.0916 | Train Acc: 0.4155
 Site-MNIST_M                       | Train Loss: 2.1548 | Train Acc: 0.3277
 Site-SVHN                          | Train Loss: 2.1591 | Train Acc: 0.2838
Average Train Accuracy: 0.4777
 Site-MNIST                         | Val  Loss: 1.6954 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.8264 | Val  Acc: 0.6892
 Site-SynthDigits                   | Val  Loss: 2.1116 | Val  Acc: 0.3784
 Site-MNIST_M                       | Val  Loss: 2.1178 | Val  Acc: 0.3514
 Site-SVHN                          | Val  Loss: 2.1551 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5054
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:8 | Val Acc: 0.6892
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3784
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3514
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 9 ============
denominator: 12038.06640625
 Site-MNIST                         | Train Loss: 1.7527 | Train Acc: 0.6824
 Site-USPS                          | Train Loss: 1.7013 | Train Acc: 0.7095
 Site-SynthDigits                   | Train Loss: 2.0666 | Train Acc: 0.4459
 Site-MNIST_M                       | Train Loss: 2.1410 | Train Acc: 0.3480
 Site-SVHN                          | Train Loss: 2.1491 | Train Acc: 0.2973
Average Train Accuracy: 0.4966
 Site-MNIST                         | Val  Loss: 1.6536 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.7570 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 2.0835 | Val  Acc: 0.4189
 Site-MNIST_M                       | Val  Loss: 2.0941 | Val  Acc: 0.4054
 Site-SVHN                          | Val  Loss: 2.1420 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5297
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7568
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7162
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4189
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4054
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 10 ============
denominator: 11916.0693359375
 Site-MNIST                         | Train Loss: 1.6957 | Train Acc: 0.6959
 Site-USPS                          | Train Loss: 1.6621 | Train Acc: 0.6926
 Site-SynthDigits                   | Train Loss: 2.0379 | Train Acc: 0.4865
 Site-MNIST_M                       | Train Loss: 2.1249 | Train Acc: 0.3682
 Site-SVHN                          | Train Loss: 2.1415 | Train Acc: 0.2939
Average Train Accuracy: 0.5074
 Site-MNIST                         | Val  Loss: 1.5919 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.7280 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 2.0552 | Val  Acc: 0.4324
 Site-MNIST_M                       | Val  Loss: 2.0814 | Val  Acc: 0.4054
 Site-SVHN                          | Val  Loss: 2.1291 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5351
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4324
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4054
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 11 ============
denominator: 11724.40625
 Site-MNIST                         | Train Loss: 1.6572 | Train Acc: 0.7095
 Site-USPS                          | Train Loss: 1.5983 | Train Acc: 0.7196
 Site-SynthDigits                   | Train Loss: 2.0182 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 2.1099 | Train Acc: 0.3784
 Site-SVHN                          | Train Loss: 2.1193 | Train Acc: 0.2939
Average Train Accuracy: 0.5203
 Site-MNIST                         | Val  Loss: 1.5435 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.6663 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 2.0316 | Val  Acc: 0.4324
 Site-MNIST_M                       | Val  Loss: 2.0628 | Val  Acc: 0.4459
 Site-SVHN                          | Val  Loss: 2.1162 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5378
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4324
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4459
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 12 ============
denominator: 11559.9462890625
 Site-MNIST                         | Train Loss: 1.6141 | Train Acc: 0.7297
 Site-USPS                          | Train Loss: 1.5473 | Train Acc: 0.7534
 Site-SynthDigits                   | Train Loss: 1.9827 | Train Acc: 0.5203
 Site-MNIST_M                       | Train Loss: 2.0931 | Train Acc: 0.3885
 Site-SVHN                          | Train Loss: 2.1170 | Train Acc: 0.3007
Average Train Accuracy: 0.5385
 Site-MNIST                         | Val  Loss: 1.4967 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.6116 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.9983 | Val  Acc: 0.4730
 Site-MNIST_M                       | Val  Loss: 2.0495 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.1071 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5486
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4730
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4324
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 13 ============
denominator: 11404.33203125
 Site-MNIST                         | Train Loss: 1.5698 | Train Acc: 0.7399
 Site-USPS                          | Train Loss: 1.5102 | Train Acc: 0.7500
 Site-SynthDigits                   | Train Loss: 1.9634 | Train Acc: 0.5236
 Site-MNIST_M                       | Train Loss: 2.0822 | Train Acc: 0.3851
 Site-SVHN                          | Train Loss: 2.1095 | Train Acc: 0.3142
Average Train Accuracy: 0.5426
 Site-MNIST                         | Val  Loss: 1.4509 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.5748 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.9767 | Val  Acc: 0.4595
 Site-MNIST_M                       | Val  Loss: 2.0310 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 2.0942 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5568
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4595
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 14 ============
denominator: 11247.2529296875
 Site-MNIST                         | Train Loss: 1.5203 | Train Acc: 0.7331
 Site-USPS                          | Train Loss: 1.4557 | Train Acc: 0.7568
 Site-SynthDigits                   | Train Loss: 1.9336 | Train Acc: 0.5236
 Site-MNIST_M                       | Train Loss: 2.0664 | Train Acc: 0.3919
 Site-SVHN                          | Train Loss: 2.0904 | Train Acc: 0.2973
Average Train Accuracy: 0.5405
 Site-MNIST                         | Val  Loss: 1.4024 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.5285 | Val  Acc: 0.7432
 Site-SynthDigits                   | Val  Loss: 1.9500 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 2.0167 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 2.0798 | Val  Acc: 0.3108
Average Valid Accuracy: 0.5568
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7432
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 15 ============
denominator: 11150.2333984375
 Site-MNIST                         | Train Loss: 1.4791 | Train Acc: 0.7500
 Site-USPS                          | Train Loss: 1.4042 | Train Acc: 0.7635
 Site-SynthDigits                   | Train Loss: 1.9092 | Train Acc: 0.5338
 Site-MNIST_M                       | Train Loss: 2.0493 | Train Acc: 0.4054
 Site-SVHN                          | Train Loss: 2.0816 | Train Acc: 0.3041
Average Train Accuracy: 0.5514
 Site-MNIST                         | Val  Loss: 1.3602 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.4707 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 1.9254 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 2.0006 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 2.0684 | Val  Acc: 0.2973
Average Valid Accuracy: 0.5541
============ Train epoch 16 ============
denominator: 11007.376953125
 Site-MNIST                         | Train Loss: 1.4477 | Train Acc: 0.7500
 Site-USPS                          | Train Loss: 1.3494 | Train Acc: 0.7669
 Site-SynthDigits                   | Train Loss: 1.8863 | Train Acc: 0.5135
 Site-MNIST_M                       | Train Loss: 2.0292 | Train Acc: 0.3953
 Site-SVHN                          | Train Loss: 2.0598 | Train Acc: 0.3176
Average Train Accuracy: 0.5486
 Site-MNIST                         | Val  Loss: 1.3090 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.4333 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 1.8985 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.9740 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.0562 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5676
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7162
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 17 ============
denominator: 10868.26171875
 Site-MNIST                         | Train Loss: 1.4060 | Train Acc: 0.7500
 Site-USPS                          | Train Loss: 1.3091 | Train Acc: 0.7601
 Site-SynthDigits                   | Train Loss: 1.8597 | Train Acc: 0.5236
 Site-MNIST_M                       | Train Loss: 2.0162 | Train Acc: 0.4054
 Site-SVHN                          | Train Loss: 2.0546 | Train Acc: 0.3277
Average Train Accuracy: 0.5534
 Site-MNIST                         | Val  Loss: 1.2651 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.4004 | Val  Acc: 0.7162
 Site-SynthDigits                   | Val  Loss: 1.8789 | Val  Acc: 0.5135
 Site-MNIST_M                       | Val  Loss: 1.9679 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 2.0430 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5703
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7162
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5135
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 18 ============
denominator: 10683.4638671875
 Site-MNIST                         | Train Loss: 1.3606 | Train Acc: 0.7568
 Site-USPS                          | Train Loss: 1.2641 | Train Acc: 0.7838
 Site-SynthDigits                   | Train Loss: 1.8386 | Train Acc: 0.5203
 Site-MNIST_M                       | Train Loss: 1.9984 | Train Acc: 0.3953
 Site-SVHN                          | Train Loss: 2.0465 | Train Acc: 0.3277
Average Train Accuracy: 0.5568
 Site-MNIST                         | Val  Loss: 1.2288 | Val  Acc: 0.7568
 Site-USPS                          | Val  Loss: 1.3547 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.8515 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.9569 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 2.0356 | Val  Acc: 0.3243
Average Valid Accuracy: 0.5703
============ Train epoch 19 ============
denominator: 10609.2900390625
 Site-MNIST                         | Train Loss: 1.3285 | Train Acc: 0.7703
 Site-USPS                          | Train Loss: 1.2300 | Train Acc: 0.7939
 Site-SynthDigits                   | Train Loss: 1.8015 | Train Acc: 0.5169
 Site-MNIST_M                       | Train Loss: 1.9808 | Train Acc: 0.3953
 Site-SVHN                          | Train Loss: 2.0310 | Train Acc: 0.3446
Average Train Accuracy: 0.5642
 Site-MNIST                         | Val  Loss: 1.1977 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.3094 | Val  Acc: 0.7703
 Site-SynthDigits                   | Val  Loss: 1.8168 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.9343 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.0306 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5703
============ Train epoch 20 ============
denominator: 10414.4365234375
 Site-MNIST                         | Train Loss: 1.2800 | Train Acc: 0.7905
 Site-USPS                          | Train Loss: 1.1688 | Train Acc: 0.8007
 Site-SynthDigits                   | Train Loss: 1.7881 | Train Acc: 0.5541
 Site-MNIST_M                       | Train Loss: 1.9702 | Train Acc: 0.4392
 Site-SVHN                          | Train Loss: 2.0265 | Train Acc: 0.3345
Average Train Accuracy: 0.5838
 Site-MNIST                         | Val  Loss: 1.1574 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.2656 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.8046 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.9052 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 2.0115 | Val  Acc: 0.3514
Average Valid Accuracy: 0.6000
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:20 | Val Acc: 0.7838
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 21 ============
denominator: 10335.87890625
 Site-MNIST                         | Train Loss: 1.2561 | Train Acc: 0.7973
 Site-USPS                          | Train Loss: 1.1388 | Train Acc: 0.8243
 Site-SynthDigits                   | Train Loss: 1.7588 | Train Acc: 0.5574
 Site-MNIST_M                       | Train Loss: 1.9482 | Train Acc: 0.4054
 Site-SVHN                          | Train Loss: 2.0124 | Train Acc: 0.3446
Average Train Accuracy: 0.5858
 Site-MNIST                         | Val  Loss: 1.1265 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.2229 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.7674 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.8967 | Val  Acc: 0.4324
 Site-SVHN                          | Val  Loss: 2.0016 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5973
============ Train epoch 22 ============
denominator: 10163.998046875
 Site-MNIST                         | Train Loss: 1.2123 | Train Acc: 0.8041
 Site-USPS                          | Train Loss: 1.1201 | Train Acc: 0.8277
 Site-SynthDigits                   | Train Loss: 1.7378 | Train Acc: 0.5642
 Site-MNIST_M                       | Train Loss: 1.9241 | Train Acc: 0.4527
 Site-SVHN                          | Train Loss: 1.9940 | Train Acc: 0.3311
Average Train Accuracy: 0.5959
 Site-MNIST                         | Val  Loss: 1.0830 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 1.1942 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.7435 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.8719 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9895 | Val  Acc: 0.3514
Average Valid Accuracy: 0.6108
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8243
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 23 ============
denominator: 10001.2333984375
 Site-MNIST                         | Train Loss: 1.1640 | Train Acc: 0.8108
 Site-USPS                          | Train Loss: 1.0633 | Train Acc: 0.8277
 Site-SynthDigits                   | Train Loss: 1.7172 | Train Acc: 0.5608
 Site-MNIST_M                       | Train Loss: 1.8994 | Train Acc: 0.4797
 Site-SVHN                          | Train Loss: 1.9808 | Train Acc: 0.3277
Average Train Accuracy: 0.6014
 Site-MNIST                         | Val  Loss: 1.0476 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 1.1506 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.7417 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.8548 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.9788 | Val  Acc: 0.3514
Average Valid Accuracy: 0.6162
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 24 ============
denominator: 9891.07421875
 Site-MNIST                         | Train Loss: 1.1258 | Train Acc: 0.8311
 Site-USPS                          | Train Loss: 1.0380 | Train Acc: 0.8277
 Site-SynthDigits                   | Train Loss: 1.6967 | Train Acc: 0.5743
 Site-MNIST_M                       | Train Loss: 1.8893 | Train Acc: 0.4831
 Site-SVHN                          | Train Loss: 1.9705 | Train Acc: 0.3345
Average Train Accuracy: 0.6101
 Site-MNIST                         | Val  Loss: 1.0170 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 1.1235 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.7196 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.8442 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.9659 | Val  Acc: 0.3649
Average Valid Accuracy: 0.6297
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6216
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 25 ============
denominator: 9810.255859375
 Site-MNIST                         | Train Loss: 1.1201 | Train Acc: 0.8108
 Site-USPS                          | Train Loss: 1.0046 | Train Acc: 0.8209
 Site-SynthDigits                   | Train Loss: 1.6952 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.8607 | Train Acc: 0.4865
 Site-SVHN                          | Train Loss: 1.9642 | Train Acc: 0.3311
Average Train Accuracy: 0.6061
 Site-MNIST                         | Val  Loss: 1.0082 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 1.0826 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.7219 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.8319 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.9601 | Val  Acc: 0.3649
Average Valid Accuracy: 0.6216
============ Train epoch 26 ============
denominator: 9732.51953125
 Site-MNIST                         | Train Loss: 1.0738 | Train Acc: 0.8243
 Site-USPS                          | Train Loss: 1.0232 | Train Acc: 0.8176
 Site-SynthDigits                   | Train Loss: 1.6492 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.8466 | Train Acc: 0.4730
 Site-SVHN                          | Train Loss: 1.9543 | Train Acc: 0.3581
Average Train Accuracy: 0.6108
 Site-MNIST                         | Val  Loss: 0.9745 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 1.0935 | Val  Acc: 0.7973
 Site-SynthDigits                   | Val  Loss: 1.6503 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.8505 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.9649 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6162
============ Train epoch 27 ============
denominator: 9533.3232421875
 Site-MNIST                         | Train Loss: 1.0418 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.9516 | Train Acc: 0.8480
 Site-SynthDigits                   | Train Loss: 1.6176 | Train Acc: 0.5743
 Site-MNIST_M                       | Train Loss: 1.8345 | Train Acc: 0.4932
 Site-SVHN                          | Train Loss: 1.9414 | Train Acc: 0.3615
Average Train Accuracy: 0.6236
 Site-MNIST                         | Val  Loss: 0.9448 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 1.0242 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.6389 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.8298 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.9669 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6459
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6081
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5405
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 28 ============
denominator: 9434.337890625
 Site-MNIST                         | Train Loss: 1.0161 | Train Acc: 0.8480
 Site-USPS                          | Train Loss: 0.9134 | Train Acc: 0.8412
 Site-SynthDigits                   | Train Loss: 1.6216 | Train Acc: 0.5608
 Site-MNIST_M                       | Train Loss: 1.8061 | Train Acc: 0.5034
 Site-SVHN                          | Train Loss: 1.9353 | Train Acc: 0.3547
Average Train Accuracy: 0.6216
 Site-MNIST                         | Val  Loss: 0.9277 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.9882 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6224 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.8153 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.9499 | Val  Acc: 0.3514
Average Valid Accuracy: 0.6162
============ Train epoch 29 ============
denominator: 9300.5537109375
 Site-MNIST                         | Train Loss: 0.9872 | Train Acc: 0.8480
 Site-USPS                          | Train Loss: 0.8850 | Train Acc: 0.8412
 Site-SynthDigits                   | Train Loss: 1.5913 | Train Acc: 0.5811
 Site-MNIST_M                       | Train Loss: 1.7899 | Train Acc: 0.5101
 Site-SVHN                          | Train Loss: 1.9160 | Train Acc: 0.3581
Average Train Accuracy: 0.6277
 Site-MNIST                         | Val  Loss: 0.9006 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.9620 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6145 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.7864 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.9393 | Val  Acc: 0.3649
Average Valid Accuracy: 0.6270
============ Train epoch 30 ============
denominator: 9244.912109375
 Site-MNIST                         | Train Loss: 0.9589 | Train Acc: 0.8480
 Site-USPS                          | Train Loss: 0.8553 | Train Acc: 0.8547
 Site-SynthDigits                   | Train Loss: 1.5683 | Train Acc: 0.5777
 Site-MNIST_M                       | Train Loss: 1.7739 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 1.9121 | Train Acc: 0.3649
Average Train Accuracy: 0.6291
 Site-MNIST                         | Val  Loss: 0.8728 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.9362 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.5886 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.7962 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.9262 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6351
============ Train epoch 31 ============
denominator: 9130.859375
 Site-MNIST                         | Train Loss: 0.9372 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.8012 | Train Acc: 0.8581
 Site-SynthDigits                   | Train Loss: 1.5640 | Train Acc: 0.5709
 Site-MNIST_M                       | Train Loss: 1.7626 | Train Acc: 0.5439
 Site-SVHN                          | Train Loss: 1.9073 | Train Acc: 0.3547
Average Train Accuracy: 0.6345
 Site-MNIST                         | Val  Loss: 0.8515 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.9090 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.5711 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.7477 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.9003 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6378
============ Train epoch 32 ============
denominator: 9011.951171875
 Site-MNIST                         | Train Loss: 0.9092 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.8240 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.5305 | Train Acc: 0.5878
 Site-MNIST_M                       | Train Loss: 1.7497 | Train Acc: 0.5135
 Site-SVHN                          | Train Loss: 1.8919 | Train Acc: 0.3682
Average Train Accuracy: 0.6372
 Site-MNIST                         | Val  Loss: 0.8272 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.8805 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.5374 | Val  Acc: 0.6216
 Site-MNIST_M                       | Val  Loss: 1.7665 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8900 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6378
============ Train epoch 33 ============
denominator: 8997.744140625
 Site-MNIST                         | Train Loss: 0.9090 | Train Acc: 0.8480
 Site-USPS                          | Train Loss: 0.7987 | Train Acc: 0.8615
 Site-SynthDigits                   | Train Loss: 1.5280 | Train Acc: 0.5709
 Site-MNIST_M                       | Train Loss: 1.7473 | Train Acc: 0.5372
 Site-SVHN                          | Train Loss: 1.8860 | Train Acc: 0.3953
Average Train Accuracy: 0.6426
 Site-MNIST                         | Val  Loss: 0.8122 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.8719 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.5328 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.7308 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.9080 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6486
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6081
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5270
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 34 ============
denominator: 8846.4052734375
 Site-MNIST                         | Train Loss: 0.8926 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.7674 | Train Acc: 0.8615
 Site-SynthDigits                   | Train Loss: 1.5066 | Train Acc: 0.6014
 Site-MNIST_M                       | Train Loss: 1.7197 | Train Acc: 0.5068
 Site-SVHN                          | Train Loss: 1.8629 | Train Acc: 0.3818
Average Train Accuracy: 0.6392
 Site-MNIST                         | Val  Loss: 0.7995 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.8360 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.5020 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.7372 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.8648 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6405
============ Train epoch 35 ============
denominator: 8764.056640625
 Site-MNIST                         | Train Loss: 0.8427 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.7335 | Train Acc: 0.8547
 Site-SynthDigits                   | Train Loss: 1.4956 | Train Acc: 0.6014
 Site-MNIST_M                       | Train Loss: 1.6884 | Train Acc: 0.5338
 Site-SVHN                          | Train Loss: 1.8496 | Train Acc: 0.3919
Average Train Accuracy: 0.6453
 Site-MNIST                         | Val  Loss: 0.7783 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 0.8144 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.5056 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.7212 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8866 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6351
============ Train epoch 36 ============
denominator: 8642.021484375
 Site-MNIST                         | Train Loss: 0.8165 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.7242 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.4783 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.6749 | Train Acc: 0.5507
 Site-SVHN                          | Train Loss: 1.8580 | Train Acc: 0.3818
Average Train Accuracy: 0.6534
 Site-MNIST                         | Val  Loss: 0.7716 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.7876 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4854 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.6906 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8464 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6486
============ Train epoch 37 ============
denominator: 8580.88671875
 Site-MNIST                         | Train Loss: 0.8168 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.7177 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.4418 | Train Acc: 0.6149
 Site-MNIST_M                       | Train Loss: 1.6545 | Train Acc: 0.5507
 Site-SVHN                          | Train Loss: 1.8445 | Train Acc: 0.4054
Average Train Accuracy: 0.6601
 Site-MNIST                         | Val  Loss: 0.7615 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.7609 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.4570 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.6747 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.8418 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6676
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6486
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5270
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 38 ============
denominator: 8482.43359375
 Site-MNIST                         | Train Loss: 0.8205 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.7012 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.4364 | Train Acc: 0.5946
 Site-MNIST_M                       | Train Loss: 1.6406 | Train Acc: 0.5473
 Site-SVHN                          | Train Loss: 1.8313 | Train Acc: 0.3919
Average Train Accuracy: 0.6507
 Site-MNIST                         | Val  Loss: 0.7677 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.7486 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.4290 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.6721 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.8170 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6649
============ Train epoch 39 ============
denominator: 8433.330078125
 Site-MNIST                         | Train Loss: 0.7740 | Train Acc: 0.8649
 Site-USPS                          | Train Loss: 0.6642 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.4679 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.6530 | Train Acc: 0.5574
 Site-SVHN                          | Train Loss: 1.8248 | Train Acc: 0.4054
Average Train Accuracy: 0.6615
 Site-MNIST                         | Val  Loss: 0.7123 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.7429 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4801 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.6366 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8492 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6595
============ Train epoch 40 ============
denominator: 8377.1474609375
 Site-MNIST                         | Train Loss: 0.7744 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.6546 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.4108 | Train Acc: 0.6115
 Site-MNIST_M                       | Train Loss: 1.6220 | Train Acc: 0.5507
 Site-SVHN                          | Train Loss: 1.8180 | Train Acc: 0.4020
Average Train Accuracy: 0.6561
 Site-MNIST                         | Val  Loss: 0.7363 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.7016 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.3883 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.6416 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.7873 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6595
============ Train epoch 41 ============
denominator: 8245.630859375
 Site-MNIST                         | Train Loss: 0.7259 | Train Acc: 0.8919
 Site-USPS                          | Train Loss: 0.6412 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.4216 | Train Acc: 0.6081
 Site-MNIST_M                       | Train Loss: 1.6148 | Train Acc: 0.5642
 Site-SVHN                          | Train Loss: 1.7975 | Train Acc: 0.4223
Average Train Accuracy: 0.6723
 Site-MNIST                         | Val  Loss: 0.6692 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.7152 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4559 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.6126 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.8179 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6676
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6486
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5135
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 42 ============
denominator: 8195.68359375
 Site-MNIST                         | Train Loss: 0.7423 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.6050 | Train Acc: 0.8784
 Site-SynthDigits                   | Train Loss: 1.4065 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.5871 | Train Acc: 0.5608
 Site-SVHN                          | Train Loss: 1.7989 | Train Acc: 0.4257
Average Train Accuracy: 0.6689
 Site-MNIST                         | Val  Loss: 0.6903 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.6644 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.4038 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.6075 | Val  Acc: 0.5135
 Site-SVHN                          | Val  Loss: 1.7815 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6676
============ Train epoch 43 ============
denominator: 8168.96875
 Site-MNIST                         | Train Loss: 0.6886 | Train Acc: 0.8885
 Site-USPS                          | Train Loss: 0.5984 | Train Acc: 0.8953
 Site-SynthDigits                   | Train Loss: 1.3762 | Train Acc: 0.6385
 Site-MNIST_M                       | Train Loss: 1.5805 | Train Acc: 0.5642
 Site-SVHN                          | Train Loss: 1.7953 | Train Acc: 0.4223
Average Train Accuracy: 0.6818
 Site-MNIST                         | Val  Loss: 0.6560 | Val  Acc: 0.8784
 Site-USPS                          | Val  Loss: 0.6626 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.3950 | Val  Acc: 0.7027
 Site-MNIST_M                       | Val  Loss: 1.6060 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.7718 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6973
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8784
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9189
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7027
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
============ Train epoch 44 ============
denominator: 8047.583984375
 Site-MNIST                         | Train Loss: 0.6906 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.5915 | Train Acc: 0.8919
 Site-SynthDigits                   | Train Loss: 1.3669 | Train Acc: 0.6385
 Site-MNIST_M                       | Train Loss: 1.5568 | Train Acc: 0.5743
 Site-SVHN                          | Train Loss: 1.7834 | Train Acc: 0.4189
Average Train Accuracy: 0.6797
 Site-MNIST                         | Val  Loss: 0.6688 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6353 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.3574 | Val  Acc: 0.6892
 Site-MNIST_M                       | Val  Loss: 1.5893 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.7480 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6865
============ Train epoch 45 ============
denominator: 7977.4345703125
 Site-MNIST                         | Train Loss: 0.6580 | Train Acc: 0.8885
 Site-USPS                          | Train Loss: 0.5846 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.3554 | Train Acc: 0.6351
 Site-MNIST_M                       | Train Loss: 1.5482 | Train Acc: 0.5980
 Site-SVHN                          | Train Loss: 1.7705 | Train Acc: 0.4358
Average Train Accuracy: 0.6892
 Site-MNIST                         | Val  Loss: 0.6347 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.6378 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.3876 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.5739 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.7406 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6865
============ Train epoch 46 ============
denominator: 7936.5244140625
 Site-MNIST                         | Train Loss: 0.6614 | Train Acc: 0.8716
 Site-USPS                          | Train Loss: 0.5725 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.3364 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.5240 | Train Acc: 0.5946
 Site-SVHN                          | Train Loss: 1.7655 | Train Acc: 0.4257
Average Train Accuracy: 0.6818
 Site-MNIST                         | Val  Loss: 0.6452 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 0.6094 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.3598 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.5842 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.7444 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6865
============ Train epoch 47 ============
denominator: 7855.57861328125
 Site-MNIST                         | Train Loss: 0.6302 | Train Acc: 0.8885
 Site-USPS                          | Train Loss: 0.5538 | Train Acc: 0.8953
 Site-SynthDigits                   | Train Loss: 1.3607 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.5204 | Train Acc: 0.6014
 Site-SVHN                          | Train Loss: 1.7530 | Train Acc: 0.4358
Average Train Accuracy: 0.6899
 Site-MNIST                         | Val  Loss: 0.6148 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.6245 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.3935 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.5738 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.7469 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6919
============ Train epoch 48 ============
denominator: 7799.1162109375
 Site-MNIST                         | Train Loss: 0.6346 | Train Acc: 0.8818
 Site-USPS                          | Train Loss: 0.5414 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.3321 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.4900 | Train Acc: 0.6047
 Site-SVHN                          | Train Loss: 1.7464 | Train Acc: 0.4324
Average Train Accuracy: 0.6899
 Site-MNIST                         | Val  Loss: 0.6269 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.5877 | Val  Acc: 0.9189
 Site-SynthDigits                   | Val  Loss: 1.3239 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.5427 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7190 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6946
============ Train epoch 49 ============
denominator: 7766.6064453125
 Site-MNIST                         | Train Loss: 0.6107 | Train Acc: 0.8885
 Site-USPS                          | Train Loss: 0.5277 | Train Acc: 0.9054
 Site-SynthDigits                   | Train Loss: 1.3218 | Train Acc: 0.6351
 Site-MNIST_M                       | Train Loss: 1.4691 | Train Acc: 0.6318
 Site-SVHN                          | Train Loss: 1.7434 | Train Acc: 0.4291
Average Train Accuracy: 0.6980
 Site-MNIST                         | Val  Loss: 0.5921 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.5809 | Val  Acc: 0.9324
 Site-SynthDigits                   | Val  Loss: 1.3378 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.5214 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.7258 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7054
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9324
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6622
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.5946
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/q-ffl...
===2023-07-03 00:01:08===
===2023-07-03 00:01:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8050
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8763
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.5525
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.3929
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2992
MNIST: 0.8050, USPS: 0.8763, SynthDigits: 0.5525, MNIST_M: 0.3929, SVHN: 0.2992, 
Average Test Accuracy(group): 0.5852, Average Test Accuracy(individual): 0.5852,
domain std=0.2249, cluster std=-1.0000, individual std=0.2249, 
