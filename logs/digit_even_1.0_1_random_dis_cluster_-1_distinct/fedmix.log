===2023-07-03 02:28:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
===2023-07-03 02:28:15===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
===2023-07-03 07:58:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.1841 | Train Acc: 0.3716
 Site-USPS                          | Train Loss: 2.1723 | Train Acc: 0.4797
 Site-SynthDigits                   | Train Loss: 2.2645 | Train Acc: 0.2365
 Site-MNIST_M                       | Train Loss: 2.2894 | Train Acc: 0.1520
 Site-SVHN                          | Train Loss: 2.2563 | Train Acc: 0.1723
Average Train Accuracy: 0.2824
 Site-MNIST                         | Val  Loss: 2.1575 | Val  Acc: 0.4324
 Site-USPS                          | Val  Loss: 2.1897 | Val  Acc: 0.4324
 Site-SynthDigits                   | Val  Loss: 2.2793 | Val  Acc: 0.2027
 Site-MNIST_M                       | Val  Loss: 2.2998 | Val  Acc: 0.1757
 Site-SVHN                          | Val  Loss: 2.2735 | Val  Acc: 0.1622
Average Valid Accuracy: 0.2811
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4324
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4324
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2027
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1757
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 2.0748 | Train Acc: 0.5101
 Site-USPS                          | Train Loss: 2.0443 | Train Acc: 0.5270
 Site-SynthDigits                   | Train Loss: 2.2286 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.2521 | Train Acc: 0.2095
 Site-SVHN                          | Train Loss: 2.2371 | Train Acc: 0.2061
Average Train Accuracy: 0.3412
 Site-MNIST                         | Val  Loss: 2.0316 | Val  Acc: 0.6216
 Site-USPS                          | Val  Loss: 2.0793 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 2.2652 | Val  Acc: 0.1757
 Site-MNIST_M                       | Val  Loss: 2.2573 | Val  Acc: 0.2568
 Site-SVHN                          | Val  Loss: 2.2502 | Val  Acc: 0.1892
Average Valid Accuracy: 0.3486
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6216
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1757
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2568
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.9680 | Train Acc: 0.5236
 Site-USPS                          | Train Loss: 1.9470 | Train Acc: 0.5743
 Site-SynthDigits                   | Train Loss: 2.1981 | Train Acc: 0.3243
 Site-MNIST_M                       | Train Loss: 2.2296 | Train Acc: 0.2770
 Site-SVHN                          | Train Loss: 2.2114 | Train Acc: 0.2095
Average Train Accuracy: 0.3818
 Site-MNIST                         | Val  Loss: 1.9125 | Val  Acc: 0.6216
 Site-USPS                          | Val  Loss: 1.9760 | Val  Acc: 0.5541
 Site-SynthDigits                   | Val  Loss: 2.2245 | Val  Acc: 0.2432
 Site-MNIST_M                       | Val  Loss: 2.2258 | Val  Acc: 0.3108
 Site-SVHN                          | Val  Loss: 2.2345 | Val  Acc: 0.2162
Average Valid Accuracy: 0.3892
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6216
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5541
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2432
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3108
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.8750 | Train Acc: 0.5676
 Site-USPS                          | Train Loss: 1.8298 | Train Acc: 0.6081
 Site-SynthDigits                   | Train Loss: 2.1392 | Train Acc: 0.3716
 Site-MNIST_M                       | Train Loss: 2.1968 | Train Acc: 0.3176
 Site-SVHN                          | Train Loss: 2.1929 | Train Acc: 0.2331
Average Train Accuracy: 0.4196
 Site-MNIST                         | Val  Loss: 1.8012 | Val  Acc: 0.6486
 Site-USPS                          | Val  Loss: 1.8653 | Val  Acc: 0.5541
 Site-SynthDigits                   | Val  Loss: 2.1816 | Val  Acc: 0.2973
 Site-MNIST_M                       | Val  Loss: 2.1870 | Val  Acc: 0.3514
 Site-SVHN                          | Val  Loss: 2.2161 | Val  Acc: 0.2432
Average Valid Accuracy: 0.4189
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6486
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5541
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2973
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3514
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.7763 | Train Acc: 0.6182
 Site-USPS                          | Train Loss: 1.6824 | Train Acc: 0.6520
 Site-SynthDigits                   | Train Loss: 2.1023 | Train Acc: 0.4257
 Site-MNIST_M                       | Train Loss: 2.1728 | Train Acc: 0.3378
 Site-SVHN                          | Train Loss: 2.1686 | Train Acc: 0.2736
Average Train Accuracy: 0.4615
 Site-MNIST                         | Val  Loss: 1.7052 | Val  Acc: 0.7297
 Site-USPS                          | Val  Loss: 1.7637 | Val  Acc: 0.5811
 Site-SynthDigits                   | Val  Loss: 2.1324 | Val  Acc: 0.3514
 Site-MNIST_M                       | Val  Loss: 2.1531 | Val  Acc: 0.3514
 Site-SVHN                          | Val  Loss: 2.1865 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4622
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7297
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5811
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3514
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3514
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.7146 | Train Acc: 0.6520
 Site-USPS                          | Train Loss: 1.6320 | Train Acc: 0.6757
 Site-SynthDigits                   | Train Loss: 2.0589 | Train Acc: 0.4527
 Site-MNIST_M                       | Train Loss: 2.1503 | Train Acc: 0.3412
 Site-SVHN                          | Train Loss: 2.1464 | Train Acc: 0.2838
Average Train Accuracy: 0.4811
 Site-MNIST                         | Val  Loss: 1.6154 | Val  Acc: 0.7297
 Site-USPS                          | Val  Loss: 1.6788 | Val  Acc: 0.6081
 Site-SynthDigits                   | Val  Loss: 2.0844 | Val  Acc: 0.4054
 Site-MNIST_M                       | Val  Loss: 2.1241 | Val  Acc: 0.3514
 Site-SVHN                          | Val  Loss: 2.1708 | Val  Acc: 0.3108
Average Valid Accuracy: 0.4811
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7297
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6081
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4054
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3514
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.6246 | Train Acc: 0.6892
 Site-USPS                          | Train Loss: 1.5338 | Train Acc: 0.6993
 Site-SynthDigits                   | Train Loss: 2.0361 | Train Acc: 0.4764
 Site-MNIST_M                       | Train Loss: 2.1218 | Train Acc: 0.3682
 Site-SVHN                          | Train Loss: 2.1282 | Train Acc: 0.2939
Average Train Accuracy: 0.5054
 Site-MNIST                         | Val  Loss: 1.5261 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.5947 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 2.0492 | Val  Acc: 0.4459
 Site-MNIST_M                       | Val  Loss: 2.0899 | Val  Acc: 0.3919
 Site-SVHN                          | Val  Loss: 2.1489 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5135
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6216
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4459
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3919
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.5585 | Train Acc: 0.6993
 Site-USPS                          | Train Loss: 1.4421 | Train Acc: 0.7264
 Site-SynthDigits                   | Train Loss: 1.9859 | Train Acc: 0.4797
 Site-MNIST_M                       | Train Loss: 2.0994 | Train Acc: 0.3581
 Site-SVHN                          | Train Loss: 2.1252 | Train Acc: 0.2939
Average Train Accuracy: 0.5115
 Site-MNIST                         | Val  Loss: 1.4471 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.5243 | Val  Acc: 0.6622
 Site-SynthDigits                   | Val  Loss: 2.0152 | Val  Acc: 0.4730
 Site-MNIST_M                       | Val  Loss: 2.0632 | Val  Acc: 0.3919
 Site-SVHN                          | Val  Loss: 2.1341 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5297
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6622
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4730
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3919
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.4658 | Train Acc: 0.7095
 Site-USPS                          | Train Loss: 1.3903 | Train Acc: 0.7264
 Site-SynthDigits                   | Train Loss: 1.9540 | Train Acc: 0.4932
 Site-MNIST_M                       | Train Loss: 2.0743 | Train Acc: 0.3851
 Site-SVHN                          | Train Loss: 2.1032 | Train Acc: 0.2939
Average Train Accuracy: 0.5216
 Site-MNIST                         | Val  Loss: 1.3639 | Val  Acc: 0.7297
 Site-USPS                          | Val  Loss: 1.4531 | Val  Acc: 0.6892
 Site-SynthDigits                   | Val  Loss: 1.9808 | Val  Acc: 0.4865
 Site-MNIST_M                       | Val  Loss: 2.0302 | Val  Acc: 0.3784
 Site-SVHN                          | Val  Loss: 2.1178 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5243
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.4025 | Train Acc: 0.7331
 Site-USPS                          | Train Loss: 1.3192 | Train Acc: 0.7297
 Site-SynthDigits                   | Train Loss: 1.9160 | Train Acc: 0.5169
 Site-MNIST_M                       | Train Loss: 2.0544 | Train Acc: 0.3919
 Site-SVHN                          | Train Loss: 2.0788 | Train Acc: 0.3176
Average Train Accuracy: 0.5378
 Site-MNIST                         | Val  Loss: 1.3079 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.4009 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.9283 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 2.0060 | Val  Acc: 0.4459
 Site-SVHN                          | Val  Loss: 2.1059 | Val  Acc: 0.3243
Average Valid Accuracy: 0.5541
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7703
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5270
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4459
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 1.3828 | Train Acc: 0.7365
 Site-USPS                          | Train Loss: 1.2791 | Train Acc: 0.7432
 Site-SynthDigits                   | Train Loss: 1.8712 | Train Acc: 0.4899
 Site-MNIST_M                       | Train Loss: 2.0475 | Train Acc: 0.3750
 Site-SVHN                          | Train Loss: 2.0555 | Train Acc: 0.2973
Average Train Accuracy: 0.5284
 Site-MNIST                         | Val  Loss: 1.2745 | Val  Acc: 0.7703
 Site-USPS                          | Val  Loss: 1.3546 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.8738 | Val  Acc: 0.5135
 Site-MNIST_M                       | Val  Loss: 2.0049 | Val  Acc: 0.3784
 Site-SVHN                          | Val  Loss: 2.0952 | Val  Acc: 0.2973
Average Valid Accuracy: 0.5378
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 1.2987 | Train Acc: 0.7703
 Site-USPS                          | Train Loss: 1.2019 | Train Acc: 0.7736
 Site-SynthDigits                   | Train Loss: 1.8402 | Train Acc: 0.5135
 Site-MNIST_M                       | Train Loss: 1.9880 | Train Acc: 0.4189
 Site-SVHN                          | Train Loss: 2.0494 | Train Acc: 0.2973
Average Train Accuracy: 0.5547
 Site-MNIST                         | Val  Loss: 1.2027 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 1.2702 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.8549 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.9696 | Val  Acc: 0.4459
 Site-SVHN                          | Val  Loss: 2.0741 | Val  Acc: 0.3108
Average Valid Accuracy: 0.5730
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7838
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5270
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4459
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 1.2317 | Train Acc: 0.7669
 Site-USPS                          | Train Loss: 1.1433 | Train Acc: 0.7838
 Site-SynthDigits                   | Train Loss: 1.8006 | Train Acc: 0.5405
 Site-MNIST_M                       | Train Loss: 1.9446 | Train Acc: 0.4054
 Site-SVHN                          | Train Loss: 2.0554 | Train Acc: 0.3041
Average Train Accuracy: 0.5601
 Site-MNIST                         | Val  Loss: 1.1481 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.2150 | Val  Acc: 0.7838
 Site-SynthDigits                   | Val  Loss: 1.8310 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.9424 | Val  Acc: 0.4189
 Site-SVHN                          | Val  Loss: 2.0566 | Val  Acc: 0.3108
Average Valid Accuracy: 0.5703
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 1.2271 | Train Acc: 0.7669
 Site-USPS                          | Train Loss: 1.1265 | Train Acc: 0.7973
 Site-SynthDigits                   | Train Loss: 1.7424 | Train Acc: 0.5473
 Site-MNIST_M                       | Train Loss: 1.9410 | Train Acc: 0.4189
 Site-SVHN                          | Train Loss: 2.0113 | Train Acc: 0.3345
Average Train Accuracy: 0.5730
 Site-MNIST                         | Val  Loss: 1.1127 | Val  Acc: 0.7838
 Site-USPS                          | Val  Loss: 1.1891 | Val  Acc: 0.8108
 Site-SynthDigits                   | Val  Loss: 1.7542 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.9272 | Val  Acc: 0.4054
 Site-SVHN                          | Val  Loss: 2.0603 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5757
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7838
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8108
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5270
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4054
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 1.1451 | Train Acc: 0.8007
 Site-USPS                          | Train Loss: 1.0610 | Train Acc: 0.8142
 Site-SynthDigits                   | Train Loss: 1.7393 | Train Acc: 0.5304
 Site-MNIST_M                       | Train Loss: 1.9196 | Train Acc: 0.4392
 Site-SVHN                          | Train Loss: 2.0055 | Train Acc: 0.3345
Average Train Accuracy: 0.5838
 Site-MNIST                         | Val  Loss: 1.0553 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 1.0904 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.7376 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.8891 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 2.0356 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5946
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5270
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 1.1443 | Train Acc: 0.8074
 Site-USPS                          | Train Loss: 0.9906 | Train Acc: 0.8209
 Site-SynthDigits                   | Train Loss: 1.6927 | Train Acc: 0.5338
 Site-MNIST_M                       | Train Loss: 1.8567 | Train Acc: 0.4696
 Site-SVHN                          | Train Loss: 1.9657 | Train Acc: 0.3209
Average Train Accuracy: 0.5905
 Site-MNIST                         | Val  Loss: 1.0126 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 1.0650 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6951 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.8634 | Val  Acc: 0.4595
 Site-SVHN                          | Val  Loss: 2.0261 | Val  Acc: 0.3784
Average Valid Accuracy: 0.5973
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4595
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 1.0663 | Train Acc: 0.8209
 Site-USPS                          | Train Loss: 0.9719 | Train Acc: 0.8209
 Site-SynthDigits                   | Train Loss: 1.6714 | Train Acc: 0.5405
 Site-MNIST_M                       | Train Loss: 1.8457 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 1.9724 | Train Acc: 0.3378
Average Train Accuracy: 0.6041
 Site-MNIST                         | Val  Loss: 0.9724 | Val  Acc: 0.8108
 Site-USPS                          | Val  Loss: 1.0107 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.6848 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.8144 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9975 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6108
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8108
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8243
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5270
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 1.0269 | Train Acc: 0.8243
 Site-USPS                          | Train Loss: 0.8950 | Train Acc: 0.8412
 Site-SynthDigits                   | Train Loss: 1.6317 | Train Acc: 0.5642
 Site-MNIST_M                       | Train Loss: 1.8272 | Train Acc: 0.5169
 Site-SVHN                          | Train Loss: 1.9666 | Train Acc: 0.3345
Average Train Accuracy: 0.6162
 Site-MNIST                         | Val  Loss: 0.9418 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.9581 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6586 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.7803 | Val  Acc: 0.4865
 Site-SVHN                          | Val  Loss: 1.9655 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6135
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7973
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5405
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4865
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 1.0025 | Train Acc: 0.8176
 Site-USPS                          | Train Loss: 0.8984 | Train Acc: 0.8176
 Site-SynthDigits                   | Train Loss: 1.5969 | Train Acc: 0.5608
 Site-MNIST_M                       | Train Loss: 1.7656 | Train Acc: 0.5203
 Site-SVHN                          | Train Loss: 1.9243 | Train Acc: 0.3378
Average Train Accuracy: 0.6108
 Site-MNIST                         | Val  Loss: 0.9097 | Val  Acc: 0.7973
 Site-USPS                          | Val  Loss: 0.9580 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.6058 | Val  Acc: 0.5135
 Site-MNIST_M                       | Val  Loss: 1.7838 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9603 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6054
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.9589 | Train Acc: 0.8378
 Site-USPS                          | Train Loss: 0.8380 | Train Acc: 0.8243
 Site-SynthDigits                   | Train Loss: 1.6067 | Train Acc: 0.5642
 Site-MNIST_M                       | Train Loss: 1.7803 | Train Acc: 0.5338
 Site-SVHN                          | Train Loss: 1.9284 | Train Acc: 0.3547
Average Train Accuracy: 0.6230
 Site-MNIST                         | Val  Loss: 0.8781 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.9004 | Val  Acc: 0.8378
 Site-SynthDigits                   | Val  Loss: 1.5944 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.7550 | Val  Acc: 0.5270
 Site-SVHN                          | Val  Loss: 1.9329 | Val  Acc: 0.4189
Average Valid Accuracy: 0.6324
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8378
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5405
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5270
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.9175 | Train Acc: 0.8243
 Site-USPS                          | Train Loss: 0.8607 | Train Acc: 0.8243
 Site-SynthDigits                   | Train Loss: 1.5339 | Train Acc: 0.5845
 Site-MNIST_M                       | Train Loss: 1.7494 | Train Acc: 0.5236
 Site-SVHN                          | Train Loss: 1.9346 | Train Acc: 0.3851
Average Train Accuracy: 0.6284
 Site-MNIST                         | Val  Loss: 0.8423 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.9342 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.5568 | Val  Acc: 0.5270
 Site-MNIST_M                       | Val  Loss: 1.7403 | Val  Acc: 0.5405
 Site-SVHN                          | Val  Loss: 1.9130 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6324
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.9008 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.8053 | Train Acc: 0.8446
 Site-SynthDigits                   | Train Loss: 1.5454 | Train Acc: 0.5608
 Site-MNIST_M                       | Train Loss: 1.7587 | Train Acc: 0.5439
 Site-SVHN                          | Train Loss: 1.9126 | Train Acc: 0.3615
Average Train Accuracy: 0.6324
 Site-MNIST                         | Val  Loss: 0.8164 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.8336 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.5578 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.7111 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.8968 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6486
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8243
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8243
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5811
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.8630 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.7851 | Train Acc: 0.8514
 Site-SynthDigits                   | Train Loss: 1.5407 | Train Acc: 0.5946
 Site-MNIST_M                       | Train Loss: 1.6782 | Train Acc: 0.5507
 Site-SVHN                          | Train Loss: 1.8987 | Train Acc: 0.3953
Average Train Accuracy: 0.6486
 Site-MNIST                         | Val  Loss: 0.7858 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.8311 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.5340 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.6884 | Val  Acc: 0.5541
 Site-SVHN                          | Val  Loss: 1.9020 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6514
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8514
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5541
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.8336 | Train Acc: 0.8446
 Site-USPS                          | Train Loss: 0.7309 | Train Acc: 0.8581
 Site-SynthDigits                   | Train Loss: 1.4960 | Train Acc: 0.5676
 Site-MNIST_M                       | Train Loss: 1.6818 | Train Acc: 0.5473
 Site-SVHN                          | Train Loss: 1.8916 | Train Acc: 0.3919
Average Train Accuracy: 0.6419
 Site-MNIST                         | Val  Loss: 0.7751 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.7863 | Val  Acc: 0.8514
 Site-SynthDigits                   | Val  Loss: 1.4995 | Val  Acc: 0.5405
 Site-MNIST_M                       | Val  Loss: 1.6503 | Val  Acc: 0.5676
 Site-SVHN                          | Val  Loss: 1.8587 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6486
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.8168 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.6922 | Train Acc: 0.8581
 Site-SynthDigits                   | Train Loss: 1.4776 | Train Acc: 0.5912
 Site-MNIST_M                       | Train Loss: 1.6389 | Train Acc: 0.5642
 Site-SVHN                          | Train Loss: 1.8448 | Train Acc: 0.4155
Average Train Accuracy: 0.6561
 Site-MNIST                         | Val  Loss: 0.7449 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.7542 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4973 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.6173 | Val  Acc: 0.5676
 Site-SVHN                          | Val  Loss: 1.8687 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6595
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5811
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5676
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.7795 | Train Acc: 0.8547
 Site-USPS                          | Train Loss: 0.7119 | Train Acc: 0.8615
 Site-SynthDigits                   | Train Loss: 1.4641 | Train Acc: 0.5980
 Site-MNIST_M                       | Train Loss: 1.6023 | Train Acc: 0.5777
 Site-SVHN                          | Train Loss: 1.8551 | Train Acc: 0.4088
Average Train Accuracy: 0.6601
 Site-MNIST                         | Val  Loss: 0.7271 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.7443 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4623 | Val  Acc: 0.5541
 Site-MNIST_M                       | Val  Loss: 1.5984 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.8461 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6595
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.7451 | Train Acc: 0.8649
 Site-USPS                          | Train Loss: 0.7417 | Train Acc: 0.8480
 Site-SynthDigits                   | Train Loss: 1.4287 | Train Acc: 0.6081
 Site-MNIST_M                       | Train Loss: 1.6055 | Train Acc: 0.5473
 Site-SVHN                          | Train Loss: 1.8400 | Train Acc: 0.4223
Average Train Accuracy: 0.6581
 Site-MNIST                         | Val  Loss: 0.7116 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.8033 | Val  Acc: 0.8243
 Site-SynthDigits                   | Val  Loss: 1.4394 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.6068 | Val  Acc: 0.5676
 Site-SVHN                          | Val  Loss: 1.8265 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6486
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.7576 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.6443 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.4098 | Train Acc: 0.6014
 Site-MNIST_M                       | Train Loss: 1.5858 | Train Acc: 0.5946
 Site-SVHN                          | Train Loss: 1.8079 | Train Acc: 0.3953
Average Train Accuracy: 0.6642
 Site-MNIST                         | Val  Loss: 0.6962 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.6851 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4364 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.5510 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.8308 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6703
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5946
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5946
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.7577 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.6857 | Train Acc: 0.8716
 Site-SynthDigits                   | Train Loss: 1.4051 | Train Acc: 0.6115
 Site-MNIST_M                       | Train Loss: 1.5944 | Train Acc: 0.5912
 Site-SVHN                          | Train Loss: 1.7941 | Train Acc: 0.4189
Average Train Accuracy: 0.6689
 Site-MNIST                         | Val  Loss: 0.6785 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.7026 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4348 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.5582 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.8102 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6595
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.7403 | Train Acc: 0.8615
 Site-USPS                          | Train Loss: 0.6102 | Train Acc: 0.8784
 Site-SynthDigits                   | Train Loss: 1.4133 | Train Acc: 0.6047
 Site-MNIST_M                       | Train Loss: 1.5639 | Train Acc: 0.5912
 Site-SVHN                          | Train Loss: 1.8038 | Train Acc: 0.4122
Average Train Accuracy: 0.6696
 Site-MNIST                         | Val  Loss: 0.6700 | Val  Acc: 0.8378
 Site-USPS                          | Val  Loss: 0.6696 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.4005 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.5379 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.7797 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6730
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8378
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5946
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.6771 | Train Acc: 0.8581
 Site-USPS                          | Train Loss: 0.6305 | Train Acc: 0.8851
 Site-SynthDigits                   | Train Loss: 1.3912 | Train Acc: 0.6182
 Site-MNIST_M                       | Train Loss: 1.5092 | Train Acc: 0.5845
 Site-SVHN                          | Train Loss: 1.7688 | Train Acc: 0.4189
Average Train Accuracy: 0.6730
 Site-MNIST                         | Val  Loss: 0.6526 | Val  Acc: 0.8243
 Site-USPS                          | Val  Loss: 0.6492 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.3895 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5256 | Val  Acc: 0.5811
 Site-SVHN                          | Val  Loss: 1.7782 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6649
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.6596 | Train Acc: 0.8649
 Site-USPS                          | Train Loss: 0.6016 | Train Acc: 0.8750
 Site-SynthDigits                   | Train Loss: 1.3674 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.5082 | Train Acc: 0.6081
 Site-SVHN                          | Train Loss: 1.8084 | Train Acc: 0.4155
Average Train Accuracy: 0.6777
 Site-MNIST                         | Val  Loss: 0.6381 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.6374 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.3777 | Val  Acc: 0.5811
 Site-MNIST_M                       | Val  Loss: 1.5123 | Val  Acc: 0.5946
 Site-SVHN                          | Val  Loss: 1.7718 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6730
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.6588 | Train Acc: 0.8716
 Site-USPS                          | Train Loss: 0.5717 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.3628 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.5055 | Train Acc: 0.6081
 Site-SVHN                          | Train Loss: 1.7814 | Train Acc: 0.4223
Average Train Accuracy: 0.6818
 Site-MNIST                         | Val  Loss: 0.6218 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.5984 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.3907 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.4794 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.7805 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6811
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5946
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.6604 | Train Acc: 0.8682
 Site-USPS                          | Train Loss: 0.5473 | Train Acc: 0.8784
 Site-SynthDigits                   | Train Loss: 1.2986 | Train Acc: 0.6182
 Site-MNIST_M                       | Train Loss: 1.4796 | Train Acc: 0.6081
 Site-SVHN                          | Train Loss: 1.7672 | Train Acc: 0.4459
Average Train Accuracy: 0.6838
 Site-MNIST                         | Val  Loss: 0.6143 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.6064 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.3519 | Val  Acc: 0.5676
 Site-MNIST_M                       | Val  Loss: 1.4854 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.7500 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6838
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8649
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8649
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5676
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.6216
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.6223 | Train Acc: 0.8784
 Site-USPS                          | Train Loss: 0.5272 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.3260 | Train Acc: 0.6284
 Site-MNIST_M                       | Train Loss: 1.4878 | Train Acc: 0.6081
 Site-SVHN                          | Train Loss: 1.7854 | Train Acc: 0.4358
Average Train Accuracy: 0.6878
 Site-MNIST                         | Val  Loss: 0.6008 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.5797 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.3713 | Val  Acc: 0.6081
 Site-MNIST_M                       | Val  Loss: 1.4555 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.7764 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6865
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8649
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6081
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.6479 | Train Acc: 0.8818
 Site-USPS                          | Train Loss: 0.5563 | Train Acc: 0.8851
 Site-SynthDigits                   | Train Loss: 1.3676 | Train Acc: 0.6081
 Site-MNIST_M                       | Train Loss: 1.4738 | Train Acc: 0.6284
 Site-SVHN                          | Train Loss: 1.7382 | Train Acc: 0.4088
Average Train Accuracy: 0.6824
 Site-MNIST                         | Val  Loss: 0.5911 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.5624 | Val  Acc: 0.8649
 Site-SynthDigits                   | Val  Loss: 1.3530 | Val  Acc: 0.5946
 Site-MNIST_M                       | Val  Loss: 1.4410 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.7513 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6865
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.6095 | Train Acc: 0.8784
 Site-USPS                          | Train Loss: 0.5550 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.3093 | Train Acc: 0.6520
 Site-MNIST_M                       | Train Loss: 1.4472 | Train Acc: 0.6216
 Site-SVHN                          | Train Loss: 1.7406 | Train Acc: 0.4324
Average Train Accuracy: 0.6946
 Site-MNIST                         | Val  Loss: 0.5733 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.5711 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.3353 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.4341 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.7343 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6919
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8784
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.6622
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.5808 | Train Acc: 0.8784
 Site-USPS                          | Train Loss: 0.5536 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.2861 | Train Acc: 0.6351
 Site-MNIST_M                       | Train Loss: 1.4295 | Train Acc: 0.6351
 Site-SVHN                          | Train Loss: 1.7663 | Train Acc: 0.4189
Average Train Accuracy: 0.6912
 Site-MNIST                         | Val  Loss: 0.5675 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.5374 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.3034 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.4344 | Val  Acc: 0.6081
 Site-SVHN                          | Val  Loss: 1.7376 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6946
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8649
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6351
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.6081
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.5745 | Train Acc: 0.8716
 Site-USPS                          | Train Loss: 0.4679 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.2911 | Train Acc: 0.6554
 Site-MNIST_M                       | Train Loss: 1.4119 | Train Acc: 0.6453
 Site-SVHN                          | Train Loss: 1.7100 | Train Acc: 0.4358
Average Train Accuracy: 0.6993
 Site-MNIST                         | Val  Loss: 0.5577 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.5239 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.2905 | Val  Acc: 0.6757
 Site-MNIST_M                       | Val  Loss: 1.4061 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.7080 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7054
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6757
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.6216
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.5532 | Train Acc: 0.8784
 Site-USPS                          | Train Loss: 0.4831 | Train Acc: 0.8885
 Site-SynthDigits                   | Train Loss: 1.2859 | Train Acc: 0.6453
 Site-MNIST_M                       | Train Loss: 1.3914 | Train Acc: 0.6622
 Site-SVHN                          | Train Loss: 1.7096 | Train Acc: 0.4324
Average Train Accuracy: 0.7014
 Site-MNIST                         | Val  Loss: 0.5490 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.5069 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.2866 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.3872 | Val  Acc: 0.6486
 Site-SVHN                          | Val  Loss: 1.7018 | Val  Acc: 0.4595
Average Valid Accuracy: 0.7027
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.5395 | Train Acc: 0.8818
 Site-USPS                          | Train Loss: 0.4829 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.2365 | Train Acc: 0.6655
 Site-MNIST_M                       | Train Loss: 1.3944 | Train Acc: 0.6216
 Site-SVHN                          | Train Loss: 1.6893 | Train Acc: 0.4595
Average Train Accuracy: 0.7020
 Site-MNIST                         | Val  Loss: 0.5434 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.5239 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.2712 | Val  Acc: 0.6622
 Site-MNIST_M                       | Val  Loss: 1.3832 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.6895 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7027
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.5304 | Train Acc: 0.8818
 Site-USPS                          | Train Loss: 0.4550 | Train Acc: 0.8986
 Site-SynthDigits                   | Train Loss: 1.2782 | Train Acc: 0.6351
 Site-MNIST_M                       | Train Loss: 1.3499 | Train Acc: 0.6689
 Site-SVHN                          | Train Loss: 1.7443 | Train Acc: 0.4189
Average Train Accuracy: 0.7007
 Site-MNIST                         | Val  Loss: 0.5346 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4665 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.2846 | Val  Acc: 0.6351
 Site-MNIST_M                       | Val  Loss: 1.3403 | Val  Acc: 0.6622
 Site-SVHN                          | Val  Loss: 1.7244 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7108
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8649
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6351
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.6622
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.5676 | Train Acc: 0.8818
 Site-USPS                          | Train Loss: 0.4625 | Train Acc: 0.8851
 Site-SynthDigits                   | Train Loss: 1.2459 | Train Acc: 0.6588
 Site-MNIST_M                       | Train Loss: 1.3622 | Train Acc: 0.6419
 Site-SVHN                          | Train Loss: 1.6776 | Train Acc: 0.4628
Average Train Accuracy: 0.7061
 Site-MNIST                         | Val  Loss: 0.5313 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4915 | Val  Acc: 0.8784
 Site-SynthDigits                   | Val  Loss: 1.2596 | Val  Acc: 0.6757
 Site-MNIST_M                       | Val  Loss: 1.3512 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6729 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7081
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.5355 | Train Acc: 0.8851
 Site-USPS                          | Train Loss: 0.4247 | Train Acc: 0.9054
 Site-SynthDigits                   | Train Loss: 1.2165 | Train Acc: 0.6520
 Site-MNIST_M                       | Train Loss: 1.3441 | Train Acc: 0.6622
 Site-SVHN                          | Train Loss: 1.6915 | Train Acc: 0.4426
Average Train Accuracy: 0.7095
 Site-MNIST                         | Val  Loss: 0.5209 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4698 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.2672 | Val  Acc: 0.6757
 Site-MNIST_M                       | Val  Loss: 1.3327 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6883 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7108
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.5064 | Train Acc: 0.8851
 Site-USPS                          | Train Loss: 0.4701 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.2109 | Train Acc: 0.6655
 Site-MNIST_M                       | Train Loss: 1.3306 | Train Acc: 0.6520
 Site-SVHN                          | Train Loss: 1.6765 | Train Acc: 0.4628
Average Train Accuracy: 0.7135
 Site-MNIST                         | Val  Loss: 0.5130 | Val  Acc: 0.8514
 Site-USPS                          | Val  Loss: 0.4741 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.2538 | Val  Acc: 0.6892
 Site-MNIST_M                       | Val  Loss: 1.3360 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6489 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7135
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8514
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9054
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6892
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6351
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.4982 | Train Acc: 0.8953
 Site-USPS                          | Train Loss: 0.4010 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.2435 | Train Acc: 0.6486
 Site-MNIST_M                       | Train Loss: 1.3106 | Train Acc: 0.6622
 Site-SVHN                          | Train Loss: 1.6682 | Train Acc: 0.4324
Average Train Accuracy: 0.7081
 Site-MNIST                         | Val  Loss: 0.5076 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4383 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.2498 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.2999 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6886 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7054
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.5005 | Train Acc: 0.8885
 Site-USPS                          | Train Loss: 0.4276 | Train Acc: 0.9054
 Site-SynthDigits                   | Train Loss: 1.2186 | Train Acc: 0.6655
 Site-MNIST_M                       | Train Loss: 1.3170 | Train Acc: 0.6453
 Site-SVHN                          | Train Loss: 1.6496 | Train Acc: 0.4696
Average Train Accuracy: 0.7149
 Site-MNIST                         | Val  Loss: 0.4960 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4563 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.2337 | Val  Acc: 0.6892
 Site-MNIST_M                       | Val  Loss: 1.3136 | Val  Acc: 0.6216
 Site-SVHN                          | Val  Loss: 1.6363 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7135
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8649
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6892
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6216
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.5218 | Train Acc: 0.8986
 Site-USPS                          | Train Loss: 0.4290 | Train Acc: 0.9088
 Site-SynthDigits                   | Train Loss: 1.2264 | Train Acc: 0.6453
 Site-MNIST_M                       | Train Loss: 1.2955 | Train Acc: 0.6858
 Site-SVHN                          | Train Loss: 1.6840 | Train Acc: 0.4426
Average Train Accuracy: 0.7162
 Site-MNIST                         | Val  Loss: 0.4958 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4234 | Val  Acc: 0.9054
 Site-SynthDigits                   | Val  Loss: 1.2357 | Val  Acc: 0.6486
 Site-MNIST_M                       | Val  Loss: 1.2669 | Val  Acc: 0.6486
 Site-SVHN                          | Val  Loss: 1.6636 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7108
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.5051 | Train Acc: 0.9054
 Site-USPS                          | Train Loss: 0.4282 | Train Acc: 0.9054
 Site-SynthDigits                   | Train Loss: 1.1424 | Train Acc: 0.6757
 Site-MNIST_M                       | Train Loss: 1.2792 | Train Acc: 0.6689
 Site-SVHN                          | Train Loss: 1.6453 | Train Acc: 0.4696
Average Train Accuracy: 0.7250
 Site-MNIST                         | Val  Loss: 0.4890 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4292 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.2230 | Val  Acc: 0.6757
 Site-MNIST_M                       | Val  Loss: 1.2833 | Val  Acc: 0.6351
 Site-SVHN                          | Val  Loss: 1.6391 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7135
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.4850 | Train Acc: 0.8986
 Site-USPS                          | Train Loss: 0.4357 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.1614 | Train Acc: 0.6892
 Site-MNIST_M                       | Train Loss: 1.2735 | Train Acc: 0.6757
 Site-SVHN                          | Train Loss: 1.5845 | Train Acc: 0.4865
Average Train Accuracy: 0.7304
 Site-MNIST                         | Val  Loss: 0.4816 | Val  Acc: 0.8649
 Site-USPS                          | Val  Loss: 0.4436 | Val  Acc: 0.8919
 Site-SynthDigits                   | Val  Loss: 1.2118 | Val  Acc: 0.6757
 Site-MNIST_M                       | Val  Loss: 1.2867 | Val  Acc: 0.6486
 Site-SVHN                          | Val  Loss: 1.6144 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7216
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8649
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8919
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6757
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6486
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.5270
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_distinct/fedmix...
===2023-07-03 09:04:59===
===2023-07-03 09:05:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[296,296,296,296,296,
client_nums=[1,1,1,1,1,]
len_dataset=[371,371,371,371,371,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8250
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8817
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.5681
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.4071
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.3179
MNIST: 0.8250, USPS: 0.8817, SynthDigits: 0.5681, MNIST_M: 0.4071, SVHN: 0.3179, 
Average Test Accuracy(group): 0.6000, Average Test Accuracy(individual): 0.6000,
domain std=0.2226, cluster std=-1.0000, individual std=0.2226, 
