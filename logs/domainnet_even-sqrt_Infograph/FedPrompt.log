===2023-03-26 17:00:40===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0281 | Train Acc: 0.3175
 Site-Clipart   | Train Loss: 1.9219 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.8626 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.9442 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 2.2183 | Train Acc: 0.1746
 Site-QuickDraw | Train Loss: 2.1766 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.7581 | Train Acc: 0.5873
 Site-Real      | Train Loss: 1.8721 | Train Acc: 0.3968
 Site-Sketch    | Train Loss: 1.8645 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 1.9842 | Train Acc: 0.4127
 Site-Clipart   | Val  Loss: 1.9450 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9688 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.8145 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.9946 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.1729 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2093 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.8542 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.8335 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 1.9368 | Val  Acc: 0.4762
 Site-Sketch    | Val  Loss: 1.9778 | Val  Acc: 0.4286
Average Valid Accuracy: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Real       | Epoch:0 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7255 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.7545 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.4508 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 1.5353 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 2.1539 | Train Acc: 0.2063
 Site-QuickDraw | Train Loss: 2.0190 | Train Acc: 0.3968
 Site-Real      | Train Loss: 1.2734 | Train Acc: 0.8095
 Site-Real      | Train Loss: 1.3706 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 1.4643 | Train Acc: 0.6190
 Site-Sketch    | Train Loss: 1.6108 | Train Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.7678 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.7842 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 1.3605 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 1.7155 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.9478 | Val  Acc: 0.2619
 Site-QuickDraw | Val  Loss: 2.0507 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3360 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 1.4194 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.6982 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.6630 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4048
 Best site-Painting   | Epoch:1 | Val Acc: 0.7143
 Best site-Painting   | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3333
 Best site-Real       | Epoch:1 | Val Acc: 0.7381
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2847 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3741 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.0369 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 1.1067 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9610 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.8086 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.8271 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.8446 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 1.1510 | Train Acc: 0.7302
 Site-Sketch    | Train Loss: 1.2443 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.3725 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.3172 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.9190 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.2766 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.7194 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.9204 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.8263 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.8546 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 1.2255 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.2871 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6429
 Best site-Painting   | Epoch:2 | Val Acc: 0.8810
 Best site-Painting   | Epoch:2 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4286
 Best site-Real       | Epoch:2 | Val Acc: 0.9286
 Best site-Real       | Epoch:2 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1119 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.1624 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.8643 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.8520 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9321 | Train Acc: 0.3175
 Site-QuickDraw | Train Loss: 1.6474 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.6067 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.6131 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.9032 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.9910 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.2990 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.1408 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.7030 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.0000 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.5140 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.9309 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.5166 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.5727 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.0524 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.0595 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Painting   | Epoch:3 | Val Acc: 0.8810
 Best site-Painting   | Epoch:3 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3810
 Best site-Real       | Epoch:3 | Val Acc: 0.9762
 Best site-Real       | Epoch:3 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8349 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9531 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.6310 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.6313 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.6147 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 1.3868 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.3478 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.3572 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.6602 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.7483 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 1.0506 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 0.8506 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.5012 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.6906 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.2031 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.6049 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3274 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3881 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7637 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.8220 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6366 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7610 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.5449 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4753 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.4796 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 1.2187 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.2808 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.2655 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.6007 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.5652 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.7593 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8168 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.3937 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.5899 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.1536 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.4842 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2250 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2637 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6326 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6363 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8071
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6905
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5000
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5750 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7478 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.4062 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.3670 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.3861 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.2015 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.2286 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1870 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5487 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.4700 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5456 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5540 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.3425 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.4874 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.0188 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.4465 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.1719 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2002 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4666 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.4633 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8405
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-Painting   | Epoch:6 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4762
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.5233 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7329 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.3869 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.3273 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.4463 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.1844 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2531 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1581 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4476 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.4189 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8012 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.7831 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.3021 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.3941 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.9260 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.5907 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.1413 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1415 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5537 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5074 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8190
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3497 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4689 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.2297 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2340 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2262 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.0328 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.1237 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1193 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3153 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3571 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.5372 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4988 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.2167 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2379 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.7604 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.3486 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.1395 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1168 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3910 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3976 | Val  Acc: 0.9524
Average Valid Accuracy: 0.8952
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5952
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3758 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3898 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.2006 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1870 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1366 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.0809 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.1737 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0907 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2511 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2753 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.4402 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3569 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2384 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2519 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.9964 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.1829 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0754 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1344 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3063 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.2762 | Val  Acc: 0.9524
Average Valid Accuracy: 0.9000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6190
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
===2023-03-26 17:27:37===
===2023-03-26 17:27:38===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 3
Loading snapshots...
Test Accuracy of Infograph: 0.4247
Average Test Accuracy: 0.4247
===2023-03-27 22:42:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0213 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9480 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.8556 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9032 | Train Acc: 0.4762
 Site-QuickDraw | Train Loss: 2.2239 | Train Acc: 0.1905
 Site-QuickDraw | Train Loss: 2.1575 | Train Acc: 0.1746
 Site-Real      | Train Loss: 1.7217 | Train Acc: 0.6032
 Site-Real      | Train Loss: 1.8227 | Train Acc: 0.4762
 Site-Sketch    | Train Loss: 1.8414 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 1.9725 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9505 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9941 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.7759 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.9843 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1689 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.2082 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.8335 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.7793 | Val  Acc: 0.5952
 Site-Sketch    | Val  Loss: 1.9212 | Val  Acc: 0.4048
 Site-Sketch    | Val  Loss: 1.9527 | Val  Acc: 0.4048
Average Valid Accuracy: 0.3833
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Real       | Epoch:0 | Val Acc: 0.5952
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6681 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.6681 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.3704 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 1.4124 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1627 | Train Acc: 0.2063
 Site-QuickDraw | Train Loss: 2.0453 | Train Acc: 0.3492
 Site-Real      | Train Loss: 1.1795 | Train Acc: 0.8730
 Site-Real      | Train Loss: 1.2445 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.3918 | Train Acc: 0.6825
 Site-Sketch    | Train Loss: 1.5062 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6730 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7469 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.2828 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.5714 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.9877 | Val  Acc: 0.2619
 Site-QuickDraw | Val  Loss: 2.0801 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.2204 | Val  Acc: 0.7619
 Site-Real      | Val  Loss: 1.2823 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5966 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.5463 | Val  Acc: 0.5476
Average Valid Accuracy: 0.5548
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4524
 Best site-Painting   | Epoch:1 | Val Acc: 0.6667
 Best site-Painting   | Epoch:1 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3571
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.1649 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.2665 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.9420 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.9848 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.8480 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 1.7764 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.6919 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.7238 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 1.0613 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.1065 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.3174 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.1920 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.8331 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 1.1265 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.6600 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.8515 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.7275 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.7100 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 1.0834 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.1448 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7452
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Painting   | Epoch:2 | Val Acc: 0.9048
 Best site-Painting   | Epoch:2 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3571
 Best site-Real       | Epoch:2 | Val Acc: 0.9524
 Best site-Real       | Epoch:2 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9653 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.0528 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.7497 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.7171 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.8443 | Train Acc: 0.2857
 Site-QuickDraw | Train Loss: 1.6008 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.5048 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.5197 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.7880 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.8403 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.2102 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.0024 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.5842 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.8571 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.4730 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.8392 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.4228 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4849 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.8877 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 0.9291 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7548
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Painting   | Epoch:3 | Val Acc: 0.9524
 Best site-Painting   | Epoch:3 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3571
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Real       | Epoch:3 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7176 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.8721 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.5437 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.5479 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.4700 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.3025 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.3196 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.2814 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.5641 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.6886 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9758 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 0.8066 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.3993 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5855 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.2166 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.4896 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2630 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3669 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6573 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7106 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8238
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Painting   | Epoch:4 | Val Acc: 0.9524
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5476
 Best site-Real       | Epoch:4 | Val Acc: 0.9762
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.4953 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6299 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.4078 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.4185 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.3234 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.1750 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2299 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2010 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.5137 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.4817 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6189 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6353 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.3066 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4572 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.1456 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.4340 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1678 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2268 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5605 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.5826 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8310
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5000
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4500 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6137 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.3185 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.3084 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.2023 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.0901 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2018 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1734 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4280 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3833 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4619 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4827 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.2604 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3928 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.9231 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.1890 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1233 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2080 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3755 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3793 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8786
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Painting   | Epoch:6 | Val Acc: 0.9762
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5714
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2820 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4571 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.2380 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2342 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.1838 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 1.0629 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2223 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1132 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3048 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3433 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5106 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4380 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2277 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2715 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.8354 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.3928 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.0923 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1262 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4177 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3931 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8690
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2399 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3042 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1557 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1655 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1581 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.0011 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.1163 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1166 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2636 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2768 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3797 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4179 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.1391 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.1782 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.7479 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.3113 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1149 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1281 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2641 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3290 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8881
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5476
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3080 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3253 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1383 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1446 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.2844 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.0234 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1694 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0751 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2584 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2331 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3480 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3069 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.1921 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.1870 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.9339 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.1613 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0657 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1199 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2644 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2193 | Val  Acc: 0.9762
Average Valid Accuracy: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6190
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Infograph...
===2023-03-27 23:10:02===
===2023-03-27 23:10:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of Infograph: 0.4597
Average Test Accuracy: 0.4597
