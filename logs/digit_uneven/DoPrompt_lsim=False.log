===2023-03-22 23:51:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
===2023-03-22 23:58:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 1
    wk_iters: 1
============ Train epoch 0 ============
===2023-03-23 00:01:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 1
    wk_iters: 1
============ Train epoch 0 ============
===2023-03-23 00:03:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 1
    wk_iters: 1
============ Train epoch 0 ============
===2023-03-23 00:04:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 1
    wk_iters: 1
============ Train epoch 0 ============
===2023-03-23 00:05:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 1
    wk_iters: 0
===2023-03-23 00:06:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 1
    wk_iters: 0
 Site-MNIST     | Train Loss: 2.3422 | Train Acc: 0.0991
 Site-MNIST     | Train Loss: 2.3073 | Train Acc: 0.0721
 Site-MNIST     | Train Loss: 2.2923 | Train Acc: 0.0901
 Site-MNIST     | Train Loss: 2.3269 | Train Acc: 0.0901
 Site-SVHN      | Train Loss: 2.3534 | Train Acc: 0.0721
 Site-SVHN      | Train Loss: 2.3666 | Train Acc: 0.0721
 Site-SVHN      | Train Loss: 2.3780 | Train Acc: 0.0721
 Site-USPS      | Train Loss: 2.2953 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.3494 | Train Acc: 0.0721
 Site-MNIST-M   | Train Loss: 2.4152 | Train Acc: 0.0811
 Site-MNIST     | Val  Loss: 2.3568 | Val  Acc: 0.0405
 Site-MNIST     | Val  Loss: 2.2661 | Val  Acc: 0.1216
 Site-MNIST     | Val  Loss: 2.3065 | Val  Acc: 0.0541
 Site-MNIST     | Val  Loss: 2.3247 | Val  Acc: 0.0946
 Site-SVHN      | Val  Loss: 2.4077 | Val  Acc: 0.0946
 Site-SVHN      | Val  Loss: 2.3137 | Val  Acc: 0.0946
 Site-SVHN      | Val  Loss: 2.3381 | Val  Acc: 0.0405
 Site-USPS      | Val  Loss: 2.2950 | Val  Acc: 0.1351
 Site-SynthDigits| Val  Loss: 2.3381 | Val  Acc: 0.0405
 Site-MNIST-M   | Val  Loss: 2.3814 | Val  Acc: 0.0676
Average Valid Accuracy: 0.0784
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0405
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1216
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0946
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0946
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0946
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0405
 Best site-USPS       | Epoch:0 | Val Acc: 0.1351
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0405
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
Loading snapshots...===2023-03-23 00:09:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 1
    wk_iters: 0
Loading snapshots...===2023-03-23 00:10:26===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 1
    wk_iters: 0
Loading snapshots... Test site-MNIST     | Epoch:0 | Test Acc: 0.0900
 Test site-SVHN      | Epoch:0 | Test Acc: 0.0678
 Test site-USPS      | Epoch:0 | Test Acc: 0.0806
 Test site-SynthDigits| Epoch:0 | Test Acc: 0.0678
 Test site-MNIST-M   | Epoch:0 | Test Acc: 0.1029
Average Test Accuracy: 0.0818
===2023-03-23 00:21:34===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8342 | Train Acc: 0.5495
 Site-MNIST     | Train Loss: 1.8279 | Train Acc: 0.4865
 Site-MNIST     | Train Loss: 1.7440 | Train Acc: 0.5225
 Site-MNIST     | Train Loss: 1.7732 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 2.0679 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 2.1351 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.0832 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.8283 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.0768 | Train Acc: 0.3874
 Site-MNIST-M   | Train Loss: 2.2339 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 1.7436 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.7388 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.8233 | Val  Acc: 0.4865
 Site-MNIST     | Val  Loss: 1.7719 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 2.0896 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 2.1464 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.0713 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 1.8600 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.0713 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 2.2451 | Val  Acc: 0.1892
Average Valid Accuracy: 0.4108
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4865
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3649
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4151 | Train Acc: 0.6757
 Site-MNIST     | Train Loss: 1.4959 | Train Acc: 0.6216
 Site-MNIST     | Train Loss: 1.3889 | Train Acc: 0.7387
 Site-MNIST     | Train Loss: 1.4300 | Train Acc: 0.7117
 Site-SVHN      | Train Loss: 1.8651 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.9707 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.8963 | Train Acc: 0.4234
 Site-USPS      | Train Loss: 1.5133 | Train Acc: 0.6937
 Site-SynthDigits| Train Loss: 1.8550 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.1226 | Train Acc: 0.1802
 Site-MNIST     | Val  Loss: 1.3755 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 1.3900 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.4890 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.4173 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 1.8982 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.9941 | Val  Acc: 0.3108
 Site-SVHN      | Val  Loss: 1.8858 | Val  Acc: 0.5405
 Site-USPS      | Val  Loss: 1.5567 | Val  Acc: 0.6757
 Site-SynthDigits| Val  Loss: 1.8858 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 2.1887 | Val  Acc: 0.1757
Average Valid Accuracy: 0.5527
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3108
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5405
 Best site-USPS       | Epoch:1 | Val Acc: 0.6757
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.2097 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 1.2613 | Train Acc: 0.7027
 Site-MNIST     | Train Loss: 1.1558 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 1.1814 | Train Acc: 0.8018
 Site-SVHN      | Train Loss: 1.7717 | Train Acc: 0.4775
 Site-SVHN      | Train Loss: 1.8639 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 1.7700 | Train Acc: 0.4505
 Site-USPS      | Train Loss: 1.2744 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 1.7275 | Train Acc: 0.4775
 Site-MNIST-M   | Train Loss: 2.0390 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.1242 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 1.1512 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 1.2611 | Val  Acc: 0.7027
 Site-MNIST     | Val  Loss: 1.1756 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 1.7638 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.8804 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.7528 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 1.3435 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 1.7528 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 2.1428 | Val  Acc: 0.1892
Average Valid Accuracy: 0.6027
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7027
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5541
 Best site-USPS       | Epoch:2 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 1.0002 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 1.0787 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 0.9518 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.9845 | Train Acc: 0.8288
 Site-SVHN      | Train Loss: 1.6024 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.7559 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.6597 | Train Acc: 0.4685
 Site-USPS      | Train Loss: 1.1124 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 1.6293 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 2.0068 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 0.9459 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.9771 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 1.0852 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 1.0073 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 1.6562 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.7963 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.6438 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.1959 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 1.6438 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.1129 | Val  Acc: 0.1622
Average Valid Accuracy: 0.6338
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5811
 Best site-USPS       | Epoch:3 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.8875 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.9597 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.8181 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.8926 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 1.5353 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 1.6795 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 1.5865 | Train Acc: 0.4775
 Site-USPS      | Train Loss: 1.0394 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.5287 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 1.9796 | Train Acc: 0.2613
 Site-MNIST     | Val  Loss: 0.8152 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.8449 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.9514 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.8853 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 1.5748 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.7298 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.5608 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 1.0861 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.5608 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 2.0891 | Val  Acc: 0.1892
Average Valid Accuracy: 0.6635
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5946
 Best site-USPS       | Epoch:4 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.7681 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.8565 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.7636 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.7222 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.4749 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.5959 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.5403 | Train Acc: 0.5045
 Site-USPS      | Train Loss: 0.8678 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.4598 | Train Acc: 0.5495
 Site-MNIST-M   | Train Loss: 1.9026 | Train Acc: 0.2793
 Site-MNIST     | Val  Loss: 0.7188 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.7328 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.8391 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.7849 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.5046 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.6659 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.4904 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.9996 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.4904 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0666 | Val  Acc: 0.2162
Average Valid Accuracy: 0.6838
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6216
 Best site-USPS       | Epoch:5 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.6779 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.7443 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.6697 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.6559 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 1.4018 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.5890 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.4682 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.8317 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.3903 | Train Acc: 0.5766
 Site-MNIST-M   | Train Loss: 1.8458 | Train Acc: 0.3243
 Site-MNIST     | Val  Loss: 0.6411 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.6496 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.7510 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.7085 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.4418 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.6042 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.4291 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.9345 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.4291 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 2.0437 | Val  Acc: 0.2703
Average Valid Accuracy: 0.7081
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6351
 Best site-USPS       | Epoch:6 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5984 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.6676 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.5918 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.6279 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 1.3567 | Train Acc: 0.6126
 Site-SVHN      | Train Loss: 1.5031 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.3507 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 0.8030 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.3654 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.7976 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 0.5793 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5753 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.6757 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.6402 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.3795 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 1.5459 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.3715 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.8837 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.3715 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0176 | Val  Acc: 0.2838
Average Valid Accuracy: 0.7230
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6216
 Best site-USPS       | Epoch:7 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5638 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.6030 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.5317 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.5655 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 1.2322 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.3983 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 1.3080 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 0.7496 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.2625 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.7604 | Train Acc: 0.4234
 Site-MNIST     | Val  Loss: 0.5268 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.5136 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.6118 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5846 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.3308 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 1.5006 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.3098 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.8464 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.3098 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.9983 | Val  Acc: 0.3243
Average Valid Accuracy: 0.7351
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6351
 Best site-USPS       | Epoch:8 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4671 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.5920 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.4892 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.5385 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.2147 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 1.3946 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.3072 | Train Acc: 0.6937
 Site-USPS      | Train Loss: 0.7036 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.2052 | Train Acc: 0.6667
 Site-MNIST-M   | Train Loss: 1.6799 | Train Acc: 0.4505
 Site-MNIST     | Val  Loss: 0.4831 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.4715 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.5641 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.5406 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.2782 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 1.4507 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.2597 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 0.8107 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.2597 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 1.9630 | Val  Acc: 0.3514
Average Valid Accuracy: 0.7473
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6486
 Best site-USPS       | Epoch:9 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/DoPrompt_lsim=False...
===2023-03-23 01:02:51===
===2023-03-23 01:02:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots... Test site-MNIST     | Epoch:9 | Test Acc: 0.8457
 Test site-SVHN      | Epoch:9 | Test Acc: 0.5380
 Test site-USPS      | Epoch:9 | Test Acc: 0.8118
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5380
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3579
Average Test Accuracy: 0.6183
