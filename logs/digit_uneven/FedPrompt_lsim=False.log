===2023-03-22 22:28:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8028 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.8223 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.7383 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.7917 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.0682 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 2.1352 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0863 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.8636 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.0949 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.2063 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 1.7479 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.7366 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.8150 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.7696 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 2.0974 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.1408 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 1.8639 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.2511 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4027
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3243
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:0 | Test Acc: 0.5007
 Test site-SVHN      | Epoch:0 | Test Acc: 0.2752
 Test site-USPS      | Epoch:0 | Test Acc: 0.5376
 Test site-SynthDigits| Epoch:0 | Test Acc: 0.2752
 Test site-MNIST-M   | Epoch:0 | Test Acc: 0.1779
Average Test Accuracy: 0.3533
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4126 | Train Acc: 0.6847
 Site-MNIST     | Train Loss: 1.4756 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.3592 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 1.4055 | Train Acc: 0.7387
 Site-SVHN      | Train Loss: 1.8850 | Train Acc: 0.4144
 Site-SVHN      | Train Loss: 1.9818 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 1.9225 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 1.5199 | Train Acc: 0.6937
 Site-SynthDigits| Train Loss: 1.9036 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 2.1447 | Train Acc: 0.1892
 Site-MNIST     | Val  Loss: 1.3652 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 1.3719 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 1.4762 | Val  Acc: 0.6351
 Site-MNIST     | Val  Loss: 1.3982 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 1.9096 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.9891 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.8876 | Val  Acc: 0.5135
 Site-USPS      | Val  Loss: 1.5663 | Val  Acc: 0.6757
 Site-SynthDigits| Val  Loss: 1.8876 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 2.1948 | Val  Acc: 0.1757
Average Valid Accuracy: 0.5608
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6351
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5135
 Best site-USPS       | Epoch:1 | Val Acc: 0.6757
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:1 | Test Acc: 0.6307
 Test site-SVHN      | Epoch:1 | Test Acc: 0.3745
 Test site-USPS      | Epoch:1 | Test Acc: 0.6828
 Test site-SynthDigits| Epoch:1 | Test Acc: 0.3745
 Test site-MNIST-M   | Epoch:1 | Test Acc: 0.2243
Average Test Accuracy: 0.4573
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1955 | Train Acc: 0.7477
 Site-MNIST     | Train Loss: 1.2662 | Train Acc: 0.7027
 Site-MNIST     | Train Loss: 1.1815 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 1.1691 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 1.7425 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.8426 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 1.7746 | Train Acc: 0.4414
 Site-USPS      | Train Loss: 1.3036 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 1.7066 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 2.0493 | Train Acc: 0.2072
 Site-MNIST     | Val  Loss: 1.1296 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 1.1561 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 1.2695 | Val  Acc: 0.7027
 Site-MNIST     | Val  Loss: 1.1827 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 1.7598 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.8814 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.7238 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.3583 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 1.7238 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.1486 | Val  Acc: 0.1486
Average Valid Accuracy: 0.6027
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7027
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5811
 Best site-USPS       | Epoch:2 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:2 | Test Acc: 0.6886
 Test site-SVHN      | Epoch:2 | Test Acc: 0.4082
 Test site-USPS      | Epoch:2 | Test Acc: 0.7473
 Test site-SynthDigits| Epoch:2 | Test Acc: 0.4082
 Test site-MNIST-M   | Epoch:2 | Test Acc: 0.2550
Average Test Accuracy: 0.5015
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9741 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 1.0447 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 0.9410 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.9947 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 1.6291 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.7275 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 1.6598 | Train Acc: 0.4775
 Site-USPS      | Train Loss: 1.1133 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.6306 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.9938 | Train Acc: 0.2432
 Site-MNIST     | Val  Loss: 0.9178 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.9204 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 1.0472 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.9604 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.6556 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.7795 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.6334 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 1.2105 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 1.6334 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 2.1143 | Val  Acc: 0.1622
Average Valid Accuracy: 0.6459
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5946
 Best site-USPS       | Epoch:3 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:3 | Test Acc: 0.7500
 Test site-SVHN      | Epoch:3 | Test Acc: 0.4376
 Test site-USPS      | Epoch:3 | Test Acc: 0.7849
 Test site-SynthDigits| Epoch:3 | Test Acc: 0.4376
 Test site-MNIST-M   | Epoch:3 | Test Acc: 0.2779
Average Test Accuracy: 0.5376
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.8935 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 1.0049 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 0.8787 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.8874 | Train Acc: 0.8468
 Site-SVHN      | Train Loss: 1.4651 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 1.6308 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.5111 | Train Acc: 0.5045
 Site-USPS      | Train Loss: 0.9939 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.4632 | Train Acc: 0.6036
 Site-MNIST-M   | Train Loss: 1.9465 | Train Acc: 0.2432
 Site-MNIST     | Val  Loss: 0.8428 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.8715 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.9925 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.9027 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 1.5183 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.6723 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.4974 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 1.0923 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.4974 | Val  Acc: 0.6081
 Site-MNIST-M   | Val  Loss: 2.0844 | Val  Acc: 0.1757
Average Valid Accuracy: 0.6608
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:4 | Val Acc: 0.6081
 Best site-USPS       | Epoch:4 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6081
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:4 | Test Acc: 0.7579
 Test site-SVHN      | Epoch:4 | Test Acc: 0.4782
 Test site-USPS      | Epoch:4 | Test Acc: 0.7634
 Test site-SynthDigits| Epoch:4 | Test Acc: 0.4782
 Test site-MNIST-M   | Epoch:4 | Test Acc: 0.2964
Average Test Accuracy: 0.5548
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.7524 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.8355 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 0.6995 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.7602 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 1.4898 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 1.6870 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 1.5523 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 1.0190 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.5059 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.8777 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.7078 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.7153 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.8419 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.7646 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.5344 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.7028 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.5511 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 1.0529 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.5511 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 2.0353 | Val  Acc: 0.2838
Average Valid Accuracy: 0.6635
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5541
 Best site-USPS       | Epoch:5 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:5 | Test Acc: 0.7771
 Test site-SVHN      | Epoch:5 | Test Acc: 0.4665
 Test site-USPS      | Epoch:5 | Test Acc: 0.7957
 Test site-SynthDigits| Epoch:5 | Test Acc: 0.4665
 Test site-MNIST-M   | Epoch:5 | Test Acc: 0.3129
Average Test Accuracy: 0.5637
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.7201 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.8087 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.7105 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.7236 | Train Acc: 0.8468
 Site-SVHN      | Train Loss: 1.3586 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.5049 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.4166 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 0.8352 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.3543 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 1.8626 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 0.6734 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6903 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.8141 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.7516 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.4072 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.5572 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.3933 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.9532 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.3933 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 2.0475 | Val  Acc: 0.2162
Average Valid Accuracy: 0.6851
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6351
 Best site-USPS       | Epoch:6 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:6 | Test Acc: 0.7871
 Test site-SVHN      | Epoch:6 | Test Acc: 0.5042
 Test site-USPS      | Epoch:6 | Test Acc: 0.7742
 Test site-SynthDigits| Epoch:6 | Test Acc: 0.5042
 Test site-MNIST-M   | Epoch:6 | Test Acc: 0.3171
Average Test Accuracy: 0.5774
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5807 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.7038 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.5539 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.6026 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 1.2105 | Train Acc: 0.7117
 Site-SVHN      | Train Loss: 1.3987 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 1.2978 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.8224 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.1719 | Train Acc: 0.7117
 Site-MNIST-M   | Train Loss: 1.8374 | Train Acc: 0.3874
 Site-MNIST     | Val  Loss: 0.5659 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5608 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6940 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.6221 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.3045 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 1.4675 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.2619 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.9095 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.2619 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 2.0289 | Val  Acc: 0.2973
Average Valid Accuracy: 0.7257
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6622
 Best site-USPS       | Epoch:7 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:7 | Test Acc: 0.8043
 Test site-SVHN      | Epoch:7 | Test Acc: 0.5507
 Test site-USPS      | Epoch:7 | Test Acc: 0.7957
 Test site-SynthDigits| Epoch:7 | Test Acc: 0.5507
 Test site-MNIST-M   | Epoch:7 | Test Acc: 0.3307
Average Test Accuracy: 0.6064
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5812 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.7276 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.5908 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.5931 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 1.2787 | Train Acc: 0.6577
 Site-SVHN      | Train Loss: 1.4441 | Train Acc: 0.5676
 Site-SVHN      | Train Loss: 1.3330 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 0.7736 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.2369 | Train Acc: 0.6577
 Site-MNIST-M   | Train Loss: 1.6748 | Train Acc: 0.4324
 Site-MNIST     | Val  Loss: 0.5451 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5912 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.7198 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.6503 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.3156 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 1.4907 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.3051 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.8637 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.3051 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.9594 | Val  Acc: 0.3784
Average Valid Accuracy: 0.7270
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6622
 Best site-USPS       | Epoch:8 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:8 | Test Acc: 0.8150
 Test site-SVHN      | Epoch:8 | Test Acc: 0.5194
 Test site-USPS      | Epoch:8 | Test Acc: 0.8172
 Test site-SynthDigits| Epoch:8 | Test Acc: 0.5194
 Test site-MNIST-M   | Epoch:8 | Test Acc: 0.3521
Average Test Accuracy: 0.6046
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4925 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.5940 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.4696 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.4779 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 1.0587 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 1.2821 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 1.1540 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 0.7276 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.0924 | Train Acc: 0.7477
 Site-MNIST-M   | Train Loss: 1.7177 | Train Acc: 0.4234
 Site-MNIST     | Val  Loss: 0.4618 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4526 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5579 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.5084 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.1985 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 1.3708 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.1520 | Val  Acc: 0.7162
 Site-USPS      | Val  Loss: 0.8214 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.1520 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 1.9870 | Val  Acc: 0.3514
Average Valid Accuracy: 0.7541
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7162
 Best site-USPS       | Epoch:9 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8364
 Test site-SVHN      | Epoch:9 | Test Acc: 0.5770
 Test site-USPS      | Epoch:9 | Test Acc: 0.8065
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5770
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3436
Average Test Accuracy: 0.6281
===2023-03-22 23:51:48===
===2023-03-23 11:41:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6282 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.6611 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.5711 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.6030 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.9840 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 2.0500 | Train Acc: 0.3153
 Site-SVHN      | Train Loss: 2.0164 | Train Acc: 0.3423
 Site-USPS      | Train Loss: 1.6685 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 1.9845 | Train Acc: 0.3874
 Site-MNIST-M   | Train Loss: 2.1940 | Train Acc: 0.1802
 Site-MNIST     | Val  Loss: 1.5601 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.5584 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.6666 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.5811 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 2.0208 | Val  Acc: 0.3919
 Site-SVHN      | Val  Loss: 2.0645 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 1.9790 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 1.7035 | Val  Acc: 0.6622
 Site-SynthDigits| Val  Loss: 1.9790 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 2.2281 | Val  Acc: 0.1892
Average Valid Accuracy: 0.4973
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3919
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:0 | Val Acc: 0.4459
 Best site-USPS       | Epoch:0 | Val Acc: 0.6622
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2057 | Train Acc: 0.7658
 Site-MNIST     | Train Loss: 1.2685 | Train Acc: 0.6847
 Site-MNIST     | Train Loss: 1.1600 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 1.1840 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 1.7492 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.8520 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 1.7794 | Train Acc: 0.4414
 Site-USPS      | Train Loss: 1.3007 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 1.7469 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 2.0759 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.1318 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 1.1584 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 1.2758 | Val  Acc: 0.6757
 Site-MNIST     | Val  Loss: 1.1700 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 1.7924 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.8856 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.7505 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.3499 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7505 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 2.1441 | Val  Acc: 0.1622
Average Valid Accuracy: 0.5986
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6757
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5676
 Best site-USPS       | Epoch:1 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9417 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 1.0238 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 0.9062 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.9309 | Train Acc: 0.8288
 Site-SVHN      | Train Loss: 1.5853 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.7178 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.6172 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 1.0827 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 1.5850 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.9899 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 0.8793 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.9066 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 1.0271 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.9301 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 1.6367 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.7605 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.5927 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.1394 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 1.5927 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.0871 | Val  Acc: 0.1757
Average Valid Accuracy: 0.6378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5811
 Best site-USPS       | Epoch:2 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7711 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.8631 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 0.7449 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.7679 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.4592 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 1.6171 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.4962 | Train Acc: 0.5045
 Site-USPS      | Train Loss: 0.9441 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.4613 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.9160 | Train Acc: 0.3063
 Site-MNIST     | Val  Loss: 0.7192 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.7445 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.8636 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.7787 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.5192 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.6639 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.4772 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.0043 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.4772 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0430 | Val  Acc: 0.2432
Average Valid Accuracy: 0.6770
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:3 | Val Acc: 0.6216
 Best site-USPS       | Epoch:3 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6518 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.7472 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.6317 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.6547 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.3676 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 1.5363 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.4012 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 0.8500 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.3669 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.8573 | Train Acc: 0.3514
 Site-MNIST     | Val  Loss: 0.6113 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.6348 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.7464 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.6747 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.4304 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.5901 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.3886 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.9166 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.3886 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 2.0113 | Val  Acc: 0.2703
Average Valid Accuracy: 0.6986
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:4 | Val Acc: 0.6351
 Best site-USPS       | Epoch:4 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.5684 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.6634 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.5546 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.5765 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 1.2918 | Train Acc: 0.6126
 Site-SVHN      | Train Loss: 1.4762 | Train Acc: 0.5405
 Site-SVHN      | Train Loss: 1.3255 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.7840 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.2907 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.8005 | Train Acc: 0.3784
 Site-MNIST     | Val  Loss: 0.5353 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5582 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.6585 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.5988 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.3594 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 1.5311 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.3170 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.8519 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.3170 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.9799 | Val  Acc: 0.3243
Average Valid Accuracy: 0.7081
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6351
 Best site-USPS       | Epoch:5 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5098 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.6036 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.4997 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.5182 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 1.2295 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.4231 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.2667 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 0.7341 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.2285 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.7560 | Train Acc: 0.3964
 Site-MNIST     | Val  Loss: 0.4816 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5014 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5974 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.5438 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.3065 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 1.4836 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.2587 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 0.8025 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.2587 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 1.9551 | Val  Acc: 0.3514
Average Valid Accuracy: 0.7297
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6757
 Best site-USPS       | Epoch:6 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4668 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.5654 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.4620 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.4743 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.1731 | Train Acc: 0.6486
 Site-SVHN      | Train Loss: 1.3785 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 1.2211 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 0.6948 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.1706 | Train Acc: 0.6486
 Site-MNIST-M   | Train Loss: 1.7128 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 0.4395 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.4615 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.5601 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.5076 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.2643 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 1.4402 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.2093 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.7647 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.2093 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.9347 | Val  Acc: 0.3378
Average Valid Accuracy: 0.7311
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6622
 Best site-USPS       | Epoch:7 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4323 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.5314 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.4280 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.4399 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.1336 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 1.3430 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.1839 | Train Acc: 0.6757
 Site-USPS      | Train Loss: 0.6689 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.1314 | Train Acc: 0.6667
 Site-MNIST-M   | Train Loss: 1.6744 | Train Acc: 0.4234
 Site-MNIST     | Val  Loss: 0.4069 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.4293 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5257 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.4754 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.2292 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 1.4069 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.1716 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 0.7383 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.1716 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 1.9149 | Val  Acc: 0.3649
Average Valid Accuracy: 0.7365
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6486
 Best site-USPS       | Epoch:8 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4024 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.5040 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.4032 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.4087 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.0923 | Train Acc: 0.6757
 Site-SVHN      | Train Loss: 1.3112 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 1.1489 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 0.6468 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.0936 | Train Acc: 0.6757
 Site-MNIST-M   | Train Loss: 1.6381 | Train Acc: 0.4234
 Site-MNIST     | Val  Loss: 0.3811 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4019 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4975 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.4505 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.1956 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 1.3698 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.1359 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.7143 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.1359 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.8944 | Val  Acc: 0.3649
Average Valid Accuracy: 0.7405
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6622
 Best site-USPS       | Epoch:9 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven/FedPrompt_lsim=False...
===2023-03-23 12:10:04===
===2023-03-23 12:10:05===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8429
 Test site-SVHN      | Epoch:9 | Test Acc: 0.5263
 Test site-USPS      | Epoch:9 | Test Acc: 0.8065
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5263
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3300
Average Test Accuracy: 0.6064
