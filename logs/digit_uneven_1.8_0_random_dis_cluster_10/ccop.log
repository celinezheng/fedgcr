===2023-08-13 12:53:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 10
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 10
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[5, 2, 6, 3, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (5) | Train Loss: 1.6933 | Train Acc: 0.5000
 Site-MNIST                     (8) | Train Loss: 1.7288 | Train Acc: 0.6667
 Site-MNIST                     (9) | Train Loss: 1.5745 | Train Acc: 0.6667
 Site-MNIST                     (6) | Train Loss: 1.6454 | Train Acc: 0.7632
 Site-MNIST                     (2) | Train Loss: 1.5632 | Train Acc: 0.6857
 Site-MNIST                     (2) | Train Loss: 1.6032 | Train Acc: 0.7302
 Site-MNIST                     (2) | Train Loss: 1.6067 | Train Acc: 0.6784
 Site-MNIST                     (2) | Train Loss: 1.6766 | Train Acc: 0.6235
 Site-MNIST                     (2) | Train Loss: 1.6493 | Train Acc: 0.6644
 Site-MNIST                     (2) | Train Loss: 1.6265 | Train Acc: 0.6860
 Site-USPS                      (7) | Train Loss: 1.7111 | Train Acc: 0.5500
 Site-USPS                      (0) | Train Loss: 1.6562 | Train Acc: 0.5556
 Site-USPS                      (0) | Train Loss: 1.8253 | Train Acc: 0.5736
 Site-USPS                      (0) | Train Loss: 1.7285 | Train Acc: 0.5536
 Site-USPS                      (0) | Train Loss: 1.7470 | Train Acc: 0.5690
 Site-USPS                      (0) | Train Loss: 1.7449 | Train Acc: 0.5463
 Site-SynthDigits               (3) | Train Loss: 2.1621 | Train Acc: 0.2914
 Site-SynthDigits               (3) | Train Loss: 2.1584 | Train Acc: 0.2308
 Site-SynthDigits               (3) | Train Loss: 2.1377 | Train Acc: 0.2587
 Site-MNIST_M                   (1) | Train Loss: 2.2426 | Train Acc: 0.1934
 Site-MNIST_M                   (1) | Train Loss: 2.1697 | Train Acc: 0.2141
 Site-SVHN                      (4) | Train Loss: 2.2692 | Train Acc: 0.1631
Average Train Accuracy: 0.5166
 Site-MNIST                     (5) | Val  Loss: 2.0150 | Val  Acc: 0.0000
 Site-MNIST                     (8) | Val  Loss: 1.4954 | Val  Acc: 0.6667
 Site-MNIST                     (9) | Val  Loss: 1.4747 | Val  Acc: 0.6000
 Site-MNIST                     (6) | Val  Loss: 1.6396 | Val  Acc: 0.5556
 Site-MNIST                     (2) | Val  Loss: 1.6631 | Val  Acc: 0.5882
 Site-MNIST                     (2) | Val  Loss: 1.7017 | Val  Acc: 0.6452
 Site-MNIST                     (2) | Val  Loss: 1.6223 | Val  Acc: 0.6964
 Site-MNIST                     (2) | Val  Loss: 1.6110 | Val  Acc: 0.7255
 Site-MNIST                     (2) | Val  Loss: 1.6629 | Val  Acc: 0.6503
 Site-MNIST                     (2) | Val  Loss: 1.6314 | Val  Acc: 0.6435
 Site-USPS                      (7) | Val  Loss: 1.7363 | Val  Acc: 0.4000
 Site-USPS                      (0) | Val  Loss: 1.8335 | Val  Acc: 0.3889
 Site-USPS                      (0) | Val  Loss: 1.8047 | Val  Acc: 0.5000
 Site-USPS                      (0) | Val  Loss: 1.7916 | Val  Acc: 0.4828
 Site-USPS                      (0) | Val  Loss: 1.7383 | Val  Acc: 0.5810
 Site-USPS                      (0) | Val  Loss: 1.6739 | Val  Acc: 0.6085
 Site-SynthDigits               (3) | Val  Loss: 2.1917 | Val  Acc: 0.1622
 Site-SynthDigits               (3) | Val  Loss: 2.2467 | Val  Acc: 0.2647
 Site-SynthDigits               (3) | Val  Loss: 2.1293 | Val  Acc: 0.2869
 Site-MNIST_M                   (1) | Val  Loss: 2.1776 | Val  Acc: 0.2000
 Site-MNIST_M                   (1) | Val  Loss: 2.2288 | Val  Acc: 0.1852
 Site-SVHN                      (4) | Val  Loss: 2.2313 | Val  Acc: 0.2000
Average Valid Accuracy: 0.4560
 Best site-MNIST                    (5)  | Epoch:0 | Val Acc: 0.0000
 Best site-MNIST                    (8)  | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST                    (9)  | Epoch:0 | Val Acc: 0.6000
 Best site-MNIST                    (6)  | Epoch:0 | Val Acc: 0.5556
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5882
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6452
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6964
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.7255
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6503
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6435
 Best site-USPS                     (7)  | Epoch:0 | Val Acc: 0.4000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.3889
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.4828
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.5810
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6085
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.1622
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2647
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2869
 Best site-MNIST_M                  (1)  | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST_M                  (1)  | Epoch:0 | Val Acc: 0.1852
 Best site-SVHN                     (4)  | Epoch:0 | Val Acc: 0.2000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 3, 5, 2, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (5) | Train Loss: 1.2393 | Train Acc: 0.6667
 Site-MNIST                     (7) | Train Loss: 1.2707 | Train Acc: 0.7500
 Site-MNIST                     (6) | Train Loss: 1.0743 | Train Acc: 0.8095
 Site-MNIST                     (8) | Train Loss: 1.1018 | Train Acc: 0.8684
 Site-MNIST                     (0) | Train Loss: 1.2793 | Train Acc: 0.8000
 Site-MNIST                     (0) | Train Loss: 1.1133 | Train Acc: 0.8254
 Site-MNIST                     (0) | Train Loss: 1.1027 | Train Acc: 0.8546
 Site-MNIST                     (0) | Train Loss: 1.2301 | Train Acc: 0.7506
 Site-MNIST                     (0) | Train Loss: 1.1629 | Train Acc: 0.7799
 Site-MNIST                     (0) | Train Loss: 1.1299 | Train Acc: 0.7955
 Site-USPS                      (9) | Train Loss: 1.2377 | Train Acc: 0.7250
 Site-USPS                      (2) | Train Loss: 1.2146 | Train Acc: 0.7361
 Site-USPS                      (2) | Train Loss: 1.4620 | Train Acc: 0.7132
 Site-USPS                      (2) | Train Loss: 1.2625 | Train Acc: 0.7339
 Site-USPS                      (2) | Train Loss: 1.2465 | Train Acc: 0.7500
 Site-USPS                      (2) | Train Loss: 1.2624 | Train Acc: 0.7394
 Site-SynthDigits               (1) | Train Loss: 2.0073 | Train Acc: 0.2980
 Site-SynthDigits               (1) | Train Loss: 1.9828 | Train Acc: 0.2711
 Site-SynthDigits               (1) | Train Loss: 1.9796 | Train Acc: 0.3035
 Site-MNIST_M                   (3) | Train Loss: 2.0616 | Train Acc: 0.2486
 Site-MNIST_M                   (3) | Train Loss: 2.0530 | Train Acc: 0.3211
 Site-SVHN                      (4) | Train Loss: 2.2036 | Train Acc: 0.1809
Average Train Accuracy: 0.6328
 Site-MNIST                     (5) | Val  Loss: 1.3150 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.9229 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.9573 | Val  Acc: 0.8000
 Site-MNIST                     (8) | Val  Loss: 1.2470 | Val  Acc: 0.5556
 Site-MNIST                     (0) | Val  Loss: 1.2433 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 1.2637 | Val  Acc: 0.7419
 Site-MNIST                     (0) | Val  Loss: 1.1312 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 1.1286 | Val  Acc: 0.8137
 Site-MNIST                     (0) | Val  Loss: 1.2038 | Val  Acc: 0.7705
 Site-MNIST                     (0) | Val  Loss: 1.1663 | Val  Acc: 0.7976
 Site-USPS                      (9) | Val  Loss: 1.1714 | Val  Acc: 0.8000
 Site-USPS                      (2) | Val  Loss: 1.4295 | Val  Acc: 0.6667
 Site-USPS                      (2) | Val  Loss: 1.4106 | Val  Acc: 0.5938
 Site-USPS                      (2) | Val  Loss: 1.3759 | Val  Acc: 0.6207
 Site-USPS                      (2) | Val  Loss: 1.2785 | Val  Acc: 0.7238
 Site-USPS                      (2) | Val  Loss: 1.1961 | Val  Acc: 0.7672
 Site-SynthDigits               (1) | Val  Loss: 2.0892 | Val  Acc: 0.1892
 Site-SynthDigits               (1) | Val  Loss: 2.1896 | Val  Acc: 0.2794
 Site-SynthDigits               (1) | Val  Loss: 1.9872 | Val  Acc: 0.3197
 Site-MNIST_M                   (3) | Val  Loss: 2.0682 | Val  Acc: 0.2444
 Site-MNIST_M                   (3) | Val  Loss: 2.0795 | Val  Acc: 0.2469
 Site-SVHN                      (4) | Val  Loss: 2.0682 | Val  Acc: 0.2286
Average Valid Accuracy: 0.6238
 Best site-MNIST                    (5)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST                    (8)  | Epoch:1 | Val Acc: 0.5556
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7419
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.8137
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7705
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7976
 Best site-USPS                     (9)  | Epoch:1 | Val Acc: 0.8000
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.6667
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.5938
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.6207
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7238
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7672
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.1892
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.2794
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.3197
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.2444
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.2469
 Best site-SVHN                     (4)  | Epoch:1 | Val Acc: 0.2286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 1, 3, 5, 2, 1, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (7) | Train Loss: 0.9313 | Train Acc: 0.8333
 Site-MNIST                     (9) | Train Loss: 1.1289 | Train Acc: 0.6667
 Site-MNIST                     (8) | Train Loss: 0.9520 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.9585 | Train Acc: 0.8421
 Site-MNIST                     (9) | Train Loss: 1.1786 | Train Acc: 0.7857
 Site-MNIST                     (0) | Train Loss: 0.9941 | Train Acc: 0.8016
 Site-MNIST                     (0) | Train Loss: 0.9476 | Train Acc: 0.8238
 Site-MNIST                     (0) | Train Loss: 1.0961 | Train Acc: 0.7579
 Site-MNIST                     (5) | Train Loss: 1.0357 | Train Acc: 0.7812
 Site-MNIST                     (9) | Train Loss: 0.9926 | Train Acc: 0.7834
 Site-USPS                      (6) | Train Loss: 0.9115 | Train Acc: 0.8000
 Site-USPS                      (3) | Train Loss: 0.8617 | Train Acc: 0.8056
 Site-USPS                      (3) | Train Loss: 0.6953 | Train Acc: 0.7364
 Site-USPS                      (3) | Train Loss: 1.0281 | Train Acc: 0.7682
 Site-USPS                      (3) | Train Loss: 1.0139 | Train Acc: 0.7905
 Site-USPS                      (3) | Train Loss: 1.0038 | Train Acc: 0.7817
 Site-SynthDigits               (2) | Train Loss: 1.8525 | Train Acc: 0.3576
 Site-SynthDigits               (2) | Train Loss: 1.8177 | Train Acc: 0.3883
 Site-SynthDigits               (2) | Train Loss: 1.7449 | Train Acc: 0.4012
 Site-MNIST_M                   (4) | Train Loss: 1.9467 | Train Acc: 0.2983
 Site-MNIST_M                   (4) | Train Loss: 1.8899 | Train Acc: 0.3578
 Site-SVHN                      (1) | Train Loss: 2.0873 | Train Acc: 0.2163
Average Train Accuracy: 0.6652
 Site-MNIST                     (7) | Val  Loss: 0.9079 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.6708 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.7673 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 1.0408 | Val  Acc: 0.6667
 Site-MNIST                     (9) | Val  Loss: 1.0874 | Val  Acc: 0.7647
 Site-MNIST                     (0) | Val  Loss: 1.1400 | Val  Acc: 0.7742
 Site-MNIST                     (0) | Val  Loss: 1.0240 | Val  Acc: 0.8214
 Site-MNIST                     (0) | Val  Loss: 1.0080 | Val  Acc: 0.7941
 Site-MNIST                     (5) | Val  Loss: 1.0697 | Val  Acc: 0.7596
 Site-MNIST                     (9) | Val  Loss: 1.0252 | Val  Acc: 0.7855
 Site-USPS                      (6) | Val  Loss: 0.9001 | Val  Acc: 0.8000
 Site-USPS                      (3) | Val  Loss: 1.1813 | Val  Acc: 0.6667
 Site-USPS                      (3) | Val  Loss: 1.1451 | Val  Acc: 0.6562
 Site-USPS                      (3) | Val  Loss: 1.1550 | Val  Acc: 0.6724
 Site-USPS                      (3) | Val  Loss: 1.0380 | Val  Acc: 0.7714
 Site-USPS                      (3) | Val  Loss: 0.9534 | Val  Acc: 0.7937
 Site-SynthDigits               (2) | Val  Loss: 1.8935 | Val  Acc: 0.4054
 Site-SynthDigits               (2) | Val  Loss: 1.9464 | Val  Acc: 0.4118
 Site-SynthDigits               (2) | Val  Loss: 1.7959 | Val  Acc: 0.3934
 Site-MNIST_M                   (4) | Val  Loss: 1.9696 | Val  Acc: 0.3111
 Site-MNIST_M                   (4) | Val  Loss: 1.9584 | Val  Acc: 0.2963
 Site-SVHN                      (1) | Val  Loss: 1.9698 | Val  Acc: 0.2571
Average Valid Accuracy: 0.6637
 Best site-MNIST                    (7)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (9)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (8)  | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST                    (9)  | Epoch:2 | Val Acc: 0.7647
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7742
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8214
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7941
 Best site-MNIST                    (5)  | Epoch:2 | Val Acc: 0.7596
 Best site-MNIST                    (9)  | Epoch:2 | Val Acc: 0.7855
 Best site-USPS                     (6)  | Epoch:2 | Val Acc: 0.8000
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.6667
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.6562
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.6724
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.7714
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.7937
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4054
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4118
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.3934
 Best site-MNIST_M                  (4)  | Epoch:2 | Val Acc: 0.3111
 Best site-MNIST_M                  (4)  | Epoch:2 | Val Acc: 0.2963
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 1, 3, 6, 2, 1, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (6) | Train Loss: 0.8070 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 1.0081 | Train Acc: 0.7500
 Site-MNIST                     (7) | Train Loss: 0.7713 | Train Acc: 0.8571
 Site-MNIST                     (8) | Train Loss: 0.8130 | Train Acc: 0.8684
 Site-MNIST                     (3) | Train Loss: 0.8407 | Train Acc: 0.8286
 Site-MNIST                     (8) | Train Loss: 0.8465 | Train Acc: 0.8175
 Site-MNIST                     (3) | Train Loss: 0.8122 | Train Acc: 0.8678
 Site-MNIST                     (3) | Train Loss: 0.9237 | Train Acc: 0.8020
 Site-MNIST                     (3) | Train Loss: 0.8797 | Train Acc: 0.8084
 Site-MNIST                     (3) | Train Loss: 0.8430 | Train Acc: 0.8151
 Site-USPS                      (5) | Train Loss: 0.7714 | Train Acc: 0.8250
 Site-USPS                      (9) | Train Loss: 0.8207 | Train Acc: 0.8056
 Site-USPS                      (9) | Train Loss: 0.7999 | Train Acc: 0.8062
 Site-USPS                      (0) | Train Loss: 0.8717 | Train Acc: 0.8026
 Site-USPS                      (0) | Train Loss: 0.8631 | Train Acc: 0.8119
 Site-USPS                      (9) | Train Loss: 0.8562 | Train Acc: 0.8042
 Site-SynthDigits               (2) | Train Loss: 1.7303 | Train Acc: 0.4305
 Site-SynthDigits               (2) | Train Loss: 1.6359 | Train Acc: 0.4579
 Site-SynthDigits               (2) | Train Loss: 1.5954 | Train Acc: 0.4725
 Site-MNIST_M                   (4) | Train Loss: 1.8737 | Train Acc: 0.3204
 Site-MNIST_M                   (4) | Train Loss: 1.8005 | Train Acc: 0.3976
 Site-SVHN                      (1) | Train Loss: 2.0331 | Train Acc: 0.2411
Average Train Accuracy: 0.7011
 Site-MNIST                     (6) | Val  Loss: 0.6838 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.5186 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.6633 | Val  Acc: 0.8000
 Site-MNIST                     (8) | Val  Loss: 0.9384 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.9490 | Val  Acc: 0.8235
 Site-MNIST                     (8) | Val  Loss: 0.9703 | Val  Acc: 0.8387
 Site-MNIST                     (3) | Val  Loss: 0.8512 | Val  Acc: 0.8571
 Site-MNIST                     (3) | Val  Loss: 0.8471 | Val  Acc: 0.8333
 Site-MNIST                     (3) | Val  Loss: 0.9218 | Val  Acc: 0.8142
 Site-MNIST                     (3) | Val  Loss: 0.8787 | Val  Acc: 0.8338
 Site-USPS                      (5) | Val  Loss: 0.6905 | Val  Acc: 0.9000
 Site-USPS                      (9) | Val  Loss: 1.0376 | Val  Acc: 0.7778
 Site-USPS                      (9) | Val  Loss: 1.0396 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 1.0274 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.8958 | Val  Acc: 0.8095
 Site-USPS                      (9) | Val  Loss: 0.8142 | Val  Acc: 0.8201
 Site-SynthDigits               (2) | Val  Loss: 1.7562 | Val  Acc: 0.5135
 Site-SynthDigits               (2) | Val  Loss: 1.8123 | Val  Acc: 0.5294
 Site-SynthDigits               (2) | Val  Loss: 1.6444 | Val  Acc: 0.4754
 Site-MNIST_M                   (4) | Val  Loss: 1.9270 | Val  Acc: 0.2889
 Site-MNIST_M                   (4) | Val  Loss: 1.9027 | Val  Acc: 0.3580
 Site-SVHN                      (1) | Val  Loss: 1.9325 | Val  Acc: 0.3000
Average Valid Accuracy: 0.7179
 Best site-MNIST                    (6)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                    (8)  | Epoch:3 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8235
 Best site-MNIST                    (8)  | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8333
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8142
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8338
 Best site-USPS                     (5)  | Epoch:3 | Val Acc: 0.9000
 Best site-USPS                     (9)  | Epoch:3 | Val Acc: 0.7778
 Best site-USPS                     (9)  | Epoch:3 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8095
 Best site-USPS                     (9)  | Epoch:3 | Val Acc: 0.8201
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5135
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5294
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.4754
 Best site-MNIST_M                  (4)  | Epoch:3 | Val Acc: 0.2889
 Best site-MNIST_M                  (4)  | Epoch:3 | Val Acc: 0.3580
 Best site-SVHN                     (1)  | Epoch:3 | Val Acc: 0.3000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 1, 3, 3, 1, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (5) | Train Loss: 0.7682 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.8853 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.6639 | Train Acc: 0.8095
 Site-MNIST                     (3) | Train Loss: 0.7067 | Train Acc: 0.8947
 Site-MNIST                     (7) | Train Loss: 0.7191 | Train Acc: 0.8286
 Site-MNIST                     (3) | Train Loss: 0.7537 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.7052 | Train Acc: 0.8855
 Site-MNIST                     (3) | Train Loss: 0.8263 | Train Acc: 0.8142
 Site-MNIST                     (7) | Train Loss: 0.7823 | Train Acc: 0.8383
 Site-MNIST                     (7) | Train Loss: 0.7417 | Train Acc: 0.8475
 Site-USPS                      (8) | Train Loss: 0.6781 | Train Acc: 0.8250
 Site-USPS                      (0) | Train Loss: 0.6537 | Train Acc: 0.8611
 Site-USPS                      (0) | Train Loss: 0.5206 | Train Acc: 0.8295
 Site-USPS                      (0) | Train Loss: 0.7985 | Train Acc: 0.8240
 Site-USPS                      (0) | Train Loss: 0.7658 | Train Acc: 0.8357
 Site-USPS                      (0) | Train Loss: 0.7686 | Train Acc: 0.8347
 Site-SynthDigits               (2) | Train Loss: 1.6079 | Train Acc: 0.4901
 Site-SynthDigits               (2) | Train Loss: 1.5204 | Train Acc: 0.4945
 Site-SynthDigits               (2) | Train Loss: 1.4825 | Train Acc: 0.5051
 Site-MNIST_M                   (4) | Train Loss: 1.7875 | Train Acc: 0.3646
 Site-MNIST_M                   (9) | Train Loss: 1.7407 | Train Acc: 0.4465
 Site-SVHN                      (1) | Train Loss: 1.9730 | Train Acc: 0.2660
Average Train Accuracy: 0.7270
 Site-MNIST                     (5) | Val  Loss: 0.4840 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4169 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.6005 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.8747 | Val  Acc: 0.7778
 Site-MNIST                     (7) | Val  Loss: 0.8551 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.8494 | Val  Acc: 0.8710
 Site-MNIST                     (7) | Val  Loss: 0.7304 | Val  Acc: 0.8750
 Site-MNIST                     (3) | Val  Loss: 0.7343 | Val  Acc: 0.8431
 Site-MNIST                     (7) | Val  Loss: 0.8190 | Val  Acc: 0.8142
 Site-MNIST                     (7) | Val  Loss: 0.7790 | Val  Acc: 0.8399
 Site-USPS                      (8) | Val  Loss: 0.5710 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.9547 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.9639 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.9320 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.8039 | Val  Acc: 0.8190
 Site-USPS                      (0) | Val  Loss: 0.7343 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.6282 | Val  Acc: 0.5405
 Site-SynthDigits               (2) | Val  Loss: 1.6095 | Val  Acc: 0.5588
 Site-SynthDigits               (2) | Val  Loss: 1.5276 | Val  Acc: 0.5246
 Site-MNIST_M                   (4) | Val  Loss: 1.8601 | Val  Acc: 0.3333
 Site-MNIST_M                   (9) | Val  Loss: 1.8230 | Val  Acc: 0.4321
 Site-SVHN                      (1) | Val  Loss: 1.8925 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7328
 Best site-MNIST                    (5)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.7778
 Best site-MNIST                    (7)  | Epoch:4 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8710
 Best site-MNIST                    (7)  | Epoch:4 | Val Acc: 0.8750
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8431
 Best site-MNIST                    (7)  | Epoch:4 | Val Acc: 0.8142
 Best site-MNIST                    (7)  | Epoch:4 | Val Acc: 0.8399
 Best site-USPS                     (8)  | Epoch:4 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8190
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5405
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5588
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5246
 Best site-MNIST_M                  (4)  | Epoch:4 | Val Acc: 0.3333
 Best site-MNIST_M                  (9)  | Epoch:4 | Val Acc: 0.4321
 Best site-SVHN                     (1)  | Epoch:4 | Val Acc: 0.2857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 5 ============
cnt=[4, 1, 3, 2, 5, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (8) | Train Loss: 0.7263 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.8347 | Train Acc: 0.7500
 Site-MNIST                     (5) | Train Loss: 0.5907 | Train Acc: 0.9048
 Site-MNIST                     (6) | Train Loss: 0.6201 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.9203 | Train Acc: 0.8143
 Site-MNIST                     (6) | Train Loss: 0.6872 | Train Acc: 0.8413
 Site-MNIST                     (0) | Train Loss: 0.6237 | Train Acc: 0.8811
 Site-MNIST                     (6) | Train Loss: 0.7454 | Train Acc: 0.8362
 Site-MNIST                     (0) | Train Loss: 0.7000 | Train Acc: 0.8370
 Site-MNIST                     (9) | Train Loss: 0.6717 | Train Acc: 0.8566
 Site-USPS                      (7) | Train Loss: 0.6057 | Train Acc: 0.8250
 Site-USPS                      (4) | Train Loss: 0.5910 | Train Acc: 0.8750
 Site-USPS                      (4) | Train Loss: 0.4787 | Train Acc: 0.8295
 Site-USPS                      (4) | Train Loss: 0.7388 | Train Acc: 0.8283
 Site-USPS                      (4) | Train Loss: 0.7095 | Train Acc: 0.8452
 Site-USPS                      (4) | Train Loss: 0.7054 | Train Acc: 0.8399
 Site-SynthDigits               (2) | Train Loss: 1.5247 | Train Acc: 0.5298
 Site-SynthDigits               (2) | Train Loss: 1.4648 | Train Acc: 0.5495
 Site-SynthDigits               (2) | Train Loss: 1.3782 | Train Acc: 0.5703
 Site-MNIST_M                   (3) | Train Loss: 1.6975 | Train Acc: 0.3867
 Site-MNIST_M                   (3) | Train Loss: 1.6670 | Train Acc: 0.4740
 Site-SVHN                      (1) | Train Loss: 1.9162 | Train Acc: 0.3121
Average Train Accuracy: 0.7428
 Site-MNIST                     (8) | Val  Loss: 0.3654 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.3066 | Val  Acc: 1.0000
 Site-MNIST                     (5) | Val  Loss: 0.5226 | Val  Acc: 0.8000
 Site-MNIST                     (6) | Val  Loss: 0.7631 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.7548 | Val  Acc: 0.8235
 Site-MNIST                     (6) | Val  Loss: 0.7703 | Val  Acc: 0.8710
 Site-MNIST                     (0) | Val  Loss: 0.6656 | Val  Acc: 0.9107
 Site-MNIST                     (6) | Val  Loss: 0.6686 | Val  Acc: 0.8627
 Site-MNIST                     (0) | Val  Loss: 0.7442 | Val  Acc: 0.8361
 Site-MNIST                     (9) | Val  Loss: 0.7071 | Val  Acc: 0.8459
 Site-USPS                      (7) | Val  Loss: 0.5245 | Val  Acc: 0.9000
 Site-USPS                      (4) | Val  Loss: 0.9078 | Val  Acc: 0.7778
 Site-USPS                      (4) | Val  Loss: 0.9199 | Val  Acc: 0.7188
 Site-USPS                      (4) | Val  Loss: 0.8842 | Val  Acc: 0.7241
 Site-USPS                      (4) | Val  Loss: 0.7516 | Val  Acc: 0.8190
 Site-USPS                      (4) | Val  Loss: 0.6783 | Val  Acc: 0.8677
 Site-SynthDigits               (2) | Val  Loss: 1.5127 | Val  Acc: 0.6216
 Site-SynthDigits               (2) | Val  Loss: 1.4746 | Val  Acc: 0.6176
 Site-SynthDigits               (2) | Val  Loss: 1.4118 | Val  Acc: 0.5738
 Site-MNIST_M                   (3) | Val  Loss: 1.7874 | Val  Acc: 0.4000
 Site-MNIST_M                   (3) | Val  Loss: 1.7383 | Val  Acc: 0.4938
 Site-SVHN                      (1) | Val  Loss: 1.8464 | Val  Acc: 0.3143
Average Valid Accuracy: 0.7526
 Best site-MNIST                    (8)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (5)  | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST                    (6)  | Epoch:5 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8235
 Best site-MNIST                    (6)  | Epoch:5 | Val Acc: 0.8710
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.9107
 Best site-MNIST                    (6)  | Epoch:5 | Val Acc: 0.8627
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8361
 Best site-MNIST                    (9)  | Epoch:5 | Val Acc: 0.8459
 Best site-USPS                     (7)  | Epoch:5 | Val Acc: 0.9000
 Best site-USPS                     (4)  | Epoch:5 | Val Acc: 0.7778
 Best site-USPS                     (4)  | Epoch:5 | Val Acc: 0.7188
 Best site-USPS                     (4)  | Epoch:5 | Val Acc: 0.7241
 Best site-USPS                     (4)  | Epoch:5 | Val Acc: 0.8190
 Best site-USPS                     (4)  | Epoch:5 | Val Acc: 0.8677
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6216
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6176
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5738
 Best site-MNIST_M                  (3)  | Epoch:5 | Val Acc: 0.4000
 Best site-MNIST_M                  (3)  | Epoch:5 | Val Acc: 0.4938
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.3143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 1, 1, 8, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (8) | Train Loss: 0.6636 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.7828 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.5451 | Train Acc: 0.9048
 Site-MNIST                     (3) | Train Loss: 0.5604 | Train Acc: 0.8684
 Site-MNIST                     (3) | Train Loss: 1.0202 | Train Acc: 0.8286
 Site-MNIST                     (3) | Train Loss: 0.6296 | Train Acc: 0.8651
 Site-MNIST                     (3) | Train Loss: 0.5613 | Train Acc: 0.8943
 Site-MNIST                     (3) | Train Loss: 0.6792 | Train Acc: 0.8435
 Site-MNIST                     (3) | Train Loss: 0.6476 | Train Acc: 0.8546
 Site-MNIST                     (3) | Train Loss: 0.6166 | Train Acc: 0.8709
 Site-USPS                      (5) | Train Loss: 0.5720 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 0.7977 | Train Acc: 0.9028
 Site-USPS                      (0) | Train Loss: 1.0541 | Train Acc: 0.8372
 Site-USPS                      (0) | Train Loss: 0.7042 | Train Acc: 0.8369
 Site-USPS                      (0) | Train Loss: 0.6492 | Train Acc: 0.8429
 Site-USPS                      (0) | Train Loss: 0.6609 | Train Acc: 0.8571
 Site-SynthDigits               (6) | Train Loss: 1.4362 | Train Acc: 0.5629
 Site-SynthDigits               (6) | Train Loss: 1.3905 | Train Acc: 0.5751
 Site-SynthDigits               (2) | Train Loss: 1.2862 | Train Acc: 0.6171
 Site-MNIST_M                   (4) | Train Loss: 1.6440 | Train Acc: 0.4199
 Site-MNIST_M                   (9) | Train Loss: 1.5202 | Train Acc: 0.5321
 Site-SVHN                      (1) | Train Loss: 1.8401 | Train Acc: 0.3652
Average Train Accuracy: 0.7612
 Site-MNIST                     (8) | Val  Loss: 0.3245 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.2689 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.5027 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.7317 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.7009 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.6898 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.5977 | Val  Acc: 0.9286
 Site-MNIST                     (3) | Val  Loss: 0.6020 | Val  Acc: 0.8725
 Site-MNIST                     (3) | Val  Loss: 0.6803 | Val  Acc: 0.8415
 Site-MNIST                     (3) | Val  Loss: 0.6457 | Val  Acc: 0.8520
 Site-USPS                      (5) | Val  Loss: 0.4761 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.8774 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.9013 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 0.8510 | Val  Acc: 0.7586
 Site-USPS                      (0) | Val  Loss: 0.7192 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.6400 | Val  Acc: 0.8783
 Site-SynthDigits               (6) | Val  Loss: 1.4112 | Val  Acc: 0.6757
 Site-SynthDigits               (6) | Val  Loss: 1.3606 | Val  Acc: 0.6618
 Site-SynthDigits               (2) | Val  Loss: 1.3272 | Val  Acc: 0.5984
 Site-MNIST_M                   (4) | Val  Loss: 1.7315 | Val  Acc: 0.4222
 Site-MNIST_M                   (9) | Val  Loss: 1.6649 | Val  Acc: 0.5309
 Site-SVHN                      (1) | Val  Loss: 1.7828 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7661
 Best site-MNIST                    (8)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8725
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8415
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8520
 Best site-USPS                     (5)  | Epoch:6 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7586
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.8783
 Best site-SynthDigits              (6)  | Epoch:6 | Val Acc: 0.6757
 Best site-SynthDigits              (6)  | Epoch:6 | Val Acc: 0.6618
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.5984
 Best site-MNIST_M                  (4)  | Epoch:6 | Val Acc: 0.4222
 Best site-MNIST_M                  (9)  | Epoch:6 | Val Acc: 0.5309
 Best site-SVHN                     (1)  | Epoch:6 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 2, 1, 5, 1, 1, 1, 1, 1, 6, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (8) | Train Loss: 0.6691 | Train Acc: 0.8333
 Site-MNIST                     (9) | Train Loss: 0.7397 | Train Acc: 0.9167
 Site-MNIST                     (5) | Train Loss: 0.5075 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.5115 | Train Acc: 0.8947
 Site-MNIST                     (9) | Train Loss: 0.5175 | Train Acc: 0.8429
 Site-MNIST                     (1) | Train Loss: 0.5875 | Train Acc: 0.8413
 Site-MNIST                     (9) | Train Loss: 0.5158 | Train Acc: 0.8899
 Site-MNIST                     (9) | Train Loss: 0.6261 | Train Acc: 0.8680
 Site-MNIST                     (9) | Train Loss: 0.6029 | Train Acc: 0.8655
 Site-MNIST                     (9) | Train Loss: 0.5757 | Train Acc: 0.8762
 Site-USPS                      (6) | Train Loss: 0.5687 | Train Acc: 0.8000
 Site-USPS                      (3) | Train Loss: 0.5780 | Train Acc: 0.9167
 Site-USPS                      (3) | Train Loss: 0.4334 | Train Acc: 0.8527
 Site-USPS                      (3) | Train Loss: 0.6738 | Train Acc: 0.8326
 Site-USPS                      (3) | Train Loss: 0.6201 | Train Acc: 0.8524
 Site-USPS                      (3) | Train Loss: 0.6262 | Train Acc: 0.8571
 Site-SynthDigits               (0) | Train Loss: 1.3303 | Train Acc: 0.5695
 Site-SynthDigits               (0) | Train Loss: 1.2966 | Train Acc: 0.6154
 Site-SynthDigits               (0) | Train Loss: 1.1995 | Train Acc: 0.6415
 Site-MNIST_M                   (7) | Train Loss: 1.5839 | Train Acc: 0.4475
 Site-MNIST_M                   (2) | Train Loss: 1.5173 | Train Acc: 0.5505
 Site-SVHN                      (4) | Train Loss: 1.7893 | Train Acc: 0.3723
Average Train Accuracy: 0.7724
 Site-MNIST                     (8) | Val  Loss: 0.2464 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.2402 | Val  Acc: 1.0000
 Site-MNIST                     (5) | Val  Loss: 0.4986 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.7257 | Val  Acc: 0.7778
 Site-MNIST                     (9) | Val  Loss: 0.6785 | Val  Acc: 0.8235
 Site-MNIST                     (1) | Val  Loss: 0.6482 | Val  Acc: 0.8710
 Site-MNIST                     (9) | Val  Loss: 0.5552 | Val  Acc: 0.9286
 Site-MNIST                     (9) | Val  Loss: 0.5614 | Val  Acc: 0.8922
 Site-MNIST                     (9) | Val  Loss: 0.6365 | Val  Acc: 0.8689
 Site-MNIST                     (9) | Val  Loss: 0.6061 | Val  Acc: 0.8640
 Site-USPS                      (6) | Val  Loss: 0.4277 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.8492 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.8909 | Val  Acc: 0.6562
 Site-USPS                      (3) | Val  Loss: 0.8146 | Val  Acc: 0.7414
 Site-USPS                      (3) | Val  Loss: 0.6815 | Val  Acc: 0.8381
 Site-USPS                      (3) | Val  Loss: 0.6082 | Val  Acc: 0.8783
 Site-SynthDigits               (0) | Val  Loss: 1.3350 | Val  Acc: 0.7297
 Site-SynthDigits               (0) | Val  Loss: 1.2523 | Val  Acc: 0.7206
 Site-SynthDigits               (0) | Val  Loss: 1.2270 | Val  Acc: 0.6393
 Site-MNIST_M                   (7) | Val  Loss: 1.6765 | Val  Acc: 0.4000
 Site-MNIST_M                   (2) | Val  Loss: 1.6042 | Val  Acc: 0.5185
 Site-SVHN                      (4) | Val  Loss: 1.6936 | Val  Acc: 0.3857
Average Valid Accuracy: 0.7707
 Best site-MNIST                    (8)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (9)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (5)  | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                    (9)  | Epoch:7 | Val Acc: 0.8235
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8710
 Best site-MNIST                    (9)  | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST                    (9)  | Epoch:7 | Val Acc: 0.8922
 Best site-MNIST                    (9)  | Epoch:7 | Val Acc: 0.8689
 Best site-MNIST                    (9)  | Epoch:7 | Val Acc: 0.8640
 Best site-USPS                     (6)  | Epoch:7 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.6562
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.7414
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8381
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8783
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.7297
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.7206
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.6393
 Best site-MNIST_M                  (7)  | Epoch:7 | Val Acc: 0.4000
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.5185
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.3857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 5, 1, 5, 1, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (5) | Train Loss: 0.6559 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.7652 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.5129 | Train Acc: 0.8571
 Site-MNIST                     (7) | Train Loss: 0.4938 | Train Acc: 0.8684
 Site-MNIST                     (1) | Train Loss: 0.4917 | Train Acc: 0.8143
 Site-MNIST                     (7) | Train Loss: 0.5895 | Train Acc: 0.8175
 Site-MNIST                     (1) | Train Loss: 0.5179 | Train Acc: 0.8855
 Site-MNIST                     (1) | Train Loss: 0.6125 | Train Acc: 0.8386
 Site-MNIST                     (1) | Train Loss: 0.5846 | Train Acc: 0.8560
 Site-MNIST                     (7) | Train Loss: 0.5636 | Train Acc: 0.8672
 Site-USPS                      (8) | Train Loss: 0.5117 | Train Acc: 0.8500
 Site-USPS                      (3) | Train Loss: 0.4896 | Train Acc: 0.9167
 Site-USPS                      (3) | Train Loss: 0.4312 | Train Acc: 0.8760
 Site-USPS                      (3) | Train Loss: 0.6291 | Train Acc: 0.8455
 Site-USPS                      (3) | Train Loss: 0.5796 | Train Acc: 0.8738
 Site-USPS                      (3) | Train Loss: 0.5861 | Train Acc: 0.8743
 Site-SynthDigits               (0) | Train Loss: 1.2412 | Train Acc: 0.6490
 Site-SynthDigits               (0) | Train Loss: 1.1765 | Train Acc: 0.6447
 Site-SynthDigits               (0) | Train Loss: 1.1194 | Train Acc: 0.6864
 Site-MNIST_M                   (9) | Train Loss: 1.5178 | Train Acc: 0.4807
 Site-MNIST_M                   (2) | Train Loss: 1.4039 | Train Acc: 0.5780
 Site-SVHN                      (4) | Train Loss: 1.7177 | Train Acc: 0.4149
Average Train Accuracy: 0.7800
 Site-MNIST                     (5) | Val  Loss: 0.1885 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.2012 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.4737 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.6751 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.6506 | Val  Acc: 0.7647
 Site-MNIST                     (7) | Val  Loss: 0.6280 | Val  Acc: 0.8387
 Site-MNIST                     (1) | Val  Loss: 0.5500 | Val  Acc: 0.8750
 Site-MNIST                     (1) | Val  Loss: 0.5507 | Val  Acc: 0.8627
 Site-MNIST                     (1) | Val  Loss: 0.6243 | Val  Acc: 0.8470
 Site-MNIST                     (7) | Val  Loss: 0.5912 | Val  Acc: 0.8520
 Site-USPS                      (8) | Val  Loss: 0.3902 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7882 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.8342 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 0.7884 | Val  Acc: 0.7931
 Site-USPS                      (3) | Val  Loss: 0.6492 | Val  Acc: 0.8476
 Site-USPS                      (3) | Val  Loss: 0.5679 | Val  Acc: 0.8783
 Site-SynthDigits               (0) | Val  Loss: 1.2391 | Val  Acc: 0.7027
 Site-SynthDigits               (0) | Val  Loss: 1.1622 | Val  Acc: 0.7647
 Site-SynthDigits               (0) | Val  Loss: 1.1280 | Val  Acc: 0.7049
 Site-MNIST_M                   (9) | Val  Loss: 1.5938 | Val  Acc: 0.4667
 Site-MNIST_M                   (2) | Val  Loss: 1.5139 | Val  Acc: 0.5802
 Site-SVHN                      (4) | Val  Loss: 1.5823 | Val  Acc: 0.4286
Average Valid Accuracy: 0.7784
 Best site-MNIST                    (5)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.7647
 Best site-MNIST                    (7)  | Epoch:8 | Val Acc: 0.8387
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8750
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8627
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8470
 Best site-MNIST                    (7)  | Epoch:8 | Val Acc: 0.8520
 Best site-USPS                     (8)  | Epoch:8 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7931
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.8476
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.8783
 Best site-SynthDigits              (0)  | Epoch:8 | Val Acc: 0.7027
 Best site-SynthDigits              (0)  | Epoch:8 | Val Acc: 0.7647
 Best site-SynthDigits              (0)  | Epoch:8 | Val Acc: 0.7049
 Best site-MNIST_M                  (9)  | Epoch:8 | Val Acc: 0.4667
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.5802
 Best site-SVHN                     (4)  | Epoch:8 | Val Acc: 0.4286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 6, 1, 5, 1, 1, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (7) | Train Loss: 0.5910 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.6862 | Train Acc: 0.8333
 Site-MNIST                     (5) | Train Loss: 0.4681 | Train Acc: 0.8571
 Site-MNIST                     (7) | Train Loss: 0.4391 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.4416 | Train Acc: 0.8143
 Site-MNIST                     (7) | Train Loss: 0.5312 | Train Acc: 0.8492
 Site-MNIST                     (1) | Train Loss: 0.4597 | Train Acc: 0.8987
 Site-MNIST                     (1) | Train Loss: 0.5604 | Train Acc: 0.8631
 Site-MNIST                     (1) | Train Loss: 0.5275 | Train Acc: 0.8723
 Site-MNIST                     (1) | Train Loss: 0.5074 | Train Acc: 0.8898
 Site-USPS                      (6) | Train Loss: 0.5098 | Train Acc: 0.8000
 Site-USPS                      (3) | Train Loss: 0.4388 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.5882 | Train Acc: 0.8527
 Site-USPS                      (3) | Train Loss: 0.6202 | Train Acc: 0.8369
 Site-USPS                      (3) | Train Loss: 0.5603 | Train Acc: 0.8667
 Site-USPS                      (3) | Train Loss: 0.5749 | Train Acc: 0.8690
 Site-SynthDigits               (8) | Train Loss: 1.2013 | Train Acc: 0.6424
 Site-SynthDigits               (8) | Train Loss: 1.1080 | Train Acc: 0.6557
 Site-SynthDigits               (2) | Train Loss: 1.0617 | Train Acc: 0.7047
 Site-MNIST_M                   (9) | Train Loss: 1.4388 | Train Acc: 0.5580
 Site-MNIST_M                   (4) | Train Loss: 1.3726 | Train Acc: 0.6208
 Site-SVHN                      (0) | Train Loss: 1.6406 | Train Acc: 0.4184
Average Train Accuracy: 0.7910
 Site-MNIST                     (7) | Val  Loss: 0.1522 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1689 | Val  Acc: 1.0000
 Site-MNIST                     (5) | Val  Loss: 0.4762 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.6652 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.6039 | Val  Acc: 0.8235
 Site-MNIST                     (7) | Val  Loss: 0.5641 | Val  Acc: 0.8710
 Site-MNIST                     (1) | Val  Loss: 0.4899 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.4971 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.5696 | Val  Acc: 0.8689
 Site-MNIST                     (1) | Val  Loss: 0.5378 | Val  Acc: 0.8671
 Site-USPS                      (6) | Val  Loss: 0.3859 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.8172 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.8581 | Val  Acc: 0.6562
 Site-USPS                      (3) | Val  Loss: 0.7726 | Val  Acc: 0.7586
 Site-USPS                      (3) | Val  Loss: 0.6381 | Val  Acc: 0.8190
 Site-USPS                      (3) | Val  Loss: 0.5562 | Val  Acc: 0.8730
 Site-SynthDigits               (8) | Val  Loss: 1.1781 | Val  Acc: 0.7027
 Site-SynthDigits               (8) | Val  Loss: 1.0921 | Val  Acc: 0.7500
 Site-SynthDigits               (2) | Val  Loss: 1.0845 | Val  Acc: 0.6967
 Site-MNIST_M                   (9) | Val  Loss: 1.5161 | Val  Acc: 0.5111
 Site-MNIST_M                   (4) | Val  Loss: 1.4327 | Val  Acc: 0.6420
 Site-SVHN                      (0) | Val  Loss: 1.5130 | Val  Acc: 0.4571
Average Valid Accuracy: 0.7859
 Best site-MNIST                    (7)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (5)  | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:9 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8235
 Best site-MNIST                    (7)  | Epoch:9 | Val Acc: 0.8710
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8689
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8671
 Best site-USPS                     (6)  | Epoch:9 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.6562
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.7586
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8190
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8730
 Best site-SynthDigits              (8)  | Epoch:9 | Val Acc: 0.7027
 Best site-SynthDigits              (8)  | Epoch:9 | Val Acc: 0.7500
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.6967
 Best site-MNIST_M                  (9)  | Epoch:9 | Val Acc: 0.5111
 Best site-MNIST_M                  (4)  | Epoch:9 | Val Acc: 0.6420
 Best site-SVHN                     (0)  | Epoch:9 | Val Acc: 0.4571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 10 ============
cnt=[5, 1, 3, 6, 1, 1, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (8) | Train Loss: 0.5804 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.6997 | Train Acc: 0.8333
 Site-MNIST                     (5) | Train Loss: 0.4678 | Train Acc: 0.8571
 Site-MNIST                     (9) | Train Loss: 0.4194 | Train Acc: 0.9211
 Site-MNIST                     (3) | Train Loss: 0.5673 | Train Acc: 0.8143
 Site-MNIST                     (9) | Train Loss: 0.5182 | Train Acc: 0.8413
 Site-MNIST                     (3) | Train Loss: 0.4250 | Train Acc: 0.9031
 Site-MNIST                     (3) | Train Loss: 0.5553 | Train Acc: 0.8729
 Site-MNIST                     (3) | Train Loss: 0.5236 | Train Acc: 0.8709
 Site-MNIST                     (3) | Train Loss: 0.4906 | Train Acc: 0.8838
 Site-USPS                      (6) | Train Loss: 0.4732 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4148 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.4090 | Train Acc: 0.8837
 Site-USPS                      (0) | Train Loss: 0.5842 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.5286 | Train Acc: 0.8714
 Site-USPS                      (0) | Train Loss: 0.5338 | Train Acc: 0.8743
 Site-SynthDigits               (2) | Train Loss: 1.1735 | Train Acc: 0.6623
 Site-SynthDigits               (2) | Train Loss: 1.0748 | Train Acc: 0.6667
 Site-SynthDigits               (2) | Train Loss: 1.0104 | Train Acc: 0.7169
 Site-MNIST_M                   (7) | Train Loss: 1.3925 | Train Acc: 0.5912
 Site-MNIST_M                   (1) | Train Loss: 1.2743 | Train Acc: 0.6208
 Site-SVHN                      (4) | Train Loss: 1.6082 | Train Acc: 0.4539
Average Train Accuracy: 0.7999
 Site-MNIST                     (8) | Val  Loss: 0.1221 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.1442 | Val  Acc: 1.0000
 Site-MNIST                     (5) | Val  Loss: 0.4630 | Val  Acc: 0.8000
 Site-MNIST                     (9) | Val  Loss: 0.6311 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.5780 | Val  Acc: 0.8235
 Site-MNIST                     (9) | Val  Loss: 0.5386 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.4799 | Val  Acc: 0.8929
 Site-MNIST                     (3) | Val  Loss: 0.4839 | Val  Acc: 0.8824
 Site-MNIST                     (3) | Val  Loss: 0.5519 | Val  Acc: 0.8634
 Site-MNIST                     (3) | Val  Loss: 0.5198 | Val  Acc: 0.8731
 Site-USPS                      (6) | Val  Loss: 0.3527 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7753 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.8170 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 0.7500 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.6095 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.5219 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 1.1106 | Val  Acc: 0.7297
 Site-SynthDigits               (2) | Val  Loss: 1.0267 | Val  Acc: 0.7647
 Site-SynthDigits               (2) | Val  Loss: 1.0087 | Val  Acc: 0.7377
 Site-MNIST_M                   (7) | Val  Loss: 1.4536 | Val  Acc: 0.6222
 Site-MNIST_M                   (1) | Val  Loss: 1.3632 | Val  Acc: 0.6790
 Site-SVHN                      (4) | Val  Loss: 1.4045 | Val  Acc: 0.4857
Average Valid Accuracy: 0.8011
 Best site-MNIST                    (8)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (5)  | Epoch:10 | Val Acc: 0.8000
 Best site-MNIST                    (9)  | Epoch:10 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8235
 Best site-MNIST                    (9)  | Epoch:10 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8929
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8824
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8634
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8731
 Best site-USPS                     (6)  | Epoch:10 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.7297
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.7647
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.7377
 Best site-MNIST_M                  (7)  | Epoch:10 | Val Acc: 0.6222
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6790
 Best site-SVHN                     (4)  | Epoch:10 | Val Acc: 0.4857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 1, 3, 6, 1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (7) | Train Loss: 0.5826 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.6381 | Train Acc: 0.8333
 Site-MNIST                     (5) | Train Loss: 0.4247 | Train Acc: 0.8571
 Site-MNIST                     (7) | Train Loss: 0.3748 | Train Acc: 0.8947
 Site-MNIST                     (3) | Train Loss: 0.7780 | Train Acc: 0.8429
 Site-MNIST                     (7) | Train Loss: 0.4616 | Train Acc: 0.8571
 Site-MNIST                     (3) | Train Loss: 0.4155 | Train Acc: 0.9075
 Site-MNIST                     (3) | Train Loss: 0.4914 | Train Acc: 0.8753
 Site-MNIST                     (3) | Train Loss: 0.4812 | Train Acc: 0.8927
 Site-MNIST                     (3) | Train Loss: 0.4499 | Train Acc: 0.8974
 Site-USPS                      (6) | Train Loss: 0.4847 | Train Acc: 0.8250
 Site-USPS                      (0) | Train Loss: 0.5179 | Train Acc: 0.9444
 Site-USPS                      (9) | Train Loss: 0.3895 | Train Acc: 0.8837
 Site-USPS                      (9) | Train Loss: 0.5681 | Train Acc: 0.8412
 Site-USPS                      (9) | Train Loss: 0.4993 | Train Acc: 0.8690
 Site-USPS                      (9) | Train Loss: 0.5277 | Train Acc: 0.8783
 Site-SynthDigits               (2) | Train Loss: 1.0723 | Train Acc: 0.6887
 Site-SynthDigits               (2) | Train Loss: 1.0029 | Train Acc: 0.6996
 Site-SynthDigits               (2) | Train Loss: 0.9476 | Train Acc: 0.7515
 Site-MNIST_M                   (4) | Train Loss: 1.3280 | Train Acc: 0.5967
 Site-MNIST_M                   (8) | Train Loss: 1.2816 | Train Acc: 0.6391
 Site-SVHN                      (1) | Train Loss: 1.5172 | Train Acc: 0.4787
Average Train Accuracy: 0.8085
 Site-MNIST                     (7) | Val  Loss: 0.1133 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.1341 | Val  Acc: 1.0000
 Site-MNIST                     (5) | Val  Loss: 0.4534 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.6067 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.5367 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.4938 | Val  Acc: 0.9032
 Site-MNIST                     (3) | Val  Loss: 0.4396 | Val  Acc: 0.9286
 Site-MNIST                     (3) | Val  Loss: 0.4468 | Val  Acc: 0.9020
 Site-MNIST                     (3) | Val  Loss: 0.5063 | Val  Acc: 0.8743
 Site-MNIST                     (3) | Val  Loss: 0.4809 | Val  Acc: 0.8731
 Site-USPS                      (6) | Val  Loss: 0.3575 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.8004 | Val  Acc: 0.7222
 Site-USPS                      (9) | Val  Loss: 0.8349 | Val  Acc: 0.6875
 Site-USPS                      (9) | Val  Loss: 0.7292 | Val  Acc: 0.7414
 Site-USPS                      (9) | Val  Loss: 0.5963 | Val  Acc: 0.8190
 Site-USPS                      (9) | Val  Loss: 0.5150 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 1.0545 | Val  Acc: 0.7838
 Site-SynthDigits               (2) | Val  Loss: 0.9584 | Val  Acc: 0.7794
 Site-SynthDigits               (2) | Val  Loss: 0.9587 | Val  Acc: 0.7377
 Site-MNIST_M                   (4) | Val  Loss: 1.4127 | Val  Acc: 0.5778
 Site-MNIST_M                   (8) | Val  Loss: 1.3138 | Val  Acc: 0.6667
 Site-SVHN                      (1) | Val  Loss: 1.3237 | Val  Acc: 0.5286
Average Valid Accuracy: 0.8074
 Best site-MNIST                    (7)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:11 | Val Acc: 0.8824
 Best site-MNIST                    (7)  | Epoch:11 | Val Acc: 0.9032
 Best site-MNIST                    (3)  | Epoch:11 | Val Acc: 0.9286
 Best site-MNIST                    (3)  | Epoch:11 | Val Acc: 0.9020
 Best site-MNIST                    (3)  | Epoch:11 | Val Acc: 0.8743
 Best site-MNIST                    (3)  | Epoch:11 | Val Acc: 0.8731
 Best site-USPS                     (6)  | Epoch:11 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.7222
 Best site-USPS                     (9)  | Epoch:11 | Val Acc: 0.6875
 Best site-USPS                     (9)  | Epoch:11 | Val Acc: 0.7414
 Best site-USPS                     (9)  | Epoch:11 | Val Acc: 0.8190
 Best site-USPS                     (9)  | Epoch:11 | Val Acc: 0.8783
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7838
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7794
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7377
 Best site-MNIST_M                  (4)  | Epoch:11 | Val Acc: 0.5778
 Best site-MNIST_M                  (8)  | Epoch:11 | Val Acc: 0.6667
 Best site-SVHN                     (1)  | Epoch:11 | Val Acc: 0.5286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 1, 2, 1, 2, 1, 7, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (6) | Train Loss: 0.5786 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.5986 | Train Acc: 0.8333
 Site-MNIST                     (5) | Train Loss: 0.4088 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3565 | Train Acc: 0.8947
 Site-MNIST                     (6) | Train Loss: 0.4938 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.4422 | Train Acc: 0.8651
 Site-MNIST                     (6) | Train Loss: 0.3680 | Train Acc: 0.9207
 Site-MNIST                     (6) | Train Loss: 0.4668 | Train Acc: 0.8753
 Site-MNIST                     (6) | Train Loss: 0.4544 | Train Acc: 0.8913
 Site-MNIST                     (6) | Train Loss: 0.4269 | Train Acc: 0.9019
 Site-USPS                      (7) | Train Loss: 0.4655 | Train Acc: 0.8500
 Site-USPS                      (4) | Train Loss: 0.4485 | Train Acc: 0.9306
 Site-USPS                      (4) | Train Loss: 0.5258 | Train Acc: 0.8682
 Site-USPS                      (9) | Train Loss: 0.5587 | Train Acc: 0.8412
 Site-USPS                      (9) | Train Loss: 0.4886 | Train Acc: 0.8810
 Site-USPS                      (9) | Train Loss: 0.4993 | Train Acc: 0.8796
 Site-SynthDigits               (8) | Train Loss: 1.0363 | Train Acc: 0.7086
 Site-SynthDigits               (8) | Train Loss: 0.9371 | Train Acc: 0.7326
 Site-SynthDigits               (3) | Train Loss: 0.9005 | Train Acc: 0.7597
 Site-MNIST_M                   (2) | Train Loss: 1.2602 | Train Acc: 0.6354
 Site-MNIST_M                   (2) | Train Loss: 1.3329 | Train Acc: 0.6483
 Site-SVHN                      (1) | Train Loss: 1.4679 | Train Acc: 0.5213
Average Train Accuracy: 0.8163
 Site-MNIST                     (6) | Val  Loss: 0.0822 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.1202 | Val  Acc: 1.0000
 Site-MNIST                     (5) | Val  Loss: 0.4579 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6035 | Val  Acc: 0.7778
 Site-MNIST                     (6) | Val  Loss: 0.5201 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4712 | Val  Acc: 0.9032
 Site-MNIST                     (6) | Val  Loss: 0.4204 | Val  Acc: 0.9286
 Site-MNIST                     (6) | Val  Loss: 0.4281 | Val  Acc: 0.8922
 Site-MNIST                     (6) | Val  Loss: 0.4834 | Val  Acc: 0.8743
 Site-MNIST                     (6) | Val  Loss: 0.4599 | Val  Acc: 0.8852
 Site-USPS                      (7) | Val  Loss: 0.3313 | Val  Acc: 0.9000
 Site-USPS                      (4) | Val  Loss: 0.7623 | Val  Acc: 0.7222
 Site-USPS                      (4) | Val  Loss: 0.7919 | Val  Acc: 0.7188
 Site-USPS                      (9) | Val  Loss: 0.6952 | Val  Acc: 0.7931
 Site-USPS                      (9) | Val  Loss: 0.5720 | Val  Acc: 0.8381
 Site-USPS                      (9) | Val  Loss: 0.4914 | Val  Acc: 0.8783
 Site-SynthDigits               (8) | Val  Loss: 0.9920 | Val  Acc: 0.7838
 Site-SynthDigits               (8) | Val  Loss: 0.8893 | Val  Acc: 0.7794
 Site-SynthDigits               (3) | Val  Loss: 0.9154 | Val  Acc: 0.7459
 Site-MNIST_M                   (2) | Val  Loss: 1.3347 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.2326 | Val  Acc: 0.7037
 Site-SVHN                      (1) | Val  Loss: 1.2757 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8192
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST                    (5)  | Epoch:12 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.7778
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9032
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.9286
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8922
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8743
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8852
 Best site-USPS                     (7)  | Epoch:12 | Val Acc: 0.9000
 Best site-USPS                     (4)  | Epoch:12 | Val Acc: 0.7222
 Best site-USPS                     (4)  | Epoch:12 | Val Acc: 0.7188
 Best site-USPS                     (9)  | Epoch:12 | Val Acc: 0.7931
 Best site-USPS                     (9)  | Epoch:12 | Val Acc: 0.8381
 Best site-USPS                     (9)  | Epoch:12 | Val Acc: 0.8783
 Best site-SynthDigits              (8)  | Epoch:12 | Val Acc: 0.7838
 Best site-SynthDigits              (8)  | Epoch:12 | Val Acc: 0.7794
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.7459
 Best site-MNIST_M                  (2)  | Epoch:12 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:12 | Val Acc: 0.7037
 Best site-SVHN                     (1)  | Epoch:12 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 4, 1, 1, 1, 4, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (1) | Train Loss: 0.5693 | Train Acc: 0.8333
 Site-MNIST                     (9) | Train Loss: 0.6009 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.4021 | Train Acc: 0.8571
 Site-MNIST                     (5) | Train Loss: 0.3438 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.3535 | Train Acc: 0.8429
 Site-MNIST                     (5) | Train Loss: 0.4304 | Train Acc: 0.8651
 Site-MNIST                     (5) | Train Loss: 0.3695 | Train Acc: 0.9119
 Site-MNIST                     (5) | Train Loss: 0.5005 | Train Acc: 0.8802
 Site-MNIST                     (1) | Train Loss: 0.4469 | Train Acc: 0.8886
 Site-MNIST                     (1) | Train Loss: 0.4141 | Train Acc: 0.9011
 Site-USPS                      (3) | Train Loss: 0.4222 | Train Acc: 0.8750
 Site-USPS                      (6) | Train Loss: 0.3732 | Train Acc: 0.9444
 Site-USPS                      (6) | Train Loss: 0.3258 | Train Acc: 0.8682
 Site-USPS                      (6) | Train Loss: 0.5212 | Train Acc: 0.8455
 Site-USPS                      (6) | Train Loss: 0.4577 | Train Acc: 0.8786
 Site-USPS                      (6) | Train Loss: 0.4651 | Train Acc: 0.8862
 Site-SynthDigits               (0) | Train Loss: 0.9699 | Train Acc: 0.7152
 Site-SynthDigits               (0) | Train Loss: 0.9308 | Train Acc: 0.7253
 Site-SynthDigits               (0) | Train Loss: 0.8546 | Train Acc: 0.7760
 Site-MNIST_M                   (8) | Train Loss: 1.2219 | Train Acc: 0.6630
 Site-MNIST_M                   (2) | Train Loss: 1.2225 | Train Acc: 0.6606
 Site-SVHN                      (4) | Train Loss: 1.4194 | Train Acc: 0.5248
Average Train Accuracy: 0.8226
 Site-MNIST                     (1) | Val  Loss: 0.0704 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.1057 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4370 | Val  Acc: 0.8000
 Site-MNIST                     (5) | Val  Loss: 0.5751 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4961 | Val  Acc: 0.8824
 Site-MNIST                     (5) | Val  Loss: 0.4496 | Val  Acc: 0.9032
 Site-MNIST                     (5) | Val  Loss: 0.4084 | Val  Acc: 0.9107
 Site-MNIST                     (5) | Val  Loss: 0.4143 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.4717 | Val  Acc: 0.8798
 Site-MNIST                     (1) | Val  Loss: 0.4457 | Val  Acc: 0.8882
 Site-USPS                      (3) | Val  Loss: 0.3068 | Val  Acc: 0.9000
 Site-USPS                      (6) | Val  Loss: 0.7227 | Val  Acc: 0.7222
 Site-USPS                      (6) | Val  Loss: 0.7523 | Val  Acc: 0.6875
 Site-USPS                      (6) | Val  Loss: 0.6712 | Val  Acc: 0.7759
 Site-USPS                      (6) | Val  Loss: 0.5459 | Val  Acc: 0.8381
 Site-USPS                      (6) | Val  Loss: 0.4603 | Val  Acc: 0.8889
 Site-SynthDigits               (0) | Val  Loss: 0.9394 | Val  Acc: 0.7838
 Site-SynthDigits               (0) | Val  Loss: 0.8519 | Val  Acc: 0.7794
 Site-SynthDigits               (0) | Val  Loss: 0.8733 | Val  Acc: 0.7705
 Site-MNIST_M                   (8) | Val  Loss: 1.2992 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 1.1838 | Val  Acc: 0.7407
 Site-SVHN                      (4) | Val  Loss: 1.2278 | Val  Acc: 0.5857
Average Valid Accuracy: 0.8211
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (9)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:13 | Val Acc: 0.8000
 Best site-MNIST                    (5)  | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                    (5)  | Epoch:13 | Val Acc: 0.9032
 Best site-MNIST                    (5)  | Epoch:13 | Val Acc: 0.9107
 Best site-MNIST                    (5)  | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.8798
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.8882
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.9000
 Best site-USPS                     (6)  | Epoch:13 | Val Acc: 0.7222
 Best site-USPS                     (6)  | Epoch:13 | Val Acc: 0.6875
 Best site-USPS                     (6)  | Epoch:13 | Val Acc: 0.7759
 Best site-USPS                     (6)  | Epoch:13 | Val Acc: 0.8381
 Best site-USPS                     (6)  | Epoch:13 | Val Acc: 0.8889
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.7838
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.7794
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.7705
 Best site-MNIST_M                  (8)  | Epoch:13 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:13 | Val Acc: 0.7407
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.5857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 14 ============
cnt=[5, 2, 5, 2, 1, 1, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (6) | Train Loss: 0.5693 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5831 | Train Acc: 0.8333
 Site-MNIST                     (8) | Train Loss: 0.3900 | Train Acc: 0.8571
 Site-MNIST                     (7) | Train Loss: 0.3204 | Train Acc: 0.9211
 Site-MNIST                     (2) | Train Loss: 0.5612 | Train Acc: 0.8286
 Site-MNIST                     (7) | Train Loss: 0.4033 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3512 | Train Acc: 0.9207
 Site-MNIST                     (2) | Train Loss: 0.4356 | Train Acc: 0.8900
 Site-MNIST                     (2) | Train Loss: 0.4216 | Train Acc: 0.8954
 Site-MNIST                     (8) | Train Loss: 0.3878 | Train Acc: 0.9026
 Site-USPS                      (5) | Train Loss: 0.4169 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4334 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.3376 | Train Acc: 0.8915
 Site-USPS                      (0) | Train Loss: 0.5053 | Train Acc: 0.8541
 Site-USPS                      (0) | Train Loss: 0.4402 | Train Acc: 0.8929
 Site-USPS                      (0) | Train Loss: 0.4590 | Train Acc: 0.8929
 Site-SynthDigits               (3) | Train Loss: 1.0352 | Train Acc: 0.7152
 Site-SynthDigits               (3) | Train Loss: 0.8811 | Train Acc: 0.7509
 Site-SynthDigits               (9) | Train Loss: 0.8274 | Train Acc: 0.7963
 Site-MNIST_M                   (1) | Train Loss: 1.1992 | Train Acc: 0.6354
 Site-MNIST_M                   (1) | Train Loss: 1.2079 | Train Acc: 0.6789
 Site-SVHN                      (4) | Train Loss: 1.4061 | Train Acc: 0.5390
Average Train Accuracy: 0.8264
 Site-MNIST                     (6) | Val  Loss: 0.0609 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0964 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.4532 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5814 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.4812 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.4185 | Val  Acc: 0.9032
 Site-MNIST                     (2) | Val  Loss: 0.3777 | Val  Acc: 0.9107
 Site-MNIST                     (2) | Val  Loss: 0.3870 | Val  Acc: 0.8922
 Site-MNIST                     (2) | Val  Loss: 0.4456 | Val  Acc: 0.8907
 Site-MNIST                     (8) | Val  Loss: 0.4224 | Val  Acc: 0.9003
 Site-USPS                      (5) | Val  Loss: 0.2806 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7134 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.7558 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 0.6638 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.5386 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.4513 | Val  Acc: 0.8783
 Site-SynthDigits               (3) | Val  Loss: 0.8999 | Val  Acc: 0.7568
 Site-SynthDigits               (3) | Val  Loss: 0.8122 | Val  Acc: 0.8088
 Site-SynthDigits               (9) | Val  Loss: 0.8442 | Val  Acc: 0.7869
 Site-MNIST_M                   (1) | Val  Loss: 1.2541 | Val  Acc: 0.6444
 Site-MNIST_M                   (1) | Val  Loss: 1.1395 | Val  Acc: 0.7037
 Site-SVHN                      (4) | Val  Loss: 1.1675 | Val  Acc: 0.5857
Average Valid Accuracy: 0.8206
============ Train epoch 15 ============
cnt=[5, 1, 5, 3, 1, 1, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (5) | Train Loss: 0.5557 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5461 | Train Acc: 0.8333
 Site-MNIST                     (8) | Train Loss: 0.3559 | Train Acc: 0.8571
 Site-MNIST                     (9) | Train Loss: 0.2931 | Train Acc: 0.9211
 Site-MNIST                     (2) | Train Loss: 0.6049 | Train Acc: 0.8571
 Site-MNIST                     (9) | Train Loss: 0.3714 | Train Acc: 0.8968
 Site-MNIST                     (2) | Train Loss: 0.3289 | Train Acc: 0.9251
 Site-MNIST                     (2) | Train Loss: 0.4121 | Train Acc: 0.8949
 Site-MNIST                     (2) | Train Loss: 0.3957 | Train Acc: 0.8981
 Site-MNIST                     (9) | Train Loss: 0.3646 | Train Acc: 0.9155
 Site-USPS                      (6) | Train Loss: 0.4224 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.6314 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.3333 | Train Acc: 0.9070
 Site-USPS                      (0) | Train Loss: 0.5044 | Train Acc: 0.8498
 Site-USPS                      (0) | Train Loss: 0.4405 | Train Acc: 0.8905
 Site-USPS                      (0) | Train Loss: 0.4541 | Train Acc: 0.8902
 Site-SynthDigits               (3) | Train Loss: 0.8735 | Train Acc: 0.7285
 Site-SynthDigits               (3) | Train Loss: 0.8197 | Train Acc: 0.7546
 Site-SynthDigits               (3) | Train Loss: 0.7752 | Train Acc: 0.8045
 Site-MNIST_M                   (7) | Train Loss: 1.1374 | Train Acc: 0.6740
 Site-MNIST_M                   (1) | Train Loss: 1.0379 | Train Acc: 0.6911
 Site-SVHN                      (4) | Train Loss: 1.3539 | Train Acc: 0.5603
Average Train Accuracy: 0.8358
 Site-MNIST                     (5) | Val  Loss: 0.0523 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0830 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.4435 | Val  Acc: 0.8000
 Site-MNIST                     (9) | Val  Loss: 0.5566 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.4549 | Val  Acc: 0.8824
 Site-MNIST                     (9) | Val  Loss: 0.4013 | Val  Acc: 0.9032
 Site-MNIST                     (2) | Val  Loss: 0.3610 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.3691 | Val  Acc: 0.9020
 Site-MNIST                     (2) | Val  Loss: 0.4188 | Val  Acc: 0.8962
 Site-MNIST                     (9) | Val  Loss: 0.3993 | Val  Acc: 0.9063
 Site-USPS                      (6) | Val  Loss: 0.2908 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7232 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.7594 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.6549 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.5382 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.4505 | Val  Acc: 0.8730
 Site-SynthDigits               (3) | Val  Loss: 0.8641 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.7419 | Val  Acc: 0.8235
 Site-SynthDigits               (3) | Val  Loss: 0.8092 | Val  Acc: 0.7951
 Site-MNIST_M                   (7) | Val  Loss: 1.1934 | Val  Acc: 0.6667
 Site-MNIST_M                   (1) | Val  Loss: 1.0821 | Val  Acc: 0.7407
 Site-SVHN                      (4) | Val  Loss: 1.0998 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8292
 Best site-MNIST                    (5)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (8)  | Epoch:15 | Val Acc: 0.8000
 Best site-MNIST                    (9)  | Epoch:15 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8824
 Best site-MNIST                    (9)  | Epoch:15 | Val Acc: 0.9032
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9020
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8962
 Best site-MNIST                    (9)  | Epoch:15 | Val Acc: 0.9063
 Best site-USPS                     (6)  | Epoch:15 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8730
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.8235
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.7951
 Best site-MNIST_M                  (7)  | Epoch:15 | Val Acc: 0.6667
 Best site-MNIST_M                  (1)  | Epoch:15 | Val Acc: 0.7407
 Best site-SVHN                     (4)  | Epoch:15 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 7, 1, 3, 1, 1, 2, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (5) | Train Loss: 0.5537 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.5179 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.3155 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2672 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.3619 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.3325 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2968 | Train Acc: 0.9251
 Site-MNIST                     (1) | Train Loss: 0.3746 | Train Acc: 0.9046
 Site-MNIST                     (1) | Train Loss: 0.3701 | Train Acc: 0.9117
 Site-MNIST                     (6) | Train Loss: 0.3374 | Train Acc: 0.9215
 Site-USPS                      (8) | Train Loss: 0.4177 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.3642 | Train Acc: 0.9444
 Site-USPS                      (9) | Train Loss: 0.3791 | Train Acc: 0.8915
 Site-USPS                      (9) | Train Loss: 0.4874 | Train Acc: 0.8455
 Site-USPS                      (9) | Train Loss: 0.4194 | Train Acc: 0.8929
 Site-USPS                      (9) | Train Loss: 0.4399 | Train Acc: 0.8915
 Site-SynthDigits               (3) | Train Loss: 0.9402 | Train Acc: 0.7285
 Site-SynthDigits               (3) | Train Loss: 0.8211 | Train Acc: 0.7619
 Site-SynthDigits               (3) | Train Loss: 0.7432 | Train Acc: 0.8248
 Site-MNIST_M                   (7) | Train Loss: 1.1220 | Train Acc: 0.6519
 Site-MNIST_M                   (2) | Train Loss: 1.0810 | Train Acc: 0.6850
 Site-SVHN                      (4) | Train Loss: 1.2924 | Train Acc: 0.5674
Average Train Accuracy: 0.8399
 Site-MNIST                     (5) | Val  Loss: 0.0517 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.4355 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5500 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4315 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.3703 | Val  Acc: 0.9032
 Site-MNIST                     (1) | Val  Loss: 0.3297 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3389 | Val  Acc: 0.9020
 Site-MNIST                     (1) | Val  Loss: 0.3888 | Val  Acc: 0.9126
 Site-MNIST                     (6) | Val  Loss: 0.3717 | Val  Acc: 0.9094
 Site-USPS                      (8) | Val  Loss: 0.2748 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7310 | Val  Acc: 0.7222
 Site-USPS                      (9) | Val  Loss: 0.7670 | Val  Acc: 0.6875
 Site-USPS                      (9) | Val  Loss: 0.6450 | Val  Acc: 0.7931
 Site-USPS                      (9) | Val  Loss: 0.5243 | Val  Acc: 0.8190
 Site-USPS                      (9) | Val  Loss: 0.4369 | Val  Acc: 0.8677
 Site-SynthDigits               (3) | Val  Loss: 0.8293 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.7134 | Val  Acc: 0.8235
 Site-SynthDigits               (3) | Val  Loss: 0.7772 | Val  Acc: 0.7869
 Site-MNIST_M                   (7) | Val  Loss: 1.1966 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 1.0690 | Val  Acc: 0.7284
 Site-SVHN                      (4) | Val  Loss: 1.0713 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8270
============ Train epoch 17 ============
cnt=[6, 1, 1, 3, 1, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (6) | Train Loss: 0.5544 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5079 | Train Acc: 0.8333
 Site-MNIST                     (8) | Train Loss: 0.3230 | Train Acc: 0.8571
 Site-MNIST                     (7) | Train Loss: 0.2610 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.3565 | Train Acc: 0.8571
 Site-MNIST                     (7) | Train Loss: 0.3319 | Train Acc: 0.9127
 Site-MNIST                     (0) | Train Loss: 0.2841 | Train Acc: 0.9295
 Site-MNIST                     (0) | Train Loss: 0.3793 | Train Acc: 0.9046
 Site-MNIST                     (0) | Train Loss: 0.3627 | Train Acc: 0.9090
 Site-MNIST                     (0) | Train Loss: 0.3316 | Train Acc: 0.9200
 Site-USPS                      (2) | Train Loss: 0.3710 | Train Acc: 0.8750
 Site-USPS                      (5) | Train Loss: 0.3894 | Train Acc: 0.9444
 Site-USPS                      (5) | Train Loss: 0.4008 | Train Acc: 0.9147
 Site-USPS                      (5) | Train Loss: 0.4702 | Train Acc: 0.8627
 Site-USPS                      (5) | Train Loss: 0.3960 | Train Acc: 0.9024
 Site-USPS                      (5) | Train Loss: 0.4096 | Train Acc: 0.8981
 Site-SynthDigits               (3) | Train Loss: 0.8284 | Train Acc: 0.7550
 Site-SynthDigits               (3) | Train Loss: 0.7717 | Train Acc: 0.7839
 Site-SynthDigits               (3) | Train Loss: 0.7177 | Train Acc: 0.8310
 Site-MNIST_M                   (4) | Train Loss: 1.0834 | Train Acc: 0.6796
 Site-MNIST_M                   (9) | Train Loss: 1.0281 | Train Acc: 0.7003
 Site-SVHN                      (1) | Train Loss: 1.3060 | Train Acc: 0.5851
Average Train Accuracy: 0.8459
 Site-MNIST                     (6) | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0708 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.4471 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5529 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4261 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.3611 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.3244 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.3342 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.3843 | Val  Acc: 0.9071
 Site-MNIST                     (0) | Val  Loss: 0.3658 | Val  Acc: 0.9124
 Site-USPS                      (2) | Val  Loss: 0.2491 | Val  Acc: 0.9000
 Site-USPS                      (5) | Val  Loss: 0.6824 | Val  Acc: 0.7222
 Site-USPS                      (5) | Val  Loss: 0.7161 | Val  Acc: 0.7188
 Site-USPS                      (5) | Val  Loss: 0.6210 | Val  Acc: 0.7931
 Site-USPS                      (5) | Val  Loss: 0.5000 | Val  Acc: 0.8381
 Site-USPS                      (5) | Val  Loss: 0.4130 | Val  Acc: 0.8783
 Site-SynthDigits               (3) | Val  Loss: 0.7761 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.6513 | Val  Acc: 0.8088
 Site-SynthDigits               (3) | Val  Loss: 0.7367 | Val  Acc: 0.8197
 Site-MNIST_M                   (4) | Val  Loss: 1.1597 | Val  Acc: 0.6889
 Site-MNIST_M                   (9) | Val  Loss: 1.0338 | Val  Acc: 0.7531
 Site-SVHN                      (1) | Val  Loss: 1.0388 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8352
 Best site-MNIST                    (6)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (8)  | Epoch:17 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:17 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8824
 Best site-MNIST                    (7)  | Epoch:17 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9071
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9124
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9000
 Best site-USPS                     (5)  | Epoch:17 | Val Acc: 0.7222
 Best site-USPS                     (5)  | Epoch:17 | Val Acc: 0.7188
 Best site-USPS                     (5)  | Epoch:17 | Val Acc: 0.7931
 Best site-USPS                     (5)  | Epoch:17 | Val Acc: 0.8381
 Best site-USPS                     (5)  | Epoch:17 | Val Acc: 0.8783
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.8088
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.8197
 Best site-MNIST_M                  (4)  | Epoch:17 | Val Acc: 0.6889
 Best site-MNIST_M                  (9)  | Epoch:17 | Val Acc: 0.7531
 Best site-SVHN                     (1)  | Epoch:17 | Val Acc: 0.6571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 18 ============
cnt=[5, 3, 1, 3, 1, 1, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (5) | Train Loss: 0.5324 | Train Acc: 0.8333
 Site-MNIST                     (8) | Train Loss: 0.4889 | Train Acc: 0.8333
 Site-MNIST                     (9) | Train Loss: 0.2973 | Train Acc: 0.9048
 Site-MNIST                     (8) | Train Loss: 0.2495 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.3334 | Train Acc: 0.8857
 Site-MNIST                     (8) | Train Loss: 0.3089 | Train Acc: 0.9206
 Site-MNIST                     (8) | Train Loss: 0.2767 | Train Acc: 0.9383
 Site-MNIST                     (8) | Train Loss: 0.3501 | Train Acc: 0.9095
 Site-MNIST                     (1) | Train Loss: 0.3473 | Train Acc: 0.9130
 Site-MNIST                     (1) | Train Loss: 0.3109 | Train Acc: 0.9260
 Site-USPS                      (6) | Train Loss: 0.3739 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.4350 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.3456 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.4560 | Train Acc: 0.8541
 Site-USPS                      (0) | Train Loss: 0.3841 | Train Acc: 0.8976
 Site-USPS                      (0) | Train Loss: 0.4083 | Train Acc: 0.8955
 Site-SynthDigits               (3) | Train Loss: 0.8492 | Train Acc: 0.7815
 Site-SynthDigits               (3) | Train Loss: 0.7535 | Train Acc: 0.7912
 Site-SynthDigits               (3) | Train Loss: 0.6882 | Train Acc: 0.8289
 Site-MNIST_M                   (7) | Train Loss: 1.0402 | Train Acc: 0.6906
 Site-MNIST_M                   (2) | Train Loss: 1.0728 | Train Acc: 0.6942
 Site-SVHN                      (4) | Train Loss: 1.2814 | Train Acc: 0.5922
Average Train Accuracy: 0.8536
 Site-MNIST                     (5) | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.0626 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.4478 | Val  Acc: 0.8000
 Site-MNIST                     (8) | Val  Loss: 0.5435 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4096 | Val  Acc: 0.8824
 Site-MNIST                     (8) | Val  Loss: 0.3417 | Val  Acc: 0.9355
 Site-MNIST                     (8) | Val  Loss: 0.3064 | Val  Acc: 0.9464
 Site-MNIST                     (8) | Val  Loss: 0.3159 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.3667 | Val  Acc: 0.9126
 Site-MNIST                     (1) | Val  Loss: 0.3476 | Val  Acc: 0.9215
 Site-USPS                      (6) | Val  Loss: 0.2495 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.6838 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.7180 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 0.6175 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.4950 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.4048 | Val  Acc: 0.8836
 Site-SynthDigits               (3) | Val  Loss: 0.7480 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.6250 | Val  Acc: 0.8235
 Site-SynthDigits               (3) | Val  Loss: 0.7203 | Val  Acc: 0.8197
 Site-MNIST_M                   (7) | Val  Loss: 1.1173 | Val  Acc: 0.7111
 Site-MNIST_M                   (2) | Val  Loss: 0.9904 | Val  Acc: 0.7778
 Site-SVHN                      (4) | Val  Loss: 1.0063 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8385
 Best site-MNIST                    (5)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (8)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (9)  | Epoch:18 | Val Acc: 0.8000
 Best site-MNIST                    (8)  | Epoch:18 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.8824
 Best site-MNIST                    (8)  | Epoch:18 | Val Acc: 0.9355
 Best site-MNIST                    (8)  | Epoch:18 | Val Acc: 0.9464
 Best site-MNIST                    (8)  | Epoch:18 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9126
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9215
 Best site-USPS                     (6)  | Epoch:18 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8836
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8235
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8197
 Best site-MNIST_M                  (7)  | Epoch:18 | Val Acc: 0.7111
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7778
 Best site-SVHN                     (4)  | Epoch:18 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 19 ============
cnt=[3, 3, 1, 1, 1, 5, 1, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (6) | Train Loss: 0.5608 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4959 | Train Acc: 0.8333
 Site-MNIST                     (9) | Train Loss: 0.3177 | Train Acc: 0.8571
 Site-MNIST                     (7) | Train Loss: 0.2496 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.2406 | Train Acc: 0.8714
 Site-MNIST                     (7) | Train Loss: 0.3165 | Train Acc: 0.9048
 Site-MNIST                     (9) | Train Loss: 0.2840 | Train Acc: 0.9295
 Site-MNIST                     (9) | Train Loss: 0.3582 | Train Acc: 0.8998
 Site-MNIST                     (9) | Train Loss: 0.3483 | Train Acc: 0.9117
 Site-MNIST                     (0) | Train Loss: 0.3122 | Train Acc: 0.9208
 Site-USPS                      (2) | Train Loss: 0.3586 | Train Acc: 0.8750
 Site-USPS                      (5) | Train Loss: 0.3691 | Train Acc: 0.9444
 Site-USPS                      (5) | Train Loss: 0.2750 | Train Acc: 0.9225
 Site-USPS                      (5) | Train Loss: 0.4421 | Train Acc: 0.8627
 Site-USPS                      (5) | Train Loss: 0.3705 | Train Acc: 0.9119
 Site-USPS                      (5) | Train Loss: 0.3865 | Train Acc: 0.9048
 Site-SynthDigits               (1) | Train Loss: 0.8494 | Train Acc: 0.7748
 Site-SynthDigits               (1) | Train Loss: 0.7686 | Train Acc: 0.8059
 Site-SynthDigits               (1) | Train Loss: 0.6676 | Train Acc: 0.8411
 Site-MNIST_M                   (8) | Train Loss: 1.0250 | Train Acc: 0.6851
 Site-MNIST_M                   (3) | Train Loss: 0.9645 | Train Acc: 0.7034
 Site-SVHN                      (4) | Train Loss: 1.2454 | Train Acc: 0.6135
Average Train Accuracy: 0.8525
 Site-MNIST                     (6) | Val  Loss: 0.0300 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0600 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.4612 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5518 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4148 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.3396 | Val  Acc: 0.9355
 Site-MNIST                     (9) | Val  Loss: 0.3077 | Val  Acc: 0.9464
 Site-MNIST                     (9) | Val  Loss: 0.3178 | Val  Acc: 0.9118
 Site-MNIST                     (9) | Val  Loss: 0.3660 | Val  Acc: 0.9126
 Site-MNIST                     (0) | Val  Loss: 0.3493 | Val  Acc: 0.9124
 Site-USPS                      (2) | Val  Loss: 0.2226 | Val  Acc: 0.9000
 Site-USPS                      (5) | Val  Loss: 0.6451 | Val  Acc: 0.7222
 Site-USPS                      (5) | Val  Loss: 0.6812 | Val  Acc: 0.7188
 Site-USPS                      (5) | Val  Loss: 0.5960 | Val  Acc: 0.8103
 Site-USPS                      (5) | Val  Loss: 0.4773 | Val  Acc: 0.8571
 Site-USPS                      (5) | Val  Loss: 0.3882 | Val  Acc: 0.8995
 Site-SynthDigits               (1) | Val  Loss: 0.7292 | Val  Acc: 0.8108
 Site-SynthDigits               (1) | Val  Loss: 0.5920 | Val  Acc: 0.8235
 Site-SynthDigits               (1) | Val  Loss: 0.6848 | Val  Acc: 0.8361
 Site-MNIST_M                   (8) | Val  Loss: 1.0826 | Val  Acc: 0.7111
 Site-MNIST_M                   (3) | Val  Loss: 0.9677 | Val  Acc: 0.7778
 Site-SVHN                      (4) | Val  Loss: 0.9607 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8462
 Best site-MNIST                    (6)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (9)  | Epoch:19 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:19 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8824
 Best site-MNIST                    (7)  | Epoch:19 | Val Acc: 0.9355
 Best site-MNIST                    (9)  | Epoch:19 | Val Acc: 0.9464
 Best site-MNIST                    (9)  | Epoch:19 | Val Acc: 0.9118
 Best site-MNIST                    (9)  | Epoch:19 | Val Acc: 0.9126
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9124
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.9000
 Best site-USPS                     (5)  | Epoch:19 | Val Acc: 0.7222
 Best site-USPS                     (5)  | Epoch:19 | Val Acc: 0.7188
 Best site-USPS                     (5)  | Epoch:19 | Val Acc: 0.8103
 Best site-USPS                     (5)  | Epoch:19 | Val Acc: 0.8571
 Best site-USPS                     (5)  | Epoch:19 | Val Acc: 0.8995
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8108
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8235
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8361
 Best site-MNIST_M                  (8)  | Epoch:19 | Val Acc: 0.7111
 Best site-MNIST_M                  (3)  | Epoch:19 | Val Acc: 0.7778
 Best site-SVHN                     (4)  | Epoch:19 | Val Acc: 0.6714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 7, 2, 1, 1, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (5) | Train Loss: 0.5666 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4640 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2923 | Train Acc: 0.8571
 Site-MNIST                     (7) | Train Loss: 0.2297 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.4826 | Train Acc: 0.8857
 Site-MNIST                     (7) | Train Loss: 0.2940 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2688 | Train Acc: 0.9383
 Site-MNIST                     (1) | Train Loss: 0.3234 | Train Acc: 0.9144
 Site-MNIST                     (1) | Train Loss: 0.3339 | Train Acc: 0.9171
 Site-MNIST                     (1) | Train Loss: 0.2978 | Train Acc: 0.9291
 Site-USPS                      (0) | Train Loss: 0.3520 | Train Acc: 0.8750
 Site-USPS                      (6) | Train Loss: 0.4379 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.2754 | Train Acc: 0.9147
 Site-USPS                      (6) | Train Loss: 0.4433 | Train Acc: 0.8584
 Site-USPS                      (6) | Train Loss: 0.3676 | Train Acc: 0.9071
 Site-USPS                      (6) | Train Loss: 0.3800 | Train Acc: 0.8995
 Site-SynthDigits               (2) | Train Loss: 0.7192 | Train Acc: 0.7682
 Site-SynthDigits               (2) | Train Loss: 0.7008 | Train Acc: 0.8242
 Site-SynthDigits               (9) | Train Loss: 0.6528 | Train Acc: 0.8595
 Site-MNIST_M                   (8) | Train Loss: 1.0196 | Train Acc: 0.6961
 Site-MNIST_M                   (3) | Train Loss: 0.9858 | Train Acc: 0.7187
 Site-SVHN                      (4) | Train Loss: 1.2037 | Train Acc: 0.6170
Average Train Accuracy: 0.8570
 Site-MNIST                     (5) | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0565 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4595 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5452 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3989 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.3252 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2915 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.3033 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.3483 | Val  Acc: 0.9180
 Site-MNIST                     (1) | Val  Loss: 0.3331 | Val  Acc: 0.9215
 Site-USPS                      (0) | Val  Loss: 0.2176 | Val  Acc: 0.9000
 Site-USPS                      (6) | Val  Loss: 0.6363 | Val  Acc: 0.7222
 Site-USPS                      (6) | Val  Loss: 0.6763 | Val  Acc: 0.7188
 Site-USPS                      (6) | Val  Loss: 0.5849 | Val  Acc: 0.8103
 Site-USPS                      (6) | Val  Loss: 0.4709 | Val  Acc: 0.8476
 Site-USPS                      (6) | Val  Loss: 0.3825 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.6974 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.5651 | Val  Acc: 0.8529
 Site-SynthDigits               (9) | Val  Loss: 0.6622 | Val  Acc: 0.8443
 Site-MNIST_M                   (8) | Val  Loss: 1.0700 | Val  Acc: 0.7111
 Site-MNIST_M                   (3) | Val  Loss: 0.9526 | Val  Acc: 0.7654
 Site-SVHN                      (4) | Val  Loss: 0.9192 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8516
 Best site-MNIST                    (5)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:20 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.8824
 Best site-MNIST                    (7)  | Epoch:20 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9180
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9215
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.9000
 Best site-USPS                     (6)  | Epoch:20 | Val Acc: 0.7222
 Best site-USPS                     (6)  | Epoch:20 | Val Acc: 0.7188
 Best site-USPS                     (6)  | Epoch:20 | Val Acc: 0.8103
 Best site-USPS                     (6)  | Epoch:20 | Val Acc: 0.8476
 Best site-USPS                     (6)  | Epoch:20 | Val Acc: 0.8942
 Best site-SynthDigits              (2)  | Epoch:20 | Val Acc: 0.8649
 Best site-SynthDigits              (2)  | Epoch:20 | Val Acc: 0.8529
 Best site-SynthDigits              (9)  | Epoch:20 | Val Acc: 0.8443
 Best site-MNIST_M                  (8)  | Epoch:20 | Val Acc: 0.7111
 Best site-MNIST_M                  (3)  | Epoch:20 | Val Acc: 0.7654
 Best site-SVHN                     (4)  | Epoch:20 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 21 ============
cnt=[3, 2, 5, 1, 1, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (5) | Train Loss: 0.5329 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.4315 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2475 | Train Acc: 0.9048
 Site-MNIST                     (6) | Train Loss: 0.2119 | Train Acc: 0.9737
 Site-MNIST                     (7) | Train Loss: 0.3533 | Train Acc: 0.9143
 Site-MNIST                     (6) | Train Loss: 0.2621 | Train Acc: 0.9365
 Site-MNIST                     (6) | Train Loss: 0.2624 | Train Acc: 0.9471
 Site-MNIST                     (7) | Train Loss: 0.3059 | Train Acc: 0.9193
 Site-MNIST                     (7) | Train Loss: 0.3120 | Train Acc: 0.9253
 Site-MNIST                     (1) | Train Loss: 0.2703 | Train Acc: 0.9381
 Site-USPS                      (9) | Train Loss: 0.3714 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.3039 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2735 | Train Acc: 0.9070
 Site-USPS                      (2) | Train Loss: 0.4381 | Train Acc: 0.8455
 Site-USPS                      (2) | Train Loss: 0.3613 | Train Acc: 0.8976
 Site-USPS                      (2) | Train Loss: 0.3784 | Train Acc: 0.9008
 Site-SynthDigits               (0) | Train Loss: 0.7200 | Train Acc: 0.7815
 Site-SynthDigits               (0) | Train Loss: 0.7160 | Train Acc: 0.8168
 Site-SynthDigits               (0) | Train Loss: 0.6348 | Train Acc: 0.8554
 Site-MNIST_M                   (8) | Train Loss: 0.9763 | Train Acc: 0.7127
 Site-MNIST_M                   (3) | Train Loss: 0.8984 | Train Acc: 0.7370
 Site-SVHN                      (4) | Train Loss: 1.2145 | Train Acc: 0.6028
Average Train Accuracy: 0.8669
 Site-MNIST                     (5) | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.0501 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4527 | Val  Acc: 0.8000
 Site-MNIST                     (6) | Val  Loss: 0.5333 | Val  Acc: 0.7778
 Site-MNIST                     (7) | Val  Loss: 0.3790 | Val  Acc: 0.8824
 Site-MNIST                     (6) | Val  Loss: 0.3048 | Val  Acc: 0.9355
 Site-MNIST                     (6) | Val  Loss: 0.2694 | Val  Acc: 0.9464
 Site-MNIST                     (7) | Val  Loss: 0.2820 | Val  Acc: 0.9020
 Site-MNIST                     (7) | Val  Loss: 0.3268 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.3103 | Val  Acc: 0.9335
 Site-USPS                      (9) | Val  Loss: 0.2229 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6559 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6977 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.5855 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.4694 | Val  Acc: 0.8286
 Site-USPS                      (2) | Val  Loss: 0.3791 | Val  Acc: 0.8624
 Site-SynthDigits               (0) | Val  Loss: 0.6743 | Val  Acc: 0.8378
 Site-SynthDigits               (0) | Val  Loss: 0.5632 | Val  Acc: 0.8382
 Site-SynthDigits               (0) | Val  Loss: 0.6483 | Val  Acc: 0.8525
 Site-MNIST_M                   (8) | Val  Loss: 1.0475 | Val  Acc: 0.6889
 Site-MNIST_M                   (3) | Val  Loss: 0.9203 | Val  Acc: 0.7654
 Site-SVHN                      (4) | Val  Loss: 0.9062 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8452
============ Train epoch 22 ============
cnt=[3, 3, 1, 1, 1, 1, 4, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (5) | Train Loss: 0.5265 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.4249 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.2335 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2094 | Train Acc: 0.9737
 Site-MNIST                     (7) | Train Loss: 0.3177 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.2503 | Train Acc: 0.9365
 Site-MNIST                     (0) | Train Loss: 0.2331 | Train Acc: 0.9515
 Site-MNIST                     (7) | Train Loss: 0.3119 | Train Acc: 0.9193
 Site-MNIST                     (7) | Train Loss: 0.3037 | Train Acc: 0.9280
 Site-MNIST                     (7) | Train Loss: 0.2624 | Train Acc: 0.9404
 Site-USPS                      (2) | Train Loss: 0.3414 | Train Acc: 0.8750
 Site-USPS                      (9) | Train Loss: 0.5394 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.2549 | Train Acc: 0.9225
 Site-USPS                      (6) | Train Loss: 0.4159 | Train Acc: 0.8498
 Site-USPS                      (6) | Train Loss: 0.3373 | Train Acc: 0.9024
 Site-USPS                      (6) | Train Loss: 0.3620 | Train Acc: 0.9087
 Site-SynthDigits               (1) | Train Loss: 0.7758 | Train Acc: 0.7947
 Site-SynthDigits               (1) | Train Loss: 0.6457 | Train Acc: 0.8242
 Site-SynthDigits               (1) | Train Loss: 0.6061 | Train Acc: 0.8595
 Site-MNIST_M                   (8) | Train Loss: 0.9603 | Train Acc: 0.7072
 Site-MNIST_M                   (3) | Train Loss: 0.9442 | Train Acc: 0.7462
 Site-SVHN                      (4) | Train Loss: 1.1420 | Train Acc: 0.6206
Average Train Accuracy: 0.8709
 Site-MNIST                     (5) | Val  Loss: 0.0238 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.0467 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4373 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5170 | Val  Acc: 0.7778
 Site-MNIST                     (7) | Val  Loss: 0.3632 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2954 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2627 | Val  Acc: 0.9464
 Site-MNIST                     (7) | Val  Loss: 0.2730 | Val  Acc: 0.9020
 Site-MNIST                     (7) | Val  Loss: 0.3184 | Val  Acc: 0.9235
 Site-MNIST                     (7) | Val  Loss: 0.2996 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.2206 | Val  Acc: 0.9000
 Site-USPS                      (9) | Val  Loss: 0.6291 | Val  Acc: 0.7222
 Site-USPS                      (6) | Val  Loss: 0.6611 | Val  Acc: 0.7188
 Site-USPS                      (6) | Val  Loss: 0.5666 | Val  Acc: 0.7931
 Site-USPS                      (6) | Val  Loss: 0.4548 | Val  Acc: 0.8286
 Site-USPS                      (6) | Val  Loss: 0.3629 | Val  Acc: 0.8783
 Site-SynthDigits               (1) | Val  Loss: 0.6405 | Val  Acc: 0.8649
 Site-SynthDigits               (1) | Val  Loss: 0.5251 | Val  Acc: 0.8382
 Site-SynthDigits               (1) | Val  Loss: 0.6382 | Val  Acc: 0.8279
 Site-MNIST_M                   (8) | Val  Loss: 1.0234 | Val  Acc: 0.7333
 Site-MNIST_M                   (3) | Val  Loss: 0.8924 | Val  Acc: 0.7901
 Site-SVHN                      (4) | Val  Loss: 0.9111 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8485
============ Train epoch 23 ============
cnt=[2, 1, 2, 1, 3, 1, 3, 7, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (5) | Train Loss: 0.5231 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.4086 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.2475 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2051 | Train Acc: 0.9737
 Site-MNIST                     (7) | Train Loss: 0.4666 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2524 | Train Acc: 0.9365
 Site-MNIST                     (7) | Train Loss: 0.2478 | Train Acc: 0.9427
 Site-MNIST                     (7) | Train Loss: 0.3115 | Train Acc: 0.9193
 Site-MNIST                     (7) | Train Loss: 0.3031 | Train Acc: 0.9239
 Site-MNIST                     (7) | Train Loss: 0.2617 | Train Acc: 0.9411
 Site-USPS                      (8) | Train Loss: 0.3329 | Train Acc: 0.8750
 Site-USPS                      (6) | Train Loss: 0.2664 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 1.2251 | Train Acc: 0.9225
 Site-USPS                      (6) | Train Loss: 0.3953 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.3289 | Train Acc: 0.9238
 Site-USPS                      (2) | Train Loss: 0.3472 | Train Acc: 0.9087
 Site-SynthDigits               (4) | Train Loss: 0.7274 | Train Acc: 0.8013
 Site-SynthDigits               (4) | Train Loss: 0.7015 | Train Acc: 0.8388
 Site-SynthDigits               (4) | Train Loss: 0.5981 | Train Acc: 0.8676
 Site-MNIST_M                   (3) | Train Loss: 0.9381 | Train Acc: 0.7182
 Site-MNIST_M                   (9) | Train Loss: 0.9386 | Train Acc: 0.7278
 Site-SVHN                      (1) | Train Loss: 1.1293 | Train Acc: 0.6312
Average Train Accuracy: 0.8742
 Site-MNIST                     (5) | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.0438 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4648 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5454 | Val  Acc: 0.7778
 Site-MNIST                     (7) | Val  Loss: 0.3802 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2967 | Val  Acc: 0.9355
 Site-MNIST                     (7) | Val  Loss: 0.2603 | Val  Acc: 0.9464
 Site-MNIST                     (7) | Val  Loss: 0.2720 | Val  Acc: 0.9216
 Site-MNIST                     (7) | Val  Loss: 0.3181 | Val  Acc: 0.9180
 Site-MNIST                     (7) | Val  Loss: 0.3006 | Val  Acc: 0.9335
 Site-USPS                      (8) | Val  Loss: 0.1918 | Val  Acc: 0.9000
 Site-USPS                      (6) | Val  Loss: 0.5977 | Val  Acc: 0.7222
 Site-USPS                      (6) | Val  Loss: 0.6397 | Val  Acc: 0.7188
 Site-USPS                      (6) | Val  Loss: 0.5527 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4387 | Val  Acc: 0.8381
 Site-USPS                      (2) | Val  Loss: 0.3507 | Val  Acc: 0.9101
 Site-SynthDigits               (4) | Val  Loss: 0.6274 | Val  Acc: 0.9189
 Site-SynthDigits               (4) | Val  Loss: 0.5064 | Val  Acc: 0.8529
 Site-SynthDigits               (4) | Val  Loss: 0.6166 | Val  Acc: 0.8607
 Site-MNIST_M                   (3) | Val  Loss: 0.9894 | Val  Acc: 0.7333
 Site-MNIST_M                   (9) | Val  Loss: 0.8751 | Val  Acc: 0.8025
 Site-SVHN                      (1) | Val  Loss: 0.8672 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8564
 Best site-MNIST                    (5)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:23 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.7778
 Best site-MNIST                    (7)  | Epoch:23 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9355
 Best site-MNIST                    (7)  | Epoch:23 | Val Acc: 0.9464
 Best site-MNIST                    (7)  | Epoch:23 | Val Acc: 0.9216
 Best site-MNIST                    (7)  | Epoch:23 | Val Acc: 0.9180
 Best site-MNIST                    (7)  | Epoch:23 | Val Acc: 0.9335
 Best site-USPS                     (8)  | Epoch:23 | Val Acc: 0.9000
 Best site-USPS                     (6)  | Epoch:23 | Val Acc: 0.7222
 Best site-USPS                     (6)  | Epoch:23 | Val Acc: 0.7188
 Best site-USPS                     (6)  | Epoch:23 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8381
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9101
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.9189
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8529
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8607
 Best site-MNIST_M                  (3)  | Epoch:23 | Val Acc: 0.7333
 Best site-MNIST_M                  (9)  | Epoch:23 | Val Acc: 0.8025
 Best site-SVHN                     (1)  | Epoch:23 | Val Acc: 0.6571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 24 ============
cnt=[5, 4, 1, 1, 1, 1, 1, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (5) | Train Loss: 0.5251 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4137 | Train Acc: 0.9167
 Site-MNIST                     (8) | Train Loss: 0.2471 | Train Acc: 0.9048
 Site-MNIST                     (8) | Train Loss: 0.2015 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3574 | Train Acc: 0.9143
 Site-MNIST                     (8) | Train Loss: 0.2486 | Train Acc: 0.9365
 Site-MNIST                     (8) | Train Loss: 0.2411 | Train Acc: 0.9471
 Site-MNIST                     (1) | Train Loss: 0.3011 | Train Acc: 0.9218
 Site-MNIST                     (8) | Train Loss: 0.2974 | Train Acc: 0.9253
 Site-MNIST                     (1) | Train Loss: 0.2558 | Train Acc: 0.9389
 Site-USPS                      (6) | Train Loss: 0.3320 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.2934 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2591 | Train Acc: 0.9302
 Site-USPS                      (0) | Train Loss: 0.4073 | Train Acc: 0.8627
 Site-USPS                      (0) | Train Loss: 0.3212 | Train Acc: 0.9262
 Site-USPS                      (0) | Train Loss: 0.3420 | Train Acc: 0.9087
 Site-SynthDigits               (9) | Train Loss: 0.7055 | Train Acc: 0.7947
 Site-SynthDigits               (3) | Train Loss: 0.6305 | Train Acc: 0.8278
 Site-SynthDigits               (9) | Train Loss: 0.5831 | Train Acc: 0.8778
 Site-MNIST_M                   (7) | Train Loss: 0.9035 | Train Acc: 0.7348
 Site-MNIST_M                   (2) | Train Loss: 0.9117 | Train Acc: 0.7339
 Site-SVHN                      (4) | Train Loss: 1.0854 | Train Acc: 0.6560
Average Train Accuracy: 0.8759
 Site-MNIST                     (5) | Val  Loss: 0.0190 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.4696 | Val  Acc: 0.8000
 Site-MNIST                     (8) | Val  Loss: 0.5396 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3755 | Val  Acc: 0.8824
 Site-MNIST                     (8) | Val  Loss: 0.2910 | Val  Acc: 0.9355
 Site-MNIST                     (8) | Val  Loss: 0.2559 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2672 | Val  Acc: 0.9118
 Site-MNIST                     (8) | Val  Loss: 0.3131 | Val  Acc: 0.9180
 Site-MNIST                     (1) | Val  Loss: 0.2954 | Val  Acc: 0.9275
 Site-USPS                      (6) | Val  Loss: 0.1830 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5921 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.6364 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.5430 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.4333 | Val  Acc: 0.8762
 Site-USPS                      (0) | Val  Loss: 0.3460 | Val  Acc: 0.9048
 Site-SynthDigits               (9) | Val  Loss: 0.6024 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.4746 | Val  Acc: 0.8529
 Site-SynthDigits               (9) | Val  Loss: 0.6044 | Val  Acc: 0.8443
 Site-MNIST_M                   (7) | Val  Loss: 0.9655 | Val  Acc: 0.7778
 Site-MNIST_M                   (2) | Val  Loss: 0.8471 | Val  Acc: 0.8272
 Site-SVHN                      (4) | Val  Loss: 0.8406 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8643
 Best site-MNIST                    (5)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (8)  | Epoch:24 | Val Acc: 0.8000
 Best site-MNIST                    (8)  | Epoch:24 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.8824
 Best site-MNIST                    (8)  | Epoch:24 | Val Acc: 0.9355
 Best site-MNIST                    (8)  | Epoch:24 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9118
 Best site-MNIST                    (8)  | Epoch:24 | Val Acc: 0.9180
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9275
 Best site-USPS                     (6)  | Epoch:24 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8762
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.9048
 Best site-SynthDigits              (9)  | Epoch:24 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:24 | Val Acc: 0.8529
 Best site-SynthDigits              (9)  | Epoch:24 | Val Acc: 0.8443
 Best site-MNIST_M                  (7)  | Epoch:24 | Val Acc: 0.7778
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.8272
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 5, 5, 1, 1, 1, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (5) | Train Loss: 0.5298 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4020 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.2291 | Train Acc: 0.9048
 Site-MNIST                     (7) | Train Loss: 0.1925 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.4468 | Train Acc: 0.9286
 Site-MNIST                     (7) | Train Loss: 0.2395 | Train Acc: 0.9365
 Site-MNIST                     (7) | Train Loss: 0.2233 | Train Acc: 0.9471
 Site-MNIST                     (1) | Train Loss: 0.2941 | Train Acc: 0.9242
 Site-MNIST                     (1) | Train Loss: 0.2888 | Train Acc: 0.9321
 Site-MNIST                     (1) | Train Loss: 0.2497 | Train Acc: 0.9396
 Site-USPS                      (9) | Train Loss: 0.3392 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.3751 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2310 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.4017 | Train Acc: 0.8541
 Site-USPS                      (2) | Train Loss: 0.3101 | Train Acc: 0.9262
 Site-USPS                      (2) | Train Loss: 0.3363 | Train Acc: 0.9127
 Site-SynthDigits               (6) | Train Loss: 0.7488 | Train Acc: 0.7881
 Site-SynthDigits               (6) | Train Loss: 0.6732 | Train Acc: 0.8352
 Site-SynthDigits               (0) | Train Loss: 0.5720 | Train Acc: 0.8778
 Site-MNIST_M                   (8) | Train Loss: 0.8924 | Train Acc: 0.7348
 Site-MNIST_M                   (3) | Train Loss: 0.8511 | Train Acc: 0.7554
 Site-SVHN                      (4) | Train Loss: 1.1113 | Train Acc: 0.6560
Average Train Accuracy: 0.8800
 Site-MNIST                     (5) | Val  Loss: 0.0178 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0400 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4688 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5410 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3724 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.2852 | Val  Acc: 0.9355
 Site-MNIST                     (7) | Val  Loss: 0.2482 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2601 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.3056 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.2893 | Val  Acc: 0.9335
 Site-USPS                      (9) | Val  Loss: 0.1763 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5886 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6404 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.5350 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.4292 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.3416 | Val  Acc: 0.8942
 Site-SynthDigits               (6) | Val  Loss: 0.5789 | Val  Acc: 0.9189
 Site-SynthDigits               (6) | Val  Loss: 0.4721 | Val  Acc: 0.8676
 Site-SynthDigits               (0) | Val  Loss: 0.5922 | Val  Acc: 0.8443
 Site-MNIST_M                   (8) | Val  Loss: 0.9512 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.8297 | Val  Acc: 0.8272
 Site-SVHN                      (4) | Val  Loss: 0.8378 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8661
 Best site-MNIST                    (5)  | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:25 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:25 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.8824
 Best site-MNIST                    (7)  | Epoch:25 | Val Acc: 0.9355
 Best site-MNIST                    (7)  | Epoch:25 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9235
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9335
 Best site-USPS                     (9)  | Epoch:25 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.7500
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.8276
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.8571
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.8942
 Best site-SynthDigits              (6)  | Epoch:25 | Val Acc: 0.9189
 Best site-SynthDigits              (6)  | Epoch:25 | Val Acc: 0.8676
 Best site-SynthDigits              (0)  | Epoch:25 | Val Acc: 0.8443
 Best site-MNIST_M                  (8)  | Epoch:25 | Val Acc: 0.7778
 Best site-MNIST_M                  (3)  | Epoch:25 | Val Acc: 0.8272
 Best site-SVHN                     (4)  | Epoch:25 | Val Acc: 0.7571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 3, 1, 1, 1, 7, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (0) | Train Loss: 0.5255 | Train Acc: 0.8333
 Site-MNIST                     (5) | Train Loss: 0.3943 | Train Acc: 0.9167
 Site-MNIST                     (5) | Train Loss: 0.2202 | Train Acc: 0.9048
 Site-MNIST                     (5) | Train Loss: 0.1908 | Train Acc: 0.9737
 Site-MNIST                     (8) | Train Loss: 0.2310 | Train Acc: 0.9286
 Site-MNIST                     (5) | Train Loss: 0.2287 | Train Acc: 0.9365
 Site-MNIST                     (5) | Train Loss: 0.2319 | Train Acc: 0.9471
 Site-MNIST                     (8) | Train Loss: 0.2805 | Train Acc: 0.9218
 Site-MNIST                     (5) | Train Loss: 0.2830 | Train Acc: 0.9348
 Site-MNIST                     (5) | Train Loss: 0.2423 | Train Acc: 0.9449
 Site-USPS                      (2) | Train Loss: 0.3367 | Train Acc: 0.9000
 Site-USPS                      (9) | Train Loss: 0.2674 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.2376 | Train Acc: 0.9147
 Site-USPS                      (6) | Train Loss: 0.3890 | Train Acc: 0.8584
 Site-USPS                      (6) | Train Loss: 0.3165 | Train Acc: 0.9310
 Site-USPS                      (6) | Train Loss: 0.3286 | Train Acc: 0.9127
 Site-SynthDigits               (1) | Train Loss: 0.6780 | Train Acc: 0.7947
 Site-SynthDigits               (1) | Train Loss: 0.6262 | Train Acc: 0.8425
 Site-SynthDigits               (1) | Train Loss: 0.5518 | Train Acc: 0.8798
 Site-MNIST_M                   (3) | Train Loss: 0.8727 | Train Acc: 0.7459
 Site-MNIST_M                   (7) | Train Loss: 0.8835 | Train Acc: 0.7676
 Site-SVHN                      (4) | Train Loss: 1.0482 | Train Acc: 0.6773
Average Train Accuracy: 0.8817
 Site-MNIST                     (0) | Val  Loss: 0.0163 | Val  Acc: 1.0000
 Site-MNIST                     (5) | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-MNIST                     (5) | Val  Loss: 0.4612 | Val  Acc: 0.8000
 Site-MNIST                     (5) | Val  Loss: 0.5222 | Val  Acc: 0.7778
 Site-MNIST                     (8) | Val  Loss: 0.3572 | Val  Acc: 0.8824
 Site-MNIST                     (5) | Val  Loss: 0.2730 | Val  Acc: 0.9355
 Site-MNIST                     (5) | Val  Loss: 0.2392 | Val  Acc: 0.9464
 Site-MNIST                     (8) | Val  Loss: 0.2509 | Val  Acc: 0.9118
 Site-MNIST                     (5) | Val  Loss: 0.2961 | Val  Acc: 0.9235
 Site-MNIST                     (5) | Val  Loss: 0.2804 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1716 | Val  Acc: 0.9000
 Site-USPS                      (9) | Val  Loss: 0.5834 | Val  Acc: 0.7778
 Site-USPS                      (6) | Val  Loss: 0.6350 | Val  Acc: 0.7812
 Site-USPS                      (6) | Val  Loss: 0.5325 | Val  Acc: 0.8103
 Site-USPS                      (6) | Val  Loss: 0.4251 | Val  Acc: 0.8762
 Site-USPS                      (6) | Val  Loss: 0.3356 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.5539 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.4614 | Val  Acc: 0.8824
 Site-SynthDigits               (1) | Val  Loss: 0.5674 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.9458 | Val  Acc: 0.7778
 Site-MNIST_M                   (7) | Val  Loss: 0.8169 | Val  Acc: 0.8519
 Site-SVHN                      (4) | Val  Loss: 0.8297 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8728
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                    (5)  | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                    (5)  | Epoch:26 | Val Acc: 0.8000
 Best site-MNIST                    (5)  | Epoch:26 | Val Acc: 0.7778
 Best site-MNIST                    (8)  | Epoch:26 | Val Acc: 0.8824
 Best site-MNIST                    (5)  | Epoch:26 | Val Acc: 0.9355
 Best site-MNIST                    (5)  | Epoch:26 | Val Acc: 0.9464
 Best site-MNIST                    (8)  | Epoch:26 | Val Acc: 0.9118
 Best site-MNIST                    (5)  | Epoch:26 | Val Acc: 0.9235
 Best site-MNIST                    (5)  | Epoch:26 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.9000
 Best site-USPS                     (9)  | Epoch:26 | Val Acc: 0.7778
 Best site-USPS                     (6)  | Epoch:26 | Val Acc: 0.7812
 Best site-USPS                     (6)  | Epoch:26 | Val Acc: 0.8103
 Best site-USPS                     (6)  | Epoch:26 | Val Acc: 0.8762
 Best site-USPS                     (6)  | Epoch:26 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.8824
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.8689
 Best site-MNIST_M                  (3)  | Epoch:26 | Val Acc: 0.7778
 Best site-MNIST_M                  (7)  | Epoch:26 | Val Acc: 0.8519
 Best site-SVHN                     (4)  | Epoch:26 | Val Acc: 0.7571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 5, 3, 1, 1, 1, 1, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (5) | Train Loss: 0.5090 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3853 | Train Acc: 0.9167
 Site-MNIST                     (8) | Train Loss: 0.2061 | Train Acc: 0.9048
 Site-MNIST                     (8) | Train Loss: 0.1860 | Train Acc: 0.9737
 Site-MNIST                     (7) | Train Loss: 0.2428 | Train Acc: 0.9143
 Site-MNIST                     (8) | Train Loss: 0.2251 | Train Acc: 0.9365
 Site-MNIST                     (8) | Train Loss: 0.2116 | Train Acc: 0.9471
 Site-MNIST                     (7) | Train Loss: 0.2735 | Train Acc: 0.9242
 Site-MNIST                     (7) | Train Loss: 0.2769 | Train Acc: 0.9361
 Site-MNIST                     (7) | Train Loss: 0.2362 | Train Acc: 0.9442
 Site-USPS                      (1) | Train Loss: 0.2996 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.2214 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.7890 | Train Acc: 0.9225
 Site-USPS                      (1) | Train Loss: 0.3822 | Train Acc: 0.8627
 Site-USPS                      (6) | Train Loss: 0.3026 | Train Acc: 0.9262
 Site-USPS                      (1) | Train Loss: 0.3168 | Train Acc: 0.9206
 Site-SynthDigits               (2) | Train Loss: 0.6545 | Train Acc: 0.8079
 Site-SynthDigits               (2) | Train Loss: 0.5852 | Train Acc: 0.8425
 Site-SynthDigits               (2) | Train Loss: 0.5241 | Train Acc: 0.8758
 Site-MNIST_M                   (3) | Train Loss: 0.8637 | Train Acc: 0.7403
 Site-MNIST_M                   (9) | Train Loss: 0.8069 | Train Acc: 0.7615
 Site-SVHN                      (4) | Train Loss: 1.0831 | Train Acc: 0.6738
Average Train Accuracy: 0.8816
 Site-MNIST                     (5) | Val  Loss: 0.0161 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.4662 | Val  Acc: 0.8000
 Site-MNIST                     (8) | Val  Loss: 0.5207 | Val  Acc: 0.7778
 Site-MNIST                     (7) | Val  Loss: 0.3539 | Val  Acc: 0.8824
 Site-MNIST                     (8) | Val  Loss: 0.2661 | Val  Acc: 0.9355
 Site-MNIST                     (8) | Val  Loss: 0.2332 | Val  Acc: 0.9464
 Site-MNIST                     (7) | Val  Loss: 0.2439 | Val  Acc: 0.9118
 Site-MNIST                     (7) | Val  Loss: 0.2904 | Val  Acc: 0.9235
 Site-MNIST                     (7) | Val  Loss: 0.2738 | Val  Acc: 0.9335
 Site-USPS                      (1) | Val  Loss: 0.1589 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.5562 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.6043 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.5163 | Val  Acc: 0.8276
 Site-USPS                      (6) | Val  Loss: 0.4104 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.3225 | Val  Acc: 0.9101
 Site-SynthDigits               (2) | Val  Loss: 0.5466 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.4413 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5496 | Val  Acc: 0.8607
 Site-MNIST_M                   (3) | Val  Loss: 0.9196 | Val  Acc: 0.7778
 Site-MNIST_M                   (9) | Val  Loss: 0.7907 | Val  Acc: 0.8519
 Site-SVHN                      (4) | Val  Loss: 0.8164 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8728
============ Train epoch 28 ============
cnt=[2, 2, 3, 1, 1, 1, 7, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (5) | Train Loss: 0.4965 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.3735 | Train Acc: 0.9167
 Site-MNIST                     (6) | Train Loss: 0.1900 | Train Acc: 0.9524
 Site-MNIST                     (6) | Train Loss: 0.1712 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.6513 | Train Acc: 0.9286
 Site-MNIST                     (6) | Train Loss: 0.2112 | Train Acc: 0.9524
 Site-MNIST                     (6) | Train Loss: 0.2077 | Train Acc: 0.9559
 Site-MNIST                     (6) | Train Loss: 0.2830 | Train Acc: 0.9193
 Site-MNIST                     (0) | Train Loss: 0.2608 | Train Acc: 0.9307
 Site-MNIST                     (6) | Train Loss: 0.2268 | Train Acc: 0.9532
 Site-USPS                      (1) | Train Loss: 0.3231 | Train Acc: 0.8750
 Site-USPS                      (1) | Train Loss: 0.4563 | Train Acc: 0.9306
 Site-USPS                      (7) | Train Loss: 0.4908 | Train Acc: 0.8992
 Site-USPS                      (7) | Train Loss: 0.3734 | Train Acc: 0.8627
 Site-USPS                      (7) | Train Loss: 0.2863 | Train Acc: 0.9262
 Site-USPS                      (9) | Train Loss: 0.3106 | Train Acc: 0.9167
 Site-SynthDigits               (2) | Train Loss: 0.6388 | Train Acc: 0.7947
 Site-SynthDigits               (2) | Train Loss: 0.6002 | Train Acc: 0.8388
 Site-SynthDigits               (2) | Train Loss: 0.5151 | Train Acc: 0.8880
 Site-MNIST_M                   (3) | Train Loss: 0.8515 | Train Acc: 0.7680
 Site-MNIST_M                   (8) | Train Loss: 0.8509 | Train Acc: 0.7645
 Site-SVHN                      (4) | Train Loss: 1.0302 | Train Acc: 0.6773
Average Train Accuracy: 0.8844
 Site-MNIST                     (5) | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.0320 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.4321 | Val  Acc: 0.8000
 Site-MNIST                     (6) | Val  Loss: 0.4804 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3259 | Val  Acc: 0.8824
 Site-MNIST                     (6) | Val  Loss: 0.2516 | Val  Acc: 0.9355
 Site-MNIST                     (6) | Val  Loss: 0.2247 | Val  Acc: 0.9464
 Site-MNIST                     (6) | Val  Loss: 0.2348 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.2796 | Val  Acc: 0.9290
 Site-MNIST                     (6) | Val  Loss: 0.2638 | Val  Acc: 0.9366
 Site-USPS                      (1) | Val  Loss: 0.1766 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.5753 | Val  Acc: 0.7778
 Site-USPS                      (7) | Val  Loss: 0.6106 | Val  Acc: 0.7812
 Site-USPS                      (7) | Val  Loss: 0.5078 | Val  Acc: 0.8276
 Site-USPS                      (7) | Val  Loss: 0.4104 | Val  Acc: 0.8476
 Site-USPS                      (9) | Val  Loss: 0.3203 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.5402 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.4366 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5517 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.9144 | Val  Acc: 0.7778
 Site-MNIST_M                   (8) | Val  Loss: 0.7783 | Val  Acc: 0.8642
 Site-SVHN                      (4) | Val  Loss: 0.8029 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8731
 Best site-MNIST                    (5)  | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:28 | Val Acc: 0.8000
 Best site-MNIST                    (6)  | Epoch:28 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.8824
 Best site-MNIST                    (6)  | Epoch:28 | Val Acc: 0.9355
 Best site-MNIST                    (6)  | Epoch:28 | Val Acc: 0.9464
 Best site-MNIST                    (6)  | Epoch:28 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9290
 Best site-MNIST                    (6)  | Epoch:28 | Val Acc: 0.9366
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.7778
 Best site-USPS                     (7)  | Epoch:28 | Val Acc: 0.7812
 Best site-USPS                     (7)  | Epoch:28 | Val Acc: 0.8276
 Best site-USPS                     (7)  | Epoch:28 | Val Acc: 0.8476
 Best site-USPS                     (9)  | Epoch:28 | Val Acc: 0.8942
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8824
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8689
 Best site-MNIST_M                  (3)  | Epoch:28 | Val Acc: 0.7778
 Best site-MNIST_M                  (8)  | Epoch:28 | Val Acc: 0.8642
 Best site-SVHN                     (4)  | Epoch:28 | Val Acc: 0.7571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 29 ============
cnt=[3, 6, 1, 1, 1, 1, 3, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (5) | Train Loss: 0.5287 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3691 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1763 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1655 | Train Acc: 0.9737
 Site-MNIST                     (9) | Train Loss: 0.2998 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2036 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.2095 | Train Acc: 0.9559
 Site-MNIST                     (9) | Train Loss: 0.2564 | Train Acc: 0.9291
 Site-MNIST                     (9) | Train Loss: 0.2575 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.2189 | Train Acc: 0.9532
 Site-USPS                      (6) | Train Loss: 0.3127 | Train Acc: 0.9000
 Site-USPS                      (6) | Train Loss: 0.2256 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2170 | Train Acc: 0.9147
 Site-USPS                      (0) | Train Loss: 0.3667 | Train Acc: 0.8670
 Site-USPS                      (0) | Train Loss: 0.2880 | Train Acc: 0.9333
 Site-USPS                      (6) | Train Loss: 0.3053 | Train Acc: 0.9193
 Site-SynthDigits               (7) | Train Loss: 0.6717 | Train Acc: 0.8079
 Site-SynthDigits               (7) | Train Loss: 0.5512 | Train Acc: 0.8608
 Site-SynthDigits               (2) | Train Loss: 0.5144 | Train Acc: 0.8880
 Site-MNIST_M                   (3) | Train Loss: 0.8428 | Train Acc: 0.7680
 Site-MNIST_M                   (8) | Train Loss: 0.7699 | Train Acc: 0.7554
 Site-SVHN                      (4) | Train Loss: 1.0418 | Train Acc: 0.6844
Average Train Accuracy: 0.8895
 Site-MNIST                     (5) | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0328 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4476 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4844 | Val  Acc: 0.7778
 Site-MNIST                     (9) | Val  Loss: 0.3235 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2441 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2152 | Val  Acc: 0.9464
 Site-MNIST                     (9) | Val  Loss: 0.2274 | Val  Acc: 0.9118
 Site-MNIST                     (9) | Val  Loss: 0.2704 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2574 | Val  Acc: 0.9426
 Site-USPS                      (6) | Val  Loss: 0.1609 | Val  Acc: 0.9000
 Site-USPS                      (6) | Val  Loss: 0.5569 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.5991 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.5023 | Val  Acc: 0.8103
 Site-USPS                      (0) | Val  Loss: 0.4035 | Val  Acc: 0.8857
 Site-USPS                      (6) | Val  Loss: 0.3162 | Val  Acc: 0.8889
 Site-SynthDigits               (7) | Val  Loss: 0.5238 | Val  Acc: 0.9189
 Site-SynthDigits               (7) | Val  Loss: 0.4112 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5261 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.8857 | Val  Acc: 0.7778
 Site-MNIST_M                   (8) | Val  Loss: 0.7644 | Val  Acc: 0.8642
 Site-SVHN                      (4) | Val  Loss: 0.7774 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8718
============ Train epoch 30 ============
cnt=[1, 3, 3, 3, 1, 1, 6, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (5) | Train Loss: 0.5330 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.3620 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1695 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1592 | Train Acc: 0.9737
 Site-MNIST                     (6) | Train Loss: 0.7246 | Train Acc: 0.9143
 Site-MNIST                     (6) | Train Loss: 0.1948 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1886 | Train Acc: 0.9604
 Site-MNIST                     (6) | Train Loss: 0.2513 | Train Acc: 0.9340
 Site-MNIST                     (6) | Train Loss: 0.2497 | Train Acc: 0.9375
 Site-MNIST                     (6) | Train Loss: 0.2123 | Train Acc: 0.9555
 Site-USPS                      (7) | Train Loss: 0.2982 | Train Acc: 0.9500
 Site-USPS                      (9) | Train Loss: 0.2264 | Train Acc: 0.9306
 Site-USPS                      (9) | Train Loss: 0.2158 | Train Acc: 0.8992
 Site-USPS                      (2) | Train Loss: 0.3625 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.2845 | Train Acc: 0.9381
 Site-USPS                      (2) | Train Loss: 0.3093 | Train Acc: 0.9180
 Site-SynthDigits               (3) | Train Loss: 0.6561 | Train Acc: 0.7947
 Site-SynthDigits               (3) | Train Loss: 0.5371 | Train Acc: 0.8864
 Site-SynthDigits               (3) | Train Loss: 0.4974 | Train Acc: 0.8900
 Site-MNIST_M                   (8) | Train Loss: 0.8218 | Train Acc: 0.7956
 Site-MNIST_M                   (0) | Train Loss: 0.8162 | Train Acc: 0.7737
 Site-SVHN                      (4) | Train Loss: 0.9629 | Train Acc: 0.6986
Average Train Accuracy: 0.8945
 Site-MNIST                     (5) | Val  Loss: 0.0180 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4618 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4873 | Val  Acc: 0.7778
 Site-MNIST                     (6) | Val  Loss: 0.3216 | Val  Acc: 0.8824
 Site-MNIST                     (6) | Val  Loss: 0.2313 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2050 | Val  Acc: 0.9464
 Site-MNIST                     (6) | Val  Loss: 0.2201 | Val  Acc: 0.9118
 Site-MNIST                     (6) | Val  Loss: 0.2627 | Val  Acc: 0.9344
 Site-MNIST                     (6) | Val  Loss: 0.2517 | Val  Acc: 0.9486
 Site-USPS                      (7) | Val  Loss: 0.1640 | Val  Acc: 0.9000
 Site-USPS                      (9) | Val  Loss: 0.5585 | Val  Acc: 0.7778
 Site-USPS                      (9) | Val  Loss: 0.6109 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.5024 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.4092 | Val  Acc: 0.9048
 Site-USPS                      (2) | Val  Loss: 0.3189 | Val  Acc: 0.8942
 Site-SynthDigits               (3) | Val  Loss: 0.5133 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.4042 | Val  Acc: 0.8824
 Site-SynthDigits               (3) | Val  Loss: 0.5144 | Val  Acc: 0.8689
 Site-MNIST_M                   (8) | Val  Loss: 0.8857 | Val  Acc: 0.8000
 Site-MNIST_M                   (0) | Val  Loss: 0.7539 | Val  Acc: 0.8642
 Site-SVHN                      (4) | Val  Loss: 0.7605 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8771
 Best site-MNIST                    (5)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.7778
 Best site-MNIST                    (6)  | Epoch:30 | Val Acc: 0.8824
 Best site-MNIST                    (6)  | Epoch:30 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9464
 Best site-MNIST                    (6)  | Epoch:30 | Val Acc: 0.9118
 Best site-MNIST                    (6)  | Epoch:30 | Val Acc: 0.9344
 Best site-MNIST                    (6)  | Epoch:30 | Val Acc: 0.9486
 Best site-USPS                     (7)  | Epoch:30 | Val Acc: 0.9000
 Best site-USPS                     (9)  | Epoch:30 | Val Acc: 0.7778
 Best site-USPS                     (9)  | Epoch:30 | Val Acc: 0.7500
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8276
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.9048
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8942
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8824
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8689
 Best site-MNIST_M                  (8)  | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST_M                  (0)  | Epoch:30 | Val Acc: 0.8642
 Best site-SVHN                     (4)  | Epoch:30 | Val Acc: 0.7714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 31 ============
cnt=[1, 5, 3, 1, 1, 1, 5, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (5) | Train Loss: 0.5261 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3391 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1747 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1545 | Train Acc: 0.9737
 Site-MNIST                     (9) | Train Loss: 0.1868 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1934 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.2008 | Train Acc: 0.9559
 Site-MNIST                     (9) | Train Loss: 0.2448 | Train Acc: 0.9364
 Site-MNIST                     (7) | Train Loss: 0.2511 | Train Acc: 0.9416
 Site-MNIST                     (9) | Train Loss: 0.2069 | Train Acc: 0.9555
 Site-USPS                      (0) | Train Loss: 0.3101 | Train Acc: 0.9000
 Site-USPS                      (6) | Train Loss: 0.3305 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.2101 | Train Acc: 0.9070
 Site-USPS                      (6) | Train Loss: 0.3686 | Train Acc: 0.8755
 Site-USPS                      (6) | Train Loss: 0.2775 | Train Acc: 0.9357
 Site-USPS                      (6) | Train Loss: 0.3016 | Train Acc: 0.9180
 Site-SynthDigits               (2) | Train Loss: 0.6216 | Train Acc: 0.8079
 Site-SynthDigits               (2) | Train Loss: 0.5606 | Train Acc: 0.8681
 Site-SynthDigits               (2) | Train Loss: 0.4858 | Train Acc: 0.9022
 Site-MNIST_M                   (3) | Train Loss: 0.7949 | Train Acc: 0.7735
 Site-MNIST_M                   (8) | Train Loss: 0.7912 | Train Acc: 0.7920
 Site-SVHN                      (4) | Train Loss: 0.9604 | Train Acc: 0.7021
Average Train Accuracy: 0.8933
 Site-MNIST                     (5) | Val  Loss: 0.0176 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4647 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4887 | Val  Acc: 0.7778
 Site-MNIST                     (9) | Val  Loss: 0.3175 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2220 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1953 | Val  Acc: 0.9643
 Site-MNIST                     (9) | Val  Loss: 0.2130 | Val  Acc: 0.9216
 Site-MNIST                     (7) | Val  Loss: 0.2577 | Val  Acc: 0.9290
 Site-MNIST                     (9) | Val  Loss: 0.2482 | Val  Acc: 0.9426
 Site-USPS                      (0) | Val  Loss: 0.1543 | Val  Acc: 0.9000
 Site-USPS                      (6) | Val  Loss: 0.5414 | Val  Acc: 0.8333
 Site-USPS                      (6) | Val  Loss: 0.5948 | Val  Acc: 0.7812
 Site-USPS                      (6) | Val  Loss: 0.4861 | Val  Acc: 0.8276
 Site-USPS                      (6) | Val  Loss: 0.3988 | Val  Acc: 0.9048
 Site-USPS                      (6) | Val  Loss: 0.3146 | Val  Acc: 0.8995
 Site-SynthDigits               (2) | Val  Loss: 0.5091 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.4055 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.5070 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.8705 | Val  Acc: 0.8222
 Site-MNIST_M                   (8) | Val  Loss: 0.7343 | Val  Acc: 0.8642
 Site-SVHN                      (4) | Val  Loss: 0.7681 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8819
 Best site-MNIST                    (5)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.7778
 Best site-MNIST                    (9)  | Epoch:31 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9643
 Best site-MNIST                    (9)  | Epoch:31 | Val Acc: 0.9216
 Best site-MNIST                    (7)  | Epoch:31 | Val Acc: 0.9290
 Best site-MNIST                    (9)  | Epoch:31 | Val Acc: 0.9426
 Best site-USPS                     (0)  | Epoch:31 | Val Acc: 0.9000
 Best site-USPS                     (6)  | Epoch:31 | Val Acc: 0.8333
 Best site-USPS                     (6)  | Epoch:31 | Val Acc: 0.7812
 Best site-USPS                     (6)  | Epoch:31 | Val Acc: 0.8276
 Best site-USPS                     (6)  | Epoch:31 | Val Acc: 0.9048
 Best site-USPS                     (6)  | Epoch:31 | Val Acc: 0.8995
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.8649
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.8971
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.8689
 Best site-MNIST_M                  (3)  | Epoch:31 | Val Acc: 0.8222
 Best site-MNIST_M                  (8)  | Epoch:31 | Val Acc: 0.8642
 Best site-SVHN                     (4)  | Epoch:31 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 32 ============
cnt=[3, 7, 3, 1, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (5) | Train Loss: 0.5202 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3408 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.1632 | Train Acc: 0.9524
 Site-MNIST                     (7) | Train Loss: 0.1504 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.6752 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1947 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1921 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2427 | Train Acc: 0.9340
 Site-MNIST                     (1) | Train Loss: 0.2420 | Train Acc: 0.9416
 Site-MNIST                     (1) | Train Loss: 0.2044 | Train Acc: 0.9577
 Site-USPS                      (8) | Train Loss: 0.2990 | Train Acc: 0.9250
 Site-USPS                      (6) | Train Loss: 0.2457 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.2080 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3412 | Train Acc: 0.8755
 Site-USPS                      (2) | Train Loss: 0.2651 | Train Acc: 0.9357
 Site-USPS                      (2) | Train Loss: 0.2867 | Train Acc: 0.9312
 Site-SynthDigits               (0) | Train Loss: 0.5422 | Train Acc: 0.8278
 Site-SynthDigits               (0) | Train Loss: 0.5346 | Train Acc: 0.8571
 Site-SynthDigits               (0) | Train Loss: 0.4722 | Train Acc: 0.9002
 Site-MNIST_M                   (9) | Train Loss: 0.7825 | Train Acc: 0.7901
 Site-MNIST_M                   (3) | Train Loss: 0.7548 | Train Acc: 0.7920
 Site-SVHN                      (4) | Train Loss: 0.9549 | Train Acc: 0.7057
Average Train Accuracy: 0.8966
 Site-MNIST                     (5) | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0334 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4481 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.4765 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3092 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2269 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1976 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2128 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.2556 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2445 | Val  Acc: 0.9426
 Site-USPS                      (8) | Val  Loss: 0.1549 | Val  Acc: 0.9000
 Site-USPS                      (6) | Val  Loss: 0.5217 | Val  Acc: 0.7778
 Site-USPS                      (6) | Val  Loss: 0.5582 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4652 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.3833 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.3035 | Val  Acc: 0.8942
 Site-SynthDigits               (0) | Val  Loss: 0.4948 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.3801 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.4831 | Val  Acc: 0.8852
 Site-MNIST_M                   (9) | Val  Loss: 0.8574 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.7174 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.7476 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8799
============ Train epoch 33 ============
cnt=[7, 1, 3, 1, 1, 1, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (5) | Train Loss: 0.5293 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3316 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1608 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1493 | Train Acc: 0.9737
 Site-MNIST                     (7) | Train Loss: 0.3547 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1870 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1888 | Train Acc: 0.9559
 Site-MNIST                     (7) | Train Loss: 0.2415 | Train Acc: 0.9364
 Site-MNIST                     (0) | Train Loss: 0.2444 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2001 | Train Acc: 0.9577
 Site-USPS                      (1) | Train Loss: 0.2764 | Train Acc: 0.9500
 Site-USPS                      (8) | Train Loss: 0.2709 | Train Acc: 0.9306
 Site-USPS                      (8) | Train Loss: 0.2324 | Train Acc: 0.9225
 Site-USPS                      (6) | Train Loss: 0.3437 | Train Acc: 0.8712
 Site-USPS                      (6) | Train Loss: 0.2588 | Train Acc: 0.9310
 Site-USPS                      (6) | Train Loss: 0.2853 | Train Acc: 0.9246
 Site-SynthDigits               (2) | Train Loss: 0.6446 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.5070 | Train Acc: 0.8681
 Site-SynthDigits               (2) | Train Loss: 0.4699 | Train Acc: 0.8982
 Site-MNIST_M                   (3) | Train Loss: 0.7590 | Train Acc: 0.7901
 Site-MNIST_M                   (9) | Train Loss: 0.7174 | Train Acc: 0.7859
 Site-SVHN                      (4) | Train Loss: 0.9486 | Train Acc: 0.6986
Average Train Accuracy: 0.8978
 Site-MNIST                     (5) | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4693 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4913 | Val  Acc: 0.7778
 Site-MNIST                     (7) | Val  Loss: 0.3155 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2241 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1929 | Val  Acc: 0.9643
 Site-MNIST                     (7) | Val  Loss: 0.2088 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2508 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2402 | Val  Acc: 0.9426
 Site-USPS                      (1) | Val  Loss: 0.1442 | Val  Acc: 0.9000
 Site-USPS                      (8) | Val  Loss: 0.5130 | Val  Acc: 0.8333
 Site-USPS                      (8) | Val  Loss: 0.5490 | Val  Acc: 0.7812
 Site-USPS                      (6) | Val  Loss: 0.4629 | Val  Acc: 0.8103
 Site-USPS                      (6) | Val  Loss: 0.3807 | Val  Acc: 0.8857
 Site-USPS                      (6) | Val  Loss: 0.2991 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.4931 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.3677 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.4735 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8308 | Val  Acc: 0.8444
 Site-MNIST_M                   (9) | Val  Loss: 0.6942 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.7428 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8836
 Best site-MNIST                    (5)  | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.7778
 Best site-MNIST                    (7)  | Epoch:33 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9643
 Best site-MNIST                    (7)  | Epoch:33 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9426
 Best site-USPS                     (1)  | Epoch:33 | Val Acc: 0.9000
 Best site-USPS                     (8)  | Epoch:33 | Val Acc: 0.8333
 Best site-USPS                     (8)  | Epoch:33 | Val Acc: 0.7812
 Best site-USPS                     (6)  | Epoch:33 | Val Acc: 0.8103
 Best site-USPS                     (6)  | Epoch:33 | Val Acc: 0.8857
 Best site-USPS                     (6)  | Epoch:33 | Val Acc: 0.9048
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8971
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8852
 Best site-MNIST_M                  (3)  | Epoch:33 | Val Acc: 0.8444
 Best site-MNIST_M                  (9)  | Epoch:33 | Val Acc: 0.8765
 Best site-SVHN                     (4)  | Epoch:33 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 4, 3, 2, 1, 1, 4, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (5) | Train Loss: 0.5220 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.3217 | Train Acc: 0.9167
 Site-MNIST                     (9) | Train Loss: 0.1515 | Train Acc: 0.9524
 Site-MNIST                     (7) | Train Loss: 0.1483 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2544 | Train Acc: 0.9286
 Site-MNIST                     (7) | Train Loss: 0.1772 | Train Acc: 0.9683
 Site-MNIST                     (7) | Train Loss: 0.1842 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2379 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2392 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1929 | Train Acc: 0.9585
 Site-USPS                      (0) | Train Loss: 0.2795 | Train Acc: 0.9750
 Site-USPS                      (6) | Train Loss: 0.2403 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.3299 | Train Acc: 0.9225
 Site-USPS                      (6) | Train Loss: 0.3311 | Train Acc: 0.8755
 Site-USPS                      (6) | Train Loss: 0.2590 | Train Acc: 0.9452
 Site-USPS                      (8) | Train Loss: 0.2755 | Train Acc: 0.9286
 Site-SynthDigits               (2) | Train Loss: 0.5504 | Train Acc: 0.8212
 Site-SynthDigits               (2) | Train Loss: 0.4775 | Train Acc: 0.8938
 Site-SynthDigits               (2) | Train Loss: 0.4549 | Train Acc: 0.8961
 Site-MNIST_M                   (3) | Train Loss: 0.7596 | Train Acc: 0.7901
 Site-MNIST_M                   (3) | Train Loss: 0.7580 | Train Acc: 0.7982
 Site-SVHN                      (4) | Train Loss: 0.9298 | Train Acc: 0.6879
Average Train Accuracy: 0.9012
 Site-MNIST                     (5) | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.4765 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5074 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3203 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.2193 | Val  Acc: 0.9355
 Site-MNIST                     (7) | Val  Loss: 0.1863 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2019 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2447 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2335 | Val  Acc: 0.9486
 Site-USPS                      (0) | Val  Loss: 0.1451 | Val  Acc: 0.9000
 Site-USPS                      (6) | Val  Loss: 0.5113 | Val  Acc: 0.7778
 Site-USPS                      (6) | Val  Loss: 0.5451 | Val  Acc: 0.7500
 Site-USPS                      (6) | Val  Loss: 0.4651 | Val  Acc: 0.8103
 Site-USPS                      (6) | Val  Loss: 0.3797 | Val  Acc: 0.8762
 Site-USPS                      (8) | Val  Loss: 0.2924 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.4830 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3596 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.4601 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8325 | Val  Acc: 0.8222
 Site-MNIST_M                   (3) | Val  Loss: 0.6973 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.7332 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8788
============ Train epoch 35 ============
cnt=[4, 3, 4, 1, 1, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (5) | Train Loss: 0.5222 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.3156 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1423 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1427 | Train Acc: 0.9737
 Site-MNIST                     (6) | Train Loss: 0.3086 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1698 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1808 | Train Acc: 0.9559
 Site-MNIST                     (6) | Train Loss: 0.2221 | Train Acc: 0.9413
 Site-MNIST                     (6) | Train Loss: 0.2260 | Train Acc: 0.9416
 Site-MNIST                     (6) | Train Loss: 0.1887 | Train Acc: 0.9592
 Site-USPS                      (7) | Train Loss: 0.2682 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.1919 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1852 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3305 | Train Acc: 0.8755
 Site-USPS                      (9) | Train Loss: 0.2570 | Train Acc: 0.9357
 Site-USPS                      (2) | Train Loss: 0.2719 | Train Acc: 0.9312
 Site-SynthDigits               (1) | Train Loss: 0.5723 | Train Acc: 0.8278
 Site-SynthDigits               (1) | Train Loss: 0.4887 | Train Acc: 0.8828
 Site-SynthDigits               (1) | Train Loss: 0.4430 | Train Acc: 0.9022
 Site-MNIST_M                   (8) | Train Loss: 0.7581 | Train Acc: 0.7845
 Site-MNIST_M                   (3) | Train Loss: 0.7660 | Train Acc: 0.8043
 Site-SVHN                      (4) | Train Loss: 0.9689 | Train Acc: 0.7163
Average Train Accuracy: 0.9009
 Site-MNIST                     (5) | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.0341 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4846 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5136 | Val  Acc: 0.7778
 Site-MNIST                     (6) | Val  Loss: 0.3222 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2119 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1797 | Val  Acc: 0.9643
 Site-MNIST                     (6) | Val  Loss: 0.1956 | Val  Acc: 0.9216
 Site-MNIST                     (6) | Val  Loss: 0.2409 | Val  Acc: 0.9454
 Site-MNIST                     (6) | Val  Loss: 0.2304 | Val  Acc: 0.9486
 Site-USPS                      (7) | Val  Loss: 0.1369 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.4951 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5362 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4511 | Val  Acc: 0.8276
 Site-USPS                      (9) | Val  Loss: 0.3746 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2893 | Val  Acc: 0.9101
 Site-SynthDigits               (1) | Val  Loss: 0.4634 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.3644 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.4630 | Val  Acc: 0.8770
 Site-MNIST_M                   (8) | Val  Loss: 0.8306 | Val  Acc: 0.8222
 Site-MNIST_M                   (3) | Val  Loss: 0.6873 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.7304 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8854
 Best site-MNIST                    (5)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.7778
 Best site-MNIST                    (6)  | Epoch:35 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.9643
 Best site-MNIST                    (6)  | Epoch:35 | Val Acc: 0.9216
 Best site-MNIST                    (6)  | Epoch:35 | Val Acc: 0.9454
 Best site-MNIST                    (6)  | Epoch:35 | Val Acc: 0.9486
 Best site-USPS                     (7)  | Epoch:35 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8276
 Best site-USPS                     (9)  | Epoch:35 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.9101
 Best site-SynthDigits              (1)  | Epoch:35 | Val Acc: 0.8919
 Best site-SynthDigits              (1)  | Epoch:35 | Val Acc: 0.8971
 Best site-SynthDigits              (1)  | Epoch:35 | Val Acc: 0.8770
 Best site-MNIST_M                  (8)  | Epoch:35 | Val Acc: 0.8222
 Best site-MNIST_M                  (3)  | Epoch:35 | Val Acc: 0.8765
 Best site-SVHN                     (4)  | Epoch:35 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 36 ============
cnt=[3, 2, 3, 2, 1, 1, 5, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (5) | Train Loss: 0.5188 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.3082 | Train Acc: 0.9167
 Site-MNIST                     (9) | Train Loss: 0.1398 | Train Acc: 0.9524
 Site-MNIST                     (6) | Train Loss: 0.1479 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2971 | Train Acc: 0.9286
 Site-MNIST                     (6) | Train Loss: 0.1648 | Train Acc: 0.9683
 Site-MNIST                     (6) | Train Loss: 0.1751 | Train Acc: 0.9604
 Site-MNIST                     (0) | Train Loss: 0.2351 | Train Acc: 0.9340
 Site-MNIST                     (0) | Train Loss: 0.2376 | Train Acc: 0.9375
 Site-MNIST                     (6) | Train Loss: 0.1845 | Train Acc: 0.9623
 Site-USPS                      (8) | Train Loss: 0.2764 | Train Acc: 0.9750
 Site-USPS                      (7) | Train Loss: 0.3607 | Train Acc: 0.9306
 Site-USPS                      (7) | Train Loss: 0.1873 | Train Acc: 0.9225
 Site-USPS                      (7) | Train Loss: 0.3341 | Train Acc: 0.8798
 Site-USPS                      (1) | Train Loss: 0.2421 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.2701 | Train Acc: 0.9325
 Site-SynthDigits               (2) | Train Loss: 0.5356 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.4689 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 0.4395 | Train Acc: 0.9104
 Site-MNIST_M                   (3) | Train Loss: 0.7396 | Train Acc: 0.8011
 Site-MNIST_M                   (3) | Train Loss: 0.6760 | Train Acc: 0.8012
 Site-SVHN                      (4) | Train Loss: 0.9572 | Train Acc: 0.7163
Average Train Accuracy: 0.9049
 Site-MNIST                     (5) | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.4977 | Val  Acc: 0.8000
 Site-MNIST                     (6) | Val  Loss: 0.5182 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3249 | Val  Acc: 0.8824
 Site-MNIST                     (6) | Val  Loss: 0.2107 | Val  Acc: 0.9355
 Site-MNIST                     (6) | Val  Loss: 0.1784 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1939 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2380 | Val  Acc: 0.9399
 Site-MNIST                     (6) | Val  Loss: 0.2282 | Val  Acc: 0.9456
 Site-USPS                      (8) | Val  Loss: 0.1252 | Val  Acc: 0.9000
 Site-USPS                      (7) | Val  Loss: 0.4854 | Val  Acc: 0.7778
 Site-USPS                      (7) | Val  Loss: 0.5278 | Val  Acc: 0.7500
 Site-USPS                      (7) | Val  Loss: 0.4447 | Val  Acc: 0.8103
 Site-USPS                      (1) | Val  Loss: 0.3720 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.2882 | Val  Acc: 0.8995
 Site-SynthDigits               (2) | Val  Loss: 0.4594 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3530 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.4507 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.7990 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.6685 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.7094 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8829
============ Train epoch 37 ============
cnt=[1, 2, 5, 1, 1, 1, 1, 7, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (5) | Train Loss: 0.5258 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.3063 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.1301 | Train Acc: 0.9524
 Site-MNIST                     (7) | Train Loss: 0.1400 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3778 | Train Acc: 0.9286
 Site-MNIST                     (7) | Train Loss: 0.1609 | Train Acc: 0.9683
 Site-MNIST                     (7) | Train Loss: 0.1650 | Train Acc: 0.9604
 Site-MNIST                     (7) | Train Loss: 0.2250 | Train Acc: 0.9340
 Site-MNIST                     (7) | Train Loss: 0.2189 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1807 | Train Acc: 0.9592
 Site-USPS                      (6) | Train Loss: 0.2629 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.4140 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1900 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3194 | Train Acc: 0.8798
 Site-USPS                      (2) | Train Loss: 0.2458 | Train Acc: 0.9452
 Site-USPS                      (2) | Train Loss: 0.2650 | Train Acc: 0.9365
 Site-SynthDigits               (8) | Train Loss: 0.5211 | Train Acc: 0.8411
 Site-SynthDigits               (8) | Train Loss: 0.5166 | Train Acc: 0.8828
 Site-SynthDigits               (0) | Train Loss: 0.4269 | Train Acc: 0.9124
 Site-MNIST_M                   (3) | Train Loss: 0.7271 | Train Acc: 0.7956
 Site-MNIST_M                   (9) | Train Loss: 0.7334 | Train Acc: 0.8012
 Site-SVHN                      (4) | Train Loss: 0.9027 | Train Acc: 0.7270
Average Train Accuracy: 0.9052
 Site-MNIST                     (5) | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4951 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5235 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3249 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.2106 | Val  Acc: 0.9355
 Site-MNIST                     (7) | Val  Loss: 0.1744 | Val  Acc: 0.9643
 Site-MNIST                     (7) | Val  Loss: 0.1910 | Val  Acc: 0.9216
 Site-MNIST                     (7) | Val  Loss: 0.2351 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2253 | Val  Acc: 0.9456
 Site-USPS                      (6) | Val  Loss: 0.1200 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.4842 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5274 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4349 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.3656 | Val  Acc: 0.8762
 Site-USPS                      (2) | Val  Loss: 0.2875 | Val  Acc: 0.8889
 Site-SynthDigits               (8) | Val  Loss: 0.4506 | Val  Acc: 0.9189
 Site-SynthDigits               (8) | Val  Loss: 0.3459 | Val  Acc: 0.9118
 Site-SynthDigits               (0) | Val  Loss: 0.4459 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8119 | Val  Acc: 0.8444
 Site-MNIST_M                   (9) | Val  Loss: 0.6687 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.6909 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8866
 Best site-MNIST                    (5)  | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:37 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:37 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.8824
 Best site-MNIST                    (7)  | Epoch:37 | Val Acc: 0.9355
 Best site-MNIST                    (7)  | Epoch:37 | Val Acc: 0.9643
 Best site-MNIST                    (7)  | Epoch:37 | Val Acc: 0.9216
 Best site-MNIST                    (7)  | Epoch:37 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.9456
 Best site-USPS                     (6)  | Epoch:37 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:37 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:37 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:37 | Val Acc: 0.8276
 Best site-USPS                     (2)  | Epoch:37 | Val Acc: 0.8762
 Best site-USPS                     (2)  | Epoch:37 | Val Acc: 0.8889
 Best site-SynthDigits              (8)  | Epoch:37 | Val Acc: 0.9189
 Best site-SynthDigits              (8)  | Epoch:37 | Val Acc: 0.9118
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.8852
 Best site-MNIST_M                  (3)  | Epoch:37 | Val Acc: 0.8444
 Best site-MNIST_M                  (9)  | Epoch:37 | Val Acc: 0.8765
 Best site-SVHN                     (4)  | Epoch:37 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 38 ============
cnt=[1, 2, 3, 1, 5, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (0) | Train Loss: 0.5190 | Train Acc: 0.8333
 Site-MNIST                     (4) | Train Loss: 0.2990 | Train Acc: 0.9167
 Site-MNIST                     (9) | Train Loss: 0.1332 | Train Acc: 0.9524
 Site-MNIST                     (9) | Train Loss: 0.1362 | Train Acc: 0.9737
 Site-MNIST                     (4) | Train Loss: 0.1906 | Train Acc: 0.9286
 Site-MNIST                     (9) | Train Loss: 0.1602 | Train Acc: 0.9683
 Site-MNIST                     (9) | Train Loss: 0.1688 | Train Acc: 0.9648
 Site-MNIST                     (4) | Train Loss: 0.2241 | Train Acc: 0.9364
 Site-MNIST                     (4) | Train Loss: 0.2160 | Train Acc: 0.9416
 Site-MNIST                     (4) | Train Loss: 0.1794 | Train Acc: 0.9592
 Site-USPS                      (6) | Train Loss: 0.2549 | Train Acc: 0.9750
 Site-USPS                      (7) | Train Loss: 0.3103 | Train Acc: 0.9306
 Site-USPS                      (7) | Train Loss: 0.6623 | Train Acc: 0.9147
 Site-USPS                      (7) | Train Loss: 0.3060 | Train Acc: 0.8798
 Site-USPS                      (1) | Train Loss: 0.2352 | Train Acc: 0.9476
 Site-USPS                      (1) | Train Loss: 0.2567 | Train Acc: 0.9339
 Site-SynthDigits               (2) | Train Loss: 0.5288 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.4893 | Train Acc: 0.8901
 Site-SynthDigits               (2) | Train Loss: 0.4128 | Train Acc: 0.9124
 Site-MNIST_M                   (3) | Train Loss: 0.7057 | Train Acc: 0.8177
 Site-MNIST_M                   (8) | Train Loss: 0.7257 | Train Acc: 0.8043
 Site-SVHN                      (5) | Train Loss: 0.8796 | Train Acc: 0.7199
Average Train Accuracy: 0.9065
 Site-MNIST                     (0) | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.4936 | Val  Acc: 0.8000
 Site-MNIST                     (9) | Val  Loss: 0.5213 | Val  Acc: 0.7778
 Site-MNIST                     (4) | Val  Loss: 0.3226 | Val  Acc: 0.8824
 Site-MNIST                     (9) | Val  Loss: 0.2116 | Val  Acc: 0.9355
 Site-MNIST                     (9) | Val  Loss: 0.1752 | Val  Acc: 0.9643
 Site-MNIST                     (4) | Val  Loss: 0.1898 | Val  Acc: 0.9216
 Site-MNIST                     (4) | Val  Loss: 0.2337 | Val  Acc: 0.9399
 Site-MNIST                     (4) | Val  Loss: 0.2223 | Val  Acc: 0.9517
 Site-USPS                      (6) | Val  Loss: 0.1166 | Val  Acc: 0.9000
 Site-USPS                      (7) | Val  Loss: 0.4637 | Val  Acc: 0.8333
 Site-USPS                      (7) | Val  Loss: 0.5080 | Val  Acc: 0.7812
 Site-USPS                      (7) | Val  Loss: 0.4276 | Val  Acc: 0.8276
 Site-USPS                      (1) | Val  Loss: 0.3533 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.2743 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.4469 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3387 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.4358 | Val  Acc: 0.8770
 Site-MNIST_M                   (3) | Val  Loss: 0.7854 | Val  Acc: 0.8667
 Site-MNIST_M                   (8) | Val  Loss: 0.6530 | Val  Acc: 0.8889
 Site-SVHN                      (5) | Val  Loss: 0.6834 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8887
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (9)  | Epoch:38 | Val Acc: 0.8000
 Best site-MNIST                    (9)  | Epoch:38 | Val Acc: 0.7778
 Best site-MNIST                    (4)  | Epoch:38 | Val Acc: 0.8824
 Best site-MNIST                    (9)  | Epoch:38 | Val Acc: 0.9355
 Best site-MNIST                    (9)  | Epoch:38 | Val Acc: 0.9643
 Best site-MNIST                    (4)  | Epoch:38 | Val Acc: 0.9216
 Best site-MNIST                    (4)  | Epoch:38 | Val Acc: 0.9399
 Best site-MNIST                    (4)  | Epoch:38 | Val Acc: 0.9517
 Best site-USPS                     (6)  | Epoch:38 | Val Acc: 0.9000
 Best site-USPS                     (7)  | Epoch:38 | Val Acc: 0.8333
 Best site-USPS                     (7)  | Epoch:38 | Val Acc: 0.7812
 Best site-USPS                     (7)  | Epoch:38 | Val Acc: 0.8276
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.8952
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9048
 Best site-SynthDigits              (2)  | Epoch:38 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:38 | Val Acc: 0.9265
 Best site-SynthDigits              (2)  | Epoch:38 | Val Acc: 0.8770
 Best site-MNIST_M                  (3)  | Epoch:38 | Val Acc: 0.8667
 Best site-MNIST_M                  (8)  | Epoch:38 | Val Acc: 0.8889
 Best site-SVHN                     (5)  | Epoch:38 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 2, 3, 1, 1, 1, 1, 7, 3, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (5) | Train Loss: 0.5268 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.3038 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.1410 | Train Acc: 0.9524
 Site-MNIST                     (7) | Train Loss: 0.1420 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3731 | Train Acc: 0.9286
 Site-MNIST                     (7) | Train Loss: 0.1637 | Train Acc: 0.9683
 Site-MNIST                     (7) | Train Loss: 0.1905 | Train Acc: 0.9604
 Site-MNIST                     (0) | Train Loss: 0.2115 | Train Acc: 0.9389
 Site-MNIST                     (7) | Train Loss: 0.2223 | Train Acc: 0.9389
 Site-MNIST                     (7) | Train Loss: 0.1827 | Train Acc: 0.9592
 Site-USPS                      (6) | Train Loss: 0.2571 | Train Acc: 0.9750
 Site-USPS                      (8) | Train Loss: 0.2668 | Train Acc: 0.9306
 Site-USPS                      (8) | Train Loss: 0.3728 | Train Acc: 0.9302
 Site-USPS                      (8) | Train Loss: 0.3025 | Train Acc: 0.9013
 Site-USPS                      (1) | Train Loss: 0.2228 | Train Acc: 0.9381
 Site-USPS                      (1) | Train Loss: 0.2460 | Train Acc: 0.9365
 Site-SynthDigits               (2) | Train Loss: 0.5533 | Train Acc: 0.8344
 Site-SynthDigits               (2) | Train Loss: 0.4843 | Train Acc: 0.8974
 Site-SynthDigits               (2) | Train Loss: 0.4161 | Train Acc: 0.9145
 Site-MNIST_M                   (3) | Train Loss: 0.7011 | Train Acc: 0.8398
 Site-MNIST_M                   (9) | Train Loss: 0.6726 | Train Acc: 0.8104
 Site-SVHN                      (4) | Train Loss: 0.8704 | Train Acc: 0.7270
Average Train Accuracy: 0.9093
 Site-MNIST                     (5) | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.0274 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4770 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5031 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3159 | Val  Acc: 0.8824
 Site-MNIST                     (7) | Val  Loss: 0.2121 | Val  Acc: 0.9355
 Site-MNIST                     (7) | Val  Loss: 0.1785 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1901 | Val  Acc: 0.9216
 Site-MNIST                     (7) | Val  Loss: 0.2343 | Val  Acc: 0.9344
 Site-MNIST                     (7) | Val  Loss: 0.2227 | Val  Acc: 0.9486
 Site-USPS                      (6) | Val  Loss: 0.1051 | Val  Acc: 1.0000
 Site-USPS                      (8) | Val  Loss: 0.4372 | Val  Acc: 0.7778
 Site-USPS                      (8) | Val  Loss: 0.4705 | Val  Acc: 0.7812
 Site-USPS                      (8) | Val  Loss: 0.4091 | Val  Acc: 0.8448
 Site-USPS                      (1) | Val  Loss: 0.3371 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.2584 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.4346 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3279 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.4229 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.7584 | Val  Acc: 0.8667
 Site-MNIST_M                   (9) | Val  Loss: 0.6380 | Val  Acc: 0.8889
 Site-SVHN                      (4) | Val  Loss: 0.6777 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8915
 Best site-MNIST                    (5)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.8824
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 0.9355
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9216
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 0.9344
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 0.9486
 Best site-USPS                     (6)  | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                     (8)  | Epoch:39 | Val Acc: 0.7778
 Best site-USPS                     (8)  | Epoch:39 | Val Acc: 0.7812
 Best site-USPS                     (8)  | Epoch:39 | Val Acc: 0.8448
 Best site-USPS                     (1)  | Epoch:39 | Val Acc: 0.8952
 Best site-USPS                     (1)  | Epoch:39 | Val Acc: 0.9048
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.9265
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.8852
 Best site-MNIST_M                  (3)  | Epoch:39 | Val Acc: 0.8667
 Best site-MNIST_M                  (9)  | Epoch:39 | Val Acc: 0.8889
 Best site-SVHN                     (4)  | Epoch:39 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 40 ============
cnt=[5, 2, 1, 1, 1, 1, 4, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (5) | Train Loss: 0.5626 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.2957 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1425 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1377 | Train Acc: 0.9737
 Site-MNIST                     (6) | Train Loss: 0.3708 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1641 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1753 | Train Acc: 0.9648
 Site-MNIST                     (6) | Train Loss: 0.2145 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.2179 | Train Acc: 0.9443
 Site-MNIST                     (6) | Train Loss: 0.1807 | Train Acc: 0.9592
 Site-USPS                      (2) | Train Loss: 0.2361 | Train Acc: 0.9750
 Site-USPS                      (7) | Train Loss: 0.1990 | Train Acc: 0.9306
 Site-USPS                      (7) | Train Loss: 0.2099 | Train Acc: 0.9302
 Site-USPS                      (7) | Train Loss: 0.3047 | Train Acc: 0.8841
 Site-USPS                      (7) | Train Loss: 0.2228 | Train Acc: 0.9405
 Site-USPS                      (7) | Train Loss: 0.2430 | Train Acc: 0.9392
 Site-SynthDigits               (1) | Train Loss: 0.5659 | Train Acc: 0.8411
 Site-SynthDigits               (1) | Train Loss: 0.4502 | Train Acc: 0.8864
 Site-SynthDigits               (9) | Train Loss: 0.4031 | Train Acc: 0.9145
 Site-MNIST_M                   (3) | Train Loss: 0.7055 | Train Acc: 0.8287
 Site-MNIST_M                   (8) | Train Loss: 0.6409 | Train Acc: 0.7982
 Site-SVHN                      (4) | Train Loss: 0.8803 | Train Acc: 0.7447
Average Train Accuracy: 0.9084
 Site-MNIST                     (5) | Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4735 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4983 | Val  Acc: 0.7778
 Site-MNIST                     (6) | Val  Loss: 0.3123 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2078 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1741 | Val  Acc: 0.9643
 Site-MNIST                     (6) | Val  Loss: 0.1873 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2309 | Val  Acc: 0.9399
 Site-MNIST                     (6) | Val  Loss: 0.2217 | Val  Acc: 0.9456
 Site-USPS                      (2) | Val  Loss: 0.1031 | Val  Acc: 1.0000
 Site-USPS                      (7) | Val  Loss: 0.4319 | Val  Acc: 0.8333
 Site-USPS                      (7) | Val  Loss: 0.4697 | Val  Acc: 0.7812
 Site-USPS                      (7) | Val  Loss: 0.4063 | Val  Acc: 0.8276
 Site-USPS                      (7) | Val  Loss: 0.3402 | Val  Acc: 0.8952
 Site-USPS                      (7) | Val  Loss: 0.2596 | Val  Acc: 0.9101
 Site-SynthDigits               (1) | Val  Loss: 0.4216 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.3191 | Val  Acc: 0.9265
 Site-SynthDigits               (9) | Val  Loss: 0.4143 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.7755 | Val  Acc: 0.8667
 Site-MNIST_M                   (8) | Val  Loss: 0.6457 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6678 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8942
 Best site-MNIST                    (5)  | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                    (6)  | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.7778
 Best site-MNIST                    (6)  | Epoch:40 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9643
 Best site-MNIST                    (6)  | Epoch:40 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9399
 Best site-MNIST                    (6)  | Epoch:40 | Val Acc: 0.9456
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                     (7)  | Epoch:40 | Val Acc: 0.8333
 Best site-USPS                     (7)  | Epoch:40 | Val Acc: 0.7812
 Best site-USPS                     (7)  | Epoch:40 | Val Acc: 0.8276
 Best site-USPS                     (7)  | Epoch:40 | Val Acc: 0.8952
 Best site-USPS                     (7)  | Epoch:40 | Val Acc: 0.9101
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8919
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.9265
 Best site-SynthDigits              (9)  | Epoch:40 | Val Acc: 0.8852
 Best site-MNIST_M                  (3)  | Epoch:40 | Val Acc: 0.8667
 Best site-MNIST_M                  (8)  | Epoch:40 | Val Acc: 0.9012
 Best site-SVHN                     (4)  | Epoch:40 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 1, 5, 3, 1, 1, 2, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (5) | Train Loss: 0.5580 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.2901 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.1345 | Train Acc: 0.9524
 Site-MNIST                     (7) | Train Loss: 0.1378 | Train Acc: 0.9737
 Site-MNIST                     (2) | Train Loss: 0.1582 | Train Acc: 0.9143
 Site-MNIST                     (2) | Train Loss: 0.1545 | Train Acc: 0.9683
 Site-MNIST                     (2) | Train Loss: 0.1626 | Train Acc: 0.9648
 Site-MNIST                     (2) | Train Loss: 0.2279 | Train Acc: 0.9413
 Site-MNIST                     (7) | Train Loss: 0.2109 | Train Acc: 0.9457
 Site-MNIST                     (7) | Train Loss: 0.1753 | Train Acc: 0.9592
 Site-USPS                      (8) | Train Loss: 0.2418 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.1777 | Train Acc: 0.9167
 Site-USPS                      (9) | Train Loss: 0.2068 | Train Acc: 0.9302
 Site-USPS                      (6) | Train Loss: 0.2942 | Train Acc: 0.8841
 Site-USPS                      (6) | Train Loss: 0.2249 | Train Acc: 0.9405
 Site-USPS                      (9) | Train Loss: 0.2446 | Train Acc: 0.9405
 Site-SynthDigits               (3) | Train Loss: 0.5313 | Train Acc: 0.8411
 Site-SynthDigits               (3) | Train Loss: 0.4156 | Train Acc: 0.9011
 Site-SynthDigits               (3) | Train Loss: 0.3925 | Train Acc: 0.9246
 Site-MNIST_M                   (0) | Train Loss: 0.7064 | Train Acc: 0.8066
 Site-MNIST_M                   (0) | Train Loss: 0.7124 | Train Acc: 0.7890
 Site-SVHN                      (4) | Train Loss: 0.8223 | Train Acc: 0.7340
Average Train Accuracy: 0.9070
 Site-MNIST                     (5) | Val  Loss: 0.0119 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.4871 | Val  Acc: 0.8000
 Site-MNIST                     (7) | Val  Loss: 0.5117 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.3164 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.2039 | Val  Acc: 0.9355
 Site-MNIST                     (2) | Val  Loss: 0.1673 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.1825 | Val  Acc: 0.9216
 Site-MNIST                     (7) | Val  Loss: 0.2266 | Val  Acc: 0.9454
 Site-MNIST                     (7) | Val  Loss: 0.2184 | Val  Acc: 0.9517
 Site-USPS                      (8) | Val  Loss: 0.1011 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4446 | Val  Acc: 0.8333
 Site-USPS                      (9) | Val  Loss: 0.4843 | Val  Acc: 0.8125
 Site-USPS                      (6) | Val  Loss: 0.4078 | Val  Acc: 0.8448
 Site-USPS                      (6) | Val  Loss: 0.3420 | Val  Acc: 0.8952
 Site-USPS                      (9) | Val  Loss: 0.2639 | Val  Acc: 0.8995
 Site-SynthDigits               (3) | Val  Loss: 0.4176 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.3053 | Val  Acc: 0.9265
 Site-SynthDigits               (3) | Val  Loss: 0.4068 | Val  Acc: 0.9016
 Site-MNIST_M                   (0) | Val  Loss: 0.7711 | Val  Acc: 0.8667
 Site-MNIST_M                   (0) | Val  Loss: 0.6396 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6512 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8984
 Best site-MNIST                    (5)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:41 | Val Acc: 0.8000
 Best site-MNIST                    (7)  | Epoch:41 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:41 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:41 | Val Acc: 0.9355
 Best site-MNIST                    (2)  | Epoch:41 | Val Acc: 0.9643
 Best site-MNIST                    (2)  | Epoch:41 | Val Acc: 0.9216
 Best site-MNIST                    (7)  | Epoch:41 | Val Acc: 0.9454
 Best site-MNIST                    (7)  | Epoch:41 | Val Acc: 0.9517
 Best site-USPS                     (8)  | Epoch:41 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8333
 Best site-USPS                     (9)  | Epoch:41 | Val Acc: 0.8125
 Best site-USPS                     (6)  | Epoch:41 | Val Acc: 0.8448
 Best site-USPS                     (6)  | Epoch:41 | Val Acc: 0.8952
 Best site-USPS                     (9)  | Epoch:41 | Val Acc: 0.8995
 Best site-SynthDigits              (3)  | Epoch:41 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:41 | Val Acc: 0.9265
 Best site-SynthDigits              (3)  | Epoch:41 | Val Acc: 0.9016
 Best site-MNIST_M                  (0)  | Epoch:41 | Val Acc: 0.8667
 Best site-MNIST_M                  (0)  | Epoch:41 | Val Acc: 0.9012
 Best site-SVHN                     (4)  | Epoch:41 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 42 ============
cnt=[1, 5, 1, 3, 1, 1, 1, 4, 1, 4, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (5) | Train Loss: 0.5391 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2919 | Train Acc: 0.9167
 Site-MNIST                     (9) | Train Loss: 0.1337 | Train Acc: 0.9524
 Site-MNIST                     (9) | Train Loss: 0.1379 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3585 | Train Acc: 0.9143
 Site-MNIST                     (9) | Train Loss: 0.1569 | Train Acc: 0.9683
 Site-MNIST                     (9) | Train Loss: 0.1646 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2337 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2102 | Train Acc: 0.9429
 Site-MNIST                     (1) | Train Loss: 0.1735 | Train Acc: 0.9600
 Site-USPS                      (6) | Train Loss: 0.2447 | Train Acc: 0.9750
 Site-USPS                      (7) | Train Loss: 0.2284 | Train Acc: 0.9167
 Site-USPS                      (7) | Train Loss: 0.9187 | Train Acc: 0.9380
 Site-USPS                      (7) | Train Loss: 0.2846 | Train Acc: 0.9013
 Site-USPS                      (7) | Train Loss: 0.2210 | Train Acc: 0.9452
 Site-USPS                      (0) | Train Loss: 0.2430 | Train Acc: 0.9352
 Site-SynthDigits               (3) | Train Loss: 0.5535 | Train Acc: 0.8808
 Site-SynthDigits               (3) | Train Loss: 0.4538 | Train Acc: 0.9048
 Site-SynthDigits               (3) | Train Loss: 0.3929 | Train Acc: 0.9226
 Site-MNIST_M                   (2) | Train Loss: 0.6726 | Train Acc: 0.8232
 Site-MNIST_M                   (8) | Train Loss: 0.6937 | Train Acc: 0.8226
 Site-SVHN                      (4) | Train Loss: 0.8218 | Train Acc: 0.7163
Average Train Accuracy: 0.9112
 Site-MNIST                     (5) | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0288 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.5154 | Val  Acc: 0.8000
 Site-MNIST                     (9) | Val  Loss: 0.5213 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3257 | Val  Acc: 0.8824
 Site-MNIST                     (9) | Val  Loss: 0.2019 | Val  Acc: 0.9355
 Site-MNIST                     (9) | Val  Loss: 0.1662 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1809 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2256 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2175 | Val  Acc: 0.9426
 Site-USPS                      (6) | Val  Loss: 0.0923 | Val  Acc: 1.0000
 Site-USPS                      (7) | Val  Loss: 0.4273 | Val  Acc: 0.8889
 Site-USPS                      (7) | Val  Loss: 0.4720 | Val  Acc: 0.8125
 Site-USPS                      (7) | Val  Loss: 0.4096 | Val  Acc: 0.8103
 Site-USPS                      (7) | Val  Loss: 0.3430 | Val  Acc: 0.8857
 Site-USPS                      (0) | Val  Loss: 0.2594 | Val  Acc: 0.9048
 Site-SynthDigits               (3) | Val  Loss: 0.4225 | Val  Acc: 0.8919
 Site-SynthDigits               (3) | Val  Loss: 0.3011 | Val  Acc: 0.9265
 Site-SynthDigits               (3) | Val  Loss: 0.3971 | Val  Acc: 0.8934
 Site-MNIST_M                   (2) | Val  Loss: 0.7272 | Val  Acc: 0.8667
 Site-MNIST_M                   (8) | Val  Loss: 0.6125 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6603 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8960
============ Train epoch 43 ============
cnt=[3, 2, 4, 2, 1, 1, 6, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (5) | Train Loss: 0.5193 | Train Acc: 0.8333
 Site-MNIST                     (6) | Train Loss: 0.2964 | Train Acc: 0.9167
 Site-MNIST                     (9) | Train Loss: 0.1271 | Train Acc: 0.9524
 Site-MNIST                     (6) | Train Loss: 0.1416 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3634 | Train Acc: 0.9143
 Site-MNIST                     (6) | Train Loss: 0.1529 | Train Acc: 0.9683
 Site-MNIST                     (6) | Train Loss: 0.1592 | Train Acc: 0.9648
 Site-MNIST                     (6) | Train Loss: 0.2047 | Train Acc: 0.9438
 Site-MNIST                     (6) | Train Loss: 0.2165 | Train Acc: 0.9416
 Site-MNIST                     (1) | Train Loss: 0.1713 | Train Acc: 0.9623
 Site-USPS                      (8) | Train Loss: 0.2274 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2712 | Train Acc: 0.9167
 Site-USPS                      (2) | Train Loss: 0.5372 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.2722 | Train Acc: 0.8927
 Site-USPS                      (7) | Train Loss: 0.2054 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2333 | Train Acc: 0.9352
 Site-SynthDigits               (0) | Train Loss: 0.5018 | Train Acc: 0.8411
 Site-SynthDigits               (0) | Train Loss: 0.4497 | Train Acc: 0.9084
 Site-SynthDigits               (0) | Train Loss: 0.3957 | Train Acc: 0.9165
 Site-MNIST_M                   (3) | Train Loss: 0.6563 | Train Acc: 0.8398
 Site-MNIST_M                   (3) | Train Loss: 0.6148 | Train Acc: 0.8349
 Site-SVHN                      (4) | Train Loss: 0.7996 | Train Acc: 0.7482
Average Train Accuracy: 0.9120
 Site-MNIST                     (5) | Val  Loss: 0.0105 | Val  Acc: 1.0000
 Site-MNIST                     (6) | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.5088 | Val  Acc: 0.8000
 Site-MNIST                     (6) | Val  Loss: 0.5104 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3210 | Val  Acc: 0.8824
 Site-MNIST                     (6) | Val  Loss: 0.1996 | Val  Acc: 0.9355
 Site-MNIST                     (6) | Val  Loss: 0.1660 | Val  Acc: 0.9643
 Site-MNIST                     (6) | Val  Loss: 0.1785 | Val  Acc: 0.9216
 Site-MNIST                     (6) | Val  Loss: 0.2235 | Val  Acc: 0.9454
 Site-MNIST                     (1) | Val  Loss: 0.2131 | Val  Acc: 0.9486
 Site-USPS                      (8) | Val  Loss: 0.0949 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4119 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4443 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.3971 | Val  Acc: 0.8448
 Site-USPS                      (7) | Val  Loss: 0.3301 | Val  Acc: 0.8762
 Site-USPS                      (2) | Val  Loss: 0.2442 | Val  Acc: 0.9153
 Site-SynthDigits               (0) | Val  Loss: 0.4176 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.2893 | Val  Acc: 0.9265
 Site-SynthDigits               (0) | Val  Loss: 0.3909 | Val  Acc: 0.9098
 Site-MNIST_M                   (3) | Val  Loss: 0.7064 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.5985 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6687 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8975
============ Train epoch 44 ============
cnt=[1, 4, 2, 3, 3, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (5) | Train Loss: 0.5272 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2968 | Train Acc: 0.9167
 Site-MNIST                     (8) | Train Loss: 0.1146 | Train Acc: 0.9524
 Site-MNIST                     (6) | Train Loss: 0.1312 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1794 | Train Acc: 0.9143
 Site-MNIST                     (6) | Train Loss: 0.1458 | Train Acc: 0.9683
 Site-MNIST                     (6) | Train Loss: 0.1785 | Train Acc: 0.9692
 Site-MNIST                     (6) | Train Loss: 0.2096 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2058 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1663 | Train Acc: 0.9615
 Site-USPS                      (9) | Train Loss: 0.2277 | Train Acc: 0.9750
 Site-USPS                      (3) | Train Loss: 0.2794 | Train Acc: 0.9306
 Site-USPS                      (3) | Train Loss: 0.1707 | Train Acc: 0.9302
 Site-USPS                      (3) | Train Loss: 0.2771 | Train Acc: 0.8884
 Site-USPS                      (7) | Train Loss: 0.2046 | Train Acc: 0.9524
 Site-USPS                      (7) | Train Loss: 0.2276 | Train Acc: 0.9405
 Site-SynthDigits               (4) | Train Loss: 0.5515 | Train Acc: 0.8543
 Site-SynthDigits               (4) | Train Loss: 0.4387 | Train Acc: 0.9121
 Site-SynthDigits               (4) | Train Loss: 0.3804 | Train Acc: 0.9145
 Site-MNIST_M                   (2) | Train Loss: 0.6525 | Train Acc: 0.8398
 Site-MNIST_M                   (2) | Train Loss: 0.6216 | Train Acc: 0.8318
 Site-SVHN                      (0) | Train Loss: 0.7910 | Train Acc: 0.7553
Average Train Accuracy: 0.9132
 Site-MNIST                     (5) | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0251 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.5013 | Val  Acc: 0.8000
 Site-MNIST                     (6) | Val  Loss: 0.5077 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3177 | Val  Acc: 0.8824
 Site-MNIST                     (6) | Val  Loss: 0.1960 | Val  Acc: 0.9355
 Site-MNIST                     (6) | Val  Loss: 0.1618 | Val  Acc: 0.9643
 Site-MNIST                     (6) | Val  Loss: 0.1749 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2203 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2086 | Val  Acc: 0.9486
 Site-USPS                      (9) | Val  Loss: 0.1018 | Val  Acc: 1.0000
 Site-USPS                      (3) | Val  Loss: 0.4107 | Val  Acc: 0.8333
 Site-USPS                      (3) | Val  Loss: 0.4452 | Val  Acc: 0.8125
 Site-USPS                      (3) | Val  Loss: 0.3929 | Val  Acc: 0.8448
 Site-USPS                      (7) | Val  Loss: 0.3301 | Val  Acc: 0.8857
 Site-USPS                      (7) | Val  Loss: 0.2433 | Val  Acc: 0.9206
 Site-SynthDigits               (4) | Val  Loss: 0.4036 | Val  Acc: 0.9189
 Site-SynthDigits               (4) | Val  Loss: 0.2840 | Val  Acc: 0.9118
 Site-SynthDigits               (4) | Val  Loss: 0.3852 | Val  Acc: 0.9098
 Site-MNIST_M                   (2) | Val  Loss: 0.7167 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.6009 | Val  Acc: 0.9012
 Site-SVHN                      (0) | Val  Loss: 0.6576 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8993
 Best site-MNIST                    (5)  | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST                    (8)  | Epoch:44 | Val Acc: 0.8000
 Best site-MNIST                    (6)  | Epoch:44 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.8824
 Best site-MNIST                    (6)  | Epoch:44 | Val Acc: 0.9355
 Best site-MNIST                    (6)  | Epoch:44 | Val Acc: 0.9643
 Best site-MNIST                    (6)  | Epoch:44 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9399
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9486
 Best site-USPS                     (9)  | Epoch:44 | Val Acc: 1.0000
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.8333
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.8125
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.8448
 Best site-USPS                     (7)  | Epoch:44 | Val Acc: 0.8857
 Best site-USPS                     (7)  | Epoch:44 | Val Acc: 0.9206
 Best site-SynthDigits              (4)  | Epoch:44 | Val Acc: 0.9189
 Best site-SynthDigits              (4)  | Epoch:44 | Val Acc: 0.9118
 Best site-SynthDigits              (4)  | Epoch:44 | Val Acc: 0.9098
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.8667
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.9012
 Best site-SVHN                     (0)  | Epoch:44 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 45 ============
cnt=[1, 3, 1, 1, 3, 1, 5, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (5) | Train Loss: 0.5072 | Train Acc: 0.8333
 Site-MNIST                     (7) | Train Loss: 0.3019 | Train Acc: 0.9167
 Site-MNIST                     (9) | Train Loss: 0.1060 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1329 | Train Acc: 0.9474
 Site-MNIST                     (7) | Train Loss: 0.1919 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1387 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1641 | Train Acc: 0.9648
 Site-MNIST                     (7) | Train Loss: 0.2098 | Train Acc: 0.9389
 Site-MNIST                     (9) | Train Loss: 0.1996 | Train Acc: 0.9375
 Site-MNIST                     (7) | Train Loss: 0.1611 | Train Acc: 0.9608
 Site-USPS                      (2) | Train Loss: 0.2361 | Train Acc: 0.9750
 Site-USPS                      (6) | Train Loss: 0.4608 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.1651 | Train Acc: 0.9380
 Site-USPS                      (6) | Train Loss: 0.2912 | Train Acc: 0.8927
 Site-USPS                      (6) | Train Loss: 0.2103 | Train Acc: 0.9548
 Site-USPS                      (6) | Train Loss: 0.2276 | Train Acc: 0.9405
 Site-SynthDigits               (4) | Train Loss: 0.4734 | Train Acc: 0.8609
 Site-SynthDigits               (4) | Train Loss: 0.4247 | Train Acc: 0.8974
 Site-SynthDigits               (4) | Train Loss: 0.3767 | Train Acc: 0.9206
 Site-MNIST_M                   (8) | Train Loss: 0.6411 | Train Acc: 0.8564
 Site-MNIST_M                   (3) | Train Loss: 0.6045 | Train Acc: 0.8379
 Site-SVHN                      (0) | Train Loss: 0.7881 | Train Acc: 0.7447
Average Train Accuracy: 0.9129
 Site-MNIST                     (5) | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.5170 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5203 | Val  Acc: 0.7778
 Site-MNIST                     (7) | Val  Loss: 0.3229 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1937 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1581 | Val  Acc: 0.9643
 Site-MNIST                     (7) | Val  Loss: 0.1717 | Val  Acc: 0.9314
 Site-MNIST                     (9) | Val  Loss: 0.2182 | Val  Acc: 0.9399
 Site-MNIST                     (7) | Val  Loss: 0.2059 | Val  Acc: 0.9486
 Site-USPS                      (2) | Val  Loss: 0.0951 | Val  Acc: 1.0000
 Site-USPS                      (6) | Val  Loss: 0.4095 | Val  Acc: 0.8889
 Site-USPS                      (6) | Val  Loss: 0.4489 | Val  Acc: 0.7812
 Site-USPS                      (6) | Val  Loss: 0.3902 | Val  Acc: 0.8448
 Site-USPS                      (6) | Val  Loss: 0.3278 | Val  Acc: 0.8952
 Site-USPS                      (6) | Val  Loss: 0.2442 | Val  Acc: 0.9153
 Site-SynthDigits               (4) | Val  Loss: 0.4033 | Val  Acc: 0.9189
 Site-SynthDigits               (4) | Val  Loss: 0.2853 | Val  Acc: 0.9265
 Site-SynthDigits               (4) | Val  Loss: 0.3825 | Val  Acc: 0.9098
 Site-MNIST_M                   (8) | Val  Loss: 0.6976 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.5857 | Val  Acc: 0.9012
 Site-SVHN                      (0) | Val  Loss: 0.6384 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9013
 Best site-MNIST                    (5)  | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST                    (9)  | Epoch:45 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.7778
 Best site-MNIST                    (7)  | Epoch:45 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST                    (7)  | Epoch:45 | Val Acc: 0.9314
 Best site-MNIST                    (9)  | Epoch:45 | Val Acc: 0.9399
 Best site-MNIST                    (7)  | Epoch:45 | Val Acc: 0.9486
 Best site-USPS                     (2)  | Epoch:45 | Val Acc: 1.0000
 Best site-USPS                     (6)  | Epoch:45 | Val Acc: 0.8889
 Best site-USPS                     (6)  | Epoch:45 | Val Acc: 0.7812
 Best site-USPS                     (6)  | Epoch:45 | Val Acc: 0.8448
 Best site-USPS                     (6)  | Epoch:45 | Val Acc: 0.8952
 Best site-USPS                     (6)  | Epoch:45 | Val Acc: 0.9153
 Best site-SynthDigits              (4)  | Epoch:45 | Val Acc: 0.9189
 Best site-SynthDigits              (4)  | Epoch:45 | Val Acc: 0.9265
 Best site-SynthDigits              (4)  | Epoch:45 | Val Acc: 0.9098
 Best site-MNIST_M                  (8)  | Epoch:45 | Val Acc: 0.8667
 Best site-MNIST_M                  (3)  | Epoch:45 | Val Acc: 0.9012
 Best site-SVHN                     (0)  | Epoch:45 | Val Acc: 0.8000
 Test site-MNIST                     (5)| Epoch:45 | Test Acc: 0.9406
 Test site-USPS                      (2)| Epoch:45 | Test Acc: 0.9430
 Test site-SynthDigits               (4)| Epoch:45 | Test Acc: 0.8835
 Test site-MNIST_M                   (8)| Epoch:45 | Test Acc: 0.7147
 Test site-SVHN                      (0)| Epoch:45 | Test Acc: 0.6297
MNIST: 0.9406, USPS: 0.9430, SynthDigits: 0.8835, MNIST_M: 0.7147, SVHN: 0.6297, 
Average Test Accuracy(group): 0.8223, Average Test Accuracy(individual): 0.8988,
domain std=0.1273, cluster std=0.1164, individual std=0.0879, 
Average Test Accuracy: 0.8223
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 46 ============
cnt=[6, 5, 2, 1, 1, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (5) | Train Loss: 0.4957 | Train Acc: 0.8333
 Site-MNIST                     (8) | Train Loss: 0.2974 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.1026 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1389 | Train Acc: 0.9474
 Site-MNIST                     (8) | Train Loss: 0.1842 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1385 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1525 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2249 | Train Acc: 0.9413
 Site-MNIST                     (0) | Train Loss: 0.2000 | Train Acc: 0.9361
 Site-MNIST                     (0) | Train Loss: 0.1605 | Train Acc: 0.9615
 Site-USPS                      (9) | Train Loss: 0.2214 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.1658 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.1603 | Train Acc: 0.9302
 Site-USPS                      (1) | Train Loss: 0.2699 | Train Acc: 0.9056
 Site-USPS                      (1) | Train Loss: 0.2046 | Train Acc: 0.9476
 Site-USPS                      (1) | Train Loss: 0.2241 | Train Acc: 0.9339
 Site-SynthDigits               (6) | Train Loss: 0.4320 | Train Acc: 0.8742
 Site-SynthDigits               (3) | Train Loss: 0.4091 | Train Acc: 0.9084
 Site-SynthDigits               (6) | Train Loss: 0.3659 | Train Acc: 0.9206
 Site-MNIST_M                   (2) | Train Loss: 0.6431 | Train Acc: 0.8343
 Site-MNIST_M                   (2) | Train Loss: 0.6033 | Train Acc: 0.8318
 Site-SVHN                      (4) | Train Loss: 0.7882 | Train Acc: 0.7518
Average Train Accuracy: 0.9121
 Site-MNIST                     (5) | Val  Loss: 0.0112 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.0235 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.5248 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5293 | Val  Acc: 0.7778
 Site-MNIST                     (8) | Val  Loss: 0.3283 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1961 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1578 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1712 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2175 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2040 | Val  Acc: 0.9486
 Site-USPS                      (9) | Val  Loss: 0.0882 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3858 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.4282 | Val  Acc: 0.8438
 Site-USPS                      (1) | Val  Loss: 0.3802 | Val  Acc: 0.8621
 Site-USPS                      (1) | Val  Loss: 0.3211 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.2401 | Val  Acc: 0.9153
 Site-SynthDigits               (6) | Val  Loss: 0.4016 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.2817 | Val  Acc: 0.9118
 Site-SynthDigits               (6) | Val  Loss: 0.3800 | Val  Acc: 0.8934
 Site-MNIST_M                   (2) | Val  Loss: 0.6905 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.5784 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6304 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9045
 Best site-MNIST                    (5)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (8)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (7)  | Epoch:46 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.7778
 Best site-MNIST                    (8)  | Epoch:46 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9399
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9486
 Best site-USPS                     (9)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.8438
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.8621
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.8857
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.9153
 Best site-SynthDigits              (6)  | Epoch:46 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:46 | Val Acc: 0.9118
 Best site-SynthDigits              (6)  | Epoch:46 | Val Acc: 0.8934
 Best site-MNIST_M                  (2)  | Epoch:46 | Val Acc: 0.8889
 Best site-MNIST_M                  (2)  | Epoch:46 | Val Acc: 0.9012
 Best site-SVHN                     (4)  | Epoch:46 | Val Acc: 0.8000
 Test site-MNIST                     (5)| Epoch:46 | Test Acc: 0.9411
 Test site-USPS                      (9)| Epoch:46 | Test Acc: 0.9462
 Test site-SynthDigits               (6)| Epoch:46 | Test Acc: 0.8834
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.7167
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.6295
MNIST: 0.9411, USPS: 0.9462, SynthDigits: 0.8834, MNIST_M: 0.7167, SVHN: 0.6295, 
Average Test Accuracy(group): 0.8234, Average Test Accuracy(individual): 0.9001,
domain std=0.1277, cluster std=0.1063, individual std=0.0882, 
Average Test Accuracy: 0.8234
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 47 ============
cnt=[3, 1, 1, 3, 1, 1, 5, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (5) | Train Loss: 0.5038 | Train Acc: 0.8333
 Site-MNIST                     (8) | Train Loss: 0.2865 | Train Acc: 0.9167
 Site-MNIST                     (7) | Train Loss: 0.0977 | Train Acc: 0.9524
 Site-MNIST                     (8) | Train Loss: 0.1350 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.1543 | Train Acc: 0.9143
 Site-MNIST                     (8) | Train Loss: 0.1348 | Train Acc: 0.9603
 Site-MNIST                     (8) | Train Loss: 0.1511 | Train Acc: 0.9692
 Site-MNIST                     (0) | Train Loss: 0.2099 | Train Acc: 0.9389
 Site-MNIST                     (8) | Train Loss: 0.2007 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1624 | Train Acc: 0.9615
 Site-USPS                      (1) | Train Loss: 0.2255 | Train Acc: 0.9750
 Site-USPS                      (6) | Train Loss: 0.2774 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.1513 | Train Acc: 0.9457
 Site-USPS                      (6) | Train Loss: 0.2857 | Train Acc: 0.9013
 Site-USPS                      (6) | Train Loss: 0.1913 | Train Acc: 0.9524
 Site-USPS                      (6) | Train Loss: 0.2173 | Train Acc: 0.9418
 Site-SynthDigits               (3) | Train Loss: 0.4735 | Train Acc: 0.8675
 Site-SynthDigits               (3) | Train Loss: 0.4011 | Train Acc: 0.9011
 Site-SynthDigits               (3) | Train Loss: 0.3773 | Train Acc: 0.9226
 Site-MNIST_M                   (2) | Train Loss: 0.6459 | Train Acc: 0.8453
 Site-MNIST_M                   (9) | Train Loss: 0.6096 | Train Acc: 0.8563
 Site-SVHN                      (4) | Train Loss: 0.7748 | Train Acc: 0.7766
Average Train Accuracy: 0.9158
 Site-MNIST                     (5) | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-MNIST                     (8) | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-MNIST                     (7) | Val  Loss: 0.5148 | Val  Acc: 0.8000
 Site-MNIST                     (8) | Val  Loss: 0.5076 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3162 | Val  Acc: 0.8824
 Site-MNIST                     (8) | Val  Loss: 0.1918 | Val  Acc: 0.9355
 Site-MNIST                     (8) | Val  Loss: 0.1571 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1692 | Val  Acc: 0.9314
 Site-MNIST                     (8) | Val  Loss: 0.2155 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2015 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.0966 | Val  Acc: 1.0000
 Site-USPS                      (6) | Val  Loss: 0.3828 | Val  Acc: 0.8333
 Site-USPS                      (6) | Val  Loss: 0.4205 | Val  Acc: 0.8125
 Site-USPS                      (6) | Val  Loss: 0.3768 | Val  Acc: 0.8448
 Site-USPS                      (6) | Val  Loss: 0.3193 | Val  Acc: 0.8952
 Site-USPS                      (6) | Val  Loss: 0.2385 | Val  Acc: 0.9101
 Site-SynthDigits               (3) | Val  Loss: 0.3913 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.2772 | Val  Acc: 0.9118
 Site-SynthDigits               (3) | Val  Loss: 0.3764 | Val  Acc: 0.9016
 Site-MNIST_M                   (2) | Val  Loss: 0.6950 | Val  Acc: 0.8667
 Site-MNIST_M                   (9) | Val  Loss: 0.5743 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6183 | Val  Acc: 0.8143
Average Valid Accuracy: 0.8994
 Test site-MNIST                     (5)| Epoch:46 | Test Acc: 0.9411
 Test site-USPS                      (1)| Epoch:46 | Test Acc: 0.9419
 Test site-SynthDigits               (3)| Epoch:46 | Test Acc: 0.8838
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.7220
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.6354
MNIST: 0.9411, USPS: 0.9419, SynthDigits: 0.8838, MNIST_M: 0.7220, SVHN: 0.6354, 
Average Test Accuracy(group): 0.8249, Average Test Accuracy(individual): 0.8997,
domain std=0.1242, cluster std=0.1135, individual std=0.0857, 
Average Test Accuracy: 0.8249
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 48 ============
cnt=[9, 1, 1, 1, 1, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (5) | Train Loss: 0.5028 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2859 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0969 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1362 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.1554 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1377 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1662 | Train Acc: 0.9692
 Site-MNIST                     (0) | Train Loss: 0.2110 | Train Acc: 0.9413
 Site-MNIST                     (0) | Train Loss: 0.1947 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.1579 | Train Acc: 0.9623
 Site-USPS                      (9) | Train Loss: 0.2309 | Train Acc: 0.9750
 Site-USPS                      (6) | Train Loss: 0.1954 | Train Acc: 0.9306
 Site-USPS                      (6) | Train Loss: 0.1660 | Train Acc: 0.9225
 Site-USPS                      (6) | Train Loss: 0.2807 | Train Acc: 0.9099
 Site-USPS                      (6) | Train Loss: 0.2045 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2174 | Train Acc: 0.9458
 Site-SynthDigits               (7) | Train Loss: 0.4698 | Train Acc: 0.8609
 Site-SynthDigits               (3) | Train Loss: 0.3726 | Train Acc: 0.9121
 Site-SynthDigits               (7) | Train Loss: 0.3618 | Train Acc: 0.9267
 Site-MNIST_M                   (8) | Train Loss: 0.6159 | Train Acc: 0.8508
 Site-MNIST_M                   (2) | Train Loss: 0.5955 | Train Acc: 0.8563
 Site-SVHN                      (4) | Train Loss: 0.7833 | Train Acc: 0.7553
Average Train Accuracy: 0.9151
 Site-MNIST                     (5) | Val  Loss: 0.0102 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0226 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4994 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4969 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3076 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1901 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1572 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1685 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2130 | Val  Acc: 0.9454
 Site-MNIST                     (0) | Val  Loss: 0.1990 | Val  Acc: 0.9486
 Site-USPS                      (9) | Val  Loss: 0.1003 | Val  Acc: 1.0000
 Site-USPS                      (6) | Val  Loss: 0.3810 | Val  Acc: 0.8333
 Site-USPS                      (6) | Val  Loss: 0.4137 | Val  Acc: 0.8438
 Site-USPS                      (6) | Val  Loss: 0.3680 | Val  Acc: 0.8448
 Site-USPS                      (6) | Val  Loss: 0.3134 | Val  Acc: 0.8762
 Site-USPS                      (1) | Val  Loss: 0.2348 | Val  Acc: 0.9153
 Site-SynthDigits               (7) | Val  Loss: 0.3782 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.2728 | Val  Acc: 0.9118
 Site-SynthDigits               (7) | Val  Loss: 0.3697 | Val  Acc: 0.9098
 Site-MNIST_M                   (8) | Val  Loss: 0.6728 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.5609 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6179 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9003
 Test site-MNIST                     (5)| Epoch:47 | Test Acc: 0.9419
 Test site-USPS                      (9)| Epoch:47 | Test Acc: 0.9409
 Test site-SynthDigits               (7)| Epoch:47 | Test Acc: 0.8836
 Test site-MNIST_M                   (8)| Epoch:47 | Test Acc: 0.7236
 Test site-SVHN                      (4)| Epoch:47 | Test Acc: 0.6331
MNIST: 0.9419, USPS: 0.9409, SynthDigits: 0.8836, MNIST_M: 0.7236, SVHN: 0.6331, 
Average Test Accuracy(group): 0.8246, Average Test Accuracy(individual): 0.8998,
domain std=0.1246, cluster std=0.1107, individual std=0.0858, 
Average Test Accuracy: 0.8246
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
============ Train epoch 49 ============
cnt=[3, 1, 2, 3, 3, 1, 2, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (1) | Train Loss: 0.5251 | Train Acc: 0.8333
 Site-MNIST                     (4) | Train Loss: 0.2940 | Train Acc: 0.9167
 Site-MNIST                     (9) | Train Loss: 0.0864 | Train Acc: 1.0000
 Site-MNIST                     (9) | Train Loss: 0.1293 | Train Acc: 0.9474
 Site-MNIST                     (8) | Train Loss: 0.2176 | Train Acc: 0.9286
 Site-MNIST                     (4) | Train Loss: 0.1332 | Train Acc: 0.9683
 Site-MNIST                     (9) | Train Loss: 0.1571 | Train Acc: 0.9692
 Site-MNIST                     (8) | Train Loss: 0.2166 | Train Acc: 0.9438
 Site-MNIST                     (4) | Train Loss: 0.1939 | Train Acc: 0.9416
 Site-MNIST                     (9) | Train Loss: 0.1535 | Train Acc: 0.9600
 Site-USPS                      (7) | Train Loss: 0.2309 | Train Acc: 0.9500
 Site-USPS                      (3) | Train Loss: 0.1822 | Train Acc: 0.9306
 Site-USPS                      (3) | Train Loss: 0.1895 | Train Acc: 0.9457
 Site-USPS                      (3) | Train Loss: 0.2671 | Train Acc: 0.8970
 Site-USPS                      (6) | Train Loss: 0.1916 | Train Acc: 0.9524
 Site-USPS                      (6) | Train Loss: 0.2153 | Train Acc: 0.9444
 Site-SynthDigits               (0) | Train Loss: 0.4632 | Train Acc: 0.8675
 Site-SynthDigits               (0) | Train Loss: 0.3773 | Train Acc: 0.9048
 Site-SynthDigits               (0) | Train Loss: 0.3644 | Train Acc: 0.9246
 Site-MNIST_M                   (2) | Train Loss: 0.6255 | Train Acc: 0.8564
 Site-MNIST_M                   (2) | Train Loss: 0.5907 | Train Acc: 0.8654
 Site-SVHN                      (5) | Train Loss: 0.7711 | Train Acc: 0.7589
Average Train Accuracy: 0.9185
 Site-MNIST                     (1) | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-MNIST                     (9) | Val  Loss: 0.4909 | Val  Acc: 0.8000
 Site-MNIST                     (9) | Val  Loss: 0.4961 | Val  Acc: 0.7778
 Site-MNIST                     (8) | Val  Loss: 0.3050 | Val  Acc: 0.8824
 Site-MNIST                     (4) | Val  Loss: 0.1877 | Val  Acc: 0.9355
 Site-MNIST                     (9) | Val  Loss: 0.1571 | Val  Acc: 0.9643
 Site-MNIST                     (8) | Val  Loss: 0.1670 | Val  Acc: 0.9412
 Site-MNIST                     (4) | Val  Loss: 0.2117 | Val  Acc: 0.9399
 Site-MNIST                     (9) | Val  Loss: 0.1966 | Val  Acc: 0.9486
 Site-USPS                      (7) | Val  Loss: 0.0969 | Val  Acc: 1.0000
 Site-USPS                      (3) | Val  Loss: 0.3718 | Val  Acc: 0.8889
 Site-USPS                      (3) | Val  Loss: 0.3995 | Val  Acc: 0.8750
 Site-USPS                      (3) | Val  Loss: 0.3567 | Val  Acc: 0.8793
 Site-USPS                      (6) | Val  Loss: 0.3048 | Val  Acc: 0.8952
 Site-USPS                      (6) | Val  Loss: 0.2295 | Val  Acc: 0.9206
 Site-SynthDigits               (0) | Val  Loss: 0.3773 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.2713 | Val  Acc: 0.9118
 Site-SynthDigits               (0) | Val  Loss: 0.3664 | Val  Acc: 0.9098
 Site-MNIST_M                   (2) | Val  Loss: 0.6698 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.5583 | Val  Acc: 0.8889
 Site-SVHN                      (5) | Val  Loss: 0.6339 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9066
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST                    (9)  | Epoch:49 | Val Acc: 0.8000
 Best site-MNIST                    (9)  | Epoch:49 | Val Acc: 0.7778
 Best site-MNIST                    (8)  | Epoch:49 | Val Acc: 0.8824
 Best site-MNIST                    (4)  | Epoch:49 | Val Acc: 0.9355
 Best site-MNIST                    (9)  | Epoch:49 | Val Acc: 0.9643
 Best site-MNIST                    (8)  | Epoch:49 | Val Acc: 0.9412
 Best site-MNIST                    (4)  | Epoch:49 | Val Acc: 0.9399
 Best site-MNIST                    (9)  | Epoch:49 | Val Acc: 0.9486
 Best site-USPS                     (7)  | Epoch:49 | Val Acc: 1.0000
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.8889
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.8750
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.8793
 Best site-USPS                     (6)  | Epoch:49 | Val Acc: 0.8952
 Best site-USPS                     (6)  | Epoch:49 | Val Acc: 0.9206
 Best site-SynthDigits              (0)  | Epoch:49 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:49 | Val Acc: 0.9118
 Best site-SynthDigits              (0)  | Epoch:49 | Val Acc: 0.9098
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8667
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8889
 Best site-SVHN                     (5)  | Epoch:49 | Val Acc: 0.8000
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9423
 Test site-USPS                      (7)| Epoch:49 | Test Acc: 0.9452
 Test site-SynthDigits               (0)| Epoch:49 | Test Acc: 0.8836
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7206
 Test site-SVHN                      (5)| Epoch:49 | Test Acc: 0.6332
MNIST: 0.9423, USPS: 0.9452, SynthDigits: 0.8836, MNIST_M: 0.7206, SVHN: 0.6332, 
Average Test Accuracy(group): 0.8250, Average Test Accuracy(individual): 0.9009,
domain std=0.1260, cluster std=0.1070, individual std=0.0870, 
Average Test Accuracy: 0.8250
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_10/ccop_q=1...
===2023-08-13 17:44:59===
===2023-08-13 17:45:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 10
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 10
Loading snapshots...
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9423
 Test site-USPS                      (7)| Epoch:49 | Test Acc: 0.9452
 Test site-SynthDigits               (0)| Epoch:49 | Test Acc: 0.8836
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7206
 Test site-SVHN                      (5)| Epoch:49 | Test Acc: 0.6332
MNIST: 0.9423, USPS: 0.9452, SynthDigits: 0.8836, MNIST_M: 0.7206, SVHN: 0.6332, 
Average Test Accuracy(group): 0.8250, Average Test Accuracy(individual): 0.9009,
domain std=0.1260, cluster std=0.1070, individual std=0.0870, 
