===2023-08-12 22:15:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 10
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 10
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 2, 1, 1, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (8) | Train Loss: 1.6424 | Train Acc: 0.6800
 Site-MNIST                     (9) | Train Loss: 1.6601 | Train Acc: 0.6568
 Site-MNIST                     (2) | Train Loss: 1.6874 | Train Acc: 0.5996
 Site-MNIST                     (2) | Train Loss: 1.6536 | Train Acc: 0.6636
 Site-MNIST                     (8) | Train Loss: 1.6537 | Train Acc: 0.6541
 Site-USPS                      (1) | Train Loss: 1.6635 | Train Acc: 0.5564
 Site-USPS                      (1) | Train Loss: 1.6740 | Train Acc: 0.5415
 Site-USPS                      (7) | Train Loss: 1.6605 | Train Acc: 0.5708
 Site-SynthDigits               (6) | Train Loss: 2.1259 | Train Acc: 0.2424
 Site-SynthDigits               (3) | Train Loss: 2.0929 | Train Acc: 0.2917
 Site-MNIST_M                   (5) | Train Loss: 2.1654 | Train Acc: 0.2244
 Site-MNIST_M                   (4) | Train Loss: 2.1833 | Train Acc: 0.2273
 Site-SVHN                      (0) | Train Loss: 2.2314 | Train Acc: 0.1840
Average Train Accuracy: 0.4687
 Site-MNIST                     (8) | Val  Loss: 1.7550 | Val  Acc: 0.5179
 Site-MNIST                     (9) | Val  Loss: 1.7378 | Val  Acc: 0.6429
 Site-MNIST                     (2) | Val  Loss: 1.6350 | Val  Acc: 0.6746
 Site-MNIST                     (2) | Val  Loss: 1.6797 | Val  Acc: 0.6053
 Site-MNIST                     (8) | Val  Loss: 1.6671 | Val  Acc: 0.6316
 Site-USPS                      (1) | Val  Loss: 1.6804 | Val  Acc: 0.5673
 Site-USPS                      (1) | Val  Loss: 1.7411 | Val  Acc: 0.4679
 Site-USPS                      (7) | Val  Loss: 1.6587 | Val  Acc: 0.5684
 Site-SynthDigits               (6) | Val  Loss: 2.2610 | Val  Acc: 0.2576
 Site-SynthDigits               (3) | Val  Loss: 2.0785 | Val  Acc: 0.2273
 Site-MNIST_M                   (5) | Val  Loss: 2.0568 | Val  Acc: 0.2841
 Site-MNIST_M                   (4) | Val  Loss: 2.1376 | Val  Acc: 0.2500
 Site-SVHN                      (0) | Val  Loss: 2.2363 | Val  Acc: 0.1644
Average Valid Accuracy: 0.4507
 Best site-MNIST                    (8)  | Epoch:0 | Val Acc: 0.5179
 Best site-MNIST                    (9)  | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6746
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6053
 Best site-MNIST                    (8)  | Epoch:0 | Val Acc: 0.6316
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5673
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.4679
 Best site-USPS                     (7)  | Epoch:0 | Val Acc: 0.5684
 Best site-SynthDigits              (6)  | Epoch:0 | Val Acc: 0.2576
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2273
 Best site-MNIST_M                  (5)  | Epoch:0 | Val Acc: 0.2841
 Best site-MNIST_M                  (4)  | Epoch:0 | Val Acc: 0.2500
 Best site-SVHN                     (0)  | Epoch:0 | Val Acc: 0.1644
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 1, 2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (6) | Train Loss: 1.2251 | Train Acc: 0.7733
 Site-MNIST                     (7) | Train Loss: 1.2240 | Train Acc: 0.7988
 Site-MNIST                     (6) | Train Loss: 1.2625 | Train Acc: 0.7298
 Site-MNIST                     (1) | Train Loss: 1.2158 | Train Acc: 0.7490
 Site-MNIST                     (7) | Train Loss: 1.2210 | Train Acc: 0.7426
 Site-USPS                      (3) | Train Loss: 1.1558 | Train Acc: 0.7746
 Site-USPS                      (9) | Train Loss: 1.1751 | Train Acc: 0.7843
 Site-USPS                      (3) | Train Loss: 1.1669 | Train Acc: 0.7902
 Site-SynthDigits               (0) | Train Loss: 1.8878 | Train Acc: 0.3712
 Site-SynthDigits               (5) | Train Loss: 1.8650 | Train Acc: 0.3914
 Site-MNIST_M                   (8) | Train Loss: 2.0161 | Train Acc: 0.2812
 Site-MNIST_M                   (2) | Train Loss: 2.0547 | Train Acc: 0.2841
 Site-SVHN                      (4) | Train Loss: 2.0974 | Train Acc: 0.2368
Average Train Accuracy: 0.5929
 Site-MNIST                     (6) | Val  Loss: 1.3078 | Val  Acc: 0.6964
 Site-MNIST                     (7) | Val  Loss: 1.2874 | Val  Acc: 0.7738
 Site-MNIST                     (6) | Val  Loss: 1.2045 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 1.2684 | Val  Acc: 0.7474
 Site-MNIST                     (7) | Val  Loss: 1.2351 | Val  Acc: 0.7789
 Site-USPS                      (3) | Val  Loss: 1.1452 | Val  Acc: 0.8558
 Site-USPS                      (9) | Val  Loss: 1.2355 | Val  Acc: 0.7628
 Site-USPS                      (3) | Val  Loss: 1.1717 | Val  Acc: 0.7778
 Site-SynthDigits               (0) | Val  Loss: 2.0788 | Val  Acc: 0.3561
 Site-SynthDigits               (5) | Val  Loss: 1.8215 | Val  Acc: 0.3737
 Site-MNIST_M                   (8) | Val  Loss: 1.8934 | Val  Acc: 0.3864
 Site-MNIST_M                   (2) | Val  Loss: 2.0500 | Val  Acc: 0.2879
 Site-SVHN                      (4) | Val  Loss: 2.0762 | Val  Acc: 0.2466
Average Valid Accuracy: 0.6016
 Best site-MNIST                    (6)  | Epoch:1 | Val Acc: 0.6964
 Best site-MNIST                    (7)  | Epoch:1 | Val Acc: 0.7738
 Best site-MNIST                    (6)  | Epoch:1 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7474
 Best site-MNIST                    (7)  | Epoch:1 | Val Acc: 0.7789
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.8558
 Best site-USPS                     (9)  | Epoch:1 | Val Acc: 0.7628
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7778
 Best site-SynthDigits              (0)  | Epoch:1 | Val Acc: 0.3561
 Best site-SynthDigits              (5)  | Epoch:1 | Val Acc: 0.3737
 Best site-MNIST_M                  (8)  | Epoch:1 | Val Acc: 0.3864
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.2879
 Best site-SVHN                     (4)  | Epoch:1 | Val Acc: 0.2466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 1, 1, 2, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (6) | Train Loss: 1.0169 | Train Acc: 0.7644
 Site-MNIST                     (6) | Train Loss: 1.0365 | Train Acc: 0.8166
 Site-MNIST                     (3) | Train Loss: 1.1004 | Train Acc: 0.7436
 Site-MNIST                     (9) | Train Loss: 1.0479 | Train Acc: 0.7714
 Site-MNIST                     (3) | Train Loss: 1.0385 | Train Acc: 0.7566
 Site-USPS                      (0) | Train Loss: 0.9700 | Train Acc: 0.7626
 Site-USPS                      (7) | Train Loss: 0.9758 | Train Acc: 0.7636
 Site-USPS                      (0) | Train Loss: 0.9576 | Train Acc: 0.7902
 Site-SynthDigits               (5) | Train Loss: 1.7069 | Train Acc: 0.4451
 Site-SynthDigits               (2) | Train Loss: 1.6162 | Train Acc: 0.4735
 Site-MNIST_M                   (4) | Train Loss: 1.8564 | Train Acc: 0.3551
 Site-MNIST_M                   (8) | Train Loss: 1.8958 | Train Acc: 0.3598
 Site-SVHN                      (1) | Train Loss: 2.0138 | Train Acc: 0.2709
Average Train Accuracy: 0.6210
 Site-MNIST                     (6) | Val  Loss: 1.1195 | Val  Acc: 0.7679
 Site-MNIST                     (6) | Val  Loss: 1.1189 | Val  Acc: 0.7738
 Site-MNIST                     (3) | Val  Loss: 1.0255 | Val  Acc: 0.7778
 Site-MNIST                     (9) | Val  Loss: 1.1084 | Val  Acc: 0.7684
 Site-MNIST                     (3) | Val  Loss: 1.0667 | Val  Acc: 0.8105
 Site-USPS                      (0) | Val  Loss: 0.9378 | Val  Acc: 0.8365
 Site-USPS                      (7) | Val  Loss: 1.0352 | Val  Acc: 0.7308
 Site-USPS                      (0) | Val  Loss: 0.9826 | Val  Acc: 0.7607
 Site-SynthDigits               (5) | Val  Loss: 1.8841 | Val  Acc: 0.4545
 Site-SynthDigits               (2) | Val  Loss: 1.5991 | Val  Acc: 0.4646
 Site-MNIST_M                   (4) | Val  Loss: 1.7397 | Val  Acc: 0.4545
 Site-MNIST_M                   (8) | Val  Loss: 1.9144 | Val  Acc: 0.3939
 Site-SVHN                      (1) | Val  Loss: 1.9688 | Val  Acc: 0.2671
Average Valid Accuracy: 0.6355
 Best site-MNIST                    (6)  | Epoch:2 | Val Acc: 0.7679
 Best site-MNIST                    (6)  | Epoch:2 | Val Acc: 0.7738
 Best site-MNIST                    (3)  | Epoch:2 | Val Acc: 0.7778
 Best site-MNIST                    (9)  | Epoch:2 | Val Acc: 0.7684
 Best site-MNIST                    (3)  | Epoch:2 | Val Acc: 0.8105
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8365
 Best site-USPS                     (7)  | Epoch:2 | Val Acc: 0.7308
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7607
 Best site-SynthDigits              (5)  | Epoch:2 | Val Acc: 0.4545
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4646
 Best site-MNIST_M                  (4)  | Epoch:2 | Val Acc: 0.4545
 Best site-MNIST_M                  (8)  | Epoch:2 | Val Acc: 0.3939
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2671
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 1, 1, 2, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.9125 | Train Acc: 0.7822
 Site-MNIST                     (6) | Train Loss: 0.9121 | Train Acc: 0.8550
 Site-MNIST                     (0) | Train Loss: 0.9595 | Train Acc: 0.7653
 Site-MNIST                     (6) | Train Loss: 0.9138 | Train Acc: 0.7898
 Site-MNIST                     (8) | Train Loss: 0.9064 | Train Acc: 0.7855
 Site-USPS                      (5) | Train Loss: 0.8421 | Train Acc: 0.7938
 Site-USPS                      (4) | Train Loss: 0.8452 | Train Acc: 0.8051
 Site-USPS                      (9) | Train Loss: 0.8256 | Train Acc: 0.8243
 Site-SynthDigits               (2) | Train Loss: 1.5267 | Train Acc: 0.5189
 Site-SynthDigits               (7) | Train Loss: 1.4670 | Train Acc: 0.5492
 Site-MNIST_M                   (3) | Train Loss: 1.7240 | Train Acc: 0.4148
 Site-MNIST_M                   (3) | Train Loss: 1.7941 | Train Acc: 0.4261
 Site-SVHN                      (1) | Train Loss: 1.9282 | Train Acc: 0.3305
Average Train Accuracy: 0.6647
 Site-MNIST                     (0) | Val  Loss: 0.9627 | Val  Acc: 0.7857
 Site-MNIST                     (6) | Val  Loss: 0.9527 | Val  Acc: 0.8214
 Site-MNIST                     (0) | Val  Loss: 0.8816 | Val  Acc: 0.8016
 Site-MNIST                     (6) | Val  Loss: 0.9736 | Val  Acc: 0.7895
 Site-MNIST                     (8) | Val  Loss: 0.9275 | Val  Acc: 0.8421
 Site-USPS                      (5) | Val  Loss: 0.8018 | Val  Acc: 0.8654
 Site-USPS                      (4) | Val  Loss: 0.8896 | Val  Acc: 0.7949
 Site-USPS                      (9) | Val  Loss: 0.8509 | Val  Acc: 0.7906
 Site-SynthDigits               (2) | Val  Loss: 1.7421 | Val  Acc: 0.5000
 Site-SynthDigits               (7) | Val  Loss: 1.4381 | Val  Acc: 0.5051
 Site-MNIST_M                   (3) | Val  Loss: 1.5941 | Val  Acc: 0.5000
 Site-MNIST_M                   (3) | Val  Loss: 1.8135 | Val  Acc: 0.4091
 Site-SVHN                      (1) | Val  Loss: 1.8551 | Val  Acc: 0.3356
Average Valid Accuracy: 0.6724
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7857
 Best site-MNIST                    (6)  | Epoch:3 | Val Acc: 0.8214
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8016
 Best site-MNIST                    (6)  | Epoch:3 | Val Acc: 0.7895
 Best site-MNIST                    (8)  | Epoch:3 | Val Acc: 0.8421
 Best site-USPS                     (5)  | Epoch:3 | Val Acc: 0.8654
 Best site-USPS                     (4)  | Epoch:3 | Val Acc: 0.7949
 Best site-USPS                     (9)  | Epoch:3 | Val Acc: 0.7906
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits              (7)  | Epoch:3 | Val Acc: 0.5051
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.4091
 Best site-SVHN                     (1)  | Epoch:3 | Val Acc: 0.3356
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 2, 1, 2, 1, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (7) | Train Loss: 0.7827 | Train Acc: 0.8222
 Site-MNIST                     (3) | Train Loss: 0.7831 | Train Acc: 0.8580
 Site-MNIST                     (3) | Train Loss: 0.8394 | Train Acc: 0.7870
 Site-MNIST                     (7) | Train Loss: 0.7973 | Train Acc: 0.8081
 Site-MNIST                     (6) | Train Loss: 0.7871 | Train Acc: 0.8222
 Site-USPS                      (1) | Train Loss: 0.7639 | Train Acc: 0.8082
 Site-USPS                      (1) | Train Loss: 0.7659 | Train Acc: 0.8131
 Site-USPS                      (9) | Train Loss: 0.7525 | Train Acc: 0.8296
 Site-SynthDigits               (0) | Train Loss: 1.3892 | Train Acc: 0.5682
 Site-SynthDigits               (8) | Train Loss: 1.3172 | Train Acc: 0.6111
 Site-MNIST_M                   (2) | Train Loss: 1.6404 | Train Acc: 0.4688
 Site-MNIST_M                   (5) | Train Loss: 1.6647 | Train Acc: 0.4659
 Site-SVHN                      (4) | Train Loss: 1.8193 | Train Acc: 0.3629
Average Train Accuracy: 0.6943
 Site-MNIST                     (7) | Val  Loss: 0.8200 | Val  Acc: 0.8036
 Site-MNIST                     (3) | Val  Loss: 0.8102 | Val  Acc: 0.8333
 Site-MNIST                     (3) | Val  Loss: 0.7620 | Val  Acc: 0.8254
 Site-MNIST                     (7) | Val  Loss: 0.8548 | Val  Acc: 0.7947
 Site-MNIST                     (6) | Val  Loss: 0.8036 | Val  Acc: 0.8526
 Site-USPS                      (1) | Val  Loss: 0.7179 | Val  Acc: 0.8654
 Site-USPS                      (1) | Val  Loss: 0.8074 | Val  Acc: 0.7885
 Site-USPS                      (9) | Val  Loss: 0.7826 | Val  Acc: 0.7949
 Site-SynthDigits               (0) | Val  Loss: 1.6105 | Val  Acc: 0.5455
 Site-SynthDigits               (8) | Val  Loss: 1.3029 | Val  Acc: 0.5657
 Site-MNIST_M                   (2) | Val  Loss: 1.5225 | Val  Acc: 0.5341
 Site-MNIST_M                   (5) | Val  Loss: 1.7504 | Val  Acc: 0.4697
 Site-SVHN                      (4) | Val  Loss: 1.7669 | Val  Acc: 0.3904
Average Valid Accuracy: 0.6972
 Best site-MNIST                    (7)  | Epoch:4 | Val Acc: 0.8036
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8333
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8254
 Best site-MNIST                    (7)  | Epoch:4 | Val Acc: 0.7947
 Best site-MNIST                    (6)  | Epoch:4 | Val Acc: 0.8526
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.8654
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.7885
 Best site-USPS                     (9)  | Epoch:4 | Val Acc: 0.7949
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.5455
 Best site-SynthDigits              (8)  | Epoch:4 | Val Acc: 0.5657
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.5341
 Best site-MNIST_M                  (5)  | Epoch:4 | Val Acc: 0.4697
 Best site-SVHN                     (4)  | Epoch:4 | Val Acc: 0.3904
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 1, 1, 2, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.7424 | Train Acc: 0.8000
 Site-MNIST                     (8) | Train Loss: 0.7027 | Train Acc: 0.8462
 Site-MNIST                     (5) | Train Loss: 0.7792 | Train Acc: 0.7870
 Site-MNIST                     (0) | Train Loss: 0.7477 | Train Acc: 0.8213
 Site-MNIST                     (0) | Train Loss: 0.7340 | Train Acc: 0.8249
 Site-USPS                      (6) | Train Loss: 0.7079 | Train Acc: 0.8010
 Site-USPS                      (3) | Train Loss: 0.7153 | Train Acc: 0.8211
 Site-USPS                      (3) | Train Loss: 0.6995 | Train Acc: 0.8424
 Site-SynthDigits               (2) | Train Loss: 1.2998 | Train Acc: 0.5928
 Site-SynthDigits               (9) | Train Loss: 1.2184 | Train Acc: 0.6389
 Site-MNIST_M                   (7) | Train Loss: 1.5540 | Train Acc: 0.5227
 Site-MNIST_M                   (1) | Train Loss: 1.5609 | Train Acc: 0.5322
 Site-SVHN                      (4) | Train Loss: 1.7412 | Train Acc: 0.4191
Average Train Accuracy: 0.7115
 Site-MNIST                     (0) | Val  Loss: 0.7559 | Val  Acc: 0.8036
 Site-MNIST                     (8) | Val  Loss: 0.7410 | Val  Acc: 0.8452
 Site-MNIST                     (5) | Val  Loss: 0.7217 | Val  Acc: 0.8175
 Site-MNIST                     (0) | Val  Loss: 0.8022 | Val  Acc: 0.7895
 Site-MNIST                     (0) | Val  Loss: 0.7413 | Val  Acc: 0.8386
 Site-USPS                      (6) | Val  Loss: 0.6805 | Val  Acc: 0.8558
 Site-USPS                      (3) | Val  Loss: 0.7607 | Val  Acc: 0.7949
 Site-USPS                      (3) | Val  Loss: 0.7376 | Val  Acc: 0.7991
 Site-SynthDigits               (2) | Val  Loss: 1.5288 | Val  Acc: 0.5379
 Site-SynthDigits               (9) | Val  Loss: 1.1871 | Val  Acc: 0.5808
 Site-MNIST_M                   (7) | Val  Loss: 1.4211 | Val  Acc: 0.5909
 Site-MNIST_M                   (1) | Val  Loss: 1.6464 | Val  Acc: 0.5303
 Site-SVHN                      (4) | Val  Loss: 1.6630 | Val  Acc: 0.4452
Average Valid Accuracy: 0.7099
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8036
 Best site-MNIST                    (8)  | Epoch:5 | Val Acc: 0.8452
 Best site-MNIST                    (5)  | Epoch:5 | Val Acc: 0.8175
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.7895
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8386
 Best site-USPS                     (6)  | Epoch:5 | Val Acc: 0.8558
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7949
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7991
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5379
 Best site-SynthDigits              (9)  | Epoch:5 | Val Acc: 0.5808
 Best site-MNIST_M                  (7)  | Epoch:5 | Val Acc: 0.5909
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.5303
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.4452
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 1, 1, 1, 1, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (8) | Train Loss: 0.6718 | Train Acc: 0.8444
 Site-MNIST                     (8) | Train Loss: 0.6039 | Train Acc: 0.8757
 Site-MNIST                     (7) | Train Loss: 0.6935 | Train Acc: 0.8284
 Site-MNIST                     (9) | Train Loss: 0.6630 | Train Acc: 0.8318
 Site-MNIST                     (2) | Train Loss: 0.6442 | Train Acc: 0.8468
 Site-USPS                      (0) | Train Loss: 0.6906 | Train Acc: 0.8201
 Site-USPS                      (0) | Train Loss: 0.6790 | Train Acc: 0.8243
 Site-USPS                      (0) | Train Loss: 0.6696 | Train Acc: 0.8371
 Site-SynthDigits               (4) | Train Loss: 1.1673 | Train Acc: 0.6534
 Site-SynthDigits               (6) | Train Loss: 1.0994 | Train Acc: 0.7045
 Site-MNIST_M                   (5) | Train Loss: 1.4313 | Train Acc: 0.5710
 Site-MNIST_M                   (3) | Train Loss: 1.4875 | Train Acc: 0.5568
 Site-SVHN                      (1) | Train Loss: 1.6622 | Train Acc: 0.4463
Average Train Accuracy: 0.7416
 Site-MNIST                     (8) | Val  Loss: 0.6505 | Val  Acc: 0.8929
 Site-MNIST                     (8) | Val  Loss: 0.6417 | Val  Acc: 0.8929
 Site-MNIST                     (7) | Val  Loss: 0.6295 | Val  Acc: 0.8730
 Site-MNIST                     (9) | Val  Loss: 0.7103 | Val  Acc: 0.8316
 Site-MNIST                     (2) | Val  Loss: 0.6558 | Val  Acc: 0.8667
 Site-USPS                      (0) | Val  Loss: 0.6229 | Val  Acc: 0.8654
 Site-USPS                      (0) | Val  Loss: 0.7180 | Val  Acc: 0.7885
 Site-USPS                      (0) | Val  Loss: 0.7125 | Val  Acc: 0.7991
 Site-SynthDigits               (4) | Val  Loss: 1.4215 | Val  Acc: 0.6136
 Site-SynthDigits               (6) | Val  Loss: 1.0838 | Val  Acc: 0.6414
 Site-MNIST_M                   (5) | Val  Loss: 1.3443 | Val  Acc: 0.6023
 Site-MNIST_M                   (3) | Val  Loss: 1.6014 | Val  Acc: 0.5758
 Site-SVHN                      (1) | Val  Loss: 1.6039 | Val  Acc: 0.4863
Average Valid Accuracy: 0.7484
 Best site-MNIST                    (8)  | Epoch:6 | Val Acc: 0.8929
 Best site-MNIST                    (8)  | Epoch:6 | Val Acc: 0.8929
 Best site-MNIST                    (7)  | Epoch:6 | Val Acc: 0.8730
 Best site-MNIST                    (9)  | Epoch:6 | Val Acc: 0.8316
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8667
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.8654
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7885
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7991
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.6136
 Best site-SynthDigits              (6)  | Epoch:6 | Val Acc: 0.6414
 Best site-MNIST_M                  (5)  | Epoch:6 | Val Acc: 0.6023
 Best site-MNIST_M                  (3)  | Epoch:6 | Val Acc: 0.5758
 Best site-SVHN                     (1)  | Epoch:6 | Val Acc: 0.4863
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 1, 1, 1, 1, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (7) | Train Loss: 0.6285 | Train Acc: 0.8133
 Site-MNIST                     (7) | Train Loss: 0.5726 | Train Acc: 0.8669
 Site-MNIST                     (1) | Train Loss: 0.6495 | Train Acc: 0.8205
 Site-MNIST                     (7) | Train Loss: 0.6206 | Train Acc: 0.8476
 Site-MNIST                     (7) | Train Loss: 0.6044 | Train Acc: 0.8511
 Site-USPS                      (3) | Train Loss: 0.6246 | Train Acc: 0.8297
 Site-USPS                      (9) | Train Loss: 0.6188 | Train Acc: 0.8514
 Site-USPS                      (8) | Train Loss: 0.6100 | Train Acc: 0.8562
 Site-SynthDigits               (6) | Train Loss: 1.0702 | Train Acc: 0.6610
 Site-SynthDigits               (2) | Train Loss: 1.0091 | Train Acc: 0.7273
 Site-MNIST_M                   (5) | Train Loss: 1.3921 | Train Acc: 0.6023
 Site-MNIST_M                   (0) | Train Loss: 1.4114 | Train Acc: 0.5739
 Site-SVHN                      (4) | Train Loss: 1.5754 | Train Acc: 0.4770
Average Train Accuracy: 0.7522
 Site-MNIST                     (7) | Val  Loss: 0.5971 | Val  Acc: 0.8750
 Site-MNIST                     (7) | Val  Loss: 0.5834 | Val  Acc: 0.8810
 Site-MNIST                     (1) | Val  Loss: 0.5999 | Val  Acc: 0.8492
 Site-MNIST                     (7) | Val  Loss: 0.6679 | Val  Acc: 0.8263
 Site-MNIST                     (7) | Val  Loss: 0.6084 | Val  Acc: 0.8667
 Site-USPS                      (3) | Val  Loss: 0.5670 | Val  Acc: 0.8942
 Site-USPS                      (9) | Val  Loss: 0.6591 | Val  Acc: 0.8333
 Site-USPS                      (8) | Val  Loss: 0.6607 | Val  Acc: 0.8162
 Site-SynthDigits               (6) | Val  Loss: 1.3440 | Val  Acc: 0.6212
 Site-SynthDigits               (2) | Val  Loss: 0.9924 | Val  Acc: 0.6667
 Site-MNIST_M                   (5) | Val  Loss: 1.2875 | Val  Acc: 0.6705
 Site-MNIST_M                   (0) | Val  Loss: 1.5189 | Val  Acc: 0.5909
 Site-SVHN                      (4) | Val  Loss: 1.5346 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7609
 Best site-MNIST                    (7)  | Epoch:7 | Val Acc: 0.8750
 Best site-MNIST                    (7)  | Epoch:7 | Val Acc: 0.8810
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8492
 Best site-MNIST                    (7)  | Epoch:7 | Val Acc: 0.8263
 Best site-MNIST                    (7)  | Epoch:7 | Val Acc: 0.8667
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8942
 Best site-USPS                     (9)  | Epoch:7 | Val Acc: 0.8333
 Best site-USPS                     (8)  | Epoch:7 | Val Acc: 0.8162
 Best site-SynthDigits              (6)  | Epoch:7 | Val Acc: 0.6212
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6667
 Best site-MNIST_M                  (5)  | Epoch:7 | Val Acc: 0.6705
 Best site-MNIST_M                  (0)  | Epoch:7 | Val Acc: 0.5909
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 1, 3, 1, 1, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (2) | Train Loss: 0.5833 | Train Acc: 0.8222
 Site-MNIST                     (2) | Train Loss: 0.5674 | Train Acc: 0.8728
 Site-MNIST                     (9) | Train Loss: 0.6020 | Train Acc: 0.8323
 Site-MNIST                     (2) | Train Loss: 0.5823 | Train Acc: 0.8541
 Site-MNIST                     (7) | Train Loss: 0.5642 | Train Acc: 0.8634
 Site-USPS                      (0) | Train Loss: 0.6061 | Train Acc: 0.8297
 Site-USPS                      (8) | Train Loss: 0.5959 | Train Acc: 0.8514
 Site-USPS                      (8) | Train Loss: 0.5956 | Train Acc: 0.8520
 Site-SynthDigits               (5) | Train Loss: 1.0290 | Train Acc: 0.7083
 Site-SynthDigits               (4) | Train Loss: 0.9454 | Train Acc: 0.7576
 Site-MNIST_M                   (6) | Train Loss: 1.3084 | Train Acc: 0.6222
 Site-MNIST_M                   (3) | Train Loss: 1.3151 | Train Acc: 0.5947
 Site-SVHN                      (1) | Train Loss: 1.4854 | Train Acc: 0.5128
Average Train Accuracy: 0.7672
 Site-MNIST                     (2) | Val  Loss: 0.5435 | Val  Acc: 0.8750
 Site-MNIST                     (2) | Val  Loss: 0.5385 | Val  Acc: 0.8690
 Site-MNIST                     (9) | Val  Loss: 0.5618 | Val  Acc: 0.8571
 Site-MNIST                     (2) | Val  Loss: 0.6226 | Val  Acc: 0.8368
 Site-MNIST                     (7) | Val  Loss: 0.5678 | Val  Acc: 0.8667
 Site-USPS                      (0) | Val  Loss: 0.5405 | Val  Acc: 0.8846
 Site-USPS                      (8) | Val  Loss: 0.6294 | Val  Acc: 0.8333
 Site-USPS                      (8) | Val  Loss: 0.6432 | Val  Acc: 0.8248
 Site-SynthDigits               (5) | Val  Loss: 1.2461 | Val  Acc: 0.6515
 Site-SynthDigits               (4) | Val  Loss: 0.9110 | Val  Acc: 0.7020
 Site-MNIST_M                   (6) | Val  Loss: 1.2218 | Val  Acc: 0.6818
 Site-MNIST_M                   (3) | Val  Loss: 1.4245 | Val  Acc: 0.6212
 Site-SVHN                      (1) | Val  Loss: 1.4410 | Val  Acc: 0.5137
Average Valid Accuracy: 0.7706
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8750
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8690
 Best site-MNIST                    (9)  | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8368
 Best site-MNIST                    (7)  | Epoch:8 | Val Acc: 0.8667
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8846
 Best site-USPS                     (8)  | Epoch:8 | Val Acc: 0.8333
 Best site-USPS                     (8)  | Epoch:8 | Val Acc: 0.8248
 Best site-SynthDigits              (5)  | Epoch:8 | Val Acc: 0.6515
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.7020
 Best site-MNIST_M                  (6)  | Epoch:8 | Val Acc: 0.6818
 Best site-MNIST_M                  (3)  | Epoch:8 | Val Acc: 0.6212
 Best site-SVHN                     (1)  | Epoch:8 | Val Acc: 0.5137
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 1, 2, 2, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (6) | Train Loss: 0.5668 | Train Acc: 0.8222
 Site-MNIST                     (6) | Train Loss: 0.5156 | Train Acc: 0.8817
 Site-MNIST                     (9) | Train Loss: 0.5685 | Train Acc: 0.8442
 Site-MNIST                     (0) | Train Loss: 0.5449 | Train Acc: 0.8594
 Site-MNIST                     (8) | Train Loss: 0.5235 | Train Acc: 0.8687
 Site-USPS                      (7) | Train Loss: 0.5633 | Train Acc: 0.8369
 Site-USPS                      (3) | Train Loss: 0.5447 | Train Acc: 0.8610
 Site-USPS                      (3) | Train Loss: 0.5447 | Train Acc: 0.8637
 Site-SynthDigits               (2) | Train Loss: 0.9494 | Train Acc: 0.7216
 Site-SynthDigits               (2) | Train Loss: 0.8655 | Train Acc: 0.7664
 Site-MNIST_M                   (5) | Train Loss: 1.2587 | Train Acc: 0.6477
 Site-MNIST_M                   (1) | Train Loss: 1.2749 | Train Acc: 0.6136
 Site-SVHN                      (4) | Train Loss: 1.4321 | Train Acc: 0.5315
Average Train Accuracy: 0.7784
 Site-MNIST                     (6) | Val  Loss: 0.5001 | Val  Acc: 0.8929
 Site-MNIST                     (6) | Val  Loss: 0.4959 | Val  Acc: 0.8810
 Site-MNIST                     (9) | Val  Loss: 0.5238 | Val  Acc: 0.8651
 Site-MNIST                     (0) | Val  Loss: 0.5841 | Val  Acc: 0.8474
 Site-MNIST                     (8) | Val  Loss: 0.5267 | Val  Acc: 0.8737
 Site-USPS                      (7) | Val  Loss: 0.4892 | Val  Acc: 0.8750
 Site-USPS                      (3) | Val  Loss: 0.5781 | Val  Acc: 0.8397
 Site-USPS                      (3) | Val  Loss: 0.5966 | Val  Acc: 0.8162
 Site-SynthDigits               (2) | Val  Loss: 1.1761 | Val  Acc: 0.6894
 Site-SynthDigits               (2) | Val  Loss: 0.8487 | Val  Acc: 0.7222
 Site-MNIST_M                   (5) | Val  Loss: 1.1690 | Val  Acc: 0.7045
 Site-MNIST_M                   (1) | Val  Loss: 1.3676 | Val  Acc: 0.6288
 Site-SVHN                      (4) | Val  Loss: 1.4039 | Val  Acc: 0.5342
Average Valid Accuracy: 0.7823
 Best site-MNIST                    (6)  | Epoch:9 | Val Acc: 0.8929
 Best site-MNIST                    (6)  | Epoch:9 | Val Acc: 0.8810
 Best site-MNIST                    (9)  | Epoch:9 | Val Acc: 0.8651
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8474
 Best site-MNIST                    (8)  | Epoch:9 | Val Acc: 0.8737
 Best site-USPS                     (7)  | Epoch:9 | Val Acc: 0.8750
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8397
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8162
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.6894
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.7222
 Best site-MNIST_M                  (5)  | Epoch:9 | Val Acc: 0.7045
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.6288
 Best site-SVHN                     (4)  | Epoch:9 | Val Acc: 0.5342
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 1, 1, 2, 1, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (8) | Train Loss: 0.5431 | Train Acc: 0.8044
 Site-MNIST                     (1) | Train Loss: 0.4782 | Train Acc: 0.8876
 Site-MNIST                     (8) | Train Loss: 0.5630 | Train Acc: 0.8304
 Site-MNIST                     (6) | Train Loss: 0.5356 | Train Acc: 0.8476
 Site-MNIST                     (6) | Train Loss: 0.5152 | Train Acc: 0.8643
 Site-USPS                      (3) | Train Loss: 0.5278 | Train Acc: 0.8633
 Site-USPS                      (9) | Train Loss: 0.5089 | Train Acc: 0.8722
 Site-USPS                      (3) | Train Loss: 0.5037 | Train Acc: 0.8860
 Site-SynthDigits               (5) | Train Loss: 0.8920 | Train Acc: 0.7519
 Site-SynthDigits               (2) | Train Loss: 0.8212 | Train Acc: 0.7689
 Site-MNIST_M                   (0) | Train Loss: 1.2141 | Train Acc: 0.6619
 Site-MNIST_M                   (7) | Train Loss: 1.2179 | Train Acc: 0.6667
 Site-SVHN                      (4) | Train Loss: 1.4214 | Train Acc: 0.5468
Average Train Accuracy: 0.7886
 Site-MNIST                     (8) | Val  Loss: 0.4916 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.4828 | Val  Acc: 0.8333
 Site-MNIST                     (8) | Val  Loss: 0.5168 | Val  Acc: 0.8333
 Site-MNIST                     (6) | Val  Loss: 0.5755 | Val  Acc: 0.8474
 Site-MNIST                     (6) | Val  Loss: 0.5139 | Val  Acc: 0.8842
 Site-USPS                      (3) | Val  Loss: 0.4642 | Val  Acc: 0.8942
 Site-USPS                      (9) | Val  Loss: 0.5429 | Val  Acc: 0.8333
 Site-USPS                      (3) | Val  Loss: 0.5595 | Val  Acc: 0.8376
 Site-SynthDigits               (5) | Val  Loss: 1.0861 | Val  Acc: 0.6970
 Site-SynthDigits               (2) | Val  Loss: 0.7737 | Val  Acc: 0.7475
 Site-MNIST_M                   (0) | Val  Loss: 1.1112 | Val  Acc: 0.6818
 Site-MNIST_M                   (7) | Val  Loss: 1.3072 | Val  Acc: 0.6515
 Site-SVHN                      (4) | Val  Loss: 1.3602 | Val  Acc: 0.5205
Average Valid Accuracy: 0.7811
============ Train epoch 11 ============
cnt=[2, 2, 1, 1, 1, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (5) | Train Loss: 0.4893 | Train Acc: 0.8489
 Site-MNIST                     (0) | Train Loss: 0.4442 | Train Acc: 0.9024
 Site-MNIST                     (5) | Train Loss: 0.4914 | Train Acc: 0.8738
 Site-MNIST                     (0) | Train Loss: 0.4725 | Train Acc: 0.8725
 Site-MNIST                     (9) | Train Loss: 0.4489 | Train Acc: 0.8975
 Site-USPS                      (1) | Train Loss: 0.5088 | Train Acc: 0.8465
 Site-USPS                      (7) | Train Loss: 0.4996 | Train Acc: 0.8722
 Site-USPS                      (1) | Train Loss: 0.4874 | Train Acc: 0.8829
 Site-SynthDigits               (3) | Train Loss: 0.8447 | Train Acc: 0.7500
 Site-SynthDigits               (6) | Train Loss: 0.7679 | Train Acc: 0.8106
 Site-MNIST_M                   (8) | Train Loss: 1.1683 | Train Acc: 0.6506
 Site-MNIST_M                   (2) | Train Loss: 1.1595 | Train Acc: 0.6534
 Site-SVHN                      (4) | Train Loss: 1.3163 | Train Acc: 0.5690
Average Train Accuracy: 0.8023
 Site-MNIST                     (5) | Val  Loss: 0.4180 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.4052 | Val  Acc: 0.9048
 Site-MNIST                     (5) | Val  Loss: 0.4499 | Val  Acc: 0.8810
 Site-MNIST                     (0) | Val  Loss: 0.5057 | Val  Acc: 0.8684
 Site-MNIST                     (9) | Val  Loss: 0.4480 | Val  Acc: 0.8912
 Site-USPS                      (1) | Val  Loss: 0.4368 | Val  Acc: 0.8942
 Site-USPS                      (7) | Val  Loss: 0.5189 | Val  Acc: 0.8526
 Site-USPS                      (1) | Val  Loss: 0.5485 | Val  Acc: 0.8291
 Site-SynthDigits               (3) | Val  Loss: 1.0235 | Val  Acc: 0.7424
 Site-SynthDigits               (6) | Val  Loss: 0.7371 | Val  Acc: 0.7576
 Site-MNIST_M                   (8) | Val  Loss: 1.1194 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 1.2483 | Val  Acc: 0.6364
 Site-SVHN                      (4) | Val  Loss: 1.2962 | Val  Acc: 0.5753
Average Valid Accuracy: 0.8023
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.9048
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8810
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8684
 Best site-MNIST                    (9)  | Epoch:11 | Val Acc: 0.8912
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8942
 Best site-USPS                     (7)  | Epoch:11 | Val Acc: 0.8526
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8291
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7424
 Best site-SynthDigits              (6)  | Epoch:11 | Val Acc: 0.7576
 Best site-MNIST_M                  (8)  | Epoch:11 | Val Acc: 0.7045
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.6364
 Best site-SVHN                     (4)  | Epoch:11 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 1, 3, 1, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (2) | Train Loss: 0.4575 | Train Acc: 0.8489
 Site-MNIST                     (2) | Train Loss: 0.3796 | Train Acc: 0.9053
 Site-MNIST                     (2) | Train Loss: 0.4679 | Train Acc: 0.8817
 Site-MNIST                     (9) | Train Loss: 0.4490 | Train Acc: 0.8752
 Site-MNIST                     (7) | Train Loss: 0.4281 | Train Acc: 0.8975
 Site-USPS                      (0) | Train Loss: 0.4854 | Train Acc: 0.8585
 Site-USPS                      (0) | Train Loss: 0.4682 | Train Acc: 0.8786
 Site-USPS                      (6) | Train Loss: 0.4627 | Train Acc: 0.8935
 Site-SynthDigits               (8) | Train Loss: 0.7875 | Train Acc: 0.7860
 Site-SynthDigits               (3) | Train Loss: 0.7198 | Train Acc: 0.8194
 Site-MNIST_M                   (5) | Train Loss: 1.1094 | Train Acc: 0.6676
 Site-MNIST_M                   (1) | Train Loss: 1.0824 | Train Acc: 0.6894
 Site-SVHN                      (4) | Train Loss: 1.2499 | Train Acc: 0.5877
Average Train Accuracy: 0.8146
 Site-MNIST                     (2) | Val  Loss: 0.3916 | Val  Acc: 0.9107
 Site-MNIST                     (2) | Val  Loss: 0.3807 | Val  Acc: 0.8929
 Site-MNIST                     (2) | Val  Loss: 0.4270 | Val  Acc: 0.8889
 Site-MNIST                     (9) | Val  Loss: 0.4823 | Val  Acc: 0.8842
 Site-MNIST                     (7) | Val  Loss: 0.4274 | Val  Acc: 0.9018
 Site-USPS                      (0) | Val  Loss: 0.4123 | Val  Acc: 0.8942
 Site-USPS                      (0) | Val  Loss: 0.4887 | Val  Acc: 0.8462
 Site-USPS                      (6) | Val  Loss: 0.5220 | Val  Acc: 0.8376
 Site-SynthDigits               (8) | Val  Loss: 0.9396 | Val  Acc: 0.7576
 Site-SynthDigits               (3) | Val  Loss: 0.6779 | Val  Acc: 0.7929
 Site-MNIST_M                   (5) | Val  Loss: 1.0541 | Val  Acc: 0.6932
 Site-MNIST_M                   (1) | Val  Loss: 1.1783 | Val  Acc: 0.6515
 Site-SVHN                      (4) | Val  Loss: 1.2592 | Val  Acc: 0.5616
Average Valid Accuracy: 0.8087
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.9107
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8929
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8889
 Best site-MNIST                    (9)  | Epoch:12 | Val Acc: 0.8842
 Best site-MNIST                    (7)  | Epoch:12 | Val Acc: 0.9018
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.8942
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.8462
 Best site-USPS                     (6)  | Epoch:12 | Val Acc: 0.8376
 Best site-SynthDigits              (8)  | Epoch:12 | Val Acc: 0.7576
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.7929
 Best site-MNIST_M                  (5)  | Epoch:12 | Val Acc: 0.6932
 Best site-MNIST_M                  (1)  | Epoch:12 | Val Acc: 0.6515
 Best site-SVHN                     (4)  | Epoch:12 | Val Acc: 0.5616
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 1, 4, 1, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.4194 | Train Acc: 0.8533
 Site-MNIST                     (2) | Train Loss: 0.3848 | Train Acc: 0.9112
 Site-MNIST                     (2) | Train Loss: 0.4370 | Train Acc: 0.8876
 Site-MNIST                     (2) | Train Loss: 0.4244 | Train Acc: 0.8844
 Site-MNIST                     (7) | Train Loss: 0.3979 | Train Acc: 0.9046
 Site-USPS                      (9) | Train Loss: 0.4734 | Train Acc: 0.8681
 Site-USPS                      (8) | Train Loss: 0.4443 | Train Acc: 0.8850
 Site-USPS                      (1) | Train Loss: 0.4440 | Train Acc: 0.8967
 Site-SynthDigits               (3) | Train Loss: 0.7474 | Train Acc: 0.7992
 Site-SynthDigits               (6) | Train Loss: 0.6643 | Train Acc: 0.8220
 Site-MNIST_M                   (0) | Train Loss: 1.0520 | Train Acc: 0.6761
 Site-MNIST_M                   (5) | Train Loss: 1.0572 | Train Acc: 0.6894
 Site-SVHN                      (4) | Train Loss: 1.2182 | Train Acc: 0.6116
Average Train Accuracy: 0.8222
 Site-MNIST                     (2) | Val  Loss: 0.3504 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.3447 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.4029 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.4538 | Val  Acc: 0.8895
 Site-MNIST                     (7) | Val  Loss: 0.3984 | Val  Acc: 0.9088
 Site-USPS                      (9) | Val  Loss: 0.3871 | Val  Acc: 0.8942
 Site-USPS                      (8) | Val  Loss: 0.4658 | Val  Acc: 0.8526
 Site-USPS                      (1) | Val  Loss: 0.5041 | Val  Acc: 0.8504
 Site-SynthDigits               (3) | Val  Loss: 0.9004 | Val  Acc: 0.7500
 Site-SynthDigits               (6) | Val  Loss: 0.6355 | Val  Acc: 0.7929
 Site-MNIST_M                   (0) | Val  Loss: 0.9895 | Val  Acc: 0.7273
 Site-MNIST_M                   (5) | Val  Loss: 1.1131 | Val  Acc: 0.6742
 Site-SVHN                      (4) | Val  Loss: 1.2416 | Val  Acc: 0.5753
Average Valid Accuracy: 0.8213
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9048
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8895
 Best site-MNIST                    (7)  | Epoch:13 | Val Acc: 0.9088
 Best site-USPS                     (9)  | Epoch:13 | Val Acc: 0.8942
 Best site-USPS                     (8)  | Epoch:13 | Val Acc: 0.8526
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8504
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7500
 Best site-SynthDigits              (6)  | Epoch:13 | Val Acc: 0.7929
 Best site-MNIST_M                  (0)  | Epoch:13 | Val Acc: 0.7273
 Best site-MNIST_M                  (5)  | Epoch:13 | Val Acc: 0.6742
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 1, 3, 1, 1, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (2) | Train Loss: 0.4079 | Train Acc: 0.8667
 Site-MNIST                     (2) | Train Loss: 0.3381 | Train Acc: 0.9201
 Site-MNIST                     (9) | Train Loss: 0.4142 | Train Acc: 0.8915
 Site-MNIST                     (2) | Train Loss: 0.3979 | Train Acc: 0.8975
 Site-MNIST                     (8) | Train Loss: 0.3723 | Train Acc: 0.9177
 Site-USPS                      (5) | Train Loss: 0.4415 | Train Acc: 0.8777
 Site-USPS                      (5) | Train Loss: 0.4267 | Train Acc: 0.8802
 Site-USPS                      (1) | Train Loss: 0.4232 | Train Acc: 0.8967
 Site-SynthDigits               (3) | Train Loss: 0.6961 | Train Acc: 0.8106
 Site-SynthDigits               (6) | Train Loss: 0.6293 | Train Acc: 0.8409
 Site-MNIST_M                   (7) | Train Loss: 1.0213 | Train Acc: 0.6932
 Site-MNIST_M                   (0) | Train Loss: 0.9901 | Train Acc: 0.7083
 Site-SVHN                      (4) | Train Loss: 1.2045 | Train Acc: 0.6184
Average Train Accuracy: 0.8323
 Site-MNIST                     (2) | Val  Loss: 0.3356 | Val  Acc: 0.8929
 Site-MNIST                     (2) | Val  Loss: 0.3267 | Val  Acc: 0.9048
 Site-MNIST                     (9) | Val  Loss: 0.3733 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.4249 | Val  Acc: 0.8947
 Site-MNIST                     (8) | Val  Loss: 0.3744 | Val  Acc: 0.9193
 Site-USPS                      (5) | Val  Loss: 0.3711 | Val  Acc: 0.8942
 Site-USPS                      (5) | Val  Loss: 0.4440 | Val  Acc: 0.8590
 Site-USPS                      (1) | Val  Loss: 0.4822 | Val  Acc: 0.8547
 Site-SynthDigits               (3) | Val  Loss: 0.8328 | Val  Acc: 0.7803
 Site-SynthDigits               (6) | Val  Loss: 0.5994 | Val  Acc: 0.7980
 Site-MNIST_M                   (7) | Val  Loss: 0.9575 | Val  Acc: 0.7159
 Site-MNIST_M                   (0) | Val  Loss: 1.0491 | Val  Acc: 0.6970
 Site-SVHN                      (4) | Val  Loss: 1.2159 | Val  Acc: 0.5685
Average Valid Accuracy: 0.8218
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8929
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9048
 Best site-MNIST                    (9)  | Epoch:14 | Val Acc: 0.9048
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8947
 Best site-MNIST                    (8)  | Epoch:14 | Val Acc: 0.9193
 Best site-USPS                     (5)  | Epoch:14 | Val Acc: 0.8942
 Best site-USPS                     (5)  | Epoch:14 | Val Acc: 0.8590
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8547
 Best site-SynthDigits              (3)  | Epoch:14 | Val Acc: 0.7803
 Best site-SynthDigits              (6)  | Epoch:14 | Val Acc: 0.7980
 Best site-MNIST_M                  (7)  | Epoch:14 | Val Acc: 0.7159
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.6970
 Best site-SVHN                     (4)  | Epoch:14 | Val Acc: 0.5685
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 1, 1, 1, 2, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (0) | Train Loss: 0.3706 | Train Acc: 0.8844
 Site-MNIST                     (8) | Train Loss: 0.3227 | Train Acc: 0.9320
 Site-MNIST                     (6) | Train Loss: 0.3875 | Train Acc: 0.8994
 Site-MNIST                     (8) | Train Loss: 0.3747 | Train Acc: 0.9014
 Site-MNIST                     (6) | Train Loss: 0.3446 | Train Acc: 0.9212
 Site-USPS                      (5) | Train Loss: 0.4343 | Train Acc: 0.8753
 Site-USPS                      (7) | Train Loss: 0.4207 | Train Acc: 0.8850
 Site-USPS                      (3) | Train Loss: 0.4123 | Train Acc: 0.8903
 Site-SynthDigits               (4) | Train Loss: 0.6804 | Train Acc: 0.8163
 Site-SynthDigits               (4) | Train Loss: 0.6163 | Train Acc: 0.8561
 Site-MNIST_M                   (9) | Train Loss: 0.9606 | Train Acc: 0.6932
 Site-MNIST_M                   (2) | Train Loss: 0.9870 | Train Acc: 0.7140
 Site-SVHN                      (1) | Train Loss: 1.1166 | Train Acc: 0.6320
Average Train Accuracy: 0.8385
 Site-MNIST                     (0) | Val  Loss: 0.3048 | Val  Acc: 0.9107
 Site-MNIST                     (8) | Val  Loss: 0.2969 | Val  Acc: 0.9286
 Site-MNIST                     (6) | Val  Loss: 0.3467 | Val  Acc: 0.9127
 Site-MNIST                     (8) | Val  Loss: 0.3986 | Val  Acc: 0.9105
 Site-MNIST                     (6) | Val  Loss: 0.3474 | Val  Acc: 0.9263
 Site-USPS                      (5) | Val  Loss: 0.3570 | Val  Acc: 0.8942
 Site-USPS                      (7) | Val  Loss: 0.4270 | Val  Acc: 0.8590
 Site-USPS                      (3) | Val  Loss: 0.4750 | Val  Acc: 0.8547
 Site-SynthDigits               (4) | Val  Loss: 0.8049 | Val  Acc: 0.7803
 Site-SynthDigits               (4) | Val  Loss: 0.5785 | Val  Acc: 0.7980
 Site-MNIST_M                   (9) | Val  Loss: 0.9478 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 1.0218 | Val  Acc: 0.7121
 Site-SVHN                      (1) | Val  Loss: 1.1697 | Val  Acc: 0.5822
Average Valid Accuracy: 0.8305
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9107
 Best site-MNIST                    (8)  | Epoch:15 | Val Acc: 0.9286
 Best site-MNIST                    (6)  | Epoch:15 | Val Acc: 0.9127
 Best site-MNIST                    (8)  | Epoch:15 | Val Acc: 0.9105
 Best site-MNIST                    (6)  | Epoch:15 | Val Acc: 0.9263
 Best site-USPS                     (5)  | Epoch:15 | Val Acc: 0.8942
 Best site-USPS                     (7)  | Epoch:15 | Val Acc: 0.8590
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8547
 Best site-SynthDigits              (4)  | Epoch:15 | Val Acc: 0.7803
 Best site-SynthDigits              (4)  | Epoch:15 | Val Acc: 0.7980
 Best site-MNIST_M                  (9)  | Epoch:15 | Val Acc: 0.7273
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.7121
 Best site-SVHN                     (1)  | Epoch:15 | Val Acc: 0.5822
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 2, 1, 2, 1, 1, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.3762 | Train Acc: 0.8844
 Site-MNIST                     (1) | Train Loss: 0.3071 | Train Acc: 0.9349
 Site-MNIST                     (7) | Train Loss: 0.3683 | Train Acc: 0.9034
 Site-MNIST                     (9) | Train Loss: 0.3561 | Train Acc: 0.9054
 Site-MNIST                     (9) | Train Loss: 0.3265 | Train Acc: 0.9238
 Site-USPS                      (3) | Train Loss: 0.4209 | Train Acc: 0.8849
 Site-USPS                      (3) | Train Loss: 0.4034 | Train Acc: 0.8802
 Site-USPS                      (8) | Train Loss: 0.4051 | Train Acc: 0.8946
 Site-SynthDigits               (6) | Train Loss: 0.6520 | Train Acc: 0.8239
 Site-SynthDigits               (2) | Train Loss: 0.5854 | Train Acc: 0.8598
 Site-MNIST_M                   (5) | Train Loss: 0.9460 | Train Acc: 0.7159
 Site-MNIST_M                   (0) | Train Loss: 0.9295 | Train Acc: 0.7311
 Site-SVHN                      (4) | Train Loss: 1.1271 | Train Acc: 0.6405
Average Train Accuracy: 0.8448
 Site-MNIST                     (1) | Val  Loss: 0.2901 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2792 | Val  Acc: 0.9286
 Site-MNIST                     (7) | Val  Loss: 0.3256 | Val  Acc: 0.9206
 Site-MNIST                     (9) | Val  Loss: 0.3814 | Val  Acc: 0.9105
 Site-MNIST                     (9) | Val  Loss: 0.3292 | Val  Acc: 0.9298
 Site-USPS                      (3) | Val  Loss: 0.3418 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.4129 | Val  Acc: 0.8654
 Site-USPS                      (8) | Val  Loss: 0.4604 | Val  Acc: 0.8547
 Site-SynthDigits               (6) | Val  Loss: 0.7621 | Val  Acc: 0.7803
 Site-SynthDigits               (2) | Val  Loss: 0.5468 | Val  Acc: 0.8081
 Site-MNIST_M                   (5) | Val  Loss: 0.9459 | Val  Acc: 0.7159
 Site-MNIST_M                   (0) | Val  Loss: 0.9955 | Val  Acc: 0.7424
 Site-SVHN                      (4) | Val  Loss: 1.1461 | Val  Acc: 0.5822
Average Valid Accuracy: 0.8341
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9286
 Best site-MNIST                    (7)  | Epoch:16 | Val Acc: 0.9206
 Best site-MNIST                    (9)  | Epoch:16 | Val Acc: 0.9105
 Best site-MNIST                    (9)  | Epoch:16 | Val Acc: 0.9298
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8942
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8654
 Best site-USPS                     (8)  | Epoch:16 | Val Acc: 0.8547
 Best site-SynthDigits              (6)  | Epoch:16 | Val Acc: 0.7803
 Best site-SynthDigits              (2)  | Epoch:16 | Val Acc: 0.8081
 Best site-MNIST_M                  (5)  | Epoch:16 | Val Acc: 0.7159
 Best site-MNIST_M                  (0)  | Epoch:16 | Val Acc: 0.7424
 Best site-SVHN                     (4)  | Epoch:16 | Val Acc: 0.5822
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 1, 1, 2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (6) | Train Loss: 0.3558 | Train Acc: 0.8933
 Site-MNIST                     (3) | Train Loss: 0.2950 | Train Acc: 0.9349
 Site-MNIST                     (3) | Train Loss: 0.3584 | Train Acc: 0.9053
 Site-MNIST                     (8) | Train Loss: 0.3456 | Train Acc: 0.9067
 Site-MNIST                     (6) | Train Loss: 0.3155 | Train Acc: 0.9256
 Site-USPS                      (9) | Train Loss: 0.4140 | Train Acc: 0.8825
 Site-USPS                      (1) | Train Loss: 0.3810 | Train Acc: 0.8850
 Site-USPS                      (5) | Train Loss: 0.3857 | Train Acc: 0.9020
 Site-SynthDigits               (4) | Train Loss: 0.6670 | Train Acc: 0.8258
 Site-SynthDigits               (4) | Train Loss: 0.5702 | Train Acc: 0.8573
 Site-MNIST_M                   (2) | Train Loss: 0.8899 | Train Acc: 0.7415
 Site-MNIST_M                   (7) | Train Loss: 0.8932 | Train Acc: 0.7405
 Site-SVHN                      (0) | Train Loss: 1.1451 | Train Acc: 0.6422
Average Train Accuracy: 0.8494
 Site-MNIST                     (6) | Val  Loss: 0.2750 | Val  Acc: 0.9286
 Site-MNIST                     (3) | Val  Loss: 0.2689 | Val  Acc: 0.9286
 Site-MNIST                     (3) | Val  Loss: 0.3179 | Val  Acc: 0.9206
 Site-MNIST                     (8) | Val  Loss: 0.3725 | Val  Acc: 0.9105
 Site-MNIST                     (6) | Val  Loss: 0.3187 | Val  Acc: 0.9333
 Site-USPS                      (9) | Val  Loss: 0.3231 | Val  Acc: 0.9038
 Site-USPS                      (1) | Val  Loss: 0.3919 | Val  Acc: 0.8590
 Site-USPS                      (5) | Val  Loss: 0.4404 | Val  Acc: 0.8675
 Site-SynthDigits               (4) | Val  Loss: 0.7515 | Val  Acc: 0.7879
 Site-SynthDigits               (4) | Val  Loss: 0.5254 | Val  Acc: 0.8131
 Site-MNIST_M                   (2) | Val  Loss: 0.9195 | Val  Acc: 0.7386
 Site-MNIST_M                   (7) | Val  Loss: 0.9528 | Val  Acc: 0.7500
 Site-SVHN                      (0) | Val  Loss: 1.1460 | Val  Acc: 0.5890
Average Valid Accuracy: 0.8408
 Best site-MNIST                    (6)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (3)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (3)  | Epoch:17 | Val Acc: 0.9206
 Best site-MNIST                    (8)  | Epoch:17 | Val Acc: 0.9105
 Best site-MNIST                    (6)  | Epoch:17 | Val Acc: 0.9333
 Best site-USPS                     (9)  | Epoch:17 | Val Acc: 0.9038
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8590
 Best site-USPS                     (5)  | Epoch:17 | Val Acc: 0.8675
 Best site-SynthDigits              (4)  | Epoch:17 | Val Acc: 0.7879
 Best site-SynthDigits              (4)  | Epoch:17 | Val Acc: 0.8131
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.7386
 Best site-MNIST_M                  (7)  | Epoch:17 | Val Acc: 0.7500
 Best site-SVHN                     (0)  | Epoch:17 | Val Acc: 0.5890
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 1, 1, 1, 1, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (8) | Train Loss: 0.3181 | Train Acc: 0.8933
 Site-MNIST                     (6) | Train Loss: 0.3043 | Train Acc: 0.9320
 Site-MNIST                     (8) | Train Loss: 0.3456 | Train Acc: 0.9093
 Site-MNIST                     (0) | Train Loss: 0.3363 | Train Acc: 0.9067
 Site-MNIST                     (6) | Train Loss: 0.3049 | Train Acc: 0.9299
 Site-USPS                      (1) | Train Loss: 0.3982 | Train Acc: 0.8969
 Site-USPS                      (7) | Train Loss: 0.3704 | Train Acc: 0.8866
 Site-USPS                      (7) | Train Loss: 0.3687 | Train Acc: 0.9031
 Site-SynthDigits               (3) | Train Loss: 0.5783 | Train Acc: 0.8409
 Site-SynthDigits               (9) | Train Loss: 0.5307 | Train Acc: 0.8712
 Site-MNIST_M                   (2) | Train Loss: 0.9146 | Train Acc: 0.7585
 Site-MNIST_M                   (5) | Train Loss: 0.8883 | Train Acc: 0.7557
 Site-SVHN                      (4) | Train Loss: 1.0796 | Train Acc: 0.6474
Average Train Accuracy: 0.8563
 Site-MNIST                     (8) | Val  Loss: 0.2722 | Val  Acc: 0.9107
 Site-MNIST                     (6) | Val  Loss: 0.2655 | Val  Acc: 0.9167
 Site-MNIST                     (8) | Val  Loss: 0.3070 | Val  Acc: 0.9206
 Site-MNIST                     (0) | Val  Loss: 0.3600 | Val  Acc: 0.9105
 Site-MNIST                     (6) | Val  Loss: 0.3074 | Val  Acc: 0.9298
 Site-USPS                      (1) | Val  Loss: 0.3125 | Val  Acc: 0.9038
 Site-USPS                      (7) | Val  Loss: 0.3784 | Val  Acc: 0.8654
 Site-USPS                      (7) | Val  Loss: 0.4285 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.7036 | Val  Acc: 0.8106
 Site-SynthDigits               (9) | Val  Loss: 0.5018 | Val  Acc: 0.8333
 Site-MNIST_M                   (2) | Val  Loss: 0.9101 | Val  Acc: 0.7500
 Site-MNIST_M                   (5) | Val  Loss: 0.9312 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.1016 | Val  Acc: 0.5890
Average Valid Accuracy: 0.8455
 Best site-MNIST                    (8)  | Epoch:18 | Val Acc: 0.9107
 Best site-MNIST                    (6)  | Epoch:18 | Val Acc: 0.9167
 Best site-MNIST                    (8)  | Epoch:18 | Val Acc: 0.9206
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9105
 Best site-MNIST                    (6)  | Epoch:18 | Val Acc: 0.9298
 Best site-USPS                     (1)  | Epoch:18 | Val Acc: 0.9038
 Best site-USPS                     (7)  | Epoch:18 | Val Acc: 0.8654
 Best site-USPS                     (7)  | Epoch:18 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8106
 Best site-SynthDigits              (9)  | Epoch:18 | Val Acc: 0.8333
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7500
 Best site-MNIST_M                  (5)  | Epoch:18 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:18 | Val Acc: 0.5890
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 2, 1, 1, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (1) | Train Loss: 0.3084 | Train Acc: 0.8978
 Site-MNIST                     (6) | Train Loss: 0.2740 | Train Acc: 0.9408
 Site-MNIST                     (8) | Train Loss: 0.3326 | Train Acc: 0.9132
 Site-MNIST                     (1) | Train Loss: 0.3218 | Train Acc: 0.9133
 Site-MNIST                     (6) | Train Loss: 0.2902 | Train Acc: 0.9326
 Site-USPS                      (7) | Train Loss: 0.3786 | Train Acc: 0.8873
 Site-USPS                      (0) | Train Loss: 0.3573 | Train Acc: 0.8946
 Site-USPS                      (0) | Train Loss: 0.3553 | Train Acc: 0.9084
 Site-SynthDigits               (3) | Train Loss: 0.5750 | Train Acc: 0.8390
 Site-SynthDigits               (9) | Train Loss: 0.5272 | Train Acc: 0.8699
 Site-MNIST_M                   (2) | Train Loss: 0.8688 | Train Acc: 0.7727
 Site-MNIST_M                   (5) | Train Loss: 0.8305 | Train Acc: 0.7557
 Site-SVHN                      (4) | Train Loss: 1.0831 | Train Acc: 0.6559
Average Train Accuracy: 0.8601
 Site-MNIST                     (1) | Val  Loss: 0.2565 | Val  Acc: 0.9286
 Site-MNIST                     (6) | Val  Loss: 0.2500 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.2927 | Val  Acc: 0.9127
 Site-MNIST                     (1) | Val  Loss: 0.3468 | Val  Acc: 0.9053
 Site-MNIST                     (6) | Val  Loss: 0.2949 | Val  Acc: 0.9298
 Site-USPS                      (7) | Val  Loss: 0.2931 | Val  Acc: 0.9038
 Site-USPS                      (0) | Val  Loss: 0.3648 | Val  Acc: 0.8590
 Site-USPS                      (0) | Val  Loss: 0.4190 | Val  Acc: 0.8675
 Site-SynthDigits               (3) | Val  Loss: 0.7135 | Val  Acc: 0.8030
 Site-SynthDigits               (9) | Val  Loss: 0.4863 | Val  Acc: 0.8232
 Site-MNIST_M                   (2) | Val  Loss: 0.8711 | Val  Acc: 0.7500
 Site-MNIST_M                   (5) | Val  Loss: 0.9023 | Val  Acc: 0.7727
 Site-SVHN                      (4) | Val  Loss: 1.1063 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8462
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (6)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (8)  | Epoch:19 | Val Acc: 0.9127
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9053
 Best site-MNIST                    (6)  | Epoch:19 | Val Acc: 0.9298
 Best site-USPS                     (7)  | Epoch:19 | Val Acc: 0.9038
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.8590
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.8675
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.8030
 Best site-SynthDigits              (9)  | Epoch:19 | Val Acc: 0.8232
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7500
 Best site-MNIST_M                  (5)  | Epoch:19 | Val Acc: 0.7727
 Best site-SVHN                     (4)  | Epoch:19 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 2, 1, 2, 1, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (5) | Train Loss: 0.3344 | Train Acc: 0.8800
 Site-MNIST                     (5) | Train Loss: 0.3330 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.3403 | Train Acc: 0.8935
 Site-MNIST                     (8) | Train Loss: 0.3285 | Train Acc: 0.9067
 Site-MNIST                     (1) | Train Loss: 0.2996 | Train Acc: 0.9264
 Site-USPS                      (3) | Train Loss: 0.3813 | Train Acc: 0.8969
 Site-USPS                      (7) | Train Loss: 0.3494 | Train Acc: 0.9042
 Site-USPS                      (3) | Train Loss: 0.3501 | Train Acc: 0.9084
 Site-SynthDigits               (6) | Train Loss: 0.5905 | Train Acc: 0.8295
 Site-SynthDigits               (4) | Train Loss: 0.5246 | Train Acc: 0.8775
 Site-MNIST_M                   (9) | Train Loss: 0.8454 | Train Acc: 0.7727
 Site-MNIST_M                   (2) | Train Loss: 0.8313 | Train Acc: 0.7557
 Site-SVHN                      (0) | Train Loss: 1.0105 | Train Acc: 0.6661
Average Train Accuracy: 0.8574
 Site-MNIST                     (5) | Val  Loss: 0.2672 | Val  Acc: 0.9286
 Site-MNIST                     (5) | Val  Loss: 0.2598 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3022 | Val  Acc: 0.9048
 Site-MNIST                     (8) | Val  Loss: 0.3555 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3011 | Val  Acc: 0.9228
 Site-USPS                      (3) | Val  Loss: 0.2887 | Val  Acc: 0.9327
 Site-USPS                      (7) | Val  Loss: 0.3533 | Val  Acc: 0.8782
 Site-USPS                      (3) | Val  Loss: 0.4069 | Val  Acc: 0.8675
 Site-SynthDigits               (6) | Val  Loss: 0.7006 | Val  Acc: 0.7955
 Site-SynthDigits               (4) | Val  Loss: 0.4709 | Val  Acc: 0.8333
 Site-MNIST_M                   (9) | Val  Loss: 0.8537 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.8898 | Val  Acc: 0.7803
 Site-SVHN                      (0) | Val  Loss: 1.0648 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8497
 Best site-MNIST                    (5)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (5)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9048
 Best site-MNIST                    (8)  | Epoch:20 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9228
 Best site-USPS                     (3)  | Epoch:20 | Val Acc: 0.9327
 Best site-USPS                     (7)  | Epoch:20 | Val Acc: 0.8782
 Best site-USPS                     (3)  | Epoch:20 | Val Acc: 0.8675
 Best site-SynthDigits              (6)  | Epoch:20 | Val Acc: 0.7955
 Best site-SynthDigits              (4)  | Epoch:20 | Val Acc: 0.8333
 Best site-MNIST_M                  (9)  | Epoch:20 | Val Acc: 0.7500
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.7803
 Best site-SVHN                     (0)  | Epoch:20 | Val Acc: 0.6233
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 21 ============
cnt=[1, 1, 1, 2, 1, 1, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (8) | Train Loss: 0.3176 | Train Acc: 0.8889
 Site-MNIST                     (8) | Train Loss: 0.2456 | Train Acc: 0.9349
 Site-MNIST                     (0) | Train Loss: 0.3217 | Train Acc: 0.9073
 Site-MNIST                     (7) | Train Loss: 0.3131 | Train Acc: 0.9120
 Site-MNIST                     (7) | Train Loss: 0.2838 | Train Acc: 0.9308
 Site-USPS                      (6) | Train Loss: 0.3623 | Train Acc: 0.8993
 Site-USPS                      (3) | Train Loss: 0.3389 | Train Acc: 0.9058
 Site-USPS                      (3) | Train Loss: 0.3389 | Train Acc: 0.9084
 Site-SynthDigits               (1) | Train Loss: 0.5769 | Train Acc: 0.8485
 Site-SynthDigits               (9) | Train Loss: 0.5050 | Train Acc: 0.8851
 Site-MNIST_M                   (5) | Train Loss: 0.8364 | Train Acc: 0.7699
 Site-MNIST_M                   (2) | Train Loss: 0.8186 | Train Acc: 0.7633
 Site-SVHN                      (4) | Train Loss: 0.9669 | Train Acc: 0.6729
Average Train Accuracy: 0.8636
 Site-MNIST                     (8) | Val  Loss: 0.2550 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.2446 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2847 | Val  Acc: 0.9286
 Site-MNIST                     (7) | Val  Loss: 0.3386 | Val  Acc: 0.9211
 Site-MNIST                     (7) | Val  Loss: 0.2842 | Val  Acc: 0.9298
 Site-USPS                      (6) | Val  Loss: 0.2890 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.3435 | Val  Acc: 0.8718
 Site-USPS                      (3) | Val  Loss: 0.3960 | Val  Acc: 0.8632
 Site-SynthDigits               (1) | Val  Loss: 0.6527 | Val  Acc: 0.8333
 Site-SynthDigits               (9) | Val  Loss: 0.4499 | Val  Acc: 0.8535
 Site-MNIST_M                   (5) | Val  Loss: 0.8779 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.8869 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.0431 | Val  Acc: 0.6370
Average Valid Accuracy: 0.8591
 Best site-MNIST                    (8)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (8)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (7)  | Epoch:21 | Val Acc: 0.9211
 Best site-MNIST                    (7)  | Epoch:21 | Val Acc: 0.9298
 Best site-USPS                     (6)  | Epoch:21 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8718
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8632
 Best site-SynthDigits              (1)  | Epoch:21 | Val Acc: 0.8333
 Best site-SynthDigits              (9)  | Epoch:21 | Val Acc: 0.8535
 Best site-MNIST_M                  (5)  | Epoch:21 | Val Acc: 0.7614
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:21 | Val Acc: 0.6370
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 22 ============
cnt=[1, 1, 3, 1, 1, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (2) | Train Loss: 0.2921 | Train Acc: 0.8978
 Site-MNIST                     (2) | Train Loss: 0.2474 | Train Acc: 0.9320
 Site-MNIST                     (8) | Train Loss: 0.3018 | Train Acc: 0.9152
 Site-MNIST                     (8) | Train Loss: 0.2982 | Train Acc: 0.9185
 Site-MNIST                     (2) | Train Loss: 0.2687 | Train Acc: 0.9361
 Site-USPS                      (5) | Train Loss: 0.3557 | Train Acc: 0.8945
 Site-USPS                      (1) | Train Loss: 0.3256 | Train Acc: 0.9026
 Site-USPS                      (9) | Train Loss: 0.3238 | Train Acc: 0.9105
 Site-SynthDigits               (6) | Train Loss: 0.5570 | Train Acc: 0.8466
 Site-SynthDigits               (3) | Train Loss: 0.4802 | Train Acc: 0.8889
 Site-MNIST_M                   (0) | Train Loss: 0.7912 | Train Acc: 0.7841
 Site-MNIST_M                   (7) | Train Loss: 0.7899 | Train Acc: 0.7784
 Site-SVHN                      (4) | Train Loss: 0.9870 | Train Acc: 0.6610
Average Train Accuracy: 0.8666
 Site-MNIST                     (2) | Val  Loss: 0.2343 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2277 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.2682 | Val  Acc: 0.9206
 Site-MNIST                     (8) | Val  Loss: 0.3207 | Val  Acc: 0.9158
 Site-MNIST                     (2) | Val  Loss: 0.2704 | Val  Acc: 0.9298
 Site-USPS                      (5) | Val  Loss: 0.2670 | Val  Acc: 0.9327
 Site-USPS                      (1) | Val  Loss: 0.3292 | Val  Acc: 0.8782
 Site-USPS                      (9) | Val  Loss: 0.3830 | Val  Acc: 0.8675
 Site-SynthDigits               (6) | Val  Loss: 0.6536 | Val  Acc: 0.8106
 Site-SynthDigits               (3) | Val  Loss: 0.4416 | Val  Acc: 0.8535
 Site-MNIST_M                   (0) | Val  Loss: 0.8230 | Val  Acc: 0.7841
 Site-MNIST_M                   (7) | Val  Loss: 0.8501 | Val  Acc: 0.7955
 Site-SVHN                      (4) | Val  Loss: 1.0520 | Val  Acc: 0.6301
Average Valid Accuracy: 0.8597
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9286
 Best site-MNIST                    (8)  | Epoch:22 | Val Acc: 0.9206
 Best site-MNIST                    (8)  | Epoch:22 | Val Acc: 0.9158
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9298
 Best site-USPS                     (5)  | Epoch:22 | Val Acc: 0.9327
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.8782
 Best site-USPS                     (9)  | Epoch:22 | Val Acc: 0.8675
 Best site-SynthDigits              (6)  | Epoch:22 | Val Acc: 0.8106
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8535
 Best site-MNIST_M                  (0)  | Epoch:22 | Val Acc: 0.7841
 Best site-MNIST_M                  (7)  | Epoch:22 | Val Acc: 0.7955
 Best site-SVHN                     (4)  | Epoch:22 | Val Acc: 0.6301
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 23 ============
cnt=[1, 1, 1, 2, 1, 1, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (0) | Train Loss: 0.2829 | Train Acc: 0.9067
 Site-MNIST                     (8) | Train Loss: 0.2476 | Train Acc: 0.9467
 Site-MNIST                     (9) | Train Loss: 0.2920 | Train Acc: 0.9172
 Site-MNIST                     (8) | Train Loss: 0.2912 | Train Acc: 0.9225
 Site-MNIST                     (8) | Train Loss: 0.2572 | Train Acc: 0.9396
 Site-USPS                      (6) | Train Loss: 0.3550 | Train Acc: 0.8945
 Site-USPS                      (3) | Train Loss: 0.3272 | Train Acc: 0.9058
 Site-USPS                      (3) | Train Loss: 0.3201 | Train Acc: 0.9148
 Site-SynthDigits               (7) | Train Loss: 0.5271 | Train Acc: 0.8561
 Site-SynthDigits               (1) | Train Loss: 0.4653 | Train Acc: 0.8977
 Site-MNIST_M                   (5) | Train Loss: 0.7970 | Train Acc: 0.8068
 Site-MNIST_M                   (2) | Train Loss: 0.7989 | Train Acc: 0.7860
 Site-SVHN                      (4) | Train Loss: 0.9916 | Train Acc: 0.6848
Average Train Accuracy: 0.8753
 Site-MNIST                     (0) | Val  Loss: 0.2229 | Val  Acc: 0.9464
 Site-MNIST                     (8) | Val  Loss: 0.2179 | Val  Acc: 0.9286
 Site-MNIST                     (9) | Val  Loss: 0.2617 | Val  Acc: 0.9365
 Site-MNIST                     (8) | Val  Loss: 0.3117 | Val  Acc: 0.9316
 Site-MNIST                     (8) | Val  Loss: 0.2618 | Val  Acc: 0.9509
 Site-USPS                      (6) | Val  Loss: 0.2609 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.3225 | Val  Acc: 0.8782
 Site-USPS                      (3) | Val  Loss: 0.3807 | Val  Acc: 0.8632
 Site-SynthDigits               (7) | Val  Loss: 0.5988 | Val  Acc: 0.8561
 Site-SynthDigits               (1) | Val  Loss: 0.4219 | Val  Acc: 0.8687
 Site-MNIST_M                   (5) | Val  Loss: 0.8329 | Val  Acc: 0.7727
 Site-MNIST_M                   (2) | Val  Loss: 0.8404 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.0085 | Val  Acc: 0.6438
Average Valid Accuracy: 0.8690
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9464
 Best site-MNIST                    (8)  | Epoch:23 | Val Acc: 0.9286
 Best site-MNIST                    (9)  | Epoch:23 | Val Acc: 0.9365
 Best site-MNIST                    (8)  | Epoch:23 | Val Acc: 0.9316
 Best site-MNIST                    (8)  | Epoch:23 | Val Acc: 0.9509
 Best site-USPS                     (6)  | Epoch:23 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:23 | Val Acc: 0.8782
 Best site-USPS                     (3)  | Epoch:23 | Val Acc: 0.8632
 Best site-SynthDigits              (7)  | Epoch:23 | Val Acc: 0.8561
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.8687
 Best site-MNIST_M                  (5)  | Epoch:23 | Val Acc: 0.7727
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:23 | Val Acc: 0.6438
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 2, 1, 1, 1, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (7) | Train Loss: 0.2909 | Train Acc: 0.9111
 Site-MNIST                     (1) | Train Loss: 0.2303 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2824 | Train Acc: 0.9191
 Site-MNIST                     (7) | Train Loss: 0.2828 | Train Acc: 0.9238
 Site-MNIST                     (7) | Train Loss: 0.2502 | Train Acc: 0.9431
 Site-USPS                      (8) | Train Loss: 0.3393 | Train Acc: 0.9065
 Site-USPS                      (9) | Train Loss: 0.3160 | Train Acc: 0.9105
 Site-USPS                      (0) | Train Loss: 0.3137 | Train Acc: 0.9159
 Site-SynthDigits               (5) | Train Loss: 0.5221 | Train Acc: 0.8561
 Site-SynthDigits               (3) | Train Loss: 0.4680 | Train Acc: 0.8851
 Site-MNIST_M                   (2) | Train Loss: 0.7723 | Train Acc: 0.7784
 Site-MNIST_M                   (6) | Train Loss: 0.7391 | Train Acc: 0.7803
 Site-SVHN                      (4) | Train Loss: 0.9544 | Train Acc: 0.6797
Average Train Accuracy: 0.8733
 Site-MNIST                     (7) | Val  Loss: 0.2163 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2125 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2557 | Val  Acc: 0.9365
 Site-MNIST                     (7) | Val  Loss: 0.3025 | Val  Acc: 0.9421
 Site-MNIST                     (7) | Val  Loss: 0.2547 | Val  Acc: 0.9404
 Site-USPS                      (8) | Val  Loss: 0.2500 | Val  Acc: 0.9423
 Site-USPS                      (9) | Val  Loss: 0.3143 | Val  Acc: 0.8910
 Site-USPS                      (0) | Val  Loss: 0.3714 | Val  Acc: 0.8718
 Site-SynthDigits               (5) | Val  Loss: 0.5997 | Val  Acc: 0.8636
 Site-SynthDigits               (3) | Val  Loss: 0.4165 | Val  Acc: 0.8687
 Site-MNIST_M                   (2) | Val  Loss: 0.8263 | Val  Acc: 0.7614
 Site-MNIST_M                   (6) | Val  Loss: 0.8304 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 0.9755 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8743
 Best site-MNIST                    (7)  | Epoch:24 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9365
 Best site-MNIST                    (7)  | Epoch:24 | Val Acc: 0.9421
 Best site-MNIST                    (7)  | Epoch:24 | Val Acc: 0.9404
 Best site-USPS                     (8)  | Epoch:24 | Val Acc: 0.9423
 Best site-USPS                     (9)  | Epoch:24 | Val Acc: 0.8910
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8718
 Best site-SynthDigits              (5)  | Epoch:24 | Val Acc: 0.8636
 Best site-SynthDigits              (3)  | Epoch:24 | Val Acc: 0.8687
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7614
 Best site-MNIST_M                  (6)  | Epoch:24 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.6849
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 1, 1, 2, 1, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (0) | Train Loss: 0.2806 | Train Acc: 0.9111
 Site-MNIST                     (7) | Train Loss: 0.2181 | Train Acc: 0.9438
 Site-MNIST                     (7) | Train Loss: 0.2783 | Train Acc: 0.9191
 Site-MNIST                     (0) | Train Loss: 0.2790 | Train Acc: 0.9159
 Site-MNIST                     (5) | Train Loss: 0.2447 | Train Acc: 0.9448
 Site-USPS                      (6) | Train Loss: 0.3308 | Train Acc: 0.9017
 Site-USPS                      (3) | Train Loss: 0.3113 | Train Acc: 0.9121
 Site-USPS                      (3) | Train Loss: 0.3027 | Train Acc: 0.9191
 Site-SynthDigits               (8) | Train Loss: 0.5078 | Train Acc: 0.8598
 Site-SynthDigits               (1) | Train Loss: 0.4475 | Train Acc: 0.8977
 Site-MNIST_M                   (2) | Train Loss: 0.7502 | Train Acc: 0.7898
 Site-MNIST_M                   (9) | Train Loss: 0.7310 | Train Acc: 0.7860
 Site-SVHN                      (4) | Train Loss: 0.9532 | Train Acc: 0.6865
Average Train Accuracy: 0.8760
 Site-MNIST                     (0) | Val  Loss: 0.2207 | Val  Acc: 0.9107
 Site-MNIST                     (7) | Val  Loss: 0.2153 | Val  Acc: 0.9167
 Site-MNIST                     (7) | Val  Loss: 0.2512 | Val  Acc: 0.9444
 Site-MNIST                     (0) | Val  Loss: 0.2967 | Val  Acc: 0.9421
 Site-MNIST                     (5) | Val  Loss: 0.2509 | Val  Acc: 0.9404
 Site-USPS                      (6) | Val  Loss: 0.2463 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.3045 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.3594 | Val  Acc: 0.8718
 Site-SynthDigits               (8) | Val  Loss: 0.5890 | Val  Acc: 0.8485
 Site-SynthDigits               (1) | Val  Loss: 0.4032 | Val  Acc: 0.8838
 Site-MNIST_M                   (2) | Val  Loss: 0.8059 | Val  Acc: 0.7841
 Site-MNIST_M                   (9) | Val  Loss: 0.8076 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.9741 | Val  Acc: 0.6712
Average Valid Accuracy: 0.8732
============ Train epoch 26 ============
cnt=[1, 1, 1, 2, 1, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (6) | Train Loss: 0.2672 | Train Acc: 0.9111
 Site-MNIST                     (9) | Train Loss: 0.2243 | Train Acc: 0.9438
 Site-MNIST                     (6) | Train Loss: 0.2756 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.2775 | Train Acc: 0.9159
 Site-MNIST                     (6) | Train Loss: 0.2450 | Train Acc: 0.9413
 Site-USPS                      (3) | Train Loss: 0.3270 | Train Acc: 0.9065
 Site-USPS                      (8) | Train Loss: 0.3000 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2959 | Train Acc: 0.9201
 Site-SynthDigits               (7) | Train Loss: 0.4831 | Train Acc: 0.8598
 Site-SynthDigits               (0) | Train Loss: 0.4424 | Train Acc: 0.8990
 Site-MNIST_M                   (2) | Train Loss: 0.7470 | Train Acc: 0.7898
 Site-MNIST_M                   (5) | Train Loss: 0.7367 | Train Acc: 0.7879
 Site-SVHN                      (4) | Train Loss: 0.9282 | Train Acc: 0.7002
Average Train Accuracy: 0.8777
 Site-MNIST                     (6) | Val  Loss: 0.2235 | Val  Acc: 0.9107
 Site-MNIST                     (9) | Val  Loss: 0.2179 | Val  Acc: 0.9167
 Site-MNIST                     (6) | Val  Loss: 0.2494 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2938 | Val  Acc: 0.9316
 Site-MNIST                     (6) | Val  Loss: 0.2499 | Val  Acc: 0.9368
 Site-USPS                      (3) | Val  Loss: 0.2448 | Val  Acc: 0.9327
 Site-USPS                      (8) | Val  Loss: 0.2960 | Val  Acc: 0.8910
 Site-USPS                      (3) | Val  Loss: 0.3484 | Val  Acc: 0.8718
 Site-SynthDigits               (7) | Val  Loss: 0.5676 | Val  Acc: 0.8485
 Site-SynthDigits               (0) | Val  Loss: 0.3903 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.7963 | Val  Acc: 0.7727
 Site-MNIST_M                   (5) | Val  Loss: 0.8104 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 0.9393 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8695
============ Train epoch 27 ============
cnt=[2, 2, 2, 1, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.2761 | Train Acc: 0.9067
 Site-MNIST                     (7) | Train Loss: 0.2337 | Train Acc: 0.9438
 Site-MNIST                     (9) | Train Loss: 0.2764 | Train Acc: 0.9172
 Site-MNIST                     (6) | Train Loss: 0.2772 | Train Acc: 0.9212
 Site-MNIST                     (1) | Train Loss: 0.2414 | Train Acc: 0.9457
 Site-USPS                      (3) | Train Loss: 0.3142 | Train Acc: 0.9065
 Site-USPS                      (8) | Train Loss: 0.2998 | Train Acc: 0.9073
 Site-USPS                      (5) | Train Loss: 0.2905 | Train Acc: 0.9127
 Site-SynthDigits               (2) | Train Loss: 0.4756 | Train Acc: 0.8674
 Site-SynthDigits               (2) | Train Loss: 0.4378 | Train Acc: 0.9003
 Site-MNIST_M                   (0) | Train Loss: 0.7310 | Train Acc: 0.7812
 Site-MNIST_M                   (0) | Train Loss: 0.7031 | Train Acc: 0.7879
 Site-SVHN                      (4) | Train Loss: 0.8675 | Train Acc: 0.7121
Average Train Accuracy: 0.8777
 Site-MNIST                     (1) | Val  Loss: 0.2162 | Val  Acc: 0.9286
 Site-MNIST                     (7) | Val  Loss: 0.2172 | Val  Acc: 0.9286
 Site-MNIST                     (9) | Val  Loss: 0.2535 | Val  Acc: 0.9365
 Site-MNIST                     (6) | Val  Loss: 0.2959 | Val  Acc: 0.9316
 Site-MNIST                     (1) | Val  Loss: 0.2491 | Val  Acc: 0.9333
 Site-USPS                      (3) | Val  Loss: 0.2446 | Val  Acc: 0.9327
 Site-USPS                      (8) | Val  Loss: 0.2894 | Val  Acc: 0.8910
 Site-USPS                      (5) | Val  Loss: 0.3415 | Val  Acc: 0.8718
 Site-SynthDigits               (2) | Val  Loss: 0.5589 | Val  Acc: 0.8409
 Site-SynthDigits               (2) | Val  Loss: 0.3790 | Val  Acc: 0.8838
 Site-MNIST_M                   (0) | Val  Loss: 0.7677 | Val  Acc: 0.7614
 Site-MNIST_M                   (0) | Val  Loss: 0.7875 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 0.9088 | Val  Acc: 0.6918
Average Valid Accuracy: 0.8708
============ Train epoch 28 ============
cnt=[2, 3, 1, 1, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.2465 | Train Acc: 0.9111
 Site-MNIST                     (1) | Train Loss: 0.2380 | Train Acc: 0.9408
 Site-MNIST                     (1) | Train Loss: 0.2645 | Train Acc: 0.9211
 Site-MNIST                     (8) | Train Loss: 0.2673 | Train Acc: 0.9225
 Site-MNIST                     (6) | Train Loss: 0.2329 | Train Acc: 0.9466
 Site-USPS                      (5) | Train Loss: 0.3149 | Train Acc: 0.9065
 Site-USPS                      (9) | Train Loss: 0.2957 | Train Acc: 0.9121
 Site-USPS                      (3) | Train Loss: 0.2899 | Train Acc: 0.9169
 Site-SynthDigits               (0) | Train Loss: 0.4666 | Train Acc: 0.8750
 Site-SynthDigits               (0) | Train Loss: 0.4124 | Train Acc: 0.9066
 Site-MNIST_M                   (2) | Train Loss: 0.7166 | Train Acc: 0.8040
 Site-MNIST_M                   (7) | Train Loss: 0.6868 | Train Acc: 0.7992
 Site-SVHN                      (4) | Train Loss: 0.8781 | Train Acc: 0.7240
Average Train Accuracy: 0.8836
 Site-MNIST                     (1) | Val  Loss: 0.2058 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2044 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2447 | Val  Acc: 0.9365
 Site-MNIST                     (8) | Val  Loss: 0.2859 | Val  Acc: 0.9368
 Site-MNIST                     (6) | Val  Loss: 0.2384 | Val  Acc: 0.9404
 Site-USPS                      (5) | Val  Loss: 0.2444 | Val  Acc: 0.9423
 Site-USPS                      (9) | Val  Loss: 0.2853 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.3392 | Val  Acc: 0.8803
 Site-SynthDigits               (0) | Val  Loss: 0.5430 | Val  Acc: 0.8636
 Site-SynthDigits               (0) | Val  Loss: 0.3669 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.7713 | Val  Acc: 0.7841
 Site-MNIST_M                   (7) | Val  Loss: 0.7826 | Val  Acc: 0.8030
 Site-SVHN                      (4) | Val  Loss: 0.8974 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8782
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9365
 Best site-MNIST                    (8)  | Epoch:28 | Val Acc: 0.9368
 Best site-MNIST                    (6)  | Epoch:28 | Val Acc: 0.9404
 Best site-USPS                     (5)  | Epoch:28 | Val Acc: 0.9423
 Best site-USPS                     (9)  | Epoch:28 | Val Acc: 0.8846
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.8803
 Best site-SynthDigits              (0)  | Epoch:28 | Val Acc: 0.8636
 Best site-SynthDigits              (0)  | Epoch:28 | Val Acc: 0.8889
 Best site-MNIST_M                  (2)  | Epoch:28 | Val Acc: 0.7841
 Best site-MNIST_M                  (7)  | Epoch:28 | Val Acc: 0.8030
 Best site-SVHN                     (4)  | Epoch:28 | Val Acc: 0.6986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 29 ============
cnt=[3, 1, 1, 2, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (8) | Train Loss: 0.2660 | Train Acc: 0.9200
 Site-MNIST                     (0) | Train Loss: 0.2268 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2564 | Train Acc: 0.9231
 Site-MNIST                     (0) | Train Loss: 0.2586 | Train Acc: 0.9225
 Site-MNIST                     (9) | Train Loss: 0.2258 | Train Acc: 0.9457
 Site-USPS                      (3) | Train Loss: 0.3058 | Train Acc: 0.9113
 Site-USPS                      (3) | Train Loss: 0.2824 | Train Acc: 0.9249
 Site-USPS                      (7) | Train Loss: 0.2801 | Train Acc: 0.9191
 Site-SynthDigits               (6) | Train Loss: 0.4591 | Train Acc: 0.8655
 Site-SynthDigits               (1) | Train Loss: 0.4100 | Train Acc: 0.9015
 Site-MNIST_M                   (5) | Train Loss: 0.6804 | Train Acc: 0.8097
 Site-MNIST_M                   (2) | Train Loss: 0.6858 | Train Acc: 0.7973
 Site-SVHN                      (4) | Train Loss: 0.8443 | Train Acc: 0.7053
Average Train Accuracy: 0.8840
 Site-MNIST                     (8) | Val  Loss: 0.1985 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1976 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2368 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2752 | Val  Acc: 0.9421
 Site-MNIST                     (9) | Val  Loss: 0.2313 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2330 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.2804 | Val  Acc: 0.8974
 Site-USPS                      (7) | Val  Loss: 0.3312 | Val  Acc: 0.8803
 Site-SynthDigits               (6) | Val  Loss: 0.5257 | Val  Acc: 0.8636
 Site-SynthDigits               (1) | Val  Loss: 0.3674 | Val  Acc: 0.8889
 Site-MNIST_M                   (5) | Val  Loss: 0.7442 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.7532 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.8973 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8786
 Best site-MNIST                    (8)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9365
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9421
 Best site-MNIST                    (9)  | Epoch:29 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.9423
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.8974
 Best site-USPS                     (7)  | Epoch:29 | Val Acc: 0.8803
 Best site-SynthDigits              (6)  | Epoch:29 | Val Acc: 0.8636
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8889
 Best site-MNIST_M                  (5)  | Epoch:29 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:29 | Val Acc: 0.8106
 Best site-SVHN                     (4)  | Epoch:29 | Val Acc: 0.6781
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 30 ============
cnt=[1, 2, 1, 1, 1, 1, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (8) | Train Loss: 0.2581 | Train Acc: 0.9111
 Site-MNIST                     (2) | Train Loss: 0.2061 | Train Acc: 0.9408
 Site-MNIST                     (8) | Train Loss: 0.2501 | Train Acc: 0.9231
 Site-MNIST                     (9) | Train Loss: 0.2530 | Train Acc: 0.9290
 Site-MNIST                     (9) | Train Loss: 0.2235 | Train Acc: 0.9457
 Site-USPS                      (1) | Train Loss: 0.3025 | Train Acc: 0.9113
 Site-USPS                      (7) | Train Loss: 0.2817 | Train Acc: 0.9169
 Site-USPS                      (1) | Train Loss: 0.2775 | Train Acc: 0.9244
 Site-SynthDigits               (5) | Train Loss: 0.4423 | Train Acc: 0.8693
 Site-SynthDigits               (3) | Train Loss: 0.4035 | Train Acc: 0.9066
 Site-MNIST_M                   (6) | Train Loss: 0.6988 | Train Acc: 0.7926
 Site-MNIST_M                   (0) | Train Loss: 0.6643 | Train Acc: 0.8068
 Site-SVHN                      (4) | Train Loss: 0.8537 | Train Acc: 0.7274
Average Train Accuracy: 0.8850
 Site-MNIST                     (8) | Val  Loss: 0.1943 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.1929 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.2320 | Val  Acc: 0.9444
 Site-MNIST                     (9) | Val  Loss: 0.2717 | Val  Acc: 0.9421
 Site-MNIST                     (9) | Val  Loss: 0.2259 | Val  Acc: 0.9404
 Site-USPS                      (1) | Val  Loss: 0.2341 | Val  Acc: 0.9519
 Site-USPS                      (7) | Val  Loss: 0.2755 | Val  Acc: 0.9038
 Site-USPS                      (1) | Val  Loss: 0.3274 | Val  Acc: 0.8846
 Site-SynthDigits               (5) | Val  Loss: 0.5149 | Val  Acc: 0.8561
 Site-SynthDigits               (3) | Val  Loss: 0.3520 | Val  Acc: 0.8939
 Site-MNIST_M                   (6) | Val  Loss: 0.7530 | Val  Acc: 0.7614
 Site-MNIST_M                   (0) | Val  Loss: 0.7623 | Val  Acc: 0.7955
 Site-SVHN                      (4) | Val  Loss: 0.8718 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8782
============ Train epoch 31 ============
cnt=[3, 1, 1, 1, 1, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (0) | Train Loss: 0.2395 | Train Acc: 0.9200
 Site-MNIST                     (8) | Train Loss: 0.2002 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2417 | Train Acc: 0.9270
 Site-MNIST                     (0) | Train Loss: 0.2435 | Train Acc: 0.9304
 Site-MNIST                     (8) | Train Loss: 0.2152 | Train Acc: 0.9483
 Site-USPS                      (7) | Train Loss: 0.3007 | Train Acc: 0.9089
 Site-USPS                      (5) | Train Loss: 0.2787 | Train Acc: 0.9265
 Site-USPS                      (3) | Train Loss: 0.2716 | Train Acc: 0.9223
 Site-SynthDigits               (1) | Train Loss: 0.4411 | Train Acc: 0.8655
 Site-SynthDigits               (9) | Train Loss: 0.3831 | Train Acc: 0.9141
 Site-MNIST_M                   (2) | Train Loss: 0.6799 | Train Acc: 0.8182
 Site-MNIST_M                   (6) | Train Loss: 0.6705 | Train Acc: 0.8106
 Site-SVHN                      (4) | Train Loss: 0.8065 | Train Acc: 0.7462
Average Train Accuracy: 0.8911
 Site-MNIST                     (0) | Val  Loss: 0.1900 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.1863 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2263 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2629 | Val  Acc: 0.9474
 Site-MNIST                     (8) | Val  Loss: 0.2187 | Val  Acc: 0.9439
 Site-USPS                      (7) | Val  Loss: 0.2201 | Val  Acc: 0.9519
 Site-USPS                      (5) | Val  Loss: 0.2678 | Val  Acc: 0.8974
 Site-USPS                      (3) | Val  Loss: 0.3245 | Val  Acc: 0.8761
 Site-SynthDigits               (1) | Val  Loss: 0.5033 | Val  Acc: 0.8636
 Site-SynthDigits               (9) | Val  Loss: 0.3463 | Val  Acc: 0.8939
 Site-MNIST_M                   (2) | Val  Loss: 0.7344 | Val  Acc: 0.7841
 Site-MNIST_M                   (6) | Val  Loss: 0.7393 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.8345 | Val  Acc: 0.6918
Average Valid Accuracy: 0.8811
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                    (8)  | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9365
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9474
 Best site-MNIST                    (8)  | Epoch:31 | Val Acc: 0.9439
 Best site-USPS                     (7)  | Epoch:31 | Val Acc: 0.9519
 Best site-USPS                     (5)  | Epoch:31 | Val Acc: 0.8974
 Best site-USPS                     (3)  | Epoch:31 | Val Acc: 0.8761
 Best site-SynthDigits              (1)  | Epoch:31 | Val Acc: 0.8636
 Best site-SynthDigits              (9)  | Epoch:31 | Val Acc: 0.8939
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.7841
 Best site-MNIST_M                  (6)  | Epoch:31 | Val Acc: 0.8106
 Best site-SVHN                     (4)  | Epoch:31 | Val Acc: 0.6918
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 32 ============
cnt=[1, 1, 1, 1, 1, 2, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (8) | Train Loss: 0.2638 | Train Acc: 0.9200
 Site-MNIST                     (8) | Train Loss: 0.2133 | Train Acc: 0.9379
 Site-MNIST                     (8) | Train Loss: 0.2468 | Train Acc: 0.9231
 Site-MNIST                     (2) | Train Loss: 0.2508 | Train Acc: 0.9225
 Site-MNIST                     (7) | Train Loss: 0.2189 | Train Acc: 0.9431
 Site-USPS                      (5) | Train Loss: 0.2816 | Train Acc: 0.9137
 Site-USPS                      (1) | Train Loss: 0.2652 | Train Acc: 0.9233
 Site-USPS                      (5) | Train Loss: 0.2635 | Train Acc: 0.9276
 Site-SynthDigits               (3) | Train Loss: 0.4494 | Train Acc: 0.8769
 Site-SynthDigits               (9) | Train Loss: 0.3770 | Train Acc: 0.9141
 Site-MNIST_M                   (6) | Train Loss: 0.6408 | Train Acc: 0.8239
 Site-MNIST_M                   (0) | Train Loss: 0.6278 | Train Acc: 0.8144
 Site-SVHN                      (4) | Train Loss: 0.7969 | Train Acc: 0.7479
Average Train Accuracy: 0.8914
 Site-MNIST                     (8) | Val  Loss: 0.2016 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.1966 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.2287 | Val  Acc: 0.9365
 Site-MNIST                     (2) | Val  Loss: 0.2629 | Val  Acc: 0.9368
 Site-MNIST                     (7) | Val  Loss: 0.2229 | Val  Acc: 0.9368
 Site-USPS                      (5) | Val  Loss: 0.2108 | Val  Acc: 0.9519
 Site-USPS                      (1) | Val  Loss: 0.2588 | Val  Acc: 0.9038
 Site-USPS                      (5) | Val  Loss: 0.3099 | Val  Acc: 0.8846
 Site-SynthDigits               (3) | Val  Loss: 0.5101 | Val  Acc: 0.8712
 Site-SynthDigits               (9) | Val  Loss: 0.3342 | Val  Acc: 0.8939
 Site-MNIST_M                   (6) | Val  Loss: 0.6840 | Val  Acc: 0.7727
 Site-MNIST_M                   (0) | Val  Loss: 0.7190 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.8472 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8834
 Best site-MNIST                    (8)  | Epoch:32 | Val Acc: 0.9286
 Best site-MNIST                    (8)  | Epoch:32 | Val Acc: 0.9286
 Best site-MNIST                    (8)  | Epoch:32 | Val Acc: 0.9365
 Best site-MNIST                    (2)  | Epoch:32 | Val Acc: 0.9368
 Best site-MNIST                    (7)  | Epoch:32 | Val Acc: 0.9368
 Best site-USPS                     (5)  | Epoch:32 | Val Acc: 0.9519
 Best site-USPS                     (1)  | Epoch:32 | Val Acc: 0.9038
 Best site-USPS                     (5)  | Epoch:32 | Val Acc: 0.8846
 Best site-SynthDigits              (3)  | Epoch:32 | Val Acc: 0.8712
 Best site-SynthDigits              (9)  | Epoch:32 | Val Acc: 0.8939
 Best site-MNIST_M                  (6)  | Epoch:32 | Val Acc: 0.7727
 Best site-MNIST_M                  (0)  | Epoch:32 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:32 | Val Acc: 0.7123
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 33 ============
cnt=[1, 1, 1, 1, 1, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (7) | Train Loss: 0.2463 | Train Acc: 0.9289
 Site-MNIST                     (7) | Train Loss: 0.1963 | Train Acc: 0.9438
 Site-MNIST                     (7) | Train Loss: 0.2330 | Train Acc: 0.9270
 Site-MNIST                     (0) | Train Loss: 0.2401 | Train Acc: 0.9304
 Site-MNIST                     (7) | Train Loss: 0.2125 | Train Acc: 0.9431
 Site-USPS                      (3) | Train Loss: 0.2861 | Train Acc: 0.9161
 Site-USPS                      (5) | Train Loss: 0.2641 | Train Acc: 0.9329
 Site-USPS                      (8) | Train Loss: 0.2603 | Train Acc: 0.9276
 Site-SynthDigits               (6) | Train Loss: 0.4275 | Train Acc: 0.8712
 Site-SynthDigits               (1) | Train Loss: 0.3779 | Train Acc: 0.9179
 Site-MNIST_M                   (9) | Train Loss: 0.6391 | Train Acc: 0.8182
 Site-MNIST_M                   (2) | Train Loss: 0.6294 | Train Acc: 0.8182
 Site-SVHN                      (4) | Train Loss: 0.8066 | Train Acc: 0.7598
Average Train Accuracy: 0.8950
 Site-MNIST                     (7) | Val  Loss: 0.1834 | Val  Acc: 0.9286
 Site-MNIST                     (7) | Val  Loss: 0.1813 | Val  Acc: 0.9286
 Site-MNIST                     (7) | Val  Loss: 0.2230 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2538 | Val  Acc: 0.9474
 Site-MNIST                     (7) | Val  Loss: 0.2114 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2008 | Val  Acc: 0.9519
 Site-USPS                      (5) | Val  Loss: 0.2550 | Val  Acc: 0.9103
 Site-USPS                      (8) | Val  Loss: 0.3097 | Val  Acc: 0.8846
 Site-SynthDigits               (6) | Val  Loss: 0.5065 | Val  Acc: 0.8561
 Site-SynthDigits               (1) | Val  Loss: 0.3347 | Val  Acc: 0.8990
 Site-MNIST_M                   (9) | Val  Loss: 0.6890 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.7118 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.8097 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8850
 Best site-MNIST                    (7)  | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                    (7)  | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                    (7)  | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9474
 Best site-MNIST                    (7)  | Epoch:33 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:33 | Val Acc: 0.9519
 Best site-USPS                     (5)  | Epoch:33 | Val Acc: 0.9103
 Best site-USPS                     (8)  | Epoch:33 | Val Acc: 0.8846
 Best site-SynthDigits              (6)  | Epoch:33 | Val Acc: 0.8561
 Best site-SynthDigits              (1)  | Epoch:33 | Val Acc: 0.8990
 Best site-MNIST_M                  (9)  | Epoch:33 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:33 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:33 | Val Acc: 0.7123
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 34 ============
cnt=[2, 1, 1, 2, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (6) | Train Loss: 0.2437 | Train Acc: 0.9244
 Site-MNIST                     (0) | Train Loss: 0.1854 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.2327 | Train Acc: 0.9310
 Site-MNIST                     (6) | Train Loss: 0.2399 | Train Acc: 0.9264
 Site-MNIST                     (8) | Train Loss: 0.2077 | Train Acc: 0.9483
 Site-USPS                      (3) | Train Loss: 0.2795 | Train Acc: 0.9137
 Site-USPS                      (9) | Train Loss: 0.2581 | Train Acc: 0.9265
 Site-USPS                      (3) | Train Loss: 0.2561 | Train Acc: 0.9212
 Site-SynthDigits               (4) | Train Loss: 0.4012 | Train Acc: 0.8845
 Site-SynthDigits               (7) | Train Loss: 0.3617 | Train Acc: 0.9167
 Site-MNIST_M                   (2) | Train Loss: 0.6012 | Train Acc: 0.8352
 Site-MNIST_M                   (5) | Train Loss: 0.6402 | Train Acc: 0.8125
 Site-SVHN                      (1) | Train Loss: 0.8439 | Train Acc: 0.7581
Average Train Accuracy: 0.8962
 Site-MNIST                     (6) | Val  Loss: 0.1808 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1823 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2226 | Val  Acc: 0.9444
 Site-MNIST                     (6) | Val  Loss: 0.2523 | Val  Acc: 0.9474
 Site-MNIST                     (8) | Val  Loss: 0.2100 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.2041 | Val  Acc: 0.9519
 Site-USPS                      (9) | Val  Loss: 0.2494 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.3023 | Val  Acc: 0.8846
 Site-SynthDigits               (4) | Val  Loss: 0.4871 | Val  Acc: 0.8712
 Site-SynthDigits               (7) | Val  Loss: 0.3191 | Val  Acc: 0.9091
 Site-MNIST_M                   (2) | Val  Loss: 0.6579 | Val  Acc: 0.7955
 Site-MNIST_M                   (5) | Val  Loss: 0.6844 | Val  Acc: 0.8258
 Site-SVHN                      (1) | Val  Loss: 0.8233 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8882
 Best site-MNIST                    (6)  | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9444
 Best site-MNIST                    (6)  | Epoch:34 | Val Acc: 0.9474
 Best site-MNIST                    (8)  | Epoch:34 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:34 | Val Acc: 0.9519
 Best site-USPS                     (9)  | Epoch:34 | Val Acc: 0.9103
 Best site-USPS                     (3)  | Epoch:34 | Val Acc: 0.8846
 Best site-SynthDigits              (4)  | Epoch:34 | Val Acc: 0.8712
 Best site-SynthDigits              (7)  | Epoch:34 | Val Acc: 0.9091
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.7955
 Best site-MNIST_M                  (5)  | Epoch:34 | Val Acc: 0.8258
 Best site-SVHN                     (1)  | Epoch:34 | Val Acc: 0.6986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 1, 1, 1, 1, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (5) | Train Loss: 0.2147 | Train Acc: 0.9289
 Site-MNIST                     (5) | Train Loss: 0.1736 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.2230 | Train Acc: 0.9329
 Site-MNIST                     (5) | Train Loss: 0.2322 | Train Acc: 0.9290
 Site-MNIST                     (0) | Train Loss: 0.2020 | Train Acc: 0.9483
 Site-USPS                      (6) | Train Loss: 0.2854 | Train Acc: 0.9089
 Site-USPS                      (3) | Train Loss: 0.2500 | Train Acc: 0.9345
 Site-USPS                      (7) | Train Loss: 0.2540 | Train Acc: 0.9276
 Site-SynthDigits               (1) | Train Loss: 0.4580 | Train Acc: 0.8731
 Site-SynthDigits               (8) | Train Loss: 0.3608 | Train Acc: 0.9192
 Site-MNIST_M                   (2) | Train Loss: 0.6250 | Train Acc: 0.8210
 Site-MNIST_M                   (9) | Train Loss: 0.6131 | Train Acc: 0.8409
 Site-SVHN                      (4) | Train Loss: 0.7564 | Train Acc: 0.7666
Average Train Accuracy: 0.8990
 Site-MNIST                     (5) | Val  Loss: 0.1697 | Val  Acc: 0.9464
 Site-MNIST                     (5) | Val  Loss: 0.1720 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2140 | Val  Acc: 0.9444
 Site-MNIST                     (5) | Val  Loss: 0.2465 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.2039 | Val  Acc: 0.9509
 Site-USPS                      (6) | Val  Loss: 0.1955 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2472 | Val  Acc: 0.9038
 Site-USPS                      (7) | Val  Loss: 0.3028 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.4893 | Val  Acc: 0.8712
 Site-SynthDigits               (8) | Val  Loss: 0.3182 | Val  Acc: 0.9040
 Site-MNIST_M                   (2) | Val  Loss: 0.6859 | Val  Acc: 0.7727
 Site-MNIST_M                   (9) | Val  Loss: 0.7037 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.7803 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8863
============ Train epoch 36 ============
cnt=[1, 1, 3, 1, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (2) | Train Loss: 0.2148 | Train Acc: 0.9378
 Site-MNIST                     (2) | Train Loss: 0.1713 | Train Acc: 0.9527
 Site-MNIST                     (2) | Train Loss: 0.2175 | Train Acc: 0.9329
 Site-MNIST                     (6) | Train Loss: 0.2256 | Train Acc: 0.9330
 Site-MNIST                     (6) | Train Loss: 0.1944 | Train Acc: 0.9510
 Site-USPS                      (1) | Train Loss: 0.2679 | Train Acc: 0.9161
 Site-USPS                      (8) | Train Loss: 0.2437 | Train Acc: 0.9345
 Site-USPS                      (5) | Train Loss: 0.2454 | Train Acc: 0.9297
 Site-SynthDigits               (7) | Train Loss: 0.3879 | Train Acc: 0.8826
 Site-SynthDigits               (3) | Train Loss: 0.3484 | Train Acc: 0.9179
 Site-MNIST_M                   (9) | Train Loss: 0.5932 | Train Acc: 0.8523
 Site-MNIST_M                   (0) | Train Loss: 0.6135 | Train Acc: 0.8333
 Site-SVHN                      (4) | Train Loss: 0.8032 | Train Acc: 0.7632
Average Train Accuracy: 0.9028
 Site-MNIST                     (2) | Val  Loss: 0.1619 | Val  Acc: 0.9464
 Site-MNIST                     (2) | Val  Loss: 0.1680 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2065 | Val  Acc: 0.9524
 Site-MNIST                     (6) | Val  Loss: 0.2396 | Val  Acc: 0.9421
 Site-MNIST                     (6) | Val  Loss: 0.1984 | Val  Acc: 0.9509
 Site-USPS                      (1) | Val  Loss: 0.1901 | Val  Acc: 0.9615
 Site-USPS                      (8) | Val  Loss: 0.2393 | Val  Acc: 0.9038
 Site-USPS                      (5) | Val  Loss: 0.2890 | Val  Acc: 0.8846
 Site-SynthDigits               (7) | Val  Loss: 0.4670 | Val  Acc: 0.8712
 Site-SynthDigits               (3) | Val  Loss: 0.3082 | Val  Acc: 0.9141
 Site-MNIST_M                   (9) | Val  Loss: 0.6637 | Val  Acc: 0.7955
 Site-MNIST_M                   (0) | Val  Loss: 0.6822 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.7818 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8920
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9464
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9524
 Best site-MNIST                    (6)  | Epoch:36 | Val Acc: 0.9421
 Best site-MNIST                    (6)  | Epoch:36 | Val Acc: 0.9509
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.9615
 Best site-USPS                     (8)  | Epoch:36 | Val Acc: 0.9038
 Best site-USPS                     (5)  | Epoch:36 | Val Acc: 0.8846
 Best site-SynthDigits              (7)  | Epoch:36 | Val Acc: 0.8712
 Best site-SynthDigits              (3)  | Epoch:36 | Val Acc: 0.9141
 Best site-MNIST_M                  (9)  | Epoch:36 | Val Acc: 0.7955
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.8182
 Best site-SVHN                     (4)  | Epoch:36 | Val Acc: 0.7260
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 1, 1, 3, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.2207 | Train Acc: 0.9378
 Site-MNIST                     (3) | Train Loss: 0.1878 | Train Acc: 0.9586
 Site-MNIST                     (8) | Train Loss: 0.2143 | Train Acc: 0.9349
 Site-MNIST                     (3) | Train Loss: 0.2233 | Train Acc: 0.9330
 Site-MNIST                     (7) | Train Loss: 0.1921 | Train Acc: 0.9501
 Site-USPS                      (0) | Train Loss: 0.2691 | Train Acc: 0.9137
 Site-USPS                      (9) | Train Loss: 0.2445 | Train Acc: 0.9313
 Site-USPS                      (0) | Train Loss: 0.2413 | Train Acc: 0.9286
 Site-SynthDigits               (6) | Train Loss: 0.3985 | Train Acc: 0.8883
 Site-SynthDigits               (2) | Train Loss: 0.3438 | Train Acc: 0.9230
 Site-MNIST_M                   (1) | Train Loss: 0.5884 | Train Acc: 0.8580
 Site-MNIST_M                   (5) | Train Loss: 0.6072 | Train Acc: 0.8428
 Site-SVHN                      (4) | Train Loss: 0.7596 | Train Acc: 0.7700
Average Train Accuracy: 0.9054
 Site-MNIST                     (3) | Val  Loss: 0.1598 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1673 | Val  Acc: 0.9405
 Site-MNIST                     (8) | Val  Loss: 0.2027 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2341 | Val  Acc: 0.9368
 Site-MNIST                     (7) | Val  Loss: 0.1955 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1858 | Val  Acc: 0.9615
 Site-USPS                      (9) | Val  Loss: 0.2340 | Val  Acc: 0.9038
 Site-USPS                      (0) | Val  Loss: 0.2815 | Val  Acc: 0.8846
 Site-SynthDigits               (6) | Val  Loss: 0.4712 | Val  Acc: 0.8712
 Site-SynthDigits               (2) | Val  Loss: 0.3069 | Val  Acc: 0.9192
 Site-MNIST_M                   (1) | Val  Loss: 0.6697 | Val  Acc: 0.7841
 Site-MNIST_M                   (5) | Val  Loss: 0.6707 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.7619 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8967
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9405
 Best site-MNIST                    (8)  | Epoch:37 | Val Acc: 0.9524
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9368
 Best site-MNIST                    (7)  | Epoch:37 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9615
 Best site-USPS                     (9)  | Epoch:37 | Val Acc: 0.9038
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.8846
 Best site-SynthDigits              (6)  | Epoch:37 | Val Acc: 0.8712
 Best site-SynthDigits              (2)  | Epoch:37 | Val Acc: 0.9192
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.7841
 Best site-MNIST_M                  (5)  | Epoch:37 | Val Acc: 0.8409
 Best site-SVHN                     (4)  | Epoch:37 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 38 ============
cnt=[1, 1, 1, 2, 1, 1, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (8) | Train Loss: 0.1974 | Train Acc: 0.9467
 Site-MNIST                     (8) | Train Loss: 0.1672 | Train Acc: 0.9527
 Site-MNIST                     (8) | Train Loss: 0.2098 | Train Acc: 0.9349
 Site-MNIST                     (9) | Train Loss: 0.2190 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.1871 | Train Acc: 0.9510
 Site-USPS                      (7) | Train Loss: 0.2479 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2424 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2314 | Train Acc: 0.9286
 Site-SynthDigits               (2) | Train Loss: 0.3965 | Train Acc: 0.8883
 Site-SynthDigits               (5) | Train Loss: 0.3403 | Train Acc: 0.9154
 Site-MNIST_M                   (6) | Train Loss: 0.5839 | Train Acc: 0.8466
 Site-MNIST_M                   (0) | Train Loss: 0.5724 | Train Acc: 0.8314
 Site-SVHN                      (4) | Train Loss: 0.7262 | Train Acc: 0.7632
Average Train Accuracy: 0.9031
 Site-MNIST                     (8) | Val  Loss: 0.1614 | Val  Acc: 0.9643
 Site-MNIST                     (8) | Val  Loss: 0.1695 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.1991 | Val  Acc: 0.9524
 Site-MNIST                     (9) | Val  Loss: 0.2321 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1940 | Val  Acc: 0.9509
 Site-USPS                      (7) | Val  Loss: 0.1858 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2339 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.2772 | Val  Acc: 0.8846
 Site-SynthDigits               (2) | Val  Loss: 0.4468 | Val  Acc: 0.8788
 Site-SynthDigits               (5) | Val  Loss: 0.2989 | Val  Acc: 0.9091
 Site-MNIST_M                   (6) | Val  Loss: 0.6573 | Val  Acc: 0.8068
 Site-MNIST_M                   (0) | Val  Loss: 0.6609 | Val  Acc: 0.8333
 Site-SVHN                      (4) | Val  Loss: 0.7484 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8941
============ Train epoch 39 ============
cnt=[1, 2, 1, 2, 1, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (7) | Train Loss: 0.1946 | Train Acc: 0.9467
 Site-MNIST                     (5) | Train Loss: 0.1964 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.2060 | Train Acc: 0.9389
 Site-MNIST                     (7) | Train Loss: 0.2174 | Train Acc: 0.9330
 Site-MNIST                     (1) | Train Loss: 0.1830 | Train Acc: 0.9510
 Site-USPS                      (3) | Train Loss: 0.2515 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2350 | Train Acc: 0.9409
 Site-USPS                      (9) | Train Loss: 0.2299 | Train Acc: 0.9340
 Site-SynthDigits               (8) | Train Loss: 0.3757 | Train Acc: 0.8883
 Site-SynthDigits               (0) | Train Loss: 0.3410 | Train Acc: 0.9242
 Site-MNIST_M                   (6) | Train Loss: 0.5866 | Train Acc: 0.8324
 Site-MNIST_M                   (2) | Train Loss: 0.5826 | Train Acc: 0.8466
 Site-SVHN                      (4) | Train Loss: 0.6952 | Train Acc: 0.7717
Average Train Accuracy: 0.9065
 Site-MNIST                     (7) | Val  Loss: 0.1561 | Val  Acc: 0.9643
 Site-MNIST                     (5) | Val  Loss: 0.1640 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1974 | Val  Acc: 0.9524
 Site-MNIST                     (7) | Val  Loss: 0.2280 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1893 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1794 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2276 | Val  Acc: 0.9167
 Site-USPS                      (9) | Val  Loss: 0.2739 | Val  Acc: 0.8889
 Site-SynthDigits               (8) | Val  Loss: 0.4469 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 0.2933 | Val  Acc: 0.9192
 Site-MNIST_M                   (6) | Val  Loss: 0.6508 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6545 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7401 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8990
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 0.9643
 Best site-MNIST                    (5)  | Epoch:39 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9524
 Best site-MNIST                    (7)  | Epoch:39 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.9167
 Best site-USPS                     (9)  | Epoch:39 | Val Acc: 0.8889
 Best site-SynthDigits              (8)  | Epoch:39 | Val Acc: 0.8788
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.9192
 Best site-MNIST_M                  (6)  | Epoch:39 | Val Acc: 0.7955
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:39 | Val Acc: 0.7260
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 1, 3, 1, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (2) | Train Loss: 0.2042 | Train Acc: 0.9422
 Site-MNIST                     (9) | Train Loss: 0.1916 | Train Acc: 0.9586
 Site-MNIST                     (2) | Train Loss: 0.2046 | Train Acc: 0.9369
 Site-MNIST                     (7) | Train Loss: 0.2136 | Train Acc: 0.9330
 Site-MNIST                     (2) | Train Loss: 0.1817 | Train Acc: 0.9518
 Site-USPS                      (0) | Train Loss: 0.2535 | Train Acc: 0.9185
 Site-USPS                      (8) | Train Loss: 0.2290 | Train Acc: 0.9393
 Site-USPS                      (0) | Train Loss: 0.2264 | Train Acc: 0.9361
 Site-SynthDigits               (6) | Train Loss: 0.3851 | Train Acc: 0.8939
 Site-SynthDigits               (3) | Train Loss: 0.3360 | Train Acc: 0.9280
 Site-MNIST_M                   (5) | Train Loss: 0.5807 | Train Acc: 0.8409
 Site-MNIST_M                   (1) | Train Loss: 0.5878 | Train Acc: 0.8428
 Site-SVHN                      (4) | Train Loss: 0.7143 | Train Acc: 0.7768
Average Train Accuracy: 0.9076
 Site-MNIST                     (2) | Val  Loss: 0.1567 | Val  Acc: 0.9643
 Site-MNIST                     (9) | Val  Loss: 0.1650 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.1950 | Val  Acc: 0.9524
 Site-MNIST                     (7) | Val  Loss: 0.2260 | Val  Acc: 0.9368
 Site-MNIST                     (2) | Val  Loss: 0.1876 | Val  Acc: 0.9544
 Site-USPS                      (0) | Val  Loss: 0.1771 | Val  Acc: 0.9519
 Site-USPS                      (8) | Val  Loss: 0.2238 | Val  Acc: 0.9103
 Site-USPS                      (0) | Val  Loss: 0.2663 | Val  Acc: 0.8803
 Site-SynthDigits               (6) | Val  Loss: 0.4411 | Val  Acc: 0.8788
 Site-SynthDigits               (3) | Val  Loss: 0.2819 | Val  Acc: 0.9192
 Site-MNIST_M                   (5) | Val  Loss: 0.6249 | Val  Acc: 0.8295
 Site-MNIST_M                   (1) | Val  Loss: 0.6463 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7371 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9012
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9643
 Best site-MNIST                    (9)  | Epoch:40 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9524
 Best site-MNIST                    (7)  | Epoch:40 | Val Acc: 0.9368
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9544
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.9519
 Best site-USPS                     (8)  | Epoch:40 | Val Acc: 0.9103
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.8803
 Best site-SynthDigits              (6)  | Epoch:40 | Val Acc: 0.8788
 Best site-SynthDigits              (3)  | Epoch:40 | Val Acc: 0.9192
 Best site-MNIST_M                  (5)  | Epoch:40 | Val Acc: 0.8295
 Best site-MNIST_M                  (1)  | Epoch:40 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:40 | Val Acc: 0.7534
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 41 ============
cnt=[1, 4, 1, 1, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.2107 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.1850 | Train Acc: 0.9556
 Site-MNIST                     (8) | Train Loss: 0.1995 | Train Acc: 0.9408
 Site-MNIST                     (1) | Train Loss: 0.2092 | Train Acc: 0.9369
 Site-MNIST                     (1) | Train Loss: 0.1763 | Train Acc: 0.9518
 Site-USPS                      (0) | Train Loss: 0.2405 | Train Acc: 0.9161
 Site-USPS                      (9) | Train Loss: 0.2249 | Train Acc: 0.9377
 Site-USPS                      (6) | Train Loss: 0.2253 | Train Acc: 0.9361
 Site-SynthDigits               (2) | Train Loss: 0.3933 | Train Acc: 0.8807
 Site-SynthDigits               (7) | Train Loss: 0.3222 | Train Acc: 0.9293
 Site-MNIST_M                   (5) | Train Loss: 0.5682 | Train Acc: 0.8466
 Site-MNIST_M                   (3) | Train Loss: 0.5559 | Train Acc: 0.8428
 Site-SVHN                      (4) | Train Loss: 0.7084 | Train Acc: 0.7922
Average Train Accuracy: 0.9087
 Site-MNIST                     (1) | Val  Loss: 0.1519 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1604 | Val  Acc: 0.9405
 Site-MNIST                     (8) | Val  Loss: 0.1900 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2225 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1834 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1730 | Val  Acc: 0.9519
 Site-USPS                      (9) | Val  Loss: 0.2228 | Val  Acc: 0.9103
 Site-USPS                      (6) | Val  Loss: 0.2673 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4327 | Val  Acc: 0.8712
 Site-SynthDigits               (7) | Val  Loss: 0.2804 | Val  Acc: 0.9192
 Site-MNIST_M                   (5) | Val  Loss: 0.6191 | Val  Acc: 0.8295
 Site-MNIST_M                   (3) | Val  Loss: 0.6305 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7174 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9020
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9405
 Best site-MNIST                    (8)  | Epoch:41 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:41 | Val Acc: 0.9519
 Best site-USPS                     (9)  | Epoch:41 | Val Acc: 0.9103
 Best site-USPS                     (6)  | Epoch:41 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:41 | Val Acc: 0.8712
 Best site-SynthDigits              (7)  | Epoch:41 | Val Acc: 0.9192
 Best site-MNIST_M                  (5)  | Epoch:41 | Val Acc: 0.8295
 Best site-MNIST_M                  (3)  | Epoch:41 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:41 | Val Acc: 0.7534
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 42 ============
cnt=[1, 3, 1, 2, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (1) | Train Loss: 0.1913 | Train Acc: 0.9422
 Site-MNIST                     (1) | Train Loss: 0.1979 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.1987 | Train Acc: 0.9448
 Site-MNIST                     (9) | Train Loss: 0.2092 | Train Acc: 0.9356
 Site-MNIST                     (8) | Train Loss: 0.1754 | Train Acc: 0.9536
 Site-USPS                      (3) | Train Loss: 0.2550 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2254 | Train Acc: 0.9361
 Site-USPS                      (7) | Train Loss: 0.2228 | Train Acc: 0.9340
 Site-SynthDigits               (5) | Train Loss: 0.3630 | Train Acc: 0.8902
 Site-SynthDigits               (0) | Train Loss: 0.3086 | Train Acc: 0.9230
 Site-MNIST_M                   (2) | Train Loss: 0.5675 | Train Acc: 0.8608
 Site-MNIST_M                   (6) | Train Loss: 0.5653 | Train Acc: 0.8409
 Site-SVHN                      (4) | Train Loss: 0.7020 | Train Acc: 0.7853
Average Train Accuracy: 0.9093
 Site-MNIST                     (1) | Val  Loss: 0.1514 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1616 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1871 | Val  Acc: 0.9524
 Site-MNIST                     (9) | Val  Loss: 0.2212 | Val  Acc: 0.9368
 Site-MNIST                     (8) | Val  Loss: 0.1828 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1781 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2207 | Val  Acc: 0.9103
 Site-USPS                      (7) | Val  Loss: 0.2634 | Val  Acc: 0.8803
 Site-SynthDigits               (5) | Val  Loss: 0.4206 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 0.2727 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.6147 | Val  Acc: 0.8068
 Site-MNIST_M                   (6) | Val  Loss: 0.6278 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.7080 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8984
============ Train epoch 43 ============
cnt=[1, 1, 2, 2, 1, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (3) | Train Loss: 0.1813 | Train Acc: 0.9511
 Site-MNIST                     (6) | Train Loss: 0.1552 | Train Acc: 0.9527
 Site-MNIST                     (8) | Train Loss: 0.1960 | Train Acc: 0.9408
 Site-MNIST                     (3) | Train Loss: 0.2062 | Train Acc: 0.9382
 Site-MNIST                     (9) | Train Loss: 0.1731 | Train Acc: 0.9536
 Site-USPS                      (7) | Train Loss: 0.2462 | Train Acc: 0.9233
 Site-USPS                      (7) | Train Loss: 0.2183 | Train Acc: 0.9345
 Site-USPS                      (0) | Train Loss: 0.2214 | Train Acc: 0.9361
 Site-SynthDigits               (2) | Train Loss: 0.3722 | Train Acc: 0.8920
 Site-SynthDigits               (2) | Train Loss: 0.3251 | Train Acc: 0.9255
 Site-MNIST_M                   (5) | Train Loss: 0.5625 | Train Acc: 0.8580
 Site-MNIST_M                   (1) | Train Loss: 0.5549 | Train Acc: 0.8504
 Site-SVHN                      (4) | Train Loss: 0.7064 | Train Acc: 0.7922
Average Train Accuracy: 0.9114
 Site-MNIST                     (3) | Val  Loss: 0.1503 | Val  Acc: 0.9643
 Site-MNIST                     (6) | Val  Loss: 0.1614 | Val  Acc: 0.9286
 Site-MNIST                     (8) | Val  Loss: 0.1869 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2187 | Val  Acc: 0.9368
 Site-MNIST                     (9) | Val  Loss: 0.1802 | Val  Acc: 0.9509
 Site-USPS                      (7) | Val  Loss: 0.1695 | Val  Acc: 0.9615
 Site-USPS                      (7) | Val  Loss: 0.2133 | Val  Acc: 0.9103
 Site-USPS                      (0) | Val  Loss: 0.2523 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4243 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 0.2718 | Val  Acc: 0.9192
 Site-MNIST_M                   (5) | Val  Loss: 0.6187 | Val  Acc: 0.8182
 Site-MNIST_M                   (1) | Val  Loss: 0.6311 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.6943 | Val  Acc: 0.7603
Average Valid Accuracy: 0.8997
============ Train epoch 44 ============
cnt=[2, 1, 1, 1, 1, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (6) | Train Loss: 0.1872 | Train Acc: 0.9511
 Site-MNIST                     (0) | Train Loss: 0.1663 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.1945 | Train Acc: 0.9389
 Site-MNIST                     (6) | Train Loss: 0.2039 | Train Acc: 0.9396
 Site-MNIST                     (6) | Train Loss: 0.1702 | Train Acc: 0.9527
 Site-USPS                      (3) | Train Loss: 0.2427 | Train Acc: 0.9257
 Site-USPS                      (9) | Train Loss: 0.2244 | Train Acc: 0.9393
 Site-USPS                      (8) | Train Loss: 0.2189 | Train Acc: 0.9361
 Site-SynthDigits               (1) | Train Loss: 0.3501 | Train Acc: 0.8864
 Site-SynthDigits               (7) | Train Loss: 0.3301 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.5282 | Train Acc: 0.8636
 Site-MNIST_M                   (5) | Train Loss: 0.5496 | Train Acc: 0.8390
 Site-SVHN                      (4) | Train Loss: 0.6971 | Train Acc: 0.7939
Average Train Accuracy: 0.9113
 Site-MNIST                     (6) | Val  Loss: 0.1497 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1603 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1852 | Val  Acc: 0.9524
 Site-MNIST                     (6) | Val  Loss: 0.2171 | Val  Acc: 0.9368
 Site-MNIST                     (6) | Val  Loss: 0.1787 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1716 | Val  Acc: 0.9615
 Site-USPS                      (9) | Val  Loss: 0.2124 | Val  Acc: 0.9103
 Site-USPS                      (8) | Val  Loss: 0.2513 | Val  Acc: 0.8974
 Site-SynthDigits               (1) | Val  Loss: 0.4172 | Val  Acc: 0.8788
 Site-SynthDigits               (7) | Val  Loss: 0.2693 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.6017 | Val  Acc: 0.8182
 Site-MNIST_M                   (5) | Val  Loss: 0.6163 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.6863 | Val  Acc: 0.7397
Average Valid Accuracy: 0.8999
============ Train epoch 45 ============
cnt=[1, 4, 1, 1, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (1) | Train Loss: 0.2160 | Train Acc: 0.9422
 Site-MNIST                     (1) | Train Loss: 0.1794 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.1943 | Train Acc: 0.9448
 Site-MNIST                     (7) | Train Loss: 0.2044 | Train Acc: 0.9343
 Site-MNIST                     (1) | Train Loss: 0.1724 | Train Acc: 0.9527
 Site-USPS                      (9) | Train Loss: 0.2246 | Train Acc: 0.9209
 Site-USPS                      (5) | Train Loss: 0.2155 | Train Acc: 0.9361
 Site-USPS                      (3) | Train Loss: 0.2104 | Train Acc: 0.9414
 Site-SynthDigits               (8) | Train Loss: 0.3651 | Train Acc: 0.8864
 Site-SynthDigits               (4) | Train Loss: 0.3005 | Train Acc: 0.9318
 Site-MNIST_M                   (2) | Train Loss: 0.5503 | Train Acc: 0.8551
 Site-MNIST_M                   (6) | Train Loss: 0.5093 | Train Acc: 0.8561
 Site-SVHN                      (0) | Train Loss: 0.6578 | Train Acc: 0.8024
Average Train Accuracy: 0.9121
 Site-MNIST                     (1) | Val  Loss: 0.1531 | Val  Acc: 0.9821
 Site-MNIST                     (1) | Val  Loss: 0.1618 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.1843 | Val  Acc: 0.9524
 Site-MNIST                     (7) | Val  Loss: 0.2173 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1790 | Val  Acc: 0.9474
 Site-USPS                      (9) | Val  Loss: 0.1680 | Val  Acc: 0.9519
 Site-USPS                      (5) | Val  Loss: 0.2110 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.2439 | Val  Acc: 0.8889
 Site-SynthDigits               (8) | Val  Loss: 0.4110 | Val  Acc: 0.8712
 Site-SynthDigits               (4) | Val  Loss: 0.2615 | Val  Acc: 0.9293
 Site-MNIST_M                   (2) | Val  Loss: 0.6046 | Val  Acc: 0.8182
 Site-MNIST_M                   (6) | Val  Loss: 0.6257 | Val  Acc: 0.8561
 Site-SVHN                      (0) | Val  Loss: 0.6791 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9011
 Test site-MNIST                     (1)| Epoch:41 | Test Acc: 0.9374
 Test site-USPS                      (9)| Epoch:41 | Test Acc: 0.9462
 Test site-SynthDigits               (8)| Epoch:41 | Test Acc: 0.8990
 Test site-MNIST_M                   (2)| Epoch:41 | Test Acc: 0.7517
 Test site-SVHN                      (0)| Epoch:41 | Test Acc: 0.7034
MNIST: 0.9374, USPS: 0.9462, SynthDigits: 0.8990, MNIST_M: 0.7517, SVHN: 0.7034, 
Average Test Accuracy(group): 0.8476, Average Test Accuracy(individual): 0.8870,
domain std=0.1004, cluster std=0.0916, individual std=0.0850, 
Average Test Accuracy: 0.8476
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 1, 1, 4, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (3) | Train Loss: 0.1898 | Train Acc: 0.9467
 Site-MNIST                     (3) | Train Loss: 0.1564 | Train Acc: 0.9527
 Site-MNIST                     (7) | Train Loss: 0.1916 | Train Acc: 0.9448
 Site-MNIST                     (3) | Train Loss: 0.2007 | Train Acc: 0.9356
 Site-MNIST                     (3) | Train Loss: 0.1696 | Train Acc: 0.9518
 Site-USPS                      (8) | Train Loss: 0.2179 | Train Acc: 0.9209
 Site-USPS                      (6) | Train Loss: 0.2110 | Train Acc: 0.9345
 Site-USPS                      (1) | Train Loss: 0.2144 | Train Acc: 0.9382
 Site-SynthDigits               (2) | Train Loss: 0.3373 | Train Acc: 0.8939
 Site-SynthDigits               (9) | Train Loss: 0.3063 | Train Acc: 0.9280
 Site-MNIST_M                   (5) | Train Loss: 0.5235 | Train Acc: 0.8636
 Site-MNIST_M                   (0) | Train Loss: 0.5383 | Train Acc: 0.8542
 Site-SVHN                      (4) | Train Loss: 0.6729 | Train Acc: 0.7956
Average Train Accuracy: 0.9123
 Site-MNIST                     (3) | Val  Loss: 0.1454 | Val  Acc: 0.9821
 Site-MNIST                     (3) | Val  Loss: 0.1585 | Val  Acc: 0.9405
 Site-MNIST                     (7) | Val  Loss: 0.1850 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2156 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1776 | Val  Acc: 0.9474
 Site-USPS                      (8) | Val  Loss: 0.1613 | Val  Acc: 0.9615
 Site-USPS                      (6) | Val  Loss: 0.2036 | Val  Acc: 0.9103
 Site-USPS                      (1) | Val  Loss: 0.2353 | Val  Acc: 0.8974
 Site-SynthDigits               (2) | Val  Loss: 0.4263 | Val  Acc: 0.8788
 Site-SynthDigits               (9) | Val  Loss: 0.2613 | Val  Acc: 0.9242
 Site-MNIST_M                   (5) | Val  Loss: 0.5819 | Val  Acc: 0.8182
 Site-MNIST_M                   (0) | Val  Loss: 0.6079 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.6822 | Val  Acc: 0.7603
Average Valid Accuracy: 0.9039
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9821
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9405
 Best site-MNIST                    (7)  | Epoch:46 | Val Acc: 0.9524
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9368
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9474
 Best site-USPS                     (8)  | Epoch:46 | Val Acc: 0.9615
 Best site-USPS                     (6)  | Epoch:46 | Val Acc: 0.9103
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.8974
 Best site-SynthDigits              (2)  | Epoch:46 | Val Acc: 0.8788
 Best site-SynthDigits              (9)  | Epoch:46 | Val Acc: 0.9242
 Best site-MNIST_M                  (5)  | Epoch:46 | Val Acc: 0.8182
 Best site-MNIST_M                  (0)  | Epoch:46 | Val Acc: 0.8409
 Best site-SVHN                     (4)  | Epoch:46 | Val Acc: 0.7603
 Test site-MNIST                     (3)| Epoch:46 | Test Acc: 0.9376
 Test site-USPS                      (8)| Epoch:46 | Test Acc: 0.9495
 Test site-SynthDigits               (2)| Epoch:46 | Test Acc: 0.8967
 Test site-MNIST_M                   (5)| Epoch:46 | Test Acc: 0.7534
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.7023
MNIST: 0.9376, USPS: 0.9495, SynthDigits: 0.8967, MNIST_M: 0.7534, SVHN: 0.7023, 
Average Test Accuracy(group): 0.8479, Average Test Accuracy(individual): 0.8876,
domain std=0.1009, cluster std=0.0921, individual std=0.0852, 
Average Test Accuracy: 0.8479
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 1, 1, 2, 1, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (6) | Train Loss: 0.1870 | Train Acc: 0.9467
 Site-MNIST                     (6) | Train Loss: 0.1499 | Train Acc: 0.9497
 Site-MNIST                     (1) | Train Loss: 0.1879 | Train Acc: 0.9408
 Site-MNIST                     (8) | Train Loss: 0.1991 | Train Acc: 0.9396
 Site-MNIST                     (6) | Train Loss: 0.1690 | Train Acc: 0.9536
 Site-USPS                      (9) | Train Loss: 0.2182 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2149 | Train Acc: 0.9329
 Site-USPS                      (3) | Train Loss: 0.2130 | Train Acc: 0.9404
 Site-SynthDigits               (2) | Train Loss: 0.3413 | Train Acc: 0.9015
 Site-SynthDigits               (7) | Train Loss: 0.3081 | Train Acc: 0.9230
 Site-MNIST_M                   (0) | Train Loss: 0.5324 | Train Acc: 0.8636
 Site-MNIST_M                   (5) | Train Loss: 0.5206 | Train Acc: 0.8466
 Site-SVHN                      (4) | Train Loss: 0.6319 | Train Acc: 0.7939
Average Train Accuracy: 0.9118
 Site-MNIST                     (6) | Val  Loss: 0.1388 | Val  Acc: 0.9821
 Site-MNIST                     (6) | Val  Loss: 0.1525 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1868 | Val  Acc: 0.9524
 Site-MNIST                     (8) | Val  Loss: 0.2146 | Val  Acc: 0.9368
 Site-MNIST                     (6) | Val  Loss: 0.1754 | Val  Acc: 0.9509
 Site-USPS                      (9) | Val  Loss: 0.1668 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2015 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2356 | Val  Acc: 0.8974
 Site-SynthDigits               (2) | Val  Loss: 0.4363 | Val  Acc: 0.8788
 Site-SynthDigits               (7) | Val  Loss: 0.2580 | Val  Acc: 0.9444
 Site-MNIST_M                   (0) | Val  Loss: 0.5967 | Val  Acc: 0.8182
 Site-MNIST_M                   (5) | Val  Loss: 0.6204 | Val  Acc: 0.8333
 Site-SVHN                      (4) | Val  Loss: 0.6713 | Val  Acc: 0.7671
Average Valid Accuracy: 0.9057
 Best site-MNIST                    (6)  | Epoch:47 | Val Acc: 0.9821
 Best site-MNIST                    (6)  | Epoch:47 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:47 | Val Acc: 0.9524
 Best site-MNIST                    (8)  | Epoch:47 | Val Acc: 0.9368
 Best site-MNIST                    (6)  | Epoch:47 | Val Acc: 0.9509
 Best site-USPS                     (9)  | Epoch:47 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:47 | Val Acc: 0.9103
 Best site-USPS                     (3)  | Epoch:47 | Val Acc: 0.8974
 Best site-SynthDigits              (2)  | Epoch:47 | Val Acc: 0.8788
 Best site-SynthDigits              (7)  | Epoch:47 | Val Acc: 0.9444
 Best site-MNIST_M                  (0)  | Epoch:47 | Val Acc: 0.8182
 Best site-MNIST_M                  (5)  | Epoch:47 | Val Acc: 0.8333
 Best site-SVHN                     (4)  | Epoch:47 | Val Acc: 0.7671
 Test site-MNIST                     (6)| Epoch:47 | Test Acc: 0.9383
 Test site-USPS                      (9)| Epoch:47 | Test Acc: 0.9505
 Test site-SynthDigits               (2)| Epoch:47 | Test Acc: 0.8978
 Test site-MNIST_M                   (0)| Epoch:47 | Test Acc: 0.7521
 Test site-SVHN                      (4)| Epoch:47 | Test Acc: 0.7065
MNIST: 0.9383, USPS: 0.9505, SynthDigits: 0.8978, MNIST_M: 0.7521, SVHN: 0.7065, 
Average Test Accuracy(group): 0.8491, Average Test Accuracy(individual): 0.8884,
domain std=0.1003, cluster std=0.0911, individual std=0.0852, 
Average Test Accuracy: 0.8491
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 48 ============
cnt=[1, 1, 3, 1, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (2) | Train Loss: 0.1975 | Train Acc: 0.9467
 Site-MNIST                     (2) | Train Loss: 0.1523 | Train Acc: 0.9497
 Site-MNIST                     (9) | Train Loss: 0.1857 | Train Acc: 0.9428
 Site-MNIST                     (2) | Train Loss: 0.1954 | Train Acc: 0.9422
 Site-MNIST                     (7) | Train Loss: 0.1640 | Train Acc: 0.9536
 Site-USPS                      (1) | Train Loss: 0.2195 | Train Acc: 0.9233
 Site-USPS                      (6) | Train Loss: 0.2129 | Train Acc: 0.9361
 Site-USPS                      (6) | Train Loss: 0.1985 | Train Acc: 0.9457
 Site-SynthDigits               (8) | Train Loss: 0.3629 | Train Acc: 0.9034
 Site-SynthDigits               (3) | Train Loss: 0.2952 | Train Acc: 0.9280
 Site-MNIST_M                   (0) | Train Loss: 0.5163 | Train Acc: 0.8750
 Site-MNIST_M                   (5) | Train Loss: 0.4968 | Train Acc: 0.8447
 Site-SVHN                      (4) | Train Loss: 0.6467 | Train Acc: 0.7990
Average Train Accuracy: 0.9146
 Site-MNIST                     (2) | Val  Loss: 0.1356 | Val  Acc: 0.9821
 Site-MNIST                     (2) | Val  Loss: 0.1496 | Val  Acc: 0.9405
 Site-MNIST                     (9) | Val  Loss: 0.1806 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.2105 | Val  Acc: 0.9368
 Site-MNIST                     (7) | Val  Loss: 0.1726 | Val  Acc: 0.9509
 Site-USPS                      (1) | Val  Loss: 0.1574 | Val  Acc: 0.9615
 Site-USPS                      (6) | Val  Loss: 0.2006 | Val  Acc: 0.9231
 Site-USPS                      (6) | Val  Loss: 0.2310 | Val  Acc: 0.8974
 Site-SynthDigits               (8) | Val  Loss: 0.3987 | Val  Acc: 0.8864
 Site-SynthDigits               (3) | Val  Loss: 0.2482 | Val  Acc: 0.9242
 Site-MNIST_M                   (0) | Val  Loss: 0.5759 | Val  Acc: 0.8295
 Site-MNIST_M                   (5) | Val  Loss: 0.6142 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.6552 | Val  Acc: 0.7740
Average Valid Accuracy: 0.9088
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 0.9821
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 0.9405
 Best site-MNIST                    (9)  | Epoch:48 | Val Acc: 0.9524
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 0.9368
 Best site-MNIST                    (7)  | Epoch:48 | Val Acc: 0.9509
 Best site-USPS                     (1)  | Epoch:48 | Val Acc: 0.9615
 Best site-USPS                     (6)  | Epoch:48 | Val Acc: 0.9231
 Best site-USPS                     (6)  | Epoch:48 | Val Acc: 0.8974
 Best site-SynthDigits              (8)  | Epoch:48 | Val Acc: 0.8864
 Best site-SynthDigits              (3)  | Epoch:48 | Val Acc: 0.9242
 Best site-MNIST_M                  (0)  | Epoch:48 | Val Acc: 0.8295
 Best site-MNIST_M                  (5)  | Epoch:48 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:48 | Val Acc: 0.7740
 Test site-MNIST                     (2)| Epoch:48 | Test Acc: 0.9400
 Test site-USPS                      (1)| Epoch:48 | Test Acc: 0.9473
 Test site-SynthDigits               (8)| Epoch:48 | Test Acc: 0.9004
 Test site-MNIST_M                   (0)| Epoch:48 | Test Acc: 0.7524
 Test site-SVHN                      (4)| Epoch:48 | Test Acc: 0.7049
MNIST: 0.9400, USPS: 0.9473, SynthDigits: 0.9004, MNIST_M: 0.7524, SVHN: 0.7049, 
Average Test Accuracy(group): 0.8490, Average Test Accuracy(individual): 0.8887,
domain std=0.1007, cluster std=0.0913, individual std=0.0853, 
Average Test Accuracy: 0.8490
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 1, 1, 1, 1, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (0) | Train Loss: 0.1761 | Train Acc: 0.9511
 Site-MNIST                     (5) | Train Loss: 0.1530 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1824 | Train Acc: 0.9487
 Site-MNIST                     (5) | Train Loss: 0.1925 | Train Acc: 0.9396
 Site-MNIST                     (5) | Train Loss: 0.1602 | Train Acc: 0.9536
 Site-USPS                      (8) | Train Loss: 0.2236 | Train Acc: 0.9305
 Site-USPS                      (3) | Train Loss: 0.2040 | Train Acc: 0.9377
 Site-USPS                      (9) | Train Loss: 0.2001 | Train Acc: 0.9468
 Site-SynthDigits               (7) | Train Loss: 0.3879 | Train Acc: 0.9053
 Site-SynthDigits               (4) | Train Loss: 0.2942 | Train Acc: 0.9293
 Site-MNIST_M                   (2) | Train Loss: 0.4943 | Train Acc: 0.8665
 Site-MNIST_M                   (6) | Train Loss: 0.5237 | Train Acc: 0.8504
 Site-SVHN                      (1) | Train Loss: 0.6517 | Train Acc: 0.8041
Average Train Accuracy: 0.9168
 Site-MNIST                     (0) | Val  Loss: 0.1353 | Val  Acc: 0.9643
 Site-MNIST                     (5) | Val  Loss: 0.1494 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1780 | Val  Acc: 0.9524
 Site-MNIST                     (5) | Val  Loss: 0.2073 | Val  Acc: 0.9368
 Site-MNIST                     (5) | Val  Loss: 0.1700 | Val  Acc: 0.9509
 Site-USPS                      (8) | Val  Loss: 0.1508 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2003 | Val  Acc: 0.9167
 Site-USPS                      (9) | Val  Loss: 0.2277 | Val  Acc: 0.9017
 Site-SynthDigits               (7) | Val  Loss: 0.3897 | Val  Acc: 0.9015
 Site-SynthDigits               (4) | Val  Loss: 0.2436 | Val  Acc: 0.9444
 Site-MNIST_M                   (2) | Val  Loss: 0.5558 | Val  Acc: 0.8523
 Site-MNIST_M                   (6) | Val  Loss: 0.6009 | Val  Acc: 0.8485
 Site-SVHN                      (1) | Val  Loss: 0.6484 | Val  Acc: 0.7877
Average Valid Accuracy: 0.9122
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9643
 Best site-MNIST                    (5)  | Epoch:49 | Val Acc: 0.9405
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9524
 Best site-MNIST                    (5)  | Epoch:49 | Val Acc: 0.9368
 Best site-MNIST                    (5)  | Epoch:49 | Val Acc: 0.9509
 Best site-USPS                     (8)  | Epoch:49 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.9167
 Best site-USPS                     (9)  | Epoch:49 | Val Acc: 0.9017
 Best site-SynthDigits              (7)  | Epoch:49 | Val Acc: 0.9015
 Best site-SynthDigits              (4)  | Epoch:49 | Val Acc: 0.9444
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8523
 Best site-MNIST_M                  (6)  | Epoch:49 | Val Acc: 0.8485
 Best site-SVHN                     (1)  | Epoch:49 | Val Acc: 0.7877
 Test site-MNIST                     (0)| Epoch:49 | Test Acc: 0.9391
 Test site-USPS                      (8)| Epoch:49 | Test Acc: 0.9473
 Test site-SynthDigits               (7)| Epoch:49 | Test Acc: 0.9003
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7549
 Test site-SVHN                      (1)| Epoch:49 | Test Acc: 0.7067
MNIST: 0.9391, USPS: 0.9473, SynthDigits: 0.9003, MNIST_M: 0.7549, SVHN: 0.7067, 
Average Test Accuracy(group): 0.8497, Average Test Accuracy(individual): 0.8888,
domain std=0.0995, cluster std=0.0908, individual std=0.0842, 
Average Test Accuracy: 0.8497
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_10/ccop_q=1...
===2023-08-13 03:31:01===
===2023-08-13 03:31:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 10
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 10
Loading snapshots...
 Test site-MNIST                     (0)| Epoch:49 | Test Acc: 0.9391
 Test site-USPS                      (8)| Epoch:49 | Test Acc: 0.9473
 Test site-SynthDigits               (7)| Epoch:49 | Test Acc: 0.9003
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7549
 Test site-SVHN                      (1)| Epoch:49 | Test Acc: 0.7067
MNIST: 0.9391, USPS: 0.9473, SynthDigits: 0.9003, MNIST_M: 0.7549, SVHN: 0.7067, 
Average Test Accuracy(group): 0.8497, Average Test Accuracy(individual): 0.8888,
domain std=0.0995, cluster std=0.0908, individual std=0.0842, 
