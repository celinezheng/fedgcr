===2023-07-30 05:06:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.1361 | Train Acc: 0.4555
 Site-MNIST                         | Train Loss: 2.1482 | Train Acc: 0.4475
 Site-USPS                          | Train Loss: 2.1048 | Train Acc: 0.4582
 Site-USPS                          | Train Loss: 2.1017 | Train Acc: 0.4852
 Site-SynthDigits                   | Train Loss: 2.2523 | Train Acc: 0.2049
 Site-SynthDigits                   | Train Loss: 2.2339 | Train Acc: 0.2628
 Site-MNIST_M                       | Train Loss: 2.2656 | Train Acc: 0.2075
 Site-MNIST_M                       | Train Loss: 2.2754 | Train Acc: 0.1587
 Site-SVHN                          | Train Loss: 2.2549 | Train Acc: 0.2345
 Site-SVHN                          | Train Loss: 2.2504 | Train Acc: 0.2224
Average Train Accuracy: 0.3137
 Site-MNIST                         | Val  Loss: 2.1734 | Val  Acc: 0.3913
 Site-MNIST                         | Val  Loss: 2.1414 | Val  Acc: 0.4424
 Site-USPS                          | Val  Loss: 2.1197 | Val  Acc: 0.4130
 Site-USPS                          | Val  Loss: 2.1203 | Val  Acc: 0.3921
 Site-SynthDigits                   | Val  Loss: 2.2273 | Val  Acc: 0.2609
 Site-SynthDigits                   | Val  Loss: 2.2432 | Val  Acc: 0.2410
 Site-MNIST_M                       | Val  Loss: 2.2818 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2695 | Val  Acc: 0.1978
 Site-SVHN                          | Val  Loss: 2.2408 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2471 | Val  Acc: 0.2950
Average Valid Accuracy: 0.3134
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3913
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4424
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4130
 Best site-USPS                      | Epoch:0 | Val Acc: 0.3921
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2609
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2410
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1978
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.9831 | Train Acc: 0.5822
 Site-MNIST                         | Train Loss: 2.0125 | Train Acc: 0.5256
 Site-USPS                          | Train Loss: 1.9269 | Train Acc: 0.5606
 Site-USPS                          | Train Loss: 1.9225 | Train Acc: 0.5883
 Site-SynthDigits                   | Train Loss: 2.1910 | Train Acc: 0.2642
 Site-SynthDigits                   | Train Loss: 2.1553 | Train Acc: 0.3570
 Site-MNIST_M                       | Train Loss: 2.2394 | Train Acc: 0.2507
 Site-MNIST_M                       | Train Loss: 2.2441 | Train Acc: 0.2206
 Site-SVHN                          | Train Loss: 2.2192 | Train Acc: 0.2722
 Site-SVHN                          | Train Loss: 2.2161 | Train Acc: 0.2413
Average Train Accuracy: 0.3863
 Site-MNIST                         | Val  Loss: 2.0400 | Val  Acc: 0.4674
 Site-MNIST                         | Val  Loss: 2.0023 | Val  Acc: 0.5360
 Site-USPS                          | Val  Loss: 1.9546 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 1.9529 | Val  Acc: 0.4928
 Site-SynthDigits                   | Val  Loss: 2.1520 | Val  Acc: 0.3152
 Site-SynthDigits                   | Val  Loss: 2.1744 | Val  Acc: 0.2986
 Site-MNIST_M                       | Val  Loss: 2.2535 | Val  Acc: 0.2500
 Site-MNIST_M                       | Val  Loss: 2.2406 | Val  Acc: 0.2482
 Site-SVHN                          | Val  Loss: 2.1955 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.2034 | Val  Acc: 0.3094
Average Valid Accuracy: 0.3733
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4674
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5360
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4928
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3152
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2986
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2500
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2482
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3094
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.8453 | Train Acc: 0.6496
 Site-MNIST                         | Train Loss: 1.8830 | Train Acc: 0.5614
 Site-USPS                          | Train Loss: 1.7578 | Train Acc: 0.6011
 Site-USPS                          | Train Loss: 1.7559 | Train Acc: 0.6430
 Site-SynthDigits                   | Train Loss: 2.1258 | Train Acc: 0.3073
 Site-SynthDigits                   | Train Loss: 2.0723 | Train Acc: 0.3901
 Site-MNIST_M                       | Train Loss: 2.1988 | Train Acc: 0.2965
 Site-MNIST_M                       | Train Loss: 2.2013 | Train Acc: 0.2610
 Site-SVHN                          | Train Loss: 2.1901 | Train Acc: 0.2749
 Site-SVHN                          | Train Loss: 2.1862 | Train Acc: 0.2511
Average Train Accuracy: 0.4236
 Site-MNIST                         | Val  Loss: 1.9142 | Val  Acc: 0.5217
 Site-MNIST                         | Val  Loss: 1.8791 | Val  Acc: 0.5863
 Site-USPS                          | Val  Loss: 1.7918 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.7936 | Val  Acc: 0.5719
 Site-SynthDigits                   | Val  Loss: 2.0817 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1027 | Val  Acc: 0.3417
 Site-MNIST_M                       | Val  Loss: 2.2245 | Val  Acc: 0.2826
 Site-MNIST_M                       | Val  Loss: 2.2043 | Val  Acc: 0.3022
 Site-SVHN                          | Val  Loss: 2.1593 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 2.1702 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4166
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5217
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5863
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5719
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3417
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2826
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3022
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.7143 | Train Acc: 0.6819
 Site-MNIST                         | Train Loss: 1.7690 | Train Acc: 0.6090
 Site-USPS                          | Train Loss: 1.6231 | Train Acc: 0.6496
 Site-USPS                          | Train Loss: 1.6116 | Train Acc: 0.6969
 Site-SynthDigits                   | Train Loss: 2.0525 | Train Acc: 0.3558
 Site-SynthDigits                   | Train Loss: 1.9918 | Train Acc: 0.4413
 Site-MNIST_M                       | Train Loss: 2.1506 | Train Acc: 0.3639
 Site-MNIST_M                       | Train Loss: 2.1605 | Train Acc: 0.3067
 Site-SVHN                          | Train Loss: 2.1664 | Train Acc: 0.2911
 Site-SVHN                          | Train Loss: 2.1598 | Train Acc: 0.2610
Average Train Accuracy: 0.4657
 Site-MNIST                         | Val  Loss: 1.7902 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.7599 | Val  Acc: 0.6475
 Site-USPS                          | Val  Loss: 1.6521 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.6541 | Val  Acc: 0.6331
 Site-SynthDigits                   | Val  Loss: 2.0024 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 2.0269 | Val  Acc: 0.3957
 Site-MNIST_M                       | Val  Loss: 2.1813 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 2.1545 | Val  Acc: 0.3489
 Site-SVHN                          | Val  Loss: 2.1278 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 2.1401 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4668
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5870
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6475
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6331
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3957
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3489
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3165
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.6038 | Train Acc: 0.6873
 Site-MNIST                         | Train Loss: 1.6624 | Train Acc: 0.6278
 Site-USPS                          | Train Loss: 1.4968 | Train Acc: 0.6739
 Site-USPS                          | Train Loss: 1.4898 | Train Acc: 0.7283
 Site-SynthDigits                   | Train Loss: 1.9793 | Train Acc: 0.3935
 Site-SynthDigits                   | Train Loss: 1.9058 | Train Acc: 0.4807
 Site-MNIST_M                       | Train Loss: 2.0872 | Train Acc: 0.3962
 Site-MNIST_M                       | Train Loss: 2.1046 | Train Acc: 0.3417
 Site-SVHN                          | Train Loss: 2.1486 | Train Acc: 0.2992
 Site-SVHN                          | Train Loss: 2.1333 | Train Acc: 0.2682
Average Train Accuracy: 0.4897
 Site-MNIST                         | Val  Loss: 1.6818 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.6583 | Val  Acc: 0.6691
 Site-USPS                          | Val  Loss: 1.5353 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.5329 | Val  Acc: 0.6763
 Site-SynthDigits                   | Val  Loss: 1.9158 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.9442 | Val  Acc: 0.4209
 Site-MNIST_M                       | Val  Loss: 2.1340 | Val  Acc: 0.3043
 Site-MNIST_M                       | Val  Loss: 2.0910 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0916 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 2.1121 | Val  Acc: 0.3094
Average Valid Accuracy: 0.4845
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6691
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6763
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4209
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3043
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3094
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.4990 | Train Acc: 0.6954
 Site-MNIST                         | Train Loss: 1.5571 | Train Acc: 0.6520
 Site-USPS                          | Train Loss: 1.3904 | Train Acc: 0.7224
 Site-USPS                          | Train Loss: 1.3822 | Train Acc: 0.7444
 Site-SynthDigits                   | Train Loss: 1.8981 | Train Acc: 0.4447
 Site-SynthDigits                   | Train Loss: 1.8227 | Train Acc: 0.5274
 Site-MNIST_M                       | Train Loss: 2.0316 | Train Acc: 0.4340
 Site-MNIST_M                       | Train Loss: 2.0527 | Train Acc: 0.3839
 Site-SVHN                          | Train Loss: 2.1206 | Train Acc: 0.3181
 Site-SVHN                          | Train Loss: 2.0889 | Train Acc: 0.2852
Average Train Accuracy: 0.5207
 Site-MNIST                         | Val  Loss: 1.5824 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.5591 | Val  Acc: 0.6906
 Site-USPS                          | Val  Loss: 1.4362 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.4254 | Val  Acc: 0.6942
 Site-SynthDigits                   | Val  Loss: 1.8197 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.8548 | Val  Acc: 0.4892
 Site-MNIST_M                       | Val  Loss: 2.0864 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 2.0342 | Val  Acc: 0.4101
 Site-SVHN                          | Val  Loss: 2.0347 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 2.0757 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5155
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6906
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6942
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4892
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.4101
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.4139 | Train Acc: 0.7089
 Site-MNIST                         | Train Loss: 1.4745 | Train Acc: 0.6547
 Site-USPS                          | Train Loss: 1.3364 | Train Acc: 0.7170
 Site-USPS                          | Train Loss: 1.3262 | Train Acc: 0.7507
 Site-SynthDigits                   | Train Loss: 1.8174 | Train Acc: 0.4717
 Site-SynthDigits                   | Train Loss: 1.7378 | Train Acc: 0.5462
 Site-MNIST_M                       | Train Loss: 1.9860 | Train Acc: 0.4340
 Site-MNIST_M                       | Train Loss: 2.0172 | Train Acc: 0.3650
 Site-SVHN                          | Train Loss: 2.0821 | Train Acc: 0.3208
 Site-SVHN                          | Train Loss: 2.0506 | Train Acc: 0.2978
Average Train Accuracy: 0.5267
 Site-MNIST                         | Val  Loss: 1.4919 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.4738 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.3766 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.3638 | Val  Acc: 0.7194
 Site-SynthDigits                   | Val  Loss: 1.7287 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.7693 | Val  Acc: 0.5108
 Site-MNIST_M                       | Val  Loss: 2.0478 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 1.9812 | Val  Acc: 0.4137
 Site-SVHN                          | Val  Loss: 1.9909 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 2.0382 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5245
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7194
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5108
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4137
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.3262 | Train Acc: 0.7278
 Site-MNIST                         | Train Loss: 1.4057 | Train Acc: 0.6655
 Site-USPS                          | Train Loss: 1.2924 | Train Acc: 0.7116
 Site-USPS                          | Train Loss: 1.2687 | Train Acc: 0.7489
 Site-SynthDigits                   | Train Loss: 1.7398 | Train Acc: 0.5013
 Site-SynthDigits                   | Train Loss: 1.6579 | Train Acc: 0.5498
 Site-MNIST_M                       | Train Loss: 1.9429 | Train Acc: 0.4205
 Site-MNIST_M                       | Train Loss: 1.9867 | Train Acc: 0.3623
 Site-SVHN                          | Train Loss: 2.0477 | Train Acc: 0.3342
 Site-SVHN                          | Train Loss: 2.0090 | Train Acc: 0.3202
Average Train Accuracy: 0.5342
 Site-MNIST                         | Val  Loss: 1.4162 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.3991 | Val  Acc: 0.6871
 Site-USPS                          | Val  Loss: 1.3334 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.3129 | Val  Acc: 0.7266
 Site-SynthDigits                   | Val  Loss: 1.6490 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.6865 | Val  Acc: 0.5144
 Site-MNIST_M                       | Val  Loss: 2.0243 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.9480 | Val  Acc: 0.4209
 Site-SVHN                          | Val  Loss: 1.9404 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 1.9941 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5299
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6871
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7266
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5144
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4209
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3417
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.2429 | Train Acc: 0.7439
 Site-MNIST                         | Train Loss: 1.3142 | Train Acc: 0.6996
 Site-USPS                          | Train Loss: 1.2090 | Train Acc: 0.7332
 Site-USPS                          | Train Loss: 1.1943 | Train Acc: 0.7614
 Site-SynthDigits                   | Train Loss: 1.6745 | Train Acc: 0.5256
 Site-SynthDigits                   | Train Loss: 1.5957 | Train Acc: 0.5677
 Site-MNIST_M                       | Train Loss: 1.9025 | Train Acc: 0.4286
 Site-MNIST_M                       | Train Loss: 1.9442 | Train Acc: 0.3803
 Site-SVHN                          | Train Loss: 2.0159 | Train Acc: 0.3531
 Site-SVHN                          | Train Loss: 1.9660 | Train Acc: 0.3318
Average Train Accuracy: 0.5525
 Site-MNIST                         | Val  Loss: 1.3341 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.3120 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.2558 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2301 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.5838 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.6202 | Val  Acc: 0.5180
 Site-MNIST_M                       | Val  Loss: 1.9801 | Val  Acc: 0.3804
 Site-MNIST_M                       | Val  Loss: 1.8982 | Val  Acc: 0.4496
 Site-SVHN                          | Val  Loss: 1.9039 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.9592 | Val  Acc: 0.3633
Average Valid Accuracy: 0.5458
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5180
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3804
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4496
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3633
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.1834 | Train Acc: 0.7682
 Site-MNIST                         | Train Loss: 1.2570 | Train Acc: 0.7103
 Site-USPS                          | Train Loss: 1.1356 | Train Acc: 0.7628
 Site-USPS                          | Train Loss: 1.1186 | Train Acc: 0.7803
 Site-SynthDigits                   | Train Loss: 1.6268 | Train Acc: 0.5337
 Site-SynthDigits                   | Train Loss: 1.5443 | Train Acc: 0.5901
 Site-MNIST_M                       | Train Loss: 1.8579 | Train Acc: 0.4313
 Site-MNIST_M                       | Train Loss: 1.9097 | Train Acc: 0.3955
 Site-SVHN                          | Train Loss: 1.9929 | Train Acc: 0.3504
 Site-SVHN                          | Train Loss: 1.9444 | Train Acc: 0.3453
Average Train Accuracy: 0.5668
 Site-MNIST                         | Val  Loss: 1.2731 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.2519 | Val  Acc: 0.7338
 Site-USPS                          | Val  Loss: 1.1921 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.1622 | Val  Acc: 0.7482
 Site-SynthDigits                   | Val  Loss: 1.5342 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.5705 | Val  Acc: 0.5432
 Site-MNIST_M                       | Val  Loss: 1.9442 | Val  Acc: 0.3804
 Site-MNIST_M                       | Val  Loss: 1.8578 | Val  Acc: 0.4532
 Site-SVHN                          | Val  Loss: 1.8743 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.9310 | Val  Acc: 0.3669
Average Valid Accuracy: 0.5552
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6522
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7338
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7482
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5432
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3804
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4532
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3669
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 1.1261 | Train Acc: 0.7601
 Site-MNIST                         | Train Loss: 1.1929 | Train Acc: 0.7238
 Site-USPS                          | Train Loss: 1.0926 | Train Acc: 0.7628
 Site-USPS                          | Train Loss: 1.0697 | Train Acc: 0.7740
 Site-SynthDigits                   | Train Loss: 1.5680 | Train Acc: 0.5526
 Site-SynthDigits                   | Train Loss: 1.4923 | Train Acc: 0.5937
 Site-MNIST_M                       | Train Loss: 1.8219 | Train Acc: 0.4340
 Site-MNIST_M                       | Train Loss: 1.8709 | Train Acc: 0.4018
 Site-SVHN                          | Train Loss: 1.9597 | Train Acc: 0.3558
 Site-SVHN                          | Train Loss: 1.9019 | Train Acc: 0.3561
Average Train Accuracy: 0.5715
 Site-MNIST                         | Val  Loss: 1.2113 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.1912 | Val  Acc: 0.7518
 Site-USPS                          | Val  Loss: 1.1424 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.1075 | Val  Acc: 0.7482
 Site-SynthDigits                   | Val  Loss: 1.4905 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.5203 | Val  Acc: 0.5612
 Site-MNIST_M                       | Val  Loss: 1.9115 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.8224 | Val  Acc: 0.4388
 Site-SVHN                          | Val  Loss: 1.8420 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 1.8972 | Val  Acc: 0.3633
Average Valid Accuracy: 0.5581
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7518
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7482
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5612
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4388
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3633
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 1.0731 | Train Acc: 0.7709
 Site-MNIST                         | Train Loss: 1.1488 | Train Acc: 0.7130
 Site-USPS                          | Train Loss: 1.0520 | Train Acc: 0.7601
 Site-USPS                          | Train Loss: 1.0274 | Train Acc: 0.7749
 Site-SynthDigits                   | Train Loss: 1.5248 | Train Acc: 0.5660
 Site-SynthDigits                   | Train Loss: 1.4456 | Train Acc: 0.6188
 Site-MNIST_M                       | Train Loss: 1.7912 | Train Acc: 0.4447
 Site-MNIST_M                       | Train Loss: 1.8449 | Train Acc: 0.4081
 Site-SVHN                          | Train Loss: 1.9360 | Train Acc: 0.3720
 Site-SVHN                          | Train Loss: 1.8775 | Train Acc: 0.3704
Average Train Accuracy: 0.5799
 Site-MNIST                         | Val  Loss: 1.1681 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.1502 | Val  Acc: 0.7410
 Site-USPS                          | Val  Loss: 1.1036 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.0622 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.4431 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.4674 | Val  Acc: 0.5899
 Site-MNIST_M                       | Val  Loss: 1.8771 | Val  Acc: 0.3587
 Site-MNIST_M                       | Val  Loss: 1.7912 | Val  Acc: 0.4532
 Site-SVHN                          | Val  Loss: 1.8160 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.8693 | Val  Acc: 0.3777
Average Valid Accuracy: 0.5678
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7410
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6304
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5899
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3587
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4532
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3777
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 1.0256 | Train Acc: 0.7817
 Site-MNIST                         | Train Loss: 1.0906 | Train Acc: 0.7336
 Site-USPS                          | Train Loss: 0.9981 | Train Acc: 0.7574
 Site-USPS                          | Train Loss: 0.9642 | Train Acc: 0.7803
 Site-SynthDigits                   | Train Loss: 1.4892 | Train Acc: 0.5553
 Site-SynthDigits                   | Train Loss: 1.4024 | Train Acc: 0.6161
 Site-MNIST_M                       | Train Loss: 1.7546 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.8068 | Train Acc: 0.4251
 Site-SVHN                          | Train Loss: 1.9153 | Train Acc: 0.3666
 Site-SVHN                          | Train Loss: 1.8512 | Train Acc: 0.3776
Average Train Accuracy: 0.5849
 Site-MNIST                         | Val  Loss: 1.1125 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.0923 | Val  Acc: 0.7662
 Site-USPS                          | Val  Loss: 1.0475 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.0068 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.4035 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.4342 | Val  Acc: 0.5683
 Site-MNIST_M                       | Val  Loss: 1.8356 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.7524 | Val  Acc: 0.4604
 Site-SVHN                          | Val  Loss: 1.7865 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8412 | Val  Acc: 0.3741
Average Valid Accuracy: 0.5703
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7662
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5683
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4604
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3741
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.9868 | Train Acc: 0.7790
 Site-MNIST                         | Train Loss: 1.0563 | Train Acc: 0.7417
 Site-USPS                          | Train Loss: 0.9688 | Train Acc: 0.7709
 Site-USPS                          | Train Loss: 0.9292 | Train Acc: 0.7785
 Site-SynthDigits                   | Train Loss: 1.4555 | Train Acc: 0.5687
 Site-SynthDigits                   | Train Loss: 1.3635 | Train Acc: 0.6161
 Site-MNIST_M                       | Train Loss: 1.7202 | Train Acc: 0.4663
 Site-MNIST_M                       | Train Loss: 1.7725 | Train Acc: 0.4305
 Site-SVHN                          | Train Loss: 1.8881 | Train Acc: 0.3720
 Site-SVHN                          | Train Loss: 1.8147 | Train Acc: 0.3830
Average Train Accuracy: 0.5907
 Site-MNIST                         | Val  Loss: 1.0737 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.0554 | Val  Acc: 0.7662
 Site-USPS                          | Val  Loss: 1.0249 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.9760 | Val  Acc: 0.7626
 Site-SynthDigits                   | Val  Loss: 1.3739 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.4009 | Val  Acc: 0.5791
 Site-MNIST_M                       | Val  Loss: 1.8012 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.7169 | Val  Acc: 0.4820
 Site-SVHN                          | Val  Loss: 1.7605 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8158 | Val  Acc: 0.3777
Average Valid Accuracy: 0.5794
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7662
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7626
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6304
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5791
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4820
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3777
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.9540 | Train Acc: 0.7817
 Site-MNIST                         | Train Loss: 1.0298 | Train Acc: 0.7363
 Site-USPS                          | Train Loss: 0.9303 | Train Acc: 0.7790
 Site-USPS                          | Train Loss: 0.9112 | Train Acc: 0.7883
 Site-SynthDigits                   | Train Loss: 1.4211 | Train Acc: 0.5741
 Site-SynthDigits                   | Train Loss: 1.3290 | Train Acc: 0.6305
 Site-MNIST_M                       | Train Loss: 1.6905 | Train Acc: 0.4690
 Site-MNIST_M                       | Train Loss: 1.7487 | Train Acc: 0.4475
 Site-SVHN                          | Train Loss: 1.8572 | Train Acc: 0.3774
 Site-SVHN                          | Train Loss: 1.7950 | Train Acc: 0.3973
Average Train Accuracy: 0.5981
 Site-MNIST                         | Val  Loss: 1.0431 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.0238 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.0025 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 0.9454 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.3423 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.3663 | Val  Acc: 0.5863
 Site-MNIST_M                       | Val  Loss: 1.7697 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.6884 | Val  Acc: 0.4892
 Site-SVHN                          | Val  Loss: 1.7344 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.7926 | Val  Acc: 0.3885
Average Valid Accuracy: 0.5855
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5863
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4892
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3885
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.9334 | Train Acc: 0.7709
 Site-MNIST                         | Train Loss: 1.0102 | Train Acc: 0.7157
 Site-USPS                          | Train Loss: 0.8998 | Train Acc: 0.7925
 Site-USPS                          | Train Loss: 0.8666 | Train Acc: 0.7973
 Site-SynthDigits                   | Train Loss: 1.3678 | Train Acc: 0.5714
 Site-SynthDigits                   | Train Loss: 1.2759 | Train Acc: 0.6466
 Site-MNIST_M                       | Train Loss: 1.6556 | Train Acc: 0.4825
 Site-MNIST_M                       | Train Loss: 1.7240 | Train Acc: 0.4538
 Site-SVHN                          | Train Loss: 1.8268 | Train Acc: 0.3854
 Site-SVHN                          | Train Loss: 1.7703 | Train Acc: 0.4018
Average Train Accuracy: 0.6018
 Site-MNIST                         | Val  Loss: 1.0294 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.0098 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 0.9725 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.9104 | Val  Acc: 0.7806
 Site-SynthDigits                   | Val  Loss: 1.2811 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.3215 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.7425 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.6575 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.7060 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7644 | Val  Acc: 0.3957
Average Valid Accuracy: 0.5866
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.6522
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7806
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.6079
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4239
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3957
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.9043 | Train Acc: 0.7709
 Site-MNIST                         | Train Loss: 0.9713 | Train Acc: 0.7291
 Site-USPS                          | Train Loss: 0.8664 | Train Acc: 0.7978
 Site-USPS                          | Train Loss: 0.8331 | Train Acc: 0.7982
 Site-SynthDigits                   | Train Loss: 1.3441 | Train Acc: 0.5849
 Site-SynthDigits                   | Train Loss: 1.2550 | Train Acc: 0.6556
 Site-MNIST_M                       | Train Loss: 1.6222 | Train Acc: 0.5067
 Site-MNIST_M                       | Train Loss: 1.6793 | Train Acc: 0.4700
 Site-SVHN                          | Train Loss: 1.8155 | Train Acc: 0.3881
 Site-SVHN                          | Train Loss: 1.7476 | Train Acc: 0.4090
Average Train Accuracy: 0.6110
 Site-MNIST                         | Val  Loss: 0.9881 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 0.9713 | Val  Acc: 0.7446
 Site-USPS                          | Val  Loss: 0.9446 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.8724 | Val  Acc: 0.7986
 Site-SynthDigits                   | Val  Loss: 1.2477 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.2925 | Val  Acc: 0.6151
 Site-MNIST_M                       | Val  Loss: 1.7105 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.6227 | Val  Acc: 0.5252
 Site-SVHN                          | Val  Loss: 1.6863 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.7398 | Val  Acc: 0.4065
Average Valid Accuracy: 0.6046
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7446
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7986
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.6151
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5252
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.8553 | Train Acc: 0.7844
 Site-MNIST                         | Train Loss: 0.9313 | Train Acc: 0.7543
 Site-USPS                          | Train Loss: 0.8265 | Train Acc: 0.8248
 Site-USPS                          | Train Loss: 0.7897 | Train Acc: 0.8108
 Site-SynthDigits                   | Train Loss: 1.3272 | Train Acc: 0.5687
 Site-SynthDigits                   | Train Loss: 1.2346 | Train Acc: 0.6538
 Site-MNIST_M                       | Train Loss: 1.5872 | Train Acc: 0.5229
 Site-MNIST_M                       | Train Loss: 1.6363 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 1.7891 | Train Acc: 0.3908
 Site-SVHN                          | Train Loss: 1.7214 | Train Acc: 0.4126
Average Train Accuracy: 0.6200
 Site-MNIST                         | Val  Loss: 0.9402 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.9314 | Val  Acc: 0.7590
 Site-USPS                          | Val  Loss: 0.9162 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 0.8386 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.2276 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.2787 | Val  Acc: 0.6115
 Site-MNIST_M                       | Val  Loss: 1.6690 | Val  Acc: 0.4783
 Site-MNIST_M                       | Val  Loss: 1.5864 | Val  Acc: 0.5360
 Site-SVHN                          | Val  Loss: 1.6634 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.7164 | Val  Acc: 0.4137
Average Valid Accuracy: 0.6162
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7590
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6304
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6115
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4783
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5360
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4137
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.8396 | Train Acc: 0.7978
 Site-MNIST                         | Train Loss: 0.9108 | Train Acc: 0.7489
 Site-USPS                          | Train Loss: 0.8017 | Train Acc: 0.8356
 Site-USPS                          | Train Loss: 0.7835 | Train Acc: 0.8179
 Site-SynthDigits                   | Train Loss: 1.2978 | Train Acc: 0.5876
 Site-SynthDigits                   | Train Loss: 1.2009 | Train Acc: 0.6700
 Site-MNIST_M                       | Train Loss: 1.5618 | Train Acc: 0.5283
 Site-MNIST_M                       | Train Loss: 1.6338 | Train Acc: 0.4861
 Site-SVHN                          | Train Loss: 1.7768 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.7073 | Train Acc: 0.4161
Average Train Accuracy: 0.6290
 Site-MNIST                         | Val  Loss: 0.9171 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 0.9080 | Val  Acc: 0.7482
 Site-USPS                          | Val  Loss: 0.9042 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.8202 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.1884 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.2427 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.6468 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.5641 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.6424 | Val  Acc: 0.4674
 Site-SVHN                          | Val  Loss: 1.6968 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6249
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7482
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.6259
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5576
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.4674
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.7987 | Train Acc: 0.7978
 Site-MNIST                         | Train Loss: 0.8814 | Train Acc: 0.7614
 Site-USPS                          | Train Loss: 0.7807 | Train Acc: 0.8383
 Site-USPS                          | Train Loss: 0.7634 | Train Acc: 0.8161
 Site-SynthDigits                   | Train Loss: 1.2746 | Train Acc: 0.5849
 Site-SynthDigits                   | Train Loss: 1.1809 | Train Acc: 0.6771
 Site-MNIST_M                       | Train Loss: 1.5361 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.5974 | Train Acc: 0.4915
 Site-SVHN                          | Train Loss: 1.7539 | Train Acc: 0.4070
 Site-SVHN                          | Train Loss: 1.6834 | Train Acc: 0.4260
Average Train Accuracy: 0.6320
 Site-MNIST                         | Val  Loss: 0.8938 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.8808 | Val  Acc: 0.7590
 Site-USPS                          | Val  Loss: 0.8921 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.8036 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.1699 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.2241 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.6174 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.5374 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.6209 | Val  Acc: 0.4674
 Site-SVHN                          | Val  Loss: 1.6781 | Val  Acc: 0.4353
Average Valid Accuracy: 0.6263
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7590
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6259
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4891
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5576
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.4674
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.4353
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.7801 | Train Acc: 0.8113
 Site-MNIST                         | Train Loss: 0.8510 | Train Acc: 0.7650
 Site-USPS                          | Train Loss: 0.7699 | Train Acc: 0.8383
 Site-USPS                          | Train Loss: 0.7488 | Train Acc: 0.8126
 Site-SynthDigits                   | Train Loss: 1.2431 | Train Acc: 0.5930
 Site-SynthDigits                   | Train Loss: 1.1521 | Train Acc: 0.6843
 Site-MNIST_M                       | Train Loss: 1.5227 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.5729 | Train Acc: 0.4996
 Site-SVHN                          | Train Loss: 1.7320 | Train Acc: 0.4178
 Site-SVHN                          | Train Loss: 1.6612 | Train Acc: 0.4386
Average Train Accuracy: 0.6381
 Site-MNIST                         | Val  Loss: 0.8602 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 0.8551 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 0.8789 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.7871 | Val  Acc: 0.8058
 Site-SynthDigits                   | Val  Loss: 1.1402 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.1950 | Val  Acc: 0.6331
 Site-MNIST_M                       | Val  Loss: 1.5894 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.5102 | Val  Acc: 0.5540
 Site-SVHN                          | Val  Loss: 1.5985 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.6544 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6310
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:20 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8058
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6331
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5540
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4460
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.7627 | Train Acc: 0.8059
 Site-MNIST                         | Train Loss: 0.8252 | Train Acc: 0.7803
 Site-USPS                          | Train Loss: 0.7421 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.7079 | Train Acc: 0.8188
 Site-SynthDigits                   | Train Loss: 1.2353 | Train Acc: 0.5849
 Site-SynthDigits                   | Train Loss: 1.1421 | Train Acc: 0.6906
 Site-MNIST_M                       | Train Loss: 1.4896 | Train Acc: 0.5418
 Site-MNIST_M                       | Train Loss: 1.5500 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.7258 | Train Acc: 0.4151
 Site-SVHN                          | Train Loss: 1.6510 | Train Acc: 0.4386
Average Train Accuracy: 0.6434
 Site-MNIST                         | Val  Loss: 0.8255 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 0.8233 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 0.8598 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.7617 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.1320 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 1.1904 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.5576 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.4835 | Val  Acc: 0.5719
 Site-SVHN                          | Val  Loss: 1.5880 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.6473 | Val  Acc: 0.4496
Average Valid Accuracy: 0.6400
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6739
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6259
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5217
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5719
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4496
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.7348 | Train Acc: 0.8113
 Site-MNIST                         | Train Loss: 0.7910 | Train Acc: 0.7910
 Site-USPS                          | Train Loss: 0.7275 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.6957 | Train Acc: 0.8233
 Site-SynthDigits                   | Train Loss: 1.2115 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 1.1224 | Train Acc: 0.6942
 Site-MNIST_M                       | Train Loss: 1.4739 | Train Acc: 0.5391
 Site-MNIST_M                       | Train Loss: 1.5338 | Train Acc: 0.5139
 Site-SVHN                          | Train Loss: 1.6987 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 1.6220 | Train Acc: 0.4511
Average Train Accuracy: 0.6500
 Site-MNIST                         | Val  Loss: 0.7984 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.7992 | Val  Acc: 0.7878
 Site-USPS                          | Val  Loss: 0.8497 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.7451 | Val  Acc: 0.8058
 Site-SynthDigits                   | Val  Loss: 1.1107 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 1.1650 | Val  Acc: 0.6403
 Site-MNIST_M                       | Val  Loss: 1.5347 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.4647 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.5674 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.6226 | Val  Acc: 0.4640
Average Valid Accuracy: 0.6491
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7878
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8058
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6739
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6403
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5755
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.5109
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4640
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.7277 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.7882 | Train Acc: 0.7848
 Site-USPS                          | Train Loss: 0.7100 | Train Acc: 0.8410
 Site-USPS                          | Train Loss: 0.6880 | Train Acc: 0.8206
 Site-SynthDigits                   | Train Loss: 1.1889 | Train Acc: 0.6226
 Site-SynthDigits                   | Train Loss: 1.0971 | Train Acc: 0.7049
 Site-MNIST_M                       | Train Loss: 1.4679 | Train Acc: 0.5229
 Site-MNIST_M                       | Train Loss: 1.5156 | Train Acc: 0.5031
 Site-SVHN                          | Train Loss: 1.6802 | Train Acc: 0.4367
 Site-SVHN                          | Train Loss: 1.6088 | Train Acc: 0.4610
Average Train Accuracy: 0.6517
 Site-MNIST                         | Val  Loss: 0.7932 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 0.7885 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 0.8454 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.7341 | Val  Acc: 0.8058
 Site-SynthDigits                   | Val  Loss: 1.0793 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 1.1357 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.5243 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.4568 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.5424 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.5980 | Val  Acc: 0.4640
Average Valid Accuracy: 0.6465
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.7090 | Train Acc: 0.8167
 Site-MNIST                         | Train Loss: 0.7694 | Train Acc: 0.7830
 Site-USPS                          | Train Loss: 0.6972 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.6700 | Train Acc: 0.8197
 Site-SynthDigits                   | Train Loss: 1.1737 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.0820 | Train Acc: 0.7085
 Site-MNIST_M                       | Train Loss: 1.4510 | Train Acc: 0.5310
 Site-MNIST_M                       | Train Loss: 1.5042 | Train Acc: 0.5148
 Site-SVHN                          | Train Loss: 1.6628 | Train Acc: 0.4313
 Site-SVHN                          | Train Loss: 1.5806 | Train Acc: 0.4717
Average Train Accuracy: 0.6548
 Site-MNIST                         | Val  Loss: 0.7768 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 0.7672 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 0.8337 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.7202 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.0647 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 1.1220 | Val  Acc: 0.6691
 Site-MNIST_M                       | Val  Loss: 1.5048 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.4319 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.5265 | Val  Acc: 0.5435
 Site-SVHN                          | Val  Loss: 1.5846 | Val  Acc: 0.4712
Average Valid Accuracy: 0.6556
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6957
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6691
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5755
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.5435
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.6857 | Train Acc: 0.8275
 Site-MNIST                         | Train Loss: 0.7461 | Train Acc: 0.8027
 Site-USPS                          | Train Loss: 0.6833 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.6511 | Train Acc: 0.8305
 Site-SynthDigits                   | Train Loss: 1.1691 | Train Acc: 0.6307
 Site-SynthDigits                   | Train Loss: 1.0705 | Train Acc: 0.7094
 Site-MNIST_M                       | Train Loss: 1.4189 | Train Acc: 0.5499
 Site-MNIST_M                       | Train Loss: 1.4715 | Train Acc: 0.5300
 Site-SVHN                          | Train Loss: 1.6685 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.5761 | Train Acc: 0.4709
Average Train Accuracy: 0.6643
 Site-MNIST                         | Val  Loss: 0.7508 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.7411 | Val  Acc: 0.8058
 Site-USPS                          | Val  Loss: 0.8166 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.7013 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.0560 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 1.1184 | Val  Acc: 0.6835
 Site-MNIST_M                       | Val  Loss: 1.4655 | Val  Acc: 0.5652
 Site-MNIST_M                       | Val  Loss: 1.4048 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.5194 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.5742 | Val  Acc: 0.4748
Average Valid Accuracy: 0.6650
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8058
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.7065
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6835
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5652
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.5217
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4748
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.6701 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.7276 | Train Acc: 0.8090
 Site-USPS                          | Train Loss: 0.6612 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.6301 | Train Acc: 0.8368
 Site-SynthDigits                   | Train Loss: 1.1401 | Train Acc: 0.6361
 Site-SynthDigits                   | Train Loss: 1.0493 | Train Acc: 0.7148
 Site-MNIST_M                       | Train Loss: 1.4092 | Train Acc: 0.5499
 Site-MNIST_M                       | Train Loss: 1.4585 | Train Acc: 0.5300
 Site-SVHN                          | Train Loss: 1.6506 | Train Acc: 0.4420
 Site-SVHN                          | Train Loss: 1.5654 | Train Acc: 0.4691
Average Train Accuracy: 0.6675
 Site-MNIST                         | Val  Loss: 0.7277 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 0.7204 | Val  Acc: 0.7950
 Site-USPS                          | Val  Loss: 0.8036 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6820 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.0410 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 1.0948 | Val  Acc: 0.6871
 Site-MNIST_M                       | Val  Loss: 1.4618 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.3938 | Val  Acc: 0.5971
 Site-SVHN                          | Val  Loss: 1.5131 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.5640 | Val  Acc: 0.4712
Average Valid Accuracy: 0.6610
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.6516 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.7025 | Train Acc: 0.8161
 Site-USPS                          | Train Loss: 0.6647 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.6334 | Train Acc: 0.8251
 Site-SynthDigits                   | Train Loss: 1.1207 | Train Acc: 0.6388
 Site-SynthDigits                   | Train Loss: 1.0348 | Train Acc: 0.7175
 Site-MNIST_M                       | Train Loss: 1.3927 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.4476 | Train Acc: 0.5399
 Site-SVHN                          | Train Loss: 1.6256 | Train Acc: 0.4447
 Site-SVHN                          | Train Loss: 1.5409 | Train Acc: 0.4807
Average Train Accuracy: 0.6719
 Site-MNIST                         | Val  Loss: 0.7108 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.7020 | Val  Acc: 0.8094
 Site-USPS                          | Val  Loss: 0.8018 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6811 | Val  Acc: 0.8022
 Site-SynthDigits                   | Val  Loss: 1.0242 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 1.0775 | Val  Acc: 0.6906
 Site-MNIST_M                       | Val  Loss: 1.4368 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.3766 | Val  Acc: 0.5971
 Site-SVHN                          | Val  Loss: 1.4948 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.5453 | Val  Acc: 0.4640
Average Valid Accuracy: 0.6624
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.6438 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.6895 | Train Acc: 0.8117
 Site-USPS                          | Train Loss: 0.6438 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.6181 | Train Acc: 0.8314
 Site-SynthDigits                   | Train Loss: 1.0992 | Train Acc: 0.6469
 Site-SynthDigits                   | Train Loss: 1.0173 | Train Acc: 0.7256
 Site-MNIST_M                       | Train Loss: 1.3888 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.4366 | Train Acc: 0.5426
 Site-SVHN                          | Train Loss: 1.6096 | Train Acc: 0.4474
 Site-SVHN                          | Train Loss: 1.5296 | Train Acc: 0.4861
Average Train Accuracy: 0.6745
 Site-MNIST                         | Val  Loss: 0.7047 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.6914 | Val  Acc: 0.8022
 Site-USPS                          | Val  Loss: 0.7905 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.6673 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 1.0047 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 1.0527 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.4382 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.3717 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.4804 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.5327 | Val  Acc: 0.4604
Average Valid Accuracy: 0.6577
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.6256 | Train Acc: 0.8410
 Site-MNIST                         | Train Loss: 0.6630 | Train Acc: 0.8269
 Site-USPS                          | Train Loss: 0.6279 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.6021 | Train Acc: 0.8359
 Site-SynthDigits                   | Train Loss: 1.1055 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 1.0175 | Train Acc: 0.7229
 Site-MNIST_M                       | Train Loss: 1.3712 | Train Acc: 0.5633
 Site-MNIST_M                       | Train Loss: 1.4113 | Train Acc: 0.5480
 Site-SVHN                          | Train Loss: 1.6105 | Train Acc: 0.4555
 Site-SVHN                          | Train Loss: 1.5145 | Train Acc: 0.4879
Average Train Accuracy: 0.6775
 Site-MNIST                         | Val  Loss: 0.6808 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.6655 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.7769 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.6480 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.0092 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 1.0557 | Val  Acc: 0.6835
 Site-MNIST_M                       | Val  Loss: 1.4100 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3481 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.4760 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.5270 | Val  Acc: 0.4676
Average Valid Accuracy: 0.6617
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.6073 | Train Acc: 0.8464
 Site-MNIST                         | Train Loss: 0.6619 | Train Acc: 0.8287
 Site-USPS                          | Train Loss: 0.6188 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.5872 | Train Acc: 0.8430
 Site-SynthDigits                   | Train Loss: 1.0841 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 0.9998 | Train Acc: 0.7256
 Site-MNIST_M                       | Train Loss: 1.3553 | Train Acc: 0.5768
 Site-MNIST_M                       | Train Loss: 1.4008 | Train Acc: 0.5480
 Site-SVHN                          | Train Loss: 1.6029 | Train Acc: 0.4528
 Site-SVHN                          | Train Loss: 1.4931 | Train Acc: 0.4978
Average Train Accuracy: 0.6818
 Site-MNIST                         | Val  Loss: 0.6744 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.6556 | Val  Acc: 0.8273
 Site-USPS                          | Val  Loss: 0.7718 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.6378 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 1.0012 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 1.0426 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.3956 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3325 | Val  Acc: 0.5935
 Site-SVHN                          | Val  Loss: 1.4508 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.5102 | Val  Acc: 0.4748
Average Valid Accuracy: 0.6686
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7935
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8273
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8165
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.7065
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5935
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.5217
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4748
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.6051 | Train Acc: 0.8544
 Site-MNIST                         | Train Loss: 0.6470 | Train Acc: 0.8332
 Site-USPS                          | Train Loss: 0.6088 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.5806 | Train Acc: 0.8395
 Site-SynthDigits                   | Train Loss: 1.0684 | Train Acc: 0.6523
 Site-SynthDigits                   | Train Loss: 0.9760 | Train Acc: 0.7327
 Site-MNIST_M                       | Train Loss: 1.3469 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.4027 | Train Acc: 0.5561
 Site-SVHN                          | Train Loss: 1.5839 | Train Acc: 0.4609
 Site-SVHN                          | Train Loss: 1.4899 | Train Acc: 0.5022
Average Train Accuracy: 0.6860
 Site-MNIST                         | Val  Loss: 0.6637 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6431 | Val  Acc: 0.8309
 Site-USPS                          | Val  Loss: 0.7614 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6282 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 0.9896 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 1.0268 | Val  Acc: 0.6906
 Site-MNIST_M                       | Val  Loss: 1.3906 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.3273 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.4453 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.4982 | Val  Acc: 0.4784
Average Valid Accuracy: 0.6704
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8309
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6906
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.5217
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.5828 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.6350 | Train Acc: 0.8305
 Site-USPS                          | Train Loss: 0.5923 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.5734 | Train Acc: 0.8457
 Site-SynthDigits                   | Train Loss: 1.0520 | Train Acc: 0.6658
 Site-SynthDigits                   | Train Loss: 0.9598 | Train Acc: 0.7408
 Site-MNIST_M                       | Train Loss: 1.3431 | Train Acc: 0.5633
 Site-MNIST_M                       | Train Loss: 1.3833 | Train Acc: 0.5578
 Site-SVHN                          | Train Loss: 1.5754 | Train Acc: 0.4744
 Site-SVHN                          | Train Loss: 1.4777 | Train Acc: 0.5004
Average Train Accuracy: 0.6901
 Site-MNIST                         | Val  Loss: 0.6436 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.6272 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.7562 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.6216 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 0.9632 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 1.0054 | Val  Acc: 0.7050
 Site-MNIST_M                       | Val  Loss: 1.3825 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.3215 | Val  Acc: 0.5971
 Site-SVHN                          | Val  Loss: 1.4445 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.4910 | Val  Acc: 0.4928
Average Valid Accuracy: 0.6769
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7935
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8237
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.7050
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5543
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5971
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.5326
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4928
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.5760 | Train Acc: 0.8679
 Site-MNIST                         | Train Loss: 0.6152 | Train Acc: 0.8386
 Site-USPS                          | Train Loss: 0.5828 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.5593 | Train Acc: 0.8448
 Site-SynthDigits                   | Train Loss: 1.0465 | Train Acc: 0.6631
 Site-SynthDigits                   | Train Loss: 0.9530 | Train Acc: 0.7408
 Site-MNIST_M                       | Train Loss: 1.3395 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.3697 | Train Acc: 0.5578
 Site-SVHN                          | Train Loss: 1.5623 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.4653 | Train Acc: 0.5166
Average Train Accuracy: 0.6933
 Site-MNIST                         | Val  Loss: 0.6322 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.6156 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.7466 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6077 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 0.9570 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.9928 | Val  Acc: 0.7014
 Site-MNIST_M                       | Val  Loss: 1.3672 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.3086 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.4294 | Val  Acc: 0.5435
 Site-SVHN                          | Val  Loss: 1.4784 | Val  Acc: 0.5072
Average Valid Accuracy: 0.6779
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8381
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8165
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.7014
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.5435
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.5072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.5714 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.6254 | Train Acc: 0.8269
 Site-USPS                          | Train Loss: 0.5731 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.5481 | Train Acc: 0.8413
 Site-SynthDigits                   | Train Loss: 1.0290 | Train Acc: 0.6712
 Site-SynthDigits                   | Train Loss: 0.9309 | Train Acc: 0.7372
 Site-MNIST_M                       | Train Loss: 1.3385 | Train Acc: 0.5714
 Site-MNIST_M                       | Train Loss: 1.3689 | Train Acc: 0.5561
 Site-SVHN                          | Train Loss: 1.5483 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.4576 | Train Acc: 0.5184
Average Train Accuracy: 0.6935
 Site-MNIST                         | Val  Loss: 0.6279 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6118 | Val  Acc: 0.8309
 Site-USPS                          | Val  Loss: 0.7459 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6044 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 0.9326 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.9706 | Val  Acc: 0.7050
 Site-MNIST_M                       | Val  Loss: 1.3589 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3051 | Val  Acc: 0.5935
 Site-SVHN                          | Val  Loss: 1.4188 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.4664 | Val  Acc: 0.5108
Average Valid Accuracy: 0.6797
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8309
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.7050
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5935
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.5108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.5553 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.5973 | Train Acc: 0.8359
 Site-USPS                          | Train Loss: 0.5606 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.5343 | Train Acc: 0.8439
 Site-SynthDigits                   | Train Loss: 1.0279 | Train Acc: 0.6658
 Site-SynthDigits                   | Train Loss: 0.9274 | Train Acc: 0.7453
 Site-MNIST_M                       | Train Loss: 1.3115 | Train Acc: 0.5741
 Site-MNIST_M                       | Train Loss: 1.3498 | Train Acc: 0.5749
 Site-SVHN                          | Train Loss: 1.5395 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.4506 | Train Acc: 0.5139
Average Train Accuracy: 0.6972
 Site-MNIST                         | Val  Loss: 0.6076 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.5944 | Val  Acc: 0.8345
 Site-USPS                          | Val  Loss: 0.7284 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.5928 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 0.9223 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9667 | Val  Acc: 0.7050
 Site-MNIST_M                       | Val  Loss: 1.3343 | Val  Acc: 0.5652
 Site-MNIST_M                       | Val  Loss: 1.2859 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.4122 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.4607 | Val  Acc: 0.5036
Average Valid Accuracy: 0.6837
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8345
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8165
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.7050
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5652
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.6079
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.5036
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.5445 | Train Acc: 0.8625
 Site-MNIST                         | Train Loss: 0.5850 | Train Acc: 0.8457
 Site-USPS                          | Train Loss: 0.5534 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.5389 | Train Acc: 0.8466
 Site-SynthDigits                   | Train Loss: 1.0158 | Train Acc: 0.6712
 Site-SynthDigits                   | Train Loss: 0.9229 | Train Acc: 0.7444
 Site-MNIST_M                       | Train Loss: 1.2962 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.3306 | Train Acc: 0.5767
 Site-SVHN                          | Train Loss: 1.5246 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.4262 | Train Acc: 0.5265
Average Train Accuracy: 0.7009
 Site-MNIST                         | Val  Loss: 0.5891 | Val  Acc: 0.8370
 Site-MNIST                         | Val  Loss: 0.5776 | Val  Acc: 0.8453
 Site-USPS                          | Val  Loss: 0.7284 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.5872 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 0.9195 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9654 | Val  Acc: 0.7086
 Site-MNIST_M                       | Val  Loss: 1.3184 | Val  Acc: 0.5652
 Site-MNIST_M                       | Val  Loss: 1.2704 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.4090 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.4552 | Val  Acc: 0.5108
Average Valid Accuracy: 0.6906
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8370
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8453
 Best site-USPS                      | Epoch:36 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.7086
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5652
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.6079
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.5108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.5437 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.5818 | Train Acc: 0.8368
 Site-USPS                          | Train Loss: 0.5454 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.5269 | Train Acc: 0.8448
 Site-SynthDigits                   | Train Loss: 1.0003 | Train Acc: 0.6792
 Site-SynthDigits                   | Train Loss: 0.9083 | Train Acc: 0.7444
 Site-MNIST_M                       | Train Loss: 1.3039 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.3254 | Train Acc: 0.5722
 Site-SVHN                          | Train Loss: 1.5227 | Train Acc: 0.4906
 Site-SVHN                          | Train Loss: 1.4207 | Train Acc: 0.5265
Average Train Accuracy: 0.6999
 Site-MNIST                         | Val  Loss: 0.5888 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.5768 | Val  Acc: 0.8453
 Site-USPS                          | Val  Loss: 0.7274 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.5800 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 0.9116 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.9467 | Val  Acc: 0.7086
 Site-MNIST_M                       | Val  Loss: 1.3180 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.2699 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.3913 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.4362 | Val  Acc: 0.5180
Average Valid Accuracy: 0.6866
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.5233 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.5601 | Train Acc: 0.8475
 Site-USPS                          | Train Loss: 0.5321 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.5088 | Train Acc: 0.8547
 Site-SynthDigits                   | Train Loss: 0.9983 | Train Acc: 0.6900
 Site-SynthDigits                   | Train Loss: 0.8918 | Train Acc: 0.7552
 Site-MNIST_M                       | Train Loss: 1.2903 | Train Acc: 0.5714
 Site-MNIST_M                       | Train Loss: 1.3106 | Train Acc: 0.5794
 Site-SVHN                          | Train Loss: 1.5166 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.4110 | Train Acc: 0.5336
Average Train Accuracy: 0.7077
 Site-MNIST                         | Val  Loss: 0.5699 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.5626 | Val  Acc: 0.8417
 Site-USPS                          | Val  Loss: 0.7124 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.5658 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 0.9002 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9396 | Val  Acc: 0.7230
 Site-MNIST_M                       | Val  Loss: 1.3004 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.2564 | Val  Acc: 0.6043
 Site-SVHN                          | Val  Loss: 1.3856 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.4360 | Val  Acc: 0.5216
Average Valid Accuracy: 0.6917
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8417
 Best site-USPS                      | Epoch:38 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.7230
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5543
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.6043
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.5761
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.5216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.5106 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5443 | Train Acc: 0.8547
 Site-USPS                          | Train Loss: 0.5222 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.5010 | Train Acc: 0.8565
 Site-SynthDigits                   | Train Loss: 0.9889 | Train Acc: 0.6873
 Site-SynthDigits                   | Train Loss: 0.8867 | Train Acc: 0.7534
 Site-MNIST_M                       | Train Loss: 1.2741 | Train Acc: 0.5930
 Site-MNIST_M                       | Train Loss: 1.2830 | Train Acc: 0.5901
 Site-SVHN                          | Train Loss: 1.5047 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.4063 | Train Acc: 0.5426
Average Train Accuracy: 0.7128
 Site-MNIST                         | Val  Loss: 0.5457 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5406 | Val  Acc: 0.8525
 Site-USPS                          | Val  Loss: 0.7004 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5565 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 0.8957 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.9347 | Val  Acc: 0.7194
 Site-MNIST_M                       | Val  Loss: 1.2763 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.2359 | Val  Acc: 0.6151
 Site-SVHN                          | Val  Loss: 1.3888 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.4268 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7018
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8525
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.7194
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.6151
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.5652
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.5053 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5470 | Train Acc: 0.8583
 Site-USPS                          | Train Loss: 0.5162 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.4975 | Train Acc: 0.8565
 Site-SynthDigits                   | Train Loss: 0.9817 | Train Acc: 0.6927
 Site-SynthDigits                   | Train Loss: 0.8914 | Train Acc: 0.7489
 Site-MNIST_M                       | Train Loss: 1.2715 | Train Acc: 0.5822
 Site-MNIST_M                       | Train Loss: 1.2914 | Train Acc: 0.5848
 Site-SVHN                          | Train Loss: 1.4984 | Train Acc: 0.5094
 Site-SVHN                          | Train Loss: 1.3930 | Train Acc: 0.5435
Average Train Accuracy: 0.7115
 Site-MNIST                         | Val  Loss: 0.5393 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5353 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.7056 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.5531 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 0.8891 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9313 | Val  Acc: 0.7230
 Site-MNIST_M                       | Val  Loss: 1.2860 | Val  Acc: 0.5652
 Site-MNIST_M                       | Val  Loss: 1.2383 | Val  Acc: 0.6115
 Site-SVHN                          | Val  Loss: 1.3785 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.4129 | Val  Acc: 0.5360
Average Valid Accuracy: 0.7007
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.4972 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.5285 | Train Acc: 0.8583
 Site-USPS                          | Train Loss: 0.5108 | Train Acc: 0.8679
 Site-USPS                          | Train Loss: 0.4859 | Train Acc: 0.8610
 Site-SynthDigits                   | Train Loss: 0.9805 | Train Acc: 0.6927
 Site-SynthDigits                   | Train Loss: 0.8749 | Train Acc: 0.7570
 Site-MNIST_M                       | Train Loss: 1.2619 | Train Acc: 0.5876
 Site-MNIST_M                       | Train Loss: 1.2736 | Train Acc: 0.5928
 Site-SVHN                          | Train Loss: 1.4949 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.3876 | Train Acc: 0.5462
Average Train Accuracy: 0.7146
 Site-MNIST                         | Val  Loss: 0.5357 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5256 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.6992 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.5438 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 0.8970 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.9274 | Val  Acc: 0.7230
 Site-MNIST_M                       | Val  Loss: 1.2741 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.2237 | Val  Acc: 0.6115
 Site-SVHN                          | Val  Loss: 1.3704 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.4100 | Val  Acc: 0.5360
Average Valid Accuracy: 0.6985
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.4865 | Train Acc: 0.8814
 Site-MNIST                         | Train Loss: 0.5239 | Train Acc: 0.8646
 Site-USPS                          | Train Loss: 0.4983 | Train Acc: 0.8760
 Site-USPS                          | Train Loss: 0.4774 | Train Acc: 0.8610
 Site-SynthDigits                   | Train Loss: 0.9568 | Train Acc: 0.6927
 Site-SynthDigits                   | Train Loss: 0.8662 | Train Acc: 0.7561
 Site-MNIST_M                       | Train Loss: 1.2698 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.2729 | Train Acc: 0.5883
 Site-SVHN                          | Train Loss: 1.4849 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 1.3646 | Train Acc: 0.5489
Average Train Accuracy: 0.7174
 Site-MNIST                         | Val  Loss: 0.5232 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5154 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.6842 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5348 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 0.8673 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.9008 | Val  Acc: 0.7338
 Site-MNIST_M                       | Val  Loss: 1.2726 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.2280 | Val  Acc: 0.6115
 Site-SVHN                          | Val  Loss: 1.3498 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.3967 | Val  Acc: 0.5360
Average Valid Accuracy: 0.7061
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.7338
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5870
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6115
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.5870
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.5360
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.4787 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.5122 | Train Acc: 0.8664
 Site-USPS                          | Train Loss: 0.4986 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.4713 | Train Acc: 0.8709
 Site-SynthDigits                   | Train Loss: 0.9669 | Train Acc: 0.6981
 Site-SynthDigits                   | Train Loss: 0.8633 | Train Acc: 0.7498
 Site-MNIST_M                       | Train Loss: 1.2396 | Train Acc: 0.6092
 Site-MNIST_M                       | Train Loss: 1.2342 | Train Acc: 0.6045
 Site-SVHN                          | Train Loss: 1.4977 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.3781 | Train Acc: 0.5462
Average Train Accuracy: 0.7196
 Site-MNIST                         | Val  Loss: 0.5110 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5019 | Val  Acc: 0.8597
 Site-USPS                          | Val  Loss: 0.6742 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.5257 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 0.8777 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9222 | Val  Acc: 0.7410
 Site-MNIST_M                       | Val  Loss: 1.2456 | Val  Acc: 0.6087
 Site-MNIST_M                       | Val  Loss: 1.1983 | Val  Acc: 0.6259
 Site-SVHN                          | Val  Loss: 1.3640 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.4014 | Val  Acc: 0.5396
Average Valid Accuracy: 0.7151
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8597
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7500
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7410
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6087
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6259
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.5870
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.5396
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.4713 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.5030 | Train Acc: 0.8664
 Site-USPS                          | Train Loss: 0.4943 | Train Acc: 0.8679
 Site-USPS                          | Train Loss: 0.4670 | Train Acc: 0.8628
 Site-SynthDigits                   | Train Loss: 0.9546 | Train Acc: 0.6981
 Site-SynthDigits                   | Train Loss: 0.8505 | Train Acc: 0.7578
 Site-MNIST_M                       | Train Loss: 1.2512 | Train Acc: 0.5984
 Site-MNIST_M                       | Train Loss: 1.2418 | Train Acc: 0.5973
 Site-SVHN                          | Train Loss: 1.4759 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 1.3714 | Train Acc: 0.5561
Average Train Accuracy: 0.7214
 Site-MNIST                         | Val  Loss: 0.5027 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.4956 | Val  Acc: 0.8525
 Site-USPS                          | Val  Loss: 0.6767 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5243 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 0.8654 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.9070 | Val  Acc: 0.7374
 Site-MNIST_M                       | Val  Loss: 1.2432 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.1981 | Val  Acc: 0.6115
 Site-SVHN                          | Val  Loss: 1.3423 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.3828 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7072
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.4644 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.4950 | Train Acc: 0.8700
 Site-USPS                          | Train Loss: 0.4809 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.4653 | Train Acc: 0.8646
 Site-SynthDigits                   | Train Loss: 0.9451 | Train Acc: 0.7143
 Site-SynthDigits                   | Train Loss: 0.8466 | Train Acc: 0.7605
 Site-MNIST_M                       | Train Loss: 1.2357 | Train Acc: 0.5903
 Site-MNIST_M                       | Train Loss: 1.2337 | Train Acc: 0.5991
 Site-SVHN                          | Train Loss: 1.4697 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.3501 | Train Acc: 0.5578
Average Train Accuracy: 0.7234
 Site-MNIST                         | Val  Loss: 0.5006 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.4891 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.6694 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5177 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 0.8527 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.8919 | Val  Acc: 0.7446
 Site-MNIST_M                       | Val  Loss: 1.2427 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.1950 | Val  Acc: 0.6115
 Site-SVHN                          | Val  Loss: 1.3361 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.3737 | Val  Acc: 0.5432
Average Valid Accuracy: 0.7094
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.4507 | Train Acc: 0.8814
 Site-MNIST                         | Train Loss: 0.4828 | Train Acc: 0.8726
 Site-USPS                          | Train Loss: 0.4803 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.4512 | Train Acc: 0.8700
 Site-SynthDigits                   | Train Loss: 0.9475 | Train Acc: 0.7035
 Site-SynthDigits                   | Train Loss: 0.8595 | Train Acc: 0.7605
 Site-MNIST_M                       | Train Loss: 1.2115 | Train Acc: 0.6065
 Site-MNIST_M                       | Train Loss: 1.2147 | Train Acc: 0.6143
 Site-SVHN                          | Train Loss: 1.4621 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.3464 | Train Acc: 0.5534
Average Train Accuracy: 0.7253
 Site-MNIST                         | Val  Loss: 0.4886 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.4771 | Val  Acc: 0.8669
 Site-USPS                          | Val  Loss: 0.6640 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5126 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 0.8630 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.8969 | Val  Acc: 0.7446
 Site-MNIST_M                       | Val  Loss: 1.2138 | Val  Acc: 0.6196
 Site-MNIST_M                       | Val  Loss: 1.1740 | Val  Acc: 0.6331
 Site-SVHN                          | Val  Loss: 1.3330 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.3751 | Val  Acc: 0.5288
Average Valid Accuracy: 0.7119
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.4421 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.4764 | Train Acc: 0.8753
 Site-USPS                          | Train Loss: 0.4770 | Train Acc: 0.8733
 Site-USPS                          | Train Loss: 0.4393 | Train Acc: 0.8700
 Site-SynthDigits                   | Train Loss: 0.9325 | Train Acc: 0.7116
 Site-SynthDigits                   | Train Loss: 0.8401 | Train Acc: 0.7605
 Site-MNIST_M                       | Train Loss: 1.2270 | Train Acc: 0.6065
 Site-MNIST_M                       | Train Loss: 1.2120 | Train Acc: 0.6108
 Site-SVHN                          | Train Loss: 1.4503 | Train Acc: 0.5310
 Site-SVHN                          | Train Loss: 1.3327 | Train Acc: 0.5578
Average Train Accuracy: 0.7289
 Site-MNIST                         | Val  Loss: 0.4870 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.4707 | Val  Acc: 0.8705
 Site-USPS                          | Val  Loss: 0.6581 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5083 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 0.8495 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.8818 | Val  Acc: 0.7410
 Site-MNIST_M                       | Val  Loss: 1.2209 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.1776 | Val  Acc: 0.6223
 Site-SVHN                          | Val  Loss: 1.3203 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.3626 | Val  Acc: 0.5360
Average Valid Accuracy: 0.7097
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.4399 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.4716 | Train Acc: 0.8798
 Site-USPS                          | Train Loss: 0.4682 | Train Acc: 0.8733
 Site-USPS                          | Train Loss: 0.4383 | Train Acc: 0.8762
 Site-SynthDigits                   | Train Loss: 0.9248 | Train Acc: 0.7116
 Site-SynthDigits                   | Train Loss: 0.8236 | Train Acc: 0.7650
 Site-MNIST_M                       | Train Loss: 1.2086 | Train Acc: 0.6065
 Site-MNIST_M                       | Train Loss: 1.2043 | Train Acc: 0.6179
 Site-SVHN                          | Train Loss: 1.4526 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.3350 | Train Acc: 0.5596
Average Train Accuracy: 0.7300
 Site-MNIST                         | Val  Loss: 0.4696 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.4613 | Val  Acc: 0.8705
 Site-USPS                          | Val  Loss: 0.6598 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5051 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 0.8419 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.8780 | Val  Acc: 0.7482
 Site-MNIST_M                       | Val  Loss: 1.2041 | Val  Acc: 0.6087
 Site-MNIST_M                       | Val  Loss: 1.1623 | Val  Acc: 0.6259
 Site-SVHN                          | Val  Loss: 1.3278 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.3646 | Val  Acc: 0.5576
Average Valid Accuracy: 0.7184
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8705
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7482
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6087
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6259
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.5576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.4339 | Train Acc: 0.9003
 Site-MNIST                         | Train Loss: 0.4608 | Train Acc: 0.8798
 Site-USPS                          | Train Loss: 0.4647 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.4410 | Train Acc: 0.8744
 Site-SynthDigits                   | Train Loss: 0.9165 | Train Acc: 0.7170
 Site-SynthDigits                   | Train Loss: 0.8129 | Train Acc: 0.7623
 Site-MNIST_M                       | Train Loss: 1.2035 | Train Acc: 0.6092
 Site-MNIST_M                       | Train Loss: 1.2060 | Train Acc: 0.6197
 Site-SVHN                          | Train Loss: 1.4416 | Train Acc: 0.5364
 Site-SVHN                          | Train Loss: 1.3229 | Train Acc: 0.5695
Average Train Accuracy: 0.7347
 Site-MNIST                         | Val  Loss: 0.4639 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.4580 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.6543 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5017 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 0.8261 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.8659 | Val  Acc: 0.7554
 Site-MNIST_M                       | Val  Loss: 1.2047 | Val  Acc: 0.6087
 Site-MNIST_M                       | Val  Loss: 1.1625 | Val  Acc: 0.6259
 Site-SVHN                          | Val  Loss: 1.3063 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.3537 | Val  Acc: 0.5612
Average Valid Accuracy: 0.7202
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8777
 Best site-USPS                      | Epoch:49 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.7554
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6087
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6259
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.5612
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/afl...
===2023-07-30 06:28:40===
===2023-07-30 06:28:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8727
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8688
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.7232
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.5414
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.4776
MNIST: 0.8727, USPS: 0.8688, SynthDigits: 0.7232, MNIST_M: 0.5414, SVHN: 0.4776, 
Average Test Accuracy(group): 0.6968, Average Test Accuracy(individual): 0.6968,
domain std=0.1634, cluster std=-1.0000, individual std=0.1634, 
