===2023-07-26 14:34:47===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
===2023-07-30 03:28:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.1207 | Train Acc: 0.5256
 Site-MNIST                         | Train Loss: 2.1439 | Train Acc: 0.4439
 Site-USPS                          | Train Loss: 2.0689 | Train Acc: 0.5175
 Site-USPS                          | Train Loss: 2.0711 | Train Acc: 0.5166
 Site-SynthDigits                   | Train Loss: 2.2410 | Train Acc: 0.2156
 Site-SynthDigits                   | Train Loss: 2.2136 | Train Acc: 0.2987
 Site-MNIST_M                       | Train Loss: 2.2769 | Train Acc: 0.1779
 Site-MNIST_M                       | Train Loss: 2.2744 | Train Acc: 0.1623
 Site-SVHN                          | Train Loss: 2.2582 | Train Acc: 0.1914
 Site-SVHN                          | Train Loss: 2.2552 | Train Acc: 0.2099
Average Train Accuracy: 0.3259
 Site-MNIST                         | Val  Loss: 2.1566 | Val  Acc: 0.4348
 Site-MNIST                         | Val  Loss: 2.1412 | Val  Acc: 0.4748
 Site-USPS                          | Val  Loss: 2.0953 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 2.0997 | Val  Acc: 0.4496
 Site-SynthDigits                   | Val  Loss: 2.2045 | Val  Acc: 0.3261
 Site-SynthDigits                   | Val  Loss: 2.2279 | Val  Acc: 0.2734
 Site-MNIST_M                       | Val  Loss: 2.2650 | Val  Acc: 0.1413
 Site-MNIST_M                       | Val  Loss: 2.2694 | Val  Acc: 0.1835
 Site-SVHN                          | Val  Loss: 2.2397 | Val  Acc: 0.2609
 Site-SVHN                          | Val  Loss: 2.2512 | Val  Acc: 0.1942
Average Valid Accuracy: 0.3228
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4348
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4748
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4496
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3261
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2734
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1413
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1835
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1942
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.9408 | Train Acc: 0.6280
 Site-MNIST                         | Train Loss: 1.9796 | Train Acc: 0.5435
 Site-USPS                          | Train Loss: 1.8849 | Train Acc: 0.5660
 Site-USPS                          | Train Loss: 1.8817 | Train Acc: 0.5919
 Site-SynthDigits                   | Train Loss: 2.1727 | Train Acc: 0.2749
 Site-SynthDigits                   | Train Loss: 2.1288 | Train Acc: 0.3587
 Site-MNIST_M                       | Train Loss: 2.2458 | Train Acc: 0.2318
 Site-MNIST_M                       | Train Loss: 2.2407 | Train Acc: 0.2143
 Site-SVHN                          | Train Loss: 2.2312 | Train Acc: 0.2507
 Site-SVHN                          | Train Loss: 2.2274 | Train Acc: 0.2511
Average Train Accuracy: 0.3911
 Site-MNIST                         | Val  Loss: 2.0024 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.9796 | Val  Acc: 0.5755
 Site-USPS                          | Val  Loss: 1.9180 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.9220 | Val  Acc: 0.5324
 Site-SynthDigits                   | Val  Loss: 2.1243 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1514 | Val  Acc: 0.3094
 Site-MNIST_M                       | Val  Loss: 2.2409 | Val  Acc: 0.1739
 Site-MNIST_M                       | Val  Loss: 2.2392 | Val  Acc: 0.2338
 Site-SVHN                          | Val  Loss: 2.2017 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2204 | Val  Acc: 0.2518
Average Valid Accuracy: 0.3816
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5755
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5324
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3094
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1739
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2338
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2518
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.7732 | Train Acc: 0.6900
 Site-MNIST                         | Train Loss: 1.8283 | Train Acc: 0.5731
 Site-USPS                          | Train Loss: 1.7042 | Train Acc: 0.6119
 Site-USPS                          | Train Loss: 1.7034 | Train Acc: 0.6430
 Site-SynthDigits                   | Train Loss: 2.1055 | Train Acc: 0.3154
 Site-SynthDigits                   | Train Loss: 2.0447 | Train Acc: 0.4072
 Site-MNIST_M                       | Train Loss: 2.2194 | Train Acc: 0.2399
 Site-MNIST_M                       | Train Loss: 2.2090 | Train Acc: 0.2323
 Site-SVHN                          | Train Loss: 2.2065 | Train Acc: 0.2668
 Site-SVHN                          | Train Loss: 2.1988 | Train Acc: 0.2744
Average Train Accuracy: 0.4254
 Site-MNIST                         | Val  Loss: 1.8485 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8259 | Val  Acc: 0.6115
 Site-USPS                          | Val  Loss: 1.7501 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.7522 | Val  Acc: 0.5647
 Site-SynthDigits                   | Val  Loss: 2.0427 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0756 | Val  Acc: 0.3381
 Site-MNIST_M                       | Val  Loss: 2.2178 | Val  Acc: 0.1957
 Site-MNIST_M                       | Val  Loss: 2.2081 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1660 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1907 | Val  Acc: 0.2698
Average Valid Accuracy: 0.4040
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6115
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5647
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3381
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1957
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.6252 | Train Acc: 0.7197
 Site-MNIST                         | Train Loss: 1.6903 | Train Acc: 0.6251
 Site-USPS                          | Train Loss: 1.5509 | Train Acc: 0.6469
 Site-USPS                          | Train Loss: 1.5428 | Train Acc: 0.6709
 Site-SynthDigits                   | Train Loss: 2.0397 | Train Acc: 0.3720
 Site-SynthDigits                   | Train Loss: 1.9709 | Train Acc: 0.4386
 Site-MNIST_M                       | Train Loss: 2.1889 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.1795 | Train Acc: 0.2547
 Site-SVHN                          | Train Loss: 2.1847 | Train Acc: 0.2911
 Site-SVHN                          | Train Loss: 2.1753 | Train Acc: 0.2789
Average Train Accuracy: 0.4551
 Site-MNIST                         | Val  Loss: 1.7046 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.6816 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.6078 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.6035 | Val  Acc: 0.6043
 Site-SynthDigits                   | Val  Loss: 1.9707 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 2.0080 | Val  Acc: 0.3957
 Site-MNIST_M                       | Val  Loss: 2.1884 | Val  Acc: 0.2283
 Site-MNIST_M                       | Val  Loss: 2.1780 | Val  Acc: 0.2806
 Site-SVHN                          | Val  Loss: 2.1338 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1650 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4426
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6043
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3957
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2283
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2806
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.4947 | Train Acc: 0.7628
 Site-MNIST                         | Train Loss: 1.5649 | Train Acc: 0.6726
 Site-USPS                          | Train Loss: 1.4001 | Train Acc: 0.6927
 Site-USPS                          | Train Loss: 1.3964 | Train Acc: 0.7058
 Site-SynthDigits                   | Train Loss: 1.9870 | Train Acc: 0.4124
 Site-SynthDigits                   | Train Loss: 1.8956 | Train Acc: 0.4619
 Site-MNIST_M                       | Train Loss: 2.1609 | Train Acc: 0.2776
 Site-MNIST_M                       | Train Loss: 2.1436 | Train Acc: 0.2789
 Site-SVHN                          | Train Loss: 2.1619 | Train Acc: 0.2884
 Site-SVHN                          | Train Loss: 2.1480 | Train Acc: 0.2987
Average Train Accuracy: 0.4852
 Site-MNIST                         | Val  Loss: 1.5791 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.5571 | Val  Acc: 0.7122
 Site-USPS                          | Val  Loss: 1.4689 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.4573 | Val  Acc: 0.6691
 Site-SynthDigits                   | Val  Loss: 1.9033 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.9438 | Val  Acc: 0.4281
 Site-MNIST_M                       | Val  Loss: 2.1574 | Val  Acc: 0.2609
 Site-MNIST_M                       | Val  Loss: 2.1446 | Val  Acc: 0.2950
 Site-SVHN                          | Val  Loss: 2.1041 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 2.1401 | Val  Acc: 0.3094
Average Valid Accuracy: 0.4816
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7122
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6691
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4281
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2609
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2950
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3094
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.3825 | Train Acc: 0.7628
 Site-MNIST                         | Train Loss: 1.4557 | Train Acc: 0.6942
 Site-USPS                          | Train Loss: 1.2727 | Train Acc: 0.7143
 Site-USPS                          | Train Loss: 1.2668 | Train Acc: 0.7587
 Site-SynthDigits                   | Train Loss: 1.9148 | Train Acc: 0.4313
 Site-SynthDigits                   | Train Loss: 1.8336 | Train Acc: 0.4924
 Site-MNIST_M                       | Train Loss: 2.0972 | Train Acc: 0.2965
 Site-MNIST_M                       | Train Loss: 2.0932 | Train Acc: 0.2978
 Site-SVHN                          | Train Loss: 2.1357 | Train Acc: 0.3019
 Site-SVHN                          | Train Loss: 2.1175 | Train Acc: 0.3013
Average Train Accuracy: 0.5051
 Site-MNIST                         | Val  Loss: 1.4737 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4531 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.3475 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.3244 | Val  Acc: 0.7086
 Site-SynthDigits                   | Val  Loss: 1.8339 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.8729 | Val  Acc: 0.4568
 Site-MNIST_M                       | Val  Loss: 2.1247 | Val  Acc: 0.2935
 Site-MNIST_M                       | Val  Loss: 2.0925 | Val  Acc: 0.3129
 Site-SVHN                          | Val  Loss: 2.0667 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 2.1087 | Val  Acc: 0.3273
Average Valid Accuracy: 0.5047
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7086
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4568
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2935
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3129
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.2992 | Train Acc: 0.7574
 Site-MNIST                         | Train Loss: 1.3675 | Train Acc: 0.7103
 Site-USPS                          | Train Loss: 1.1707 | Train Acc: 0.7601
 Site-USPS                          | Train Loss: 1.1565 | Train Acc: 0.7883
 Site-SynthDigits                   | Train Loss: 1.8248 | Train Acc: 0.4636
 Site-SynthDigits                   | Train Loss: 1.7341 | Train Acc: 0.5157
 Site-MNIST_M                       | Train Loss: 2.0129 | Train Acc: 0.3585
 Site-MNIST_M                       | Train Loss: 2.0459 | Train Acc: 0.3327
 Site-SVHN                          | Train Loss: 2.0898 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 2.0545 | Train Acc: 0.3202
Average Train Accuracy: 0.5336
 Site-MNIST                         | Val  Loss: 1.3892 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.3717 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.2243 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2079 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.7494 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.7706 | Val  Acc: 0.4856
 Site-MNIST_M                       | Val  Loss: 2.0645 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 2.0031 | Val  Acc: 0.3669
 Site-SVHN                          | Val  Loss: 1.9759 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 2.0436 | Val  Acc: 0.3741
Average Valid Accuracy: 0.5238
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4856
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3669
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3741
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.2105 | Train Acc: 0.7601
 Site-MNIST                         | Train Loss: 1.2794 | Train Acc: 0.7193
 Site-USPS                          | Train Loss: 1.1001 | Train Acc: 0.7547
 Site-USPS                          | Train Loss: 1.0775 | Train Acc: 0.7937
 Site-SynthDigits                   | Train Loss: 1.7594 | Train Acc: 0.4906
 Site-SynthDigits                   | Train Loss: 1.6709 | Train Acc: 0.5435
 Site-MNIST_M                       | Train Loss: 1.9709 | Train Acc: 0.3827
 Site-MNIST_M                       | Train Loss: 2.0065 | Train Acc: 0.3408
 Site-SVHN                          | Train Loss: 2.0596 | Train Acc: 0.3181
 Site-SVHN                          | Train Loss: 2.0199 | Train Acc: 0.3283
Average Train Accuracy: 0.5432
 Site-MNIST                         | Val  Loss: 1.3054 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.2834 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.1593 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.1348 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.6834 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.7049 | Val  Acc: 0.5072
 Site-MNIST_M                       | Val  Loss: 2.0378 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 1.9588 | Val  Acc: 0.3885
 Site-SVHN                          | Val  Loss: 1.9440 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 2.0083 | Val  Acc: 0.3705
Average Valid Accuracy: 0.5357
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7266
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5072
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3885
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3705
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.1391 | Train Acc: 0.7736
 Site-MNIST                         | Train Loss: 1.1952 | Train Acc: 0.7480
 Site-USPS                          | Train Loss: 1.0206 | Train Acc: 0.7736
 Site-USPS                          | Train Loss: 1.0044 | Train Acc: 0.8027
 Site-SynthDigits                   | Train Loss: 1.7085 | Train Acc: 0.5067
 Site-SynthDigits                   | Train Loss: 1.6190 | Train Acc: 0.5578
 Site-MNIST_M                       | Train Loss: 1.9118 | Train Acc: 0.3962
 Site-MNIST_M                       | Train Loss: 1.9634 | Train Acc: 0.3561
 Site-SVHN                          | Train Loss: 2.0222 | Train Acc: 0.3073
 Site-SVHN                          | Train Loss: 1.9828 | Train Acc: 0.3327
Average Train Accuracy: 0.5555
 Site-MNIST                         | Val  Loss: 1.2203 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.2001 | Val  Acc: 0.7482
 Site-USPS                          | Val  Loss: 1.0786 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 1.0529 | Val  Acc: 0.7590
 Site-SynthDigits                   | Val  Loss: 1.6257 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6458 | Val  Acc: 0.5324
 Site-MNIST_M                       | Val  Loss: 1.9974 | Val  Acc: 0.3152
 Site-MNIST_M                       | Val  Loss: 1.9112 | Val  Acc: 0.3993
 Site-SVHN                          | Val  Loss: 1.9099 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.9704 | Val  Acc: 0.3633
Average Valid Accuracy: 0.5465
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7482
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7590
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5324
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3152
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3993
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3633
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.0746 | Train Acc: 0.7898
 Site-MNIST                         | Train Loss: 1.1236 | Train Acc: 0.7596
 Site-USPS                          | Train Loss: 0.9611 | Train Acc: 0.7898
 Site-USPS                          | Train Loss: 0.9324 | Train Acc: 0.8099
 Site-SynthDigits                   | Train Loss: 1.6547 | Train Acc: 0.5040
 Site-SynthDigits                   | Train Loss: 1.5525 | Train Acc: 0.5713
 Site-MNIST_M                       | Train Loss: 1.8715 | Train Acc: 0.3962
 Site-MNIST_M                       | Train Loss: 1.9253 | Train Acc: 0.3704
 Site-SVHN                          | Train Loss: 1.9948 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 1.9558 | Train Acc: 0.3435
Average Train Accuracy: 0.5663
 Site-MNIST                         | Val  Loss: 1.1508 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.1331 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.0185 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.9866 | Val  Acc: 0.7734
 Site-SynthDigits                   | Val  Loss: 1.5730 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.5917 | Val  Acc: 0.5252
 Site-MNIST_M                       | Val  Loss: 1.9673 | Val  Acc: 0.3152
 Site-MNIST_M                       | Val  Loss: 1.8713 | Val  Acc: 0.3957
 Site-SVHN                          | Val  Loss: 1.8871 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.9450 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5534
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7734
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5252
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3152
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3957
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 1.0004 | Train Acc: 0.7898
 Site-MNIST                         | Train Loss: 1.0560 | Train Acc: 0.7758
 Site-USPS                          | Train Loss: 0.8991 | Train Acc: 0.8113
 Site-USPS                          | Train Loss: 0.8723 | Train Acc: 0.8170
 Site-SynthDigits                   | Train Loss: 1.6162 | Train Acc: 0.5148
 Site-SynthDigits                   | Train Loss: 1.5108 | Train Acc: 0.5812
 Site-MNIST_M                       | Train Loss: 1.8410 | Train Acc: 0.4043
 Site-MNIST_M                       | Train Loss: 1.8890 | Train Acc: 0.3839
 Site-SVHN                          | Train Loss: 1.9827 | Train Acc: 0.3261
 Site-SVHN                          | Train Loss: 1.9306 | Train Acc: 0.3525
Average Train Accuracy: 0.5757
 Site-MNIST                         | Val  Loss: 1.0866 | Val  Acc: 0.7283
 Site-MNIST                         | Val  Loss: 1.0615 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 0.9566 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.9216 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 1.5307 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.5533 | Val  Acc: 0.5468
 Site-MNIST_M                       | Val  Loss: 1.9339 | Val  Acc: 0.3370
 Site-MNIST_M                       | Val  Loss: 1.8369 | Val  Acc: 0.4173
 Site-SVHN                          | Val  Loss: 1.8604 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.9221 | Val  Acc: 0.3669
Average Valid Accuracy: 0.5675
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7283
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7842
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7770
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5468
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3370
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4173
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3669
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.9408 | Train Acc: 0.8032
 Site-MNIST                         | Train Loss: 0.9978 | Train Acc: 0.7865
 Site-USPS                          | Train Loss: 0.8317 | Train Acc: 0.8383
 Site-USPS                          | Train Loss: 0.8066 | Train Acc: 0.8269
 Site-SynthDigits                   | Train Loss: 1.5849 | Train Acc: 0.5283
 Site-SynthDigits                   | Train Loss: 1.4798 | Train Acc: 0.5857
 Site-MNIST_M                       | Train Loss: 1.8075 | Train Acc: 0.4151
 Site-MNIST_M                       | Train Loss: 1.8598 | Train Acc: 0.3973
 Site-SVHN                          | Train Loss: 1.9767 | Train Acc: 0.3100
 Site-SVHN                          | Train Loss: 1.9218 | Train Acc: 0.3444
Average Train Accuracy: 0.5836
 Site-MNIST                         | Val  Loss: 1.0266 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.0008 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 0.8976 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.8530 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.5035 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.5192 | Val  Acc: 0.5468
 Site-MNIST_M                       | Val  Loss: 1.9000 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.7994 | Val  Acc: 0.4388
 Site-SVHN                          | Val  Loss: 1.8480 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.9106 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5743
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7842
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5468
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4388
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.8942 | Train Acc: 0.8059
 Site-MNIST                         | Train Loss: 0.9519 | Train Acc: 0.7919
 Site-USPS                          | Train Loss: 0.8095 | Train Acc: 0.8383
 Site-USPS                          | Train Loss: 0.7705 | Train Acc: 0.8215
 Site-SynthDigits                   | Train Loss: 1.5393 | Train Acc: 0.5337
 Site-SynthDigits                   | Train Loss: 1.4381 | Train Acc: 0.6018
 Site-MNIST_M                       | Train Loss: 1.7837 | Train Acc: 0.4124
 Site-MNIST_M                       | Train Loss: 1.8386 | Train Acc: 0.3964
 Site-SVHN                          | Train Loss: 1.9465 | Train Acc: 0.3423
 Site-SVHN                          | Train Loss: 1.8892 | Train Acc: 0.3587
Average Train Accuracy: 0.5903
 Site-MNIST                         | Val  Loss: 0.9745 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.9534 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.8841 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.8279 | Val  Acc: 0.7806
 Site-SynthDigits                   | Val  Loss: 1.4553 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.4702 | Val  Acc: 0.5432
 Site-MNIST_M                       | Val  Loss: 1.8790 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.7781 | Val  Acc: 0.4496
 Site-SVHN                          | Val  Loss: 1.8148 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.8791 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5758
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7806
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5432
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4496
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.8327 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.9005 | Train Acc: 0.7991
 Site-USPS                          | Train Loss: 0.7518 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.7207 | Train Acc: 0.8422
 Site-SynthDigits                   | Train Loss: 1.5172 | Train Acc: 0.5310
 Site-SynthDigits                   | Train Loss: 1.4181 | Train Acc: 0.6000
 Site-MNIST_M                       | Train Loss: 1.7591 | Train Acc: 0.4367
 Site-MNIST_M                       | Train Loss: 1.8055 | Train Acc: 0.4045
 Site-SVHN                          | Train Loss: 1.9454 | Train Acc: 0.3342
 Site-SVHN                          | Train Loss: 1.8777 | Train Acc: 0.3623
Average Train Accuracy: 0.5976
 Site-MNIST                         | Val  Loss: 0.9288 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.9006 | Val  Acc: 0.8022
 Site-USPS                          | Val  Loss: 0.8333 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.7760 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.4398 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.4518 | Val  Acc: 0.5612
 Site-MNIST_M                       | Val  Loss: 1.8480 | Val  Acc: 0.3587
 Site-MNIST_M                       | Val  Loss: 1.7464 | Val  Acc: 0.4604
 Site-SVHN                          | Val  Loss: 1.8030 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.8648 | Val  Acc: 0.3633
Average Valid Accuracy: 0.5859
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8022
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5612
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.3587
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4604
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3633
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.8083 | Train Acc: 0.8221
 Site-MNIST                         | Train Loss: 0.8534 | Train Acc: 0.8081
 Site-USPS                          | Train Loss: 0.7169 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.6793 | Train Acc: 0.8457
 Site-SynthDigits                   | Train Loss: 1.4939 | Train Acc: 0.5445
 Site-SynthDigits                   | Train Loss: 1.3858 | Train Acc: 0.6108
 Site-MNIST_M                       | Train Loss: 1.7170 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.7705 | Train Acc: 0.4305
 Site-SVHN                          | Train Loss: 1.9342 | Train Acc: 0.3477
 Site-SVHN                          | Train Loss: 1.8665 | Train Acc: 0.3632
Average Train Accuracy: 0.6091
 Site-MNIST                         | Val  Loss: 0.8802 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.8578 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.7997 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.7317 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.4173 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.4224 | Val  Acc: 0.5683
 Site-MNIST_M                       | Val  Loss: 1.8108 | Val  Acc: 0.3913
 Site-MNIST_M                       | Val  Loss: 1.7146 | Val  Acc: 0.4856
 Site-SVHN                          | Val  Loss: 1.7842 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8456 | Val  Acc: 0.3705
Average Valid Accuracy: 0.5956
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8165
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5683
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.3913
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4856
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3705
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.7463 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.8096 | Train Acc: 0.8152
 Site-USPS                          | Train Loss: 0.6870 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.6430 | Train Acc: 0.8520
 Site-SynthDigits                   | Train Loss: 1.4727 | Train Acc: 0.5418
 Site-SynthDigits                   | Train Loss: 1.3465 | Train Acc: 0.6152
 Site-MNIST_M                       | Train Loss: 1.6969 | Train Acc: 0.4663
 Site-MNIST_M                       | Train Loss: 1.7546 | Train Acc: 0.4197
 Site-SVHN                          | Train Loss: 1.9057 | Train Acc: 0.3585
 Site-SVHN                          | Train Loss: 1.8338 | Train Acc: 0.3740
Average Train Accuracy: 0.6138
 Site-MNIST                         | Val  Loss: 0.8381 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.8103 | Val  Acc: 0.8129
 Site-USPS                          | Val  Loss: 0.7789 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.7030 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.3984 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.3947 | Val  Acc: 0.5612
 Site-MNIST_M                       | Val  Loss: 1.7886 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.6954 | Val  Acc: 0.4964
 Site-SVHN                          | Val  Loss: 1.7641 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.8267 | Val  Acc: 0.3813
Average Valid Accuracy: 0.5978
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8129
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5612
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4964
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3813
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.7298 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.7906 | Train Acc: 0.8179
 Site-USPS                          | Train Loss: 0.6576 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.6069 | Train Acc: 0.8637
 Site-SynthDigits                   | Train Loss: 1.4396 | Train Acc: 0.5580
 Site-SynthDigits                   | Train Loss: 1.3230 | Train Acc: 0.6233
 Site-MNIST_M                       | Train Loss: 1.6791 | Train Acc: 0.4717
 Site-MNIST_M                       | Train Loss: 1.7286 | Train Acc: 0.4332
 Site-SVHN                          | Train Loss: 1.8983 | Train Acc: 0.3585
 Site-SVHN                          | Train Loss: 1.8316 | Train Acc: 0.3695
Average Train Accuracy: 0.6197
 Site-MNIST                         | Val  Loss: 0.8071 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.7792 | Val  Acc: 0.8273
 Site-USPS                          | Val  Loss: 0.7492 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.6717 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 1.3736 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.3715 | Val  Acc: 0.5683
 Site-MNIST_M                       | Val  Loss: 1.7640 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.6742 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.7480 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8113 | Val  Acc: 0.3777
Average Valid Accuracy: 0.6014
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7935
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8273
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8165
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5683
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3777
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.6963 | Train Acc: 0.8410
 Site-MNIST                         | Train Loss: 0.7479 | Train Acc: 0.8269
 Site-USPS                          | Train Loss: 0.6407 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.5833 | Train Acc: 0.8646
 Site-SynthDigits                   | Train Loss: 1.4240 | Train Acc: 0.5553
 Site-SynthDigits                   | Train Loss: 1.3062 | Train Acc: 0.6260
 Site-MNIST_M                       | Train Loss: 1.6518 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.7041 | Train Acc: 0.4430
 Site-SVHN                          | Train Loss: 1.8928 | Train Acc: 0.3612
 Site-SVHN                          | Train Loss: 1.8133 | Train Acc: 0.3758
Average Train Accuracy: 0.6220
 Site-MNIST                         | Val  Loss: 0.7706 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.7422 | Val  Acc: 0.8309
 Site-USPS                          | Val  Loss: 0.7297 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.6460 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.3571 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.3510 | Val  Acc: 0.5791
 Site-MNIST_M                       | Val  Loss: 1.7428 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.6496 | Val  Acc: 0.4928
 Site-SVHN                          | Val  Loss: 1.7356 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.7979 | Val  Acc: 0.3741
Average Valid Accuracy: 0.6025
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8309
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5791
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4928
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3741
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.6656 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.7254 | Train Acc: 0.8287
 Site-USPS                          | Train Loss: 0.6267 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.5730 | Train Acc: 0.8628
 Site-SynthDigits                   | Train Loss: 1.3923 | Train Acc: 0.5876
 Site-SynthDigits                   | Train Loss: 1.2731 | Train Acc: 0.6341
 Site-MNIST_M                       | Train Loss: 1.6513 | Train Acc: 0.4690
 Site-MNIST_M                       | Train Loss: 1.7025 | Train Acc: 0.4305
 Site-SVHN                          | Train Loss: 1.8748 | Train Acc: 0.3827
 Site-SVHN                          | Train Loss: 1.7958 | Train Acc: 0.3946
Average Train Accuracy: 0.6299
 Site-MNIST                         | Val  Loss: 0.7333 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.7183 | Val  Acc: 0.8417
 Site-USPS                          | Val  Loss: 0.7371 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.6442 | Val  Acc: 0.8058
 Site-SynthDigits                   | Val  Loss: 1.3235 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.3131 | Val  Acc: 0.5935
 Site-MNIST_M                       | Val  Loss: 1.7405 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.6435 | Val  Acc: 0.4820
 Site-SVHN                          | Val  Loss: 1.7214 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7792 | Val  Acc: 0.3921
Average Valid Accuracy: 0.6050
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8417
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8058
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5935
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4820
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3921
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.6421 | Train Acc: 0.8544
 Site-MNIST                         | Train Loss: 0.6810 | Train Acc: 0.8368
 Site-USPS                          | Train Loss: 0.5924 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.5456 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.3861 | Train Acc: 0.5633
 Site-SynthDigits                   | Train Loss: 1.2629 | Train Acc: 0.6413
 Site-MNIST_M                       | Train Loss: 1.6108 | Train Acc: 0.4744
 Site-MNIST_M                       | Train Loss: 1.6597 | Train Acc: 0.4493
 Site-SVHN                          | Train Loss: 1.8650 | Train Acc: 0.3747
 Site-SVHN                          | Train Loss: 1.7782 | Train Acc: 0.3955
Average Train Accuracy: 0.6337
 Site-MNIST                         | Val  Loss: 0.7025 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.6818 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.7024 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.6118 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.3191 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.3123 | Val  Acc: 0.5863
 Site-MNIST_M                       | Val  Loss: 1.7011 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.6060 | Val  Acc: 0.4892
 Site-SVHN                          | Val  Loss: 1.7076 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7656 | Val  Acc: 0.4065
Average Valid Accuracy: 0.6129
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5863
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4892
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.6150 | Train Acc: 0.8544
 Site-MNIST                         | Train Loss: 0.6671 | Train Acc: 0.8404
 Site-USPS                          | Train Loss: 0.5769 | Train Acc: 0.8760
 Site-USPS                          | Train Loss: 0.5271 | Train Acc: 0.8726
 Site-SynthDigits                   | Train Loss: 1.3626 | Train Acc: 0.5741
 Site-SynthDigits                   | Train Loss: 1.2436 | Train Acc: 0.6457
 Site-MNIST_M                       | Train Loss: 1.6049 | Train Acc: 0.4798
 Site-MNIST_M                       | Train Loss: 1.6530 | Train Acc: 0.4538
 Site-SVHN                          | Train Loss: 1.8382 | Train Acc: 0.3881
 Site-SVHN                          | Train Loss: 1.7535 | Train Acc: 0.4072
Average Train Accuracy: 0.6392
 Site-MNIST                         | Val  Loss: 0.6735 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.6577 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.6906 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5946 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.2996 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.2868 | Val  Acc: 0.6007
 Site-MNIST_M                       | Val  Loss: 1.6903 | Val  Acc: 0.3804
 Site-MNIST_M                       | Val  Loss: 1.5932 | Val  Acc: 0.5036
 Site-SVHN                          | Val  Loss: 1.6915 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.7504 | Val  Acc: 0.4101
Average Valid Accuracy: 0.6212
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:20 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6007
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.3804
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5036
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4101
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.6017 | Train Acc: 0.8598
 Site-MNIST                         | Train Loss: 0.6552 | Train Acc: 0.8475
 Site-USPS                          | Train Loss: 0.5650 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.5174 | Train Acc: 0.8717
 Site-SynthDigits                   | Train Loss: 1.3417 | Train Acc: 0.5849
 Site-SynthDigits                   | Train Loss: 1.2239 | Train Acc: 0.6457
 Site-MNIST_M                       | Train Loss: 1.5815 | Train Acc: 0.4744
 Site-MNIST_M                       | Train Loss: 1.6383 | Train Acc: 0.4511
 Site-SVHN                          | Train Loss: 1.8296 | Train Acc: 0.3854
 Site-SVHN                          | Train Loss: 1.7427 | Train Acc: 0.4143
Average Train Accuracy: 0.6414
 Site-MNIST                         | Val  Loss: 0.6508 | Val  Acc: 0.8370
 Site-MNIST                         | Val  Loss: 0.6359 | Val  Acc: 0.8633
 Site-USPS                          | Val  Loss: 0.6846 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.5825 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.2842 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2669 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.6886 | Val  Acc: 0.3913
 Site-MNIST_M                       | Val  Loss: 1.5828 | Val  Acc: 0.4928
 Site-SVHN                          | Val  Loss: 1.6783 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.7362 | Val  Acc: 0.4065
Average Valid Accuracy: 0.6245
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8370
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8633
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6079
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.3913
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4928
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.5819 | Train Acc: 0.8544
 Site-MNIST                         | Train Loss: 0.6234 | Train Acc: 0.8493
 Site-USPS                          | Train Loss: 0.5365 | Train Acc: 0.8841
 Site-USPS                          | Train Loss: 0.4918 | Train Acc: 0.8762
 Site-SynthDigits                   | Train Loss: 1.3304 | Train Acc: 0.5714
 Site-SynthDigits                   | Train Loss: 1.2102 | Train Acc: 0.6502
 Site-MNIST_M                       | Train Loss: 1.5665 | Train Acc: 0.4879
 Site-MNIST_M                       | Train Loss: 1.6038 | Train Acc: 0.4673
 Site-SVHN                          | Train Loss: 1.8257 | Train Acc: 0.3827
 Site-SVHN                          | Train Loss: 1.7376 | Train Acc: 0.4108
Average Train Accuracy: 0.6434
 Site-MNIST                         | Val  Loss: 0.6249 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.6083 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.6620 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5589 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.2624 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.2584 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.6619 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.5573 | Val  Acc: 0.5144
 Site-SVHN                          | Val  Loss: 1.6702 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.7340 | Val  Acc: 0.4029
Average Valid Accuracy: 0.6241
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.5628 | Train Acc: 0.8598
 Site-MNIST                         | Train Loss: 0.6131 | Train Acc: 0.8502
 Site-USPS                          | Train Loss: 0.5226 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4828 | Train Acc: 0.8789
 Site-SynthDigits                   | Train Loss: 1.3079 | Train Acc: 0.5768
 Site-SynthDigits                   | Train Loss: 1.1915 | Train Acc: 0.6538
 Site-MNIST_M                       | Train Loss: 1.5611 | Train Acc: 0.4825
 Site-MNIST_M                       | Train Loss: 1.6005 | Train Acc: 0.4726
 Site-SVHN                          | Train Loss: 1.8216 | Train Acc: 0.3881
 Site-SVHN                          | Train Loss: 1.7266 | Train Acc: 0.4188
Average Train Accuracy: 0.6469
 Site-MNIST                         | Val  Loss: 0.6013 | Val  Acc: 0.8370
 Site-MNIST                         | Val  Loss: 0.5903 | Val  Acc: 0.8633
 Site-USPS                          | Val  Loss: 0.6603 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.5469 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.2513 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2383 | Val  Acc: 0.6115
 Site-MNIST_M                       | Val  Loss: 1.6541 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.5509 | Val  Acc: 0.5144
 Site-SVHN                          | Val  Loss: 1.6554 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.7205 | Val  Acc: 0.4173
Average Valid Accuracy: 0.6288
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8370
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8633
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8381
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.6115
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5144
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4173
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.5451 | Train Acc: 0.8625
 Site-MNIST                         | Train Loss: 0.5965 | Train Acc: 0.8502
 Site-USPS                          | Train Loss: 0.5248 | Train Acc: 0.8841
 Site-USPS                          | Train Loss: 0.4748 | Train Acc: 0.8843
 Site-SynthDigits                   | Train Loss: 1.2885 | Train Acc: 0.5984
 Site-SynthDigits                   | Train Loss: 1.1881 | Train Acc: 0.6565
 Site-MNIST_M                       | Train Loss: 1.5551 | Train Acc: 0.4744
 Site-MNIST_M                       | Train Loss: 1.5925 | Train Acc: 0.4700
 Site-SVHN                          | Train Loss: 1.8059 | Train Acc: 0.3908
 Site-SVHN                          | Train Loss: 1.7093 | Train Acc: 0.4251
Average Train Accuracy: 0.6496
 Site-MNIST                         | Val  Loss: 0.5865 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5725 | Val  Acc: 0.8669
 Site-USPS                          | Val  Loss: 0.6677 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 0.5419 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.2364 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.2223 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.6384 | Val  Acc: 0.4348
 Site-MNIST_M                       | Val  Loss: 1.5436 | Val  Acc: 0.5144
 Site-SVHN                          | Val  Loss: 1.6401 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.7049 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6353
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8669
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8381
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4348
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5144
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.5286 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.5784 | Train Acc: 0.8655
 Site-USPS                          | Train Loss: 0.5018 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4569 | Train Acc: 0.8870
 Site-SynthDigits                   | Train Loss: 1.2878 | Train Acc: 0.5768
 Site-SynthDigits                   | Train Loss: 1.1651 | Train Acc: 0.6592
 Site-MNIST_M                       | Train Loss: 1.5199 | Train Acc: 0.5094
 Site-MNIST_M                       | Train Loss: 1.5674 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.7978 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 1.6962 | Train Acc: 0.4215
Average Train Accuracy: 0.6556
 Site-MNIST                         | Val  Loss: 0.5628 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.5510 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.6354 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.5202 | Val  Acc: 0.8417
 Site-SynthDigits                   | Val  Loss: 1.2312 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2203 | Val  Acc: 0.6043
 Site-MNIST_M                       | Val  Loss: 1.6191 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.5219 | Val  Acc: 0.5252
 Site-SVHN                          | Val  Loss: 1.6301 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6918 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6368
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8777
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8417
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6043
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.4239
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5252
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4317
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.5183 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.5547 | Train Acc: 0.8646
 Site-USPS                          | Train Loss: 0.4975 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4462 | Train Acc: 0.8852
 Site-SynthDigits                   | Train Loss: 1.2788 | Train Acc: 0.5768
 Site-SynthDigits                   | Train Loss: 1.1564 | Train Acc: 0.6673
 Site-MNIST_M                       | Train Loss: 1.5047 | Train Acc: 0.5121
 Site-MNIST_M                       | Train Loss: 1.5515 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.7927 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.6984 | Train Acc: 0.4233
Average Train Accuracy: 0.6576
 Site-MNIST                         | Val  Loss: 0.5473 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5298 | Val  Acc: 0.8741
 Site-USPS                          | Val  Loss: 0.6348 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.5149 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.2109 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.2043 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.6024 | Val  Acc: 0.4348
 Site-MNIST_M                       | Val  Loss: 1.5006 | Val  Acc: 0.5252
 Site-SVHN                          | Val  Loss: 1.6222 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6857 | Val  Acc: 0.4209
Average Valid Accuracy: 0.6364
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.4892 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5337 | Train Acc: 0.8646
 Site-USPS                          | Train Loss: 0.4798 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4332 | Train Acc: 0.8915
 Site-SynthDigits                   | Train Loss: 1.2587 | Train Acc: 0.5930
 Site-SynthDigits                   | Train Loss: 1.1414 | Train Acc: 0.6753
 Site-MNIST_M                       | Train Loss: 1.5000 | Train Acc: 0.5121
 Site-MNIST_M                       | Train Loss: 1.5464 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.7911 | Train Acc: 0.3935
 Site-SVHN                          | Train Loss: 1.6773 | Train Acc: 0.4242
Average Train Accuracy: 0.6615
 Site-MNIST                         | Val  Loss: 0.5271 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5142 | Val  Acc: 0.8741
 Site-USPS                          | Val  Loss: 0.6192 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4971 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1979 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.1844 | Val  Acc: 0.6187
 Site-MNIST_M                       | Val  Loss: 1.5884 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.4949 | Val  Acc: 0.5216
 Site-SVHN                          | Val  Loss: 1.6111 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6759 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6389
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8741
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6187
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.4239
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5216
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.4909 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.5240 | Train Acc: 0.8628
 Site-USPS                          | Train Loss: 0.4701 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4218 | Train Acc: 0.8915
 Site-SynthDigits                   | Train Loss: 1.2465 | Train Acc: 0.5876
 Site-SynthDigits                   | Train Loss: 1.1289 | Train Acc: 0.6700
 Site-MNIST_M                       | Train Loss: 1.4864 | Train Acc: 0.5283
 Site-MNIST_M                       | Train Loss: 1.5299 | Train Acc: 0.4906
 Site-SVHN                          | Train Loss: 1.7791 | Train Acc: 0.4070
 Site-SVHN                          | Train Loss: 1.6692 | Train Acc: 0.4278
Average Train Accuracy: 0.6623
 Site-MNIST                         | Val  Loss: 0.5111 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.5014 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.6202 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4921 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1859 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.1731 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.5720 | Val  Acc: 0.4348
 Site-MNIST_M                       | Val  Loss: 1.4774 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.6072 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6668 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6458
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:28 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6259
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.4348
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5432
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.4611 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.5039 | Train Acc: 0.8717
 Site-USPS                          | Train Loss: 0.4539 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4157 | Train Acc: 0.8915
 Site-SynthDigits                   | Train Loss: 1.2377 | Train Acc: 0.5957
 Site-SynthDigits                   | Train Loss: 1.1092 | Train Acc: 0.6691
 Site-MNIST_M                       | Train Loss: 1.4664 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.5056 | Train Acc: 0.5076
 Site-SVHN                          | Train Loss: 1.7776 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.6652 | Train Acc: 0.4251
Average Train Accuracy: 0.6653
 Site-MNIST                         | Val  Loss: 0.4863 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4809 | Val  Acc: 0.8885
 Site-USPS                          | Val  Loss: 0.5976 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4715 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1694 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.1596 | Val  Acc: 0.6187
 Site-MNIST_M                       | Val  Loss: 1.5504 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.4570 | Val  Acc: 0.5468
 Site-SVHN                          | Val  Loss: 1.6087 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.6657 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6461
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8885
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6187
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5468
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.4539 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5036 | Train Acc: 0.8717
 Site-USPS                          | Train Loss: 0.4549 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4119 | Train Acc: 0.8924
 Site-SynthDigits                   | Train Loss: 1.2173 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 1.0898 | Train Acc: 0.6798
 Site-MNIST_M                       | Train Loss: 1.4664 | Train Acc: 0.5310
 Site-MNIST_M                       | Train Loss: 1.4870 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.7689 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.6552 | Train Acc: 0.4332
Average Train Accuracy: 0.6688
 Site-MNIST                         | Val  Loss: 0.4762 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4706 | Val  Acc: 0.8885
 Site-USPS                          | Val  Loss: 0.6039 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4810 | Val  Acc: 0.8453
 Site-SynthDigits                   | Val  Loss: 1.1513 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.1383 | Val  Acc: 0.6295
 Site-MNIST_M                       | Val  Loss: 1.5451 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.4506 | Val  Acc: 0.5540
 Site-SVHN                          | Val  Loss: 1.5928 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6539 | Val  Acc: 0.4424
Average Valid Accuracy: 0.6512
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8885
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8453
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6295
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5540
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.4458 | Train Acc: 0.8814
 Site-MNIST                         | Train Loss: 0.4846 | Train Acc: 0.8843
 Site-USPS                          | Train Loss: 0.4276 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3840 | Train Acc: 0.9013
 Site-SynthDigits                   | Train Loss: 1.2276 | Train Acc: 0.5930
 Site-SynthDigits                   | Train Loss: 1.0996 | Train Acc: 0.6807
 Site-MNIST_M                       | Train Loss: 1.4437 | Train Acc: 0.5337
 Site-MNIST_M                       | Train Loss: 1.4749 | Train Acc: 0.5283
 Site-SVHN                          | Train Loss: 1.7649 | Train Acc: 0.4043
 Site-SVHN                          | Train Loss: 1.6615 | Train Acc: 0.4242
Average Train Accuracy: 0.6740
 Site-MNIST                         | Val  Loss: 0.4599 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.4509 | Val  Acc: 0.8957
 Site-USPS                          | Val  Loss: 0.5639 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.4426 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.1539 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.1533 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.5151 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.4249 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.5972 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.6585 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6566
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8957
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6259
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5612
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4317
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.4359 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.4826 | Train Acc: 0.8789
 Site-USPS                          | Train Loss: 0.4350 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.3859 | Train Acc: 0.8978
 Site-SynthDigits                   | Train Loss: 1.2030 | Train Acc: 0.6146
 Site-SynthDigits                   | Train Loss: 1.0738 | Train Acc: 0.6816
 Site-MNIST_M                       | Train Loss: 1.4201 | Train Acc: 0.5337
 Site-MNIST_M                       | Train Loss: 1.4575 | Train Acc: 0.5327
 Site-SVHN                          | Train Loss: 1.7416 | Train Acc: 0.4124
 Site-SVHN                          | Train Loss: 1.6429 | Train Acc: 0.4305
Average Train Accuracy: 0.6761
 Site-MNIST                         | Val  Loss: 0.4599 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4483 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.5738 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.4522 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.1238 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.1238 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.5150 | Val  Acc: 0.4674
 Site-MNIST_M                       | Val  Loss: 1.4269 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.5779 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.6470 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6570
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8921
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8561
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6475
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.4674
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5576
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4317
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.4275 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.4678 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4381 | Train Acc: 0.8922
 Site-USPS                          | Train Loss: 0.3859 | Train Acc: 0.8960
 Site-SynthDigits                   | Train Loss: 1.1911 | Train Acc: 0.6146
 Site-SynthDigits                   | Train Loss: 1.0653 | Train Acc: 0.6798
 Site-MNIST_M                       | Train Loss: 1.4184 | Train Acc: 0.5418
 Site-MNIST_M                       | Train Loss: 1.4410 | Train Acc: 0.5336
 Site-SVHN                          | Train Loss: 1.7425 | Train Acc: 0.4070
 Site-SVHN                          | Train Loss: 1.6393 | Train Acc: 0.4368
Average Train Accuracy: 0.6755
 Site-MNIST                         | Val  Loss: 0.4428 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.4400 | Val  Acc: 0.8993
 Site-USPS                          | Val  Loss: 0.5912 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4551 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1126 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.1024 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.4914 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.4060 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.5761 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6353 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6649
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8993
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6304
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6475
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.4891
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5755
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4460
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.4142 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.4421 | Train Acc: 0.8879
 Site-USPS                          | Train Loss: 0.4204 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.3690 | Train Acc: 0.8933
 Site-SynthDigits                   | Train Loss: 1.1831 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.0570 | Train Acc: 0.6924
 Site-MNIST_M                       | Train Loss: 1.4003 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.4304 | Train Acc: 0.5372
 Site-SVHN                          | Train Loss: 1.7323 | Train Acc: 0.4124
 Site-SVHN                          | Train Loss: 1.6237 | Train Acc: 0.4395
Average Train Accuracy: 0.6825
 Site-MNIST                         | Val  Loss: 0.4180 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.4157 | Val  Acc: 0.9029
 Site-USPS                          | Val  Loss: 0.5681 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.4423 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1173 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.1063 | Val  Acc: 0.6511
 Site-MNIST_M                       | Val  Loss: 1.4770 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.3920 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.5613 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.6231 | Val  Acc: 0.4532
Average Valid Accuracy: 0.6696
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9029
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6511
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.4891
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5755
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4565
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4532
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.4021 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.4417 | Train Acc: 0.8897
 Site-USPS                          | Train Loss: 0.4134 | Train Acc: 0.8976
 Site-USPS                          | Train Loss: 0.3694 | Train Acc: 0.9040
 Site-SynthDigits                   | Train Loss: 1.1631 | Train Acc: 0.6307
 Site-SynthDigits                   | Train Loss: 1.0351 | Train Acc: 0.6888
 Site-MNIST_M                       | Train Loss: 1.3959 | Train Acc: 0.5391
 Site-MNIST_M                       | Train Loss: 1.4253 | Train Acc: 0.5408
 Site-SVHN                          | Train Loss: 1.7178 | Train Acc: 0.4178
 Site-SVHN                          | Train Loss: 1.6078 | Train Acc: 0.4413
Average Train Accuracy: 0.6828
 Site-MNIST                         | Val  Loss: 0.4135 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.4115 | Val  Acc: 0.8993
 Site-USPS                          | Val  Loss: 0.5664 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.4372 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.0880 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0756 | Val  Acc: 0.6655
 Site-MNIST_M                       | Val  Loss: 1.4642 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.3906 | Val  Acc: 0.5827
 Site-SVHN                          | Val  Loss: 1.5512 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6175 | Val  Acc: 0.4532
Average Valid Accuracy: 0.6743
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8993
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8597
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.6655
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5827
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.4532
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.4009 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.4234 | Train Acc: 0.8942
 Site-USPS                          | Train Loss: 0.4012 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.3561 | Train Acc: 0.9013
 Site-SynthDigits                   | Train Loss: 1.1726 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.0394 | Train Acc: 0.6933
 Site-MNIST_M                       | Train Loss: 1.3740 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.3989 | Train Acc: 0.5444
 Site-SVHN                          | Train Loss: 1.7324 | Train Acc: 0.4070
 Site-SVHN                          | Train Loss: 1.6037 | Train Acc: 0.4430
Average Train Accuracy: 0.6851
 Site-MNIST                         | Val  Loss: 0.3930 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.3950 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.5524 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4258 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.0935 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.0882 | Val  Acc: 0.6547
 Site-MNIST_M                       | Val  Loss: 1.4448 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.3691 | Val  Acc: 0.5791
 Site-SVHN                          | Val  Loss: 1.5439 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6118 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6729
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.3862 | Train Acc: 0.8976
 Site-MNIST                         | Train Loss: 0.4187 | Train Acc: 0.8951
 Site-USPS                          | Train Loss: 0.4034 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.3543 | Train Acc: 0.9067
 Site-SynthDigits                   | Train Loss: 1.1509 | Train Acc: 0.6334
 Site-SynthDigits                   | Train Loss: 1.0136 | Train Acc: 0.6978
 Site-MNIST_M                       | Train Loss: 1.3696 | Train Acc: 0.5526
 Site-MNIST_M                       | Train Loss: 1.4059 | Train Acc: 0.5435
 Site-SVHN                          | Train Loss: 1.7216 | Train Acc: 0.4178
 Site-SVHN                          | Train Loss: 1.5991 | Train Acc: 0.4484
Average Train Accuracy: 0.6893
 Site-MNIST                         | Val  Loss: 0.3846 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3882 | Val  Acc: 0.9101
 Site-USPS                          | Val  Loss: 0.5524 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.4234 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.0738 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.0635 | Val  Acc: 0.6691
 Site-MNIST_M                       | Val  Loss: 1.4294 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.3702 | Val  Acc: 0.5683
 Site-SVHN                          | Val  Loss: 1.5283 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.6102 | Val  Acc: 0.4784
Average Valid Accuracy: 0.6812
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9101
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8597
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6691
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5683
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4565
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.3913 | Train Acc: 0.9003
 Site-MNIST                         | Train Loss: 0.4168 | Train Acc: 0.8978
 Site-USPS                          | Train Loss: 0.3975 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.3503 | Train Acc: 0.9049
 Site-SynthDigits                   | Train Loss: 1.1441 | Train Acc: 0.6361
 Site-SynthDigits                   | Train Loss: 1.0040 | Train Acc: 0.7031
 Site-MNIST_M                       | Train Loss: 1.3659 | Train Acc: 0.5526
 Site-MNIST_M                       | Train Loss: 1.3881 | Train Acc: 0.5498
 Site-SVHN                          | Train Loss: 1.6989 | Train Acc: 0.4178
 Site-SVHN                          | Train Loss: 1.6000 | Train Acc: 0.4520
Average Train Accuracy: 0.6915
 Site-MNIST                         | Val  Loss: 0.3904 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3887 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.5537 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.4214 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.0641 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.0526 | Val  Acc: 0.6763
 Site-MNIST_M                       | Val  Loss: 1.4268 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.3637 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.5333 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.6007 | Val  Acc: 0.4748
Average Valid Accuracy: 0.6891
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9137
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6763
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5217
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4748
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.3778 | Train Acc: 0.9003
 Site-MNIST                         | Train Loss: 0.4084 | Train Acc: 0.9004
 Site-USPS                          | Train Loss: 0.3897 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.3427 | Train Acc: 0.9040
 Site-SynthDigits                   | Train Loss: 1.1382 | Train Acc: 0.6361
 Site-SynthDigits                   | Train Loss: 1.0080 | Train Acc: 0.6987
 Site-MNIST_M                       | Train Loss: 1.3540 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.3743 | Train Acc: 0.5525
 Site-SVHN                          | Train Loss: 1.7071 | Train Acc: 0.4124
 Site-SVHN                          | Train Loss: 1.5776 | Train Acc: 0.4574
Average Train Accuracy: 0.6931
 Site-MNIST                         | Val  Loss: 0.3783 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3764 | Val  Acc: 0.9173
 Site-USPS                          | Val  Loss: 0.5439 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.4128 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.0680 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.0585 | Val  Acc: 0.6655
 Site-MNIST_M                       | Val  Loss: 1.4102 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3496 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.5167 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.5883 | Val  Acc: 0.4784
Average Valid Accuracy: 0.6898
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9173
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6304
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6655
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.6007
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.4784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.3730 | Train Acc: 0.8949
 Site-MNIST                         | Train Loss: 0.4039 | Train Acc: 0.8987
 Site-USPS                          | Train Loss: 0.3834 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.3327 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.1361 | Train Acc: 0.6388
 Site-SynthDigits                   | Train Loss: 0.9926 | Train Acc: 0.7013
 Site-MNIST_M                       | Train Loss: 1.3341 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.3594 | Train Acc: 0.5578
 Site-SVHN                          | Train Loss: 1.7006 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 1.5849 | Train Acc: 0.4610
Average Train Accuracy: 0.6960
 Site-MNIST                         | Val  Loss: 0.3786 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3726 | Val  Acc: 0.9173
 Site-USPS                          | Val  Loss: 0.5316 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.4014 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.0500 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0447 | Val  Acc: 0.6691
 Site-MNIST_M                       | Val  Loss: 1.3742 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.3289 | Val  Acc: 0.5971
 Site-SVHN                          | Val  Loss: 1.5065 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.5879 | Val  Acc: 0.4748
Average Valid Accuracy: 0.6884
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.3723 | Train Acc: 0.8976
 Site-MNIST                         | Train Loss: 0.3917 | Train Acc: 0.9040
 Site-USPS                          | Train Loss: 0.3819 | Train Acc: 0.9030
 Site-USPS                          | Train Loss: 0.3448 | Train Acc: 0.9031
 Site-SynthDigits                   | Train Loss: 1.1121 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 0.9820 | Train Acc: 0.7040
 Site-MNIST_M                       | Train Loss: 1.3318 | Train Acc: 0.5714
 Site-MNIST_M                       | Train Loss: 1.3453 | Train Acc: 0.5614
 Site-SVHN                          | Train Loss: 1.6813 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 1.5654 | Train Acc: 0.4691
Average Train Accuracy: 0.6986
 Site-MNIST                         | Val  Loss: 0.3599 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3687 | Val  Acc: 0.9065
 Site-USPS                          | Val  Loss: 0.5483 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.4071 | Val  Acc: 0.8705
 Site-SynthDigits                   | Val  Loss: 1.0473 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.0288 | Val  Acc: 0.6727
 Site-MNIST_M                       | Val  Loss: 1.3775 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3257 | Val  Acc: 0.5935
 Site-SVHN                          | Val  Loss: 1.5034 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5761 | Val  Acc: 0.4892
Average Valid Accuracy: 0.6913
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9065
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8705
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6727
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5935
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.3520 | Train Acc: 0.9057
 Site-MNIST                         | Train Loss: 0.3794 | Train Acc: 0.9049
 Site-USPS                          | Train Loss: 0.3821 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3421 | Train Acc: 0.9058
 Site-SynthDigits                   | Train Loss: 1.0922 | Train Acc: 0.6523
 Site-SynthDigits                   | Train Loss: 0.9597 | Train Acc: 0.7121
 Site-MNIST_M                       | Train Loss: 1.3425 | Train Acc: 0.5660
 Site-MNIST_M                       | Train Loss: 1.3565 | Train Acc: 0.5605
 Site-SVHN                          | Train Loss: 1.6816 | Train Acc: 0.4447
 Site-SVHN                          | Train Loss: 1.5570 | Train Acc: 0.4762
Average Train Accuracy: 0.7037
 Site-MNIST                         | Val  Loss: 0.3552 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.3567 | Val  Acc: 0.9209
 Site-USPS                          | Val  Loss: 0.5466 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.4060 | Val  Acc: 0.8705
 Site-SynthDigits                   | Val  Loss: 1.0303 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0069 | Val  Acc: 0.6727
 Site-MNIST_M                       | Val  Loss: 1.3751 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.3276 | Val  Acc: 0.6043
 Site-SVHN                          | Val  Loss: 1.4949 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.5677 | Val  Acc: 0.4892
Average Valid Accuracy: 0.6938
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9209
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8705
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6727
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5543
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6043
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.4892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.3533 | Train Acc: 0.9084
 Site-MNIST                         | Train Loss: 0.3810 | Train Acc: 0.9022
 Site-USPS                          | Train Loss: 0.3712 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3340 | Train Acc: 0.9067
 Site-SynthDigits                   | Train Loss: 1.0886 | Train Acc: 0.6631
 Site-SynthDigits                   | Train Loss: 0.9540 | Train Acc: 0.7166
 Site-MNIST_M                       | Train Loss: 1.3227 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.3457 | Train Acc: 0.5695
 Site-SVHN                          | Train Loss: 1.6733 | Train Acc: 0.4340
 Site-SVHN                          | Train Loss: 1.5462 | Train Acc: 0.4753
Average Train Accuracy: 0.7064
 Site-MNIST                         | Val  Loss: 0.3549 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3571 | Val  Acc: 0.9209
 Site-USPS                          | Val  Loss: 0.5454 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4026 | Val  Acc: 0.8633
 Site-SynthDigits                   | Val  Loss: 1.0073 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 0.9943 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.3523 | Val  Acc: 0.5761
 Site-MNIST_M                       | Val  Loss: 1.3093 | Val  Acc: 0.6043
 Site-SVHN                          | Val  Loss: 1.4881 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5603 | Val  Acc: 0.4964
Average Valid Accuracy: 0.7003
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9209
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8633
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6739
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6942
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5761
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6043
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4964
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.3543 | Train Acc: 0.9003
 Site-MNIST                         | Train Loss: 0.3855 | Train Acc: 0.9031
 Site-USPS                          | Train Loss: 0.3633 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.3168 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.0886 | Train Acc: 0.6523
 Site-SynthDigits                   | Train Loss: 0.9616 | Train Acc: 0.7112
 Site-MNIST_M                       | Train Loss: 1.3089 | Train Acc: 0.5741
 Site-MNIST_M                       | Train Loss: 1.3258 | Train Acc: 0.5713
 Site-SVHN                          | Train Loss: 1.6808 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.5417 | Train Acc: 0.4726
Average Train Accuracy: 0.7043
 Site-MNIST                         | Val  Loss: 0.3504 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3511 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.5236 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.3883 | Val  Acc: 0.8741
 Site-SynthDigits                   | Val  Loss: 1.0122 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 1.0046 | Val  Acc: 0.6906
 Site-MNIST_M                       | Val  Loss: 1.3451 | Val  Acc: 0.5761
 Site-MNIST_M                       | Val  Loss: 1.2991 | Val  Acc: 0.6115
 Site-SVHN                          | Val  Loss: 1.4856 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.5593 | Val  Acc: 0.4856
Average Valid Accuracy: 0.7021
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9137
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8741
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6848
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6906
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5761
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6115
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4856
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.3385 | Train Acc: 0.9057
 Site-MNIST                         | Train Loss: 0.3707 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.3735 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3205 | Train Acc: 0.9049
 Site-SynthDigits                   | Train Loss: 1.0712 | Train Acc: 0.6577
 Site-SynthDigits                   | Train Loss: 0.9330 | Train Acc: 0.7265
 Site-MNIST_M                       | Train Loss: 1.3130 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.3159 | Train Acc: 0.5740
 Site-SVHN                          | Train Loss: 1.6650 | Train Acc: 0.4340
 Site-SVHN                          | Train Loss: 1.5312 | Train Acc: 0.4753
Average Train Accuracy: 0.7066
 Site-MNIST                         | Val  Loss: 0.3416 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.3418 | Val  Acc: 0.9245
 Site-USPS                          | Val  Loss: 0.5301 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.3897 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 0.9934 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 0.9735 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.3366 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.2958 | Val  Acc: 0.6223
 Site-SVHN                          | Val  Loss: 1.4690 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5504 | Val  Acc: 0.4928
Average Valid Accuracy: 0.7090
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9245
 Best site-USPS                      | Epoch:45 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8777
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.6848
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.6942
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.5870
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.6223
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.4928
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.3430 | Train Acc: 0.9057
 Site-MNIST                         | Train Loss: 0.3600 | Train Acc: 0.9103
 Site-USPS                          | Train Loss: 0.3580 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3048 | Train Acc: 0.9112
 Site-SynthDigits                   | Train Loss: 1.0934 | Train Acc: 0.6496
 Site-SynthDigits                   | Train Loss: 0.9533 | Train Acc: 0.7175
 Site-MNIST_M                       | Train Loss: 1.2857 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.2958 | Train Acc: 0.5865
 Site-SVHN                          | Train Loss: 1.6731 | Train Acc: 0.4340
 Site-SVHN                          | Train Loss: 1.5488 | Train Acc: 0.4726
Average Train Accuracy: 0.7070
 Site-MNIST                         | Val  Loss: 0.3359 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.3351 | Val  Acc: 0.9209
 Site-USPS                          | Val  Loss: 0.5029 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.3734 | Val  Acc: 0.8849
 Site-SynthDigits                   | Val  Loss: 1.0113 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 1.0075 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.3120 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.2737 | Val  Acc: 0.6187
 Site-SVHN                          | Val  Loss: 1.4715 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.5553 | Val  Acc: 0.4928
Average Valid Accuracy: 0.7104
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9209
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8849
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6848
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6978
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5870
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6187
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.4928
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.3371 | Train Acc: 0.9057
 Site-MNIST                         | Train Loss: 0.3548 | Train Acc: 0.9121
 Site-USPS                          | Train Loss: 0.3529 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3031 | Train Acc: 0.9103
 Site-SynthDigits                   | Train Loss: 1.0852 | Train Acc: 0.6550
 Site-SynthDigits                   | Train Loss: 0.9409 | Train Acc: 0.7193
 Site-MNIST_M                       | Train Loss: 1.2758 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.2925 | Train Acc: 0.5794
 Site-SVHN                          | Train Loss: 1.6592 | Train Acc: 0.4313
 Site-SVHN                          | Train Loss: 1.5331 | Train Acc: 0.4744
Average Train Accuracy: 0.7081
 Site-MNIST                         | Val  Loss: 0.3298 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.3295 | Val  Acc: 0.9209
 Site-USPS                          | Val  Loss: 0.5080 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.3743 | Val  Acc: 0.8705
 Site-SynthDigits                   | Val  Loss: 0.9955 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 0.9885 | Val  Acc: 0.7014
 Site-MNIST_M                       | Val  Loss: 1.3035 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.2712 | Val  Acc: 0.6151
 Site-SVHN                          | Val  Loss: 1.4656 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.5542 | Val  Acc: 0.4820
Average Valid Accuracy: 0.7057
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.3290 | Train Acc: 0.9003
 Site-MNIST                         | Train Loss: 0.3507 | Train Acc: 0.9103
 Site-USPS                          | Train Loss: 0.3632 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3156 | Train Acc: 0.9067
 Site-SynthDigits                   | Train Loss: 1.0545 | Train Acc: 0.6604
 Site-SynthDigits                   | Train Loss: 0.9114 | Train Acc: 0.7256
 Site-MNIST_M                       | Train Loss: 1.2854 | Train Acc: 0.5822
 Site-MNIST_M                       | Train Loss: 1.2911 | Train Acc: 0.5803
 Site-SVHN                          | Train Loss: 1.6490 | Train Acc: 0.4420
 Site-SVHN                          | Train Loss: 1.5095 | Train Acc: 0.4798
Average Train Accuracy: 0.7101
 Site-MNIST                         | Val  Loss: 0.3190 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.3278 | Val  Acc: 0.9245
 Site-USPS                          | Val  Loss: 0.5249 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.3830 | Val  Acc: 0.8741
 Site-SynthDigits                   | Val  Loss: 0.9735 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 0.9545 | Val  Acc: 0.7050
 Site-MNIST_M                       | Val  Loss: 1.3156 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.2777 | Val  Acc: 0.6187
 Site-SVHN                          | Val  Loss: 1.4574 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.5299 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7166
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9245
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8741
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.6957
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7050
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5870
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6187
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.5326
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/fedavg...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.3214 | Train Acc: 0.9057
 Site-MNIST                         | Train Loss: 0.3469 | Train Acc: 0.9148
 Site-USPS                          | Train Loss: 0.3556 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3088 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.0607 | Train Acc: 0.6523
 Site-SynthDigits                   | Train Loss: 0.9100 | Train Acc: 0.7238
 Site-MNIST_M                       | Train Loss: 1.2659 | Train Acc: 0.5849
 Site-MNIST_M                       | Train Loss: 1.2731 | Train Acc: 0.5857
 Site-SVHN                          | Train Loss: 1.6334 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.5118 | Train Acc: 0.4816
Average Train Accuracy: 0.7114
 Site-MNIST                         | Val  Loss: 0.3130 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.3170 | Val  Acc: 0.9281
 Site-USPS                          | Val  Loss: 0.5135 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.3775 | Val  Acc: 0.8741
 Site-SynthDigits                   | Val  Loss: 0.9701 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 0.9657 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.2764 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.2570 | Val  Acc: 0.6223
 Site-SVHN                          | Val  Loss: 1.4509 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.5324 | Val  Acc: 0.4928
Average Valid Accuracy: 0.7126
===2023-07-30 04:53:57===
===2023-07-30 04:54:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.8953
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9011
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.6770
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.5181
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.4168
MNIST: 0.8953, USPS: 0.9011, SynthDigits: 0.6770, MNIST_M: 0.5181, SVHN: 0.4168, 
Average Test Accuracy(group): 0.6817, Average Test Accuracy(individual): 0.6817,
domain std=0.1953, cluster std=-1.0000, individual std=0.1953, 
