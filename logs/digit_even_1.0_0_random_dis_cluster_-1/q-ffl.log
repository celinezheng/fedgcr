===2023-07-30 06:41:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
denominator: 30450.7734375
 Site-MNIST                         | Train Loss: 2.1938 | Train Acc: 0.4555
 Site-MNIST                         | Train Loss: 2.2102 | Train Acc: 0.3812
 Site-USPS                          | Train Loss: 2.1515 | Train Acc: 0.4717
 Site-USPS                          | Train Loss: 2.1577 | Train Acc: 0.4592
 Site-SynthDigits                   | Train Loss: 2.2653 | Train Acc: 0.2022
 Site-SynthDigits                   | Train Loss: 2.2484 | Train Acc: 0.2484
 Site-MNIST_M                       | Train Loss: 2.2882 | Train Acc: 0.1482
 Site-MNIST_M                       | Train Loss: 2.2879 | Train Acc: 0.1417
 Site-SVHN                          | Train Loss: 2.2701 | Train Acc: 0.1617
 Site-SVHN                          | Train Loss: 2.2717 | Train Acc: 0.1695
Average Train Accuracy: 0.2839
 Site-MNIST                         | Val  Loss: 2.2160 | Val  Acc: 0.3587
 Site-MNIST                         | Val  Loss: 2.2068 | Val  Acc: 0.4065
 Site-USPS                          | Val  Loss: 2.1724 | Val  Acc: 0.4565
 Site-USPS                          | Val  Loss: 2.1778 | Val  Acc: 0.4137
 Site-SynthDigits                   | Val  Loss: 2.2376 | Val  Acc: 0.3152
 Site-SynthDigits                   | Val  Loss: 2.2551 | Val  Acc: 0.2374
 Site-MNIST_M                       | Val  Loss: 2.2773 | Val  Acc: 0.1413
 Site-MNIST_M                       | Val  Loss: 2.2819 | Val  Acc: 0.1763
 Site-SVHN                          | Val  Loss: 2.2583 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2669 | Val  Acc: 0.1763
Average Valid Accuracy: 0.2954
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3587
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4065
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4565
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4137
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3152
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2374
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1413
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1763
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 1 ============
denominator: 29838.94921875
 Site-MNIST                         | Train Loss: 2.0826 | Train Acc: 0.5768
 Site-MNIST                         | Train Loss: 2.1114 | Train Acc: 0.4762
 Site-USPS                          | Train Loss: 2.0331 | Train Acc: 0.5445
 Site-USPS                          | Train Loss: 2.0351 | Train Acc: 0.5480
 Site-SynthDigits                   | Train Loss: 2.2248 | Train Acc: 0.2507
 Site-SynthDigits                   | Train Loss: 2.1986 | Train Acc: 0.3220
 Site-MNIST_M                       | Train Loss: 2.2666 | Train Acc: 0.2075
 Site-MNIST_M                       | Train Loss: 2.2692 | Train Acc: 0.1767
 Site-SVHN                          | Train Loss: 2.2493 | Train Acc: 0.2129
 Site-SVHN                          | Train Loss: 2.2526 | Train Acc: 0.2224
Average Train Accuracy: 0.3538
 Site-MNIST                         | Val  Loss: 2.1260 | Val  Acc: 0.4674
 Site-MNIST                         | Val  Loss: 2.1101 | Val  Acc: 0.5180
 Site-USPS                          | Val  Loss: 2.0598 | Val  Acc: 0.5109
 Site-USPS                          | Val  Loss: 2.0644 | Val  Acc: 0.4820
 Site-SynthDigits                   | Val  Loss: 2.1892 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.2110 | Val  Acc: 0.2950
 Site-MNIST_M                       | Val  Loss: 2.2613 | Val  Acc: 0.1522
 Site-MNIST_M                       | Val  Loss: 2.2636 | Val  Acc: 0.2050
 Site-SVHN                          | Val  Loss: 2.2326 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2443 | Val  Acc: 0.2158
Average Valid Accuracy: 0.3466
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4674
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5180
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5109
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4820
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2950
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1522
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2050
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2158
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 2 ============
denominator: 29361.78125
 Site-MNIST                         | Train Loss: 1.9707 | Train Acc: 0.6011
 Site-MNIST                         | Train Loss: 2.0144 | Train Acc: 0.5139
 Site-USPS                          | Train Loss: 1.9131 | Train Acc: 0.5795
 Site-USPS                          | Train Loss: 1.9186 | Train Acc: 0.5991
 Site-SynthDigits                   | Train Loss: 2.1834 | Train Acc: 0.2803
 Site-SynthDigits                   | Train Loss: 2.1467 | Train Acc: 0.3570
 Site-MNIST_M                       | Train Loss: 2.2457 | Train Acc: 0.2183
 Site-MNIST_M                       | Train Loss: 2.2520 | Train Acc: 0.1937
 Site-SVHN                          | Train Loss: 2.2324 | Train Acc: 0.2507
 Site-SVHN                          | Train Loss: 2.2333 | Train Acc: 0.2475
Average Train Accuracy: 0.3841
 Site-MNIST                         | Val  Loss: 2.0359 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 2.0117 | Val  Acc: 0.5504
 Site-USPS                          | Val  Loss: 1.9516 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 1.9555 | Val  Acc: 0.5288
 Site-SynthDigits                   | Val  Loss: 2.1407 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.1649 | Val  Acc: 0.3165
 Site-MNIST_M                       | Val  Loss: 2.2489 | Val  Acc: 0.1522
 Site-MNIST_M                       | Val  Loss: 2.2457 | Val  Acc: 0.2302
 Site-SVHN                          | Val  Loss: 2.2100 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2249 | Val  Acc: 0.2554
Average Valid Accuracy: 0.3773
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5504
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5288
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3165
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1522
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2302
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2554
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 3 ============
denominator: 28552.095703125
 Site-MNIST                         | Train Loss: 1.8677 | Train Acc: 0.6388
 Site-MNIST                         | Train Loss: 1.9211 | Train Acc: 0.5399
 Site-USPS                          | Train Loss: 1.8006 | Train Acc: 0.6011
 Site-USPS                          | Train Loss: 1.8025 | Train Acc: 0.6296
 Site-SynthDigits                   | Train Loss: 2.1393 | Train Acc: 0.3315
 Site-SynthDigits                   | Train Loss: 2.0959 | Train Acc: 0.3919
 Site-MNIST_M                       | Train Loss: 2.2268 | Train Acc: 0.2426
 Site-MNIST_M                       | Train Loss: 2.2350 | Train Acc: 0.2161
 Site-SVHN                          | Train Loss: 2.2164 | Train Acc: 0.2668
 Site-SVHN                          | Train Loss: 2.2174 | Train Acc: 0.2637
Average Train Accuracy: 0.4122
 Site-MNIST                         | Val  Loss: 1.9450 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9158 | Val  Acc: 0.5755
 Site-USPS                          | Val  Loss: 1.8488 | Val  Acc: 0.5761
 Site-USPS                          | Val  Loss: 1.8512 | Val  Acc: 0.5647
 Site-SynthDigits                   | Val  Loss: 2.0910 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.1175 | Val  Acc: 0.3453
 Site-MNIST_M                       | Val  Loss: 2.2315 | Val  Acc: 0.1739
 Site-MNIST_M                       | Val  Loss: 2.2259 | Val  Acc: 0.2662
 Site-SVHN                          | Val  Loss: 2.1876 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.2072 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3989
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5755
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5761
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5647
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3453
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.1739
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2662
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 4 ============
denominator: 27931.08984375
 Site-MNIST                         | Train Loss: 1.7704 | Train Acc: 0.6873
 Site-MNIST                         | Train Loss: 1.8295 | Train Acc: 0.5946
 Site-USPS                          | Train Loss: 1.6821 | Train Acc: 0.6442
 Site-USPS                          | Train Loss: 1.6872 | Train Acc: 0.6637
 Site-SynthDigits                   | Train Loss: 2.1026 | Train Acc: 0.3666
 Site-SynthDigits                   | Train Loss: 2.0447 | Train Acc: 0.4170
 Site-MNIST_M                       | Train Loss: 2.2089 | Train Acc: 0.2399
 Site-MNIST_M                       | Train Loss: 2.2130 | Train Acc: 0.2323
 Site-SVHN                          | Train Loss: 2.1963 | Train Acc: 0.2803
 Site-SVHN                          | Train Loss: 2.1961 | Train Acc: 0.2735
Average Train Accuracy: 0.4399
 Site-MNIST                         | Val  Loss: 1.8518 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.8221 | Val  Acc: 0.6367
 Site-USPS                          | Val  Loss: 1.7383 | Val  Acc: 0.5761
 Site-USPS                          | Val  Loss: 1.7373 | Val  Acc: 0.5863
 Site-SynthDigits                   | Val  Loss: 2.0429 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0738 | Val  Acc: 0.3777
 Site-MNIST_M                       | Val  Loss: 2.2173 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2078 | Val  Acc: 0.2806
 Site-SVHN                          | Val  Loss: 2.1619 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1857 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4256
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5870
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6367
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5761
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5863
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3777
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2806
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2878
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 5 ============
denominator: 27334.251953125
 Site-MNIST                         | Train Loss: 1.6662 | Train Acc: 0.7089
 Site-MNIST                         | Train Loss: 1.7391 | Train Acc: 0.5973
 Site-USPS                          | Train Loss: 1.5921 | Train Acc: 0.6550
 Site-USPS                          | Train Loss: 1.5906 | Train Acc: 0.6726
 Site-SynthDigits                   | Train Loss: 2.0572 | Train Acc: 0.3827
 Site-SynthDigits                   | Train Loss: 2.0008 | Train Acc: 0.4395
 Site-MNIST_M                       | Train Loss: 2.1823 | Train Acc: 0.2588
 Site-MNIST_M                       | Train Loss: 2.1884 | Train Acc: 0.2377
 Site-SVHN                          | Train Loss: 2.1823 | Train Acc: 0.2965
 Site-SVHN                          | Train Loss: 2.1810 | Train Acc: 0.2762
Average Train Accuracy: 0.4525
 Site-MNIST                         | Val  Loss: 1.7587 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7326 | Val  Acc: 0.6403
 Site-USPS                          | Val  Loss: 1.6494 | Val  Acc: 0.5978
 Site-USPS                          | Val  Loss: 1.6466 | Val  Acc: 0.6079
 Site-SynthDigits                   | Val  Loss: 1.9935 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 2.0300 | Val  Acc: 0.3885
 Site-MNIST_M                       | Val  Loss: 2.1995 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.1849 | Val  Acc: 0.2734
 Site-SVHN                          | Val  Loss: 2.1462 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1717 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4354
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6403
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5978
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6079
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4348
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3885
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2734
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2914
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 6 ============
denominator: 26791.072265625
 Site-MNIST                         | Train Loss: 1.5743 | Train Acc: 0.7412
 Site-MNIST                         | Train Loss: 1.6526 | Train Acc: 0.6269
 Site-USPS                          | Train Loss: 1.4859 | Train Acc: 0.6873
 Site-USPS                          | Train Loss: 1.4810 | Train Acc: 0.6969
 Site-SynthDigits                   | Train Loss: 2.0146 | Train Acc: 0.4232
 Site-SynthDigits                   | Train Loss: 1.9492 | Train Acc: 0.4502
 Site-MNIST_M                       | Train Loss: 2.1595 | Train Acc: 0.2722
 Site-MNIST_M                       | Train Loss: 2.1712 | Train Acc: 0.2682
 Site-SVHN                          | Train Loss: 2.1681 | Train Acc: 0.2965
 Site-SVHN                          | Train Loss: 2.1645 | Train Acc: 0.2780
Average Train Accuracy: 0.4741
 Site-MNIST                         | Val  Loss: 1.6761 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.6500 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.5458 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.5411 | Val  Acc: 0.6403
 Site-SynthDigits                   | Val  Loss: 1.9497 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.9876 | Val  Acc: 0.4137
 Site-MNIST_M                       | Val  Loss: 2.1772 | Val  Acc: 0.2391
 Site-MNIST_M                       | Val  Loss: 2.1598 | Val  Acc: 0.2950
 Site-SVHN                          | Val  Loss: 2.1256 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1523 | Val  Acc: 0.3094
Average Valid Accuracy: 0.4581
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6196
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6403
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4137
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.2391
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.2950
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3094
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 7 ============
denominator: 26084.951171875
 Site-MNIST                         | Train Loss: 1.4970 | Train Acc: 0.7412
 Site-MNIST                         | Train Loss: 1.5755 | Train Acc: 0.6502
 Site-USPS                          | Train Loss: 1.3776 | Train Acc: 0.7197
 Site-USPS                          | Train Loss: 1.3763 | Train Acc: 0.7435
 Site-SynthDigits                   | Train Loss: 1.9557 | Train Acc: 0.4528
 Site-SynthDigits                   | Train Loss: 1.8915 | Train Acc: 0.4834
 Site-MNIST_M                       | Train Loss: 2.0952 | Train Acc: 0.3342
 Site-MNIST_M                       | Train Loss: 2.1231 | Train Acc: 0.2951
 Site-SVHN                          | Train Loss: 2.1424 | Train Acc: 0.3046
 Site-SVHN                          | Train Loss: 2.1385 | Train Acc: 0.2879
Average Train Accuracy: 0.5013
 Site-MNIST                         | Val  Loss: 1.5991 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.5790 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4446 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.4309 | Val  Acc: 0.6942
 Site-SynthDigits                   | Val  Loss: 1.8980 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.9250 | Val  Acc: 0.4640
 Site-MNIST_M                       | Val  Loss: 2.1415 | Val  Acc: 0.2500
 Site-MNIST_M                       | Val  Loss: 2.1022 | Val  Acc: 0.3381
 Site-SVHN                          | Val  Loss: 2.0850 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1216 | Val  Acc: 0.3201
Average Valid Accuracy: 0.4826
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6942
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4640
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.2500
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3381
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3201
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 8 ============
denominator: 25470.849609375
 Site-MNIST                         | Train Loss: 1.4344 | Train Acc: 0.7385
 Site-MNIST                         | Train Loss: 1.5148 | Train Acc: 0.6538
 Site-USPS                          | Train Loss: 1.3322 | Train Acc: 0.7224
 Site-USPS                          | Train Loss: 1.3342 | Train Acc: 0.7354
 Site-SynthDigits                   | Train Loss: 1.8849 | Train Acc: 0.4663
 Site-SynthDigits                   | Train Loss: 1.8246 | Train Acc: 0.5049
 Site-MNIST_M                       | Train Loss: 2.0446 | Train Acc: 0.3477
 Site-MNIST_M                       | Train Loss: 2.0947 | Train Acc: 0.2915
 Site-SVHN                          | Train Loss: 2.1009 | Train Acc: 0.3208
 Site-SVHN                          | Train Loss: 2.0913 | Train Acc: 0.3094
Average Train Accuracy: 0.5091
 Site-MNIST                         | Val  Loss: 1.5309 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.5210 | Val  Acc: 0.6583
 Site-USPS                          | Val  Loss: 1.3955 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.3836 | Val  Acc: 0.6871
 Site-SynthDigits                   | Val  Loss: 1.8234 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.8418 | Val  Acc: 0.4856
 Site-MNIST_M                       | Val  Loss: 2.1127 | Val  Acc: 0.2935
 Site-MNIST_M                       | Val  Loss: 2.0561 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0266 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 2.0751 | Val  Acc: 0.3597
Average Valid Accuracy: 0.4992
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6583
 Best site-USPS                      | Epoch:8 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:8 | Val Acc: 0.6871
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4856
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.2935
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 9 ============
denominator: 24665.01953125
 Site-MNIST                         | Train Loss: 1.3656 | Train Acc: 0.7493
 Site-MNIST                         | Train Loss: 1.4394 | Train Acc: 0.6744
 Site-USPS                          | Train Loss: 1.2558 | Train Acc: 0.7385
 Site-USPS                          | Train Loss: 1.2439 | Train Acc: 0.7650
 Site-SynthDigits                   | Train Loss: 1.8323 | Train Acc: 0.4960
 Site-SynthDigits                   | Train Loss: 1.7630 | Train Acc: 0.5220
 Site-MNIST_M                       | Train Loss: 2.0095 | Train Acc: 0.3720
 Site-MNIST_M                       | Train Loss: 2.0608 | Train Acc: 0.3067
 Site-SVHN                          | Train Loss: 2.0734 | Train Acc: 0.3154
 Site-SVHN                          | Train Loss: 2.0646 | Train Acc: 0.3175
Average Train Accuracy: 0.5257
 Site-MNIST                         | Val  Loss: 1.4531 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.4477 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.3105 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2988 | Val  Acc: 0.7302
 Site-SynthDigits                   | Val  Loss: 1.7719 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.7890 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 2.0857 | Val  Acc: 0.2826
 Site-MNIST_M                       | Val  Loss: 2.0205 | Val  Acc: 0.3669
 Site-SVHN                          | Val  Loss: 2.0029 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 2.0459 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5144
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7302
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.2826
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3669
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 10 ============
denominator: 24134.38671875
 Site-MNIST                         | Train Loss: 1.2853 | Train Acc: 0.7601
 Site-MNIST                         | Train Loss: 1.3676 | Train Acc: 0.6978
 Site-USPS                          | Train Loss: 1.1829 | Train Acc: 0.7520
 Site-USPS                          | Train Loss: 1.1800 | Train Acc: 0.7830
 Site-SynthDigits                   | Train Loss: 1.7842 | Train Acc: 0.5202
 Site-SynthDigits                   | Train Loss: 1.7148 | Train Acc: 0.5426
 Site-MNIST_M                       | Train Loss: 1.9828 | Train Acc: 0.3801
 Site-MNIST_M                       | Train Loss: 2.0369 | Train Acc: 0.3229
 Site-SVHN                          | Train Loss: 2.0532 | Train Acc: 0.3154
 Site-SVHN                          | Train Loss: 2.0385 | Train Acc: 0.3211
Average Train Accuracy: 0.5395
 Site-MNIST                         | Val  Loss: 1.3841 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.3755 | Val  Acc: 0.6871
 Site-USPS                          | Val  Loss: 1.2356 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 1.2236 | Val  Acc: 0.7482
 Site-SynthDigits                   | Val  Loss: 1.7244 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.7424 | Val  Acc: 0.5180
 Site-MNIST_M                       | Val  Loss: 2.0618 | Val  Acc: 0.3152
 Site-MNIST_M                       | Val  Loss: 1.9925 | Val  Acc: 0.3849
 Site-SVHN                          | Val  Loss: 1.9800 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 2.0219 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5263
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6871
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7482
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5180
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3152
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3849
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3489
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 11 ============
denominator: 23680.50390625
 Site-MNIST                         | Train Loss: 1.2226 | Train Acc: 0.7628
 Site-MNIST                         | Train Loss: 1.3033 | Train Acc: 0.7103
 Site-USPS                          | Train Loss: 1.1082 | Train Acc: 0.7763
 Site-USPS                          | Train Loss: 1.1099 | Train Acc: 0.7937
 Site-SynthDigits                   | Train Loss: 1.7407 | Train Acc: 0.5256
 Site-SynthDigits                   | Train Loss: 1.6749 | Train Acc: 0.5587
 Site-MNIST_M                       | Train Loss: 1.9500 | Train Acc: 0.3908
 Site-MNIST_M                       | Train Loss: 2.0164 | Train Acc: 0.3354
 Site-SVHN                          | Train Loss: 2.0370 | Train Acc: 0.3235
 Site-SVHN                          | Train Loss: 2.0196 | Train Acc: 0.3211
Average Train Accuracy: 0.5498
 Site-MNIST                         | Val  Loss: 1.3185 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3091 | Val  Acc: 0.7086
 Site-USPS                          | Val  Loss: 1.1627 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.1487 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.6746 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.6974 | Val  Acc: 0.5396
 Site-MNIST_M                       | Val  Loss: 2.0385 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 1.9661 | Val  Acc: 0.3921
 Site-SVHN                          | Val  Loss: 1.9536 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9997 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5429
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7086
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5396
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3921
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 12 ============
denominator: 23208.1796875
 Site-MNIST                         | Train Loss: 1.1681 | Train Acc: 0.7601
 Site-MNIST                         | Train Loss: 1.2481 | Train Acc: 0.7130
 Site-USPS                          | Train Loss: 1.0686 | Train Acc: 0.8005
 Site-USPS                          | Train Loss: 1.0567 | Train Acc: 0.7937
 Site-SynthDigits                   | Train Loss: 1.6945 | Train Acc: 0.5310
 Site-SynthDigits                   | Train Loss: 1.6294 | Train Acc: 0.5668
 Site-MNIST_M                       | Train Loss: 1.9254 | Train Acc: 0.4097
 Site-MNIST_M                       | Train Loss: 1.9981 | Train Acc: 0.3327
 Site-SVHN                          | Train Loss: 2.0105 | Train Acc: 0.3342
 Site-SVHN                          | Train Loss: 1.9938 | Train Acc: 0.3300
Average Train Accuracy: 0.5572
 Site-MNIST                         | Val  Loss: 1.2619 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.2544 | Val  Acc: 0.7122
 Site-USPS                          | Val  Loss: 1.1159 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.1007 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.6209 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.6488 | Val  Acc: 0.5468
 Site-MNIST_M                       | Val  Loss: 2.0143 | Val  Acc: 0.3043
 Site-MNIST_M                       | Val  Loss: 1.9460 | Val  Acc: 0.3957
 Site-SVHN                          | Val  Loss: 1.9289 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.9717 | Val  Acc: 0.3633
Average Valid Accuracy: 0.5480
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7122
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5468
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3043
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3957
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3633
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 13 ============
denominator: 22802.267578125
 Site-MNIST                         | Train Loss: 1.1110 | Train Acc: 0.7763
 Site-MNIST                         | Train Loss: 1.1903 | Train Acc: 0.7229
 Site-USPS                          | Train Loss: 1.0218 | Train Acc: 0.7871
 Site-USPS                          | Train Loss: 1.0171 | Train Acc: 0.7964
 Site-SynthDigits                   | Train Loss: 1.6550 | Train Acc: 0.5364
 Site-SynthDigits                   | Train Loss: 1.5900 | Train Acc: 0.5722
 Site-MNIST_M                       | Train Loss: 1.9069 | Train Acc: 0.4070
 Site-MNIST_M                       | Train Loss: 1.9774 | Train Acc: 0.3381
 Site-SVHN                          | Train Loss: 1.9943 | Train Acc: 0.3369
 Site-SVHN                          | Train Loss: 1.9702 | Train Acc: 0.3390
Average Train Accuracy: 0.5612
 Site-MNIST                         | Val  Loss: 1.2046 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.2003 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.0681 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 1.0572 | Val  Acc: 0.7626
 Site-SynthDigits                   | Val  Loss: 1.5820 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6084 | Val  Acc: 0.5468
 Site-MNIST_M                       | Val  Loss: 1.9929 | Val  Acc: 0.3152
 Site-MNIST_M                       | Val  Loss: 1.9231 | Val  Acc: 0.4029
 Site-SVHN                          | Val  Loss: 1.8925 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.9495 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5516
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7266
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7626
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5468
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.3152
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4029
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 14 ============
denominator: 22399.390625
 Site-MNIST                         | Train Loss: 1.0622 | Train Acc: 0.7844
 Site-MNIST                         | Train Loss: 1.1273 | Train Acc: 0.7498
 Site-USPS                          | Train Loss: 0.9325 | Train Acc: 0.8221
 Site-USPS                          | Train Loss: 0.9307 | Train Acc: 0.8242
 Site-SynthDigits                   | Train Loss: 1.6356 | Train Acc: 0.5391
 Site-SynthDigits                   | Train Loss: 1.5656 | Train Acc: 0.5722
 Site-MNIST_M                       | Train Loss: 1.8638 | Train Acc: 0.4205
 Site-MNIST_M                       | Train Loss: 1.9374 | Train Acc: 0.3614
 Site-SVHN                          | Train Loss: 1.9983 | Train Acc: 0.3477
 Site-SVHN                          | Train Loss: 1.9703 | Train Acc: 0.3345
Average Train Accuracy: 0.5756
 Site-MNIST                         | Val  Loss: 1.1462 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.1409 | Val  Acc: 0.7590
 Site-USPS                          | Val  Loss: 0.9817 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.9622 | Val  Acc: 0.7914
 Site-SynthDigits                   | Val  Loss: 1.5656 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.5931 | Val  Acc: 0.5396
 Site-MNIST_M                       | Val  Loss: 1.9603 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 1.8844 | Val  Acc: 0.4173
 Site-SVHN                          | Val  Loss: 1.8873 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9398 | Val  Acc: 0.3669
Average Valid Accuracy: 0.5570
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7590
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7914
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5396
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4173
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3669
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 15 ============
denominator: 21951.990234375
 Site-MNIST                         | Train Loss: 1.0111 | Train Acc: 0.7898
 Site-MNIST                         | Train Loss: 1.0927 | Train Acc: 0.7426
 Site-USPS                          | Train Loss: 0.9105 | Train Acc: 0.8356
 Site-USPS                          | Train Loss: 0.8971 | Train Acc: 0.8269
 Site-SynthDigits                   | Train Loss: 1.5942 | Train Acc: 0.5687
 Site-SynthDigits                   | Train Loss: 1.5102 | Train Acc: 0.5874
 Site-MNIST_M                       | Train Loss: 1.8473 | Train Acc: 0.4178
 Site-MNIST_M                       | Train Loss: 1.9327 | Train Acc: 0.3578
 Site-SVHN                          | Train Loss: 1.9667 | Train Acc: 0.3423
 Site-SVHN                          | Train Loss: 1.9453 | Train Acc: 0.3498
Average Train Accuracy: 0.5819
 Site-MNIST                         | Val  Loss: 1.1069 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.1050 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 0.9649 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.9397 | Val  Acc: 0.7950
 Site-SynthDigits                   | Val  Loss: 1.5175 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.5461 | Val  Acc: 0.5540
 Site-MNIST_M                       | Val  Loss: 1.9439 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 1.8719 | Val  Acc: 0.4065
 Site-SVHN                          | Val  Loss: 1.8725 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.9173 | Val  Acc: 0.3705
Average Valid Accuracy: 0.5617
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7950
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5540
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4065
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3705
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 16 ============
denominator: 21557.640625
 Site-MNIST                         | Train Loss: 0.9746 | Train Acc: 0.7925
 Site-MNIST                         | Train Loss: 1.0579 | Train Acc: 0.7498
 Site-USPS                          | Train Loss: 0.8716 | Train Acc: 0.8383
 Site-USPS                          | Train Loss: 0.8554 | Train Acc: 0.8305
 Site-SynthDigits                   | Train Loss: 1.5631 | Train Acc: 0.5687
 Site-SynthDigits                   | Train Loss: 1.4870 | Train Acc: 0.5910
 Site-MNIST_M                       | Train Loss: 1.8248 | Train Acc: 0.4313
 Site-MNIST_M                       | Train Loss: 1.9058 | Train Acc: 0.3650
 Site-SVHN                          | Train Loss: 1.9554 | Train Acc: 0.3423
 Site-SVHN                          | Train Loss: 1.9359 | Train Acc: 0.3516
Average Train Accuracy: 0.5861
 Site-MNIST                         | Val  Loss: 1.0638 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.0598 | Val  Acc: 0.7482
 Site-USPS                          | Val  Loss: 0.9321 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.9000 | Val  Acc: 0.8022
 Site-SynthDigits                   | Val  Loss: 1.4948 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.5221 | Val  Acc: 0.5612
 Site-MNIST_M                       | Val  Loss: 1.9212 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 1.8434 | Val  Acc: 0.4209
 Site-SVHN                          | Val  Loss: 1.8503 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.9003 | Val  Acc: 0.3741
Average Valid Accuracy: 0.5667
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7482
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8022
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5612
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4209
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3741
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 17 ============
denominator: 21285.068359375
 Site-MNIST                         | Train Loss: 0.9383 | Train Acc: 0.7951
 Site-MNIST                         | Train Loss: 1.0164 | Train Acc: 0.7444
 Site-USPS                          | Train Loss: 0.8522 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.8287 | Train Acc: 0.8314
 Site-SynthDigits                   | Train Loss: 1.5288 | Train Acc: 0.5849
 Site-SynthDigits                   | Train Loss: 1.4518 | Train Acc: 0.6018
 Site-MNIST_M                       | Train Loss: 1.8023 | Train Acc: 0.4340
 Site-MNIST_M                       | Train Loss: 1.8897 | Train Acc: 0.3668
 Site-SVHN                          | Train Loss: 1.9319 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 1.9082 | Train Acc: 0.3614
Average Train Accuracy: 0.5892
 Site-MNIST                         | Val  Loss: 1.0307 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.0267 | Val  Acc: 0.7338
 Site-USPS                          | Val  Loss: 0.9112 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.8741 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.4481 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.4805 | Val  Acc: 0.5683
 Site-MNIST_M                       | Val  Loss: 1.8996 | Val  Acc: 0.3370
 Site-MNIST_M                       | Val  Loss: 1.8264 | Val  Acc: 0.4209
 Site-SVHN                          | Val  Loss: 1.8230 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.8805 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5686
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7338
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5683
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.3370
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4209
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 18 ============
denominator: 20994.701171875
 Site-MNIST                         | Train Loss: 0.9019 | Train Acc: 0.8032
 Site-MNIST                         | Train Loss: 0.9826 | Train Acc: 0.7516
 Site-USPS                          | Train Loss: 0.8072 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.7897 | Train Acc: 0.8341
 Site-SynthDigits                   | Train Loss: 1.5117 | Train Acc: 0.5795
 Site-SynthDigits                   | Train Loss: 1.4309 | Train Acc: 0.6018
 Site-MNIST_M                       | Train Loss: 1.7666 | Train Acc: 0.4286
 Site-MNIST_M                       | Train Loss: 1.8614 | Train Acc: 0.3830
 Site-SVHN                          | Train Loss: 1.9301 | Train Acc: 0.3450
 Site-SVHN                          | Train Loss: 1.9031 | Train Acc: 0.3587
Average Train Accuracy: 0.5932
 Site-MNIST                         | Val  Loss: 0.9896 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.9844 | Val  Acc: 0.7410
 Site-USPS                          | Val  Loss: 0.8753 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.8333 | Val  Acc: 0.8022
 Site-SynthDigits                   | Val  Loss: 1.4331 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.4623 | Val  Acc: 0.5827
 Site-MNIST_M                       | Val  Loss: 1.8778 | Val  Acc: 0.3152
 Site-MNIST_M                       | Val  Loss: 1.7942 | Val  Acc: 0.4209
 Site-SVHN                          | Val  Loss: 1.8103 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8662 | Val  Acc: 0.3741
Average Valid Accuracy: 0.5693
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7410
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8022
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5827
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.3152
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4209
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3741
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 19 ============
denominator: 20701.947265625
 Site-MNIST                         | Train Loss: 0.8781 | Train Acc: 0.7978
 Site-MNIST                         | Train Loss: 0.9402 | Train Acc: 0.7641
 Site-USPS                          | Train Loss: 0.7659 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.7516 | Train Acc: 0.8404
 Site-SynthDigits                   | Train Loss: 1.4846 | Train Acc: 0.5822
 Site-SynthDigits                   | Train Loss: 1.4013 | Train Acc: 0.6126
 Site-MNIST_M                       | Train Loss: 1.7396 | Train Acc: 0.4474
 Site-MNIST_M                       | Train Loss: 1.8350 | Train Acc: 0.3830
 Site-SVHN                          | Train Loss: 1.9157 | Train Acc: 0.3558
 Site-SVHN                          | Train Loss: 1.8874 | Train Acc: 0.3641
Average Train Accuracy: 0.5999
 Site-MNIST                         | Val  Loss: 0.9558 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.9516 | Val  Acc: 0.7698
 Site-USPS                          | Val  Loss: 0.8374 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.7937 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.4068 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.4368 | Val  Acc: 0.5827
 Site-MNIST_M                       | Val  Loss: 1.8467 | Val  Acc: 0.3370
 Site-MNIST_M                       | Val  Loss: 1.7683 | Val  Acc: 0.4245
 Site-SVHN                          | Val  Loss: 1.7975 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.8542 | Val  Acc: 0.3813
Average Valid Accuracy: 0.5815
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7698
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5827
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.3370
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4245
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3813
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 20 ============
denominator: 20417.384765625
 Site-MNIST                         | Train Loss: 0.8448 | Train Acc: 0.8059
 Site-MNIST                         | Train Loss: 0.9174 | Train Acc: 0.7686
 Site-USPS                          | Train Loss: 0.7580 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.7358 | Train Acc: 0.8395
 Site-SynthDigits                   | Train Loss: 1.4598 | Train Acc: 0.5903
 Site-SynthDigits                   | Train Loss: 1.3771 | Train Acc: 0.6143
 Site-MNIST_M                       | Train Loss: 1.7199 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.8252 | Train Acc: 0.3919
 Site-SVHN                          | Train Loss: 1.8787 | Train Acc: 0.3693
 Site-SVHN                          | Train Loss: 1.8561 | Train Acc: 0.3722
Average Train Accuracy: 0.6057
 Site-MNIST                         | Val  Loss: 0.9188 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 0.9158 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 0.8329 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.7821 | Val  Acc: 0.8058
 Site-SynthDigits                   | Val  Loss: 1.3715 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.4078 | Val  Acc: 0.5935
 Site-MNIST_M                       | Val  Loss: 1.8375 | Val  Acc: 0.3370
 Site-MNIST_M                       | Val  Loss: 1.7504 | Val  Acc: 0.4388
 Site-SVHN                          | Val  Loss: 1.7739 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.8336 | Val  Acc: 0.3957
Average Valid Accuracy: 0.5855
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:20 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8058
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5935
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.3370
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4388
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3957
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 21 ============
denominator: 19965.29296875
 Site-MNIST                         | Train Loss: 0.8094 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.8935 | Train Acc: 0.7812
 Site-USPS                          | Train Loss: 0.7280 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.7102 | Train Acc: 0.8475
 Site-SynthDigits                   | Train Loss: 1.4365 | Train Acc: 0.5876
 Site-SynthDigits                   | Train Loss: 1.3567 | Train Acc: 0.6170
 Site-MNIST_M                       | Train Loss: 1.6933 | Train Acc: 0.4636
 Site-MNIST_M                       | Train Loss: 1.8046 | Train Acc: 0.4018
 Site-SVHN                          | Train Loss: 1.8780 | Train Acc: 0.3747
 Site-SVHN                          | Train Loss: 1.8555 | Train Acc: 0.3776
Average Train Accuracy: 0.6128
 Site-MNIST                         | Val  Loss: 0.8846 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.8829 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 0.8140 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.7553 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 1.3588 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.3901 | Val  Acc: 0.5827
 Site-MNIST_M                       | Val  Loss: 1.8149 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.7304 | Val  Acc: 0.4460
 Site-SVHN                          | Val  Loss: 1.7671 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.8221 | Val  Acc: 0.4029
Average Valid Accuracy: 0.5898
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8165
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5827
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4460
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4029
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 22 ============
denominator: 19859.328125
 Site-MNIST                         | Train Loss: 0.7804 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.8520 | Train Acc: 0.7874
 Site-USPS                          | Train Loss: 0.6999 | Train Acc: 0.8679
 Site-USPS                          | Train Loss: 0.6838 | Train Acc: 0.8475
 Site-SynthDigits                   | Train Loss: 1.4157 | Train Acc: 0.6011
 Site-SynthDigits                   | Train Loss: 1.3367 | Train Acc: 0.6188
 Site-MNIST_M                       | Train Loss: 1.6718 | Train Acc: 0.4825
 Site-MNIST_M                       | Train Loss: 1.7766 | Train Acc: 0.4099
 Site-SVHN                          | Train Loss: 1.8626 | Train Acc: 0.3801
 Site-SVHN                          | Train Loss: 1.8366 | Train Acc: 0.3677
Average Train Accuracy: 0.6182
 Site-MNIST                         | Val  Loss: 0.8458 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.8471 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 0.7879 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.7263 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.3442 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.3749 | Val  Acc: 0.5899
 Site-MNIST_M                       | Val  Loss: 1.8019 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.7039 | Val  Acc: 0.4604
 Site-SVHN                          | Val  Loss: 1.7557 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.8108 | Val  Acc: 0.4029
Average Valid Accuracy: 0.5952
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7842
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5899
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.4604
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4029
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 23 ============
denominator: 19565.900390625
 Site-MNIST                         | Train Loss: 0.7506 | Train Acc: 0.8302
 Site-MNIST                         | Train Loss: 0.8281 | Train Acc: 0.8009
 Site-USPS                          | Train Loss: 0.6757 | Train Acc: 0.8679
 Site-USPS                          | Train Loss: 0.6632 | Train Acc: 0.8484
 Site-SynthDigits                   | Train Loss: 1.3965 | Train Acc: 0.5957
 Site-SynthDigits                   | Train Loss: 1.3198 | Train Acc: 0.6233
 Site-MNIST_M                       | Train Loss: 1.6479 | Train Acc: 0.4879
 Site-MNIST_M                       | Train Loss: 1.7611 | Train Acc: 0.4197
 Site-SVHN                          | Train Loss: 1.8507 | Train Acc: 0.3827
 Site-SVHN                          | Train Loss: 1.8188 | Train Acc: 0.3758
Average Train Accuracy: 0.6233
 Site-MNIST                         | Val  Loss: 0.8149 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.8163 | Val  Acc: 0.8058
 Site-USPS                          | Val  Loss: 0.7702 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.7048 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.3245 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.3556 | Val  Acc: 0.5971
 Site-MNIST_M                       | Val  Loss: 1.7819 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.6832 | Val  Acc: 0.4640
 Site-SVHN                          | Val  Loss: 1.7300 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7915 | Val  Acc: 0.3993
Average Valid Accuracy: 0.6025
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8058
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5971
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.4640
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3993
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 24 ============
denominator: 19285.439453125
 Site-MNIST                         | Train Loss: 0.7321 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.8089 | Train Acc: 0.8009
 Site-USPS                          | Train Loss: 0.6606 | Train Acc: 0.8733
 Site-USPS                          | Train Loss: 0.6402 | Train Acc: 0.8538
 Site-SynthDigits                   | Train Loss: 1.3756 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 1.3119 | Train Acc: 0.6251
 Site-MNIST_M                       | Train Loss: 1.6210 | Train Acc: 0.4906
 Site-MNIST_M                       | Train Loss: 1.7316 | Train Acc: 0.4296
 Site-SVHN                          | Train Loss: 1.8428 | Train Acc: 0.3881
 Site-SVHN                          | Train Loss: 1.8097 | Train Acc: 0.3830
Average Train Accuracy: 0.6281
 Site-MNIST                         | Val  Loss: 0.7925 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.7916 | Val  Acc: 0.8022
 Site-USPS                          | Val  Loss: 0.7560 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.6818 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.3167 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.3365 | Val  Acc: 0.5971
 Site-MNIST_M                       | Val  Loss: 1.7634 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.6616 | Val  Acc: 0.4820
 Site-SVHN                          | Val  Loss: 1.7156 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7767 | Val  Acc: 0.4137
Average Valid Accuracy: 0.6064
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8022
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5971
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4820
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4137
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 25 ============
denominator: 19040.5234375
 Site-MNIST                         | Train Loss: 0.7015 | Train Acc: 0.8410
 Site-MNIST                         | Train Loss: 0.7858 | Train Acc: 0.8054
 Site-USPS                          | Train Loss: 0.6348 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.6206 | Train Acc: 0.8592
 Site-SynthDigits                   | Train Loss: 1.3601 | Train Acc: 0.6092
 Site-SynthDigits                   | Train Loss: 1.2782 | Train Acc: 0.6305
 Site-MNIST_M                       | Train Loss: 1.5923 | Train Acc: 0.4933
 Site-MNIST_M                       | Train Loss: 1.7108 | Train Acc: 0.4341
 Site-SVHN                          | Train Loss: 1.8198 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 1.7928 | Train Acc: 0.3848
Average Train Accuracy: 0.6324
 Site-MNIST                         | Val  Loss: 0.7612 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.7636 | Val  Acc: 0.8022
 Site-USPS                          | Val  Loss: 0.7336 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.6621 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.2981 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.3216 | Val  Acc: 0.6115
 Site-MNIST_M                       | Val  Loss: 1.7317 | Val  Acc: 0.3587
 Site-MNIST_M                       | Val  Loss: 1.6344 | Val  Acc: 0.4784
 Site-SVHN                          | Val  Loss: 1.7027 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7615 | Val  Acc: 0.4101
Average Valid Accuracy: 0.6086
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8022
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6115
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.3587
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.4784
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4101
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 26 ============
denominator: 18905.259765625
 Site-MNIST                         | Train Loss: 0.6844 | Train Acc: 0.8302
 Site-MNIST                         | Train Loss: 0.7627 | Train Acc: 0.8045
 Site-USPS                          | Train Loss: 0.6207 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.5983 | Train Acc: 0.8619
 Site-SynthDigits                   | Train Loss: 1.3422 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 1.2640 | Train Acc: 0.6341
 Site-MNIST_M                       | Train Loss: 1.5744 | Train Acc: 0.5094
 Site-MNIST_M                       | Train Loss: 1.7008 | Train Acc: 0.4430
 Site-SVHN                          | Train Loss: 1.8194 | Train Acc: 0.3935
 Site-SVHN                          | Train Loss: 1.7951 | Train Acc: 0.3821
Average Train Accuracy: 0.6341
 Site-MNIST                         | Val  Loss: 0.7419 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.7432 | Val  Acc: 0.8094
 Site-USPS                          | Val  Loss: 0.7277 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.6448 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.2916 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.3040 | Val  Acc: 0.6115
 Site-MNIST_M                       | Val  Loss: 1.7163 | Val  Acc: 0.3587
 Site-MNIST_M                       | Val  Loss: 1.6159 | Val  Acc: 0.4784
 Site-SVHN                          | Val  Loss: 1.6948 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7500 | Val  Acc: 0.4101
Average Valid Accuracy: 0.6122
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8094
 Best site-USPS                      | Epoch:26 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6115
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.3587
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.4784
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.4101
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 27 ============
denominator: 18636.572265625
 Site-MNIST                         | Train Loss: 0.6565 | Train Acc: 0.8464
 Site-MNIST                         | Train Loss: 0.7322 | Train Acc: 0.8179
 Site-USPS                          | Train Loss: 0.6080 | Train Acc: 0.8814
 Site-USPS                          | Train Loss: 0.5914 | Train Acc: 0.8619
 Site-SynthDigits                   | Train Loss: 1.3171 | Train Acc: 0.6146
 Site-SynthDigits                   | Train Loss: 1.2462 | Train Acc: 0.6457
 Site-MNIST_M                       | Train Loss: 1.5573 | Train Acc: 0.5040
 Site-MNIST_M                       | Train Loss: 1.6818 | Train Acc: 0.4493
 Site-SVHN                          | Train Loss: 1.7996 | Train Acc: 0.4124
 Site-SVHN                          | Train Loss: 1.7646 | Train Acc: 0.3910
Average Train Accuracy: 0.6425
 Site-MNIST                         | Val  Loss: 0.7144 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.7176 | Val  Acc: 0.8309
 Site-USPS                          | Val  Loss: 0.7222 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.6339 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.2764 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.2810 | Val  Acc: 0.6007
 Site-MNIST_M                       | Val  Loss: 1.6903 | Val  Acc: 0.3804
 Site-MNIST_M                       | Val  Loss: 1.5955 | Val  Acc: 0.4820
 Site-SVHN                          | Val  Loss: 1.6819 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7324 | Val  Acc: 0.4173
Average Valid Accuracy: 0.6173
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8309
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6007
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.3804
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.4820
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4173
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 28 ============
denominator: 18438.466796875
 Site-MNIST                         | Train Loss: 0.6451 | Train Acc: 0.8544
 Site-MNIST                         | Train Loss: 0.7116 | Train Acc: 0.8143
 Site-USPS                          | Train Loss: 0.5901 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.5719 | Train Acc: 0.8646
 Site-SynthDigits                   | Train Loss: 1.3000 | Train Acc: 0.6253
 Site-SynthDigits                   | Train Loss: 1.2234 | Train Acc: 0.6466
 Site-MNIST_M                       | Train Loss: 1.5329 | Train Acc: 0.5067
 Site-MNIST_M                       | Train Loss: 1.6606 | Train Acc: 0.4592
 Site-SVHN                          | Train Loss: 1.7856 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 1.7532 | Train Acc: 0.3928
Average Train Accuracy: 0.6463
 Site-MNIST                         | Val  Loss: 0.6958 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.6988 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.7122 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.6209 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.2530 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.2624 | Val  Acc: 0.6187
 Site-MNIST_M                       | Val  Loss: 1.6664 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.5685 | Val  Acc: 0.5072
 Site-SVHN                          | Val  Loss: 1.6775 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.7239 | Val  Acc: 0.4209
Average Valid Accuracy: 0.6201
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7935
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8237
 Best site-USPS                      | Epoch:28 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6187
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5072
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.4209
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 29 ============
denominator: 18259.029296875
 Site-MNIST                         | Train Loss: 0.6227 | Train Acc: 0.8518
 Site-MNIST                         | Train Loss: 0.7003 | Train Acc: 0.8260
 Site-USPS                          | Train Loss: 0.5777 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.5678 | Train Acc: 0.8700
 Site-SynthDigits                   | Train Loss: 1.2799 | Train Acc: 0.6173
 Site-SynthDigits                   | Train Loss: 1.1991 | Train Acc: 0.6511
 Site-MNIST_M                       | Train Loss: 1.5041 | Train Acc: 0.5256
 Site-MNIST_M                       | Train Loss: 1.6335 | Train Acc: 0.4709
 Site-SVHN                          | Train Loss: 1.7747 | Train Acc: 0.4178
 Site-SVHN                          | Train Loss: 1.7457 | Train Acc: 0.4000
Average Train Accuracy: 0.6509
 Site-MNIST                         | Val  Loss: 0.6790 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.6792 | Val  Acc: 0.8309
 Site-USPS                          | Val  Loss: 0.7007 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.6058 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.2380 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.2413 | Val  Acc: 0.6151
 Site-MNIST_M                       | Val  Loss: 1.6367 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.5420 | Val  Acc: 0.5072
 Site-SVHN                          | Val  Loss: 1.6676 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7125 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6234
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8309
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6151
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5072
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 30 ============
denominator: 18060.7578125
 Site-MNIST                         | Train Loss: 0.6030 | Train Acc: 0.8544
 Site-MNIST                         | Train Loss: 0.6823 | Train Acc: 0.8314
 Site-USPS                          | Train Loss: 0.5710 | Train Acc: 0.8814
 Site-USPS                          | Train Loss: 0.5581 | Train Acc: 0.8735
 Site-SynthDigits                   | Train Loss: 1.2633 | Train Acc: 0.6280
 Site-SynthDigits                   | Train Loss: 1.1824 | Train Acc: 0.6529
 Site-MNIST_M                       | Train Loss: 1.5039 | Train Acc: 0.5256
 Site-MNIST_M                       | Train Loss: 1.6170 | Train Acc: 0.4735
 Site-SVHN                          | Train Loss: 1.7682 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 1.7414 | Train Acc: 0.3973
Average Train Accuracy: 0.6547
 Site-MNIST                         | Val  Loss: 0.6559 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.6542 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.7012 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.6003 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.2288 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.2269 | Val  Acc: 0.6331
 Site-MNIST_M                       | Val  Loss: 1.6371 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.5358 | Val  Acc: 0.5108
 Site-SVHN                          | Val  Loss: 1.6571 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7088 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6288
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8381
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8381
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6331
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.4239
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5108
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 31 ============
denominator: 17837.513671875
 Site-MNIST                         | Train Loss: 0.5821 | Train Acc: 0.8625
 Site-MNIST                         | Train Loss: 0.6496 | Train Acc: 0.8448
 Site-USPS                          | Train Loss: 0.5476 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.5347 | Train Acc: 0.8717
 Site-SynthDigits                   | Train Loss: 1.2630 | Train Acc: 0.6173
 Site-SynthDigits                   | Train Loss: 1.1819 | Train Acc: 0.6520
 Site-MNIST_M                       | Train Loss: 1.4740 | Train Acc: 0.5418
 Site-MNIST_M                       | Train Loss: 1.5992 | Train Acc: 0.4762
 Site-SVHN                          | Train Loss: 1.7478 | Train Acc: 0.4340
 Site-SVHN                          | Train Loss: 1.7335 | Train Acc: 0.4063
Average Train Accuracy: 0.6593
 Site-MNIST                         | Val  Loss: 0.6270 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.6280 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.6788 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5780 | Val  Acc: 0.8489
 Site-SynthDigits                   | Val  Loss: 1.2336 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.2287 | Val  Acc: 0.6367
 Site-MNIST_M                       | Val  Loss: 1.6100 | Val  Acc: 0.4348
 Site-MNIST_M                       | Val  Loss: 1.5083 | Val  Acc: 0.5180
 Site-SVHN                          | Val  Loss: 1.6471 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6937 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6367
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8489
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6367
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.4348
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5180
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4317
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 32 ============
denominator: 17684.111328125
 Site-MNIST                         | Train Loss: 0.5604 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.6371 | Train Acc: 0.8413
 Site-USPS                          | Train Loss: 0.5426 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.5203 | Train Acc: 0.8717
 Site-SynthDigits                   | Train Loss: 1.2367 | Train Acc: 0.6307
 Site-SynthDigits                   | Train Loss: 1.1553 | Train Acc: 0.6664
 Site-MNIST_M                       | Train Loss: 1.4490 | Train Acc: 0.5391
 Site-MNIST_M                       | Train Loss: 1.5787 | Train Acc: 0.4861
 Site-SVHN                          | Train Loss: 1.7304 | Train Acc: 0.4420
 Site-SVHN                          | Train Loss: 1.7194 | Train Acc: 0.4143
Average Train Accuracy: 0.6654
 Site-MNIST                         | Val  Loss: 0.6221 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6181 | Val  Acc: 0.8417
 Site-USPS                          | Val  Loss: 0.6740 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5713 | Val  Acc: 0.8489
 Site-SynthDigits                   | Val  Loss: 1.2053 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.1951 | Val  Acc: 0.6511
 Site-MNIST_M                       | Val  Loss: 1.5843 | Val  Acc: 0.4457
 Site-MNIST_M                       | Val  Loss: 1.4924 | Val  Acc: 0.5324
 Site-SVHN                          | Val  Loss: 1.6339 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.6751 | Val  Acc: 0.4388
Average Valid Accuracy: 0.6411
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8417
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8489
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6511
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.4457
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5324
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 33 ============
denominator: 17443.220703125
 Site-MNIST                         | Train Loss: 0.5600 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.6384 | Train Acc: 0.8448
 Site-USPS                          | Train Loss: 0.5480 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.5189 | Train Acc: 0.8726
 Site-SynthDigits                   | Train Loss: 1.2152 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 1.1481 | Train Acc: 0.6735
 Site-MNIST_M                       | Train Loss: 1.4291 | Train Acc: 0.5553
 Site-MNIST_M                       | Train Loss: 1.5582 | Train Acc: 0.4915
 Site-SVHN                          | Train Loss: 1.7272 | Train Acc: 0.4474
 Site-SVHN                          | Train Loss: 1.7012 | Train Acc: 0.4224
Average Train Accuracy: 0.6712
 Site-MNIST                         | Val  Loss: 0.6286 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.6069 | Val  Acc: 0.8453
 Site-USPS                          | Val  Loss: 0.6709 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.5724 | Val  Acc: 0.8489
 Site-SynthDigits                   | Val  Loss: 1.1860 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.1728 | Val  Acc: 0.6583
 Site-MNIST_M                       | Val  Loss: 1.5680 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.4782 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.6339 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6663 | Val  Acc: 0.4496
Average Valid Accuracy: 0.6476
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.7935
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8453
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8489
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6583
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5432
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4496
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 34 ============
denominator: 17453.537109375
 Site-MNIST                         | Train Loss: 0.5459 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.6088 | Train Acc: 0.8457
 Site-USPS                          | Train Loss: 0.5205 | Train Acc: 0.8895
 Site-USPS                          | Train Loss: 0.4995 | Train Acc: 0.8762
 Site-SynthDigits                   | Train Loss: 1.1981 | Train Acc: 0.6469
 Site-SynthDigits                   | Train Loss: 1.1249 | Train Acc: 0.6735
 Site-MNIST_M                       | Train Loss: 1.4207 | Train Acc: 0.5553
 Site-MNIST_M                       | Train Loss: 1.5562 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.7204 | Train Acc: 0.4501
 Site-SVHN                          | Train Loss: 1.6919 | Train Acc: 0.4233
Average Train Accuracy: 0.6727
 Site-MNIST                         | Val  Loss: 0.5981 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.5865 | Val  Acc: 0.8453
 Site-USPS                          | Val  Loss: 0.6563 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.5505 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1745 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.1585 | Val  Acc: 0.6583
 Site-MNIST_M                       | Val  Loss: 1.5521 | Val  Acc: 0.4783
 Site-MNIST_M                       | Val  Loss: 1.4649 | Val  Acc: 0.5468
 Site-SVHN                          | Val  Loss: 1.6274 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6587 | Val  Acc: 0.4532
Average Valid Accuracy: 0.6530
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8453
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6583
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.4783
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5468
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4532
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 35 ============
denominator: 17225.439453125
 Site-MNIST                         | Train Loss: 0.5245 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.5990 | Train Acc: 0.8502
 Site-USPS                          | Train Loss: 0.5042 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4880 | Train Acc: 0.8816
 Site-SynthDigits                   | Train Loss: 1.1863 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 1.1107 | Train Acc: 0.6789
 Site-MNIST_M                       | Train Loss: 1.4060 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.5404 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.7021 | Train Acc: 0.4582
 Site-SVHN                          | Train Loss: 1.6799 | Train Acc: 0.4260
Average Train Accuracy: 0.6769
 Site-MNIST                         | Val  Loss: 0.5828 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.5725 | Val  Acc: 0.8489
 Site-USPS                          | Val  Loss: 0.6399 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.5380 | Val  Acc: 0.8633
 Site-SynthDigits                   | Val  Loss: 1.1606 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.1432 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.5317 | Val  Acc: 0.4674
 Site-MNIST_M                       | Val  Loss: 1.4481 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.6132 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6516 | Val  Acc: 0.4568
Average Valid Accuracy: 0.6577
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8489
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8633
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.6619
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.4674
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5612
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.4568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 36 ============
denominator: 17128.185546875
 Site-MNIST                         | Train Loss: 0.5127 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.5682 | Train Acc: 0.8619
 Site-USPS                          | Train Loss: 0.5011 | Train Acc: 0.8922
 Site-USPS                          | Train Loss: 0.4852 | Train Acc: 0.8753
 Site-SynthDigits                   | Train Loss: 1.1761 | Train Acc: 0.6469
 Site-SynthDigits                   | Train Loss: 1.1055 | Train Acc: 0.6726
 Site-MNIST_M                       | Train Loss: 1.3877 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.5247 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.7002 | Train Acc: 0.4744
 Site-SVHN                          | Train Loss: 1.6561 | Train Acc: 0.4350
Average Train Accuracy: 0.6815
 Site-MNIST                         | Val  Loss: 0.5675 | Val  Acc: 0.8370
 Site-MNIST                         | Val  Loss: 0.5525 | Val  Acc: 0.8597
 Site-USPS                          | Val  Loss: 0.6370 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5337 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1531 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.1372 | Val  Acc: 0.6583
 Site-MNIST_M                       | Val  Loss: 1.5365 | Val  Acc: 0.4783
 Site-MNIST_M                       | Val  Loss: 1.4404 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.5809 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6374 | Val  Acc: 0.4604
Average Valid Accuracy: 0.6573
============ Train epoch 37 ============
denominator: 16945.80078125
 Site-MNIST                         | Train Loss: 0.5058 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.5640 | Train Acc: 0.8583
 Site-USPS                          | Train Loss: 0.4892 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4743 | Train Acc: 0.8798
 Site-SynthDigits                   | Train Loss: 1.1636 | Train Acc: 0.6550
 Site-SynthDigits                   | Train Loss: 1.0850 | Train Acc: 0.6771
 Site-MNIST_M                       | Train Loss: 1.3672 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.5115 | Train Acc: 0.5112
 Site-SVHN                          | Train Loss: 1.7042 | Train Acc: 0.4609
 Site-SVHN                          | Train Loss: 1.6647 | Train Acc: 0.4269
Average Train Accuracy: 0.6828
 Site-MNIST                         | Val  Loss: 0.5579 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.5396 | Val  Acc: 0.8669
 Site-USPS                          | Val  Loss: 0.6284 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5223 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.1370 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.1342 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.5031 | Val  Acc: 0.4783
 Site-MNIST_M                       | Val  Loss: 1.4176 | Val  Acc: 0.5683
 Site-SVHN                          | Val  Loss: 1.5810 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6367 | Val  Acc: 0.4568
Average Valid Accuracy: 0.6588
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8669
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8597
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6619
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.4783
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5683
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 38 ============
denominator: 16705.40625
 Site-MNIST                         | Train Loss: 0.5004 | Train Acc: 0.8976
 Site-MNIST                         | Train Loss: 0.5538 | Train Acc: 0.8646
 Site-USPS                          | Train Loss: 0.4783 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.4616 | Train Acc: 0.8870
 Site-SynthDigits                   | Train Loss: 1.1502 | Train Acc: 0.6550
 Site-SynthDigits                   | Train Loss: 1.0768 | Train Acc: 0.6834
 Site-MNIST_M                       | Train Loss: 1.3602 | Train Acc: 0.5876
 Site-MNIST_M                       | Train Loss: 1.4900 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.6772 | Train Acc: 0.4798
 Site-SVHN                          | Train Loss: 1.6606 | Train Acc: 0.4314
Average Train Accuracy: 0.6904
 Site-MNIST                         | Val  Loss: 0.5431 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5253 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.6221 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5101 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.1292 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.1145 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.4907 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.4068 | Val  Acc: 0.5863
 Site-SVHN                          | Val  Loss: 1.5789 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6264 | Val  Acc: 0.4748
Average Valid Accuracy: 0.6674
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8777
 Best site-USPS                      | Epoch:38 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6619
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.4891
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5863
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4748
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 39 ============
denominator: 16620.419921875
 Site-MNIST                         | Train Loss: 0.4820 | Train Acc: 0.9057
 Site-MNIST                         | Train Loss: 0.5415 | Train Acc: 0.8682
 Site-USPS                          | Train Loss: 0.4708 | Train Acc: 0.9057
 Site-USPS                          | Train Loss: 0.4541 | Train Acc: 0.8843
 Site-SynthDigits                   | Train Loss: 1.1313 | Train Acc: 0.6550
 Site-SynthDigits                   | Train Loss: 1.0610 | Train Acc: 0.6897
 Site-MNIST_M                       | Train Loss: 1.3478 | Train Acc: 0.5903
 Site-MNIST_M                       | Train Loss: 1.4745 | Train Acc: 0.5211
 Site-SVHN                          | Train Loss: 1.6756 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.6454 | Train Acc: 0.4422
Average Train Accuracy: 0.6944
 Site-MNIST                         | Val  Loss: 0.5308 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5116 | Val  Acc: 0.8741
 Site-USPS                          | Val  Loss: 0.6099 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5005 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.1119 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0969 | Val  Acc: 0.6763
 Site-MNIST_M                       | Val  Loss: 1.4885 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.3955 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.5719 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6227 | Val  Acc: 0.4748
Average Valid Accuracy: 0.6699
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8741
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6763
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.4748
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 40 ============
denominator: 16424.267578125
 Site-MNIST                         | Train Loss: 0.4647 | Train Acc: 0.9137
 Site-MNIST                         | Train Loss: 0.5279 | Train Acc: 0.8646
 Site-USPS                          | Train Loss: 0.4653 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.4475 | Train Acc: 0.8861
 Site-SynthDigits                   | Train Loss: 1.1166 | Train Acc: 0.6631
 Site-SynthDigits                   | Train Loss: 1.0470 | Train Acc: 0.6915
 Site-MNIST_M                       | Train Loss: 1.3372 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.4705 | Train Acc: 0.5220
 Site-SVHN                          | Train Loss: 1.6594 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.6413 | Train Acc: 0.4448
Average Train Accuracy: 0.6967
 Site-MNIST                         | Val  Loss: 0.5252 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5017 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.6067 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.4939 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.1026 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0803 | Val  Acc: 0.6763
 Site-MNIST_M                       | Val  Loss: 1.4742 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.3865 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.5526 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6106 | Val  Acc: 0.4640
Average Valid Accuracy: 0.6685
============ Train epoch 41 ============
denominator: 16371.8369140625
 Site-MNIST                         | Train Loss: 0.4596 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.5101 | Train Acc: 0.8691
 Site-USPS                          | Train Loss: 0.4474 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.4416 | Train Acc: 0.8897
 Site-SynthDigits                   | Train Loss: 1.0946 | Train Acc: 0.6685
 Site-SynthDigits                   | Train Loss: 1.0386 | Train Acc: 0.6933
 Site-MNIST_M                       | Train Loss: 1.3329 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.4588 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.6509 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.6266 | Train Acc: 0.4484
Average Train Accuracy: 0.7006
 Site-MNIST                         | Val  Loss: 0.5091 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.4877 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5956 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.4828 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 1.0878 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.0664 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.4661 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.3816 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.5574 | Val  Acc: 0.4674
 Site-SVHN                          | Val  Loss: 1.6055 | Val  Acc: 0.4856
Average Valid Accuracy: 0.6754
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8777
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6304
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4674
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4856
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 42 ============
denominator: 16297.791015625
 Site-MNIST                         | Train Loss: 0.4430 | Train Acc: 0.9164
 Site-MNIST                         | Train Loss: 0.5008 | Train Acc: 0.8726
 Site-USPS                          | Train Loss: 0.4427 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.4343 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.0853 | Train Acc: 0.6685
 Site-SynthDigits                   | Train Loss: 1.0235 | Train Acc: 0.7058
 Site-MNIST_M                       | Train Loss: 1.3192 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.4535 | Train Acc: 0.5247
 Site-SVHN                          | Train Loss: 1.6554 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.6296 | Train Acc: 0.4529
Average Train Accuracy: 0.7040
 Site-MNIST                         | Val  Loss: 0.4973 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.4761 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.5856 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.4735 | Val  Acc: 0.8813
 Site-SynthDigits                   | Val  Loss: 1.0755 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0563 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.4501 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.3705 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.5556 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.6089 | Val  Acc: 0.4928
Average Valid Accuracy: 0.6811
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8777
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8813
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6978
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6007
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.4928
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 43 ============
denominator: 16120.20703125
 Site-MNIST                         | Train Loss: 0.4346 | Train Acc: 0.9137
 Site-MNIST                         | Train Loss: 0.4963 | Train Acc: 0.8753
 Site-USPS                          | Train Loss: 0.4278 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.4193 | Train Acc: 0.8960
 Site-SynthDigits                   | Train Loss: 1.0861 | Train Acc: 0.6712
 Site-SynthDigits                   | Train Loss: 1.0120 | Train Acc: 0.7040
 Site-MNIST_M                       | Train Loss: 1.3100 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.4475 | Train Acc: 0.5291
 Site-SVHN                          | Train Loss: 1.6369 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.6070 | Train Acc: 0.4565
Average Train Accuracy: 0.7054
 Site-MNIST                         | Val  Loss: 0.4888 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.4671 | Val  Acc: 0.8849
 Site-USPS                          | Val  Loss: 0.5798 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.4636 | Val  Acc: 0.8849
 Site-SynthDigits                   | Val  Loss: 1.0600 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0461 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.4400 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.3569 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.5431 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.5885 | Val  Acc: 0.4928
Average Valid Accuracy: 0.6840
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8849
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8849
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6942
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6007
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4928
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 44 ============
denominator: 16022.4375
 Site-MNIST                         | Train Loss: 0.4250 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.4882 | Train Acc: 0.8834
 Site-USPS                          | Train Loss: 0.4180 | Train Acc: 0.9164
 Site-USPS                          | Train Loss: 0.4013 | Train Acc: 0.8969
 Site-SynthDigits                   | Train Loss: 1.0702 | Train Acc: 0.6685
 Site-SynthDigits                   | Train Loss: 1.0123 | Train Acc: 0.7067
 Site-MNIST_M                       | Train Loss: 1.2957 | Train Acc: 0.6011
 Site-MNIST_M                       | Train Loss: 1.4273 | Train Acc: 0.5345
 Site-SVHN                          | Train Loss: 1.6417 | Train Acc: 0.4960
 Site-SVHN                          | Train Loss: 1.6060 | Train Acc: 0.4547
Average Train Accuracy: 0.7083
 Site-MNIST                         | Val  Loss: 0.4700 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4536 | Val  Acc: 0.8957
 Site-USPS                          | Val  Loss: 0.5674 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.4515 | Val  Acc: 0.8885
 Site-SynthDigits                   | Val  Loss: 1.0598 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0478 | Val  Acc: 0.6763
 Site-MNIST_M                       | Val  Loss: 1.4325 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.3508 | Val  Acc: 0.5971
 Site-SVHN                          | Val  Loss: 1.5307 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.5898 | Val  Acc: 0.4892
Average Valid Accuracy: 0.6895
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8957
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8885
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6763
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5971
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 45 ============
denominator: 15898.986328125
 Site-MNIST                         | Train Loss: 0.4113 | Train Acc: 0.9191
 Site-MNIST                         | Train Loss: 0.4744 | Train Acc: 0.8834
 Site-USPS                          | Train Loss: 0.4203 | Train Acc: 0.9164
 Site-USPS                          | Train Loss: 0.3994 | Train Acc: 0.8978
 Site-SynthDigits                   | Train Loss: 1.0569 | Train Acc: 0.6792
 Site-SynthDigits                   | Train Loss: 0.9982 | Train Acc: 0.7103
 Site-MNIST_M                       | Train Loss: 1.2864 | Train Acc: 0.6011
 Site-MNIST_M                       | Train Loss: 1.4139 | Train Acc: 0.5372
 Site-SVHN                          | Train Loss: 1.6388 | Train Acc: 0.4906
 Site-SVHN                          | Train Loss: 1.6047 | Train Acc: 0.4529
Average Train Accuracy: 0.7088
 Site-MNIST                         | Val  Loss: 0.4628 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.4400 | Val  Acc: 0.8885
 Site-USPS                          | Val  Loss: 0.5628 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4483 | Val  Acc: 0.8921
 Site-SynthDigits                   | Val  Loss: 1.0465 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.0311 | Val  Acc: 0.6906
 Site-MNIST_M                       | Val  Loss: 1.4271 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.3436 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.5409 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.5932 | Val  Acc: 0.4784
Average Valid Accuracy: 0.6855
============ Train epoch 46 ============
denominator: 15833.326171875
 Site-MNIST                         | Train Loss: 0.4111 | Train Acc: 0.9164
 Site-MNIST                         | Train Loss: 0.4666 | Train Acc: 0.8816
 Site-USPS                          | Train Loss: 0.4080 | Train Acc: 0.9191
 Site-USPS                          | Train Loss: 0.3896 | Train Acc: 0.9031
 Site-SynthDigits                   | Train Loss: 1.0382 | Train Acc: 0.6981
 Site-SynthDigits                   | Train Loss: 0.9806 | Train Acc: 0.7148
 Site-MNIST_M                       | Train Loss: 1.2828 | Train Acc: 0.6065
 Site-MNIST_M                       | Train Loss: 1.4065 | Train Acc: 0.5372
 Site-SVHN                          | Train Loss: 1.6203 | Train Acc: 0.4906
 Site-SVHN                          | Train Loss: 1.6026 | Train Acc: 0.4574
Average Train Accuracy: 0.7125
 Site-MNIST                         | Val  Loss: 0.4674 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.4356 | Val  Acc: 0.8957
 Site-USPS                          | Val  Loss: 0.5501 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4380 | Val  Acc: 0.8957
 Site-SynthDigits                   | Val  Loss: 1.0220 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0145 | Val  Acc: 0.7014
 Site-MNIST_M                       | Val  Loss: 1.4064 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3340 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.5194 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5755 | Val  Acc: 0.4928
Average Valid Accuracy: 0.6945
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8957
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8957
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.7014
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6007
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.4928
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
============ Train epoch 47 ============
denominator: 15741.8408203125
 Site-MNIST                         | Train Loss: 0.4006 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.4513 | Train Acc: 0.8879
 Site-USPS                          | Train Loss: 0.3948 | Train Acc: 0.9191
 Site-USPS                          | Train Loss: 0.3821 | Train Acc: 0.9004
 Site-SynthDigits                   | Train Loss: 1.0381 | Train Acc: 0.6927
 Site-SynthDigits                   | Train Loss: 0.9770 | Train Acc: 0.7148
 Site-MNIST_M                       | Train Loss: 1.2706 | Train Acc: 0.6065
 Site-MNIST_M                       | Train Loss: 1.4059 | Train Acc: 0.5390
 Site-SVHN                          | Train Loss: 1.6190 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.5896 | Train Acc: 0.4646
Average Train Accuracy: 0.7143
 Site-MNIST                         | Val  Loss: 0.4442 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.4246 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.5482 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4326 | Val  Acc: 0.8921
 Site-SynthDigits                   | Val  Loss: 1.0238 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.0066 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.4100 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.3282 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.5226 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5788 | Val  Acc: 0.5036
Average Valid Accuracy: 0.6931
============ Train epoch 48 ============
denominator: 15594.88671875
 Site-MNIST                         | Train Loss: 0.3906 | Train Acc: 0.9164
 Site-MNIST                         | Train Loss: 0.4541 | Train Acc: 0.8861
 Site-USPS                          | Train Loss: 0.3990 | Train Acc: 0.9164
 Site-USPS                          | Train Loss: 0.3882 | Train Acc: 0.8951
 Site-SynthDigits                   | Train Loss: 1.0157 | Train Acc: 0.7008
 Site-SynthDigits                   | Train Loss: 0.9627 | Train Acc: 0.7220
 Site-MNIST_M                       | Train Loss: 1.2656 | Train Acc: 0.5984
 Site-MNIST_M                       | Train Loss: 1.3855 | Train Acc: 0.5435
 Site-SVHN                          | Train Loss: 1.6088 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.5731 | Train Acc: 0.4637
Average Train Accuracy: 0.7141
 Site-MNIST                         | Val  Loss: 0.4398 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.4192 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.5478 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4331 | Val  Acc: 0.8849
 Site-SynthDigits                   | Val  Loss: 1.0014 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 0.9919 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.4010 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.3221 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.5064 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5606 | Val  Acc: 0.5036
Average Valid Accuracy: 0.6923
============ Train epoch 49 ============
denominator: 15565.021484375
 Site-MNIST                         | Train Loss: 0.3776 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.4388 | Train Acc: 0.8888
 Site-USPS                          | Train Loss: 0.3837 | Train Acc: 0.9191
 Site-USPS                          | Train Loss: 0.3789 | Train Acc: 0.9004
 Site-SynthDigits                   | Train Loss: 1.0138 | Train Acc: 0.7035
 Site-SynthDigits                   | Train Loss: 0.9517 | Train Acc: 0.7220
 Site-MNIST_M                       | Train Loss: 1.2590 | Train Acc: 0.6011
 Site-MNIST_M                       | Train Loss: 1.3770 | Train Acc: 0.5471
 Site-SVHN                          | Train Loss: 1.5963 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.5725 | Train Acc: 0.4691
Average Train Accuracy: 0.7174
 Site-MNIST                         | Val  Loss: 0.4217 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4052 | Val  Acc: 0.8993
 Site-USPS                          | Val  Loss: 0.5426 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4272 | Val  Acc: 0.8849
 Site-SynthDigits                   | Val  Loss: 0.9975 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 0.9886 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.3882 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.3135 | Val  Acc: 0.6043
 Site-SVHN                          | Val  Loss: 1.5016 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5554 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6956
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8993
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8849
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6978
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.5217
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6043
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/q-ffl...
===2023-07-30 08:04:14===
===2023-07-30 08:04:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8809
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8903
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.6803
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.5210
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.4213
MNIST: 0.8809, USPS: 0.8903, SynthDigits: 0.6803, MNIST_M: 0.5210, SVHN: 0.4213, 
Average Test Accuracy(group): 0.6787, Average Test Accuracy(individual): 0.6787,
domain std=0.1880, cluster std=-1.0000, individual std=0.1880, 
