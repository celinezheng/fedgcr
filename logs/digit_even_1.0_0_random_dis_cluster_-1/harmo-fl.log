===2023-07-30 09:51:14===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.3021 | Train Acc: 0.7439
 Site-MNIST                         | Train Loss: 1.3574 | Train Acc: 0.6978
 Site-USPS                          | Train Loss: 1.1152 | Train Acc: 0.7951
 Site-USPS                          | Train Loss: 1.1029 | Train Acc: 0.8135
 Site-SynthDigits                   | Train Loss: 1.8701 | Train Acc: 0.3827
 Site-SynthDigits                   | Train Loss: 1.8016 | Train Acc: 0.4439
 Site-MNIST_M                       | Train Loss: 2.0636 | Train Acc: 0.2911
 Site-MNIST_M                       | Train Loss: 2.0606 | Train Acc: 0.3112
 Site-SVHN                          | Train Loss: 2.1514 | Train Acc: 0.2372
 Site-SVHN                          | Train Loss: 2.1272 | Train Acc: 0.2529
Average Train Accuracy: 0.4969
 Site-MNIST                         | Val  Loss: 1.3986 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3511 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.1988 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 1.1547 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.8814 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 1.8441 | Val  Acc: 0.3957
 Site-MNIST_M                       | Val  Loss: 2.0557 | Val  Acc: 0.3370
 Site-MNIST_M                       | Val  Loss: 2.0372 | Val  Acc: 0.3489
 Site-SVHN                          | Val  Loss: 2.1101 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1379 | Val  Acc: 0.2662
Average Valid Accuracy: 0.4928
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3957
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3370
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3489
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2662
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.8327 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.9558 | Train Acc: 0.7462
 Site-USPS                          | Train Loss: 0.7028 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.6956 | Train Acc: 0.8520
 Site-SynthDigits                   | Train Loss: 1.5740 | Train Acc: 0.5121
 Site-SynthDigits                   | Train Loss: 1.4517 | Train Acc: 0.5605
 Site-MNIST_M                       | Train Loss: 1.7755 | Train Acc: 0.4205
 Site-MNIST_M                       | Train Loss: 1.8031 | Train Acc: 0.3973
 Site-SVHN                          | Train Loss: 2.0282 | Train Acc: 0.2884
 Site-SVHN                          | Train Loss: 1.9486 | Train Acc: 0.3283
Average Train Accuracy: 0.5785
 Site-MNIST                         | Val  Loss: 0.9543 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 0.9287 | Val  Acc: 0.7698
 Site-USPS                          | Val  Loss: 0.8180 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.7485 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.4920 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.5149 | Val  Acc: 0.5360
 Site-MNIST_M                       | Val  Loss: 1.8028 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.7461 | Val  Acc: 0.4281
 Site-SVHN                          | Val  Loss: 1.8744 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9499 | Val  Acc: 0.3237
Average Valid Accuracy: 0.5617
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7698
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.5360
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4281
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.6359 | Train Acc: 0.8679
 Site-MNIST                         | Train Loss: 0.7256 | Train Acc: 0.7946
 Site-USPS                          | Train Loss: 0.5638 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.5790 | Train Acc: 0.8448
 Site-SynthDigits                   | Train Loss: 1.4722 | Train Acc: 0.5094
 Site-SynthDigits                   | Train Loss: 1.3327 | Train Acc: 0.5776
 Site-MNIST_M                       | Train Loss: 1.6684 | Train Acc: 0.4340
 Site-MNIST_M                       | Train Loss: 1.7065 | Train Acc: 0.4233
 Site-SVHN                          | Train Loss: 1.9387 | Train Acc: 0.3019
 Site-SVHN                          | Train Loss: 1.8676 | Train Acc: 0.3444
Average Train Accuracy: 0.5963
 Site-MNIST                         | Val  Loss: 0.7071 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6978 | Val  Acc: 0.8417
 Site-USPS                          | Val  Loss: 0.7031 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 0.6107 | Val  Acc: 0.8058
 Site-SynthDigits                   | Val  Loss: 1.3621 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.4168 | Val  Acc: 0.5144
 Site-MNIST_M                       | Val  Loss: 1.6686 | Val  Acc: 0.3804
 Site-MNIST_M                       | Val  Loss: 1.6543 | Val  Acc: 0.4209
 Site-SVHN                          | Val  Loss: 1.8166 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.8815 | Val  Acc: 0.3237
Average Valid Accuracy: 0.5689
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8417
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8058
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5144
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3804
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4209
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.5298 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.6290 | Train Acc: 0.8305
 Site-USPS                          | Train Loss: 0.4783 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.4677 | Train Acc: 0.8798
 Site-SynthDigits                   | Train Loss: 1.3351 | Train Acc: 0.5822
 Site-SynthDigits                   | Train Loss: 1.2129 | Train Acc: 0.6045
 Site-MNIST_M                       | Train Loss: 1.5958 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.5864 | Train Acc: 0.4619
 Site-SVHN                          | Train Loss: 1.8724 | Train Acc: 0.3315
 Site-SVHN                          | Train Loss: 1.7886 | Train Acc: 0.3659
Average Train Accuracy: 0.6267
 Site-MNIST                         | Val  Loss: 0.5943 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5988 | Val  Acc: 0.8597
 Site-USPS                          | Val  Loss: 0.5963 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.5166 | Val  Acc: 0.8489
 Site-SynthDigits                   | Val  Loss: 1.2293 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.2702 | Val  Acc: 0.5899
 Site-MNIST_M                       | Val  Loss: 1.5749 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.5141 | Val  Acc: 0.4892
 Site-SVHN                          | Val  Loss: 1.6916 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.7845 | Val  Acc: 0.3813
Average Valid Accuracy: 0.6191
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8597
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8489
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5899
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4892
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3813
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.4860 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.5566 | Train Acc: 0.8439
 Site-USPS                          | Train Loss: 0.4004 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.3972 | Train Acc: 0.9058
 Site-SynthDigits                   | Train Loss: 1.2701 | Train Acc: 0.5768
 Site-SynthDigits                   | Train Loss: 1.1227 | Train Acc: 0.6215
 Site-MNIST_M                       | Train Loss: 1.5433 | Train Acc: 0.4744
 Site-MNIST_M                       | Train Loss: 1.5217 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.8457 | Train Acc: 0.3261
 Site-SVHN                          | Train Loss: 1.7208 | Train Acc: 0.4108
Average Train Accuracy: 0.6391
 Site-MNIST                         | Val  Loss: 0.5264 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5343 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.5973 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4649 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 1.1537 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.2076 | Val  Acc: 0.5647
 Site-MNIST_M                       | Val  Loss: 1.4893 | Val  Acc: 0.4783
 Site-MNIST_M                       | Val  Loss: 1.4496 | Val  Acc: 0.4964
 Site-SVHN                          | Val  Loss: 1.6031 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.7183 | Val  Acc: 0.4137
Average Valid Accuracy: 0.6426
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8777
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5647
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4783
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4964
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4137
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.4162 | Train Acc: 0.8625
 Site-MNIST                         | Train Loss: 0.4716 | Train Acc: 0.8574
 Site-USPS                          | Train Loss: 0.3737 | Train Acc: 0.9164
 Site-USPS                          | Train Loss: 0.3515 | Train Acc: 0.9166
 Site-SynthDigits                   | Train Loss: 1.2046 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.0712 | Train Acc: 0.6646
 Site-MNIST_M                       | Train Loss: 1.4810 | Train Acc: 0.4879
 Site-MNIST_M                       | Train Loss: 1.4478 | Train Acc: 0.5022
 Site-SVHN                          | Train Loss: 1.8091 | Train Acc: 0.3666
 Site-SVHN                          | Train Loss: 1.6779 | Train Acc: 0.4179
Average Train Accuracy: 0.6612
 Site-MNIST                         | Val  Loss: 0.4535 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4752 | Val  Acc: 0.8597
 Site-USPS                          | Val  Loss: 0.5441 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.4273 | Val  Acc: 0.8885
 Site-SynthDigits                   | Val  Loss: 1.1431 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.1421 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.3932 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.3699 | Val  Acc: 0.5252
 Site-SVHN                          | Val  Loss: 1.5847 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.6822 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6628
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8597
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8587
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8885
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5252
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4565
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.4049 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.4538 | Train Acc: 0.8493
 Site-USPS                          | Train Loss: 0.3442 | Train Acc: 0.9191
 Site-USPS                          | Train Loss: 0.3360 | Train Acc: 0.9229
 Site-SynthDigits                   | Train Loss: 1.1638 | Train Acc: 0.6280
 Site-SynthDigits                   | Train Loss: 1.0110 | Train Acc: 0.6673
 Site-MNIST_M                       | Train Loss: 1.4419 | Train Acc: 0.5094
 Site-MNIST_M                       | Train Loss: 1.3971 | Train Acc: 0.5318
 Site-SVHN                          | Train Loss: 1.7309 | Train Acc: 0.3989
 Site-SVHN                          | Train Loss: 1.6166 | Train Acc: 0.4538
Average Train Accuracy: 0.6746
 Site-MNIST                         | Val  Loss: 0.4129 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.4408 | Val  Acc: 0.8525
 Site-USPS                          | Val  Loss: 0.5285 | Val  Acc: 0.8478
 Site-USPS                          | Val  Loss: 0.4050 | Val  Acc: 0.8849
 Site-SynthDigits                   | Val  Loss: 1.0498 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 1.0813 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.3293 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.3319 | Val  Acc: 0.5360
 Site-SVHN                          | Val  Loss: 1.5160 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.5922 | Val  Acc: 0.4856
Average Valid Accuracy: 0.6773
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8525
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8478
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8849
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6739
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5360
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.5109
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.4856
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.3369 | Train Acc: 0.9003
 Site-MNIST                         | Train Loss: 0.3905 | Train Acc: 0.8861
 Site-USPS                          | Train Loss: 0.3163 | Train Acc: 0.9245
 Site-USPS                          | Train Loss: 0.2893 | Train Acc: 0.9238
 Site-SynthDigits                   | Train Loss: 1.1257 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 0.9697 | Train Acc: 0.6861
 Site-MNIST_M                       | Train Loss: 1.3626 | Train Acc: 0.5229
 Site-MNIST_M                       | Train Loss: 1.3335 | Train Acc: 0.5480
 Site-SVHN                          | Train Loss: 1.7488 | Train Acc: 0.3881
 Site-SVHN                          | Train Loss: 1.6311 | Train Acc: 0.4296
Average Train Accuracy: 0.6813
 Site-MNIST                         | Val  Loss: 0.3258 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3550 | Val  Acc: 0.9029
 Site-USPS                          | Val  Loss: 0.4781 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.3558 | Val  Acc: 0.8885
 Site-SynthDigits                   | Val  Loss: 1.0006 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 1.0525 | Val  Acc: 0.6547
 Site-MNIST_M                       | Val  Loss: 1.2807 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.2812 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.5327 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.6046 | Val  Acc: 0.4784
Average Valid Accuracy: 0.6953
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9029
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8885
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6957
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6547
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5612
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.4784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.3174 | Train Acc: 0.9030
 Site-MNIST                         | Train Loss: 0.3393 | Train Acc: 0.8978
 Site-USPS                          | Train Loss: 0.2760 | Train Acc: 0.9353
 Site-USPS                          | Train Loss: 0.2597 | Train Acc: 0.9363
 Site-SynthDigits                   | Train Loss: 1.0846 | Train Acc: 0.6307
 Site-SynthDigits                   | Train Loss: 0.9359 | Train Acc: 0.7049
 Site-MNIST_M                       | Train Loss: 1.3571 | Train Acc: 0.5364
 Site-MNIST_M                       | Train Loss: 1.2906 | Train Acc: 0.5614
 Site-SVHN                          | Train Loss: 1.7264 | Train Acc: 0.4070
 Site-SVHN                          | Train Loss: 1.5899 | Train Acc: 0.4538
Average Train Accuracy: 0.6967
 Site-MNIST                         | Val  Loss: 0.3044 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.3344 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.4529 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.3276 | Val  Acc: 0.9065
 Site-SynthDigits                   | Val  Loss: 0.9853 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 1.0214 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.2197 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.2425 | Val  Acc: 0.5719
 Site-SVHN                          | Val  Loss: 1.4922 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5698 | Val  Acc: 0.4784
Average Valid Accuracy: 0.7076
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8921
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9065
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6957
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6619
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5719
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.4784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.3131 | Train Acc: 0.9030
 Site-MNIST                         | Train Loss: 0.3362 | Train Acc: 0.8996
 Site-USPS                          | Train Loss: 0.2738 | Train Acc: 0.9245
 Site-USPS                          | Train Loss: 0.2636 | Train Acc: 0.9354
 Site-SynthDigits                   | Train Loss: 1.0533 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 0.8932 | Train Acc: 0.7157
 Site-MNIST_M                       | Train Loss: 1.3420 | Train Acc: 0.5337
 Site-MNIST_M                       | Train Loss: 1.2661 | Train Acc: 0.5785
 Site-SVHN                          | Train Loss: 1.6304 | Train Acc: 0.4313
 Site-SVHN                          | Train Loss: 1.5133 | Train Acc: 0.4843
Average Train Accuracy: 0.7050
 Site-MNIST                         | Val  Loss: 0.3008 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.3271 | Val  Acc: 0.9101
 Site-USPS                          | Val  Loss: 0.4686 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.3419 | Val  Acc: 0.8993
 Site-SynthDigits                   | Val  Loss: 0.9245 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9590 | Val  Acc: 0.6906
 Site-MNIST_M                       | Val  Loss: 1.1830 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.2277 | Val  Acc: 0.5647
 Site-SVHN                          | Val  Loss: 1.4139 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.4918 | Val  Acc: 0.5072
Average Valid Accuracy: 0.7224
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9101
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8993
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.6906
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.5647
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.5072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.2803 | Train Acc: 0.9164
 Site-MNIST                         | Train Loss: 0.2917 | Train Acc: 0.9112
 Site-USPS                          | Train Loss: 0.2701 | Train Acc: 0.9272
 Site-USPS                          | Train Loss: 0.2425 | Train Acc: 0.9426
 Site-SynthDigits                   | Train Loss: 0.9947 | Train Acc: 0.6469
 Site-SynthDigits                   | Train Loss: 0.8395 | Train Acc: 0.7390
 Site-MNIST_M                       | Train Loss: 1.3045 | Train Acc: 0.5499
 Site-MNIST_M                       | Train Loss: 1.2104 | Train Acc: 0.6018
 Site-SVHN                          | Train Loss: 1.6329 | Train Acc: 0.4259
 Site-SVHN                          | Train Loss: 1.4765 | Train Acc: 0.4906
Average Train Accuracy: 0.7152
 Site-MNIST                         | Val  Loss: 0.2629 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2874 | Val  Acc: 0.9173
 Site-USPS                          | Val  Loss: 0.4485 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.3142 | Val  Acc: 0.9137
 Site-SynthDigits                   | Val  Loss: 0.8528 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9091 | Val  Acc: 0.7014
 Site-MNIST_M                       | Val  Loss: 1.1497 | Val  Acc: 0.6196
 Site-MNIST_M                       | Val  Loss: 1.1882 | Val  Acc: 0.5863
 Site-SVHN                          | Val  Loss: 1.3877 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.4622 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7394
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9173
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9137
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.7014
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.6196
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5863
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5761
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.2706 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.2765 | Train Acc: 0.9184
 Site-USPS                          | Train Loss: 0.2502 | Train Acc: 0.9326
 Site-USPS                          | Train Loss: 0.2175 | Train Acc: 0.9426
 Site-SynthDigits                   | Train Loss: 1.0108 | Train Acc: 0.6496
 Site-SynthDigits                   | Train Loss: 0.8525 | Train Acc: 0.7372
 Site-MNIST_M                       | Train Loss: 1.2634 | Train Acc: 0.5876
 Site-MNIST_M                       | Train Loss: 1.1762 | Train Acc: 0.6072
 Site-SVHN                          | Train Loss: 1.5997 | Train Acc: 0.4474
 Site-SVHN                          | Train Loss: 1.4725 | Train Acc: 0.5076
Average Train Accuracy: 0.7255
 Site-MNIST                         | Val  Loss: 0.2384 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2617 | Val  Acc: 0.9281
 Site-USPS                          | Val  Loss: 0.4211 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.2826 | Val  Acc: 0.9209
 Site-SynthDigits                   | Val  Loss: 0.8693 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9370 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.1219 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.1472 | Val  Acc: 0.5827
 Site-SVHN                          | Val  Loss: 1.3684 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.4496 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7343
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.2656 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.2696 | Train Acc: 0.9139
 Site-USPS                          | Train Loss: 0.2309 | Train Acc: 0.9434
 Site-USPS                          | Train Loss: 0.2046 | Train Acc: 0.9516
 Site-SynthDigits                   | Train Loss: 0.9607 | Train Acc: 0.6604
 Site-SynthDigits                   | Train Loss: 0.8137 | Train Acc: 0.7516
 Site-MNIST_M                       | Train Loss: 1.2544 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.1413 | Train Acc: 0.6197
 Site-SVHN                          | Train Loss: 1.6052 | Train Acc: 0.4555
 Site-SVHN                          | Train Loss: 1.4742 | Train Acc: 0.5040
Average Train Accuracy: 0.7301
 Site-MNIST                         | Val  Loss: 0.2372 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2616 | Val  Acc: 0.9209
 Site-USPS                          | Val  Loss: 0.4009 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.2681 | Val  Acc: 0.9281
 Site-SynthDigits                   | Val  Loss: 0.8183 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.8944 | Val  Acc: 0.6906
 Site-MNIST_M                       | Val  Loss: 1.0528 | Val  Acc: 0.6739
 Site-MNIST_M                       | Val  Loss: 1.1283 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.3233 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.4326 | Val  Acc: 0.5576
Average Valid Accuracy: 0.7553
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9209
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8913
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9281
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6906
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.6739
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.6079
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.5576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.2422 | Train Acc: 0.9299
 Site-MNIST                         | Train Loss: 0.2400 | Train Acc: 0.9336
 Site-USPS                          | Train Loss: 0.2275 | Train Acc: 0.9272
 Site-USPS                          | Train Loss: 0.2034 | Train Acc: 0.9453
 Site-SynthDigits                   | Train Loss: 0.9206 | Train Acc: 0.6819
 Site-SynthDigits                   | Train Loss: 0.7601 | Train Acc: 0.7677
 Site-MNIST_M                       | Train Loss: 1.2284 | Train Acc: 0.5741
 Site-MNIST_M                       | Train Loss: 1.1139 | Train Acc: 0.6404
 Site-SVHN                          | Train Loss: 1.5593 | Train Acc: 0.4717
 Site-SVHN                          | Train Loss: 1.4171 | Train Acc: 0.5112
Average Train Accuracy: 0.7383
 Site-MNIST                         | Val  Loss: 0.2076 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2341 | Val  Acc: 0.9353
 Site-USPS                          | Val  Loss: 0.4073 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2708 | Val  Acc: 0.9065
 Site-SynthDigits                   | Val  Loss: 0.7832 | Val  Acc: 0.7717
 Site-SynthDigits                   | Val  Loss: 0.8394 | Val  Acc: 0.7230
 Site-MNIST_M                       | Val  Loss: 1.0420 | Val  Acc: 0.6196
 Site-MNIST_M                       | Val  Loss: 1.0956 | Val  Acc: 0.6043
 Site-SVHN                          | Val  Loss: 1.2931 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.4018 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7466
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.2259 | Train Acc: 0.9380
 Site-MNIST                         | Train Loss: 0.2370 | Train Acc: 0.9363
 Site-USPS                          | Train Loss: 0.2172 | Train Acc: 0.9353
 Site-USPS                          | Train Loss: 0.1946 | Train Acc: 0.9498
 Site-SynthDigits                   | Train Loss: 0.9101 | Train Acc: 0.6981
 Site-SynthDigits                   | Train Loss: 0.7640 | Train Acc: 0.7668
 Site-MNIST_M                       | Train Loss: 1.2464 | Train Acc: 0.5903
 Site-MNIST_M                       | Train Loss: 1.1063 | Train Acc: 0.6377
 Site-SVHN                          | Train Loss: 1.5759 | Train Acc: 0.4636
 Site-SVHN                          | Train Loss: 1.4163 | Train Acc: 0.5283
Average Train Accuracy: 0.7444
 Site-MNIST                         | Val  Loss: 0.2170 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2318 | Val  Acc: 0.9353
 Site-USPS                          | Val  Loss: 0.3949 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.2585 | Val  Acc: 0.9209
 Site-SynthDigits                   | Val  Loss: 0.7823 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.8324 | Val  Acc: 0.7194
 Site-MNIST_M                       | Val  Loss: 1.0102 | Val  Acc: 0.6630
 Site-MNIST_M                       | Val  Loss: 1.0886 | Val  Acc: 0.6223
 Site-SVHN                          | Val  Loss: 1.2830 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.4047 | Val  Acc: 0.5432
Average Valid Accuracy: 0.7524
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.2226 | Train Acc: 0.9299
 Site-MNIST                         | Train Loss: 0.2194 | Train Acc: 0.9363
 Site-USPS                          | Train Loss: 0.2008 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1753 | Train Acc: 0.9525
 Site-SynthDigits                   | Train Loss: 0.8792 | Train Acc: 0.7089
 Site-SynthDigits                   | Train Loss: 0.7439 | Train Acc: 0.7722
 Site-MNIST_M                       | Train Loss: 1.1911 | Train Acc: 0.5876
 Site-MNIST_M                       | Train Loss: 1.0578 | Train Acc: 0.6565
 Site-SVHN                          | Train Loss: 1.5644 | Train Acc: 0.4663
 Site-SVHN                          | Train Loss: 1.3990 | Train Acc: 0.5336
Average Train Accuracy: 0.7495
 Site-MNIST                         | Val  Loss: 0.1899 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2176 | Val  Acc: 0.9353
 Site-USPS                          | Val  Loss: 0.3592 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.2400 | Val  Acc: 0.9353
 Site-SynthDigits                   | Val  Loss: 0.7490 | Val  Acc: 0.7826
 Site-SynthDigits                   | Val  Loss: 0.8057 | Val  Acc: 0.7266
 Site-MNIST_M                       | Val  Loss: 0.9716 | Val  Acc: 0.6848
 Site-MNIST_M                       | Val  Loss: 1.0412 | Val  Acc: 0.6403
 Site-SVHN                          | Val  Loss: 1.2664 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.3810 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7654
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9353
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8913
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9353
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.7826
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.7266
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.6848
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.6403
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.5761
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.5468
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.2096 | Train Acc: 0.9407
 Site-MNIST                         | Train Loss: 0.2048 | Train Acc: 0.9471
 Site-USPS                          | Train Loss: 0.2094 | Train Acc: 0.9461
 Site-USPS                          | Train Loss: 0.1789 | Train Acc: 0.9543
 Site-SynthDigits                   | Train Loss: 0.8634 | Train Acc: 0.7116
 Site-SynthDigits                   | Train Loss: 0.7054 | Train Acc: 0.7874
 Site-MNIST_M                       | Train Loss: 1.1941 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.0361 | Train Acc: 0.6583
 Site-SVHN                          | Train Loss: 1.5420 | Train Acc: 0.4690
 Site-SVHN                          | Train Loss: 1.3578 | Train Acc: 0.5381
Average Train Accuracy: 0.7548
 Site-MNIST                         | Val  Loss: 0.1731 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.2014 | Val  Acc: 0.9532
 Site-USPS                          | Val  Loss: 0.3710 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.2415 | Val  Acc: 0.9281
 Site-SynthDigits                   | Val  Loss: 0.6966 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.7685 | Val  Acc: 0.7590
 Site-MNIST_M                       | Val  Loss: 0.9608 | Val  Acc: 0.6848
 Site-MNIST_M                       | Val  Loss: 1.0394 | Val  Acc: 0.6511
 Site-SVHN                          | Val  Loss: 1.2292 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.3450 | Val  Acc: 0.5612
Average Valid Accuracy: 0.7766
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9532
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8913
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9281
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7590
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6848
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6511
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.5761
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.5612
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.2043 | Train Acc: 0.9380
 Site-MNIST                         | Train Loss: 0.1948 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.1880 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1626 | Train Acc: 0.9587
 Site-SynthDigits                   | Train Loss: 0.8613 | Train Acc: 0.7035
 Site-SynthDigits                   | Train Loss: 0.7036 | Train Acc: 0.7848
 Site-MNIST_M                       | Train Loss: 1.1727 | Train Acc: 0.6011
 Site-MNIST_M                       | Train Loss: 0.9934 | Train Acc: 0.6717
 Site-SVHN                          | Train Loss: 1.5467 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.3775 | Train Acc: 0.5363
Average Train Accuracy: 0.7577
 Site-MNIST                         | Val  Loss: 0.1647 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1904 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.3279 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.2157 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.7083 | Val  Acc: 0.7935
 Site-SynthDigits                   | Val  Loss: 0.7864 | Val  Acc: 0.7446
 Site-MNIST_M                       | Val  Loss: 0.9250 | Val  Acc: 0.7283
 Site-MNIST_M                       | Val  Loss: 1.0013 | Val  Acc: 0.6655
 Site-SVHN                          | Val  Loss: 1.2701 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.3635 | Val  Acc: 0.5683
Average Valid Accuracy: 0.7867
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9604
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9496
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7935
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7446
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.7283
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.6655
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.5652
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.2016 | Train Acc: 0.9380
 Site-MNIST                         | Train Loss: 0.1925 | Train Acc: 0.9480
 Site-USPS                          | Train Loss: 0.1912 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1644 | Train Acc: 0.9605
 Site-SynthDigits                   | Train Loss: 0.8137 | Train Acc: 0.7170
 Site-SynthDigits                   | Train Loss: 0.6606 | Train Acc: 0.8090
 Site-MNIST_M                       | Train Loss: 1.1699 | Train Acc: 0.6065
 Site-MNIST_M                       | Train Loss: 0.9886 | Train Acc: 0.6870
 Site-SVHN                          | Train Loss: 1.5261 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.3534 | Train Acc: 0.5471
Average Train Accuracy: 0.7652
 Site-MNIST                         | Val  Loss: 0.1621 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1934 | Val  Acc: 0.9388
 Site-USPS                          | Val  Loss: 0.3432 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.2192 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.6691 | Val  Acc: 0.8261
 Site-SynthDigits                   | Val  Loss: 0.7432 | Val  Acc: 0.7698
 Site-MNIST_M                       | Val  Loss: 0.9035 | Val  Acc: 0.7391
 Site-MNIST_M                       | Val  Loss: 0.9964 | Val  Acc: 0.6655
 Site-SVHN                          | Val  Loss: 1.2145 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.3144 | Val  Acc: 0.5683
Average Valid Accuracy: 0.7914
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9388
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9496
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.8261
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7698
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.7391
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.6655
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5870
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.1756 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1773 | Train Acc: 0.9543
 Site-USPS                          | Train Loss: 0.1863 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1480 | Train Acc: 0.9650
 Site-SynthDigits                   | Train Loss: 0.8201 | Train Acc: 0.7170
 Site-SynthDigits                   | Train Loss: 0.6761 | Train Acc: 0.7991
 Site-MNIST_M                       | Train Loss: 1.1209 | Train Acc: 0.6173
 Site-MNIST_M                       | Train Loss: 0.9431 | Train Acc: 0.6897
 Site-SVHN                          | Train Loss: 1.5403 | Train Acc: 0.4663
 Site-SVHN                          | Train Loss: 1.3498 | Train Acc: 0.5372
Average Train Accuracy: 0.7654
 Site-MNIST                         | Val  Loss: 0.1529 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.1755 | Val  Acc: 0.9460
 Site-USPS                          | Val  Loss: 0.2908 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.2038 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.6933 | Val  Acc: 0.7935
 Site-SynthDigits                   | Val  Loss: 0.7638 | Val  Acc: 0.7482
 Site-MNIST_M                       | Val  Loss: 0.8666 | Val  Acc: 0.7609
 Site-MNIST_M                       | Val  Loss: 0.9548 | Val  Acc: 0.6763
 Site-SVHN                          | Val  Loss: 1.2164 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.3362 | Val  Acc: 0.5683
Average Valid Accuracy: 0.7928
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9460
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7935
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7482
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.7609
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.6763
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.1769 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1738 | Train Acc: 0.9516
 Site-USPS                          | Train Loss: 0.1934 | Train Acc: 0.9488
 Site-USPS                          | Train Loss: 0.1568 | Train Acc: 0.9587
 Site-SynthDigits                   | Train Loss: 0.7961 | Train Acc: 0.7466
 Site-SynthDigits                   | Train Loss: 0.6319 | Train Acc: 0.8152
 Site-MNIST_M                       | Train Loss: 1.1393 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 0.9323 | Train Acc: 0.6978
 Site-SVHN                          | Train Loss: 1.5138 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.3120 | Train Acc: 0.5641
Average Train Accuracy: 0.7713
 Site-MNIST                         | Val  Loss: 0.1537 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1810 | Val  Acc: 0.9353
 Site-USPS                          | Val  Loss: 0.3342 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.2146 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.6532 | Val  Acc: 0.8261
 Site-SynthDigits                   | Val  Loss: 0.7163 | Val  Acc: 0.7734
 Site-MNIST_M                       | Val  Loss: 0.8452 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.9456 | Val  Acc: 0.6942
 Site-SVHN                          | Val  Loss: 1.1565 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.2923 | Val  Acc: 0.5899
Average Valid Accuracy: 0.8084
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9353
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9496
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.8261
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.7734
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.8043
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.6942
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.5899
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.1851 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1703 | Train Acc: 0.9552
 Site-USPS                          | Train Loss: 0.1823 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1391 | Train Acc: 0.9641
 Site-SynthDigits                   | Train Loss: 0.7909 | Train Acc: 0.7358
 Site-SynthDigits                   | Train Loss: 0.6421 | Train Acc: 0.8081
 Site-MNIST_M                       | Train Loss: 1.1154 | Train Acc: 0.6119
 Site-MNIST_M                       | Train Loss: 0.9092 | Train Acc: 0.7022
 Site-SVHN                          | Train Loss: 1.5048 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.2975 | Train Acc: 0.5686
Average Train Accuracy: 0.7737
 Site-MNIST                         | Val  Loss: 0.1417 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1692 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.2842 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1957 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.6613 | Val  Acc: 0.7935
 Site-SynthDigits                   | Val  Loss: 0.7219 | Val  Acc: 0.7662
 Site-MNIST_M                       | Val  Loss: 0.8403 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.9207 | Val  Acc: 0.6978
 Site-SVHN                          | Val  Loss: 1.1528 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.2962 | Val  Acc: 0.5863
Average Valid Accuracy: 0.8058
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.1668 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1639 | Train Acc: 0.9561
 Site-USPS                          | Train Loss: 0.1792 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1430 | Train Acc: 0.9677
 Site-SynthDigits                   | Train Loss: 0.7713 | Train Acc: 0.7358
 Site-SynthDigits                   | Train Loss: 0.6130 | Train Acc: 0.8233
 Site-MNIST_M                       | Train Loss: 1.1121 | Train Acc: 0.6173
 Site-MNIST_M                       | Train Loss: 0.8986 | Train Acc: 0.7139
 Site-SVHN                          | Train Loss: 1.4820 | Train Acc: 0.4960
 Site-SVHN                          | Train Loss: 1.2763 | Train Acc: 0.5650
Average Train Accuracy: 0.7781
 Site-MNIST                         | Val  Loss: 0.1436 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1663 | Val  Acc: 0.9532
 Site-USPS                          | Val  Loss: 0.3140 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1985 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.6244 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.6927 | Val  Acc: 0.7878
 Site-MNIST_M                       | Val  Loss: 0.8204 | Val  Acc: 0.7826
 Site-MNIST_M                       | Val  Loss: 0.9180 | Val  Acc: 0.6942
 Site-SVHN                          | Val  Loss: 1.1325 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.2779 | Val  Acc: 0.5827
Average Valid Accuracy: 0.8105
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9532
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.8478
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.7878
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.7826
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.6942
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.5827
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.1656 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1552 | Train Acc: 0.9614
 Site-USPS                          | Train Loss: 0.1818 | Train Acc: 0.9488
 Site-USPS                          | Train Loss: 0.1438 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 0.7606 | Train Acc: 0.7466
 Site-SynthDigits                   | Train Loss: 0.6039 | Train Acc: 0.8305
 Site-MNIST_M                       | Train Loss: 1.1055 | Train Acc: 0.6038
 Site-MNIST_M                       | Train Loss: 0.8676 | Train Acc: 0.7157
 Site-SVHN                          | Train Loss: 1.5193 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.2971 | Train Acc: 0.5641
Average Train Accuracy: 0.7774
 Site-MNIST                         | Val  Loss: 0.1242 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1452 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.2986 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1907 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.6304 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.6794 | Val  Acc: 0.7842
 Site-MNIST_M                       | Val  Loss: 0.8175 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.8988 | Val  Acc: 0.6835
 Site-SVHN                          | Val  Loss: 1.1171 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.2824 | Val  Acc: 0.5755
Average Valid Accuracy: 0.8065
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.1616 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1489 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1631 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1256 | Train Acc: 0.9704
 Site-SynthDigits                   | Train Loss: 0.7485 | Train Acc: 0.7655
 Site-SynthDigits                   | Train Loss: 0.6072 | Train Acc: 0.8314
 Site-MNIST_M                       | Train Loss: 1.1113 | Train Acc: 0.6173
 Site-MNIST_M                       | Train Loss: 0.8567 | Train Acc: 0.7327
 Site-SVHN                          | Train Loss: 1.5097 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.2825 | Train Acc: 0.5821
Average Train Accuracy: 0.7858
 Site-MNIST                         | Val  Loss: 0.1185 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1388 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2768 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1755 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.6135 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.6688 | Val  Acc: 0.7986
 Site-MNIST_M                       | Val  Loss: 0.7899 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.8867 | Val  Acc: 0.7050
 Site-SVHN                          | Val  Loss: 1.1172 | Val  Acc: 0.6739
 Site-SVHN                          | Val  Loss: 1.2692 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8279
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9640
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.8478
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.7986
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.8152
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.7050
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.6739
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.6007
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.1587 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1513 | Train Acc: 0.9614
 Site-USPS                          | Train Loss: 0.1715 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1273 | Train Acc: 0.9704
 Site-SynthDigits                   | Train Loss: 0.7318 | Train Acc: 0.7574
 Site-SynthDigits                   | Train Loss: 0.5787 | Train Acc: 0.8422
 Site-MNIST_M                       | Train Loss: 1.0865 | Train Acc: 0.6199
 Site-MNIST_M                       | Train Loss: 0.8428 | Train Acc: 0.7283
 Site-SVHN                          | Train Loss: 1.4919 | Train Acc: 0.5148
 Site-SVHN                          | Train Loss: 1.2372 | Train Acc: 0.5830
Average Train Accuracy: 0.7886
 Site-MNIST                         | Val  Loss: 0.1259 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1420 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.2679 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1755 | Val  Acc: 0.9604
 Site-SynthDigits                   | Val  Loss: 0.6012 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.6676 | Val  Acc: 0.7950
 Site-MNIST_M                       | Val  Loss: 0.7728 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.8652 | Val  Acc: 0.7050
 Site-SVHN                          | Val  Loss: 1.0613 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.2350 | Val  Acc: 0.5935
Average Valid Accuracy: 0.8206
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.1545 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1505 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1626 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1222 | Train Acc: 0.9713
 Site-SynthDigits                   | Train Loss: 0.7357 | Train Acc: 0.7574
 Site-SynthDigits                   | Train Loss: 0.5617 | Train Acc: 0.8413
 Site-MNIST_M                       | Train Loss: 1.1017 | Train Acc: 0.6199
 Site-MNIST_M                       | Train Loss: 0.8364 | Train Acc: 0.7318
 Site-SVHN                          | Train Loss: 1.4882 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.2345 | Train Acc: 0.5883
Average Train Accuracy: 0.7893
 Site-MNIST                         | Val  Loss: 0.1211 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1392 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2809 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1742 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.5885 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.6497 | Val  Acc: 0.8094
 Site-MNIST_M                       | Val  Loss: 0.7841 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.8779 | Val  Acc: 0.7014
 Site-SVHN                          | Val  Loss: 1.0705 | Val  Acc: 0.6957
 Site-SVHN                          | Val  Loss: 1.2352 | Val  Acc: 0.6223
Average Valid Accuracy: 0.8318
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9568
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9676
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.8094
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.7935
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.7014
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.6957
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.6223
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.1529 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1425 | Train Acc: 0.9659
 Site-USPS                          | Train Loss: 0.1603 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1159 | Train Acc: 0.9740
 Site-SynthDigits                   | Train Loss: 0.7276 | Train Acc: 0.7439
 Site-SynthDigits                   | Train Loss: 0.5714 | Train Acc: 0.8395
 Site-MNIST_M                       | Train Loss: 1.0852 | Train Acc: 0.6199
 Site-MNIST_M                       | Train Loss: 0.8157 | Train Acc: 0.7399
 Site-SVHN                          | Train Loss: 1.5012 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.2367 | Train Acc: 0.5857
Average Train Accuracy: 0.7884
 Site-MNIST                         | Val  Loss: 0.1237 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1328 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2546 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1635 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.5811 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.6623 | Val  Acc: 0.7842
 Site-MNIST_M                       | Val  Loss: 0.7643 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.8534 | Val  Acc: 0.7086
 Site-SVHN                          | Val  Loss: 1.0670 | Val  Acc: 0.6739
 Site-SVHN                          | Val  Loss: 1.2368 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8261
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.1593 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1433 | Train Acc: 0.9614
 Site-USPS                          | Train Loss: 0.1526 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1141 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 0.7465 | Train Acc: 0.7709
 Site-SynthDigits                   | Train Loss: 0.5559 | Train Acc: 0.8484
 Site-MNIST_M                       | Train Loss: 1.0948 | Train Acc: 0.6173
 Site-MNIST_M                       | Train Loss: 0.8232 | Train Acc: 0.7336
 Site-SVHN                          | Train Loss: 1.4964 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.2077 | Train Acc: 0.5973
Average Train Accuracy: 0.7914
 Site-MNIST                         | Val  Loss: 0.1280 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1478 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2676 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1651 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.5584 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.6419 | Val  Acc: 0.8094
 Site-MNIST_M                       | Val  Loss: 0.7462 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.8734 | Val  Acc: 0.7086
 Site-SVHN                          | Val  Loss: 1.0625 | Val  Acc: 0.6739
 Site-SVHN                          | Val  Loss: 1.2189 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8271
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.1433 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1317 | Train Acc: 0.9641
 Site-USPS                          | Train Loss: 0.1510 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1093 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 0.7319 | Train Acc: 0.7601
 Site-SynthDigits                   | Train Loss: 0.5587 | Train Acc: 0.8493
 Site-MNIST_M                       | Train Loss: 1.0809 | Train Acc: 0.6173
 Site-MNIST_M                       | Train Loss: 0.7947 | Train Acc: 0.7498
 Site-SVHN                          | Train Loss: 1.5062 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.2027 | Train Acc: 0.5857
Average Train Accuracy: 0.7896
 Site-MNIST                         | Val  Loss: 0.1243 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1338 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.2582 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1608 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.5805 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.6418 | Val  Acc: 0.7986
 Site-MNIST_M                       | Val  Loss: 0.7501 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.8374 | Val  Acc: 0.7014
 Site-SVHN                          | Val  Loss: 1.0696 | Val  Acc: 0.6848
 Site-SVHN                          | Val  Loss: 1.2219 | Val  Acc: 0.6079
Average Valid Accuracy: 0.8243
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.1449 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1363 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1556 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1105 | Train Acc: 0.9740
 Site-SynthDigits                   | Train Loss: 0.7066 | Train Acc: 0.7790
 Site-SynthDigits                   | Train Loss: 0.5339 | Train Acc: 0.8538
 Site-MNIST_M                       | Train Loss: 1.0790 | Train Acc: 0.6173
 Site-MNIST_M                       | Train Loss: 0.7992 | Train Acc: 0.7435
 Site-SVHN                          | Train Loss: 1.4880 | Train Acc: 0.5148
 Site-SVHN                          | Train Loss: 1.1983 | Train Acc: 0.5928
Average Train Accuracy: 0.7951
 Site-MNIST                         | Val  Loss: 0.1188 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1357 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.2542 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1584 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.5507 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.6201 | Val  Acc: 0.8094
 Site-MNIST_M                       | Val  Loss: 0.7265 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.8406 | Val  Acc: 0.7086
 Site-SVHN                          | Val  Loss: 1.0285 | Val  Acc: 0.7065
 Site-SVHN                          | Val  Loss: 1.1952 | Val  Acc: 0.6223
Average Valid Accuracy: 0.8336
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9604
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9640
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.8094
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.8152
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.7086
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.7065
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.6223
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.1496 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1270 | Train Acc: 0.9713
 Site-USPS                          | Train Loss: 0.1484 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1114 | Train Acc: 0.9740
 Site-SynthDigits                   | Train Loss: 0.6930 | Train Acc: 0.7763
 Site-SynthDigits                   | Train Loss: 0.5195 | Train Acc: 0.8538
 Site-MNIST_M                       | Train Loss: 1.0623 | Train Acc: 0.6334
 Site-MNIST_M                       | Train Loss: 0.7811 | Train Acc: 0.7516
 Site-SVHN                          | Train Loss: 1.4771 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.1957 | Train Acc: 0.5937
Average Train Accuracy: 0.7983
 Site-MNIST                         | Val  Loss: 0.1029 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1207 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.2545 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1550 | Val  Acc: 0.9604
 Site-SynthDigits                   | Val  Loss: 0.5399 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5989 | Val  Acc: 0.8094
 Site-MNIST_M                       | Val  Loss: 0.7194 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.8100 | Val  Acc: 0.7122
 Site-SVHN                          | Val  Loss: 1.0288 | Val  Acc: 0.6848
 Site-SVHN                          | Val  Loss: 1.1871 | Val  Acc: 0.6331
Average Valid Accuracy: 0.8333
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.1462 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1200 | Train Acc: 0.9686
 Site-USPS                          | Train Loss: 0.1337 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1025 | Train Acc: 0.9749
 Site-SynthDigits                   | Train Loss: 0.6950 | Train Acc: 0.7871
 Site-SynthDigits                   | Train Loss: 0.5190 | Train Acc: 0.8583
 Site-MNIST_M                       | Train Loss: 1.0637 | Train Acc: 0.6280
 Site-MNIST_M                       | Train Loss: 0.7669 | Train Acc: 0.7570
 Site-SVHN                          | Train Loss: 1.4742 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.1850 | Train Acc: 0.6000
Average Train Accuracy: 0.8002
 Site-MNIST                         | Val  Loss: 0.1042 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1172 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2303 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1454 | Val  Acc: 0.9604
 Site-SynthDigits                   | Val  Loss: 0.5347 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.6014 | Val  Acc: 0.8094
 Site-MNIST_M                       | Val  Loss: 0.7184 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.8116 | Val  Acc: 0.7338
 Site-SVHN                          | Val  Loss: 1.0317 | Val  Acc: 0.6957
 Site-SVHN                          | Val  Loss: 1.1904 | Val  Acc: 0.6403
Average Valid Accuracy: 0.8354
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9604
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.8094
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.8043
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.7338
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.6957
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.6403
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.1365 | Train Acc: 0.9650
 Site-MNIST                         | Train Loss: 0.1174 | Train Acc: 0.9659
 Site-USPS                          | Train Loss: 0.1418 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1017 | Train Acc: 0.9776
 Site-SynthDigits                   | Train Loss: 0.7012 | Train Acc: 0.7682
 Site-SynthDigits                   | Train Loss: 0.5193 | Train Acc: 0.8511
 Site-MNIST_M                       | Train Loss: 1.0529 | Train Acc: 0.6146
 Site-MNIST_M                       | Train Loss: 0.7562 | Train Acc: 0.7677
 Site-SVHN                          | Train Loss: 1.4768 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.1660 | Train Acc: 0.6009
Average Train Accuracy: 0.7975
 Site-MNIST                         | Val  Loss: 0.1133 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1172 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2080 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1444 | Val  Acc: 0.9604
 Site-SynthDigits                   | Val  Loss: 0.5400 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.6095 | Val  Acc: 0.8058
 Site-MNIST_M                       | Val  Loss: 0.7069 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7983 | Val  Acc: 0.7266
 Site-SVHN                          | Val  Loss: 1.0048 | Val  Acc: 0.7065
 Site-SVHN                          | Val  Loss: 1.1760 | Val  Acc: 0.6331
Average Valid Accuracy: 0.8365
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9568
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9604
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.8058
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.7266
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.7065
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.6331
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1332 | Train Acc: 0.9650
 Site-MNIST                         | Train Loss: 0.1212 | Train Acc: 0.9695
 Site-USPS                          | Train Loss: 0.1368 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.0949 | Train Acc: 0.9812
 Site-SynthDigits                   | Train Loss: 0.6932 | Train Acc: 0.7844
 Site-SynthDigits                   | Train Loss: 0.4955 | Train Acc: 0.8655
 Site-MNIST_M                       | Train Loss: 1.0596 | Train Acc: 0.6361
 Site-MNIST_M                       | Train Loss: 0.7554 | Train Acc: 0.7534
 Site-SVHN                          | Train Loss: 1.4546 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.1772 | Train Acc: 0.6072
Average Train Accuracy: 0.8045
 Site-MNIST                         | Val  Loss: 0.1113 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1179 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.2179 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1421 | Val  Acc: 0.9712
 Site-SynthDigits                   | Val  Loss: 0.5189 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5977 | Val  Acc: 0.8129
 Site-MNIST_M                       | Val  Loss: 0.6926 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.8061 | Val  Acc: 0.7338
 Site-SVHN                          | Val  Loss: 1.0091 | Val  Acc: 0.7065
 Site-SVHN                          | Val  Loss: 1.1654 | Val  Acc: 0.6511
Average Valid Accuracy: 0.8416
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9640
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9712
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8129
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.7338
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.7065
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.6511
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1388 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1196 | Train Acc: 0.9695
 Site-USPS                          | Train Loss: 0.1348 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0981 | Train Acc: 0.9794
 Site-SynthDigits                   | Train Loss: 0.6793 | Train Acc: 0.7871
 Site-SynthDigits                   | Train Loss: 0.4904 | Train Acc: 0.8646
 Site-MNIST_M                       | Train Loss: 1.0763 | Train Acc: 0.6334
 Site-MNIST_M                       | Train Loss: 0.7746 | Train Acc: 0.7516
 Site-SVHN                          | Train Loss: 1.4572 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 1.1538 | Train Acc: 0.6054
Average Train Accuracy: 0.8036
 Site-MNIST                         | Val  Loss: 0.1026 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1132 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.2281 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1426 | Val  Acc: 0.9604
 Site-SynthDigits                   | Val  Loss: 0.5000 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5649 | Val  Acc: 0.8201
 Site-MNIST_M                       | Val  Loss: 0.7002 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.8294 | Val  Acc: 0.7302
 Site-SVHN                          | Val  Loss: 0.9755 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.1314 | Val  Acc: 0.6691
Average Valid Accuracy: 0.8459
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9748
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9604
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8201
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.8152
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.7302
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.7283
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.6691
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.1316 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1130 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.1410 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0978 | Train Acc: 0.9767
 Site-SynthDigits                   | Train Loss: 0.6770 | Train Acc: 0.7871
 Site-SynthDigits                   | Train Loss: 0.4764 | Train Acc: 0.8753
 Site-MNIST_M                       | Train Loss: 1.0358 | Train Acc: 0.6361
 Site-MNIST_M                       | Train Loss: 0.7321 | Train Acc: 0.7740
 Site-SVHN                          | Train Loss: 1.4564 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.1385 | Train Acc: 0.6108
Average Train Accuracy: 0.8074
 Site-MNIST                         | Val  Loss: 0.1028 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1125 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2232 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1377 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4989 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5656 | Val  Acc: 0.8237
 Site-MNIST_M                       | Val  Loss: 0.6631 | Val  Acc: 0.8478
 Site-MNIST_M                       | Val  Loss: 0.7849 | Val  Acc: 0.7518
 Site-SVHN                          | Val  Loss: 0.9823 | Val  Acc: 0.7391
 Site-SVHN                          | Val  Loss: 1.1439 | Val  Acc: 0.6619
Average Valid Accuracy: 0.8535
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9676
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.8237
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.8478
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.7518
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.7391
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.6619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1268 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.1070 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.1358 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.0939 | Train Acc: 0.9785
 Site-SynthDigits                   | Train Loss: 0.6707 | Train Acc: 0.7925
 Site-SynthDigits                   | Train Loss: 0.4895 | Train Acc: 0.8691
 Site-MNIST_M                       | Train Loss: 1.0314 | Train Acc: 0.6307
 Site-MNIST_M                       | Train Loss: 0.7115 | Train Acc: 0.7785
 Site-SVHN                          | Train Loss: 1.4639 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.1556 | Train Acc: 0.6036
Average Train Accuracy: 0.8078
 Site-MNIST                         | Val  Loss: 0.1022 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1045 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2062 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1322 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.5088 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5800 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.6638 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7687 | Val  Acc: 0.7446
 Site-SVHN                          | Val  Loss: 0.9697 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.1524 | Val  Acc: 0.6511
Average Valid Accuracy: 0.8474
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1304 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1073 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1354 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0943 | Train Acc: 0.9821
 Site-SynthDigits                   | Train Loss: 0.6695 | Train Acc: 0.7817
 Site-SynthDigits                   | Train Loss: 0.4629 | Train Acc: 0.8717
 Site-MNIST_M                       | Train Loss: 1.0593 | Train Acc: 0.6388
 Site-MNIST_M                       | Train Loss: 0.7269 | Train Acc: 0.7686
 Site-SVHN                          | Train Loss: 1.4652 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.1367 | Train Acc: 0.6072
Average Train Accuracy: 0.8051
 Site-MNIST                         | Val  Loss: 0.0966 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1038 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2123 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1361 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4677 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.5435 | Val  Acc: 0.8273
 Site-MNIST_M                       | Val  Loss: 0.6765 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.7986 | Val  Acc: 0.7446
 Site-SVHN                          | Val  Loss: 0.9579 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.1339 | Val  Acc: 0.6583
Average Valid Accuracy: 0.8539
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9820
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9676
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.8913
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.8273
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.7446
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.7283
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.6583
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1221 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.1026 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1295 | Train Acc: 0.9704
 Site-USPS                          | Train Loss: 0.0872 | Train Acc: 0.9830
 Site-SynthDigits                   | Train Loss: 0.6630 | Train Acc: 0.7817
 Site-SynthDigits                   | Train Loss: 0.4682 | Train Acc: 0.8682
 Site-MNIST_M                       | Train Loss: 1.0468 | Train Acc: 0.6361
 Site-MNIST_M                       | Train Loss: 0.7040 | Train Acc: 0.7776
 Site-SVHN                          | Train Loss: 1.4734 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.1435 | Train Acc: 0.6072
Average Train Accuracy: 0.8087
 Site-MNIST                         | Val  Loss: 0.0930 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.0984 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.1965 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1276 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4856 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5550 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.6502 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7684 | Val  Acc: 0.7590
 Site-SVHN                          | Val  Loss: 0.9679 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.1413 | Val  Acc: 0.6691
Average Valid Accuracy: 0.8531
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1198 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.1044 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1281 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0888 | Train Acc: 0.9830
 Site-SynthDigits                   | Train Loss: 0.6694 | Train Acc: 0.7763
 Site-SynthDigits                   | Train Loss: 0.4806 | Train Acc: 0.8628
 Site-MNIST_M                       | Train Loss: 1.0439 | Train Acc: 0.6388
 Site-MNIST_M                       | Train Loss: 0.7120 | Train Acc: 0.7731
 Site-SVHN                          | Train Loss: 1.4611 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.1275 | Train Acc: 0.6117
Average Train Accuracy: 0.8051
 Site-MNIST                         | Val  Loss: 0.0910 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.0952 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.2097 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1229 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4800 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5696 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.6588 | Val  Acc: 0.8478
 Site-MNIST_M                       | Val  Loss: 0.7671 | Val  Acc: 0.7626
 Site-SVHN                          | Val  Loss: 0.9758 | Val  Acc: 0.7065
 Site-SVHN                          | Val  Loss: 1.1254 | Val  Acc: 0.6475
Average Valid Accuracy: 0.8473
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1167 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.0948 | Train Acc: 0.9794
 Site-USPS                          | Train Loss: 0.1321 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0870 | Train Acc: 0.9803
 Site-SynthDigits                   | Train Loss: 0.6543 | Train Acc: 0.7871
 Site-SynthDigits                   | Train Loss: 0.4540 | Train Acc: 0.8700
 Site-MNIST_M                       | Train Loss: 1.0369 | Train Acc: 0.6334
 Site-MNIST_M                       | Train Loss: 0.7025 | Train Acc: 0.7785
 Site-SVHN                          | Train Loss: 1.4803 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.1269 | Train Acc: 0.6224
Average Train Accuracy: 0.8074
 Site-MNIST                         | Val  Loss: 0.0841 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.0892 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2149 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1285 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4724 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5450 | Val  Acc: 0.8201
 Site-MNIST_M                       | Val  Loss: 0.6490 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7583 | Val  Acc: 0.7554
 Site-SVHN                          | Val  Loss: 0.9643 | Val  Acc: 0.7065
 Site-SVHN                          | Val  Loss: 1.1253 | Val  Acc: 0.6547
Average Valid Accuracy: 0.8517
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1191 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.1013 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1323 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0865 | Train Acc: 0.9794
 Site-SynthDigits                   | Train Loss: 0.6388 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.4420 | Train Acc: 0.8798
 Site-MNIST_M                       | Train Loss: 1.0553 | Train Acc: 0.6415
 Site-MNIST_M                       | Train Loss: 0.7073 | Train Acc: 0.7785
 Site-SVHN                          | Train Loss: 1.4554 | Train Acc: 0.5364
 Site-SVHN                          | Train Loss: 1.0836 | Train Acc: 0.6251
Average Train Accuracy: 0.8135
 Site-MNIST                         | Val  Loss: 0.0931 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.0955 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2060 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1253 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4531 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5240 | Val  Acc: 0.8309
 Site-MNIST_M                       | Val  Loss: 0.6525 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7726 | Val  Acc: 0.7482
 Site-SVHN                          | Val  Loss: 0.9077 | Val  Acc: 0.7391
 Site-SVHN                          | Val  Loss: 1.0844 | Val  Acc: 0.6835
Average Valid Accuracy: 0.8560
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9676
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.8309
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.7482
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.7391
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.6835
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1173 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.1014 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1305 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0842 | Train Acc: 0.9812
 Site-SynthDigits                   | Train Loss: 0.6540 | Train Acc: 0.7898
 Site-SynthDigits                   | Train Loss: 0.4510 | Train Acc: 0.8753
 Site-MNIST_M                       | Train Loss: 1.0075 | Train Acc: 0.6577
 Site-MNIST_M                       | Train Loss: 0.6605 | Train Acc: 0.7982
 Site-SVHN                          | Train Loss: 1.4735 | Train Acc: 0.5283
 Site-SVHN                          | Train Loss: 1.1024 | Train Acc: 0.6206
Average Train Accuracy: 0.8159
 Site-MNIST                         | Val  Loss: 0.1068 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.0996 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.1762 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1229 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4715 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.5558 | Val  Acc: 0.8201
 Site-MNIST_M                       | Val  Loss: 0.6457 | Val  Acc: 0.8478
 Site-MNIST_M                       | Val  Loss: 0.7413 | Val  Acc: 0.7626
 Site-SVHN                          | Val  Loss: 0.9215 | Val  Acc: 0.6957
 Site-SVHN                          | Val  Loss: 1.0913 | Val  Acc: 0.6655
Average Valid Accuracy: 0.8491
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1180 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0984 | Train Acc: 0.9758
 Site-USPS                          | Train Loss: 0.1295 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0843 | Train Acc: 0.9812
 Site-SynthDigits                   | Train Loss: 0.6562 | Train Acc: 0.7871
 Site-SynthDigits                   | Train Loss: 0.4481 | Train Acc: 0.8709
 Site-MNIST_M                       | Train Loss: 1.0231 | Train Acc: 0.6442
 Site-MNIST_M                       | Train Loss: 0.6562 | Train Acc: 0.7937
 Site-SVHN                          | Train Loss: 1.4400 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.0888 | Train Acc: 0.6224
Average Train Accuracy: 0.8133
 Site-MNIST                         | Val  Loss: 0.1000 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.0990 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1750 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1179 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4683 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5441 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.6205 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7297 | Val  Acc: 0.7518
 Site-SVHN                          | Val  Loss: 0.8968 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.0694 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8517
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1152 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.0978 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1197 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.0796 | Train Acc: 0.9821
 Site-SynthDigits                   | Train Loss: 0.6460 | Train Acc: 0.8032
 Site-SynthDigits                   | Train Loss: 0.4503 | Train Acc: 0.8834
 Site-MNIST_M                       | Train Loss: 1.0120 | Train Acc: 0.6469
 Site-MNIST_M                       | Train Loss: 0.6712 | Train Acc: 0.7946
 Site-SVHN                          | Train Loss: 1.4570 | Train Acc: 0.5364
 Site-SVHN                          | Train Loss: 1.0956 | Train Acc: 0.6242
Average Train Accuracy: 0.8181
 Site-MNIST                         | Val  Loss: 0.1015 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.0971 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1660 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1163 | Val  Acc: 0.9712
 Site-SynthDigits                   | Val  Loss: 0.4646 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5318 | Val  Acc: 0.8345
 Site-MNIST_M                       | Val  Loss: 0.6223 | Val  Acc: 0.8478
 Site-MNIST_M                       | Val  Loss: 0.7408 | Val  Acc: 0.7590
 Site-SVHN                          | Val  Loss: 0.9031 | Val  Acc: 0.7500
 Site-SVHN                          | Val  Loss: 1.0687 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8564
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9676
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9712
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.8345
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.8478
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.7590
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.7500
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.6727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1099 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.0885 | Train Acc: 0.9812
 Site-USPS                          | Train Loss: 0.1144 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.0773 | Train Acc: 0.9821
 Site-SynthDigits                   | Train Loss: 0.6336 | Train Acc: 0.7978
 Site-SynthDigits                   | Train Loss: 0.4452 | Train Acc: 0.8834
 Site-MNIST_M                       | Train Loss: 0.9954 | Train Acc: 0.6550
 Site-MNIST_M                       | Train Loss: 0.6602 | Train Acc: 0.7964
 Site-SVHN                          | Train Loss: 1.4533 | Train Acc: 0.5148
 Site-SVHN                          | Train Loss: 1.0964 | Train Acc: 0.6287
Average Train Accuracy: 0.8180
 Site-MNIST                         | Val  Loss: 0.0926 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.0876 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1639 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1192 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4751 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5230 | Val  Acc: 0.8273
 Site-MNIST_M                       | Val  Loss: 0.6102 | Val  Acc: 0.8587
 Site-MNIST_M                       | Val  Loss: 0.7185 | Val  Acc: 0.7662
 Site-SVHN                          | Val  Loss: 0.9179 | Val  Acc: 0.7717
 Site-SVHN                          | Val  Loss: 1.0804 | Val  Acc: 0.6835
Average Valid Accuracy: 0.8596
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9676
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.8273
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.8587
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.7662
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.7717
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.6835
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1141 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.0915 | Train Acc: 0.9821
 Site-USPS                          | Train Loss: 0.1338 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.0787 | Train Acc: 0.9794
 Site-SynthDigits                   | Train Loss: 0.6307 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.4316 | Train Acc: 0.8852
 Site-MNIST_M                       | Train Loss: 1.0025 | Train Acc: 0.6631
 Site-MNIST_M                       | Train Loss: 0.6412 | Train Acc: 0.7964
 Site-SVHN                          | Train Loss: 1.4586 | Train Acc: 0.5337
 Site-SVHN                          | Train Loss: 1.0845 | Train Acc: 0.6386
Average Train Accuracy: 0.8203
 Site-MNIST                         | Val  Loss: 0.0894 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.0900 | Val  Acc: 0.9784
 Site-USPS                          | Val  Loss: 0.1804 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1169 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4634 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5166 | Val  Acc: 0.8273
 Site-MNIST_M                       | Val  Loss: 0.5910 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7039 | Val  Acc: 0.7698
 Site-SVHN                          | Val  Loss: 0.8957 | Val  Acc: 0.7609
 Site-SVHN                          | Val  Loss: 1.0757 | Val  Acc: 0.6835
Average Valid Accuracy: 0.8607
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9784
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9676
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.8273
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.7698
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.7609
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.6835
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1162 | Train Acc: 0.9650
 Site-MNIST                         | Train Loss: 0.0928 | Train Acc: 0.9821
 Site-USPS                          | Train Loss: 0.1271 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0783 | Train Acc: 0.9821
 Site-SynthDigits                   | Train Loss: 0.6131 | Train Acc: 0.7978
 Site-SynthDigits                   | Train Loss: 0.4089 | Train Acc: 0.8915
 Site-MNIST_M                       | Train Loss: 1.0041 | Train Acc: 0.6550
 Site-MNIST_M                       | Train Loss: 0.6609 | Train Acc: 0.7991
 Site-SVHN                          | Train Loss: 1.4468 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.0894 | Train Acc: 0.6332
Average Train Accuracy: 0.8194
 Site-MNIST                         | Val  Loss: 0.0881 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.0882 | Val  Acc: 0.9784
 Site-USPS                          | Val  Loss: 0.1791 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1186 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4417 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4970 | Val  Acc: 0.8381
 Site-MNIST_M                       | Val  Loss: 0.5938 | Val  Acc: 0.8478
 Site-MNIST_M                       | Val  Loss: 0.7111 | Val  Acc: 0.7734
 Site-SVHN                          | Val  Loss: 0.8992 | Val  Acc: 0.7500
 Site-SVHN                          | Val  Loss: 1.0744 | Val  Acc: 0.6763
Average Valid Accuracy: 0.8625
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9784
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9676
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.8804
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.8381
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.8478
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.7734
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.7500
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.6763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0/harmo-fl...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1117 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0905 | Train Acc: 0.9821
 Site-USPS                          | Train Loss: 0.1249 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0769 | Train Acc: 0.9821
 Site-SynthDigits                   | Train Loss: 0.6207 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.4065 | Train Acc: 0.8915
 Site-MNIST_M                       | Train Loss: 0.9927 | Train Acc: 0.6631
 Site-MNIST_M                       | Train Loss: 0.6340 | Train Acc: 0.8090
 Site-SVHN                          | Train Loss: 1.4518 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 1.0691 | Train Acc: 0.6422
Average Train Accuracy: 0.8226
 Site-MNIST                         | Val  Loss: 0.0950 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.0915 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.1641 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1148 | Val  Acc: 0.9712
 Site-SynthDigits                   | Val  Loss: 0.4387 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5001 | Val  Acc: 0.8309
 Site-MNIST_M                       | Val  Loss: 0.5920 | Val  Acc: 0.8478
 Site-MNIST_M                       | Val  Loss: 0.6968 | Val  Acc: 0.7734
 Site-SVHN                          | Val  Loss: 0.9013 | Val  Acc: 0.7609
 Site-SVHN                          | Val  Loss: 1.0684 | Val  Acc: 0.6906
Average Valid Accuracy: 0.8621
===2023-07-30 15:57:06===
===2023-07-30 15:57:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.9354
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9419
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.7827
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.5464
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.4412
MNIST: 0.9354, USPS: 0.9419, SynthDigits: 0.7827, MNIST_M: 0.5464, SVHN: 0.4412, 
Average Test Accuracy(group): 0.7295, Average Test Accuracy(individual): 0.7295,
domain std=0.2035, cluster std=-1.0000, individual std=0.2035, 
