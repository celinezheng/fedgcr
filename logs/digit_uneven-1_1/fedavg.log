===2023-04-21 19:48:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[35,71,106,142,33,66,100,44,55,33,]
label set of clients: [10, 10, 10, 10, 8, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 2.3003 | Train Acc: 0.0286
 Site-MNIST     | Train Loss: 2.2922 | Train Acc: 0.0986
 Site-MNIST     | Train Loss: 2.2889 | Train Acc: 0.1604
 Site-MNIST     | Train Loss: 2.2909 | Train Acc: 0.1268
 Site-SVHN      | Train Loss: 2.2655 | Train Acc: 0.1212
 Site-SVHN      | Train Loss: 2.2991 | Train Acc: 0.1061
 Site-SVHN      | Train Loss: 2.3043 | Train Acc: 0.1600
 Site-USPS      | Train Loss: 2.3183 | Train Acc: 0.1136
 Site-SynthDigits| Train Loss: 2.3131 | Train Acc: 0.0909
 Site-MNIST-M   | Train Loss: 2.3234 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.2846 | Val  Acc: 0.2174
 Site-MNIST     | Val  Loss: 2.2981 | Val  Acc: 0.1277
 Site-MNIST     | Val  Loss: 2.3060 | Val  Acc: 0.1549
 Site-MNIST     | Val  Loss: 2.2910 | Val  Acc: 0.1596
 Site-SVHN      | Val  Loss: 2.2928 | Val  Acc: 0.2273
 Site-SVHN      | Val  Loss: 2.2865 | Val  Acc: 0.1818
 Site-SVHN      | Val  Loss: 2.2949 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.3169 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.3134 | Val  Acc: 0.0541
 Site-MNIST-M   | Val  Loss: 2.3269 | Val  Acc: 0.0455
Average Valid Accuracy: 0.1393
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2174
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1277
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1549
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1596
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2273
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1818
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1212
 Best site-USPS       | Epoch:0 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0541
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 2.3057 | Train Acc: 0.0286
 Site-MNIST     | Train Loss: 2.2749 | Train Acc: 0.1831
 Site-MNIST     | Train Loss: 2.2714 | Train Acc: 0.2170
 Site-MNIST     | Train Loss: 2.2718 | Train Acc: 0.2042
 Site-SVHN      | Train Loss: 2.3069 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2813 | Train Acc: 0.1364
 Site-SVHN      | Train Loss: 2.2943 | Train Acc: 0.1900
 Site-USPS      | Train Loss: 2.2991 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.3065 | Train Acc: 0.0727
 Site-MNIST-M   | Train Loss: 2.2589 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.2585 | Val  Acc: 0.3043
 Site-MNIST     | Val  Loss: 2.2805 | Val  Acc: 0.2340
 Site-MNIST     | Val  Loss: 2.2937 | Val  Acc: 0.2394
 Site-MNIST     | Val  Loss: 2.2723 | Val  Acc: 0.2021
 Site-SVHN      | Val  Loss: 2.2852 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2800 | Val  Acc: 0.2273
 Site-SVHN      | Val  Loss: 2.2910 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 2.3007 | Val  Acc: 0.1724
 Site-SynthDigits| Val  Loss: 2.3099 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.3221 | Val  Acc: 0.0455
Average Valid Accuracy: 0.1976
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3043
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2340
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2394
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2021
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2273
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1515
 Best site-USPS       | Epoch:1 | Val Acc: 0.1724
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.0811
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 2.2961 | Train Acc: 0.0571
 Site-MNIST     | Train Loss: 2.2577 | Train Acc: 0.2394
 Site-MNIST     | Train Loss: 2.2524 | Train Acc: 0.3208
 Site-MNIST     | Train Loss: 2.2541 | Train Acc: 0.2958
 Site-SVHN      | Train Loss: 2.2703 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.3010 | Train Acc: 0.1364
 Site-SVHN      | Train Loss: 2.2981 | Train Acc: 0.1900
 Site-USPS      | Train Loss: 2.2819 | Train Acc: 0.3409
 Site-SynthDigits| Train Loss: 2.3149 | Train Acc: 0.0909
 Site-MNIST-M   | Train Loss: 2.2833 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 2.2337 | Val  Acc: 0.4348
 Site-MNIST     | Val  Loss: 2.2636 | Val  Acc: 0.2979
 Site-MNIST     | Val  Loss: 2.2820 | Val  Acc: 0.3099
 Site-MNIST     | Val  Loss: 2.2541 | Val  Acc: 0.3298
 Site-SVHN      | Val  Loss: 2.2780 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2742 | Val  Acc: 0.2273
 Site-SVHN      | Val  Loss: 2.2872 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 2.2843 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.3063 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.3173 | Val  Acc: 0.0455
Average Valid Accuracy: 0.2299
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4348
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2979
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3099
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3298
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2273
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1515
 Best site-USPS       | Epoch:2 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.0811
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 2.2788 | Train Acc: 0.1429
 Site-MNIST     | Train Loss: 2.2367 | Train Acc: 0.3099
 Site-MNIST     | Train Loss: 2.2381 | Train Acc: 0.3491
 Site-MNIST     | Train Loss: 2.2360 | Train Acc: 0.3732
 Site-SVHN      | Train Loss: 2.3176 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2731 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.2820 | Train Acc: 0.1900
 Site-USPS      | Train Loss: 2.2642 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.3053 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.2576 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.2083 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.2463 | Val  Acc: 0.3617
 Site-MNIST     | Val  Loss: 2.2700 | Val  Acc: 0.3239
 Site-MNIST     | Val  Loss: 2.2371 | Val  Acc: 0.3404
 Site-SVHN      | Val  Loss: 2.2708 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2679 | Val  Acc: 0.2273
 Site-SVHN      | Val  Loss: 2.2828 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 2.2702 | Val  Acc: 0.2414
 Site-SynthDigits| Val  Loss: 2.3032 | Val  Acc: 0.1081
 Site-MNIST-M   | Val  Loss: 2.3130 | Val  Acc: 0.0455
Average Valid Accuracy: 0.2655
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:3 | Val Acc: 0.3617
 Best site-MNIST      | Epoch:3 | Val Acc: 0.3239
 Best site-MNIST      | Epoch:3 | Val Acc: 0.3404
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2273
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1667
 Best site-USPS       | Epoch:3 | Val Acc: 0.2414
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.1081
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2806 | Train Acc: 0.1714
 Site-MNIST     | Train Loss: 2.2297 | Train Acc: 0.3944
 Site-MNIST     | Train Loss: 2.2247 | Train Acc: 0.4057
 Site-MNIST     | Train Loss: 2.2185 | Train Acc: 0.4155
 Site-SVHN      | Train Loss: 2.2961 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2958 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.2885 | Train Acc: 0.1900
 Site-USPS      | Train Loss: 2.2541 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.3033 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.2947 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.1848 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.2299 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.2583 | Val  Acc: 0.3803
 Site-MNIST     | Val  Loss: 2.2206 | Val  Acc: 0.4043
 Site-SVHN      | Val  Loss: 2.2657 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2632 | Val  Acc: 0.2273
 Site-SVHN      | Val  Loss: 2.2795 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 2.2562 | Val  Acc: 0.2759
 Site-SynthDigits| Val  Loss: 2.3006 | Val  Acc: 0.1081
 Site-MNIST-M   | Val  Loss: 2.3097 | Val  Acc: 0.0455
Average Valid Accuracy: 0.2852
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3803
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4043
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2273
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1667
 Best site-USPS       | Epoch:4 | Val Acc: 0.2759
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.1081
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 2.2566 | Train Acc: 0.1714
 Site-MNIST     | Train Loss: 2.2124 | Train Acc: 0.4085
 Site-MNIST     | Train Loss: 2.2106 | Train Acc: 0.4057
 Site-MNIST     | Train Loss: 2.2014 | Train Acc: 0.4225
 Site-SVHN      | Train Loss: 2.3332 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2898 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2772 | Train Acc: 0.2100
 Site-USPS      | Train Loss: 2.2399 | Train Acc: 0.3636
 Site-SynthDigits| Train Loss: 2.2953 | Train Acc: 0.0909
 Site-MNIST-M   | Train Loss: 2.2944 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.1613 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.2135 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.2468 | Val  Acc: 0.3521
 Site-MNIST     | Val  Loss: 2.2044 | Val  Acc: 0.4149
 Site-SVHN      | Val  Loss: 2.2579 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2557 | Val  Acc: 0.2727
 Site-SVHN      | Val  Loss: 2.2749 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 2.2428 | Val  Acc: 0.2759
 Site-SynthDigits| Val  Loss: 2.2977 | Val  Acc: 0.1081
 Site-MNIST-M   | Val  Loss: 2.3059 | Val  Acc: 0.0455
Average Valid Accuracy: 0.2962
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:5 | Val Acc: 0.3521
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4149
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2727
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1818
 Best site-USPS       | Epoch:5 | Val Acc: 0.2759
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.1081
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 2.2609 | Train Acc: 0.2000
 Site-MNIST     | Train Loss: 2.1925 | Train Acc: 0.4225
 Site-MNIST     | Train Loss: 2.1950 | Train Acc: 0.4245
 Site-MNIST     | Train Loss: 2.1859 | Train Acc: 0.4296
 Site-SVHN      | Train Loss: 2.2830 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2887 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2689 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.2270 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.3053 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2922 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.1405 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.1981 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.2353 | Val  Acc: 0.3803
 Site-MNIST     | Val  Loss: 2.1884 | Val  Acc: 0.4468
 Site-SVHN      | Val  Loss: 2.2524 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2507 | Val  Acc: 0.2955
 Site-SVHN      | Val  Loss: 2.2722 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 2.2301 | Val  Acc: 0.2759
 Site-SynthDigits| Val  Loss: 2.2959 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.3022 | Val  Acc: 0.0455
Average Valid Accuracy: 0.3048
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:6 | Val Acc: 0.3803
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4468
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2955
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2121
 Best site-USPS       | Epoch:6 | Val Acc: 0.2759
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.0811
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 2.2743 | Train Acc: 0.2000
 Site-MNIST     | Train Loss: 2.1704 | Train Acc: 0.4648
 Site-MNIST     | Train Loss: 2.1798 | Train Acc: 0.4245
 Site-MNIST     | Train Loss: 2.1684 | Train Acc: 0.4296
 Site-SVHN      | Train Loss: 2.2804 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2989 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2716 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.2138 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.2895 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2827 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.1184 | Val  Acc: 0.4783
 Site-MNIST     | Val  Loss: 2.1823 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.2238 | Val  Acc: 0.3803
 Site-MNIST     | Val  Loss: 2.1727 | Val  Acc: 0.4468
 Site-SVHN      | Val  Loss: 2.2471 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2458 | Val  Acc: 0.2955
 Site-SVHN      | Val  Loss: 2.2698 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 2.2167 | Val  Acc: 0.2759
 Site-SynthDigits| Val  Loss: 2.2935 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.2982 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3029
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 2.2333 | Train Acc: 0.2000
 Site-MNIST     | Train Loss: 2.1515 | Train Acc: 0.4648
 Site-MNIST     | Train Loss: 2.1665 | Train Acc: 0.4340
 Site-MNIST     | Train Loss: 2.1519 | Train Acc: 0.4507
 Site-SVHN      | Train Loss: 2.2215 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2563 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2732 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 2.1988 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.2851 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.3184 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.0975 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.1672 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.2129 | Val  Acc: 0.3944
 Site-MNIST     | Val  Loss: 2.1572 | Val  Acc: 0.4574
 Site-SVHN      | Val  Loss: 2.2420 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2412 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2673 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.2040 | Val  Acc: 0.3448
 Site-SynthDigits| Val  Loss: 2.2908 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.2951 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3248
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:8 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:8 | Val Acc: 0.3944
 Best site-MNIST      | Epoch:8 | Val Acc: 0.4574
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2273
 Best site-USPS       | Epoch:8 | Val Acc: 0.3448
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.0811
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.2522 | Train Acc: 0.2286
 Site-MNIST     | Train Loss: 2.1482 | Train Acc: 0.4789
 Site-MNIST     | Train Loss: 2.1578 | Train Acc: 0.4340
 Site-MNIST     | Train Loss: 2.1371 | Train Acc: 0.4366
 Site-SVHN      | Train Loss: 2.2884 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2590 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2582 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 2.1918 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.2889 | Train Acc: 0.0909
 Site-MNIST-M   | Train Loss: 2.2413 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.0780 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.1518 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.2007 | Val  Acc: 0.3944
 Site-MNIST     | Val  Loss: 2.1412 | Val  Acc: 0.4574
 Site-SVHN      | Val  Loss: 2.2373 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2368 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2637 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.1906 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.2879 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.2922 | Val  Acc: 0.1364
Average Valid Accuracy: 0.3328
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:9 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:9 | Val Acc: 0.3944
 Best site-MNIST      | Epoch:9 | Val Acc: 0.4574
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2273
 Best site-USPS       | Epoch:9 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.0811
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.3236
 Test site-SVHN      | Epoch:9 | Test Acc: 0.1758
 Test site-USPS      | Epoch:9 | Test Acc: 0.3871
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.1547
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.1236
Average Test Accuracy: 0.2330
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 2.1934 | Train Acc: 0.2857
 Site-MNIST     | Train Loss: 2.1228 | Train Acc: 0.4648
 Site-MNIST     | Train Loss: 2.1331 | Train Acc: 0.4528
 Site-MNIST     | Train Loss: 2.1192 | Train Acc: 0.4437
 Site-SVHN      | Train Loss: 2.2551 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2658 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2612 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 2.1797 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.2879 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2417 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.0575 | Val  Acc: 0.4783
 Site-MNIST     | Val  Loss: 2.1352 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1876 | Val  Acc: 0.4085
 Site-MNIST     | Val  Loss: 2.1259 | Val  Acc: 0.4787
 Site-SVHN      | Val  Loss: 2.2320 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2317 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2607 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.1782 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2856 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.2892 | Val  Acc: 0.1364
Average Valid Accuracy: 0.3333
 Best site-MNIST      | Epoch:10 | Val Acc: 0.4783
 Best site-MNIST      | Epoch:10 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:10 | Val Acc: 0.4085
 Best site-MNIST      | Epoch:10 | Val Acc: 0.4787
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2273
 Best site-USPS       | Epoch:10 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.0811
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 2.1803 | Train Acc: 0.2286
 Site-MNIST     | Train Loss: 2.1111 | Train Acc: 0.4789
 Site-MNIST     | Train Loss: 2.1218 | Train Acc: 0.4434
 Site-MNIST     | Train Loss: 2.1032 | Train Acc: 0.4366
 Site-SVHN      | Train Loss: 2.2897 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2556 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2610 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 2.1618 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.2820 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2489 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.0375 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.1199 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.1757 | Val  Acc: 0.3944
 Site-MNIST     | Val  Loss: 2.1103 | Val  Acc: 0.4681
 Site-SVHN      | Val  Loss: 2.2250 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2258 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2572 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 2.1650 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2826 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.2861 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3380
 Best site-MNIST      | Epoch:11 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:11 | Val Acc: 0.3944
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4681
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2121
 Best site-USPS       | Epoch:11 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.0811
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 2.1638 | Train Acc: 0.2286
 Site-MNIST     | Train Loss: 2.0912 | Train Acc: 0.4930
 Site-MNIST     | Train Loss: 2.1041 | Train Acc: 0.4434
 Site-MNIST     | Train Loss: 2.0886 | Train Acc: 0.4507
 Site-SVHN      | Train Loss: 2.2852 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2333 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2538 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 2.1443 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.2669 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2923 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.0178 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.1042 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.1631 | Val  Acc: 0.3944
 Site-MNIST     | Val  Loss: 2.0951 | Val  Acc: 0.4681
 Site-SVHN      | Val  Loss: 2.2172 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2192 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2531 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.1527 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2796 | Val  Acc: 0.0811
 Site-MNIST-M   | Val  Loss: 2.2833 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3418
 Best site-MNIST      | Epoch:12 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:12 | Val Acc: 0.3944
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4681
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2273
 Best site-USPS       | Epoch:12 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.0811
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 2.1468 | Train Acc: 0.2571
 Site-MNIST     | Train Loss: 2.0701 | Train Acc: 0.4930
 Site-MNIST     | Train Loss: 2.0997 | Train Acc: 0.4434
 Site-MNIST     | Train Loss: 2.0718 | Train Acc: 0.4648
 Site-SVHN      | Train Loss: 2.2678 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2402 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2555 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 2.1384 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2808 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2817 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9984 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.0886 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 2.1506 | Val  Acc: 0.4225
 Site-MNIST     | Val  Loss: 2.0801 | Val  Acc: 0.4681
 Site-SVHN      | Val  Loss: 2.2123 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2140 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2496 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.1413 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2778 | Val  Acc: 0.1081
 Site-MNIST-M   | Val  Loss: 2.2810 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3529
 Best site-MNIST      | Epoch:13 | Val Acc: 0.5217
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4225
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4681
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2273
 Best site-USPS       | Epoch:13 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.1081
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.1802 | Train Acc: 0.2857
 Site-MNIST     | Train Loss: 2.0585 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0706 | Train Acc: 0.4434
 Site-MNIST     | Train Loss: 2.0562 | Train Acc: 0.4648
 Site-SVHN      | Train Loss: 2.2530 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2590 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2552 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.1155 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2759 | Train Acc: 0.0909
 Site-MNIST-M   | Train Loss: 2.2461 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9789 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.0747 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 2.1395 | Val  Acc: 0.4225
 Site-MNIST     | Val  Loss: 2.0646 | Val  Acc: 0.4787
 Site-SVHN      | Val  Loss: 2.2067 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2085 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2458 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.1289 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2756 | Val  Acc: 0.1081
 Site-MNIST-M   | Val  Loss: 2.2782 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3437
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 2.2074 | Train Acc: 0.2571
 Site-MNIST     | Train Loss: 2.0592 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0730 | Train Acc: 0.4528
 Site-MNIST     | Train Loss: 2.0399 | Train Acc: 0.4648
 Site-SVHN      | Train Loss: 2.3499 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2494 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2518 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.1100 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2649 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2718 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9587 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.0584 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 2.1269 | Val  Acc: 0.4225
 Site-MNIST     | Val  Loss: 2.0512 | Val  Acc: 0.4894
 Site-SVHN      | Val  Loss: 2.2023 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2041 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2427 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.1178 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2735 | Val  Acc: 0.1081
 Site-MNIST-M   | Val  Loss: 2.2765 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3448
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 2.1228 | Train Acc: 0.2571
 Site-MNIST     | Train Loss: 2.0258 | Train Acc: 0.5070
 Site-MNIST     | Train Loss: 2.0515 | Train Acc: 0.4340
 Site-MNIST     | Train Loss: 2.0266 | Train Acc: 0.4648
 Site-SVHN      | Train Loss: 2.1718 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2427 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2369 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0948 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2631 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.3203 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9397 | Val  Acc: 0.5217
 Site-MNIST     | Val  Loss: 2.0436 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 2.1148 | Val  Acc: 0.4085
 Site-MNIST     | Val  Loss: 2.0363 | Val  Acc: 0.4681
 Site-SVHN      | Val  Loss: 2.1971 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1998 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2403 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.1051 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2712 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2747 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3439
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 2.1769 | Train Acc: 0.3143
 Site-MNIST     | Train Loss: 2.0184 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0342 | Train Acc: 0.4434
 Site-MNIST     | Train Loss: 2.0100 | Train Acc: 0.4789
 Site-SVHN      | Train Loss: 2.2204 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2403 | Train Acc: 0.1970
 Site-SVHN      | Train Loss: 2.2434 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0778 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2651 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2755 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9218 | Val  Acc: 0.5652
 Site-MNIST     | Val  Loss: 2.0293 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 2.1025 | Val  Acc: 0.4085
 Site-MNIST     | Val  Loss: 2.0215 | Val  Acc: 0.4787
 Site-SVHN      | Val  Loss: 2.1932 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1963 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2390 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.0944 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2706 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2729 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3515
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 2.1148 | Train Acc: 0.3429
 Site-MNIST     | Train Loss: 2.0067 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0356 | Train Acc: 0.4434
 Site-MNIST     | Train Loss: 1.9961 | Train Acc: 0.4859
 Site-SVHN      | Train Loss: 2.1362 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2696 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2242 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0743 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2586 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2743 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9043 | Val  Acc: 0.5652
 Site-MNIST     | Val  Loss: 2.0156 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 2.0907 | Val  Acc: 0.4085
 Site-MNIST     | Val  Loss: 2.0070 | Val  Acc: 0.4787
 Site-SVHN      | Val  Loss: 2.1889 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1929 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2372 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.0833 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2695 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2709 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3515
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.0353 | Train Acc: 0.3429
 Site-MNIST     | Train Loss: 1.9918 | Train Acc: 0.5352
 Site-MNIST     | Train Loss: 2.0121 | Train Acc: 0.4434
 Site-MNIST     | Train Loss: 1.9816 | Train Acc: 0.4930
 Site-SVHN      | Train Loss: 2.1598 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2637 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2327 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0545 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2743 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.3033 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.8864 | Val  Acc: 0.6087
 Site-MNIST     | Val  Loss: 2.0019 | Val  Acc: 0.4894
 Site-MNIST     | Val  Loss: 2.0789 | Val  Acc: 0.4085
 Site-MNIST     | Val  Loss: 1.9916 | Val  Acc: 0.4787
 Site-SVHN      | Val  Loss: 2.1845 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1892 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2358 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.0725 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2682 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2691 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3580
 Best site-MNIST      | Epoch:19 | Val Acc: 0.6087
 Best site-MNIST      | Epoch:19 | Val Acc: 0.4894
 Best site-MNIST      | Epoch:19 | Val Acc: 0.4085
 Best site-MNIST      | Epoch:19 | Val Acc: 0.4787
 Best site-SVHN       | Epoch:19 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:19 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:19 | Val Acc: 0.2273
 Best site-USPS       | Epoch:19 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.3564
 Test site-SVHN      | Epoch:19 | Test Acc: 0.1874
 Test site-USPS      | Epoch:19 | Test Acc: 0.4247
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.1785
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.1421
Average Test Accuracy: 0.2579
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 2.1458 | Train Acc: 0.3429
 Site-MNIST     | Train Loss: 1.9705 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 1.9935 | Train Acc: 0.4434
 Site-MNIST     | Train Loss: 1.9676 | Train Acc: 0.4930
 Site-SVHN      | Train Loss: 2.2357 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2227 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2357 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0584 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2622 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2729 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.8691 | Val  Acc: 0.6087
 Site-MNIST     | Val  Loss: 1.9880 | Val  Acc: 0.4894
 Site-MNIST     | Val  Loss: 2.0668 | Val  Acc: 0.4085
 Site-MNIST     | Val  Loss: 1.9761 | Val  Acc: 0.4787
 Site-SVHN      | Val  Loss: 2.1785 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1847 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2337 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.0617 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2672 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2674 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3580
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 2.1151 | Train Acc: 0.3429
 Site-MNIST     | Train Loss: 1.9609 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 1.9848 | Train Acc: 0.4623
 Site-MNIST     | Train Loss: 1.9509 | Train Acc: 0.5070
 Site-SVHN      | Train Loss: 2.1507 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2245 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2215 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0272 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2533 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.2384 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.8521 | Val  Acc: 0.6522
 Site-MNIST     | Val  Loss: 1.9740 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 2.0543 | Val  Acc: 0.4225
 Site-MNIST     | Val  Loss: 1.9618 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 2.1765 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1824 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2310 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.0499 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2655 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2658 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3680
 Best site-MNIST      | Epoch:21 | Val Acc: 0.6522
 Best site-MNIST      | Epoch:21 | Val Acc: 0.5106
 Best site-MNIST      | Epoch:21 | Val Acc: 0.4225
 Best site-MNIST      | Epoch:21 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:21 | Val Acc: 0.2273
 Best site-USPS       | Epoch:21 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 2.0308 | Train Acc: 0.3429
 Site-MNIST     | Train Loss: 1.9609 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 1.9558 | Train Acc: 0.4623
 Site-MNIST     | Train Loss: 1.9379 | Train Acc: 0.5070
 Site-SVHN      | Train Loss: 2.2834 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2561 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2134 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0392 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2620 | Train Acc: 0.1273
 Site-MNIST-M   | Train Loss: 2.2623 | Train Acc: 0.0000
 Site-MNIST     | Val  Loss: 1.8350 | Val  Acc: 0.6522
 Site-MNIST     | Val  Loss: 1.9607 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 2.0427 | Val  Acc: 0.4225
 Site-MNIST     | Val  Loss: 1.9484 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 2.1728 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1786 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2284 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.0369 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2628 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2621 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3680
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 2.1478 | Train Acc: 0.3429
 Site-MNIST     | Train Loss: 1.9282 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 1.9635 | Train Acc: 0.4623
 Site-MNIST     | Train Loss: 1.9225 | Train Acc: 0.5070
 Site-SVHN      | Train Loss: 2.2269 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2562 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2125 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0199 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2502 | Train Acc: 0.1091
 Site-MNIST-M   | Train Loss: 2.3039 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.8179 | Val  Acc: 0.6522
 Site-MNIST     | Val  Loss: 1.9471 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 2.0299 | Val  Acc: 0.4225
 Site-MNIST     | Val  Loss: 1.9326 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 2.1685 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1750 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2261 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.0262 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2613 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2609 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3680
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 2.0720 | Train Acc: 0.3429
 Site-MNIST     | Train Loss: 1.9348 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 1.9472 | Train Acc: 0.4623
 Site-MNIST     | Train Loss: 1.9043 | Train Acc: 0.5070
 Site-SVHN      | Train Loss: 2.1736 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.1846 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2332 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 1.9959 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2453 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.3824 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.8027 | Val  Acc: 0.6522
 Site-MNIST     | Val  Loss: 1.9342 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 2.0170 | Val  Acc: 0.4225
 Site-MNIST     | Val  Loss: 1.9168 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 2.1633 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1708 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.2241 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 2.0148 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2603 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2591 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3680
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 2.0632 | Train Acc: 0.3714
 Site-MNIST     | Train Loss: 1.9059 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 1.9173 | Train Acc: 0.4623
 Site-MNIST     | Train Loss: 1.8897 | Train Acc: 0.5141
 Site-SVHN      | Train Loss: 2.1076 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2299 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2332 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.9873 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2455 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.2866 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.7886 | Val  Acc: 0.6522
 Site-MNIST     | Val  Loss: 1.9219 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 2.0047 | Val  Acc: 0.4225
 Site-MNIST     | Val  Loss: 1.9026 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 2.1594 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1672 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2220 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 2.0040 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2591 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2567 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3718
 Best site-MNIST      | Epoch:25 | Val Acc: 0.6522
 Best site-MNIST      | Epoch:25 | Val Acc: 0.5106
 Best site-MNIST      | Epoch:25 | Val Acc: 0.4225
 Best site-MNIST      | Epoch:25 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:25 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:25 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:25 | Val Acc: 0.2424
 Best site-USPS       | Epoch:25 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 2.0566 | Train Acc: 0.3714
 Site-MNIST     | Train Loss: 1.8976 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 1.9154 | Train Acc: 0.4717
 Site-MNIST     | Train Loss: 1.8794 | Train Acc: 0.5282
 Site-SVHN      | Train Loss: 2.2399 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2622 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2111 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.9828 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2403 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.2363 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.7740 | Val  Acc: 0.6522
 Site-MNIST     | Val  Loss: 1.9096 | Val  Acc: 0.5319
 Site-MNIST     | Val  Loss: 1.9928 | Val  Acc: 0.4366
 Site-MNIST     | Val  Loss: 1.8887 | Val  Acc: 0.5106
 Site-SVHN      | Val  Loss: 2.1565 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1648 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2199 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9939 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2581 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2543 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3764
 Best site-MNIST      | Epoch:26 | Val Acc: 0.6522
 Best site-MNIST      | Epoch:26 | Val Acc: 0.5319
 Best site-MNIST      | Epoch:26 | Val Acc: 0.4366
 Best site-MNIST      | Epoch:26 | Val Acc: 0.5106
 Best site-SVHN       | Epoch:26 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:26 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2424
 Best site-USPS       | Epoch:26 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 2.1499 | Train Acc: 0.3714
 Site-MNIST     | Train Loss: 1.8675 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 1.8949 | Train Acc: 0.4906
 Site-MNIST     | Train Loss: 1.8686 | Train Acc: 0.5423
 Site-SVHN      | Train Loss: 2.2016 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2024 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2015 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.9642 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2461 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.2681 | Train Acc: 0.0000
 Site-MNIST     | Val  Loss: 1.7610 | Val  Acc: 0.6522
 Site-MNIST     | Val  Loss: 1.8981 | Val  Acc: 0.5532
 Site-MNIST     | Val  Loss: 1.9816 | Val  Acc: 0.4648
 Site-MNIST     | Val  Loss: 1.8773 | Val  Acc: 0.5319
 Site-SVHN      | Val  Loss: 2.1500 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1592 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2164 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9818 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2558 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2509 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3861
 Best site-MNIST      | Epoch:27 | Val Acc: 0.6522
 Best site-MNIST      | Epoch:27 | Val Acc: 0.5532
 Best site-MNIST      | Epoch:27 | Val Acc: 0.4648
 Best site-MNIST      | Epoch:27 | Val Acc: 0.5319
 Best site-SVHN       | Epoch:27 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:27 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:27 | Val Acc: 0.2424
 Best site-USPS       | Epoch:27 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 2.1166 | Train Acc: 0.3714
 Site-MNIST     | Train Loss: 1.8151 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.8808 | Train Acc: 0.5094
 Site-MNIST     | Train Loss: 1.8516 | Train Acc: 0.5493
 Site-SVHN      | Train Loss: 2.2632 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2271 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2173 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.9570 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2355 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.2480 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.7475 | Val  Acc: 0.6957
 Site-MNIST     | Val  Loss: 1.8859 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.9688 | Val  Acc: 0.4930
 Site-MNIST     | Val  Loss: 1.8628 | Val  Acc: 0.5319
 Site-SVHN      | Val  Loss: 2.1472 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1569 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2155 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9725 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2550 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2487 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3954
 Best site-MNIST      | Epoch:28 | Val Acc: 0.6957
 Best site-MNIST      | Epoch:28 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:28 | Val Acc: 0.4930
 Best site-MNIST      | Epoch:28 | Val Acc: 0.5319
 Best site-SVHN       | Epoch:28 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:28 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2424
 Best site-USPS       | Epoch:28 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 2.0160 | Train Acc: 0.3714
 Site-MNIST     | Train Loss: 1.8347 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.8758 | Train Acc: 0.5189
 Site-MNIST     | Train Loss: 1.8371 | Train Acc: 0.5563
 Site-SVHN      | Train Loss: 2.2332 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2198 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.1791 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.9663 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2306 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.2602 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.7302 | Val  Acc: 0.6957
 Site-MNIST     | Val  Loss: 1.8720 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.9576 | Val  Acc: 0.4930
 Site-MNIST     | Val  Loss: 1.8487 | Val  Acc: 0.5426
 Site-SVHN      | Val  Loss: 2.1429 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1539 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2141 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9647 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2533 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2487 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3965
 Best site-MNIST      | Epoch:29 | Val Acc: 0.6957
 Best site-MNIST      | Epoch:29 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:29 | Val Acc: 0.4930
 Best site-MNIST      | Epoch:29 | Val Acc: 0.5426
 Best site-SVHN       | Epoch:29 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:29 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:29 | Val Acc: 0.2424
 Best site-USPS       | Epoch:29 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.4021
 Test site-SVHN      | Epoch:29 | Test Acc: 0.1919
 Test site-USPS      | Epoch:29 | Test Acc: 0.4839
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.2032
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.1593
Average Test Accuracy: 0.2881
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 1.9002 | Train Acc: 0.3714
 Site-MNIST     | Train Loss: 1.8105 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.8609 | Train Acc: 0.5189
 Site-MNIST     | Train Loss: 1.8250 | Train Acc: 0.5634
 Site-SVHN      | Train Loss: 2.2589 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2173 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.1872 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.9518 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2371 | Train Acc: 0.1455
 Site-MNIST-M   | Train Loss: 2.2966 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.7158 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.8596 | Val  Acc: 0.5957
 Site-MNIST     | Val  Loss: 1.9462 | Val  Acc: 0.4930
 Site-MNIST     | Val  Loss: 1.8365 | Val  Acc: 0.5426
 Site-SVHN      | Val  Loss: 2.1405 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1515 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2125 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9551 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2523 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2463 | Val  Acc: 0.1818
Average Valid Accuracy: 0.4030
 Best site-MNIST      | Epoch:30 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:30 | Val Acc: 0.5957
 Best site-MNIST      | Epoch:30 | Val Acc: 0.4930
 Best site-MNIST      | Epoch:30 | Val Acc: 0.5426
 Best site-SVHN       | Epoch:30 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:30 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:30 | Val Acc: 0.2424
 Best site-USPS       | Epoch:30 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 2.0571 | Train Acc: 0.3714
 Site-MNIST     | Train Loss: 1.8063 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.8530 | Train Acc: 0.5094
 Site-MNIST     | Train Loss: 1.8156 | Train Acc: 0.5845
 Site-SVHN      | Train Loss: 2.2291 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2148 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.1927 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.9258 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2291 | Train Acc: 0.1636
 Site-MNIST-M   | Train Loss: 2.2608 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.7031 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.8489 | Val  Acc: 0.6383
 Site-MNIST     | Val  Loss: 1.9368 | Val  Acc: 0.5070
 Site-MNIST     | Val  Loss: 1.8252 | Val  Acc: 0.5426
 Site-SVHN      | Val  Loss: 2.1379 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1486 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2102 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9433 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2489 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2421 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4166
 Best site-MNIST      | Epoch:31 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:31 | Val Acc: 0.6383
 Best site-MNIST      | Epoch:31 | Val Acc: 0.5070
 Best site-MNIST      | Epoch:31 | Val Acc: 0.5426
 Best site-SVHN       | Epoch:31 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:31 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:31 | Val Acc: 0.2424
 Best site-USPS       | Epoch:31 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 2.0744 | Train Acc: 0.4000
 Site-MNIST     | Train Loss: 1.7857 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.8449 | Train Acc: 0.5283
 Site-MNIST     | Train Loss: 1.7991 | Train Acc: 0.5845
 Site-SVHN      | Train Loss: 2.2014 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.1953 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2055 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.9122 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2228 | Train Acc: 0.1636
 Site-MNIST-M   | Train Loss: 2.2119 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6857 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.8360 | Val  Acc: 0.6383
 Site-MNIST     | Val  Loss: 1.9257 | Val  Acc: 0.5211
 Site-MNIST     | Val  Loss: 1.8126 | Val  Acc: 0.5532
 Site-SVHN      | Val  Loss: 2.1354 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1457 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2076 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9321 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2478 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2400 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4191
 Best site-MNIST      | Epoch:32 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:32 | Val Acc: 0.6383
 Best site-MNIST      | Epoch:32 | Val Acc: 0.5211
 Best site-MNIST      | Epoch:32 | Val Acc: 0.5532
 Best site-SVHN       | Epoch:32 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:32 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:32 | Val Acc: 0.2424
 Best site-USPS       | Epoch:32 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 1.9763 | Train Acc: 0.4000
 Site-MNIST     | Train Loss: 1.8198 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.8295 | Train Acc: 0.5283
 Site-MNIST     | Train Loss: 1.7896 | Train Acc: 0.5845
 Site-SVHN      | Train Loss: 2.1152 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2082 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.2007 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8991 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2203 | Train Acc: 0.1636
 Site-MNIST-M   | Train Loss: 2.2596 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6739 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.8252 | Val  Acc: 0.6383
 Site-MNIST     | Val  Loss: 1.9151 | Val  Acc: 0.5211
 Site-MNIST     | Val  Loss: 1.8018 | Val  Acc: 0.5532
 Site-SVHN      | Val  Loss: 2.1327 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1431 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2054 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9213 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2461 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2368 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4236
 Best site-MNIST      | Epoch:33 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:33 | Val Acc: 0.6383
 Best site-MNIST      | Epoch:33 | Val Acc: 0.5211
 Best site-MNIST      | Epoch:33 | Val Acc: 0.5532
 Best site-SVHN       | Epoch:33 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:33 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2424
 Best site-USPS       | Epoch:33 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 2.0155 | Train Acc: 0.4000
 Site-MNIST     | Train Loss: 1.7679 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.8195 | Train Acc: 0.5283
 Site-MNIST     | Train Loss: 1.7741 | Train Acc: 0.5845
 Site-SVHN      | Train Loss: 2.2630 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.1894 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1904 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.9053 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2210 | Train Acc: 0.1636
 Site-MNIST-M   | Train Loss: 2.2261 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6602 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.8135 | Val  Acc: 0.6383
 Site-MNIST     | Val  Loss: 1.9032 | Val  Acc: 0.5211
 Site-MNIST     | Val  Loss: 1.7879 | Val  Acc: 0.5532
 Site-SVHN      | Val  Loss: 2.1292 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1396 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2036 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.9137 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2451 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2353 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4286
 Best site-MNIST      | Epoch:34 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:34 | Val Acc: 0.6383
 Best site-MNIST      | Epoch:34 | Val Acc: 0.5211
 Best site-MNIST      | Epoch:34 | Val Acc: 0.5532
 Best site-SVHN       | Epoch:34 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:34 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:34 | Val Acc: 0.2576
 Best site-USPS       | Epoch:34 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 1.9931 | Train Acc: 0.4000
 Site-MNIST     | Train Loss: 1.7491 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.7960 | Train Acc: 0.5283
 Site-MNIST     | Train Loss: 1.7600 | Train Acc: 0.5915
 Site-SVHN      | Train Loss: 2.2511 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2125 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 2.1642 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8924 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2234 | Train Acc: 0.1636
 Site-MNIST-M   | Train Loss: 2.2544 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6441 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.8002 | Val  Acc: 0.6383
 Site-MNIST     | Val  Loss: 1.8920 | Val  Acc: 0.5211
 Site-MNIST     | Val  Loss: 1.7755 | Val  Acc: 0.5532
 Site-SVHN      | Val  Loss: 2.1262 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1367 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.2015 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9058 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2442 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2349 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4252
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 1.9210 | Train Acc: 0.4000
 Site-MNIST     | Train Loss: 1.7913 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.7961 | Train Acc: 0.5377
 Site-MNIST     | Train Loss: 1.7536 | Train Acc: 0.5845
 Site-SVHN      | Train Loss: 2.1981 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.1374 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1914 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8882 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2170 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.2532 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6340 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.7908 | Val  Acc: 0.6383
 Site-MNIST     | Val  Loss: 1.8840 | Val  Acc: 0.5352
 Site-MNIST     | Val  Loss: 1.7695 | Val  Acc: 0.5638
 Site-SVHN      | Val  Loss: 2.1249 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1359 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1995 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8900 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2385 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2342 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4338
 Best site-MNIST      | Epoch:36 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:36 | Val Acc: 0.6383
 Best site-MNIST      | Epoch:36 | Val Acc: 0.5352
 Best site-MNIST      | Epoch:36 | Val Acc: 0.5638
 Best site-SVHN       | Epoch:36 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:36 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:36 | Val Acc: 0.2576
 Best site-USPS       | Epoch:36 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 1.8668 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.7100 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.7833 | Train Acc: 0.5283
 Site-MNIST     | Train Loss: 1.7347 | Train Acc: 0.6268
 Site-SVHN      | Train Loss: 2.1987 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2165 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1905 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8679 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2140 | Train Acc: 0.1636
 Site-MNIST-M   | Train Loss: 2.2729 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6201 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.7780 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.8694 | Val  Acc: 0.5352
 Site-MNIST     | Val  Loss: 1.7527 | Val  Acc: 0.5638
 Site-SVHN      | Val  Loss: 2.1207 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1314 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1978 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8882 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2407 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2282 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4332
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 1.9106 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.7290 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.7599 | Train Acc: 0.5377
 Site-MNIST     | Train Loss: 1.7228 | Train Acc: 0.6338
 Site-SVHN      | Train Loss: 2.3402 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2196 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1849 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8646 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2023 | Train Acc: 0.1636
 Site-MNIST-M   | Train Loss: 2.3001 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.6048 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.7649 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.8581 | Val  Acc: 0.5493
 Site-MNIST     | Val  Loss: 1.7399 | Val  Acc: 0.5745
 Site-SVHN      | Val  Loss: 2.1177 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1277 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1947 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8818 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2395 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2287 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4405
 Best site-MNIST      | Epoch:38 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:38 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:38 | Val Acc: 0.5493
 Best site-MNIST      | Epoch:38 | Val Acc: 0.5745
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2576
 Best site-USPS       | Epoch:38 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.8700 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.6788 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.7483 | Train Acc: 0.5377
 Site-MNIST     | Train Loss: 1.7158 | Train Acc: 0.6408
 Site-SVHN      | Train Loss: 2.2022 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2174 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1874 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8188 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1912 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.2397 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.5952 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.7564 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.8511 | Val  Acc: 0.5493
 Site-MNIST     | Val  Loss: 1.7350 | Val  Acc: 0.5638
 Site-SVHN      | Val  Loss: 2.1158 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1274 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1936 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8622 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2343 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2280 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4373
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 1.9965 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.7029 | Train Acc: 0.6197
 Site-MNIST     | Train Loss: 1.7568 | Train Acc: 0.5472
 Site-MNIST     | Train Loss: 1.7028 | Train Acc: 0.6549
 Site-SVHN      | Train Loss: 2.1371 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.1681 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1627 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8412 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1958 | Train Acc: 0.2182
 Site-MNIST-M   | Train Loss: 2.2402 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.5815 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.7445 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.8402 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.7224 | Val  Acc: 0.5745
 Site-SVHN      | Val  Loss: 2.1136 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1246 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1921 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8553 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2335 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2264 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4419
 Best site-MNIST      | Epoch:40 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:40 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:40 | Val Acc: 0.5634
 Best site-MNIST      | Epoch:40 | Val Acc: 0.5745
 Best site-SVHN       | Epoch:40 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:40 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:40 | Val Acc: 0.2576
 Best site-USPS       | Epoch:40 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 1.9604 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.6870 | Train Acc: 0.6338
 Site-MNIST     | Train Loss: 1.7266 | Train Acc: 0.5472
 Site-MNIST     | Train Loss: 1.6878 | Train Acc: 0.6761
 Site-SVHN      | Train Loss: 2.2665 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2107 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1680 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8289 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2242 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.2521 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.5675 | Val  Acc: 0.7826
 Site-MNIST     | Val  Loss: 1.7315 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.8270 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.7079 | Val  Acc: 0.5745
 Site-SVHN      | Val  Loss: 2.1083 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1197 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1904 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8530 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2347 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2212 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4484
 Best site-MNIST      | Epoch:41 | Val Acc: 0.7826
 Best site-MNIST      | Epoch:41 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:41 | Val Acc: 0.5634
 Best site-MNIST      | Epoch:41 | Val Acc: 0.5745
 Best site-SVHN       | Epoch:41 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:41 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:41 | Val Acc: 0.2576
 Best site-USPS       | Epoch:41 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 1.9006 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.6776 | Train Acc: 0.6338
 Site-MNIST     | Train Loss: 1.7383 | Train Acc: 0.5566
 Site-MNIST     | Train Loss: 1.6786 | Train Acc: 0.6761
 Site-SVHN      | Train Loss: 2.2219 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2061 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1858 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8187 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1849 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.3079 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.5563 | Val  Acc: 0.8261
 Site-MNIST     | Val  Loss: 1.7220 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.8202 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.7013 | Val  Acc: 0.5851
 Site-SVHN      | Val  Loss: 2.1061 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1189 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1896 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8382 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2303 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2245 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4559
 Best site-MNIST      | Epoch:42 | Val Acc: 0.8261
 Best site-MNIST      | Epoch:42 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:42 | Val Acc: 0.5634
 Best site-MNIST      | Epoch:42 | Val Acc: 0.5851
 Best site-SVHN       | Epoch:42 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:42 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:42 | Val Acc: 0.2576
 Best site-USPS       | Epoch:42 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 1.8131 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.6763 | Train Acc: 0.6338
 Site-MNIST     | Train Loss: 1.7212 | Train Acc: 0.5566
 Site-MNIST     | Train Loss: 1.6644 | Train Acc: 0.6901
 Site-SVHN      | Train Loss: 2.1256 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.1574 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1945 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8266 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.2137 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.3338 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.5433 | Val  Acc: 0.8696
 Site-MNIST     | Val  Loss: 1.7102 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.8084 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.6890 | Val  Acc: 0.5851
 Site-SVHN      | Val  Loss: 2.1015 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1144 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1870 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8323 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2304 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2202 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4624
 Best site-MNIST      | Epoch:43 | Val Acc: 0.8696
 Best site-MNIST      | Epoch:43 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:43 | Val Acc: 0.5634
 Best site-MNIST      | Epoch:43 | Val Acc: 0.5851
 Best site-SVHN       | Epoch:43 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:43 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:43 | Val Acc: 0.2576
 Best site-USPS       | Epoch:43 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:43 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.8421 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.6633 | Train Acc: 0.6479
 Site-MNIST     | Train Loss: 1.7107 | Train Acc: 0.5566
 Site-MNIST     | Train Loss: 1.6557 | Train Acc: 0.6972
 Site-SVHN      | Train Loss: 2.1066 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.1732 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1684 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.8079 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.2038 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.2267 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.5303 | Val  Acc: 0.8696
 Site-MNIST     | Val  Loss: 1.6994 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.7983 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.6782 | Val  Acc: 0.5851
 Site-SVHN      | Val  Loss: 2.0974 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1108 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1848 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8237 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2280 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2206 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4624
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 1.8947 | Train Acc: 0.4286
 Site-MNIST     | Train Loss: 1.6150 | Train Acc: 0.6479
 Site-MNIST     | Train Loss: 1.7014 | Train Acc: 0.5566
 Site-MNIST     | Train Loss: 1.6424 | Train Acc: 0.6972
 Site-SVHN      | Train Loss: 2.0705 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.1685 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1824 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.7983 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1971 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.2417 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.5176 | Val  Acc: 0.8261
 Site-MNIST     | Val  Loss: 1.6877 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.7874 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.6652 | Val  Acc: 0.5851
 Site-SVHN      | Val  Loss: 2.0946 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1079 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1831 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8187 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2272 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2198 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4559
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 1.8917 | Train Acc: 0.4857
 Site-MNIST     | Train Loss: 1.5948 | Train Acc: 0.6479
 Site-MNIST     | Train Loss: 1.6874 | Train Acc: 0.5566
 Site-MNIST     | Train Loss: 1.6305 | Train Acc: 0.7042
 Site-SVHN      | Train Loss: 2.0588 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2005 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1580 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.7937 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1897 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.2388 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.5051 | Val  Acc: 0.8696
 Site-MNIST     | Val  Loss: 1.6774 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.7782 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.6566 | Val  Acc: 0.5851
 Site-SVHN      | Val  Loss: 2.0932 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1067 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1821 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.8076 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2255 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2203 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4624
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 1.8749 | Train Acc: 0.4857
 Site-MNIST     | Train Loss: 1.6056 | Train Acc: 0.6479
 Site-MNIST     | Train Loss: 1.6863 | Train Acc: 0.5566
 Site-MNIST     | Train Loss: 1.6214 | Train Acc: 0.7113
 Site-SVHN      | Train Loss: 2.1138 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2249 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1732 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.7760 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1573 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.2354 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.4948 | Val  Acc: 0.8696
 Site-MNIST     | Val  Loss: 1.6679 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.7694 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.6490 | Val  Acc: 0.5851
 Site-SVHN      | Val  Loss: 2.0914 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1056 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1808 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.7959 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2226 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2225 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4624
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 1.8602 | Train Acc: 0.4857
 Site-MNIST     | Train Loss: 1.6381 | Train Acc: 0.6620
 Site-MNIST     | Train Loss: 1.6506 | Train Acc: 0.5660
 Site-MNIST     | Train Loss: 1.6136 | Train Acc: 0.7113
 Site-SVHN      | Train Loss: 2.0951 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2038 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1643 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.7649 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1802 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.3637 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.4824 | Val  Acc: 0.8696
 Site-MNIST     | Val  Loss: 1.6573 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.7596 | Val  Acc: 0.5634
 Site-MNIST     | Val  Loss: 1.6374 | Val  Acc: 0.5957
 Site-SVHN      | Val  Loss: 2.0884 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1031 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1793 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.7890 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2210 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2228 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4635
 Best site-MNIST      | Epoch:48 | Val Acc: 0.8696
 Best site-MNIST      | Epoch:48 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:48 | Val Acc: 0.5634
 Best site-MNIST      | Epoch:48 | Val Acc: 0.5957
 Best site-SVHN       | Epoch:48 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:48 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:48 | Val Acc: 0.2576
 Best site-USPS       | Epoch:48 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.8093 | Train Acc: 0.4857
 Site-MNIST     | Train Loss: 1.6132 | Train Acc: 0.6761
 Site-MNIST     | Train Loss: 1.6572 | Train Acc: 0.5755
 Site-MNIST     | Train Loss: 1.5984 | Train Acc: 0.7183
 Site-SVHN      | Train Loss: 2.2896 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2454 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1561 | Train Acc: 0.2300
 Site-USPS      | Train Loss: 1.7590 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1890 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.2364 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.4712 | Val  Acc: 0.8696
 Site-MNIST     | Val  Loss: 1.6471 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.7490 | Val  Acc: 0.5775
 Site-MNIST     | Val  Loss: 1.6277 | Val  Acc: 0.5957
 Site-SVHN      | Val  Loss: 2.0839 | Val  Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.0991 | Val  Acc: 0.3409
 Site-SVHN      | Val  Loss: 2.1769 | Val  Acc: 0.2576
 Site-USPS      | Val  Loss: 1.7792 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2197 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2188 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4649
 Best site-MNIST      | Epoch:49 | Val Acc: 0.8696
 Best site-MNIST      | Epoch:49 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:49 | Val Acc: 0.5775
 Best site-MNIST      | Epoch:49 | Val Acc: 0.5957
 Best site-SVHN       | Epoch:49 | Val Acc: 0.3182
 Best site-SVHN       | Epoch:49 | Val Acc: 0.3409
 Best site-SVHN       | Epoch:49 | Val Acc: 0.2576
 Best site-USPS       | Epoch:49 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:49 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/fedavg...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.5050
 Test site-SVHN      | Epoch:49 | Test Acc: 0.1965
 Test site-USPS      | Epoch:49 | Test Acc: 0.6129
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.2307
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.1929
Average Test Accuracy: 0.3476
===2023-04-21 20:15:02===
===2023-04-21 20:15:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[35,71,106,142,33,66,100,44,55,33,]
label set of clients: [10, 10, 10, 10, 8, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.5050
 Test site-SVHN      | Epoch:49 | Test Acc: 0.1965
 Test site-USPS      | Epoch:49 | Test Acc: 0.6129
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.2307
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.1929
Average Test Accuracy: 0.3476
