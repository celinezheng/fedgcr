===2023-04-23 03:19:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[35,71,106,142,33,66,100,44,55,33,]
label set of clients: [10, 10, 10, 10, 8, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.7920 | Train Acc: 0.6571
 Site-MNIST     | Train Loss: 1.7557 | Train Acc: 0.6761
 Site-MNIST     | Train Loss: 1.8034 | Train Acc: 0.6792
 Site-MNIST     | Train Loss: 1.7242 | Train Acc: 0.7183
 Site-SVHN      | Train Loss: 2.2172 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.2326 | Train Acc: 0.2576
 Site-SVHN      | Train Loss: 2.1917 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.8288 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1783 | Train Acc: 0.2000
 Site-MNIST-M   | Train Loss: 2.4494 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.6452 | Val  Acc: 0.7391
 Site-MNIST     | Val  Loss: 1.7516 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.8731 | Val  Acc: 0.6479
 Site-MNIST     | Val  Loss: 1.7840 | Val  Acc: 0.6809
 Site-SVHN      | Val  Loss: 2.1277 | Val  Acc: 0.4091
 Site-SVHN      | Val  Loss: 2.1469 | Val  Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.2295 | Val  Acc: 0.1970
 Site-USPS      | Val  Loss: 1.8837 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.2655 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2132 | Val  Acc: 0.3182
Average Valid Accuracy: 0.4764
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7391
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6596
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6479
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6809
 Best site-SVHN       | Epoch:0 | Val Acc: 0.4091
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3636
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1970
 Best site-USPS       | Epoch:0 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.4412 | Train Acc: 0.7714
 Site-MNIST     | Train Loss: 1.2459 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 1.3718 | Train Acc: 0.7075
 Site-MNIST     | Train Loss: 1.2565 | Train Acc: 0.7958
 Site-SVHN      | Train Loss: 2.1287 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1386 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 2.0622 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.4631 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 2.0076 | Train Acc: 0.2364
 Site-MNIST-M   | Train Loss: 2.2219 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 1.1690 | Val  Acc: 0.9130
 Site-MNIST     | Val  Loss: 1.2992 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.4313 | Val  Acc: 0.7042
 Site-MNIST     | Val  Loss: 1.3405 | Val  Acc: 0.7128
 Site-SVHN      | Val  Loss: 1.9990 | Val  Acc: 0.4545
 Site-SVHN      | Val  Loss: 2.0250 | Val  Acc: 0.4773
 Site-SVHN      | Val  Loss: 2.1398 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.5840 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 2.1760 | Val  Acc: 0.2162
 Site-MNIST-M   | Val  Loss: 2.1781 | Val  Acc: 0.4091
Average Valid Accuracy: 0.5559
 Best site-MNIST      | Epoch:1 | Val Acc: 0.9130
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7042
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7128
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4545
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4773
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3333
 Best site-USPS       | Epoch:1 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2162
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.1689 | Train Acc: 0.7714
 Site-MNIST     | Train Loss: 0.9263 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 1.0634 | Train Acc: 0.8302
 Site-MNIST     | Train Loss: 0.9281 | Train Acc: 0.8873
 Site-SVHN      | Train Loss: 1.9237 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1053 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.0013 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.2297 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.9179 | Train Acc: 0.3273
 Site-MNIST-M   | Train Loss: 2.2194 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 0.8482 | Val  Acc: 0.9130
 Site-MNIST     | Val  Loss: 0.9789 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 1.1365 | Val  Acc: 0.8169
 Site-MNIST     | Val  Loss: 1.0434 | Val  Acc: 0.8404
 Site-SVHN      | Val  Loss: 1.9345 | Val  Acc: 0.4091
 Site-SVHN      | Val  Loss: 1.9432 | Val  Acc: 0.4545
 Site-SVHN      | Val  Loss: 2.0554 | Val  Acc: 0.2879
 Site-USPS      | Val  Loss: 1.3165 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 2.0356 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1372 | Val  Acc: 0.2727
Average Valid Accuracy: 0.5731
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9130
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8169
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8404
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4091
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4545
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2879
 Best site-USPS       | Epoch:2 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 0.9200 | Train Acc: 0.8000
 Site-MNIST     | Train Loss: 0.6683 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.9024 | Train Acc: 0.8208
 Site-MNIST     | Train Loss: 0.7127 | Train Acc: 0.9085
 Site-SVHN      | Train Loss: 2.1142 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.0190 | Train Acc: 0.2879
 Site-SVHN      | Train Loss: 1.9297 | Train Acc: 0.3700
 Site-USPS      | Train Loss: 1.0388 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.8415 | Train Acc: 0.3455
 Site-MNIST-M   | Train Loss: 2.0996 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 0.6857 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.7605 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.9012 | Val  Acc: 0.8169
 Site-MNIST     | Val  Loss: 0.8597 | Val  Acc: 0.8298
 Site-SVHN      | Val  Loss: 1.9061 | Val  Acc: 0.4091
 Site-SVHN      | Val  Loss: 1.8894 | Val  Acc: 0.4545
 Site-SVHN      | Val  Loss: 2.0046 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.1369 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 2.0086 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.0467 | Val  Acc: 0.3636
Average Valid Accuracy: 0.5852
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8169
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8298
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4091
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4545
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3333
 Best site-USPS       | Epoch:3 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 0.7542 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.5614 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.7321 | Train Acc: 0.8585
 Site-MNIST     | Train Loss: 0.5618 | Train Acc: 0.9366
 Site-SVHN      | Train Loss: 1.9999 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 1.9765 | Train Acc: 0.3030
 Site-SVHN      | Train Loss: 1.8371 | Train Acc: 0.4100
 Site-USPS      | Train Loss: 0.8762 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.7546 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 2.0079 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.5768 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.6316 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.7597 | Val  Acc: 0.8451
 Site-MNIST     | Val  Loss: 0.6928 | Val  Acc: 0.8723
 Site-SVHN      | Val  Loss: 1.8436 | Val  Acc: 0.4545
 Site-SVHN      | Val  Loss: 1.8073 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.9301 | Val  Acc: 0.3788
 Site-USPS      | Val  Loss: 0.9836 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.9138 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 1.9713 | Val  Acc: 0.4091
Average Valid Accuracy: 0.6490
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8451
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8723
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4545
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3788
 Best site-USPS       | Epoch:4 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.5164 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.4872 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.6174 | Train Acc: 0.8962
 Site-MNIST     | Train Loss: 0.4684 | Train Acc: 0.9366
 Site-SVHN      | Train Loss: 1.9059 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 1.8860 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.7509 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.8798 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.6252 | Train Acc: 0.4727
 Site-MNIST-M   | Train Loss: 1.8607 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.5078 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.5434 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.6513 | Val  Acc: 0.8732
 Site-MNIST     | Val  Loss: 0.5784 | Val  Acc: 0.9149
 Site-SVHN      | Val  Loss: 1.7376 | Val  Acc: 0.5455
 Site-SVHN      | Val  Loss: 1.7403 | Val  Acc: 0.5455
 Site-SVHN      | Val  Loss: 1.8949 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 0.9028 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.8863 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 1.8799 | Val  Acc: 0.3182
Average Valid Accuracy: 0.6678
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8732
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9149
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5455
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5455
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4242
 Best site-USPS       | Epoch:5 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.5847 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.4767 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.5344 | Train Acc: 0.9151
 Site-MNIST     | Train Loss: 0.3754 | Train Acc: 0.9366
 Site-SVHN      | Train Loss: 1.8920 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 2.0660 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.7146 | Train Acc: 0.5100
 Site-USPS      | Train Loss: 0.7886 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.6012 | Train Acc: 0.3818
 Site-MNIST-M   | Train Loss: 1.7053 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.4544 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.4493 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5389 | Val  Acc: 0.9014
 Site-MNIST     | Val  Loss: 0.5003 | Val  Acc: 0.9255
 Site-SVHN      | Val  Loss: 1.6889 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6935 | Val  Acc: 0.5227
 Site-SVHN      | Val  Loss: 1.8327 | Val  Acc: 0.4394
 Site-USPS      | Val  Loss: 0.8595 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.9770 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 1.8687 | Val  Acc: 0.3636
Average Valid Accuracy: 0.6655
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.5684 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.3467 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.4490 | Train Acc: 0.9434
 Site-MNIST     | Train Loss: 0.3316 | Train Acc: 0.9437
 Site-SVHN      | Train Loss: 1.8776 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 1.7412 | Train Acc: 0.3485
 Site-SVHN      | Train Loss: 1.6770 | Train Acc: 0.4900
 Site-USPS      | Train Loss: 0.7240 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.5593 | Train Acc: 0.5091
 Site-MNIST-M   | Train Loss: 1.8819 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.4182 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.4103 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.4804 | Val  Acc: 0.9577
 Site-MNIST     | Val  Loss: 0.4238 | Val  Acc: 0.9362
 Site-SVHN      | Val  Loss: 1.6700 | Val  Acc: 0.5455
 Site-SVHN      | Val  Loss: 1.6346 | Val  Acc: 0.5682
 Site-SVHN      | Val  Loss: 1.7456 | Val  Acc: 0.4394
 Site-USPS      | Val  Loss: 0.7845 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.9007 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 1.8591 | Val  Acc: 0.3636
Average Valid Accuracy: 0.6965
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9577
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9362
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5455
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5682
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4394
 Best site-USPS       | Epoch:7 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.3832 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.3260 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.4141 | Train Acc: 0.8868
 Site-MNIST     | Train Loss: 0.2722 | Train Acc: 0.9577
 Site-SVHN      | Train Loss: 1.6660 | Train Acc: 0.2121
 Site-SVHN      | Train Loss: 1.7771 | Train Acc: 0.3485
 Site-SVHN      | Train Loss: 1.6225 | Train Acc: 0.5700
 Site-USPS      | Train Loss: 0.7086 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.4983 | Train Acc: 0.5091
 Site-MNIST-M   | Train Loss: 1.6515 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.3819 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.3542 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.4332 | Val  Acc: 0.8873
 Site-MNIST     | Val  Loss: 0.3826 | Val  Acc: 0.8936
 Site-SVHN      | Val  Loss: 1.6083 | Val  Acc: 0.5909
 Site-SVHN      | Val  Loss: 1.5760 | Val  Acc: 0.6136
 Site-SVHN      | Val  Loss: 1.6931 | Val  Acc: 0.5152
 Site-USPS      | Val  Loss: 0.7230 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.9025 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 1.7782 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7022
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8873
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8936
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5909
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6136
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5152
 Best site-USPS       | Epoch:8 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.3318 | Train Acc: 0.8857
 Site-MNIST     | Train Loss: 0.3031 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3620 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.2394 | Train Acc: 0.9648
 Site-SVHN      | Train Loss: 1.9408 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.6682 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 1.5201 | Train Acc: 0.5700
 Site-USPS      | Train Loss: 0.7919 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.3906 | Train Acc: 0.5091
 Site-MNIST-M   | Train Loss: 1.6867 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.3491 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.3005 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.3617 | Val  Acc: 0.9296
 Site-MNIST     | Val  Loss: 0.3358 | Val  Acc: 0.9255
 Site-SVHN      | Val  Loss: 1.5338 | Val  Acc: 0.5909
 Site-SVHN      | Val  Loss: 1.5033 | Val  Acc: 0.5909
 Site-SVHN      | Val  Loss: 1.6215 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 0.7255 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.8713 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.7329 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7078
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9296
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9255
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5909
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5909
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5000
 Best site-USPS       | Epoch:9 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.3056 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.2522 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.3121 | Train Acc: 0.9340
 Site-MNIST     | Train Loss: 0.2013 | Train Acc: 0.9789
 Site-SVHN      | Train Loss: 1.9856 | Train Acc: 0.2424
 Site-SVHN      | Train Loss: 1.4730 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 1.4454 | Train Acc: 0.6300
 Site-USPS      | Train Loss: 0.6782 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.4525 | Train Acc: 0.5636
 Site-MNIST-M   | Train Loss: 1.5289 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.3393 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.2734 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.3183 | Val  Acc: 0.9437
 Site-MNIST     | Val  Loss: 0.3044 | Val  Acc: 0.9468
 Site-SVHN      | Val  Loss: 1.5453 | Val  Acc: 0.6818
 Site-SVHN      | Val  Loss: 1.4912 | Val  Acc: 0.6591
 Site-SVHN      | Val  Loss: 1.5716 | Val  Acc: 0.5152
 Site-USPS      | Val  Loss: 0.6893 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.8685 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 1.7085 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7261
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9437
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9468
 Best site-SVHN       | Epoch:10 | Val Acc: 0.6818
 Best site-SVHN       | Epoch:10 | Val Acc: 0.6591
 Best site-SVHN       | Epoch:10 | Val Acc: 0.5152
 Best site-USPS       | Epoch:10 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.2892 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.2449 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.3100 | Train Acc: 0.9434
 Site-MNIST     | Train Loss: 0.1960 | Train Acc: 0.9648
 Site-SVHN      | Train Loss: 1.6429 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.7520 | Train Acc: 0.4242
 Site-SVHN      | Train Loss: 1.4100 | Train Acc: 0.6100
 Site-USPS      | Train Loss: 0.7098 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.2779 | Train Acc: 0.6000
 Site-MNIST-M   | Train Loss: 1.3245 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.3638 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.2797 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.3252 | Val  Acc: 0.9296
 Site-MNIST     | Val  Loss: 0.2807 | Val  Acc: 0.9468
 Site-SVHN      | Val  Loss: 1.4031 | Val  Acc: 0.6818
 Site-SVHN      | Val  Loss: 1.3858 | Val  Acc: 0.6136
 Site-SVHN      | Val  Loss: 1.4911 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 0.6198 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7890 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5952 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7302
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9296
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9468
 Best site-SVHN       | Epoch:11 | Val Acc: 0.6818
 Best site-SVHN       | Epoch:11 | Val Acc: 0.6136
 Best site-SVHN       | Epoch:11 | Val Acc: 0.5000
 Best site-USPS       | Epoch:11 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.5169 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.2615 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2966 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.1586 | Train Acc: 0.9789
 Site-SVHN      | Train Loss: 1.6125 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.9024 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.3494 | Train Acc: 0.6500
 Site-USPS      | Train Loss: 0.5405 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.3018 | Train Acc: 0.5818
 Site-MNIST-M   | Train Loss: 1.5825 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3058 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.2237 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.2782 | Val  Acc: 0.9437
 Site-MNIST     | Val  Loss: 0.2640 | Val  Acc: 0.9574
 Site-SVHN      | Val  Loss: 1.4016 | Val  Acc: 0.6818
 Site-SVHN      | Val  Loss: 1.3461 | Val  Acc: 0.6591
 Site-SVHN      | Val  Loss: 1.4922 | Val  Acc: 0.5455
 Site-USPS      | Val  Loss: 0.5736 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.7814 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.7017 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7329
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9437
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9574
 Best site-SVHN       | Epoch:12 | Val Acc: 0.6818
 Best site-SVHN       | Epoch:12 | Val Acc: 0.6591
 Best site-SVHN       | Epoch:12 | Val Acc: 0.5455
 Best site-USPS       | Epoch:12 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.2965 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.2162 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.2479 | Train Acc: 0.9340
 Site-MNIST     | Train Loss: 0.1449 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.4788 | Train Acc: 0.3030
 Site-SVHN      | Train Loss: 1.5494 | Train Acc: 0.4242
 Site-SVHN      | Train Loss: 1.2486 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.6068 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.2239 | Train Acc: 0.5818
 Site-MNIST-M   | Train Loss: 1.4969 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.3367 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.2181 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2435 | Val  Acc: 0.9437
 Site-MNIST     | Val  Loss: 0.2337 | Val  Acc: 0.9255
 Site-SVHN      | Val  Loss: 1.3451 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 1.2966 | Val  Acc: 0.6818
 Site-SVHN      | Val  Loss: 1.4249 | Val  Acc: 0.5303
 Site-USPS      | Val  Loss: 0.6193 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7689 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.6702 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7505
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9437
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9255
 Best site-SVHN       | Epoch:13 | Val Acc: 0.7727
 Best site-SVHN       | Epoch:13 | Val Acc: 0.6818
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5303
 Best site-USPS       | Epoch:13 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.2993 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.2176 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.2425 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.1396 | Train Acc: 0.9789
 Site-SVHN      | Train Loss: 1.6838 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.5144 | Train Acc: 0.4697
 Site-SVHN      | Train Loss: 1.2612 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.5421 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.1665 | Train Acc: 0.6727
 Site-MNIST-M   | Train Loss: 1.6938 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2823 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.2051 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.2385 | Val  Acc: 0.9437
 Site-MNIST     | Val  Loss: 0.2188 | Val  Acc: 0.9681
 Site-SVHN      | Val  Loss: 1.3588 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 1.2741 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 1.3762 | Val  Acc: 0.6212
 Site-USPS      | Val  Loss: 0.5938 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7732 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.6564 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7712
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9437
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9681
 Best site-SVHN       | Epoch:14 | Val Acc: 0.7727
 Best site-SVHN       | Epoch:14 | Val Acc: 0.7500
 Best site-SVHN       | Epoch:14 | Val Acc: 0.6212
 Best site-USPS       | Epoch:14 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.1994 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.2518 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2103 | Train Acc: 0.9528
 Site-MNIST     | Train Loss: 0.1162 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.9170 | Train Acc: 0.3030
 Site-SVHN      | Train Loss: 1.5876 | Train Acc: 0.4697
 Site-SVHN      | Train Loss: 1.2268 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.5979 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1516 | Train Acc: 0.6727
 Site-MNIST-M   | Train Loss: 1.2816 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2718 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.1753 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2144 | Val  Acc: 0.9577
 Site-MNIST     | Val  Loss: 0.1922 | Val  Acc: 0.9468
 Site-SVHN      | Val  Loss: 1.3034 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 1.2359 | Val  Acc: 0.7273
 Site-SVHN      | Val  Loss: 1.3478 | Val  Acc: 0.5758
 Site-USPS      | Val  Loss: 0.5798 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.7489 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.6174 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7543
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.3077 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1777 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1894 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.1068 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.8118 | Train Acc: 0.3030
 Site-SVHN      | Train Loss: 1.4058 | Train Acc: 0.4697
 Site-SVHN      | Train Loss: 1.1990 | Train Acc: 0.7200
 Site-USPS      | Train Loss: 0.5652 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.1271 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.2825 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.2502 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.1590 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1825 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.1755 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 1.2745 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 1.1684 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 1.2925 | Val  Acc: 0.6212
 Site-USPS      | Val  Loss: 0.5548 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7924 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.6413 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7687
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.2427 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1988 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1939 | Train Acc: 0.9717
 Site-MNIST     | Train Loss: 0.0873 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.4175 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.4856 | Train Acc: 0.4697
 Site-SVHN      | Train Loss: 1.0823 | Train Acc: 0.7400
 Site-USPS      | Train Loss: 0.5345 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.0411 | Train Acc: 0.6727
 Site-MNIST-M   | Train Loss: 1.2461 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.1947 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.1233 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1714 | Val  Acc: 0.9718
 Site-MNIST     | Val  Loss: 0.1731 | Val  Acc: 0.9681
 Site-SVHN      | Val  Loss: 1.2415 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 1.1301 | Val  Acc: 0.7955
 Site-SVHN      | Val  Loss: 1.2598 | Val  Acc: 0.6364
 Site-USPS      | Val  Loss: 0.5530 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7555 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.6487 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7777
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9718
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9681
 Best site-SVHN       | Epoch:17 | Val Acc: 0.7727
 Best site-SVHN       | Epoch:17 | Val Acc: 0.7955
 Best site-SVHN       | Epoch:17 | Val Acc: 0.6364
 Best site-USPS       | Epoch:17 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.4130 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1713 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1725 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0806 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.7357 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 1.3199 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.1041 | Train Acc: 0.7400
 Site-USPS      | Train Loss: 0.5343 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.0612 | Train Acc: 0.7091
 Site-MNIST-M   | Train Loss: 1.5540 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2056 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.1249 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1634 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.1617 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 1.2142 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 1.1097 | Val  Acc: 0.7955
 Site-SVHN      | Val  Loss: 1.2385 | Val  Acc: 0.6515
 Site-USPS      | Val  Loss: 0.5420 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7403 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.6132 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7854
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9859
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9787
 Best site-SVHN       | Epoch:18 | Val Acc: 0.7727
 Best site-SVHN       | Epoch:18 | Val Acc: 0.7955
 Best site-SVHN       | Epoch:18 | Val Acc: 0.6515
 Best site-USPS       | Epoch:18 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.1744 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1510 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1578 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0766 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.3718 | Train Acc: 0.4242
 Site-SVHN      | Train Loss: 1.3635 | Train Acc: 0.5606
 Site-SVHN      | Train Loss: 1.0349 | Train Acc: 0.8000
 Site-USPS      | Train Loss: 0.5464 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0690 | Train Acc: 0.6909
 Site-MNIST-M   | Train Loss: 1.0471 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.2202 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.1210 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1391 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.1537 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 1.1566 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 1.0589 | Val  Acc: 0.8409
 Site-SVHN      | Val  Loss: 1.1935 | Val  Acc: 0.6818
 Site-USPS      | Val  Loss: 0.5613 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7690 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.5947 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7948
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9859
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9787
 Best site-SVHN       | Epoch:19 | Val Acc: 0.8182
 Best site-SVHN       | Epoch:19 | Val Acc: 0.8409
 Best site-SVHN       | Epoch:19 | Val Acc: 0.6818
 Best site-USPS       | Epoch:19 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.2188 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1845 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1511 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0674 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.3750 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.4986 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 0.9822 | Train Acc: 0.8100
 Site-USPS      | Train Loss: 0.5446 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.0391 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.3062 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.2016 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.1155 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1362 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.1435 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 1.1324 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 1.0230 | Val  Acc: 0.8409
 Site-SVHN      | Val  Loss: 1.1602 | Val  Acc: 0.7121
 Site-USPS      | Val  Loss: 0.5422 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.6998 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5608 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7941
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.2182 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.1627 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1615 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.0557 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.9586 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.1648 | Train Acc: 0.6061
 Site-SVHN      | Train Loss: 0.9897 | Train Acc: 0.8000
 Site-USPS      | Train Loss: 0.5073 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.9638 | Train Acc: 0.7091
 Site-MNIST-M   | Train Loss: 1.3993 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.1795 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0958 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1331 | Val  Acc: 0.9718
 Site-MNIST     | Val  Loss: 0.1428 | Val  Acc: 0.9574
 Site-SVHN      | Val  Loss: 1.1167 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 1.0194 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 1.1692 | Val  Acc: 0.7273
 Site-USPS      | Val  Loss: 0.5645 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7657 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5523 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7880
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.1718 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1483 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1469 | Train Acc: 0.9717
 Site-MNIST     | Train Loss: 0.0491 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.6042 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.3407 | Train Acc: 0.6061
 Site-SVHN      | Train Loss: 0.9970 | Train Acc: 0.8300
 Site-USPS      | Train Loss: 0.5063 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9301 | Train Acc: 0.7455
 Site-MNIST-M   | Train Loss: 0.9419 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.1308 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0764 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1222 | Val  Acc: 0.9718
 Site-MNIST     | Val  Loss: 0.1442 | Val  Acc: 0.9681
 Site-SVHN      | Val  Loss: 1.0449 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 0.9660 | Val  Acc: 0.8409
 Site-SVHN      | Val  Loss: 1.1169 | Val  Acc: 0.7424
 Site-USPS      | Val  Loss: 0.5396 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.6939 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.5410 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8012
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9718
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9681
 Best site-SVHN       | Epoch:22 | Val Acc: 0.8182
 Best site-SVHN       | Epoch:22 | Val Acc: 0.8409
 Best site-SVHN       | Epoch:22 | Val Acc: 0.7424
 Best site-USPS       | Epoch:22 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.1645 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1207 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1306 | Train Acc: 0.9717
 Site-MNIST     | Train Loss: 0.0480 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.7250 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 1.2075 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 0.8529 | Train Acc: 0.8400
 Site-USPS      | Train Loss: 0.5506 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.8809 | Train Acc: 0.7818
 Site-MNIST-M   | Train Loss: 1.1739 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.1367 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0823 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1194 | Val  Acc: 0.9718
 Site-MNIST     | Val  Loss: 0.1261 | Val  Acc: 0.9681
 Site-SVHN      | Val  Loss: 1.0164 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 0.9166 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 1.0580 | Val  Acc: 0.7424
 Site-USPS      | Val  Loss: 0.5243 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.7454 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5253 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8072
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9718
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9681
 Best site-SVHN       | Epoch:23 | Val Acc: 0.8182
 Best site-SVHN       | Epoch:23 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:23 | Val Acc: 0.7424
 Best site-USPS       | Epoch:23 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.1857 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1195 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1237 | Train Acc: 0.9717
 Site-MNIST     | Train Loss: 0.0460 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.8783 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.3570 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 0.8733 | Train Acc: 0.8300
 Site-USPS      | Train Loss: 0.5237 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.8680 | Train Acc: 0.7636
 Site-MNIST-M   | Train Loss: 0.9648 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.1377 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0808 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1171 | Val  Acc: 0.9718
 Site-MNIST     | Val  Loss: 0.1201 | Val  Acc: 0.9681
 Site-SVHN      | Val  Loss: 0.9838 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 0.8831 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 1.0221 | Val  Acc: 0.7424
 Site-USPS      | Val  Loss: 0.4989 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.7089 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5109 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8099
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9718
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9681
 Best site-SVHN       | Epoch:24 | Val Acc: 0.8182
 Best site-SVHN       | Epoch:24 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:24 | Val Acc: 0.7424
 Best site-USPS       | Epoch:24 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.1680 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1349 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1073 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0410 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.3858 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.1892 | Train Acc: 0.6515
 Site-SVHN      | Train Loss: 0.8622 | Train Acc: 0.8300
 Site-USPS      | Train Loss: 0.4731 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.8938 | Train Acc: 0.7636
 Site-MNIST-M   | Train Loss: 1.4400 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.1029 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0657 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1017 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.1102 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.9822 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 0.8787 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 1.0059 | Val  Acc: 0.7727
 Site-USPS      | Val  Loss: 0.5120 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.6732 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5352 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8097
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.1372 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1233 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1173 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.0404 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.3525 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 1.1018 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.9098 | Train Acc: 0.8700
 Site-USPS      | Train Loss: 0.4695 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.8507 | Train Acc: 0.7636
 Site-MNIST-M   | Train Loss: 1.1456 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.1150 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0691 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1051 | Val  Acc: 0.9577
 Site-MNIST     | Val  Loss: 0.1152 | Val  Acc: 0.9574
 Site-SVHN      | Val  Loss: 0.9916 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.8856 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 1.0126 | Val  Acc: 0.7576
 Site-USPS      | Val  Loss: 0.5241 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.6533 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5430 | Val  Acc: 0.5455
Average Valid Accuracy: 0.8145
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9577
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9574
 Best site-SVHN       | Epoch:26 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:26 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:26 | Val Acc: 0.7576
 Best site-USPS       | Epoch:26 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.1484 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1237 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.1237 | Train Acc: 0.9717
 Site-MNIST     | Train Loss: 0.0334 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 2.0894 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.4314 | Train Acc: 0.6515
 Site-SVHN      | Train Loss: 0.8126 | Train Acc: 0.8700
 Site-USPS      | Train Loss: 0.4566 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.7829 | Train Acc: 0.8000
 Site-MNIST-M   | Train Loss: 0.8152 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.0968 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0570 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1057 | Val  Acc: 0.9718
 Site-MNIST     | Val  Loss: 0.1110 | Val  Acc: 0.9681
 Site-SVHN      | Val  Loss: 0.9520 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.8448 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.9878 | Val  Acc: 0.7576
 Site-USPS      | Val  Loss: 0.5175 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.6614 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5091 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8159
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9718
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9681
 Best site-SVHN       | Epoch:27 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:27 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:27 | Val Acc: 0.7576
 Best site-USPS       | Epoch:27 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.1803 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.1007 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0977 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0268 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 1.6770 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.0549 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 0.8011 | Train Acc: 0.9100
 Site-USPS      | Train Loss: 0.4892 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.7593 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.8924 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.0718 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0435 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0793 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0943 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.9239 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.8162 | Val  Acc: 0.8864
 Site-SVHN      | Val  Loss: 0.9626 | Val  Acc: 0.7576
 Site-USPS      | Val  Loss: 0.5050 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.6496 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5149 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8123
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1748 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0974 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.1006 | Train Acc: 0.9717
 Site-MNIST     | Train Loss: 0.0294 | Train Acc: 0.9930
 Site-SVHN      | Train Loss: 2.5143 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.1502 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 0.7949 | Train Acc: 0.9000
 Site-USPS      | Train Loss: 0.4831 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.7518 | Train Acc: 0.8364
 Site-MNIST-M   | Train Loss: 1.1020 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0802 | Val  Acc: 0.9565
 Site-MNIST     | Val  Loss: 0.0501 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0925 | Val  Acc: 0.9718
 Site-MNIST     | Val  Loss: 0.0835 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.8612 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.7726 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.9189 | Val  Acc: 0.7879
 Site-USPS      | Val  Loss: 0.5275 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.6737 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.4726 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8253
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9565
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9718
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9787
 Best site-SVHN       | Epoch:29 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:29 | Val Acc: 0.9091
 Best site-SVHN       | Epoch:29 | Val Acc: 0.7879
 Best site-USPS       | Epoch:29 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.8836
 Test site-SVHN      | Epoch:29 | Test Acc: 0.2902
 Test site-USPS      | Epoch:29 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.4814
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.3400
Average Test Accuracy: 0.5689
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.1577 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.0945 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0875 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0252 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7257 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.0304 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 0.7674 | Train Acc: 0.8900
 Site-USPS      | Train Loss: 0.4567 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.7945 | Train Acc: 0.7818
 Site-MNIST-M   | Train Loss: 0.8135 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0500 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0406 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0781 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0801 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.8971 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 0.7665 | Val  Acc: 0.8864
 Site-SVHN      | Val  Loss: 0.8969 | Val  Acc: 0.7727
 Site-USPS      | Val  Loss: 0.5154 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.7101 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5301 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8196
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.1940 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.1065 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0921 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0240 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 2.0330 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 0.9632 | Train Acc: 0.7121
 Site-SVHN      | Train Loss: 0.7177 | Train Acc: 0.9200
 Site-USPS      | Train Loss: 0.4831 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.6996 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.9836 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.0500 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0858 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0855 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.8066 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.7276 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.8790 | Val  Acc: 0.8182
 Site-USPS      | Val  Loss: 0.5098 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.6452 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4537 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8451
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9859
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9787
 Best site-SVHN       | Epoch:31 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:31 | Val Acc: 0.9091
 Best site-SVHN       | Epoch:31 | Val Acc: 0.8182
 Best site-USPS       | Epoch:31 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.1279 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0898 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0853 | Train Acc: 0.9717
 Site-MNIST     | Train Loss: 0.0223 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2243 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.0386 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.7133 | Train Acc: 0.9000
 Site-USPS      | Train Loss: 0.4551 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.7263 | Train Acc: 0.8364
 Site-MNIST-M   | Train Loss: 0.9805 | Train Acc: 0.6970
 Site-MNIST     | Val  Loss: 0.0530 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0787 | Val  Acc: 0.9718
 Site-MNIST     | Val  Loss: 0.0743 | Val  Acc: 0.9681
 Site-SVHN      | Val  Loss: 0.8140 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 0.7136 | Val  Acc: 0.8864
 Site-SVHN      | Val  Loss: 0.8661 | Val  Acc: 0.8030
 Site-USPS      | Val  Loss: 0.4918 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.6821 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5227 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8198
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.1354 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0768 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0828 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0201 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5104 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.0062 | Train Acc: 0.7121
 Site-SVHN      | Train Loss: 0.6916 | Train Acc: 0.9100
 Site-USPS      | Train Loss: 0.4510 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.7046 | Train Acc: 0.8364
 Site-MNIST-M   | Train Loss: 1.5421 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.0351 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0287 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0725 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0762 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.8209 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.7059 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.8485 | Val  Acc: 0.8485
 Site-USPS      | Val  Loss: 0.4813 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.6521 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5120 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8313
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1521 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.0774 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0722 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0196 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2959 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 0.9053 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.6800 | Train Acc: 0.9100
 Site-USPS      | Train Loss: 0.4614 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.7546 | Train Acc: 0.8545
 Site-MNIST-M   | Train Loss: 1.2595 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.0451 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0307 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0645 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0708 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.8115 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.6792 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.7817 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5013 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.5606 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.5041 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8306
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.1442 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0679 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0702 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0213 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3915 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 0.8701 | Train Acc: 0.7424
 Site-SVHN      | Train Loss: 0.6241 | Train Acc: 0.9100
 Site-USPS      | Train Loss: 0.4020 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.6881 | Train Acc: 0.8545
 Site-MNIST-M   | Train Loss: 0.7508 | Train Acc: 0.6970
 Site-MNIST     | Val  Loss: 0.0566 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0703 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0607 | Val  Acc: 0.9894
 Site-SVHN      | Val  Loss: 0.7445 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.6500 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.7726 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4802 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.6106 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4853 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8491
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9894
 Best site-SVHN       | Epoch:35 | Val Acc: 0.8636
 Best site-SVHN       | Epoch:35 | Val Acc: 0.9091
 Best site-SVHN       | Epoch:35 | Val Acc: 0.8333
 Best site-USPS       | Epoch:35 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.1384 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.0784 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0709 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0187 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.8440 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 0.9512 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.6246 | Train Acc: 0.9200
 Site-USPS      | Train Loss: 0.3976 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.6521 | Train Acc: 0.8545
 Site-MNIST-M   | Train Loss: 0.8778 | Train Acc: 0.7576
 Site-MNIST     | Val  Loss: 0.0501 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0585 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0598 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.7527 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.6420 | Val  Acc: 0.9318
 Site-SVHN      | Val  Loss: 0.7579 | Val  Acc: 0.8485
 Site-USPS      | Val  Loss: 0.5151 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.6247 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5301 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8461
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.1169 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0895 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0657 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0207 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.8679 | Train Acc: 0.4242
 Site-SVHN      | Train Loss: 0.9356 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.6105 | Train Acc: 0.9300
 Site-USPS      | Train Loss: 0.3558 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.6334 | Train Acc: 0.8545
 Site-MNIST-M   | Train Loss: 1.0030 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.0578 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0327 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0674 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0607 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.7113 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.6248 | Val  Acc: 0.9318
 Site-SVHN      | Val  Loss: 0.7359 | Val  Acc: 0.8485
 Site-USPS      | Val  Loss: 0.4670 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.5992 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4936 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8549
 Best site-MNIST      | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9859
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9787
 Best site-SVHN       | Epoch:37 | Val Acc: 0.9091
 Best site-SVHN       | Epoch:37 | Val Acc: 0.9318
 Best site-SVHN       | Epoch:37 | Val Acc: 0.8485
 Best site-USPS       | Epoch:37 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.1451 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0657 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0677 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0169 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7094 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 0.9535 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.5839 | Train Acc: 0.9300
 Site-USPS      | Train Loss: 0.3599 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.6848 | Train Acc: 0.8545
 Site-MNIST-M   | Train Loss: 1.0503 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0255 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0694 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0630 | Val  Acc: 0.9787
 Site-SVHN      | Val  Loss: 0.7217 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.6190 | Val  Acc: 0.9318
 Site-SVHN      | Val  Loss: 0.7195 | Val  Acc: 0.8636
 Site-USPS      | Val  Loss: 0.4730 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.5752 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4694 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8564
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9859
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9787
 Best site-SVHN       | Epoch:38 | Val Acc: 0.9091
 Best site-SVHN       | Epoch:38 | Val Acc: 0.9318
 Best site-SVHN       | Epoch:38 | Val Acc: 0.8636
 Best site-USPS       | Epoch:38 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1584 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0620 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0649 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0160 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7400 | Train Acc: 0.4242
 Site-SVHN      | Train Loss: 0.8336 | Train Acc: 0.7879
 Site-SVHN      | Train Loss: 0.5648 | Train Acc: 0.9300
 Site-USPS      | Train Loss: 0.3717 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.6352 | Train Acc: 0.8364
 Site-MNIST-M   | Train Loss: 1.2188 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.0357 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0624 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0548 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6936 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.5980 | Val  Acc: 0.9318
 Site-SVHN      | Val  Loss: 0.7210 | Val  Acc: 0.8636
 Site-USPS      | Val  Loss: 0.4537 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.6181 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5078 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8559
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.1447 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0711 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0538 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0173 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5107 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 1.0678 | Train Acc: 0.7879
 Site-SVHN      | Train Loss: 0.5817 | Train Acc: 0.9200
 Site-USPS      | Train Loss: 0.3360 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5725 | Train Acc: 0.8727
 Site-MNIST-M   | Train Loss: 0.8173 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.0512 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0288 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0542 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0495 | Val  Acc: 0.9894
 Site-SVHN      | Val  Loss: 0.6784 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.5785 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.6706 | Val  Acc: 0.8636
 Site-USPS      | Val  Loss: 0.4866 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.5632 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4995 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8507
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.1310 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0557 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0665 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0152 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2657 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 0.8064 | Train Acc: 0.8030
 Site-SVHN      | Train Loss: 0.5256 | Train Acc: 0.9200
 Site-USPS      | Train Loss: 0.3393 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.6705 | Train Acc: 0.8545
 Site-MNIST-M   | Train Loss: 0.8009 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0627 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0514 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6636 | Val  Acc: 0.8636
 Site-SVHN      | Val  Loss: 0.5530 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.6571 | Val  Acc: 0.8636
 Site-USPS      | Val  Loss: 0.4760 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.6212 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.4902 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8445
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.2171 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0750 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0606 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0141 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2780 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 0.8919 | Train Acc: 0.8030
 Site-SVHN      | Train Loss: 0.5067 | Train Acc: 0.9300
 Site-USPS      | Train Loss: 0.3133 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.5658 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.7523 | Train Acc: 0.7879
 Site-MNIST     | Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0542 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0447 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6610 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.5530 | Val  Acc: 0.9318
 Site-SVHN      | Val  Loss: 0.6587 | Val  Acc: 0.8788
 Site-USPS      | Val  Loss: 0.4849 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.6127 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.4867 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8574
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9859
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:42 | Val Acc: 0.9091
 Best site-SVHN       | Epoch:42 | Val Acc: 0.9318
 Best site-SVHN       | Epoch:42 | Val Acc: 0.8788
 Best site-USPS       | Epoch:42 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.1462 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.0554 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0517 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0139 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4699 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 0.8175 | Train Acc: 0.8030
 Site-SVHN      | Train Loss: 0.4824 | Train Acc: 0.9600
 Site-USPS      | Train Loss: 0.3468 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.6177 | Train Acc: 0.8909
 Site-MNIST-M   | Train Loss: 0.7505 | Train Acc: 0.7576
 Site-MNIST     | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0239 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0527 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0464 | Val  Acc: 0.9894
 Site-SVHN      | Val  Loss: 0.6386 | Val  Acc: 0.9545
 Site-SVHN      | Val  Loss: 0.5427 | Val  Acc: 0.9773
 Site-SVHN      | Val  Loss: 0.6543 | Val  Acc: 0.9091
 Site-USPS      | Val  Loss: 0.5058 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.6146 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.4667 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8604
 Best site-MNIST      | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9859
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9894
 Best site-SVHN       | Epoch:43 | Val Acc: 0.9545
 Best site-SVHN       | Epoch:43 | Val Acc: 0.9773
 Best site-SVHN       | Epoch:43 | Val Acc: 0.9091
 Best site-USPS       | Epoch:43 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:43 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1152 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.0603 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0514 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6022 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 0.7800 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 0.5362 | Train Acc: 0.9300
 Site-USPS      | Train Loss: 0.3459 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.5672 | Train Acc: 0.8909
 Site-MNIST-M   | Train Loss: 0.7009 | Train Acc: 0.7879
 Site-MNIST     | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0200 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0464 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0407 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6388 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.5470 | Val  Acc: 0.9318
 Site-SVHN      | Val  Loss: 0.6626 | Val  Acc: 0.8788
 Site-USPS      | Val  Loss: 0.4739 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.6214 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5433 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8528
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.1184 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0567 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0503 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0130 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.9324 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 0.9180 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 0.4930 | Train Acc: 0.9600
 Site-USPS      | Train Loss: 0.2962 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5964 | Train Acc: 0.8909
 Site-MNIST-M   | Train Loss: 1.0923 | Train Acc: 0.7879
 Site-MNIST     | Val  Loss: 0.0258 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0428 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5911 | Val  Acc: 0.9545
 Site-SVHN      | Val  Loss: 0.5199 | Val  Acc: 0.9545
 Site-SVHN      | Val  Loss: 0.6417 | Val  Acc: 0.8788
 Site-USPS      | Val  Loss: 0.4949 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.6049 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5257 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8611
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:45 | Val Acc: 0.9545
 Best site-SVHN       | Epoch:45 | Val Acc: 0.9545
 Best site-SVHN       | Epoch:45 | Val Acc: 0.8788
 Best site-USPS       | Epoch:45 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:45 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.1321 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.0557 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0615 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0111 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5618 | Train Acc: 0.4242
 Site-SVHN      | Train Loss: 0.8533 | Train Acc: 0.8030
 Site-SVHN      | Train Loss: 0.4820 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.3379 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.5988 | Train Acc: 0.8909
 Site-MNIST-M   | Train Loss: 0.6389 | Train Acc: 0.7879
 Site-MNIST     | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0532 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0494 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6286 | Val  Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.5305 | Val  Acc: 0.9545
 Site-SVHN      | Val  Loss: 0.6492 | Val  Acc: 0.8788
 Site-USPS      | Val  Loss: 0.5273 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.6221 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5138 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8517
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.1183 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0502 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0497 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0130 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3917 | Train Acc: 0.3939
 Site-SVHN      | Train Loss: 0.7989 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 0.4801 | Train Acc: 0.9600
 Site-USPS      | Train Loss: 0.3045 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.5332 | Train Acc: 0.9273
 Site-MNIST-M   | Train Loss: 0.7508 | Train Acc: 0.8182
 Site-MNIST     | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0225 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0524 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5833 | Val  Acc: 0.9545
 Site-SVHN      | Val  Loss: 0.4983 | Val  Acc: 0.9773
 Site-SVHN      | Val  Loss: 0.6093 | Val  Acc: 0.8939
 Site-USPS      | Val  Loss: 0.5110 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.5874 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.4886 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8634
 Best site-MNIST      | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9859
 Best site-MNIST      | Epoch:47 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:47 | Val Acc: 0.9545
 Best site-SVHN       | Epoch:47 | Val Acc: 0.9773
 Best site-SVHN       | Epoch:47 | Val Acc: 0.8939
 Best site-USPS       | Epoch:47 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:47 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:47 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.1413 | Train Acc: 0.9714
 Site-MNIST     | Train Loss: 0.0484 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0485 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0124 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5941 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.0743 | Train Acc: 0.8333
 Site-SVHN      | Train Loss: 0.4498 | Train Acc: 0.9700
 Site-USPS      | Train Loss: 0.3149 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5362 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.7096 | Train Acc: 0.7576
 Site-MNIST     | Val  Loss: 0.0309 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0213 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0515 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0420 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5437 | Val  Acc: 0.9545
 Site-SVHN      | Val  Loss: 0.4809 | Val  Acc: 0.9773
 Site-SVHN      | Val  Loss: 0.5865 | Val  Acc: 0.8939
 Site-USPS      | Val  Loss: 0.5060 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.5419 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4895 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8686
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:48 | Val Acc: 0.9545
 Best site-SVHN       | Epoch:48 | Val Acc: 0.9773
 Best site-SVHN       | Epoch:48 | Val Acc: 0.8939
 Best site-USPS       | Epoch:48 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/harmo-fl...
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1329 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.0618 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0501 | Train Acc: 0.9906
 Site-MNIST     | Train Loss: 0.0093 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1994 | Train Acc: 0.4848
 Site-SVHN      | Train Loss: 1.0471 | Train Acc: 0.8333
 Site-SVHN      | Train Loss: 0.4519 | Train Acc: 0.9800
 Site-USPS      | Train Loss: 0.3230 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.5894 | Train Acc: 0.8727
 Site-MNIST-M   | Train Loss: 1.1004 | Train Acc: 0.7879
 Site-MNIST     | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0481 | Val  Acc: 0.9859
 Site-MNIST     | Val  Loss: 0.0462 | Val  Acc: 0.9894
 Site-SVHN      | Val  Loss: 0.5302 | Val  Acc: 0.9545
 Site-SVHN      | Val  Loss: 0.4836 | Val  Acc: 0.9773
 Site-SVHN      | Val  Loss: 0.6074 | Val  Acc: 0.9091
 Site-USPS      | Val  Loss: 0.5330 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.5917 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4736 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8631
===2023-04-23 04:14:09===
===2023-04-23 04:14:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[35,71,106,142,33,66,100,44,55,33,]
label set of clients: [10, 10, 10, 10, 8, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8907
 Test site-SVHN      | Epoch:48 | Test Acc: 0.2982
 Test site-USPS      | Epoch:48 | Test Acc: 0.8602
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.4963
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.3264
Average Test Accuracy: 0.5744
