===2023-04-07 01:27:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[26,53,80,106,52,104,156,55,59,48,]
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
client-0 is in G-4
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(3,)(0,)(5,)]
 Site-MNIST     | Train Loss: 2.2210 | Train Acc: 0.2308
 Site-MNIST     | Train Loss: 2.1539 | Train Acc: 0.3774
 Site-MNIST     | Train Loss: 2.0779 | Train Acc: 0.3500
 Site-MNIST     | Train Loss: 2.0706 | Train Acc: 0.3585
 Site-SVHN      | Train Loss: 2.1894 | Train Acc: 0.2115
 Site-SVHN      | Train Loss: 2.2361 | Train Acc: 0.1923
 Site-SVHN      | Train Loss: 2.2145 | Train Acc: 0.1987
 Site-USPS      | Train Loss: 2.1080 | Train Acc: 0.2182
 Site-SynthDigits| Train Loss: 2.2938 | Train Acc: 0.1525
 Site-MNIST-M   | Train Loss: 2.3036 | Train Acc: 0.1875
 Site-MNIST     | Val  Loss: 2.2224 | Val  Acc: 0.2941
 Site-MNIST     | Val  Loss: 2.1324 | Val  Acc: 0.2571
 Site-MNIST     | Val  Loss: 2.1493 | Val  Acc: 0.2453
 Site-MNIST     | Val  Loss: 2.1017 | Val  Acc: 0.3662
 Site-SVHN      | Val  Loss: 2.0673 | Val  Acc: 0.1765
 Site-SVHN      | Val  Loss: 2.2314 | Val  Acc: 0.1304
 Site-SVHN      | Val  Loss: 2.2575 | Val  Acc: 0.1731
 Site-USPS      | Val  Loss: 1.8872 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.2916 | Val  Acc: 0.1795
 Site-MNIST-M   | Val  Loss: 2.3791 | Val  Acc: 0.1562
Average Valid Accuracy: 0.2438
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2941
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2571
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2453
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3662
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1765
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1304
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1731
 Best site-USPS       | Epoch:0 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1795
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1562
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 2 ============
============ Train epoch 3 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 2.0961 | Train Acc: 0.3077
 Site-MNIST     | Train Loss: 1.9385 | Train Acc: 0.4151
 Site-MNIST     | Train Loss: 1.8923 | Train Acc: 0.4500
 Site-MNIST     | Train Loss: 1.8531 | Train Acc: 0.4434
 Site-SVHN      | Train Loss: 2.1675 | Train Acc: 0.2308
 Site-SVHN      | Train Loss: 2.1689 | Train Acc: 0.2212
 Site-SVHN      | Train Loss: 2.1257 | Train Acc: 0.2756
 Site-USPS      | Train Loss: 2.0005 | Train Acc: 0.2545
 Site-SynthDigits| Train Loss: 2.2150 | Train Acc: 0.1695
 Site-MNIST-M   | Train Loss: 2.2833 | Train Acc: 0.1667
============ Train epoch 4 ============
============ Train epoch 5 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 1.9122 | Train Acc: 0.3077
 Site-MNIST     | Train Loss: 1.6663 | Train Acc: 0.5660
 Site-MNIST     | Train Loss: 1.7017 | Train Acc: 0.5750
 Site-MNIST     | Train Loss: 1.6905 | Train Acc: 0.5377
 Site-SVHN      | Train Loss: 2.1951 | Train Acc: 0.2115
 Site-SVHN      | Train Loss: 2.1266 | Train Acc: 0.2692
 Site-SVHN      | Train Loss: 2.0498 | Train Acc: 0.2436
 Site-USPS      | Train Loss: 1.7854 | Train Acc: 0.3818
 Site-SynthDigits| Train Loss: 2.1316 | Train Acc: 0.2542
 Site-MNIST-M   | Train Loss: 2.2412 | Train Acc: 0.1875
============ Train epoch 6 ============
============ Train epoch 7 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 1.7537 | Train Acc: 0.4615
 Site-MNIST     | Train Loss: 1.5213 | Train Acc: 0.6415
 Site-MNIST     | Train Loss: 1.4662 | Train Acc: 0.6875
 Site-MNIST     | Train Loss: 1.4809 | Train Acc: 0.6509
 Site-SVHN      | Train Loss: 2.0840 | Train Acc: 0.2115
 Site-SVHN      | Train Loss: 2.0614 | Train Acc: 0.2788
 Site-SVHN      | Train Loss: 1.9817 | Train Acc: 0.2885
 Site-USPS      | Train Loss: 1.6693 | Train Acc: 0.4909
 Site-SynthDigits| Train Loss: 2.0408 | Train Acc: 0.3559
 Site-MNIST-M   | Train Loss: 2.2136 | Train Acc: 0.2292
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 1.5788 | Train Acc: 0.5385
 Site-MNIST     | Train Loss: 1.3427 | Train Acc: 0.6604
 Site-MNIST     | Train Loss: 1.2077 | Train Acc: 0.6750
 Site-MNIST     | Train Loss: 1.2110 | Train Acc: 0.7547
 Site-SVHN      | Train Loss: 2.0670 | Train Acc: 0.2692
 Site-SVHN      | Train Loss: 1.9447 | Train Acc: 0.2981
 Site-SVHN      | Train Loss: 1.8846 | Train Acc: 0.3397
 Site-USPS      | Train Loss: 1.5090 | Train Acc: 0.6000
 Site-SynthDigits| Train Loss: 1.9389 | Train Acc: 0.3559
 Site-MNIST-M   | Train Loss: 2.2163 | Train Acc: 0.2083
 Site-MNIST     | Val  Loss: 1.6218 | Val  Acc: 0.7647
 Site-MNIST     | Val  Loss: 1.3483 | Val  Acc: 0.6857
 Site-MNIST     | Val  Loss: 1.2958 | Val  Acc: 0.6415
 Site-MNIST     | Val  Loss: 1.2621 | Val  Acc: 0.6901
 Site-SVHN      | Val  Loss: 1.5346 | Val  Acc: 0.3529
 Site-SVHN      | Val  Loss: 1.9141 | Val  Acc: 0.2754
 Site-SVHN      | Val  Loss: 1.9698 | Val  Acc: 0.2692
 Site-USPS      | Val  Loss: 1.2336 | Val  Acc: 0.7297
 Site-SynthDigits| Val  Loss: 2.0996 | Val  Acc: 0.2308
 Site-MNIST-M   | Val  Loss: 2.2435 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4890
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7647
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6857
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6415
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6901
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3529
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2754
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2692
 Best site-USPS       | Epoch:4 | Val Acc: 0.7297
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2308
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.4020 | Train Acc: 0.6538
 Site-MNIST     | Train Loss: 1.1936 | Train Acc: 0.7170
 Site-MNIST     | Train Loss: 1.0261 | Train Acc: 0.8125
 Site-MNIST     | Train Loss: 1.0487 | Train Acc: 0.8396
 Site-SVHN      | Train Loss: 2.0100 | Train Acc: 0.3269
 Site-SVHN      | Train Loss: 1.8399 | Train Acc: 0.3462
 Site-SVHN      | Train Loss: 1.7190 | Train Acc: 0.4679
 Site-USPS      | Train Loss: 1.2962 | Train Acc: 0.7091
 Site-SynthDigits| Train Loss: 1.7712 | Train Acc: 0.4576
 Site-MNIST-M   | Train Loss: 2.1422 | Train Acc: 0.1875
============ Train epoch 12 ============
============ Train epoch 13 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.2995 | Train Acc: 0.6538
 Site-MNIST     | Train Loss: 1.0675 | Train Acc: 0.7358
 Site-MNIST     | Train Loss: 0.8716 | Train Acc: 0.8125
 Site-MNIST     | Train Loss: 0.9095 | Train Acc: 0.8585
 Site-SVHN      | Train Loss: 2.0748 | Train Acc: 0.3654
 Site-SVHN      | Train Loss: 1.7381 | Train Acc: 0.3942
 Site-SVHN      | Train Loss: 1.6195 | Train Acc: 0.5192
 Site-USPS      | Train Loss: 1.1839 | Train Acc: 0.6909
 Site-SynthDigits| Train Loss: 1.6860 | Train Acc: 0.5085
 Site-MNIST-M   | Train Loss: 2.2028 | Train Acc: 0.2292
============ Train epoch 14 ============
============ Train epoch 15 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.0480 | Train Acc: 0.7692
 Site-MNIST     | Train Loss: 0.8910 | Train Acc: 0.7925
 Site-MNIST     | Train Loss: 0.7377 | Train Acc: 0.8375
 Site-MNIST     | Train Loss: 0.7353 | Train Acc: 0.9151
 Site-SVHN      | Train Loss: 1.8633 | Train Acc: 0.3269
 Site-SVHN      | Train Loss: 1.6644 | Train Acc: 0.4135
 Site-SVHN      | Train Loss: 1.4644 | Train Acc: 0.5641
 Site-USPS      | Train Loss: 1.0697 | Train Acc: 0.7455
 Site-SynthDigits| Train Loss: 1.5871 | Train Acc: 0.4746
 Site-MNIST-M   | Train Loss: 2.0892 | Train Acc: 0.2500
============ Train epoch 16 ============
============ Train epoch 17 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.9693 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.6542 | Train Acc: 0.8868
 Site-MNIST     | Train Loss: 0.6087 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.5971 | Train Acc: 0.9151
 Site-SVHN      | Train Loss: 1.9067 | Train Acc: 0.3846
 Site-SVHN      | Train Loss: 1.5410 | Train Acc: 0.4615
 Site-SVHN      | Train Loss: 1.2847 | Train Acc: 0.6538
 Site-USPS      | Train Loss: 0.9429 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.4303 | Train Acc: 0.5932
 Site-MNIST-M   | Train Loss: 1.9802 | Train Acc: 0.2292
 Site-MNIST     | Val  Loss: 1.3800 | Val  Acc: 0.8235
 Site-MNIST     | Val  Loss: 0.7594 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.6130 | Val  Acc: 0.9434
 Site-MNIST     | Val  Loss: 0.6988 | Val  Acc: 0.8592
 Site-SVHN      | Val  Loss: 1.0850 | Val  Acc: 0.5882
 Site-SVHN      | Val  Loss: 1.3792 | Val  Acc: 0.5652
 Site-SVHN      | Val  Loss: 1.4197 | Val  Acc: 0.5769
 Site-USPS      | Val  Loss: 0.7576 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 1.7751 | Val  Acc: 0.4872
 Site-MNIST-M   | Val  Loss: 2.0996 | Val  Acc: 0.1875
Average Valid Accuracy: 0.6645
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8235
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9434
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8592
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5882
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5652
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5769
 Best site-USPS       | Epoch:8 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4872
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.1875
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.8383 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.5703 | Train Acc: 0.9057
 Site-MNIST     | Train Loss: 0.5084 | Train Acc: 0.9250
 Site-MNIST     | Train Loss: 0.4862 | Train Acc: 0.9340
 Site-SVHN      | Train Loss: 1.7615 | Train Acc: 0.3654
 Site-SVHN      | Train Loss: 1.4202 | Train Acc: 0.5481
 Site-SVHN      | Train Loss: 1.1190 | Train Acc: 0.6923
 Site-USPS      | Train Loss: 0.8611 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.3739 | Train Acc: 0.5593
 Site-MNIST-M   | Train Loss: 2.0531 | Train Acc: 0.2292
============ Train epoch 20 ============
============ Train epoch 21 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7381 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.6153 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.4203 | Train Acc: 0.9250
 Site-MNIST     | Train Loss: 0.3962 | Train Acc: 0.9434
 Site-SVHN      | Train Loss: 1.7482 | Train Acc: 0.4038
 Site-SVHN      | Train Loss: 1.3274 | Train Acc: 0.5769
 Site-SVHN      | Train Loss: 0.9754 | Train Acc: 0.7821
 Site-USPS      | Train Loss: 0.7135 | Train Acc: 0.7455
 Site-SynthDigits| Train Loss: 1.2174 | Train Acc: 0.5932
 Site-MNIST-M   | Train Loss: 1.9335 | Train Acc: 0.2708
============ Train epoch 22 ============
============ Train epoch 23 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6157 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.4022 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.3416 | Train Acc: 0.9375
 Site-MNIST     | Train Loss: 0.3077 | Train Acc: 0.9717
 Site-SVHN      | Train Loss: 1.7188 | Train Acc: 0.4615
 Site-SVHN      | Train Loss: 1.2149 | Train Acc: 0.6058
 Site-SVHN      | Train Loss: 0.8794 | Train Acc: 0.8141
 Site-USPS      | Train Loss: 0.6622 | Train Acc: 0.7636
 Site-SynthDigits| Train Loss: 1.1197 | Train Acc: 0.6610
 Site-MNIST-M   | Train Loss: 1.8471 | Train Acc: 0.3125
============ Train epoch 24 ============
============ Train epoch 25 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6055 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.3182 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.2945 | Train Acc: 0.9625
 Site-MNIST     | Train Loss: 0.2613 | Train Acc: 0.9906
 Site-SVHN      | Train Loss: 1.5959 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.0617 | Train Acc: 0.6923
 Site-SVHN      | Train Loss: 0.6871 | Train Acc: 0.8718
 Site-USPS      | Train Loss: 0.5503 | Train Acc: 0.8000
 Site-SynthDigits| Train Loss: 1.1158 | Train Acc: 0.6271
 Site-MNIST-M   | Train Loss: 1.8625 | Train Acc: 0.2917
 Site-MNIST     | Val  Loss: 1.0262 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.4068 | Val  Acc: 0.9714
 Site-MNIST     | Val  Loss: 0.2534 | Val  Acc: 0.9811
 Site-MNIST     | Val  Loss: 0.3649 | Val  Acc: 0.9437
 Site-SVHN      | Val  Loss: 0.6134 | Val  Acc: 0.7647
 Site-SVHN      | Val  Loss: 0.7810 | Val  Acc: 0.8116
 Site-SVHN      | Val  Loss: 0.8258 | Val  Acc: 0.8077
 Site-USPS      | Val  Loss: 0.4656 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.6745 | Val  Acc: 0.5128
 Site-MNIST-M   | Val  Loss: 2.0521 | Val  Acc: 0.2188
Average Valid Accuracy: 0.7791
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9714
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9811
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9437
 Best site-SVHN       | Epoch:12 | Val Acc: 0.7647
 Best site-SVHN       | Epoch:12 | Val Acc: 0.8116
 Best site-SVHN       | Epoch:12 | Val Acc: 0.8077
 Best site-USPS       | Epoch:12 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5128
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.2188
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 26 ============
============ Train epoch 27 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.5057 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.2981 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.2565 | Train Acc: 0.9750
 Site-MNIST     | Train Loss: 0.2189 | Train Acc: 0.9811
 Site-SVHN      | Train Loss: 1.3851 | Train Acc: 0.5769
 Site-SVHN      | Train Loss: 0.8981 | Train Acc: 0.7212
 Site-SVHN      | Train Loss: 0.6312 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.5429 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.0000 | Train Acc: 0.6441
 Site-MNIST-M   | Train Loss: 1.7859 | Train Acc: 0.3333
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.5741 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.2305 | Train Acc: 0.9434
 Site-MNIST     | Train Loss: 0.2370 | Train Acc: 0.9625
 Site-MNIST     | Train Loss: 0.2020 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4340 | Train Acc: 0.5577
 Site-SVHN      | Train Loss: 0.8387 | Train Acc: 0.7404
 Site-SVHN      | Train Loss: 0.5140 | Train Acc: 0.9103
 Site-USPS      | Train Loss: 0.5226 | Train Acc: 0.8364
 Site-SynthDigits| Train Loss: 0.9133 | Train Acc: 0.7288
 Site-MNIST-M   | Train Loss: 1.6666 | Train Acc: 0.3125
============ Train epoch 30 ============
============ Train epoch 31 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4442 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.1837 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.1686 | Train Acc: 0.9875
 Site-MNIST     | Train Loss: 0.1342 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5460 | Train Acc: 0.5385
 Site-SVHN      | Train Loss: 0.7583 | Train Acc: 0.7981
 Site-SVHN      | Train Loss: 0.4926 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.4953 | Train Acc: 0.8545
 Site-SynthDigits| Train Loss: 0.9647 | Train Acc: 0.6610
 Site-MNIST-M   | Train Loss: 1.6337 | Train Acc: 0.4167
============ Train epoch 32 ============
============ Train epoch 33 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4978 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.1820 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.1493 | Train Acc: 0.9625
 Site-MNIST     | Train Loss: 0.1096 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1411 | Train Acc: 0.6154
 Site-SVHN      | Train Loss: 0.6748 | Train Acc: 0.7788
 Site-SVHN      | Train Loss: 0.3875 | Train Acc: 0.9487
 Site-USPS      | Train Loss: 0.4077 | Train Acc: 0.8545
 Site-SynthDigits| Train Loss: 0.7936 | Train Acc: 0.7627
 Site-MNIST-M   | Train Loss: 1.4921 | Train Acc: 0.4375
 Site-MNIST     | Val  Loss: 0.5076 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1871 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1105 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1897 | Val  Acc: 0.9437
 Site-SVHN      | Val  Loss: 0.3395 | Val  Acc: 0.8824
 Site-SVHN      | Val  Loss: 0.4139 | Val  Acc: 0.9275
 Site-SVHN      | Val  Loss: 0.4773 | Val  Acc: 0.8942
 Site-USPS      | Val  Loss: 0.3625 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.6236 | Val  Acc: 0.5641
 Site-MNIST-M   | Val  Loss: 2.0149 | Val  Acc: 0.3438
Average Valid Accuracy: 0.8448
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9437
 Best site-SVHN       | Epoch:16 | Val Acc: 0.8824
 Best site-SVHN       | Epoch:16 | Val Acc: 0.9275
 Best site-SVHN       | Epoch:16 | Val Acc: 0.8942
 Best site-USPS       | Epoch:16 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.5641
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.3438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 34 ============
============ Train epoch 35 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4020 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.1398 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.1240 | Train Acc: 0.9750
 Site-MNIST     | Train Loss: 0.0942 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0723 | Train Acc: 0.6154
 Site-SVHN      | Train Loss: 0.5680 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 0.2914 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.3772 | Train Acc: 0.8727
 Site-SynthDigits| Train Loss: 0.7020 | Train Acc: 0.7797
 Site-MNIST-M   | Train Loss: 1.3455 | Train Acc: 0.5000
============ Train epoch 36 ============
============ Train epoch 37 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4052 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.1208 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.1067 | Train Acc: 0.9750
 Site-MNIST     | Train Loss: 0.0713 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9258 | Train Acc: 0.6538
 Site-SVHN      | Train Loss: 0.4510 | Train Acc: 0.9135
 Site-SVHN      | Train Loss: 0.2404 | Train Acc: 0.9808
 Site-USPS      | Train Loss: 0.3466 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.7088 | Train Acc: 0.7797
 Site-MNIST-M   | Train Loss: 1.3448 | Train Acc: 0.5208
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.2636 | Train Acc: 0.8846
 Site-MNIST     | Train Loss: 0.0942 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0806 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0682 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0894 | Train Acc: 0.6154
 Site-SVHN      | Train Loss: 0.4311 | Train Acc: 0.9327
 Site-SVHN      | Train Loss: 0.2001 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.2804 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.6418 | Train Acc: 0.8136
 Site-MNIST-M   | Train Loss: 1.1698 | Train Acc: 0.5417
============ Train epoch 40 ============
============ Train epoch 41 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.2907 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.0823 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0699 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0648 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9140 | Train Acc: 0.6731
 Site-SVHN      | Train Loss: 0.3326 | Train Acc: 0.9519
 Site-SVHN      | Train Loss: 0.1556 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.2813 | Train Acc: 0.9455
 Site-SynthDigits| Train Loss: 0.6098 | Train Acc: 0.7966
 Site-MNIST-M   | Train Loss: 1.1452 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.2091 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0865 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0532 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0932 | Val  Acc: 0.9859
 Site-SVHN      | Val  Loss: 0.1274 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1618 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2211 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2991 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.5740 | Val  Acc: 0.5385
 Site-MNIST-M   | Val  Loss: 1.9729 | Val  Acc: 0.3438
Average Valid Accuracy: 0.8760
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9859
 Best site-SVHN       | Epoch:20 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:20 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:20 | Val Acc: 1.0000
 Best site-USPS       | Epoch:20 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.5385
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.3438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 42 ============
============ Train epoch 43 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.2739 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0633 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0597 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0454 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.8257 | Train Acc: 0.6731
 Site-SVHN      | Train Loss: 0.3183 | Train Acc: 0.9423
 Site-SVHN      | Train Loss: 0.1683 | Train Acc: 0.9936
 Site-USPS      | Train Loss: 0.2169 | Train Acc: 0.9636
 Site-SynthDigits| Train Loss: 0.5535 | Train Acc: 0.7966
 Site-MNIST-M   | Train Loss: 0.9840 | Train Acc: 0.6458
============ Train epoch 44 ============
============ Train epoch 45 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.3119 | Train Acc: 0.8846
 Site-MNIST     | Train Loss: 0.1021 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0641 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0508 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.8454 | Train Acc: 0.7308
 Site-SVHN      | Train Loss: 0.3329 | Train Acc: 0.9231
 Site-SVHN      | Train Loss: 0.1370 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1869 | Train Acc: 0.9636
 Site-SynthDigits| Train Loss: 0.4802 | Train Acc: 0.8814
 Site-MNIST-M   | Train Loss: 0.8638 | Train Acc: 0.6875
============ Train epoch 46 ============
============ Train epoch 47 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.1975 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0674 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0467 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0353 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7254 | Train Acc: 0.7885
 Site-SVHN      | Train Loss: 0.2542 | Train Acc: 0.9615
 Site-SVHN      | Train Loss: 0.1220 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.2139 | Train Acc: 0.9455
 Site-SynthDigits| Train Loss: 0.4385 | Train Acc: 0.8814
 Site-MNIST-M   | Train Loss: 0.8104 | Train Acc: 0.7500
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.2422 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0506 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0480 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0392 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.8499 | Train Acc: 0.7692
 Site-SVHN      | Train Loss: 0.2202 | Train Acc: 0.9904
 Site-SVHN      | Train Loss: 0.0976 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1523 | Train Acc: 0.9818
 Site-SynthDigits| Train Loss: 0.4418 | Train Acc: 0.8475
 Site-MNIST-M   | Train Loss: 0.7851 | Train Acc: 0.7292
 Site-MNIST     | Val  Loss: 0.1758 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0650 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0356 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0655 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0799 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1015 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1385 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2502 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.5415 | Val  Acc: 0.5641
 Site-MNIST-M   | Val  Loss: 1.9485 | Val  Acc: 0.3438
Average Valid Accuracy: 0.8827
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:24 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:24 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:24 | Val Acc: 1.0000
 Best site-USPS       | Epoch:24 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.5641
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.3438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 50 ============
============ Train epoch 51 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.1852 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0473 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0362 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0303 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5828 | Train Acc: 0.8846
 Site-SVHN      | Train Loss: 0.1923 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1023 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1327 | Train Acc: 0.9818
 Site-SynthDigits| Train Loss: 0.4020 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 0.7409 | Train Acc: 0.8542
============ Train epoch 52 ============
============ Train epoch 53 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.2435 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0408 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0325 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0238 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6214 | Train Acc: 0.7885
 Site-SVHN      | Train Loss: 0.1824 | Train Acc: 0.9808
 Site-SVHN      | Train Loss: 0.0724 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1358 | Train Acc: 0.9818
 Site-SynthDigits| Train Loss: 0.3790 | Train Acc: 0.8983
 Site-MNIST-M   | Train Loss: 0.7648 | Train Acc: 0.7500
============ Train epoch 54 ============
============ Train epoch 55 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.1783 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0447 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0304 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0213 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5528 | Train Acc: 0.8846
 Site-SVHN      | Train Loss: 0.1523 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0716 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1115 | Train Acc: 0.9818
 Site-SynthDigits| Train Loss: 0.2769 | Train Acc: 0.9831
 Site-MNIST-M   | Train Loss: 0.5900 | Train Acc: 0.8958
============ Train epoch 56 ============
============ Train epoch 57 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.1882 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0279 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0233 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4578 | Train Acc: 0.8462
 Site-SVHN      | Train Loss: 0.1378 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0508 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1092 | Train Acc: 0.9818
 Site-SynthDigits| Train Loss: 0.2591 | Train Acc: 0.9831
 Site-MNIST-M   | Train Loss: 0.5058 | Train Acc: 0.9167
 Site-MNIST     | Val  Loss: 0.1004 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0384 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0373 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0419 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0529 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0811 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2458 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.5918 | Val  Acc: 0.5385
 Site-MNIST-M   | Val  Loss: 1.8959 | Val  Acc: 0.3750
Average Valid Accuracy: 0.8832
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:28 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:28 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:28 | Val Acc: 1.0000
 Best site-USPS       | Epoch:28 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.5385
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 58 ============
============ Train epoch 59 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.1541 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0301 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0244 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0187 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.3929 | Train Acc: 0.9231
 Site-SVHN      | Train Loss: 0.1192 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0695 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0860 | Train Acc: 0.9818
 Site-SynthDigits| Train Loss: 0.2454 | Train Acc: 0.9831
 Site-MNIST-M   | Train Loss: 0.4600 | Train Acc: 0.9167
 Site-MNIST     | Val  Loss: 0.0592 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0256 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0178 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0647 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0780 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0849 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2453 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.4531 | Val  Acc: 0.6154
 Site-MNIST-M   | Val  Loss: 1.9050 | Val  Acc: 0.3125
Average Valid Accuracy: 0.8847
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:29 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:29 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:29 | Val Acc: 1.0000
 Best site-USPS       | Epoch:29 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.6154
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.3125
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.8743
 Test site-SVHN      | Epoch:29 | Test Acc: 0.3496
 Test site-USPS      | Epoch:29 | Test Acc: 0.8871
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.5253
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.3107
Average Test Accuracy: 0.5894
===2023-04-07 02:11:39===

===2023-04-07 11:20:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[26,53,80,106,52,104,156,55,59,48,]
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
client-0 is in G-4
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(3,)(0,)(5,)]
 Site-MNIST     | Train Loss: 2.2210 | Train Acc: 0.2308
 Site-MNIST     | Train Loss: 2.1539 | Train Acc: 0.3774
 Site-MNIST     | Train Loss: 2.0779 | Train Acc: 0.3500
 Site-MNIST     | Train Loss: 2.0706 | Train Acc: 0.3585
 Site-SVHN      | Train Loss: 2.1894 | Train Acc: 0.2115
 Site-SVHN      | Train Loss: 2.2361 | Train Acc: 0.1923
 Site-SVHN      | Train Loss: 2.2145 | Train Acc: 0.1987
 Site-USPS      | Train Loss: 2.1080 | Train Acc: 0.2182
 Site-SynthDigits| Train Loss: 2.2938 | Train Acc: 0.1525
 Site-MNIST-M   | Train Loss: 2.3036 | Train Acc: 0.1875
============ Train epoch 2 ============
===2023-04-07 11:22:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[26,53,80,106,52,104,156,55,59,48,]
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
client-0 is in G-4
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(3,)(0,)(5,)]
 Site-MNIST     | Train Loss: 2.2210 | Train Acc: 0.2308
 Site-MNIST     | Train Loss: 2.1539 | Train Acc: 0.3774
 Site-MNIST     | Train Loss: 2.0779 | Train Acc: 0.3500
 Site-MNIST     | Train Loss: 2.0706 | Train Acc: 0.3585
 Site-SVHN      | Train Loss: 2.1894 | Train Acc: 0.2115
 Site-SVHN      | Train Loss: 2.2361 | Train Acc: 0.1923
 Site-SVHN      | Train Loss: 2.2145 | Train Acc: 0.1987
 Site-USPS      | Train Loss: 2.1080 | Train Acc: 0.2182
 Site-SynthDigits| Train Loss: 2.2938 | Train Acc: 0.1525
 Site-MNIST-M   | Train Loss: 2.3036 | Train Acc: 0.1875
============ Train epoch 2 ============
============ Train epoch 3 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 2.0740 | Train Acc: 0.3077
 Site-MNIST     | Train Loss: 1.9049 | Train Acc: 0.4151
 Site-MNIST     | Train Loss: 1.8948 | Train Acc: 0.4625
 Site-MNIST     | Train Loss: 1.8894 | Train Acc: 0.4245
 Site-SVHN      | Train Loss: 2.1965 | Train Acc: 0.2308
 Site-SVHN      | Train Loss: 2.1781 | Train Acc: 0.2404
 Site-SVHN      | Train Loss: 2.1243 | Train Acc: 0.2756
 Site-USPS      | Train Loss: 1.9906 | Train Acc: 0.2545
 Site-SynthDigits| Train Loss: 2.2169 | Train Acc: 0.1864
 Site-MNIST-M   | Train Loss: 2.2791 | Train Acc: 0.1667
 Site-MNIST     | Val  Loss: 2.0643 | Val  Acc: 0.3529
 Site-MNIST     | Val  Loss: 1.9454 | Val  Acc: 0.3714
 Site-MNIST     | Val  Loss: 1.9694 | Val  Acc: 0.3962
 Site-MNIST     | Val  Loss: 1.9208 | Val  Acc: 0.4648
 Site-SVHN      | Val  Loss: 1.9159 | Val  Acc: 0.2941
 Site-SVHN      | Val  Loss: 2.1534 | Val  Acc: 0.1884
 Site-SVHN      | Val  Loss: 2.1862 | Val  Acc: 0.2115
 Site-USPS      | Val  Loss: 1.6904 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.2462 | Val  Acc: 0.1795
 Site-MNIST-M   | Val  Loss: 2.3277 | Val  Acc: 0.2500
Average Valid Accuracy: 0.3168
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3529
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3714
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3962
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4648
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2941
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1884
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2115
 Best site-USPS       | Epoch:1 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1795
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 4 ============
============ Train epoch 5 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 1.9089 | Train Acc: 0.3077
 Site-MNIST     | Train Loss: 1.6633 | Train Acc: 0.5660
 Site-MNIST     | Train Loss: 1.7017 | Train Acc: 0.5750
 Site-MNIST     | Train Loss: 1.6882 | Train Acc: 0.5377
 Site-SVHN      | Train Loss: 2.1657 | Train Acc: 0.2308
 Site-SVHN      | Train Loss: 2.1313 | Train Acc: 0.2692
 Site-SVHN      | Train Loss: 2.0431 | Train Acc: 0.2949
 Site-USPS      | Train Loss: 1.7817 | Train Acc: 0.4000
 Site-SynthDigits| Train Loss: 2.1342 | Train Acc: 0.2203
 Site-MNIST-M   | Train Loss: 2.2412 | Train Acc: 0.1875
============ Train epoch 6 ============
============ Train epoch 7 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 1.7478 | Train Acc: 0.4615
 Site-MNIST     | Train Loss: 1.5179 | Train Acc: 0.6792
 Site-MNIST     | Train Loss: 1.4586 | Train Acc: 0.6750
 Site-MNIST     | Train Loss: 1.4683 | Train Acc: 0.6698
 Site-SVHN      | Train Loss: 2.0797 | Train Acc: 0.2115
 Site-SVHN      | Train Loss: 2.0581 | Train Acc: 0.2788
 Site-SVHN      | Train Loss: 1.9720 | Train Acc: 0.2885
 Site-USPS      | Train Loss: 1.6810 | Train Acc: 0.4727
 Site-SynthDigits| Train Loss: 2.0508 | Train Acc: 0.2542
 Site-MNIST-M   | Train Loss: 2.2236 | Train Acc: 0.1875
 Site-MNIST     | Val  Loss: 1.7989 | Val  Acc: 0.6471
 Site-MNIST     | Val  Loss: 1.5676 | Val  Acc: 0.6286
 Site-MNIST     | Val  Loss: 1.5477 | Val  Acc: 0.6038
 Site-MNIST     | Val  Loss: 1.5031 | Val  Acc: 0.6901
 Site-SVHN      | Val  Loss: 1.6361 | Val  Acc: 0.2647
 Site-SVHN      | Val  Loss: 1.9988 | Val  Acc: 0.2029
 Site-SVHN      | Val  Loss: 2.0590 | Val  Acc: 0.2596
 Site-USPS      | Val  Loss: 1.4198 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 2.1972 | Val  Acc: 0.2564
 Site-MNIST-M   | Val  Loss: 2.2781 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4452
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6471
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6286
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6038
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6901
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2647
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2029
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2596
 Best site-USPS       | Epoch:3 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2564
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 1.5669 | Train Acc: 0.5769
 Site-MNIST     | Train Loss: 1.4257 | Train Acc: 0.6792
 Site-MNIST     | Train Loss: 1.2014 | Train Acc: 0.6875
 Site-MNIST     | Train Loss: 1.2029 | Train Acc: 0.7642
 Site-SVHN      | Train Loss: 2.0720 | Train Acc: 0.2692
 Site-SVHN      | Train Loss: 1.9133 | Train Acc: 0.2981
 Site-SVHN      | Train Loss: 1.8642 | Train Acc: 0.3910
 Site-USPS      | Train Loss: 1.4861 | Train Acc: 0.6545
 Site-SynthDigits| Train Loss: 1.9444 | Train Acc: 0.3220
 Site-MNIST-M   | Train Loss: 2.2207 | Train Acc: 0.1667
============ Train epoch 10 ============
============ Train epoch 11 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
clients=[(1,)(1,)(4,)(1,)(3,)]
 Site-MNIST     | Train Loss: 1.3801 | Train Acc: 0.6538
 Site-MNIST     | Train Loss: 1.1854 | Train Acc: 0.7736
 Site-MNIST     | Train Loss: 1.0328 | Train Acc: 0.8000
 Site-MNIST     | Train Loss: 1.0182 | Train Acc: 0.8585
 Site-SVHN      | Train Loss: 2.0302 | Train Acc: 0.3077
 Site-SVHN      | Train Loss: 1.8322 | Train Acc: 0.3462
 Site-SVHN      | Train Loss: 1.7136 | Train Acc: 0.4679
 Site-USPS      | Train Loss: 1.3114 | Train Acc: 0.7091
 Site-SynthDigits| Train Loss: 1.8093 | Train Acc: 0.4237
 Site-MNIST-M   | Train Loss: 2.1340 | Train Acc: 0.1875
 Site-MNIST     | Val  Loss: 1.6389 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 1.1765 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.0666 | Val  Acc: 0.8302
 Site-MNIST     | Val  Loss: 1.1027 | Val  Acc: 0.7606
 Site-SVHN      | Val  Loss: 1.3357 | Val  Acc: 0.5588
 Site-SVHN      | Val  Loss: 1.7672 | Val  Acc: 0.3913
 Site-SVHN      | Val  Loss: 1.8412 | Val  Acc: 0.3462
 Site-USPS      | Val  Loss: 1.0694 | Val  Acc: 0.7297
 Site-SynthDigits| Val  Loss: 2.0302 | Val  Acc: 0.4615
 Site-MNIST-M   | Val  Loss: 2.2096 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6068
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8302
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7606
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5588
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3913
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3462
 Best site-USPS       | Epoch:5 | Val Acc: 0.7297
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4615
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 12 ============
============ Train epoch 13 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.1863 | Train Acc: 0.6923
 Site-MNIST     | Train Loss: 0.9514 | Train Acc: 0.7547
 Site-MNIST     | Train Loss: 0.8638 | Train Acc: 0.8250
 Site-MNIST     | Train Loss: 0.8478 | Train Acc: 0.8491
 Site-SVHN      | Train Loss: 1.9733 | Train Acc: 0.3462
 Site-SVHN      | Train Loss: 1.7015 | Train Acc: 0.4231
 Site-SVHN      | Train Loss: 1.6401 | Train Acc: 0.5064
 Site-USPS      | Train Loss: 1.1262 | Train Acc: 0.7091
 Site-SynthDigits| Train Loss: 1.7007 | Train Acc: 0.4576
 Site-MNIST-M   | Train Loss: 2.2618 | Train Acc: 0.2292
============ Train epoch 14 ============
============ Train epoch 15 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.0741 | Train Acc: 0.7692
 Site-MNIST     | Train Loss: 0.7678 | Train Acc: 0.8491
 Site-MNIST     | Train Loss: 0.7544 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.7199 | Train Acc: 0.8774
 Site-SVHN      | Train Loss: 1.9247 | Train Acc: 0.3077
 Site-SVHN      | Train Loss: 1.6870 | Train Acc: 0.4231
 Site-SVHN      | Train Loss: 1.4557 | Train Acc: 0.5705
 Site-USPS      | Train Loss: 1.0948 | Train Acc: 0.7818
 Site-SynthDigits| Train Loss: 1.5944 | Train Acc: 0.4237
 Site-MNIST-M   | Train Loss: 2.0875 | Train Acc: 0.2292
 Site-MNIST     | Val  Loss: 1.4744 | Val  Acc: 0.8235
 Site-MNIST     | Val  Loss: 0.8973 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7831 | Val  Acc: 0.9245
 Site-MNIST     | Val  Loss: 0.8375 | Val  Acc: 0.8451
 Site-SVHN      | Val  Loss: 1.1807 | Val  Acc: 0.5882
 Site-SVHN      | Val  Loss: 1.5525 | Val  Acc: 0.5072
 Site-SVHN      | Val  Loss: 1.5913 | Val  Acc: 0.4712
 Site-USPS      | Val  Loss: 0.8538 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 1.8839 | Val  Acc: 0.4615
 Site-MNIST-M   | Val  Loss: 2.1388 | Val  Acc: 0.2812
Average Valid Accuracy: 0.6516
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8235
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9245
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8451
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5882
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5072
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4712
 Best site-USPS       | Epoch:7 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4615
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2812
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 16 ============
============ Train epoch 17 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.9595 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.7666 | Train Acc: 0.8868
 Site-MNIST     | Train Loss: 0.5997 | Train Acc: 0.8875
 Site-MNIST     | Train Loss: 0.5746 | Train Acc: 0.9151
 Site-SVHN      | Train Loss: 1.8583 | Train Acc: 0.3077
 Site-SVHN      | Train Loss: 1.5535 | Train Acc: 0.4904
 Site-SVHN      | Train Loss: 1.3396 | Train Acc: 0.6154
 Site-USPS      | Train Loss: 0.8875 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.5406 | Train Acc: 0.5085
 Site-MNIST-M   | Train Loss: 2.0985 | Train Acc: 0.2292
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.8493 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.5441 | Train Acc: 0.8868
 Site-MNIST     | Train Loss: 0.5166 | Train Acc: 0.9125
 Site-MNIST     | Train Loss: 0.4821 | Train Acc: 0.9245
 Site-SVHN      | Train Loss: 1.7769 | Train Acc: 0.3654
 Site-SVHN      | Train Loss: 1.4247 | Train Acc: 0.5096
 Site-SVHN      | Train Loss: 1.1965 | Train Acc: 0.6603
 Site-USPS      | Train Loss: 0.7696 | Train Acc: 0.7636
 Site-SynthDigits| Train Loss: 1.4834 | Train Acc: 0.4915
 Site-MNIST-M   | Train Loss: 2.0971 | Train Acc: 0.2708
 Site-MNIST     | Val  Loss: 1.2872 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.6267 | Val  Acc: 0.8857
 Site-MNIST     | Val  Loss: 0.5006 | Val  Acc: 0.9434
 Site-MNIST     | Val  Loss: 0.6115 | Val  Acc: 0.8732
 Site-SVHN      | Val  Loss: 0.9521 | Val  Acc: 0.6471
 Site-SVHN      | Val  Loss: 1.2805 | Val  Acc: 0.5942
 Site-SVHN      | Val  Loss: 1.3236 | Val  Acc: 0.5769
 Site-USPS      | Val  Loss: 0.6931 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 1.8969 | Val  Acc: 0.4359
 Site-MNIST-M   | Val  Loss: 2.1082 | Val  Acc: 0.2188
Average Valid Accuracy: 0.6841
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8857
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9434
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8732
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6471
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5942
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5769
 Best site-USPS       | Epoch:9 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4359
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.2188
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.7707
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2756
 Test site-USPS      | Epoch:9 | Test Acc: 0.7903
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.3865
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2357
Average Test Accuracy: 0.4918
============ Train epoch 20 ============
============ Train epoch 21 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7210 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.5037 | Train Acc: 0.8868
 Site-MNIST     | Train Loss: 0.4427 | Train Acc: 0.9125
 Site-MNIST     | Train Loss: 0.4126 | Train Acc: 0.9340
 Site-SVHN      | Train Loss: 1.9142 | Train Acc: 0.4231
 Site-SVHN      | Train Loss: 1.3696 | Train Acc: 0.5769
 Site-SVHN      | Train Loss: 1.1413 | Train Acc: 0.7179
 Site-USPS      | Train Loss: 0.7270 | Train Acc: 0.7455
 Site-SynthDigits| Train Loss: 1.3017 | Train Acc: 0.6102
 Site-MNIST-M   | Train Loss: 1.8785 | Train Acc: 0.3125
============ Train epoch 22 ============
============ Train epoch 23 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7477 | Train Acc: 0.7692
 Site-MNIST     | Train Loss: 0.4798 | Train Acc: 0.9057
 Site-MNIST     | Train Loss: 0.3987 | Train Acc: 0.9250
 Site-MNIST     | Train Loss: 0.3910 | Train Acc: 0.9528
 Site-SVHN      | Train Loss: 1.5742 | Train Acc: 0.4615
 Site-SVHN      | Train Loss: 1.2110 | Train Acc: 0.5962
 Site-SVHN      | Train Loss: 0.9090 | Train Acc: 0.7949
 Site-USPS      | Train Loss: 0.6829 | Train Acc: 0.7636
 Site-SynthDigits| Train Loss: 1.1848 | Train Acc: 0.5932
 Site-MNIST-M   | Train Loss: 1.9251 | Train Acc: 0.3125
 Site-MNIST     | Val  Loss: 1.1944 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.5271 | Val  Acc: 0.9143
 Site-MNIST     | Val  Loss: 0.3653 | Val  Acc: 0.9623
 Site-MNIST     | Val  Loss: 0.4983 | Val  Acc: 0.9014
 Site-SVHN      | Val  Loss: 0.7818 | Val  Acc: 0.7059
 Site-SVHN      | Val  Loss: 0.9927 | Val  Acc: 0.7536
 Site-SVHN      | Val  Loss: 1.0522 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.5294 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.7603 | Val  Acc: 0.4872
 Site-MNIST-M   | Val  Loss: 2.0242 | Val  Acc: 0.3125
Average Valid Accuracy: 0.7507
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9143
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9623
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9014
 Best site-SVHN       | Epoch:11 | Val Acc: 0.7059
 Best site-SVHN       | Epoch:11 | Val Acc: 0.7536
 Best site-SVHN       | Epoch:11 | Val Acc: 0.7500
 Best site-USPS       | Epoch:11 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.4872
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.3125
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 24 ============
============ Train epoch 25 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.5544 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.3571 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.2994 | Train Acc: 0.9625
 Site-MNIST     | Train Loss: 0.2663 | Train Acc: 0.9717
 Site-SVHN      | Train Loss: 1.6896 | Train Acc: 0.4615
 Site-SVHN      | Train Loss: 1.0599 | Train Acc: 0.6442
 Site-SVHN      | Train Loss: 0.8331 | Train Acc: 0.8141
 Site-USPS      | Train Loss: 0.5973 | Train Acc: 0.8000
 Site-SynthDigits| Train Loss: 1.1069 | Train Acc: 0.6441
 Site-MNIST-M   | Train Loss: 1.8354 | Train Acc: 0.3542
============ Train epoch 26 ============
============ Train epoch 27 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.5252 | Train Acc: 0.8077
 Site-MNIST     | Train Loss: 0.3393 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.2704 | Train Acc: 0.9500
 Site-MNIST     | Train Loss: 0.2359 | Train Acc: 0.9811
 Site-SVHN      | Train Loss: 1.4144 | Train Acc: 0.4615
 Site-SVHN      | Train Loss: 1.0221 | Train Acc: 0.7115
 Site-SVHN      | Train Loss: 0.6949 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.6004 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.0784 | Train Acc: 0.5932
 Site-MNIST-M   | Train Loss: 1.8495 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.8931 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.3693 | Val  Acc: 0.9429
 Site-MNIST     | Val  Loss: 0.2359 | Val  Acc: 0.9811
 Site-MNIST     | Val  Loss: 0.3384 | Val  Acc: 0.9296
 Site-SVHN      | Val  Loss: 0.5856 | Val  Acc: 0.7353
 Site-SVHN      | Val  Loss: 0.7763 | Val  Acc: 0.8116
 Site-SVHN      | Val  Loss: 0.8510 | Val  Acc: 0.7981
 Site-USPS      | Val  Loss: 0.4874 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.6524 | Val  Acc: 0.5128
 Site-MNIST-M   | Val  Loss: 1.9703 | Val  Acc: 0.3125
Average Valid Accuracy: 0.7803
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9429
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9811
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9296
 Best site-SVHN       | Epoch:13 | Val Acc: 0.7353
 Best site-SVHN       | Epoch:13 | Val Acc: 0.8116
 Best site-SVHN       | Epoch:13 | Val Acc: 0.7981
 Best site-USPS       | Epoch:13 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5128
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3125
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4710 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.2175 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.2063 | Train Acc: 0.9750
 Site-MNIST     | Train Loss: 0.1761 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4184 | Train Acc: 0.4615
 Site-SVHN      | Train Loss: 0.9047 | Train Acc: 0.7692
 Site-SVHN      | Train Loss: 0.6117 | Train Acc: 0.8974
 Site-USPS      | Train Loss: 0.4391 | Train Acc: 0.8545
 Site-SynthDigits| Train Loss: 0.9347 | Train Acc: 0.6610
 Site-MNIST-M   | Train Loss: 1.7266 | Train Acc: 0.3958
============ Train epoch 30 ============
============ Train epoch 31 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4707 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.2601 | Train Acc: 0.9245
 Site-MNIST     | Train Loss: 0.1815 | Train Acc: 0.9875
 Site-MNIST     | Train Loss: 0.1531 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2312 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 0.8088 | Train Acc: 0.7885
 Site-SVHN      | Train Loss: 0.4525 | Train Acc: 0.9487
 Site-USPS      | Train Loss: 0.4544 | Train Acc: 0.8364
 Site-SynthDigits| Train Loss: 0.8866 | Train Acc: 0.7458
 Site-MNIST-M   | Train Loss: 1.6868 | Train Acc: 0.4375
 Site-MNIST     | Val  Loss: 0.6019 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2416 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1493 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2306 | Val  Acc: 0.9718
 Site-SVHN      | Val  Loss: 0.4075 | Val  Acc: 0.8824
 Site-SVHN      | Val  Loss: 0.5304 | Val  Acc: 0.9130
 Site-SVHN      | Val  Loss: 0.6207 | Val  Acc: 0.8654
 Site-USPS      | Val  Loss: 0.3780 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.6596 | Val  Acc: 0.5385
 Site-MNIST-M   | Val  Loss: 1.9606 | Val  Acc: 0.3438
Average Valid Accuracy: 0.8353
 Best site-MNIST      | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9718
 Best site-SVHN       | Epoch:15 | Val Acc: 0.8824
 Best site-SVHN       | Epoch:15 | Val Acc: 0.9130
 Best site-SVHN       | Epoch:15 | Val Acc: 0.8654
 Best site-USPS       | Epoch:15 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5385
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.3438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 32 ============
============ Train epoch 33 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4183 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.1809 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.1573 | Train Acc: 0.9875
 Site-MNIST     | Train Loss: 0.1120 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1575 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 0.6518 | Train Acc: 0.8462
 Site-SVHN      | Train Loss: 0.4197 | Train Acc: 0.9551
 Site-USPS      | Train Loss: 0.4074 | Train Acc: 0.8727
 Site-SynthDigits| Train Loss: 0.8184 | Train Acc: 0.7627
 Site-MNIST-M   | Train Loss: 1.6375 | Train Acc: 0.4167
============ Train epoch 34 ============
============ Train epoch 35 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4133 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.1205 | Train Acc: 0.9623
 Site-MNIST     | Train Loss: 0.1259 | Train Acc: 0.9750
 Site-MNIST     | Train Loss: 0.0898 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0518 | Train Acc: 0.5769
 Site-SVHN      | Train Loss: 0.6149 | Train Acc: 0.8269
 Site-SVHN      | Train Loss: 0.3507 | Train Acc: 0.9551
 Site-USPS      | Train Loss: 0.3705 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.9070 | Train Acc: 0.6610
 Site-MNIST-M   | Train Loss: 1.5918 | Train Acc: 0.4583
 Site-MNIST     | Val  Loss: 0.3294 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1367 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0881 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1632 | Val  Acc: 0.9577
 Site-SVHN      | Val  Loss: 0.3212 | Val  Acc: 0.9412
 Site-SVHN      | Val  Loss: 0.4213 | Val  Acc: 0.9275
 Site-SVHN      | Val  Loss: 0.5035 | Val  Acc: 0.8846
 Site-USPS      | Val  Loss: 0.3223 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.6849 | Val  Acc: 0.4872
 Site-MNIST-M   | Val  Loss: 1.9261 | Val  Acc: 0.3125
Average Valid Accuracy: 0.8376
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9577
 Best site-SVHN       | Epoch:17 | Val Acc: 0.9412
 Best site-SVHN       | Epoch:17 | Val Acc: 0.9275
 Best site-SVHN       | Epoch:17 | Val Acc: 0.8846
 Best site-USPS       | Epoch:17 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.4872
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.3125
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 36 ============
============ Train epoch 37 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.4134 | Train Acc: 0.8846
 Site-MNIST     | Train Loss: 0.1131 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.1015 | Train Acc: 0.9875
 Site-MNIST     | Train Loss: 0.0773 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0535 | Train Acc: 0.6538
 Site-SVHN      | Train Loss: 0.4748 | Train Acc: 0.9231
 Site-SVHN      | Train Loss: 0.2881 | Train Acc: 0.9744
 Site-USPS      | Train Loss: 0.3488 | Train Acc: 0.9273
 Site-SynthDigits| Train Loss: 0.6765 | Train Acc: 0.7797
 Site-MNIST-M   | Train Loss: 1.3484 | Train Acc: 0.5417
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.3860 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.1087 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.1017 | Train Acc: 0.9750
 Site-MNIST     | Train Loss: 0.0740 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9522 | Train Acc: 0.7115
 Site-SVHN      | Train Loss: 0.4662 | Train Acc: 0.9135
 Site-SVHN      | Train Loss: 0.2354 | Train Acc: 0.9872
 Site-USPS      | Train Loss: 0.2799 | Train Acc: 0.9273
 Site-SynthDigits| Train Loss: 0.6679 | Train Acc: 0.7966
 Site-MNIST-M   | Train Loss: 1.2728 | Train Acc: 0.4792
 Site-MNIST     | Val  Loss: 0.2129 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0965 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0678 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1340 | Val  Acc: 0.9577
 Site-SVHN      | Val  Loss: 0.2029 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2678 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3462 | Val  Acc: 0.9519
 Site-USPS      | Val  Loss: 0.2869 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.5579 | Val  Acc: 0.5641
 Site-MNIST-M   | Val  Loss: 1.8342 | Val  Acc: 0.3750
Average Valid Accuracy: 0.8741
 Best site-MNIST      | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9577
 Best site-SVHN       | Epoch:19 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:19 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:19 | Val Acc: 0.9519
 Best site-USPS       | Epoch:19 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.5641
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.8486
 Test site-SVHN      | Epoch:19 | Test Acc: 0.3375
 Test site-USPS      | Epoch:19 | Test Acc: 0.8602
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.4900
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.2893
Average Test Accuracy: 0.5651
============ Train epoch 40 ============
============ Train epoch 41 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.3210 | Train Acc: 0.8846
 Site-MNIST     | Train Loss: 0.0826 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0828 | Train Acc: 0.9875
 Site-MNIST     | Train Loss: 0.0534 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0532 | Train Acc: 0.7692
 Site-SVHN      | Train Loss: 0.3748 | Train Acc: 0.9423
 Site-SVHN      | Train Loss: 0.2269 | Train Acc: 0.9808
 Site-USPS      | Train Loss: 0.2246 | Train Acc: 0.9455
 Site-SynthDigits| Train Loss: 0.6079 | Train Acc: 0.8136
 Site-MNIST-M   | Train Loss: 1.1636 | Train Acc: 0.5833
============ Train epoch 42 ============
============ Train epoch 43 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.3183 | Train Acc: 0.8846
 Site-MNIST     | Train Loss: 0.0785 | Train Acc: 0.9811
 Site-MNIST     | Train Loss: 0.0738 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0524 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7926 | Train Acc: 0.7308
 Site-SVHN      | Train Loss: 0.3301 | Train Acc: 0.9423
 Site-SVHN      | Train Loss: 0.1570 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.2156 | Train Acc: 0.9636
 Site-SynthDigits| Train Loss: 0.5272 | Train Acc: 0.8814
 Site-MNIST-M   | Train Loss: 1.0288 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.1626 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0736 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0496 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0982 | Val  Acc: 0.9859
 Site-SVHN      | Val  Loss: 0.1276 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1651 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2302 | Val  Acc: 0.9808
 Site-USPS      | Val  Loss: 0.2691 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.5398 | Val  Acc: 0.5641
 Site-MNIST-M   | Val  Loss: 1.7988 | Val  Acc: 0.4688
Average Valid Accuracy: 0.8891
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9859
 Best site-SVHN       | Epoch:21 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:21 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:21 | Val Acc: 0.9808
 Best site-USPS       | Epoch:21 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.5641
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.4688
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/FedPrompt...
============ Train epoch 44 ============
============ Train epoch 45 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
clients=[(1,)(1,)(4,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.2246 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.0662 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0557 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0430 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7347 | Train Acc: 0.7885
 Site-SVHN      | Train Loss: 0.2878 | Train Acc: 0.9712
 Site-SVHN      | Train Loss: 0.1527 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.2081 | Train Acc: 0.9455
 Site-SynthDigits| Train Loss: 0.5099 | Train Acc: 0.8814
 Site-MNIST-M   | Train Loss: 0.9078 | Train Acc: 0.7083
============ Train epoch 46 ============
============ Train epoch 47 ============
