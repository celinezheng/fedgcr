===2023-04-06 14:37:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2389 | Train Acc: 0.2386
 Site-MNIST     | Train Loss: 2.2207 | Train Acc: 0.3750
 Site-MNIST     | Train Loss: 2.2449 | Train Acc: 0.1818
 Site-MNIST     | Train Loss: 2.2320 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.2783 | Train Acc: 0.1364
 Site-SVHN      | Train Loss: 2.2737 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.2838 | Train Acc: 0.1477
 Site-USPS      | Train Loss: 2.2393 | Train Acc: 0.3409
 Site-SynthDigits| Train Loss: 2.2929 | Train Acc: 0.1705
 Site-MNIST-M   | Train Loss: 2.2881 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 2.2337 | Val  Acc: 0.3220
 Site-MNIST     | Val  Loss: 2.2488 | Val  Acc: 0.1186
 Site-MNIST     | Val  Loss: 2.2359 | Val  Acc: 0.3559
 Site-MNIST     | Val  Loss: 2.2081 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.2915 | Val  Acc: 0.1186
 Site-SVHN      | Val  Loss: 2.2824 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.2695 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 2.2533 | Val  Acc: 0.2881
 Site-SynthDigits| Val  Loss: 2.2976 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2968 | Val  Acc: 0.1356
Average Valid Accuracy: 0.2288
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3559
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1186
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-USPS       | Epoch:0 | Val Acc: 0.2881
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.1774 | Train Acc: 0.3977
 Site-MNIST     | Train Loss: 2.1503 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 2.1801 | Train Acc: 0.3636
 Site-MNIST     | Train Loss: 2.1606 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 2.2548 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2500 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.2724 | Train Acc: 0.1477
 Site-USPS      | Train Loss: 2.1835 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2867 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.2725 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 2.1577 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.1928 | Val  Acc: 0.3051
 Site-MNIST     | Val  Loss: 2.1692 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.1377 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 2.2829 | Val  Acc: 0.1356
 Site-SVHN      | Val  Loss: 2.2583 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.2595 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.1989 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 2.2946 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 2.2861 | Val  Acc: 0.2034
Average Valid Accuracy: 0.3119
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1356
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-USPS       | Epoch:1 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.1251 | Train Acc: 0.3864
 Site-MNIST     | Train Loss: 2.0837 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 2.1203 | Train Acc: 0.4205
 Site-MNIST     | Train Loss: 2.0956 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 2.2460 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2421 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.2516 | Train Acc: 0.1591
 Site-USPS      | Train Loss: 2.1310 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2735 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.2616 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 2.0873 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 2.1383 | Val  Acc: 0.3898
 Site-MNIST     | Val  Loss: 2.1059 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 2.0711 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 2.2750 | Val  Acc: 0.1356
 Site-SVHN      | Val  Loss: 2.2386 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2531 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 2.1470 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 2.2887 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2756 | Val  Acc: 0.2373
Average Valid Accuracy: 0.3305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3898
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1356
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2373
 Best site-USPS       | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.0644 | Train Acc: 0.3977
 Site-MNIST     | Train Loss: 2.0117 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 2.0618 | Train Acc: 0.4318
 Site-MNIST     | Train Loss: 2.0224 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 2.2270 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2295 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.2383 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 2.0569 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2650 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2541 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 2.0222 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 2.0865 | Val  Acc: 0.4068
 Site-MNIST     | Val  Loss: 2.0449 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 2.0057 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 2.2678 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.2217 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2486 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 2.0982 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 2.2810 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2659 | Val  Acc: 0.2373
Average Valid Accuracy: 0.3373
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2373
 Best site-USPS       | Epoch:3 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 2.0261 | Train Acc: 0.4091
 Site-MNIST     | Train Loss: 1.9627 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 2.0067 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 1.9661 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 2.2205 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.2159 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.2286 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 2.0129 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2444 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2410 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.9604 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 2.0374 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 1.9883 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 1.9448 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 2.2607 | Val  Acc: 0.1356
 Site-SVHN      | Val  Loss: 2.2069 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2423 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.0491 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.2723 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2567 | Val  Acc: 0.2881
Average Valid Accuracy: 0.3508
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1356
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 1.9466 | Train Acc: 0.4205
 Site-MNIST     | Train Loss: 1.8674 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.9423 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.9151 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 2.2130 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.2155 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.2229 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 1.9791 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2456 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2356 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.9017 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.9864 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 1.9340 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 1.8840 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.2543 | Val  Acc: 0.1186
 Site-SVHN      | Val  Loss: 2.1937 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2377 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.0039 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.2610 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.2473 | Val  Acc: 0.3220
Average Valid Accuracy: 0.3593
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1186
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2542
 Best site-USPS       | Epoch:5 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 1.9351 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 1.8307 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.8995 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 1.8550 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 2.1961 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.2113 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.2155 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 1.9490 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 2.2235 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2212 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.8479 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.9402 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.8847 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.8309 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 2.2489 | Val  Acc: 0.1186
 Site-SVHN      | Val  Loss: 2.1820 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2328 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.9601 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 2.2498 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2385 | Val  Acc: 0.3390
Average Valid Accuracy: 0.3814
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1186
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2542
 Best site-USPS       | Epoch:6 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.8899 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.8010 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.8736 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.8002 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 2.1905 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1943 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.2015 | Train Acc: 0.1932
 Site-USPS      | Train Loss: 1.8701 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2074 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2166 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 1.7976 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.8968 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.8381 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7806 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.2435 | Val  Acc: 0.1186
 Site-SVHN      | Val  Loss: 2.1715 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2280 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.9164 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 2.2385 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2293 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4017
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1186
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2542
 Best site-USPS       | Epoch:7 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.8094 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.7450 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.8030 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.7676 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 2.1714 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1870 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1930 | Train Acc: 0.2045
 Site-USPS      | Train Loss: 1.8534 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1994 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2021 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 1.7447 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.8488 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.7887 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7258 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.2393 | Val  Acc: 0.1356
 Site-SVHN      | Val  Loss: 2.1619 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2236 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.8781 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 2.2272 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2215 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4085
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1356
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2712
 Best site-USPS       | Epoch:8 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.7848 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.7028 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.7766 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.7008 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 2.1731 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1623 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1934 | Train Acc: 0.2045
 Site-USPS      | Train Loss: 1.8066 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1761 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.1890 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 1.6983 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.8078 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7468 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6806 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.2348 | Val  Acc: 0.1356
 Site-SVHN      | Val  Loss: 2.1535 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2196 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.8368 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 2.2151 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2127 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4271
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1356
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2712
 Best site-USPS       | Epoch:9 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-MNIST     | Train Loss: 1.7375 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.6537 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.7172 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.6558 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 2.1640 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1720 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1964 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.7689 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 2.1740 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.1786 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.6528 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.7656 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.7047 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6348 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.2306 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1451 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2158 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.7991 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.2023 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2059 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4390
 Best site-MNIST      | Epoch:10 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:10 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:10 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:10 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2712
 Best site-USPS       | Epoch:10 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-MNIST     | Train Loss: 1.6845 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.6105 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.6778 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.6192 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.1512 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1570 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1722 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.7425 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 2.1577 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.1737 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 1.6083 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.7253 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6653 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.5930 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.2256 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1383 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2111 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.7640 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 2.1899 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.1971 | Val  Acc: 0.3729
Average Valid Accuracy: 0.4559
 Best site-MNIST      | Epoch:11 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:11 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:11 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:11 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2881
 Best site-USPS       | Epoch:11 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-MNIST     | Train Loss: 1.6536 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.5687 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.6216 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.5789 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 2.1548 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1576 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1781 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.6787 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 2.1579 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.1574 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.5686 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.6886 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6294 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.5565 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.2215 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1310 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2070 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.7285 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1773 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.1894 | Val  Acc: 0.3559
Average Valid Accuracy: 0.4695
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:12 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:12 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:12 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2881
 Best site-USPS       | Epoch:12 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-MNIST     | Train Loss: 1.5988 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.5321 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.6175 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.5523 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.1298 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1529 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1503 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.6560 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 2.1281 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1544 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 1.5293 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.6517 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.5932 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.5184 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.2176 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1246 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2022 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.6958 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.1650 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1817 | Val  Acc: 0.3559
Average Valid Accuracy: 0.4847
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:13 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:13 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:13 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3051
 Best site-USPS       | Epoch:13 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-MNIST     | Train Loss: 1.5911 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.5121 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.5667 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.5058 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 2.1442 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1365 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1523 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.6172 | Train Acc: 0.6477
 Site-SynthDigits| Train Loss: 2.1111 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.1483 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 1.4915 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.6170 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.5580 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4824 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.2140 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1184 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1976 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.6697 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 2.1531 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1744 | Val  Acc: 0.3729
Average Valid Accuracy: 0.4898
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:14 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:14 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:14 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3051
 Best site-USPS       | Epoch:14 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-MNIST     | Train Loss: 1.5493 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.4883 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.5280 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.4451 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1174 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1428 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1544 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.5704 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 2.0958 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.1296 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 1.4553 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.5820 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.5248 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4481 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.2100 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1124 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1933 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.6435 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.1421 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1668 | Val  Acc: 0.3898
Average Valid Accuracy: 0.4949
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:15 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:15 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:15 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:15 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3051
 Best site-USPS       | Epoch:15 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-MNIST     | Train Loss: 1.5379 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.4567 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.5214 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.4244 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.1241 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1214 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1594 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.5858 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.0919 | Train Acc: 0.2955
 Site-MNIST-M   | Train Loss: 2.1213 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.4250 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.5503 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.4973 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.4177 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.2070 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.1063 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1883 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.6056 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.1279 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1579 | Val  Acc: 0.3729
Average Valid Accuracy: 0.5102
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:16 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:16 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:16 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3051
 Best site-USPS       | Epoch:16 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-MNIST     | Train Loss: 1.4807 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.4231 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.4626 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3927 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.1171 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1257 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1441 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.5479 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.0682 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.1055 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.3917 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.5189 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.4678 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.3876 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.2026 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.1015 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1841 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5752 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 2.1181 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1504 | Val  Acc: 0.3898
Average Valid Accuracy: 0.5169
 Best site-MNIST      | Epoch:17 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:17 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:17 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:17 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:17 | Val Acc: 0.3051
 Best site-USPS       | Epoch:17 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-MNIST     | Train Loss: 1.4677 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3539 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.4556 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.3680 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.1155 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1186 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1311 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.5006 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 2.0510 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.0977 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.3608 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.4885 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.4394 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.3577 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1978 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0962 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1781 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5593 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.1047 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.1436 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5271
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:18 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:18 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:18 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:18 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:18 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3051
 Best site-USPS       | Epoch:18 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-MNIST     | Train Loss: 1.4169 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3544 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.4178 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.3308 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0927 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1069 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1246 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4759 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.0461 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.0942 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.3305 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.4603 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.4118 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.3306 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1949 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0900 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1725 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5312 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0936 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1369 | Val  Acc: 0.4068
Average Valid Accuracy: 0.5288
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:19 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:19 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:19 | Val Acc: 0.3051
 Best site-USPS       | Epoch:19 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.6429
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2111
 Test site-USPS      | Epoch:19 | Test Acc: 0.7419
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.3093
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.2414
Average Test Accuracy: 0.4293
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-MNIST     | Train Loss: 1.4060 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3107 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.3830 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.3362 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.0958 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1057 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1290 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.4566 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.0548 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.0822 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.3029 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.4335 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.3870 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.3041 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1916 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0847 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1669 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5033 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0810 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1289 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5271
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-MNIST     | Train Loss: 1.3441 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2903 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.3640 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.2706 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.0774 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1166 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.1287 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4200 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 2.0187 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.0846 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.2753 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.4050 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.3621 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2776 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1881 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0808 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1626 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.4763 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0722 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1234 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5288
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-MNIST     | Train Loss: 1.3539 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.2849 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3214 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.2173 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.0726 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1089 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1193 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4168 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 2.0291 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.0780 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.2471 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.3787 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.3351 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2527 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1849 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0751 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1592 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.4595 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0624 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1185 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5322
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:22 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:22 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:22 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:22 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:22 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:22 | Val Acc: 0.3051
 Best site-USPS       | Epoch:22 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-MNIST     | Train Loss: 1.2798 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.2490 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3047 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.2329 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 2.0867 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0920 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1062 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.3865 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.0107 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.0565 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.2204 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.3540 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.3128 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2301 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1812 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0696 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1556 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.4287 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 2.0544 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1117 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5390
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:23 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:23 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:23 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:23 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:23 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:23 | Val Acc: 0.3051
 Best site-USPS       | Epoch:23 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-MNIST     | Train Loss: 1.3044 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2170 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2777 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1974 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 2.0948 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0953 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0898 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.3251 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 1.9827 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.0444 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 1.1989 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.3312 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2922 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2070 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1785 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0639 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1471 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.4062 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0409 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.1017 | Val  Acc: 0.4407
Average Valid Accuracy: 0.5458
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:24 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:24 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:24 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:24 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:24 | Val Acc: 0.3051
 Best site-USPS       | Epoch:24 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-MNIST     | Train Loss: 1.2639 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.2157 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.2552 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1886 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 2.0704 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0931 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1084 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.3713 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.9742 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.0382 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.1754 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.3099 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2695 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1849 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1756 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0582 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1421 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.3812 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 2.0286 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0971 | Val  Acc: 0.4068
Average Valid Accuracy: 0.5441
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-MNIST     | Train Loss: 1.2556 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.2004 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.2317 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1647 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 2.0702 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0779 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0989 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.2839 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9632 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.0308 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 1.1534 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 1.2873 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2512 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.1654 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.1733 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0536 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1360 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.3507 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 2.0210 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0877 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5593
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:26 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2881
 Best site-USPS       | Epoch:26 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-MNIST     | Train Loss: 1.2140 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1528 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.2535 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1769 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0702 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0578 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0890 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2942 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.9602 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.0234 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 1.1336 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.2676 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2327 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.1439 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.1713 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0486 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1302 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.3335 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 2.0090 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0826 | Val  Acc: 0.4407
Average Valid Accuracy: 0.5576
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-MNIST     | Train Loss: 1.1922 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1433 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.1978 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1038 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0688 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0778 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1013 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2448 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.9552 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.0194 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 1.1089 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.2471 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2116 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.1240 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.1691 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0435 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1239 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.3191 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.9983 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0764 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5627
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:28 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2881
 Best site-USPS       | Epoch:28 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-MNIST     | Train Loss: 1.1709 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1247 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.1905 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0899 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0384 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0648 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0752 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.2468 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 1.9412 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.9995 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 1.0869 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.2255 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1923 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.1048 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1629 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0383 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1221 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.2885 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9919 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0735 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5661
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:29 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:29 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:29 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:29 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:29 | Val Acc: 0.2881
 Best site-USPS       | Epoch:29 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-MNIST     | Train Loss: 1.1267 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1031 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.1580 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.1013 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0520 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0659 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0919 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2424 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 1.9278 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 2.0015 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 1.0692 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.2081 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1772 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.0867 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1608 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0358 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1113 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.2751 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.9810 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0644 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5678
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:30 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:30 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:30 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:30 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:30 | Val Acc: 0.2881
 Best site-USPS       | Epoch:30 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-MNIST     | Train Loss: 1.1182 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1220 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.1391 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0755 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0393 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0436 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0752 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.2316 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.9168 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.9670 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 1.0528 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.1926 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1665 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.0713 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1584 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0290 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1000 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.2536 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.9716 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0568 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5678
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-MNIST     | Train Loss: 1.1042 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.0587 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1093 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0520 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0352 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0491 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0530 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.2200 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.9235 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.9717 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 1.0292 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.1726 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1406 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0529 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1555 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0240 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0985 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.2366 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9622 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0519 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5729
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:32 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:32 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:32 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:32 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:32 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:32 | Val Acc: 0.2881
 Best site-USPS       | Epoch:32 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-MNIST     | Train Loss: 1.0606 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.0724 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1204 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0156 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0237 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0243 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0676 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1843 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.9095 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.9678 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.0111 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.1556 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1295 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0387 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.1518 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0189 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0883 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.2158 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9535 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0445 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5746
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:33 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:33 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:33 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2881
 Best site-USPS       | Epoch:33 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-MNIST     | Train Loss: 1.0764 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0675 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0915 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0010 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0189 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0424 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0719 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1600 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.9013 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.9479 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.9934 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.1375 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1126 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.0256 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.1512 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0136 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0814 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1915 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9435 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0390 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5797
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:34 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:34 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:34 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:34 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:34 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:34 | Val Acc: 0.3220
 Best site-USPS       | Epoch:34 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-MNIST     | Train Loss: 1.0643 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0272 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0665 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.9954 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0161 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0168 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0565 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.1577 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8927 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9452 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.9735 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.1189 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.0907 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.0073 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.1449 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0124 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0827 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.1699 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9371 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0350 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5780
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-MNIST     | Train Loss: 1.0460 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0088 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 1.0548 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.9505 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0241 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0257 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0451 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.1307 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8599 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9361 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.9573 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.1038 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.0764 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9930 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.1419 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0073 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0771 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1514 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9281 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0295 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5831
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:36 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:36 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:36 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:36 | Val Acc: 0.3220
 Best site-USPS       | Epoch:36 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-MNIST     | Train Loss: 1.0133 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.9947 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 1.0225 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9673 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0269 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0081 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0528 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.0835 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8487 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9282 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.9432 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.0865 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.0604 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.9795 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.1387 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0021 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0739 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1366 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.9177 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0229 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5847
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:37 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:37 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:37 | Val Acc: 0.3220
 Best site-USPS       | Epoch:37 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-MNIST     | Train Loss: 1.0348 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.9883 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 1.0139 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.9513 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0185 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0212 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0333 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.0807 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.8415 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9195 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.9243 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.0736 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.0436 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.9671 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.1358 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 1.9976 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0693 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1158 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9131 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0154 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5915
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3220
 Best site-USPS       | Epoch:38 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/PromptFL...
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-MNIST     | Train Loss: 1.0108 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.9657 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9944 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9195 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 2.0055 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.9867 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0388 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.0944 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8450 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9116 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.9133 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 1.0585 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.0324 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9586 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.1340 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 1.9897 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0637 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1101 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9033 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0104 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5898
===2023-04-06 15:37:46===
===2023-04-06 15:37:47===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:38 | Test Acc: 0.7300
 Test site-SVHN      | Epoch:38 | Test Acc: 0.2267
 Test site-USPS      | Epoch:38 | Test Acc: 0.8172
 Test site-SynthDigits| Epoch:38 | Test Acc: 0.3870
 Test site-MNIST-M   | Epoch:38 | Test Acc: 0.2850
Average Test Accuracy: 0.4892
