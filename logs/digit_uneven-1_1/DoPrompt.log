===2023-04-06 01:53:25===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8195 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.7045 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.7000 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.6577 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 2.2308 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1847 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1917 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.7998 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 2.1271 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2237 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.6607 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7273 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.7614 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7189 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.2338 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1718 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2253 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7907 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.1352 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2219 | Val  Acc: 0.1525
Average Valid Accuracy: 0.3898
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4235 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.3666 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.3695 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.2568 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.1280 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0834 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0824 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.4612 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 1.9721 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.1162 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.2950 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.3722 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.4021 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.3216 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.1612 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0846 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1481 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.4660 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.9610 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.1226 | Val  Acc: 0.1695
Average Valid Accuracy: 0.4814
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1618 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1000 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.1503 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.0340 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0808 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0300 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0093 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 1.2325 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8628 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 2.0296 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.0582 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.1363 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.1651 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.0706 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1060 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0370 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0889 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.2460 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.8410 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0431 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5288
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1695
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9465 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.9019 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.9252 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.8209 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 2.0706 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9821 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9850 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 1.0999 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7325 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9343 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.8531 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.9324 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9673 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8668 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0599 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9969 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.0410 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.0842 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7468 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.9715 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5763
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2034
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7703 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.7587 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.7677 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.6721 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 2.0111 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9613 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.9236 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.9106 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.6616 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.8595 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 0.6874 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.7628 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7961 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6979 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.0187 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9594 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9998 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.9576 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6639 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.9148 | Val  Acc: 0.2881
Average Valid Accuracy: 0.6169
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6573 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.5896 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.6643 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5473 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.9941 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8927 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.9099 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.8902 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.5813 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.7795 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.5466 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6272 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6549 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5659 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.9793 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9241 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.9541 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.8736 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6083 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8570 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6305
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2542
 Best site-USPS       | Epoch:5 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5465 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.4931 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.5339 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4586 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.9481 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8771 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.8465 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.8121 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.5344 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.7042 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 0.4573 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5295 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5432 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4688 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.9491 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8937 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.9221 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.8034 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.5453 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7996 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6407
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2373
 Best site-USPS       | Epoch:6 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4924 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4427 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.5016 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3669 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.9280 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8303 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8013 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.7486 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.4493 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.6636 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.3999 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4858 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4885 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4285 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.9088 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8660 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8852 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.7548 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.4785 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7624 | Val  Acc: 0.3729
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2712
 Best site-USPS       | Epoch:7 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4319 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3676 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.4138 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3395 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8838 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.8104 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7857 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.6978 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3949 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.6042 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 0.3431 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4074 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4158 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3694 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8907 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8379 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8610 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.7137 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.4425 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7130 | Val  Acc: 0.3898
Average Valid Accuracy: 0.6525
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2373
 Best site-USPS       | Epoch:8 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3981 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3438 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3943 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2692 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.8626 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7874 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.7617 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.6448 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.2955 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.5886 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.3056 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3835 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3790 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3428 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8736 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8227 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8334 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.6679 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.3993 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6872 | Val  Acc: 0.4237
Average Valid Accuracy: 0.6627
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2712
 Best site-USPS       | Epoch:9 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-MNIST     | Train Loss: 0.3507 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2973 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3164 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2517 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.8564 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7731 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.7801 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.6205 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.2783 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.4689 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.2642 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3153 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3235 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3006 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8431 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8010 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8211 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.6444 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.3780 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6118 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6678
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:10 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2712
 Best site-USPS       | Epoch:10 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-MNIST     | Train Loss: 0.3325 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3037 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3305 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2268 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.8111 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.7684 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.6992 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.5852 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.1355 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.4816 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.2472 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3172 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3110 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2849 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.8277 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7770 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7802 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.5885 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.3072 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.6325 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6881
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:11 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3559
 Best site-USPS       | Epoch:11 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-MNIST     | Train Loss: 0.3149 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2671 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2679 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2011 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.8109 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7042 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.6246 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.5738 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.1742 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.4041 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2215 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2723 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2658 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2618 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.8000 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7632 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7574 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.5781 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.2852 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5533 | Val  Acc: 0.4746
Average Valid Accuracy: 0.6864
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-MNIST     | Train Loss: 0.2851 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2559 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2898 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1922 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7731 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6806 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.6746 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.5011 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.0677 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.3942 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.2181 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2807 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2740 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2534 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.7697 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.7327 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.7247 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.4927 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2546 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.5368 | Val  Acc: 0.4915
Average Valid Accuracy: 0.7102
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:13 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3559
 Best site-USPS       | Epoch:13 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-MNIST     | Train Loss: 0.2611 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2247 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2612 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1781 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7832 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.6288 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.6102 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.5774 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.0421 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.3008 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.2048 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2527 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2467 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2226 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.7427 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7208 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7114 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.5752 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.2140 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4835 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7034
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-MNIST     | Train Loss: 0.2727 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2127 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2492 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1747 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7422 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6976 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.6342 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.4217 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.9822 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.2566 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.1968 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2503 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2287 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2320 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.7210 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.7175 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.6861 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.4561 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2148 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.4596 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7119
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:15 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3390
 Best site-USPS       | Epoch:15 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-MNIST     | Train Loss: 0.2150 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2029 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2380 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1569 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7028 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6309 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.6124 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.4706 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.9263 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.2407 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.1843 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2243 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2249 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2014 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.7175 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.6774 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6679 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.5116 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.1718 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.4349 | Val  Acc: 0.5085
Average Valid Accuracy: 0.7169
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:16 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3898
 Best site-USPS       | Epoch:16 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-MNIST     | Train Loss: 0.2569 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.1975 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2455 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1657 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7219 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.6631 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.5349 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.4010 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.9227 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.1457 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.1978 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2302 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2117 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2109 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.6806 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6774 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6359 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.4248 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1287 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3502 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7203
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:17 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:17 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:17 | Val Acc: 0.3729
 Best site-USPS       | Epoch:17 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-MNIST     | Train Loss: 0.1930 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1895 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2160 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1334 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6571 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.5726 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.5613 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.4155 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.9661 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.2001 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.1616 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2121 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1939 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1790 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.6487 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.6511 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6087 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.4498 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1866 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4330 | Val  Acc: 0.4915
Average Valid Accuracy: 0.7220
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:18 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:18 | Val Acc: 0.4576
 Best site-USPS       | Epoch:18 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-MNIST     | Train Loss: 0.2216 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.1877 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2309 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1458 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7246 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.5822 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.5449 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.3926 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.7529 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.0112 | Train Acc: 0.7500
 Site-MNIST     | Val  Loss: 0.1853 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2205 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1991 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2005 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.6484 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.6768 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.6201 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.3980 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0558 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.2993 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7169
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-MNIST     | Train Loss: 0.1655 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1708 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1748 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1144 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6742 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.5208 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.5661 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.3753 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.7215 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.0449 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.1382 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1725 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1605 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1554 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.6383 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.5994 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.5753 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.4224 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0919 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.3109 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7339
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:20 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:20 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:20 | Val Acc: 0.4068
 Best site-USPS       | Epoch:20 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-MNIST     | Train Loss: 0.2086 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1406 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2215 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1158 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6358 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.5671 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.4692 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.3258 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.7010 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.9508 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.1513 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1837 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1531 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1731 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.6002 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6382 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5852 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.3741 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0195 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.2425 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7339
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-MNIST     | Train Loss: 0.1504 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1351 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1767 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0808 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6795 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.5107 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.4568 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.3963 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.6902 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.9583 | Train Acc: 0.7500
 Site-MNIST     | Val  Loss: 0.1336 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1651 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1409 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1474 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.5712 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.5473 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.5629 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.4342 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.0737 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.2743 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7373
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:22 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:22 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:22 | Val Acc: 0.4407
 Best site-USPS       | Epoch:22 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-MNIST     | Train Loss: 0.1809 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1527 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1772 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1233 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6543 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.5804 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.4622 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.2848 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.6726 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.8477 | Train Acc: 0.8182
 Site-MNIST     | Val  Loss: 0.1336 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1690 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1524 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1635 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.5319 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5977 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5540 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.3707 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.9915 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.1774 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7475
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:23 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:23 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:23 | Val Acc: 0.4068
 Best site-USPS       | Epoch:23 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-MNIST     | Train Loss: 0.1427 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1153 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1777 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0761 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6265 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.4570 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.4115 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.3958 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.6118 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.9602 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.1305 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1457 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1128 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1424 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.5500 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.5098 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.5371 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.4476 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.0664 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.2752 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7390
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-MNIST     | Train Loss: 0.1667 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1271 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1783 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0789 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6603 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.5709 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.3626 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.3042 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.6349 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.8166 | Train Acc: 0.8182
 Site-MNIST     | Val  Loss: 0.1295 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1390 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1166 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1708 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.4340 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.5773 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5659 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.3849 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.9838 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.1652 | Val  Acc: 0.6102
Average Valid Accuracy: 0.7610
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:25 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:25 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:25 | Val Acc: 0.4407
 Best site-USPS       | Epoch:25 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-MNIST     | Train Loss: 0.1296 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1246 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1765 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0640 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6227 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.5033 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.3900 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.3800 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.6416 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.8475 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.1322 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1419 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1183 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1410 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.5045 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.5608 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5280 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.3919 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0676 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 1.1963 | Val  Acc: 0.5932
Average Valid Accuracy: 0.7475
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-MNIST     | Train Loss: 0.1644 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.1152 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1716 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0852 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5583 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.4252 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.3784 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.2400 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.5857 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.6495 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.1238 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1574 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1190 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1555 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.4456 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.4428 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.4850 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.3380 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.9540 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.0417 | Val  Acc: 0.6780
Average Valid Accuracy: 0.7712
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:27 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:27 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:27 | Val Acc: 0.5085
 Best site-USPS       | Epoch:27 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-MNIST     | Train Loss: 0.1214 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1009 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1546 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0556 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5218 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.4737 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.2686 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.3284 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.4996 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.7987 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.1162 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1196 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0976 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1347 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3626 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.5600 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.4866 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.3464 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0069 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.1291 | Val  Acc: 0.6610
Average Valid Accuracy: 0.7729
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:28 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:28 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:28 | Val Acc: 0.4407
 Best site-USPS       | Epoch:28 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-MNIST     | Train Loss: 0.1556 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.0869 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1218 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0535 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5431 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.3375 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 1.3414 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.2201 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.5240 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.6221 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.1012 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1029 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0811 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1475 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.4220 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.4010 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.4522 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.3429 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.9316 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 1.0272 | Val  Acc: 0.7119
Average Valid Accuracy: 0.7949
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:29 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:29 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:29 | Val Acc: 0.4915
 Best site-USPS       | Epoch:29 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.7119
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-MNIST     | Train Loss: 0.1090 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1238 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1495 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0541 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4744 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.4146 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.2589 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.3766 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.4558 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.7114 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.1212 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1208 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0980 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1284 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.3858 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.4746 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.4706 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.4180 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.9871 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 1.1103 | Val  Acc: 0.6610
Average Valid Accuracy: 0.7712
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-MNIST     | Train Loss: 0.1505 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0898 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1156 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0571 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5191 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.3387 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 1.2379 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.2133 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4374 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.5706 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.0981 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1085 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0896 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1176 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3619 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3789 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.3900 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.3175 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.9064 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.0027 | Val  Acc: 0.7627
Average Valid Accuracy: 0.8000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:31 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:31 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:31 | Val Acc: 0.5085
 Best site-USPS       | Epoch:31 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-MNIST     | Train Loss: 0.0958 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1016 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1794 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0580 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4736 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.4234 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.2534 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.2390 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.4021 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.5947 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.1187 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1663 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1097 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.0974 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3258 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.4342 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.4622 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.3200 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.9705 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.0181 | Val  Acc: 0.7288
Average Valid Accuracy: 0.7847
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-MNIST     | Train Loss: 0.1332 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0974 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1196 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0492 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4084 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.2992 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 1.2039 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.1787 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.4774 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.5084 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.0914 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1047 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0799 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1251 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.3412 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3588 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.3846 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.2897 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.9700 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 0.9428 | Val  Acc: 0.7797
Average Valid Accuracy: 0.8000
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-MNIST     | Train Loss: 0.1081 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1042 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1306 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0476 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5237 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.3936 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.2304 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.1894 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3572 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.4715 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.1174 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1023 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1015 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1212 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3231 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.4021 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.4157 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.2926 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.8961 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 0.9313 | Val  Acc: 0.7458
Average Valid Accuracy: 0.7864
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-MNIST     | Train Loss: 0.0985 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0733 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1123 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0498 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3407 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 1.4049 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 1.2008 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.1620 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.3694 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.5995 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.0914 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0999 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0685 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0959 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.3146 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.3877 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3517 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.2828 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.9362 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 1.0549 | Val  Acc: 0.7627
Average Valid Accuracy: 0.7966
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-MNIST     | Train Loss: 0.1114 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0819 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1170 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0422 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4844 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.3220 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 1.2004 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.1905 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3577 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.4294 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1056 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0857 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0712 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1161 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.2918 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.3820 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.4160 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.2839 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.9200 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.8860 | Val  Acc: 0.7458
Average Valid Accuracy: 0.8000
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-MNIST     | Train Loss: 0.1138 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0792 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0946 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0323 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3011 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.3437 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.2466 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.2416 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4688 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.5444 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.0761 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0815 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0610 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0838 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3262 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3655 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.3539 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.3113 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0105 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.0133 | Val  Acc: 0.7627
Average Valid Accuracy: 0.7983
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-MNIST     | Train Loss: 0.1152 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1025 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1357 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0525 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5356 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.3490 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.2258 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.2080 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.3092 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.3282 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1328 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.0954 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0960 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1215 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.3070 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.3614 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.4083 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.2833 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.9452 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.7845 | Val  Acc: 0.7966
Average Valid Accuracy: 0.7949
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-MNIST     | Train Loss: 0.1046 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0608 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0879 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4781 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.3200 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.1713 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 0.1881 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.4638 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.5268 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.0709 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0745 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0566 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0859 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.2619 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.3593 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.3855 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.3002 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0052 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.9941 | Val  Acc: 0.7627
Average Valid Accuracy: 0.8102
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:39 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:39 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:39 | Val Acc: 0.5085
 Best site-USPS       | Epoch:39 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1_1/DoPrompt...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8864
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3033
 Test site-USPS      | Epoch:39 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.5479
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.4400
Average Test Accuracy: 0.6054
===2023-04-06 04:13:19===
===2023-04-06 04:13:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8864
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3033
 Test site-USPS      | Epoch:39 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.5479
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.4400
Average Test Accuracy: 0.6054
