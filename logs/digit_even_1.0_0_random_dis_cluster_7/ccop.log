===2023-08-12 07:19:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (4) | Train Loss: 1.6953 | Train Acc: 0.6361
 Site-MNIST                     (4) | Train Loss: 1.7569 | Train Acc: 0.5686
 Site-USPS                      (2) | Train Loss: 1.6787 | Train Acc: 0.6119
 Site-USPS                      (2) | Train Loss: 1.6896 | Train Acc: 0.5892
 Site-SynthDigits               (0) | Train Loss: 2.0828 | Train Acc: 0.3288
 Site-SynthDigits               (0) | Train Loss: 2.0609 | Train Acc: 0.3345
 Site-MNIST_M                   (3) | Train Loss: 2.1527 | Train Acc: 0.2264
 Site-MNIST_M                   (6) | Train Loss: 2.1751 | Train Acc: 0.2054
 Site-SVHN                      (5) | Train Loss: 2.2009 | Train Acc: 0.1833
 Site-SVHN                      (1) | Train Loss: 2.2028 | Train Acc: 0.2108
Average Train Accuracy: 0.3895
 Site-MNIST                     (4) | Val  Loss: 1.7693 | Val  Acc: 0.5435
 Site-MNIST                     (4) | Val  Loss: 1.7402 | Val  Acc: 0.5899
 Site-USPS                      (2) | Val  Loss: 1.7620 | Val  Acc: 0.5543
 Site-USPS                      (2) | Val  Loss: 1.7301 | Val  Acc: 0.5719
 Site-SynthDigits               (0) | Val  Loss: 2.0961 | Val  Acc: 0.3043
 Site-SynthDigits               (0) | Val  Loss: 2.0716 | Val  Acc: 0.3381
 Site-MNIST_M                   (3) | Val  Loss: 2.0927 | Val  Acc: 0.2500
 Site-MNIST_M                   (6) | Val  Loss: 2.1633 | Val  Acc: 0.2230
 Site-SVHN                      (5) | Val  Loss: 2.1702 | Val  Acc: 0.2391
 Site-SVHN                      (1) | Val  Loss: 2.2057 | Val  Acc: 0.2050
Average Valid Accuracy: 0.3819
 Best site-MNIST                    (4)  | Epoch:0 | Val Acc: 0.5435
 Best site-MNIST                    (4)  | Epoch:0 | Val Acc: 0.5899
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5543
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5719
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3043
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3381
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-MNIST_M                  (6)  | Epoch:0 | Val Acc: 0.2230
 Best site-SVHN                     (5)  | Epoch:0 | Val Acc: 0.2391
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.2974 | Train Acc: 0.7682
 Site-MNIST                     (0) | Train Loss: 1.3785 | Train Acc: 0.7049
 Site-USPS                      (4) | Train Loss: 1.2167 | Train Acc: 0.7466
 Site-USPS                      (4) | Train Loss: 1.2520 | Train Acc: 0.7426
 Site-SynthDigits               (5) | Train Loss: 1.8790 | Train Acc: 0.4151
 Site-SynthDigits               (3) | Train Loss: 1.8003 | Train Acc: 0.4457
 Site-MNIST_M                   (2) | Train Loss: 1.8867 | Train Acc: 0.3747
 Site-MNIST_M                   (2) | Train Loss: 1.9367 | Train Acc: 0.3390
 Site-SVHN                      (6) | Train Loss: 2.0633 | Train Acc: 0.2561
 Site-SVHN                      (1) | Train Loss: 2.0520 | Train Acc: 0.2816
Average Train Accuracy: 0.5075
 Site-MNIST                     (0) | Val  Loss: 1.3581 | Val  Acc: 0.7283
 Site-MNIST                     (0) | Val  Loss: 1.3547 | Val  Acc: 0.7446
 Site-USPS                      (4) | Val  Loss: 1.3210 | Val  Acc: 0.6630
 Site-USPS                      (4) | Val  Loss: 1.3012 | Val  Acc: 0.7194
 Site-SynthDigits               (5) | Val  Loss: 1.8411 | Val  Acc: 0.3804
 Site-SynthDigits               (3) | Val  Loss: 1.8159 | Val  Acc: 0.4209
 Site-MNIST_M                   (2) | Val  Loss: 1.8663 | Val  Acc: 0.3587
 Site-MNIST_M                   (2) | Val  Loss: 1.8959 | Val  Acc: 0.3921
 Site-SVHN                      (6) | Val  Loss: 2.0397 | Val  Acc: 0.3261
 Site-SVHN                      (1) | Val  Loss: 2.0655 | Val  Acc: 0.2914
Average Valid Accuracy: 0.5025
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7283
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7446
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.6630
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.7194
 Best site-SynthDigits              (5)  | Epoch:1 | Val Acc: 0.3804
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.4209
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.3587
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.3921
 Best site-SVHN                     (6)  | Epoch:1 | Val Acc: 0.3261
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (4) | Train Loss: 1.1216 | Train Acc: 0.7574
 Site-MNIST                     (4) | Train Loss: 1.2052 | Train Acc: 0.7112
 Site-USPS                      (1) | Train Loss: 1.0096 | Train Acc: 0.7844
 Site-USPS                      (1) | Train Loss: 1.0252 | Train Acc: 0.7561
 Site-SynthDigits               (0) | Train Loss: 1.6145 | Train Acc: 0.4852
 Site-SynthDigits               (0) | Train Loss: 1.5067 | Train Acc: 0.5318
 Site-MNIST_M                   (6) | Train Loss: 1.6957 | Train Acc: 0.4744
 Site-MNIST_M                   (2) | Train Loss: 1.7696 | Train Acc: 0.4341
 Site-SVHN                      (3) | Train Loss: 1.9154 | Train Acc: 0.3261
 Site-SVHN                      (5) | Train Loss: 1.8715 | Train Acc: 0.3480
Average Train Accuracy: 0.5609
 Site-MNIST                     (4) | Val  Loss: 1.1676 | Val  Acc: 0.7717
 Site-MNIST                     (4) | Val  Loss: 1.1882 | Val  Acc: 0.7590
 Site-USPS                      (1) | Val  Loss: 1.0872 | Val  Acc: 0.7174
 Site-USPS                      (1) | Val  Loss: 1.0960 | Val  Acc: 0.7374
 Site-SynthDigits               (0) | Val  Loss: 1.5151 | Val  Acc: 0.5109
 Site-SynthDigits               (0) | Val  Loss: 1.5317 | Val  Acc: 0.5036
 Site-MNIST_M                   (6) | Val  Loss: 1.7435 | Val  Acc: 0.4565
 Site-MNIST_M                   (2) | Val  Loss: 1.7257 | Val  Acc: 0.4748
 Site-SVHN                      (3) | Val  Loss: 1.9070 | Val  Acc: 0.2717
 Site-SVHN                      (5) | Val  Loss: 1.9326 | Val  Acc: 0.3094
Average Valid Accuracy: 0.5512
 Best site-MNIST                    (4)  | Epoch:2 | Val Acc: 0.7717
 Best site-MNIST                    (4)  | Epoch:2 | Val Acc: 0.7590
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.7174
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.7374
 Best site-SynthDigits              (0)  | Epoch:2 | Val Acc: 0.5109
 Best site-SynthDigits              (0)  | Epoch:2 | Val Acc: 0.5036
 Best site-MNIST_M                  (6)  | Epoch:2 | Val Acc: 0.4565
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.4748
 Best site-SVHN                     (3)  | Epoch:2 | Val Acc: 0.2717
 Best site-SVHN                     (5)  | Epoch:2 | Val Acc: 0.3094
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (4) | Train Loss: 0.8755 | Train Acc: 0.8167
 Site-MNIST                     (4) | Train Loss: 0.9560 | Train Acc: 0.7848
 Site-USPS                      (2) | Train Loss: 0.8229 | Train Acc: 0.8302
 Site-USPS                      (2) | Train Loss: 0.8390 | Train Acc: 0.8188
 Site-SynthDigits               (3) | Train Loss: 1.3967 | Train Acc: 0.5687
 Site-SynthDigits               (3) | Train Loss: 1.2916 | Train Acc: 0.6278
 Site-MNIST_M                   (1) | Train Loss: 1.5935 | Train Acc: 0.4933
 Site-MNIST_M                   (6) | Train Loss: 1.6387 | Train Acc: 0.4843
 Site-SVHN                      (0) | Train Loss: 1.8100 | Train Acc: 0.3639
 Site-SVHN                      (5) | Train Loss: 1.7440 | Train Acc: 0.4090
Average Train Accuracy: 0.6197
 Site-MNIST                     (4) | Val  Loss: 0.9145 | Val  Acc: 0.8261
 Site-MNIST                     (4) | Val  Loss: 0.9381 | Val  Acc: 0.8273
 Site-USPS                      (2) | Val  Loss: 0.9254 | Val  Acc: 0.7283
 Site-USPS                      (2) | Val  Loss: 0.8973 | Val  Acc: 0.7878
 Site-SynthDigits               (3) | Val  Loss: 1.3368 | Val  Acc: 0.5543
 Site-SynthDigits               (3) | Val  Loss: 1.3143 | Val  Acc: 0.5647
 Site-MNIST_M                   (1) | Val  Loss: 1.6356 | Val  Acc: 0.5000
 Site-MNIST_M                   (6) | Val  Loss: 1.6013 | Val  Acc: 0.5468
 Site-SVHN                      (0) | Val  Loss: 1.7941 | Val  Acc: 0.2826
 Site-SVHN                      (5) | Val  Loss: 1.8142 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5960
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8261
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8273
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.7283
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.7878
 Best site-SynthDigits              (3)  | Epoch:3 | Val Acc: 0.5543
 Best site-SynthDigits              (3)  | Epoch:3 | Val Acc: 0.5647
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST_M                  (6)  | Epoch:3 | Val Acc: 0.5468
 Best site-SVHN                     (0)  | Epoch:3 | Val Acc: 0.2826
 Best site-SVHN                     (5)  | Epoch:3 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (4) | Train Loss: 0.7543 | Train Acc: 0.8410
 Site-MNIST                     (5) | Train Loss: 0.8410 | Train Acc: 0.8108
 Site-USPS                      (0) | Train Loss: 0.7435 | Train Acc: 0.8518
 Site-USPS                      (0) | Train Loss: 0.7676 | Train Acc: 0.8287
 Site-SynthDigits               (3) | Train Loss: 1.2532 | Train Acc: 0.6065
 Site-SynthDigits               (3) | Train Loss: 1.1503 | Train Acc: 0.6646
 Site-MNIST_M                   (2) | Train Loss: 1.4744 | Train Acc: 0.5660
 Site-MNIST_M                   (6) | Train Loss: 1.5135 | Train Acc: 0.5641
 Site-SVHN                      (1) | Train Loss: 1.6885 | Train Acc: 0.4286
 Site-SVHN                      (1) | Train Loss: 1.6209 | Train Acc: 0.4448
Average Train Accuracy: 0.6607
 Site-MNIST                     (4) | Val  Loss: 0.7688 | Val  Acc: 0.8804
 Site-MNIST                     (5) | Val  Loss: 0.8172 | Val  Acc: 0.8633
 Site-USPS                      (0) | Val  Loss: 0.8608 | Val  Acc: 0.7391
 Site-USPS                      (0) | Val  Loss: 0.8239 | Val  Acc: 0.8022
 Site-SynthDigits               (3) | Val  Loss: 1.1951 | Val  Acc: 0.5870
 Site-SynthDigits               (3) | Val  Loss: 1.1770 | Val  Acc: 0.6079
 Site-MNIST_M                   (2) | Val  Loss: 1.5145 | Val  Acc: 0.5761
 Site-MNIST_M                   (6) | Val  Loss: 1.4779 | Val  Acc: 0.6187
 Site-SVHN                      (1) | Val  Loss: 1.6652 | Val  Acc: 0.3913
 Site-SVHN                      (1) | Val  Loss: 1.6783 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6498
 Best site-MNIST                    (4)  | Epoch:4 | Val Acc: 0.8804
 Best site-MNIST                    (5)  | Epoch:4 | Val Acc: 0.8633
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7391
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8022
 Best site-SynthDigits              (3)  | Epoch:4 | Val Acc: 0.5870
 Best site-SynthDigits              (3)  | Epoch:4 | Val Acc: 0.6079
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.5761
 Best site-MNIST_M                  (6)  | Epoch:4 | Val Acc: 0.6187
 Best site-SVHN                     (1)  | Epoch:4 | Val Acc: 0.3913
 Best site-SVHN                     (1)  | Epoch:4 | Val Acc: 0.4317
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (1) | Train Loss: 0.6652 | Train Acc: 0.8491
 Site-MNIST                     (1) | Train Loss: 0.7497 | Train Acc: 0.8215
 Site-USPS                      (2) | Train Loss: 0.6861 | Train Acc: 0.8491
 Site-USPS                      (2) | Train Loss: 0.7036 | Train Acc: 0.8422
 Site-SynthDigits               (6) | Train Loss: 1.1008 | Train Acc: 0.6577
 Site-SynthDigits               (4) | Train Loss: 1.0090 | Train Acc: 0.7130
 Site-MNIST_M                   (0) | Train Loss: 1.3673 | Train Acc: 0.5984
 Site-MNIST_M                   (5) | Train Loss: 1.3936 | Train Acc: 0.6143
 Site-SVHN                      (3) | Train Loss: 1.5195 | Train Acc: 0.4879
 Site-SVHN                      (3) | Train Loss: 1.4739 | Train Acc: 0.5148
Average Train Accuracy: 0.6948
 Site-MNIST                     (1) | Val  Loss: 0.6617 | Val  Acc: 0.8913
 Site-MNIST                     (1) | Val  Loss: 0.7264 | Val  Acc: 0.8489
 Site-USPS                      (2) | Val  Loss: 0.8055 | Val  Acc: 0.7609
 Site-USPS                      (2) | Val  Loss: 0.7644 | Val  Acc: 0.8129
 Site-SynthDigits               (6) | Val  Loss: 1.0412 | Val  Acc: 0.6304
 Site-SynthDigits               (4) | Val  Loss: 1.0353 | Val  Acc: 0.6475
 Site-MNIST_M                   (0) | Val  Loss: 1.4009 | Val  Acc: 0.5978
 Site-MNIST_M                   (5) | Val  Loss: 1.3651 | Val  Acc: 0.6295
 Site-SVHN                      (3) | Val  Loss: 1.5100 | Val  Acc: 0.4674
 Site-SVHN                      (3) | Val  Loss: 1.5149 | Val  Acc: 0.5036
Average Valid Accuracy: 0.6790
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8913
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8489
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.7609
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.8129
 Best site-SynthDigits              (6)  | Epoch:5 | Val Acc: 0.6304
 Best site-SynthDigits              (4)  | Epoch:5 | Val Acc: 0.6475
 Best site-MNIST_M                  (0)  | Epoch:5 | Val Acc: 0.5978
 Best site-MNIST_M                  (5)  | Epoch:5 | Val Acc: 0.6295
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.4674
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.5036
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (4) | Train Loss: 0.5851 | Train Acc: 0.8679
 Site-MNIST                     (6) | Train Loss: 0.6672 | Train Acc: 0.8368
 Site-USPS                      (3) | Train Loss: 0.6311 | Train Acc: 0.8625
 Site-USPS                      (3) | Train Loss: 0.6523 | Train Acc: 0.8484
 Site-SynthDigits               (2) | Train Loss: 0.9861 | Train Acc: 0.6900
 Site-SynthDigits               (5) | Train Loss: 0.9091 | Train Acc: 0.7507
 Site-MNIST_M                   (0) | Train Loss: 1.2590 | Train Acc: 0.6280
 Site-MNIST_M                   (0) | Train Loss: 1.2891 | Train Acc: 0.6466
 Site-SVHN                      (1) | Train Loss: 1.4353 | Train Acc: 0.5202
 Site-SVHN                      (1) | Train Loss: 1.3913 | Train Acc: 0.5453
Average Train Accuracy: 0.7197
 Site-MNIST                     (4) | Val  Loss: 0.5733 | Val  Acc: 0.8804
 Site-MNIST                     (6) | Val  Loss: 0.6491 | Val  Acc: 0.8597
 Site-USPS                      (3) | Val  Loss: 0.7652 | Val  Acc: 0.7826
 Site-USPS                      (3) | Val  Loss: 0.7226 | Val  Acc: 0.8273
 Site-SynthDigits               (2) | Val  Loss: 0.9292 | Val  Acc: 0.6630
 Site-SynthDigits               (5) | Val  Loss: 0.9283 | Val  Acc: 0.6835
 Site-MNIST_M                   (0) | Val  Loss: 1.2923 | Val  Acc: 0.6196
 Site-MNIST_M                   (0) | Val  Loss: 1.2434 | Val  Acc: 0.6511
 Site-SVHN                      (1) | Val  Loss: 1.4346 | Val  Acc: 0.5000
 Site-SVHN                      (1) | Val  Loss: 1.4310 | Val  Acc: 0.5360
Average Valid Accuracy: 0.7003
 Best site-MNIST                    (4)  | Epoch:6 | Val Acc: 0.8804
 Best site-MNIST                    (6)  | Epoch:6 | Val Acc: 0.8597
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7826
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8273
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6630
 Best site-SynthDigits              (5)  | Epoch:6 | Val Acc: 0.6835
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.6196
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.6511
 Best site-SVHN                     (1)  | Epoch:6 | Val Acc: 0.5000
 Best site-SVHN                     (1)  | Epoch:6 | Val Acc: 0.5360
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (3) | Train Loss: 0.5555 | Train Acc: 0.8491
 Site-MNIST                     (3) | Train Loss: 0.6388 | Train Acc: 0.8260
 Site-USPS                      (1) | Train Loss: 0.5921 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.6127 | Train Acc: 0.8493
 Site-SynthDigits               (2) | Train Loss: 0.9122 | Train Acc: 0.7035
 Site-SynthDigits               (2) | Train Loss: 0.8400 | Train Acc: 0.7623
 Site-MNIST_M                   (0) | Train Loss: 1.2041 | Train Acc: 0.6361
 Site-MNIST_M                   (5) | Train Loss: 1.2195 | Train Acc: 0.6610
 Site-SVHN                      (4) | Train Loss: 1.3742 | Train Acc: 0.5499
 Site-SVHN                      (6) | Train Loss: 1.3019 | Train Acc: 0.5821
Average Train Accuracy: 0.7276
 Site-MNIST                     (3) | Val  Loss: 0.5397 | Val  Acc: 0.8696
 Site-MNIST                     (3) | Val  Loss: 0.6219 | Val  Acc: 0.8417
 Site-USPS                      (1) | Val  Loss: 0.7313 | Val  Acc: 0.7826
 Site-USPS                      (1) | Val  Loss: 0.6854 | Val  Acc: 0.8201
 Site-SynthDigits               (2) | Val  Loss: 0.8632 | Val  Acc: 0.6848
 Site-SynthDigits               (2) | Val  Loss: 0.8617 | Val  Acc: 0.7050
 Site-MNIST_M                   (0) | Val  Loss: 1.2253 | Val  Acc: 0.6739
 Site-MNIST_M                   (5) | Val  Loss: 1.1750 | Val  Acc: 0.6906
 Site-SVHN                      (4) | Val  Loss: 1.3321 | Val  Acc: 0.5543
 Site-SVHN                      (6) | Val  Loss: 1.3475 | Val  Acc: 0.5683
Average Valid Accuracy: 0.7191
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8696
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8417
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.7826
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8201
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6848
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.7050
 Best site-MNIST_M                  (0)  | Epoch:7 | Val Acc: 0.6739
 Best site-MNIST_M                  (5)  | Epoch:7 | Val Acc: 0.6906
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.5543
 Best site-SVHN                     (6)  | Epoch:7 | Val Acc: 0.5683
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (5) | Train Loss: 0.5032 | Train Acc: 0.8679
 Site-MNIST                     (1) | Train Loss: 0.5927 | Train Acc: 0.8305
 Site-USPS                      (6) | Train Loss: 0.5928 | Train Acc: 0.8464
 Site-USPS                      (3) | Train Loss: 0.6085 | Train Acc: 0.8386
 Site-SynthDigits               (4) | Train Loss: 0.8324 | Train Acc: 0.7439
 Site-SynthDigits               (4) | Train Loss: 0.7678 | Train Acc: 0.7722
 Site-MNIST_M                   (2) | Train Loss: 1.1383 | Train Acc: 0.6442
 Site-MNIST_M                   (2) | Train Loss: 1.1382 | Train Acc: 0.6780
 Site-SVHN                      (0) | Train Loss: 1.2582 | Train Acc: 0.5768
 Site-SVHN                      (0) | Train Loss: 1.2030 | Train Acc: 0.6135
Average Train Accuracy: 0.7412
 Site-MNIST                     (5) | Val  Loss: 0.4996 | Val  Acc: 0.8804
 Site-MNIST                     (1) | Val  Loss: 0.5805 | Val  Acc: 0.8453
 Site-USPS                      (6) | Val  Loss: 0.7270 | Val  Acc: 0.7500
 Site-USPS                      (3) | Val  Loss: 0.6924 | Val  Acc: 0.7986
 Site-SynthDigits               (4) | Val  Loss: 0.7946 | Val  Acc: 0.6848
 Site-SynthDigits               (4) | Val  Loss: 0.7959 | Val  Acc: 0.7194
 Site-MNIST_M                   (2) | Val  Loss: 1.1754 | Val  Acc: 0.6522
 Site-MNIST_M                   (2) | Val  Loss: 1.1108 | Val  Acc: 0.6727
 Site-SVHN                      (0) | Val  Loss: 1.2414 | Val  Acc: 0.6196
 Site-SVHN                      (0) | Val  Loss: 1.2366 | Val  Acc: 0.6079
Average Valid Accuracy: 0.7231
 Best site-MNIST                    (5)  | Epoch:8 | Val Acc: 0.8804
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8453
 Best site-USPS                     (6)  | Epoch:8 | Val Acc: 0.7500
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7986
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.6848
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.7194
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.6522
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.6727
 Best site-SVHN                     (0)  | Epoch:8 | Val Acc: 0.6196
 Best site-SVHN                     (0)  | Epoch:8 | Val Acc: 0.6079
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (1) | Train Loss: 0.4566 | Train Acc: 0.8787
 Site-MNIST                     (1) | Train Loss: 0.5293 | Train Acc: 0.8592
 Site-USPS                      (0) | Train Loss: 0.5036 | Train Acc: 0.8544
 Site-USPS                      (0) | Train Loss: 0.5226 | Train Acc: 0.8610
 Site-SynthDigits               (4) | Train Loss: 0.8303 | Train Acc: 0.7439
 Site-SynthDigits               (6) | Train Loss: 0.7529 | Train Acc: 0.7821
 Site-MNIST_M                   (2) | Train Loss: 1.0924 | Train Acc: 0.6792
 Site-MNIST_M                   (5) | Train Loss: 1.0919 | Train Acc: 0.7031
 Site-SVHN                      (3) | Train Loss: 1.2929 | Train Acc: 0.5768
 Site-SVHN                      (3) | Train Loss: 1.2079 | Train Acc: 0.6036
Average Train Accuracy: 0.7542
 Site-MNIST                     (1) | Val  Loss: 0.4294 | Val  Acc: 0.9022
 Site-MNIST                     (1) | Val  Loss: 0.5143 | Val  Acc: 0.8777
 Site-USPS                      (0) | Val  Loss: 0.6563 | Val  Acc: 0.7935
 Site-USPS                      (0) | Val  Loss: 0.5926 | Val  Acc: 0.8201
 Site-SynthDigits               (4) | Val  Loss: 0.7994 | Val  Acc: 0.7283
 Site-SynthDigits               (6) | Val  Loss: 0.7760 | Val  Acc: 0.7266
 Site-MNIST_M                   (2) | Val  Loss: 1.1046 | Val  Acc: 0.6957
 Site-MNIST_M                   (5) | Val  Loss: 1.0482 | Val  Acc: 0.7266
 Site-SVHN                      (3) | Val  Loss: 1.2737 | Val  Acc: 0.5435
 Site-SVHN                      (3) | Val  Loss: 1.2672 | Val  Acc: 0.5827
Average Valid Accuracy: 0.7397
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.9022
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8777
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.7935
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8201
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7283
 Best site-SynthDigits              (6)  | Epoch:9 | Val Acc: 0.7266
 Best site-MNIST_M                  (2)  | Epoch:9 | Val Acc: 0.6957
 Best site-MNIST_M                  (5)  | Epoch:9 | Val Acc: 0.7266
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5435
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5827
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (0) | Train Loss: 0.4548 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.5370 | Train Acc: 0.8413
 Site-USPS                      (1) | Train Loss: 0.5117 | Train Acc: 0.8544
 Site-USPS                      (1) | Train Loss: 0.5290 | Train Acc: 0.8538
 Site-SynthDigits               (4) | Train Loss: 0.7419 | Train Acc: 0.7925
 Site-SynthDigits               (5) | Train Loss: 0.6915 | Train Acc: 0.7991
 Site-MNIST_M                   (3) | Train Loss: 1.0360 | Train Acc: 0.6739
 Site-MNIST_M                   (3) | Train Loss: 1.0303 | Train Acc: 0.7238
 Site-SVHN                      (6) | Train Loss: 1.1962 | Train Acc: 0.6092
 Site-SVHN                      (2) | Train Loss: 1.1313 | Train Acc: 0.6323
Average Train Accuracy: 0.7637
 Site-MNIST                     (0) | Val  Loss: 0.4234 | Val  Acc: 0.8696
 Site-MNIST                     (0) | Val  Loss: 0.5149 | Val  Acc: 0.8453
 Site-USPS                      (1) | Val  Loss: 0.6609 | Val  Acc: 0.7717
 Site-USPS                      (1) | Val  Loss: 0.6031 | Val  Acc: 0.8237
 Site-SynthDigits               (4) | Val  Loss: 0.7087 | Val  Acc: 0.7500
 Site-SynthDigits               (5) | Val  Loss: 0.7105 | Val  Acc: 0.7698
 Site-MNIST_M                   (3) | Val  Loss: 1.0493 | Val  Acc: 0.7174
 Site-MNIST_M                   (3) | Val  Loss: 0.9914 | Val  Acc: 0.7446
 Site-SVHN                      (6) | Val  Loss: 1.1604 | Val  Acc: 0.6522
 Site-SVHN                      (2) | Val  Loss: 1.1656 | Val  Acc: 0.6511
Average Valid Accuracy: 0.7595
 Best site-MNIST                    (0)  | Epoch:10 | Val Acc: 0.8696
 Best site-MNIST                    (0)  | Epoch:10 | Val Acc: 0.8453
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.7717
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.8237
 Best site-SynthDigits              (4)  | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits              (5)  | Epoch:10 | Val Acc: 0.7698
 Best site-MNIST_M                  (3)  | Epoch:10 | Val Acc: 0.7174
 Best site-MNIST_M                  (3)  | Epoch:10 | Val Acc: 0.7446
 Best site-SVHN                     (6)  | Epoch:10 | Val Acc: 0.6522
 Best site-SVHN                     (2)  | Epoch:10 | Val Acc: 0.6511
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (0) | Train Loss: 0.4082 | Train Acc: 0.8760
 Site-MNIST                     (0) | Train Loss: 0.4775 | Train Acc: 0.8628
 Site-USPS                      (4) | Train Loss: 0.4996 | Train Acc: 0.8544
 Site-USPS                      (6) | Train Loss: 0.5094 | Train Acc: 0.8592
 Site-SynthDigits               (2) | Train Loss: 0.6954 | Train Acc: 0.8086
 Site-SynthDigits               (2) | Train Loss: 0.6435 | Train Acc: 0.8188
 Site-MNIST_M                   (5) | Train Loss: 0.9985 | Train Acc: 0.6846
 Site-MNIST_M                   (3) | Train Loss: 0.9816 | Train Acc: 0.7444
 Site-SVHN                      (1) | Train Loss: 1.1541 | Train Acc: 0.6334
 Site-SVHN                      (1) | Train Loss: 1.0809 | Train Acc: 0.6574
Average Train Accuracy: 0.7800
 Site-MNIST                     (0) | Val  Loss: 0.3787 | Val  Acc: 0.9022
 Site-MNIST                     (0) | Val  Loss: 0.4724 | Val  Acc: 0.8813
 Site-USPS                      (4) | Val  Loss: 0.6507 | Val  Acc: 0.8043
 Site-USPS                      (6) | Val  Loss: 0.5864 | Val  Acc: 0.8381
 Site-SynthDigits               (2) | Val  Loss: 0.6679 | Val  Acc: 0.7717
 Site-SynthDigits               (2) | Val  Loss: 0.6621 | Val  Acc: 0.7878
 Site-MNIST_M                   (5) | Val  Loss: 1.0160 | Val  Acc: 0.6957
 Site-MNIST_M                   (3) | Val  Loss: 0.9514 | Val  Acc: 0.7446
 Site-SVHN                      (1) | Val  Loss: 1.1160 | Val  Acc: 0.6304
 Site-SVHN                      (1) | Val  Loss: 1.1170 | Val  Acc: 0.6583
Average Valid Accuracy: 0.7714
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.9022
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8813
 Best site-USPS                     (4)  | Epoch:11 | Val Acc: 0.8043
 Best site-USPS                     (6)  | Epoch:11 | Val Acc: 0.8381
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7717
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7878
 Best site-MNIST_M                  (5)  | Epoch:11 | Val Acc: 0.6957
 Best site-MNIST_M                  (3)  | Epoch:11 | Val Acc: 0.7446
 Best site-SVHN                     (1)  | Epoch:11 | Val Acc: 0.6304
 Best site-SVHN                     (1)  | Epoch:11 | Val Acc: 0.6583
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 12 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (3) | Train Loss: 0.3812 | Train Acc: 0.8922
 Site-MNIST                     (3) | Train Loss: 0.4531 | Train Acc: 0.8753
 Site-USPS                      (1) | Train Loss: 0.4726 | Train Acc: 0.8598
 Site-USPS                      (1) | Train Loss: 0.4893 | Train Acc: 0.8583
 Site-SynthDigits               (4) | Train Loss: 0.6530 | Train Acc: 0.8302
 Site-SynthDigits               (6) | Train Loss: 0.5990 | Train Acc: 0.8404
 Site-MNIST_M                   (5) | Train Loss: 0.9555 | Train Acc: 0.7089
 Site-MNIST_M                   (0) | Train Loss: 0.9348 | Train Acc: 0.7498
 Site-SVHN                      (2) | Train Loss: 1.1164 | Train Acc: 0.6415
 Site-SVHN                      (2) | Train Loss: 1.0320 | Train Acc: 0.6726
Average Train Accuracy: 0.7929
 Site-MNIST                     (3) | Val  Loss: 0.3524 | Val  Acc: 0.9022
 Site-MNIST                     (3) | Val  Loss: 0.4451 | Val  Acc: 0.8921
 Site-USPS                      (1) | Val  Loss: 0.6271 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.5613 | Val  Acc: 0.8345
 Site-SynthDigits               (4) | Val  Loss: 0.6186 | Val  Acc: 0.8043
 Site-SynthDigits               (6) | Val  Loss: 0.6157 | Val  Acc: 0.8237
 Site-MNIST_M                   (5) | Val  Loss: 0.9719 | Val  Acc: 0.6957
 Site-MNIST_M                   (0) | Val  Loss: 0.9022 | Val  Acc: 0.7518
 Site-SVHN                      (2) | Val  Loss: 1.0786 | Val  Acc: 0.6739
 Site-SVHN                      (2) | Val  Loss: 1.0737 | Val  Acc: 0.6727
Average Valid Accuracy: 0.7855
 Best site-MNIST                    (3)  | Epoch:12 | Val Acc: 0.9022
 Best site-MNIST                    (3)  | Epoch:12 | Val Acc: 0.8921
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8345
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.8043
 Best site-SynthDigits              (6)  | Epoch:12 | Val Acc: 0.8237
 Best site-MNIST_M                  (5)  | Epoch:12 | Val Acc: 0.6957
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.7518
 Best site-SVHN                     (2)  | Epoch:12 | Val Acc: 0.6739
 Best site-SVHN                     (2)  | Epoch:12 | Val Acc: 0.6727
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (0) | Train Loss: 0.3551 | Train Acc: 0.9057
 Site-MNIST                     (0) | Train Loss: 0.4264 | Train Acc: 0.8789
 Site-USPS                      (2) | Train Loss: 0.4506 | Train Acc: 0.8679
 Site-USPS                      (2) | Train Loss: 0.4649 | Train Acc: 0.8628
 Site-SynthDigits               (5) | Train Loss: 0.6407 | Train Acc: 0.8221
 Site-SynthDigits               (4) | Train Loss: 0.5895 | Train Acc: 0.8314
 Site-MNIST_M                   (6) | Train Loss: 0.9147 | Train Acc: 0.7439
 Site-MNIST_M                   (3) | Train Loss: 0.8958 | Train Acc: 0.7525
 Site-SVHN                      (1) | Train Loss: 1.0896 | Train Acc: 0.6388
 Site-SVHN                      (1) | Train Loss: 1.0119 | Train Acc: 0.6789
Average Train Accuracy: 0.7983
 Site-MNIST                     (0) | Val  Loss: 0.3221 | Val  Acc: 0.9022
 Site-MNIST                     (0) | Val  Loss: 0.4184 | Val  Acc: 0.9029
 Site-USPS                      (2) | Val  Loss: 0.5958 | Val  Acc: 0.7935
 Site-USPS                      (2) | Val  Loss: 0.5321 | Val  Acc: 0.8345
 Site-SynthDigits               (5) | Val  Loss: 0.6175 | Val  Acc: 0.7935
 Site-SynthDigits               (4) | Val  Loss: 0.6101 | Val  Acc: 0.8022
 Site-MNIST_M                   (6) | Val  Loss: 0.9322 | Val  Acc: 0.7174
 Site-MNIST_M                   (3) | Val  Loss: 0.8632 | Val  Acc: 0.7662
 Site-SVHN                      (1) | Val  Loss: 1.0500 | Val  Acc: 0.6739
 Site-SVHN                      (1) | Val  Loss: 1.0522 | Val  Acc: 0.6691
Average Valid Accuracy: 0.7855
============ Train epoch 14 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (3) | Train Loss: 0.3319 | Train Acc: 0.9084
 Site-MNIST                     (3) | Train Loss: 0.4063 | Train Acc: 0.8861
 Site-USPS                      (4) | Train Loss: 0.4246 | Train Acc: 0.8679
 Site-USPS                      (4) | Train Loss: 0.4264 | Train Acc: 0.8709
 Site-SynthDigits               (2) | Train Loss: 0.6259 | Train Acc: 0.8248
 Site-SynthDigits               (6) | Train Loss: 0.5662 | Train Acc: 0.8341
 Site-MNIST_M                   (0) | Train Loss: 0.8735 | Train Acc: 0.7466
 Site-MNIST_M                   (5) | Train Loss: 0.8541 | Train Acc: 0.7596
 Site-SVHN                      (1) | Train Loss: 1.0725 | Train Acc: 0.6496
 Site-SVHN                      (1) | Train Loss: 0.9729 | Train Acc: 0.6897
Average Train Accuracy: 0.8038
 Site-MNIST                     (3) | Val  Loss: 0.3017 | Val  Acc: 0.9130
 Site-MNIST                     (3) | Val  Loss: 0.3984 | Val  Acc: 0.9101
 Site-USPS                      (4) | Val  Loss: 0.5731 | Val  Acc: 0.7935
 Site-USPS                      (4) | Val  Loss: 0.5031 | Val  Acc: 0.8309
 Site-SynthDigits               (2) | Val  Loss: 0.6086 | Val  Acc: 0.7826
 Site-SynthDigits               (6) | Val  Loss: 0.5935 | Val  Acc: 0.7950
 Site-MNIST_M                   (0) | Val  Loss: 0.8978 | Val  Acc: 0.7174
 Site-MNIST_M                   (5) | Val  Loss: 0.8208 | Val  Acc: 0.7626
 Site-SVHN                      (1) | Val  Loss: 1.0196 | Val  Acc: 0.7065
 Site-SVHN                      (1) | Val  Loss: 1.0150 | Val  Acc: 0.6727
Average Valid Accuracy: 0.7884
 Best site-MNIST                    (3)  | Epoch:14 | Val Acc: 0.9130
 Best site-MNIST                    (3)  | Epoch:14 | Val Acc: 0.9101
 Best site-USPS                     (4)  | Epoch:14 | Val Acc: 0.7935
 Best site-USPS                     (4)  | Epoch:14 | Val Acc: 0.8309
 Best site-SynthDigits              (2)  | Epoch:14 | Val Acc: 0.7826
 Best site-SynthDigits              (6)  | Epoch:14 | Val Acc: 0.7950
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.7174
 Best site-MNIST_M                  (5)  | Epoch:14 | Val Acc: 0.7626
 Best site-SVHN                     (1)  | Epoch:14 | Val Acc: 0.7065
 Best site-SVHN                     (1)  | Epoch:14 | Val Acc: 0.6727
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (0) | Train Loss: 0.3175 | Train Acc: 0.9245
 Site-MNIST                     (0) | Train Loss: 0.3909 | Train Acc: 0.8924
 Site-USPS                      (4) | Train Loss: 0.4119 | Train Acc: 0.8679
 Site-USPS                      (6) | Train Loss: 0.4131 | Train Acc: 0.8771
 Site-SynthDigits               (1) | Train Loss: 0.6111 | Train Acc: 0.8275
 Site-SynthDigits               (1) | Train Loss: 0.5539 | Train Acc: 0.8466
 Site-MNIST_M                   (3) | Train Loss: 0.8338 | Train Acc: 0.7601
 Site-MNIST_M                   (5) | Train Loss: 0.8138 | Train Acc: 0.7740
 Site-SVHN                      (2) | Train Loss: 1.0932 | Train Acc: 0.6334
 Site-SVHN                      (2) | Train Loss: 0.9645 | Train Acc: 0.6888
Average Train Accuracy: 0.8092
 Site-MNIST                     (0) | Val  Loss: 0.2841 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.3848 | Val  Acc: 0.9173
 Site-USPS                      (4) | Val  Loss: 0.5613 | Val  Acc: 0.8152
 Site-USPS                      (6) | Val  Loss: 0.4862 | Val  Acc: 0.8453
 Site-SynthDigits               (1) | Val  Loss: 0.5978 | Val  Acc: 0.8043
 Site-SynthDigits               (1) | Val  Loss: 0.5733 | Val  Acc: 0.8201
 Site-MNIST_M                   (3) | Val  Loss: 0.8651 | Val  Acc: 0.7174
 Site-MNIST_M                   (5) | Val  Loss: 0.7847 | Val  Acc: 0.7914
 Site-SVHN                      (2) | Val  Loss: 1.0077 | Val  Acc: 0.6848
 Site-SVHN                      (2) | Val  Loss: 1.0210 | Val  Acc: 0.6799
Average Valid Accuracy: 0.8010
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9348
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9173
 Best site-USPS                     (4)  | Epoch:15 | Val Acc: 0.8152
 Best site-USPS                     (6)  | Epoch:15 | Val Acc: 0.8453
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8043
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8201
 Best site-MNIST_M                  (3)  | Epoch:15 | Val Acc: 0.7174
 Best site-MNIST_M                  (5)  | Epoch:15 | Val Acc: 0.7914
 Best site-SVHN                     (2)  | Epoch:15 | Val Acc: 0.6848
 Best site-SVHN                     (2)  | Epoch:15 | Val Acc: 0.6799
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.3249 | Train Acc: 0.9164
 Site-MNIST                     (1) | Train Loss: 0.3892 | Train Acc: 0.8879
 Site-USPS                      (2) | Train Loss: 0.4110 | Train Acc: 0.8814
 Site-USPS                      (2) | Train Loss: 0.4181 | Train Acc: 0.8825
 Site-SynthDigits               (4) | Train Loss: 0.5652 | Train Acc: 0.8437
 Site-SynthDigits               (4) | Train Loss: 0.5178 | Train Acc: 0.8735
 Site-MNIST_M                   (3) | Train Loss: 0.8301 | Train Acc: 0.7439
 Site-MNIST_M                   (5) | Train Loss: 0.7965 | Train Acc: 0.7749
 Site-SVHN                      (0) | Train Loss: 1.0340 | Train Acc: 0.6631
 Site-SVHN                      (6) | Train Loss: 0.9148 | Train Acc: 0.7085
Average Train Accuracy: 0.8176
 Site-MNIST                     (1) | Val  Loss: 0.2863 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.3917 | Val  Acc: 0.9173
 Site-USPS                      (2) | Val  Loss: 0.5573 | Val  Acc: 0.8152
 Site-USPS                      (2) | Val  Loss: 0.4862 | Val  Acc: 0.8525
 Site-SynthDigits               (4) | Val  Loss: 0.5558 | Val  Acc: 0.8043
 Site-SynthDigits               (4) | Val  Loss: 0.5314 | Val  Acc: 0.8345
 Site-MNIST_M                   (3) | Val  Loss: 0.8477 | Val  Acc: 0.7283
 Site-MNIST_M                   (5) | Val  Loss: 0.7746 | Val  Acc: 0.7806
 Site-SVHN                      (0) | Val  Loss: 0.9621 | Val  Acc: 0.7174
 Site-SVHN                      (6) | Val  Loss: 0.9711 | Val  Acc: 0.7122
Average Valid Accuracy: 0.8097
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9348
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9173
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.8152
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.8525
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.8043
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.8345
 Best site-MNIST_M                  (3)  | Epoch:16 | Val Acc: 0.7283
 Best site-MNIST_M                  (5)  | Epoch:16 | Val Acc: 0.7806
 Best site-SVHN                     (0)  | Epoch:16 | Val Acc: 0.7174
 Best site-SVHN                     (6)  | Epoch:16 | Val Acc: 0.7122
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (1) | Train Loss: 0.3091 | Train Acc: 0.9164
 Site-MNIST                     (1) | Train Loss: 0.3806 | Train Acc: 0.8906
 Site-USPS                      (2) | Train Loss: 0.3936 | Train Acc: 0.8787
 Site-USPS                      (2) | Train Loss: 0.4117 | Train Acc: 0.8771
 Site-SynthDigits               (4) | Train Loss: 0.5509 | Train Acc: 0.8518
 Site-SynthDigits               (6) | Train Loss: 0.5092 | Train Acc: 0.8592
 Site-MNIST_M                   (3) | Train Loss: 0.7883 | Train Acc: 0.7601
 Site-MNIST_M                   (5) | Train Loss: 0.7685 | Train Acc: 0.7874
 Site-SVHN                      (0) | Train Loss: 1.0312 | Train Acc: 0.6442
 Site-SVHN                      (0) | Train Loss: 0.9223 | Train Acc: 0.7040
Average Train Accuracy: 0.8170
 Site-MNIST                     (1) | Val  Loss: 0.2716 | Val  Acc: 0.9130
 Site-MNIST                     (1) | Val  Loss: 0.3802 | Val  Acc: 0.9209
 Site-USPS                      (2) | Val  Loss: 0.5415 | Val  Acc: 0.8043
 Site-USPS                      (2) | Val  Loss: 0.4697 | Val  Acc: 0.8489
 Site-SynthDigits               (4) | Val  Loss: 0.5329 | Val  Acc: 0.8152
 Site-SynthDigits               (6) | Val  Loss: 0.5217 | Val  Acc: 0.8453
 Site-MNIST_M                   (3) | Val  Loss: 0.8216 | Val  Acc: 0.7283
 Site-MNIST_M                   (5) | Val  Loss: 0.7438 | Val  Acc: 0.7878
 Site-SVHN                      (0) | Val  Loss: 0.9623 | Val  Acc: 0.7283
 Site-SVHN                      (0) | Val  Loss: 0.9688 | Val  Acc: 0.7014
Average Valid Accuracy: 0.8093
============ Train epoch 18 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (1) | Train Loss: 0.2845 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.3535 | Train Acc: 0.9040
 Site-USPS                      (2) | Train Loss: 0.3759 | Train Acc: 0.8706
 Site-USPS                      (6) | Train Loss: 0.3750 | Train Acc: 0.8870
 Site-SynthDigits               (4) | Train Loss: 0.5699 | Train Acc: 0.8383
 Site-SynthDigits               (4) | Train Loss: 0.5114 | Train Acc: 0.8538
 Site-MNIST_M                   (5) | Train Loss: 0.7719 | Train Acc: 0.7709
 Site-MNIST_M                   (3) | Train Loss: 0.7448 | Train Acc: 0.7830
 Site-SVHN                      (0) | Train Loss: 1.0287 | Train Acc: 0.6685
 Site-SVHN                      (0) | Train Loss: 0.8987 | Train Acc: 0.7094
Average Train Accuracy: 0.8207
 Site-MNIST                     (1) | Val  Loss: 0.2492 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.3518 | Val  Acc: 0.9281
 Site-USPS                      (2) | Val  Loss: 0.5197 | Val  Acc: 0.8043
 Site-USPS                      (6) | Val  Loss: 0.4387 | Val  Acc: 0.8417
 Site-SynthDigits               (4) | Val  Loss: 0.5664 | Val  Acc: 0.7935
 Site-SynthDigits               (4) | Val  Loss: 0.5356 | Val  Acc: 0.8201
 Site-MNIST_M                   (5) | Val  Loss: 0.8022 | Val  Acc: 0.7609
 Site-MNIST_M                   (3) | Val  Loss: 0.7263 | Val  Acc: 0.7950
 Site-SVHN                      (0) | Val  Loss: 0.9381 | Val  Acc: 0.7283
 Site-SVHN                      (0) | Val  Loss: 0.9532 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8126
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9281
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8043
 Best site-USPS                     (6)  | Epoch:18 | Val Acc: 0.8417
 Best site-SynthDigits              (4)  | Epoch:18 | Val Acc: 0.7935
 Best site-SynthDigits              (4)  | Epoch:18 | Val Acc: 0.8201
 Best site-MNIST_M                  (5)  | Epoch:18 | Val Acc: 0.7609
 Best site-MNIST_M                  (3)  | Epoch:18 | Val Acc: 0.7950
 Best site-SVHN                     (0)  | Epoch:18 | Val Acc: 0.7283
 Best site-SVHN                     (0)  | Epoch:18 | Val Acc: 0.7086
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.2813 | Train Acc: 0.9191
 Site-MNIST                     (0) | Train Loss: 0.3394 | Train Acc: 0.9058
 Site-USPS                      (4) | Train Loss: 0.3784 | Train Acc: 0.8787
 Site-USPS                      (6) | Train Loss: 0.3746 | Train Acc: 0.8852
 Site-SynthDigits               (1) | Train Loss: 0.5153 | Train Acc: 0.8625
 Site-SynthDigits               (1) | Train Loss: 0.4699 | Train Acc: 0.8771
 Site-MNIST_M                   (3) | Train Loss: 0.7742 | Train Acc: 0.7574
 Site-MNIST_M                   (5) | Train Loss: 0.7335 | Train Acc: 0.7955
 Site-SVHN                      (2) | Train Loss: 0.9799 | Train Acc: 0.6873
 Site-SVHN                      (2) | Train Loss: 0.8708 | Train Acc: 0.7327
Average Train Accuracy: 0.8302
 Site-MNIST                     (0) | Val  Loss: 0.2437 | Val  Acc: 0.9239
 Site-MNIST                     (0) | Val  Loss: 0.3480 | Val  Acc: 0.9281
 Site-USPS                      (4) | Val  Loss: 0.5198 | Val  Acc: 0.8152
 Site-USPS                      (6) | Val  Loss: 0.4405 | Val  Acc: 0.8489
 Site-SynthDigits               (1) | Val  Loss: 0.5069 | Val  Acc: 0.8478
 Site-SynthDigits               (1) | Val  Loss: 0.4859 | Val  Acc: 0.8489
 Site-MNIST_M                   (3) | Val  Loss: 0.7850 | Val  Acc: 0.7391
 Site-MNIST_M                   (5) | Val  Loss: 0.7195 | Val  Acc: 0.7914
 Site-SVHN                      (2) | Val  Loss: 0.9134 | Val  Acc: 0.7609
 Site-SVHN                      (2) | Val  Loss: 0.9119 | Val  Acc: 0.7482
Average Valid Accuracy: 0.8252
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9239
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9281
 Best site-USPS                     (4)  | Epoch:19 | Val Acc: 0.8152
 Best site-USPS                     (6)  | Epoch:19 | Val Acc: 0.8489
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8478
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8489
 Best site-MNIST_M                  (3)  | Epoch:19 | Val Acc: 0.7391
 Best site-MNIST_M                  (5)  | Epoch:19 | Val Acc: 0.7914
 Best site-SVHN                     (2)  | Epoch:19 | Val Acc: 0.7609
 Best site-SVHN                     (2)  | Epoch:19 | Val Acc: 0.7482
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (1) | Train Loss: 0.2677 | Train Acc: 0.9272
 Site-MNIST                     (1) | Train Loss: 0.3304 | Train Acc: 0.9094
 Site-USPS                      (5) | Train Loss: 0.3683 | Train Acc: 0.8814
 Site-USPS                      (4) | Train Loss: 0.3665 | Train Acc: 0.8870
 Site-SynthDigits               (2) | Train Loss: 0.4956 | Train Acc: 0.8625
 Site-SynthDigits               (2) | Train Loss: 0.4539 | Train Acc: 0.8789
 Site-MNIST_M                   (3) | Train Loss: 0.7266 | Train Acc: 0.7628
 Site-MNIST_M                   (3) | Train Loss: 0.7009 | Train Acc: 0.8027
 Site-SVHN                      (0) | Train Loss: 0.9790 | Train Acc: 0.6658
 Site-SVHN                      (6) | Train Loss: 0.8655 | Train Acc: 0.7300
Average Train Accuracy: 0.8308
 Site-MNIST                     (1) | Val  Loss: 0.2254 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.3323 | Val  Acc: 0.9317
 Site-USPS                      (5) | Val  Loss: 0.5094 | Val  Acc: 0.8261
 Site-USPS                      (4) | Val  Loss: 0.4243 | Val  Acc: 0.8561
 Site-SynthDigits               (2) | Val  Loss: 0.4815 | Val  Acc: 0.8478
 Site-SynthDigits               (2) | Val  Loss: 0.4674 | Val  Acc: 0.8525
 Site-MNIST_M                   (3) | Val  Loss: 0.7414 | Val  Acc: 0.7609
 Site-MNIST_M                   (3) | Val  Loss: 0.6753 | Val  Acc: 0.8022
 Site-SVHN                      (0) | Val  Loss: 0.9156 | Val  Acc: 0.7609
 Site-SVHN                      (6) | Val  Loss: 0.9130 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8314
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9317
 Best site-USPS                     (5)  | Epoch:20 | Val Acc: 0.8261
 Best site-USPS                     (4)  | Epoch:20 | Val Acc: 0.8561
 Best site-SynthDigits              (2)  | Epoch:20 | Val Acc: 0.8478
 Best site-SynthDigits              (2)  | Epoch:20 | Val Acc: 0.8525
 Best site-MNIST_M                  (3)  | Epoch:20 | Val Acc: 0.7609
 Best site-MNIST_M                  (3)  | Epoch:20 | Val Acc: 0.8022
 Best site-SVHN                     (0)  | Epoch:20 | Val Acc: 0.7609
 Best site-SVHN                     (6)  | Epoch:20 | Val Acc: 0.7302
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (0) | Train Loss: 0.2663 | Train Acc: 0.9191
 Site-MNIST                     (0) | Train Loss: 0.3254 | Train Acc: 0.9085
 Site-USPS                      (1) | Train Loss: 0.3666 | Train Acc: 0.8868
 Site-USPS                      (1) | Train Loss: 0.3517 | Train Acc: 0.8924
 Site-SynthDigits               (4) | Train Loss: 0.4930 | Train Acc: 0.8518
 Site-SynthDigits               (5) | Train Loss: 0.4510 | Train Acc: 0.8762
 Site-MNIST_M                   (6) | Train Loss: 0.7257 | Train Acc: 0.7817
 Site-MNIST_M                   (2) | Train Loss: 0.6955 | Train Acc: 0.8072
 Site-SVHN                      (3) | Train Loss: 0.9500 | Train Acc: 0.6819
 Site-SVHN                      (3) | Train Loss: 0.8423 | Train Acc: 0.7399
Average Train Accuracy: 0.8346
 Site-MNIST                     (0) | Val  Loss: 0.2269 | Val  Acc: 0.9239
 Site-MNIST                     (0) | Val  Loss: 0.3299 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.4946 | Val  Acc: 0.8261
 Site-USPS                      (1) | Val  Loss: 0.4199 | Val  Acc: 0.8561
 Site-SynthDigits               (4) | Val  Loss: 0.4870 | Val  Acc: 0.8478
 Site-SynthDigits               (5) | Val  Loss: 0.4632 | Val  Acc: 0.8525
 Site-MNIST_M                   (6) | Val  Loss: 0.7297 | Val  Acc: 0.7717
 Site-MNIST_M                   (2) | Val  Loss: 0.6648 | Val  Acc: 0.8022
 Site-SVHN                      (3) | Val  Loss: 0.8880 | Val  Acc: 0.7609
 Site-SVHN                      (3) | Val  Loss: 0.8870 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8307
============ Train epoch 22 ============
cnt=[2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (2) | Train Loss: 0.2575 | Train Acc: 0.9191
 Site-MNIST                     (2) | Train Loss: 0.3135 | Train Acc: 0.9157
 Site-USPS                      (4) | Train Loss: 0.3454 | Train Acc: 0.8841
 Site-USPS                      (6) | Train Loss: 0.3414 | Train Acc: 0.9013
 Site-SynthDigits               (0) | Train Loss: 0.4917 | Train Acc: 0.8571
 Site-SynthDigits               (0) | Train Loss: 0.4494 | Train Acc: 0.8780
 Site-MNIST_M                   (1) | Train Loss: 0.7167 | Train Acc: 0.7736
 Site-MNIST_M                   (5) | Train Loss: 0.6674 | Train Acc: 0.8108
 Site-SVHN                      (3) | Train Loss: 0.9349 | Train Acc: 0.6819
 Site-SVHN                      (3) | Train Loss: 0.8123 | Train Acc: 0.7507
Average Train Accuracy: 0.8372
 Site-MNIST                     (2) | Val  Loss: 0.2201 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.3176 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.4711 | Val  Acc: 0.8261
 Site-USPS                      (6) | Val  Loss: 0.4009 | Val  Acc: 0.8669
 Site-SynthDigits               (0) | Val  Loss: 0.4945 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4635 | Val  Acc: 0.8561
 Site-MNIST_M                   (1) | Val  Loss: 0.7189 | Val  Acc: 0.7717
 Site-MNIST_M                   (5) | Val  Loss: 0.6552 | Val  Acc: 0.7986
 Site-SVHN                      (3) | Val  Loss: 0.8558 | Val  Acc: 0.7609
 Site-SVHN                      (3) | Val  Loss: 0.8625 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8332
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9348
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9317
 Best site-USPS                     (4)  | Epoch:22 | Val Acc: 0.8261
 Best site-USPS                     (6)  | Epoch:22 | Val Acc: 0.8669
 Best site-SynthDigits              (0)  | Epoch:22 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:22 | Val Acc: 0.8561
 Best site-MNIST_M                  (1)  | Epoch:22 | Val Acc: 0.7717
 Best site-MNIST_M                  (5)  | Epoch:22 | Val Acc: 0.7986
 Best site-SVHN                     (3)  | Epoch:22 | Val Acc: 0.7609
 Best site-SVHN                     (3)  | Epoch:22 | Val Acc: 0.7374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (3) | Train Loss: 0.2497 | Train Acc: 0.9218
 Site-MNIST                     (6) | Train Loss: 0.3056 | Train Acc: 0.9157
 Site-USPS                      (1) | Train Loss: 0.3368 | Train Acc: 0.8814
 Site-USPS                      (5) | Train Loss: 0.3293 | Train Acc: 0.9058
 Site-SynthDigits               (4) | Train Loss: 0.4700 | Train Acc: 0.8625
 Site-SynthDigits               (4) | Train Loss: 0.4353 | Train Acc: 0.8888
 Site-MNIST_M                   (2) | Train Loss: 0.6887 | Train Acc: 0.7763
 Site-MNIST_M                   (2) | Train Loss: 0.6566 | Train Acc: 0.8135
 Site-SVHN                      (0) | Train Loss: 0.9296 | Train Acc: 0.7008
 Site-SVHN                      (0) | Train Loss: 0.8083 | Train Acc: 0.7444
Average Train Accuracy: 0.8411
 Site-MNIST                     (3) | Val  Loss: 0.2113 | Val  Acc: 0.9348
 Site-MNIST                     (6) | Val  Loss: 0.3065 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.4563 | Val  Acc: 0.8152
 Site-USPS                      (5) | Val  Loss: 0.3879 | Val  Acc: 0.8597
 Site-SynthDigits               (4) | Val  Loss: 0.4771 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.4425 | Val  Acc: 0.8669
 Site-MNIST_M                   (2) | Val  Loss: 0.6877 | Val  Acc: 0.7826
 Site-MNIST_M                   (2) | Val  Loss: 0.6267 | Val  Acc: 0.8201
 Site-SVHN                      (0) | Val  Loss: 0.8663 | Val  Acc: 0.7500
 Site-SVHN                      (0) | Val  Loss: 0.8673 | Val  Acc: 0.7446
Average Valid Accuracy: 0.8375
 Best site-MNIST                    (3)  | Epoch:23 | Val Acc: 0.9348
 Best site-MNIST                    (6)  | Epoch:23 | Val Acc: 0.9317
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.8152
 Best site-USPS                     (5)  | Epoch:23 | Val Acc: 0.8597
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8696
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8669
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.7826
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.8201
 Best site-SVHN                     (0)  | Epoch:23 | Val Acc: 0.7500
 Best site-SVHN                     (0)  | Epoch:23 | Val Acc: 0.7446
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.2488 | Train Acc: 0.9245
 Site-MNIST                     (0) | Train Loss: 0.3017 | Train Acc: 0.9148
 Site-USPS                      (2) | Train Loss: 0.3490 | Train Acc: 0.8787
 Site-USPS                      (6) | Train Loss: 0.3499 | Train Acc: 0.8996
 Site-SynthDigits               (4) | Train Loss: 0.4497 | Train Acc: 0.8760
 Site-SynthDigits               (5) | Train Loss: 0.4062 | Train Acc: 0.8951
 Site-MNIST_M                   (3) | Train Loss: 0.6807 | Train Acc: 0.7682
 Site-MNIST_M                   (3) | Train Loss: 0.6435 | Train Acc: 0.8135
 Site-SVHN                      (1) | Train Loss: 0.9059 | Train Acc: 0.6900
 Site-SVHN                      (1) | Train Loss: 0.7889 | Train Acc: 0.7650
Average Train Accuracy: 0.8425
 Site-MNIST                     (0) | Val  Loss: 0.2146 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.3163 | Val  Acc: 0.9281
 Site-USPS                      (2) | Val  Loss: 0.4845 | Val  Acc: 0.8152
 Site-USPS                      (6) | Val  Loss: 0.4116 | Val  Acc: 0.8633
 Site-SynthDigits               (4) | Val  Loss: 0.4392 | Val  Acc: 0.8804
 Site-SynthDigits               (5) | Val  Loss: 0.4215 | Val  Acc: 0.8813
 Site-MNIST_M                   (3) | Val  Loss: 0.6808 | Val  Acc: 0.7826
 Site-MNIST_M                   (3) | Val  Loss: 0.6212 | Val  Acc: 0.8058
 Site-SVHN                      (1) | Val  Loss: 0.8284 | Val  Acc: 0.7717
 Site-SVHN                      (1) | Val  Loss: 0.8236 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8422
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9348
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9281
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8152
 Best site-USPS                     (6)  | Epoch:24 | Val Acc: 0.8633
 Best site-SynthDigits              (4)  | Epoch:24 | Val Acc: 0.8804
 Best site-SynthDigits              (5)  | Epoch:24 | Val Acc: 0.8813
 Best site-MNIST_M                  (3)  | Epoch:24 | Val Acc: 0.7826
 Best site-MNIST_M                  (3)  | Epoch:24 | Val Acc: 0.8058
 Best site-SVHN                     (1)  | Epoch:24 | Val Acc: 0.7717
 Best site-SVHN                     (1)  | Epoch:24 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (3) | Train Loss: 0.2441 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3055 | Train Acc: 0.9121
 Site-USPS                      (4) | Train Loss: 0.3211 | Train Acc: 0.8922
 Site-USPS                      (6) | Train Loss: 0.3251 | Train Acc: 0.9067
 Site-SynthDigits               (0) | Train Loss: 0.4472 | Train Acc: 0.8706
 Site-SynthDigits               (0) | Train Loss: 0.4119 | Train Acc: 0.8897
 Site-MNIST_M                   (1) | Train Loss: 0.6728 | Train Acc: 0.7871
 Site-MNIST_M                   (1) | Train Loss: 0.6300 | Train Acc: 0.8206
 Site-SVHN                      (2) | Train Loss: 0.9131 | Train Acc: 0.6927
 Site-SVHN                      (5) | Train Loss: 0.7862 | Train Acc: 0.7641
Average Train Accuracy: 0.8460
 Site-MNIST                     (3) | Val  Loss: 0.2107 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.3052 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.4421 | Val  Acc: 0.8152
 Site-USPS                      (6) | Val  Loss: 0.3755 | Val  Acc: 0.8705
 Site-SynthDigits               (0) | Val  Loss: 0.4430 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.4217 | Val  Acc: 0.8741
 Site-MNIST_M                   (1) | Val  Loss: 0.6722 | Val  Acc: 0.7935
 Site-MNIST_M                   (1) | Val  Loss: 0.6094 | Val  Acc: 0.8058
 Site-SVHN                      (2) | Val  Loss: 0.8207 | Val  Acc: 0.7717
 Site-SVHN                      (5) | Val  Loss: 0.8311 | Val  Acc: 0.7518
Average Valid Accuracy: 0.8397
============ Train epoch 26 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (3) | Train Loss: 0.2423 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3058 | Train Acc: 0.9067
 Site-USPS                      (4) | Train Loss: 0.3208 | Train Acc: 0.8895
 Site-USPS                      (4) | Train Loss: 0.3159 | Train Acc: 0.9004
 Site-SynthDigits               (0) | Train Loss: 0.4296 | Train Acc: 0.8760
 Site-SynthDigits               (0) | Train Loss: 0.4015 | Train Acc: 0.8861
 Site-MNIST_M                   (6) | Train Loss: 0.6523 | Train Acc: 0.7978
 Site-MNIST_M                   (1) | Train Loss: 0.6287 | Train Acc: 0.8224
 Site-SVHN                      (2) | Train Loss: 0.9033 | Train Acc: 0.6981
 Site-SVHN                      (5) | Train Loss: 0.7792 | Train Acc: 0.7668
Average Train Accuracy: 0.8468
 Site-MNIST                     (3) | Val  Loss: 0.2135 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.3060 | Val  Acc: 0.9245
 Site-USPS                      (4) | Val  Loss: 0.4360 | Val  Acc: 0.8152
 Site-USPS                      (4) | Val  Loss: 0.3725 | Val  Acc: 0.8669
 Site-SynthDigits               (0) | Val  Loss: 0.4290 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.4095 | Val  Acc: 0.8669
 Site-MNIST_M                   (6) | Val  Loss: 0.6493 | Val  Acc: 0.8043
 Site-MNIST_M                   (1) | Val  Loss: 0.5906 | Val  Acc: 0.8201
 Site-SVHN                      (2) | Val  Loss: 0.8003 | Val  Acc: 0.7717
 Site-SVHN                      (5) | Val  Loss: 0.8128 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8408
============ Train epoch 27 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (3) | Train Loss: 0.2350 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2929 | Train Acc: 0.9148
 Site-USPS                      (1) | Train Loss: 0.3024 | Train Acc: 0.9030
 Site-USPS                      (5) | Train Loss: 0.2971 | Train Acc: 0.9085
 Site-SynthDigits               (4) | Train Loss: 0.4465 | Train Acc: 0.8679
 Site-SynthDigits               (4) | Train Loss: 0.4061 | Train Acc: 0.8852
 Site-MNIST_M                   (0) | Train Loss: 0.6391 | Train Acc: 0.7925
 Site-MNIST_M                   (0) | Train Loss: 0.6062 | Train Acc: 0.8260
 Site-SVHN                      (2) | Train Loss: 0.9019 | Train Acc: 0.7062
 Site-SVHN                      (6) | Train Loss: 0.7597 | Train Acc: 0.7596
Average Train Accuracy: 0.8496
 Site-MNIST                     (3) | Val  Loss: 0.2044 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.2907 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.4158 | Val  Acc: 0.8261
 Site-USPS                      (5) | Val  Loss: 0.3483 | Val  Acc: 0.8777
 Site-SynthDigits               (4) | Val  Loss: 0.4478 | Val  Acc: 0.8587
 Site-SynthDigits               (4) | Val  Loss: 0.4163 | Val  Acc: 0.8669
 Site-MNIST_M                   (0) | Val  Loss: 0.6363 | Val  Acc: 0.7935
 Site-MNIST_M                   (0) | Val  Loss: 0.5783 | Val  Acc: 0.8237
 Site-SVHN                      (2) | Val  Loss: 0.8026 | Val  Acc: 0.7500
 Site-SVHN                      (6) | Val  Loss: 0.8200 | Val  Acc: 0.7410
Average Valid Accuracy: 0.8404
============ Train epoch 28 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (3) | Train Loss: 0.2337 | Train Acc: 0.9218
 Site-MNIST                     (3) | Train Loss: 0.2999 | Train Acc: 0.9085
 Site-USPS                      (4) | Train Loss: 0.3097 | Train Acc: 0.8895
 Site-USPS                      (4) | Train Loss: 0.3026 | Train Acc: 0.9058
 Site-SynthDigits               (1) | Train Loss: 0.4252 | Train Acc: 0.8706
 Site-SynthDigits               (6) | Train Loss: 0.3923 | Train Acc: 0.8870
 Site-MNIST_M                   (0) | Train Loss: 0.6325 | Train Acc: 0.8005
 Site-MNIST_M                   (0) | Train Loss: 0.5926 | Train Acc: 0.8305
 Site-SVHN                      (5) | Train Loss: 0.8846 | Train Acc: 0.7089
 Site-SVHN                      (2) | Train Loss: 0.7392 | Train Acc: 0.7731
Average Train Accuracy: 0.8496
 Site-MNIST                     (3) | Val  Loss: 0.2090 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.2963 | Val  Acc: 0.9173
 Site-USPS                      (4) | Val  Loss: 0.4207 | Val  Acc: 0.8261
 Site-USPS                      (4) | Val  Loss: 0.3598 | Val  Acc: 0.8777
 Site-SynthDigits               (1) | Val  Loss: 0.4293 | Val  Acc: 0.8587
 Site-SynthDigits               (6) | Val  Loss: 0.4077 | Val  Acc: 0.8705
 Site-MNIST_M                   (0) | Val  Loss: 0.6341 | Val  Acc: 0.8043
 Site-MNIST_M                   (0) | Val  Loss: 0.5710 | Val  Acc: 0.8201
 Site-SVHN                      (5) | Val  Loss: 0.7925 | Val  Acc: 0.7826
 Site-SVHN                      (2) | Val  Loss: 0.7911 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8440
 Best site-MNIST                    (3)  | Epoch:28 | Val Acc: 0.9239
 Best site-MNIST                    (3)  | Epoch:28 | Val Acc: 0.9173
 Best site-USPS                     (4)  | Epoch:28 | Val Acc: 0.8261
 Best site-USPS                     (4)  | Epoch:28 | Val Acc: 0.8777
 Best site-SynthDigits              (1)  | Epoch:28 | Val Acc: 0.8587
 Best site-SynthDigits              (6)  | Epoch:28 | Val Acc: 0.8705
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.8043
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.8201
 Best site-SVHN                     (5)  | Epoch:28 | Val Acc: 0.7826
 Best site-SVHN                     (2)  | Epoch:28 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.2222 | Train Acc: 0.9299
 Site-MNIST                     (6) | Train Loss: 0.2780 | Train Acc: 0.9166
 Site-USPS                      (4) | Train Loss: 0.3022 | Train Acc: 0.9030
 Site-USPS                      (4) | Train Loss: 0.2982 | Train Acc: 0.9049
 Site-SynthDigits               (5) | Train Loss: 0.4198 | Train Acc: 0.8841
 Site-SynthDigits               (2) | Train Loss: 0.3836 | Train Acc: 0.8960
 Site-MNIST_M                   (3) | Train Loss: 0.6294 | Train Acc: 0.8005
 Site-MNIST_M                   (3) | Train Loss: 0.5862 | Train Acc: 0.8359
 Site-SVHN                      (1) | Train Loss: 0.8679 | Train Acc: 0.7170
 Site-SVHN                      (1) | Train Loss: 0.7358 | Train Acc: 0.7785
Average Train Accuracy: 0.8566
 Site-MNIST                     (0) | Val  Loss: 0.1930 | Val  Acc: 0.9348
 Site-MNIST                     (6) | Val  Loss: 0.2832 | Val  Acc: 0.9281
 Site-USPS                      (4) | Val  Loss: 0.4155 | Val  Acc: 0.8261
 Site-USPS                      (4) | Val  Loss: 0.3501 | Val  Acc: 0.8705
 Site-SynthDigits               (5) | Val  Loss: 0.4249 | Val  Acc: 0.8804
 Site-SynthDigits               (2) | Val  Loss: 0.3960 | Val  Acc: 0.8813
 Site-MNIST_M                   (3) | Val  Loss: 0.6217 | Val  Acc: 0.8043
 Site-MNIST_M                   (3) | Val  Loss: 0.5591 | Val  Acc: 0.8309
 Site-SVHN                      (1) | Val  Loss: 0.7813 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.7818 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8509
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9348
 Best site-MNIST                    (6)  | Epoch:29 | Val Acc: 0.9281
 Best site-USPS                     (4)  | Epoch:29 | Val Acc: 0.8261
 Best site-USPS                     (4)  | Epoch:29 | Val Acc: 0.8705
 Best site-SynthDigits              (5)  | Epoch:29 | Val Acc: 0.8804
 Best site-SynthDigits              (2)  | Epoch:29 | Val Acc: 0.8813
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.8043
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.8309
 Best site-SVHN                     (1)  | Epoch:29 | Val Acc: 0.7826
 Best site-SVHN                     (1)  | Epoch:29 | Val Acc: 0.7698
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 30 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (3) | Train Loss: 0.2199 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.2815 | Train Acc: 0.9175
 Site-USPS                      (4) | Train Loss: 0.2992 | Train Acc: 0.9084
 Site-USPS                      (4) | Train Loss: 0.2992 | Train Acc: 0.9121
 Site-SynthDigits               (6) | Train Loss: 0.4006 | Train Acc: 0.8868
 Site-SynthDigits               (1) | Train Loss: 0.3708 | Train Acc: 0.9049
 Site-MNIST_M                   (0) | Train Loss: 0.6205 | Train Acc: 0.8167
 Site-MNIST_M                   (0) | Train Loss: 0.5774 | Train Acc: 0.8377
 Site-SVHN                      (2) | Train Loss: 0.8752 | Train Acc: 0.7251
 Site-SVHN                      (5) | Train Loss: 0.7444 | Train Acc: 0.7677
Average Train Accuracy: 0.8601
 Site-MNIST                     (3) | Val  Loss: 0.1922 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.2828 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.4012 | Val  Acc: 0.8261
 Site-USPS                      (4) | Val  Loss: 0.3437 | Val  Acc: 0.8813
 Site-SynthDigits               (6) | Val  Loss: 0.3957 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3780 | Val  Acc: 0.8813
 Site-MNIST_M                   (0) | Val  Loss: 0.6017 | Val  Acc: 0.7935
 Site-MNIST_M                   (0) | Val  Loss: 0.5447 | Val  Acc: 0.8345
 Site-SVHN                      (2) | Val  Loss: 0.7820 | Val  Acc: 0.7500
 Site-SVHN                      (5) | Val  Loss: 0.7902 | Val  Acc: 0.7518
Average Valid Accuracy: 0.8454
============ Train epoch 31 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (3) | Train Loss: 0.2196 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2703 | Train Acc: 0.9202
 Site-USPS                      (6) | Train Loss: 0.2916 | Train Acc: 0.9111
 Site-USPS                      (4) | Train Loss: 0.2835 | Train Acc: 0.9166
 Site-SynthDigits               (1) | Train Loss: 0.4011 | Train Acc: 0.8760
 Site-SynthDigits               (1) | Train Loss: 0.3654 | Train Acc: 0.9004
 Site-MNIST_M                   (0) | Train Loss: 0.6100 | Train Acc: 0.8113
 Site-MNIST_M                   (0) | Train Loss: 0.5662 | Train Acc: 0.8386
 Site-SVHN                      (2) | Train Loss: 0.8505 | Train Acc: 0.7035
 Site-SVHN                      (5) | Train Loss: 0.7135 | Train Acc: 0.7830
Average Train Accuracy: 0.8591
 Site-MNIST                     (3) | Val  Loss: 0.1812 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2742 | Val  Acc: 0.9317
 Site-USPS                      (6) | Val  Loss: 0.3967 | Val  Acc: 0.8261
 Site-USPS                      (4) | Val  Loss: 0.3264 | Val  Acc: 0.8885
 Site-SynthDigits               (1) | Val  Loss: 0.4012 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3726 | Val  Acc: 0.8849
 Site-MNIST_M                   (0) | Val  Loss: 0.5968 | Val  Acc: 0.8261
 Site-MNIST_M                   (0) | Val  Loss: 0.5370 | Val  Acc: 0.8381
 Site-SVHN                      (2) | Val  Loss: 0.7691 | Val  Acc: 0.7391
 Site-SVHN                      (5) | Val  Loss: 0.7628 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8505
============ Train epoch 32 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (1) | Train Loss: 0.2143 | Train Acc: 0.9380
 Site-MNIST                     (1) | Train Loss: 0.2682 | Train Acc: 0.9247
 Site-USPS                      (4) | Train Loss: 0.2969 | Train Acc: 0.8976
 Site-USPS                      (6) | Train Loss: 0.2850 | Train Acc: 0.9103
 Site-SynthDigits               (2) | Train Loss: 0.4026 | Train Acc: 0.8841
 Site-SynthDigits               (2) | Train Loss: 0.3676 | Train Acc: 0.9004
 Site-MNIST_M                   (3) | Train Loss: 0.6132 | Train Acc: 0.8113
 Site-MNIST_M                   (3) | Train Loss: 0.5634 | Train Acc: 0.8350
 Site-SVHN                      (0) | Train Loss: 0.8434 | Train Acc: 0.7197
 Site-SVHN                      (5) | Train Loss: 0.7020 | Train Acc: 0.7848
Average Train Accuracy: 0.8606
 Site-MNIST                     (1) | Val  Loss: 0.1758 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2687 | Val  Acc: 0.9353
 Site-USPS                      (4) | Val  Loss: 0.3946 | Val  Acc: 0.8261
 Site-USPS                      (6) | Val  Loss: 0.3314 | Val  Acc: 0.8777
 Site-SynthDigits               (2) | Val  Loss: 0.3968 | Val  Acc: 0.8804
 Site-SynthDigits               (2) | Val  Loss: 0.3738 | Val  Acc: 0.8849
 Site-MNIST_M                   (3) | Val  Loss: 0.5969 | Val  Acc: 0.8152
 Site-MNIST_M                   (3) | Val  Loss: 0.5369 | Val  Acc: 0.8309
 Site-SVHN                      (0) | Val  Loss: 0.7561 | Val  Acc: 0.7826
 Site-SVHN                      (5) | Val  Loss: 0.7457 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8552
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9353
 Best site-USPS                     (4)  | Epoch:32 | Val Acc: 0.8261
 Best site-USPS                     (6)  | Epoch:32 | Val Acc: 0.8777
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8804
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8849
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.8152
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.8309
 Best site-SVHN                     (0)  | Epoch:32 | Val Acc: 0.7826
 Best site-SVHN                     (5)  | Epoch:32 | Val Acc: 0.7734
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (0) | Train Loss: 0.2105 | Train Acc: 0.9326
 Site-MNIST                     (0) | Train Loss: 0.2637 | Train Acc: 0.9247
 Site-USPS                      (4) | Train Loss: 0.2803 | Train Acc: 0.9111
 Site-USPS                      (4) | Train Loss: 0.2731 | Train Acc: 0.9157
 Site-SynthDigits               (3) | Train Loss: 0.3911 | Train Acc: 0.8841
 Site-SynthDigits               (3) | Train Loss: 0.3528 | Train Acc: 0.9031
 Site-MNIST_M                   (2) | Train Loss: 0.6119 | Train Acc: 0.8005
 Site-MNIST_M                   (6) | Train Loss: 0.5488 | Train Acc: 0.8350
 Site-SVHN                      (1) | Train Loss: 0.8481 | Train Acc: 0.7143
 Site-SVHN                      (5) | Train Loss: 0.6973 | Train Acc: 0.7892
Average Train Accuracy: 0.8610
 Site-MNIST                     (0) | Val  Loss: 0.1724 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2636 | Val  Acc: 0.9353
 Site-USPS                      (4) | Val  Loss: 0.3804 | Val  Acc: 0.8370
 Site-USPS                      (4) | Val  Loss: 0.3145 | Val  Acc: 0.8885
 Site-SynthDigits               (3) | Val  Loss: 0.3849 | Val  Acc: 0.8913
 Site-SynthDigits               (3) | Val  Loss: 0.3639 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5784 | Val  Acc: 0.8152
 Site-MNIST_M                   (6) | Val  Loss: 0.5250 | Val  Acc: 0.8381
 Site-SVHN                      (1) | Val  Loss: 0.7459 | Val  Acc: 0.7826
 Site-SVHN                      (5) | Val  Loss: 0.7468 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8599
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9353
 Best site-USPS                     (4)  | Epoch:33 | Val Acc: 0.8370
 Best site-USPS                     (4)  | Epoch:33 | Val Acc: 0.8885
 Best site-SynthDigits              (3)  | Epoch:33 | Val Acc: 0.8913
 Best site-SynthDigits              (3)  | Epoch:33 | Val Acc: 0.8813
 Best site-MNIST_M                  (2)  | Epoch:33 | Val Acc: 0.8152
 Best site-MNIST_M                  (6)  | Epoch:33 | Val Acc: 0.8381
 Best site-SVHN                     (1)  | Epoch:33 | Val Acc: 0.7826
 Best site-SVHN                     (5)  | Epoch:33 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (3) | Train Loss: 0.2055 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2613 | Train Acc: 0.9274
 Site-USPS                      (6) | Train Loss: 0.2737 | Train Acc: 0.9218
 Site-USPS                      (4) | Train Loss: 0.2798 | Train Acc: 0.9157
 Site-SynthDigits               (1) | Train Loss: 0.3892 | Train Acc: 0.8868
 Site-SynthDigits               (1) | Train Loss: 0.3566 | Train Acc: 0.9031
 Site-MNIST_M                   (0) | Train Loss: 0.5996 | Train Acc: 0.8194
 Site-MNIST_M                   (5) | Train Loss: 0.5369 | Train Acc: 0.8413
 Site-SVHN                      (2) | Train Loss: 0.8341 | Train Acc: 0.7170
 Site-SVHN                      (2) | Train Loss: 0.6885 | Train Acc: 0.7919
Average Train Accuracy: 0.8654
 Site-MNIST                     (3) | Val  Loss: 0.1667 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2656 | Val  Acc: 0.9353
 Site-USPS                      (6) | Val  Loss: 0.3775 | Val  Acc: 0.8370
 Site-USPS                      (4) | Val  Loss: 0.3132 | Val  Acc: 0.8849
 Site-SynthDigits               (1) | Val  Loss: 0.3873 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3618 | Val  Acc: 0.8849
 Site-MNIST_M                   (0) | Val  Loss: 0.5640 | Val  Acc: 0.8370
 Site-MNIST_M                   (5) | Val  Loss: 0.5189 | Val  Acc: 0.8417
 Site-SVHN                      (2) | Val  Loss: 0.7332 | Val  Acc: 0.7935
 Site-SVHN                      (2) | Val  Loss: 0.7362 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8610
 Best site-MNIST                    (3)  | Epoch:34 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:34 | Val Acc: 0.9353
 Best site-USPS                     (6)  | Epoch:34 | Val Acc: 0.8370
 Best site-USPS                     (4)  | Epoch:34 | Val Acc: 0.8849
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8849
 Best site-MNIST_M                  (0)  | Epoch:34 | Val Acc: 0.8370
 Best site-MNIST_M                  (5)  | Epoch:34 | Val Acc: 0.8417
 Best site-SVHN                     (2)  | Epoch:34 | Val Acc: 0.7935
 Best site-SVHN                     (2)  | Epoch:34 | Val Acc: 0.7698
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (3) | Train Loss: 0.2078 | Train Acc: 0.9272
 Site-MNIST                     (3) | Train Loss: 0.2604 | Train Acc: 0.9265
 Site-USPS                      (0) | Train Loss: 0.2778 | Train Acc: 0.9137
 Site-USPS                      (0) | Train Loss: 0.2727 | Train Acc: 0.9184
 Site-SynthDigits               (4) | Train Loss: 0.3746 | Train Acc: 0.8895
 Site-SynthDigits               (6) | Train Loss: 0.3538 | Train Acc: 0.9112
 Site-MNIST_M                   (5) | Train Loss: 0.5964 | Train Acc: 0.8032
 Site-MNIST_M                   (1) | Train Loss: 0.5337 | Train Acc: 0.8448
 Site-SVHN                      (2) | Train Loss: 0.8275 | Train Acc: 0.7251
 Site-SVHN                      (2) | Train Loss: 0.6704 | Train Acc: 0.8000
Average Train Accuracy: 0.8660
 Site-MNIST                     (3) | Val  Loss: 0.1614 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2657 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3804 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3163 | Val  Acc: 0.8885
 Site-SynthDigits               (4) | Val  Loss: 0.3769 | Val  Acc: 0.8804
 Site-SynthDigits               (6) | Val  Loss: 0.3481 | Val  Acc: 0.8849
 Site-MNIST_M                   (5) | Val  Loss: 0.5471 | Val  Acc: 0.8370
 Site-MNIST_M                   (1) | Val  Loss: 0.5112 | Val  Acc: 0.8453
 Site-SVHN                      (2) | Val  Loss: 0.7216 | Val  Acc: 0.7500
 Site-SVHN                      (2) | Val  Loss: 0.7275 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8574
============ Train epoch 36 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (3) | Train Loss: 0.1965 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2532 | Train Acc: 0.9247
 Site-USPS                      (5) | Train Loss: 0.2776 | Train Acc: 0.9191
 Site-USPS                      (0) | Train Loss: 0.2733 | Train Acc: 0.9103
 Site-SynthDigits               (4) | Train Loss: 0.3791 | Train Acc: 0.8868
 Site-SynthDigits               (4) | Train Loss: 0.3537 | Train Acc: 0.9040
 Site-MNIST_M                   (2) | Train Loss: 0.5827 | Train Acc: 0.8194
 Site-MNIST_M                   (2) | Train Loss: 0.5251 | Train Acc: 0.8484
 Site-SVHN                      (1) | Train Loss: 0.8180 | Train Acc: 0.7224
 Site-SVHN                      (6) | Train Loss: 0.6739 | Train Acc: 0.7991
Average Train Accuracy: 0.8664
 Site-MNIST                     (3) | Val  Loss: 0.1601 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2644 | Val  Acc: 0.9388
 Site-USPS                      (5) | Val  Loss: 0.3799 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3202 | Val  Acc: 0.8957
 Site-SynthDigits               (4) | Val  Loss: 0.3777 | Val  Acc: 0.8804
 Site-SynthDigits               (4) | Val  Loss: 0.3532 | Val  Acc: 0.8921
 Site-MNIST_M                   (2) | Val  Loss: 0.5427 | Val  Acc: 0.8261
 Site-MNIST_M                   (2) | Val  Loss: 0.5033 | Val  Acc: 0.8525
 Site-SVHN                      (1) | Val  Loss: 0.7193 | Val  Acc: 0.7826
 Site-SVHN                      (6) | Val  Loss: 0.7104 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8635
 Best site-MNIST                    (3)  | Epoch:36 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:36 | Val Acc: 0.9388
 Best site-USPS                     (5)  | Epoch:36 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:36 | Val Acc: 0.8957
 Best site-SynthDigits              (4)  | Epoch:36 | Val Acc: 0.8804
 Best site-SynthDigits              (4)  | Epoch:36 | Val Acc: 0.8921
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.8261
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.8525
 Best site-SVHN                     (1)  | Epoch:36 | Val Acc: 0.7826
 Best site-SVHN                     (6)  | Epoch:36 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.1947 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2540 | Train Acc: 0.9274
 Site-USPS                      (4) | Train Loss: 0.2674 | Train Acc: 0.9191
 Site-USPS                      (4) | Train Loss: 0.2632 | Train Acc: 0.9175
 Site-SynthDigits               (1) | Train Loss: 0.3818 | Train Acc: 0.8814
 Site-SynthDigits               (5) | Train Loss: 0.3561 | Train Acc: 0.8978
 Site-MNIST_M                   (0) | Train Loss: 0.5693 | Train Acc: 0.8167
 Site-MNIST_M                   (0) | Train Loss: 0.5183 | Train Acc: 0.8475
 Site-SVHN                      (2) | Train Loss: 0.8182 | Train Acc: 0.7143
 Site-SVHN                      (6) | Train Loss: 0.6528 | Train Acc: 0.7964
Average Train Accuracy: 0.8659
 Site-MNIST                     (3) | Val  Loss: 0.1618 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.2594 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3675 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.3087 | Val  Acc: 0.8921
 Site-SynthDigits               (1) | Val  Loss: 0.3878 | Val  Acc: 0.8696
 Site-SynthDigits               (5) | Val  Loss: 0.3525 | Val  Acc: 0.8885
 Site-MNIST_M                   (0) | Val  Loss: 0.5365 | Val  Acc: 0.8261
 Site-MNIST_M                   (0) | Val  Loss: 0.4922 | Val  Acc: 0.8597
 Site-SVHN                      (2) | Val  Loss: 0.7056 | Val  Acc: 0.7935
 Site-SVHN                      (6) | Val  Loss: 0.7105 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8628
============ Train epoch 38 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (0) | Train Loss: 0.2017 | Train Acc: 0.9326
 Site-MNIST                     (0) | Train Loss: 0.2514 | Train Acc: 0.9274
 Site-USPS                      (4) | Train Loss: 0.2572 | Train Acc: 0.9299
 Site-USPS                      (4) | Train Loss: 0.2557 | Train Acc: 0.9220
 Site-SynthDigits               (2) | Train Loss: 0.3790 | Train Acc: 0.8868
 Site-SynthDigits               (6) | Train Loss: 0.3406 | Train Acc: 0.9040
 Site-MNIST_M                   (3) | Train Loss: 0.5780 | Train Acc: 0.8167
 Site-MNIST_M                   (3) | Train Loss: 0.5212 | Train Acc: 0.8529
 Site-SVHN                      (5) | Train Loss: 0.8090 | Train Acc: 0.7332
 Site-SVHN                      (1) | Train Loss: 0.6521 | Train Acc: 0.8009
Average Train Accuracy: 0.8706
 Site-MNIST                     (0) | Val  Loss: 0.1593 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2579 | Val  Acc: 0.9353
 Site-USPS                      (4) | Val  Loss: 0.3476 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.2935 | Val  Acc: 0.8921
 Site-SynthDigits               (2) | Val  Loss: 0.3919 | Val  Acc: 0.8696
 Site-SynthDigits               (6) | Val  Loss: 0.3495 | Val  Acc: 0.8885
 Site-MNIST_M                   (3) | Val  Loss: 0.5317 | Val  Acc: 0.8478
 Site-MNIST_M                   (3) | Val  Loss: 0.4905 | Val  Acc: 0.8597
 Site-SVHN                      (5) | Val  Loss: 0.6957 | Val  Acc: 0.7717
 Site-SVHN                      (1) | Val  Loss: 0.7048 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8632
============ Train epoch 39 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (0) | Train Loss: 0.1930 | Train Acc: 0.9353
 Site-MNIST                     (0) | Train Loss: 0.2433 | Train Acc: 0.9318
 Site-USPS                      (4) | Train Loss: 0.2688 | Train Acc: 0.9245
 Site-USPS                      (4) | Train Loss: 0.2615 | Train Acc: 0.9184
 Site-SynthDigits               (2) | Train Loss: 0.3587 | Train Acc: 0.8841
 Site-SynthDigits               (2) | Train Loss: 0.3295 | Train Acc: 0.9040
 Site-MNIST_M                   (3) | Train Loss: 0.5577 | Train Acc: 0.8113
 Site-MNIST_M                   (5) | Train Loss: 0.5101 | Train Acc: 0.8475
 Site-SVHN                      (1) | Train Loss: 0.8112 | Train Acc: 0.7251
 Site-SVHN                      (6) | Train Loss: 0.6528 | Train Acc: 0.7991
Average Train Accuracy: 0.8681
 Site-MNIST                     (0) | Val  Loss: 0.1513 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2500 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3508 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.2972 | Val  Acc: 0.8921
 Site-SynthDigits               (2) | Val  Loss: 0.3587 | Val  Acc: 0.8696
 Site-SynthDigits               (2) | Val  Loss: 0.3315 | Val  Acc: 0.8849
 Site-MNIST_M                   (3) | Val  Loss: 0.5224 | Val  Acc: 0.8478
 Site-MNIST_M                   (5) | Val  Loss: 0.4805 | Val  Acc: 0.8597
 Site-SVHN                      (1) | Val  Loss: 0.7013 | Val  Acc: 0.7826
 Site-SVHN                      (6) | Val  Loss: 0.7038 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8664
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9565
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:39 | Val Acc: 0.8478
 Best site-USPS                     (4)  | Epoch:39 | Val Acc: 0.8921
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.8696
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.8849
 Best site-MNIST_M                  (3)  | Epoch:39 | Val Acc: 0.8478
 Best site-MNIST_M                  (5)  | Epoch:39 | Val Acc: 0.8597
 Best site-SVHN                     (1)  | Epoch:39 | Val Acc: 0.7826
 Best site-SVHN                     (6)  | Epoch:39 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (0) | Train Loss: 0.1907 | Train Acc: 0.9326
 Site-MNIST                     (0) | Train Loss: 0.2344 | Train Acc: 0.9327
 Site-USPS                      (6) | Train Loss: 0.2587 | Train Acc: 0.9272
 Site-USPS                      (4) | Train Loss: 0.2489 | Train Acc: 0.9211
 Site-SynthDigits               (2) | Train Loss: 0.3611 | Train Acc: 0.8868
 Site-SynthDigits               (2) | Train Loss: 0.3276 | Train Acc: 0.9085
 Site-MNIST_M                   (5) | Train Loss: 0.5614 | Train Acc: 0.8221
 Site-MNIST_M                   (3) | Train Loss: 0.4976 | Train Acc: 0.8511
 Site-SVHN                      (1) | Train Loss: 0.8200 | Train Acc: 0.7358
 Site-SVHN                      (1) | Train Loss: 0.6485 | Train Acc: 0.8054
Average Train Accuracy: 0.8723
 Site-MNIST                     (0) | Val  Loss: 0.1506 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2472 | Val  Acc: 0.9388
 Site-USPS                      (6) | Val  Loss: 0.3518 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.2927 | Val  Acc: 0.8993
 Site-SynthDigits               (2) | Val  Loss: 0.3588 | Val  Acc: 0.8804
 Site-SynthDigits               (2) | Val  Loss: 0.3349 | Val  Acc: 0.8849
 Site-MNIST_M                   (5) | Val  Loss: 0.5193 | Val  Acc: 0.8478
 Site-MNIST_M                   (3) | Val  Loss: 0.4756 | Val  Acc: 0.8525
 Site-SVHN                      (1) | Val  Loss: 0.6974 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.6984 | Val  Acc: 0.7806
Average Valid Accuracy: 0.8671
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9565
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9388
 Best site-USPS                     (6)  | Epoch:40 | Val Acc: 0.8478
 Best site-USPS                     (4)  | Epoch:40 | Val Acc: 0.8993
 Best site-SynthDigits              (2)  | Epoch:40 | Val Acc: 0.8804
 Best site-SynthDigits              (2)  | Epoch:40 | Val Acc: 0.8849
 Best site-MNIST_M                  (5)  | Epoch:40 | Val Acc: 0.8478
 Best site-MNIST_M                  (3)  | Epoch:40 | Val Acc: 0.8525
 Best site-SVHN                     (1)  | Epoch:40 | Val Acc: 0.7826
 Best site-SVHN                     (1)  | Epoch:40 | Val Acc: 0.7806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 41 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (3) | Train Loss: 0.1917 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2405 | Train Acc: 0.9354
 Site-USPS                      (0) | Train Loss: 0.2550 | Train Acc: 0.9218
 Site-USPS                      (6) | Train Loss: 0.2506 | Train Acc: 0.9256
 Site-SynthDigits               (4) | Train Loss: 0.3563 | Train Acc: 0.8949
 Site-SynthDigits               (4) | Train Loss: 0.3258 | Train Acc: 0.9031
 Site-MNIST_M                   (2) | Train Loss: 0.5544 | Train Acc: 0.8275
 Site-MNIST_M                   (2) | Train Loss: 0.4952 | Train Acc: 0.8520
 Site-SVHN                      (5) | Train Loss: 0.8060 | Train Acc: 0.7358
 Site-SVHN                      (1) | Train Loss: 0.6422 | Train Acc: 0.8027
Average Train Accuracy: 0.8729
 Site-MNIST                     (3) | Val  Loss: 0.1467 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2444 | Val  Acc: 0.9388
 Site-USPS                      (0) | Val  Loss: 0.3449 | Val  Acc: 0.8587
 Site-USPS                      (6) | Val  Loss: 0.2842 | Val  Acc: 0.9065
 Site-SynthDigits               (4) | Val  Loss: 0.3551 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.3323 | Val  Acc: 0.8885
 Site-MNIST_M                   (2) | Val  Loss: 0.5125 | Val  Acc: 0.8261
 Site-MNIST_M                   (2) | Val  Loss: 0.4699 | Val  Acc: 0.8561
 Site-SVHN                      (5) | Val  Loss: 0.6942 | Val  Acc: 0.7935
 Site-SVHN                      (1) | Val  Loss: 0.6888 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8686
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9388
 Best site-USPS                     (0)  | Epoch:41 | Val Acc: 0.8587
 Best site-USPS                     (6)  | Epoch:41 | Val Acc: 0.9065
 Best site-SynthDigits              (4)  | Epoch:41 | Val Acc: 0.8696
 Best site-SynthDigits              (4)  | Epoch:41 | Val Acc: 0.8885
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.8261
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.8561
 Best site-SVHN                     (5)  | Epoch:41 | Val Acc: 0.7935
 Best site-SVHN                     (1)  | Epoch:41 | Val Acc: 0.7914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (3) | Train Loss: 0.1880 | Train Acc: 0.9380
 Site-MNIST                     (3) | Train Loss: 0.2308 | Train Acc: 0.9381
 Site-USPS                      (4) | Train Loss: 0.2450 | Train Acc: 0.9353
 Site-USPS                      (5) | Train Loss: 0.2490 | Train Acc: 0.9247
 Site-SynthDigits               (1) | Train Loss: 0.3494 | Train Acc: 0.8868
 Site-SynthDigits               (1) | Train Loss: 0.3210 | Train Acc: 0.9085
 Site-MNIST_M                   (0) | Train Loss: 0.5494 | Train Acc: 0.8275
 Site-MNIST_M                   (0) | Train Loss: 0.4905 | Train Acc: 0.8592
 Site-SVHN                      (6) | Train Loss: 0.7933 | Train Acc: 0.7412
 Site-SVHN                      (2) | Train Loss: 0.6243 | Train Acc: 0.8081
Average Train Accuracy: 0.8767
 Site-MNIST                     (3) | Val  Loss: 0.1481 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2439 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3353 | Val  Acc: 0.8478
 Site-USPS                      (5) | Val  Loss: 0.2793 | Val  Acc: 0.9029
 Site-SynthDigits               (1) | Val  Loss: 0.3401 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3145 | Val  Acc: 0.8993
 Site-MNIST_M                   (0) | Val  Loss: 0.4997 | Val  Acc: 0.8587
 Site-MNIST_M                   (0) | Val  Loss: 0.4624 | Val  Acc: 0.8633
 Site-SVHN                      (6) | Val  Loss: 0.6686 | Val  Acc: 0.8043
 Site-SVHN                      (2) | Val  Loss: 0.6817 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8744
 Best site-MNIST                    (3)  | Epoch:42 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:42 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:42 | Val Acc: 0.8478
 Best site-USPS                     (5)  | Epoch:42 | Val Acc: 0.9029
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.8993
 Best site-MNIST_M                  (0)  | Epoch:42 | Val Acc: 0.8587
 Best site-MNIST_M                  (0)  | Epoch:42 | Val Acc: 0.8633
 Best site-SVHN                     (6)  | Epoch:42 | Val Acc: 0.8043
 Best site-SVHN                     (2)  | Epoch:42 | Val Acc: 0.7914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.1794 | Train Acc: 0.9434
 Site-MNIST                     (0) | Train Loss: 0.2273 | Train Acc: 0.9354
 Site-USPS                      (4) | Train Loss: 0.2542 | Train Acc: 0.9218
 Site-USPS                      (4) | Train Loss: 0.2365 | Train Acc: 0.9256
 Site-SynthDigits               (5) | Train Loss: 0.3480 | Train Acc: 0.8841
 Site-SynthDigits               (3) | Train Loss: 0.3253 | Train Acc: 0.9076
 Site-MNIST_M                   (6) | Train Loss: 0.5503 | Train Acc: 0.8194
 Site-MNIST_M                   (2) | Train Loss: 0.4836 | Train Acc: 0.8592
 Site-SVHN                      (1) | Train Loss: 0.7845 | Train Acc: 0.7439
 Site-SVHN                      (1) | Train Loss: 0.6180 | Train Acc: 0.8126
Average Train Accuracy: 0.8753
 Site-MNIST                     (0) | Val  Loss: 0.1469 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2381 | Val  Acc: 0.9424
 Site-USPS                      (4) | Val  Loss: 0.3366 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2789 | Val  Acc: 0.9029
 Site-SynthDigits               (5) | Val  Loss: 0.3427 | Val  Acc: 0.8804
 Site-SynthDigits               (3) | Val  Loss: 0.3203 | Val  Acc: 0.8921
 Site-MNIST_M                   (6) | Val  Loss: 0.5100 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4629 | Val  Acc: 0.8561
 Site-SVHN                      (1) | Val  Loss: 0.6649 | Val  Acc: 0.8261
 Site-SVHN                      (1) | Val  Loss: 0.6662 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8769
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9565
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9424
 Best site-USPS                     (4)  | Epoch:43 | Val Acc: 0.8587
 Best site-USPS                     (4)  | Epoch:43 | Val Acc: 0.9029
 Best site-SynthDigits              (5)  | Epoch:43 | Val Acc: 0.8804
 Best site-SynthDigits              (3)  | Epoch:43 | Val Acc: 0.8921
 Best site-MNIST_M                  (6)  | Epoch:43 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.8561
 Best site-SVHN                     (1)  | Epoch:43 | Val Acc: 0.8261
 Best site-SVHN                     (1)  | Epoch:43 | Val Acc: 0.7950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.1750 | Train Acc: 0.9488
 Site-MNIST                     (0) | Train Loss: 0.2286 | Train Acc: 0.9336
 Site-USPS                      (4) | Train Loss: 0.2492 | Train Acc: 0.9272
 Site-USPS                      (4) | Train Loss: 0.2415 | Train Acc: 0.9238
 Site-SynthDigits               (3) | Train Loss: 0.3475 | Train Acc: 0.8868
 Site-SynthDigits               (6) | Train Loss: 0.3166 | Train Acc: 0.9112
 Site-MNIST_M                   (2) | Train Loss: 0.5384 | Train Acc: 0.8221
 Site-MNIST_M                   (2) | Train Loss: 0.4794 | Train Acc: 0.8556
 Site-SVHN                      (1) | Train Loss: 0.7733 | Train Acc: 0.7439
 Site-SVHN                      (5) | Train Loss: 0.6092 | Train Acc: 0.8099
Average Train Accuracy: 0.8763
 Site-MNIST                     (0) | Val  Loss: 0.1416 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2346 | Val  Acc: 0.9424
 Site-USPS                      (4) | Val  Loss: 0.3386 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2791 | Val  Acc: 0.9029
 Site-SynthDigits               (3) | Val  Loss: 0.3329 | Val  Acc: 0.8804
 Site-SynthDigits               (6) | Val  Loss: 0.3104 | Val  Acc: 0.8957
 Site-MNIST_M                   (2) | Val  Loss: 0.5053 | Val  Acc: 0.8804
 Site-MNIST_M                   (2) | Val  Loss: 0.4567 | Val  Acc: 0.8597
 Site-SVHN                      (1) | Val  Loss: 0.6554 | Val  Acc: 0.8370
 Site-SVHN                      (5) | Val  Loss: 0.6657 | Val  Acc: 0.8094
Average Valid Accuracy: 0.8823
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9565
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9424
 Best site-USPS                     (4)  | Epoch:44 | Val Acc: 0.8587
 Best site-USPS                     (4)  | Epoch:44 | Val Acc: 0.9029
 Best site-SynthDigits              (3)  | Epoch:44 | Val Acc: 0.8804
 Best site-SynthDigits              (6)  | Epoch:44 | Val Acc: 0.8957
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.8804
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.8597
 Best site-SVHN                     (1)  | Epoch:44 | Val Acc: 0.8370
 Best site-SVHN                     (5)  | Epoch:44 | Val Acc: 0.8094
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 45 ============
cnt=[1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (2) | Train Loss: 0.1764 | Train Acc: 0.9434
 Site-MNIST                     (2) | Train Loss: 0.2292 | Train Acc: 0.9354
 Site-USPS                      (4) | Train Loss: 0.2428 | Train Acc: 0.9299
 Site-USPS                      (4) | Train Loss: 0.2347 | Train Acc: 0.9300
 Site-SynthDigits               (6) | Train Loss: 0.3470 | Train Acc: 0.8895
 Site-SynthDigits               (0) | Train Loss: 0.3125 | Train Acc: 0.9121
 Site-MNIST_M                   (1) | Train Loss: 0.5458 | Train Acc: 0.8140
 Site-MNIST_M                   (1) | Train Loss: 0.4756 | Train Acc: 0.8556
 Site-SVHN                      (5) | Train Loss: 0.7727 | Train Acc: 0.7574
 Site-SVHN                      (3) | Train Loss: 0.6046 | Train Acc: 0.8188
Average Train Accuracy: 0.8786
 Site-MNIST                     (2) | Val  Loss: 0.1394 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2335 | Val  Acc: 0.9424
 Site-USPS                      (4) | Val  Loss: 0.3257 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2659 | Val  Acc: 0.9101
 Site-SynthDigits               (6) | Val  Loss: 0.3397 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.3083 | Val  Acc: 0.8921
 Site-MNIST_M                   (1) | Val  Loss: 0.4964 | Val  Acc: 0.8804
 Site-MNIST_M                   (1) | Val  Loss: 0.4518 | Val  Acc: 0.8633
 Site-SVHN                      (5) | Val  Loss: 0.6568 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.6624 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8765
 Test site-MNIST                     (2)| Epoch:44 | Test Acc: 0.9404
 Test site-USPS                      (4)| Epoch:44 | Test Acc: 0.9366
 Test site-SynthDigits               (6)| Epoch:44 | Test Acc: 0.8984
 Test site-MNIST_M                   (1)| Epoch:44 | Test Acc: 0.7796
 Test site-SVHN                      (5)| Epoch:44 | Test Acc: 0.7343
MNIST: 0.9404, USPS: 0.9366, SynthDigits: 0.8984, MNIST_M: 0.7796, SVHN: 0.7343, 
Average Test Accuracy(group): 0.8579, Average Test Accuracy(individual): 0.8579,
domain std=0.0849, cluster std=0.0862, individual std=0.0849, 
Average Test Accuracy: 0.8579
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (3) | Train Loss: 0.1851 | Train Acc: 0.9353
 Site-MNIST                     (3) | Train Loss: 0.2238 | Train Acc: 0.9327
 Site-USPS                      (4) | Train Loss: 0.2480 | Train Acc: 0.9326
 Site-USPS                      (4) | Train Loss: 0.2395 | Train Acc: 0.9265
 Site-SynthDigits               (0) | Train Loss: 0.3347 | Train Acc: 0.8949
 Site-SynthDigits               (0) | Train Loss: 0.3107 | Train Acc: 0.9166
 Site-MNIST_M                   (6) | Train Loss: 0.5424 | Train Acc: 0.8194
 Site-MNIST_M                   (1) | Train Loss: 0.4670 | Train Acc: 0.8646
 Site-SVHN                      (2) | Train Loss: 0.7694 | Train Acc: 0.7520
 Site-SVHN                      (5) | Train Loss: 0.6100 | Train Acc: 0.8179
Average Train Accuracy: 0.8793
 Site-MNIST                     (3) | Val  Loss: 0.1401 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2374 | Val  Acc: 0.9424
 Site-USPS                      (4) | Val  Loss: 0.3333 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2757 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3251 | Val  Acc: 0.8913
 Site-SynthDigits               (0) | Val  Loss: 0.2983 | Val  Acc: 0.9029
 Site-MNIST_M                   (6) | Val  Loss: 0.4893 | Val  Acc: 0.8478
 Site-MNIST_M                   (1) | Val  Loss: 0.4475 | Val  Acc: 0.8597
 Site-SVHN                      (2) | Val  Loss: 0.6564 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.6590 | Val  Acc: 0.8058
Average Valid Accuracy: 0.8776
 Test site-MNIST                     (3)| Epoch:45 | Test Acc: 0.9394
 Test site-USPS                      (4)| Epoch:45 | Test Acc: 0.9333
 Test site-SynthDigits               (0)| Epoch:45 | Test Acc: 0.9028
 Test site-MNIST_M                   (6)| Epoch:45 | Test Acc: 0.7794
 Test site-SVHN                      (2)| Epoch:45 | Test Acc: 0.7342
MNIST: 0.9394, USPS: 0.9333, SynthDigits: 0.9028, MNIST_M: 0.7794, SVHN: 0.7342, 
Average Test Accuracy(group): 0.8578, Average Test Accuracy(individual): 0.8578,
domain std=0.0846, cluster std=0.0857, individual std=0.0846, 
Average Test Accuracy: 0.8578
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (3) | Train Loss: 0.1773 | Train Acc: 0.9434
 Site-MNIST                     (3) | Train Loss: 0.2250 | Train Acc: 0.9345
 Site-USPS                      (0) | Train Loss: 0.2367 | Train Acc: 0.9407
 Site-USPS                      (0) | Train Loss: 0.2340 | Train Acc: 0.9291
 Site-SynthDigits               (4) | Train Loss: 0.3317 | Train Acc: 0.8895
 Site-SynthDigits               (6) | Train Loss: 0.3031 | Train Acc: 0.9148
 Site-MNIST_M                   (2) | Train Loss: 0.5409 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 0.4601 | Train Acc: 0.8664
 Site-SVHN                      (1) | Train Loss: 0.7715 | Train Acc: 0.7466
 Site-SVHN                      (5) | Train Loss: 0.5931 | Train Acc: 0.8188
Average Train Accuracy: 0.8809
 Site-MNIST                     (3) | Val  Loss: 0.1383 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2322 | Val  Acc: 0.9424
 Site-USPS                      (0) | Val  Loss: 0.3214 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.2663 | Val  Acc: 0.9065
 Site-SynthDigits               (4) | Val  Loss: 0.3227 | Val  Acc: 0.8804
 Site-SynthDigits               (6) | Val  Loss: 0.3009 | Val  Acc: 0.8993
 Site-MNIST_M                   (2) | Val  Loss: 0.4931 | Val  Acc: 0.8478
 Site-MNIST_M                   (2) | Val  Loss: 0.4472 | Val  Acc: 0.8597
 Site-SVHN                      (1) | Val  Loss: 0.6445 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.6467 | Val  Acc: 0.8022
Average Valid Accuracy: 0.8758
 Test site-MNIST                     (3)| Epoch:46 | Test Acc: 0.9399
 Test site-USPS                      (0)| Epoch:46 | Test Acc: 0.9376
 Test site-SynthDigits               (4)| Epoch:46 | Test Acc: 0.9007
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.7814
 Test site-SVHN                      (1)| Epoch:46 | Test Acc: 0.7331
MNIST: 0.9399, USPS: 0.9376, SynthDigits: 0.9007, MNIST_M: 0.7814, SVHN: 0.7331, 
Average Test Accuracy(group): 0.8585, Average Test Accuracy(individual): 0.8585,
domain std=0.0852, cluster std=0.0869, individual std=0.0852, 
Average Test Accuracy: 0.8585
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (0) | Train Loss: 0.1728 | Train Acc: 0.9353
 Site-MNIST                     (0) | Train Loss: 0.2231 | Train Acc: 0.9363
 Site-USPS                      (4) | Train Loss: 0.2320 | Train Acc: 0.9353
 Site-USPS                      (6) | Train Loss: 0.2243 | Train Acc: 0.9309
 Site-SynthDigits               (3) | Train Loss: 0.3335 | Train Acc: 0.8976
 Site-SynthDigits               (3) | Train Loss: 0.3088 | Train Acc: 0.9184
 Site-MNIST_M                   (2) | Train Loss: 0.5298 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 0.4566 | Train Acc: 0.8673
 Site-SVHN                      (1) | Train Loss: 0.7671 | Train Acc: 0.7439
 Site-SVHN                      (5) | Train Loss: 0.6012 | Train Acc: 0.8152
Average Train Accuracy: 0.8805
 Site-MNIST                     (0) | Val  Loss: 0.1361 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2312 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3125 | Val  Acc: 0.8587
 Site-USPS                      (6) | Val  Loss: 0.2522 | Val  Acc: 0.9137
 Site-SynthDigits               (3) | Val  Loss: 0.3213 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.2953 | Val  Acc: 0.8921
 Site-MNIST_M                   (2) | Val  Loss: 0.4822 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4410 | Val  Acc: 0.8633
 Site-SVHN                      (1) | Val  Loss: 0.6366 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.6503 | Val  Acc: 0.8022
Average Valid Accuracy: 0.8758
 Test site-MNIST                     (0)| Epoch:47 | Test Acc: 0.9379
 Test site-USPS                      (4)| Epoch:47 | Test Acc: 0.9419
 Test site-SynthDigits               (3)| Epoch:47 | Test Acc: 0.9020
 Test site-MNIST_M                   (2)| Epoch:47 | Test Acc: 0.7834
 Test site-SVHN                      (1)| Epoch:47 | Test Acc: 0.7323
MNIST: 0.9379, USPS: 0.9419, SynthDigits: 0.9020, MNIST_M: 0.7834, SVHN: 0.7323, 
Average Test Accuracy(group): 0.8595, Average Test Accuracy(individual): 0.8595,
domain std=0.0857, cluster std=0.0921, individual std=0.0857, 
Average Test Accuracy: 0.8595
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
============ Train epoch 49 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (4) | Train Loss: 0.1672 | Train Acc: 0.9488
 Site-MNIST                     (4) | Train Loss: 0.2217 | Train Acc: 0.9336
 Site-USPS                      (0) | Train Loss: 0.2343 | Train Acc: 0.9353
 Site-USPS                      (6) | Train Loss: 0.2299 | Train Acc: 0.9283
 Site-SynthDigits               (3) | Train Loss: 0.3269 | Train Acc: 0.8949
 Site-SynthDigits               (3) | Train Loss: 0.2962 | Train Acc: 0.9157
 Site-MNIST_M                   (2) | Train Loss: 0.5237 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 0.4488 | Train Acc: 0.8583
 Site-SVHN                      (1) | Train Loss: 0.7553 | Train Acc: 0.7601
 Site-SVHN                      (5) | Train Loss: 0.5935 | Train Acc: 0.8278
Average Train Accuracy: 0.8828
 Site-MNIST                     (4) | Val  Loss: 0.1354 | Val  Acc: 0.9565
 Site-MNIST                     (4) | Val  Loss: 0.2319 | Val  Acc: 0.9424
 Site-USPS                      (0) | Val  Loss: 0.3300 | Val  Acc: 0.8587
 Site-USPS                      (6) | Val  Loss: 0.2691 | Val  Acc: 0.9137
 Site-SynthDigits               (3) | Val  Loss: 0.3080 | Val  Acc: 0.9022
 Site-SynthDigits               (3) | Val  Loss: 0.2926 | Val  Acc: 0.9137
 Site-MNIST_M                   (2) | Val  Loss: 0.4770 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4377 | Val  Acc: 0.8597
 Site-SVHN                      (1) | Val  Loss: 0.6446 | Val  Acc: 0.8261
 Site-SVHN                      (5) | Val  Loss: 0.6398 | Val  Acc: 0.8165
Average Valid Accuracy: 0.8848
 Best site-MNIST                    (4)  | Epoch:49 | Val Acc: 0.9565
 Best site-MNIST                    (4)  | Epoch:49 | Val Acc: 0.9424
 Best site-USPS                     (0)  | Epoch:49 | Val Acc: 0.8587
 Best site-USPS                     (6)  | Epoch:49 | Val Acc: 0.9137
 Best site-SynthDigits              (3)  | Epoch:49 | Val Acc: 0.9022
 Best site-SynthDigits              (3)  | Epoch:49 | Val Acc: 0.9137
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8597
 Best site-SVHN                     (1)  | Epoch:49 | Val Acc: 0.8261
 Best site-SVHN                     (5)  | Epoch:49 | Val Acc: 0.8165
 Test site-MNIST                     (4)| Epoch:49 | Test Acc: 0.9396
 Test site-USPS                      (0)| Epoch:49 | Test Acc: 0.9355
 Test site-SynthDigits               (3)| Epoch:49 | Test Acc: 0.9012
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7844
 Test site-SVHN                      (1)| Epoch:49 | Test Acc: 0.7343
MNIST: 0.9396, USPS: 0.9355, SynthDigits: 0.9012, MNIST_M: 0.7844, SVHN: 0.7343, 
Average Test Accuracy(group): 0.8590, Average Test Accuracy(individual): 0.8590,
domain std=0.0839, cluster std=0.0897, individual std=0.0839, 
Average Test Accuracy: 0.8590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_7/ccop_q=1...
===2023-08-12 12:14:47===
===2023-08-12 12:14:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 7
Loading snapshots...
 Test site-MNIST                     (4)| Epoch:49 | Test Acc: 0.9396
 Test site-USPS                      (0)| Epoch:49 | Test Acc: 0.9355
 Test site-SynthDigits               (3)| Epoch:49 | Test Acc: 0.9012
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7844
 Test site-SVHN                      (1)| Epoch:49 | Test Acc: 0.7343
MNIST: 0.9396, USPS: 0.9355, SynthDigits: 0.9012, MNIST_M: 0.7844, SVHN: 0.7343, 
Average Test Accuracy(group): 0.8590, Average Test Accuracy(individual): 0.8590,
domain std=0.0839, cluster std=0.0897, individual std=0.0839, 
