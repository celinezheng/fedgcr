===2023-08-11 04:23:58===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.0496 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.9974 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.0620 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 1.0287 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0649 | Train Acc: 0.9651
 Site-art_painting                  | Train Loss: 1.4760 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.4577 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 1.4437 | Train Acc: 0.7653
 Site-cartoon                       | Train Loss: 1.5308 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.5676 | Train Acc: 0.7384
 Site-sketch                        | Train Loss: 1.8078 | Train Acc: 0.3719
Average Train Accuracy: 0.8307
 Site-photo                         | Val  Loss: 1.0773 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 1.0863 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 1.2088 | Val  Acc: 0.9559
 Site-photo                         | Val  Loss: 1.0466 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 1.0462 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.3747 | Val  Acc: 0.7857
 Site-art_painting                  | Val  Loss: 1.4214 | Val  Acc: 0.7619
 Site-art_painting                  | Val  Loss: 1.4990 | Val  Acc: 0.7606
 Site-cartoon                       | Val  Loss: 1.6242 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.5906 | Val  Acc: 0.6435
 Site-sketch                        | Val  Loss: 1.8107 | Val  Acc: 0.2875
Average Valid Accuracy: 0.7988
 Best site-photo                     | Epoch:0 | Val Acc: 0.9667
 Best site-photo                     | Epoch:0 | Val Acc: 0.9556
 Best site-photo                     | Epoch:0 | Val Acc: 0.9559
 Best site-photo                     | Epoch:0 | Val Acc: 0.9804
 Best site-photo                     | Epoch:0 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7857
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7619
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7606
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.6957
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.6435
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 0.5328 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.4825 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4959 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5165 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.5374 | Train Acc: 0.9782
 Site-art_painting                  | Train Loss: 1.1402 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 1.0898 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 1.0554 | Train Acc: 0.8263
 Site-cartoon                       | Train Loss: 1.2512 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.2887 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.6913 | Train Acc: 0.4298
Average Train Accuracy: 0.8548
 Site-photo                         | Val  Loss: 0.5725 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.5502 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.7064 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5181 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5170 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.9584 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 1.0401 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.1258 | Val  Acc: 0.8310
 Site-cartoon                       | Val  Loss: 1.3260 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.3199 | Val  Acc: 0.7565
 Site-sketch                        | Val  Loss: 1.6673 | Val  Acc: 0.3750
Average Valid Accuracy: 0.8616
 Best site-photo                     | Epoch:1 | Val Acc: 0.9667
 Best site-photo                     | Epoch:1 | Val Acc: 0.9778
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:1 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8730
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8310
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7565
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 0.2652 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2027 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2685 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.2595 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2582 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.9147 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.9286 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.8757 | Train Acc: 0.8592
 Site-cartoon                       | Train Loss: 1.0556 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.1095 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.5515 | Train Acc: 0.4959
Average Train Accuracy: 0.8610
 Site-photo                         | Val  Loss: 0.2523 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2785 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2982 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2460 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2498 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.7521 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.8152 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 0.8967 | Val  Acc: 0.8521
 Site-cartoon                       | Val  Loss: 1.2060 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.1523 | Val  Acc: 0.7304
 Site-sketch                        | Val  Loss: 1.5157 | Val  Acc: 0.3625
Average Valid Accuracy: 0.8578
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 0.1520 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0690 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1155 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1430 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1457 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.7139 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.7286 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.7242 | Train Acc: 0.8638
 Site-cartoon                       | Train Loss: 1.0597 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 0.9632 | Train Acc: 0.8023
 Site-sketch                        | Train Loss: 1.4406 | Train Acc: 0.5124
Average Train Accuracy: 0.8666
 Site-photo                         | Val  Loss: 0.1223 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1453 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1636 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1362 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1332 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5152 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.6375 | Val  Acc: 0.8889
 Site-art_painting                  | Val  Loss: 0.7644 | Val  Acc: 0.8732
 Site-cartoon                       | Val  Loss: 1.0357 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 0.9907 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.4120 | Val  Acc: 0.4625
Average Valid Accuracy: 0.8797
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 0.9902
 Best site-photo                     | Epoch:3 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:3 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8732
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7652
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.1197 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0472 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0629 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0720 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0935 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6589 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.6609 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.6101 | Train Acc: 0.9061
 Site-cartoon                       | Train Loss: 1.0341 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.8711 | Train Acc: 0.8081
 Site-sketch                        | Train Loss: 1.3479 | Train Acc: 0.4959
Average Train Accuracy: 0.8767
 Site-photo                         | Val  Loss: 0.1397 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0915 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1066 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0744 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1205 | Val  Acc: 0.9737
 Site-art_painting                  | Val  Loss: 0.3852 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.4837 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.6192 | Val  Acc: 0.8732
 Site-cartoon                       | Val  Loss: 0.9265 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.9012 | Val  Acc: 0.7913
 Site-sketch                        | Val  Loss: 1.3054 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8869
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8732
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.7913
 Best site-sketch                    | Epoch:4 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.0900 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0307 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0365 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0612 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.0558 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5228 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.5807 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 0.5141 | Train Acc: 0.8967
 Site-cartoon                       | Train Loss: 0.8650 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.8157 | Train Acc: 0.7558
 Site-sketch                        | Train Loss: 1.3237 | Train Acc: 0.5041
Average Train Accuracy: 0.8705
 Site-photo                         | Val  Loss: 0.0581 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0763 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0667 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0432 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0523 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4620 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.4262 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.4895 | Val  Acc: 0.8873
 Site-cartoon                       | Val  Loss: 0.8479 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.8392 | Val  Acc: 0.7913
 Site-sketch                        | Val  Loss: 1.2508 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8974
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8873
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7913
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.0711 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0253 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0264 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0339 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0410 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5987 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.5325 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.4279 | Train Acc: 0.9249
 Site-cartoon                       | Train Loss: 0.8968 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.8105 | Train Acc: 0.8023
 Site-sketch                        | Train Loss: 1.2450 | Train Acc: 0.5620
Average Train Accuracy: 0.8859
 Site-photo                         | Val  Loss: 0.0820 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0662 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1376 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0343 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0309 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.3377 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.3624 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.4817 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.7793 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 0.7607 | Val  Acc: 0.7565
 Site-sketch                        | Val  Loss: 1.1667 | Val  Acc: 0.5250
Average Valid Accuracy: 0.8935
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.0549 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0102 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0124 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0280 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0233 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5402 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.5117 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.4237 | Train Acc: 0.9061
 Site-cartoon                       | Train Loss: 0.8390 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.6937 | Train Acc: 0.8023
 Site-sketch                        | Train Loss: 1.1734 | Train Acc: 0.5537
Average Train Accuracy: 0.8880
 Site-photo                         | Val  Loss: 0.0186 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0212 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3326 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.3438 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.4218 | Val  Acc: 0.9085
 Site-cartoon                       | Val  Loss: 0.6761 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.7321 | Val  Acc: 0.8348
 Site-sketch                        | Val  Loss: 1.0942 | Val  Acc: 0.5375
Average Valid Accuracy: 0.9127
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9085
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8348
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.0918 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0093 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0318 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0179 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4198 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3964 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.3895 | Train Acc: 0.9108
 Site-cartoon                       | Train Loss: 0.7543 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.6645 | Train Acc: 0.8314
 Site-sketch                        | Train Loss: 1.2596 | Train Acc: 0.5124
Average Train Accuracy: 0.8957
 Site-photo                         | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0411 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0299 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0287 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2224 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3432 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.4418 | Val  Acc: 0.8944
 Site-cartoon                       | Val  Loss: 0.6787 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.6595 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.1726 | Val  Acc: 0.4875
Average Valid Accuracy: 0.9075
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.0685 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0052 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0266 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0245 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.4327 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.4691 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.3442 | Train Acc: 0.9343
 Site-cartoon                       | Train Loss: 0.6802 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.6184 | Train Acc: 0.8605
 Site-sketch                        | Train Loss: 1.1471 | Train Acc: 0.5537
Average Train Accuracy: 0.8983
 Site-photo                         | Val  Loss: 0.0184 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2664 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.3574 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.3597 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.5479 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.6927 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.1192 | Val  Acc: 0.5250
Average Valid Accuracy: 0.9131
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9155
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7739
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.1054 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0092 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0139 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0136 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3993 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3749 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.3370 | Train Acc: 0.9108
 Site-cartoon                       | Train Loss: 0.7322 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.5633 | Train Acc: 0.8895
 Site-sketch                        | Train Loss: 1.0957 | Train Acc: 0.5868
Average Train Accuracy: 0.9035
 Site-photo                         | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0168 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0212 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0209 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2617 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.3450 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.4060 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 0.5254 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.6099 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 1.0205 | Val  Acc: 0.5000
Average Valid Accuracy: 0.9044
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.0515 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0157 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3546 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3767 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.2996 | Train Acc: 0.9390
 Site-cartoon                       | Train Loss: 0.7371 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.5894 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 1.0873 | Train Acc: 0.5868
Average Train Accuracy: 0.9095
 Site-photo                         | Val  Loss: 0.0065 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0124 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0205 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2006 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2498 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.3360 | Val  Acc: 0.9296
 Site-cartoon                       | Val  Loss: 0.5343 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.5749 | Val  Acc: 0.8348
 Site-sketch                        | Val  Loss: 1.0444 | Val  Acc: 0.5500
Average Valid Accuracy: 0.9209
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:11 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9296
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8348
 Best site-sketch                    | Epoch:11 | Val Acc: 0.5500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.0506 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0192 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0259 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0097 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3746 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3170 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2842 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.6735 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.5158 | Train Acc: 0.8488
 Site-sketch                        | Train Loss: 1.0762 | Train Acc: 0.5785
Average Train Accuracy: 0.9074
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0083 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2237 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.2559 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2821 | Val  Acc: 0.9296
 Site-cartoon                       | Val  Loss: 0.5417 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.5601 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 0.9814 | Val  Acc: 0.5500
Average Valid Accuracy: 0.9213
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9296
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8609
 Best site-sketch                    | Epoch:12 | Val Acc: 0.5500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.0576 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0058 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0137 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3949 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.4479 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.2662 | Train Acc: 0.9296
 Site-cartoon                       | Train Loss: 0.6706 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.4928 | Train Acc: 0.8895
 Site-sketch                        | Train Loss: 1.0799 | Train Acc: 0.5950
Average Train Accuracy: 0.9051
 Site-photo                         | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0122 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1970 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.2244 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.3011 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.4724 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.5456 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 1.0108 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9247
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9155
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.8783
 Best site-sketch                    | Epoch:13 | Val Acc: 0.5750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.0710 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0390 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0096 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0086 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3193 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3814 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.2282 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.8778 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.4811 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 0.9942 | Train Acc: 0.6198
Average Train Accuracy: 0.9050
 Site-photo                         | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1749 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1908 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.3639 | Val  Acc: 0.9085
 Site-cartoon                       | Val  Loss: 0.4370 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.5114 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 0.9389 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9309
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9085
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8435
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.0443 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0049 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3450 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2843 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.2815 | Train Acc: 0.9390
 Site-cartoon                       | Train Loss: 0.7013 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4871 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 1.0346 | Train Acc: 0.6198
Average Train Accuracy: 0.9170
 Site-photo                         | Val  Loss: 0.0183 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2058 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2539 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2428 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3639 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4745 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 0.9079 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9316
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9437
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8870
 Best site-sketch                    | Epoch:15 | Val Acc: 0.5875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.0420 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0109 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0058 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2664 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.3609 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.2347 | Train Acc: 0.9390
 Site-cartoon                       | Train Loss: 0.6362 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.4032 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.9218 | Train Acc: 0.6777
Average Train Accuracy: 0.9209
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1355 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.2195 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.3137 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.4625 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4661 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.9383 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9350
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:16 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:16 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:16 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.8957
 Best site-sketch                    | Epoch:16 | Val Acc: 0.6375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.0609 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0118 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0114 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4179 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3990 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.2155 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.6785 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.4047 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.9645 | Train Acc: 0.6694
Average Train Accuracy: 0.9228
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0120 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1534 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2612 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.1859 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3781 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4586 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.9399 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9338
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.0398 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0093 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2905 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3736 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.1929 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.7381 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.4492 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 1.0132 | Train Acc: 0.6446
Average Train Accuracy: 0.9146
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2058 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1887 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2548 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3566 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4663 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 0.9052 | Val  Acc: 0.5625
Average Valid Accuracy: 0.9229
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0305 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3348 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3573 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.2896 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.4822 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.3889 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.9013 | Train Acc: 0.6446
Average Train Accuracy: 0.9240
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1347 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1791 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.2402 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.3754 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4543 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 0.8838 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9265
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0355 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0062 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3149 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.2533 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1850 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6373 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3619 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.9598 | Train Acc: 0.6033
Average Train Accuracy: 0.9194
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1368 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2608 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.2387 | Val  Acc: 0.9296
 Site-cartoon                       | Val  Loss: 0.3720 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4800 | Val  Acc: 0.8261
 Site-sketch                        | Val  Loss: 0.8881 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9234
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0315 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0040 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2855 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2795 | Train Acc: 0.8842
 Site-art_painting                  | Train Loss: 0.1844 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.5867 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3889 | Train Acc: 0.8779
 Site-sketch                        | Train Loss: 0.9577 | Train Acc: 0.6777
Average Train Accuracy: 0.9150
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0193 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1370 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1643 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2113 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.2924 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4259 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 0.9276 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9475
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 0.9902
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9507
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.9565
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8696
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0565 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3211 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3249 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2106 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6383 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3798 | Train Acc: 0.8837
 Site-sketch                        | Train Loss: 0.8842 | Train Acc: 0.7107
Average Train Accuracy: 0.9248
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0179 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1091 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1305 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1967 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.3321 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4577 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.8595 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9358
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0732 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3603 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3045 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.1827 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.5358 | Train Acc: 0.9118
 Site-cartoon                       | Train Loss: 0.3378 | Train Acc: 0.9186
 Site-sketch                        | Train Loss: 0.9441 | Train Acc: 0.6694
Average Train Accuracy: 0.9278
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0907 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1373 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1887 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3768 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4039 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 0.8464 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9393
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0320 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0050 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0112 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0049 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3234 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3003 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.1748 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.6932 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3135 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.8984 | Train Acc: 0.6860
Average Train Accuracy: 0.9203
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1335 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1591 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1739 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.2477 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4148 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 0.8781 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9383
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0364 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0061 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0101 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2143 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.2889 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.1825 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.5405 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.2946 | Train Acc: 0.9302
 Site-sketch                        | Train Loss: 0.8392 | Train Acc: 0.7273
Average Train Accuracy: 0.9362
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0941 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1617 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2014 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.3318 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3493 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.7829 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9421
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0211 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0101 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3190 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2652 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1958 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.4674 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.3286 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.8360 | Train Acc: 0.7025
Average Train Accuracy: 0.9346
 Site-photo                         | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0064 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0785 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1484 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1429 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3123 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3879 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.7898 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9510
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.9565
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.8783
 Best site-sketch                    | Epoch:26 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0334 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3628 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2550 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.1428 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.6043 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.2977 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.8775 | Train Acc: 0.6942
Average Train Accuracy: 0.9253
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0062 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0779 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1102 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1685 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.2739 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3635 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 0.8986 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9363
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0337 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0156 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0378 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3006 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.2513 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1287 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.5095 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.3148 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.8111 | Train Acc: 0.7025
Average Train Accuracy: 0.9253
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1251 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1218 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1519 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.3066 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.3500 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 0.8147 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9340
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0211 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2994 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2440 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1706 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.5412 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3141 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.7967 | Train Acc: 0.7107
Average Train Accuracy: 0.9303
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0767 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1646 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.1829 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.2836 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3109 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.8118 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9432
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0515 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3548 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2111 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1121 | Train Acc: 0.9812
 Site-cartoon                       | Train Loss: 0.6554 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.2884 | Train Acc: 0.9186
 Site-sketch                        | Train Loss: 0.7971 | Train Acc: 0.7107
Average Train Accuracy: 0.9274
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1293 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1262 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.2822 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3071 | Val  Acc: 0.9217
 Site-sketch                        | Val  Loss: 0.7316 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9456
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0305 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0057 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2831 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.2214 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1753 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.4362 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.2388 | Train Acc: 0.9419
 Site-sketch                        | Train Loss: 0.8569 | Train Acc: 0.6612
Average Train Accuracy: 0.9338
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0446 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1272 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2042 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.2045 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.3777 | Val  Acc: 0.9043
 Site-sketch                        | Val  Loss: 0.7941 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9513
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9507
 Best site-cartoon                   | Epoch:31 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.9043
 Best site-sketch                    | Epoch:31 | Val Acc: 0.6250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0626 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0097 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2574 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2501 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1405 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.5252 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.2412 | Train Acc: 0.9419
 Site-sketch                        | Train Loss: 0.8365 | Train Acc: 0.6942
Average Train Accuracy: 0.9337
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0840 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1686 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1281 | Val  Acc: 0.9366
 Site-cartoon                       | Val  Loss: 0.2477 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3397 | Val  Acc: 0.9304
 Site-sketch                        | Val  Loss: 0.8143 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9349
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0219 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2120 | Train Acc: 0.9762
 Site-art_painting                  | Train Loss: 0.2549 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1784 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.4488 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.2606 | Train Acc: 0.9419
 Site-sketch                        | Train Loss: 0.8194 | Train Acc: 0.7190
Average Train Accuracy: 0.9449
 Site-photo                         | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0471 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1237 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1629 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.2251 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.2917 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.8218 | Val  Acc: 0.7125
Average Valid Accuracy: 0.9568
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:33 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9648
 Best site-cartoon                   | Epoch:33 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8957
 Best site-sketch                    | Epoch:33 | Val Acc: 0.7125
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0160 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0055 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2167 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.1938 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1276 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.5633 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.2602 | Train Acc: 0.9302
 Site-sketch                        | Train Loss: 0.8450 | Train Acc: 0.6777
Average Train Accuracy: 0.9263
 Site-photo                         | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0182 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0176 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0563 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1553 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3495 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.2874 | Val  Acc: 0.9391
 Site-sketch                        | Val  Loss: 0.7948 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9472
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0304 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2276 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2929 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1516 | Train Acc: 0.9812
 Site-cartoon                       | Train Loss: 0.6620 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.2929 | Train Acc: 0.9360
 Site-sketch                        | Train Loss: 0.8102 | Train Acc: 0.7107
Average Train Accuracy: 0.9323
 Site-photo                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0121 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0652 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1034 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1518 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.2557 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.2885 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.7787 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9420
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0481 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4009 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.2223 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1516 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.3731 | Train Acc: 0.9118
 Site-cartoon                       | Train Loss: 0.2332 | Train Acc: 0.9419
 Site-sketch                        | Train Loss: 0.7839 | Train Acc: 0.7025
Average Train Accuracy: 0.9419
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0681 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.0951 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1435 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.2038 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.2842 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.8318 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9429
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.1018 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0040 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3925 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.1932 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1517 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.4730 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.2613 | Train Acc: 0.9360
 Site-sketch                        | Train Loss: 0.8003 | Train Acc: 0.7107
Average Train Accuracy: 0.9296
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0598 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0886 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2062 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.1707 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.3270 | Val  Acc: 0.9043
 Site-sketch                        | Val  Loss: 0.7056 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9552
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0238 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2682 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2119 | Train Acc: 0.9579
 Site-art_painting                  | Train Loss: 0.1224 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.5456 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.2164 | Train Acc: 0.9593
 Site-sketch                        | Train Loss: 0.7649 | Train Acc: 0.7190
Average Train Accuracy: 0.9416
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0385 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1145 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.0871 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.2176 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3088 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.7671 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9475
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0550 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3601 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.1589 | Train Acc: 0.9684
 Site-art_painting                  | Train Loss: 0.1396 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.5401 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.2271 | Train Acc: 0.9302
 Site-sketch                        | Train Loss: 0.7727 | Train Acc: 0.6942
Average Train Accuracy: 0.9303
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0475 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0992 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1069 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.1698 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.2585 | Val  Acc: 0.9304
 Site-sketch                        | Val  Loss: 0.7255 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9564
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0149 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3386 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.2410 | Train Acc: 0.9579
 Site-art_painting                  | Train Loss: 0.0725 | Train Acc: 0.9906
 Site-cartoon                       | Train Loss: 0.5048 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.2412 | Train Acc: 0.9477
 Site-sketch                        | Train Loss: 0.7327 | Train Acc: 0.7769
Average Train Accuracy: 0.9488
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0349 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0936 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.0912 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.2001 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.2899 | Val  Acc: 0.9391
 Site-sketch                        | Val  Loss: 0.6891 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9627
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:40 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9789
 Best site-cartoon                   | Epoch:40 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.9391
 Best site-sketch                    | Epoch:40 | Val Acc: 0.6875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedsam...
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0253 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3627 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.1876 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.1029 | Train Acc: 0.9812
 Site-cartoon                       | Train Loss: 0.3514 | Train Acc: 0.9412
 Site-cartoon                       | Train Loss: 0.1837 | Train Acc: 0.9593
 Site-sketch                        | Train Loss: 0.7710 | Train Acc: 0.7273
Average Train Accuracy: 0.9486
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1227 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1253 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1304 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.1586 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.2433 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.7088 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9524
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0337 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2093 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2044 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.0756 | Train Acc: 0.9765
 Site-cartoon                       | Train Loss: 0.4591 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.2127 | Train Acc: 0.9477
 Site-sketch                        | Train Loss: 0.7227 | Train Acc: 0.7190
Average Train Accuracy: 0.9336
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0320 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0945 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1220 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.1547 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.2942 | Val  Acc: 0.9478
 Site-sketch                        | Val  Loss: 0.6719 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9575
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0269 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2679 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2361 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1184 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.5523 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.2282 | Train Acc: 0.9535
 Site-sketch                        | Train Loss: 0.7022 | Train Acc: 0.7603
Average Train Accuracy: 0.9403
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0444 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1129 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.1413 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3194 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.6622 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9548
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0099 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2777 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2131 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.1162 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.5052 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.1978 | Train Acc: 0.9767
 Site-sketch                        | Train Loss: 0.7984 | Train Acc: 0.6694
Average Train Accuracy: 0.9347
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0605 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1019 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1662 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.2444 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.2710 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.7535 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9427
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0092 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3311 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.1646 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.1145 | Train Acc: 0.9765
 Site-cartoon                       | Train Loss: 0.6279 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.2063 | Train Acc: 0.9535
 Site-sketch                        | Train Loss: 0.7558 | Train Acc: 0.6860
Average Train Accuracy: 0.9418
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0329 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0449 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.0968 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.1816 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.2505 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.7393 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9518
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0312 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2401 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2383 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1199 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.5445 | Train Acc: 0.9118
 Site-cartoon                       | Train Loss: 0.1900 | Train Acc: 0.9651
 Site-sketch                        | Train Loss: 0.7587 | Train Acc: 0.7273
Average Train Accuracy: 0.9432
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0368 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1096 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1168 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.2196 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.2761 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.6231 | Val  Acc: 0.7375
Average Valid Accuracy: 0.9564
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0190 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1456 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.1522 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1582 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.4477 | Train Acc: 0.9118
 Site-cartoon                       | Train Loss: 0.1739 | Train Acc: 0.9477
 Site-sketch                        | Train Loss: 0.7371 | Train Acc: 0.7438
Average Train Accuracy: 0.9513
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0482 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0729 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1205 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.1525 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3544 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 0.7484 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9511
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0247 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0000 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3099 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.1832 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.0718 | Train Acc: 0.9812
 Site-cartoon                       | Train Loss: 0.6121 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.2086 | Train Acc: 0.9477
 Site-sketch                        | Train Loss: 0.6845 | Train Acc: 0.7603
Average Train Accuracy: 0.9349
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1054 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0740 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.2158 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.2792 | Val  Acc: 0.9217
 Site-sketch                        | Val  Loss: 0.6798 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9546
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0124 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0131 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2874 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.1549 | Train Acc: 0.9684
 Site-art_painting                  | Train Loss: 0.0743 | Train Acc: 0.9859
 Site-cartoon                       | Train Loss: 0.6276 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.2119 | Train Acc: 0.9477
 Site-sketch                        | Train Loss: 0.6895 | Train Acc: 0.7521
Average Train Accuracy: 0.9372
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0455 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0753 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.2223 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.2848 | Val  Acc: 0.9217
 Site-sketch                        | Val  Loss: 0.7099 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9495
===2023-08-11 04:56:39===
===2023-08-11 04:56:53===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:40 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:40 | Test Acc: 0.9184
 Test site-cartoon                   | Epoch:40 | Test Acc: 0.8255
 Test site-sketch                    | Epoch:40 | Test Acc: 0.6563
photo: 0.9985, art_painting: 0.9184, cartoon: 0.8255, sketch: 0.6563, 
Average Test Accuracy(group): 0.8497, Average Test Accuracy(individual): 0.9141,
domain std=0.1273, cluster std=-1.0000, individual std=0.1035, 
