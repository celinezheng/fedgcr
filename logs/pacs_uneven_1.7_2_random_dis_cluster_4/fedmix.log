===2023-08-11 04:58:25===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.8185 | Train Acc: 0.5111
 Site-photo                         | Train Loss: 1.8127 | Train Acc: 0.6912
 Site-photo                         | Train Loss: 1.8197 | Train Acc: 0.5686
 Site-photo                         | Train Loss: 1.8127 | Train Acc: 0.5229
 Site-photo                         | Train Loss: 1.8220 | Train Acc: 0.5546
 Site-art_painting                  | Train Loss: 1.8839 | Train Acc: 0.2381
 Site-art_painting                  | Train Loss: 1.8977 | Train Acc: 0.2632
 Site-art_painting                  | Train Loss: 1.8990 | Train Acc: 0.2958
 Site-cartoon                       | Train Loss: 1.9077 | Train Acc: 0.2941
 Site-cartoon                       | Train Loss: 1.8965 | Train Acc: 0.2849
 Site-sketch                        | Train Loss: 1.9314 | Train Acc: 0.1983
Average Train Accuracy: 0.4021
 Site-photo                         | Val  Loss: 1.8252 | Val  Acc: 0.4667
 Site-photo                         | Val  Loss: 1.8236 | Val  Acc: 0.5111
 Site-photo                         | Val  Loss: 1.8399 | Val  Acc: 0.6029
 Site-photo                         | Val  Loss: 1.8133 | Val  Acc: 0.4706
 Site-photo                         | Val  Loss: 1.8139 | Val  Acc: 0.5329
 Site-art_painting                  | Val  Loss: 1.8841 | Val  Acc: 0.3214
 Site-art_painting                  | Val  Loss: 1.8874 | Val  Acc: 0.2540
 Site-art_painting                  | Val  Loss: 1.8799 | Val  Acc: 0.2746
 Site-cartoon                       | Val  Loss: 1.9159 | Val  Acc: 0.3043
 Site-cartoon                       | Val  Loss: 1.8917 | Val  Acc: 0.2870
 Site-sketch                        | Val  Loss: 1.9270 | Val  Acc: 0.1625
Average Valid Accuracy: 0.3807
 Best site-photo                     | Epoch:0 | Val Acc: 0.4667
 Best site-photo                     | Epoch:0 | Val Acc: 0.5111
 Best site-photo                     | Epoch:0 | Val Acc: 0.6029
 Best site-photo                     | Epoch:0 | Val Acc: 0.4706
 Best site-photo                     | Epoch:0 | Val Acc: 0.5329
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3214
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2540
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2746
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.3043
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.2870
 Best site-sketch                    | Epoch:0 | Val Acc: 0.1625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 1.7366 | Train Acc: 0.7556
 Site-photo                         | Train Loss: 1.7387 | Train Acc: 0.8676
 Site-photo                         | Train Loss: 1.7128 | Train Acc: 0.7843
 Site-photo                         | Train Loss: 1.7224 | Train Acc: 0.8105
 Site-photo                         | Train Loss: 1.7247 | Train Acc: 0.8341
 Site-art_painting                  | Train Loss: 1.8427 | Train Acc: 0.5000
 Site-art_painting                  | Train Loss: 1.8335 | Train Acc: 0.4526
 Site-art_painting                  | Train Loss: 1.8376 | Train Acc: 0.4695
 Site-cartoon                       | Train Loss: 1.8737 | Train Acc: 0.3529
 Site-cartoon                       | Train Loss: 1.8614 | Train Acc: 0.4012
 Site-sketch                        | Train Loss: 1.9091 | Train Acc: 0.2479
Average Train Accuracy: 0.5887
 Site-photo                         | Val  Loss: 1.7233 | Val  Acc: 0.8333
 Site-photo                         | Val  Loss: 1.7308 | Val  Acc: 0.7778
 Site-photo                         | Val  Loss: 1.7700 | Val  Acc: 0.8088
 Site-photo                         | Val  Loss: 1.7070 | Val  Acc: 0.8529
 Site-photo                         | Val  Loss: 1.7166 | Val  Acc: 0.8158
 Site-art_painting                  | Val  Loss: 1.8225 | Val  Acc: 0.5714
 Site-art_painting                  | Val  Loss: 1.8354 | Val  Acc: 0.4286
 Site-art_painting                  | Val  Loss: 1.8268 | Val  Acc: 0.5070
 Site-cartoon                       | Val  Loss: 1.9039 | Val  Acc: 0.3913
 Site-cartoon                       | Val  Loss: 1.8654 | Val  Acc: 0.3478
 Site-sketch                        | Val  Loss: 1.9080 | Val  Acc: 0.2625
Average Valid Accuracy: 0.5998
 Best site-photo                     | Epoch:1 | Val Acc: 0.8333
 Best site-photo                     | Epoch:1 | Val Acc: 0.7778
 Best site-photo                     | Epoch:1 | Val Acc: 0.8088
 Best site-photo                     | Epoch:1 | Val Acc: 0.8529
 Best site-photo                     | Epoch:1 | Val Acc: 0.8158
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5714
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4286
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5070
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.3913
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.3478
 Best site-sketch                    | Epoch:1 | Val Acc: 0.2625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 1.6180 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 1.5740 | Train Acc: 0.9412
 Site-photo                         | Train Loss: 1.6140 | Train Acc: 0.9020
 Site-photo                         | Train Loss: 1.6205 | Train Acc: 0.9150
 Site-photo                         | Train Loss: 1.6296 | Train Acc: 0.9083
 Site-art_painting                  | Train Loss: 1.7740 | Train Acc: 0.6190
 Site-art_painting                  | Train Loss: 1.7851 | Train Acc: 0.5368
 Site-art_painting                  | Train Loss: 1.7904 | Train Acc: 0.5775
 Site-cartoon                       | Train Loss: 1.8269 | Train Acc: 0.5000
 Site-cartoon                       | Train Loss: 1.8212 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.8913 | Train Acc: 0.3058
Average Train Accuracy: 0.6944
 Site-photo                         | Val  Loss: 1.6176 | Val  Acc: 0.8667
 Site-photo                         | Val  Loss: 1.6414 | Val  Acc: 0.8444
 Site-photo                         | Val  Loss: 1.6711 | Val  Acc: 0.9265
 Site-photo                         | Val  Loss: 1.6144 | Val  Acc: 0.9314
 Site-photo                         | Val  Loss: 1.6187 | Val  Acc: 0.9079
 Site-art_painting                  | Val  Loss: 1.7524 | Val  Acc: 0.6786
 Site-art_painting                  | Val  Loss: 1.7786 | Val  Acc: 0.5714
 Site-art_painting                  | Val  Loss: 1.7953 | Val  Acc: 0.5986
 Site-cartoon                       | Val  Loss: 1.8417 | Val  Acc: 0.3913
 Site-cartoon                       | Val  Loss: 1.8337 | Val  Acc: 0.4522
 Site-sketch                        | Val  Loss: 1.9083 | Val  Acc: 0.1875
Average Valid Accuracy: 0.6688
 Best site-photo                     | Epoch:2 | Val Acc: 0.8667
 Best site-photo                     | Epoch:2 | Val Acc: 0.8444
 Best site-photo                     | Epoch:2 | Val Acc: 0.9265
 Best site-photo                     | Epoch:2 | Val Acc: 0.9314
 Best site-photo                     | Epoch:2 | Val Acc: 0.9079
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6786
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5714
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5986
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.3913
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.4522
 Best site-sketch                    | Epoch:2 | Val Acc: 0.1875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 1.5175 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 1.4428 | Train Acc: 0.9559
 Site-photo                         | Train Loss: 1.5340 | Train Acc: 0.9412
 Site-photo                         | Train Loss: 1.5195 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 1.5431 | Train Acc: 0.9345
 Site-art_painting                  | Train Loss: 1.7538 | Train Acc: 0.5952
 Site-art_painting                  | Train Loss: 1.7143 | Train Acc: 0.6737
 Site-art_painting                  | Train Loss: 1.7418 | Train Acc: 0.6291
 Site-cartoon                       | Train Loss: 1.7613 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.7731 | Train Acc: 0.5523
 Site-sketch                        | Train Loss: 1.8896 | Train Acc: 0.2810
Average Train Accuracy: 0.7412
 Site-photo                         | Val  Loss: 1.5429 | Val  Acc: 0.9000
 Site-photo                         | Val  Loss: 1.5469 | Val  Acc: 0.9111
 Site-photo                         | Val  Loss: 1.5853 | Val  Acc: 0.9412
 Site-photo                         | Val  Loss: 1.5189 | Val  Acc: 0.9608
 Site-photo                         | Val  Loss: 1.5357 | Val  Acc: 0.9539
 Site-art_painting                  | Val  Loss: 1.6958 | Val  Acc: 0.7857
 Site-art_painting                  | Val  Loss: 1.7125 | Val  Acc: 0.6349
 Site-art_painting                  | Val  Loss: 1.7333 | Val  Acc: 0.6338
 Site-cartoon                       | Val  Loss: 1.8028 | Val  Acc: 0.3913
 Site-cartoon                       | Val  Loss: 1.7795 | Val  Acc: 0.5565
 Site-sketch                        | Val  Loss: 1.8696 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7268
 Best site-photo                     | Epoch:3 | Val Acc: 0.9000
 Best site-photo                     | Epoch:3 | Val Acc: 0.9111
 Best site-photo                     | Epoch:3 | Val Acc: 0.9412
 Best site-photo                     | Epoch:3 | Val Acc: 0.9608
 Best site-photo                     | Epoch:3 | Val Acc: 0.9539
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7857
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6349
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6338
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.3913
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.5565
 Best site-sketch                    | Epoch:3 | Val Acc: 0.3250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 1.4440 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 1.4304 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.4442 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.4391 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 1.4532 | Train Acc: 0.9476
 Site-art_painting                  | Train Loss: 1.6725 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.6919 | Train Acc: 0.6632
 Site-art_painting                  | Train Loss: 1.6828 | Train Acc: 0.6714
 Site-cartoon                       | Train Loss: 1.7471 | Train Acc: 0.6176
 Site-cartoon                       | Train Loss: 1.7364 | Train Acc: 0.5814
 Site-sketch                        | Train Loss: 1.8721 | Train Acc: 0.3388
Average Train Accuracy: 0.7597
 Site-photo                         | Val  Loss: 1.4648 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.4593 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 1.5230 | Val  Acc: 0.9412
 Site-photo                         | Val  Loss: 1.4305 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 1.4334 | Val  Acc: 0.9737
 Site-art_painting                  | Val  Loss: 1.6426 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.6632 | Val  Acc: 0.7143
 Site-art_painting                  | Val  Loss: 1.6865 | Val  Acc: 0.6901
 Site-cartoon                       | Val  Loss: 1.7541 | Val  Acc: 0.5217
 Site-cartoon                       | Val  Loss: 1.7525 | Val  Acc: 0.5652
 Site-sketch                        | Val  Loss: 1.8693 | Val  Acc: 0.2750
Average Valid Accuracy: 0.7546
 Best site-photo                     | Epoch:4 | Val Acc: 0.9333
 Best site-photo                     | Epoch:4 | Val Acc: 0.9556
 Best site-photo                     | Epoch:4 | Val Acc: 0.9412
 Best site-photo                     | Epoch:4 | Val Acc: 0.9804
 Best site-photo                     | Epoch:4 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7143
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6901
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.5217
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.5652
 Best site-sketch                    | Epoch:4 | Val Acc: 0.2750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 1.3563 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 1.3378 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.3444 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.3532 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 1.3623 | Train Acc: 0.9694
 Site-art_painting                  | Train Loss: 1.6355 | Train Acc: 0.6905
 Site-art_painting                  | Train Loss: 1.6144 | Train Acc: 0.7474
 Site-art_painting                  | Train Loss: 1.6167 | Train Acc: 0.7324
 Site-cartoon                       | Train Loss: 1.6984 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.7012 | Train Acc: 0.6279
 Site-sketch                        | Train Loss: 1.8550 | Train Acc: 0.2975
Average Train Accuracy: 0.7854
 Site-photo                         | Val  Loss: 1.3636 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 1.3816 | Val  Acc: 0.9111
 Site-photo                         | Val  Loss: 1.4703 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 1.3538 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 1.3610 | Val  Acc: 0.9671
 Site-art_painting                  | Val  Loss: 1.5741 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.5856 | Val  Acc: 0.7937
 Site-art_painting                  | Val  Loss: 1.6259 | Val  Acc: 0.7465
 Site-cartoon                       | Val  Loss: 1.7377 | Val  Acc: 0.5652
 Site-cartoon                       | Val  Loss: 1.7254 | Val  Acc: 0.5739
 Site-sketch                        | Val  Loss: 1.8488 | Val  Acc: 0.3125
Average Valid Accuracy: 0.7859
 Best site-photo                     | Epoch:5 | Val Acc: 0.9667
 Best site-photo                     | Epoch:5 | Val Acc: 0.9111
 Best site-photo                     | Epoch:5 | Val Acc: 0.9706
 Best site-photo                     | Epoch:5 | Val Acc: 0.9804
 Best site-photo                     | Epoch:5 | Val Acc: 0.9671
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8571
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7937
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7465
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.5652
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.5739
 Best site-sketch                    | Epoch:5 | Val Acc: 0.3125
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 1.2632 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 1.2762 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.2719 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.2920 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 1.2865 | Train Acc: 0.9738
 Site-art_painting                  | Train Loss: 1.5820 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.5730 | Train Acc: 0.7579
 Site-art_painting                  | Train Loss: 1.5656 | Train Acc: 0.7559
 Site-cartoon                       | Train Loss: 1.6470 | Train Acc: 0.6176
 Site-cartoon                       | Train Loss: 1.6773 | Train Acc: 0.6686
 Site-sketch                        | Train Loss: 1.8157 | Train Acc: 0.3554
Average Train Accuracy: 0.7890
 Site-photo                         | Val  Loss: 1.2886 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.2996 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.3871 | Val  Acc: 0.9559
 Site-photo                         | Val  Loss: 1.2667 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 1.2749 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.4893 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 1.5258 | Val  Acc: 0.7937
 Site-art_painting                  | Val  Loss: 1.5985 | Val  Acc: 0.7324
 Site-cartoon                       | Val  Loss: 1.7082 | Val  Acc: 0.5652
 Site-cartoon                       | Val  Loss: 1.6716 | Val  Acc: 0.5913
 Site-sketch                        | Val  Loss: 1.8312 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7969
 Best site-photo                     | Epoch:6 | Val Acc: 0.9333
 Best site-photo                     | Epoch:6 | Val Acc: 0.9333
 Best site-photo                     | Epoch:6 | Val Acc: 0.9559
 Best site-photo                     | Epoch:6 | Val Acc: 0.9706
 Best site-photo                     | Epoch:6 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7937
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7324
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.5652
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.5913
 Best site-sketch                    | Epoch:6 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 1.1711 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 1.0804 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.1909 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.1980 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 1.2020 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.5473 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 1.5605 | Train Acc: 0.7474
 Site-art_painting                  | Train Loss: 1.5235 | Train Acc: 0.7324
 Site-cartoon                       | Train Loss: 1.5974 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.6487 | Train Acc: 0.6628
 Site-sketch                        | Train Loss: 1.8364 | Train Acc: 0.3058
Average Train Accuracy: 0.8059
 Site-photo                         | Val  Loss: 1.2117 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 1.2081 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.3540 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 1.1846 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 1.1942 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.4541 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 1.4968 | Val  Acc: 0.8095
 Site-art_painting                  | Val  Loss: 1.5455 | Val  Acc: 0.7746
 Site-cartoon                       | Val  Loss: 1.6487 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.6321 | Val  Acc: 0.6261
 Site-sketch                        | Val  Loss: 1.8054 | Val  Acc: 0.3375
Average Valid Accuracy: 0.8239
 Best site-photo                     | Epoch:7 | Val Acc: 0.9667
 Best site-photo                     | Epoch:7 | Val Acc: 0.9333
 Best site-photo                     | Epoch:7 | Val Acc: 0.9706
 Best site-photo                     | Epoch:7 | Val Acc: 0.9902
 Best site-photo                     | Epoch:7 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8095
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7746
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.6261
 Best site-sketch                    | Epoch:7 | Val Acc: 0.3375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 1.0953 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 1.1456 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1094 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 1.1317 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1347 | Train Acc: 0.9782
 Site-art_painting                  | Train Loss: 1.4913 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 1.5243 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.4860 | Train Acc: 0.7559
 Site-cartoon                       | Train Loss: 1.5755 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.5988 | Train Acc: 0.6919
 Site-sketch                        | Train Loss: 1.7993 | Train Acc: 0.3967
Average Train Accuracy: 0.8179
 Site-photo                         | Val  Loss: 1.1313 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.1363 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.2709 | Val  Acc: 0.9559
 Site-photo                         | Val  Loss: 1.1052 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 1.1112 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.3879 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 1.4330 | Val  Acc: 0.8413
 Site-art_painting                  | Val  Loss: 1.4811 | Val  Acc: 0.7676
 Site-cartoon                       | Val  Loss: 1.6510 | Val  Acc: 0.6522
 Site-cartoon                       | Val  Loss: 1.6093 | Val  Acc: 0.6174
 Site-sketch                        | Val  Loss: 1.7882 | Val  Acc: 0.3500
Average Valid Accuracy: 0.8156
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 1.0385 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.9190 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0347 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 1.0463 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 1.0604 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 1.4727 | Train Acc: 0.7381
 Site-art_painting                  | Train Loss: 1.4156 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.4342 | Train Acc: 0.7793
 Site-cartoon                       | Train Loss: 1.5546 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.5682 | Train Acc: 0.7093
 Site-sketch                        | Train Loss: 1.7891 | Train Acc: 0.3058
Average Train Accuracy: 0.8065
 Site-photo                         | Val  Loss: 1.0446 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0579 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 1.2211 | Val  Acc: 0.9559
 Site-photo                         | Val  Loss: 1.0417 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 1.0443 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.3951 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.4212 | Val  Acc: 0.8095
 Site-art_painting                  | Val  Loss: 1.4446 | Val  Acc: 0.7958
 Site-cartoon                       | Val  Loss: 1.6048 | Val  Acc: 0.6087
 Site-cartoon                       | Val  Loss: 1.5790 | Val  Acc: 0.6609
 Site-sketch                        | Val  Loss: 1.7813 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8206
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.9531 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.9762 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9603 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.9742 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.9877 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.4471 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 1.3992 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.4030 | Train Acc: 0.7934
 Site-cartoon                       | Train Loss: 1.5088 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 1.5350 | Train Acc: 0.6977
 Site-sketch                        | Train Loss: 1.7779 | Train Acc: 0.3884
Average Train Accuracy: 0.8280
 Site-photo                         | Val  Loss: 0.9744 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9970 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.0804 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.9663 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.9688 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.2835 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 1.3189 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.4168 | Val  Acc: 0.7817
 Site-cartoon                       | Val  Loss: 1.5861 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.5583 | Val  Acc: 0.6696
 Site-sketch                        | Val  Loss: 1.7621 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8492
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9778
 Best site-photo                     | Epoch:10 | Val Acc: 0.9853
 Best site-photo                     | Epoch:10 | Val Acc: 0.9804
 Best site-photo                     | Epoch:10 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8730
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7817
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.6696
 Best site-sketch                    | Epoch:10 | Val Acc: 0.4125
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.9332 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.8871 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9100 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.9136 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.9323 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.3984 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 1.4116 | Train Acc: 0.7263
 Site-art_painting                  | Train Loss: 1.3680 | Train Acc: 0.7512
 Site-cartoon                       | Train Loss: 1.4853 | Train Acc: 0.6471
 Site-cartoon                       | Train Loss: 1.5079 | Train Acc: 0.7326
 Site-sketch                        | Train Loss: 1.7816 | Train Acc: 0.3471
Average Train Accuracy: 0.8123
 Site-photo                         | Val  Loss: 0.9358 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.9326 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.1274 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.8983 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9108 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.2362 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 1.2943 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.3707 | Val  Acc: 0.7394
 Site-cartoon                       | Val  Loss: 1.5496 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.5360 | Val  Acc: 0.6609
 Site-sketch                        | Val  Loss: 1.7659 | Val  Acc: 0.2875
Average Valid Accuracy: 0.8220
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.8198 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.8061 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8442 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.8398 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.8586 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.3129 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.3425 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.3089 | Train Acc: 0.8310
 Site-cartoon                       | Train Loss: 1.4702 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.4720 | Train Acc: 0.7326
 Site-sketch                        | Train Loss: 1.7482 | Train Acc: 0.3967
Average Train Accuracy: 0.8415
 Site-photo                         | Val  Loss: 0.8346 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.8742 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.0390 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.8370 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.8453 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.2060 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 1.2027 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 1.3416 | Val  Acc: 0.8169
 Site-cartoon                       | Val  Loss: 1.4942 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.5058 | Val  Acc: 0.6870
 Site-sketch                        | Val  Loss: 1.7365 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8447
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.8197 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.7948 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7830 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.7797 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8244 | Train Acc: 0.9738
 Site-art_painting                  | Train Loss: 1.2942 | Train Acc: 0.7381
 Site-art_painting                  | Train Loss: 1.3153 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 1.3275 | Train Acc: 0.8122
 Site-cartoon                       | Train Loss: 1.4236 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.4384 | Train Acc: 0.7500
 Site-sketch                        | Train Loss: 1.7336 | Train Acc: 0.3554
Average Train Accuracy: 0.8265
 Site-photo                         | Val  Loss: 0.8196 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.8486 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 0.9983 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.7913 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.7794 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.1941 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 1.2032 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.3154 | Val  Acc: 0.7958
 Site-cartoon                       | Val  Loss: 1.4874 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.4766 | Val  Acc: 0.6957
 Site-sketch                        | Val  Loss: 1.7321 | Val  Acc: 0.3625
Average Valid Accuracy: 0.8349
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.7201 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.7146 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7372 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.7260 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.7626 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.3143 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 1.3000 | Train Acc: 0.7579
 Site-art_painting                  | Train Loss: 1.2697 | Train Acc: 0.8404
 Site-cartoon                       | Train Loss: 1.4095 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.4192 | Train Acc: 0.7442
 Site-sketch                        | Train Loss: 1.7210 | Train Acc: 0.3719
Average Train Accuracy: 0.8363
 Site-photo                         | Val  Loss: 0.7370 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.7756 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 0.9444 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.7207 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7221 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.1186 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 1.1948 | Val  Acc: 0.8413
 Site-art_painting                  | Val  Loss: 1.2698 | Val  Acc: 0.8169
 Site-cartoon                       | Val  Loss: 1.4727 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.4338 | Val  Acc: 0.7130
 Site-sketch                        | Val  Loss: 1.6993 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8419
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.6784 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.7005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6498 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6644 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.6947 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 1.2210 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 1.2206 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 1.1882 | Train Acc: 0.7934
 Site-cartoon                       | Train Loss: 1.3552 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.4120 | Train Acc: 0.7558
 Site-sketch                        | Train Loss: 1.6930 | Train Acc: 0.4628
Average Train Accuracy: 0.8399
 Site-photo                         | Val  Loss: 0.7350 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.6962 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8526 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6795 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6696 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.0818 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 1.1750 | Val  Acc: 0.8254
 Site-art_painting                  | Val  Loss: 1.2629 | Val  Acc: 0.7958
 Site-cartoon                       | Val  Loss: 1.4219 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.3936 | Val  Acc: 0.7391
 Site-sketch                        | Val  Loss: 1.6775 | Val  Acc: 0.3750
Average Valid Accuracy: 0.8591
 Best site-photo                     | Epoch:15 | Val Acc: 0.9667
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8254
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7958
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.7391
 Best site-sketch                    | Epoch:15 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.6457 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.5764 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6408 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.6333 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.6481 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 1.1799 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 1.1819 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.1927 | Train Acc: 0.8263
 Site-cartoon                       | Train Loss: 1.3765 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.3805 | Train Acc: 0.7500
 Site-sketch                        | Train Loss: 1.6757 | Train Acc: 0.4793
Average Train Accuracy: 0.8487
 Site-photo                         | Val  Loss: 0.6921 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 0.6751 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.8593 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.6354 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.6172 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.0610 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 1.1115 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.1831 | Val  Acc: 0.8310
 Site-cartoon                       | Val  Loss: 1.4110 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.4062 | Val  Acc: 0.6696
 Site-sketch                        | Val  Loss: 1.6587 | Val  Acc: 0.3875
Average Valid Accuracy: 0.8401
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.5925 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.4504 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5540 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6135 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.5996 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 1.1948 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 1.1832 | Train Acc: 0.7579
 Site-art_painting                  | Train Loss: 1.1577 | Train Acc: 0.7934
 Site-cartoon                       | Train Loss: 1.2849 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.3261 | Train Acc: 0.7384
 Site-sketch                        | Train Loss: 1.6867 | Train Acc: 0.4050
Average Train Accuracy: 0.8361
 Site-photo                         | Val  Loss: 0.6136 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.6468 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.7962 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.5834 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.5766 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.0077 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 1.0743 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.1734 | Val  Acc: 0.8451
 Site-cartoon                       | Val  Loss: 1.3269 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.3513 | Val  Acc: 0.7130
 Site-sketch                        | Val  Loss: 1.6624 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8603
 Best site-photo                     | Epoch:17 | Val Acc: 0.9667
 Best site-photo                     | Epoch:17 | Val Acc: 0.9778
 Best site-photo                     | Epoch:17 | Val Acc: 0.9853
 Best site-photo                     | Epoch:17 | Val Acc: 0.9902
 Best site-photo                     | Epoch:17 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8929
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8730
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8451
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.7130
 Best site-sketch                    | Epoch:17 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.5289 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.4614 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5399 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.5507 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.5655 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.1123 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 1.0819 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 1.1024 | Train Acc: 0.8263
 Site-cartoon                       | Train Loss: 1.3262 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.3241 | Train Acc: 0.7326
 Site-sketch                        | Train Loss: 1.6657 | Train Acc: 0.4298
Average Train Accuracy: 0.8468
 Site-photo                         | Val  Loss: 0.5897 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.5776 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8160 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.5408 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.5324 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.9628 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 1.0289 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.1523 | Val  Acc: 0.8239
 Site-cartoon                       | Val  Loss: 1.3843 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.3377 | Val  Acc: 0.7130
 Site-sketch                        | Val  Loss: 1.6274 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8623
 Best site-photo                     | Epoch:18 | Val Acc: 0.9667
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 0.9853
 Best site-photo                     | Epoch:18 | Val Acc: 0.9804
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8730
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8239
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.7130
 Best site-sketch                    | Epoch:18 | Val Acc: 0.4750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.5080 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.4206 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5209 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.5185 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.5125 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 1.1113 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 1.0959 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 1.0483 | Train Acc: 0.8169
 Site-cartoon                       | Train Loss: 1.2411 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.2673 | Train Acc: 0.7791
 Site-sketch                        | Train Loss: 1.6689 | Train Acc: 0.4298
Average Train Accuracy: 0.8460
 Site-photo                         | Val  Loss: 0.5099 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.5581 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.6925 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.5016 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.5253 | Val  Acc: 0.9737
 Site-art_painting                  | Val  Loss: 0.9305 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.9912 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.1321 | Val  Acc: 0.8380
 Site-cartoon                       | Val  Loss: 1.3370 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.3193 | Val  Acc: 0.7130
 Site-sketch                        | Val  Loss: 1.5887 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8607
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.4852 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.3669 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.4586 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.4823 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.4802 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 1.0757 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 1.1026 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 1.0420 | Train Acc: 0.8216
 Site-cartoon                       | Train Loss: 1.2651 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.2889 | Train Acc: 0.7558
 Site-sketch                        | Train Loss: 1.6437 | Train Acc: 0.4380
Average Train Accuracy: 0.8474
 Site-photo                         | Val  Loss: 0.5137 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.4618 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7359 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.4719 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.4666 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.9124 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.9547 | Val  Acc: 0.8889
 Site-art_painting                  | Val  Loss: 1.0789 | Val  Acc: 0.8028
 Site-cartoon                       | Val  Loss: 1.2956 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.2813 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.6215 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8605
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.4414 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2878 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.4425 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.4352 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.4330 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 1.0910 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 1.0689 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.9733 | Train Acc: 0.8498
 Site-cartoon                       | Train Loss: 1.2204 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.2452 | Train Acc: 0.8081
 Site-sketch                        | Train Loss: 1.6331 | Train Acc: 0.4793
Average Train Accuracy: 0.8615
 Site-photo                         | Val  Loss: 0.4671 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4637 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.6198 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4513 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.4319 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.8212 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.9644 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 1.0571 | Val  Acc: 0.8310
 Site-cartoon                       | Val  Loss: 1.2996 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.2633 | Val  Acc: 0.7391
 Site-sketch                        | Val  Loss: 1.6032 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8738
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 0.9778
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 0.9706
 Best site-photo                     | Epoch:21 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8310
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.7391
 Best site-sketch                    | Epoch:21 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.4231 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.3008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3886 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.4077 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.4252 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 1.0137 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 1.0970 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 0.9708 | Train Acc: 0.8357
 Site-cartoon                       | Train Loss: 1.1940 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 1.2450 | Train Acc: 0.7907
 Site-sketch                        | Train Loss: 1.6244 | Train Acc: 0.4298
Average Train Accuracy: 0.8597
 Site-photo                         | Val  Loss: 0.4353 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4422 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.5061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4025 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.4088 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.9117 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.9538 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.0477 | Val  Acc: 0.8169
 Site-cartoon                       | Val  Loss: 1.2431 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.2494 | Val  Acc: 0.7391
 Site-sketch                        | Val  Loss: 1.5767 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8598
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.3889 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.3608 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.3533 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.3734 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.3923 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 0.9802 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.9869 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 0.9889 | Train Acc: 0.8545
 Site-cartoon                       | Train Loss: 1.1825 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.2137 | Train Acc: 0.7384
 Site-sketch                        | Train Loss: 1.5753 | Train Acc: 0.4876
Average Train Accuracy: 0.8582
 Site-photo                         | Val  Loss: 0.3971 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.4505 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 0.5877 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3690 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3756 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.8082 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.9229 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 0.9786 | Val  Acc: 0.8662
 Site-cartoon                       | Val  Loss: 1.2236 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.2329 | Val  Acc: 0.7391
 Site-sketch                        | Val  Loss: 1.5426 | Val  Acc: 0.4875
Average Valid Accuracy: 0.8725
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.3698 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.3105 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.3456 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.3185 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3593 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 1.0020 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.9875 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.8909 | Train Acc: 0.8451
 Site-cartoon                       | Train Loss: 1.1702 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.1872 | Train Acc: 0.7791
 Site-sketch                        | Train Loss: 1.5899 | Train Acc: 0.4628
Average Train Accuracy: 0.8491
 Site-photo                         | Val  Loss: 0.3637 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3692 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.4407 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.3435 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.3645 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.7781 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.8851 | Val  Acc: 0.8889
 Site-art_painting                  | Val  Loss: 0.9641 | Val  Acc: 0.8662
 Site-cartoon                       | Val  Loss: 1.1869 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.2004 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.5303 | Val  Acc: 0.4625
Average Valid Accuracy: 0.8709
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.3348 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2582 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.3031 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3174 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.3306 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.9039 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.9649 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.9279 | Train Acc: 0.8404
 Site-cartoon                       | Train Loss: 1.2000 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.1415 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.5680 | Train Acc: 0.4628
Average Train Accuracy: 0.8627
 Site-photo                         | Val  Loss: 0.4028 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.3242 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4749 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.3311 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3402 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.8163 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.8451 | Val  Acc: 0.8889
 Site-art_painting                  | Val  Loss: 0.9612 | Val  Acc: 0.8451
 Site-cartoon                       | Val  Loss: 1.1847 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.1730 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.5561 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8738
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.3199 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.3151 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.2940 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2931 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3216 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.9404 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.9184 | Train Acc: 0.7789
 Site-art_painting                  | Train Loss: 0.8654 | Train Acc: 0.8638
 Site-cartoon                       | Train Loss: 1.1096 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.1677 | Train Acc: 0.7326
 Site-sketch                        | Train Loss: 1.5500 | Train Acc: 0.4793
Average Train Accuracy: 0.8595
 Site-photo                         | Val  Loss: 0.2992 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3474 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5209 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.3050 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.2853 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.7383 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.8671 | Val  Acc: 0.8413
 Site-art_painting                  | Val  Loss: 0.9140 | Val  Acc: 0.8521
 Site-cartoon                       | Val  Loss: 1.1333 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.1866 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.5061 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8710
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.2943 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1872 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2915 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.2840 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2935 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.9531 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.9110 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8202 | Train Acc: 0.8545
 Site-cartoon                       | Train Loss: 1.0978 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.1309 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.5444 | Train Acc: 0.4463
Average Train Accuracy: 0.8589
 Site-photo                         | Val  Loss: 0.2863 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3026 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3586 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.2730 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.2913 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.7833 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.8231 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.9161 | Val  Acc: 0.8662
 Site-cartoon                       | Val  Loss: 1.1700 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.1536 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.4831 | Val  Acc: 0.4875
Average Valid Accuracy: 0.8837
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 0.9853
 Best site-photo                     | Epoch:27 | Val Acc: 0.9902
 Best site-photo                     | Epoch:27 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:27 | Val Acc: 0.8929
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:27 | Val Acc: 0.8662
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.7739
 Best site-sketch                    | Epoch:27 | Val Acc: 0.4875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.2812 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2083 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.2448 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2547 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2677 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.8801 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.9314 | Train Acc: 0.8211
 Site-art_painting                  | Train Loss: 0.8644 | Train Acc: 0.8498
 Site-cartoon                       | Train Loss: 1.1369 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.0979 | Train Acc: 0.7500
 Site-sketch                        | Train Loss: 1.5464 | Train Acc: 0.4298
Average Train Accuracy: 0.8573
 Site-photo                         | Val  Loss: 0.3052 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2901 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3102 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2881 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.2575 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.6352 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.7904 | Val  Acc: 0.8889
 Site-art_painting                  | Val  Loss: 0.9195 | Val  Acc: 0.8380
 Site-cartoon                       | Val  Loss: 1.1497 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.1379 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.5208 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8830
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.2845 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.1856 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2446 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.2382 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2687 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.8960 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.8459 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8077 | Train Acc: 0.8779
 Site-cartoon                       | Train Loss: 1.1345 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.0832 | Train Acc: 0.8023
 Site-sketch                        | Train Loss: 1.4914 | Train Acc: 0.4793
Average Train Accuracy: 0.8648
 Site-photo                         | Val  Loss: 0.2738 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.2546 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4811 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.2481 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.2541 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.6520 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.7699 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 0.8593 | Val  Acc: 0.8521
 Site-cartoon                       | Val  Loss: 1.0900 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.0949 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.5005 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8714
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.2598 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1811 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2289 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.2301 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2377 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.8639 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8138 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.7858 | Train Acc: 0.8732
 Site-cartoon                       | Train Loss: 1.1466 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.0862 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.4716 | Train Acc: 0.4876
Average Train Accuracy: 0.8553
 Site-photo                         | Val  Loss: 0.2146 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2572 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.2802 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2269 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.2460 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.6806 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.6960 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.8124 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.1626 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.0895 | Val  Acc: 0.8087
 Site-sketch                        | Val  Loss: 1.4679 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8836
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.2478 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1942 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.2009 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.2231 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.2214 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 0.8208 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.7712 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.7778 | Train Acc: 0.8498
 Site-cartoon                       | Train Loss: 1.0387 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.0467 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.5068 | Train Acc: 0.4876
Average Train Accuracy: 0.8649
 Site-photo                         | Val  Loss: 0.2453 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2343 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4525 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.2427 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.2191 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.6408 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.7106 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.8164 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.0722 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 1.0622 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.4595 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8819
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.2363 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1703 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1814 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1989 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2033 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.8194 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.8604 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 0.7673 | Train Acc: 0.8638
 Site-cartoon                       | Train Loss: 1.1048 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.0464 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.4866 | Train Acc: 0.5041
Average Train Accuracy: 0.8648
 Site-photo                         | Val  Loss: 0.2045 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2448 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.3447 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2168 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.1914 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7143 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.7041 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 0.8248 | Val  Acc: 0.8099
 Site-cartoon                       | Val  Loss: 1.0932 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.0554 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.4437 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8633
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.1991 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1049 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1550 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1822 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1933 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.7919 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.8451 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.7494 | Train Acc: 0.8826
 Site-cartoon                       | Train Loss: 1.1125 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.0439 | Train Acc: 0.7674
 Site-sketch                        | Train Loss: 1.4659 | Train Acc: 0.4876
Average Train Accuracy: 0.8620
 Site-photo                         | Val  Loss: 0.1827 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2375 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2132 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2090 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1824 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.6225 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.7028 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.7553 | Val  Acc: 0.8873
 Site-cartoon                       | Val  Loss: 1.1234 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.0714 | Val  Acc: 0.7304
 Site-sketch                        | Val  Loss: 1.3938 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8892
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8873
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.7304
 Best site-sketch                    | Epoch:33 | Val Acc: 0.4750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.2172 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.1708 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1577 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1753 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.1937 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.7732 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8709 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.6741 | Train Acc: 0.8920
 Site-cartoon                       | Train Loss: 1.0749 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.0244 | Train Acc: 0.7849
 Site-sketch                        | Train Loss: 1.4755 | Train Acc: 0.4793
Average Train Accuracy: 0.8562
 Site-photo                         | Val  Loss: 0.2183 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.2052 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2694 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1721 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1762 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5210 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.6530 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.7592 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.0704 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.0437 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.4838 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8745
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.1836 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1743 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1403 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1713 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1768 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.7684 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.7407 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.6929 | Train Acc: 0.8638
 Site-cartoon                       | Train Loss: 1.1067 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.0180 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.4179 | Train Acc: 0.5537
Average Train Accuracy: 0.8744
 Site-photo                         | Val  Loss: 0.1834 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1927 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2072 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1653 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1572 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.6195 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.7112 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 0.7238 | Val  Acc: 0.8803
 Site-cartoon                       | Val  Loss: 1.0165 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 1.0469 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.3796 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8909
 Best site-photo                     | Epoch:35 | Val Acc: 1.0000
 Best site-photo                     | Epoch:35 | Val Acc: 1.0000
 Best site-photo                     | Epoch:35 | Val Acc: 1.0000
 Best site-photo                     | Epoch:35 | Val Acc: 0.9902
 Best site-photo                     | Epoch:35 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8571
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8803
 Best site-cartoon                   | Epoch:35 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:35 | Val Acc: 0.7739
 Best site-sketch                    | Epoch:35 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.1955 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1483 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1405 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1405 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1573 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.7720 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.8547 | Train Acc: 0.8211
 Site-art_painting                  | Train Loss: 0.6943 | Train Acc: 0.8967
 Site-cartoon                       | Train Loss: 1.0561 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 0.9734 | Train Acc: 0.7907
 Site-sketch                        | Train Loss: 1.4376 | Train Acc: 0.5207
Average Train Accuracy: 0.8698
 Site-photo                         | Val  Loss: 0.2098 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.1745 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2259 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1491 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1777 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.5863 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.5877 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.7288 | Val  Acc: 0.8732
 Site-cartoon                       | Val  Loss: 0.9662 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.0409 | Val  Acc: 0.7565
 Site-sketch                        | Val  Loss: 1.4012 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8814
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.1837 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2178 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1271 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1162 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1559 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 0.7002 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.8100 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.6833 | Train Acc: 0.8685
 Site-cartoon                       | Train Loss: 0.9975 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.0004 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.4398 | Train Acc: 0.5041
Average Train Accuracy: 0.8661
 Site-photo                         | Val  Loss: 0.1581 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1804 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2260 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1501 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1390 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5662 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.5841 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.7371 | Val  Acc: 0.8803
 Site-cartoon                       | Val  Loss: 0.9959 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.9925 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.4168 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8911
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 0.9902
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8803
 Best site-cartoon                   | Epoch:37 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:37 | Val Acc: 0.7826
 Best site-sketch                    | Epoch:37 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.1632 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0965 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1259 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1443 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1369 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.7364 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.7778 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.6787 | Train Acc: 0.8732
 Site-cartoon                       | Train Loss: 1.0297 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.9725 | Train Acc: 0.7791
 Site-sketch                        | Train Loss: 1.4198 | Train Acc: 0.5455
Average Train Accuracy: 0.8760
 Site-photo                         | Val  Loss: 0.1326 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1433 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3304 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.1489 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1507 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5932 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.6221 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.7612 | Val  Acc: 0.8521
 Site-cartoon                       | Val  Loss: 0.9589 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 1.0033 | Val  Acc: 0.7913
 Site-sketch                        | Val  Loss: 1.3643 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8971
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 0.9853
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8521
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.7913
 Best site-sketch                    | Epoch:38 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.1552 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0870 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1145 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1254 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1426 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.6477 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.7400 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 0.6593 | Train Acc: 0.8873
 Site-cartoon                       | Train Loss: 0.9732 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.9458 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.4162 | Train Acc: 0.4959
Average Train Accuracy: 0.8771
 Site-photo                         | Val  Loss: 0.1124 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1484 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2452 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1268 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1219 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5177 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.5911 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.6997 | Val  Acc: 0.9014
 Site-cartoon                       | Val  Loss: 1.0203 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.9460 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.4023 | Val  Acc: 0.5125
Average Valid Accuracy: 0.9001
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:39 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:39 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:39 | Val Acc: 0.9014
 Best site-cartoon                   | Epoch:39 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:39 | Val Acc: 0.7826
 Best site-sketch                    | Epoch:39 | Val Acc: 0.5125
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.1481 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2368 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1329 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1150 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1489 | Train Acc: 0.9782
 Site-art_painting                  | Train Loss: 0.6796 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.7670 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.6302 | Train Acc: 0.8920
 Site-cartoon                       | Train Loss: 0.9736 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.9622 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.3963 | Train Acc: 0.5041
Average Train Accuracy: 0.8771
 Site-photo                         | Val  Loss: 0.1120 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1142 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2370 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1201 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1192 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5936 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.6287 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.7047 | Val  Acc: 0.8521
 Site-cartoon                       | Val  Loss: 0.9380 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.9851 | Val  Acc: 0.7565
 Site-sketch                        | Val  Loss: 1.3525 | Val  Acc: 0.4625
Average Valid Accuracy: 0.8871
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.1438 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0813 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0873 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0958 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1224 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.7280 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.7643 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.6461 | Train Acc: 0.8920
 Site-cartoon                       | Train Loss: 0.9824 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.9655 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.4260 | Train Acc: 0.4545
Average Train Accuracy: 0.8700
 Site-photo                         | Val  Loss: 0.1068 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1401 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2646 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1344 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1095 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.5266 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5675 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.6991 | Val  Acc: 0.8803
 Site-cartoon                       | Val  Loss: 0.9562 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.9719 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.3657 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8940
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.1347 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0701 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0840 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1120 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.1095 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6559 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.7360 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.6278 | Train Acc: 0.8685
 Site-cartoon                       | Train Loss: 0.9344 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 0.9394 | Train Acc: 0.8198
 Site-sketch                        | Train Loss: 1.4212 | Train Acc: 0.5124
Average Train Accuracy: 0.8668
 Site-photo                         | Val  Loss: 0.1094 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1154 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1225 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0925 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0970 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.4676 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5758 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.6568 | Val  Acc: 0.8873
 Site-cartoon                       | Val  Loss: 0.9703 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.9871 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.3089 | Val  Acc: 0.5125
Average Valid Accuracy: 0.8978
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.1295 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0767 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0951 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1068 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1074 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6910 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.7813 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5915 | Train Acc: 0.9014
 Site-cartoon                       | Train Loss: 0.9379 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.8951 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.3903 | Train Acc: 0.5455
Average Train Accuracy: 0.8822
 Site-photo                         | Val  Loss: 0.0925 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1165 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1605 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0863 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1069 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5005 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5662 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.6301 | Val  Acc: 0.9014
 Site-cartoon                       | Val  Loss: 0.9760 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.9257 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.3390 | Val  Acc: 0.5500
Average Valid Accuracy: 0.8939
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.1729 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0671 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.1052 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0927 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1221 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.6277 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.6696 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.6066 | Train Acc: 0.8920
 Site-cartoon                       | Train Loss: 0.9353 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.9004 | Train Acc: 0.8430
 Site-sketch                        | Train Loss: 1.3972 | Train Acc: 0.5207
Average Train Accuracy: 0.8722
 Site-photo                         | Val  Loss: 0.1185 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1307 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1058 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0943 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0956 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4860 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5860 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 0.6117 | Val  Acc: 0.9014
 Site-cartoon                       | Val  Loss: 0.9958 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.9420 | Val  Acc: 0.8087
 Site-sketch                        | Val  Loss: 1.3197 | Val  Acc: 0.5500
Average Valid Accuracy: 0.8934
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.1281 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2607 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0864 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0913 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1051 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6061 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.6659 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.5789 | Train Acc: 0.8826
 Site-cartoon                       | Train Loss: 0.9883 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.8698 | Train Acc: 0.8488
 Site-sketch                        | Train Loss: 1.3625 | Train Acc: 0.5372
Average Train Accuracy: 0.8868
 Site-photo                         | Val  Loss: 0.1031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0885 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1047 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0992 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0923 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.4383 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.5327 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.6102 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.9343 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.8909 | Val  Acc: 0.8348
 Site-sketch                        | Val  Loss: 1.3645 | Val  Acc: 0.4375
Average Valid Accuracy: 0.9026
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9155
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.8348
 Best site-sketch                    | Epoch:45 | Val Acc: 0.4375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.1241 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0932 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0800 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0751 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0968 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.6404 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.6299 | Train Acc: 0.8526
 Site-art_painting                  | Train Loss: 0.5841 | Train Acc: 0.8826
 Site-cartoon                       | Train Loss: 0.9600 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.8699 | Train Acc: 0.8023
 Site-sketch                        | Train Loss: 1.3507 | Train Acc: 0.5620
Average Train Accuracy: 0.8777
 Site-photo                         | Val  Loss: 0.1529 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.1101 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2460 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0880 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0785 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5875 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5468 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.6342 | Val  Acc: 0.8873
 Site-cartoon                       | Val  Loss: 0.9667 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 0.8863 | Val  Acc: 0.8348
 Site-sketch                        | Val  Loss: 1.3608 | Val  Acc: 0.4625
Average Valid Accuracy: 0.8845
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.1362 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0698 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0979 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0778 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0880 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.6580 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.6692 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.5753 | Train Acc: 0.9014
 Site-cartoon                       | Train Loss: 0.9406 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.8669 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.3586 | Train Acc: 0.5289
Average Train Accuracy: 0.8856
 Site-photo                         | Val  Loss: 0.1513 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.1042 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1481 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1028 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0795 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4054 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.5489 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.6310 | Val  Acc: 0.8873
 Site-cartoon                       | Val  Loss: 0.8369 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.8997 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.3676 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8915
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0974 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0592 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0824 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0897 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0884 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5955 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.6880 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.5647 | Train Acc: 0.9108
 Site-cartoon                       | Train Loss: 1.0011 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.8751 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.3988 | Train Acc: 0.4711
Average Train Accuracy: 0.8703
 Site-photo                         | Val  Loss: 0.1274 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0856 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2988 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.0954 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0721 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4602 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5297 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.6383 | Val  Acc: 0.8944
 Site-cartoon                       | Val  Loss: 0.8666 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.8569 | Val  Acc: 0.7913
 Site-sketch                        | Val  Loss: 1.2719 | Val  Acc: 0.5125
Average Valid Accuracy: 0.8920
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.1047 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0484 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0726 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0696 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0858 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.6522 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6917 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.5971 | Train Acc: 0.8920
 Site-cartoon                       | Train Loss: 0.9553 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.8657 | Train Acc: 0.8198
 Site-sketch                        | Train Loss: 1.3509 | Train Acc: 0.5289
Average Train Accuracy: 0.8765
 Site-photo                         | Val  Loss: 0.1125 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0959 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1037 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0733 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0647 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4001 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.4936 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.5890 | Val  Acc: 0.8803
 Site-cartoon                       | Val  Loss: 0.8571 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.8610 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.3002 | Val  Acc: 0.5000
Average Valid Accuracy: 0.9033
 Best site-photo                     | Epoch:49 | Val Acc: 1.0000
 Best site-photo                     | Epoch:49 | Val Acc: 1.0000
 Best site-photo                     | Epoch:49 | Val Acc: 1.0000
 Best site-photo                     | Epoch:49 | Val Acc: 1.0000
 Best site-photo                     | Epoch:49 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:49 | Val Acc: 0.8803
 Best site-cartoon                   | Epoch:49 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:49 | Val Acc: 0.8174
 Best site-sketch                    | Epoch:49 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedmix...
===2023-08-11 05:32:46===
===2023-08-11 05:33:01===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:49 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:49 | Test Acc: 0.8855
 Test site-cartoon                   | Epoch:49 | Test Acc: 0.7489
 Test site-sketch                    | Epoch:49 | Test Acc: 0.5172
photo: 0.9985, art_painting: 0.8855, cartoon: 0.7489, sketch: 0.5172, 
Average Test Accuracy(group): 0.7875, Average Test Accuracy(individual): 0.8786,
domain std=0.1794, cluster std=-1.0000, individual std=0.1466, 
