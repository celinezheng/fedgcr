===2023-08-11 01:21:51===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.8570 | Train Acc: 0.4889
 Site-photo                         | Train Loss: 1.8154 | Train Acc: 0.5294
 Site-photo                         | Train Loss: 1.8528 | Train Acc: 0.4314
 Site-photo                         | Train Loss: 1.8549 | Train Acc: 0.5229
 Site-photo                         | Train Loss: 1.8472 | Train Acc: 0.5066
 Site-art_painting                  | Train Loss: 1.9055 | Train Acc: 0.2619
 Site-art_painting                  | Train Loss: 1.8801 | Train Acc: 0.3158
 Site-art_painting                  | Train Loss: 1.8750 | Train Acc: 0.3333
 Site-cartoon                       | Train Loss: 1.9205 | Train Acc: 0.1471
 Site-cartoon                       | Train Loss: 1.9090 | Train Acc: 0.2500
 Site-sketch                        | Train Loss: 1.9511 | Train Acc: 0.1157
Average Train Accuracy: 0.3548
 Site-photo                         | Val  Loss: 1.8495 | Val  Acc: 0.4667
 Site-photo                         | Val  Loss: 1.8707 | Val  Acc: 0.4444
 Site-photo                         | Val  Loss: 1.8676 | Val  Acc: 0.4265
 Site-photo                         | Val  Loss: 1.8486 | Val  Acc: 0.4804
 Site-photo                         | Val  Loss: 1.8493 | Val  Acc: 0.4803
 Site-art_painting                  | Val  Loss: 1.8403 | Val  Acc: 0.4643
 Site-art_painting                  | Val  Loss: 1.8477 | Val  Acc: 0.4444
 Site-art_painting                  | Val  Loss: 1.8729 | Val  Acc: 0.3873
 Site-cartoon                       | Val  Loss: 1.8895 | Val  Acc: 0.2174
 Site-cartoon                       | Val  Loss: 1.8986 | Val  Acc: 0.2522
 Site-sketch                        | Val  Loss: 1.9396 | Val  Acc: 0.1000
Average Valid Accuracy: 0.3785
 Best site-photo                     | Epoch:0 | Val Acc: 0.4667
 Best site-photo                     | Epoch:0 | Val Acc: 0.4444
 Best site-photo                     | Epoch:0 | Val Acc: 0.4265
 Best site-photo                     | Epoch:0 | Val Acc: 0.4804
 Best site-photo                     | Epoch:0 | Val Acc: 0.4803
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4643
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4444
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3873
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.2174
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.2522
 Best site-sketch                    | Epoch:0 | Val Acc: 0.1000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 1.7515 | Train Acc: 0.8444
 Site-photo                         | Train Loss: 1.7236 | Train Acc: 0.8088
 Site-photo                         | Train Loss: 1.7534 | Train Acc: 0.8039
 Site-photo                         | Train Loss: 1.7547 | Train Acc: 0.8105
 Site-photo                         | Train Loss: 1.7507 | Train Acc: 0.8297
 Site-art_painting                  | Train Loss: 1.8169 | Train Acc: 0.4048
 Site-art_painting                  | Train Loss: 1.8364 | Train Acc: 0.5263
 Site-art_painting                  | Train Loss: 1.8108 | Train Acc: 0.4836
 Site-cartoon                       | Train Loss: 1.8671 | Train Acc: 0.4118
 Site-cartoon                       | Train Loss: 1.8695 | Train Acc: 0.3314
 Site-sketch                        | Train Loss: 1.9430 | Train Acc: 0.0992
Average Train Accuracy: 0.5777
 Site-photo                         | Val  Loss: 1.7480 | Val  Acc: 0.7333
 Site-photo                         | Val  Loss: 1.7796 | Val  Acc: 0.8000
 Site-photo                         | Val  Loss: 1.7912 | Val  Acc: 0.8088
 Site-photo                         | Val  Loss: 1.7453 | Val  Acc: 0.8431
 Site-photo                         | Val  Loss: 1.7592 | Val  Acc: 0.7961
 Site-art_painting                  | Val  Loss: 1.7824 | Val  Acc: 0.6786
 Site-art_painting                  | Val  Loss: 1.7819 | Val  Acc: 0.5873
 Site-art_painting                  | Val  Loss: 1.8260 | Val  Acc: 0.5070
 Site-cartoon                       | Val  Loss: 1.8473 | Val  Acc: 0.4348
 Site-cartoon                       | Val  Loss: 1.8578 | Val  Acc: 0.3478
 Site-sketch                        | Val  Loss: 1.9201 | Val  Acc: 0.1375
Average Valid Accuracy: 0.6068
 Best site-photo                     | Epoch:1 | Val Acc: 0.7333
 Best site-photo                     | Epoch:1 | Val Acc: 0.8000
 Best site-photo                     | Epoch:1 | Val Acc: 0.8088
 Best site-photo                     | Epoch:1 | Val Acc: 0.8431
 Best site-photo                     | Epoch:1 | Val Acc: 0.7961
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6786
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5873
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5070
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.4348
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.3478
 Best site-sketch                    | Epoch:1 | Val Acc: 0.1375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 1.6519 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 1.6267 | Train Acc: 0.9265
 Site-photo                         | Train Loss: 1.6498 | Train Acc: 0.9510
 Site-photo                         | Train Loss: 1.6503 | Train Acc: 0.9412
 Site-photo                         | Train Loss: 1.6476 | Train Acc: 0.9389
 Site-art_painting                  | Train Loss: 1.7637 | Train Acc: 0.5238
 Site-art_painting                  | Train Loss: 1.7800 | Train Acc: 0.5895
 Site-art_painting                  | Train Loss: 1.7654 | Train Acc: 0.5681
 Site-cartoon                       | Train Loss: 1.8183 | Train Acc: 0.4706
 Site-cartoon                       | Train Loss: 1.8283 | Train Acc: 0.5058
 Site-sketch                        | Train Loss: 1.9207 | Train Acc: 0.1405
Average Train Accuracy: 0.6768
 Site-photo                         | Val  Loss: 1.6472 | Val  Acc: 0.9000
 Site-photo                         | Val  Loss: 1.6833 | Val  Acc: 0.8667
 Site-photo                         | Val  Loss: 1.7064 | Val  Acc: 0.9412
 Site-photo                         | Val  Loss: 1.6449 | Val  Acc: 0.9216
 Site-photo                         | Val  Loss: 1.6481 | Val  Acc: 0.9211
 Site-art_painting                  | Val  Loss: 1.7081 | Val  Acc: 0.6429
 Site-art_painting                  | Val  Loss: 1.7345 | Val  Acc: 0.6508
 Site-art_painting                  | Val  Loss: 1.7745 | Val  Acc: 0.5845
 Site-cartoon                       | Val  Loss: 1.8117 | Val  Acc: 0.4783
 Site-cartoon                       | Val  Loss: 1.8243 | Val  Acc: 0.4435
 Site-sketch                        | Val  Loss: 1.9000 | Val  Acc: 0.1375
Average Valid Accuracy: 0.6807
 Best site-photo                     | Epoch:2 | Val Acc: 0.9000
 Best site-photo                     | Epoch:2 | Val Acc: 0.8667
 Best site-photo                     | Epoch:2 | Val Acc: 0.9412
 Best site-photo                     | Epoch:2 | Val Acc: 0.9216
 Best site-photo                     | Epoch:2 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6429
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6508
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5845
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.4783
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.4435
 Best site-sketch                    | Epoch:2 | Val Acc: 0.1375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 1.5522 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 1.5175 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.5640 | Train Acc: 0.9608
 Site-photo                         | Train Loss: 1.5523 | Train Acc: 0.9739
 Site-photo                         | Train Loss: 1.5654 | Train Acc: 0.9651
 Site-art_painting                  | Train Loss: 1.7356 | Train Acc: 0.6190
 Site-art_painting                  | Train Loss: 1.7182 | Train Acc: 0.6421
 Site-art_painting                  | Train Loss: 1.7152 | Train Acc: 0.6150
 Site-cartoon                       | Train Loss: 1.7865 | Train Acc: 0.5294
 Site-cartoon                       | Train Loss: 1.7889 | Train Acc: 0.5407
 Site-sketch                        | Train Loss: 1.9028 | Train Acc: 0.1818
Average Train Accuracy: 0.7211
 Site-photo                         | Val  Loss: 1.5512 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.5783 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 1.5984 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 1.5573 | Val  Acc: 0.9608
 Site-photo                         | Val  Loss: 1.5574 | Val  Acc: 0.9539
 Site-art_painting                  | Val  Loss: 1.6533 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.6660 | Val  Acc: 0.7460
 Site-art_painting                  | Val  Loss: 1.7345 | Val  Acc: 0.6831
 Site-cartoon                       | Val  Loss: 1.7673 | Val  Acc: 0.6087
 Site-cartoon                       | Val  Loss: 1.7895 | Val  Acc: 0.6000
 Site-sketch                        | Val  Loss: 1.8880 | Val  Acc: 0.1625
Average Valid Accuracy: 0.7581
 Best site-photo                     | Epoch:3 | Val Acc: 0.9333
 Best site-photo                     | Epoch:3 | Val Acc: 0.9556
 Best site-photo                     | Epoch:3 | Val Acc: 0.9853
 Best site-photo                     | Epoch:3 | Val Acc: 0.9608
 Best site-photo                     | Epoch:3 | Val Acc: 0.9539
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7460
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6831
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6087
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6000
 Best site-sketch                    | Epoch:3 | Val Acc: 0.1625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 1.4740 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 1.4508 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.4661 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 1.4614 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 1.4697 | Train Acc: 0.9694
 Site-art_painting                  | Train Loss: 1.6869 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.6769 | Train Acc: 0.6842
 Site-art_painting                  | Train Loss: 1.6714 | Train Acc: 0.6901
 Site-cartoon                       | Train Loss: 1.7496 | Train Acc: 0.5294
 Site-cartoon                       | Train Loss: 1.7424 | Train Acc: 0.6221
 Site-sketch                        | Train Loss: 1.8820 | Train Acc: 0.2562
Average Train Accuracy: 0.7556
 Site-photo                         | Val  Loss: 1.4509 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.4842 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 1.5661 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 1.4598 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 1.4683 | Val  Acc: 0.9803
 Site-art_painting                  | Val  Loss: 1.5706 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.6189 | Val  Acc: 0.6984
 Site-art_painting                  | Val  Loss: 1.6918 | Val  Acc: 0.6549
 Site-cartoon                       | Val  Loss: 1.7335 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.7514 | Val  Acc: 0.5565
 Site-sketch                        | Val  Loss: 1.8750 | Val  Acc: 0.2625
Average Valid Accuracy: 0.7723
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 0.9556
 Best site-photo                     | Epoch:4 | Val Acc: 0.9706
 Best site-photo                     | Epoch:4 | Val Acc: 0.9706
 Best site-photo                     | Epoch:4 | Val Acc: 0.9803
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6984
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6549
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.6957
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.5565
 Best site-sketch                    | Epoch:4 | Val Acc: 0.2625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 1.3744 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 1.3708 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3639 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 1.3769 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 1.3816 | Train Acc: 0.9694
 Site-art_painting                  | Train Loss: 1.6183 | Train Acc: 0.7143
 Site-art_painting                  | Train Loss: 1.6251 | Train Acc: 0.7053
 Site-art_painting                  | Train Loss: 1.6087 | Train Acc: 0.7042
 Site-cartoon                       | Train Loss: 1.7000 | Train Acc: 0.5588
 Site-cartoon                       | Train Loss: 1.7118 | Train Acc: 0.6628
 Site-sketch                        | Train Loss: 1.8706 | Train Acc: 0.3058
Average Train Accuracy: 0.7776
 Site-photo                         | Val  Loss: 1.3809 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.4275 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.5057 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 1.3775 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 1.3811 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.5605 | Val  Acc: 0.7857
 Site-art_painting                  | Val  Loss: 1.5653 | Val  Acc: 0.6825
 Site-art_painting                  | Val  Loss: 1.6288 | Val  Acc: 0.7465
 Site-cartoon                       | Val  Loss: 1.7174 | Val  Acc: 0.6522
 Site-cartoon                       | Val  Loss: 1.7245 | Val  Acc: 0.6000
 Site-sketch                        | Val  Loss: 1.8704 | Val  Acc: 0.2125
Average Valid Accuracy: 0.7719
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 1.2882 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 1.3493 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.2889 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 1.2987 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 1.3121 | Train Acc: 0.9651
 Site-art_painting                  | Train Loss: 1.5701 | Train Acc: 0.6905
 Site-art_painting                  | Train Loss: 1.5785 | Train Acc: 0.7053
 Site-art_painting                  | Train Loss: 1.5668 | Train Acc: 0.7230
 Site-cartoon                       | Train Loss: 1.6410 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.6841 | Train Acc: 0.6919
 Site-sketch                        | Train Loss: 1.8591 | Train Acc: 0.2727
Average Train Accuracy: 0.7874
 Site-photo                         | Val  Loss: 1.3108 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 1.3201 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.4356 | Val  Acc: 0.9559
 Site-photo                         | Val  Loss: 1.2954 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 1.2912 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.4877 | Val  Acc: 0.8214
 Site-art_painting                  | Val  Loss: 1.5302 | Val  Acc: 0.7460
 Site-art_painting                  | Val  Loss: 1.5743 | Val  Acc: 0.7394
 Site-cartoon                       | Val  Loss: 1.6757 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.6954 | Val  Acc: 0.6522
 Site-sketch                        | Val  Loss: 1.8594 | Val  Acc: 0.2500
Average Valid Accuracy: 0.7934
 Best site-photo                     | Epoch:6 | Val Acc: 0.9667
 Best site-photo                     | Epoch:6 | Val Acc: 0.9333
 Best site-photo                     | Epoch:6 | Val Acc: 0.9559
 Best site-photo                     | Epoch:6 | Val Acc: 0.9804
 Best site-photo                     | Epoch:6 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8214
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7460
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7394
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.6957
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.6522
 Best site-sketch                    | Epoch:6 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 1.2271 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 1.1611 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2055 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 1.2134 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 1.2175 | Train Acc: 0.9738
 Site-art_painting                  | Train Loss: 1.5425 | Train Acc: 0.7381
 Site-art_painting                  | Train Loss: 1.5406 | Train Acc: 0.7474
 Site-art_painting                  | Train Loss: 1.5433 | Train Acc: 0.7042
 Site-cartoon                       | Train Loss: 1.6208 | Train Acc: 0.6471
 Site-cartoon                       | Train Loss: 1.6338 | Train Acc: 0.6686
 Site-sketch                        | Train Loss: 1.8512 | Train Acc: 0.2727
Average Train Accuracy: 0.7886
 Site-photo                         | Val  Loss: 1.2152 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 1.2388 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.3117 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 1.2047 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 1.2123 | Val  Acc: 0.9803
 Site-art_painting                  | Val  Loss: 1.4307 | Val  Acc: 0.8214
 Site-art_painting                  | Val  Loss: 1.4854 | Val  Acc: 0.7937
 Site-art_painting                  | Val  Loss: 1.5484 | Val  Acc: 0.7183
 Site-cartoon                       | Val  Loss: 1.6521 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.6450 | Val  Acc: 0.6696
 Site-sketch                        | Val  Loss: 1.8350 | Val  Acc: 0.2875
Average Valid Accuracy: 0.8118
 Best site-photo                     | Epoch:7 | Val Acc: 0.9667
 Best site-photo                     | Epoch:7 | Val Acc: 0.9778
 Best site-photo                     | Epoch:7 | Val Acc: 0.9853
 Best site-photo                     | Epoch:7 | Val Acc: 0.9902
 Best site-photo                     | Epoch:7 | Val Acc: 0.9803
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8214
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7937
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7183
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.6696
 Best site-sketch                    | Epoch:7 | Val Acc: 0.2875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 1.1419 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 1.1407 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1413 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 1.1390 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 1.1465 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.5079 | Train Acc: 0.7381
 Site-art_painting                  | Train Loss: 1.5025 | Train Acc: 0.7053
 Site-art_painting                  | Train Loss: 1.4883 | Train Acc: 0.7559
 Site-cartoon                       | Train Loss: 1.6061 | Train Acc: 0.6471
 Site-cartoon                       | Train Loss: 1.6087 | Train Acc: 0.6977
 Site-sketch                        | Train Loss: 1.8317 | Train Acc: 0.3058
Average Train Accuracy: 0.7985
 Site-photo                         | Val  Loss: 1.1308 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 1.1616 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.2157 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1245 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 1.1382 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.3620 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.3931 | Val  Acc: 0.8254
 Site-art_painting                  | Val  Loss: 1.5307 | Val  Acc: 0.7254
 Site-cartoon                       | Val  Loss: 1.6442 | Val  Acc: 0.6087
 Site-cartoon                       | Val  Loss: 1.6300 | Val  Acc: 0.6609
 Site-sketch                        | Val  Loss: 1.8156 | Val  Acc: 0.2750
Average Valid Accuracy: 0.8067
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 1.0809 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.9677 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.0493 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 1.0611 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 1.0710 | Train Acc: 0.9782
 Site-art_painting                  | Train Loss: 1.4310 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 1.4197 | Train Acc: 0.7579
 Site-art_painting                  | Train Loss: 1.4220 | Train Acc: 0.7418
 Site-cartoon                       | Train Loss: 1.5504 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.5826 | Train Acc: 0.6802
 Site-sketch                        | Train Loss: 1.8089 | Train Acc: 0.3471
Average Train Accuracy: 0.8130
 Site-photo                         | Val  Loss: 1.0585 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0954 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.1264 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 1.0533 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0659 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.3280 | Val  Acc: 0.8214
 Site-art_painting                  | Val  Loss: 1.3810 | Val  Acc: 0.7937
 Site-art_painting                  | Val  Loss: 1.4691 | Val  Acc: 0.7606
 Site-cartoon                       | Val  Loss: 1.5668 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.5721 | Val  Acc: 0.7130
 Site-sketch                        | Val  Loss: 1.8094 | Val  Acc: 0.2750
Average Valid Accuracy: 0.8196
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9778
 Best site-photo                     | Epoch:9 | Val Acc: 0.9853
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8214
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7937
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7606
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.6957
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7130
 Best site-sketch                    | Epoch:9 | Val Acc: 0.2750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 1.0008 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.8657 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.9921 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9642 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.9905 | Train Acc: 0.9738
 Site-art_painting                  | Train Loss: 1.3978 | Train Acc: 0.7619
 Site-art_painting                  | Train Loss: 1.3906 | Train Acc: 0.7263
 Site-art_painting                  | Train Loss: 1.3743 | Train Acc: 0.7653
 Site-cartoon                       | Train Loss: 1.5070 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.5468 | Train Acc: 0.6977
 Site-sketch                        | Train Loss: 1.8042 | Train Acc: 0.3223
Average Train Accuracy: 0.8047
 Site-photo                         | Val  Loss: 0.9900 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9985 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.1560 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.9654 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 1.0013 | Val  Acc: 0.9803
 Site-art_painting                  | Val  Loss: 1.2472 | Val  Acc: 0.8214
 Site-art_painting                  | Val  Loss: 1.3116 | Val  Acc: 0.7937
 Site-art_painting                  | Val  Loss: 1.4429 | Val  Acc: 0.8028
 Site-cartoon                       | Val  Loss: 1.5467 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.5482 | Val  Acc: 0.7130
 Site-sketch                        | Val  Loss: 1.7948 | Val  Acc: 0.3500
Average Valid Accuracy: 0.8361
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9778
 Best site-photo                     | Epoch:10 | Val Acc: 0.9853
 Best site-photo                     | Epoch:10 | Val Acc: 0.9902
 Best site-photo                     | Epoch:10 | Val Acc: 0.9803
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8214
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7937
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8028
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7130
 Best site-sketch                    | Epoch:10 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.9170 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.8769 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.9016 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9225 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.9395 | Train Acc: 0.9782
 Site-art_painting                  | Train Loss: 1.3834 | Train Acc: 0.7619
 Site-art_painting                  | Train Loss: 1.3816 | Train Acc: 0.6842
 Site-art_painting                  | Train Loss: 1.3532 | Train Acc: 0.7793
 Site-cartoon                       | Train Loss: 1.5123 | Train Acc: 0.6471
 Site-cartoon                       | Train Loss: 1.5030 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 1.7815 | Train Acc: 0.3636
Average Train Accuracy: 0.8089
 Site-photo                         | Val  Loss: 0.9367 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9474 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 1.1083 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.9036 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9271 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.1916 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 1.2956 | Val  Acc: 0.7937
 Site-art_painting                  | Val  Loss: 1.3813 | Val  Acc: 0.7958
 Site-cartoon                       | Val  Loss: 1.5057 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.5338 | Val  Acc: 0.6957
 Site-sketch                        | Val  Loss: 1.7734 | Val  Acc: 0.2750
Average Valid Accuracy: 0.8329
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.8676 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.8523 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8435 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8348 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.8654 | Train Acc: 0.9738
 Site-art_painting                  | Train Loss: 1.3573 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 1.3467 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.3187 | Train Acc: 0.7887
 Site-cartoon                       | Train Loss: 1.4575 | Train Acc: 0.6176
 Site-cartoon                       | Train Loss: 1.4684 | Train Acc: 0.7209
 Site-sketch                        | Train Loss: 1.7712 | Train Acc: 0.3554
Average Train Accuracy: 0.8116
 Site-photo                         | Val  Loss: 0.8548 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.8747 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.9867 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8496 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8599 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.1912 | Val  Acc: 0.8214
 Site-art_painting                  | Val  Loss: 1.2396 | Val  Acc: 0.8095
 Site-art_painting                  | Val  Loss: 1.3599 | Val  Acc: 0.7676
 Site-cartoon                       | Val  Loss: 1.4846 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.5030 | Val  Acc: 0.6870
 Site-sketch                        | Val  Loss: 1.7606 | Val  Acc: 0.3500
Average Valid Accuracy: 0.8318
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.7894 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.8178 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7838 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7927 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7982 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 1.3267 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 1.3323 | Train Acc: 0.7263
 Site-art_painting                  | Train Loss: 1.2372 | Train Acc: 0.8357
 Site-cartoon                       | Train Loss: 1.4405 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.4420 | Train Acc: 0.7500
 Site-sketch                        | Train Loss: 1.7672 | Train Acc: 0.3554
Average Train Accuracy: 0.8293
 Site-photo                         | Val  Loss: 0.8251 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.8446 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 0.9629 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.8022 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.7980 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.1785 | Val  Acc: 0.8214
 Site-art_painting                  | Val  Loss: 1.2094 | Val  Acc: 0.8095
 Site-art_painting                  | Val  Loss: 1.3032 | Val  Acc: 0.7746
 Site-cartoon                       | Val  Loss: 1.4557 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.4624 | Val  Acc: 0.7217
 Site-sketch                        | Val  Loss: 1.7529 | Val  Acc: 0.3125
Average Valid Accuracy: 0.8265
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.7551 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.7318 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7485 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.7398 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.7434 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 1.2496 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 1.2256 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 1.2204 | Train Acc: 0.8216
 Site-cartoon                       | Train Loss: 1.3882 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.4107 | Train Acc: 0.7791
 Site-sketch                        | Train Loss: 1.7376 | Train Acc: 0.3719
Average Train Accuracy: 0.8419
 Site-photo                         | Val  Loss: 0.7401 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7904 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 0.8214 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.7456 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.7450 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.1450 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.1724 | Val  Acc: 0.8254
 Site-art_painting                  | Val  Loss: 1.2740 | Val  Acc: 0.8169
 Site-cartoon                       | Val  Loss: 1.3979 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.4328 | Val  Acc: 0.7304
 Site-sketch                        | Val  Loss: 1.7121 | Val  Acc: 0.3000
Average Valid Accuracy: 0.8403
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 0.9556
 Best site-photo                     | Epoch:14 | Val Acc: 0.9853
 Best site-photo                     | Epoch:14 | Val Acc: 0.9902
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8571
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8254
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8169
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.7304
 Best site-sketch                    | Epoch:14 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.6915 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.7900 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6679 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.6715 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.7006 | Train Acc: 0.9782
 Site-art_painting                  | Train Loss: 1.2756 | Train Acc: 0.7381
 Site-art_painting                  | Train Loss: 1.2201 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.1681 | Train Acc: 0.8122
 Site-cartoon                       | Train Loss: 1.3816 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.3912 | Train Acc: 0.7558
 Site-sketch                        | Train Loss: 1.6988 | Train Acc: 0.4132
Average Train Accuracy: 0.8248
 Site-photo                         | Val  Loss: 0.6962 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7169 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.8762 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.6865 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.6914 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.0767 | Val  Acc: 0.8214
 Site-art_painting                  | Val  Loss: 1.1068 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.2111 | Val  Acc: 0.8239
 Site-cartoon                       | Val  Loss: 1.3622 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.4177 | Val  Acc: 0.7304
 Site-sketch                        | Val  Loss: 1.6819 | Val  Acc: 0.3875
Average Valid Accuracy: 0.8540
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9778
 Best site-photo                     | Epoch:15 | Val Acc: 0.9706
 Best site-photo                     | Epoch:15 | Val Acc: 0.9902
 Best site-photo                     | Epoch:15 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8214
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8730
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8239
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.7304
 Best site-sketch                    | Epoch:15 | Val Acc: 0.3875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.6343 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.6683 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6144 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6430 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.6528 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 1.1718 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 1.1716 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.1525 | Train Acc: 0.8216
 Site-cartoon                       | Train Loss: 1.3398 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.3609 | Train Acc: 0.7326
 Site-sketch                        | Train Loss: 1.7071 | Train Acc: 0.4132
Average Train Accuracy: 0.8440
 Site-photo                         | Val  Loss: 0.6582 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.6417 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7576 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.6225 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.6329 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.0315 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.1292 | Val  Acc: 0.8413
 Site-art_painting                  | Val  Loss: 1.2706 | Val  Acc: 0.7746
 Site-cartoon                       | Val  Loss: 1.3793 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.3806 | Val  Acc: 0.7391
 Site-sketch                        | Val  Loss: 1.7072 | Val  Acc: 0.3125
Average Valid Accuracy: 0.8436
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.5905 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.5140 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.5804 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.5742 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6222 | Train Acc: 0.9782
 Site-art_painting                  | Train Loss: 1.1877 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 1.1778 | Train Acc: 0.7579
 Site-art_painting                  | Train Loss: 1.0928 | Train Acc: 0.8169
 Site-cartoon                       | Train Loss: 1.3165 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.3127 | Train Acc: 0.7500
 Site-sketch                        | Train Loss: 1.6893 | Train Acc: 0.4050
Average Train Accuracy: 0.8342
 Site-photo                         | Val  Loss: 0.5947 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5975 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.6667 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5817 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.5960 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.0381 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 1.0769 | Val  Acc: 0.8413
 Site-art_painting                  | Val  Loss: 1.2138 | Val  Acc: 0.7817
 Site-cartoon                       | Val  Loss: 1.3266 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.3471 | Val  Acc: 0.7565
 Site-sketch                        | Val  Loss: 1.6637 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8661
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 0.9778
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 0.9902
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8413
 Best site-art_painting              | Epoch:17 | Val Acc: 0.7817
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.7565
 Best site-sketch                    | Epoch:17 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.5648 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.4930 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.5419 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5469 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.5764 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 1.1422 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.1501 | Train Acc: 0.7579
 Site-art_painting                  | Train Loss: 1.1043 | Train Acc: 0.8263
 Site-cartoon                       | Train Loss: 1.2937 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.3043 | Train Acc: 0.7674
 Site-sketch                        | Train Loss: 1.6959 | Train Acc: 0.4215
Average Train Accuracy: 0.8388
 Site-photo                         | Val  Loss: 0.5111 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5720 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 0.6115 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5703 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.5563 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.9255 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.9666 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 1.1201 | Val  Acc: 0.8169
 Site-cartoon                       | Val  Loss: 1.3356 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 1.3297 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.6472 | Val  Acc: 0.3500
Average Valid Accuracy: 0.8618
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.5078 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.5084 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.4914 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4949 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.5196 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 1.1570 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.0993 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 1.0825 | Train Acc: 0.8357
 Site-cartoon                       | Train Loss: 1.2498 | Train Acc: 0.6176
 Site-cartoon                       | Train Loss: 1.2798 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.6925 | Train Acc: 0.3719
Average Train Accuracy: 0.8312
 Site-photo                         | Val  Loss: 0.5187 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5198 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7444 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.5084 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.4968 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.9392 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.9851 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.1354 | Val  Acc: 0.8169
 Site-cartoon                       | Val  Loss: 1.2661 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 1.3191 | Val  Acc: 0.7217
 Site-sketch                        | Val  Loss: 1.6389 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8712
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-photo                     | Epoch:19 | Val Acc: 0.9853
 Best site-photo                     | Epoch:19 | Val Acc: 0.9902
 Best site-photo                     | Epoch:19 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8929
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8571
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8169
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.7217
 Best site-sketch                    | Epoch:19 | Val Acc: 0.4125
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.4838 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.4357 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4673 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4749 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.4904 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 1.0770 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.1204 | Train Acc: 0.7474
 Site-art_painting                  | Train Loss: 1.0614 | Train Acc: 0.8451
 Site-cartoon                       | Train Loss: 1.3011 | Train Acc: 0.6471
 Site-cartoon                       | Train Loss: 1.2712 | Train Acc: 0.7442
 Site-sketch                        | Train Loss: 1.6601 | Train Acc: 0.4711
Average Train Accuracy: 0.8410
 Site-photo                         | Val  Loss: 0.4571 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4818 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5346 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4764 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.4679 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.9063 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.9953 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.0716 | Val  Acc: 0.8169
 Site-cartoon                       | Val  Loss: 1.3045 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.2674 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.6116 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8680
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.4341 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.3593 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4495 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.4313 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.4434 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 1.0559 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 1.0688 | Train Acc: 0.7789
 Site-art_painting                  | Train Loss: 1.0588 | Train Acc: 0.8263
 Site-cartoon                       | Train Loss: 1.2324 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.2316 | Train Acc: 0.7616
 Site-sketch                        | Train Loss: 1.6416 | Train Acc: 0.4545
Average Train Accuracy: 0.8467
 Site-photo                         | Val  Loss: 0.4682 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.4590 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6694 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.4234 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4381 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.8733 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.9005 | Val  Acc: 0.8889
 Site-art_painting                  | Val  Loss: 1.0881 | Val  Acc: 0.8239
 Site-cartoon                       | Val  Loss: 1.2497 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.2602 | Val  Acc: 0.7304
 Site-sketch                        | Val  Loss: 1.6145 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8670
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.4028 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.3497 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4196 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.3978 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4205 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 1.0236 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 1.0315 | Train Acc: 0.7789
 Site-art_painting                  | Train Loss: 0.9503 | Train Acc: 0.8216
 Site-cartoon                       | Train Loss: 1.2083 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.2358 | Train Acc: 0.7558
 Site-sketch                        | Train Loss: 1.6249 | Train Acc: 0.4215
Average Train Accuracy: 0.8508
 Site-photo                         | Val  Loss: 0.4194 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4147 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4781 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3999 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4226 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.7778 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.8984 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.0493 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.2619 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.2689 | Val  Acc: 0.7217
 Site-sketch                        | Val  Loss: 1.5990 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8636
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.3759 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.3543 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3821 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.3773 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.3857 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.0611 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 0.9795 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.9100 | Train Acc: 0.8638
 Site-cartoon                       | Train Loss: 1.2712 | Train Acc: 0.6471
 Site-cartoon                       | Train Loss: 1.2088 | Train Acc: 0.7558
 Site-sketch                        | Train Loss: 1.6164 | Train Acc: 0.4545
Average Train Accuracy: 0.8404
 Site-photo                         | Val  Loss: 0.3810 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4097 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 0.5821 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.3764 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.3683 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.7540 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.9313 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 1.0190 | Val  Acc: 0.8239
 Site-cartoon                       | Val  Loss: 1.2100 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.2100 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.5835 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8678
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.3861 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.3766 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3416 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.3736 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.3613 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 0.9724 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.9789 | Train Acc: 0.7684
 Site-art_painting                  | Train Loss: 0.9459 | Train Acc: 0.8169
 Site-cartoon                       | Train Loss: 1.2038 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.1517 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.6139 | Train Acc: 0.4545
Average Train Accuracy: 0.8444
 Site-photo                         | Val  Loss: 0.3587 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3844 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.5605 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.3399 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3419 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.8571 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 0.9185 | Val  Acc: 0.8254
 Site-art_painting                  | Val  Loss: 1.0144 | Val  Acc: 0.8451
 Site-cartoon                       | Val  Loss: 1.1970 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.1833 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.5721 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8559
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.3731 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2777 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3110 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.3180 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.3443 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 0.9483 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.9632 | Train Acc: 0.7263
 Site-art_painting                  | Train Loss: 0.9033 | Train Acc: 0.8545
 Site-cartoon                       | Train Loss: 1.1932 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.1358 | Train Acc: 0.7849
 Site-sketch                        | Train Loss: 1.5882 | Train Acc: 0.4380
Average Train Accuracy: 0.8438
 Site-photo                         | Val  Loss: 0.3336 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3235 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3899 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3167 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3324 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.7410 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.8274 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.9926 | Val  Acc: 0.8169
 Site-cartoon                       | Val  Loss: 1.1697 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.1805 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.5274 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8667
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.3040 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2299 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2762 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.3003 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.3060 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 0.9565 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9708 | Train Acc: 0.7789
 Site-art_painting                  | Train Loss: 0.9188 | Train Acc: 0.8451
 Site-cartoon                       | Train Loss: 1.2107 | Train Acc: 0.6176
 Site-cartoon                       | Train Loss: 1.1511 | Train Acc: 0.7558
 Site-sketch                        | Train Loss: 1.5819 | Train Acc: 0.4711
Average Train Accuracy: 0.8409
 Site-photo                         | Val  Loss: 0.3566 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.3141 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4669 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2978 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.3129 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.7168 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.8667 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 0.9184 | Val  Acc: 0.8239
 Site-cartoon                       | Val  Loss: 1.1223 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.1688 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.5435 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8701
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.2790 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2296 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2754 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2635 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2884 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.9731 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.9358 | Train Acc: 0.7789
 Site-art_painting                  | Train Loss: 0.8748 | Train Acc: 0.8732
 Site-cartoon                       | Train Loss: 1.1926 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.1082 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.5671 | Train Acc: 0.4793
Average Train Accuracy: 0.8573
 Site-photo                         | Val  Loss: 0.2893 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3341 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4416 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2707 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.2900 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.7260 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 0.7389 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.9303 | Val  Acc: 0.8380
 Site-cartoon                       | Val  Loss: 1.1064 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 1.1413 | Val  Acc: 0.7304
 Site-sketch                        | Val  Loss: 1.5095 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8758
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 0.9902
 Best site-photo                     | Epoch:27 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:27 | Val Acc: 0.8571
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:27 | Val Acc: 0.8380
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.7304
 Best site-sketch                    | Epoch:27 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.2843 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1744 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2441 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.2394 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2599 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.9193 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8965 | Train Acc: 0.7789
 Site-art_painting                  | Train Loss: 0.8839 | Train Acc: 0.8545
 Site-cartoon                       | Train Loss: 1.1185 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 1.1249 | Train Acc: 0.7849
 Site-sketch                        | Train Loss: 1.5670 | Train Acc: 0.4793
Average Train Accuracy: 0.8599
 Site-photo                         | Val  Loss: 0.2686 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2589 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2976 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2428 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2515 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.7754 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.7881 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.9391 | Val  Acc: 0.8239
 Site-cartoon                       | Val  Loss: 1.1356 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 1.1118 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.5061 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8630
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.2558 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2038 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.2613 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.2398 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2553 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.9076 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 0.8658 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.7957 | Train Acc: 0.8685
 Site-cartoon                       | Train Loss: 1.1619 | Train Acc: 0.6176
 Site-cartoon                       | Train Loss: 1.0855 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.5333 | Train Acc: 0.4380
Average Train Accuracy: 0.8434
 Site-photo                         | Val  Loss: 0.2881 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.2744 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.4485 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.2300 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2394 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.6911 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.7726 | Val  Acc: 0.8889
 Site-art_painting                  | Val  Loss: 0.8384 | Val  Acc: 0.8662
 Site-cartoon                       | Val  Loss: 1.0831 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.0972 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.4812 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8655
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.2499 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1997 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.2265 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.2114 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.2357 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.8939 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8874 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 0.7856 | Train Acc: 0.8779
 Site-cartoon                       | Train Loss: 1.1650 | Train Acc: 0.6471
 Site-cartoon                       | Train Loss: 1.0660 | Train Acc: 0.7674
 Site-sketch                        | Train Loss: 1.5225 | Train Acc: 0.4959
Average Train Accuracy: 0.8451
 Site-photo                         | Val  Loss: 0.2419 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2778 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.4619 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.2257 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.2353 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.6630 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.7388 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.8637 | Val  Acc: 0.8662
 Site-cartoon                       | Val  Loss: 1.0892 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 1.0691 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 1.4938 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8855
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 0.9778
 Best site-photo                     | Epoch:30 | Val Acc: 0.9853
 Best site-photo                     | Epoch:30 | Val Acc: 0.9902
 Best site-photo                     | Epoch:30 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8662
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:30 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.2406 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1585 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2162 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.1971 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.2241 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.8557 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.8450 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.7305 | Train Acc: 0.8873
 Site-cartoon                       | Train Loss: 1.1146 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.0376 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.5297 | Train Acc: 0.5041
Average Train Accuracy: 0.8657
 Site-photo                         | Val  Loss: 0.2486 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.2638 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.2732 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2177 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.2178 | Val  Acc: 0.9803
 Site-art_painting                  | Val  Loss: 0.7296 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.7066 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.8585 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.0824 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.0951 | Val  Acc: 0.7565
 Site-sketch                        | Val  Loss: 1.4763 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8708
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.2069 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1192 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2070 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.2159 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.2062 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.8489 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.8677 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.7618 | Train Acc: 0.8592
 Site-cartoon                       | Train Loss: 1.0908 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.0201 | Train Acc: 0.8081
 Site-sketch                        | Train Loss: 1.4959 | Train Acc: 0.4876
Average Train Accuracy: 0.8605
 Site-photo                         | Val  Loss: 0.2190 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2242 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4051 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.1982 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1915 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.6640 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.7357 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.8377 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.0237 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.0705 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.4693 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8810
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.2218 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1545 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.1593 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1953 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.1864 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.8238 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 0.8347 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 0.7145 | Train Acc: 0.8826
 Site-cartoon                       | Train Loss: 1.0679 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 0.9851 | Train Acc: 0.8023
 Site-sketch                        | Train Loss: 1.5062 | Train Acc: 0.4793
Average Train Accuracy: 0.8580
 Site-photo                         | Val  Loss: 0.1995 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1837 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1665 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1833 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5699 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.6742 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.8301 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.0281 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.0301 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.4844 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8909
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9902
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:33 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8592
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.7826
 Best site-sketch                    | Epoch:33 | Val Acc: 0.4375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.1780 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1419 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1801 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1597 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1790 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.8219 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8175 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.7576 | Train Acc: 0.9061
 Site-cartoon                       | Train Loss: 1.0479 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.9904 | Train Acc: 0.8081
 Site-sketch                        | Train Loss: 1.5109 | Train Acc: 0.4793
Average Train Accuracy: 0.8633
 Site-photo                         | Val  Loss: 0.2192 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1637 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2221 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1680 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1739 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5431 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.6341 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.7422 | Val  Acc: 0.8732
 Site-cartoon                       | Val  Loss: 0.9878 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.0362 | Val  Acc: 0.7913
 Site-sketch                        | Val  Loss: 1.4681 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8814
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.1780 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1341 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.1549 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1516 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1699 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.7255 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.7806 | Train Acc: 0.8211
 Site-art_painting                  | Train Loss: 0.7103 | Train Acc: 0.8873
 Site-cartoon                       | Train Loss: 1.0540 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.9642 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.5031 | Train Acc: 0.4545
Average Train Accuracy: 0.8637
 Site-photo                         | Val  Loss: 0.1632 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1784 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2680 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1617 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1540 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5301 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.6421 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.8234 | Val  Acc: 0.8451
 Site-cartoon                       | Val  Loss: 1.0168 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.9733 | Val  Acc: 0.8261
 Site-sketch                        | Val  Loss: 1.5030 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8858
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.2007 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0992 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.1352 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1451 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1633 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 0.7006 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.7563 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.6613 | Train Acc: 0.8685
 Site-cartoon                       | Train Loss: 0.9880 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.9804 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.4546 | Train Acc: 0.5041
Average Train Accuracy: 0.8735
 Site-photo                         | Val  Loss: 0.2050 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1919 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3556 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1461 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1391 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5802 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 0.5748 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.7320 | Val  Acc: 0.8732
 Site-cartoon                       | Val  Loss: 1.1086 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.0023 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.4730 | Val  Acc: 0.4875
Average Valid Accuracy: 0.8773
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.1635 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1136 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1550 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1313 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1514 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.7041 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.7325 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.6855 | Train Acc: 0.8779
 Site-cartoon                       | Train Loss: 1.0566 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 0.9663 | Train Acc: 0.8140
 Site-sketch                        | Train Loss: 1.4288 | Train Acc: 0.5124
Average Train Accuracy: 0.8670
 Site-photo                         | Val  Loss: 0.1670 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1371 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3143 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1331 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1261 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5675 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.6369 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.7567 | Val  Acc: 0.8732
 Site-cartoon                       | Val  Loss: 0.9190 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 1.0014 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.4119 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8881
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.1694 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1150 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.1365 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1367 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1334 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6787 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.7586 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.6846 | Train Acc: 0.8826
 Site-cartoon                       | Train Loss: 0.9337 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.9553 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.4177 | Train Acc: 0.5455
Average Train Accuracy: 0.8779
 Site-photo                         | Val  Loss: 0.1346 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1415 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2197 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1273 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1352 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.5226 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5530 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.7374 | Val  Acc: 0.8732
 Site-cartoon                       | Val  Loss: 0.9541 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.9754 | Val  Acc: 0.7565
 Site-sketch                        | Val  Loss: 1.3996 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8925
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8732
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.7565
 Best site-sketch                    | Epoch:38 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.1560 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0949 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1170 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1282 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1339 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.7232 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.6990 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.5952 | Train Acc: 0.8967
 Site-cartoon                       | Train Loss: 0.9881 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.9542 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.4595 | Train Acc: 0.4628
Average Train Accuracy: 0.8635
 Site-photo                         | Val  Loss: 0.1316 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1274 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1443 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1193 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1361 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5106 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5784 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.7649 | Val  Acc: 0.8732
 Site-cartoon                       | Val  Loss: 0.9833 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.9632 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.3324 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8746
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.1325 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0812 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1138 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.1293 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.6765 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.7230 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.6139 | Train Acc: 0.8826
 Site-cartoon                       | Train Loss: 0.9839 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 0.9481 | Train Acc: 0.8140
 Site-sketch                        | Train Loss: 1.4089 | Train Acc: 0.4876
Average Train Accuracy: 0.8669
 Site-photo                         | Val  Loss: 0.1164 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1146 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1586 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1047 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1308 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5355 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.6362 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.7087 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 0.9536 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.9369 | Val  Acc: 0.7913
 Site-sketch                        | Val  Loss: 1.3522 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8914
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.1556 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0893 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0976 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0960 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1259 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 0.6364 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.6903 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.6232 | Train Acc: 0.8732
 Site-cartoon                       | Train Loss: 0.9557 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.9314 | Train Acc: 0.8198
 Site-sketch                        | Train Loss: 1.4493 | Train Acc: 0.4876
Average Train Accuracy: 0.8702
 Site-photo                         | Val  Loss: 0.1438 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.1130 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1332 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1157 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1084 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4972 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.5363 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.6800 | Val  Acc: 0.9085
 Site-cartoon                       | Val  Loss: 0.9361 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.9283 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.4215 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8841
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.1299 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0632 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0957 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0967 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1082 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.7113 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.6446 | Train Acc: 0.8526
 Site-art_painting                  | Train Loss: 0.6068 | Train Acc: 0.8779
 Site-cartoon                       | Train Loss: 0.9266 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.9003 | Train Acc: 0.8081
 Site-sketch                        | Train Loss: 1.4203 | Train Acc: 0.4628
Average Train Accuracy: 0.8755
 Site-photo                         | Val  Loss: 0.0983 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1342 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.1160 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0902 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1112 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5499 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5879 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.6220 | Val  Acc: 0.9014
 Site-cartoon                       | Val  Loss: 0.9412 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.9017 | Val  Acc: 0.8087
 Site-sketch                        | Val  Loss: 1.3535 | Val  Acc: 0.5000
Average Valid Accuracy: 0.9011
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 0.9778
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9014
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.8087
 Best site-sketch                    | Epoch:42 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.1190 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0951 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0953 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0873 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1147 | Train Acc: 0.9869
 Site-art_painting                  | Train Loss: 0.6138 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.7014 | Train Acc: 0.8211
 Site-art_painting                  | Train Loss: 0.6002 | Train Acc: 0.9061
 Site-cartoon                       | Train Loss: 0.9662 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.8665 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.3634 | Train Acc: 0.5455
Average Train Accuracy: 0.8764
 Site-photo                         | Val  Loss: 0.1388 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2621 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1094 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0891 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5205 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5915 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.6740 | Val  Acc: 0.8451
 Site-cartoon                       | Val  Loss: 0.9006 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.9157 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.3984 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8979
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.1285 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0654 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0862 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0759 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1074 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.6707 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.6907 | Train Acc: 0.8211
 Site-art_painting                  | Train Loss: 0.5425 | Train Acc: 0.9061
 Site-cartoon                       | Train Loss: 0.9565 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.9019 | Train Acc: 0.8198
 Site-sketch                        | Train Loss: 1.4344 | Train Acc: 0.4628
Average Train Accuracy: 0.8736
 Site-photo                         | Val  Loss: 0.0963 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1129 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2931 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0897 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1077 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4664 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.5377 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.6282 | Val  Acc: 0.9085
 Site-cartoon                       | Val  Loss: 0.8794 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.9086 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.3377 | Val  Acc: 0.4875
Average Valid Accuracy: 0.9032
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 0.9853
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:44 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:44 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:44 | Val Acc: 0.9085
 Best site-cartoon                   | Epoch:44 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:44 | Val Acc: 0.8174
 Best site-sketch                    | Epoch:44 | Val Acc: 0.4875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.1352 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0621 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0707 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0691 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0933 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5960 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.6899 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.5915 | Train Acc: 0.8779
 Site-cartoon                       | Train Loss: 0.8988 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.8657 | Train Acc: 0.8081
 Site-sketch                        | Train Loss: 1.3666 | Train Acc: 0.4876
Average Train Accuracy: 0.8684
 Site-photo                         | Val  Loss: 0.1027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1239 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.1073 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0965 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0904 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5088 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4888 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.7129 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 0.8827 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.8943 | Val  Acc: 0.7913
 Site-sketch                        | Val  Loss: 1.3382 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8934
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.1136 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0727 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0881 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0858 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.0912 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6671 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.5889 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.5380 | Train Acc: 0.9155
 Site-cartoon                       | Train Loss: 0.9422 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.8340 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.3803 | Train Acc: 0.4876
Average Train Accuracy: 0.8857
 Site-photo                         | Val  Loss: 0.0776 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0886 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0871 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0922 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0845 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4319 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5321 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.6081 | Val  Acc: 0.9085
 Site-cartoon                       | Val  Loss: 0.8803 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.8803 | Val  Acc: 0.8087
 Site-sketch                        | Val  Loss: 1.2439 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8971
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.1205 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0855 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0657 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0767 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0864 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.6123 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.6451 | Train Acc: 0.8526
 Site-art_painting                  | Train Loss: 0.5518 | Train Acc: 0.9014
 Site-cartoon                       | Train Loss: 1.0006 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.8143 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.3957 | Train Acc: 0.4380
Average Train Accuracy: 0.8732
 Site-photo                         | Val  Loss: 0.0719 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0849 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0949 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0976 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.0737 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4040 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.5002 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.6647 | Val  Acc: 0.8451
 Site-cartoon                       | Val  Loss: 0.9038 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.8619 | Val  Acc: 0.8087
 Site-sketch                        | Val  Loss: 1.3089 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8981
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0959 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0648 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0571 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0768 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0714 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6090 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.5814 | Train Acc: 0.8842
 Site-art_painting                  | Train Loss: 0.5628 | Train Acc: 0.8873
 Site-cartoon                       | Train Loss: 0.9010 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.8858 | Train Acc: 0.7965
 Site-sketch                        | Train Loss: 1.3420 | Train Acc: 0.5124
Average Train Accuracy: 0.8816
 Site-photo                         | Val  Loss: 0.0853 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0973 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0721 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0770 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0806 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.3841 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.4949 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.6080 | Val  Acc: 0.9085
 Site-cartoon                       | Val  Loss: 0.8147 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.8737 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.3047 | Val  Acc: 0.4875
Average Valid Accuracy: 0.9039
 Best site-photo                     | Epoch:48 | Val Acc: 1.0000
 Best site-photo                     | Epoch:48 | Val Acc: 1.0000
 Best site-photo                     | Epoch:48 | Val Acc: 1.0000
 Best site-photo                     | Epoch:48 | Val Acc: 1.0000
 Best site-photo                     | Epoch:48 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:48 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:48 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:48 | Val Acc: 0.9085
 Best site-cartoon                   | Epoch:48 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:48 | Val Acc: 0.7739
 Best site-sketch                    | Epoch:48 | Val Acc: 0.4875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/fedavg...
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.1030 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0506 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0565 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0727 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0770 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5920 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.5730 | Train Acc: 0.8842
 Site-art_painting                  | Train Loss: 0.5418 | Train Acc: 0.9155
 Site-cartoon                       | Train Loss: 1.0026 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.8126 | Train Acc: 0.8198
 Site-sketch                        | Train Loss: 1.3207 | Train Acc: 0.5372
Average Train Accuracy: 0.8855
 Site-photo                         | Val  Loss: 0.1205 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0964 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0722 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0717 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.3820 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5068 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.6151 | Val  Acc: 0.8803
 Site-cartoon                       | Val  Loss: 0.8515 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.8615 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 1.3115 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8881
===2023-08-11 01:49:13===
===2023-08-11 01:49:28===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:48 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:48 | Test Acc: 0.8952
 Test site-cartoon                   | Epoch:48 | Test Acc: 0.7511
 Test site-sketch                    | Epoch:48 | Test Acc: 0.4956
photo: 0.9985, art_painting: 0.8952, cartoon: 0.7511, sketch: 0.4956, 
Average Test Accuracy(group): 0.7851, Average Test Accuracy(individual): 0.8796,
domain std=0.1889, cluster std=-1.0000, individual std=0.1513, 
