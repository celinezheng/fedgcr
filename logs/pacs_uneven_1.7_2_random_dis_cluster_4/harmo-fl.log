===2023-08-11 03:05:45===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.0480 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.9968 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.0768 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.0199 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0584 | Train Acc: 0.9738
 Site-art_painting                  | Train Loss: 1.4856 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 1.4796 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.4421 | Train Acc: 0.7371
 Site-cartoon                       | Train Loss: 1.5372 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.5600 | Train Acc: 0.6860
 Site-sketch                        | Train Loss: 1.8020 | Train Acc: 0.3802
Average Train Accuracy: 0.8133
 Site-photo                         | Val  Loss: 1.0646 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 1.0781 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 1.2244 | Val  Acc: 0.9559
 Site-photo                         | Val  Loss: 1.0422 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 1.0564 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.3556 | Val  Acc: 0.8214
 Site-art_painting                  | Val  Loss: 1.4091 | Val  Acc: 0.7619
 Site-art_painting                  | Val  Loss: 1.5068 | Val  Acc: 0.7183
 Site-cartoon                       | Val  Loss: 1.6133 | Val  Acc: 0.6087
 Site-cartoon                       | Val  Loss: 1.5938 | Val  Acc: 0.5826
 Site-sketch                        | Val  Loss: 1.8140 | Val  Acc: 0.3375
Average Valid Accuracy: 0.7896
 Best site-photo                     | Epoch:0 | Val Acc: 0.9667
 Best site-photo                     | Epoch:0 | Val Acc: 0.9556
 Best site-photo                     | Epoch:0 | Val Acc: 0.9559
 Best site-photo                     | Epoch:0 | Val Acc: 0.9902
 Best site-photo                     | Epoch:0 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8214
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7619
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7183
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.6087
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.5826
 Best site-sketch                    | Epoch:0 | Val Acc: 0.3375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 0.5210 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.4843 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5016 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5172 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.5337 | Train Acc: 0.9825
 Site-art_painting                  | Train Loss: 1.1710 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 1.1114 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 1.0816 | Train Acc: 0.7981
 Site-cartoon                       | Train Loss: 1.2482 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 1.2903 | Train Acc: 0.7384
 Site-sketch                        | Train Loss: 1.6762 | Train Acc: 0.4628
Average Train Accuracy: 0.8408
 Site-photo                         | Val  Loss: 0.5676 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.5442 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.7035 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5215 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5120 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.9523 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 1.0329 | Val  Acc: 0.8413
 Site-art_painting                  | Val  Loss: 1.1436 | Val  Acc: 0.8099
 Site-cartoon                       | Val  Loss: 1.3323 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.3148 | Val  Acc: 0.7217
 Site-sketch                        | Val  Loss: 1.6757 | Val  Acc: 0.4625
Average Valid Accuracy: 0.8556
 Best site-photo                     | Epoch:1 | Val Acc: 0.9667
 Best site-photo                     | Epoch:1 | Val Acc: 0.9778
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8929
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8413
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8099
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7217
 Best site-sketch                    | Epoch:1 | Val Acc: 0.4625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 0.2659 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.2065 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2802 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.2657 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2522 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.9339 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 0.9295 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.8802 | Train Acc: 0.8498
 Site-cartoon                       | Train Loss: 1.0946 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 1.1033 | Train Acc: 0.7674
 Site-sketch                        | Train Loss: 1.5616 | Train Acc: 0.5207
Average Train Accuracy: 0.8507
 Site-photo                         | Val  Loss: 0.2431 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2789 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2868 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2520 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2486 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.7054 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.8036 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 0.9176 | Val  Acc: 0.8310
 Site-cartoon                       | Val  Loss: 1.1825 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 1.1328 | Val  Acc: 0.7043
 Site-sketch                        | Val  Loss: 1.5183 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8654
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:2 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8730
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8310
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7043
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 0.1532 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0698 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1168 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1376 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1482 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.7188 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.7646 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 0.7528 | Train Acc: 0.8498
 Site-cartoon                       | Train Loss: 1.0738 | Train Acc: 0.6765
 Site-cartoon                       | Train Loss: 0.9622 | Train Acc: 0.7791
 Site-sketch                        | Train Loss: 1.4511 | Train Acc: 0.4876
Average Train Accuracy: 0.8553
 Site-photo                         | Val  Loss: 0.1299 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1356 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1478 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1442 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1377 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4955 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.6508 | Val  Acc: 0.8730
 Site-art_painting                  | Val  Loss: 0.8014 | Val  Acc: 0.8380
 Site-cartoon                       | Val  Loss: 1.0291 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 0.9923 | Val  Acc: 0.7391
 Site-sketch                        | Val  Loss: 1.4120 | Val  Acc: 0.5250
Average Valid Accuracy: 0.8744
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 0.9902
 Best site-photo                     | Epoch:3 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:3 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8730
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8380
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6957
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7391
 Best site-sketch                    | Epoch:3 | Val Acc: 0.5250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.1248 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0505 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0763 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0783 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0902 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6837 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.7005 | Train Acc: 0.8526
 Site-art_painting                  | Train Loss: 0.6398 | Train Acc: 0.8779
 Site-cartoon                       | Train Loss: 1.0499 | Train Acc: 0.6471
 Site-cartoon                       | Train Loss: 0.8627 | Train Acc: 0.8081
 Site-sketch                        | Train Loss: 1.3521 | Train Acc: 0.5207
Average Train Accuracy: 0.8648
 Site-photo                         | Val  Loss: 0.1420 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0960 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1385 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0780 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1118 | Val  Acc: 0.9737
 Site-art_painting                  | Val  Loss: 0.3709 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.5245 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.6357 | Val  Acc: 0.8944
 Site-cartoon                       | Val  Loss: 0.9134 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.8919 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.3265 | Val  Acc: 0.4875
Average Valid Accuracy: 0.8885
 Best site-photo                     | Epoch:4 | Val Acc: 0.9667
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 0.9853
 Best site-photo                     | Epoch:4 | Val Acc: 0.9902
 Best site-photo                     | Epoch:4 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8944
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.7652
 Best site-sketch                    | Epoch:4 | Val Acc: 0.4875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.1012 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0345 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0419 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0574 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.0497 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5434 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.6403 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.5555 | Train Acc: 0.8873
 Site-cartoon                       | Train Loss: 0.8731 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.8283 | Train Acc: 0.7616
 Site-sketch                        | Train Loss: 1.3663 | Train Acc: 0.5041
Average Train Accuracy: 0.8628
 Site-photo                         | Val  Loss: 0.0643 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0714 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0738 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0450 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0585 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4654 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.4605 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.5267 | Val  Acc: 0.8521
 Site-cartoon                       | Val  Loss: 0.8696 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.8463 | Val  Acc: 0.7478
 Site-sketch                        | Val  Loss: 1.2720 | Val  Acc: 0.5250
Average Valid Accuracy: 0.8911
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9365
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8521
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7478
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.0688 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0269 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0307 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0314 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0398 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6316 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.5797 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 0.4545 | Train Acc: 0.9061
 Site-cartoon                       | Train Loss: 0.9175 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.8140 | Train Acc: 0.7907
 Site-sketch                        | Train Loss: 1.2577 | Train Acc: 0.5537
Average Train Accuracy: 0.8758
 Site-photo                         | Val  Loss: 0.0736 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0632 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1502 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0309 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3250 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3680 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.5186 | Val  Acc: 0.8803
 Site-cartoon                       | Val  Loss: 0.8038 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.7910 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.1945 | Val  Acc: 0.4875
Average Valid Accuracy: 0.8955
 Best site-photo                     | Epoch:6 | Val Acc: 0.9667
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:6 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8803
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7652
 Best site-sketch                    | Epoch:6 | Val Acc: 0.4875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.0607 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0117 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0213 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0260 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0274 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5693 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.5666 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.4537 | Train Acc: 0.9202
 Site-cartoon                       | Train Loss: 0.8614 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.6934 | Train Acc: 0.8314
 Site-sketch                        | Train Loss: 1.2056 | Train Acc: 0.5702
Average Train Accuracy: 0.8877
 Site-photo                         | Val  Loss: 0.0197 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0288 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0930 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0308 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0239 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3149 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.3657 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.4743 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.6998 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 0.7330 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 1.1514 | Val  Acc: 0.4750
Average Valid Accuracy: 0.8991
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9155
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8435
 Best site-sketch                    | Epoch:7 | Val Acc: 0.4750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.0818 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0186 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4540 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.4547 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.4188 | Train Acc: 0.8920
 Site-cartoon                       | Train Loss: 0.7834 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.6797 | Train Acc: 0.8140
 Site-sketch                        | Train Loss: 1.3306 | Train Acc: 0.4876
Average Train Accuracy: 0.8795
 Site-photo                         | Val  Loss: 0.0110 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0585 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0312 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0313 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2319 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3763 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.4653 | Val  Acc: 0.9014
 Site-cartoon                       | Val  Loss: 0.7361 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.6731 | Val  Acc: 0.8087
 Site-sketch                        | Val  Loss: 1.1658 | Val  Acc: 0.5375
Average Valid Accuracy: 0.9040
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:8 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:8 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:8 | Val Acc: 0.9014
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.8087
 Best site-sketch                    | Epoch:8 | Val Acc: 0.5375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.0609 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0086 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0241 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0167 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0329 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.4620 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.5126 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.3672 | Train Acc: 0.9155
 Site-cartoon                       | Train Loss: 0.7820 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.6422 | Train Acc: 0.8081
 Site-sketch                        | Train Loss: 1.1900 | Train Acc: 0.4959
Average Train Accuracy: 0.8847
 Site-photo                         | Val  Loss: 0.0199 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0175 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0238 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2942 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.3788 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.3686 | Val  Acc: 0.9296
 Site-cartoon                       | Val  Loss: 0.6206 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.6973 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.1451 | Val  Acc: 0.5375
Average Valid Accuracy: 0.9055
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9365
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9296
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7652
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.0935 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0142 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0092 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0120 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4220 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.4413 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.3650 | Train Acc: 0.9061
 Site-cartoon                       | Train Loss: 0.7836 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.6034 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.1060 | Train Acc: 0.6033
Average Train Accuracy: 0.8966
 Site-photo                         | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0255 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2243 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3733 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.4156 | Val  Acc: 0.8873
 Site-cartoon                       | Val  Loss: 0.5139 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.6532 | Val  Acc: 0.8087
 Site-sketch                        | Val  Loss: 1.0285 | Val  Acc: 0.5500
Average Valid Accuracy: 0.9163
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:10 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8873
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8087
 Best site-sketch                    | Epoch:10 | Val Acc: 0.5500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.0551 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0100 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0049 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0076 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0182 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4061 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3713 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.3205 | Train Acc: 0.9343
 Site-cartoon                       | Train Loss: 0.7313 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.6146 | Train Acc: 0.8256
 Site-sketch                        | Train Loss: 1.0970 | Train Acc: 0.5868
Average Train Accuracy: 0.9012
 Site-photo                         | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0143 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0173 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1901 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2794 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.4431 | Val  Acc: 0.9014
 Site-cartoon                       | Val  Loss: 0.5898 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.6109 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.0612 | Val  Acc: 0.6000
Average Valid Accuracy: 0.9134
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.0496 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0211 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0271 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0093 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4332 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.3671 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.2996 | Train Acc: 0.9390
 Site-cartoon                       | Train Loss: 0.7240 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.5613 | Train Acc: 0.8314
 Site-sketch                        | Train Loss: 1.0851 | Train Acc: 0.5868
Average Train Accuracy: 0.8951
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2427 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.3112 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.3434 | Val  Acc: 0.9296
 Site-cartoon                       | Val  Loss: 0.6045 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.5719 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.0019 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9067
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.0334 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0212 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0115 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0094 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4030 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.4812 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.2934 | Train Acc: 0.9249
 Site-cartoon                       | Train Loss: 0.7377 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.4825 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 1.1180 | Train Acc: 0.5702
Average Train Accuracy: 0.9029
 Site-photo                         | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0190 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0160 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2076 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.2545 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.3322 | Val  Acc: 0.9366
 Site-cartoon                       | Val  Loss: 0.5354 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.5540 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 1.0495 | Val  Acc: 0.4750
Average Valid Accuracy: 0.9087
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.0623 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0867 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0119 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3490 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.4235 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.2630 | Train Acc: 0.9343
 Site-cartoon                       | Train Loss: 0.8522 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.5425 | Train Acc: 0.8488
 Site-sketch                        | Train Loss: 1.0488 | Train Acc: 0.6116
Average Train Accuracy: 0.8994
 Site-photo                         | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0124 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0128 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1530 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2199 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.4727 | Val  Acc: 0.8803
 Site-cartoon                       | Val  Loss: 0.5110 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.5936 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.0010 | Val  Acc: 0.5625
Average Valid Accuracy: 0.9126
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.0568 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0097 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3746 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3358 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.3471 | Train Acc: 0.9343
 Site-cartoon                       | Train Loss: 0.7338 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.5245 | Train Acc: 0.8430
 Site-sketch                        | Train Loss: 1.0652 | Train Acc: 0.5868
Average Train Accuracy: 0.8984
 Site-photo                         | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0119 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1873 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2814 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2770 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.4221 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.5134 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 0.9212 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9265
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9155
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8609
 Best site-sketch                    | Epoch:15 | Val Acc: 0.6125
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.0470 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0145 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0072 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3015 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.4370 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.3014 | Train Acc: 0.9249
 Site-cartoon                       | Train Loss: 0.7057 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.4392 | Train Acc: 0.8953
 Site-sketch                        | Train Loss: 0.9627 | Train Acc: 0.6777
Average Train Accuracy: 0.9125
 Site-photo                         | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1525 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2340 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.4152 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.5209 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.5192 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 0.9448 | Val  Acc: 0.6000
Average Valid Accuracy: 0.9145
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.0672 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0162 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0104 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4358 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.4567 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.2663 | Train Acc: 0.9249
 Site-cartoon                       | Train Loss: 0.7176 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4471 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 0.9879 | Train Acc: 0.6281
Average Train Accuracy: 0.9080
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0106 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1630 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2874 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.2422 | Val  Acc: 0.9085
 Site-cartoon                       | Val  Loss: 0.4050 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.5256 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 1.0065 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9197
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.0537 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3363 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3873 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.2390 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.7545 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 0.4824 | Train Acc: 0.8953
 Site-sketch                        | Train Loss: 1.0510 | Train Acc: 0.6281
Average Train Accuracy: 0.9031
 Site-photo                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0184 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2003 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2240 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.3575 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.4160 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4861 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 0.9743 | Val  Acc: 0.5375
Average Valid Accuracy: 0.9237
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0407 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3812 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.4456 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.3364 | Train Acc: 0.9343
 Site-cartoon                       | Train Loss: 0.5436 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.4613 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 0.9857 | Train Acc: 0.6033
Average Train Accuracy: 0.9130
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1656 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2123 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.2470 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.4814 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.4804 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 0.9815 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9190
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0417 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0134 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0122 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3685 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3247 | Train Acc: 0.8842
 Site-art_painting                  | Train Loss: 0.2257 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.6894 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4186 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 1.0052 | Train Acc: 0.6446
Average Train Accuracy: 0.9164
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0064 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0219 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1768 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2828 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.3019 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.4364 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.5366 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 1.0099 | Val  Acc: 0.5375
Average Valid Accuracy: 0.9185
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0424 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3411 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3535 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.2428 | Train Acc: 0.9390
 Site-cartoon                       | Train Loss: 0.6931 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.4383 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 0.9657 | Train Acc: 0.6777
Average Train Accuracy: 0.9119
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0149 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1694 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1932 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2352 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.4333 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4878 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 0.9718 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9287
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 0.9902
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8435
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0615 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0103 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3919 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.4143 | Train Acc: 0.8842
 Site-art_painting                  | Train Loss: 0.2619 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.7252 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4530 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.9481 | Train Acc: 0.6612
Average Train Accuracy: 0.9178
 Site-photo                         | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0229 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0186 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1471 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1980 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2135 | Val  Acc: 0.9366
 Site-cartoon                       | Val  Loss: 0.4791 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.5135 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 0.9405 | Val  Acc: 0.6000
Average Valid Accuracy: 0.9184
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0585 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0110 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3710 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3854 | Train Acc: 0.8842
 Site-art_painting                  | Train Loss: 0.2279 | Train Acc: 0.9437
 Site-cartoon                       | Train Loss: 0.6686 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.4193 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 1.0108 | Train Acc: 0.6529
Average Train Accuracy: 0.9187
 Site-photo                         | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1212 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1728 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2848 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.4787 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.4881 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 0.9157 | Val  Acc: 0.6000
Average Valid Accuracy: 0.9277
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0344 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0150 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0040 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0052 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3428 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3866 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.2341 | Train Acc: 0.9343
 Site-cartoon                       | Train Loss: 0.7673 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4043 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.9772 | Train Acc: 0.6529
Average Train Accuracy: 0.9176
 Site-photo                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1551 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2197 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2275 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3513 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.5065 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 0.9719 | Val  Acc: 0.5500
Average Valid Accuracy: 0.9225
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0498 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0129 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2948 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3780 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.2336 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.5862 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4145 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.9203 | Train Acc: 0.6694
Average Train Accuracy: 0.9183
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1266 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1663 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.3217 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3929 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4281 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.9106 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9315
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9437
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.9130
 Best site-sketch                    | Epoch:25 | Val Acc: 0.5875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0445 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3148 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3114 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2488 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.6047 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4202 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 0.9268 | Train Acc: 0.6694
Average Train Accuracy: 0.9192
 Site-photo                         | Val  Loss: 0.0112 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0200 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1276 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2129 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2181 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.4790 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.4629 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 0.8597 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9309
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0324 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0056 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3166 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3363 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.2212 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.7383 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3826 | Train Acc: 0.9186
 Site-sketch                        | Train Loss: 0.9889 | Train Acc: 0.6612
Average Train Accuracy: 0.9192
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1327 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1877 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2310 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.3890 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4435 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.9812 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9350
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:27 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9507
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.8783
 Best site-sketch                    | Epoch:27 | Val Acc: 0.5750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0619 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0193 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0129 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3781 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3227 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1811 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6113 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.3894 | Train Acc: 0.8953
 Site-sketch                        | Train Loss: 0.8971 | Train Acc: 0.6777
Average Train Accuracy: 0.9198
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1651 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1840 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.2137 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.4275 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.4484 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 0.8612 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9293
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0342 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3983 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.3409 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2123 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.6972 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.4010 | Train Acc: 0.8837
 Site-sketch                        | Train Loss: 0.9302 | Train Acc: 0.6694
Average Train Accuracy: 0.9137
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1223 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2477 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.2660 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.4286 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.4020 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 0.8548 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9283
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0875 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0066 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4207 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3150 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1621 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.7885 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.4041 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.9362 | Train Acc: 0.6860
Average Train Accuracy: 0.9223
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1349 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1977 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2215 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3905 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3872 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.9218 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9369
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:30 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8957
 Best site-sketch                    | Epoch:30 | Val Acc: 0.5875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0640 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0109 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3398 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2932 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2120 | Train Acc: 0.9437
 Site-cartoon                       | Train Loss: 0.5400 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.3211 | Train Acc: 0.9419
 Site-sketch                        | Train Loss: 0.9934 | Train Acc: 0.6612
Average Train Accuracy: 0.9279
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0315 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1003 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1947 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2635 | Val  Acc: 0.9366
 Site-cartoon                       | Val  Loss: 0.3389 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.4598 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.9303 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9376
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9366
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8957
 Best site-sketch                    | Epoch:31 | Val Acc: 0.6875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0482 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0197 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3335 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3054 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2216 | Train Acc: 0.9437
 Site-cartoon                       | Train Loss: 0.6318 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3515 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.9070 | Train Acc: 0.6860
Average Train Accuracy: 0.9200
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1155 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2117 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.2461 | Val  Acc: 0.9296
 Site-cartoon                       | Val  Loss: 0.3785 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4717 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 0.9094 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9279
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0328 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2853 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.3359 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.2170 | Train Acc: 0.9390
 Site-cartoon                       | Train Loss: 0.5878 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.3787 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.9296 | Train Acc: 0.6942
Average Train Accuracy: 0.9320
 Site-photo                         | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0866 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1798 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2270 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.3781 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4008 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 0.9795 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9424
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:33 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9648
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8609
 Best site-sketch                    | Epoch:33 | Val Acc: 0.6875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0279 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2844 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3204 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.1880 | Train Acc: 0.9812
 Site-cartoon                       | Train Loss: 0.6531 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3837 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.9268 | Train Acc: 0.6529
Average Train Accuracy: 0.9259
 Site-photo                         | Val  Loss: 0.0677 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0141 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0432 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1152 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2504 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.4259 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4236 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 0.8830 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9391
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0386 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3492 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3146 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.2139 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.8280 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.4011 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.9217 | Train Acc: 0.6777
Average Train Accuracy: 0.9233
 Site-photo                         | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0160 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1156 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1795 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2818 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3898 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4283 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 0.8561 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9287
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0622 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4212 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3041 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2233 | Train Acc: 0.9390
 Site-cartoon                       | Train Loss: 0.4828 | Train Acc: 0.9118
 Site-cartoon                       | Train Loss: 0.3586 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.9355 | Train Acc: 0.7190
Average Train Accuracy: 0.9325
 Site-photo                         | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1363 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1804 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2467 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3877 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3737 | Val  Acc: 0.9217
 Site-sketch                        | Val  Loss: 1.0065 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9432
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.9217
 Best site-sketch                    | Epoch:36 | Val Acc: 0.6500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.1551 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0110 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0117 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4585 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.2943 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2452 | Train Acc: 0.9437
 Site-cartoon                       | Train Loss: 0.5235 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3693 | Train Acc: 0.9360
 Site-sketch                        | Train Loss: 0.9018 | Train Acc: 0.7025
Average Train Accuracy: 0.9217
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1126 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1776 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.3190 | Val  Acc: 0.9366
 Site-cartoon                       | Val  Loss: 0.3903 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4947 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 0.8707 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9361
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0523 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3097 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2810 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.2151 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.6640 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3562 | Train Acc: 0.9419
 Site-sketch                        | Train Loss: 0.9032 | Train Acc: 0.6860
Average Train Accuracy: 0.9290
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1086 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1779 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1744 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.4127 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4338 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 0.9124 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9373
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0474 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3956 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2480 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.2172 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.6266 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3517 | Train Acc: 0.9360
 Site-sketch                        | Train Loss: 0.9053 | Train Acc: 0.6364
Average Train Accuracy: 0.9217
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0892 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2033 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.2053 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3256 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4116 | Val  Acc: 0.9043
 Site-sketch                        | Val  Loss: 0.8878 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9386
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0270 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0142 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3893 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3234 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.1584 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.5956 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3810 | Train Acc: 0.9360
 Site-sketch                        | Train Loss: 0.9195 | Train Acc: 0.6942
Average Train Accuracy: 0.9296
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0943 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1509 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1636 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3729 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4136 | Val  Acc: 0.9043
 Site-sketch                        | Val  Loss: 0.9119 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9458
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:40 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.9043
 Best site-sketch                    | Epoch:40 | Val Acc: 0.6875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0491 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0055 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3705 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2819 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.1993 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.4905 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3363 | Train Acc: 0.9360
 Site-sketch                        | Train Loss: 0.9231 | Train Acc: 0.6612
Average Train Accuracy: 0.9246
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0120 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2103 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1900 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.2113 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.3692 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3863 | Val  Acc: 0.9043
 Site-sketch                        | Val  Loss: 0.8759 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9404
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0540 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0057 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2742 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2850 | Train Acc: 0.8842
 Site-art_painting                  | Train Loss: 0.1834 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.5134 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3547 | Train Acc: 0.9186
 Site-sketch                        | Train Loss: 0.8572 | Train Acc: 0.6694
Average Train Accuracy: 0.9214
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0888 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1406 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2388 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3632 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4380 | Val  Acc: 0.9043
 Site-sketch                        | Val  Loss: 0.7849 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9514
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.9565
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.9043
 Best site-sketch                    | Epoch:42 | Val Acc: 0.6625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0506 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0040 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2624 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.3129 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2000 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.5740 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.3804 | Train Acc: 0.9244
 Site-sketch                        | Train Loss: 0.8728 | Train Acc: 0.6942
Average Train Accuracy: 0.9381
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0786 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1194 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2086 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.3429 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4717 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.8300 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9385
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0319 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0102 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3531 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2799 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.1699 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.4961 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.3445 | Train Acc: 0.9535
 Site-sketch                        | Train Loss: 0.9265 | Train Acc: 0.7190
Average Train Accuracy: 0.9356
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1088 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1472 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2708 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3781 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.4362 | Val  Acc: 0.9043
 Site-sketch                        | Val  Loss: 0.9193 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9474
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0295 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0135 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3124 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2714 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2092 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.6264 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.3641 | Train Acc: 0.9302
 Site-sketch                        | Train Loss: 0.8859 | Train Acc: 0.6694
Average Train Accuracy: 0.9365
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0815 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1297 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2072 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.3660 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.3940 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 0.8863 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9450
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0555 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2826 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.3199 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2166 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6715 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3528 | Train Acc: 0.9419
 Site-sketch                        | Train Loss: 0.9335 | Train Acc: 0.7190
Average Train Accuracy: 0.9335
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0105 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1156 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1576 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2394 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3651 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4520 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.8342 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9529
 Best site-photo                     | Epoch:46 | Val Acc: 1.0000
 Best site-photo                     | Epoch:46 | Val Acc: 1.0000
 Best site-photo                     | Epoch:46 | Val Acc: 1.0000
 Best site-photo                     | Epoch:46 | Val Acc: 1.0000
 Best site-photo                     | Epoch:46 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:46 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:46 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:46 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:46 | Val Acc: 0.9565
 Best site-cartoon                   | Epoch:46 | Val Acc: 0.8957
 Best site-sketch                    | Epoch:46 | Val Acc: 0.6875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_2/harmo-fl...
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0388 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0139 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0095 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2307 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.2673 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2115 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.6069 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.3377 | Train Acc: 0.9186
 Site-sketch                        | Train Loss: 0.9471 | Train Acc: 0.6860
Average Train Accuracy: 0.9337
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0064 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1282 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1424 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1841 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3345 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.5199 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.9351 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9417
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0523 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3259 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.2757 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1746 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.7388 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3671 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.8920 | Train Acc: 0.7190
Average Train Accuracy: 0.9332
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1527 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2184 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1825 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.3563 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4280 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.8518 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9430
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0318 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0177 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0078 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3286 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2819 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1902 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.7205 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.3551 | Train Acc: 0.9477
 Site-sketch                        | Train Loss: 0.8837 | Train Acc: 0.6777
Average Train Accuracy: 0.9230
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1063 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1105 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1951 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.4323 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4656 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 0.9391 | Val  Acc: 0.6000
Average Valid Accuracy: 0.9326
===2023-08-11 04:20:59===
===2023-08-11 04:21:13===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:46 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:46 | Test Acc: 0.9172
 Test site-cartoon                   | Epoch:46 | Test Acc: 0.8255
 Test site-sketch                    | Epoch:46 | Test Acc: 0.6150
photo: 0.9985, art_painting: 0.9172, cartoon: 0.8255, sketch: 0.6150, 
Average Test Accuracy(group): 0.8391, Average Test Accuracy(individual): 0.9100,
domain std=0.1431, cluster std=-1.0000, individual std=0.1131, 
