===2023-03-23 22:37:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8028 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.8223 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.7383 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.7917 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.0682 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 2.1352 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0863 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.8636 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.0949 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.2063 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 1.7479 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.7366 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.8150 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.7696 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 2.0974 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.1408 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 1.8639 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.2511 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4027
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3243
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4610 | Train Acc: 0.6757
 Site-MNIST     | Train Loss: 1.4814 | Train Acc: 0.6126
 Site-MNIST     | Train Loss: 1.4100 | Train Acc: 0.7027
 Site-MNIST     | Train Loss: 1.4345 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 1.8663 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 1.9780 | Train Acc: 0.4144
 Site-SVHN      | Train Loss: 1.9223 | Train Acc: 0.3964
 Site-USPS      | Train Loss: 1.5353 | Train Acc: 0.6847
 Site-SynthDigits| Train Loss: 1.8785 | Train Acc: 0.4414
 Site-MNIST-M   | Train Loss: 2.1460 | Train Acc: 0.1802
 Site-MNIST     | Val  Loss: 1.3822 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 1.3990 | Val  Acc: 0.6622
 Site-MNIST     | Val  Loss: 1.5010 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.4256 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 1.9054 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.9904 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.8750 | Val  Acc: 0.5405
 Site-USPS      | Val  Loss: 1.5693 | Val  Acc: 0.6622
 Site-SynthDigits| Val  Loss: 1.8750 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 2.1937 | Val  Acc: 0.1622
Average Valid Accuracy: 0.5446
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6622
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5405
 Best site-USPS       | Epoch:1 | Val Acc: 0.6622
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1590 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 1.2510 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 1.1214 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 1.1340 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 1.7640 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 1.8518 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 1.7634 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 1.3098 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 1.7351 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 2.0624 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.1054 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 1.1065 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 1.2296 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 1.1422 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.7681 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.8752 | Val  Acc: 0.3919
 Site-SVHN      | Val  Loss: 1.7472 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.3687 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7472 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.1552 | Val  Acc: 0.1351
Average Valid Accuracy: 0.6243
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3919
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5811
 Best site-USPS       | Epoch:2 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 1.0316 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 1.1199 | Train Acc: 0.7658
 Site-MNIST     | Train Loss: 1.0057 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.9930 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 1.5764 | Train Acc: 0.5405
 Site-SVHN      | Train Loss: 1.7322 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.6217 | Train Acc: 0.4775
 Site-USPS      | Train Loss: 1.1172 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 1.5852 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 1.9890 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 0.9662 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.9927 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 1.1129 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 1.0235 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 1.6271 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.7635 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.6055 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.2095 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.6055 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 2.1179 | Val  Acc: 0.1622
Average Valid Accuracy: 0.6338
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5676
 Best site-USPS       | Epoch:3 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.8137 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.9294 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 0.8084 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.8160 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 1.5303 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.6930 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 1.5790 | Train Acc: 0.4955
 Site-USPS      | Train Loss: 1.0237 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.5440 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.9323 | Train Acc: 0.2793
 Site-MNIST     | Val  Loss: 0.7877 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.7887 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.9212 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.8330 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.5635 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.7086 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.5420 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.1062 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.5420 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0891 | Val  Acc: 0.1892
Average Valid Accuracy: 0.6662
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:4 | Val Acc: 0.6216
 Best site-USPS       | Epoch:4 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.8043 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.9206 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.7763 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.8284 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.4265 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.5782 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 1.4969 | Train Acc: 0.5495
 Site-USPS      | Train Loss: 0.8428 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.4680 | Train Acc: 0.5766
 Site-MNIST-M   | Train Loss: 1.8837 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 0.7406 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.7867 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.8887 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.8196 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 1.4900 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.6569 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.4897 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 0.9166 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.4897 | Val  Acc: 0.6081
 Site-MNIST-M   | Val  Loss: 2.0617 | Val  Acc: 0.2027
Average Valid Accuracy: 0.6784
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6081
 Best site-USPS       | Epoch:5 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6081
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.6679 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.7991 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.6042 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.6656 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.3321 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.5230 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.3665 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 0.8801 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.3344 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.8483 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.6224 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.6208 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.7528 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.6761 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.3805 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.5598 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.3633 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.9661 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.3633 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 2.0433 | Val  Acc: 0.2297
Average Valid Accuracy: 0.6973
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6351
 Best site-USPS       | Epoch:6 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5908 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.6768 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.5434 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.5826 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.2961 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.4612 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.3791 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.8168 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.3167 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 1.8382 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 0.5661 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5654 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6983 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.6269 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.3747 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.5611 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.3566 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 0.9204 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.3566 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 2.0285 | Val  Acc: 0.2703
Average Valid Accuracy: 0.7014
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6486
 Best site-USPS       | Epoch:7 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5434 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.6237 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.5335 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.5409 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.2770 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.4666 | Train Acc: 0.5405
 Site-SVHN      | Train Loss: 1.3039 | Train Acc: 0.6306
 Site-USPS      | Train Loss: 0.8016 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.2790 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 1.7517 | Train Acc: 0.4144
 Site-MNIST     | Val  Loss: 0.5141 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5155 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6438 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.5792 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.3307 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 1.5297 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.3152 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 0.8853 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.3152 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 2.0054 | Val  Acc: 0.3243
Average Valid Accuracy: 0.7095
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6486
 Best site-USPS       | Epoch:8 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.5108 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.6260 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.5045 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.5263 | Train Acc: 0.8919
 Site-SVHN      | Train Loss: 1.1198 | Train Acc: 0.7297
 Site-SVHN      | Train Loss: 1.3199 | Train Acc: 0.6126
 Site-SVHN      | Train Loss: 1.2114 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 0.7327 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.1440 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 1.7741 | Train Acc: 0.3874
 Site-MNIST     | Val  Loss: 0.4770 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4759 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6078 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.5438 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.2169 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 1.4172 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.1765 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 0.8496 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.1765 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 2.0016 | Val  Acc: 0.3378
Average Valid Accuracy: 0.7432
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6892
 Best site-USPS       | Epoch:9 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
===2023-03-23 23:04:55===
===2023-03-23 23:04:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8329
 Test site-SVHN      | Epoch:9 | Test Acc: 0.5079
 Test site-USPS      | Epoch:9 | Test Acc: 0.8065
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5079
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3214
Average Test Accuracy: 0.5953
===2023-03-23 23:14:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 23:14:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
===2023-03-23 23:14:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 23:14:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 23:19:27===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 23:20:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 23:22:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 23:22:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 23:23:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 23:30:28===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8028 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.8223 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.7383 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.7917 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.0682 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 2.1352 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0863 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.8636 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.0949 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.2063 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 1.7479 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.7366 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.8150 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.7696 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 2.0974 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.1408 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 1.8639 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.2511 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4027
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3243
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4542 | Train Acc: 0.6757
 Site-MNIST     | Train Loss: 1.4732 | Train Acc: 0.6126
 Site-MNIST     | Train Loss: 1.4018 | Train Acc: 0.7387
 Site-MNIST     | Train Loss: 1.4266 | Train Acc: 0.7297
 Site-SVHN      | Train Loss: 1.8740 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.9799 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.9260 | Train Acc: 0.3874
 Site-USPS      | Train Loss: 1.5287 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 1.8863 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.1481 | Train Acc: 0.1802
 Site-MNIST     | Val  Loss: 1.3750 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 1.3896 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.4924 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.4168 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 1.9067 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.9931 | Val  Acc: 0.3108
 Site-SVHN      | Val  Loss: 1.8805 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.5642 | Val  Acc: 0.6622
 Site-SynthDigits| Val  Loss: 1.8805 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.1968 | Val  Acc: 0.1622
Average Valid Accuracy: 0.5378
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3108
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5000
 Best site-USPS       | Epoch:1 | Val Acc: 0.6622
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1585 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 1.2471 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 1.1213 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 1.1309 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 1.7582 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 1.8578 | Train Acc: 0.4775
 Site-SVHN      | Train Loss: 1.7633 | Train Acc: 0.4414
 Site-USPS      | Train Loss: 1.3076 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 1.7301 | Train Acc: 0.4685
 Site-MNIST-M   | Train Loss: 2.0599 | Train Acc: 0.2072
 Site-MNIST     | Val  Loss: 1.1005 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 1.1075 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 1.2233 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 1.1380 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.7640 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.8831 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.7457 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.3652 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 1.7457 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 2.1559 | Val  Acc: 0.1351
Average Valid Accuracy: 0.6216
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5676
 Best site-USPS       | Epoch:2 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 15 ============
============ Train epoch 16 ============
===2023-03-24 10:07:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8028 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.8223 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.7383 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.7917 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.0682 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 2.1352 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0863 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.8636 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.0949 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.2063 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 1.7479 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.7366 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.8150 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.7696 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 2.0974 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.1408 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 1.8639 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.2511 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4027
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3243
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4344 | Train Acc: 0.6847
 Site-MNIST     | Train Loss: 1.4549 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.3836 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 1.4091 | Train Acc: 0.7387
 Site-SVHN      | Train Loss: 1.8799 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.9827 | Train Acc: 0.3964
 Site-SVHN      | Train Loss: 1.9278 | Train Acc: 0.4144
 Site-USPS      | Train Loss: 1.5318 | Train Acc: 0.6937
 Site-SynthDigits| Train Loss: 1.8925 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.1409 | Train Acc: 0.1892
 Site-MNIST     | Val  Loss: 1.3612 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 1.3682 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 1.4753 | Val  Acc: 0.6351
 Site-MNIST     | Val  Loss: 1.3937 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 1.9099 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.9944 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.8818 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.5690 | Val  Acc: 0.6757
 Site-SynthDigits| Val  Loss: 1.8818 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.1955 | Val  Acc: 0.1757
Average Valid Accuracy: 0.5608
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6351
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5000
 Best site-USPS       | Epoch:1 | Val Acc: 0.6757
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1963 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 1.2896 | Train Acc: 0.6937
 Site-MNIST     | Train Loss: 1.1704 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 1.1689 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 1.7309 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.8471 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 1.7481 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 1.3028 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.7002 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 2.0673 | Train Acc: 0.1982
 Site-MNIST     | Val  Loss: 1.1370 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 1.1573 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 1.2686 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.1837 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.7545 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.8699 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.7283 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.3598 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7283 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 2.1523 | Val  Acc: 0.1486
Average Valid Accuracy: 0.6000
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5676
 Best site-USPS       | Epoch:2 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9718 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 1.0657 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 0.9449 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.9462 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 1.6203 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.7405 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.6535 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 1.1160 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 1.6281 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.9760 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 0.9185 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.9272 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 1.0557 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 0.9630 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.6465 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.7739 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.6289 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.2079 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 1.6289 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.1168 | Val  Acc: 0.1622
Average Valid Accuracy: 0.6392
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5811
 Best site-USPS       | Epoch:3 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.8828 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.9980 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 0.8925 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.8778 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 1.4712 | Train Acc: 0.5676
 Site-SVHN      | Train Loss: 1.6785 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.5360 | Train Acc: 0.4955
 Site-USPS      | Train Loss: 0.9999 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.4872 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 1.9458 | Train Acc: 0.2432
 Site-MNIST     | Val  Loss: 0.8416 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.8802 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.9883 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.9053 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 1.5261 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.6931 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.5082 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.0838 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.5082 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.0875 | Val  Acc: 0.1622
Average Valid Accuracy: 0.6514
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5811
 Best site-USPS       | Epoch:4 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.7669 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.8746 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.7066 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.7973 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 1.4358 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 1.5593 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.5055 | Train Acc: 0.5315
 Site-USPS      | Train Loss: 0.9578 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.4777 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.8665 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 0.7090 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.7119 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.8456 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.7705 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.5131 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.6349 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.4785 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.0364 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.4785 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0464 | Val  Acc: 0.2162
Average Valid Accuracy: 0.6878
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6216
 Best site-USPS       | Epoch:5 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.6723 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.7960 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.6193 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.6645 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 1.2668 | Train Acc: 0.6847
 Site-SVHN      | Train Loss: 1.4783 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.3329 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 0.8595 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.2641 | Train Acc: 0.6847
 Site-MNIST-M   | Train Loss: 1.8751 | Train Acc: 0.3153
 Site-MNIST     | Val  Loss: 0.6216 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.6344 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.7472 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.6764 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.3354 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 1.5010 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.3335 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.9563 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.3335 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0506 | Val  Acc: 0.2568
Average Valid Accuracy: 0.7081
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-USPS       | Epoch:6 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.6337 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.7198 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.5942 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.6221 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 1.2893 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.4659 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.3807 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 0.7837 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.3181 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.7954 | Train Acc: 0.3784
 Site-MNIST     | Val  Loss: 0.5943 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.6205 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.7424 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.6757 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.3767 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 1.5370 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.3935 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 0.8879 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.3935 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.9850 | Val  Acc: 0.3243
Average Valid Accuracy: 0.7068
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5293 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.6080 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.5295 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.5316 | Train Acc: 0.8919
 Site-SVHN      | Train Loss: 1.1782 | Train Acc: 0.6757
 Site-SVHN      | Train Loss: 1.3961 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 1.2258 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 0.7869 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.1787 | Train Acc: 0.6757
 Site-MNIST-M   | Train Loss: 1.7572 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 0.5000 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5132 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6219 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.5631 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.2642 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 1.4474 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.2301 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 0.8675 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.2301 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 2.0034 | Val  Acc: 0.3378
Average Valid Accuracy: 0.7351
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6486
 Best site-USPS       | Epoch:8 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.5512 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.6668 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.5503 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.5584 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 1.0278 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 1.2450 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.1614 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 0.7054 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.0443 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.6691 | Train Acc: 0.4505
 Site-MNIST     | Val  Loss: 0.5042 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5198 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.6480 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.6105 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.1533 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 1.3261 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 1.1416 | Val  Acc: 0.7432
 Site-USPS      | Val  Loss: 0.8255 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.1416 | Val  Acc: 0.7432
 Site-MNIST-M   | Val  Loss: 1.9088 | Val  Acc: 0.3649
Average Valid Accuracy: 0.7527
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7432
 Best site-USPS       | Epoch:9 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7432
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
===2023-03-24 10:34:39===
===2023-03-24 10:34:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8329
 Test site-SVHN      | Epoch:9 | Test Acc: 0.5079
 Test site-USPS      | Epoch:9 | Test Acc: 0.8065
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5079
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3214
Average Test Accuracy: 0.5953
===2023-03-24 10:42:52======2023-03-24 10:49:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7931 | Train Acc: 0.5856
 Site-MNIST     | Train Loss: 1.8153 | Train Acc: 0.5225
 Site-MNIST     | Train Loss: 1.7273 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.7822 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 2.0537 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 2.1292 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0786 | Train Acc: 0.2432
 Site-USPS      | Train Loss: 1.8416 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 2.0828 | Train Acc: 0.3423
 Site-MNIST-M   | Train Loss: 2.2077 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 1.7370 | Val  Acc: 0.6622
 Site-MNIST     | Val  Loss: 1.7298 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.8089 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.7619 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 2.0957 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.1388 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0639 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 1.8415 | Val  Acc: 0.5270
 Site-SynthDigits| Val  Loss: 2.0639 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.2569 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4176
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3108
 Best site-USPS       | Epoch:0 | Val Acc: 0.5270
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3982 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.4312 | Train Acc: 0.6216
 Site-MNIST     | Train Loss: 1.3408 | Train Acc: 0.7117
 Site-MNIST     | Train Loss: 1.3722 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 1.8351 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 1.9414 | Train Acc: 0.4144
 Site-SVHN      | Train Loss: 1.9047 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 1.4838 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.8425 | Train Acc: 0.4414
 Site-MNIST-M   | Train Loss: 2.1402 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.3116 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 1.3430 | Val  Acc: 0.6757
 Site-MNIST     | Val  Loss: 1.4688 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.3488 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 1.9016 | Val  Acc: 0.3784
 Site-SVHN      | Val  Loss: 1.9362 | Val  Acc: 0.3784
 Site-SVHN      | Val  Loss: 1.8442 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.5222 | Val  Acc: 0.6351
 Site-SynthDigits| Val  Loss: 1.8442 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.1928 | Val  Acc: 0.1892
Average Valid Accuracy: 0.5351
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6757
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3784
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3784
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5000
 Best site-USPS       | Epoch:1 | Val Acc: 0.6351
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0859 | Train Acc: 0.7477
 Site-MNIST     | Train Loss: 1.1944 | Train Acc: 0.7117
 Site-MNIST     | Train Loss: 1.0365 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 1.0521 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 1.6319 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.7211 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 1.6385 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 1.2322 | Train Acc: 0.7207
 Site-SynthDigits| Train Loss: 1.6033 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 2.0163 | Train Acc: 0.2523
 Site-MNIST     | Val  Loss: 1.0241 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 1.0362 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 1.1831 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.0614 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 1.6685 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7574 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.5936 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 1.2873 | Val  Acc: 0.7297
 Site-SynthDigits| Val  Loss: 1.5936 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 2.1310 | Val  Acc: 0.2162
Average Valid Accuracy: 0.6108
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5541
 Best site-USPS       | Epoch:2 | Val Acc: 0.7297
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7855 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.8909 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 0.7551 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.7698 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 1.4638 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.5812 | Train Acc: 0.4775
 Site-SVHN      | Train Loss: 1.5165 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.9612 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.4587 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.9183 | Train Acc: 0.3063
 Site-MNIST     | Val  Loss: 0.7417 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.7536 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.8792 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.7826 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.5254 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6435 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.4523 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 1.0589 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 1.4523 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 2.0488 | Val  Acc: 0.2432
Average Valid Accuracy: 0.6446
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5541
 Best site-USPS       | Epoch:3 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6447 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.7933 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 0.6449 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.6172 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 1.2472 | Train Acc: 0.5676
 Site-SVHN      | Train Loss: 1.4211 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.3164 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 0.7953 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 1.2717 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 1.8471 | Train Acc: 0.3604
 Site-MNIST     | Val  Loss: 0.6025 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6386 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.7838 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.6947 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.3157 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.4695 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.2211 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 0.9234 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.2211 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 2.0297 | Val  Acc: 0.2973
Average Valid Accuracy: 0.6824
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5946
 Best site-USPS       | Epoch:4 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4783 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.6310 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.4608 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.5051 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 0.9777 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 1.1872 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 1.1090 | Train Acc: 0.6216
 Site-USPS      | Train Loss: 0.6452 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.0206 | Train Acc: 0.7027
 Site-MNIST-M   | Train Loss: 1.6137 | Train Acc: 0.3964
 Site-MNIST     | Val  Loss: 0.4470 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.4795 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.5815 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.5336 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.1304 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 1.2939 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.0537 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.7750 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.0537 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.9250 | Val  Acc: 0.3378
Average Valid Accuracy: 0.7230
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6622
 Best site-USPS       | Epoch:5 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.3871 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.5020 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.3596 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.3520 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 0.7429 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 1.0013 | Train Acc: 0.6847
 Site-SVHN      | Train Loss: 0.8931 | Train Acc: 0.7748
 Site-USPS      | Train Loss: 0.5371 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.7426 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 1.5133 | Train Acc: 0.4955
 Site-MNIST     | Val  Loss: 0.3395 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3646 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4492 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.4394 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 0.9177 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.0756 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 0.8246 | Val  Acc: 0.7703
 Site-USPS      | Val  Loss: 0.6789 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 0.8246 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 1.8723 | Val  Acc: 0.3919
Average Valid Accuracy: 0.7905
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7703
 Best site-USPS       | Epoch:6 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2526 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.2653 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.2043 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.2330 | Train Acc: 0.9459
 Site-SVHN      | Train Loss: 0.6205 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 0.8932 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 0.7982 | Train Acc: 0.7748
 Site-USPS      | Train Loss: 0.4296 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.6333 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 1.3397 | Train Acc: 0.5405
 Site-MNIST     | Val  Loss: 0.2143 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.2136 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.2594 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2666 | Val  Acc: 0.9324
 Site-SVHN      | Val  Loss: 0.8268 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 0.9855 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 0.7378 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.6081 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.7378 | Val  Acc: 0.7973
 Site-MNIST-M   | Val  Loss: 1.7962 | Val  Acc: 0.4189
Average Valid Accuracy: 0.8230
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9324
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7973
 Best site-USPS       | Epoch:7 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7973
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.2244 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.2658 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.2113 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.1926 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 0.4338 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 0.7482 | Train Acc: 0.8018
 Site-SVHN      | Train Loss: 0.6060 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.4065 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.4208 | Train Acc: 0.9640
 Site-MNIST-M   | Train Loss: 1.2159 | Train Acc: 0.5946
 Site-MNIST     | Val  Loss: 0.1748 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1922 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.2576 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.2790 | Val  Acc: 0.9324
 Site-SVHN      | Val  Loss: 0.6748 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 0.8354 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 0.5268 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.5942 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.5268 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 1.8653 | Val  Acc: 0.4054
Average Valid Accuracy: 0.8486
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9324
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8919
 Best site-USPS       | Epoch:8 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1686 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.2198 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.1429 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1477 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.3202 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 0.6005 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 0.5514 | Train Acc: 0.8468
 Site-USPS      | Train Loss: 0.3394 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.3256 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 0.9381 | Train Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.1153 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1396 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1965 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.1804 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.5886 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 0.7085 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 0.4241 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.5589 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4241 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 1.6992 | Val  Acc: 0.5541
Average Valid Accuracy: 0.8878
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:9 | Val Acc: 0.9324
 Best site-USPS       | Epoch:9 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_alignonce/FedPrompt_lsim=False...
===2023-03-24 11:31:08===
===2023-03-24 11:33:02===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-24 11:33:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8836
 Test site-SVHN      | Epoch:9 | Test Acc: 0.6530
 Test site-USPS      | Epoch:9 | Test Acc: 0.7903
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6530
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3757
Average Test Accuracy: 0.6711
