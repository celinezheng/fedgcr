===2023-03-26 17:55:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0014 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.8997 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 2.1979 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.1259 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 1.9347 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.8918 | Train Acc: 0.5079
 Site-Real      | Train Loss: 1.7828 | Train Acc: 0.6032
 Site-Real      | Train Loss: 1.8787 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.8719 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 1.9810 | Train Acc: 0.4127
 Site-Clipart   | Val  Loss: 1.9309 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9384 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1201 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1515 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.8168 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0453 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.8320 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 1.8789 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.9264 | Val  Acc: 0.4762
 Site-Sketch    | Val  Loss: 2.0010 | Val  Acc: 0.4524
Average Valid Accuracy: 0.4381
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Painting   | Epoch:0 | Val Acc: 0.5000
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-Real       | Epoch:0 | Val Acc: 0.5714
 Best site-Real       | Epoch:0 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6513 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.6663 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 2.0943 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.9838 | Train Acc: 0.3651
 Site-Painting  | Train Loss: 1.4837 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.4821 | Train Acc: 0.6984
 Site-Real      | Train Loss: 1.3139 | Train Acc: 0.7937
 Site-Real      | Train Loss: 1.3927 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.4517 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.6188 | Train Acc: 0.5079
 Site-Clipart   | Val  Loss: 1.7067 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.7074 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0568 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1961 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 1.3575 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.7090 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 1.3576 | Val  Acc: 0.7857
 Site-Real      | Val  Loss: 1.4553 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.6432 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.6234 | Val  Acc: 0.5476
Average Valid Accuracy: 0.5595
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-Painting   | Epoch:1 | Val Acc: 0.7857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2959 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3601 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.8849 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.7002 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.0268 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 1.0725 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.9007 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.8687 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 1.1429 | Train Acc: 0.6825
 Site-Sketch    | Train Loss: 1.1863 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.3759 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2605 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.6680 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9544 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.9075 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.2810 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.8811 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.9153 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.1840 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.2682 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7238
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.6905
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1250 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1193 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.8980 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.6579 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 0.8141 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.8644 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.6502 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.6335 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8865 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9355 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 1.2857 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.0783 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5187 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 2.0122 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 0.7781 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.0728 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.5444 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.6785 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.0008 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 0.9969 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7143
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.9550 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.0293 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 1.7262 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5558 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 0.7128 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.7131 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.4627 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.4141 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7127 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.7934 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.1204 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9624 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3653 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7740 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 0.6081 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.8715 | Val  Acc: 0.7619
 Site-Real      | Val  Loss: 0.3908 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.5054 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8605 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 0.8373 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7476
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2857
 Best site-Painting   | Epoch:4 | Val Acc: 0.9286
 Best site-Painting   | Epoch:4 | Val Acc: 0.7619
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Real       | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.7469 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8203 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.7435 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.3924 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.4997 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.5717 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.3542 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.3231 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6297 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6104 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.7471 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8645 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2399 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7077 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.5050 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.6762 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 0.2849 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3503 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6838 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.6513 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8167
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.7158 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7569 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.3500 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.1181 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5299 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4172 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.3113 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.2601 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5611 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.5353 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6127 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6760 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0198 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4287 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.2407 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5574 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 0.2023 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2891 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5048 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 0.4274 | Val  Acc: 0.9524
Average Valid Accuracy: 0.8262
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.5002 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5962 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.3229 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0713 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.3815 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3935 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.2884 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.2000 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3753 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.4242 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6617 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6470 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.8654 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2619 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.3085 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3843 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.1632 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1718 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4905 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.4462 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8643
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9286
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3953 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4424 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.2421 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0374 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.2634 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.2949 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1556 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1176 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3098 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2649 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.5102 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5129 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9152 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2606 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.2135 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3321 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.1342 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1346 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2815 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3131 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8738
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4762
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.4317 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.3701 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2662 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 0.8477 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2247 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2578 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2111 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1172 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2637 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2431 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.4461 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4237 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8027 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1371 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.1761 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2897 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.0953 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1613 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2619 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.2771 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8952
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6429
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-Painting   | Epoch:9 | Val Acc: 0.9286
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
===2023-03-26 18:23:11===
===2023-03-26 18:23:13===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 3
Loading snapshots...
Test Accuracy of QuickDraw: 0.2680
Average Test Accuracy: 0.2680
===2023-03-27 23:38:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.9862 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9014 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 2.1982 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.1387 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 1.9180 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.8669 | Train Acc: 0.5079
 Site-Real      | Train Loss: 1.7371 | Train Acc: 0.6190
 Site-Real      | Train Loss: 1.8627 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8398 | Train Acc: 0.6349
 Site-Sketch    | Train Loss: 1.9633 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9269 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9541 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1297 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1710 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.8088 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 2.0358 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.8235 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 1.8259 | Val  Acc: 0.5952
 Site-Sketch    | Val  Loss: 1.9095 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 1.9603 | Val  Acc: 0.4762
Average Valid Accuracy: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Painting   | Epoch:0 | Val Acc: 0.5238
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-Real       | Epoch:0 | Val Acc: 0.5476
 Best site-Real       | Epoch:0 | Val Acc: 0.5952
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6091 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.5799 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 2.1153 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 1.9619 | Train Acc: 0.3651
 Site-Painting  | Train Loss: 1.4420 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.3974 | Train Acc: 0.7460
 Site-Real      | Train Loss: 1.1827 | Train Acc: 0.9048
 Site-Real      | Train Loss: 1.2742 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.3844 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.4977 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6162 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6524 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 2.0339 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1718 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.2541 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.5743 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 1.2296 | Val  Acc: 0.7619
 Site-Real      | Val  Loss: 1.2984 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5474 | Val  Acc: 0.5952
 Site-Sketch    | Val  Loss: 1.5267 | Val  Acc: 0.5714
Average Valid Accuracy: 0.5881
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.8571
 Best site-Painting   | Epoch:1 | Val Acc: 0.5714
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5952
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2257 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.2814 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.8400 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.6358 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.9301 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.9725 | Train Acc: 0.7937
 Site-Real      | Train Loss: 0.8115 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.7606 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 1.0756 | Train Acc: 0.6825
 Site-Sketch    | Train Loss: 1.0971 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.3051 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1730 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6328 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.8997 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.7988 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 1.1561 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 0.7626 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.8016 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.1238 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.1791 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7310
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Painting   | Epoch:2 | Val Acc: 0.9048
 Best site-Painting   | Epoch:2 | Val Acc: 0.8095
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9547 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9585 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.7975 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.5599 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 0.6676 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.7264 | Train Acc: 0.8254
 Site-Real      | Train Loss: 0.5013 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.4965 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.6939 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.7686 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 1.1090 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 0.9381 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3812 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.8829 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.6414 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.9368 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.4321 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.4977 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.8473 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.8932 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.9048
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-Real       | Epoch:3 | Val Acc: 0.9762
 Best site-Real       | Epoch:3 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7262 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8246 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.5755 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.3661 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5161 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.5797 | Train Acc: 0.8413
 Site-Real      | Train Loss: 0.3603 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2983 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.5526 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6686 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.9216 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 0.7713 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1788 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5952 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.4602 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.6578 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 0.3011 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4137 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6696 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7300 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7905
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.9286
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.5366 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6467 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.5617 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.2374 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.3627 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.4199 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2559 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.2529 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5022 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.4861 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.6226 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6949 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0570 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5831 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.3838 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5008 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.2130 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2197 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5725 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5443 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8429
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4048
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4471 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5166 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.1271 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9041 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.3224 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.2950 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.2478 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1888 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4027 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.3979 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4448 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4099 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8324 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2244 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.1788 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3495 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.1561 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2172 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3410 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.3453 | Val  Acc: 0.9524
Average Valid Accuracy: 0.8905
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Painting   | Epoch:6 | Val Acc: 0.9762
 Best site-Painting   | Epoch:6 | Val Acc: 0.9048
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3271 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4731 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.1588 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9611 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.2803 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.2606 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2025 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1247 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2847 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3490 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.5930 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4367 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.9357 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2502 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.1810 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2718 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.1206 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1016 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3709 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3848 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8667
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2831 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2671 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0972 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.8434 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.1672 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2087 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1071 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.0991 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2147 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2170 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.3102 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3367 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.7635 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0540 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.1759 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2228 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.1043 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0840 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2154 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2340 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9143
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6429
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_QuickDraw...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3129 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3407 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2334 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.8268 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.1619 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1965 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1288 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.0973 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2529 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2303 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.3800 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3613 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.7629 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.2563 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.1145 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2340 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.0826 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0766 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3131 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.2484 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8976
===2023-03-28 00:05:57===
===2023-03-28 00:05:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of QuickDraw: 0.2720
Average Test Accuracy: 0.2720
