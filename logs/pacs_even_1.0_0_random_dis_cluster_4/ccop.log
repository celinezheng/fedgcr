===2023-08-13 18:47:57===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (3) | Train Loss: 1.6387 | Train Acc: 0.3133
 Site-photo                     (3) | Train Loss: 1.6599 | Train Acc: 0.3756
 Site-art_painting              (1) | Train Loss: 1.7511 | Train Acc: 0.3267
 Site-art_painting              (1) | Train Loss: 1.7672 | Train Acc: 0.2822
 Site-cartoon                   (2) | Train Loss: 1.7945 | Train Acc: 0.2333
 Site-cartoon                   (2) | Train Loss: 1.7504 | Train Acc: 0.2533
 Site-sketch                    (0) | Train Loss: 1.7671 | Train Acc: 0.2800
 Site-sketch                    (0) | Train Loss: 1.8350 | Train Acc: 0.2511
Average Train Accuracy: 0.2894
 Site-photo                     (3) | Val  Loss: 1.6898 | Val  Acc: 0.3000
 Site-photo                     (3) | Val  Loss: 1.6975 | Val  Acc: 0.3233
 Site-art_painting              (1) | Val  Loss: 1.8142 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.7577 | Val  Acc: 0.3333
 Site-cartoon                   (2) | Val  Loss: 1.7730 | Val  Acc: 0.2700
 Site-cartoon                   (2) | Val  Loss: 1.7749 | Val  Acc: 0.2533
 Site-sketch                    (0) | Val  Loss: 1.8021 | Val  Acc: 0.2500
 Site-sketch                    (0) | Val  Loss: 1.8223 | Val  Acc: 0.2300
Average Valid Accuracy: 0.2762
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.3000
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.3233
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.2700
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.2533
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.2300
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (0) | Train Loss: 1.4768 | Train Acc: 0.5933
 Site-photo                     (0) | Train Loss: 1.4038 | Train Acc: 0.6356
 Site-art_painting              (3) | Train Loss: 1.6523 | Train Acc: 0.4200
 Site-art_painting              (3) | Train Loss: 1.6442 | Train Acc: 0.4622
 Site-cartoon                   (2) | Train Loss: 1.6295 | Train Acc: 0.3800
 Site-cartoon                   (2) | Train Loss: 1.6508 | Train Acc: 0.4556
 Site-sketch                    (1) | Train Loss: 1.6180 | Train Acc: 0.3000
 Site-sketch                    (1) | Train Loss: 1.6632 | Train Acc: 0.3044
Average Train Accuracy: 0.4439
 Site-photo                     (0) | Val  Loss: 1.3713 | Val  Acc: 0.6500
 Site-photo                     (0) | Val  Loss: 1.4299 | Val  Acc: 0.6633
 Site-art_painting              (3) | Val  Loss: 1.5923 | Val  Acc: 0.4600
 Site-art_painting              (3) | Val  Loss: 1.6038 | Val  Acc: 0.5067
 Site-cartoon                   (2) | Val  Loss: 1.6693 | Val  Acc: 0.4000
 Site-cartoon                   (2) | Val  Loss: 1.6569 | Val  Acc: 0.4067
 Site-sketch                    (1) | Val  Loss: 1.6431 | Val  Acc: 0.3300
 Site-sketch                    (1) | Val  Loss: 1.6632 | Val  Acc: 0.3033
Average Valid Accuracy: 0.4650
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6500
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6633
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.4600
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.5067
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.4000
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.4067
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.3300
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.3033
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 1.0948 | Train Acc: 0.8533
 Site-photo                     (0) | Train Loss: 1.0464 | Train Acc: 0.8267
 Site-art_painting              (3) | Train Loss: 1.4022 | Train Acc: 0.5733
 Site-art_painting              (3) | Train Loss: 1.3566 | Train Acc: 0.6133
 Site-cartoon                   (2) | Train Loss: 1.3708 | Train Acc: 0.6000
 Site-cartoon                   (2) | Train Loss: 1.4328 | Train Acc: 0.5556
 Site-sketch                    (1) | Train Loss: 1.5452 | Train Acc: 0.4133
 Site-sketch                    (1) | Train Loss: 1.5954 | Train Acc: 0.4400
Average Train Accuracy: 0.6094
 Site-photo                     (0) | Val  Loss: 1.0453 | Val  Acc: 0.8300
 Site-photo                     (0) | Val  Loss: 1.1147 | Val  Acc: 0.8200
 Site-art_painting              (3) | Val  Loss: 1.3538 | Val  Acc: 0.6100
 Site-art_painting              (3) | Val  Loss: 1.3876 | Val  Acc: 0.6500
 Site-cartoon                   (2) | Val  Loss: 1.4020 | Val  Acc: 0.5600
 Site-cartoon                   (2) | Val  Loss: 1.3967 | Val  Acc: 0.5800
 Site-sketch                    (1) | Val  Loss: 1.5734 | Val  Acc: 0.5200
 Site-sketch                    (1) | Val  Loss: 1.5855 | Val  Acc: 0.4600
Average Valid Accuracy: 0.6288
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8300
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8200
 Best site-art_painting             (3)  | Epoch:2 | Val Acc: 0.6100
 Best site-art_painting             (3)  | Epoch:2 | Val Acc: 0.6500
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.5600
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.5800
 Best site-sketch                   (1)  | Epoch:2 | Val Acc: 0.5200
 Best site-sketch                   (1)  | Epoch:2 | Val Acc: 0.4600
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (3) | Train Loss: 0.9405 | Train Acc: 0.8867
 Site-photo                     (3) | Train Loss: 0.9919 | Train Acc: 0.9267
 Site-art_painting              (0) | Train Loss: 1.3355 | Train Acc: 0.6267
 Site-art_painting              (0) | Train Loss: 1.1506 | Train Acc: 0.7244
 Site-cartoon                   (2) | Train Loss: 1.3032 | Train Acc: 0.6333
 Site-cartoon                   (2) | Train Loss: 1.2037 | Train Acc: 0.6778
 Site-sketch                    (1) | Train Loss: 1.4483 | Train Acc: 0.5867
 Site-sketch                    (1) | Train Loss: 1.5055 | Train Acc: 0.5267
Average Train Accuracy: 0.6986
 Site-photo                     (3) | Val  Loss: 0.8274 | Val  Acc: 0.9300
 Site-photo                     (3) | Val  Loss: 0.9162 | Val  Acc: 0.9233
 Site-art_painting              (0) | Val  Loss: 1.1522 | Val  Acc: 0.7700
 Site-art_painting              (0) | Val  Loss: 1.1694 | Val  Acc: 0.7467
 Site-cartoon                   (2) | Val  Loss: 1.2615 | Val  Acc: 0.6400
 Site-cartoon                   (2) | Val  Loss: 1.2605 | Val  Acc: 0.6700
 Site-sketch                    (1) | Val  Loss: 1.4621 | Val  Acc: 0.5200
 Site-sketch                    (1) | Val  Loss: 1.4595 | Val  Acc: 0.4633
Average Valid Accuracy: 0.7079
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.9300
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.9233
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.7700
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.7467
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.6400
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.6700
 Best site-sketch                   (1)  | Epoch:3 | Val Acc: 0.5200
 Best site-sketch                   (1)  | Epoch:3 | Val Acc: 0.4633
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (3) | Train Loss: 0.8017 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.7921 | Train Acc: 0.9489
 Site-art_painting              (2) | Train Loss: 1.1532 | Train Acc: 0.7267
 Site-art_painting              (2) | Train Loss: 1.0114 | Train Acc: 0.8267
 Site-cartoon                   (0) | Train Loss: 1.0888 | Train Acc: 0.7000
 Site-cartoon                   (0) | Train Loss: 1.1046 | Train Acc: 0.7200
 Site-sketch                    (1) | Train Loss: 1.2531 | Train Acc: 0.6200
 Site-sketch                    (1) | Train Loss: 1.2827 | Train Acc: 0.5400
Average Train Accuracy: 0.7519
 Site-photo                     (3) | Val  Loss: 0.6822 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.7611 | Val  Acc: 0.9500
 Site-art_painting              (2) | Val  Loss: 0.9678 | Val  Acc: 0.8300
 Site-art_painting              (2) | Val  Loss: 1.0053 | Val  Acc: 0.8233
 Site-cartoon                   (0) | Val  Loss: 1.1307 | Val  Acc: 0.6500
 Site-cartoon                   (0) | Val  Loss: 1.0972 | Val  Acc: 0.7433
 Site-sketch                    (1) | Val  Loss: 1.3139 | Val  Acc: 0.5900
 Site-sketch                    (1) | Val  Loss: 1.2836 | Val  Acc: 0.5933
Average Valid Accuracy: 0.7662
 Best site-photo                    (3)  | Epoch:4 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:4 | Val Acc: 0.9500
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.8300
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.8233
 Best site-cartoon                  (0)  | Epoch:4 | Val Acc: 0.6500
 Best site-cartoon                  (0)  | Epoch:4 | Val Acc: 0.7433
 Best site-sketch                   (1)  | Epoch:4 | Val Acc: 0.5900
 Best site-sketch                   (1)  | Epoch:4 | Val Acc: 0.5933
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (3) | Train Loss: 0.6490 | Train Acc: 0.9267
 Site-photo                     (3) | Train Loss: 0.6214 | Train Acc: 0.9578
 Site-art_painting              (1) | Train Loss: 0.9519 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 0.9788 | Train Acc: 0.8289
 Site-cartoon                   (2) | Train Loss: 0.9978 | Train Acc: 0.6800
 Site-cartoon                   (2) | Train Loss: 0.9948 | Train Acc: 0.7578
 Site-sketch                    (0) | Train Loss: 1.0910 | Train Acc: 0.6533
 Site-sketch                    (0) | Train Loss: 1.0994 | Train Acc: 0.6222
Average Train Accuracy: 0.7783
 Site-photo                     (3) | Val  Loss: 0.5556 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.6437 | Val  Acc: 0.9600
 Site-art_painting              (1) | Val  Loss: 0.8321 | Val  Acc: 0.8600
 Site-art_painting              (1) | Val  Loss: 0.8775 | Val  Acc: 0.8467
 Site-cartoon                   (2) | Val  Loss: 1.0114 | Val  Acc: 0.7200
 Site-cartoon                   (2) | Val  Loss: 0.9734 | Val  Acc: 0.7567
 Site-sketch                    (0) | Val  Loss: 1.1655 | Val  Acc: 0.6400
 Site-sketch                    (0) | Val  Loss: 1.1780 | Val  Acc: 0.5867
Average Valid Accuracy: 0.7900
 Best site-photo                    (3)  | Epoch:5 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:5 | Val Acc: 0.9600
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.8600
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.8467
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.7200
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.7567
 Best site-sketch                   (0)  | Epoch:5 | Val Acc: 0.6400
 Best site-sketch                   (0)  | Epoch:5 | Val Acc: 0.5867
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (2) | Train Loss: 0.5436 | Train Acc: 0.9667
 Site-photo                     (2) | Train Loss: 0.4935 | Train Acc: 0.9578
 Site-art_painting              (2) | Train Loss: 0.9242 | Train Acc: 0.7733
 Site-art_painting              (2) | Train Loss: 0.7978 | Train Acc: 0.8533
 Site-cartoon                   (0) | Train Loss: 1.0012 | Train Acc: 0.7000
 Site-cartoon                   (0) | Train Loss: 0.8597 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.9323 | Train Acc: 0.7200
 Site-sketch                    (3) | Train Loss: 1.0273 | Train Acc: 0.6378
Average Train Accuracy: 0.7994
 Site-photo                     (2) | Val  Loss: 0.4739 | Val  Acc: 0.9600
 Site-photo                     (2) | Val  Loss: 0.5493 | Val  Acc: 0.9533
 Site-art_painting              (2) | Val  Loss: 0.7268 | Val  Acc: 0.8600
 Site-art_painting              (2) | Val  Loss: 0.7651 | Val  Acc: 0.8567
 Site-cartoon                   (0) | Val  Loss: 0.8801 | Val  Acc: 0.7300
 Site-cartoon                   (0) | Val  Loss: 0.8365 | Val  Acc: 0.8067
 Site-sketch                    (1) | Val  Loss: 1.0733 | Val  Acc: 0.6400
 Site-sketch                    (3) | Val  Loss: 1.0104 | Val  Acc: 0.6533
Average Valid Accuracy: 0.8075
 Best site-photo                    (2)  | Epoch:6 | Val Acc: 0.9600
 Best site-photo                    (2)  | Epoch:6 | Val Acc: 0.9533
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.8600
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.8567
 Best site-cartoon                  (0)  | Epoch:6 | Val Acc: 0.7300
 Best site-cartoon                  (0)  | Epoch:6 | Val Acc: 0.8067
 Best site-sketch                   (1)  | Epoch:6 | Val Acc: 0.6400
 Best site-sketch                   (3)  | Epoch:6 | Val Acc: 0.6533
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (3) | Train Loss: 0.4777 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.4350 | Train Acc: 0.9578
 Site-art_painting              (3) | Train Loss: 0.8631 | Train Acc: 0.8067
 Site-art_painting              (1) | Train Loss: 0.7196 | Train Acc: 0.8467
 Site-cartoon                   (2) | Train Loss: 0.8335 | Train Acc: 0.7067
 Site-cartoon                   (2) | Train Loss: 0.7360 | Train Acc: 0.8244
 Site-sketch                    (0) | Train Loss: 0.9137 | Train Acc: 0.6867
 Site-sketch                    (0) | Train Loss: 0.9334 | Train Acc: 0.6689
Average Train Accuracy: 0.8097
 Site-photo                     (3) | Val  Loss: 0.4086 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.4637 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.6807 | Val  Acc: 0.8800
 Site-art_painting              (1) | Val  Loss: 0.7322 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.7630 | Val  Acc: 0.7900
 Site-cartoon                   (2) | Val  Loss: 0.7386 | Val  Acc: 0.8067
 Site-sketch                    (0) | Val  Loss: 1.0414 | Val  Acc: 0.6000
 Site-sketch                    (0) | Val  Loss: 0.9705 | Val  Acc: 0.6533
Average Valid Accuracy: 0.8117
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9600
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9633
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.8800
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.8400
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.7900
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.8067
 Best site-sketch                   (0)  | Epoch:7 | Val Acc: 0.6000
 Best site-sketch                   (0)  | Epoch:7 | Val Acc: 0.6533
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.4627 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.3723 | Train Acc: 0.9689
 Site-art_painting              (0) | Train Loss: 0.6951 | Train Acc: 0.8200
 Site-art_painting              (0) | Train Loss: 0.6163 | Train Acc: 0.8711
 Site-cartoon                   (2) | Train Loss: 0.7947 | Train Acc: 0.7667
 Site-cartoon                   (2) | Train Loss: 0.6700 | Train Acc: 0.8111
 Site-sketch                    (3) | Train Loss: 0.7894 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.8244 | Train Acc: 0.7244
Average Train Accuracy: 0.8386
 Site-photo                     (0) | Val  Loss: 0.3375 | Val  Acc: 0.9900
 Site-photo                     (0) | Val  Loss: 0.4053 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.6004 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.6270 | Val  Acc: 0.8833
 Site-cartoon                   (2) | Val  Loss: 0.7259 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 0.7443 | Val  Acc: 0.8100
 Site-sketch                    (3) | Val  Loss: 0.8601 | Val  Acc: 0.7100
 Site-sketch                    (1) | Val  Loss: 0.8304 | Val  Acc: 0.7467
Average Valid Accuracy: 0.8500
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9900
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.8700
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.8833
 Best site-cartoon                  (2)  | Epoch:8 | Val Acc: 0.8200
 Best site-cartoon                  (2)  | Epoch:8 | Val Acc: 0.8100
 Best site-sketch                   (3)  | Epoch:8 | Val Acc: 0.7100
 Best site-sketch                   (1)  | Epoch:8 | Val Acc: 0.7467
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (0) | Train Loss: 0.3598 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.3204 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.6913 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.5928 | Train Acc: 0.8822
 Site-cartoon                   (2) | Train Loss: 0.6908 | Train Acc: 0.7800
 Site-cartoon                   (2) | Train Loss: 0.6670 | Train Acc: 0.8444
 Site-sketch                    (1) | Train Loss: 0.7151 | Train Acc: 0.7200
 Site-sketch                    (1) | Train Loss: 0.8711 | Train Acc: 0.7400
Average Train Accuracy: 0.8444
 Site-photo                     (0) | Val  Loss: 0.3335 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.3598 | Val  Acc: 0.9600
 Site-art_painting              (3) | Val  Loss: 0.5725 | Val  Acc: 0.9200
 Site-art_painting              (3) | Val  Loss: 0.6075 | Val  Acc: 0.8533
 Site-cartoon                   (2) | Val  Loss: 0.6758 | Val  Acc: 0.7900
 Site-cartoon                   (2) | Val  Loss: 0.6523 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.8686 | Val  Acc: 0.6800
 Site-sketch                    (1) | Val  Loss: 0.7552 | Val  Acc: 0.7567
Average Valid Accuracy: 0.8438
============ Train epoch 10 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (3) | Train Loss: 0.3281 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.2919 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.6384 | Train Acc: 0.8600
 Site-art_painting              (2) | Train Loss: 0.5359 | Train Acc: 0.8644
 Site-cartoon                   (0) | Train Loss: 0.6619 | Train Acc: 0.8000
 Site-cartoon                   (0) | Train Loss: 0.6765 | Train Acc: 0.8289
 Site-sketch                    (1) | Train Loss: 0.6870 | Train Acc: 0.7800
 Site-sketch                    (1) | Train Loss: 0.6907 | Train Acc: 0.7422
Average Train Accuracy: 0.8522
 Site-photo                     (3) | Val  Loss: 0.2723 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.3177 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.5147 | Val  Acc: 0.9000
 Site-art_painting              (2) | Val  Loss: 0.5709 | Val  Acc: 0.8567
 Site-cartoon                   (0) | Val  Loss: 0.6407 | Val  Acc: 0.8100
 Site-cartoon                   (0) | Val  Loss: 0.6077 | Val  Acc: 0.8133
 Site-sketch                    (1) | Val  Loss: 0.7401 | Val  Acc: 0.7300
 Site-sketch                    (1) | Val  Loss: 0.7410 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8488
============ Train epoch 11 ============
cnt=[2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (2) | Train Loss: 0.3217 | Train Acc: 0.9800
 Site-photo                     (2) | Train Loss: 0.2750 | Train Acc: 0.9711
 Site-art_painting              (2) | Train Loss: 0.5944 | Train Acc: 0.8467
 Site-art_painting              (2) | Train Loss: 0.5391 | Train Acc: 0.8689
 Site-cartoon                   (0) | Train Loss: 0.6130 | Train Acc: 0.7933
 Site-cartoon                   (0) | Train Loss: 0.5363 | Train Acc: 0.8422
 Site-sketch                    (1) | Train Loss: 0.6801 | Train Acc: 0.7800
 Site-sketch                    (3) | Train Loss: 0.7597 | Train Acc: 0.7378
Average Train Accuracy: 0.8525
 Site-photo                     (2) | Val  Loss: 0.2616 | Val  Acc: 0.9500
 Site-photo                     (2) | Val  Loss: 0.3042 | Val  Acc: 0.9500
 Site-art_painting              (2) | Val  Loss: 0.5047 | Val  Acc: 0.9000
 Site-art_painting              (2) | Val  Loss: 0.5202 | Val  Acc: 0.8767
 Site-cartoon                   (0) | Val  Loss: 0.5834 | Val  Acc: 0.8300
 Site-cartoon                   (0) | Val  Loss: 0.5504 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.7433 | Val  Acc: 0.7300
 Site-sketch                    (3) | Val  Loss: 0.6656 | Val  Acc: 0.7700
Average Valid Accuracy: 0.8571
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 0.9500
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 0.9500
 Best site-art_painting             (2)  | Epoch:11 | Val Acc: 0.9000
 Best site-art_painting             (2)  | Epoch:11 | Val Acc: 0.8767
 Best site-cartoon                  (0)  | Epoch:11 | Val Acc: 0.8300
 Best site-cartoon                  (0)  | Epoch:11 | Val Acc: 0.8500
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.7300
 Best site-sketch                   (3)  | Epoch:11 | Val Acc: 0.7700
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (3) | Train Loss: 0.3017 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.2682 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.5305 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.4543 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.6151 | Train Acc: 0.7867
 Site-cartoon                   (2) | Train Loss: 0.5339 | Train Acc: 0.8222
 Site-sketch                    (1) | Train Loss: 0.6059 | Train Acc: 0.8000
 Site-sketch                    (1) | Train Loss: 0.6097 | Train Acc: 0.7844
Average Train Accuracy: 0.8614
 Site-photo                     (3) | Val  Loss: 0.2374 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.2863 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.4406 | Val  Acc: 0.9300
 Site-art_painting              (0) | Val  Loss: 0.4850 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.5993 | Val  Acc: 0.8300
 Site-cartoon                   (2) | Val  Loss: 0.5494 | Val  Acc: 0.8467
 Site-sketch                    (1) | Val  Loss: 0.6905 | Val  Acc: 0.7200
 Site-sketch                    (1) | Val  Loss: 0.6180 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8683
 Best site-photo                    (3)  | Epoch:12 | Val Acc: 0.9700
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9667
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.9300
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:12 | Val Acc: 0.8300
 Best site-cartoon                  (2)  | Epoch:12 | Val Acc: 0.8467
 Best site-sketch                   (1)  | Epoch:12 | Val Acc: 0.7200
 Best site-sketch                   (1)  | Epoch:12 | Val Acc: 0.8033
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (3) | Train Loss: 0.2354 | Train Acc: 0.9933
 Site-photo                     (3) | Train Loss: 0.2288 | Train Acc: 0.9711
 Site-art_painting              (0) | Train Loss: 0.5141 | Train Acc: 0.8533
 Site-art_painting              (0) | Train Loss: 0.4434 | Train Acc: 0.9022
 Site-cartoon                   (2) | Train Loss: 0.5765 | Train Acc: 0.7933
 Site-cartoon                   (2) | Train Loss: 0.5790 | Train Acc: 0.8356
 Site-sketch                    (1) | Train Loss: 0.6440 | Train Acc: 0.7933
 Site-sketch                    (1) | Train Loss: 0.6119 | Train Acc: 0.7711
Average Train Accuracy: 0.8642
 Site-photo                     (3) | Val  Loss: 0.1989 | Val  Acc: 0.9800
 Site-photo                     (3) | Val  Loss: 0.2449 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.4124 | Val  Acc: 0.9500
 Site-art_painting              (0) | Val  Loss: 0.4308 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.5495 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 0.5459 | Val  Acc: 0.8433
 Site-sketch                    (1) | Val  Loss: 0.6468 | Val  Acc: 0.7400
 Site-sketch                    (1) | Val  Loss: 0.6431 | Val  Acc: 0.7700
Average Valid Accuracy: 0.8725
 Best site-photo                    (3)  | Epoch:13 | Val Acc: 0.9800
 Best site-photo                    (3)  | Epoch:13 | Val Acc: 0.9667
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.9500
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.9100
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.8200
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.8433
 Best site-sketch                   (1)  | Epoch:13 | Val Acc: 0.7400
 Best site-sketch                   (1)  | Epoch:13 | Val Acc: 0.7700
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.2729 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1992 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.5336 | Train Acc: 0.8533
 Site-art_painting              (3) | Train Loss: 0.5315 | Train Acc: 0.8622
 Site-cartoon                   (2) | Train Loss: 0.5638 | Train Acc: 0.8000
 Site-cartoon                   (2) | Train Loss: 0.6772 | Train Acc: 0.8378
 Site-sketch                    (1) | Train Loss: 0.5785 | Train Acc: 0.7933
 Site-sketch                    (1) | Train Loss: 0.5820 | Train Acc: 0.8111
Average Train Accuracy: 0.8642
 Site-photo                     (0) | Val  Loss: 0.2071 | Val  Acc: 0.9900
 Site-photo                     (0) | Val  Loss: 0.2318 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.4293 | Val  Acc: 0.9100
 Site-art_painting              (3) | Val  Loss: 0.4807 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.4750 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.4679 | Val  Acc: 0.8867
 Site-sketch                    (1) | Val  Loss: 0.6996 | Val  Acc: 0.7000
 Site-sketch                    (1) | Val  Loss: 0.6577 | Val  Acc: 0.7733
Average Valid Accuracy: 0.8717
============ Train epoch 15 ============
cnt=[3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.2433 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1951 | Train Acc: 0.9867
 Site-art_painting              (3) | Train Loss: 0.5386 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.5475 | Train Acc: 0.8978
 Site-cartoon                   (2) | Train Loss: 0.5339 | Train Acc: 0.8067
 Site-cartoon                   (2) | Train Loss: 0.4901 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.5332 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.6305 | Train Acc: 0.7911
Average Train Accuracy: 0.8753
 Site-photo                     (0) | Val  Loss: 0.1932 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.2196 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.4181 | Val  Acc: 0.9100
 Site-art_painting              (0) | Val  Loss: 0.4724 | Val  Acc: 0.8633
 Site-cartoon                   (2) | Val  Loss: 0.4968 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 0.4575 | Val  Acc: 0.8567
 Site-sketch                    (1) | Val  Loss: 0.6155 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.6099 | Val  Acc: 0.7900
Average Valid Accuracy: 0.8704
============ Train epoch 16 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (3) | Train Loss: 0.2043 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1850 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.5552 | Train Acc: 0.8267
 Site-art_painting              (0) | Train Loss: 0.3877 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.5031 | Train Acc: 0.8067
 Site-cartoon                   (2) | Train Loss: 0.4585 | Train Acc: 0.8422
 Site-sketch                    (1) | Train Loss: 0.6644 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.5994 | Train Acc: 0.8156
Average Train Accuracy: 0.8686
 Site-photo                     (3) | Val  Loss: 0.2062 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.2224 | Val  Acc: 0.9833
 Site-art_painting              (0) | Val  Loss: 0.3299 | Val  Acc: 0.9400
 Site-art_painting              (0) | Val  Loss: 0.3992 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.4589 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.4871 | Val  Acc: 0.8467
 Site-sketch                    (1) | Val  Loss: 0.6701 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.5952 | Val  Acc: 0.7833
Average Valid Accuracy: 0.8771
 Best site-photo                    (3)  | Epoch:16 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:16 | Val Acc: 0.9833
 Best site-art_painting             (0)  | Epoch:16 | Val Acc: 0.9400
 Best site-art_painting             (0)  | Epoch:16 | Val Acc: 0.8933
 Best site-cartoon                  (2)  | Epoch:16 | Val Acc: 0.8400
 Best site-cartoon                  (2)  | Epoch:16 | Val Acc: 0.8467
 Best site-sketch                   (1)  | Epoch:16 | Val Acc: 0.7800
 Best site-sketch                   (1)  | Epoch:16 | Val Acc: 0.7833
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (3) | Train Loss: 0.2054 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.2249 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.4687 | Train Acc: 0.8533
 Site-art_painting              (2) | Train Loss: 0.3930 | Train Acc: 0.9000
 Site-cartoon                   (0) | Train Loss: 0.5355 | Train Acc: 0.8067
 Site-cartoon                   (0) | Train Loss: 0.4683 | Train Acc: 0.8511
 Site-sketch                    (1) | Train Loss: 0.7002 | Train Acc: 0.7467
 Site-sketch                    (1) | Train Loss: 0.5124 | Train Acc: 0.8267
Average Train Accuracy: 0.8669
 Site-photo                     (3) | Val  Loss: 0.2048 | Val  Acc: 0.9400
 Site-photo                     (3) | Val  Loss: 0.2208 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.3734 | Val  Acc: 0.9200
 Site-art_painting              (2) | Val  Loss: 0.4026 | Val  Acc: 0.8833
 Site-cartoon                   (0) | Val  Loss: 0.4763 | Val  Acc: 0.8600
 Site-cartoon                   (0) | Val  Loss: 0.4492 | Val  Acc: 0.8600
 Site-sketch                    (1) | Val  Loss: 0.5666 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.5550 | Val  Acc: 0.7933
Average Valid Accuracy: 0.8796
 Best site-photo                    (3)  | Epoch:17 | Val Acc: 0.9400
 Best site-photo                    (3)  | Epoch:17 | Val Acc: 0.9700
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.9200
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8833
 Best site-cartoon                  (0)  | Epoch:17 | Val Acc: 0.8600
 Best site-cartoon                  (0)  | Epoch:17 | Val Acc: 0.8600
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.8100
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7933
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (3) | Train Loss: 0.1856 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.2047 | Train Acc: 0.9756
 Site-art_painting              (0) | Train Loss: 0.4753 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.3505 | Train Acc: 0.9178
 Site-cartoon                   (2) | Train Loss: 0.4708 | Train Acc: 0.8333
 Site-cartoon                   (2) | Train Loss: 0.4521 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.5650 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.5314 | Train Acc: 0.7844
Average Train Accuracy: 0.8789
 Site-photo                     (3) | Val  Loss: 0.1443 | Val  Acc: 0.9900
 Site-photo                     (3) | Val  Loss: 0.2131 | Val  Acc: 0.9567
 Site-art_painting              (0) | Val  Loss: 0.3132 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.3976 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.4479 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.4125 | Val  Acc: 0.8767
 Site-sketch                    (1) | Val  Loss: 0.6522 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5638 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8904
 Best site-photo                    (3)  | Epoch:18 | Val Acc: 0.9900
 Best site-photo                    (3)  | Epoch:18 | Val Acc: 0.9567
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.9000
 Best site-cartoon                  (2)  | Epoch:18 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:18 | Val Acc: 0.8767
 Best site-sketch                   (1)  | Epoch:18 | Val Acc: 0.7500
 Best site-sketch                   (1)  | Epoch:18 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (0) | Train Loss: 0.1681 | Train Acc: 0.9933
 Site-photo                     (0) | Train Loss: 0.1595 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.4584 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.4852 | Train Acc: 0.8911
 Site-cartoon                   (2) | Train Loss: 0.4468 | Train Acc: 0.8333
 Site-cartoon                   (2) | Train Loss: 0.3851 | Train Acc: 0.8667
 Site-sketch                    (1) | Train Loss: 0.5382 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4754 | Train Acc: 0.8044
Average Train Accuracy: 0.8828
 Site-photo                     (0) | Val  Loss: 0.1791 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.1958 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.4018 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.3837 | Val  Acc: 0.9067
 Site-cartoon                   (2) | Val  Loss: 0.4211 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.4142 | Val  Acc: 0.8600
 Site-sketch                    (1) | Val  Loss: 0.5866 | Val  Acc: 0.7900
 Site-sketch                    (1) | Val  Loss: 0.5601 | Val  Acc: 0.8233
Average Valid Accuracy: 0.8846
============ Train epoch 20 ============
cnt=[4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (0) | Train Loss: 0.1820 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1442 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.4277 | Train Acc: 0.8800
 Site-art_painting              (0) | Train Loss: 0.3272 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.4270 | Train Acc: 0.8267
 Site-cartoon                   (2) | Train Loss: 0.3762 | Train Acc: 0.8600
 Site-sketch                    (3) | Train Loss: 0.4937 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.6100 | Train Acc: 0.8133
Average Train Accuracy: 0.8817
 Site-photo                     (0) | Val  Loss: 0.1724 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.1828 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.3119 | Val  Acc: 0.9600
 Site-art_painting              (0) | Val  Loss: 0.3514 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.4228 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.4457 | Val  Acc: 0.8567
 Site-sketch                    (3) | Val  Loss: 0.6529 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5274 | Val  Acc: 0.8167
Average Valid Accuracy: 0.8879
============ Train epoch 21 ============
cnt=[2, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (1) | Train Loss: 0.1904 | Train Acc: 0.9933
 Site-photo                     (3) | Train Loss: 0.1473 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.4533 | Train Acc: 0.8600
 Site-art_painting              (3) | Train Loss: 0.3108 | Train Acc: 0.9178
 Site-cartoon                   (2) | Train Loss: 0.5077 | Train Acc: 0.8133
 Site-cartoon                   (2) | Train Loss: 0.4717 | Train Acc: 0.8600
 Site-sketch                    (0) | Train Loss: 0.5228 | Train Acc: 0.8200
 Site-sketch                    (0) | Train Loss: 0.5517 | Train Acc: 0.8556
Average Train Accuracy: 0.8869
 Site-photo                     (1) | Val  Loss: 0.1745 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1615 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.3258 | Val  Acc: 0.9300
 Site-art_painting              (3) | Val  Loss: 0.3357 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.4518 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.3962 | Val  Acc: 0.8733
 Site-sketch                    (0) | Val  Loss: 0.5520 | Val  Acc: 0.8000
 Site-sketch                    (0) | Val  Loss: 0.5426 | Val  Acc: 0.8067
Average Valid Accuracy: 0.8925
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9700
 Best site-photo                    (3)  | Epoch:21 | Val Acc: 0.9800
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 0.9300
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 0.9200
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.8600
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.8733
 Best site-sketch                   (0)  | Epoch:21 | Val Acc: 0.8000
 Best site-sketch                   (0)  | Epoch:21 | Val Acc: 0.8067
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (3) | Train Loss: 0.1519 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1607 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.4800 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.3492 | Train Acc: 0.9089
 Site-cartoon                   (2) | Train Loss: 0.4692 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.4214 | Train Acc: 0.8778
 Site-sketch                    (1) | Train Loss: 0.4982 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.5846 | Train Acc: 0.8244
Average Train Accuracy: 0.8814
 Site-photo                     (3) | Val  Loss: 0.1837 | Val  Acc: 0.9400
 Site-photo                     (3) | Val  Loss: 0.1719 | Val  Acc: 0.9767
 Site-art_painting              (0) | Val  Loss: 0.2904 | Val  Acc: 0.9400
 Site-art_painting              (0) | Val  Loss: 0.3464 | Val  Acc: 0.9067
 Site-cartoon                   (2) | Val  Loss: 0.4187 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3849 | Val  Acc: 0.8767
 Site-sketch                    (1) | Val  Loss: 0.5684 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.4995 | Val  Acc: 0.8300
Average Valid Accuracy: 0.8950
 Best site-photo                    (3)  | Epoch:22 | Val Acc: 0.9400
 Best site-photo                    (3)  | Epoch:22 | Val Acc: 0.9767
 Best site-art_painting             (0)  | Epoch:22 | Val Acc: 0.9400
 Best site-art_painting             (0)  | Epoch:22 | Val Acc: 0.9067
 Best site-cartoon                  (2)  | Epoch:22 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:22 | Val Acc: 0.8767
 Best site-sketch                   (1)  | Epoch:22 | Val Acc: 0.8100
 Best site-sketch                   (1)  | Epoch:22 | Val Acc: 0.8300
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (3) | Train Loss: 0.1603 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1406 | Train Acc: 0.9844
 Site-art_painting              (2) | Train Loss: 0.4335 | Train Acc: 0.8733
 Site-art_painting              (2) | Train Loss: 0.3243 | Train Acc: 0.9222
 Site-cartoon                   (0) | Train Loss: 0.4016 | Train Acc: 0.8533
 Site-cartoon                   (0) | Train Loss: 0.4268 | Train Acc: 0.8844
 Site-sketch                    (1) | Train Loss: 0.5202 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.4595 | Train Acc: 0.8289
Average Train Accuracy: 0.8917
 Site-photo                     (3) | Val  Loss: 0.1782 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1747 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.2956 | Val  Acc: 0.9200
 Site-art_painting              (2) | Val  Loss: 0.3426 | Val  Acc: 0.9267
 Site-cartoon                   (0) | Val  Loss: 0.4678 | Val  Acc: 0.8200
 Site-cartoon                   (0) | Val  Loss: 0.3944 | Val  Acc: 0.8833
 Site-sketch                    (1) | Val  Loss: 0.5842 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.5415 | Val  Acc: 0.8100
Average Valid Accuracy: 0.8887
============ Train epoch 24 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (3) | Train Loss: 0.1776 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1683 | Train Acc: 0.9733
 Site-art_painting              (1) | Train Loss: 0.4371 | Train Acc: 0.8667
 Site-art_painting              (1) | Train Loss: 0.3523 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.4148 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.3722 | Train Acc: 0.8867
 Site-sketch                    (0) | Train Loss: 0.5211 | Train Acc: 0.8133
 Site-sketch                    (0) | Train Loss: 0.4859 | Train Acc: 0.8222
Average Train Accuracy: 0.8900
 Site-photo                     (3) | Val  Loss: 0.1935 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1839 | Val  Acc: 0.9633
 Site-art_painting              (1) | Val  Loss: 0.3141 | Val  Acc: 0.9400
 Site-art_painting              (1) | Val  Loss: 0.3654 | Val  Acc: 0.9033
 Site-cartoon                   (2) | Val  Loss: 0.4214 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3539 | Val  Acc: 0.9067
 Site-sketch                    (0) | Val  Loss: 0.5273 | Val  Acc: 0.8000
 Site-sketch                    (0) | Val  Loss: 0.5060 | Val  Acc: 0.7933
Average Valid Accuracy: 0.8921
============ Train epoch 25 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (1) | Train Loss: 0.1485 | Train Acc: 0.9933
 Site-photo                     (1) | Train Loss: 0.1442 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.3829 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.3286 | Train Acc: 0.8978
 Site-cartoon                   (2) | Train Loss: 0.4188 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.3224 | Train Acc: 0.8978
 Site-sketch                    (0) | Train Loss: 0.4802 | Train Acc: 0.8200
 Site-sketch                    (0) | Train Loss: 0.4403 | Train Acc: 0.8556
Average Train Accuracy: 0.9031
 Site-photo                     (1) | Val  Loss: 0.1333 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1715 | Val  Acc: 0.9600
 Site-art_painting              (3) | Val  Loss: 0.3036 | Val  Acc: 0.9500
 Site-art_painting              (3) | Val  Loss: 0.3358 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.4166 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.3539 | Val  Acc: 0.8967
 Site-sketch                    (0) | Val  Loss: 0.5394 | Val  Acc: 0.7800
 Site-sketch                    (0) | Val  Loss: 0.5275 | Val  Acc: 0.8167
Average Valid Accuracy: 0.8904
============ Train epoch 26 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (1) | Train Loss: 0.1426 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1424 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3927 | Train Acc: 0.8667
 Site-art_painting              (3) | Train Loss: 0.3265 | Train Acc: 0.9378
 Site-cartoon                   (2) | Train Loss: 0.4405 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.3403 | Train Acc: 0.8800
 Site-sketch                    (0) | Train Loss: 0.5385 | Train Acc: 0.8133
 Site-sketch                    (0) | Train Loss: 0.5153 | Train Acc: 0.8289
Average Train Accuracy: 0.8928
 Site-photo                     (1) | Val  Loss: 0.1207 | Val  Acc: 0.9900
 Site-photo                     (1) | Val  Loss: 0.1612 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.3526 | Val  Acc: 0.9400
 Site-art_painting              (3) | Val  Loss: 0.3099 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.4131 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3763 | Val  Acc: 0.8933
 Site-sketch                    (0) | Val  Loss: 0.5678 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.5401 | Val  Acc: 0.7867
Average Valid Accuracy: 0.8992
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9900
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9700
 Best site-art_painting             (3)  | Epoch:26 | Val Acc: 0.9400
 Best site-art_painting             (3)  | Epoch:26 | Val Acc: 0.9233
 Best site-cartoon                  (2)  | Epoch:26 | Val Acc: 0.8700
 Best site-cartoon                  (2)  | Epoch:26 | Val Acc: 0.8933
 Best site-sketch                   (0)  | Epoch:26 | Val Acc: 0.8200
 Best site-sketch                   (0)  | Epoch:26 | Val Acc: 0.7867
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (0) | Train Loss: 0.2129 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1668 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.4085 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.2989 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.4223 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.4047 | Train Acc: 0.8844
 Site-sketch                    (1) | Train Loss: 0.5329 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.4260 | Train Acc: 0.8422
Average Train Accuracy: 0.8969
 Site-photo                     (0) | Val  Loss: 0.1530 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.1741 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.2545 | Val  Acc: 0.9300
 Site-art_painting              (3) | Val  Loss: 0.2907 | Val  Acc: 0.9267
 Site-cartoon                   (2) | Val  Loss: 0.4044 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.3796 | Val  Acc: 0.8900
 Site-sketch                    (1) | Val  Loss: 0.5018 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.4810 | Val  Acc: 0.8300
Average Valid Accuracy: 0.8983
============ Train epoch 28 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (3) | Train Loss: 0.1606 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1381 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.4536 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.3238 | Train Acc: 0.9089
 Site-cartoon                   (0) | Train Loss: 0.3669 | Train Acc: 0.8733
 Site-cartoon                   (0) | Train Loss: 0.3354 | Train Acc: 0.8844
 Site-sketch                    (1) | Train Loss: 0.4824 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.4117 | Train Acc: 0.8422
Average Train Accuracy: 0.8931
 Site-photo                     (3) | Val  Loss: 0.1255 | Val  Acc: 0.9800
 Site-photo                     (3) | Val  Loss: 0.1510 | Val  Acc: 0.9800
 Site-art_painting              (2) | Val  Loss: 0.2978 | Val  Acc: 0.9200
 Site-art_painting              (2) | Val  Loss: 0.3210 | Val  Acc: 0.8967
 Site-cartoon                   (0) | Val  Loss: 0.3828 | Val  Acc: 0.8300
 Site-cartoon                   (0) | Val  Loss: 0.3414 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.5049 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.4489 | Val  Acc: 0.8667
Average Valid Accuracy: 0.8975
============ Train epoch 29 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (1) | Train Loss: 0.1759 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1207 | Train Acc: 0.9822
 Site-art_painting              (3) | Train Loss: 0.3588 | Train Acc: 0.9067
 Site-art_painting              (3) | Train Loss: 0.3291 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.3664 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.3335 | Train Acc: 0.8844
 Site-sketch                    (0) | Train Loss: 0.4006 | Train Acc: 0.8467
 Site-sketch                    (0) | Train Loss: 0.4316 | Train Acc: 0.8578
Average Train Accuracy: 0.9058
 Site-photo                     (1) | Val  Loss: 0.1016 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1379 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.2855 | Val  Acc: 0.9300
 Site-art_painting              (3) | Val  Loss: 0.2904 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.3755 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3350 | Val  Acc: 0.9033
 Site-sketch                    (0) | Val  Loss: 0.4842 | Val  Acc: 0.8300
 Site-sketch                    (0) | Val  Loss: 0.4511 | Val  Acc: 0.8500
Average Valid Accuracy: 0.9087
 Best site-photo                    (1)  | Epoch:29 | Val Acc: 0.9800
 Best site-photo                    (1)  | Epoch:29 | Val Acc: 0.9767
 Best site-art_painting             (3)  | Epoch:29 | Val Acc: 0.9300
 Best site-art_painting             (3)  | Epoch:29 | Val Acc: 0.9200
 Best site-cartoon                  (2)  | Epoch:29 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:29 | Val Acc: 0.9033
 Best site-sketch                   (0)  | Epoch:29 | Val Acc: 0.8300
 Best site-sketch                   (0)  | Epoch:29 | Val Acc: 0.8500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 30 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (1) | Train Loss: 0.1460 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1219 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3652 | Train Acc: 0.9067
 Site-art_painting              (3) | Train Loss: 0.4807 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.4423 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.3433 | Train Acc: 0.8800
 Site-sketch                    (0) | Train Loss: 0.4553 | Train Acc: 0.8400
 Site-sketch                    (0) | Train Loss: 0.4888 | Train Acc: 0.8267
Average Train Accuracy: 0.8972
 Site-photo                     (1) | Val  Loss: 0.1115 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1511 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.1988 | Val  Acc: 0.9600
 Site-art_painting              (3) | Val  Loss: 0.2574 | Val  Acc: 0.9433
 Site-cartoon                   (2) | Val  Loss: 0.4011 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.3683 | Val  Acc: 0.8767
 Site-sketch                    (0) | Val  Loss: 0.5004 | Val  Acc: 0.7900
 Site-sketch                    (0) | Val  Loss: 0.4679 | Val  Acc: 0.8400
Average Valid Accuracy: 0.9079
============ Train epoch 31 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (3) | Train Loss: 0.1230 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1214 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.4228 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.2713 | Train Acc: 0.9222
 Site-cartoon                   (0) | Train Loss: 0.3887 | Train Acc: 0.8733
 Site-cartoon                   (0) | Train Loss: 0.3437 | Train Acc: 0.8844
 Site-sketch                    (1) | Train Loss: 0.5228 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.4196 | Train Acc: 0.8533
Average Train Accuracy: 0.9011
 Site-photo                     (3) | Val  Loss: 0.1279 | Val  Acc: 0.9800
 Site-photo                     (3) | Val  Loss: 0.1380 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.2456 | Val  Acc: 0.9400
 Site-art_painting              (2) | Val  Loss: 0.2925 | Val  Acc: 0.9133
 Site-cartoon                   (0) | Val  Loss: 0.3902 | Val  Acc: 0.9000
 Site-cartoon                   (0) | Val  Loss: 0.3709 | Val  Acc: 0.8700
 Site-sketch                    (1) | Val  Loss: 0.5359 | Val  Acc: 0.7400
 Site-sketch                    (1) | Val  Loss: 0.4774 | Val  Acc: 0.8300
Average Valid Accuracy: 0.8937
============ Train epoch 32 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (3) | Train Loss: 0.1503 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1401 | Train Acc: 0.9689
 Site-art_painting              (2) | Train Loss: 0.3431 | Train Acc: 0.9067
 Site-art_painting              (2) | Train Loss: 0.4510 | Train Acc: 0.9378
 Site-cartoon                   (0) | Train Loss: 0.4101 | Train Acc: 0.8467
 Site-cartoon                   (0) | Train Loss: 0.3255 | Train Acc: 0.8933
 Site-sketch                    (1) | Train Loss: 0.4035 | Train Acc: 0.8333
 Site-sketch                    (1) | Train Loss: 0.4583 | Train Acc: 0.8556
Average Train Accuracy: 0.9019
 Site-photo                     (3) | Val  Loss: 0.1111 | Val  Acc: 0.9800
 Site-photo                     (3) | Val  Loss: 0.1331 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.2289 | Val  Acc: 0.9500
 Site-art_painting              (2) | Val  Loss: 0.2657 | Val  Acc: 0.9367
 Site-cartoon                   (0) | Val  Loss: 0.3275 | Val  Acc: 0.9200
 Site-cartoon                   (0) | Val  Loss: 0.3682 | Val  Acc: 0.8933
 Site-sketch                    (1) | Val  Loss: 0.4393 | Val  Acc: 0.8700
 Site-sketch                    (1) | Val  Loss: 0.4419 | Val  Acc: 0.8367
Average Valid Accuracy: 0.9204
 Best site-photo                    (3)  | Epoch:32 | Val Acc: 0.9800
 Best site-photo                    (3)  | Epoch:32 | Val Acc: 0.9767
 Best site-art_painting             (2)  | Epoch:32 | Val Acc: 0.9500
 Best site-art_painting             (2)  | Epoch:32 | Val Acc: 0.9367
 Best site-cartoon                  (0)  | Epoch:32 | Val Acc: 0.9200
 Best site-cartoon                  (0)  | Epoch:32 | Val Acc: 0.8933
 Best site-sketch                   (1)  | Epoch:32 | Val Acc: 0.8700
 Best site-sketch                   (1)  | Epoch:32 | Val Acc: 0.8367
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (2) | Train Loss: 0.1276 | Train Acc: 0.9800
 Site-photo                     (2) | Train Loss: 0.1062 | Train Acc: 0.9711
 Site-art_painting              (3) | Train Loss: 0.3255 | Train Acc: 0.9067
 Site-art_painting              (3) | Train Loss: 0.2777 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.3730 | Train Acc: 0.8733
 Site-cartoon                   (0) | Train Loss: 0.3606 | Train Acc: 0.8844
 Site-sketch                    (1) | Train Loss: 0.5075 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.4223 | Train Acc: 0.8578
Average Train Accuracy: 0.9022
 Site-photo                     (2) | Val  Loss: 0.1723 | Val  Acc: 0.9500
 Site-photo                     (2) | Val  Loss: 0.1343 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.2067 | Val  Acc: 0.9600
 Site-art_painting              (3) | Val  Loss: 0.2340 | Val  Acc: 0.9600
 Site-cartoon                   (0) | Val  Loss: 0.3358 | Val  Acc: 0.8900
 Site-cartoon                   (0) | Val  Loss: 0.3603 | Val  Acc: 0.8800
 Site-sketch                    (1) | Val  Loss: 0.4148 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4497 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9121
============ Train epoch 34 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (3) | Train Loss: 0.1482 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1202 | Train Acc: 0.9778
 Site-art_painting              (0) | Train Loss: 0.3660 | Train Acc: 0.8600
 Site-art_painting              (0) | Train Loss: 0.2334 | Train Acc: 0.9356
 Site-cartoon                   (2) | Train Loss: 0.3650 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.3231 | Train Acc: 0.8889
 Site-sketch                    (1) | Train Loss: 0.3851 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.3923 | Train Acc: 0.8644
Average Train Accuracy: 0.9033
 Site-photo                     (3) | Val  Loss: 0.1382 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1326 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.2269 | Val  Acc: 0.9600
 Site-art_painting              (0) | Val  Loss: 0.2409 | Val  Acc: 0.9467
 Site-cartoon                   (2) | Val  Loss: 0.3702 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.3464 | Val  Acc: 0.8900
 Site-sketch                    (1) | Val  Loss: 0.4854 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4585 | Val  Acc: 0.8267
Average Valid Accuracy: 0.9108
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (3) | Train Loss: 0.1381 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1599 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.3057 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2235 | Train Acc: 0.9489
 Site-cartoon                   (2) | Train Loss: 0.3297 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.3365 | Train Acc: 0.9067
 Site-sketch                    (1) | Train Loss: 0.4290 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.4071 | Train Acc: 0.8444
Average Train Accuracy: 0.9117
 Site-photo                     (3) | Val  Loss: 0.1183 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1604 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.2185 | Val  Acc: 0.9500
 Site-art_painting              (0) | Val  Loss: 0.2378 | Val  Acc: 0.9533
 Site-cartoon                   (2) | Val  Loss: 0.3761 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3274 | Val  Acc: 0.8867
 Site-sketch                    (1) | Val  Loss: 0.4463 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.4459 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9100
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.1455 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1212 | Train Acc: 0.9822
 Site-art_painting              (3) | Train Loss: 0.4336 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.4004 | Train Acc: 0.9111
 Site-cartoon                   (2) | Train Loss: 0.3292 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.2940 | Train Acc: 0.9044
 Site-sketch                    (0) | Train Loss: 0.4396 | Train Acc: 0.8267
 Site-sketch                    (0) | Train Loss: 0.5845 | Train Acc: 0.8578
Average Train Accuracy: 0.9069
 Site-photo                     (1) | Val  Loss: 0.1377 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1462 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.2253 | Val  Acc: 0.9400
 Site-art_painting              (3) | Val  Loss: 0.2679 | Val  Acc: 0.9367
 Site-cartoon                   (2) | Val  Loss: 0.3416 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.3172 | Val  Acc: 0.8933
 Site-sketch                    (0) | Val  Loss: 0.4921 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.4457 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9075
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (3) | Train Loss: 0.1228 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1160 | Train Acc: 0.9711
 Site-art_painting              (0) | Train Loss: 0.2709 | Train Acc: 0.9200
 Site-art_painting              (0) | Train Loss: 0.3304 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.3824 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.3311 | Train Acc: 0.8889
 Site-sketch                    (1) | Train Loss: 0.4363 | Train Acc: 0.8667
 Site-sketch                    (1) | Train Loss: 0.3592 | Train Acc: 0.8756
Average Train Accuracy: 0.9103
 Site-photo                     (3) | Val  Loss: 0.1116 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1324 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.1875 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.2497 | Val  Acc: 0.9500
 Site-cartoon                   (2) | Val  Loss: 0.3545 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.3289 | Val  Acc: 0.9000
 Site-sketch                    (1) | Val  Loss: 0.5177 | Val  Acc: 0.8000
 Site-sketch                    (1) | Val  Loss: 0.4389 | Val  Acc: 0.8533
Average Valid Accuracy: 0.9154
============ Train epoch 38 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.1371 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1114 | Train Acc: 0.9822
 Site-art_painting              (0) | Train Loss: 0.2881 | Train Acc: 0.9067
 Site-art_painting              (0) | Train Loss: 0.3242 | Train Acc: 0.9178
 Site-cartoon                   (2) | Train Loss: 0.3669 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.3961 | Train Acc: 0.9022
 Site-sketch                    (1) | Train Loss: 0.4242 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.3604 | Train Acc: 0.8689
Average Train Accuracy: 0.9072
 Site-photo                     (3) | Val  Loss: 0.1198 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1472 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.1766 | Val  Acc: 0.9900
 Site-art_painting              (0) | Val  Loss: 0.2124 | Val  Acc: 0.9467
 Site-cartoon                   (2) | Val  Loss: 0.3438 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.3194 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.3949 | Val  Acc: 0.8600
 Site-sketch                    (1) | Val  Loss: 0.4255 | Val  Acc: 0.8533
Average Valid Accuracy: 0.9258
 Best site-photo                    (3)  | Epoch:38 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:38 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:38 | Val Acc: 0.9900
 Best site-art_painting             (0)  | Epoch:38 | Val Acc: 0.9467
 Best site-cartoon                  (2)  | Epoch:38 | Val Acc: 0.8900
 Best site-cartoon                  (2)  | Epoch:38 | Val Acc: 0.8967
 Best site-sketch                   (1)  | Epoch:38 | Val Acc: 0.8600
 Best site-sketch                   (1)  | Epoch:38 | Val Acc: 0.8533
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (3) | Train Loss: 0.1059 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1220 | Train Acc: 0.9756
 Site-art_painting              (0) | Train Loss: 0.3640 | Train Acc: 0.8800
 Site-art_painting              (0) | Train Loss: 0.3376 | Train Acc: 0.9556
 Site-cartoon                   (2) | Train Loss: 0.3800 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.2911 | Train Acc: 0.9022
 Site-sketch                    (1) | Train Loss: 0.4243 | Train Acc: 0.8800
 Site-sketch                    (1) | Train Loss: 0.3774 | Train Acc: 0.8733
Average Train Accuracy: 0.9150
 Site-photo                     (3) | Val  Loss: 0.1245 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1449 | Val  Acc: 0.9600
 Site-art_painting              (0) | Val  Loss: 0.1878 | Val  Acc: 0.9800
 Site-art_painting              (0) | Val  Loss: 0.2208 | Val  Acc: 0.9433
 Site-cartoon                   (2) | Val  Loss: 0.2906 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.2849 | Val  Acc: 0.9033
 Site-sketch                    (1) | Val  Loss: 0.4263 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.4537 | Val  Acc: 0.8300
Average Valid Accuracy: 0.9183
============ Train epoch 40 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (1) | Train Loss: 0.1229 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.0994 | Train Acc: 0.9822
 Site-art_painting              (3) | Train Loss: 0.3334 | Train Acc: 0.8933
 Site-art_painting              (3) | Train Loss: 0.3144 | Train Acc: 0.9289
 Site-cartoon                   (2) | Train Loss: 0.3417 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.2615 | Train Acc: 0.9200
 Site-sketch                    (0) | Train Loss: 0.4380 | Train Acc: 0.8467
 Site-sketch                    (0) | Train Loss: 0.3584 | Train Acc: 0.8578
Average Train Accuracy: 0.9094
 Site-photo                     (1) | Val  Loss: 0.1181 | Val  Acc: 0.9900
 Site-photo                     (1) | Val  Loss: 0.1338 | Val  Acc: 0.9600
 Site-art_painting              (3) | Val  Loss: 0.1963 | Val  Acc: 0.9600
 Site-art_painting              (3) | Val  Loss: 0.2483 | Val  Acc: 0.9367
 Site-cartoon                   (2) | Val  Loss: 0.2953 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.3052 | Val  Acc: 0.9067
 Site-sketch                    (0) | Val  Loss: 0.4066 | Val  Acc: 0.8400
 Site-sketch                    (0) | Val  Loss: 0.4052 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9200
 Test site-photo                     (1)| Epoch:38 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:38 | Test Acc: 0.9074
 Test site-cartoon                   (2)| Epoch:38 | Test Acc: 0.8904
 Test site-sketch                    (0)| Epoch:38 | Test Acc: 0.8532
photo: 0.9910, art_painting: 0.9074, cartoon: 0.8904, sketch: 0.8532, 
Average Test Accuracy(group): 0.9105, Average Test Accuracy(individual): 0.9105,
domain std=0.0504, cluster std=0.0504, individual std=0.0504, 
Average Test Accuracy: 0.9105
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (0) | Train Loss: 0.0928 | Train Acc: 0.9933
 Site-photo                     (0) | Train Loss: 0.0970 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.2917 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.2227 | Train Acc: 0.9311
 Site-cartoon                   (2) | Train Loss: 0.3081 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.2954 | Train Acc: 0.8911
 Site-sketch                    (1) | Train Loss: 0.4483 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.4513 | Train Acc: 0.8644
Average Train Accuracy: 0.9061
 Site-photo                     (0) | Val  Loss: 0.1190 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1159 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.1777 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.2146 | Val  Acc: 0.9500
 Site-cartoon                   (2) | Val  Loss: 0.3150 | Val  Acc: 0.9400
 Site-cartoon                   (2) | Val  Loss: 0.3111 | Val  Acc: 0.9133
 Site-sketch                    (1) | Val  Loss: 0.4398 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.3997 | Val  Acc: 0.8400
Average Valid Accuracy: 0.9258
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.9099
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8830
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.8488
photo: 0.9910, art_painting: 0.9099, cartoon: 0.8830, sketch: 0.8488, 
Average Test Accuracy(group): 0.9082, Average Test Accuracy(individual): 0.9082,
domain std=0.0525, cluster std=0.0525, individual std=0.0525, 
Average Test Accuracy: 0.9082
============ Train epoch 42 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (3) | Train Loss: 0.1769 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0923 | Train Acc: 0.9733
 Site-art_painting              (1) | Train Loss: 0.2909 | Train Acc: 0.8933
 Site-art_painting              (1) | Train Loss: 0.2437 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.3051 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.3079 | Train Acc: 0.9200
 Site-sketch                    (0) | Train Loss: 0.4955 | Train Acc: 0.8467
 Site-sketch                    (0) | Train Loss: 0.3644 | Train Acc: 0.8600
Average Train Accuracy: 0.9097
 Site-photo                     (3) | Val  Loss: 0.1290 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1125 | Val  Acc: 0.9700
 Site-art_painting              (1) | Val  Loss: 0.2033 | Val  Acc: 0.9500
 Site-art_painting              (1) | Val  Loss: 0.2419 | Val  Acc: 0.9433
 Site-cartoon                   (2) | Val  Loss: 0.3200 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.3052 | Val  Acc: 0.9033
 Site-sketch                    (0) | Val  Loss: 0.4893 | Val  Acc: 0.8400
 Site-sketch                    (0) | Val  Loss: 0.4292 | Val  Acc: 0.8400
Average Valid Accuracy: 0.9121
 Test site-photo                     (3)| Epoch:40 | Test Acc: 0.9896
 Test site-art_painting              (1)| Epoch:40 | Test Acc: 0.9086
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8979
 Test site-sketch                    (0)| Epoch:40 | Test Acc: 0.8507
photo: 0.9896, art_painting: 0.9086, cartoon: 0.8979, sketch: 0.8507, 
Average Test Accuracy(group): 0.9117, Average Test Accuracy(individual): 0.9117,
domain std=0.0500, cluster std=0.0500, individual std=0.0500, 
Average Test Accuracy: 0.9117
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (0) | Train Loss: 0.1286 | Train Acc: 0.9600
 Site-photo                     (0) | Train Loss: 0.0968 | Train Acc: 0.9800
 Site-art_painting              (3) | Train Loss: 0.2918 | Train Acc: 0.9133
 Site-art_painting              (3) | Train Loss: 0.3224 | Train Acc: 0.9533
 Site-cartoon                   (2) | Train Loss: 0.3220 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.2582 | Train Acc: 0.9133
 Site-sketch                    (1) | Train Loss: 0.3881 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.3809 | Train Acc: 0.8756
Average Train Accuracy: 0.9153
 Site-photo                     (0) | Val  Loss: 0.1345 | Val  Acc: 0.9400
 Site-photo                     (0) | Val  Loss: 0.1358 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.1598 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.2211 | Val  Acc: 0.9367
 Site-cartoon                   (2) | Val  Loss: 0.3182 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.2762 | Val  Acc: 0.8933
 Site-sketch                    (1) | Val  Loss: 0.4673 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.3877 | Val  Acc: 0.8800
Average Valid Accuracy: 0.9146
 Test site-photo                     (0)| Epoch:42 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:42 | Test Acc: 0.9111
 Test site-cartoon                   (2)| Epoch:42 | Test Acc: 0.8979
 Test site-sketch                    (1)| Epoch:42 | Test Acc: 0.8494
photo: 0.9910, art_painting: 0.9111, cartoon: 0.8979, sketch: 0.8494, 
Average Test Accuracy(group): 0.9124, Average Test Accuracy(individual): 0.9124,
domain std=0.0509, cluster std=0.0509, individual std=0.0509, 
Average Test Accuracy: 0.9124
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (1) | Train Loss: 0.1116 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.0955 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.2933 | Train Acc: 0.9067
 Site-art_painting              (3) | Train Loss: 0.2329 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.3258 | Train Acc: 0.8533
 Site-cartoon                   (2) | Train Loss: 0.3642 | Train Acc: 0.8978
 Site-sketch                    (0) | Train Loss: 0.3658 | Train Acc: 0.8600
 Site-sketch                    (0) | Train Loss: 0.3448 | Train Acc: 0.8667
Average Train Accuracy: 0.9100
 Site-photo                     (1) | Val  Loss: 0.1054 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1231 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.1332 | Val  Acc: 0.9900
 Site-art_painting              (3) | Val  Loss: 0.2209 | Val  Acc: 0.9300
 Site-cartoon                   (2) | Val  Loss: 0.3065 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.2935 | Val  Acc: 0.8867
 Site-sketch                    (0) | Val  Loss: 0.3528 | Val  Acc: 0.8700
 Site-sketch                    (0) | Val  Loss: 0.3870 | Val  Acc: 0.8800
Average Valid Accuracy: 0.9250
 Test site-photo                     (1)| Epoch:43 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:43 | Test Acc: 0.9172
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.8894
 Test site-sketch                    (0)| Epoch:43 | Test Acc: 0.8482
photo: 0.9925, art_painting: 0.9172, cartoon: 0.8894, sketch: 0.8482, 
Average Test Accuracy(group): 0.9118, Average Test Accuracy(individual): 0.9118,
domain std=0.0527, cluster std=0.0527, individual std=0.0527, 
Average Test Accuracy: 0.9118
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (3) | Train Loss: 0.1247 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.0978 | Train Acc: 0.9733
 Site-art_painting              (1) | Train Loss: 0.2906 | Train Acc: 0.9067
 Site-art_painting              (1) | Train Loss: 0.2256 | Train Acc: 0.9467
 Site-cartoon                   (2) | Train Loss: 0.2535 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.2554 | Train Acc: 0.9244
 Site-sketch                    (0) | Train Loss: 0.3430 | Train Acc: 0.8667
 Site-sketch                    (0) | Train Loss: 0.3533 | Train Acc: 0.8711
Average Train Accuracy: 0.9194
 Site-photo                     (3) | Val  Loss: 0.1140 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1205 | Val  Acc: 0.9800
 Site-art_painting              (1) | Val  Loss: 0.1857 | Val  Acc: 0.9500
 Site-art_painting              (1) | Val  Loss: 0.2311 | Val  Acc: 0.9500
 Site-cartoon                   (2) | Val  Loss: 0.3185 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.2797 | Val  Acc: 0.9100
 Site-sketch                    (0) | Val  Loss: 0.3990 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.3917 | Val  Acc: 0.8667
Average Valid Accuracy: 0.9158
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9896
 Test site-art_painting              (1)| Epoch:43 | Test Acc: 0.9062
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.9000
 Test site-sketch                    (0)| Epoch:43 | Test Acc: 0.8545
photo: 0.9896, art_painting: 0.9062, cartoon: 0.9000, sketch: 0.8545, 
Average Test Accuracy(group): 0.9126, Average Test Accuracy(individual): 0.9126,
domain std=0.0487, cluster std=0.0487, individual std=0.0487, 
Average Test Accuracy: 0.9126
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (3) | Train Loss: 0.0900 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1523 | Train Acc: 0.9778
 Site-art_painting              (0) | Train Loss: 0.3055 | Train Acc: 0.8800
 Site-art_painting              (0) | Train Loss: 0.2153 | Train Acc: 0.9422
 Site-cartoon                   (2) | Train Loss: 0.3633 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.3201 | Train Acc: 0.9178
 Site-sketch                    (1) | Train Loss: 0.4510 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.4074 | Train Acc: 0.9044
Average Train Accuracy: 0.9153
 Site-photo                     (3) | Val  Loss: 0.0764 | Val  Acc: 0.9900
 Site-photo                     (3) | Val  Loss: 0.1198 | Val  Acc: 0.9600
 Site-art_painting              (0) | Val  Loss: 0.2031 | Val  Acc: 0.9800
 Site-art_painting              (0) | Val  Loss: 0.1868 | Val  Acc: 0.9567
 Site-cartoon                   (2) | Val  Loss: 0.2793 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.2461 | Val  Acc: 0.9333
 Site-sketch                    (1) | Val  Loss: 0.4052 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.4002 | Val  Acc: 0.8500
Average Valid Accuracy: 0.9287
 Best site-photo                    (3)  | Epoch:46 | Val Acc: 0.9900
 Best site-photo                    (3)  | Epoch:46 | Val Acc: 0.9600
 Best site-art_painting             (0)  | Epoch:46 | Val Acc: 0.9800
 Best site-art_painting             (0)  | Epoch:46 | Val Acc: 0.9567
 Best site-cartoon                  (2)  | Epoch:46 | Val Acc: 0.9100
 Best site-cartoon                  (2)  | Epoch:46 | Val Acc: 0.9333
 Best site-sketch                   (1)  | Epoch:46 | Val Acc: 0.8500
 Best site-sketch                   (1)  | Epoch:46 | Val Acc: 0.8500
 Test site-photo                     (3)| Epoch:46 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:46 | Test Acc: 0.9147
 Test site-cartoon                   (2)| Epoch:46 | Test Acc: 0.9011
 Test site-sketch                    (1)| Epoch:46 | Test Acc: 0.8424
photo: 0.9896, art_painting: 0.9147, cartoon: 0.9011, sketch: 0.8424, 
Average Test Accuracy(group): 0.9119, Average Test Accuracy(individual): 0.9119,
domain std=0.0524, cluster std=0.0524, individual std=0.0524, 
Average Test Accuracy: 0.9119
============ Train epoch 47 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (3) | Train Loss: 0.1044 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0960 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.3377 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.2203 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.3088 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.2561 | Train Acc: 0.9222
 Site-sketch                    (1) | Train Loss: 0.4692 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.4383 | Train Acc: 0.8844
Average Train Accuracy: 0.9058
 Site-photo                     (3) | Val  Loss: 0.0903 | Val  Acc: 0.9800
 Site-photo                     (3) | Val  Loss: 0.0960 | Val  Acc: 0.9867
 Site-art_painting              (0) | Val  Loss: 0.1666 | Val  Acc: 0.9600
 Site-art_painting              (0) | Val  Loss: 0.2017 | Val  Acc: 0.9500
 Site-cartoon                   (2) | Val  Loss: 0.2579 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.2709 | Val  Acc: 0.9133
 Site-sketch                    (1) | Val  Loss: 0.4060 | Val  Acc: 0.8600
 Site-sketch                    (1) | Val  Loss: 0.3760 | Val  Acc: 0.8667
Average Valid Accuracy: 0.9296
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 0.9800
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 0.9867
 Best site-art_painting             (0)  | Epoch:47 | Val Acc: 0.9600
 Best site-art_painting             (0)  | Epoch:47 | Val Acc: 0.9500
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 0.9200
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 0.9133
 Best site-sketch                   (1)  | Epoch:47 | Val Acc: 0.8600
 Best site-sketch                   (1)  | Epoch:47 | Val Acc: 0.8667
 Test site-photo                     (3)| Epoch:47 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:47 | Test Acc: 0.9160
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.9021
 Test site-sketch                    (1)| Epoch:47 | Test Acc: 0.8443
photo: 0.9896, art_painting: 0.9160, cartoon: 0.9021, sketch: 0.8443, 
Average Test Accuracy(group): 0.9130, Average Test Accuracy(individual): 0.9130,
domain std=0.0517, cluster std=0.0517, individual std=0.0517, 
Average Test Accuracy: 0.9130
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (3) | Train Loss: 0.1063 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1018 | Train Acc: 0.9733
 Site-art_painting              (2) | Train Loss: 0.2931 | Train Acc: 0.8933
 Site-art_painting              (2) | Train Loss: 0.2440 | Train Acc: 0.9222
 Site-cartoon                   (0) | Train Loss: 0.3191 | Train Acc: 0.8733
 Site-cartoon                   (0) | Train Loss: 0.2391 | Train Acc: 0.9222
 Site-sketch                    (1) | Train Loss: 0.4161 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.4142 | Train Acc: 0.8933
Average Train Accuracy: 0.9131
 Site-photo                     (3) | Val  Loss: 0.1131 | Val  Acc: 0.9800
 Site-photo                     (3) | Val  Loss: 0.0969 | Val  Acc: 0.9800
 Site-art_painting              (2) | Val  Loss: 0.1851 | Val  Acc: 0.9500
 Site-art_painting              (2) | Val  Loss: 0.2307 | Val  Acc: 0.9333
 Site-cartoon                   (0) | Val  Loss: 0.3028 | Val  Acc: 0.9200
 Site-cartoon                   (0) | Val  Loss: 0.2771 | Val  Acc: 0.9167
 Site-sketch                    (1) | Val  Loss: 0.4677 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.3512 | Val  Acc: 0.8900
Average Valid Accuracy: 0.9250
 Test site-photo                     (3)| Epoch:47 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:47 | Test Acc: 0.9172
 Test site-cartoon                   (0)| Epoch:47 | Test Acc: 0.9053
 Test site-sketch                    (1)| Epoch:47 | Test Acc: 0.8513
photo: 0.9896, art_painting: 0.9172, cartoon: 0.9053, sketch: 0.8513, 
Average Test Accuracy(group): 0.9158, Average Test Accuracy(individual): 0.9158,
domain std=0.0493, cluster std=0.0493, individual std=0.0493, 
Average Test Accuracy: 0.9158
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.1569 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1348 | Train Acc: 0.9822
 Site-art_painting              (3) | Train Loss: 0.3005 | Train Acc: 0.8733
 Site-art_painting              (3) | Train Loss: 0.2120 | Train Acc: 0.9400
 Site-cartoon                   (2) | Train Loss: 0.2961 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.2346 | Train Acc: 0.9333
 Site-sketch                    (1) | Train Loss: 0.4157 | Train Acc: 0.8333
 Site-sketch                    (1) | Train Loss: 0.3271 | Train Acc: 0.8756
Average Train Accuracy: 0.9139
 Site-photo                     (0) | Val  Loss: 0.0969 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1215 | Val  Acc: 0.9600
 Site-art_painting              (3) | Val  Loss: 0.1932 | Val  Acc: 0.9400
 Site-art_painting              (3) | Val  Loss: 0.2000 | Val  Acc: 0.9433
 Site-cartoon                   (2) | Val  Loss: 0.2870 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.2559 | Val  Acc: 0.9267
 Site-sketch                    (1) | Val  Loss: 0.3654 | Val  Acc: 0.8700
 Site-sketch                    (1) | Val  Loss: 0.3946 | Val  Acc: 0.8533
Average Valid Accuracy: 0.9204
 Test site-photo                     (0)| Epoch:48 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:48 | Test Acc: 0.9160
 Test site-cartoon                   (2)| Epoch:48 | Test Acc: 0.9064
 Test site-sketch                    (1)| Epoch:48 | Test Acc: 0.8532
photo: 0.9896, art_painting: 0.9160, cartoon: 0.9064, sketch: 0.8532, 
Average Test Accuracy(group): 0.9163, Average Test Accuracy(individual): 0.9163,
domain std=0.0486, cluster std=0.0486, individual std=0.0486, 
Average Test Accuracy: 0.9163
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
===2023-08-13 20:39:22===
===2023-08-13 20:39:37===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:49 | Test Acc: 0.9160
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.9064
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.8532
photo: 0.9896, art_painting: 0.9160, cartoon: 0.9064, sketch: 0.8532, 
Average Test Accuracy(group): 0.9163, Average Test Accuracy(individual): 0.9163,
domain std=0.0486, cluster std=0.0486, individual std=0.0486, 
