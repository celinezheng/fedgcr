===2023-08-10 13:26:17===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[5, 1, 5, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (2) | Train Loss: 1.6736 | Train Acc: 0.4667
 Site-photo                     (2) | Train Loss: 1.7515 | Train Acc: 0.4559
 Site-photo                     (2) | Train Loss: 1.6947 | Train Acc: 0.5000
 Site-photo                     (2) | Train Loss: 1.6159 | Train Acc: 0.5686
 Site-photo                     (2) | Train Loss: 1.6908 | Train Acc: 0.5022
 Site-art_painting              (0) | Train Loss: 1.8027 | Train Acc: 0.3095
 Site-art_painting              (0) | Train Loss: 1.9024 | Train Acc: 0.2526
 Site-art_painting              (0) | Train Loss: 1.7673 | Train Acc: 0.3239
 Site-cartoon                   (0) | Train Loss: 1.8389 | Train Acc: 0.1765
 Site-cartoon                   (0) | Train Loss: 1.8759 | Train Acc: 0.2558
 Site-sketch                    (1) | Train Loss: 1.8480 | Train Acc: 0.1901
Average Train Accuracy: 0.3638
 Site-photo                     (2) | Val  Loss: 1.6976 | Val  Acc: 0.5000
 Site-photo                     (2) | Val  Loss: 1.7470 | Val  Acc: 0.5111
 Site-photo                     (2) | Val  Loss: 1.6030 | Val  Acc: 0.5147
 Site-photo                     (2) | Val  Loss: 1.6918 | Val  Acc: 0.5000
 Site-photo                     (2) | Val  Loss: 1.6341 | Val  Acc: 0.5066
 Site-art_painting              (0) | Val  Loss: 1.9434 | Val  Acc: 0.2143
 Site-art_painting              (0) | Val  Loss: 1.7397 | Val  Acc: 0.4127
 Site-art_painting              (0) | Val  Loss: 1.8255 | Val  Acc: 0.2887
 Site-cartoon                   (0) | Val  Loss: 1.9569 | Val  Acc: 0.3913
 Site-cartoon                   (0) | Val  Loss: 1.8854 | Val  Acc: 0.2348
 Site-sketch                    (1) | Val  Loss: 1.7826 | Val  Acc: 0.2750
Average Valid Accuracy: 0.3954
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5111
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5147
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5066
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2143
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.4127
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2887
 Best site-cartoon                  (0)  | Epoch:0 | Val Acc: 0.3913
 Best site-cartoon                  (0)  | Epoch:0 | Val Acc: 0.2348
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.2750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 8, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (1) | Train Loss: 1.5594 | Train Acc: 0.5556
 Site-photo                     (1) | Train Loss: 1.4508 | Train Acc: 0.5735
 Site-photo                     (1) | Train Loss: 1.4472 | Train Acc: 0.6373
 Site-photo                     (1) | Train Loss: 1.4145 | Train Acc: 0.6667
 Site-photo                     (1) | Train Loss: 1.4960 | Train Acc: 0.6332
 Site-art_painting              (1) | Train Loss: 1.6244 | Train Acc: 0.5476
 Site-art_painting              (1) | Train Loss: 1.8055 | Train Acc: 0.3474
 Site-art_painting              (1) | Train Loss: 1.6442 | Train Acc: 0.4085
 Site-cartoon                   (2) | Train Loss: 1.7333 | Train Acc: 0.2647
 Site-cartoon                   (2) | Train Loss: 1.7919 | Train Acc: 0.3198
 Site-sketch                    (0) | Train Loss: 1.9155 | Train Acc: 0.2397
Average Train Accuracy: 0.4722
 Site-photo                     (1) | Val  Loss: 1.4979 | Val  Acc: 0.6000
 Site-photo                     (1) | Val  Loss: 1.5396 | Val  Acc: 0.6000
 Site-photo                     (1) | Val  Loss: 1.3862 | Val  Acc: 0.6471
 Site-photo                     (1) | Val  Loss: 1.4723 | Val  Acc: 0.6373
 Site-photo                     (1) | Val  Loss: 1.4075 | Val  Acc: 0.7171
 Site-art_painting              (1) | Val  Loss: 1.7187 | Val  Acc: 0.3929
 Site-art_painting              (1) | Val  Loss: 1.6349 | Val  Acc: 0.4286
 Site-art_painting              (1) | Val  Loss: 1.6793 | Val  Acc: 0.4155
 Site-cartoon                   (2) | Val  Loss: 1.8504 | Val  Acc: 0.2174
 Site-cartoon                   (2) | Val  Loss: 1.7566 | Val  Acc: 0.3217
 Site-sketch                    (0) | Val  Loss: 1.8268 | Val  Acc: 0.2625
Average Valid Accuracy: 0.4764
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6471
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6373
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7171
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.3929
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.4286
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.4155
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.2174
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.3217
 Best site-sketch                   (0)  | Epoch:1 | Val Acc: 0.2625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 2 ============
cnt=[7, 3, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 1.3259 | Train Acc: 0.7556
 Site-photo                     (0) | Train Loss: 1.1848 | Train Acc: 0.7941
 Site-photo                     (0) | Train Loss: 1.1956 | Train Acc: 0.8431
 Site-photo                     (0) | Train Loss: 1.2165 | Train Acc: 0.8758
 Site-photo                     (0) | Train Loss: 1.2828 | Train Acc: 0.8079
 Site-art_painting              (1) | Train Loss: 1.6098 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.6063 | Train Acc: 0.4316
 Site-art_painting              (0) | Train Loss: 1.5439 | Train Acc: 0.5070
 Site-cartoon                   (1) | Train Loss: 1.7168 | Train Acc: 0.3235
 Site-cartoon                   (1) | Train Loss: 1.6781 | Train Acc: 0.3605
 Site-sketch                    (2) | Train Loss: 1.8188 | Train Acc: 0.2397
Average Train Accuracy: 0.5853
 Site-photo                     (0) | Val  Loss: 1.2556 | Val  Acc: 0.8000
 Site-photo                     (0) | Val  Loss: 1.3007 | Val  Acc: 0.7333
 Site-photo                     (0) | Val  Loss: 1.2506 | Val  Acc: 0.8235
 Site-photo                     (0) | Val  Loss: 1.2682 | Val  Acc: 0.8627
 Site-photo                     (0) | Val  Loss: 1.1926 | Val  Acc: 0.8553
 Site-art_painting              (1) | Val  Loss: 1.5348 | Val  Acc: 0.5714
 Site-art_painting              (0) | Val  Loss: 1.5073 | Val  Acc: 0.6032
 Site-art_painting              (0) | Val  Loss: 1.5800 | Val  Acc: 0.5070
 Site-cartoon                   (1) | Val  Loss: 1.8145 | Val  Acc: 0.2174
 Site-cartoon                   (1) | Val  Loss: 1.6539 | Val  Acc: 0.4087
 Site-sketch                    (2) | Val  Loss: 1.7332 | Val  Acc: 0.2375
Average Valid Accuracy: 0.6018
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7333
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8235
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8627
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8553
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.5714
 Best site-art_painting             (0)  | Epoch:2 | Val Acc: 0.6032
 Best site-art_painting             (0)  | Epoch:2 | Val Acc: 0.5070
 Best site-cartoon                  (1)  | Epoch:2 | Val Acc: 0.2174
 Best site-cartoon                  (1)  | Epoch:2 | Val Acc: 0.4087
 Best site-sketch                   (2)  | Epoch:2 | Val Acc: 0.2375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (0) | Train Loss: 1.1072 | Train Acc: 0.8444
 Site-photo                     (0) | Train Loss: 1.1835 | Train Acc: 0.8382
 Site-photo                     (0) | Train Loss: 1.0194 | Train Acc: 0.9510
 Site-photo                     (0) | Train Loss: 1.0132 | Train Acc: 0.9346
 Site-photo                     (0) | Train Loss: 1.0573 | Train Acc: 0.8821
 Site-art_painting              (2) | Train Loss: 1.3700 | Train Acc: 0.6429
 Site-art_painting              (2) | Train Loss: 1.4574 | Train Acc: 0.6105
 Site-art_painting              (2) | Train Loss: 1.3837 | Train Acc: 0.6385
 Site-cartoon                   (1) | Train Loss: 1.6067 | Train Acc: 0.4118
 Site-cartoon                   (1) | Train Loss: 1.5574 | Train Acc: 0.4593
 Site-sketch                    (1) | Train Loss: 1.7685 | Train Acc: 0.2975
Average Train Accuracy: 0.6828
 Site-photo                     (0) | Val  Loss: 1.0240 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 1.1098 | Val  Acc: 0.8667
 Site-photo                     (0) | Val  Loss: 1.0597 | Val  Acc: 0.9118
 Site-photo                     (0) | Val  Loss: 1.0403 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.9725 | Val  Acc: 0.9276
 Site-art_painting              (2) | Val  Loss: 1.3624 | Val  Acc: 0.6429
 Site-art_painting              (2) | Val  Loss: 1.3425 | Val  Acc: 0.7143
 Site-art_painting              (2) | Val  Loss: 1.4544 | Val  Acc: 0.6127
 Site-cartoon                   (1) | Val  Loss: 1.6295 | Val  Acc: 0.3913
 Site-cartoon                   (1) | Val  Loss: 1.5353 | Val  Acc: 0.4522
 Site-sketch                    (1) | Val  Loss: 1.6773 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7026
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8667
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9118
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9276
 Best site-art_painting             (2)  | Epoch:3 | Val Acc: 0.6429
 Best site-art_painting             (2)  | Epoch:3 | Val Acc: 0.7143
 Best site-art_painting             (2)  | Epoch:3 | Val Acc: 0.6127
 Best site-cartoon                  (1)  | Epoch:3 | Val Acc: 0.3913
 Best site-cartoon                  (1)  | Epoch:3 | Val Acc: 0.4522
 Best site-sketch                   (1)  | Epoch:3 | Val Acc: 0.3250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 4 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 0.9261 | Train Acc: 0.8667
 Site-photo                     (0) | Train Loss: 0.7400 | Train Acc: 0.8971
 Site-photo                     (0) | Train Loss: 0.8071 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.8367 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.8780 | Train Acc: 0.9476
 Site-art_painting              (0) | Train Loss: 1.3136 | Train Acc: 0.7143
 Site-art_painting              (0) | Train Loss: 1.3733 | Train Acc: 0.5684
 Site-art_painting              (0) | Train Loss: 1.2324 | Train Acc: 0.7371
 Site-cartoon                   (1) | Train Loss: 1.5836 | Train Acc: 0.3824
 Site-cartoon                   (1) | Train Loss: 1.4625 | Train Acc: 0.5233
 Site-sketch                    (2) | Train Loss: 1.7185 | Train Acc: 0.2810
Average Train Accuracy: 0.7136
 Site-photo                     (0) | Val  Loss: 0.8521 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.8874 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.8580 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.8653 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.7825 | Val  Acc: 0.9671
 Site-art_painting              (0) | Val  Loss: 1.2192 | Val  Acc: 0.7143
 Site-art_painting              (0) | Val  Loss: 1.2441 | Val  Acc: 0.7778
 Site-art_painting              (0) | Val  Loss: 1.3032 | Val  Acc: 0.7324
 Site-cartoon                   (1) | Val  Loss: 1.5196 | Val  Acc: 0.3913
 Site-cartoon                   (1) | Val  Loss: 1.4345 | Val  Acc: 0.5217
 Site-sketch                    (2) | Val  Loss: 1.6602 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7490
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9111
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9671
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.7143
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.7778
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.7324
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.3913
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.5217
 Best site-sketch                   (2)  | Epoch:4 | Val Acc: 0.3500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 3, 5, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (2) | Train Loss: 0.7965 | Train Acc: 0.9556
 Site-photo                     (2) | Train Loss: 0.9093 | Train Acc: 0.9118
 Site-photo                     (2) | Train Loss: 0.7073 | Train Acc: 0.9804
 Site-photo                     (2) | Train Loss: 0.7092 | Train Acc: 0.9477
 Site-photo                     (2) | Train Loss: 0.7428 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 1.2402 | Train Acc: 0.6667
 Site-art_painting              (0) | Train Loss: 1.2589 | Train Acc: 0.6316
 Site-art_painting              (0) | Train Loss: 1.1164 | Train Acc: 0.7840
 Site-cartoon                   (1) | Train Loss: 1.4425 | Train Acc: 0.5882
 Site-cartoon                   (1) | Train Loss: 1.3568 | Train Acc: 0.5814
 Site-sketch                    (1) | Train Loss: 1.6465 | Train Acc: 0.3636
Average Train Accuracy: 0.7611
 Site-photo                     (2) | Val  Loss: 0.7506 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.7127 | Val  Acc: 0.9778
 Site-photo                     (2) | Val  Loss: 0.7592 | Val  Acc: 0.9118
 Site-photo                     (2) | Val  Loss: 0.7475 | Val  Acc: 0.9412
 Site-photo                     (2) | Val  Loss: 0.6657 | Val  Acc: 0.9539
 Site-art_painting              (0) | Val  Loss: 1.1305 | Val  Acc: 0.7857
 Site-art_painting              (0) | Val  Loss: 1.1369 | Val  Acc: 0.8095
 Site-art_painting              (0) | Val  Loss: 1.2492 | Val  Acc: 0.7394
 Site-cartoon                   (1) | Val  Loss: 1.3770 | Val  Acc: 0.6522
 Site-cartoon                   (1) | Val  Loss: 1.3566 | Val  Acc: 0.5739
 Site-sketch                    (1) | Val  Loss: 1.5937 | Val  Acc: 0.4375
Average Valid Accuracy: 0.7924
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9778
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9118
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9412
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9539
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.7857
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.8095
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.7394
 Best site-cartoon                  (1)  | Epoch:5 | Val Acc: 0.6522
 Best site-cartoon                  (1)  | Epoch:5 | Val Acc: 0.5739
 Best site-sketch                   (1)  | Epoch:5 | Val Acc: 0.4375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 6 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (0) | Train Loss: 0.7222 | Train Acc: 0.9333
 Site-photo                     (0) | Train Loss: 0.6905 | Train Acc: 0.9118
 Site-photo                     (0) | Train Loss: 0.6166 | Train Acc: 0.9510
 Site-photo                     (0) | Train Loss: 0.6398 | Train Acc: 0.9542
 Site-photo                     (0) | Train Loss: 0.6182 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 1.0896 | Train Acc: 0.7857
 Site-art_painting              (0) | Train Loss: 1.1461 | Train Acc: 0.7158
 Site-art_painting              (0) | Train Loss: 1.0479 | Train Acc: 0.8122
 Site-cartoon                   (1) | Train Loss: 1.3212 | Train Acc: 0.6765
 Site-cartoon                   (1) | Train Loss: 1.2785 | Train Acc: 0.6047
 Site-sketch                    (2) | Train Loss: 1.5966 | Train Acc: 0.3884
Average Train Accuracy: 0.7904
 Site-photo                     (0) | Val  Loss: 0.6192 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.6624 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.6596 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.6490 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.5833 | Val  Acc: 0.9671
 Site-art_painting              (0) | Val  Loss: 0.9674 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.9466 | Val  Acc: 0.8889
 Site-art_painting              (0) | Val  Loss: 1.0835 | Val  Acc: 0.8521
 Site-cartoon                   (1) | Val  Loss: 1.3746 | Val  Acc: 0.6087
 Site-cartoon                   (1) | Val  Loss: 1.2133 | Val  Acc: 0.6870
 Site-sketch                    (2) | Val  Loss: 1.5659 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8275
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9671
 Best site-art_painting             (0)  | Epoch:6 | Val Acc: 0.8571
 Best site-art_painting             (0)  | Epoch:6 | Val Acc: 0.8889
 Best site-art_painting             (0)  | Epoch:6 | Val Acc: 0.8521
 Best site-cartoon                  (1)  | Epoch:6 | Val Acc: 0.6087
 Best site-cartoon                  (1)  | Epoch:6 | Val Acc: 0.6870
 Best site-sketch                   (2)  | Epoch:6 | Val Acc: 0.4125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 7 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (0) | Train Loss: 0.6260 | Train Acc: 0.9333
 Site-photo                     (0) | Train Loss: 0.7912 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.5334 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.5584 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.5633 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.9775 | Train Acc: 0.7857
 Site-art_painting              (0) | Train Loss: 1.0427 | Train Acc: 0.6842
 Site-art_painting              (0) | Train Loss: 0.9050 | Train Acc: 0.8451
 Site-cartoon                   (1) | Train Loss: 1.2050 | Train Acc: 0.7353
 Site-cartoon                   (1) | Train Loss: 1.1581 | Train Acc: 0.6919
 Site-sketch                    (2) | Train Loss: 1.4949 | Train Acc: 0.5289
Average Train Accuracy: 0.8229
 Site-photo                     (0) | Val  Loss: 0.5843 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.5813 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5922 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.5901 | Val  Acc: 0.9314
 Site-photo                     (0) | Val  Loss: 0.5126 | Val  Acc: 0.9605
 Site-art_painting              (0) | Val  Loss: 0.9137 | Val  Acc: 0.8214
 Site-art_painting              (0) | Val  Loss: 0.8749 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.9717 | Val  Acc: 0.8239
 Site-cartoon                   (1) | Val  Loss: 1.2120 | Val  Acc: 0.5652
 Site-cartoon                   (1) | Val  Loss: 1.1066 | Val  Acc: 0.7130
 Site-sketch                    (2) | Val  Loss: 1.4894 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8102
============ Train epoch 8 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (1) | Train Loss: 0.5607 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.6813 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.4597 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.5183 | Train Acc: 0.9542
 Site-photo                     (1) | Train Loss: 0.5207 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.9519 | Train Acc: 0.7619
 Site-art_painting              (1) | Train Loss: 0.9562 | Train Acc: 0.7474
 Site-art_painting              (1) | Train Loss: 0.8690 | Train Acc: 0.8451
 Site-cartoon                   (0) | Train Loss: 1.0993 | Train Acc: 0.7059
 Site-cartoon                   (0) | Train Loss: 1.0541 | Train Acc: 0.7209
 Site-sketch                    (2) | Train Loss: 1.3959 | Train Acc: 0.5041
Average Train Accuracy: 0.8308
 Site-photo                     (1) | Val  Loss: 0.5062 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.5257 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.5302 | Val  Acc: 0.9265
 Site-photo                     (1) | Val  Loss: 0.5300 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.4623 | Val  Acc: 0.9539
 Site-art_painting              (1) | Val  Loss: 0.7572 | Val  Acc: 0.8571
 Site-art_painting              (1) | Val  Loss: 0.7650 | Val  Acc: 0.9365
 Site-art_painting              (1) | Val  Loss: 0.9339 | Val  Acc: 0.8310
 Site-cartoon                   (0) | Val  Loss: 1.0823 | Val  Acc: 0.6522
 Site-cartoon                   (0) | Val  Loss: 1.0353 | Val  Acc: 0.7652
 Site-sketch                    (2) | Val  Loss: 1.4349 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8347
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9265
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9539
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.8571
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.9365
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.8310
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.6522
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.7652
 Best site-sketch                   (2)  | Epoch:8 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 9 ============
cnt=[5, 5, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (1) | Train Loss: 0.5032 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.5959 | Train Acc: 0.9412
 Site-photo                     (1) | Train Loss: 0.4164 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.4929 | Train Acc: 0.9477
 Site-photo                     (1) | Train Loss: 0.4645 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.8723 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.8286 | Train Acc: 0.8211
 Site-art_painting              (0) | Train Loss: 0.7741 | Train Acc: 0.8310
 Site-cartoon                   (0) | Train Loss: 1.0518 | Train Acc: 0.7059
 Site-cartoon                   (0) | Train Loss: 0.9981 | Train Acc: 0.7093
 Site-sketch                    (2) | Train Loss: 1.2489 | Train Acc: 0.6281
Average Train Accuracy: 0.8450
 Site-photo                     (1) | Val  Loss: 0.4719 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.4420 | Val  Acc: 0.9111
 Site-photo                     (1) | Val  Loss: 0.4533 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.4859 | Val  Acc: 0.9412
 Site-photo                     (1) | Val  Loss: 0.4057 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.6964 | Val  Acc: 0.8214
 Site-art_painting              (0) | Val  Loss: 0.7357 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.7851 | Val  Acc: 0.8873
 Site-cartoon                   (0) | Val  Loss: 0.9829 | Val  Acc: 0.7826
 Site-cartoon                   (0) | Val  Loss: 0.9361 | Val  Acc: 0.7739
 Site-sketch                    (2) | Val  Loss: 1.3724 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8493
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9111
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9559
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9412
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8214
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.9048
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8873
 Best site-cartoon                  (0)  | Epoch:9 | Val Acc: 0.7826
 Best site-cartoon                  (0)  | Epoch:9 | Val Acc: 0.7739
 Best site-sketch                   (2)  | Epoch:9 | Val Acc: 0.4500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 10 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 0.4728 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.5203 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.3413 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.4318 | Train Acc: 0.9477
 Site-photo                     (0) | Train Loss: 0.4067 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 0.8178 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.7492 | Train Acc: 0.8316
 Site-art_painting              (0) | Train Loss: 0.6655 | Train Acc: 0.8920
 Site-cartoon                   (1) | Train Loss: 0.8833 | Train Acc: 0.7353
 Site-cartoon                   (1) | Train Loss: 0.9027 | Train Acc: 0.7965
 Site-sketch                    (2) | Train Loss: 1.1743 | Train Acc: 0.6364
Average Train Accuracy: 0.8624
 Site-photo                     (0) | Val  Loss: 0.4052 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.4104 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.4061 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.4143 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.3592 | Val  Acc: 0.9671
 Site-art_painting              (0) | Val  Loss: 0.6274 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.6617 | Val  Acc: 0.8889
 Site-art_painting              (0) | Val  Loss: 0.8088 | Val  Acc: 0.8380
 Site-cartoon                   (1) | Val  Loss: 0.9180 | Val  Acc: 0.8261
 Site-cartoon                   (1) | Val  Loss: 0.8455 | Val  Acc: 0.8174
 Site-sketch                    (2) | Val  Loss: 1.3249 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8684
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9671
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.8889
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.8380
 Best site-cartoon                  (1)  | Epoch:10 | Val Acc: 0.8261
 Best site-cartoon                  (1)  | Epoch:10 | Val Acc: 0.8174
 Best site-sketch                   (2)  | Epoch:10 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 11 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (0) | Train Loss: 0.4376 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.3215 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.3330 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.3741 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.3745 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.7887 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.7357 | Train Acc: 0.8105
 Site-art_painting              (0) | Train Loss: 0.6600 | Train Acc: 0.8826
 Site-cartoon                   (1) | Train Loss: 0.8785 | Train Acc: 0.7353
 Site-cartoon                   (1) | Train Loss: 0.8189 | Train Acc: 0.8081
 Site-sketch                    (2) | Train Loss: 1.0627 | Train Acc: 0.6694
Average Train Accuracy: 0.8718
 Site-photo                     (0) | Val  Loss: 0.3940 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3987 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.3747 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.3669 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.3177 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.5129 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.6102 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.8014 | Val  Acc: 0.8592
 Site-cartoon                   (1) | Val  Loss: 0.8435 | Val  Acc: 0.8696
 Site-cartoon                   (1) | Val  Loss: 0.7888 | Val  Acc: 0.8522
 Site-sketch                    (2) | Val  Loss: 1.1409 | Val  Acc: 0.6500
Average Valid Accuracy: 0.8959
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.9048
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8592
 Best site-cartoon                  (1)  | Epoch:11 | Val Acc: 0.8696
 Best site-cartoon                  (1)  | Epoch:11 | Val Acc: 0.8522
 Best site-sketch                   (2)  | Epoch:11 | Val Acc: 0.6500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 12 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (0) | Train Loss: 0.3750 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3577 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.2744 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.3198 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.3316 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.6828 | Train Acc: 0.9048
 Site-art_painting              (0) | Train Loss: 0.6598 | Train Acc: 0.8632
 Site-art_painting              (0) | Train Loss: 0.5826 | Train Acc: 0.8826
 Site-cartoon                   (2) | Train Loss: 0.8060 | Train Acc: 0.7941
 Site-cartoon                   (2) | Train Loss: 0.8339 | Train Acc: 0.7965
 Site-sketch                    (1) | Train Loss: 1.0325 | Train Acc: 0.6612
Average Train Accuracy: 0.8861
 Site-photo                     (0) | Val  Loss: 0.3997 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3337 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.3415 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.3382 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.2930 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.6273 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.5344 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.7029 | Val  Acc: 0.8662
 Site-cartoon                   (2) | Val  Loss: 0.8309 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.7348 | Val  Acc: 0.8522
 Site-sketch                    (1) | Val  Loss: 1.2150 | Val  Acc: 0.5875
Average Valid Accuracy: 0.8829
============ Train epoch 13 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (0) | Train Loss: 0.3312 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2267 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2744 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.3075 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.3162 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 0.6822 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.7177 | Train Acc: 0.8105
 Site-art_painting              (0) | Train Loss: 0.5834 | Train Acc: 0.8873
 Site-cartoon                   (2) | Train Loss: 0.7086 | Train Acc: 0.7941
 Site-cartoon                   (2) | Train Loss: 0.7632 | Train Acc: 0.8140
 Site-sketch                    (1) | Train Loss: 0.9461 | Train Acc: 0.6612
Average Train Accuracy: 0.8771
 Site-photo                     (0) | Val  Loss: 0.3550 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3643 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.3110 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.3275 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2724 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.5173 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.4898 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.6922 | Val  Acc: 0.8592
 Site-cartoon                   (2) | Val  Loss: 0.7136 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.7190 | Val  Acc: 0.8261
 Site-sketch                    (1) | Val  Loss: 1.1207 | Val  Acc: 0.6250
Average Valid Accuracy: 0.8903
============ Train epoch 14 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.2918 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2388 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.2264 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2736 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2907 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.6153 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6741 | Train Acc: 0.8316
 Site-art_painting              (0) | Train Loss: 0.5231 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.6956 | Train Acc: 0.7941
 Site-cartoon                   (2) | Train Loss: 0.6971 | Train Acc: 0.8430
 Site-sketch                    (1) | Train Loss: 0.9283 | Train Acc: 0.7273
Average Train Accuracy: 0.8909
 Site-photo                     (0) | Val  Loss: 0.3419 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2935 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2814 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2868 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2666 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.6121 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.5161 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.6606 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.6721 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.6588 | Val  Acc: 0.8522
 Site-sketch                    (1) | Val  Loss: 1.0805 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9018
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.9048
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8873
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8522
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 15 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.2966 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2434 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.2395 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.2805 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2544 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.6647 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6605 | Train Acc: 0.8421
 Site-art_painting              (0) | Train Loss: 0.4993 | Train Acc: 0.8967
 Site-cartoon                   (1) | Train Loss: 0.6744 | Train Acc: 0.7647
 Site-cartoon                   (1) | Train Loss: 0.6695 | Train Acc: 0.8547
 Site-sketch                    (2) | Train Loss: 0.8265 | Train Acc: 0.7521
Average Train Accuracy: 0.8903
 Site-photo                     (0) | Val  Loss: 0.3650 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2817 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2676 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2837 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2421 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3962 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.4552 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.6581 | Val  Acc: 0.8873
 Site-cartoon                   (1) | Val  Loss: 0.6454 | Val  Acc: 0.8696
 Site-cartoon                   (1) | Val  Loss: 0.6000 | Val  Acc: 0.8696
 Site-sketch                    (2) | Val  Loss: 0.9583 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9082
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.9524
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.8873
 Best site-cartoon                  (1)  | Epoch:15 | Val Acc: 0.8696
 Best site-cartoon                  (1)  | Epoch:15 | Val Acc: 0.8696
 Best site-sketch                   (2)  | Epoch:15 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (1) | Train Loss: 0.2491 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2262 | Train Acc: 0.9265
 Site-photo                     (1) | Train Loss: 0.1991 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.2353 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.2278 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.6127 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.5391 | Train Acc: 0.8421
 Site-art_painting              (1) | Train Loss: 0.4884 | Train Acc: 0.8967
 Site-cartoon                   (0) | Train Loss: 0.6391 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.6171 | Train Acc: 0.8372
 Site-sketch                    (2) | Train Loss: 0.8176 | Train Acc: 0.7273
Average Train Accuracy: 0.8922
 Site-photo                     (1) | Val  Loss: 0.2843 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2914 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2257 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.2492 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.2196 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.4838 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.3576 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.6246 | Val  Acc: 0.8873
 Site-cartoon                   (0) | Val  Loss: 0.6761 | Val  Acc: 0.8261
 Site-cartoon                   (0) | Val  Loss: 0.5976 | Val  Acc: 0.8435
 Site-sketch                    (2) | Val  Loss: 1.0149 | Val  Acc: 0.6750
Average Valid Accuracy: 0.8971
============ Train epoch 17 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (0) | Train Loss: 0.2771 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1853 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1951 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2312 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2179 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.5738 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.4789 | Train Acc: 0.8842
 Site-art_painting              (0) | Train Loss: 0.4644 | Train Acc: 0.9108
 Site-cartoon                   (2) | Train Loss: 0.6258 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.6083 | Train Acc: 0.8430
 Site-sketch                    (1) | Train Loss: 0.7652 | Train Acc: 0.7355
Average Train Accuracy: 0.9006
 Site-photo                     (0) | Val  Loss: 0.2371 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2761 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2224 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.2464 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.2041 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.5478 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.3800 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.5841 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.6100 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.5373 | Val  Acc: 0.8696
 Site-sketch                    (1) | Val  Loss: 1.0915 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9004
============ Train epoch 18 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.2486 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1693 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1604 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1967 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.2333 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.5495 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.5944 | Train Acc: 0.8316
 Site-art_painting              (0) | Train Loss: 0.4420 | Train Acc: 0.8967
 Site-cartoon                   (1) | Train Loss: 0.5878 | Train Acc: 0.7941
 Site-cartoon                   (1) | Train Loss: 0.5906 | Train Acc: 0.8547
 Site-sketch                    (2) | Train Loss: 0.7567 | Train Acc: 0.7603
Average Train Accuracy: 0.8983
 Site-photo                     (0) | Val  Loss: 0.3335 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2354 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2118 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2391 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1939 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.4624 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.3709 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.5264 | Val  Acc: 0.9014
 Site-cartoon                   (1) | Val  Loss: 0.5758 | Val  Acc: 0.9130
 Site-cartoon                   (1) | Val  Loss: 0.5061 | Val  Acc: 0.8783
 Site-sketch                    (2) | Val  Loss: 1.0229 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9092
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.9524
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.9014
 Best site-cartoon                  (1)  | Epoch:18 | Val Acc: 0.9130
 Best site-cartoon                  (1)  | Epoch:18 | Val Acc: 0.8783
 Best site-sketch                   (2)  | Epoch:18 | Val Acc: 0.6875
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 19 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (0) | Train Loss: 0.2288 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3324 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1651 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2000 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2027 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.5662 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.4935 | Train Acc: 0.8421
 Site-art_painting              (0) | Train Loss: 0.4847 | Train Acc: 0.9108
 Site-cartoon                   (1) | Train Loss: 0.5763 | Train Acc: 0.8235
 Site-cartoon                   (1) | Train Loss: 0.5405 | Train Acc: 0.8721
 Site-sketch                    (2) | Train Loss: 0.7249 | Train Acc: 0.7686
Average Train Accuracy: 0.8976
 Site-photo                     (0) | Val  Loss: 0.2911 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2074 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2001 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1872 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1847 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.3629 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.4370 | Val  Acc: 0.8730
 Site-art_painting              (0) | Val  Loss: 0.4964 | Val  Acc: 0.8944
 Site-cartoon                   (1) | Val  Loss: 0.6020 | Val  Acc: 0.8696
 Site-cartoon                   (1) | Val  Loss: 0.4821 | Val  Acc: 0.9130
 Site-sketch                    (2) | Val  Loss: 0.8907 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9066
============ Train epoch 20 ============
cnt=[2, 1, 8, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (2) | Train Loss: 0.1745 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1398 | Train Acc: 0.9559
 Site-photo                     (2) | Train Loss: 0.1444 | Train Acc: 0.9804
 Site-photo                     (2) | Train Loss: 0.2183 | Train Acc: 0.9608
 Site-photo                     (2) | Train Loss: 0.1987 | Train Acc: 0.9607
 Site-art_painting              (2) | Train Loss: 0.4813 | Train Acc: 0.8571
 Site-art_painting              (2) | Train Loss: 0.3955 | Train Acc: 0.8737
 Site-art_painting              (2) | Train Loss: 0.3594 | Train Acc: 0.9249
 Site-cartoon                   (0) | Train Loss: 0.5645 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.5379 | Train Acc: 0.8430
 Site-sketch                    (1) | Train Loss: 0.7636 | Train Acc: 0.7190
Average Train Accuracy: 0.8999
 Site-photo                     (2) | Val  Loss: 0.2707 | Val  Acc: 0.9000
 Site-photo                     (2) | Val  Loss: 0.2035 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.1491 | Val  Acc: 0.9706
 Site-photo                     (2) | Val  Loss: 0.1758 | Val  Acc: 0.9510
 Site-photo                     (2) | Val  Loss: 0.1487 | Val  Acc: 0.9803
 Site-art_painting              (2) | Val  Loss: 0.4255 | Val  Acc: 0.8571
 Site-art_painting              (2) | Val  Loss: 0.3890 | Val  Acc: 0.8889
 Site-art_painting              (2) | Val  Loss: 0.4915 | Val  Acc: 0.9085
 Site-cartoon                   (0) | Val  Loss: 0.5067 | Val  Acc: 0.9565
 Site-cartoon                   (0) | Val  Loss: 0.5099 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.8791 | Val  Acc: 0.7125
Average Valid Accuracy: 0.9070
============ Train epoch 21 ============
cnt=[3, 1, 7, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (2) | Train Loss: 0.2261 | Train Acc: 0.9556
 Site-photo                     (2) | Train Loss: 0.1624 | Train Acc: 0.9706
 Site-photo                     (2) | Train Loss: 0.1280 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1719 | Train Acc: 0.9739
 Site-photo                     (2) | Train Loss: 0.1854 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.5384 | Train Acc: 0.8571
 Site-art_painting              (2) | Train Loss: 0.4913 | Train Acc: 0.8526
 Site-art_painting              (2) | Train Loss: 0.3748 | Train Acc: 0.9061
 Site-cartoon                   (0) | Train Loss: 0.5466 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.5099 | Train Acc: 0.8779
 Site-sketch                    (0) | Train Loss: 0.6722 | Train Acc: 0.7769
Average Train Accuracy: 0.9062
 Site-photo                     (2) | Val  Loss: 0.2955 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.2005 | Val  Acc: 0.9778
 Site-photo                     (2) | Val  Loss: 0.1594 | Val  Acc: 0.9706
 Site-photo                     (2) | Val  Loss: 0.1651 | Val  Acc: 0.9706
 Site-photo                     (2) | Val  Loss: 0.1555 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.3610 | Val  Acc: 0.9643
 Site-art_painting              (2) | Val  Loss: 0.3398 | Val  Acc: 0.9365
 Site-art_painting              (2) | Val  Loss: 0.5112 | Val  Acc: 0.9155
 Site-cartoon                   (0) | Val  Loss: 0.5186 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.4614 | Val  Acc: 0.8957
 Site-sketch                    (0) | Val  Loss: 0.9173 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9189
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9778
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9706
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9706
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 0.9643
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.9365
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.9155
 Best site-cartoon                  (0)  | Epoch:21 | Val Acc: 0.9130
 Best site-cartoon                  (0)  | Epoch:21 | Val Acc: 0.8957
 Best site-sketch                   (0)  | Epoch:21 | Val Acc: 0.6500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 22 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.1767 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1476 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1253 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1643 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1783 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.5285 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.4576 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.3515 | Train Acc: 0.9202
 Site-cartoon                   (2) | Train Loss: 0.6378 | Train Acc: 0.7647
 Site-cartoon                   (2) | Train Loss: 0.5383 | Train Acc: 0.8256
 Site-sketch                    (1) | Train Loss: 0.6329 | Train Acc: 0.8017
Average Train Accuracy: 0.9045
 Site-photo                     (0) | Val  Loss: 0.1977 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2376 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1663 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1784 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1488 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3057 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.3573 | Val  Acc: 0.8730
 Site-art_painting              (0) | Val  Loss: 0.4381 | Val  Acc: 0.9085
 Site-cartoon                   (2) | Val  Loss: 0.4932 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.4321 | Val  Acc: 0.9043
 Site-sketch                    (1) | Val  Loss: 0.9316 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9060
============ Train epoch 23 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (0) | Train Loss: 0.1736 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2128 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1409 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1601 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1611 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.5065 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.4854 | Train Acc: 0.9158
 Site-art_painting              (0) | Train Loss: 0.3733 | Train Acc: 0.9202
 Site-cartoon                   (2) | Train Loss: 0.5859 | Train Acc: 0.8529
 Site-cartoon                   (2) | Train Loss: 0.4682 | Train Acc: 0.9070
 Site-sketch                    (1) | Train Loss: 0.6432 | Train Acc: 0.7686
Average Train Accuracy: 0.9185
 Site-photo                     (0) | Val  Loss: 0.2465 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.2275 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1624 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1532 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.1371 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3893 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.3386 | Val  Acc: 0.8889
 Site-art_painting              (0) | Val  Loss: 0.4799 | Val  Acc: 0.9014
 Site-cartoon                   (2) | Val  Loss: 0.5122 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.4438 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.9064 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9081
============ Train epoch 24 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (0) | Train Loss: 0.1855 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2239 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1345 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1405 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1622 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4934 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.4008 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.3654 | Train Acc: 0.9108
 Site-cartoon                   (2) | Train Loss: 0.5100 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.4432 | Train Acc: 0.8895
 Site-sketch                    (1) | Train Loss: 0.6075 | Train Acc: 0.8017
Average Train Accuracy: 0.9104
 Site-photo                     (0) | Val  Loss: 0.1835 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.2657 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1384 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1605 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1276 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3714 | Val  Acc: 0.8214
 Site-art_painting              (0) | Val  Loss: 0.2972 | Val  Acc: 0.9206
 Site-art_painting              (0) | Val  Loss: 0.4707 | Val  Acc: 0.9155
 Site-cartoon                   (2) | Val  Loss: 0.5210 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.3967 | Val  Acc: 0.9304
 Site-sketch                    (1) | Val  Loss: 0.8640 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9086
============ Train epoch 25 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (0) | Train Loss: 0.1579 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1065 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1262 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1512 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1577 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.5088 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.4322 | Train Acc: 0.8632
 Site-art_painting              (0) | Train Loss: 0.3814 | Train Acc: 0.8826
 Site-cartoon                   (2) | Train Loss: 0.4533 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.4229 | Train Acc: 0.8895
 Site-sketch                    (1) | Train Loss: 0.6623 | Train Acc: 0.8099
Average Train Accuracy: 0.9168
 Site-photo                     (0) | Val  Loss: 0.2500 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.2257 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1427 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1535 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1455 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.2262 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2559 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3784 | Val  Acc: 0.9648
 Site-cartoon                   (2) | Val  Loss: 0.4627 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3766 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.9291 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9223
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 0.9683
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 0.9648
 Best site-cartoon                  (2)  | Epoch:25 | Val Acc: 0.8696
 Best site-cartoon                  (2)  | Epoch:25 | Val Acc: 0.9217
 Best site-sketch                   (1)  | Epoch:25 | Val Acc: 0.6750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (1) | Train Loss: 0.1321 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1591 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0954 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1314 | Train Acc: 0.9608
 Site-photo                     (1) | Train Loss: 0.1491 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.3529 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.4291 | Train Acc: 0.9158
 Site-art_painting              (1) | Train Loss: 0.3077 | Train Acc: 0.9249
 Site-cartoon                   (0) | Train Loss: 0.4683 | Train Acc: 0.9118
 Site-cartoon                   (0) | Train Loss: 0.4282 | Train Acc: 0.9244
 Site-sketch                    (2) | Train Loss: 0.6249 | Train Acc: 0.7686
Average Train Accuracy: 0.9275
 Site-photo                     (1) | Val  Loss: 0.2832 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2246 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1314 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1442 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.1260 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2265 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.2880 | Val  Acc: 0.9206
 Site-art_painting              (1) | Val  Loss: 0.4202 | Val  Acc: 0.9085
 Site-cartoon                   (0) | Val  Loss: 0.4302 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.4011 | Val  Acc: 0.8870
 Site-sketch                    (2) | Val  Loss: 0.8933 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9263
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9868
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 0.9206
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 0.9085
 Best site-cartoon                  (0)  | Epoch:26 | Val Acc: 0.9130
 Best site-cartoon                  (0)  | Epoch:26 | Val Acc: 0.8870
 Best site-sketch                   (2)  | Epoch:26 | Val Acc: 0.7625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 27 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (0) | Train Loss: 0.1455 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0994 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0993 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1547 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1543 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.5522 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3959 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.3116 | Train Acc: 0.9155
 Site-cartoon                   (2) | Train Loss: 0.4566 | Train Acc: 0.8824
 Site-cartoon                   (2) | Train Loss: 0.4291 | Train Acc: 0.8663
 Site-sketch                    (1) | Train Loss: 0.6234 | Train Acc: 0.7769
Average Train Accuracy: 0.9171
 Site-photo                     (0) | Val  Loss: 0.1919 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1985 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1240 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1420 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1218 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.2686 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2548 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.3630 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.5216 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.4046 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.8096 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9222
============ Train epoch 28 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (0) | Train Loss: 0.1360 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1398 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1042 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1586 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1379 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.5113 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.3582 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.3043 | Train Acc: 0.9108
 Site-cartoon                   (2) | Train Loss: 0.5188 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.4089 | Train Acc: 0.9012
 Site-sketch                    (1) | Train Loss: 0.5380 | Train Acc: 0.8347
Average Train Accuracy: 0.9172
 Site-photo                     (0) | Val  Loss: 0.2335 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2393 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1273 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1554 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1084 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2706 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.2330 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3186 | Val  Acc: 0.9437
 Site-cartoon                   (2) | Val  Loss: 0.4413 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3714 | Val  Acc: 0.9043
 Site-sketch                    (1) | Val  Loss: 0.8872 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9226
============ Train epoch 29 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (0) | Train Loss: 0.1269 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0784 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1149 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1266 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1466 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4994 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.4449 | Train Acc: 0.8842
 Site-art_painting              (0) | Train Loss: 0.3155 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.4350 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.4098 | Train Acc: 0.9070
 Site-sketch                    (1) | Train Loss: 0.5578 | Train Acc: 0.7769
Average Train Accuracy: 0.9215
 Site-photo                     (0) | Val  Loss: 0.1916 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1882 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1150 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1352 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1128 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2773 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.2211 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.4471 | Val  Acc: 0.9014
 Site-cartoon                   (2) | Val  Loss: 0.4082 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.3438 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.8261 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9282
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9683
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9014
 Best site-cartoon                  (2)  | Epoch:29 | Val Acc: 0.9565
 Best site-cartoon                  (2)  | Epoch:29 | Val Acc: 0.9217
 Best site-sketch                   (1)  | Epoch:29 | Val Acc: 0.7625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 30 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (0) | Train Loss: 0.1378 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1210 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.0845 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1165 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1450 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.3864 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.3289 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.2854 | Train Acc: 0.9484
 Site-cartoon                   (2) | Train Loss: 0.4748 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.4002 | Train Acc: 0.9070
 Site-sketch                    (1) | Train Loss: 0.5328 | Train Acc: 0.8264
Average Train Accuracy: 0.9250
 Site-photo                     (0) | Val  Loss: 0.1897 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1641 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1087 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1177 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1128 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2535 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2161 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3658 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.4510 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3424 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.8701 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9249
============ Train epoch 31 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.1332 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.5121 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.0844 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1343 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1272 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4380 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3876 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2978 | Train Acc: 0.9296
 Site-cartoon                   (2) | Train Loss: 0.5104 | Train Acc: 0.8529
 Site-cartoon                   (2) | Train Loss: 0.3820 | Train Acc: 0.8953
 Site-sketch                    (1) | Train Loss: 0.4857 | Train Acc: 0.8760
Average Train Accuracy: 0.9255
 Site-photo                     (0) | Val  Loss: 0.2454 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2099 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1029 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1316 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1136 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.2253 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2951 | Val  Acc: 0.9206
 Site-art_painting              (0) | Val  Loss: 0.4047 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.3818 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.3267 | Val  Acc: 0.9565
 Site-sketch                    (1) | Val  Loss: 0.7249 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9308
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9206
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9225
 Best site-cartoon                  (2)  | Epoch:31 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:31 | Val Acc: 0.9565
 Best site-sketch                   (1)  | Epoch:31 | Val Acc: 0.7875
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 32 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (0) | Train Loss: 0.1107 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4254 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0920 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1170 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1279 | Train Acc: 0.9782
 Site-art_painting              (0) | Train Loss: 0.4845 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3601 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.2860 | Train Acc: 0.9108
 Site-cartoon                   (2) | Train Loss: 0.5052 | Train Acc: 0.7941
 Site-cartoon                   (2) | Train Loss: 0.3625 | Train Acc: 0.9070
 Site-sketch                    (1) | Train Loss: 0.5277 | Train Acc: 0.7934
Average Train Accuracy: 0.9133
 Site-photo                     (0) | Val  Loss: 0.1689 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.2208 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1237 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1266 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1141 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.2293 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2043 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3583 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.4100 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3367 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.8537 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9245
============ Train epoch 33 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (0) | Train Loss: 0.1866 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1017 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0966 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1023 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1395 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4253 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.3119 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2819 | Train Acc: 0.9108
 Site-cartoon                   (2) | Train Loss: 0.4292 | Train Acc: 0.8529
 Site-cartoon                   (2) | Train Loss: 0.3764 | Train Acc: 0.9186
 Site-sketch                    (1) | Train Loss: 0.5414 | Train Acc: 0.8017
Average Train Accuracy: 0.9239
 Site-photo                     (0) | Val  Loss: 0.1204 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1182 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0878 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1252 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.0847 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.2719 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2360 | Val  Acc: 0.9365
 Site-art_painting              (0) | Val  Loss: 0.3211 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.4747 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.3341 | Val  Acc: 0.9565
 Site-sketch                    (1) | Val  Loss: 0.7853 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9365
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9934
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9365
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9225
 Best site-cartoon                  (2)  | Epoch:33 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:33 | Val Acc: 0.9565
 Best site-sketch                   (1)  | Epoch:33 | Val Acc: 0.7750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 34 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (0) | Train Loss: 0.1698 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1395 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0775 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1115 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1322 | Train Acc: 0.9782
 Site-art_painting              (0) | Train Loss: 0.4313 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.4041 | Train Acc: 0.8737
 Site-art_painting              (0) | Train Loss: 0.2516 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.4261 | Train Acc: 0.8824
 Site-cartoon                   (2) | Train Loss: 0.3512 | Train Acc: 0.9244
 Site-sketch                    (1) | Train Loss: 0.5550 | Train Acc: 0.7851
Average Train Accuracy: 0.9231
 Site-photo                     (0) | Val  Loss: 0.1525 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2091 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1056 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1093 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.1072 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2537 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2600 | Val  Acc: 0.9365
 Site-art_painting              (0) | Val  Loss: 0.2947 | Val  Acc: 0.9437
 Site-cartoon                   (2) | Val  Loss: 0.3472 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.3304 | Val  Acc: 0.9043
 Site-sketch                    (1) | Val  Loss: 0.8254 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9287
============ Train epoch 35 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (0) | Train Loss: 0.1290 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1492 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0919 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1251 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1186 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.3335 | Train Acc: 0.9524
 Site-art_painting              (0) | Train Loss: 0.3758 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2578 | Train Acc: 0.9343
 Site-cartoon                   (2) | Train Loss: 0.4156 | Train Acc: 0.8824
 Site-cartoon                   (2) | Train Loss: 0.3789 | Train Acc: 0.9128
 Site-sketch                    (1) | Train Loss: 0.4689 | Train Acc: 0.8430
Average Train Accuracy: 0.9368
 Site-photo                     (0) | Val  Loss: 0.1527 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1625 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0939 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1415 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1044 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.1540 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.1802 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.3636 | Val  Acc: 0.9014
 Site-cartoon                   (2) | Val  Loss: 0.3267 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.3226 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.6779 | Val  Acc: 0.7250
Average Valid Accuracy: 0.9398
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9841
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9014
 Best site-cartoon                  (2)  | Epoch:35 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:35 | Val Acc: 0.9130
 Best site-sketch                   (1)  | Epoch:35 | Val Acc: 0.7250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.1533 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1019 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.0926 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.1354 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.0929 | Train Acc: 0.9913
 Site-art_painting              (1) | Train Loss: 0.4120 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.3223 | Train Acc: 0.9263
 Site-art_painting              (1) | Train Loss: 0.2859 | Train Acc: 0.9061
 Site-cartoon                   (0) | Train Loss: 0.4568 | Train Acc: 0.8824
 Site-cartoon                   (0) | Train Loss: 0.3277 | Train Acc: 0.9419
 Site-sketch                    (2) | Train Loss: 0.5027 | Train Acc: 0.8264
Average Train Accuracy: 0.9345
 Site-photo                     (1) | Val  Loss: 0.1591 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1672 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1103 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1281 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.0944 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.1772 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.2288 | Val  Acc: 0.9365
 Site-art_painting              (1) | Val  Loss: 0.3173 | Val  Acc: 0.9155
 Site-cartoon                   (0) | Val  Loss: 0.2908 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.3133 | Val  Acc: 0.9304
 Site-sketch                    (2) | Val  Loss: 0.6449 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9314
============ Train epoch 37 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (0) | Train Loss: 0.1106 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1217 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0960 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1267 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.0978 | Train Acc: 0.9782
 Site-art_painting              (0) | Train Loss: 0.4367 | Train Acc: 0.9048
 Site-art_painting              (0) | Train Loss: 0.3319 | Train Acc: 0.9158
 Site-art_painting              (0) | Train Loss: 0.2375 | Train Acc: 0.9624
 Site-cartoon                   (2) | Train Loss: 0.3822 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.2985 | Train Acc: 0.9477
 Site-sketch                    (1) | Train Loss: 0.4476 | Train Acc: 0.8347
Average Train Accuracy: 0.9422
 Site-photo                     (0) | Val  Loss: 0.1091 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1308 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0867 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1068 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1048 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.1910 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2029 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3158 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.4108 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.3028 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.7678 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9421
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9934
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 0.9683
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 0.9296
 Best site-cartoon                  (2)  | Epoch:37 | Val Acc: 0.9565
 Best site-cartoon                  (2)  | Epoch:37 | Val Acc: 0.9130
 Best site-sketch                   (1)  | Epoch:37 | Val Acc: 0.7750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_3/ccop_q=1...
============ Train epoch 38 ============
cnt=[1, 8, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (1) | Train Loss: 0.1389 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1188 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0778 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1414 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.0953 | Train Acc: 0.9782
 Site-art_painting              (1) | Train Loss: 0.4158 | Train Acc: 0.8571
 Site-art_painting              (1) | Train Loss: 0.2919 | Train Acc: 0.9053
 Site-art_painting              (1) | Train Loss: 0.2326 | Train Acc: 0.9484
 Site-cartoon                   (2) | Train Loss: 0.4165 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.3535 | Train Acc: 0.9186
 Site-sketch                    (0) | Train Loss: 0.4522 | Train Acc: 0.8512
Average Train Accuracy: 0.9329
 Site-photo                     (1) | Val  Loss: 0.1885 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1335 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.0821 | Val  Acc: 0.9853
 Site-photo                     (1) | Val  Loss: 0.0942 | Val  Acc: 0.9804
 Site-photo                     (1) | Val  Loss: 0.0893 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.2191 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.2277 | Val  Acc: 0.9206
 Site-art_painting              (1) | Val  Loss: 0.3205 | Val  Acc: 0.9155
 Site-cartoon                   (2) | Val  Loss: 0.2973 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.3053 | Val  Acc: 0.9304
 Site-sketch                    (0) | Val  Loss: 0.8024 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9388
============ Train epoch 39 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (0) | Train Loss: 0.1033 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1072 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0611 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1228 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1094 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4301 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3241 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2382 | Train Acc: 0.9296
 Site-cartoon                   (1) | Train Loss: 0.3920 | Train Acc: 0.9118
 Site-cartoon                   (1) | Train Loss: 0.3102 | Train Acc: 0.9477
 Site-sketch                    (2) | Train Loss: 0.5282 | Train Acc: 0.8430
Average Train Accuracy: 0.9369
 Site-photo                     (0) | Val  Loss: 0.1502 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1371 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0918 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1114 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.0844 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.1798 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2172 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.4093 | Val  Acc: 0.9225
 Site-cartoon                   (1) | Val  Loss: 0.3394 | Val  Acc: 0.9565
 Site-cartoon                   (1) | Val  Loss: 0.3041 | Val  Acc: 0.9391
 Site-sketch                    (2) | Val  Loss: 0.7661 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9386
============ Train epoch 40 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (0) | Train Loss: 0.1020 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.0598 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0740 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1329 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1058 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4122 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.2670 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2507 | Train Acc: 0.9249
 Site-cartoon                   (1) | Train Loss: 0.3997 | Train Acc: 0.9118
 Site-cartoon                   (1) | Train Loss: 0.2944 | Train Acc: 0.9419
 Site-sketch                    (2) | Train Loss: 0.4215 | Train Acc: 0.8843
Average Train Accuracy: 0.9432
 Site-photo                     (0) | Val  Loss: 0.0871 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1397 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0917 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1132 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1056 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.2232 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2557 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.3321 | Val  Acc: 0.9296
 Site-cartoon                   (1) | Val  Loss: 0.2406 | Val  Acc: 0.9565
 Site-cartoon                   (1) | Val  Loss: 0.2833 | Val  Acc: 0.9130
 Site-sketch                    (2) | Val  Loss: 0.7049 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9393
 Test site-photo                     (0)| Epoch:37 | Test Acc: 0.9925
 Test site-art_painting              (0)| Epoch:37 | Test Acc: 0.8989
 Test site-cartoon                   (1)| Epoch:37 | Test Acc: 0.8840
 Test site-sketch                    (2)| Epoch:37 | Test Acc: 0.7992
photo: 0.9925, art_painting: 0.8989, cartoon: 0.8840, sketch: 0.7992, 
Average Test Accuracy(group): 0.8937, Average Test Accuracy(individual): 0.9297,
domain std=0.0686, cluster std=0.0646, individual std=0.0631, 
===2023-08-10 14:25:32===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 3
Loading snapshots...
 Test site-photo                     (0)| Epoch:37 | Test Acc: 0.9925
 Test site-art_painting              (0)| Epoch:37 | Test Acc: 0.8940
 Test site-cartoon                   (2)| Epoch:37 | Test Acc: 0.8809
 Test site-sketch                    (1)| Epoch:37 | Test Acc: 0.7967
photo: 0.9925, art_painting: 0.8940, cartoon: 0.8809, sketch: 0.7967, 
Average Test Accuracy(group): 0.8910, Average Test Accuracy(individual): 0.9276,
domain std=0.0695, cluster std=0.0649, individual std=0.0646, 
