===2023-03-29 15:07:50===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-Clipart   | Train Loss: 2.0201 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9586 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 2.1828 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1423 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 1.9407 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9481 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 2.2607 | Train Acc: 0.1746
 Site-QuickDraw | Train Loss: 2.1661 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.8317 | Train Acc: 0.5397
 Site-Real      | Train Loss: 1.8814 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.8489 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.9540 | Train Acc: 0.4127
 Site-Clipart   | Val  Loss: 1.9865 | Val  Acc: 0.3095
 Site-Clipart   | Val  Loss: 1.9568 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1205 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1327 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.8184 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 2.0347 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.1723 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.1842 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.8193 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 1.8599 | Val  Acc: 0.5952
 Site-Sketch    | Val  Loss: 1.8855 | Val  Acc: 0.4048
 Site-Sketch    | Val  Loss: 1.9966 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3790
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3095
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Real       | Epoch:0 | Val Acc: 0.5952
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6243 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.6711 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.0518 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.9762 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.4771 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.4856 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.0784 | Train Acc: 0.3016
 Site-QuickDraw | Train Loss: 2.0321 | Train Acc: 0.3492
 Site-Real      | Train Loss: 1.2710 | Train Acc: 0.8730
 Site-Real      | Train Loss: 1.3432 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.4217 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.5481 | Train Acc: 0.6349
 Site-Clipart   | Val  Loss: 1.6851 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.6345 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9059 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 2.0724 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.3286 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.6394 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.9880 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.0612 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.2865 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 1.3742 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5915 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.5412 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6052
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Painting   | Epoch:1 | Val Acc: 0.7857
 Best site-Painting   | Epoch:1 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3571
 Best site-Real       | Epoch:1 | Val Acc: 0.8810
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3126 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.3243 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.9046 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7699 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.1407 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 1.0617 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9460 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 1.8462 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.8217 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.8652 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 1.1884 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.2425 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3744 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3566 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7239 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.9421 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.9868 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.2227 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.7602 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.8971 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.8213 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.9089 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.2213 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.2387 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3571
 Best site-Real       | Epoch:2 | Val Acc: 0.9762
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9770 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0267 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.7670 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5095 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.8044 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.8320 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.8413 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 1.6706 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.5858 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.6068 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8599 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9883 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 1.0048 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0975 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4296 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6461 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6783 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 1.0706 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.5676 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.7283 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.5552 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.6165 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.9420 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.9738 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7302
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Painting   | Epoch:3 | Val Acc: 0.9286
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3571
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7959 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9201 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.6987 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3795 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.6970 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.6468 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.6238 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.4115 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.4037 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.4100 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.6922 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.7941 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9263 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8981 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2710 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7167 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.5871 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.6923 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.3303 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5692 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3979 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3995 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7800 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8465 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7560
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6967 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7451 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.5360 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2823 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.5219 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.5586 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.5491 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.3472 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.3596 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2865 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5975 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.6265 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8122 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7194 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0595 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.6146 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.3287 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6335 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.2199 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.4293 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.2710 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.3216 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7614 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.6580 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7738
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 1.0000
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4286
 Best site-Real       | Epoch:5 | Val Acc: 0.9286
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5286 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6110 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.4435 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.0205 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3549 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3703 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.4747 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 1.1339 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.2231 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1874 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4586 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5445 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.7052 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.5675 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0541 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3667 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.3134 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.5425 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 0.9752 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.2678 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1798 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2360 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5044 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5665 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8135
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Painting   | Epoch:6 | Val Acc: 0.9762
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4352 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6035 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.3665 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9501 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2993 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3006 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1806 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 1.0444 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.1977 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1757 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3788 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5442 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5725 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4705 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8846 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3402 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.1736 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3400 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.8385 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.1943 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1435 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2066 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5150 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.4070 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8472
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5714
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3640 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3827 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1443 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8436 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2511 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2801 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1253 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 0.9649 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.1830 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1137 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3397 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4755 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3781 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3321 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8372 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2041 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1327 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3783 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.8587 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.0852 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0967 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1763 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4011 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4247 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8690
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5952
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2680 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3487 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2515 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.8209 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.2100 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1899 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.0712 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 0.9906 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1754 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1162 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3562 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3649 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5186 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.3144 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.6895 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1335 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1077 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2451 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.8313 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.0878 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0969 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2224 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4577 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.3739 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8571
===2023-03-29 15:40:55===
===2023-03-29 15:40:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.8327
 Test site-Infograph | Epoch:8 | Test Acc: 0.4658
 Test site-Painting  | Epoch:8 | Test Acc: 0.8514
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.5370
 Test site-Real      | Epoch:8 | Test Acc: 0.9310
 Test site-Sketch    | Epoch:8 | Test Acc: 0.8032
Average Test Accuracy: 0.7368
