===2023-03-29 15:07:50===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-Clipart   | Train Loss: 2.0201 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9586 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 2.1828 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1423 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 1.9407 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9481 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 2.2607 | Train Acc: 0.1746
 Site-QuickDraw | Train Loss: 2.1661 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.8317 | Train Acc: 0.5397
 Site-Real      | Train Loss: 1.8814 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.8489 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.9540 | Train Acc: 0.4127
 Site-Clipart   | Val  Loss: 1.9865 | Val  Acc: 0.3095
 Site-Clipart   | Val  Loss: 1.9568 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1205 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1327 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.8184 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 2.0347 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.1723 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.1842 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.8193 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 1.8599 | Val  Acc: 0.5952
 Site-Sketch    | Val  Loss: 1.8855 | Val  Acc: 0.4048
 Site-Sketch    | Val  Loss: 1.9966 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3790
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3095
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Real       | Epoch:0 | Val Acc: 0.5952
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6243 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.6711 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.0518 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.9762 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.4771 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.4856 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.0784 | Train Acc: 0.3016
 Site-QuickDraw | Train Loss: 2.0321 | Train Acc: 0.3492
 Site-Real      | Train Loss: 1.2710 | Train Acc: 0.8730
 Site-Real      | Train Loss: 1.3432 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.4217 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.5481 | Train Acc: 0.6349
 Site-Clipart   | Val  Loss: 1.6851 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.6345 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9059 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 2.0724 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.3286 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.6394 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.9880 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.0612 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.2865 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 1.3742 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5915 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.5412 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6052
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Painting   | Epoch:1 | Val Acc: 0.7857
 Best site-Painting   | Epoch:1 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3571
 Best site-Real       | Epoch:1 | Val Acc: 0.8810
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3126 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.3243 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.9046 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7699 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.1407 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 1.0617 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9460 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 1.8462 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.8217 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.8652 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 1.1884 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.2425 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3744 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3566 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7239 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.9421 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.9868 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.2227 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.7602 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.8971 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.8213 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.9089 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.2213 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.2387 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3571
 Best site-Real       | Epoch:2 | Val Acc: 0.9762
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9770 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0267 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.7670 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5095 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.8044 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.8320 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.8413 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 1.6706 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.5858 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.6068 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8599 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9883 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 1.0048 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0975 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4296 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6461 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6783 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 1.0706 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.5676 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.7283 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.5552 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.6165 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.9420 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.9738 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7302
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Painting   | Epoch:3 | Val Acc: 0.9286
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3571
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7959 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9201 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.6987 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3795 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.6970 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.6468 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.6238 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.4115 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.4037 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.4100 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.6922 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.7941 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9263 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8981 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2710 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7167 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.5871 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.6923 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.3303 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5692 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3979 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3995 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7800 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8465 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7560
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6967 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7451 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.5360 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2823 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.5219 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.5586 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.5491 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.3472 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.3596 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2865 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5975 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.6265 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8122 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7194 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0595 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.6146 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.3287 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6335 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.2199 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.4293 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.2710 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.3216 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7614 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.6580 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7738
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 1.0000
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4286
 Best site-Real       | Epoch:5 | Val Acc: 0.9286
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5286 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6110 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.4435 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.0205 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3549 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3703 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.4747 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 1.1339 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.2231 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1874 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4586 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5445 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.7052 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.5675 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0541 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3667 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.3134 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.5425 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 0.9752 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.2678 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1798 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2360 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5044 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5665 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8135
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Painting   | Epoch:6 | Val Acc: 0.9762
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4352 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6035 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.3665 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9501 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2993 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3006 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1806 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 1.0444 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.1977 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1757 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3788 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5442 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5725 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4705 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8846 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3402 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.1736 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3400 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.8385 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.1943 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1435 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2066 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5150 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.4070 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8472
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5714
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3640 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3827 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1443 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8436 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2511 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2801 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1253 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 0.9649 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.1830 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1137 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3397 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4755 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3781 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3321 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8372 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2041 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1327 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3783 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.8587 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.0852 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0967 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1763 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4011 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4247 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8690
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5952
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2680 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3487 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2515 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.8209 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.2100 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1899 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.0712 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 0.9906 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1754 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1162 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3562 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3649 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5186 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.3144 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.6895 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1335 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1077 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2451 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.8313 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.0878 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0969 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2224 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4577 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.3739 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8571
===2023-03-29 15:40:55===
===2023-03-29 15:40:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.8327
 Test site-Infograph | Epoch:8 | Test Acc: 0.4658
 Test site-Painting  | Epoch:8 | Test Acc: 0.8514
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.5370
 Test site-Real      | Epoch:8 | Test Acc: 0.9310
 Test site-Sketch    | Epoch:8 | Test Acc: 0.8032
Average Test Accuracy: 0.7368
===2023-03-30 21:16:19===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-2
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
only align at first round
 Site-Clipart   | Train Loss: 2.0216 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9415 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1963 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1562 | Train Acc: 0.2540
 Site-Painting  | Train Loss: 1.9737 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.9550 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2707 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 2.2045 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.8477 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.9170 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 1.9669 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.9723 | Train Acc: 0.4921
 Site-Clipart   | Val  Loss: 1.9646 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9586 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1356 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1378 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8990 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.0608 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1944 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2238 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.8754 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.9531 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9364 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0324 | Val  Acc: 0.4762
Average Valid Accuracy: 0.3968
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2619
 Best site-Real       | Epoch:0 | Val Acc: 0.4762
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(5,)(4,)(3,)]
 Site-Clipart   | Train Loss: 1.6965 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.6377 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 2.1076 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.0099 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.4852 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.4527 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.1551 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 2.0511 | Train Acc: 0.3492
 Site-Real      | Train Loss: 1.3082 | Train Acc: 0.7937
 Site-Real      | Train Loss: 1.3848 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.5066 | Train Acc: 0.6349
 Site-Sketch    | Train Loss: 1.5176 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.7139 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6832 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9427 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1544 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.3409 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.6562 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.0309 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1007 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.3561 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 1.3665 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.5771 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.5592 | Val  Acc: 0.6905
Average Valid Accuracy: 0.5516
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Painting   | Epoch:1 | Val Acc: 0.7381
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 1.2946 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3279 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.9517 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.7597 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.0670 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.0760 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9910 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 1.8541 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.8633 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.9673 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.1855 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.1725 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4029 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4018 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7501 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9713 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.9592 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 1.2209 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7927 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.8746 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.8849 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.9160 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.2320 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.3039 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6706
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Painting   | Epoch:2 | Val Acc: 0.9286
 Best site-Painting   | Epoch:2 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4048
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 1.0981 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.0728 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.7649 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5512 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.7864 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8200 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.8287 | Train Acc: 0.3333
 Site-QuickDraw | Train Loss: 1.7039 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.6368 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.6316 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.9022 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 0.9893 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1466 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0489 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4372 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8462 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.7681 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.0336 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7472 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.8029 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.6268 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.6328 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9311 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.9782 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7063
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3571
 Best site-Painting   | Epoch:3 | Val Acc: 0.8571
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Real       | Epoch:3 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 0.8268 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.8777 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.5414 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3550 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.6147 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.6729 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.6427 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.4934 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.4837 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.4446 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.8097 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 0.8325 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1000 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 0.8778 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2128 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6617 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.6103 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.7743 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4643 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.6796 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.4034 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.4558 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.8906 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.7925 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7361
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4524
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5238
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 0.6195 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7826 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.5923 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2931 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5037 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.5892 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.3845 | Train Acc: 0.6349
 Site-QuickDraw | Train Loss: 1.2644 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.3577 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.3090 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.6666 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.6540 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.7835 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.6773 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0738 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4275 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4881 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.6749 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.1666 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.3604 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.2800 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3509 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7511 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.6191 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7937
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6429
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 0.4790 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7324 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.3636 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0577 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.3977 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3789 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.2908 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.1613 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.3466 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.2192 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.5823 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.5880 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7509 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6602 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9317 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4644 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.3904 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.4748 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.1507 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.2756 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2665 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2523 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.6009 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.6659 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7837
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 0.3455 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5564 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.2234 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9652 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.3410 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3165 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.2297 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.1071 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2701 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1616 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4069 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4656 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.6071 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.4927 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0537 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.3213 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.2533 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3911 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.0288 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2330 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1645 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2211 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4654 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3751 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8075
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5476
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-Painting   | Epoch:7 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5714
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 0.2819 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4021 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.0931 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8863 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2566 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2554 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.1360 | Train Acc: 0.6349
 Site-QuickDraw | Train Loss: 0.9697 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.2452 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1295 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2874 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4013 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.4292 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3665 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7296 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.2547 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.2473 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3202 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.7900 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.0244 | Val  Acc: 0.7857
 Site-Real      | Val  Loss: 0.1373 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1764 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3545 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3901 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8690
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5952
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-Painting   | Epoch:8 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7857
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
clients=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 0.3008 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4758 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.1915 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9613 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.1937 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1951 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.0514 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 0.8003 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.1339 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1315 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3001 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.2887 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.4988 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3047 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6870 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9947 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.1993 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2062 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.7984 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 0.9264 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.1195 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1289 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4813 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.4108 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7143
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
===2023-03-30 21:48:41===
===2023-03-30 21:48:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8175
 Test site-Infograph | Epoch:9 | Test Acc: 0.4642
 Test site-Painting  | Epoch:9 | Test Acc: 0.8417
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5380
 Test site-Real      | Epoch:9 | Test Acc: 0.9285
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7960
Average Test Accuracy: 0.7310
===2023-03-30 22:52:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 22:52:09===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 22:53:11===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 22:54:15===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 22:57:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 22:57:17===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 0
    tune: False
    lambda for constrastive: 0.5
domain number = 3
===2023-03-30 22:57:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 0
    tune: False
    lambda for constrastive: 0.5
domain number = 3
===2023-03-30 23:02:16===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 0
    tune: False
    lambda for constrastive: 0.5
domain number = 3
===2023-03-30 23:04:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 0
    tune: False
    lambda for constrastive: 0.5
domain number = 3
===2023-03-30 23:04:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 1
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 23:18:35===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
===2023-03-30 23:24:04===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 23:24:12===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-11 is in G-2
client-11 is in G-1
client-11 is in G-2
client-11 is in G-2
client-11 is in G-2
client-11 is in G-0
client-11 is in G-2
client-11 is in G-2
client-11 is in G-1
client-11 is in G-2
client-11 is in G-2
client-11 is in G-1
 Site-Clipart   | Train Loss: 2.0179 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 1.9309 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.1871 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1522 | Train Acc: 0.2540
 Site-Painting  | Train Loss: 1.9616 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.9428 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2653 | Train Acc: 0.2063
 Site-QuickDraw | Train Loss: 2.2028 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.8395 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.9215 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.9573 | Train Acc: 0.4762
 Site-Sketch    | Train Loss: 1.9686 | Train Acc: 0.4921
 Site-Clipart   | Val  Loss: 1.9594 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.9440 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.1288 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1379 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8822 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 2.0555 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1998 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2208 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8772 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.9544 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9262 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 2.0252 | Val  Acc: 0.4524
Average Valid Accuracy: 0.3948
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.4048
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
cnt=[(2,)(3,)(7,)]
client-11 is in G-2
client-11 is in G-1
client-11 is in G-0
client-11 is in G-2
client-11 is in G-2
client-11 is in G-0
client-11 is in G-2
client-11 is in G-2
client-11 is in G-1
client-11 is in G-2
client-11 is in G-2
client-11 is in G-1
 Site-Clipart   | Train Loss: 1.6966 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6450 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.1148 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.0180 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.5004 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.4678 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.1462 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 2.0542 | Train Acc: 0.3016
 Site-Real      | Train Loss: 1.3127 | Train Acc: 0.7937
 Site-Real      | Train Loss: 1.3926 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.5117 | Train Acc: 0.6190
 Site-Sketch    | Train Loss: 1.5293 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.7165 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.6831 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9458 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1540 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.3451 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.6720 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.0403 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1005 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.3681 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 1.3736 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5927 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.5740 | Val  Acc: 0.6429
Average Valid Accuracy: 0.5437
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.7857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-align/FedPrompt...
===2023-03-30 23:30:37===
