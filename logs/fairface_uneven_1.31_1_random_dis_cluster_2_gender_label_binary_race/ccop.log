===2023-06-06 23:17:47===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0.4
    std_rw: False
    gender_label: True
    binary_race: True
    save_iter: -1
data_number=[37,49,65,86,112,148,194,256,334,439,148,196,]
client_nums=[10,2,]
label set of clients: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, ]
domain number = 2
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.01793, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.6933 | Train Acc: 0.5676
 Site-White_1                  | Train Loss: 0.6234 | Train Acc: 0.7551
 Site-White_2                  | Train Loss: 0.5971 | Train Acc: 0.7692
 Site-White_3                  | Train Loss: 0.6441 | Train Acc: 0.6628
 Site-White_4                  | Train Loss: 0.6296 | Train Acc: 0.6964
 Site-White_5                  | Train Loss: 0.6357 | Train Acc: 0.7297
 Site-White_6                  | Train Loss: 0.6528 | Train Acc: 0.6546
 Site-White_7                  | Train Loss: 0.6449 | Train Acc: 0.6602
 Site-White_8                  | Train Loss: 0.6322 | Train Acc: 0.7156
 Site-White_9                  | Train Loss: 0.6250 | Train Acc: 0.7198
 Site-Black_0                  | Train Loss: 0.6843 | Train Acc: 0.5743
 Site-Black_1                  | Train Loss: 0.6571 | Train Acc: 0.6327
 Site-White_0                   (0) | Val  Loss: 0.7659 | Val  Acc: 0.5000
 Site-White_1                   (0) | Val  Loss: 0.6275 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.6473 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.6408 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.6842 | Val  Acc: 0.5862
 Site-White_5                   (0) | Val  Loss: 0.6534 | Val  Acc: 0.6842
 Site-White_6                   (0) | Val  Loss: 0.6336 | Val  Acc: 0.6735
 Site-White_7                   (0) | Val  Loss: 0.6422 | Val  Acc: 0.6250
 Site-White_8                   (0) | Val  Loss: 0.6253 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.6528 | Val  Acc: 0.6273
 Site-Black_0                   (1) | Val  Loss: 0.7042 | Val  Acc: 0.4474
 Site-Black_1                   (1) | Val  Loss: 0.6672 | Val  Acc: 0.5510
Average Valid Accuracy: 0.6315
 Best site-White_0                  (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-White_1                  (0)  | Epoch:0 | Val Acc: 0.7692
 Best site-White_2                  (0)  | Epoch:0 | Val Acc: 0.7059
 Best site-White_3                  (0)  | Epoch:0 | Val Acc: 0.6818
 Best site-White_4                  (0)  | Epoch:0 | Val Acc: 0.5862
 Best site-White_5                  (0)  | Epoch:0 | Val Acc: 0.6842
 Best site-White_6                  (0)  | Epoch:0 | Val Acc: 0.6735
 Best site-White_7                  (0)  | Epoch:0 | Val Acc: 0.6250
 Best site-White_8                  (0)  | Epoch:0 | Val Acc: 0.7262
 Best site-White_9                  (0)  | Epoch:0 | Val Acc: 0.6273
 Best site-Black_0                  (1)  | Epoch:0 | Val Acc: 0.4474
 Best site-Black_1                  (1)  | Epoch:0 | Val Acc: 0.5510
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 1 ============
cnt=[11, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.00852, quan_i=0.63, quan_c=0.64
minimize weight of clients:[1, ]
 Site-White_0                  | Train Loss: 0.5445 | Train Acc: 0.6486
 Site-White_1                  | Train Loss: 0.5756 | Train Acc: 0.7551
 Site-White_2                  | Train Loss: 0.6473 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5935 | Train Acc: 0.6512
 Site-White_4                  | Train Loss: 0.5671 | Train Acc: 0.7679
 Site-White_5                  | Train Loss: 0.5723 | Train Acc: 0.7162
 Site-White_6                  | Train Loss: 0.5753 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.5914 | Train Acc: 0.7070
 Site-White_8                  | Train Loss: 0.5720 | Train Acc: 0.7425
 Site-White_9                  | Train Loss: 0.5368 | Train Acc: 0.7745
 Site-Black_0                  | Train Loss: 0.6414 | Train Acc: 0.6284
 Site-Black_1                  | Train Loss: 0.5997 | Train Acc: 0.6071
 Site-White_0                   (0) | Val  Loss: 0.5632 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.5937 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.6130 | Val  Acc: 0.6471
 Site-White_3                   (0) | Val  Loss: 0.5417 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.6022 | Val  Acc: 0.6552
 Site-White_5                   (0) | Val  Loss: 0.6089 | Val  Acc: 0.6842
 Site-White_6                   (0) | Val  Loss: 0.5678 | Val  Acc: 0.6735
 Site-White_7                   (0) | Val  Loss: 0.5458 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.5574 | Val  Acc: 0.6905
 Site-White_9                   (0) | Val  Loss: 0.5674 | Val  Acc: 0.7455
 Site-Black_0                   (0) | Val  Loss: 0.7076 | Val  Acc: 0.5526
 Site-Black_1                   (0) | Val  Loss: 0.6125 | Val  Acc: 0.6735
Average Valid Accuracy: 0.6947
 Best site-White_0                  (0)  | Epoch:1 | Val Acc: 0.8000
 Best site-White_1                  (1)  | Epoch:1 | Val Acc: 0.6923
 Best site-White_2                  (0)  | Epoch:1 | Val Acc: 0.6471
 Best site-White_3                  (0)  | Epoch:1 | Val Acc: 0.7727
 Best site-White_4                  (0)  | Epoch:1 | Val Acc: 0.6552
 Best site-White_5                  (0)  | Epoch:1 | Val Acc: 0.6842
 Best site-White_6                  (0)  | Epoch:1 | Val Acc: 0.6735
 Best site-White_7                  (0)  | Epoch:1 | Val Acc: 0.7500
 Best site-White_8                  (0)  | Epoch:1 | Val Acc: 0.6905
 Best site-White_9                  (0)  | Epoch:1 | Val Acc: 0.7455
 Best site-Black_0                  (0)  | Epoch:1 | Val Acc: 0.5526
 Best site-Black_1                  (0)  | Epoch:1 | Val Acc: 0.6735
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 11, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.00535, quan_i=0.58, quan_c=0.58
minimize weight of clients:[0, ]
 Site-White_0                  | Train Loss: 0.4323 | Train Acc: 0.7297
 Site-White_1                  | Train Loss: 0.4964 | Train Acc: 0.7959
 Site-White_2                  | Train Loss: 0.3603 | Train Acc: 0.8923
 Site-White_3                  | Train Loss: 0.5179 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.4809 | Train Acc: 0.7679
 Site-White_5                  | Train Loss: 0.4981 | Train Acc: 0.7568
 Site-White_6                  | Train Loss: 0.5209 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.5479 | Train Acc: 0.6914
 Site-White_8                  | Train Loss: 0.5152 | Train Acc: 0.7545
 Site-White_9                  | Train Loss: 0.4780 | Train Acc: 0.7813
 Site-Black_0                  | Train Loss: 0.6364 | Train Acc: 0.6622
 Site-Black_1                  | Train Loss: 0.6170 | Train Acc: 0.6480
 Site-White_0                   (0) | Val  Loss: 0.5297 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.5476 | Val  Acc: 0.6923
 Site-White_2                   (1) | Val  Loss: 0.5837 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.6017 | Val  Acc: 0.6818
 Site-White_4                   (1) | Val  Loss: 0.5894 | Val  Acc: 0.6552
 Site-White_5                   (1) | Val  Loss: 0.6460 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4992 | Val  Acc: 0.7959
 Site-White_7                   (1) | Val  Loss: 0.5396 | Val  Acc: 0.7188
 Site-White_8                   (1) | Val  Loss: 0.5029 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.5145 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.8066 | Val  Acc: 0.5789
 Site-Black_1                   (1) | Val  Loss: 0.6511 | Val  Acc: 0.6122
Average Valid Accuracy: 0.6983
 Best site-White_0                  (0)  | Epoch:2 | Val Acc: 0.7000
 Best site-White_1                  (1)  | Epoch:2 | Val Acc: 0.6923
 Best site-White_2                  (1)  | Epoch:2 | Val Acc: 0.7059
 Best site-White_3                  (1)  | Epoch:2 | Val Acc: 0.6818
 Best site-White_4                  (1)  | Epoch:2 | Val Acc: 0.6552
 Best site-White_5                  (1)  | Epoch:2 | Val Acc: 0.7368
 Best site-White_6                  (1)  | Epoch:2 | Val Acc: 0.7959
 Best site-White_7                  (1)  | Epoch:2 | Val Acc: 0.7188
 Best site-White_8                  (1)  | Epoch:2 | Val Acc: 0.7381
 Best site-White_9                  (1)  | Epoch:2 | Val Acc: 0.7636
 Best site-Black_0                  (1)  | Epoch:2 | Val Acc: 0.5789
 Best site-Black_1                  (1)  | Epoch:2 | Val Acc: 0.6122
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 3 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.00353, quan_i=0.50, quan_c=0.50
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4396 | Train Acc: 0.7297
 Site-White_1                  | Train Loss: 0.5311 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2856 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4957 | Train Acc: 0.7442
 Site-White_4                  | Train Loss: 0.4500 | Train Acc: 0.7411
 Site-White_5                  | Train Loss: 0.5038 | Train Acc: 0.7635
 Site-White_6                  | Train Loss: 0.5551 | Train Acc: 0.7113
 Site-White_7                  | Train Loss: 0.5297 | Train Acc: 0.7031
 Site-White_8                  | Train Loss: 0.4596 | Train Acc: 0.7964
 Site-White_9                  | Train Loss: 0.4527 | Train Acc: 0.7790
 Site-Black_0                  | Train Loss: 0.5701 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.6422 | Train Acc: 0.6480
 Site-White_0                   (0) | Val  Loss: 0.4590 | Val  Acc: 0.9000
 Site-White_1                   (0) | Val  Loss: 0.3831 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5937 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.4948 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.5134 | Val  Acc: 0.7586
 Site-White_5                   (0) | Val  Loss: 0.6631 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4735 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.5004 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4844 | Val  Acc: 0.7381
 Site-White_9                   (0) | Val  Loss: 0.5336 | Val  Acc: 0.7091
 Site-Black_0                   (1) | Val  Loss: 0.7844 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.6771 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7456
 Best site-White_0                  (0)  | Epoch:3 | Val Acc: 0.9000
 Best site-White_1                  (0)  | Epoch:3 | Val Acc: 0.8462
 Best site-White_2                  (0)  | Epoch:3 | Val Acc: 0.7059
 Best site-White_3                  (0)  | Epoch:3 | Val Acc: 0.7273
 Best site-White_4                  (0)  | Epoch:3 | Val Acc: 0.7586
 Best site-White_5                  (0)  | Epoch:3 | Val Acc: 0.7105
 Best site-White_6                  (0)  | Epoch:3 | Val Acc: 0.8163
 Best site-White_7                  (0)  | Epoch:3 | Val Acc: 0.7500
 Best site-White_8                  (0)  | Epoch:3 | Val Acc: 0.7381
 Best site-White_9                  (0)  | Epoch:3 | Val Acc: 0.7091
 Best site-Black_0                  (1)  | Epoch:3 | Val Acc: 0.6316
 Best site-Black_1                  (1)  | Epoch:3 | Val Acc: 0.6531
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 4 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.00318, quan_i=0.48, quan_c=0.48
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4688 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.5295 | Train Acc: 0.7959
 Site-White_2                  | Train Loss: 0.2991 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.5089 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.4530 | Train Acc: 0.7589
 Site-White_5                  | Train Loss: 0.4295 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.6203 | Train Acc: 0.7371
 Site-White_7                  | Train Loss: 0.5238 | Train Acc: 0.7188
 Site-White_8                  | Train Loss: 0.4687 | Train Acc: 0.7784
 Site-White_9                  | Train Loss: 0.4410 | Train Acc: 0.8018
 Site-Black_0                  | Train Loss: 0.5902 | Train Acc: 0.6757
 Site-Black_1                  | Train Loss: 0.6510 | Train Acc: 0.6684
 Site-White_0                   (0) | Val  Loss: 0.4719 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.4272 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.6106 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.5376 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.5255 | Val  Acc: 0.6897
 Site-White_5                   (0) | Val  Loss: 0.6765 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4502 | Val  Acc: 0.7959
 Site-White_7                   (0) | Val  Loss: 0.4990 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4583 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4802 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.7907 | Val  Acc: 0.6842
 Site-Black_1                   (1) | Val  Loss: 0.7585 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7261
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 5 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.00353, quan_i=0.47, quan_c=0.48
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4020 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.5323 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2790 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.5237 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.4320 | Train Acc: 0.7679
 Site-White_5                  | Train Loss: 0.4482 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.5232 | Train Acc: 0.7165
 Site-White_7                  | Train Loss: 0.5038 | Train Acc: 0.7422
 Site-White_8                  | Train Loss: 0.4304 | Train Acc: 0.7964
 Site-White_9                  | Train Loss: 0.4403 | Train Acc: 0.7722
 Site-Black_0                  | Train Loss: 0.6135 | Train Acc: 0.6757
 Site-Black_1                  | Train Loss: 0.5505 | Train Acc: 0.6786
 Site-White_0                   (1) | Val  Loss: 0.5228 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3739 | Val  Acc: 0.9231
 Site-White_2                   (1) | Val  Loss: 0.6528 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5974 | Val  Acc: 0.6818
 Site-White_4                   (1) | Val  Loss: 0.5570 | Val  Acc: 0.7586
 Site-White_5                   (1) | Val  Loss: 0.6324 | Val  Acc: 0.6842
 Site-White_6                   (1) | Val  Loss: 0.4547 | Val  Acc: 0.7755
 Site-White_7                   (1) | Val  Loss: 0.4678 | Val  Acc: 0.8125
 Site-White_8                   (1) | Val  Loss: 0.4399 | Val  Acc: 0.8214
 Site-White_9                   (1) | Val  Loss: 0.5222 | Val  Acc: 0.7455
 Site-Black_0                   (0) | Val  Loss: 0.9136 | Val  Acc: 0.6579
 Site-Black_1                   (0) | Val  Loss: 0.6723 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7514
 Best site-White_0                  (1)  | Epoch:5 | Val Acc: 0.7000
 Best site-White_1                  (1)  | Epoch:5 | Val Acc: 0.9231
 Best site-White_2                  (1)  | Epoch:5 | Val Acc: 0.8235
 Best site-White_3                  (1)  | Epoch:5 | Val Acc: 0.6818
 Best site-White_4                  (1)  | Epoch:5 | Val Acc: 0.7586
 Best site-White_5                  (1)  | Epoch:5 | Val Acc: 0.6842
 Best site-White_6                  (1)  | Epoch:5 | Val Acc: 0.7755
 Best site-White_7                  (1)  | Epoch:5 | Val Acc: 0.8125
 Best site-White_8                  (1)  | Epoch:5 | Val Acc: 0.8214
 Best site-White_9                  (1)  | Epoch:5 | Val Acc: 0.7455
 Best site-Black_0                  (0)  | Epoch:5 | Val Acc: 0.6579
 Best site-Black_1                  (0)  | Epoch:5 | Val Acc: 0.6327
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.00311, quan_i=0.44, quan_c=0.46
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3899 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4749 | Train Acc: 0.7755
 Site-White_2                  | Train Loss: 0.2414 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.5069 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.4260 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.4459 | Train Acc: 0.7973
 Site-White_6                  | Train Loss: 0.4711 | Train Acc: 0.7526
 Site-White_7                  | Train Loss: 0.5256 | Train Acc: 0.7305
 Site-White_8                  | Train Loss: 0.4287 | Train Acc: 0.8054
 Site-White_9                  | Train Loss: 0.4461 | Train Acc: 0.7882
 Site-Black_0                  | Train Loss: 0.5572 | Train Acc: 0.7027
 Site-Black_1                  | Train Loss: 0.5450 | Train Acc: 0.6837
 Site-White_0                   (1) | Val  Loss: 0.5986 | Val  Acc: 0.5000
 Site-White_1                   (1) | Val  Loss: 0.4947 | Val  Acc: 0.6923
 Site-White_2                   (1) | Val  Loss: 0.4890 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5322 | Val  Acc: 0.6818
 Site-White_4                   (1) | Val  Loss: 0.4508 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.6726 | Val  Acc: 0.6842
 Site-White_6                   (1) | Val  Loss: 0.4132 | Val  Acc: 0.8571
 Site-White_7                   (1) | Val  Loss: 0.5302 | Val  Acc: 0.7500
 Site-White_8                   (1) | Val  Loss: 0.5006 | Val  Acc: 0.7738
 Site-White_9                   (1) | Val  Loss: 0.5177 | Val  Acc: 0.7455
 Site-Black_0                   (0) | Val  Loss: 0.7865 | Val  Acc: 0.6053
 Site-Black_1                   (0) | Val  Loss: 0.6798 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7145
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 7 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.00262, quan_i=0.45, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3675 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4605 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.3308 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5260 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.4014 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4067 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.5857 | Train Acc: 0.7216
 Site-White_7                  | Train Loss: 0.5050 | Train Acc: 0.7305
 Site-White_8                  | Train Loss: 0.4122 | Train Acc: 0.7904
 Site-White_9                  | Train Loss: 0.4236 | Train Acc: 0.8109
 Site-Black_0                  | Train Loss: 0.5788 | Train Acc: 0.6622
 Site-Black_1                  | Train Loss: 0.6423 | Train Acc: 0.6633
 Site-White_0                   (0) | Val  Loss: 0.4821 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3589 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5762 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.5801 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4657 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5779 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4566 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4927 | Val  Acc: 0.7812
 Site-White_8                   (0) | Val  Loss: 0.4709 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.4906 | Val  Acc: 0.7364
 Site-Black_0                   (1) | Val  Loss: 0.7836 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.6528 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7517
 Best site-White_0                  (0)  | Epoch:7 | Val Acc: 0.8000
 Best site-White_1                  (0)  | Epoch:7 | Val Acc: 0.8462
 Best site-White_2                  (0)  | Epoch:7 | Val Acc: 0.7059
 Best site-White_3                  (0)  | Epoch:7 | Val Acc: 0.7727
 Best site-White_4                  (0)  | Epoch:7 | Val Acc: 0.7931
 Best site-White_5                  (0)  | Epoch:7 | Val Acc: 0.7368
 Best site-White_6                  (0)  | Epoch:7 | Val Acc: 0.8163
 Best site-White_7                  (0)  | Epoch:7 | Val Acc: 0.7812
 Best site-White_8                  (0)  | Epoch:7 | Val Acc: 0.7262
 Best site-White_9                  (0)  | Epoch:7 | Val Acc: 0.7364
 Best site-Black_0                  (1)  | Epoch:7 | Val Acc: 0.6316
 Best site-Black_1                  (1)  | Epoch:7 | Val Acc: 0.6735
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 8 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.00275, quan_i=0.42, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4920 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.5303 | Train Acc: 0.7347
 Site-White_2                  | Train Loss: 0.4942 | Train Acc: 0.7846
 Site-White_3                  | Train Loss: 0.4817 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.4069 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.4105 | Train Acc: 0.8041
 Site-White_6                  | Train Loss: 0.4786 | Train Acc: 0.7320
 Site-White_7                  | Train Loss: 0.5030 | Train Acc: 0.7539
 Site-White_8                  | Train Loss: 0.4117 | Train Acc: 0.8024
 Site-White_9                  | Train Loss: 0.4214 | Train Acc: 0.7882
 Site-Black_0                  | Train Loss: 0.5417 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5760 | Train Acc: 0.6684
 Site-White_0                   (0) | Val  Loss: 0.3603 | Val  Acc: 0.9000
 Site-White_1                   (0) | Val  Loss: 0.3725 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4890 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5467 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.4813 | Val  Acc: 0.7241
 Site-White_5                   (0) | Val  Loss: 0.6205 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4562 | Val  Acc: 0.7347
 Site-White_7                   (0) | Val  Loss: 0.4750 | Val  Acc: 0.7812
 Site-White_8                   (0) | Val  Loss: 0.5042 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.5261 | Val  Acc: 0.7455
 Site-Black_0                   (1) | Val  Loss: 0.6761 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.7923 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7509
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 9 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.00409, quan_i=0.48, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4458 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.4422 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.3645 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4850 | Train Acc: 0.7209
 Site-White_4                  | Train Loss: 0.4189 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.4098 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.5031 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.4814 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.4030 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3996 | Train Acc: 0.8041
 Site-Black_0                  | Train Loss: 0.5951 | Train Acc: 0.6554
 Site-Black_1                  | Train Loss: 0.6315 | Train Acc: 0.6735
 Site-White_0                   (0) | Val  Loss: 0.4767 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3879 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4298 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5643 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.5419 | Val  Acc: 0.7241
 Site-White_5                   (0) | Val  Loss: 0.5156 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4224 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4873 | Val  Acc: 0.7344
 Site-White_8                   (0) | Val  Loss: 0.5237 | Val  Acc: 0.7143
 Site-White_9                   (0) | Val  Loss: 0.4975 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.8115 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.6963 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7390
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 10 ============
cnt=[9, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.00334, quan_i=0.43, quan_c=0.49
minimize weight of clients:[5, 9, ]
 Site-White_0                  | Train Loss: 0.4435 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4335 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2918 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4702 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.4121 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.4249 | Train Acc: 0.8108
 Site-White_6                  | Train Loss: 0.4575 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4666 | Train Acc: 0.7500
 Site-White_8                  | Train Loss: 0.3977 | Train Acc: 0.7994
 Site-White_9                  | Train Loss: 0.4264 | Train Acc: 0.7927
 Site-Black_0                  | Train Loss: 0.5833 | Train Acc: 0.6757
 Site-Black_1                  | Train Loss: 0.5801 | Train Acc: 0.6735
 Site-White_0                   (1) | Val  Loss: 0.5724 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.4412 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.5883 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5715 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4676 | Val  Acc: 0.7586
 Site-White_5                   (1) | Val  Loss: 0.4988 | Val  Acc: 0.8158
 Site-White_6                   (0) | Val  Loss: 0.4149 | Val  Acc: 0.8571
 Site-White_7                   (0) | Val  Loss: 0.4714 | Val  Acc: 0.7969
 Site-White_8                   (0) | Val  Loss: 0.4630 | Val  Acc: 0.7738
 Site-White_9                   (1) | Val  Loss: 0.5314 | Val  Acc: 0.7273
 Site-Black_0                   (0) | Val  Loss: 0.7710 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.6529 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7431
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 11 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.00345, quan_i=0.43, quan_c=0.43
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3718 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.5206 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2669 | Train Acc: 0.8000
 Site-White_3                  | Train Loss: 0.4984 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3900 | Train Acc: 0.8393
 Site-White_5                  | Train Loss: 0.4230 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4775 | Train Acc: 0.7320
 Site-White_7                  | Train Loss: 0.4853 | Train Acc: 0.7422
 Site-White_8                  | Train Loss: 0.3981 | Train Acc: 0.8114
 Site-White_9                  | Train Loss: 0.4159 | Train Acc: 0.8041
 Site-Black_0                  | Train Loss: 0.5296 | Train Acc: 0.7365
 Site-Black_1                  | Train Loss: 0.5173 | Train Acc: 0.7398
 Site-White_0                   (1) | Val  Loss: 0.4429 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.4115 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.5371 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.6571 | Val  Acc: 0.6364
 Site-White_4                   (1) | Val  Loss: 0.4894 | Val  Acc: 0.7586
 Site-White_5                   (1) | Val  Loss: 0.5249 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4404 | Val  Acc: 0.7755
 Site-White_7                   (1) | Val  Loss: 0.4745 | Val  Acc: 0.7188
 Site-White_8                   (1) | Val  Loss: 0.4715 | Val  Acc: 0.7738
 Site-White_9                   (1) | Val  Loss: 0.4911 | Val  Acc: 0.7545
 Site-Black_0                   (0) | Val  Loss: 0.7368 | Val  Acc: 0.5526
 Site-Black_1                   (0) | Val  Loss: 0.6861 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7113
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 12 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.00277, quan_i=0.42, quan_c=0.43
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4121 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4247 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.3356 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4623 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.4215 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.4034 | Train Acc: 0.8514
 Site-White_6                  | Train Loss: 0.5343 | Train Acc: 0.7526
 Site-White_7                  | Train Loss: 0.4870 | Train Acc: 0.7461
 Site-White_8                  | Train Loss: 0.3921 | Train Acc: 0.8323
 Site-White_9                  | Train Loss: 0.4004 | Train Acc: 0.7995
 Site-Black_0                  | Train Loss: 0.5336 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5933 | Train Acc: 0.6888
 Site-White_0                   (0) | Val  Loss: 0.5524 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3184 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5071 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.4858 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4927 | Val  Acc: 0.7586
 Site-White_5                   (0) | Val  Loss: 0.6372 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4561 | Val  Acc: 0.7959
 Site-White_7                   (0) | Val  Loss: 0.4614 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4839 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4325 | Val  Acc: 0.7727
 Site-Black_0                   (1) | Val  Loss: 0.8827 | Val  Acc: 0.6053
 Site-Black_1                   (1) | Val  Loss: 0.6633 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7279
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 13 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.00316, quan_i=0.42, quan_c=0.43
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4823 | Train Acc: 0.8919
 Site-White_1                  | Train Loss: 0.3968 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2458 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4974 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3780 | Train Acc: 0.8393
 Site-White_5                  | Train Loss: 0.3865 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.4889 | Train Acc: 0.7526
 Site-White_7                  | Train Loss: 0.4766 | Train Acc: 0.7461
 Site-White_8                  | Train Loss: 0.3886 | Train Acc: 0.8234
 Site-White_9                  | Train Loss: 0.4134 | Train Acc: 0.7973
 Site-Black_0                  | Train Loss: 0.5660 | Train Acc: 0.6892
 Site-Black_1                  | Train Loss: 0.6290 | Train Acc: 0.6939
 Site-White_0                   (0) | Val  Loss: 0.5969 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3290 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5426 | Val  Acc: 0.8824
 Site-White_3                   (0) | Val  Loss: 0.5431 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.5074 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5683 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4361 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4846 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4653 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4613 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.7035 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.6925 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7575
 Best site-White_0                  (0)  | Epoch:13 | Val Acc: 0.6000
 Best site-White_1                  (0)  | Epoch:13 | Val Acc: 0.8462
 Best site-White_2                  (0)  | Epoch:13 | Val Acc: 0.8824
 Best site-White_3                  (0)  | Epoch:13 | Val Acc: 0.6818
 Best site-White_4                  (0)  | Epoch:13 | Val Acc: 0.8276
 Best site-White_5                  (0)  | Epoch:13 | Val Acc: 0.7368
 Best site-White_6                  (0)  | Epoch:13 | Val Acc: 0.8163
 Best site-White_7                  (0)  | Epoch:13 | Val Acc: 0.7656
 Best site-White_8                  (0)  | Epoch:13 | Val Acc: 0.7738
 Best site-White_9                  (0)  | Epoch:13 | Val Acc: 0.7545
 Best site-Black_0                  (1)  | Epoch:13 | Val Acc: 0.7105
 Best site-Black_1                  (1)  | Epoch:13 | Val Acc: 0.6939
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.00293, quan_i=0.40, quan_c=0.42
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5673 | Train Acc: 0.7027
 Site-White_1                  | Train Loss: 0.4239 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.7728 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4334 | Train Acc: 0.8140
 Site-White_4                  | Train Loss: 0.4060 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4221 | Train Acc: 0.7905
 Site-White_6                  | Train Loss: 0.4992 | Train Acc: 0.7474
 Site-White_7                  | Train Loss: 0.4826 | Train Acc: 0.7500
 Site-White_8                  | Train Loss: 0.4063 | Train Acc: 0.8263
 Site-White_9                  | Train Loss: 0.3988 | Train Acc: 0.8178
 Site-Black_0                  | Train Loss: 0.5323 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5061 | Train Acc: 0.7449
 Site-White_0                   (1) | Val  Loss: 0.4131 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.3292 | Val  Acc: 0.9231
 Site-White_2                   (1) | Val  Loss: 0.4365 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.6133 | Val  Acc: 0.6364
 Site-White_4                   (1) | Val  Loss: 0.5355 | Val  Acc: 0.7931
 Site-White_5                   (1) | Val  Loss: 0.5841 | Val  Acc: 0.7895
 Site-White_6                   (1) | Val  Loss: 0.4394 | Val  Acc: 0.7959
 Site-White_7                   (1) | Val  Loss: 0.4146 | Val  Acc: 0.8125
 Site-White_8                   (1) | Val  Loss: 0.4699 | Val  Acc: 0.7619
 Site-White_9                   (1) | Val  Loss: 0.4575 | Val  Acc: 0.7909
 Site-Black_0                   (0) | Val  Loss: 0.7358 | Val  Acc: 0.6053
 Site-Black_1                   (0) | Val  Loss: 0.7552 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7705
 Best site-White_0                  (1)  | Epoch:14 | Val Acc: 0.8000
 Best site-White_1                  (1)  | Epoch:14 | Val Acc: 0.9231
 Best site-White_2                  (1)  | Epoch:14 | Val Acc: 0.8235
 Best site-White_3                  (1)  | Epoch:14 | Val Acc: 0.6364
 Best site-White_4                  (1)  | Epoch:14 | Val Acc: 0.7931
 Best site-White_5                  (1)  | Epoch:14 | Val Acc: 0.7895
 Best site-White_6                  (1)  | Epoch:14 | Val Acc: 0.7959
 Best site-White_7                  (1)  | Epoch:14 | Val Acc: 0.8125
 Best site-White_8                  (1)  | Epoch:14 | Val Acc: 0.7619
 Best site-White_9                  (1)  | Epoch:14 | Val Acc: 0.7909
 Best site-Black_0                  (0)  | Epoch:14 | Val Acc: 0.6053
 Best site-Black_1                  (0)  | Epoch:14 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 15 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
min_w=0.00448, quan_i=0.43, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4308 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.5106 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2686 | Train Acc: 0.8000
 Site-White_3                  | Train Loss: 0.4565 | Train Acc: 0.8256
 Site-White_4                  | Train Loss: 0.3690 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3953 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.5385 | Train Acc: 0.7216
 Site-White_7                  | Train Loss: 0.4752 | Train Acc: 0.7852
 Site-White_8                  | Train Loss: 0.3628 | Train Acc: 0.8323
 Site-White_9                  | Train Loss: 0.3801 | Train Acc: 0.8200
 Site-Black_0                  | Train Loss: 0.5812 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.5559 | Train Acc: 0.7092
 Site-White_0                   (0) | Val  Loss: 0.5706 | Val  Acc: 0.5000
 Site-White_1                   (0) | Val  Loss: 0.3839 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.5373 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.6385 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.4904 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.5727 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4530 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4256 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4465 | Val  Acc: 0.7857
 Site-White_9                   (0) | Val  Loss: 0.4463 | Val  Acc: 0.8182
 Site-Black_0                   (1) | Val  Loss: 0.7899 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.6665 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7274
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 16 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
min_w=0.00322, quan_i=0.41, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4697 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4302 | Train Acc: 0.8980
 Site-White_2                  | Train Loss: 0.2776 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4599 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3965 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.4160 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4361 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.4764 | Train Acc: 0.7461
 Site-White_8                  | Train Loss: 0.3683 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3849 | Train Acc: 0.8292
 Site-Black_0                  | Train Loss: 0.5570 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.5784 | Train Acc: 0.7041
 Site-White_0                   (0) | Val  Loss: 0.6118 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3245 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4025 | Val  Acc: 0.8824
 Site-White_3                   (0) | Val  Loss: 0.5553 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4388 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5994 | Val  Acc: 0.8421
 Site-White_6                   (0) | Val  Loss: 0.4884 | Val  Acc: 0.7551
 Site-White_7                   (0) | Val  Loss: 0.4539 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.5030 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4556 | Val  Acc: 0.7818
 Site-Black_0                   (1) | Val  Loss: 0.7392 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.7395 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7576
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 17 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
min_w=0.00337, quan_i=0.42, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5076 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.4690 | Train Acc: 0.8163
 Site-White_2                  | Train Loss: 0.3703 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4423 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.4059 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3809 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.4507 | Train Acc: 0.7371
 Site-White_7                  | Train Loss: 0.4726 | Train Acc: 0.7656
 Site-White_8                  | Train Loss: 0.4021 | Train Acc: 0.8144
 Site-White_9                  | Train Loss: 0.3927 | Train Acc: 0.8155
 Site-Black_0                  | Train Loss: 0.5709 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.5863 | Train Acc: 0.6939
 Site-White_0                   (1) | Val  Loss: 0.5127 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.4199 | Val  Acc: 0.6923
 Site-White_2                   (1) | Val  Loss: 0.5391 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5253 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3796 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.6494 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4454 | Val  Acc: 0.7551
 Site-White_7                   (1) | Val  Loss: 0.4420 | Val  Acc: 0.7188
 Site-White_8                   (1) | Val  Loss: 0.4835 | Val  Acc: 0.7619
 Site-White_9                   (1) | Val  Loss: 0.4928 | Val  Acc: 0.7727
 Site-Black_0                   (0) | Val  Loss: 0.7667 | Val  Acc: 0.6316
 Site-Black_1                   (0) | Val  Loss: 0.6338 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7417
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 18 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
min_w=0.00394, quan_i=0.42, quan_c=0.42
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.2496 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4702 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2298 | Train Acc: 0.8769
 Site-White_3                  | Train Loss: 0.4697 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.4330 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4012 | Train Acc: 0.8176
 Site-White_6                  | Train Loss: 0.4924 | Train Acc: 0.7268
 Site-White_7                  | Train Loss: 0.4299 | Train Acc: 0.7734
 Site-White_8                  | Train Loss: 0.3910 | Train Acc: 0.8293
 Site-White_9                  | Train Loss: 0.3946 | Train Acc: 0.8155
 Site-Black_0                  | Train Loss: 0.5393 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5802 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.5245 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.4208 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.5142 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5961 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4806 | Val  Acc: 0.7586
 Site-White_5                   (0) | Val  Loss: 0.6408 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.5140 | Val  Acc: 0.7347
 Site-White_7                   (0) | Val  Loss: 0.5216 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4720 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4763 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.7055 | Val  Acc: 0.6053
 Site-Black_1                   (1) | Val  Loss: 0.7111 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7183
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 19 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
min_w=0.00173, quan_i=0.41, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3080 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4685 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2774 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4479 | Train Acc: 0.8140
 Site-White_4                  | Train Loss: 0.3790 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3469 | Train Acc: 0.8784
 Site-White_6                  | Train Loss: 0.5046 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.4614 | Train Acc: 0.7656
 Site-White_8                  | Train Loss: 0.3806 | Train Acc: 0.8413
 Site-White_9                  | Train Loss: 0.4004 | Train Acc: 0.8132
 Site-Black_0                  | Train Loss: 0.5260 | Train Acc: 0.7365
 Site-Black_1                  | Train Loss: 0.5714 | Train Acc: 0.7092
 Site-White_0                   (1) | Val  Loss: 0.4806 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3942 | Val  Acc: 0.6923
 Site-White_2                   (1) | Val  Loss: 0.3961 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.6544 | Val  Acc: 0.6364
 Site-White_4                   (1) | Val  Loss: 0.4229 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.6037 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4985 | Val  Acc: 0.7755
 Site-White_7                   (1) | Val  Loss: 0.4819 | Val  Acc: 0.7031
 Site-White_8                   (1) | Val  Loss: 0.4558 | Val  Acc: 0.8095
 Site-White_9                   (1) | Val  Loss: 0.4946 | Val  Acc: 0.7818
 Site-Black_0                   (0) | Val  Loss: 0.6308 | Val  Acc: 0.6579
 Site-Black_1                   (0) | Val  Loss: 0.6038 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7331
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 20 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
min_w=0.00220, quan_i=0.39, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4178 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4084 | Train Acc: 0.8980
 Site-White_2                  | Train Loss: 0.3180 | Train Acc: 0.8000
 Site-White_3                  | Train Loss: 0.4674 | Train Acc: 0.7442
 Site-White_4                  | Train Loss: 0.4076 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3685 | Train Acc: 0.8649
 Site-White_6                  | Train Loss: 0.6379 | Train Acc: 0.7629
 Site-White_7                  | Train Loss: 0.4412 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.3776 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3749 | Train Acc: 0.8246
 Site-Black_0                  | Train Loss: 0.5514 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.5989 | Train Acc: 0.7194
 Site-White_0                   (1) | Val  Loss: 0.5049 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.4390 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4788 | Val  Acc: 0.7647
 Site-White_3                   (1) | Val  Loss: 0.5383 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.4353 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.5316 | Val  Acc: 0.7632
 Site-White_6                   (1) | Val  Loss: 0.4352 | Val  Acc: 0.7959
 Site-White_7                   (1) | Val  Loss: 0.4486 | Val  Acc: 0.7656
 Site-White_8                   (1) | Val  Loss: 0.5013 | Val  Acc: 0.7262
 Site-White_9                   (1) | Val  Loss: 0.5206 | Val  Acc: 0.7364
 Site-Black_0                   (0) | Val  Loss: 0.6803 | Val  Acc: 0.6053
 Site-Black_1                   (0) | Val  Loss: 0.6297 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7498
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 21 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
min_w=0.00328, quan_i=0.41, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5992 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4346 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.3499 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4944 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.3861 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.3576 | Train Acc: 0.8514
 Site-White_6                  | Train Loss: 0.4664 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.4433 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.3766 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3813 | Train Acc: 0.8314
 Site-Black_0                  | Train Loss: 0.5352 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5816 | Train Acc: 0.6684
 Site-White_0                   (0) | Val  Loss: 0.6281 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.5052 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.3975 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5662 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3890 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.5205 | Val  Acc: 0.8158
 Site-White_6                   (1) | Val  Loss: 0.4195 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4667 | Val  Acc: 0.7969
 Site-White_8                   (1) | Val  Loss: 0.4834 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.4983 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.7823 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.7266 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7586
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 22 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
min_w=0.00424, quan_i=0.41, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3773 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4152 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2600 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4656 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3823 | Train Acc: 0.7857
 Site-White_5                  | Train Loss: 0.4033 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.5288 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4649 | Train Acc: 0.7852
 Site-White_8                  | Train Loss: 0.3662 | Train Acc: 0.8413
 Site-White_9                  | Train Loss: 0.3572 | Train Acc: 0.8405
 Site-Black_0                  | Train Loss: 0.5074 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.5439 | Train Acc: 0.6990
 Site-White_0                   (1) | Val  Loss: 0.6617 | Val  Acc: 0.6000
 Site-White_1                   (1) | Val  Loss: 0.3241 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.6196 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.5809 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3668 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.5288 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4506 | Val  Acc: 0.8571
 Site-White_7                   (1) | Val  Loss: 0.4802 | Val  Acc: 0.7656
 Site-White_8                   (1) | Val  Loss: 0.4775 | Val  Acc: 0.7619
 Site-White_9                   (1) | Val  Loss: 0.4791 | Val  Acc: 0.7818
 Site-Black_0                   (0) | Val  Loss: 0.8574 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.7106 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7490
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 23 ============
cnt=[1, 11, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
min_w=0.00255, quan_i=0.39, quan_c=0.43
minimize weight of clients:[0, ]
 Site-White_0                  | Train Loss: 0.3824 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.4226 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.5253 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4417 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3940 | Train Acc: 0.7857
 Site-White_5                  | Train Loss: 0.4009 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.4247 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4343 | Train Acc: 0.7930
 Site-White_8                  | Train Loss: 0.3835 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3734 | Train Acc: 0.8360
 Site-Black_0                  | Train Loss: 0.5292 | Train Acc: 0.7365
 Site-Black_1                  | Train Loss: 0.6106 | Train Acc: 0.7092
 Site-White_0                   (0) | Val  Loss: 0.4451 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3657 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.5116 | Val  Acc: 0.8824
 Site-White_3                   (1) | Val  Loss: 0.5812 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.3933 | Val  Acc: 0.8621
 Site-White_5                   (1) | Val  Loss: 0.5403 | Val  Acc: 0.7895
 Site-White_6                   (1) | Val  Loss: 0.4537 | Val  Acc: 0.7959
 Site-White_7                   (1) | Val  Loss: 0.4315 | Val  Acc: 0.7500
 Site-White_8                   (1) | Val  Loss: 0.4865 | Val  Acc: 0.7262
 Site-White_9                   (1) | Val  Loss: 0.4618 | Val  Acc: 0.7909
 Site-Black_0                   (1) | Val  Loss: 0.6483 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.6699 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7720
 Best site-White_0                  (0)  | Epoch:23 | Val Acc: 0.7000
 Best site-White_1                  (1)  | Epoch:23 | Val Acc: 0.7692
 Best site-White_2                  (1)  | Epoch:23 | Val Acc: 0.8824
 Best site-White_3                  (1)  | Epoch:23 | Val Acc: 0.7727
 Best site-White_4                  (1)  | Epoch:23 | Val Acc: 0.8621
 Best site-White_5                  (1)  | Epoch:23 | Val Acc: 0.7895
 Best site-White_6                  (1)  | Epoch:23 | Val Acc: 0.7959
 Best site-White_7                  (1)  | Epoch:23 | Val Acc: 0.7500
 Best site-White_8                  (1)  | Epoch:23 | Val Acc: 0.7262
 Best site-White_9                  (1)  | Epoch:23 | Val Acc: 0.7909
 Best site-Black_0                  (1)  | Epoch:23 | Val Acc: 0.7105
 Best site-Black_1                  (1)  | Epoch:23 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
min_w=0.00294, quan_i=0.41, quan_c=0.43
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3169 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4437 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2576 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4638 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.4000 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.3867 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.4471 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4201 | Train Acc: 0.7734
 Site-White_8                  | Train Loss: 0.3411 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3697 | Train Acc: 0.8246
 Site-Black_0                  | Train Loss: 0.5406 | Train Acc: 0.7162
 Site-Black_1                  | Train Loss: 0.5797 | Train Acc: 0.7143
 Site-White_0                   (1) | Val  Loss: 0.4165 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3943 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4839 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.5062 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.4599 | Val  Acc: 0.7241
 Site-White_5                   (1) | Val  Loss: 0.6097 | Val  Acc: 0.7632
 Site-White_6                   (1) | Val  Loss: 0.4618 | Val  Acc: 0.8367
 Site-White_7                   (1) | Val  Loss: 0.4841 | Val  Acc: 0.7656
 Site-White_8                   (1) | Val  Loss: 0.5009 | Val  Acc: 0.7024
 Site-White_9                   (1) | Val  Loss: 0.4121 | Val  Acc: 0.8273
 Site-Black_0                   (1) | Val  Loss: 0.7040 | Val  Acc: 0.6842
 Site-Black_1                   (1) | Val  Loss: 0.7829 | Val  Acc: 0.6122
Average Valid Accuracy: 0.7386
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 25 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
min_w=0.00217, quan_i=0.39, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4120 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4073 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 1.0169 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4138 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.3663 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4055 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.3980 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.4548 | Train Acc: 0.7422
 Site-White_8                  | Train Loss: 0.3648 | Train Acc: 0.8503
 Site-White_9                  | Train Loss: 0.3764 | Train Acc: 0.8269
 Site-Black_0                  | Train Loss: 0.5745 | Train Acc: 0.6959
 Site-Black_1                  | Train Loss: 0.5174 | Train Acc: 0.6735
 Site-White_0                   (0) | Val  Loss: 0.5178 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.4123 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.4758 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.4694 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.3887 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.5743 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4370 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4991 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4601 | Val  Acc: 0.7143
 Site-White_9                   (0) | Val  Loss: 0.4366 | Val  Acc: 0.7455
 Site-Black_0                   (1) | Val  Loss: 0.7326 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.6708 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7427
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 26 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
min_w=0.00310, quan_i=0.41, quan_c=0.42
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3508 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.3820 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2537 | Train Acc: 0.8000
 Site-White_3                  | Train Loss: 0.4680 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3652 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4055 | Train Acc: 0.8176
 Site-White_6                  | Train Loss: 0.4220 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4369 | Train Acc: 0.7891
 Site-White_8                  | Train Loss: 0.3603 | Train Acc: 0.8473
 Site-White_9                  | Train Loss: 0.3750 | Train Acc: 0.8223
 Site-Black_0                  | Train Loss: 0.5276 | Train Acc: 0.7027
 Site-Black_1                  | Train Loss: 0.5426 | Train Acc: 0.6684
 Site-White_0                   (1) | Val  Loss: 0.5344 | Val  Acc: 0.6000
 Site-White_1                   (1) | Val  Loss: 0.3598 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.4473 | Val  Acc: 0.8824
 Site-White_3                   (1) | Val  Loss: 0.5489 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.4305 | Val  Acc: 0.7586
 Site-White_5                   (1) | Val  Loss: 0.5770 | Val  Acc: 0.7105
 Site-White_6                   (1) | Val  Loss: 0.4221 | Val  Acc: 0.8163
 Site-White_7                   (1) | Val  Loss: 0.4427 | Val  Acc: 0.8125
 Site-White_8                   (1) | Val  Loss: 0.4885 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.4861 | Val  Acc: 0.7818
 Site-Black_0                   (0) | Val  Loss: 0.8225 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.6935 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7483
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 27 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
min_w=0.00244, quan_i=0.38, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5741 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.3981 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.3060 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5052 | Train Acc: 0.7442
 Site-White_4                  | Train Loss: 0.4058 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3979 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.4293 | Train Acc: 0.7629
 Site-White_7                  | Train Loss: 0.4199 | Train Acc: 0.7930
 Site-White_8                  | Train Loss: 0.3644 | Train Acc: 0.8383
 Site-White_9                  | Train Loss: 0.3424 | Train Acc: 0.8497
 Site-Black_0                  | Train Loss: 0.5055 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.4983 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.5824 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3790 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4358 | Val  Acc: 0.8824
 Site-White_3                   (0) | Val  Loss: 0.4694 | Val  Acc: 0.8182
 Site-White_4                   (0) | Val  Loss: 0.3708 | Val  Acc: 0.7586
 Site-White_5                   (0) | Val  Loss: 0.5254 | Val  Acc: 0.7895
 Site-White_6                   (0) | Val  Loss: 0.4339 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4287 | Val  Acc: 0.7969
 Site-White_8                   (0) | Val  Loss: 0.4678 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4944 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.6761 | Val  Acc: 0.6842
 Site-Black_1                   (1) | Val  Loss: 0.6423 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7676
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 28 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
min_w=0.00370, quan_i=0.40, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4925 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4468 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.3167 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4490 | Train Acc: 0.8140
 Site-White_4                  | Train Loss: 0.3460 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4053 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.4690 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4505 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.3331 | Train Acc: 0.8713
 Site-White_9                  | Train Loss: 0.3389 | Train Acc: 0.8588
 Site-Black_0                  | Train Loss: 0.4814 | Train Acc: 0.7635
 Site-Black_1                  | Train Loss: 0.6115 | Train Acc: 0.7143
 Site-White_0                   (0) | Val  Loss: 0.5937 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3701 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4603 | Val  Acc: 0.6471
 Site-White_3                   (0) | Val  Loss: 0.4929 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.3372 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.5917 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4442 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.5144 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4800 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4442 | Val  Acc: 0.8000
 Site-Black_0                   (1) | Val  Loss: 0.7047 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.7246 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7274
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 29 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
min_w=0.00345, quan_i=0.42, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3037 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4223 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2613 | Train Acc: 0.9077
 Site-White_3                  | Train Loss: 0.4208 | Train Acc: 0.8256
 Site-White_4                  | Train Loss: 0.4032 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.3576 | Train Acc: 0.8986
 Site-White_6                  | Train Loss: 0.4169 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4436 | Train Acc: 0.8047
 Site-White_8                  | Train Loss: 0.3637 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3622 | Train Acc: 0.8451
 Site-Black_0                  | Train Loss: 0.5271 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.5088 | Train Acc: 0.7296
 Site-White_0                   (0) | Val  Loss: 0.6098 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3596 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4867 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.6477 | Val  Acc: 0.6364
 Site-White_4                   (0) | Val  Loss: 0.4686 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.6193 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4093 | Val  Acc: 0.7755
 Site-White_7                   (0) | Val  Loss: 0.4602 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4560 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4555 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.6386 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.7142 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7285
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 30 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
min_w=0.00207, quan_i=0.38, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4929 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.3873 | Train Acc: 0.8163
 Site-White_2                  | Train Loss: 0.3012 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5054 | Train Acc: 0.7209
 Site-White_4                  | Train Loss: 0.3862 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.3727 | Train Acc: 0.8716
 Site-White_6                  | Train Loss: 0.3874 | Train Acc: 0.7835
 Site-White_7                  | Train Loss: 0.3961 | Train Acc: 0.8320
 Site-White_8                  | Train Loss: 0.3630 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3581 | Train Acc: 0.8405
 Site-Black_0                  | Train Loss: 0.5362 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.5345 | Train Acc: 0.7347
 Site-White_0                   (1) | Val  Loss: 0.5952 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3700 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.4528 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.5243 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3806 | Val  Acc: 0.8966
 Site-White_5                   (1) | Val  Loss: 0.5681 | Val  Acc: 0.7895
 Site-White_6                   (1) | Val  Loss: 0.4338 | Val  Acc: 0.8571
 Site-White_7                   (1) | Val  Loss: 0.4488 | Val  Acc: 0.7812
 Site-White_8                   (1) | Val  Loss: 0.5000 | Val  Acc: 0.7857
 Site-White_9                   (1) | Val  Loss: 0.4640 | Val  Acc: 0.7545
 Site-Black_0                   (0) | Val  Loss: 0.7033 | Val  Acc: 0.6316
 Site-Black_1                   (0) | Val  Loss: 0.6983 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7526
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 31 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
min_w=0.00341, quan_i=0.39, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.6165 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.3961 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2212 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4753 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.3705 | Train Acc: 0.8393
 Site-White_5                  | Train Loss: 0.4154 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.4827 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.4346 | Train Acc: 0.7930
 Site-White_8                  | Train Loss: 0.3508 | Train Acc: 0.8413
 Site-White_9                  | Train Loss: 0.3637 | Train Acc: 0.8155
 Site-Black_0                  | Train Loss: 0.5217 | Train Acc: 0.7500
 Site-Black_1                  | Train Loss: 0.5588 | Train Acc: 0.7500
 Site-White_0                   (0) | Val  Loss: 0.5170 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3741 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5096 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5839 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4157 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5537 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4442 | Val  Acc: 0.7551
 Site-White_7                   (0) | Val  Loss: 0.4784 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.5067 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.4952 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.5832 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.6548 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7485
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 32 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
min_w=0.00272, quan_i=0.40, quan_c=0.40
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4226 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.4337 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2427 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5100 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.3800 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.3711 | Train Acc: 0.8446
 Site-White_6                  | Train Loss: 0.4060 | Train Acc: 0.7526
 Site-White_7                  | Train Loss: 0.4173 | Train Acc: 0.7969
 Site-White_8                  | Train Loss: 0.3383 | Train Acc: 0.8503
 Site-White_9                  | Train Loss: 0.3698 | Train Acc: 0.8383
 Site-Black_0                  | Train Loss: 0.5073 | Train Acc: 0.7297
 Site-Black_1                  | Train Loss: 0.5445 | Train Acc: 0.7041
 Site-White_0                   (0) | Val  Loss: 0.4464 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3670 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.5391 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5638 | Val  Acc: 0.6364
 Site-White_4                   (0) | Val  Loss: 0.4875 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5383 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4198 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4650 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4359 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4411 | Val  Acc: 0.8000
 Site-Black_0                   (1) | Val  Loss: 0.7945 | Val  Acc: 0.6053
 Site-Black_1                   (1) | Val  Loss: 0.7193 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7479
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 33 ============
cnt=[11, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
min_w=0.00306, quan_i=0.39, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3226 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.3914 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.3166 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4830 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.4126 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.3833 | Train Acc: 0.8919
 Site-White_6                  | Train Loss: 0.5137 | Train Acc: 0.7474
 Site-White_7                  | Train Loss: 0.4150 | Train Acc: 0.7891
 Site-White_8                  | Train Loss: 0.3633 | Train Acc: 0.8323
 Site-White_9                  | Train Loss: 0.3755 | Train Acc: 0.8383
 Site-Black_0                  | Train Loss: 0.5190 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5147 | Train Acc: 0.7296
 Site-White_0                   (1) | Val  Loss: 0.5111 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3868 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5385 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.5229 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.3485 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.5485 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4421 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4765 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4659 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4563 | Val  Acc: 0.7727
 Site-Black_0                   (0) | Val  Loss: 0.7999 | Val  Acc: 0.5526
 Site-Black_1                   (0) | Val  Loss: 0.6243 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7515
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 34 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
min_w=0.00231, quan_i=0.39, quan_c=0.40
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.6381 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4458 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2540 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4562 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3710 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3896 | Train Acc: 0.8446
 Site-White_6                  | Train Loss: 0.4488 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4358 | Train Acc: 0.7930
 Site-White_8                  | Train Loss: 0.3560 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3494 | Train Acc: 0.8269
 Site-Black_0                  | Train Loss: 0.5069 | Train Acc: 0.7703
 Site-Black_1                  | Train Loss: 0.5780 | Train Acc: 0.7296
 Site-White_0                   (0) | Val  Loss: 0.5878 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3571 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4546 | Val  Acc: 0.8235
 Site-White_3                   (0) | Val  Loss: 0.6126 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.4624 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.6265 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4228 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4348 | Val  Acc: 0.8125
 Site-White_8                   (0) | Val  Loss: 0.4671 | Val  Acc: 0.7976
 Site-White_9                   (0) | Val  Loss: 0.4507 | Val  Acc: 0.7455
 Site-Black_0                   (1) | Val  Loss: 0.8383 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.7408 | Val  Acc: 0.7551
Average Valid Accuracy: 0.7641
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 35 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
min_w=0.00310, quan_i=0.41, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3614 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.3693 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2353 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4973 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3437 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.3912 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4221 | Train Acc: 0.7835
 Site-White_7                  | Train Loss: 0.4102 | Train Acc: 0.8008
 Site-White_8                  | Train Loss: 0.3456 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3592 | Train Acc: 0.8337
 Site-Black_0                  | Train Loss: 0.5583 | Train Acc: 0.7027
 Site-Black_1                  | Train Loss: 0.5773 | Train Acc: 0.7500
 Site-White_0                   (1) | Val  Loss: 0.4396 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.3656 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.3602 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.6032 | Val  Acc: 0.6818
 Site-White_4                   (1) | Val  Loss: 0.4104 | Val  Acc: 0.7931
 Site-White_5                   (1) | Val  Loss: 0.5053 | Val  Acc: 0.7105
 Site-White_6                   (1) | Val  Loss: 0.4783 | Val  Acc: 0.8163
 Site-White_7                   (1) | Val  Loss: 0.4347 | Val  Acc: 0.7500
 Site-White_8                   (1) | Val  Loss: 0.5166 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.4537 | Val  Acc: 0.7636
 Site-Black_0                   (0) | Val  Loss: 0.6776 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.6832 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7537
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 36 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
min_w=0.00244, quan_i=0.37, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3087 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4272 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2593 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4187 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3754 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.3971 | Train Acc: 0.8446
 Site-White_6                  | Train Loss: 0.4022 | Train Acc: 0.8041
 Site-White_7                  | Train Loss: 0.4412 | Train Acc: 0.7617
 Site-White_8                  | Train Loss: 0.3253 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3534 | Train Acc: 0.8223
 Site-Black_0                  | Train Loss: 0.4921 | Train Acc: 0.7365
 Site-Black_1                  | Train Loss: 0.5806 | Train Acc: 0.7041
 Site-White_0                   (0) | Val  Loss: 0.5053 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3367 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5059 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5118 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.3487 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.6260 | Val  Acc: 0.7895
 Site-White_6                   (0) | Val  Loss: 0.4003 | Val  Acc: 0.8571
 Site-White_7                   (0) | Val  Loss: 0.5010 | Val  Acc: 0.7344
 Site-White_8                   (0) | Val  Loss: 0.4899 | Val  Acc: 0.7143
 Site-White_9                   (0) | Val  Loss: 0.4723 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.7583 | Val  Acc: 0.6053
 Site-Black_1                   (1) | Val  Loss: 0.6787 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7532
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 37 ============
cnt=[1, 11, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
min_w=0.00172, quan_i=0.38, quan_c=0.40
minimize weight of clients:[0, ]
 Site-White_0                  | Train Loss: 0.4828 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4024 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.4754 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4581 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.4342 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3949 | Train Acc: 0.8446
 Site-White_6                  | Train Loss: 0.4205 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.4144 | Train Acc: 0.7852
 Site-White_8                  | Train Loss: 0.3528 | Train Acc: 0.8473
 Site-White_9                  | Train Loss: 0.3308 | Train Acc: 0.8542
 Site-Black_0                  | Train Loss: 0.5459 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5104 | Train Acc: 0.7347
 Site-White_0                   (0) | Val  Loss: 0.6805 | Val  Acc: 0.6000
 Site-White_1                   (1) | Val  Loss: 0.3761 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4206 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5551 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.4666 | Val  Acc: 0.7931
 Site-White_5                   (1) | Val  Loss: 0.5870 | Val  Acc: 0.6842
 Site-White_6                   (1) | Val  Loss: 0.4082 | Val  Acc: 0.8163
 Site-White_7                   (1) | Val  Loss: 0.4474 | Val  Acc: 0.7656
 Site-White_8                   (1) | Val  Loss: 0.4985 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.4257 | Val  Acc: 0.7909
 Site-Black_0                   (1) | Val  Loss: 0.5526 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.7529 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7485
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 38 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
min_w=0.00337, quan_i=0.42, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4040 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.3486 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.2469 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4917 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.3787 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.4094 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.4278 | Train Acc: 0.7938
 Site-White_7                  | Train Loss: 0.4357 | Train Acc: 0.7617
 Site-White_8                  | Train Loss: 0.3440 | Train Acc: 0.8293
 Site-White_9                  | Train Loss: 0.3473 | Train Acc: 0.8337
 Site-Black_0                  | Train Loss: 0.4843 | Train Acc: 0.7500
 Site-Black_1                  | Train Loss: 0.5796 | Train Acc: 0.7143
 Site-White_0                   (1) | Val  Loss: 0.4526 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.4187 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.4605 | Val  Acc: 0.7647
 Site-White_3                   (1) | Val  Loss: 0.5756 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3524 | Val  Acc: 0.8621
 Site-White_5                   (1) | Val  Loss: 0.5521 | Val  Acc: 0.7895
 Site-White_6                   (1) | Val  Loss: 0.4457 | Val  Acc: 0.8367
 Site-White_7                   (1) | Val  Loss: 0.4165 | Val  Acc: 0.8281
 Site-White_8                   (1) | Val  Loss: 0.5227 | Val  Acc: 0.7024
 Site-White_9                   (1) | Val  Loss: 0.4264 | Val  Acc: 0.7909
 Site-Black_0                   (0) | Val  Loss: 0.7179 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.6333 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7673
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 39 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
min_w=0.00277, quan_i=0.39, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5118 | Train Acc: 0.8919
 Site-White_1                  | Train Loss: 0.3961 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2407 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4343 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3732 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.3776 | Train Acc: 0.8649
 Site-White_6                  | Train Loss: 0.4768 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4159 | Train Acc: 0.8008
 Site-White_8                  | Train Loss: 0.3505 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3540 | Train Acc: 0.8405
 Site-Black_0                  | Train Loss: 0.5228 | Train Acc: 0.7162
 Site-Black_1                  | Train Loss: 0.5363 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.5179 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3603 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4228 | Val  Acc: 0.8824
 Site-White_3                   (0) | Val  Loss: 0.5110 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4508 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.6033 | Val  Acc: 0.8158
 Site-White_6                   (0) | Val  Loss: 0.4536 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4438 | Val  Acc: 0.8281
 Site-White_8                   (0) | Val  Loss: 0.5212 | Val  Acc: 0.7500
 Site-White_9                   (0) | Val  Loss: 0.4541 | Val  Acc: 0.8000
 Site-Black_0                   (1) | Val  Loss: 0.7255 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.6139 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7905
 Best site-White_0                  (0)  | Epoch:39 | Val Acc: 0.8000
 Best site-White_1                  (0)  | Epoch:39 | Val Acc: 0.8462
 Best site-White_2                  (0)  | Epoch:39 | Val Acc: 0.8824
 Best site-White_3                  (0)  | Epoch:39 | Val Acc: 0.7273
 Best site-White_4                  (0)  | Epoch:39 | Val Acc: 0.8276
 Best site-White_5                  (0)  | Epoch:39 | Val Acc: 0.8158
 Best site-White_6                  (0)  | Epoch:39 | Val Acc: 0.8367
 Best site-White_7                  (0)  | Epoch:39 | Val Acc: 0.8281
 Best site-White_8                  (0)  | Epoch:39 | Val Acc: 0.7500
 Best site-White_9                  (0)  | Epoch:39 | Val Acc: 0.8000
 Best site-Black_0                  (1)  | Epoch:39 | Val Acc: 0.6579
 Best site-Black_1                  (1)  | Epoch:39 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
 Test site-White_0                   (0)| Epoch:39 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:39 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:39 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:39 | Test Acc: 0.8182
 Test site-White_4                   (0)| Epoch:39 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:39 | Test Acc: 0.7312
 Test site-White_6                   (0)| Epoch:39 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:39 | Test Acc: 0.8938
 Test site-White_8                   (0)| Epoch:39 | Test Acc: 0.7915
 Test site-White_9                   (0)| Epoch:39 | Test Acc: 0.8655
 Test site-Black_0                   (1)| Epoch:39 | Test Acc: 0.7021
 Test site-Black_1                   (1)| Epoch:39 | Test Acc: 0.7398
White: 0.8159, Black: 0.7210, 
Average Test Accuracy: 0.7685, domain std=0.0475, cluster std=0.0475, individual std=0.0552, 
============ Train epoch 40 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
min_w=0.00290, quan_i=0.39, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3589 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4514 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2603 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4356 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3258 | Train Acc: 0.8571
 Site-White_5                  | Train Loss: 0.4052 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.4404 | Train Acc: 0.7990
 Site-White_7                  | Train Loss: 0.4264 | Train Acc: 0.8008
 Site-White_8                  | Train Loss: 0.3531 | Train Acc: 0.8653
 Site-White_9                  | Train Loss: 0.3491 | Train Acc: 0.8542
 Site-Black_0                  | Train Loss: 0.5230 | Train Acc: 0.7162
 Site-Black_1                  | Train Loss: 0.4804 | Train Acc: 0.7449
 Site-White_0                   (0) | Val  Loss: 0.5264 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3328 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5612 | Val  Acc: 0.6471
 Site-White_3                   (0) | Val  Loss: 0.5102 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.3884 | Val  Acc: 0.8966
 Site-White_5                   (0) | Val  Loss: 0.5968 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4354 | Val  Acc: 0.8571
 Site-White_7                   (0) | Val  Loss: 0.4295 | Val  Acc: 0.7344
 Site-White_8                   (0) | Val  Loss: 0.4342 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4529 | Val  Acc: 0.8000
 Site-Black_0                   (1) | Val  Loss: 0.7242 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.6874 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7632
 Test site-White_0                   (0)| Epoch:39 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:39 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:39 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:39 | Test Acc: 0.8000
 Test site-White_4                   (0)| Epoch:39 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:39 | Test Acc: 0.7097
 Test site-White_6                   (0)| Epoch:39 | Test Acc: 0.8293
 Test site-White_7                   (0)| Epoch:39 | Test Acc: 0.8875
 Test site-White_8                   (0)| Epoch:39 | Test Acc: 0.8104
 Test site-White_9                   (0)| Epoch:39 | Test Acc: 0.8545
 Test site-Black_0                   (1)| Epoch:39 | Test Acc: 0.7234
 Test site-Black_1                   (1)| Epoch:39 | Test Acc: 0.7561
White: 0.8113, Black: 0.7398, 
Average Test Accuracy: 0.7755, domain std=0.0358, cluster std=0.0358, individual std=0.0511, 
Average Test Accuracy: 0.7755
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 41 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
min_w=0.00245, quan_i=0.38, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4856 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4192 | Train Acc: 0.7959
 Site-White_2                  | Train Loss: 0.2524 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4481 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3571 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3613 | Train Acc: 0.8716
 Site-White_6                  | Train Loss: 0.3925 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4174 | Train Acc: 0.7852
 Site-White_8                  | Train Loss: 0.3592 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3351 | Train Acc: 0.8633
 Site-Black_0                  | Train Loss: 0.5428 | Train Acc: 0.7027
 Site-Black_1                  | Train Loss: 0.5089 | Train Acc: 0.7602
 Site-White_0                   (0) | Val  Loss: 0.5058 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.4215 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4794 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5097 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4269 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.6945 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.3732 | Val  Acc: 0.8776
 Site-White_7                   (0) | Val  Loss: 0.4860 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.5278 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.4183 | Val  Acc: 0.7909
 Site-Black_0                   (1) | Val  Loss: 0.7071 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.6311 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7657
 Test site-White_0                   (0)| Epoch:40 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:40 | Test Acc: 0.8788
 Test site-White_2                   (0)| Epoch:40 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:40 | Test Acc: 0.8000
 Test site-White_4                   (0)| Epoch:40 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:40 | Test Acc: 0.7312
 Test site-White_6                   (0)| Epoch:40 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:40 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:40 | Test Acc: 0.7820
 Test site-White_9                   (0)| Epoch:40 | Test Acc: 0.8691
 Test site-Black_0                   (1)| Epoch:40 | Test Acc: 0.7021
 Test site-Black_1                   (1)| Epoch:40 | Test Acc: 0.7398
White: 0.8172, Black: 0.7210, 
Average Test Accuracy: 0.7691, domain std=0.0481, cluster std=0.0481, individual std=0.0592, 
Average Test Accuracy: 0.7691
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 42 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
min_w=0.00294, quan_i=0.37, quan_c=0.37
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3362 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.4301 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2324 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4823 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.3952 | Train Acc: 0.7768
 Site-White_5                  | Train Loss: 0.3922 | Train Acc: 0.8514
 Site-White_6                  | Train Loss: 0.4226 | Train Acc: 0.7784
 Site-White_7                  | Train Loss: 0.4245 | Train Acc: 0.7969
 Site-White_8                  | Train Loss: 0.3621 | Train Acc: 0.8383
 Site-White_9                  | Train Loss: 0.3437 | Train Acc: 0.8360
 Site-Black_0                  | Train Loss: 0.4892 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.4669 | Train Acc: 0.7296
 Site-White_0                   (0) | Val  Loss: 0.3494 | Val  Acc: 0.9000
 Site-White_1                   (0) | Val  Loss: 0.4043 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4410 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.4331 | Val  Acc: 0.8182
 Site-White_4                   (0) | Val  Loss: 0.4867 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5631 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4560 | Val  Acc: 0.7959
 Site-White_7                   (0) | Val  Loss: 0.4252 | Val  Acc: 0.8125
 Site-White_8                   (0) | Val  Loss: 0.5034 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4837 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.6386 | Val  Acc: 0.7368
 Site-Black_1                   (1) | Val  Loss: 0.7007 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7747
 Test site-White_0                   (0)| Epoch:40 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:40 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:40 | Test Acc: 0.7857
 Test site-White_3                   (0)| Epoch:40 | Test Acc: 0.8000
 Test site-White_4                   (0)| Epoch:40 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:40 | Test Acc: 0.7097
 Test site-White_6                   (0)| Epoch:40 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:40 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:40 | Test Acc: 0.7820
 Test site-White_9                   (0)| Epoch:40 | Test Acc: 0.8655
 Test site-Black_0                   (1)| Epoch:40 | Test Acc: 0.7128
 Test site-Black_1                   (1)| Epoch:40 | Test Acc: 0.7642
White: 0.8093, Black: 0.7385, 
Average Test Accuracy: 0.7739, domain std=0.0354, cluster std=0.0354, individual std=0.0554, 
Average Test Accuracy: 0.7739
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 43 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
min_w=0.00230, quan_i=0.39, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3608 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.3845 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2591 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4989 | Train Acc: 0.7326
 Site-White_4                  | Train Loss: 0.3495 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.3625 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.4828 | Train Acc: 0.7938
 Site-White_7                  | Train Loss: 0.3888 | Train Acc: 0.8125
 Site-White_8                  | Train Loss: 0.3416 | Train Acc: 0.8623
 Site-White_9                  | Train Loss: 0.3363 | Train Acc: 0.8542
 Site-Black_0                  | Train Loss: 0.5049 | Train Acc: 0.7500
 Site-Black_1                  | Train Loss: 0.4740 | Train Acc: 0.7551
 Site-White_0                   (1) | Val  Loss: 0.4404 | Val  Acc: 0.9000
 Site-White_1                   (1) | Val  Loss: 0.2815 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4009 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5868 | Val  Acc: 0.8182
 Site-White_4                   (1) | Val  Loss: 0.4305 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.5093 | Val  Acc: 0.8158
 Site-White_6                   (1) | Val  Loss: 0.4087 | Val  Acc: 0.8980
 Site-White_7                   (1) | Val  Loss: 0.4307 | Val  Acc: 0.7500
 Site-White_8                   (1) | Val  Loss: 0.4950 | Val  Acc: 0.7500
 Site-White_9                   (1) | Val  Loss: 0.4253 | Val  Acc: 0.7909
 Site-Black_0                   (0) | Val  Loss: 0.7284 | Val  Acc: 0.7105
 Site-Black_1                   (0) | Val  Loss: 0.7998 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7969
 Best site-White_0                  (1)  | Epoch:43 | Val Acc: 0.9000
 Best site-White_1                  (1)  | Epoch:43 | Val Acc: 0.8462
 Best site-White_2                  (1)  | Epoch:43 | Val Acc: 0.8235
 Best site-White_3                  (1)  | Epoch:43 | Val Acc: 0.8182
 Best site-White_4                  (1)  | Epoch:43 | Val Acc: 0.8276
 Best site-White_5                  (1)  | Epoch:43 | Val Acc: 0.8158
 Best site-White_6                  (1)  | Epoch:43 | Val Acc: 0.8980
 Best site-White_7                  (1)  | Epoch:43 | Val Acc: 0.7500
 Best site-White_8                  (1)  | Epoch:43 | Val Acc: 0.7500
 Best site-White_9                  (1)  | Epoch:43 | Val Acc: 0.7909
 Best site-Black_0                  (0)  | Epoch:43 | Val Acc: 0.7105
 Best site-Black_1                  (0)  | Epoch:43 | Val Acc: 0.6327
 Test site-White_0                   (1)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (1)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (1)| Epoch:43 | Test Acc: 0.7857
 Test site-White_3                   (1)| Epoch:43 | Test Acc: 0.8000
 Test site-White_4                   (1)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (1)| Epoch:43 | Test Acc: 0.7204
 Test site-White_6                   (1)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (1)| Epoch:43 | Test Acc: 0.8938
 Test site-White_8                   (1)| Epoch:43 | Test Acc: 0.7867
 Test site-White_9                   (1)| Epoch:43 | Test Acc: 0.8618
 Test site-Black_0                   (0)| Epoch:43 | Test Acc: 0.7021
 Test site-Black_1                   (0)| Epoch:43 | Test Acc: 0.7561
White: 0.8112, Black: 0.7291, 
Average Test Accuracy: 0.7702, domain std=0.0410, cluster std=0.0410, individual std=0.0540, 
Average Test Accuracy: 0.7702
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 44 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
min_w=0.00241, quan_i=0.36, quan_c=0.37
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3815 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.3375 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.2129 | Train Acc: 0.8769
 Site-White_3                  | Train Loss: 0.4298 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.3808 | Train Acc: 0.7857
 Site-White_5                  | Train Loss: 0.3922 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.5790 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4063 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.3354 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3340 | Train Acc: 0.8474
 Site-Black_0                  | Train Loss: 0.4852 | Train Acc: 0.7635
 Site-Black_1                  | Train Loss: 0.6528 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.5386 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.4064 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4280 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.4619 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4872 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5699 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.3781 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4845 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4967 | Val  Acc: 0.7143
 Site-White_9                   (0) | Val  Loss: 0.4634 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.6779 | Val  Acc: 0.5789
 Site-Black_1                   (1) | Val  Loss: 0.6380 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7499
 Test site-White_0                   (0)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:43 | Test Acc: 0.7857
 Test site-White_3                   (0)| Epoch:43 | Test Acc: 0.8000
 Test site-White_4                   (0)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (0)| Epoch:43 | Test Acc: 0.7312
 Test site-White_6                   (0)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:43 | Test Acc: 0.8938
 Test site-White_8                   (0)| Epoch:43 | Test Acc: 0.7867
 Test site-White_9                   (0)| Epoch:43 | Test Acc: 0.8618
 Test site-Black_0                   (1)| Epoch:43 | Test Acc: 0.7021
 Test site-Black_1                   (1)| Epoch:43 | Test Acc: 0.7642
White: 0.8123, Black: 0.7332, 
Average Test Accuracy: 0.7727, domain std=0.0396, cluster std=0.0396, individual std=0.0523, 
Average Test Accuracy: 0.7727
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 45 ============
cnt=[11, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
min_w=0.00143, quan_i=0.38, quan_c=0.42
minimize weight of clients:[2, ]
 Site-White_0                  | Train Loss: 0.4174 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4518 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.3886 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4299 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.3690 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.3735 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.3882 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.3947 | Train Acc: 0.8047
 Site-White_8                  | Train Loss: 0.3319 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3419 | Train Acc: 0.8405
 Site-Black_0                  | Train Loss: 0.5076 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.5409 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.4763 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3724 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4601 | Val  Acc: 0.8235
 Site-White_3                   (0) | Val  Loss: 0.6056 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4214 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5763 | Val  Acc: 0.8158
 Site-White_6                   (0) | Val  Loss: 0.4021 | Val  Acc: 0.8980
 Site-White_7                   (0) | Val  Loss: 0.5247 | Val  Acc: 0.7188
 Site-White_8                   (0) | Val  Loss: 0.5111 | Val  Acc: 0.7024
 Site-White_9                   (0) | Val  Loss: 0.4419 | Val  Acc: 0.7545
 Site-Black_0                   (0) | Val  Loss: 0.6619 | Val  Acc: 0.6053
 Site-Black_1                   (0) | Val  Loss: 0.7012 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7678
 Test site-White_0                   (0)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (1)| Epoch:43 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:43 | Test Acc: 0.8364
 Test site-White_4                   (0)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (0)| Epoch:43 | Test Acc: 0.7312
 Test site-White_6                   (0)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:43 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:43 | Test Acc: 0.7773
 Test site-White_9                   (0)| Epoch:43 | Test Acc: 0.8618
 Test site-Black_0                   (0)| Epoch:43 | Test Acc: 0.6915
 Test site-Black_1                   (0)| Epoch:43 | Test Acc: 0.7561
White: 0.8180, Black: 0.7238, 
Average Test Accuracy: 0.7709, domain std=0.0471, cluster std=0.0039, individual std=0.0565, 
Average Test Accuracy: 0.7709
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 46 ============
cnt=[11, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
min_w=0.00314, quan_i=0.39, quan_c=0.40
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4605 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4291 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.6622 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4649 | Train Acc: 0.8140
 Site-White_4                  | Train Loss: 0.3696 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3946 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.4220 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4247 | Train Acc: 0.7891
 Site-White_8                  | Train Loss: 0.3505 | Train Acc: 0.8473
 Site-White_9                  | Train Loss: 0.3290 | Train Acc: 0.8497
 Site-Black_0                  | Train Loss: 0.4948 | Train Acc: 0.7297
 Site-Black_1                  | Train Loss: 0.4658 | Train Acc: 0.7398
 Site-White_0                   (1) | Val  Loss: 0.6109 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3001 | Val  Acc: 0.9231
 Site-White_2                   (0) | Val  Loss: 0.5535 | Val  Acc: 0.5882
 Site-White_3                   (0) | Val  Loss: 0.5451 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4011 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5199 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4402 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4892 | Val  Acc: 0.7812
 Site-White_8                   (0) | Val  Loss: 0.4495 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4093 | Val  Acc: 0.8273
 Site-Black_0                   (0) | Val  Loss: 0.7686 | Val  Acc: 0.5789
 Site-Black_1                   (0) | Val  Loss: 0.6083 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7350
 Test site-White_0                   (1)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:43 | Test Acc: 0.7857
 Test site-White_3                   (0)| Epoch:43 | Test Acc: 0.8182
 Test site-White_4                   (0)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (0)| Epoch:43 | Test Acc: 0.7204
 Test site-White_6                   (0)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:43 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:43 | Test Acc: 0.7773
 Test site-White_9                   (0)| Epoch:43 | Test Acc: 0.8582
 Test site-Black_0                   (0)| Epoch:43 | Test Acc: 0.6915
 Test site-Black_1                   (0)| Epoch:43 | Test Acc: 0.7561
White: 0.8123, Black: 0.7238, 
Average Test Accuracy: 0.7681, domain std=0.0443, cluster std=0.0013, individual std=0.0567, 
Average Test Accuracy: 0.7681
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 47 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
min_w=0.00324, quan_i=0.42, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.6212 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4574 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2004 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4967 | Train Acc: 0.7326
 Site-White_4                  | Train Loss: 0.3785 | Train Acc: 0.8482
 Site-White_5                  | Train Loss: 0.3805 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4504 | Train Acc: 0.7784
 Site-White_7                  | Train Loss: 0.3859 | Train Acc: 0.8008
 Site-White_8                  | Train Loss: 0.3209 | Train Acc: 0.8653
 Site-White_9                  | Train Loss: 0.3278 | Train Acc: 0.8565
 Site-Black_0                  | Train Loss: 0.4668 | Train Acc: 0.7635
 Site-Black_1                  | Train Loss: 0.5949 | Train Acc: 0.7551
 Site-White_0                   (1) | Val  Loss: 0.4739 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3359 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4562 | Val  Acc: 0.6471
 Site-White_3                   (1) | Val  Loss: 0.5142 | Val  Acc: 0.8182
 Site-White_4                   (1) | Val  Loss: 0.4031 | Val  Acc: 0.8621
 Site-White_5                   (1) | Val  Loss: 0.5865 | Val  Acc: 0.8158
 Site-White_6                   (1) | Val  Loss: 0.4399 | Val  Acc: 0.8367
 Site-White_7                   (1) | Val  Loss: 0.3840 | Val  Acc: 0.8281
 Site-White_8                   (1) | Val  Loss: 0.4943 | Val  Acc: 0.7619
 Site-White_9                   (1) | Val  Loss: 0.4165 | Val  Acc: 0.7818
 Site-Black_0                   (0) | Val  Loss: 0.6127 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.7059 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7730
 Test site-White_0                   (1)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (1)| Epoch:43 | Test Acc: 0.8788
 Test site-White_2                   (1)| Epoch:43 | Test Acc: 0.8095
 Test site-White_3                   (1)| Epoch:43 | Test Acc: 0.8182
 Test site-White_4                   (1)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (1)| Epoch:43 | Test Acc: 0.7312
 Test site-White_6                   (1)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (1)| Epoch:43 | Test Acc: 0.9125
 Test site-White_8                   (1)| Epoch:43 | Test Acc: 0.7867
 Test site-White_9                   (1)| Epoch:43 | Test Acc: 0.8655
 Test site-Black_0                   (0)| Epoch:43 | Test Acc: 0.6915
 Test site-Black_1                   (0)| Epoch:43 | Test Acc: 0.7561
White: 0.8218, Black: 0.7238, 
Average Test Accuracy: 0.7728, domain std=0.0490, cluster std=0.0490, individual std=0.0604, 
Average Test Accuracy: 0.7728
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 48 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
min_w=0.00234, quan_i=0.38, quan_c=0.37
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3063 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4154 | Train Acc: 0.8980
 Site-White_2                  | Train Loss: 0.2522 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4508 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3777 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3531 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.4669 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.3968 | Train Acc: 0.8125
 Site-White_8                  | Train Loss: 0.3302 | Train Acc: 0.8533
 Site-White_9                  | Train Loss: 0.3429 | Train Acc: 0.8497
 Site-Black_0                  | Train Loss: 0.5222 | Train Acc: 0.7635
 Site-Black_1                  | Train Loss: 0.5330 | Train Acc: 0.7653
 Site-White_0                   (0) | Val  Loss: 0.4666 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3538 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4883 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.6099 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.3474 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5548 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4130 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4574 | Val  Acc: 0.7969
 Site-White_8                   (0) | Val  Loss: 0.5583 | Val  Acc: 0.6667
 Site-White_9                   (0) | Val  Loss: 0.4799 | Val  Acc: 0.7727
 Site-Black_0                   (1) | Val  Loss: 0.6839 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.6973 | Val  Acc: 0.6122
Average Valid Accuracy: 0.7392
 Test site-White_0                   (0)| Epoch:43 | Test Acc: 0.8400
 Test site-White_1                   (0)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:43 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:43 | Test Acc: 0.7636
 Test site-White_4                   (0)| Epoch:43 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:43 | Test Acc: 0.7204
 Test site-White_6                   (0)| Epoch:43 | Test Acc: 0.8455
 Test site-White_7                   (0)| Epoch:43 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:43 | Test Acc: 0.7915
 Test site-White_9                   (0)| Epoch:43 | Test Acc: 0.8618
 Test site-Black_0                   (1)| Epoch:43 | Test Acc: 0.7128
 Test site-Black_1                   (1)| Epoch:43 | Test Acc: 0.7805
White: 0.8145, Black: 0.7466, 
Average Test Accuracy: 0.7806, domain std=0.0339, cluster std=0.0339, individual std=0.0554, 
Average Test Accuracy: 0.7806
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
min_w=0.00203, quan_i=0.36, quan_c=0.37
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4111 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.3423 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.5699 | Train Acc: 0.8769
 Site-White_3                  | Train Loss: 0.4153 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.4169 | Train Acc: 0.8393
 Site-White_5                  | Train Loss: 0.3708 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4278 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.3980 | Train Acc: 0.7969
 Site-White_8                  | Train Loss: 0.3325 | Train Acc: 0.8683
 Site-White_9                  | Train Loss: 0.3427 | Train Acc: 0.8519
 Site-Black_0                  | Train Loss: 0.5115 | Train Acc: 0.7500
 Site-Black_1                  | Train Loss: 0.5252 | Train Acc: 0.7500
 Site-White_0                   (1) | Val  Loss: 0.4542 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3511 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.5140 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.5106 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.5250 | Val  Acc: 0.7931
 Site-White_5                   (1) | Val  Loss: 0.5789 | Val  Acc: 0.7632
 Site-White_6                   (1) | Val  Loss: 0.4044 | Val  Acc: 0.8367
 Site-White_7                   (1) | Val  Loss: 0.4829 | Val  Acc: 0.8125
 Site-White_8                   (1) | Val  Loss: 0.4431 | Val  Acc: 0.7500
 Site-White_9                   (1) | Val  Loss: 0.4614 | Val  Acc: 0.7727
 Site-Black_0                   (0) | Val  Loss: 0.7038 | Val  Acc: 0.6579
 Site-Black_1                   (0) | Val  Loss: 0.6378 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7587
 Test site-White_0                   (1)| Epoch:48 | Test Acc: 0.8000
 Test site-White_1                   (1)| Epoch:48 | Test Acc: 0.8485
 Test site-White_2                   (1)| Epoch:48 | Test Acc: 0.8095
 Test site-White_3                   (1)| Epoch:48 | Test Acc: 0.8182
 Test site-White_4                   (1)| Epoch:48 | Test Acc: 0.7778
 Test site-White_5                   (1)| Epoch:48 | Test Acc: 0.7204
 Test site-White_6                   (1)| Epoch:48 | Test Acc: 0.8293
 Test site-White_7                   (1)| Epoch:48 | Test Acc: 0.9000
 Test site-White_8                   (1)| Epoch:48 | Test Acc: 0.7867
 Test site-White_9                   (1)| Epoch:48 | Test Acc: 0.8691
 Test site-Black_0                   (0)| Epoch:48 | Test Acc: 0.6915
 Test site-Black_1                   (0)| Epoch:48 | Test Acc: 0.7480
White: 0.8159, Black: 0.7197, 
Average Test Accuracy: 0.7678, domain std=0.0481, cluster std=0.0481, individual std=0.0577, 
Average Test Accuracy: 0.7678
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
===2023-06-07 01:29:10===
===2023-06-07 01:29:12===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0.4
    std_rw: False
    gender_label: True
    binary_race: True
    save_iter: -1
data_number=[37,49,65,86,112,148,194,256,334,439,148,196,]
client_nums=[10,2,]
label set of clients: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, ]
domain number = 2
Loading snapshots...
 Test site-White_0                   (1)| Epoch:48 | Test Acc: 0.8400
 Test site-White_1                   (1)| Epoch:48 | Test Acc: 0.8485
 Test site-White_2                   (1)| Epoch:48 | Test Acc: 0.8095
 Test site-White_3                   (1)| Epoch:48 | Test Acc: 0.7636
 Test site-White_4                   (1)| Epoch:48 | Test Acc: 0.7639
 Test site-White_5                   (1)| Epoch:48 | Test Acc: 0.7204
 Test site-White_6                   (1)| Epoch:48 | Test Acc: 0.8455
 Test site-White_7                   (1)| Epoch:48 | Test Acc: 0.9000
 Test site-White_8                   (1)| Epoch:48 | Test Acc: 0.7915
 Test site-White_9                   (1)| Epoch:48 | Test Acc: 0.8618
 Test site-Black_0                   (0)| Epoch:48 | Test Acc: 0.7128
 Test site-Black_1                   (0)| Epoch:48 | Test Acc: 0.7805
White: 0.8145, Black: 0.7466, 
Average Test Accuracy: 0.7806, domain std=0.0339, cluster std=0.0339, individual std=0.0554, 
===2023-06-07 14:43:29===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0.4
    std_rw: False
    gender_label: True
    binary_race: True
    save_iter: -1
data_number=[37,49,65,86,112,148,194,256,334,439,148,196,]
client_nums=[10,2,]
label set of clients: [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, ]
domain number = 2
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.01793, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.6933 | Train Acc: 0.5676
 Site-White_1                  | Train Loss: 0.6234 | Train Acc: 0.7551
 Site-White_2                  | Train Loss: 0.5971 | Train Acc: 0.7692
 Site-White_3                  | Train Loss: 0.6441 | Train Acc: 0.6628
 Site-White_4                  | Train Loss: 0.6296 | Train Acc: 0.6964
 Site-White_5                  | Train Loss: 0.6357 | Train Acc: 0.7297
 Site-White_6                  | Train Loss: 0.6528 | Train Acc: 0.6546
 Site-White_7                  | Train Loss: 0.6449 | Train Acc: 0.6602
 Site-White_8                  | Train Loss: 0.6322 | Train Acc: 0.7156
 Site-White_9                  | Train Loss: 0.6250 | Train Acc: 0.7198
 Site-Black_0                  | Train Loss: 0.6843 | Train Acc: 0.5743
 Site-Black_1                  | Train Loss: 0.6571 | Train Acc: 0.6327
 Site-White_0                   (0) | Val  Loss: 0.7659 | Val  Acc: 0.5000
 Site-White_1                   (0) | Val  Loss: 0.6275 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.6473 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.6408 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.6842 | Val  Acc: 0.5862
 Site-White_5                   (0) | Val  Loss: 0.6534 | Val  Acc: 0.6842
 Site-White_6                   (0) | Val  Loss: 0.6336 | Val  Acc: 0.6735
 Site-White_7                   (0) | Val  Loss: 0.6422 | Val  Acc: 0.6250
 Site-White_8                   (0) | Val  Loss: 0.6253 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.6528 | Val  Acc: 0.6273
 Site-Black_0                   (1) | Val  Loss: 0.7042 | Val  Acc: 0.4474
 Site-Black_1                   (1) | Val  Loss: 0.6672 | Val  Acc: 0.5510
Average Valid Accuracy: 0.6315
 Best site-White_0                  (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-White_1                  (0)  | Epoch:0 | Val Acc: 0.7692
 Best site-White_2                  (0)  | Epoch:0 | Val Acc: 0.7059
 Best site-White_3                  (0)  | Epoch:0 | Val Acc: 0.6818
 Best site-White_4                  (0)  | Epoch:0 | Val Acc: 0.5862
 Best site-White_5                  (0)  | Epoch:0 | Val Acc: 0.6842
 Best site-White_6                  (0)  | Epoch:0 | Val Acc: 0.6735
 Best site-White_7                  (0)  | Epoch:0 | Val Acc: 0.6250
 Best site-White_8                  (0)  | Epoch:0 | Val Acc: 0.7262
 Best site-White_9                  (0)  | Epoch:0 | Val Acc: 0.6273
 Best site-Black_0                  (1)  | Epoch:0 | Val Acc: 0.4474
 Best site-Black_1                  (1)  | Epoch:0 | Val Acc: 0.5510
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 1 ============
cnt=[11, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.00852, quan_i=0.63, quan_c=0.64
minimize weight of clients:[1, ]
 Site-White_0                  | Train Loss: 0.5445 | Train Acc: 0.6486
 Site-White_1                  | Train Loss: 0.5756 | Train Acc: 0.7551
 Site-White_2                  | Train Loss: 0.6473 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5935 | Train Acc: 0.6512
 Site-White_4                  | Train Loss: 0.5671 | Train Acc: 0.7679
 Site-White_5                  | Train Loss: 0.5723 | Train Acc: 0.7162
 Site-White_6                  | Train Loss: 0.5753 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.5914 | Train Acc: 0.7070
 Site-White_8                  | Train Loss: 0.5720 | Train Acc: 0.7425
 Site-White_9                  | Train Loss: 0.5368 | Train Acc: 0.7745
 Site-Black_0                  | Train Loss: 0.6414 | Train Acc: 0.6284
 Site-Black_1                  | Train Loss: 0.5997 | Train Acc: 0.6071
 Site-White_0                   (0) | Val  Loss: 0.5632 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.5937 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.6130 | Val  Acc: 0.6471
 Site-White_3                   (0) | Val  Loss: 0.5417 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.6022 | Val  Acc: 0.6552
 Site-White_5                   (0) | Val  Loss: 0.6089 | Val  Acc: 0.6842
 Site-White_6                   (0) | Val  Loss: 0.5678 | Val  Acc: 0.6735
 Site-White_7                   (0) | Val  Loss: 0.5458 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.5574 | Val  Acc: 0.6905
 Site-White_9                   (0) | Val  Loss: 0.5674 | Val  Acc: 0.7455
 Site-Black_0                   (0) | Val  Loss: 0.7076 | Val  Acc: 0.5526
 Site-Black_1                   (0) | Val  Loss: 0.6125 | Val  Acc: 0.6735
Average Valid Accuracy: 0.6947
 Best site-White_0                  (0)  | Epoch:1 | Val Acc: 0.8000
 Best site-White_1                  (1)  | Epoch:1 | Val Acc: 0.6923
 Best site-White_2                  (0)  | Epoch:1 | Val Acc: 0.6471
 Best site-White_3                  (0)  | Epoch:1 | Val Acc: 0.7727
 Best site-White_4                  (0)  | Epoch:1 | Val Acc: 0.6552
 Best site-White_5                  (0)  | Epoch:1 | Val Acc: 0.6842
 Best site-White_6                  (0)  | Epoch:1 | Val Acc: 0.6735
 Best site-White_7                  (0)  | Epoch:1 | Val Acc: 0.7500
 Best site-White_8                  (0)  | Epoch:1 | Val Acc: 0.6905
 Best site-White_9                  (0)  | Epoch:1 | Val Acc: 0.7455
 Best site-Black_0                  (0)  | Epoch:1 | Val Acc: 0.5526
 Best site-Black_1                  (0)  | Epoch:1 | Val Acc: 0.6735
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 11, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.00535, quan_i=0.58, quan_c=0.58
minimize weight of clients:[0, ]
 Site-White_0                  | Train Loss: 0.4323 | Train Acc: 0.7297
 Site-White_1                  | Train Loss: 0.4964 | Train Acc: 0.7959
 Site-White_2                  | Train Loss: 0.3603 | Train Acc: 0.8923
 Site-White_3                  | Train Loss: 0.5179 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.4809 | Train Acc: 0.7679
 Site-White_5                  | Train Loss: 0.4981 | Train Acc: 0.7568
 Site-White_6                  | Train Loss: 0.5209 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.5479 | Train Acc: 0.6914
 Site-White_8                  | Train Loss: 0.5152 | Train Acc: 0.7545
 Site-White_9                  | Train Loss: 0.4780 | Train Acc: 0.7813
 Site-Black_0                  | Train Loss: 0.6364 | Train Acc: 0.6622
 Site-Black_1                  | Train Loss: 0.6170 | Train Acc: 0.6480
 Site-White_0                   (0) | Val  Loss: 0.5297 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.5476 | Val  Acc: 0.6923
 Site-White_2                   (1) | Val  Loss: 0.5837 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.6017 | Val  Acc: 0.6818
 Site-White_4                   (1) | Val  Loss: 0.5894 | Val  Acc: 0.6552
 Site-White_5                   (1) | Val  Loss: 0.6460 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4992 | Val  Acc: 0.7959
 Site-White_7                   (1) | Val  Loss: 0.5396 | Val  Acc: 0.7188
 Site-White_8                   (1) | Val  Loss: 0.5029 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.5145 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.8066 | Val  Acc: 0.5789
 Site-Black_1                   (1) | Val  Loss: 0.6511 | Val  Acc: 0.6122
Average Valid Accuracy: 0.6983
 Best site-White_0                  (0)  | Epoch:2 | Val Acc: 0.7000
 Best site-White_1                  (1)  | Epoch:2 | Val Acc: 0.6923
 Best site-White_2                  (1)  | Epoch:2 | Val Acc: 0.7059
 Best site-White_3                  (1)  | Epoch:2 | Val Acc: 0.6818
 Best site-White_4                  (1)  | Epoch:2 | Val Acc: 0.6552
 Best site-White_5                  (1)  | Epoch:2 | Val Acc: 0.7368
 Best site-White_6                  (1)  | Epoch:2 | Val Acc: 0.7959
 Best site-White_7                  (1)  | Epoch:2 | Val Acc: 0.7188
 Best site-White_8                  (1)  | Epoch:2 | Val Acc: 0.7381
 Best site-White_9                  (1)  | Epoch:2 | Val Acc: 0.7636
 Best site-Black_0                  (1)  | Epoch:2 | Val Acc: 0.5789
 Best site-Black_1                  (1)  | Epoch:2 | Val Acc: 0.6122
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 3 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.00353, quan_i=0.50, quan_c=0.50
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4396 | Train Acc: 0.7297
 Site-White_1                  | Train Loss: 0.5311 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2856 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4957 | Train Acc: 0.7442
 Site-White_4                  | Train Loss: 0.4500 | Train Acc: 0.7411
 Site-White_5                  | Train Loss: 0.5038 | Train Acc: 0.7635
 Site-White_6                  | Train Loss: 0.5551 | Train Acc: 0.7113
 Site-White_7                  | Train Loss: 0.5297 | Train Acc: 0.7031
 Site-White_8                  | Train Loss: 0.4596 | Train Acc: 0.7964
 Site-White_9                  | Train Loss: 0.4527 | Train Acc: 0.7790
 Site-Black_0                  | Train Loss: 0.5701 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.6422 | Train Acc: 0.6480
 Site-White_0                   (0) | Val  Loss: 0.4590 | Val  Acc: 0.9000
 Site-White_1                   (0) | Val  Loss: 0.3831 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5937 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.4948 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.5134 | Val  Acc: 0.7586
 Site-White_5                   (0) | Val  Loss: 0.6631 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4735 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.5004 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4844 | Val  Acc: 0.7381
 Site-White_9                   (0) | Val  Loss: 0.5336 | Val  Acc: 0.7091
 Site-Black_0                   (1) | Val  Loss: 0.7844 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.6771 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7456
 Best site-White_0                  (0)  | Epoch:3 | Val Acc: 0.9000
 Best site-White_1                  (0)  | Epoch:3 | Val Acc: 0.8462
 Best site-White_2                  (0)  | Epoch:3 | Val Acc: 0.7059
 Best site-White_3                  (0)  | Epoch:3 | Val Acc: 0.7273
 Best site-White_4                  (0)  | Epoch:3 | Val Acc: 0.7586
 Best site-White_5                  (0)  | Epoch:3 | Val Acc: 0.7105
 Best site-White_6                  (0)  | Epoch:3 | Val Acc: 0.8163
 Best site-White_7                  (0)  | Epoch:3 | Val Acc: 0.7500
 Best site-White_8                  (0)  | Epoch:3 | Val Acc: 0.7381
 Best site-White_9                  (0)  | Epoch:3 | Val Acc: 0.7091
 Best site-Black_0                  (1)  | Epoch:3 | Val Acc: 0.6316
 Best site-Black_1                  (1)  | Epoch:3 | Val Acc: 0.6531
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 4 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.00318, quan_i=0.48, quan_c=0.48
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4688 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.5295 | Train Acc: 0.7959
 Site-White_2                  | Train Loss: 0.2991 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.5089 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.4530 | Train Acc: 0.7589
 Site-White_5                  | Train Loss: 0.4295 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.6203 | Train Acc: 0.7371
 Site-White_7                  | Train Loss: 0.5238 | Train Acc: 0.7188
 Site-White_8                  | Train Loss: 0.4687 | Train Acc: 0.7784
 Site-White_9                  | Train Loss: 0.4410 | Train Acc: 0.8018
 Site-Black_0                  | Train Loss: 0.5902 | Train Acc: 0.6757
 Site-Black_1                  | Train Loss: 0.6510 | Train Acc: 0.6684
 Site-White_0                   (0) | Val  Loss: 0.4719 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.4272 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.6106 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.5376 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.5255 | Val  Acc: 0.6897
 Site-White_5                   (0) | Val  Loss: 0.6765 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4502 | Val  Acc: 0.7959
 Site-White_7                   (0) | Val  Loss: 0.4990 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4583 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4802 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.7907 | Val  Acc: 0.6842
 Site-Black_1                   (1) | Val  Loss: 0.7585 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7261
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 5 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.00353, quan_i=0.47, quan_c=0.48
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4020 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.5323 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2790 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.5237 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.4320 | Train Acc: 0.7679
 Site-White_5                  | Train Loss: 0.4482 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.5232 | Train Acc: 0.7165
 Site-White_7                  | Train Loss: 0.5038 | Train Acc: 0.7422
 Site-White_8                  | Train Loss: 0.4304 | Train Acc: 0.7964
 Site-White_9                  | Train Loss: 0.4403 | Train Acc: 0.7722
 Site-Black_0                  | Train Loss: 0.6135 | Train Acc: 0.6757
 Site-Black_1                  | Train Loss: 0.5505 | Train Acc: 0.6786
 Site-White_0                   (1) | Val  Loss: 0.5228 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3739 | Val  Acc: 0.9231
 Site-White_2                   (1) | Val  Loss: 0.6528 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5974 | Val  Acc: 0.6818
 Site-White_4                   (1) | Val  Loss: 0.5570 | Val  Acc: 0.7586
 Site-White_5                   (1) | Val  Loss: 0.6324 | Val  Acc: 0.6842
 Site-White_6                   (1) | Val  Loss: 0.4547 | Val  Acc: 0.7755
 Site-White_7                   (1) | Val  Loss: 0.4678 | Val  Acc: 0.8125
 Site-White_8                   (1) | Val  Loss: 0.4399 | Val  Acc: 0.8214
 Site-White_9                   (1) | Val  Loss: 0.5222 | Val  Acc: 0.7455
 Site-Black_0                   (0) | Val  Loss: 0.9136 | Val  Acc: 0.6579
 Site-Black_1                   (0) | Val  Loss: 0.6723 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7514
 Best site-White_0                  (1)  | Epoch:5 | Val Acc: 0.7000
 Best site-White_1                  (1)  | Epoch:5 | Val Acc: 0.9231
 Best site-White_2                  (1)  | Epoch:5 | Val Acc: 0.8235
 Best site-White_3                  (1)  | Epoch:5 | Val Acc: 0.6818
 Best site-White_4                  (1)  | Epoch:5 | Val Acc: 0.7586
 Best site-White_5                  (1)  | Epoch:5 | Val Acc: 0.6842
 Best site-White_6                  (1)  | Epoch:5 | Val Acc: 0.7755
 Best site-White_7                  (1)  | Epoch:5 | Val Acc: 0.8125
 Best site-White_8                  (1)  | Epoch:5 | Val Acc: 0.8214
 Best site-White_9                  (1)  | Epoch:5 | Val Acc: 0.7455
 Best site-Black_0                  (0)  | Epoch:5 | Val Acc: 0.6579
 Best site-Black_1                  (0)  | Epoch:5 | Val Acc: 0.6327
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.00311, quan_i=0.44, quan_c=0.46
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3899 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4749 | Train Acc: 0.7755
 Site-White_2                  | Train Loss: 0.2414 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.5069 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.4260 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.4459 | Train Acc: 0.7973
 Site-White_6                  | Train Loss: 0.4711 | Train Acc: 0.7526
 Site-White_7                  | Train Loss: 0.5256 | Train Acc: 0.7305
 Site-White_8                  | Train Loss: 0.4287 | Train Acc: 0.8054
 Site-White_9                  | Train Loss: 0.4461 | Train Acc: 0.7882
 Site-Black_0                  | Train Loss: 0.5572 | Train Acc: 0.7027
 Site-Black_1                  | Train Loss: 0.5450 | Train Acc: 0.6837
 Site-White_0                   (1) | Val  Loss: 0.5986 | Val  Acc: 0.5000
 Site-White_1                   (1) | Val  Loss: 0.4947 | Val  Acc: 0.6923
 Site-White_2                   (1) | Val  Loss: 0.4890 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5322 | Val  Acc: 0.6818
 Site-White_4                   (1) | Val  Loss: 0.4508 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.6726 | Val  Acc: 0.6842
 Site-White_6                   (1) | Val  Loss: 0.4132 | Val  Acc: 0.8571
 Site-White_7                   (1) | Val  Loss: 0.5302 | Val  Acc: 0.7500
 Site-White_8                   (1) | Val  Loss: 0.5006 | Val  Acc: 0.7738
 Site-White_9                   (1) | Val  Loss: 0.5177 | Val  Acc: 0.7455
 Site-Black_0                   (0) | Val  Loss: 0.7865 | Val  Acc: 0.6053
 Site-Black_1                   (0) | Val  Loss: 0.6798 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7145
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 7 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.00262, quan_i=0.45, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3675 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4605 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.3308 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5260 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.4014 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4067 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.5857 | Train Acc: 0.7216
 Site-White_7                  | Train Loss: 0.5050 | Train Acc: 0.7305
 Site-White_8                  | Train Loss: 0.4122 | Train Acc: 0.7904
 Site-White_9                  | Train Loss: 0.4236 | Train Acc: 0.8109
 Site-Black_0                  | Train Loss: 0.5788 | Train Acc: 0.6622
 Site-Black_1                  | Train Loss: 0.6423 | Train Acc: 0.6633
 Site-White_0                   (0) | Val  Loss: 0.4821 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3589 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5762 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.5801 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4657 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5779 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4566 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4927 | Val  Acc: 0.7812
 Site-White_8                   (0) | Val  Loss: 0.4709 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.4906 | Val  Acc: 0.7364
 Site-Black_0                   (1) | Val  Loss: 0.7836 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.6528 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7517
 Best site-White_0                  (0)  | Epoch:7 | Val Acc: 0.8000
 Best site-White_1                  (0)  | Epoch:7 | Val Acc: 0.8462
 Best site-White_2                  (0)  | Epoch:7 | Val Acc: 0.7059
 Best site-White_3                  (0)  | Epoch:7 | Val Acc: 0.7727
 Best site-White_4                  (0)  | Epoch:7 | Val Acc: 0.7931
 Best site-White_5                  (0)  | Epoch:7 | Val Acc: 0.7368
 Best site-White_6                  (0)  | Epoch:7 | Val Acc: 0.8163
 Best site-White_7                  (0)  | Epoch:7 | Val Acc: 0.7812
 Best site-White_8                  (0)  | Epoch:7 | Val Acc: 0.7262
 Best site-White_9                  (0)  | Epoch:7 | Val Acc: 0.7364
 Best site-Black_0                  (1)  | Epoch:7 | Val Acc: 0.6316
 Best site-Black_1                  (1)  | Epoch:7 | Val Acc: 0.6735
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 8 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.00275, quan_i=0.42, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4920 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.5303 | Train Acc: 0.7347
 Site-White_2                  | Train Loss: 0.4942 | Train Acc: 0.7846
 Site-White_3                  | Train Loss: 0.4817 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.4069 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.4105 | Train Acc: 0.8041
 Site-White_6                  | Train Loss: 0.4786 | Train Acc: 0.7320
 Site-White_7                  | Train Loss: 0.5030 | Train Acc: 0.7539
 Site-White_8                  | Train Loss: 0.4117 | Train Acc: 0.8024
 Site-White_9                  | Train Loss: 0.4214 | Train Acc: 0.7882
 Site-Black_0                  | Train Loss: 0.5417 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5760 | Train Acc: 0.6684
 Site-White_0                   (0) | Val  Loss: 0.3603 | Val  Acc: 0.9000
 Site-White_1                   (0) | Val  Loss: 0.3725 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4890 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5467 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.4813 | Val  Acc: 0.7241
 Site-White_5                   (0) | Val  Loss: 0.6205 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4562 | Val  Acc: 0.7347
 Site-White_7                   (0) | Val  Loss: 0.4750 | Val  Acc: 0.7812
 Site-White_8                   (0) | Val  Loss: 0.5042 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.5261 | Val  Acc: 0.7455
 Site-Black_0                   (1) | Val  Loss: 0.6761 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.7923 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7509
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 9 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.00409, quan_i=0.48, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4458 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.4422 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.3645 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4850 | Train Acc: 0.7209
 Site-White_4                  | Train Loss: 0.4189 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.4098 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.5031 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.4814 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.4030 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3996 | Train Acc: 0.8041
 Site-Black_0                  | Train Loss: 0.5951 | Train Acc: 0.6554
 Site-Black_1                  | Train Loss: 0.6315 | Train Acc: 0.6735
 Site-White_0                   (0) | Val  Loss: 0.4767 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3879 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4298 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5643 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.5419 | Val  Acc: 0.7241
 Site-White_5                   (0) | Val  Loss: 0.5156 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4224 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4873 | Val  Acc: 0.7344
 Site-White_8                   (0) | Val  Loss: 0.5237 | Val  Acc: 0.7143
 Site-White_9                   (0) | Val  Loss: 0.4975 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.8115 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.6963 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7390
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 10 ============
cnt=[9, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.00334, quan_i=0.43, quan_c=0.49
minimize weight of clients:[5, 9, ]
 Site-White_0                  | Train Loss: 0.4435 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4335 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2918 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4702 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.4121 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.4249 | Train Acc: 0.8108
 Site-White_6                  | Train Loss: 0.4575 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4666 | Train Acc: 0.7500
 Site-White_8                  | Train Loss: 0.3977 | Train Acc: 0.7994
 Site-White_9                  | Train Loss: 0.4264 | Train Acc: 0.7927
 Site-Black_0                  | Train Loss: 0.5833 | Train Acc: 0.6757
 Site-Black_1                  | Train Loss: 0.5801 | Train Acc: 0.6735
 Site-White_0                   (1) | Val  Loss: 0.5724 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.4412 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.5883 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5715 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4676 | Val  Acc: 0.7586
 Site-White_5                   (1) | Val  Loss: 0.4988 | Val  Acc: 0.8158
 Site-White_6                   (0) | Val  Loss: 0.4149 | Val  Acc: 0.8571
 Site-White_7                   (0) | Val  Loss: 0.4714 | Val  Acc: 0.7969
 Site-White_8                   (0) | Val  Loss: 0.4630 | Val  Acc: 0.7738
 Site-White_9                   (1) | Val  Loss: 0.5314 | Val  Acc: 0.7273
 Site-Black_0                   (0) | Val  Loss: 0.7710 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.6529 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7431
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 11 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.00345, quan_i=0.43, quan_c=0.43
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3718 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.5206 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2669 | Train Acc: 0.8000
 Site-White_3                  | Train Loss: 0.4984 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3900 | Train Acc: 0.8393
 Site-White_5                  | Train Loss: 0.4230 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4775 | Train Acc: 0.7320
 Site-White_7                  | Train Loss: 0.4853 | Train Acc: 0.7422
 Site-White_8                  | Train Loss: 0.3981 | Train Acc: 0.8114
 Site-White_9                  | Train Loss: 0.4159 | Train Acc: 0.8041
 Site-Black_0                  | Train Loss: 0.5296 | Train Acc: 0.7365
 Site-Black_1                  | Train Loss: 0.5173 | Train Acc: 0.7398
 Site-White_0                   (1) | Val  Loss: 0.4429 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.4115 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.5371 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.6571 | Val  Acc: 0.6364
 Site-White_4                   (1) | Val  Loss: 0.4894 | Val  Acc: 0.7586
 Site-White_5                   (1) | Val  Loss: 0.5249 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4404 | Val  Acc: 0.7755
 Site-White_7                   (1) | Val  Loss: 0.4745 | Val  Acc: 0.7188
 Site-White_8                   (1) | Val  Loss: 0.4715 | Val  Acc: 0.7738
 Site-White_9                   (1) | Val  Loss: 0.4911 | Val  Acc: 0.7545
 Site-Black_0                   (0) | Val  Loss: 0.7368 | Val  Acc: 0.5526
 Site-Black_1                   (0) | Val  Loss: 0.6861 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7113
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 12 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.00277, quan_i=0.42, quan_c=0.43
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4121 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4247 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.3356 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4623 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.4215 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.4034 | Train Acc: 0.8514
 Site-White_6                  | Train Loss: 0.5343 | Train Acc: 0.7526
 Site-White_7                  | Train Loss: 0.4870 | Train Acc: 0.7461
 Site-White_8                  | Train Loss: 0.3921 | Train Acc: 0.8323
 Site-White_9                  | Train Loss: 0.4004 | Train Acc: 0.7995
 Site-Black_0                  | Train Loss: 0.5336 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5933 | Train Acc: 0.6888
 Site-White_0                   (0) | Val  Loss: 0.5524 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3184 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5071 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.4858 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4927 | Val  Acc: 0.7586
 Site-White_5                   (0) | Val  Loss: 0.6372 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4561 | Val  Acc: 0.7959
 Site-White_7                   (0) | Val  Loss: 0.4614 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4839 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4325 | Val  Acc: 0.7727
 Site-Black_0                   (1) | Val  Loss: 0.8827 | Val  Acc: 0.6053
 Site-Black_1                   (1) | Val  Loss: 0.6633 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7279
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 13 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.00316, quan_i=0.42, quan_c=0.43
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4823 | Train Acc: 0.8919
 Site-White_1                  | Train Loss: 0.3968 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2458 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4974 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3780 | Train Acc: 0.8393
 Site-White_5                  | Train Loss: 0.3865 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.4889 | Train Acc: 0.7526
 Site-White_7                  | Train Loss: 0.4766 | Train Acc: 0.7461
 Site-White_8                  | Train Loss: 0.3886 | Train Acc: 0.8234
 Site-White_9                  | Train Loss: 0.4134 | Train Acc: 0.7973
 Site-Black_0                  | Train Loss: 0.5660 | Train Acc: 0.6892
 Site-Black_1                  | Train Loss: 0.6290 | Train Acc: 0.6939
 Site-White_0                   (0) | Val  Loss: 0.5969 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3290 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5426 | Val  Acc: 0.8824
 Site-White_3                   (0) | Val  Loss: 0.5431 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.5074 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5683 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4361 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4846 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4653 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4613 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.7035 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.6925 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7575
 Best site-White_0                  (0)  | Epoch:13 | Val Acc: 0.6000
 Best site-White_1                  (0)  | Epoch:13 | Val Acc: 0.8462
 Best site-White_2                  (0)  | Epoch:13 | Val Acc: 0.8824
 Best site-White_3                  (0)  | Epoch:13 | Val Acc: 0.6818
 Best site-White_4                  (0)  | Epoch:13 | Val Acc: 0.8276
 Best site-White_5                  (0)  | Epoch:13 | Val Acc: 0.7368
 Best site-White_6                  (0)  | Epoch:13 | Val Acc: 0.8163
 Best site-White_7                  (0)  | Epoch:13 | Val Acc: 0.7656
 Best site-White_8                  (0)  | Epoch:13 | Val Acc: 0.7738
 Best site-White_9                  (0)  | Epoch:13 | Val Acc: 0.7545
 Best site-Black_0                  (1)  | Epoch:13 | Val Acc: 0.7105
 Best site-Black_1                  (1)  | Epoch:13 | Val Acc: 0.6939
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.00293, quan_i=0.40, quan_c=0.42
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5673 | Train Acc: 0.7027
 Site-White_1                  | Train Loss: 0.4239 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.7728 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4334 | Train Acc: 0.8140
 Site-White_4                  | Train Loss: 0.4060 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4221 | Train Acc: 0.7905
 Site-White_6                  | Train Loss: 0.4992 | Train Acc: 0.7474
 Site-White_7                  | Train Loss: 0.4826 | Train Acc: 0.7500
 Site-White_8                  | Train Loss: 0.4063 | Train Acc: 0.8263
 Site-White_9                  | Train Loss: 0.3988 | Train Acc: 0.8178
 Site-Black_0                  | Train Loss: 0.5323 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5061 | Train Acc: 0.7449
 Site-White_0                   (1) | Val  Loss: 0.4131 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.3292 | Val  Acc: 0.9231
 Site-White_2                   (1) | Val  Loss: 0.4365 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.6133 | Val  Acc: 0.6364
 Site-White_4                   (1) | Val  Loss: 0.5355 | Val  Acc: 0.7931
 Site-White_5                   (1) | Val  Loss: 0.5841 | Val  Acc: 0.7895
 Site-White_6                   (1) | Val  Loss: 0.4394 | Val  Acc: 0.7959
 Site-White_7                   (1) | Val  Loss: 0.4146 | Val  Acc: 0.8125
 Site-White_8                   (1) | Val  Loss: 0.4699 | Val  Acc: 0.7619
 Site-White_9                   (1) | Val  Loss: 0.4575 | Val  Acc: 0.7909
 Site-Black_0                   (0) | Val  Loss: 0.7358 | Val  Acc: 0.6053
 Site-Black_1                   (0) | Val  Loss: 0.7552 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7705
 Best site-White_0                  (1)  | Epoch:14 | Val Acc: 0.8000
 Best site-White_1                  (1)  | Epoch:14 | Val Acc: 0.9231
 Best site-White_2                  (1)  | Epoch:14 | Val Acc: 0.8235
 Best site-White_3                  (1)  | Epoch:14 | Val Acc: 0.6364
 Best site-White_4                  (1)  | Epoch:14 | Val Acc: 0.7931
 Best site-White_5                  (1)  | Epoch:14 | Val Acc: 0.7895
 Best site-White_6                  (1)  | Epoch:14 | Val Acc: 0.7959
 Best site-White_7                  (1)  | Epoch:14 | Val Acc: 0.8125
 Best site-White_8                  (1)  | Epoch:14 | Val Acc: 0.7619
 Best site-White_9                  (1)  | Epoch:14 | Val Acc: 0.7909
 Best site-Black_0                  (0)  | Epoch:14 | Val Acc: 0.6053
 Best site-Black_1                  (0)  | Epoch:14 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 15 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
min_w=0.00448, quan_i=0.43, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4308 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.5106 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2686 | Train Acc: 0.8000
 Site-White_3                  | Train Loss: 0.4565 | Train Acc: 0.8256
 Site-White_4                  | Train Loss: 0.3690 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3953 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.5385 | Train Acc: 0.7216
 Site-White_7                  | Train Loss: 0.4752 | Train Acc: 0.7852
 Site-White_8                  | Train Loss: 0.3628 | Train Acc: 0.8323
 Site-White_9                  | Train Loss: 0.3801 | Train Acc: 0.8200
 Site-Black_0                  | Train Loss: 0.5812 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.5559 | Train Acc: 0.7092
 Site-White_0                   (0) | Val  Loss: 0.5706 | Val  Acc: 0.5000
 Site-White_1                   (0) | Val  Loss: 0.3839 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.5373 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.6385 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.4904 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.5727 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4530 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4256 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4465 | Val  Acc: 0.7857
 Site-White_9                   (0) | Val  Loss: 0.4463 | Val  Acc: 0.8182
 Site-Black_0                   (1) | Val  Loss: 0.7899 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.6665 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7274
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 16 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
min_w=0.00322, quan_i=0.41, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4697 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4302 | Train Acc: 0.8980
 Site-White_2                  | Train Loss: 0.2776 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4599 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3965 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.4160 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4361 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.4764 | Train Acc: 0.7461
 Site-White_8                  | Train Loss: 0.3683 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3849 | Train Acc: 0.8292
 Site-Black_0                  | Train Loss: 0.5570 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.5784 | Train Acc: 0.7041
 Site-White_0                   (0) | Val  Loss: 0.6118 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3245 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4025 | Val  Acc: 0.8824
 Site-White_3                   (0) | Val  Loss: 0.5553 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4388 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5994 | Val  Acc: 0.8421
 Site-White_6                   (0) | Val  Loss: 0.4884 | Val  Acc: 0.7551
 Site-White_7                   (0) | Val  Loss: 0.4539 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.5030 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4556 | Val  Acc: 0.7818
 Site-Black_0                   (1) | Val  Loss: 0.7392 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.7395 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7576
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 17 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
min_w=0.00337, quan_i=0.42, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5076 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.4690 | Train Acc: 0.8163
 Site-White_2                  | Train Loss: 0.3703 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4423 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.4059 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3809 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.4507 | Train Acc: 0.7371
 Site-White_7                  | Train Loss: 0.4726 | Train Acc: 0.7656
 Site-White_8                  | Train Loss: 0.4021 | Train Acc: 0.8144
 Site-White_9                  | Train Loss: 0.3927 | Train Acc: 0.8155
 Site-Black_0                  | Train Loss: 0.5709 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.5863 | Train Acc: 0.6939
 Site-White_0                   (1) | Val  Loss: 0.5127 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.4199 | Val  Acc: 0.6923
 Site-White_2                   (1) | Val  Loss: 0.5391 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5253 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3796 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.6494 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4454 | Val  Acc: 0.7551
 Site-White_7                   (1) | Val  Loss: 0.4420 | Val  Acc: 0.7188
 Site-White_8                   (1) | Val  Loss: 0.4835 | Val  Acc: 0.7619
 Site-White_9                   (1) | Val  Loss: 0.4928 | Val  Acc: 0.7727
 Site-Black_0                   (0) | Val  Loss: 0.7667 | Val  Acc: 0.6316
 Site-Black_1                   (0) | Val  Loss: 0.6338 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7417
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 18 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
min_w=0.00394, quan_i=0.42, quan_c=0.42
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.2496 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4702 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2298 | Train Acc: 0.8769
 Site-White_3                  | Train Loss: 0.4697 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.4330 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4012 | Train Acc: 0.8176
 Site-White_6                  | Train Loss: 0.4924 | Train Acc: 0.7268
 Site-White_7                  | Train Loss: 0.4299 | Train Acc: 0.7734
 Site-White_8                  | Train Loss: 0.3910 | Train Acc: 0.8293
 Site-White_9                  | Train Loss: 0.3946 | Train Acc: 0.8155
 Site-Black_0                  | Train Loss: 0.5393 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5802 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.5245 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.4208 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.5142 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5961 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4806 | Val  Acc: 0.7586
 Site-White_5                   (0) | Val  Loss: 0.6408 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.5140 | Val  Acc: 0.7347
 Site-White_7                   (0) | Val  Loss: 0.5216 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4720 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4763 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.7055 | Val  Acc: 0.6053
 Site-Black_1                   (1) | Val  Loss: 0.7111 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7183
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 19 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
min_w=0.00173, quan_i=0.41, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3080 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4685 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2774 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4479 | Train Acc: 0.8140
 Site-White_4                  | Train Loss: 0.3790 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3469 | Train Acc: 0.8784
 Site-White_6                  | Train Loss: 0.5046 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.4614 | Train Acc: 0.7656
 Site-White_8                  | Train Loss: 0.3806 | Train Acc: 0.8413
 Site-White_9                  | Train Loss: 0.4004 | Train Acc: 0.8132
 Site-Black_0                  | Train Loss: 0.5260 | Train Acc: 0.7365
 Site-Black_1                  | Train Loss: 0.5714 | Train Acc: 0.7092
 Site-White_0                   (1) | Val  Loss: 0.4806 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3942 | Val  Acc: 0.6923
 Site-White_2                   (1) | Val  Loss: 0.3961 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.6544 | Val  Acc: 0.6364
 Site-White_4                   (1) | Val  Loss: 0.4229 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.6037 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4985 | Val  Acc: 0.7755
 Site-White_7                   (1) | Val  Loss: 0.4819 | Val  Acc: 0.7031
 Site-White_8                   (1) | Val  Loss: 0.4558 | Val  Acc: 0.8095
 Site-White_9                   (1) | Val  Loss: 0.4946 | Val  Acc: 0.7818
 Site-Black_0                   (0) | Val  Loss: 0.6308 | Val  Acc: 0.6579
 Site-Black_1                   (0) | Val  Loss: 0.6038 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7331
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 20 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
min_w=0.00220, quan_i=0.39, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4178 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4084 | Train Acc: 0.8980
 Site-White_2                  | Train Loss: 0.3180 | Train Acc: 0.8000
 Site-White_3                  | Train Loss: 0.4674 | Train Acc: 0.7442
 Site-White_4                  | Train Loss: 0.4076 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3685 | Train Acc: 0.8649
 Site-White_6                  | Train Loss: 0.6379 | Train Acc: 0.7629
 Site-White_7                  | Train Loss: 0.4412 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.3776 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3749 | Train Acc: 0.8246
 Site-Black_0                  | Train Loss: 0.5514 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.5989 | Train Acc: 0.7194
 Site-White_0                   (1) | Val  Loss: 0.5049 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.4390 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4788 | Val  Acc: 0.7647
 Site-White_3                   (1) | Val  Loss: 0.5383 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.4353 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.5316 | Val  Acc: 0.7632
 Site-White_6                   (1) | Val  Loss: 0.4352 | Val  Acc: 0.7959
 Site-White_7                   (1) | Val  Loss: 0.4486 | Val  Acc: 0.7656
 Site-White_8                   (1) | Val  Loss: 0.5013 | Val  Acc: 0.7262
 Site-White_9                   (1) | Val  Loss: 0.5206 | Val  Acc: 0.7364
 Site-Black_0                   (0) | Val  Loss: 0.6803 | Val  Acc: 0.6053
 Site-Black_1                   (0) | Val  Loss: 0.6297 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7498
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 21 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
min_w=0.00328, quan_i=0.41, quan_c=0.45
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5992 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4346 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.3499 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4944 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.3861 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.3576 | Train Acc: 0.8514
 Site-White_6                  | Train Loss: 0.4664 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.4433 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.3766 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3813 | Train Acc: 0.8314
 Site-Black_0                  | Train Loss: 0.5352 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5816 | Train Acc: 0.6684
 Site-White_0                   (0) | Val  Loss: 0.6281 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.5052 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.3975 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5662 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3890 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.5205 | Val  Acc: 0.8158
 Site-White_6                   (1) | Val  Loss: 0.4195 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4667 | Val  Acc: 0.7969
 Site-White_8                   (1) | Val  Loss: 0.4834 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.4983 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.7823 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.7266 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7586
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 22 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
min_w=0.00424, quan_i=0.41, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3773 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4152 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2600 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4656 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3823 | Train Acc: 0.7857
 Site-White_5                  | Train Loss: 0.4033 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.5288 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4649 | Train Acc: 0.7852
 Site-White_8                  | Train Loss: 0.3662 | Train Acc: 0.8413
 Site-White_9                  | Train Loss: 0.3572 | Train Acc: 0.8405
 Site-Black_0                  | Train Loss: 0.5074 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.5439 | Train Acc: 0.6990
 Site-White_0                   (1) | Val  Loss: 0.6617 | Val  Acc: 0.6000
 Site-White_1                   (1) | Val  Loss: 0.3241 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.6196 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.5809 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3668 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.5288 | Val  Acc: 0.7368
 Site-White_6                   (1) | Val  Loss: 0.4506 | Val  Acc: 0.8571
 Site-White_7                   (1) | Val  Loss: 0.4802 | Val  Acc: 0.7656
 Site-White_8                   (1) | Val  Loss: 0.4775 | Val  Acc: 0.7619
 Site-White_9                   (1) | Val  Loss: 0.4791 | Val  Acc: 0.7818
 Site-Black_0                   (0) | Val  Loss: 0.8574 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.7106 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7490
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 23 ============
cnt=[1, 11, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
min_w=0.00255, quan_i=0.39, quan_c=0.43
minimize weight of clients:[0, ]
 Site-White_0                  | Train Loss: 0.3824 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.4226 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.5253 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4417 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3940 | Train Acc: 0.7857
 Site-White_5                  | Train Loss: 0.4009 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.4247 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4343 | Train Acc: 0.7930
 Site-White_8                  | Train Loss: 0.3835 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3734 | Train Acc: 0.8360
 Site-Black_0                  | Train Loss: 0.5292 | Train Acc: 0.7365
 Site-Black_1                  | Train Loss: 0.6106 | Train Acc: 0.7092
 Site-White_0                   (0) | Val  Loss: 0.4451 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3657 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.5116 | Val  Acc: 0.8824
 Site-White_3                   (1) | Val  Loss: 0.5812 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.3933 | Val  Acc: 0.8621
 Site-White_5                   (1) | Val  Loss: 0.5403 | Val  Acc: 0.7895
 Site-White_6                   (1) | Val  Loss: 0.4537 | Val  Acc: 0.7959
 Site-White_7                   (1) | Val  Loss: 0.4315 | Val  Acc: 0.7500
 Site-White_8                   (1) | Val  Loss: 0.4865 | Val  Acc: 0.7262
 Site-White_9                   (1) | Val  Loss: 0.4618 | Val  Acc: 0.7909
 Site-Black_0                   (1) | Val  Loss: 0.6483 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.6699 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7720
 Best site-White_0                  (0)  | Epoch:23 | Val Acc: 0.7000
 Best site-White_1                  (1)  | Epoch:23 | Val Acc: 0.7692
 Best site-White_2                  (1)  | Epoch:23 | Val Acc: 0.8824
 Best site-White_3                  (1)  | Epoch:23 | Val Acc: 0.7727
 Best site-White_4                  (1)  | Epoch:23 | Val Acc: 0.8621
 Best site-White_5                  (1)  | Epoch:23 | Val Acc: 0.7895
 Best site-White_6                  (1)  | Epoch:23 | Val Acc: 0.7959
 Best site-White_7                  (1)  | Epoch:23 | Val Acc: 0.7500
 Best site-White_8                  (1)  | Epoch:23 | Val Acc: 0.7262
 Best site-White_9                  (1)  | Epoch:23 | Val Acc: 0.7909
 Best site-Black_0                  (1)  | Epoch:23 | Val Acc: 0.7105
 Best site-Black_1                  (1)  | Epoch:23 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
min_w=0.00294, quan_i=0.41, quan_c=0.43
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3169 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4437 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2576 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4638 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.4000 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.3867 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.4471 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4201 | Train Acc: 0.7734
 Site-White_8                  | Train Loss: 0.3411 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3697 | Train Acc: 0.8246
 Site-Black_0                  | Train Loss: 0.5406 | Train Acc: 0.7162
 Site-Black_1                  | Train Loss: 0.5797 | Train Acc: 0.7143
 Site-White_0                   (1) | Val  Loss: 0.4165 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3943 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4839 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.5062 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.4599 | Val  Acc: 0.7241
 Site-White_5                   (1) | Val  Loss: 0.6097 | Val  Acc: 0.7632
 Site-White_6                   (1) | Val  Loss: 0.4618 | Val  Acc: 0.8367
 Site-White_7                   (1) | Val  Loss: 0.4841 | Val  Acc: 0.7656
 Site-White_8                   (1) | Val  Loss: 0.5009 | Val  Acc: 0.7024
 Site-White_9                   (1) | Val  Loss: 0.4121 | Val  Acc: 0.8273
 Site-Black_0                   (1) | Val  Loss: 0.7040 | Val  Acc: 0.6842
 Site-Black_1                   (1) | Val  Loss: 0.7829 | Val  Acc: 0.6122
Average Valid Accuracy: 0.7386
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 25 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
min_w=0.00217, quan_i=0.39, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4120 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4073 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 1.0169 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4138 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.3663 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4055 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.3980 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.4548 | Train Acc: 0.7422
 Site-White_8                  | Train Loss: 0.3648 | Train Acc: 0.8503
 Site-White_9                  | Train Loss: 0.3764 | Train Acc: 0.8269
 Site-Black_0                  | Train Loss: 0.5745 | Train Acc: 0.6959
 Site-Black_1                  | Train Loss: 0.5174 | Train Acc: 0.6735
 Site-White_0                   (0) | Val  Loss: 0.5178 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.4123 | Val  Acc: 0.6923
 Site-White_2                   (0) | Val  Loss: 0.4758 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.4694 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.3887 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.5743 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4370 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4991 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4601 | Val  Acc: 0.7143
 Site-White_9                   (0) | Val  Loss: 0.4366 | Val  Acc: 0.7455
 Site-Black_0                   (1) | Val  Loss: 0.7326 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.6708 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7427
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 26 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
min_w=0.00310, quan_i=0.41, quan_c=0.42
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3508 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.3820 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2537 | Train Acc: 0.8000
 Site-White_3                  | Train Loss: 0.4680 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3652 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4055 | Train Acc: 0.8176
 Site-White_6                  | Train Loss: 0.4220 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4369 | Train Acc: 0.7891
 Site-White_8                  | Train Loss: 0.3603 | Train Acc: 0.8473
 Site-White_9                  | Train Loss: 0.3750 | Train Acc: 0.8223
 Site-Black_0                  | Train Loss: 0.5276 | Train Acc: 0.7027
 Site-Black_1                  | Train Loss: 0.5426 | Train Acc: 0.6684
 Site-White_0                   (1) | Val  Loss: 0.5344 | Val  Acc: 0.6000
 Site-White_1                   (1) | Val  Loss: 0.3598 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.4473 | Val  Acc: 0.8824
 Site-White_3                   (1) | Val  Loss: 0.5489 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.4305 | Val  Acc: 0.7586
 Site-White_5                   (1) | Val  Loss: 0.5770 | Val  Acc: 0.7105
 Site-White_6                   (1) | Val  Loss: 0.4221 | Val  Acc: 0.8163
 Site-White_7                   (1) | Val  Loss: 0.4427 | Val  Acc: 0.8125
 Site-White_8                   (1) | Val  Loss: 0.4885 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.4861 | Val  Acc: 0.7818
 Site-Black_0                   (0) | Val  Loss: 0.8225 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.6935 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7483
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 27 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
min_w=0.00244, quan_i=0.38, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5741 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.3981 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.3060 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5052 | Train Acc: 0.7442
 Site-White_4                  | Train Loss: 0.4058 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3979 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.4293 | Train Acc: 0.7629
 Site-White_7                  | Train Loss: 0.4199 | Train Acc: 0.7930
 Site-White_8                  | Train Loss: 0.3644 | Train Acc: 0.8383
 Site-White_9                  | Train Loss: 0.3424 | Train Acc: 0.8497
 Site-Black_0                  | Train Loss: 0.5055 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.4983 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.5824 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3790 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4358 | Val  Acc: 0.8824
 Site-White_3                   (0) | Val  Loss: 0.4694 | Val  Acc: 0.8182
 Site-White_4                   (0) | Val  Loss: 0.3708 | Val  Acc: 0.7586
 Site-White_5                   (0) | Val  Loss: 0.5254 | Val  Acc: 0.7895
 Site-White_6                   (0) | Val  Loss: 0.4339 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4287 | Val  Acc: 0.7969
 Site-White_8                   (0) | Val  Loss: 0.4678 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4944 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.6761 | Val  Acc: 0.6842
 Site-Black_1                   (1) | Val  Loss: 0.6423 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7676
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 28 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
min_w=0.00370, quan_i=0.40, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4925 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4468 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.3167 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4490 | Train Acc: 0.8140
 Site-White_4                  | Train Loss: 0.3460 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.4053 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.4690 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4505 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.3331 | Train Acc: 0.8713
 Site-White_9                  | Train Loss: 0.3389 | Train Acc: 0.8588
 Site-Black_0                  | Train Loss: 0.4814 | Train Acc: 0.7635
 Site-Black_1                  | Train Loss: 0.6115 | Train Acc: 0.7143
 Site-White_0                   (0) | Val  Loss: 0.5937 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3701 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4603 | Val  Acc: 0.6471
 Site-White_3                   (0) | Val  Loss: 0.4929 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.3372 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.5917 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4442 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.5144 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4800 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4442 | Val  Acc: 0.8000
 Site-Black_0                   (1) | Val  Loss: 0.7047 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.7246 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7274
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 29 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
min_w=0.00345, quan_i=0.42, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3037 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4223 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2613 | Train Acc: 0.9077
 Site-White_3                  | Train Loss: 0.4208 | Train Acc: 0.8256
 Site-White_4                  | Train Loss: 0.4032 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.3576 | Train Acc: 0.8986
 Site-White_6                  | Train Loss: 0.4169 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4436 | Train Acc: 0.8047
 Site-White_8                  | Train Loss: 0.3637 | Train Acc: 0.8353
 Site-White_9                  | Train Loss: 0.3622 | Train Acc: 0.8451
 Site-Black_0                  | Train Loss: 0.5271 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.5088 | Train Acc: 0.7296
 Site-White_0                   (0) | Val  Loss: 0.6098 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3596 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4867 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.6477 | Val  Acc: 0.6364
 Site-White_4                   (0) | Val  Loss: 0.4686 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.6193 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4093 | Val  Acc: 0.7755
 Site-White_7                   (0) | Val  Loss: 0.4602 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4560 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4555 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.6386 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.7142 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7285
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 30 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
min_w=0.00207, quan_i=0.38, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4929 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.3873 | Train Acc: 0.8163
 Site-White_2                  | Train Loss: 0.3012 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5054 | Train Acc: 0.7209
 Site-White_4                  | Train Loss: 0.3862 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.3727 | Train Acc: 0.8716
 Site-White_6                  | Train Loss: 0.3874 | Train Acc: 0.7835
 Site-White_7                  | Train Loss: 0.3961 | Train Acc: 0.8320
 Site-White_8                  | Train Loss: 0.3630 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3581 | Train Acc: 0.8405
 Site-Black_0                  | Train Loss: 0.5362 | Train Acc: 0.7095
 Site-Black_1                  | Train Loss: 0.5345 | Train Acc: 0.7347
 Site-White_0                   (1) | Val  Loss: 0.5952 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3700 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.4528 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.5243 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3806 | Val  Acc: 0.8966
 Site-White_5                   (1) | Val  Loss: 0.5681 | Val  Acc: 0.7895
 Site-White_6                   (1) | Val  Loss: 0.4338 | Val  Acc: 0.8571
 Site-White_7                   (1) | Val  Loss: 0.4488 | Val  Acc: 0.7812
 Site-White_8                   (1) | Val  Loss: 0.5000 | Val  Acc: 0.7857
 Site-White_9                   (1) | Val  Loss: 0.4640 | Val  Acc: 0.7545
 Site-Black_0                   (0) | Val  Loss: 0.7033 | Val  Acc: 0.6316
 Site-Black_1                   (0) | Val  Loss: 0.6983 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7526
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 31 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
min_w=0.00341, quan_i=0.39, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.6165 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.3961 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2212 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4753 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.3705 | Train Acc: 0.8393
 Site-White_5                  | Train Loss: 0.4154 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.4827 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.4346 | Train Acc: 0.7930
 Site-White_8                  | Train Loss: 0.3508 | Train Acc: 0.8413
 Site-White_9                  | Train Loss: 0.3637 | Train Acc: 0.8155
 Site-Black_0                  | Train Loss: 0.5217 | Train Acc: 0.7500
 Site-Black_1                  | Train Loss: 0.5588 | Train Acc: 0.7500
 Site-White_0                   (0) | Val  Loss: 0.5170 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3741 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5096 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5839 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4157 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5537 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4442 | Val  Acc: 0.7551
 Site-White_7                   (0) | Val  Loss: 0.4784 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.5067 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.4952 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.5832 | Val  Acc: 0.7105
 Site-Black_1                   (1) | Val  Loss: 0.6548 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7485
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 32 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
min_w=0.00272, quan_i=0.40, quan_c=0.40
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4226 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.4337 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2427 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.5100 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.3800 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.3711 | Train Acc: 0.8446
 Site-White_6                  | Train Loss: 0.4060 | Train Acc: 0.7526
 Site-White_7                  | Train Loss: 0.4173 | Train Acc: 0.7969
 Site-White_8                  | Train Loss: 0.3383 | Train Acc: 0.8503
 Site-White_9                  | Train Loss: 0.3698 | Train Acc: 0.8383
 Site-Black_0                  | Train Loss: 0.5073 | Train Acc: 0.7297
 Site-Black_1                  | Train Loss: 0.5445 | Train Acc: 0.7041
 Site-White_0                   (0) | Val  Loss: 0.4464 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3670 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.5391 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5638 | Val  Acc: 0.6364
 Site-White_4                   (0) | Val  Loss: 0.4875 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5383 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4198 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4650 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4359 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4411 | Val  Acc: 0.8000
 Site-Black_0                   (1) | Val  Loss: 0.7945 | Val  Acc: 0.6053
 Site-Black_1                   (1) | Val  Loss: 0.7193 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7479
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 33 ============
cnt=[11, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
min_w=0.00306, quan_i=0.39, quan_c=0.41
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3226 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.3914 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.3166 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4830 | Train Acc: 0.7907
 Site-White_4                  | Train Loss: 0.4126 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.3833 | Train Acc: 0.8919
 Site-White_6                  | Train Loss: 0.5137 | Train Acc: 0.7474
 Site-White_7                  | Train Loss: 0.4150 | Train Acc: 0.7891
 Site-White_8                  | Train Loss: 0.3633 | Train Acc: 0.8323
 Site-White_9                  | Train Loss: 0.3755 | Train Acc: 0.8383
 Site-Black_0                  | Train Loss: 0.5190 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5147 | Train Acc: 0.7296
 Site-White_0                   (1) | Val  Loss: 0.5111 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3868 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5385 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.5229 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.3485 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.5485 | Val  Acc: 0.7632
 Site-White_6                   (0) | Val  Loss: 0.4421 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4765 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.4659 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4563 | Val  Acc: 0.7727
 Site-Black_0                   (0) | Val  Loss: 0.7999 | Val  Acc: 0.5526
 Site-Black_1                   (0) | Val  Loss: 0.6243 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7515
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 34 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
min_w=0.00231, quan_i=0.39, quan_c=0.40
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.6381 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4458 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2540 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4562 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3710 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3896 | Train Acc: 0.8446
 Site-White_6                  | Train Loss: 0.4488 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4358 | Train Acc: 0.7930
 Site-White_8                  | Train Loss: 0.3560 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3494 | Train Acc: 0.8269
 Site-Black_0                  | Train Loss: 0.5069 | Train Acc: 0.7703
 Site-Black_1                  | Train Loss: 0.5780 | Train Acc: 0.7296
 Site-White_0                   (0) | Val  Loss: 0.5878 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3571 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4546 | Val  Acc: 0.8235
 Site-White_3                   (0) | Val  Loss: 0.6126 | Val  Acc: 0.6818
 Site-White_4                   (0) | Val  Loss: 0.4624 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.6265 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4228 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4348 | Val  Acc: 0.8125
 Site-White_8                   (0) | Val  Loss: 0.4671 | Val  Acc: 0.7976
 Site-White_9                   (0) | Val  Loss: 0.4507 | Val  Acc: 0.7455
 Site-Black_0                   (1) | Val  Loss: 0.8383 | Val  Acc: 0.6316
 Site-Black_1                   (1) | Val  Loss: 0.7408 | Val  Acc: 0.7551
Average Valid Accuracy: 0.7641
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 35 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
min_w=0.00310, quan_i=0.41, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3614 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.3693 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2353 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4973 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3437 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.3912 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4221 | Train Acc: 0.7835
 Site-White_7                  | Train Loss: 0.4102 | Train Acc: 0.8008
 Site-White_8                  | Train Loss: 0.3456 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3592 | Train Acc: 0.8337
 Site-Black_0                  | Train Loss: 0.5583 | Train Acc: 0.7027
 Site-Black_1                  | Train Loss: 0.5773 | Train Acc: 0.7500
 Site-White_0                   (1) | Val  Loss: 0.4396 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.3656 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.3602 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.6032 | Val  Acc: 0.6818
 Site-White_4                   (1) | Val  Loss: 0.4104 | Val  Acc: 0.7931
 Site-White_5                   (1) | Val  Loss: 0.5053 | Val  Acc: 0.7105
 Site-White_6                   (1) | Val  Loss: 0.4783 | Val  Acc: 0.8163
 Site-White_7                   (1) | Val  Loss: 0.4347 | Val  Acc: 0.7500
 Site-White_8                   (1) | Val  Loss: 0.5166 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.4537 | Val  Acc: 0.7636
 Site-Black_0                   (0) | Val  Loss: 0.6776 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.6832 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7537
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 36 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
min_w=0.00244, quan_i=0.37, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3087 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4272 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2593 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4187 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3754 | Train Acc: 0.7946
 Site-White_5                  | Train Loss: 0.3971 | Train Acc: 0.8446
 Site-White_6                  | Train Loss: 0.4022 | Train Acc: 0.8041
 Site-White_7                  | Train Loss: 0.4412 | Train Acc: 0.7617
 Site-White_8                  | Train Loss: 0.3253 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3534 | Train Acc: 0.8223
 Site-Black_0                  | Train Loss: 0.4921 | Train Acc: 0.7365
 Site-Black_1                  | Train Loss: 0.5806 | Train Acc: 0.7041
 Site-White_0                   (0) | Val  Loss: 0.5053 | Val  Acc: 0.7000
 Site-White_1                   (0) | Val  Loss: 0.3367 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5059 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5118 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.3487 | Val  Acc: 0.8621
 Site-White_5                   (0) | Val  Loss: 0.6260 | Val  Acc: 0.7895
 Site-White_6                   (0) | Val  Loss: 0.4003 | Val  Acc: 0.8571
 Site-White_7                   (0) | Val  Loss: 0.5010 | Val  Acc: 0.7344
 Site-White_8                   (0) | Val  Loss: 0.4899 | Val  Acc: 0.7143
 Site-White_9                   (0) | Val  Loss: 0.4723 | Val  Acc: 0.7636
 Site-Black_0                   (1) | Val  Loss: 0.7583 | Val  Acc: 0.6053
 Site-Black_1                   (1) | Val  Loss: 0.6787 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7532
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 37 ============
cnt=[1, 11, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
min_w=0.00172, quan_i=0.38, quan_c=0.40
minimize weight of clients:[0, ]
 Site-White_0                  | Train Loss: 0.4828 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4024 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.4754 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4581 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.4342 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3949 | Train Acc: 0.8446
 Site-White_6                  | Train Loss: 0.4205 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.4144 | Train Acc: 0.7852
 Site-White_8                  | Train Loss: 0.3528 | Train Acc: 0.8473
 Site-White_9                  | Train Loss: 0.3308 | Train Acc: 0.8542
 Site-Black_0                  | Train Loss: 0.5459 | Train Acc: 0.7230
 Site-Black_1                  | Train Loss: 0.5104 | Train Acc: 0.7347
 Site-White_0                   (0) | Val  Loss: 0.6805 | Val  Acc: 0.6000
 Site-White_1                   (1) | Val  Loss: 0.3761 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4206 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5551 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.4666 | Val  Acc: 0.7931
 Site-White_5                   (1) | Val  Loss: 0.5870 | Val  Acc: 0.6842
 Site-White_6                   (1) | Val  Loss: 0.4082 | Val  Acc: 0.8163
 Site-White_7                   (1) | Val  Loss: 0.4474 | Val  Acc: 0.7656
 Site-White_8                   (1) | Val  Loss: 0.4985 | Val  Acc: 0.7381
 Site-White_9                   (1) | Val  Loss: 0.4257 | Val  Acc: 0.7909
 Site-Black_0                   (1) | Val  Loss: 0.5526 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.7529 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7485
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 38 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
min_w=0.00337, quan_i=0.42, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4040 | Train Acc: 0.7568
 Site-White_1                  | Train Loss: 0.3486 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.2469 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4917 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.3787 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.4094 | Train Acc: 0.8243
 Site-White_6                  | Train Loss: 0.4278 | Train Acc: 0.7938
 Site-White_7                  | Train Loss: 0.4357 | Train Acc: 0.7617
 Site-White_8                  | Train Loss: 0.3440 | Train Acc: 0.8293
 Site-White_9                  | Train Loss: 0.3473 | Train Acc: 0.8337
 Site-Black_0                  | Train Loss: 0.4843 | Train Acc: 0.7500
 Site-Black_1                  | Train Loss: 0.5796 | Train Acc: 0.7143
 Site-White_0                   (1) | Val  Loss: 0.4526 | Val  Acc: 0.8000
 Site-White_1                   (1) | Val  Loss: 0.4187 | Val  Acc: 0.7692
 Site-White_2                   (1) | Val  Loss: 0.4605 | Val  Acc: 0.7647
 Site-White_3                   (1) | Val  Loss: 0.5756 | Val  Acc: 0.7273
 Site-White_4                   (1) | Val  Loss: 0.3524 | Val  Acc: 0.8621
 Site-White_5                   (1) | Val  Loss: 0.5521 | Val  Acc: 0.7895
 Site-White_6                   (1) | Val  Loss: 0.4457 | Val  Acc: 0.8367
 Site-White_7                   (1) | Val  Loss: 0.4165 | Val  Acc: 0.8281
 Site-White_8                   (1) | Val  Loss: 0.5227 | Val  Acc: 0.7024
 Site-White_9                   (1) | Val  Loss: 0.4264 | Val  Acc: 0.7909
 Site-Black_0                   (0) | Val  Loss: 0.7179 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.6333 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7673
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 39 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
min_w=0.00277, quan_i=0.39, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.5118 | Train Acc: 0.8919
 Site-White_1                  | Train Loss: 0.3961 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2407 | Train Acc: 0.8308
 Site-White_3                  | Train Loss: 0.4343 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3732 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.3776 | Train Acc: 0.8649
 Site-White_6                  | Train Loss: 0.4768 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4159 | Train Acc: 0.8008
 Site-White_8                  | Train Loss: 0.3505 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3540 | Train Acc: 0.8405
 Site-Black_0                  | Train Loss: 0.5228 | Train Acc: 0.7162
 Site-Black_1                  | Train Loss: 0.5363 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.5179 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3603 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4228 | Val  Acc: 0.8824
 Site-White_3                   (0) | Val  Loss: 0.5110 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4508 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.6033 | Val  Acc: 0.8158
 Site-White_6                   (0) | Val  Loss: 0.4536 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4438 | Val  Acc: 0.8281
 Site-White_8                   (0) | Val  Loss: 0.5212 | Val  Acc: 0.7500
 Site-White_9                   (0) | Val  Loss: 0.4541 | Val  Acc: 0.8000
 Site-Black_0                   (1) | Val  Loss: 0.7255 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.6139 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7905
 Best site-White_0                  (0)  | Epoch:39 | Val Acc: 0.8000
 Best site-White_1                  (0)  | Epoch:39 | Val Acc: 0.8462
 Best site-White_2                  (0)  | Epoch:39 | Val Acc: 0.8824
 Best site-White_3                  (0)  | Epoch:39 | Val Acc: 0.7273
 Best site-White_4                  (0)  | Epoch:39 | Val Acc: 0.8276
 Best site-White_5                  (0)  | Epoch:39 | Val Acc: 0.8158
 Best site-White_6                  (0)  | Epoch:39 | Val Acc: 0.8367
 Best site-White_7                  (0)  | Epoch:39 | Val Acc: 0.8281
 Best site-White_8                  (0)  | Epoch:39 | Val Acc: 0.7500
 Best site-White_9                  (0)  | Epoch:39 | Val Acc: 0.8000
 Best site-Black_0                  (1)  | Epoch:39 | Val Acc: 0.6579
 Best site-Black_1                  (1)  | Epoch:39 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
 Test site-White_0                   (0)| Epoch:39 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:39 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:39 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:39 | Test Acc: 0.8182
 Test site-White_4                   (0)| Epoch:39 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:39 | Test Acc: 0.7312
 Test site-White_6                   (0)| Epoch:39 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:39 | Test Acc: 0.8938
 Test site-White_8                   (0)| Epoch:39 | Test Acc: 0.7915
 Test site-White_9                   (0)| Epoch:39 | Test Acc: 0.8655
 Test site-Black_0                   (1)| Epoch:39 | Test Acc: 0.7021
 Test site-Black_1                   (1)| Epoch:39 | Test Acc: 0.7398
White: 0.8159, Black: 0.7210, 
Average Test Accuracy: 0.7685, domain std=0.0475, cluster std=0.0475, individual std=0.0552, 
============ Train epoch 40 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
min_w=0.00290, quan_i=0.39, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3589 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.4514 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2603 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4356 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3258 | Train Acc: 0.8571
 Site-White_5                  | Train Loss: 0.4052 | Train Acc: 0.8311
 Site-White_6                  | Train Loss: 0.4404 | Train Acc: 0.7990
 Site-White_7                  | Train Loss: 0.4264 | Train Acc: 0.8008
 Site-White_8                  | Train Loss: 0.3531 | Train Acc: 0.8653
 Site-White_9                  | Train Loss: 0.3491 | Train Acc: 0.8542
 Site-Black_0                  | Train Loss: 0.5230 | Train Acc: 0.7162
 Site-Black_1                  | Train Loss: 0.4804 | Train Acc: 0.7449
 Site-White_0                   (0) | Val  Loss: 0.5264 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3328 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.5612 | Val  Acc: 0.6471
 Site-White_3                   (0) | Val  Loss: 0.5102 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.3884 | Val  Acc: 0.8966
 Site-White_5                   (0) | Val  Loss: 0.5968 | Val  Acc: 0.7105
 Site-White_6                   (0) | Val  Loss: 0.4354 | Val  Acc: 0.8571
 Site-White_7                   (0) | Val  Loss: 0.4295 | Val  Acc: 0.7344
 Site-White_8                   (0) | Val  Loss: 0.4342 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4529 | Val  Acc: 0.8000
 Site-Black_0                   (1) | Val  Loss: 0.7242 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.6874 | Val  Acc: 0.6735
Average Valid Accuracy: 0.7632
 Test site-White_0                   (0)| Epoch:39 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:39 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:39 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:39 | Test Acc: 0.8000
 Test site-White_4                   (0)| Epoch:39 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:39 | Test Acc: 0.7097
 Test site-White_6                   (0)| Epoch:39 | Test Acc: 0.8293
 Test site-White_7                   (0)| Epoch:39 | Test Acc: 0.8875
 Test site-White_8                   (0)| Epoch:39 | Test Acc: 0.8104
 Test site-White_9                   (0)| Epoch:39 | Test Acc: 0.8545
 Test site-Black_0                   (1)| Epoch:39 | Test Acc: 0.7234
 Test site-Black_1                   (1)| Epoch:39 | Test Acc: 0.7561
White: 0.8113, Black: 0.7398, 
Average Test Accuracy: 0.7755, domain std=0.0358, cluster std=0.0358, individual std=0.0511, 
Average Test Accuracy: 0.7755
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 41 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
min_w=0.00245, quan_i=0.38, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4856 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4192 | Train Acc: 0.7959
 Site-White_2                  | Train Loss: 0.2524 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4481 | Train Acc: 0.7791
 Site-White_4                  | Train Loss: 0.3571 | Train Acc: 0.8125
 Site-White_5                  | Train Loss: 0.3613 | Train Acc: 0.8716
 Site-White_6                  | Train Loss: 0.3925 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4174 | Train Acc: 0.7852
 Site-White_8                  | Train Loss: 0.3592 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3351 | Train Acc: 0.8633
 Site-Black_0                  | Train Loss: 0.5428 | Train Acc: 0.7027
 Site-Black_1                  | Train Loss: 0.5089 | Train Acc: 0.7602
 Site-White_0                   (0) | Val  Loss: 0.5058 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.4215 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4794 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.5097 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4269 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.6945 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.3732 | Val  Acc: 0.8776
 Site-White_7                   (0) | Val  Loss: 0.4860 | Val  Acc: 0.7500
 Site-White_8                   (0) | Val  Loss: 0.5278 | Val  Acc: 0.7262
 Site-White_9                   (0) | Val  Loss: 0.4183 | Val  Acc: 0.7909
 Site-Black_0                   (1) | Val  Loss: 0.7071 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.6311 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7657
 Test site-White_0                   (0)| Epoch:40 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:40 | Test Acc: 0.8788
 Test site-White_2                   (0)| Epoch:40 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:40 | Test Acc: 0.8000
 Test site-White_4                   (0)| Epoch:40 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:40 | Test Acc: 0.7312
 Test site-White_6                   (0)| Epoch:40 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:40 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:40 | Test Acc: 0.7820
 Test site-White_9                   (0)| Epoch:40 | Test Acc: 0.8691
 Test site-Black_0                   (1)| Epoch:40 | Test Acc: 0.7021
 Test site-Black_1                   (1)| Epoch:40 | Test Acc: 0.7398
White: 0.8172, Black: 0.7210, 
Average Test Accuracy: 0.7691, domain std=0.0481, cluster std=0.0481, individual std=0.0592, 
Average Test Accuracy: 0.7691
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 42 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
min_w=0.00294, quan_i=0.37, quan_c=0.37
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3362 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.4301 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2324 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4823 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.3952 | Train Acc: 0.7768
 Site-White_5                  | Train Loss: 0.3922 | Train Acc: 0.8514
 Site-White_6                  | Train Loss: 0.4226 | Train Acc: 0.7784
 Site-White_7                  | Train Loss: 0.4245 | Train Acc: 0.7969
 Site-White_8                  | Train Loss: 0.3621 | Train Acc: 0.8383
 Site-White_9                  | Train Loss: 0.3437 | Train Acc: 0.8360
 Site-Black_0                  | Train Loss: 0.4892 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.4669 | Train Acc: 0.7296
 Site-White_0                   (0) | Val  Loss: 0.3494 | Val  Acc: 0.9000
 Site-White_1                   (0) | Val  Loss: 0.4043 | Val  Acc: 0.7692
 Site-White_2                   (0) | Val  Loss: 0.4410 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.4331 | Val  Acc: 0.8182
 Site-White_4                   (0) | Val  Loss: 0.4867 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5631 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4560 | Val  Acc: 0.7959
 Site-White_7                   (0) | Val  Loss: 0.4252 | Val  Acc: 0.8125
 Site-White_8                   (0) | Val  Loss: 0.5034 | Val  Acc: 0.7619
 Site-White_9                   (0) | Val  Loss: 0.4837 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.6386 | Val  Acc: 0.7368
 Site-Black_1                   (1) | Val  Loss: 0.7007 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7747
 Test site-White_0                   (0)| Epoch:40 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:40 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:40 | Test Acc: 0.7857
 Test site-White_3                   (0)| Epoch:40 | Test Acc: 0.8000
 Test site-White_4                   (0)| Epoch:40 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:40 | Test Acc: 0.7097
 Test site-White_6                   (0)| Epoch:40 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:40 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:40 | Test Acc: 0.7820
 Test site-White_9                   (0)| Epoch:40 | Test Acc: 0.8655
 Test site-Black_0                   (1)| Epoch:40 | Test Acc: 0.7128
 Test site-Black_1                   (1)| Epoch:40 | Test Acc: 0.7642
White: 0.8093, Black: 0.7385, 
Average Test Accuracy: 0.7739, domain std=0.0354, cluster std=0.0354, individual std=0.0554, 
Average Test Accuracy: 0.7739
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 43 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
min_w=0.00230, quan_i=0.39, quan_c=0.38
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3608 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.3845 | Train Acc: 0.8571
 Site-White_2                  | Train Loss: 0.2591 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4989 | Train Acc: 0.7326
 Site-White_4                  | Train Loss: 0.3495 | Train Acc: 0.8304
 Site-White_5                  | Train Loss: 0.3625 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.4828 | Train Acc: 0.7938
 Site-White_7                  | Train Loss: 0.3888 | Train Acc: 0.8125
 Site-White_8                  | Train Loss: 0.3416 | Train Acc: 0.8623
 Site-White_9                  | Train Loss: 0.3363 | Train Acc: 0.8542
 Site-Black_0                  | Train Loss: 0.5049 | Train Acc: 0.7500
 Site-Black_1                  | Train Loss: 0.4740 | Train Acc: 0.7551
 Site-White_0                   (1) | Val  Loss: 0.4404 | Val  Acc: 0.9000
 Site-White_1                   (1) | Val  Loss: 0.2815 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4009 | Val  Acc: 0.8235
 Site-White_3                   (1) | Val  Loss: 0.5868 | Val  Acc: 0.8182
 Site-White_4                   (1) | Val  Loss: 0.4305 | Val  Acc: 0.8276
 Site-White_5                   (1) | Val  Loss: 0.5093 | Val  Acc: 0.8158
 Site-White_6                   (1) | Val  Loss: 0.4087 | Val  Acc: 0.8980
 Site-White_7                   (1) | Val  Loss: 0.4307 | Val  Acc: 0.7500
 Site-White_8                   (1) | Val  Loss: 0.4950 | Val  Acc: 0.7500
 Site-White_9                   (1) | Val  Loss: 0.4253 | Val  Acc: 0.7909
 Site-Black_0                   (0) | Val  Loss: 0.7284 | Val  Acc: 0.7105
 Site-Black_1                   (0) | Val  Loss: 0.7998 | Val  Acc: 0.6327
Average Valid Accuracy: 0.7969
 Best site-White_0                  (1)  | Epoch:43 | Val Acc: 0.9000
 Best site-White_1                  (1)  | Epoch:43 | Val Acc: 0.8462
 Best site-White_2                  (1)  | Epoch:43 | Val Acc: 0.8235
 Best site-White_3                  (1)  | Epoch:43 | Val Acc: 0.8182
 Best site-White_4                  (1)  | Epoch:43 | Val Acc: 0.8276
 Best site-White_5                  (1)  | Epoch:43 | Val Acc: 0.8158
 Best site-White_6                  (1)  | Epoch:43 | Val Acc: 0.8980
 Best site-White_7                  (1)  | Epoch:43 | Val Acc: 0.7500
 Best site-White_8                  (1)  | Epoch:43 | Val Acc: 0.7500
 Best site-White_9                  (1)  | Epoch:43 | Val Acc: 0.7909
 Best site-Black_0                  (0)  | Epoch:43 | Val Acc: 0.7105
 Best site-Black_1                  (0)  | Epoch:43 | Val Acc: 0.6327
 Test site-White_0                   (1)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (1)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (1)| Epoch:43 | Test Acc: 0.7857
 Test site-White_3                   (1)| Epoch:43 | Test Acc: 0.8000
 Test site-White_4                   (1)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (1)| Epoch:43 | Test Acc: 0.7204
 Test site-White_6                   (1)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (1)| Epoch:43 | Test Acc: 0.8938
 Test site-White_8                   (1)| Epoch:43 | Test Acc: 0.7867
 Test site-White_9                   (1)| Epoch:43 | Test Acc: 0.8618
 Test site-Black_0                   (0)| Epoch:43 | Test Acc: 0.7021
 Test site-Black_1                   (0)| Epoch:43 | Test Acc: 0.7561
White: 0.8112, Black: 0.7291, 
Average Test Accuracy: 0.7702, domain std=0.0410, cluster std=0.0410, individual std=0.0540, 
Average Test Accuracy: 0.7702
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 44 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
min_w=0.00241, quan_i=0.36, quan_c=0.37
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3815 | Train Acc: 0.8649
 Site-White_1                  | Train Loss: 0.3375 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.2129 | Train Acc: 0.8769
 Site-White_3                  | Train Loss: 0.4298 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.3808 | Train Acc: 0.7857
 Site-White_5                  | Train Loss: 0.3922 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.5790 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.4063 | Train Acc: 0.7773
 Site-White_8                  | Train Loss: 0.3354 | Train Acc: 0.8443
 Site-White_9                  | Train Loss: 0.3340 | Train Acc: 0.8474
 Site-Black_0                  | Train Loss: 0.4852 | Train Acc: 0.7635
 Site-Black_1                  | Train Loss: 0.6528 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.5386 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.4064 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4280 | Val  Acc: 0.7059
 Site-White_3                   (0) | Val  Loss: 0.4619 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.4872 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5699 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.3781 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4845 | Val  Acc: 0.7656
 Site-White_8                   (0) | Val  Loss: 0.4967 | Val  Acc: 0.7143
 Site-White_9                   (0) | Val  Loss: 0.4634 | Val  Acc: 0.7545
 Site-Black_0                   (1) | Val  Loss: 0.6779 | Val  Acc: 0.5789
 Site-Black_1                   (1) | Val  Loss: 0.6380 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7499
 Test site-White_0                   (0)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:43 | Test Acc: 0.7857
 Test site-White_3                   (0)| Epoch:43 | Test Acc: 0.8000
 Test site-White_4                   (0)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (0)| Epoch:43 | Test Acc: 0.7312
 Test site-White_6                   (0)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:43 | Test Acc: 0.8938
 Test site-White_8                   (0)| Epoch:43 | Test Acc: 0.7867
 Test site-White_9                   (0)| Epoch:43 | Test Acc: 0.8618
 Test site-Black_0                   (1)| Epoch:43 | Test Acc: 0.7021
 Test site-Black_1                   (1)| Epoch:43 | Test Acc: 0.7642
White: 0.8123, Black: 0.7332, 
Average Test Accuracy: 0.7727, domain std=0.0396, cluster std=0.0396, individual std=0.0523, 
Average Test Accuracy: 0.7727
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 45 ============
cnt=[11, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
min_w=0.00143, quan_i=0.38, quan_c=0.42
minimize weight of clients:[2, ]
 Site-White_0                  | Train Loss: 0.4174 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4518 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.3886 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4299 | Train Acc: 0.7558
 Site-White_4                  | Train Loss: 0.3690 | Train Acc: 0.8036
 Site-White_5                  | Train Loss: 0.3735 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.3882 | Train Acc: 0.7680
 Site-White_7                  | Train Loss: 0.3947 | Train Acc: 0.8047
 Site-White_8                  | Train Loss: 0.3319 | Train Acc: 0.8563
 Site-White_9                  | Train Loss: 0.3419 | Train Acc: 0.8405
 Site-Black_0                  | Train Loss: 0.5076 | Train Acc: 0.7432
 Site-Black_1                  | Train Loss: 0.5409 | Train Acc: 0.7194
 Site-White_0                   (0) | Val  Loss: 0.4763 | Val  Acc: 0.8000
 Site-White_1                   (0) | Val  Loss: 0.3724 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4601 | Val  Acc: 0.8235
 Site-White_3                   (0) | Val  Loss: 0.6056 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4214 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5763 | Val  Acc: 0.8158
 Site-White_6                   (0) | Val  Loss: 0.4021 | Val  Acc: 0.8980
 Site-White_7                   (0) | Val  Loss: 0.5247 | Val  Acc: 0.7188
 Site-White_8                   (0) | Val  Loss: 0.5111 | Val  Acc: 0.7024
 Site-White_9                   (0) | Val  Loss: 0.4419 | Val  Acc: 0.7545
 Site-Black_0                   (0) | Val  Loss: 0.6619 | Val  Acc: 0.6053
 Site-Black_1                   (0) | Val  Loss: 0.7012 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7678
 Test site-White_0                   (0)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (1)| Epoch:43 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:43 | Test Acc: 0.8364
 Test site-White_4                   (0)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (0)| Epoch:43 | Test Acc: 0.7312
 Test site-White_6                   (0)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:43 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:43 | Test Acc: 0.7773
 Test site-White_9                   (0)| Epoch:43 | Test Acc: 0.8618
 Test site-Black_0                   (0)| Epoch:43 | Test Acc: 0.6915
 Test site-Black_1                   (0)| Epoch:43 | Test Acc: 0.7561
White: 0.8180, Black: 0.7238, 
Average Test Accuracy: 0.7709, domain std=0.0471, cluster std=0.0039, individual std=0.0565, 
Average Test Accuracy: 0.7709
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 46 ============
cnt=[11, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
min_w=0.00314, quan_i=0.39, quan_c=0.40
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4605 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4291 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.6622 | Train Acc: 0.8154
 Site-White_3                  | Train Loss: 0.4649 | Train Acc: 0.8140
 Site-White_4                  | Train Loss: 0.3696 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3946 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.4220 | Train Acc: 0.7577
 Site-White_7                  | Train Loss: 0.4247 | Train Acc: 0.7891
 Site-White_8                  | Train Loss: 0.3505 | Train Acc: 0.8473
 Site-White_9                  | Train Loss: 0.3290 | Train Acc: 0.8497
 Site-Black_0                  | Train Loss: 0.4948 | Train Acc: 0.7297
 Site-Black_1                  | Train Loss: 0.4658 | Train Acc: 0.7398
 Site-White_0                   (1) | Val  Loss: 0.6109 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3001 | Val  Acc: 0.9231
 Site-White_2                   (0) | Val  Loss: 0.5535 | Val  Acc: 0.5882
 Site-White_3                   (0) | Val  Loss: 0.5451 | Val  Acc: 0.7273
 Site-White_4                   (0) | Val  Loss: 0.4011 | Val  Acc: 0.7931
 Site-White_5                   (0) | Val  Loss: 0.5199 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4402 | Val  Acc: 0.8367
 Site-White_7                   (0) | Val  Loss: 0.4892 | Val  Acc: 0.7812
 Site-White_8                   (0) | Val  Loss: 0.4495 | Val  Acc: 0.7738
 Site-White_9                   (0) | Val  Loss: 0.4093 | Val  Acc: 0.8273
 Site-Black_0                   (0) | Val  Loss: 0.7686 | Val  Acc: 0.5789
 Site-Black_1                   (0) | Val  Loss: 0.6083 | Val  Acc: 0.6531
Average Valid Accuracy: 0.7350
 Test site-White_0                   (1)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (0)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:43 | Test Acc: 0.7857
 Test site-White_3                   (0)| Epoch:43 | Test Acc: 0.8182
 Test site-White_4                   (0)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (0)| Epoch:43 | Test Acc: 0.7204
 Test site-White_6                   (0)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (0)| Epoch:43 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:43 | Test Acc: 0.7773
 Test site-White_9                   (0)| Epoch:43 | Test Acc: 0.8582
 Test site-Black_0                   (0)| Epoch:43 | Test Acc: 0.6915
 Test site-Black_1                   (0)| Epoch:43 | Test Acc: 0.7561
White: 0.8123, Black: 0.7238, 
Average Test Accuracy: 0.7681, domain std=0.0443, cluster std=0.0013, individual std=0.0567, 
Average Test Accuracy: 0.7681
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 47 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
min_w=0.00324, quan_i=0.42, quan_c=0.39
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.6212 | Train Acc: 0.8108
 Site-White_1                  | Train Loss: 0.4574 | Train Acc: 0.8367
 Site-White_2                  | Train Loss: 0.2004 | Train Acc: 0.8462
 Site-White_3                  | Train Loss: 0.4967 | Train Acc: 0.7326
 Site-White_4                  | Train Loss: 0.3785 | Train Acc: 0.8482
 Site-White_5                  | Train Loss: 0.3805 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4504 | Train Acc: 0.7784
 Site-White_7                  | Train Loss: 0.3859 | Train Acc: 0.8008
 Site-White_8                  | Train Loss: 0.3209 | Train Acc: 0.8653
 Site-White_9                  | Train Loss: 0.3278 | Train Acc: 0.8565
 Site-Black_0                  | Train Loss: 0.4668 | Train Acc: 0.7635
 Site-Black_1                  | Train Loss: 0.5949 | Train Acc: 0.7551
 Site-White_0                   (1) | Val  Loss: 0.4739 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3359 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.4562 | Val  Acc: 0.6471
 Site-White_3                   (1) | Val  Loss: 0.5142 | Val  Acc: 0.8182
 Site-White_4                   (1) | Val  Loss: 0.4031 | Val  Acc: 0.8621
 Site-White_5                   (1) | Val  Loss: 0.5865 | Val  Acc: 0.8158
 Site-White_6                   (1) | Val  Loss: 0.4399 | Val  Acc: 0.8367
 Site-White_7                   (1) | Val  Loss: 0.3840 | Val  Acc: 0.8281
 Site-White_8                   (1) | Val  Loss: 0.4943 | Val  Acc: 0.7619
 Site-White_9                   (1) | Val  Loss: 0.4165 | Val  Acc: 0.7818
 Site-Black_0                   (0) | Val  Loss: 0.6127 | Val  Acc: 0.6842
 Site-Black_1                   (0) | Val  Loss: 0.7059 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7730
 Test site-White_0                   (1)| Epoch:43 | Test Acc: 0.8000
 Test site-White_1                   (1)| Epoch:43 | Test Acc: 0.8788
 Test site-White_2                   (1)| Epoch:43 | Test Acc: 0.8095
 Test site-White_3                   (1)| Epoch:43 | Test Acc: 0.8182
 Test site-White_4                   (1)| Epoch:43 | Test Acc: 0.7778
 Test site-White_5                   (1)| Epoch:43 | Test Acc: 0.7312
 Test site-White_6                   (1)| Epoch:43 | Test Acc: 0.8374
 Test site-White_7                   (1)| Epoch:43 | Test Acc: 0.9125
 Test site-White_8                   (1)| Epoch:43 | Test Acc: 0.7867
 Test site-White_9                   (1)| Epoch:43 | Test Acc: 0.8655
 Test site-Black_0                   (0)| Epoch:43 | Test Acc: 0.6915
 Test site-Black_1                   (0)| Epoch:43 | Test Acc: 0.7561
White: 0.8218, Black: 0.7238, 
Average Test Accuracy: 0.7728, domain std=0.0490, cluster std=0.0490, individual std=0.0604, 
Average Test Accuracy: 0.7728
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
============ Train epoch 48 ============
cnt=[10, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
min_w=0.00234, quan_i=0.38, quan_c=0.37
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.3063 | Train Acc: 0.7838
 Site-White_1                  | Train Loss: 0.4154 | Train Acc: 0.8980
 Site-White_2                  | Train Loss: 0.2522 | Train Acc: 0.8615
 Site-White_3                  | Train Loss: 0.4508 | Train Acc: 0.7674
 Site-White_4                  | Train Loss: 0.3777 | Train Acc: 0.8214
 Site-White_5                  | Train Loss: 0.3531 | Train Acc: 0.8581
 Site-White_6                  | Train Loss: 0.4669 | Train Acc: 0.7732
 Site-White_7                  | Train Loss: 0.3968 | Train Acc: 0.8125
 Site-White_8                  | Train Loss: 0.3302 | Train Acc: 0.8533
 Site-White_9                  | Train Loss: 0.3429 | Train Acc: 0.8497
 Site-Black_0                  | Train Loss: 0.5222 | Train Acc: 0.7635
 Site-Black_1                  | Train Loss: 0.5330 | Train Acc: 0.7653
 Site-White_0                   (0) | Val  Loss: 0.4666 | Val  Acc: 0.6000
 Site-White_1                   (0) | Val  Loss: 0.3538 | Val  Acc: 0.8462
 Site-White_2                   (0) | Val  Loss: 0.4883 | Val  Acc: 0.7647
 Site-White_3                   (0) | Val  Loss: 0.6099 | Val  Acc: 0.7727
 Site-White_4                   (0) | Val  Loss: 0.3474 | Val  Acc: 0.8276
 Site-White_5                   (0) | Val  Loss: 0.5548 | Val  Acc: 0.7368
 Site-White_6                   (0) | Val  Loss: 0.4130 | Val  Acc: 0.8163
 Site-White_7                   (0) | Val  Loss: 0.4574 | Val  Acc: 0.7969
 Site-White_8                   (0) | Val  Loss: 0.5583 | Val  Acc: 0.6667
 Site-White_9                   (0) | Val  Loss: 0.4799 | Val  Acc: 0.7727
 Site-Black_0                   (1) | Val  Loss: 0.6839 | Val  Acc: 0.6579
 Site-Black_1                   (1) | Val  Loss: 0.6973 | Val  Acc: 0.6122
Average Valid Accuracy: 0.7392
 Test site-White_0                   (0)| Epoch:43 | Test Acc: 0.8400
 Test site-White_1                   (0)| Epoch:43 | Test Acc: 0.8485
 Test site-White_2                   (0)| Epoch:43 | Test Acc: 0.8095
 Test site-White_3                   (0)| Epoch:43 | Test Acc: 0.7636
 Test site-White_4                   (0)| Epoch:43 | Test Acc: 0.7639
 Test site-White_5                   (0)| Epoch:43 | Test Acc: 0.7204
 Test site-White_6                   (0)| Epoch:43 | Test Acc: 0.8455
 Test site-White_7                   (0)| Epoch:43 | Test Acc: 0.9000
 Test site-White_8                   (0)| Epoch:43 | Test Acc: 0.7915
 Test site-White_9                   (0)| Epoch:43 | Test Acc: 0.8618
 Test site-Black_0                   (1)| Epoch:43 | Test Acc: 0.7128
 Test site-Black_1                   (1)| Epoch:43 | Test Acc: 0.7805
White: 0.8145, Black: 0.7466, 
Average Test Accuracy: 0.7806, domain std=0.0339, cluster std=0.0339, individual std=0.0554, 
Average Test Accuracy: 0.7806
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 10, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
min_w=0.00203, quan_i=0.36, quan_c=0.37
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 0.4111 | Train Acc: 0.8378
 Site-White_1                  | Train Loss: 0.3423 | Train Acc: 0.8776
 Site-White_2                  | Train Loss: 0.5699 | Train Acc: 0.8769
 Site-White_3                  | Train Loss: 0.4153 | Train Acc: 0.8023
 Site-White_4                  | Train Loss: 0.4169 | Train Acc: 0.8393
 Site-White_5                  | Train Loss: 0.3708 | Train Acc: 0.8378
 Site-White_6                  | Train Loss: 0.4278 | Train Acc: 0.7423
 Site-White_7                  | Train Loss: 0.3980 | Train Acc: 0.7969
 Site-White_8                  | Train Loss: 0.3325 | Train Acc: 0.8683
 Site-White_9                  | Train Loss: 0.3427 | Train Acc: 0.8519
 Site-Black_0                  | Train Loss: 0.5115 | Train Acc: 0.7500
 Site-Black_1                  | Train Loss: 0.5252 | Train Acc: 0.7500
 Site-White_0                   (1) | Val  Loss: 0.4542 | Val  Acc: 0.7000
 Site-White_1                   (1) | Val  Loss: 0.3511 | Val  Acc: 0.8462
 Site-White_2                   (1) | Val  Loss: 0.5140 | Val  Acc: 0.7059
 Site-White_3                   (1) | Val  Loss: 0.5106 | Val  Acc: 0.7727
 Site-White_4                   (1) | Val  Loss: 0.5250 | Val  Acc: 0.7931
 Site-White_5                   (1) | Val  Loss: 0.5789 | Val  Acc: 0.7632
 Site-White_6                   (1) | Val  Loss: 0.4044 | Val  Acc: 0.8367
 Site-White_7                   (1) | Val  Loss: 0.4829 | Val  Acc: 0.8125
 Site-White_8                   (1) | Val  Loss: 0.4431 | Val  Acc: 0.7500
 Site-White_9                   (1) | Val  Loss: 0.4614 | Val  Acc: 0.7727
 Site-Black_0                   (0) | Val  Loss: 0.7038 | Val  Acc: 0.6579
 Site-Black_1                   (0) | Val  Loss: 0.6378 | Val  Acc: 0.6939
Average Valid Accuracy: 0.7587
 Test site-White_0                   (1)| Epoch:48 | Test Acc: 0.8000
 Test site-White_1                   (1)| Epoch:48 | Test Acc: 0.8485
 Test site-White_2                   (1)| Epoch:48 | Test Acc: 0.8095
 Test site-White_3                   (1)| Epoch:48 | Test Acc: 0.8182
 Test site-White_4                   (1)| Epoch:48 | Test Acc: 0.7778
 Test site-White_5                   (1)| Epoch:48 | Test Acc: 0.7204
 Test site-White_6                   (1)| Epoch:48 | Test Acc: 0.8293
 Test site-White_7                   (1)| Epoch:48 | Test Acc: 0.9000
 Test site-White_8                   (1)| Epoch:48 | Test Acc: 0.7867
 Test site-White_9                   (1)| Epoch:48 | Test Acc: 0.8691
 Test site-Black_0                   (0)| Epoch:48 | Test Acc: 0.6915
 Test site-Black_1                   (0)| Epoch:48 | Test Acc: 0.7480
White: 0.8159, Black: 0.7197, 
Average Test Accuracy: 0.7678, domain std=0.0481, cluster std=0.0481, individual std=0.0577, 
Average Test Accuracy: 0.7678
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_2_gender_label_binary_race/ccop_q=1_gmap...
===2023-06-07 16:54:53===
===2023-06-07 16:54:55===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0.4
    std_rw: False
    gender_label: True
    binary_race: True
    save_iter: -1
data_number=[37,49,65,86,112,148,194,256,334,439,148,196,]
client_nums=[10,2,]
domain number = 2
Loading snapshots...
 Test site-White-0                   (1)| Epoch:48 | Test Acc: 0.8400
 Test site-White-1                   (1)| Epoch:48 | Test Acc: 0.8485
 Test site-White-2                   (1)| Epoch:48 | Test Acc: 0.8095
 Test site-White-3                   (1)| Epoch:48 | Test Acc: 0.7636
 Test site-White-4                   (1)| Epoch:48 | Test Acc: 0.7639
 Test site-White-5                   (1)| Epoch:48 | Test Acc: 0.7204
 Test site-White-6                   (1)| Epoch:48 | Test Acc: 0.8455
 Test site-White-7                   (1)| Epoch:48 | Test Acc: 0.9000
 Test site-White-8                   (1)| Epoch:48 | Test Acc: 0.7915
 Test site-White-9                   (1)| Epoch:48 | Test Acc: 0.8618
 Test site-Black-0                   (0)| Epoch:48 | Test Acc: 0.7128
 Test site-Black-1                   (0)| Epoch:48 | Test Acc: 0.7805
White: 0.8145, Black: 0.7466, 
Average Test Accuracy: 0.7806, domain std=0.0339, cluster std=0.0339, individual std=0.0554, 
