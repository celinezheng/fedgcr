===2023-06-16 04:06:28===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = 4
===2023-06-16 06:07:28===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 2, 6, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White-0                   (3) | Train Loss: 1.6631 | Train Acc: 0.3944
 Site-White-1                   (3) | Train Loss: 1.8383 | Train Acc: 0.3636
 Site-White-2                   (3) | Train Loss: 1.8633 | Train Acc: 0.3220
 Site-White-3                   (3) | Train Loss: 1.7865 | Train Acc: 0.3604
 Site-White-4                   (3) | Train Loss: 1.7342 | Train Acc: 0.3573
 Site-Middle_Eastern-0          (0) | Train Loss: 2.3338 | Train Acc: 0.2901
 Site-Middle_Eastern-1          (0) | Train Loss: 2.0507 | Train Acc: 0.2500
 Site-Middle_Eastern-2          (3) | Train Loss: 1.9946 | Train Acc: 0.2651
 Site-Black-0                   (2) | Train Loss: 2.0441 | Train Acc: 0.2435
 Site-Black-1                   (2) | Train Loss: 2.0850 | Train Acc: 0.2112
 Site-White_ffhq-0              (1) | Train Loss: 1.1960 | Train Acc: 0.5420
Average Train Accuracy: 0.3272
 Site-White-0                   (3) | Val  Loss: 1.9823 | Val  Acc: 0.2500
 Site-White-1                   (3) | Val  Loss: 1.9170 | Val  Acc: 0.2059
 Site-White-2                   (3) | Val  Loss: 1.8822 | Val  Acc: 0.3390
 Site-White-3                   (3) | Val  Loss: 1.7967 | Val  Acc: 0.3000
 Site-White-4                   (3) | Val  Loss: 1.8630 | Val  Acc: 0.3000
 Site-Middle_Eastern-0          (0) | Val  Loss: 2.2136 | Val  Acc: 0.2222
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.7635 | Val  Acc: 0.2812
 Site-Middle_Eastern-2          (3) | Val  Loss: 2.0206 | Val  Acc: 0.2037
 Site-Black-0                   (2) | Val  Loss: 2.0792 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.9099 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1460 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2920
 Best site-White-0                  (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-White-1                  (3)  | Epoch:0 | Val Acc: 0.2059
 Best site-White-2                  (3)  | Epoch:0 | Val Acc: 0.3390
 Best site-White-3                  (3)  | Epoch:0 | Val Acc: 0.3000
 Best site-White-4                  (3)  | Epoch:0 | Val Acc: 0.3000
 Best site-Middle_Eastern-0         (0)  | Epoch:0 | Val Acc: 0.2222
 Best site-Middle_Eastern-1         (0)  | Epoch:0 | Val Acc: 0.2812
 Best site-Middle_Eastern-2         (3)  | Epoch:0 | Val Acc: 0.2037
 Best site-Black-0                  (2)  | Epoch:0 | Val Acc: 0.2449
 Best site-Black-1                  (2)  | Epoch:0 | Val Acc: 0.3133
 Best site-White_ffhq-0             (1)  | Epoch:0 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 2, 7, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White-0                   (3) | Train Loss: 1.7832 | Train Acc: 0.3873
 Site-White-1                   (3) | Train Loss: 1.7949 | Train Acc: 0.3430
 Site-White-2                   (3) | Train Loss: 1.7907 | Train Acc: 0.3366
 Site-White-3                   (3) | Train Loss: 1.7529 | Train Acc: 0.3504
 Site-White-4                   (0) | Train Loss: 1.6979 | Train Acc: 0.3640
 Site-Middle_Eastern-0          (3) | Train Loss: 2.0946 | Train Acc: 0.2672
 Site-Middle_Eastern-1          (3) | Train Loss: 1.9479 | Train Acc: 0.2634
 Site-Middle_Eastern-2          (3) | Train Loss: 1.9142 | Train Acc: 0.2730
 Site-Black-0                   (2) | Train Loss: 1.9079 | Train Acc: 0.2406
 Site-Black-1                   (2) | Train Loss: 1.9732 | Train Acc: 0.1959
 Site-White_ffhq-0              (1) | Train Loss: 1.3184 | Train Acc: 0.4818
Average Train Accuracy: 0.3185
 Site-White-0                   (3) | Val  Loss: 1.9230 | Val  Acc: 0.2000
 Site-White-1                   (3) | Val  Loss: 1.8483 | Val  Acc: 0.2059
 Site-White-2                   (3) | Val  Loss: 1.8372 | Val  Acc: 0.3898
 Site-White-3                   (3) | Val  Loss: 1.8041 | Val  Acc: 0.3100
 Site-White-4                   (0) | Val  Loss: 1.7984 | Val  Acc: 0.3176
 Site-Middle_Eastern-0          (3) | Val  Loss: 2.0775 | Val  Acc: 0.1667
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.6905 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.9110 | Val  Acc: 0.2222
 Site-Black-0                   (2) | Val  Loss: 1.9667 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.9112 | Val  Acc: 0.2410
 Site-White_ffhq-0              (1) | Val  Loss: 1.3117 | Val  Acc: 0.4615
Average Valid Accuracy: 0.2830
============ Train epoch 2 ============
cnt=[4, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White-0                   (0) | Train Loss: 1.7192 | Train Acc: 0.4014
 Site-White-1                   (0) | Train Loss: 1.7613 | Train Acc: 0.3512
 Site-White-2                   (0) | Train Loss: 1.7472 | Train Acc: 0.3874
 Site-White-3                   (0) | Train Loss: 1.7200 | Train Acc: 0.3547
 Site-White-4                   (3) | Train Loss: 1.6672 | Train Acc: 0.3623
 Site-Middle_Eastern-0          (3) | Train Loss: 1.9793 | Train Acc: 0.2901
 Site-Middle_Eastern-1          (3) | Train Loss: 1.8949 | Train Acc: 0.3080
 Site-Middle_Eastern-2          (3) | Train Loss: 1.8471 | Train Acc: 0.3150
 Site-Black-0                   (2) | Train Loss: 1.8642 | Train Acc: 0.2551
 Site-Black-1                   (2) | Train Loss: 1.9253 | Train Acc: 0.2317
 Site-White_ffhq-0              (1) | Train Loss: 1.3607 | Train Acc: 0.4836
Average Train Accuracy: 0.3400
 Site-White-0                   (0) | Val  Loss: 1.8616 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.7957 | Val  Acc: 0.2353
 Site-White-2                   (0) | Val  Loss: 1.8064 | Val  Acc: 0.3390
 Site-White-3                   (0) | Val  Loss: 1.7412 | Val  Acc: 0.3700
 Site-White-4                   (3) | Val  Loss: 1.7877 | Val  Acc: 0.3471
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.9849 | Val  Acc: 0.2778
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.6237 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.8343 | Val  Acc: 0.2593
 Site-Black-0                   (2) | Val  Loss: 1.9596 | Val  Acc: 0.2041
 Site-Black-1                   (2) | Val  Loss: 1.8641 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.3321 | Val  Acc: 0.4744
Average Valid Accuracy: 0.3133
 Best site-White-0                  (0)  | Epoch:2 | Val Acc: 0.3500
 Best site-White-1                  (0)  | Epoch:2 | Val Acc: 0.2353
 Best site-White-2                  (0)  | Epoch:2 | Val Acc: 0.3390
 Best site-White-3                  (0)  | Epoch:2 | Val Acc: 0.3700
 Best site-White-4                  (3)  | Epoch:2 | Val Acc: 0.3471
 Best site-Middle_Eastern-0         (3)  | Epoch:2 | Val Acc: 0.2778
 Best site-Middle_Eastern-1         (3)  | Epoch:2 | Val Acc: 0.3125
 Best site-Middle_Eastern-2         (3)  | Epoch:2 | Val Acc: 0.2593
 Best site-Black-0                  (2)  | Epoch:2 | Val Acc: 0.2041
 Best site-Black-1                  (2)  | Epoch:2 | Val Acc: 0.2771
 Best site-White_ffhq-0             (1)  | Epoch:2 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White-0                   (1) | Train Loss: 1.6758 | Train Acc: 0.4225
 Site-White-1                   (1) | Train Loss: 1.7053 | Train Acc: 0.3719
 Site-White-2                   (1) | Train Loss: 1.6831 | Train Acc: 0.3898
 Site-White-3                   (1) | Train Loss: 1.6562 | Train Acc: 0.3960
 Site-White-4                   (1) | Train Loss: 1.6357 | Train Acc: 0.3732
 Site-Middle_Eastern-0          (3) | Train Loss: 1.7633 | Train Acc: 0.3130
 Site-Middle_Eastern-1          (3) | Train Loss: 1.8204 | Train Acc: 0.3036
 Site-Middle_Eastern-2          (3) | Train Loss: 1.8025 | Train Acc: 0.3255
 Site-Black-0                   (2) | Train Loss: 1.8270 | Train Acc: 0.2986
 Site-Black-1                   (2) | Train Loss: 1.8707 | Train Acc: 0.2402
 Site-White_ffhq-0              (0) | Train Loss: 1.3241 | Train Acc: 0.4891
Average Train Accuracy: 0.3567
 Site-White-0                   (1) | Val  Loss: 1.8568 | Val  Acc: 0.3000
 Site-White-1                   (1) | Val  Loss: 1.7205 | Val  Acc: 0.2647
 Site-White-2                   (1) | Val  Loss: 1.8070 | Val  Acc: 0.3220
 Site-White-3                   (1) | Val  Loss: 1.7076 | Val  Acc: 0.3100
 Site-White-4                   (1) | Val  Loss: 1.7281 | Val  Acc: 0.3706
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.8749 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.5870 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.7913 | Val  Acc: 0.2778
 Site-Black-0                   (2) | Val  Loss: 1.8897 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.8405 | Val  Acc: 0.2410
 Site-White_ffhq-0              (0) | Val  Loss: 1.3136 | Val  Acc: 0.4872
Average Valid Accuracy: 0.3228
 Best site-White-0                  (1)  | Epoch:3 | Val Acc: 0.3000
 Best site-White-1                  (1)  | Epoch:3 | Val Acc: 0.2647
 Best site-White-2                  (1)  | Epoch:3 | Val Acc: 0.3220
 Best site-White-3                  (1)  | Epoch:3 | Val Acc: 0.3100
 Best site-White-4                  (1)  | Epoch:3 | Val Acc: 0.3706
 Best site-Middle_Eastern-0         (3)  | Epoch:3 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (3)  | Epoch:3 | Val Acc: 0.3438
 Best site-Middle_Eastern-2         (3)  | Epoch:3 | Val Acc: 0.2778
 Best site-Black-0                  (2)  | Epoch:3 | Val Acc: 0.2449
 Best site-Black-1                  (2)  | Epoch:3 | Val Acc: 0.2410
 Best site-White_ffhq-0             (0)  | Epoch:3 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 4 ============
cnt=[8, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White-0                   (0) | Train Loss: 1.5913 | Train Acc: 0.4366
 Site-White-1                   (0) | Train Loss: 1.6166 | Train Acc: 0.4339
 Site-White-2                   (0) | Train Loss: 1.6259 | Train Acc: 0.3995
 Site-White-3                   (0) | Train Loss: 1.5853 | Train Acc: 0.3860
 Site-White-4                   (0) | Train Loss: 1.5555 | Train Acc: 0.3975
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5765 | Train Acc: 0.3740
 Site-Middle_Eastern-1          (0) | Train Loss: 1.7143 | Train Acc: 0.3795
 Site-Middle_Eastern-2          (0) | Train Loss: 1.6686 | Train Acc: 0.3622
 Site-Black-0                   (3) | Train Loss: 1.7789 | Train Acc: 0.2783
 Site-Black-1                   (2) | Train Loss: 1.7590 | Train Acc: 0.2777
 Site-White_ffhq-0              (1) | Train Loss: 1.5096 | Train Acc: 0.4142
Average Train Accuracy: 0.3763
 Site-White-0                   (0) | Val  Loss: 1.8144 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.6609 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.7420 | Val  Acc: 0.3559
 Site-White-3                   (0) | Val  Loss: 1.6533 | Val  Acc: 0.3600
 Site-White-4                   (0) | Val  Loss: 1.6611 | Val  Acc: 0.4000
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.7738 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4967 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.6728 | Val  Acc: 0.3148
 Site-Black-0                   (3) | Val  Loss: 1.8403 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.7908 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.4318 | Val  Acc: 0.3590
Average Valid Accuracy: 0.3410
 Best site-White-0                  (0)  | Epoch:4 | Val Acc: 0.3000
 Best site-White-1                  (0)  | Epoch:4 | Val Acc: 0.3235
 Best site-White-2                  (0)  | Epoch:4 | Val Acc: 0.3559
 Best site-White-3                  (0)  | Epoch:4 | Val Acc: 0.3600
 Best site-White-4                  (0)  | Epoch:4 | Val Acc: 0.4000
 Best site-Middle_Eastern-0         (0)  | Epoch:4 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (0)  | Epoch:4 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (0)  | Epoch:4 | Val Acc: 0.3148
 Best site-Black-0                  (3)  | Epoch:4 | Val Acc: 0.2653
 Best site-Black-1                  (2)  | Epoch:4 | Val Acc: 0.2771
 Best site-White_ffhq-0             (1)  | Epoch:4 | Val Acc: 0.3590
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White-0                   (3) | Train Loss: 1.5287 | Train Acc: 0.4859
 Site-White-1                   (3) | Train Loss: 1.6007 | Train Acc: 0.4504
 Site-White-2                   (3) | Train Loss: 1.5518 | Train Acc: 0.4334
 Site-White-3                   (3) | Train Loss: 1.5199 | Train Acc: 0.4245
 Site-White-4                   (3) | Train Loss: 1.5150 | Train Acc: 0.4109
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5484 | Train Acc: 0.4046
 Site-Middle_Eastern-1          (0) | Train Loss: 1.5592 | Train Acc: 0.4375
 Site-Middle_Eastern-2          (0) | Train Loss: 1.6033 | Train Acc: 0.3806
 Site-Black-0                   (2) | Train Loss: 1.7368 | Train Acc: 0.2986
 Site-Black-1                   (2) | Train Loss: 1.7251 | Train Acc: 0.3169
 Site-White_ffhq-0              (1) | Train Loss: 1.5874 | Train Acc: 0.3887
Average Train Accuracy: 0.4029
 Site-White-0                   (3) | Val  Loss: 1.8197 | Val  Acc: 0.2500
 Site-White-1                   (3) | Val  Loss: 1.5889 | Val  Acc: 0.3529
 Site-White-2                   (3) | Val  Loss: 1.7121 | Val  Acc: 0.3559
 Site-White-3                   (3) | Val  Loss: 1.6331 | Val  Acc: 0.4100
 Site-White-4                   (3) | Val  Loss: 1.6639 | Val  Acc: 0.3529
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.7783 | Val  Acc: 0.3333
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.5259 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.6027 | Val  Acc: 0.3333
 Site-Black-0                   (2) | Val  Loss: 1.7681 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.8437 | Val  Acc: 0.2651
 Site-White_ffhq-0              (1) | Val  Loss: 1.4749 | Val  Acc: 0.4231
Average Valid Accuracy: 0.3332
============ Train epoch 6 ============
cnt=[1, 3, 2, 5, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White-0                   (3) | Train Loss: 1.5177 | Train Acc: 0.4507
 Site-White-1                   (3) | Train Loss: 1.5570 | Train Acc: 0.4256
 Site-White-2                   (3) | Train Loss: 1.5595 | Train Acc: 0.4286
 Site-White-3                   (3) | Train Loss: 1.5118 | Train Acc: 0.4245
 Site-White-4                   (3) | Train Loss: 1.4877 | Train Acc: 0.4033
 Site-Middle_Eastern-0          (1) | Train Loss: 1.7550 | Train Acc: 0.3969
 Site-Middle_Eastern-1          (1) | Train Loss: 1.6084 | Train Acc: 0.4107
 Site-Middle_Eastern-2          (1) | Train Loss: 1.6019 | Train Acc: 0.3806
 Site-Black-0                   (2) | Train Loss: 1.7258 | Train Acc: 0.3072
 Site-Black-1                   (2) | Train Loss: 1.6871 | Train Acc: 0.3118
 Site-White_ffhq-0              (0) | Train Loss: 1.2941 | Train Acc: 0.4964
Average Train Accuracy: 0.4033
 Site-White-0                   (3) | Val  Loss: 1.8294 | Val  Acc: 0.3000
 Site-White-1                   (3) | Val  Loss: 1.5832 | Val  Acc: 0.2941
 Site-White-2                   (3) | Val  Loss: 1.7211 | Val  Acc: 0.4068
 Site-White-3                   (3) | Val  Loss: 1.5888 | Val  Acc: 0.3600
 Site-White-4                   (3) | Val  Loss: 1.6014 | Val  Acc: 0.4294
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.6875 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3963 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.6705 | Val  Acc: 0.3333
 Site-Black-0                   (2) | Val  Loss: 1.7940 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.8032 | Val  Acc: 0.2530
 Site-White_ffhq-0              (0) | Val  Loss: 1.1853 | Val  Acc: 0.4615
Average Valid Accuracy: 0.3652
 Best site-White-0                  (3)  | Epoch:6 | Val Acc: 0.3000
 Best site-White-1                  (3)  | Epoch:6 | Val Acc: 0.2941
 Best site-White-2                  (3)  | Epoch:6 | Val Acc: 0.4068
 Best site-White-3                  (3)  | Epoch:6 | Val Acc: 0.3600
 Best site-White-4                  (3)  | Epoch:6 | Val Acc: 0.4294
 Best site-Middle_Eastern-0         (1)  | Epoch:6 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (1)  | Epoch:6 | Val Acc: 0.4688
 Best site-Middle_Eastern-2         (1)  | Epoch:6 | Val Acc: 0.3333
 Best site-Black-0                  (2)  | Epoch:6 | Val Acc: 0.2653
 Best site-Black-1                  (2)  | Epoch:6 | Val Acc: 0.2530
 Best site-White_ffhq-0             (0)  | Epoch:6 | Val Acc: 0.4615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White-0                   (0) | Train Loss: 1.4567 | Train Acc: 0.4437
 Site-White-1                   (0) | Train Loss: 1.5294 | Train Acc: 0.4463
 Site-White-2                   (0) | Train Loss: 1.4982 | Train Acc: 0.4383
 Site-White-3                   (0) | Train Loss: 1.4758 | Train Acc: 0.4288
 Site-White-4                   (0) | Train Loss: 1.4539 | Train Acc: 0.4310
 Site-Middle_Eastern-0          (3) | Train Loss: 1.5253 | Train Acc: 0.4351
 Site-Middle_Eastern-1          (3) | Train Loss: 1.5703 | Train Acc: 0.4107
 Site-Middle_Eastern-2          (3) | Train Loss: 1.5182 | Train Acc: 0.4068
 Site-Black-0                   (2) | Train Loss: 1.6854 | Train Acc: 0.3507
 Site-Black-1                   (2) | Train Loss: 1.6431 | Train Acc: 0.3509
 Site-White_ffhq-0              (1) | Train Loss: 1.4493 | Train Acc: 0.4361
Average Train Accuracy: 0.4162
 Site-White-0                   (0) | Val  Loss: 1.7601 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.5406 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.7009 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.5768 | Val  Acc: 0.3900
 Site-White-4                   (0) | Val  Loss: 1.6001 | Val  Acc: 0.4118
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.6498 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.4462 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.5424 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.7275 | Val  Acc: 0.3673
 Site-Black-1                   (2) | Val  Loss: 1.6679 | Val  Acc: 0.2651
 Site-White_ffhq-0              (1) | Val  Loss: 1.2992 | Val  Acc: 0.4359
Average Valid Accuracy: 0.3742
 Best site-White-0                  (0)  | Epoch:7 | Val Acc: 0.3000
 Best site-White-1                  (0)  | Epoch:7 | Val Acc: 0.3235
 Best site-White-2                  (0)  | Epoch:7 | Val Acc: 0.3898
 Best site-White-3                  (0)  | Epoch:7 | Val Acc: 0.3900
 Best site-White-4                  (0)  | Epoch:7 | Val Acc: 0.4118
 Best site-Middle_Eastern-0         (3)  | Epoch:7 | Val Acc: 0.5000
 Best site-Middle_Eastern-1         (3)  | Epoch:7 | Val Acc: 0.3438
 Best site-Middle_Eastern-2         (3)  | Epoch:7 | Val Acc: 0.3889
 Best site-Black-0                  (2)  | Epoch:7 | Val Acc: 0.3673
 Best site-Black-1                  (2)  | Epoch:7 | Val Acc: 0.2651
 Best site-White_ffhq-0             (1)  | Epoch:7 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White-0                   (0) | Train Loss: 1.4137 | Train Acc: 0.5070
 Site-White-1                   (0) | Train Loss: 1.5216 | Train Acc: 0.4215
 Site-White-2                   (0) | Train Loss: 1.4730 | Train Acc: 0.4431
 Site-White-3                   (0) | Train Loss: 1.4486 | Train Acc: 0.4330
 Site-White-4                   (3) | Train Loss: 1.4204 | Train Acc: 0.4452
 Site-Middle_Eastern-0          (3) | Train Loss: 1.4488 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (3) | Train Loss: 1.5165 | Train Acc: 0.4509
 Site-Middle_Eastern-2          (3) | Train Loss: 1.4988 | Train Acc: 0.4199
 Site-Black-0                   (2) | Train Loss: 1.6347 | Train Acc: 0.3652
 Site-Black-1                   (2) | Train Loss: 1.6230 | Train Acc: 0.3492
 Site-White_ffhq-0              (1) | Train Loss: 1.4212 | Train Acc: 0.4343
Average Train Accuracy: 0.4263
 Site-White-0                   (0) | Val  Loss: 1.7530 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.5506 | Val  Acc: 0.2353
 Site-White-2                   (0) | Val  Loss: 1.6964 | Val  Acc: 0.3729
 Site-White-3                   (0) | Val  Loss: 1.5239 | Val  Acc: 0.3600
 Site-White-4                   (3) | Val  Loss: 1.5931 | Val  Acc: 0.4353
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5873 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.4089 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.5362 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.7236 | Val  Acc: 0.3673
 Site-Black-1                   (2) | Val  Loss: 1.7482 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.3230 | Val  Acc: 0.4615
Average Valid Accuracy: 0.3755
 Best site-White-0                  (0)  | Epoch:8 | Val Acc: 0.3500
 Best site-White-1                  (0)  | Epoch:8 | Val Acc: 0.2353
 Best site-White-2                  (0)  | Epoch:8 | Val Acc: 0.3729
 Best site-White-3                  (0)  | Epoch:8 | Val Acc: 0.3600
 Best site-White-4                  (3)  | Epoch:8 | Val Acc: 0.4353
 Best site-Middle_Eastern-0         (3)  | Epoch:8 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (3)  | Epoch:8 | Val Acc: 0.4375
 Best site-Middle_Eastern-2         (3)  | Epoch:8 | Val Acc: 0.3889
 Best site-Black-0                  (2)  | Epoch:8 | Val Acc: 0.3673
 Best site-Black-1                  (2)  | Epoch:8 | Val Acc: 0.2771
 Best site-White_ffhq-0             (1)  | Epoch:8 | Val Acc: 0.4615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 4, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White-0                   (1) | Train Loss: 1.4314 | Train Acc: 0.4718
 Site-White-1                   (1) | Train Loss: 1.5140 | Train Acc: 0.4298
 Site-White-2                   (1) | Train Loss: 1.4698 | Train Acc: 0.4334
 Site-White-3                   (1) | Train Loss: 1.4251 | Train Acc: 0.4544
 Site-White-4                   (3) | Train Loss: 1.4126 | Train Acc: 0.4360
 Site-Middle_Eastern-0          (3) | Train Loss: 1.5657 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (3) | Train Loss: 1.5123 | Train Acc: 0.4554
 Site-Middle_Eastern-2          (3) | Train Loss: 1.4715 | Train Acc: 0.4304
 Site-Black-0                   (0) | Train Loss: 1.6560 | Train Acc: 0.3594
 Site-Black-1                   (0) | Train Loss: 1.5772 | Train Acc: 0.3390
 Site-White_ffhq-0              (2) | Train Loss: 1.4070 | Train Acc: 0.4617
Average Train Accuracy: 0.4258
 Site-White-0                   (1) | Val  Loss: 1.6955 | Val  Acc: 0.4000
 Site-White-1                   (1) | Val  Loss: 1.4965 | Val  Acc: 0.3235
 Site-White-2                   (1) | Val  Loss: 1.6820 | Val  Acc: 0.3898
 Site-White-3                   (1) | Val  Loss: 1.5116 | Val  Acc: 0.3800
 Site-White-4                   (3) | Val  Loss: 1.5464 | Val  Acc: 0.4353
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.6932 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3683 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.5425 | Val  Acc: 0.3519
 Site-Black-0                   (0) | Val  Loss: 1.7815 | Val  Acc: 0.2857
 Site-Black-1                   (0) | Val  Loss: 1.7353 | Val  Acc: 0.2651
 Site-White_ffhq-0              (2) | Val  Loss: 1.2714 | Val  Acc: 0.4103
Average Valid Accuracy: 0.3698
 Test site-White-0                   (1)| Epoch:8 | Test Acc: 0.2857
 Test site-White-1                   (1)| Epoch:8 | Test Acc: 0.4648
 Test site-White-2                   (1)| Epoch:8 | Test Acc: 0.4454
 Test site-White-3                   (1)| Epoch:8 | Test Acc: 0.4158
 Test site-White-4                   (3)| Epoch:8 | Test Acc: 0.4315
 Test site-Middle_Eastern-0          (3)| Epoch:8 | Test Acc: 0.3590
 Test site-Middle_Eastern-1          (3)| Epoch:8 | Test Acc: 0.3077
 Test site-Middle_Eastern-2          (3)| Epoch:8 | Test Acc: 0.4000
 Test site-Black-0                   (0)| Epoch:8 | Test Acc: 0.4200
 Test site-Black-1                   (0)| Epoch:8 | Test Acc: 0.3728
 Test site-White_ffhq-0              (2)| Epoch:8 | Test Acc: 0.4177
White: 0.4086, Middle_Eastern: 0.3556, Black: 0.3964, White_ffhq: 0.4177, 
Average Test Accuracy(group): 0.3946, Average Test Accuracy(individual): 0.3928,
domain std=0.0238, cluster std=0.0155, individual std=0.0536, 
============ Train epoch 10 ============
cnt=[3, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-White-0                   (3) | Train Loss: 1.3792 | Train Acc: 0.5070
 Site-White-1                   (3) | Train Loss: 1.4877 | Train Acc: 0.4504
 Site-White-2                   (3) | Train Loss: 1.4549 | Train Acc: 0.4431
 Site-White-3                   (3) | Train Loss: 1.4149 | Train Acc: 0.4459
 Site-White-4                   (3) | Train Loss: 1.3877 | Train Acc: 0.4385
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3636 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4704 | Train Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Train Loss: 1.4596 | Train Acc: 0.4199
 Site-Black-0                   (2) | Train Loss: 1.5723 | Train Acc: 0.4116
 Site-Black-1                   (2) | Train Loss: 1.5763 | Train Acc: 0.3629
 Site-White_ffhq-0              (1) | Train Loss: 1.4064 | Train Acc: 0.4799
Average Train Accuracy: 0.4407
 Site-White-0                   (3) | Val  Loss: 1.7959 | Val  Acc: 0.3500
 Site-White-1                   (3) | Val  Loss: 1.4463 | Val  Acc: 0.3235
 Site-White-2                   (3) | Val  Loss: 1.6766 | Val  Acc: 0.3729
 Site-White-3                   (3) | Val  Loss: 1.5128 | Val  Acc: 0.4000
 Site-White-4                   (3) | Val  Loss: 1.5217 | Val  Acc: 0.4353
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6389 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4143 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4558 | Val  Acc: 0.4259
 Site-Black-0                   (2) | Val  Loss: 1.6323 | Val  Acc: 0.4286
 Site-Black-1                   (2) | Val  Loss: 1.7529 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.2951 | Val  Acc: 0.4872
Average Valid Accuracy: 0.3927
 Best site-White-0                  (3)  | Epoch:10 | Val Acc: 0.3500
 Best site-White-1                  (3)  | Epoch:10 | Val Acc: 0.3235
 Best site-White-2                  (3)  | Epoch:10 | Val Acc: 0.3729
 Best site-White-3                  (3)  | Epoch:10 | Val Acc: 0.4000
 Best site-White-4                  (3)  | Epoch:10 | Val Acc: 0.4353
 Best site-Middle_Eastern-0         (0)  | Epoch:10 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (0)  | Epoch:10 | Val Acc: 0.3750
 Best site-Middle_Eastern-2         (0)  | Epoch:10 | Val Acc: 0.4259
 Best site-Black-0                  (2)  | Epoch:10 | Val Acc: 0.4286
 Best site-Black-1                  (2)  | Epoch:10 | Val Acc: 0.2771
 Best site-White_ffhq-0             (1)  | Epoch:10 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 11 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-White-0                   (0) | Train Loss: 1.3604 | Train Acc: 0.5000
 Site-White-1                   (0) | Train Loss: 1.4586 | Train Acc: 0.4628
 Site-White-2                   (0) | Train Loss: 1.4418 | Train Acc: 0.4528
 Site-White-3                   (0) | Train Loss: 1.4007 | Train Acc: 0.4530
 Site-White-4                   (0) | Train Loss: 1.3739 | Train Acc: 0.4477
 Site-Middle_Eastern-0          (3) | Train Loss: 1.5516 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (3) | Train Loss: 1.4774 | Train Acc: 0.4732
 Site-Middle_Eastern-2          (3) | Train Loss: 1.4651 | Train Acc: 0.4147
 Site-Black-0                   (2) | Train Loss: 1.6186 | Train Acc: 0.3971
 Site-Black-1                   (2) | Train Loss: 1.6079 | Train Acc: 0.3799
 Site-White_ffhq-0              (1) | Train Loss: 1.3119 | Train Acc: 0.4544
Average Train Accuracy: 0.4407
 Site-White-0                   (0) | Val  Loss: 1.7190 | Val  Acc: 0.4000
 Site-White-1                   (0) | Val  Loss: 1.4584 | Val  Acc: 0.3529
 Site-White-2                   (0) | Val  Loss: 1.5986 | Val  Acc: 0.4237
 Site-White-3                   (0) | Val  Loss: 1.5018 | Val  Acc: 0.4100
 Site-White-4                   (0) | Val  Loss: 1.5233 | Val  Acc: 0.4471
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.6272 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3946 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.4951 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.7119 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.6678 | Val  Acc: 0.2410
 Site-White_ffhq-0              (1) | Val  Loss: 1.2182 | Val  Acc: 0.4103
Average Valid Accuracy: 0.3854
============ Train epoch 12 ============
cnt=[2, 1, 3, 5, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-White-0                   (2) | Train Loss: 1.3094 | Train Acc: 0.5000
 Site-White-1                   (2) | Train Loss: 1.4600 | Train Acc: 0.4463
 Site-White-2                   (3) | Train Loss: 1.4514 | Train Acc: 0.4358
 Site-White-3                   (3) | Train Loss: 1.3988 | Train Acc: 0.4501
 Site-White-4                   (3) | Train Loss: 1.3610 | Train Acc: 0.4644
 Site-Middle_Eastern-0          (3) | Train Loss: 1.6727 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (3) | Train Loss: 1.4694 | Train Acc: 0.4375
 Site-Middle_Eastern-2          (2) | Train Loss: 1.4350 | Train Acc: 0.4409
 Site-Black-0                   (0) | Train Loss: 1.5901 | Train Acc: 0.4145
 Site-Black-1                   (0) | Train Loss: 1.5500 | Train Acc: 0.3782
 Site-White_ffhq-0              (1) | Train Loss: 1.3627 | Train Acc: 0.4635
Average Train Accuracy: 0.4417
 Site-White-0                   (2) | Val  Loss: 1.7072 | Val  Acc: 0.3500
 Site-White-1                   (2) | Val  Loss: 1.4758 | Val  Acc: 0.3824
 Site-White-2                   (3) | Val  Loss: 1.7007 | Val  Acc: 0.3729
 Site-White-3                   (3) | Val  Loss: 1.5241 | Val  Acc: 0.3800
 Site-White-4                   (3) | Val  Loss: 1.5339 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.6262 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.4045 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (2) | Val  Loss: 1.4593 | Val  Acc: 0.3889
 Site-Black-0                   (0) | Val  Loss: 1.6809 | Val  Acc: 0.3469
 Site-Black-1                   (0) | Val  Loss: 1.7061 | Val  Acc: 0.3012
 Site-White_ffhq-0              (1) | Val  Loss: 1.2221 | Val  Acc: 0.5128
Average Valid Accuracy: 0.3916
============ Train epoch 13 ============
cnt=[2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-White-0                   (1) | Train Loss: 1.2822 | Train Acc: 0.5282
 Site-White-1                   (1) | Train Loss: 1.4376 | Train Acc: 0.4711
 Site-White-2                   (1) | Train Loss: 1.4137 | Train Acc: 0.4552
 Site-White-3                   (1) | Train Loss: 1.3868 | Train Acc: 0.4473
 Site-White-4                   (1) | Train Loss: 1.3463 | Train Acc: 0.4628
 Site-Middle_Eastern-0          (3) | Train Loss: 1.4098 | Train Acc: 0.4504
 Site-Middle_Eastern-1          (3) | Train Loss: 1.4304 | Train Acc: 0.4509
 Site-Middle_Eastern-2          (3) | Train Loss: 1.4146 | Train Acc: 0.4462
 Site-Black-0                   (0) | Train Loss: 1.5526 | Train Acc: 0.4029
 Site-Black-1                   (0) | Train Loss: 1.5149 | Train Acc: 0.3680
 Site-White_ffhq-0              (2) | Train Loss: 1.3555 | Train Acc: 0.4891
Average Train Accuracy: 0.4520
 Site-White-0                   (1) | Val  Loss: 1.7053 | Val  Acc: 0.4000
 Site-White-1                   (1) | Val  Loss: 1.4132 | Val  Acc: 0.3235
 Site-White-2                   (1) | Val  Loss: 1.6336 | Val  Acc: 0.3220
 Site-White-3                   (1) | Val  Loss: 1.4242 | Val  Acc: 0.4300
 Site-White-4                   (1) | Val  Loss: 1.5144 | Val  Acc: 0.4471
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5922 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3910 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.4395 | Val  Acc: 0.4074
 Site-Black-0                   (0) | Val  Loss: 1.6689 | Val  Acc: 0.4082
 Site-Black-1                   (0) | Val  Loss: 1.6619 | Val  Acc: 0.3012
 Site-White_ffhq-0              (2) | Val  Loss: 1.2215 | Val  Acc: 0.4359
Average Valid Accuracy: 0.3882
============ Train epoch 14 ============
cnt=[5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-White-0                   (0) | Train Loss: 1.4335 | Train Acc: 0.5423
 Site-White-1                   (0) | Train Loss: 1.4368 | Train Acc: 0.4545
 Site-White-2                   (0) | Train Loss: 1.3984 | Train Acc: 0.4649
 Site-White-3                   (0) | Train Loss: 1.3584 | Train Acc: 0.4587
 Site-White-4                   (0) | Train Loss: 1.3327 | Train Acc: 0.4778
 Site-Middle_Eastern-0          (2) | Train Loss: 1.3105 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (2) | Train Loss: 1.4516 | Train Acc: 0.4464
 Site-Middle_Eastern-2          (2) | Train Loss: 1.4264 | Train Acc: 0.4252
 Site-Black-0                   (3) | Train Loss: 1.5515 | Train Acc: 0.4029
 Site-Black-1                   (3) | Train Loss: 1.5009 | Train Acc: 0.3850
 Site-White_ffhq-0              (1) | Train Loss: 1.2931 | Train Acc: 0.5000
Average Train Accuracy: 0.4532
 Site-White-0                   (0) | Val  Loss: 1.7184 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.4706 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.6396 | Val  Acc: 0.4068
 Site-White-3                   (0) | Val  Loss: 1.4398 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.5112 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (2) | Val  Loss: 1.6077 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (2) | Val  Loss: 1.4017 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (2) | Val  Loss: 1.4472 | Val  Acc: 0.4074
 Site-Black-0                   (3) | Val  Loss: 1.6984 | Val  Acc: 0.3469
 Site-Black-1                   (3) | Val  Loss: 1.6606 | Val  Acc: 0.2410
 Site-White_ffhq-0              (1) | Val  Loss: 1.1886 | Val  Acc: 0.4359
Average Valid Accuracy: 0.3954
 Best site-White-0                  (0)  | Epoch:14 | Val Acc: 0.3500
 Best site-White-1                  (0)  | Epoch:14 | Val Acc: 0.3235
 Best site-White-2                  (0)  | Epoch:14 | Val Acc: 0.4068
 Best site-White-3                  (0)  | Epoch:14 | Val Acc: 0.4600
 Best site-White-4                  (0)  | Epoch:14 | Val Acc: 0.4647
 Best site-Middle_Eastern-0         (2)  | Epoch:14 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (2)  | Epoch:14 | Val Acc: 0.4688
 Best site-Middle_Eastern-2         (2)  | Epoch:14 | Val Acc: 0.4074
 Best site-Black-0                  (3)  | Epoch:14 | Val Acc: 0.3469
 Best site-Black-1                  (3)  | Epoch:14 | Val Acc: 0.2410
 Best site-White_ffhq-0             (1)  | Epoch:14 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-White-0                   (1) | Train Loss: 1.3465 | Train Acc: 0.5352
 Site-White-1                   (1) | Train Loss: 1.4244 | Train Acc: 0.4421
 Site-White-2                   (1) | Train Loss: 1.3617 | Train Acc: 0.4552
 Site-White-3                   (1) | Train Loss: 1.3538 | Train Acc: 0.4744
 Site-White-4                   (1) | Train Loss: 1.3261 | Train Acc: 0.4745
 Site-Middle_Eastern-0          (3) | Train Loss: 1.5026 | Train Acc: 0.3893
 Site-Middle_Eastern-1          (3) | Train Loss: 1.4550 | Train Acc: 0.4821
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3855 | Train Acc: 0.4751
 Site-Black-0                   (0) | Train Loss: 1.5564 | Train Acc: 0.4058
 Site-Black-1                   (0) | Train Loss: 1.4955 | Train Acc: 0.4020
 Site-White_ffhq-0              (2) | Train Loss: 1.3756 | Train Acc: 0.4763
Average Train Accuracy: 0.4556
 Site-White-0                   (1) | Val  Loss: 1.6393 | Val  Acc: 0.4000
 Site-White-1                   (1) | Val  Loss: 1.4536 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.6517 | Val  Acc: 0.3390
 Site-White-3                   (1) | Val  Loss: 1.3912 | Val  Acc: 0.4100
 Site-White-4                   (1) | Val  Loss: 1.5087 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.6391 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3481 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.4310 | Val  Acc: 0.4444
 Site-Black-0                   (0) | Val  Loss: 1.6156 | Val  Acc: 0.3673
 Site-Black-1                   (0) | Val  Loss: 1.6749 | Val  Acc: 0.3494
 Site-White_ffhq-0              (2) | Val  Loss: 1.2605 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4054
 Best site-White-0                  (1)  | Epoch:15 | Val Acc: 0.4000
 Best site-White-1                  (1)  | Epoch:15 | Val Acc: 0.3529
 Best site-White-2                  (1)  | Epoch:15 | Val Acc: 0.3390
 Best site-White-3                  (1)  | Epoch:15 | Val Acc: 0.4100
 Best site-White-4                  (1)  | Epoch:15 | Val Acc: 0.4529
 Best site-Middle_Eastern-0         (3)  | Epoch:15 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (3)  | Epoch:15 | Val Acc: 0.4375
 Best site-Middle_Eastern-2         (3)  | Epoch:15 | Val Acc: 0.4444
 Best site-Black-0                  (0)  | Epoch:15 | Val Acc: 0.3673
 Best site-Black-1                  (0)  | Epoch:15 | Val Acc: 0.3494
 Best site-White_ffhq-0             (2)  | Epoch:15 | Val Acc: 0.4615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 16 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-White-0                   (0) | Train Loss: 1.4664 | Train Acc: 0.4859
 Site-White-1                   (0) | Train Loss: 1.4117 | Train Acc: 0.4793
 Site-White-2                   (0) | Train Loss: 1.4116 | Train Acc: 0.4479
 Site-White-3                   (0) | Train Loss: 1.3469 | Train Acc: 0.4658
 Site-White-4                   (0) | Train Loss: 1.3000 | Train Acc: 0.4736
 Site-Middle_Eastern-0          (3) | Train Loss: 1.7099 | Train Acc: 0.3817
 Site-Middle_Eastern-1          (3) | Train Loss: 1.4246 | Train Acc: 0.4643
 Site-Middle_Eastern-2          (3) | Train Loss: 1.4118 | Train Acc: 0.4567
 Site-Black-0                   (2) | Train Loss: 1.5578 | Train Acc: 0.4000
 Site-Black-1                   (2) | Train Loss: 1.5289 | Train Acc: 0.3799
 Site-White_ffhq-0              (1) | Train Loss: 1.2341 | Train Acc: 0.4964
Average Train Accuracy: 0.4483
 Site-White-0                   (0) | Val  Loss: 1.6941 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.4311 | Val  Acc: 0.3824
 Site-White-2                   (0) | Val  Loss: 1.6722 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.4197 | Val  Acc: 0.4100
 Site-White-4                   (0) | Val  Loss: 1.5009 | Val  Acc: 0.4588
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5597 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3362 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3967 | Val  Acc: 0.4444
 Site-Black-0                   (2) | Val  Loss: 1.7241 | Val  Acc: 0.3265
 Site-Black-1                   (2) | Val  Loss: 1.6914 | Val  Acc: 0.2289
 Site-White_ffhq-0              (1) | Val  Loss: 1.1474 | Val  Acc: 0.4231
Average Valid Accuracy: 0.3826
============ Train epoch 17 ============
cnt=[5, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-White-0                   (0) | Train Loss: 1.2234 | Train Acc: 0.5070
 Site-White-1                   (0) | Train Loss: 1.4505 | Train Acc: 0.4628
 Site-White-2                   (0) | Train Loss: 1.3846 | Train Acc: 0.4576
 Site-White-3                   (0) | Train Loss: 1.3406 | Train Acc: 0.4815
 Site-White-4                   (0) | Train Loss: 1.3203 | Train Acc: 0.4812
 Site-Middle_Eastern-0          (3) | Train Loss: 1.2161 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (3) | Train Loss: 1.4047 | Train Acc: 0.4911
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3760 | Train Acc: 0.4619
 Site-Black-0                   (1) | Train Loss: 1.4998 | Train Acc: 0.4290
 Site-Black-1                   (1) | Train Loss: 1.4694 | Train Acc: 0.4208
 Site-White_ffhq-0              (2) | Train Loss: 1.3203 | Train Acc: 0.4872
Average Train Accuracy: 0.4643
 Site-White-0                   (0) | Val  Loss: 1.6788 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.4352 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.6744 | Val  Acc: 0.4068
 Site-White-3                   (0) | Val  Loss: 1.4665 | Val  Acc: 0.3800
 Site-White-4                   (0) | Val  Loss: 1.5022 | Val  Acc: 0.4824
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5540 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3263 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.4298 | Val  Acc: 0.4444
 Site-Black-0                   (1) | Val  Loss: 1.6595 | Val  Acc: 0.3673
 Site-Black-1                   (1) | Val  Loss: 1.6167 | Val  Acc: 0.3735
 Site-White_ffhq-0              (2) | Val  Loss: 1.1653 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4019
============ Train epoch 18 ============
cnt=[1, 1, 2, 7, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-White-0                   (3) | Train Loss: 1.2350 | Train Acc: 0.5282
 Site-White-1                   (3) | Train Loss: 1.4169 | Train Acc: 0.4421
 Site-White-2                   (3) | Train Loss: 1.4019 | Train Acc: 0.4504
 Site-White-3                   (3) | Train Loss: 1.3172 | Train Acc: 0.4829
 Site-White-4                   (0) | Train Loss: 1.3052 | Train Acc: 0.4753
 Site-Middle_Eastern-0          (3) | Train Loss: 1.5808 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3970 | Train Acc: 0.4777
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3795 | Train Acc: 0.4751
 Site-Black-0                   (2) | Train Loss: 1.5224 | Train Acc: 0.4145
 Site-Black-1                   (2) | Train Loss: 1.4939 | Train Acc: 0.4020
 Site-White_ffhq-0              (1) | Train Loss: 1.3136 | Train Acc: 0.4653
Average Train Accuracy: 0.4569
 Site-White-0                   (3) | Val  Loss: 1.6411 | Val  Acc: 0.4000
 Site-White-1                   (3) | Val  Loss: 1.3741 | Val  Acc: 0.3529
 Site-White-2                   (3) | Val  Loss: 1.6528 | Val  Acc: 0.4237
 Site-White-3                   (3) | Val  Loss: 1.3860 | Val  Acc: 0.4400
 Site-White-4                   (0) | Val  Loss: 1.4883 | Val  Acc: 0.4294
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5048 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.4484 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.4194 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.6622 | Val  Acc: 0.3878
 Site-Black-1                   (2) | Val  Loss: 1.6946 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.1706 | Val  Acc: 0.4487
Average Valid Accuracy: 0.4067
 Best site-White-0                  (3)  | Epoch:18 | Val Acc: 0.4000
 Best site-White-1                  (3)  | Epoch:18 | Val Acc: 0.3529
 Best site-White-2                  (3)  | Epoch:18 | Val Acc: 0.4237
 Best site-White-3                  (3)  | Epoch:18 | Val Acc: 0.4400
 Best site-White-4                  (0)  | Epoch:18 | Val Acc: 0.4294
 Best site-Middle_Eastern-0         (3)  | Epoch:18 | Val Acc: 0.5000
 Best site-Middle_Eastern-1         (3)  | Epoch:18 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (3)  | Epoch:18 | Val Acc: 0.4074
 Best site-Black-0                  (2)  | Epoch:18 | Val Acc: 0.3878
 Best site-Black-1                  (2)  | Epoch:18 | Val Acc: 0.2771
 Best site-White_ffhq-0             (1)  | Epoch:18 | Val Acc: 0.4487
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 19 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-White-0                   (0) | Train Loss: 1.2463 | Train Acc: 0.5000
 Site-White-1                   (0) | Train Loss: 1.3771 | Train Acc: 0.5083
 Site-White-2                   (0) | Train Loss: 1.3618 | Train Acc: 0.4746
 Site-White-3                   (0) | Train Loss: 1.3124 | Train Acc: 0.4772
 Site-White-4                   (0) | Train Loss: 1.2805 | Train Acc: 0.4979
 Site-Middle_Eastern-0          (3) | Train Loss: 1.4109 | Train Acc: 0.4733
 Site-Middle_Eastern-1          (3) | Train Loss: 1.4280 | Train Acc: 0.4688
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3694 | Train Acc: 0.4646
 Site-Black-0                   (2) | Train Loss: 1.5526 | Train Acc: 0.4319
 Site-Black-1                   (2) | Train Loss: 1.4759 | Train Acc: 0.4072
 Site-White_ffhq-0              (1) | Train Loss: 1.2857 | Train Acc: 0.5000
Average Train Accuracy: 0.4731
 Site-White-0                   (0) | Val  Loss: 1.6687 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.4558 | Val  Acc: 0.2647
 Site-White-2                   (0) | Val  Loss: 1.6321 | Val  Acc: 0.3390
 Site-White-3                   (0) | Val  Loss: 1.3926 | Val  Acc: 0.4500
 Site-White-4                   (0) | Val  Loss: 1.4550 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.4923 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3553 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3975 | Val  Acc: 0.4259
 Site-Black-0                   (2) | Val  Loss: 1.7560 | Val  Acc: 0.3469
 Site-Black-1                   (2) | Val  Loss: 1.6862 | Val  Acc: 0.3253
 Site-White_ffhq-0              (1) | Val  Loss: 1.1538 | Val  Acc: 0.4359
Average Valid Accuracy: 0.3821
 Test site-White-0                   (0)| Epoch:18 | Test Acc: 0.3333
 Test site-White-1                   (0)| Epoch:18 | Test Acc: 0.4789
 Test site-White-2                   (0)| Epoch:18 | Test Acc: 0.4370
 Test site-White-3                   (0)| Epoch:18 | Test Acc: 0.4851
 Test site-White-4                   (0)| Epoch:18 | Test Acc: 0.4344
 Test site-Middle_Eastern-0          (3)| Epoch:18 | Test Acc: 0.4359
 Test site-Middle_Eastern-1          (3)| Epoch:18 | Test Acc: 0.3385
 Test site-Middle_Eastern-2          (3)| Epoch:18 | Test Acc: 0.4091
 Test site-Black-0                   (2)| Epoch:18 | Test Acc: 0.3500
 Test site-Black-1                   (2)| Epoch:18 | Test Acc: 0.3254
 Test site-White_ffhq-0              (1)| Epoch:18 | Test Acc: 0.4747
White: 0.4337, Middle_Eastern: 0.3945, Black: 0.3377, White_ffhq: 0.4747, 
Average Test Accuracy(group): 0.4102, Average Test Accuracy(individual): 0.4093,
domain std=0.0505, cluster std=0.0505, individual std=0.0590, 
============ Train epoch 20 ============
cnt=[3, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-White-0                   (3) | Train Loss: 1.2969 | Train Acc: 0.5141
 Site-White-1                   (3) | Train Loss: 1.4206 | Train Acc: 0.4876
 Site-White-2                   (3) | Train Loss: 1.3879 | Train Acc: 0.4649
 Site-White-3                   (3) | Train Loss: 1.3238 | Train Acc: 0.4687
 Site-White-4                   (3) | Train Loss: 1.2941 | Train Acc: 0.4929
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4385 | Train Acc: 0.4351
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4046 | Train Acc: 0.4464
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3810 | Train Acc: 0.4567
 Site-Black-0                   (2) | Train Loss: 1.4933 | Train Acc: 0.4348
 Site-Black-1                   (2) | Train Loss: 1.4954 | Train Acc: 0.4225
 Site-White_ffhq-0              (1) | Train Loss: 1.2803 | Train Acc: 0.5073
Average Train Accuracy: 0.4664
 Site-White-0                   (3) | Val  Loss: 1.7087 | Val  Acc: 0.4000
 Site-White-1                   (3) | Val  Loss: 1.3903 | Val  Acc: 0.3824
 Site-White-2                   (3) | Val  Loss: 1.6530 | Val  Acc: 0.3729
 Site-White-3                   (3) | Val  Loss: 1.3940 | Val  Acc: 0.4600
 Site-White-4                   (3) | Val  Loss: 1.5104 | Val  Acc: 0.4353
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5151 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3990 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3993 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.6288 | Val  Acc: 0.3878
 Site-Black-1                   (2) | Val  Loss: 1.6265 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1227 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4127
 Best site-White-0                  (3)  | Epoch:20 | Val Acc: 0.4000
 Best site-White-1                  (3)  | Epoch:20 | Val Acc: 0.3824
 Best site-White-2                  (3)  | Epoch:20 | Val Acc: 0.3729
 Best site-White-3                  (3)  | Epoch:20 | Val Acc: 0.4600
 Best site-White-4                  (3)  | Epoch:20 | Val Acc: 0.4353
 Best site-Middle_Eastern-0         (0)  | Epoch:20 | Val Acc: 0.5000
 Best site-Middle_Eastern-1         (0)  | Epoch:20 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (0)  | Epoch:20 | Val Acc: 0.4074
 Best site-Black-0                  (2)  | Epoch:20 | Val Acc: 0.3878
 Best site-Black-1                  (2)  | Epoch:20 | Val Acc: 0.3133
 Best site-White_ffhq-0             (1)  | Epoch:20 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 21 ============
cnt=[3, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-White-0                   (3) | Train Loss: 1.1760 | Train Acc: 0.5000
 Site-White-1                   (3) | Train Loss: 1.3591 | Train Acc: 0.4959
 Site-White-2                   (3) | Train Loss: 1.3513 | Train Acc: 0.4818
 Site-White-3                   (3) | Train Loss: 1.3151 | Train Acc: 0.4872
 Site-White-4                   (3) | Train Loss: 1.2777 | Train Acc: 0.4904
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4762 | Train Acc: 0.4427
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3988 | Train Acc: 0.4911
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3577 | Train Acc: 0.4724
 Site-Black-0                   (2) | Train Loss: 1.5062 | Train Acc: 0.4348
 Site-Black-1                   (2) | Train Loss: 1.4426 | Train Acc: 0.4378
 Site-White_ffhq-0              (1) | Train Loss: 1.2790 | Train Acc: 0.5091
Average Train Accuracy: 0.4767
 Site-White-0                   (3) | Val  Loss: 1.6196 | Val  Acc: 0.3500
 Site-White-1                   (3) | Val  Loss: 1.3978 | Val  Acc: 0.3824
 Site-White-2                   (3) | Val  Loss: 1.6330 | Val  Acc: 0.3898
 Site-White-3                   (3) | Val  Loss: 1.3106 | Val  Acc: 0.4800
 Site-White-4                   (3) | Val  Loss: 1.4882 | Val  Acc: 0.4294
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6208 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4601 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3826 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.5939 | Val  Acc: 0.3469
 Site-Black-1                   (2) | Val  Loss: 1.6934 | Val  Acc: 0.2892
 Site-White_ffhq-0              (1) | Val  Loss: 1.1429 | Val  Acc: 0.4103
Average Valid Accuracy: 0.4043
============ Train epoch 22 ============
cnt=[3, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-White-0                   (3) | Train Loss: 1.3420 | Train Acc: 0.5211
 Site-White-1                   (3) | Train Loss: 1.3666 | Train Acc: 0.4711
 Site-White-2                   (3) | Train Loss: 1.3529 | Train Acc: 0.4576
 Site-White-3                   (3) | Train Loss: 1.2952 | Train Acc: 0.4872
 Site-White-4                   (3) | Train Loss: 1.2784 | Train Acc: 0.4946
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3427 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3591 | Train Acc: 0.5134
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3475 | Train Acc: 0.4541
 Site-Black-0                   (2) | Train Loss: 1.4773 | Train Acc: 0.4609
 Site-Black-1                   (2) | Train Loss: 1.4271 | Train Acc: 0.4480
 Site-White_ffhq-0              (1) | Train Loss: 1.3044 | Train Acc: 0.5000
Average Train Accuracy: 0.4759
 Site-White-0                   (3) | Val  Loss: 1.5873 | Val  Acc: 0.4500
 Site-White-1                   (3) | Val  Loss: 1.3157 | Val  Acc: 0.4412
 Site-White-2                   (3) | Val  Loss: 1.6238 | Val  Acc: 0.3729
 Site-White-3                   (3) | Val  Loss: 1.3825 | Val  Acc: 0.4400
 Site-White-4                   (3) | Val  Loss: 1.4793 | Val  Acc: 0.4765
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5319 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3668 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3962 | Val  Acc: 0.4259
 Site-Black-0                   (2) | Val  Loss: 1.7259 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.6592 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1576 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4141
 Best site-White-0                  (3)  | Epoch:22 | Val Acc: 0.4500
 Best site-White-1                  (3)  | Epoch:22 | Val Acc: 0.4412
 Best site-White-2                  (3)  | Epoch:22 | Val Acc: 0.3729
 Best site-White-3                  (3)  | Epoch:22 | Val Acc: 0.4400
 Best site-White-4                  (3)  | Epoch:22 | Val Acc: 0.4765
 Best site-Middle_Eastern-0         (0)  | Epoch:22 | Val Acc: 0.5000
 Best site-Middle_Eastern-1         (0)  | Epoch:22 | Val Acc: 0.3750
 Best site-Middle_Eastern-2         (0)  | Epoch:22 | Val Acc: 0.4259
 Best site-Black-0                  (2)  | Epoch:22 | Val Acc: 0.2857
 Best site-Black-1                  (2)  | Epoch:22 | Val Acc: 0.3133
 Best site-White_ffhq-0             (1)  | Epoch:22 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 23 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-White-0                   (0) | Train Loss: 1.2849 | Train Acc: 0.4789
 Site-White-1                   (0) | Train Loss: 1.3738 | Train Acc: 0.4628
 Site-White-2                   (0) | Train Loss: 1.3382 | Train Acc: 0.4746
 Site-White-3                   (0) | Train Loss: 1.3050 | Train Acc: 0.4872
 Site-White-4                   (0) | Train Loss: 1.2809 | Train Acc: 0.4828
 Site-Middle_Eastern-0          (3) | Train Loss: 1.3853 | Train Acc: 0.4046
 Site-Middle_Eastern-1          (3) | Train Loss: 1.4260 | Train Acc: 0.4955
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3621 | Train Acc: 0.4961
 Site-Black-0                   (2) | Train Loss: 1.4995 | Train Acc: 0.4406
 Site-Black-1                   (2) | Train Loss: 1.4331 | Train Acc: 0.4412
 Site-White_ffhq-0              (1) | Train Loss: 1.2600 | Train Acc: 0.4799
Average Train Accuracy: 0.4677
 Site-White-0                   (0) | Val  Loss: 1.6559 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3581 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.5615 | Val  Acc: 0.4237
 Site-White-3                   (0) | Val  Loss: 1.3699 | Val  Acc: 0.4200
 Site-White-4                   (0) | Val  Loss: 1.4912 | Val  Acc: 0.4765
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.6551 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3126 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.4067 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.6662 | Val  Acc: 0.3673
 Site-Black-1                   (2) | Val  Loss: 1.6673 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.1636 | Val  Acc: 0.4103
Average Valid Accuracy: 0.3859
============ Train epoch 24 ============
cnt=[3, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-White-0                   (3) | Train Loss: 1.2509 | Train Acc: 0.4859
 Site-White-1                   (3) | Train Loss: 1.3918 | Train Acc: 0.4545
 Site-White-2                   (3) | Train Loss: 1.3135 | Train Acc: 0.4843
 Site-White-3                   (3) | Train Loss: 1.3070 | Train Acc: 0.4943
 Site-White-4                   (3) | Train Loss: 1.2717 | Train Acc: 0.4904
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3372 | Train Acc: 0.4580
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3187 | Train Acc: 0.5045
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3314 | Train Acc: 0.4987
 Site-Black-0                   (2) | Train Loss: 1.4533 | Train Acc: 0.4783
 Site-Black-1                   (2) | Train Loss: 1.3907 | Train Acc: 0.4668
 Site-White_ffhq-0              (1) | Train Loss: 1.3152 | Train Acc: 0.4653
Average Train Accuracy: 0.4801
 Site-White-0                   (3) | Val  Loss: 1.6097 | Val  Acc: 0.3500
 Site-White-1                   (3) | Val  Loss: 1.3611 | Val  Acc: 0.3235
 Site-White-2                   (3) | Val  Loss: 1.6013 | Val  Acc: 0.4237
 Site-White-3                   (3) | Val  Loss: 1.3666 | Val  Acc: 0.4600
 Site-White-4                   (3) | Val  Loss: 1.4531 | Val  Acc: 0.4765
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5528 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3131 | Val  Acc: 0.5312
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3715 | Val  Acc: 0.4444
 Site-Black-0                   (2) | Val  Loss: 1.6040 | Val  Acc: 0.3469
 Site-Black-1                   (2) | Val  Loss: 1.6483 | Val  Acc: 0.2651
 Site-White_ffhq-0              (1) | Val  Loss: 1.1967 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4077
============ Train epoch 25 ============
cnt=[2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-White-0                   (1) | Train Loss: 1.3138 | Train Acc: 0.4577
 Site-White-1                   (1) | Train Loss: 1.3943 | Train Acc: 0.4793
 Site-White-2                   (1) | Train Loss: 1.3173 | Train Acc: 0.4649
 Site-White-3                   (1) | Train Loss: 1.2871 | Train Acc: 0.5128
 Site-White-4                   (1) | Train Loss: 1.2491 | Train Acc: 0.5013
 Site-Middle_Eastern-0          (3) | Train Loss: 1.6110 | Train Acc: 0.4733
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3429 | Train Acc: 0.4643
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3373 | Train Acc: 0.4698
 Site-Black-0                   (0) | Train Loss: 1.4652 | Train Acc: 0.4290
 Site-Black-1                   (0) | Train Loss: 1.4140 | Train Acc: 0.4702
 Site-White_ffhq-0              (2) | Train Loss: 1.2836 | Train Acc: 0.4964
Average Train Accuracy: 0.4745
 Site-White-0                   (1) | Val  Loss: 1.6552 | Val  Acc: 0.3500
 Site-White-1                   (1) | Val  Loss: 1.4073 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.5416 | Val  Acc: 0.4068
 Site-White-3                   (1) | Val  Loss: 1.3502 | Val  Acc: 0.4500
 Site-White-4                   (1) | Val  Loss: 1.4253 | Val  Acc: 0.4824
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5287 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3575 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3939 | Val  Acc: 0.3889
 Site-Black-0                   (0) | Val  Loss: 1.6620 | Val  Acc: 0.3878
 Site-Black-1                   (0) | Val  Loss: 1.6661 | Val  Acc: 0.3133
 Site-White_ffhq-0              (2) | Val  Loss: 1.1245 | Val  Acc: 0.4359
Average Valid Accuracy: 0.4124
============ Train epoch 26 ============
cnt=[2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-White-0                   (1) | Train Loss: 1.2252 | Train Acc: 0.5352
 Site-White-1                   (1) | Train Loss: 1.3306 | Train Acc: 0.4752
 Site-White-2                   (1) | Train Loss: 1.3169 | Train Acc: 0.4697
 Site-White-3                   (1) | Train Loss: 1.2971 | Train Acc: 0.5000
 Site-White-4                   (1) | Train Loss: 1.2705 | Train Acc: 0.4870
 Site-Middle_Eastern-0          (3) | Train Loss: 1.2448 | Train Acc: 0.4504
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3603 | Train Acc: 0.4911
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3504 | Train Acc: 0.4751
 Site-Black-0                   (0) | Train Loss: 1.4493 | Train Acc: 0.4609
 Site-Black-1                   (0) | Train Loss: 1.3929 | Train Acc: 0.4395
 Site-White_ffhq-0              (2) | Train Loss: 1.3240 | Train Acc: 0.5091
Average Train Accuracy: 0.4812
 Site-White-0                   (1) | Val  Loss: 1.6492 | Val  Acc: 0.3000
 Site-White-1                   (1) | Val  Loss: 1.3861 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.5986 | Val  Acc: 0.3729
 Site-White-3                   (1) | Val  Loss: 1.3793 | Val  Acc: 0.4900
 Site-White-4                   (1) | Val  Loss: 1.4836 | Val  Acc: 0.4412
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5342 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3811 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3814 | Val  Acc: 0.4815
 Site-Black-0                   (0) | Val  Loss: 1.6070 | Val  Acc: 0.3469
 Site-Black-1                   (0) | Val  Loss: 1.6553 | Val  Acc: 0.3012
 Site-White_ffhq-0              (2) | Val  Loss: 1.2131 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4078
============ Train epoch 27 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-White-0                   (0) | Train Loss: 1.2894 | Train Acc: 0.4859
 Site-White-1                   (0) | Train Loss: 1.3489 | Train Acc: 0.4876
 Site-White-2                   (0) | Train Loss: 1.3173 | Train Acc: 0.4722
 Site-White-3                   (0) | Train Loss: 1.2740 | Train Acc: 0.4986
 Site-White-4                   (0) | Train Loss: 1.2661 | Train Acc: 0.5004
 Site-Middle_Eastern-0          (3) | Train Loss: 1.7001 | Train Acc: 0.4656
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3635 | Train Acc: 0.5045
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3594 | Train Acc: 0.4567
 Site-Black-0                   (2) | Train Loss: 1.4713 | Train Acc: 0.4377
 Site-Black-1                   (2) | Train Loss: 1.4360 | Train Acc: 0.4361
 Site-White_ffhq-0              (1) | Train Loss: 1.1770 | Train Acc: 0.5347
Average Train Accuracy: 0.4800
 Site-White-0                   (0) | Val  Loss: 1.5067 | Val  Acc: 0.4500
 Site-White-1                   (0) | Val  Loss: 1.3176 | Val  Acc: 0.3824
 Site-White-2                   (0) | Val  Loss: 1.5923 | Val  Acc: 0.4068
 Site-White-3                   (0) | Val  Loss: 1.3448 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.4546 | Val  Acc: 0.5000
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5313 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3879 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3646 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.7596 | Val  Acc: 0.3061
 Site-Black-1                   (2) | Val  Loss: 1.6822 | Val  Acc: 0.3614
 Site-White_ffhq-0              (1) | Val  Loss: 1.0973 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4310
 Best site-White-0                  (0)  | Epoch:27 | Val Acc: 0.4500
 Best site-White-1                  (0)  | Epoch:27 | Val Acc: 0.3824
 Best site-White-2                  (0)  | Epoch:27 | Val Acc: 0.4068
 Best site-White-3                  (0)  | Epoch:27 | Val Acc: 0.4600
 Best site-White-4                  (0)  | Epoch:27 | Val Acc: 0.5000
 Best site-Middle_Eastern-0         (3)  | Epoch:27 | Val Acc: 0.5556
 Best site-Middle_Eastern-1         (3)  | Epoch:27 | Val Acc: 0.4375
 Best site-Middle_Eastern-2         (3)  | Epoch:27 | Val Acc: 0.4074
 Best site-Black-0                  (2)  | Epoch:27 | Val Acc: 0.3061
 Best site-Black-1                  (2)  | Epoch:27 | Val Acc: 0.3614
 Best site-White_ffhq-0             (1)  | Epoch:27 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 28 ============
cnt=[1, 3, 2, 5, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-White-0                   (3) | Train Loss: 1.3120 | Train Acc: 0.5211
 Site-White-1                   (3) | Train Loss: 1.3698 | Train Acc: 0.4463
 Site-White-2                   (3) | Train Loss: 1.2923 | Train Acc: 0.4746
 Site-White-3                   (3) | Train Loss: 1.2894 | Train Acc: 0.5028
 Site-White-4                   (3) | Train Loss: 1.2591 | Train Acc: 0.4996
 Site-Middle_Eastern-0          (1) | Train Loss: 1.5481 | Train Acc: 0.4580
 Site-Middle_Eastern-1          (1) | Train Loss: 1.3577 | Train Acc: 0.4732
 Site-Middle_Eastern-2          (1) | Train Loss: 1.3060 | Train Acc: 0.4856
 Site-Black-0                   (2) | Train Loss: 1.4097 | Train Acc: 0.4522
 Site-Black-1                   (2) | Train Loss: 1.3954 | Train Acc: 0.4361
 Site-White_ffhq-0              (0) | Train Loss: 1.3254 | Train Acc: 0.4982
Average Train Accuracy: 0.4771
 Site-White-0                   (3) | Val  Loss: 1.5534 | Val  Acc: 0.3000
 Site-White-1                   (3) | Val  Loss: 1.3043 | Val  Acc: 0.4412
 Site-White-2                   (3) | Val  Loss: 1.6168 | Val  Acc: 0.3559
 Site-White-3                   (3) | Val  Loss: 1.3362 | Val  Acc: 0.4200
 Site-White-4                   (3) | Val  Loss: 1.4490 | Val  Acc: 0.4471
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5047 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3841 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.4037 | Val  Acc: 0.4259
 Site-Black-0                   (2) | Val  Loss: 1.6767 | Val  Acc: 0.3878
 Site-Black-1                   (2) | Val  Loss: 1.6670 | Val  Acc: 0.3253
 Site-White_ffhq-0              (0) | Val  Loss: 1.1614 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4121
============ Train epoch 29 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-White-0                   (0) | Train Loss: 1.3506 | Train Acc: 0.5000
 Site-White-1                   (0) | Train Loss: 1.3431 | Train Acc: 0.5083
 Site-White-2                   (0) | Train Loss: 1.3098 | Train Acc: 0.4794
 Site-White-3                   (0) | Train Loss: 1.2820 | Train Acc: 0.5028
 Site-White-4                   (0) | Train Loss: 1.2520 | Train Acc: 0.4803
 Site-Middle_Eastern-0          (3) | Train Loss: 1.2381 | Train Acc: 0.4656
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3891 | Train Acc: 0.5045
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3189 | Train Acc: 0.4856
 Site-Black-0                   (2) | Train Loss: 1.4683 | Train Acc: 0.4435
 Site-Black-1                   (2) | Train Loss: 1.3825 | Train Acc: 0.4191
 Site-White_ffhq-0              (1) | Train Loss: 1.2067 | Train Acc: 0.5383
Average Train Accuracy: 0.4843
 Site-White-0                   (0) | Val  Loss: 1.6192 | Val  Acc: 0.4500
 Site-White-1                   (0) | Val  Loss: 1.3102 | Val  Acc: 0.3529
 Site-White-2                   (0) | Val  Loss: 1.6440 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.3379 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.4700 | Val  Acc: 0.4588
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.4787 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3098 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3849 | Val  Acc: 0.4259
 Site-Black-0                   (2) | Val  Loss: 1.6372 | Val  Acc: 0.3265
 Site-Black-1                   (2) | Val  Loss: 1.6744 | Val  Acc: 0.3012
 Site-White_ffhq-0              (1) | Val  Loss: 1.1271 | Val  Acc: 0.4487
Average Valid Accuracy: 0.4217
 Test site-White-0                   (0)| Epoch:27 | Test Acc: 0.3333
 Test site-White-1                   (0)| Epoch:27 | Test Acc: 0.4789
 Test site-White-2                   (0)| Epoch:27 | Test Acc: 0.4790
 Test site-White-3                   (0)| Epoch:27 | Test Acc: 0.4554
 Test site-White-4                   (0)| Epoch:27 | Test Acc: 0.4577
 Test site-Middle_Eastern-0          (3)| Epoch:27 | Test Acc: 0.3846
 Test site-Middle_Eastern-1          (3)| Epoch:27 | Test Acc: 0.3692
 Test site-Middle_Eastern-2          (3)| Epoch:27 | Test Acc: 0.4364
 Test site-Black-0                   (2)| Epoch:27 | Test Acc: 0.3700
 Test site-Black-1                   (2)| Epoch:27 | Test Acc: 0.3550
 Test site-White_ffhq-0              (1)| Epoch:27 | Test Acc: 0.5190
White: 0.4409, Middle_Eastern: 0.3967, Black: 0.3625, White_ffhq: 0.5190, 
Average Test Accuracy(group): 0.4298, Average Test Accuracy(individual): 0.4217,
domain std=0.0585, cluster std=0.0585, individual std=0.0586, 
============ Train epoch 30 ============
cnt=[3, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-White-0                   (2) | Train Loss: 1.2276 | Train Acc: 0.4859
 Site-White-1                   (2) | Train Loss: 1.3464 | Train Acc: 0.4793
 Site-White-2                   (2) | Train Loss: 1.3053 | Train Acc: 0.4794
 Site-White-3                   (2) | Train Loss: 1.2674 | Train Acc: 0.5142
 Site-White-4                   (2) | Train Loss: 1.2532 | Train Acc: 0.5063
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3973 | Train Acc: 0.4809
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3818 | Train Acc: 0.5000
 Site-Middle_Eastern-2          (0) | Train Loss: 1.2889 | Train Acc: 0.5144
 Site-Black-0                   (3) | Train Loss: 1.4529 | Train Acc: 0.4406
 Site-Black-1                   (3) | Train Loss: 1.3639 | Train Acc: 0.4804
 Site-White_ffhq-0              (1) | Train Loss: 1.2555 | Train Acc: 0.5128
Average Train Accuracy: 0.4904
 Site-White-0                   (2) | Val  Loss: 1.6136 | Val  Acc: 0.3500
 Site-White-1                   (2) | Val  Loss: 1.3799 | Val  Acc: 0.3235
 Site-White-2                   (2) | Val  Loss: 1.6155 | Val  Acc: 0.3559
 Site-White-3                   (2) | Val  Loss: 1.3362 | Val  Acc: 0.5000
 Site-White-4                   (2) | Val  Loss: 1.4435 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5263 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3234 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3904 | Val  Acc: 0.4074
 Site-Black-0                   (3) | Val  Loss: 1.5735 | Val  Acc: 0.3673
 Site-Black-1                   (3) | Val  Loss: 1.5942 | Val  Acc: 0.3494
 Site-White_ffhq-0              (1) | Val  Loss: 1.0991 | Val  Acc: 0.4487
Average Valid Accuracy: 0.4073
============ Train epoch 31 ============
cnt=[2, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-White-0                   (2) | Train Loss: 1.2036 | Train Acc: 0.5141
 Site-White-1                   (2) | Train Loss: 1.3196 | Train Acc: 0.5165
 Site-White-2                   (2) | Train Loss: 1.3174 | Train Acc: 0.4649
 Site-White-3                   (2) | Train Loss: 1.2701 | Train Acc: 0.5057
 Site-White-4                   (2) | Train Loss: 1.2436 | Train Acc: 0.5029
 Site-Middle_Eastern-0          (3) | Train Loss: 1.2301 | Train Acc: 0.4427
 Site-Middle_Eastern-1          (3) | Train Loss: 1.2866 | Train Acc: 0.5089
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3110 | Train Acc: 0.4987
 Site-Black-0                   (0) | Train Loss: 1.4060 | Train Acc: 0.4783
 Site-Black-1                   (0) | Train Loss: 1.3549 | Train Acc: 0.4855
 Site-White_ffhq-0              (1) | Train Loss: 1.2808 | Train Acc: 0.4964
Average Train Accuracy: 0.4922
 Site-White-0                   (2) | Val  Loss: 1.5651 | Val  Acc: 0.3500
 Site-White-1                   (2) | Val  Loss: 1.3536 | Val  Acc: 0.4118
 Site-White-2                   (2) | Val  Loss: 1.5964 | Val  Acc: 0.3729
 Site-White-3                   (2) | Val  Loss: 1.3177 | Val  Acc: 0.4700
 Site-White-4                   (2) | Val  Loss: 1.4447 | Val  Acc: 0.4412
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5128 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3780 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3719 | Val  Acc: 0.4444
 Site-Black-0                   (0) | Val  Loss: 1.6721 | Val  Acc: 0.3673
 Site-Black-1                   (0) | Val  Loss: 1.6023 | Val  Acc: 0.3253
 Site-White_ffhq-0              (1) | Val  Loss: 1.0720 | Val  Acc: 0.4872
Average Valid Accuracy: 0.4167
============ Train epoch 32 ============
cnt=[3, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-White-0                   (2) | Train Loss: 1.2553 | Train Acc: 0.5070
 Site-White-1                   (2) | Train Loss: 1.3173 | Train Acc: 0.4959
 Site-White-2                   (2) | Train Loss: 1.2912 | Train Acc: 0.5012
 Site-White-3                   (2) | Train Loss: 1.2676 | Train Acc: 0.4986
 Site-White-4                   (2) | Train Loss: 1.2332 | Train Acc: 0.5079
 Site-Middle_Eastern-0          (0) | Train Loss: 1.2316 | Train Acc: 0.4504
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3394 | Train Acc: 0.5045
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3087 | Train Acc: 0.4724
 Site-Black-0                   (3) | Train Loss: 1.4704 | Train Acc: 0.4290
 Site-Black-1                   (3) | Train Loss: 1.3574 | Train Acc: 0.4446
 Site-White_ffhq-0              (1) | Train Loss: 1.2081 | Train Acc: 0.5219
Average Train Accuracy: 0.4849
 Site-White-0                   (2) | Val  Loss: 1.6665 | Val  Acc: 0.3500
 Site-White-1                   (2) | Val  Loss: 1.3797 | Val  Acc: 0.3529
 Site-White-2                   (2) | Val  Loss: 1.6503 | Val  Acc: 0.3729
 Site-White-3                   (2) | Val  Loss: 1.3195 | Val  Acc: 0.4800
 Site-White-4                   (2) | Val  Loss: 1.4331 | Val  Acc: 0.4706
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4800 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3255 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4184 | Val  Acc: 0.4074
 Site-Black-0                   (3) | Val  Loss: 1.6902 | Val  Acc: 0.3265
 Site-Black-1                   (3) | Val  Loss: 1.6454 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.1108 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4124
============ Train epoch 33 ============
cnt=[5, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-White-0                   (0) | Train Loss: 1.1714 | Train Acc: 0.5493
 Site-White-1                   (0) | Train Loss: 1.3445 | Train Acc: 0.5124
 Site-White-2                   (0) | Train Loss: 1.2676 | Train Acc: 0.5012
 Site-White-3                   (0) | Train Loss: 1.2653 | Train Acc: 0.5014
 Site-White-4                   (0) | Train Loss: 1.2191 | Train Acc: 0.5113
 Site-Middle_Eastern-0          (3) | Train Loss: 1.6277 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3387 | Train Acc: 0.5045
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3132 | Train Acc: 0.5039
 Site-Black-0                   (1) | Train Loss: 1.4135 | Train Acc: 0.4580
 Site-Black-1                   (1) | Train Loss: 1.3818 | Train Acc: 0.4651
 Site-White_ffhq-0              (2) | Train Loss: 1.2440 | Train Acc: 0.5055
Average Train Accuracy: 0.4945
 Site-White-0                   (0) | Val  Loss: 1.4878 | Val  Acc: 0.4500
 Site-White-1                   (0) | Val  Loss: 1.3779 | Val  Acc: 0.3529
 Site-White-2                   (0) | Val  Loss: 1.6305 | Val  Acc: 0.3559
 Site-White-3                   (0) | Val  Loss: 1.3336 | Val  Acc: 0.4800
 Site-White-4                   (0) | Val  Loss: 1.4486 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.4484 | Val  Acc: 0.6111
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3619 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3347 | Val  Acc: 0.4074
 Site-Black-0                   (1) | Val  Loss: 1.6474 | Val  Acc: 0.2857
 Site-Black-1                   (1) | Val  Loss: 1.6260 | Val  Acc: 0.3253
 Site-White_ffhq-0              (2) | Val  Loss: 1.0977 | Val  Acc: 0.5128
Average Valid Accuracy: 0.4247
============ Train epoch 34 ============
cnt=[7, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-White-0                   (0) | Train Loss: 1.2639 | Train Acc: 0.5493
 Site-White-1                   (0) | Train Loss: 1.3200 | Train Acc: 0.4835
 Site-White-2                   (0) | Train Loss: 1.2734 | Train Acc: 0.4746
 Site-White-3                   (3) | Train Loss: 1.2467 | Train Acc: 0.5100
 Site-White-4                   (0) | Train Loss: 1.2178 | Train Acc: 0.5180
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4869 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3293 | Train Acc: 0.5179
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3166 | Train Acc: 0.4882
 Site-Black-0                   (2) | Train Loss: 1.4401 | Train Acc: 0.4493
 Site-Black-1                   (2) | Train Loss: 1.3366 | Train Acc: 0.4719
 Site-White_ffhq-0              (1) | Train Loss: 1.2294 | Train Acc: 0.5164
Average Train Accuracy: 0.4908
 Site-White-0                   (0) | Val  Loss: 1.6956 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3545 | Val  Acc: 0.3529
 Site-White-2                   (0) | Val  Loss: 1.6419 | Val  Acc: 0.3898
 Site-White-3                   (3) | Val  Loss: 1.3618 | Val  Acc: 0.4700
 Site-White-4                   (0) | Val  Loss: 1.4312 | Val  Acc: 0.5000
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4889 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3190 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3258 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.6608 | Val  Acc: 0.3878
 Site-Black-1                   (2) | Val  Loss: 1.6636 | Val  Acc: 0.2410
 Site-White_ffhq-0              (1) | Val  Loss: 1.1267 | Val  Acc: 0.5128
Average Valid Accuracy: 0.4136
============ Train epoch 35 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-White-0                   (0) | Train Loss: 1.1851 | Train Acc: 0.5282
 Site-White-1                   (0) | Train Loss: 1.3261 | Train Acc: 0.4835
 Site-White-2                   (0) | Train Loss: 1.2458 | Train Acc: 0.4746
 Site-White-3                   (0) | Train Loss: 1.2515 | Train Acc: 0.5157
 Site-White-4                   (0) | Train Loss: 1.2240 | Train Acc: 0.5079
 Site-Middle_Eastern-0          (3) | Train Loss: 1.2458 | Train Acc: 0.4580
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3461 | Train Acc: 0.5000
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3013 | Train Acc: 0.5039
 Site-Black-0                   (2) | Train Loss: 1.4268 | Train Acc: 0.4638
 Site-Black-1                   (2) | Train Loss: 1.3623 | Train Acc: 0.4736
 Site-White_ffhq-0              (1) | Train Loss: 1.2194 | Train Acc: 0.5237
Average Train Accuracy: 0.4939
 Site-White-0                   (0) | Val  Loss: 1.5473 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3469 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.6479 | Val  Acc: 0.3729
 Site-White-3                   (0) | Val  Loss: 1.3572 | Val  Acc: 0.5000
 Site-White-4                   (0) | Val  Loss: 1.4482 | Val  Acc: 0.4765
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5565 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3377 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3286 | Val  Acc: 0.4630
 Site-Black-0                   (2) | Val  Loss: 1.7024 | Val  Acc: 0.3673
 Site-Black-1                   (2) | Val  Loss: 1.6147 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.1479 | Val  Acc: 0.4487
Average Valid Accuracy: 0.4055
============ Train epoch 36 ============
cnt=[3, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-White-0                   (3) | Train Loss: 1.2334 | Train Acc: 0.5000
 Site-White-1                   (3) | Train Loss: 1.3363 | Train Acc: 0.4752
 Site-White-2                   (3) | Train Loss: 1.2775 | Train Acc: 0.4964
 Site-White-3                   (3) | Train Loss: 1.2456 | Train Acc: 0.5214
 Site-White-4                   (3) | Train Loss: 1.2209 | Train Acc: 0.5197
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4243 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3388 | Train Acc: 0.5089
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3011 | Train Acc: 0.4672
 Site-Black-0                   (2) | Train Loss: 1.4310 | Train Acc: 0.4667
 Site-Black-1                   (2) | Train Loss: 1.3710 | Train Acc: 0.4872
 Site-White_ffhq-0              (1) | Train Loss: 1.2598 | Train Acc: 0.5164
Average Train Accuracy: 0.4890
 Site-White-0                   (3) | Val  Loss: 1.4062 | Val  Acc: 0.4000
 Site-White-1                   (3) | Val  Loss: 1.4027 | Val  Acc: 0.2647
 Site-White-2                   (3) | Val  Loss: 1.6018 | Val  Acc: 0.3220
 Site-White-3                   (3) | Val  Loss: 1.3582 | Val  Acc: 0.4800
 Site-White-4                   (3) | Val  Loss: 1.4601 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6229 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4088 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3717 | Val  Acc: 0.4444
 Site-Black-0                   (2) | Val  Loss: 1.6363 | Val  Acc: 0.4082
 Site-Black-1                   (2) | Val  Loss: 1.6181 | Val  Acc: 0.2892
 Site-White_ffhq-0              (1) | Val  Loss: 1.1048 | Val  Acc: 0.4872
Average Valid Accuracy: 0.3999
============ Train epoch 37 ============
cnt=[1, 8, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-White-0                   (1) | Train Loss: 1.2841 | Train Acc: 0.5211
 Site-White-1                   (1) | Train Loss: 1.3259 | Train Acc: 0.4752
 Site-White-2                   (1) | Train Loss: 1.2836 | Train Acc: 0.4891
 Site-White-3                   (1) | Train Loss: 1.2559 | Train Acc: 0.5100
 Site-White-4                   (1) | Train Loss: 1.2185 | Train Acc: 0.5088
 Site-Middle_Eastern-0          (1) | Train Loss: 1.3980 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (1) | Train Loss: 1.3528 | Train Acc: 0.4732
 Site-Middle_Eastern-2          (1) | Train Loss: 1.3006 | Train Acc: 0.5013
 Site-Black-0                   (3) | Train Loss: 1.4430 | Train Acc: 0.4406
 Site-Black-1                   (0) | Train Loss: 1.3703 | Train Acc: 0.4446
 Site-White_ffhq-0              (2) | Train Loss: 1.1692 | Train Acc: 0.5328
Average Train Accuracy: 0.4840
 Site-White-0                   (1) | Val  Loss: 1.5388 | Val  Acc: 0.3500
 Site-White-1                   (1) | Val  Loss: 1.3696 | Val  Acc: 0.2941
 Site-White-2                   (1) | Val  Loss: 1.5955 | Val  Acc: 0.3898
 Site-White-3                   (1) | Val  Loss: 1.3591 | Val  Acc: 0.4500
 Site-White-4                   (1) | Val  Loss: 1.4104 | Val  Acc: 0.5118
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5667 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3121 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.2968 | Val  Acc: 0.5000
 Site-Black-0                   (3) | Val  Loss: 1.6951 | Val  Acc: 0.3061
 Site-Black-1                   (0) | Val  Loss: 1.6762 | Val  Acc: 0.2892
 Site-White_ffhq-0              (2) | Val  Loss: 1.0735 | Val  Acc: 0.4872
Average Valid Accuracy: 0.4083
============ Train epoch 38 ============
cnt=[8, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-White-0                   (0) | Train Loss: 1.1855 | Train Acc: 0.5493
 Site-White-1                   (0) | Train Loss: 1.3355 | Train Acc: 0.4876
 Site-White-2                   (0) | Train Loss: 1.2896 | Train Acc: 0.5085
 Site-White-3                   (0) | Train Loss: 1.2680 | Train Acc: 0.4929
 Site-White-4                   (0) | Train Loss: 1.2134 | Train Acc: 0.4987
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5541 | Train Acc: 0.4504
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3460 | Train Acc: 0.5179
 Site-Middle_Eastern-2          (0) | Train Loss: 1.2930 | Train Acc: 0.4987
 Site-Black-0                   (2) | Train Loss: 1.3872 | Train Acc: 0.4580
 Site-Black-1                   (3) | Train Loss: 1.3414 | Train Acc: 0.4974
 Site-White_ffhq-0              (1) | Train Loss: 1.2389 | Train Acc: 0.5128
Average Train Accuracy: 0.4975
 Site-White-0                   (0) | Val  Loss: 1.5812 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3378 | Val  Acc: 0.4118
 Site-White-2                   (0) | Val  Loss: 1.6797 | Val  Acc: 0.4068
 Site-White-3                   (0) | Val  Loss: 1.2867 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.4471 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5499 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.2393 | Val  Acc: 0.5312
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3679 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.6697 | Val  Acc: 0.3265
 Site-Black-1                   (3) | Val  Loss: 1.6260 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1356 | Val  Acc: 0.5385
Average Valid Accuracy: 0.4221
============ Train epoch 39 ============
cnt=[1, 3, 2, 5, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-White-0                   (3) | Train Loss: 1.3361 | Train Acc: 0.5493
 Site-White-1                   (3) | Train Loss: 1.3535 | Train Acc: 0.4711
 Site-White-2                   (3) | Train Loss: 1.2703 | Train Acc: 0.4891
 Site-White-3                   (3) | Train Loss: 1.2378 | Train Acc: 0.5214
 Site-White-4                   (3) | Train Loss: 1.1932 | Train Acc: 0.5322
 Site-Middle_Eastern-0          (1) | Train Loss: 1.3116 | Train Acc: 0.4427
 Site-Middle_Eastern-1          (1) | Train Loss: 1.3069 | Train Acc: 0.4955
 Site-Middle_Eastern-2          (1) | Train Loss: 1.2943 | Train Acc: 0.4803
 Site-Black-0                   (2) | Train Loss: 1.4391 | Train Acc: 0.4464
 Site-Black-1                   (2) | Train Loss: 1.3721 | Train Acc: 0.4787
 Site-White_ffhq-0              (0) | Train Loss: 1.1838 | Train Acc: 0.5310
Average Train Accuracy: 0.4943
 Site-White-0                   (3) | Val  Loss: 1.6214 | Val  Acc: 0.3500
 Site-White-1                   (3) | Val  Loss: 1.3309 | Val  Acc: 0.3235
 Site-White-2                   (3) | Val  Loss: 1.5655 | Val  Acc: 0.3729
 Site-White-3                   (3) | Val  Loss: 1.3289 | Val  Acc: 0.4700
 Site-White-4                   (3) | Val  Loss: 1.4452 | Val  Acc: 0.4588
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.4782 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3619 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.3725 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.6917 | Val  Acc: 0.3061
 Site-Black-1                   (2) | Val  Loss: 1.6574 | Val  Acc: 0.3012
 Site-White_ffhq-0              (0) | Val  Loss: 1.0402 | Val  Acc: 0.5256
Average Valid Accuracy: 0.4077
 Test site-White-0                   (3)| Epoch:27 | Test Acc: 0.4048
 Test site-White-1                   (3)| Epoch:27 | Test Acc: 0.5352
 Test site-White-2                   (3)| Epoch:27 | Test Acc: 0.4370
 Test site-White-3                   (3)| Epoch:27 | Test Acc: 0.4604
 Test site-White-4                   (3)| Epoch:27 | Test Acc: 0.4257
 Test site-Middle_Eastern-0          (1)| Epoch:27 | Test Acc: 0.5128
 Test site-Middle_Eastern-1          (1)| Epoch:27 | Test Acc: 0.3385
 Test site-Middle_Eastern-2          (1)| Epoch:27 | Test Acc: 0.4364
 Test site-Black-0                   (2)| Epoch:27 | Test Acc: 0.3500
 Test site-Black-1                   (2)| Epoch:27 | Test Acc: 0.3254
 Test site-White_ffhq-0              (0)| Epoch:27 | Test Acc: 0.5000
White: 0.4526, Middle_Eastern: 0.4292, Black: 0.3377, White_ffhq: 0.5000, 
Average Test Accuracy(group): 0.4299, Average Test Accuracy(individual): 0.4296,
domain std=0.0590, cluster std=0.0590, individual std=0.0676, 
============ Train epoch 40 ============
cnt=[2, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-White-0                   (3) | Train Loss: 1.2597 | Train Acc: 0.5211
 Site-White-1                   (3) | Train Loss: 1.3132 | Train Acc: 0.4711
 Site-White-2                   (3) | Train Loss: 1.2635 | Train Acc: 0.4964
 Site-White-3                   (3) | Train Loss: 1.2449 | Train Acc: 0.5128
 Site-White-4                   (3) | Train Loss: 1.2067 | Train Acc: 0.5213
 Site-Middle_Eastern-0          (1) | Train Loss: 1.4708 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (1) | Train Loss: 1.2882 | Train Acc: 0.4911
 Site-Middle_Eastern-2          (3) | Train Loss: 1.2824 | Train Acc: 0.4987
 Site-Black-0                   (0) | Train Loss: 1.3989 | Train Acc: 0.4580
 Site-Black-1                   (0) | Train Loss: 1.3375 | Train Acc: 0.4872
 Site-White_ffhq-0              (2) | Train Loss: 1.2279 | Train Acc: 0.5073
Average Train Accuracy: 0.4902
 Site-White-0                   (3) | Val  Loss: 1.4438 | Val  Acc: 0.3500
 Site-White-1                   (3) | Val  Loss: 1.3004 | Val  Acc: 0.4412
 Site-White-2                   (3) | Val  Loss: 1.6349 | Val  Acc: 0.3559
 Site-White-3                   (3) | Val  Loss: 1.3080 | Val  Acc: 0.4700
 Site-White-4                   (3) | Val  Loss: 1.4099 | Val  Acc: 0.5000
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.3350 | Val  Acc: 0.6111
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3319 | Val  Acc: 0.5000
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3837 | Val  Acc: 0.3889
 Site-Black-0                   (0) | Val  Loss: 1.6855 | Val  Acc: 0.3469
 Site-Black-1                   (0) | Val  Loss: 1.6456 | Val  Acc: 0.2651
 Site-White_ffhq-0              (2) | Val  Loss: 1.0626 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4299
 Test site-White-0                   (3)| Epoch:27 | Test Acc: 0.4286
 Test site-White-1                   (3)| Epoch:27 | Test Acc: 0.4648
 Test site-White-2                   (3)| Epoch:27 | Test Acc: 0.4370
 Test site-White-3                   (3)| Epoch:27 | Test Acc: 0.4703
 Test site-White-4                   (3)| Epoch:27 | Test Acc: 0.4548
 Test site-Middle_Eastern-0          (1)| Epoch:27 | Test Acc: 0.3846
 Test site-Middle_Eastern-1          (1)| Epoch:27 | Test Acc: 0.3077
 Test site-Middle_Eastern-2          (3)| Epoch:27 | Test Acc: 0.4182
 Test site-Black-0                   (0)| Epoch:27 | Test Acc: 0.4100
 Test site-Black-1                   (0)| Epoch:27 | Test Acc: 0.3905
 Test site-White_ffhq-0              (2)| Epoch:27 | Test Acc: 0.5000
White: 0.4511, Middle_Eastern: 0.3702, Black: 0.4003, White_ffhq: 0.5000, 
Average Test Accuracy(group): 0.4304, Average Test Accuracy(individual): 0.4242,
domain std=0.0495, cluster std=0.0567, individual std=0.0497, 
Average Test Accuracy: 0.4304
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 41 ============
cnt=[6, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-White-0                   (3) | Train Loss: 1.2963 | Train Acc: 0.5141
 Site-White-1                   (0) | Train Loss: 1.3250 | Train Acc: 0.4711
 Site-White-2                   (3) | Train Loss: 1.2890 | Train Acc: 0.4939
 Site-White-3                   (0) | Train Loss: 1.2323 | Train Acc: 0.5256
 Site-White-4                   (0) | Train Loss: 1.1916 | Train Acc: 0.5155
 Site-Middle_Eastern-0          (0) | Train Loss: 1.2292 | Train Acc: 0.4427
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3347 | Train Acc: 0.4911
 Site-Middle_Eastern-2          (0) | Train Loss: 1.2871 | Train Acc: 0.4961
 Site-Black-0                   (2) | Train Loss: 1.3744 | Train Acc: 0.4899
 Site-Black-1                   (2) | Train Loss: 1.3587 | Train Acc: 0.4838
 Site-White_ffhq-0              (1) | Train Loss: 1.2291 | Train Acc: 0.5201
Average Train Accuracy: 0.4949
 Site-White-0                   (3) | Val  Loss: 1.5574 | Val  Acc: 0.5000
 Site-White-1                   (0) | Val  Loss: 1.3416 | Val  Acc: 0.2941
 Site-White-2                   (3) | Val  Loss: 1.6030 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.3222 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.4500 | Val  Acc: 0.4706
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5160 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3706 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3789 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.6502 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.6840 | Val  Acc: 0.2651
 Site-White_ffhq-0              (1) | Val  Loss: 1.0773 | Val  Acc: 0.5256
Average Valid Accuracy: 0.4045
 Test site-White-0                   (3)| Epoch:40 | Test Acc: 0.4048
 Test site-White-1                   (0)| Epoch:40 | Test Acc: 0.4930
 Test site-White-2                   (3)| Epoch:40 | Test Acc: 0.3866
 Test site-White-3                   (0)| Epoch:40 | Test Acc: 0.4455
 Test site-White-4                   (0)| Epoch:40 | Test Acc: 0.4519
 Test site-Middle_Eastern-0          (0)| Epoch:40 | Test Acc: 0.4359
 Test site-Middle_Eastern-1          (0)| Epoch:40 | Test Acc: 0.3385
 Test site-Middle_Eastern-2          (0)| Epoch:40 | Test Acc: 0.4455
 Test site-Black-0                   (2)| Epoch:40 | Test Acc: 0.3900
 Test site-Black-1                   (2)| Epoch:40 | Test Acc: 0.3669
 Test site-White_ffhq-0              (1)| Epoch:40 | Test Acc: 0.5506
White: 0.4363, Middle_Eastern: 0.4066, Black: 0.3784, White_ffhq: 0.5506, 
Average Test Accuracy(group): 0.4430, Average Test Accuracy(individual): 0.4281,
domain std=0.0654, cluster std=0.0671, individual std=0.0572, 
Average Test Accuracy: 0.4430
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-White-0                   (0) | Train Loss: 1.2396 | Train Acc: 0.5141
 Site-White-1                   (0) | Train Loss: 1.3272 | Train Acc: 0.4669
 Site-White-2                   (0) | Train Loss: 1.2543 | Train Acc: 0.4843
 Site-White-3                   (0) | Train Loss: 1.2289 | Train Acc: 0.5228
 Site-White-4                   (0) | Train Loss: 1.1970 | Train Acc: 0.5180
 Site-Middle_Eastern-0          (3) | Train Loss: 1.3491 | Train Acc: 0.4504
 Site-Middle_Eastern-1          (3) | Train Loss: 1.2932 | Train Acc: 0.5179
 Site-Middle_Eastern-2          (3) | Train Loss: 1.2797 | Train Acc: 0.5039
 Site-Black-0                   (2) | Train Loss: 1.4069 | Train Acc: 0.4754
 Site-Black-1                   (2) | Train Loss: 1.3451 | Train Acc: 0.5043
 Site-White_ffhq-0              (1) | Train Loss: 1.2312 | Train Acc: 0.5292
Average Train Accuracy: 0.4988
 Site-White-0                   (0) | Val  Loss: 1.6249 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3021 | Val  Acc: 0.2941
 Site-White-2                   (0) | Val  Loss: 1.6344 | Val  Acc: 0.3729
 Site-White-3                   (0) | Val  Loss: 1.3088 | Val  Acc: 0.4700
 Site-White-4                   (0) | Val  Loss: 1.4170 | Val  Acc: 0.4765
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.4326 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3794 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3251 | Val  Acc: 0.4630
 Site-Black-0                   (2) | Val  Loss: 1.7119 | Val  Acc: 0.3469
 Site-Black-1                   (2) | Val  Loss: 1.6583 | Val  Acc: 0.3012
 Site-White_ffhq-0              (1) | Val  Loss: 1.0693 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4095
 Test site-White-0                   (0)| Epoch:41 | Test Acc: 0.3810
 Test site-White-1                   (0)| Epoch:41 | Test Acc: 0.4930
 Test site-White-2                   (0)| Epoch:41 | Test Acc: 0.4370
 Test site-White-3                   (0)| Epoch:41 | Test Acc: 0.4752
 Test site-White-4                   (0)| Epoch:41 | Test Acc: 0.4781
 Test site-Middle_Eastern-0          (3)| Epoch:41 | Test Acc: 0.4359
 Test site-Middle_Eastern-1          (3)| Epoch:41 | Test Acc: 0.3385
 Test site-Middle_Eastern-2          (3)| Epoch:41 | Test Acc: 0.4455
 Test site-Black-0                   (2)| Epoch:41 | Test Acc: 0.4000
 Test site-Black-1                   (2)| Epoch:41 | Test Acc: 0.3728
 Test site-White_ffhq-0              (1)| Epoch:41 | Test Acc: 0.5316
White: 0.4529, Middle_Eastern: 0.4066, Black: 0.3864, White_ffhq: 0.5316, 
Average Test Accuracy(group): 0.4444, Average Test Accuracy(individual): 0.4353,
domain std=0.0558, cluster std=0.0558, individual std=0.0553, 
Average Test Accuracy: 0.4444
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 2, 7, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-White-0                   (0) | Train Loss: 1.2819 | Train Acc: 0.5634
 Site-White-1                   (2) | Train Loss: 1.3129 | Train Acc: 0.4793
 Site-White-2                   (2) | Train Loss: 1.2615 | Train Acc: 0.4843
 Site-White-3                   (2) | Train Loss: 1.2365 | Train Acc: 0.5299
 Site-White-4                   (2) | Train Loss: 1.1890 | Train Acc: 0.5364
 Site-Middle_Eastern-0          (2) | Train Loss: 1.2092 | Train Acc: 0.4580
 Site-Middle_Eastern-1          (2) | Train Loss: 1.2785 | Train Acc: 0.5357
 Site-Middle_Eastern-2          (2) | Train Loss: 1.2733 | Train Acc: 0.5066
 Site-Black-0                   (1) | Train Loss: 1.3689 | Train Acc: 0.4957
 Site-Black-1                   (1) | Train Loss: 1.3282 | Train Acc: 0.4736
 Site-White_ffhq-0              (3) | Train Loss: 1.2089 | Train Acc: 0.5365
Average Train Accuracy: 0.5090
 Site-White-0                   (0) | Val  Loss: 1.5068 | Val  Acc: 0.3500
 Site-White-1                   (2) | Val  Loss: 1.3437 | Val  Acc: 0.3235
 Site-White-2                   (2) | Val  Loss: 1.5745 | Val  Acc: 0.3559
 Site-White-3                   (2) | Val  Loss: 1.3012 | Val  Acc: 0.4500
 Site-White-4                   (2) | Val  Loss: 1.4278 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (2) | Val  Loss: 1.4729 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (2) | Val  Loss: 1.3506 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (2) | Val  Loss: 1.3072 | Val  Acc: 0.4630
 Site-Black-0                   (1) | Val  Loss: 1.6417 | Val  Acc: 0.4286
 Site-Black-1                   (1) | Val  Loss: 1.6546 | Val  Acc: 0.3133
 Site-White_ffhq-0              (3) | Val  Loss: 1.1494 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4168
 Test site-White-0                   (0)| Epoch:42 | Test Acc: 0.3571
 Test site-White-1                   (2)| Epoch:42 | Test Acc: 0.4930
 Test site-White-2                   (2)| Epoch:42 | Test Acc: 0.4538
 Test site-White-3                   (2)| Epoch:42 | Test Acc: 0.4653
 Test site-White-4                   (2)| Epoch:42 | Test Acc: 0.4286
 Test site-Middle_Eastern-0          (2)| Epoch:42 | Test Acc: 0.4359
 Test site-Middle_Eastern-1          (2)| Epoch:42 | Test Acc: 0.3077
 Test site-Middle_Eastern-2          (2)| Epoch:42 | Test Acc: 0.4727
 Test site-Black-0                   (1)| Epoch:42 | Test Acc: 0.3600
 Test site-Black-1                   (1)| Epoch:42 | Test Acc: 0.3609
 Test site-White_ffhq-0              (3)| Epoch:42 | Test Acc: 0.5316
White: 0.4396, Middle_Eastern: 0.4054, Black: 0.3605, White_ffhq: 0.5316, 
Average Test Accuracy(group): 0.4343, Average Test Accuracy(individual): 0.4242,
domain std=0.0628, cluster std=0.0711, individual std=0.0657, 
Average Test Accuracy: 0.4343
============ Train epoch 44 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-White-0                   (0) | Train Loss: 1.2317 | Train Acc: 0.5141
 Site-White-1                   (0) | Train Loss: 1.3218 | Train Acc: 0.4752
 Site-White-2                   (0) | Train Loss: 1.2568 | Train Acc: 0.4697
 Site-White-3                   (0) | Train Loss: 1.2477 | Train Acc: 0.5271
 Site-White-4                   (0) | Train Loss: 1.2055 | Train Acc: 0.5121
 Site-Middle_Eastern-0          (3) | Train Loss: 1.3589 | Train Acc: 0.4733
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3283 | Train Acc: 0.4866
 Site-Middle_Eastern-2          (3) | Train Loss: 1.3074 | Train Acc: 0.4829
 Site-Black-0                   (2) | Train Loss: 1.3946 | Train Acc: 0.4754
 Site-Black-1                   (2) | Train Loss: 1.2957 | Train Acc: 0.5128
 Site-White_ffhq-0              (1) | Train Loss: 1.2251 | Train Acc: 0.5146
Average Train Accuracy: 0.4949
 Site-White-0                   (0) | Val  Loss: 1.5874 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.3477 | Val  Acc: 0.4118
 Site-White-2                   (0) | Val  Loss: 1.5669 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.3536 | Val  Acc: 0.4400
 Site-White-4                   (0) | Val  Loss: 1.4429 | Val  Acc: 0.4706
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5173 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3858 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3656 | Val  Acc: 0.4259
 Site-Black-0                   (2) | Val  Loss: 1.6475 | Val  Acc: 0.3265
 Site-Black-1                   (2) | Val  Loss: 1.6310 | Val  Acc: 0.2892
 Site-White_ffhq-0              (1) | Val  Loss: 1.0797 | Val  Acc: 0.5641
Average Valid Accuracy: 0.4220
 Test site-White-0                   (0)| Epoch:42 | Test Acc: 0.3810
 Test site-White-1                   (0)| Epoch:42 | Test Acc: 0.5070
 Test site-White-2                   (0)| Epoch:42 | Test Acc: 0.4286
 Test site-White-3                   (0)| Epoch:42 | Test Acc: 0.4455
 Test site-White-4                   (0)| Epoch:42 | Test Acc: 0.4519
 Test site-Middle_Eastern-0          (3)| Epoch:42 | Test Acc: 0.4615
 Test site-Middle_Eastern-1          (3)| Epoch:42 | Test Acc: 0.3692
 Test site-Middle_Eastern-2          (3)| Epoch:42 | Test Acc: 0.4182
 Test site-Black-0                   (2)| Epoch:42 | Test Acc: 0.3500
 Test site-Black-1                   (2)| Epoch:42 | Test Acc: 0.3905
 Test site-White_ffhq-0              (1)| Epoch:42 | Test Acc: 0.5127
White: 0.4428, Middle_Eastern: 0.4163, Black: 0.3703, White_ffhq: 0.5127, 
Average Test Accuracy(group): 0.4355, Average Test Accuracy(individual): 0.4287,
domain std=0.0516, cluster std=0.0516, individual std=0.0510, 
Average Test Accuracy: 0.4355
============ Train epoch 45 ============
cnt=[1, 8, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-White-0                   (1) | Train Loss: 1.1751 | Train Acc: 0.5634
 Site-White-1                   (1) | Train Loss: 1.2823 | Train Acc: 0.5000
 Site-White-2                   (1) | Train Loss: 1.2802 | Train Acc: 0.4939
 Site-White-3                   (1) | Train Loss: 1.2437 | Train Acc: 0.5299
 Site-White-4                   (1) | Train Loss: 1.1872 | Train Acc: 0.5205
 Site-Middle_Eastern-0          (1) | Train Loss: 1.2801 | Train Acc: 0.4580
 Site-Middle_Eastern-1          (1) | Train Loss: 1.2843 | Train Acc: 0.5580
 Site-Middle_Eastern-2          (1) | Train Loss: 1.2906 | Train Acc: 0.4961
 Site-Black-0                   (2) | Train Loss: 1.3803 | Train Acc: 0.4609
 Site-Black-1                   (3) | Train Loss: 1.2981 | Train Acc: 0.4770
 Site-White_ffhq-0              (0) | Train Loss: 1.1775 | Train Acc: 0.5237
Average Train Accuracy: 0.5074
 Site-White-0                   (1) | Val  Loss: 1.6103 | Val  Acc: 0.4000
 Site-White-1                   (1) | Val  Loss: 1.3272 | Val  Acc: 0.3235
 Site-White-2                   (1) | Val  Loss: 1.5634 | Val  Acc: 0.3729
 Site-White-3                   (1) | Val  Loss: 1.3393 | Val  Acc: 0.4000
 Site-White-4                   (1) | Val  Loss: 1.4438 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.4114 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3808 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.3490 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.6899 | Val  Acc: 0.3878
 Site-Black-1                   (3) | Val  Loss: 1.6785 | Val  Acc: 0.3253
 Site-White_ffhq-0              (0) | Val  Loss: 1.0878 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4187
 Test site-White-0                   (1)| Epoch:42 | Test Acc: 0.3810
 Test site-White-1                   (1)| Epoch:42 | Test Acc: 0.5211
 Test site-White-2                   (1)| Epoch:42 | Test Acc: 0.4874
 Test site-White-3                   (1)| Epoch:42 | Test Acc: 0.4406
 Test site-White-4                   (1)| Epoch:42 | Test Acc: 0.4548
 Test site-Middle_Eastern-0          (1)| Epoch:42 | Test Acc: 0.3590
 Test site-Middle_Eastern-1          (1)| Epoch:42 | Test Acc: 0.3385
 Test site-Middle_Eastern-2          (1)| Epoch:42 | Test Acc: 0.4364
 Test site-Black-0                   (2)| Epoch:42 | Test Acc: 0.3700
 Test site-Black-1                   (3)| Epoch:42 | Test Acc: 0.3609
 Test site-White_ffhq-0              (0)| Epoch:42 | Test Acc: 0.5316
White: 0.4570, Middle_Eastern: 0.3779, Black: 0.3655, White_ffhq: 0.5316, 
Average Test Accuracy(group): 0.4330, Average Test Accuracy(individual): 0.4256,
domain std=0.0669, cluster std=0.0680, individual std=0.0651, 
Average Test Accuracy: 0.4330
============ Train epoch 46 ============
cnt=[2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-White-0                   (1) | Train Loss: 1.1719 | Train Acc: 0.5493
 Site-White-1                   (1) | Train Loss: 1.3062 | Train Acc: 0.4711
 Site-White-2                   (1) | Train Loss: 1.2401 | Train Acc: 0.5061
 Site-White-3                   (1) | Train Loss: 1.2130 | Train Acc: 0.5399
 Site-White-4                   (1) | Train Loss: 1.1822 | Train Acc: 0.5222
 Site-Middle_Eastern-0          (3) | Train Loss: 1.2218 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3043 | Train Acc: 0.5089
 Site-Middle_Eastern-2          (3) | Train Loss: 1.2925 | Train Acc: 0.5013
 Site-Black-0                   (0) | Train Loss: 1.3853 | Train Acc: 0.4928
 Site-Black-1                   (0) | Train Loss: 1.2749 | Train Acc: 0.5281
 Site-White_ffhq-0              (2) | Train Loss: 1.1968 | Train Acc: 0.5365
Average Train Accuracy: 0.5062
 Site-White-0                   (1) | Val  Loss: 1.6609 | Val  Acc: 0.3000
 Site-White-1                   (1) | Val  Loss: 1.3265 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.6100 | Val  Acc: 0.3729
 Site-White-3                   (1) | Val  Loss: 1.3565 | Val  Acc: 0.4900
 Site-White-4                   (1) | Val  Loss: 1.4628 | Val  Acc: 0.4235
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5647 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.3648 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3118 | Val  Acc: 0.3704
 Site-Black-0                   (0) | Val  Loss: 1.6530 | Val  Acc: 0.3469
 Site-Black-1                   (0) | Val  Loss: 1.6503 | Val  Acc: 0.2530
 Site-White_ffhq-0              (2) | Val  Loss: 1.0834 | Val  Acc: 0.4359
Average Valid Accuracy: 0.3872
 Test site-White-0                   (1)| Epoch:42 | Test Acc: 0.4524
 Test site-White-1                   (1)| Epoch:42 | Test Acc: 0.5352
 Test site-White-2                   (1)| Epoch:42 | Test Acc: 0.4202
 Test site-White-3                   (1)| Epoch:42 | Test Acc: 0.4505
 Test site-White-4                   (1)| Epoch:42 | Test Acc: 0.4723
 Test site-Middle_Eastern-0          (3)| Epoch:42 | Test Acc: 0.3590
 Test site-Middle_Eastern-1          (3)| Epoch:42 | Test Acc: 0.3077
 Test site-Middle_Eastern-2          (3)| Epoch:42 | Test Acc: 0.4091
 Test site-Black-0                   (0)| Epoch:42 | Test Acc: 0.3600
 Test site-Black-1                   (0)| Epoch:42 | Test Acc: 0.3669
 Test site-White_ffhq-0              (2)| Epoch:42 | Test Acc: 0.5380
White: 0.4661, Middle_Eastern: 0.3586, Black: 0.3634, White_ffhq: 0.5380, 
Average Test Accuracy(group): 0.4315, Average Test Accuracy(individual): 0.4247,
domain std=0.0750, cluster std=0.0750, individual std=0.0704, 
Average Test Accuracy: 0.4315
============ Train epoch 47 ============
cnt=[3, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-White-0                   (3) | Train Loss: 1.1656 | Train Acc: 0.5211
 Site-White-1                   (3) | Train Loss: 1.3256 | Train Acc: 0.4876
 Site-White-2                   (3) | Train Loss: 1.2290 | Train Acc: 0.4891
 Site-White-3                   (3) | Train Loss: 1.2042 | Train Acc: 0.5342
 Site-White-4                   (3) | Train Loss: 1.1813 | Train Acc: 0.5314
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4227 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3245 | Train Acc: 0.5000
 Site-Middle_Eastern-2          (0) | Train Loss: 1.2872 | Train Acc: 0.4908
 Site-Black-0                   (2) | Train Loss: 1.3796 | Train Acc: 0.4725
 Site-Black-1                   (2) | Train Loss: 1.3109 | Train Acc: 0.4821
 Site-White_ffhq-0              (1) | Train Loss: 1.1732 | Train Acc: 0.5401
Average Train Accuracy: 0.4979
 Site-White-0                   (3) | Val  Loss: 1.5320 | Val  Acc: 0.3500
 Site-White-1                   (3) | Val  Loss: 1.3852 | Val  Acc: 0.3824
 Site-White-2                   (3) | Val  Loss: 1.5783 | Val  Acc: 0.3898
 Site-White-3                   (3) | Val  Loss: 1.2955 | Val  Acc: 0.4800
 Site-White-4                   (3) | Val  Loss: 1.4391 | Val  Acc: 0.4706
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4766 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3422 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3401 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.7022 | Val  Acc: 0.3265
 Site-Black-1                   (2) | Val  Loss: 1.6521 | Val  Acc: 0.2892
 Site-White_ffhq-0              (1) | Val  Loss: 1.0431 | Val  Acc: 0.4872
Average Valid Accuracy: 0.4104
 Test site-White-0                   (3)| Epoch:42 | Test Acc: 0.4048
 Test site-White-1                   (3)| Epoch:42 | Test Acc: 0.5070
 Test site-White-2                   (3)| Epoch:42 | Test Acc: 0.4622
 Test site-White-3                   (3)| Epoch:42 | Test Acc: 0.4554
 Test site-White-4                   (3)| Epoch:42 | Test Acc: 0.4869
 Test site-Middle_Eastern-0          (0)| Epoch:42 | Test Acc: 0.3590
 Test site-Middle_Eastern-1          (0)| Epoch:42 | Test Acc: 0.2923
 Test site-Middle_Eastern-2          (0)| Epoch:42 | Test Acc: 0.4182
 Test site-Black-0                   (2)| Epoch:42 | Test Acc: 0.3000
 Test site-Black-1                   (2)| Epoch:42 | Test Acc: 0.3669
 Test site-White_ffhq-0              (1)| Epoch:42 | Test Acc: 0.5633
White: 0.4633, Middle_Eastern: 0.3565, Black: 0.3334, White_ffhq: 0.5633, 
Average Test Accuracy(group): 0.4291, Average Test Accuracy(individual): 0.4196,
domain std=0.0917, cluster std=0.0917, individual std=0.0815, 
Average Test Accuracy: 0.4291
============ Train epoch 48 ============
cnt=[2, 3, 1, 5, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-White-0                   (3) | Train Loss: 1.3187 | Train Acc: 0.5352
 Site-White-1                   (3) | Train Loss: 1.2998 | Train Acc: 0.5041
 Site-White-2                   (3) | Train Loss: 1.2334 | Train Acc: 0.4891
 Site-White-3                   (3) | Train Loss: 1.2355 | Train Acc: 0.5256
 Site-White-4                   (3) | Train Loss: 1.1988 | Train Acc: 0.5280
 Site-Middle_Eastern-0          (1) | Train Loss: 1.1669 | Train Acc: 0.4733
 Site-Middle_Eastern-1          (1) | Train Loss: 1.2563 | Train Acc: 0.5089
 Site-Middle_Eastern-2          (1) | Train Loss: 1.2794 | Train Acc: 0.4672
 Site-Black-0                   (0) | Train Loss: 1.3758 | Train Acc: 0.4812
 Site-Black-1                   (0) | Train Loss: 1.3262 | Train Acc: 0.5111
 Site-White_ffhq-0              (2) | Train Loss: 1.2279 | Train Acc: 0.5219
Average Train Accuracy: 0.5042
 Site-White-0                   (3) | Val  Loss: 1.4928 | Val  Acc: 0.4000
 Site-White-1                   (3) | Val  Loss: 1.2708 | Val  Acc: 0.4412
 Site-White-2                   (3) | Val  Loss: 1.6367 | Val  Acc: 0.3898
 Site-White-3                   (3) | Val  Loss: 1.3255 | Val  Acc: 0.4400
 Site-White-4                   (3) | Val  Loss: 1.4171 | Val  Acc: 0.4706
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.3890 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3425 | Val  Acc: 0.5312
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.3818 | Val  Acc: 0.3704
 Site-Black-0                   (0) | Val  Loss: 1.7023 | Val  Acc: 0.3265
 Site-Black-1                   (0) | Val  Loss: 1.7174 | Val  Acc: 0.3133
 Site-White_ffhq-0              (2) | Val  Loss: 1.1142 | Val  Acc: 0.4872
Average Valid Accuracy: 0.4246
 Test site-White-0                   (3)| Epoch:42 | Test Acc: 0.3810
 Test site-White-1                   (3)| Epoch:42 | Test Acc: 0.5211
 Test site-White-2                   (3)| Epoch:42 | Test Acc: 0.4958
 Test site-White-3                   (3)| Epoch:42 | Test Acc: 0.4406
 Test site-White-4                   (3)| Epoch:42 | Test Acc: 0.4898
 Test site-Middle_Eastern-0          (1)| Epoch:42 | Test Acc: 0.3846
 Test site-Middle_Eastern-1          (1)| Epoch:42 | Test Acc: 0.3385
 Test site-Middle_Eastern-2          (1)| Epoch:42 | Test Acc: 0.4273
 Test site-Black-0                   (0)| Epoch:42 | Test Acc: 0.3800
 Test site-Black-1                   (0)| Epoch:42 | Test Acc: 0.3550
 Test site-White_ffhq-0              (2)| Epoch:42 | Test Acc: 0.5380
White: 0.4657, Middle_Eastern: 0.3834, Black: 0.3675, White_ffhq: 0.5380, 
Average Test Accuracy(group): 0.4386, Average Test Accuracy(individual): 0.4320,
domain std=0.0684, cluster std=0.0684, individual std=0.0667, 
Average Test Accuracy: 0.4386
============ Train epoch 49 ============
cnt=[2, 3, 1, 5, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-White-0                   (1) | Train Loss: 1.2555 | Train Acc: 0.5141
 Site-White-1                   (1) | Train Loss: 1.3010 | Train Acc: 0.4752
 Site-White-2                   (3) | Train Loss: 1.2365 | Train Acc: 0.4867
 Site-White-3                   (1) | Train Loss: 1.2108 | Train Acc: 0.5214
 Site-White-4                   (3) | Train Loss: 1.1832 | Train Acc: 0.5305
 Site-Middle_Eastern-0          (3) | Train Loss: 1.5271 | Train Acc: 0.4885
 Site-Middle_Eastern-1          (3) | Train Loss: 1.3201 | Train Acc: 0.5000
 Site-Middle_Eastern-2          (3) | Train Loss: 1.2597 | Train Acc: 0.5066
 Site-Black-0                   (0) | Train Loss: 1.3580 | Train Acc: 0.4638
 Site-Black-1                   (0) | Train Loss: 1.3352 | Train Acc: 0.4804
 Site-White_ffhq-0              (2) | Train Loss: 1.2482 | Train Acc: 0.5128
Average Train Accuracy: 0.4982
 Site-White-0                   (1) | Val  Loss: 1.5819 | Val  Acc: 0.3000
 Site-White-1                   (1) | Val  Loss: 1.2939 | Val  Acc: 0.4412
 Site-White-2                   (3) | Val  Loss: 1.5938 | Val  Acc: 0.3729
 Site-White-3                   (1) | Val  Loss: 1.3369 | Val  Acc: 0.4500
 Site-White-4                   (3) | Val  Loss: 1.4102 | Val  Acc: 0.4824
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5805 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.2943 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.3363 | Val  Acc: 0.4259
 Site-Black-0                   (0) | Val  Loss: 1.7162 | Val  Acc: 0.3061
 Site-Black-1                   (0) | Val  Loss: 1.6842 | Val  Acc: 0.2530
 Site-White_ffhq-0              (2) | Val  Loss: 1.1173 | Val  Acc: 0.5128
Average Valid Accuracy: 0.4052
 Test site-White-0                   (1)| Epoch:42 | Test Acc: 0.4286
 Test site-White-1                   (1)| Epoch:42 | Test Acc: 0.4930
 Test site-White-2                   (3)| Epoch:42 | Test Acc: 0.4790
 Test site-White-3                   (1)| Epoch:42 | Test Acc: 0.4802
 Test site-White-4                   (3)| Epoch:42 | Test Acc: 0.4606
 Test site-Middle_Eastern-0          (3)| Epoch:42 | Test Acc: 0.4103
 Test site-Middle_Eastern-1          (3)| Epoch:42 | Test Acc: 0.3538
 Test site-Middle_Eastern-2          (3)| Epoch:42 | Test Acc: 0.4545
 Test site-Black-0                   (0)| Epoch:42 | Test Acc: 0.3400
 Test site-Black-1                   (0)| Epoch:42 | Test Acc: 0.3609
 Test site-White_ffhq-0              (2)| Epoch:42 | Test Acc: 0.5506
White: 0.4683, Middle_Eastern: 0.4062, Black: 0.3505, White_ffhq: 0.5506, 
Average Test Accuracy(group): 0.4439, Average Test Accuracy(individual): 0.4374,
domain std=0.0744, cluster std=0.0719, individual std=0.0628, 
Average Test Accuracy: 0.4439
 Test site-White-0                   (1)| Epoch:42 | Test Acc: 0.4048
 Test site-White-1                   (1)| Epoch:42 | Test Acc: 0.4930
 Test site-White-2                   (3)| Epoch:42 | Test Acc: 0.4538
 Test site-White-3                   (1)| Epoch:42 | Test Acc: 0.4851
 Test site-White-4                   (3)| Epoch:42 | Test Acc: 0.4548
 Test site-Middle_Eastern-0          (3)| Epoch:42 | Test Acc: 0.4872
 Test site-Middle_Eastern-1          (3)| Epoch:42 | Test Acc: 0.3538
 Test site-Middle_Eastern-2          (3)| Epoch:42 | Test Acc: 0.4273
 Test site-Black-0                   (0)| Epoch:42 | Test Acc: 0.4100
 Test site-Black-1                   (0)| Epoch:42 | Test Acc: 0.3964
 Test site-White_ffhq-0              (2)| Epoch:42 | Test Acc: 0.5380
White: 0.4583, Middle_Eastern: 0.4228, Black: 0.4032, White_ffhq: 0.5380, 
Average Test Accuracy(group): 0.4556, Average Test Accuracy(individual): 0.4458,
domain std=0.0515, cluster std=0.0498, individual std=0.0507, 
===2023-06-16 08:24:21===
===2023-06-16 08:24:36===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = 4
Loading snapshots...
 Test site-White-0                   (0)| Epoch:42 | Test Acc: 0.4286
 Test site-White-1                   (0)| Epoch:42 | Test Acc: 0.5211
 Test site-White-2                   (0)| Epoch:42 | Test Acc: 0.4370
 Test site-White-3                   (0)| Epoch:42 | Test Acc: 0.4653
 Test site-White-4                   (0)| Epoch:42 | Test Acc: 0.4781
 Test site-Middle_Eastern-0          (3)| Epoch:42 | Test Acc: 0.4103
 Test site-Middle_Eastern-1          (3)| Epoch:42 | Test Acc: 0.3538
 Test site-Middle_Eastern-2          (3)| Epoch:42 | Test Acc: 0.4091
 Test site-Black-0                   (2)| Epoch:42 | Test Acc: 0.3500
 Test site-Black-1                   (2)| Epoch:42 | Test Acc: 0.3550
 Test site-White_ffhq-0              (1)| Epoch:42 | Test Acc: 0.5253
White: 0.4660, Middle_Eastern: 0.3911, Black: 0.3525, White_ffhq: 0.5253, 
Average Test Accuracy(group): 0.4337, Average Test Accuracy(individual): 0.4303,
domain std=0.0668, cluster std=0.0668, individual std=0.0600, 
===2023-06-16 12:10:25===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[72,124,211,359,612,131,224,381,176,301,281,]
client_nums=[5,3,2,1,]
len_dataset=[3952,2112,1367,804,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk-0               (1) | Train Loss: 2.3117 | Train Acc: 0.0972
 Site-White_utk-1               (2) | Train Loss: 2.2746 | Train Acc: 0.1129
 Site-White_utk-2               (2) | Train Loss: 2.2209 | Train Acc: 0.1232
 Site-White_utk-3               (2) | Train Loss: 2.2016 | Train Acc: 0.1198
 Site-White_utk-4               (2) | Train Loss: 2.2324 | Train Acc: 0.1389
 Site-Middle_Eastern-0          (0) | Train Loss: 2.0501 | Train Acc: 0.2672
 Site-Middle_Eastern-1          (0) | Train Loss: 1.9663 | Train Acc: 0.2723
 Site-Middle_Eastern-2          (0) | Train Loss: 1.9534 | Train Acc: 0.2887
 Site-Black-0                   (3) | Train Loss: 2.0855 | Train Acc: 0.2330
 Site-Black-1                   (3) | Train Loss: 2.0678 | Train Acc: 0.2525
 Site-White-0                   (0) | Train Loss: 1.8445 | Train Acc: 0.3594
Average Train Accuracy: 0.2059
 Site-White_utk-0               (1) | Val  Loss: 2.2809 | Val  Acc: 0.1000
 Site-White_utk-1               (2) | Val  Loss: 2.1555 | Val  Acc: 0.0588
 Site-White_utk-2               (2) | Val  Loss: 2.3022 | Val  Acc: 0.1333
 Site-White_utk-3               (2) | Val  Loss: 2.2338 | Val  Acc: 0.1569
 Site-White_utk-4               (2) | Val  Loss: 2.3057 | Val  Acc: 0.0920
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6751 | Val  Acc: 0.2778
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.8130 | Val  Acc: 0.2500
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.9059 | Val  Acc: 0.2407
 Site-Black-0                   (3) | Val  Loss: 2.0472 | Val  Acc: 0.2400
 Site-Black-1                   (3) | Val  Loss: 2.1057 | Val  Acc: 0.3023
 Site-White-0                   (0) | Val  Loss: 1.9501 | Val  Acc: 0.3250
Average Valid Accuracy: 0.1979
 Best site-White_utk-0              (1)  | Epoch:0 | Val Acc: 0.1000
 Best site-White_utk-1              (2)  | Epoch:0 | Val Acc: 0.0588
 Best site-White_utk-2              (2)  | Epoch:0 | Val Acc: 0.1333
 Best site-White_utk-3              (2)  | Epoch:0 | Val Acc: 0.1569
 Best site-White_utk-4              (2)  | Epoch:0 | Val Acc: 0.0920
 Best site-Middle_Eastern-0         (0)  | Epoch:0 | Val Acc: 0.2778
 Best site-Middle_Eastern-1         (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-Middle_Eastern-2         (0)  | Epoch:0 | Val Acc: 0.2407
 Best site-Black-0                  (3)  | Epoch:0 | Val Acc: 0.2400
 Best site-Black-1                  (3)  | Epoch:0 | Val Acc: 0.3023
 Best site-White-0                  (0)  | Epoch:0 | Val Acc: 0.3250
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 1 ============
cnt=[4, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk-0               (3) | Train Loss: 1.9865 | Train Acc: 0.1944
 Site-White_utk-1               (0) | Train Loss: 2.0315 | Train Acc: 0.2097
 Site-White_utk-2               (0) | Train Loss: 2.0316 | Train Acc: 0.2180
 Site-White_utk-3               (0) | Train Loss: 2.0087 | Train Acc: 0.2591
 Site-White_utk-4               (0) | Train Loss: 2.0015 | Train Acc: 0.2484
 Site-Middle_Eastern-0          (1) | Train Loss: 1.9634 | Train Acc: 0.2672
 Site-Middle_Eastern-1          (1) | Train Loss: 1.9657 | Train Acc: 0.3036
 Site-Middle_Eastern-2          (1) | Train Loss: 1.9645 | Train Acc: 0.2861
 Site-Black-0                   (2) | Train Loss: 2.0531 | Train Acc: 0.2159
 Site-Black-1                   (2) | Train Loss: 2.0371 | Train Acc: 0.2791
 Site-White-0                   (1) | Train Loss: 1.9480 | Train Acc: 0.3772
Average Train Accuracy: 0.2599
 Site-White_utk-0               (3) | Val  Loss: 2.0492 | Val  Acc: 0.2000
 Site-White_utk-1               (0) | Val  Loss: 1.9254 | Val  Acc: 0.1765
 Site-White_utk-2               (0) | Val  Loss: 1.9678 | Val  Acc: 0.3667
 Site-White_utk-3               (0) | Val  Loss: 2.0167 | Val  Acc: 0.1961
 Site-White_utk-4               (0) | Val  Loss: 2.0269 | Val  Acc: 0.2069
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.8725 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.9466 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.9400 | Val  Acc: 0.2407
 Site-Black-0                   (2) | Val  Loss: 2.0557 | Val  Acc: 0.2400
 Site-Black-1                   (2) | Val  Loss: 2.0151 | Val  Acc: 0.3256
 Site-White-0                   (1) | Val  Loss: 1.9081 | Val  Acc: 0.4000
Average Valid Accuracy: 0.2855
 Best site-White_utk-0              (3)  | Epoch:1 | Val Acc: 0.2000
 Best site-White_utk-1              (0)  | Epoch:1 | Val Acc: 0.1765
 Best site-White_utk-2              (0)  | Epoch:1 | Val Acc: 0.3667
 Best site-White_utk-3              (0)  | Epoch:1 | Val Acc: 0.1961
 Best site-White_utk-4              (0)  | Epoch:1 | Val Acc: 0.2069
 Best site-Middle_Eastern-0         (1)  | Epoch:1 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (1)  | Epoch:1 | Val Acc: 0.3438
 Best site-Middle_Eastern-2         (1)  | Epoch:1 | Val Acc: 0.2407
 Best site-Black-0                  (2)  | Epoch:1 | Val Acc: 0.2400
 Best site-Black-1                  (2)  | Epoch:1 | Val Acc: 0.3256
 Best site-White-0                  (1)  | Epoch:1 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 2, 4, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk-0               (0) | Train Loss: 1.8420 | Train Acc: 0.2778
 Site-White_utk-1               (3) | Train Loss: 1.9242 | Train Acc: 0.3306
 Site-White_utk-2               (3) | Train Loss: 1.9432 | Train Acc: 0.2322
 Site-White_utk-3               (3) | Train Loss: 1.8668 | Train Acc: 0.3398
 Site-White_utk-4               (3) | Train Loss: 1.8723 | Train Acc: 0.3431
 Site-Middle_Eastern-0          (2) | Train Loss: 2.0820 | Train Acc: 0.3053
 Site-Middle_Eastern-1          (2) | Train Loss: 1.8881 | Train Acc: 0.2902
 Site-Middle_Eastern-2          (2) | Train Loss: 1.9117 | Train Acc: 0.3202
 Site-Black-0                   (1) | Train Loss: 1.9716 | Train Acc: 0.2898
 Site-Black-1                   (1) | Train Loss: 1.9694 | Train Acc: 0.2824
 Site-White-0                   (2) | Train Loss: 1.8412 | Train Acc: 0.3915
Average Train Accuracy: 0.3094
 Site-White_utk-0               (0) | Val  Loss: 1.9428 | Val  Acc: 0.3000
 Site-White_utk-1               (3) | Val  Loss: 1.7458 | Val  Acc: 0.4706
 Site-White_utk-2               (3) | Val  Loss: 1.8130 | Val  Acc: 0.4667
 Site-White_utk-3               (3) | Val  Loss: 1.8991 | Val  Acc: 0.2549
 Site-White_utk-4               (3) | Val  Loss: 1.8921 | Val  Acc: 0.2644
 Site-Middle_Eastern-0          (2) | Val  Loss: 1.7808 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (2) | Val  Loss: 1.9283 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (2) | Val  Loss: 1.8948 | Val  Acc: 0.2222
 Site-Black-0                   (1) | Val  Loss: 1.9998 | Val  Acc: 0.3200
 Site-Black-1                   (1) | Val  Loss: 1.9449 | Val  Acc: 0.3488
 Site-White-0                   (2) | Val  Loss: 1.8235 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3391
 Best site-White_utk-0              (0)  | Epoch:2 | Val Acc: 0.3000
 Best site-White_utk-1              (3)  | Epoch:2 | Val Acc: 0.4706
 Best site-White_utk-2              (3)  | Epoch:2 | Val Acc: 0.4667
 Best site-White_utk-3              (3)  | Epoch:2 | Val Acc: 0.2549
 Best site-White_utk-4              (3)  | Epoch:2 | Val Acc: 0.2644
 Best site-Middle_Eastern-0         (2)  | Epoch:2 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (2)  | Epoch:2 | Val Acc: 0.3438
 Best site-Middle_Eastern-2         (2)  | Epoch:2 | Val Acc: 0.2222
 Best site-Black-0                  (1)  | Epoch:2 | Val Acc: 0.3200
 Best site-Black-1                  (1)  | Epoch:2 | Val Acc: 0.3488
 Best site-White-0                  (2)  | Epoch:2 | Val Acc: 0.3500
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk-0               (1) | Train Loss: 1.7142 | Train Acc: 0.3194
 Site-White_utk-1               (1) | Train Loss: 1.8191 | Train Acc: 0.3468
 Site-White_utk-2               (1) | Train Loss: 1.8480 | Train Acc: 0.3033
 Site-White_utk-3               (1) | Train Loss: 1.7757 | Train Acc: 0.3482
 Site-White_utk-4               (1) | Train Loss: 1.7676 | Train Acc: 0.3611
 Site-Middle_Eastern-0          (3) | Train Loss: 1.7957 | Train Acc: 0.3435
 Site-Middle_Eastern-1          (3) | Train Loss: 1.7890 | Train Acc: 0.3348
 Site-Middle_Eastern-2          (3) | Train Loss: 1.7977 | Train Acc: 0.3622
 Site-Black-0                   (2) | Train Loss: 1.8984 | Train Acc: 0.3125
 Site-Black-1                   (2) | Train Loss: 1.8840 | Train Acc: 0.3090
 Site-White-0                   (0) | Train Loss: 1.7685 | Train Acc: 0.3986
Average Train Accuracy: 0.3399
 Site-White_utk-0               (1) | Val  Loss: 1.9719 | Val  Acc: 0.2000
 Site-White_utk-1               (1) | Val  Loss: 1.5738 | Val  Acc: 0.5294
 Site-White_utk-2               (1) | Val  Loss: 1.7885 | Val  Acc: 0.4667
 Site-White_utk-3               (1) | Val  Loss: 1.7816 | Val  Acc: 0.2941
 Site-White_utk-4               (1) | Val  Loss: 1.7889 | Val  Acc: 0.2874
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.6764 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.7875 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.7626 | Val  Acc: 0.2963
 Site-Black-0                   (2) | Val  Loss: 1.9196 | Val  Acc: 0.3200
 Site-Black-1                   (2) | Val  Loss: 1.9671 | Val  Acc: 0.3488
 Site-White-0                   (0) | Val  Loss: 1.7113 | Val  Acc: 0.4250
Average Valid Accuracy: 0.3603
 Best site-White_utk-0              (1)  | Epoch:3 | Val Acc: 0.2000
 Best site-White_utk-1              (1)  | Epoch:3 | Val Acc: 0.5294
 Best site-White_utk-2              (1)  | Epoch:3 | Val Acc: 0.4667
 Best site-White_utk-3              (1)  | Epoch:3 | Val Acc: 0.2941
 Best site-White_utk-4              (1)  | Epoch:3 | Val Acc: 0.2874
 Best site-Middle_Eastern-0         (3)  | Epoch:3 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (3)  | Epoch:3 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (3)  | Epoch:3 | Val Acc: 0.2963
 Best site-Black-0                  (2)  | Epoch:3 | Val Acc: 0.3200
 Best site-Black-1                  (2)  | Epoch:3 | Val Acc: 0.3488
 Best site-White-0                  (0)  | Epoch:3 | Val Acc: 0.4250
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk-0               (0) | Train Loss: 1.8254 | Train Acc: 0.3472
 Site-White_utk-1               (0) | Train Loss: 1.7739 | Train Acc: 0.3065
 Site-White_utk-2               (0) | Train Loss: 1.8220 | Train Acc: 0.3033
 Site-White_utk-3               (0) | Train Loss: 1.7403 | Train Acc: 0.3649
 Site-White_utk-4               (0) | Train Loss: 1.7215 | Train Acc: 0.3464
 Site-Middle_Eastern-0          (3) | Train Loss: 1.7562 | Train Acc: 0.3664
 Site-Middle_Eastern-1          (3) | Train Loss: 1.7423 | Train Acc: 0.3527
 Site-Middle_Eastern-2          (3) | Train Loss: 1.7240 | Train Acc: 0.3465
 Site-Black-0                   (2) | Train Loss: 1.8330 | Train Acc: 0.3182
 Site-Black-1                   (2) | Train Loss: 1.8070 | Train Acc: 0.3389
 Site-White-0                   (1) | Train Loss: 1.7070 | Train Acc: 0.3665
Average Train Accuracy: 0.3416
 Site-White_utk-0               (0) | Val  Loss: 1.7853 | Val  Acc: 0.1000
 Site-White_utk-1               (0) | Val  Loss: 1.4579 | Val  Acc: 0.5882
 Site-White_utk-2               (0) | Val  Loss: 1.8097 | Val  Acc: 0.3667
 Site-White_utk-3               (0) | Val  Loss: 1.7350 | Val  Acc: 0.2549
 Site-White_utk-4               (0) | Val  Loss: 1.7998 | Val  Acc: 0.2874
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.6753 | Val  Acc: 0.2222
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.6287 | Val  Acc: 0.5000
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.6779 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.8918 | Val  Acc: 0.2000
 Site-Black-1                   (2) | Val  Loss: 1.8699 | Val  Acc: 0.3488
 Site-White-0                   (1) | Val  Loss: 1.6533 | Val  Acc: 0.4750
Average Valid Accuracy: 0.3393
============ Train epoch 5 ============
cnt=[3, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White_utk-0               (1) | Train Loss: 1.7194 | Train Acc: 0.3889
 Site-White_utk-1               (1) | Train Loss: 1.6889 | Train Acc: 0.3306
 Site-White_utk-2               (1) | Train Loss: 1.8115 | Train Acc: 0.3270
 Site-White_utk-3               (1) | Train Loss: 1.6619 | Train Acc: 0.3315
 Site-White_utk-4               (1) | Train Loss: 1.6601 | Train Acc: 0.3725
 Site-Middle_Eastern-0          (0) | Train Loss: 1.6073 | Train Acc: 0.3588
 Site-Middle_Eastern-1          (0) | Train Loss: 1.6940 | Train Acc: 0.3571
 Site-Middle_Eastern-2          (0) | Train Loss: 1.6810 | Train Acc: 0.3543
 Site-Black-0                   (3) | Train Loss: 1.8182 | Train Acc: 0.3068
 Site-Black-1                   (3) | Train Loss: 1.7761 | Train Acc: 0.3355
 Site-White-0                   (2) | Train Loss: 1.6968 | Train Acc: 0.3701
Average Train Accuracy: 0.3485
 Site-White_utk-0               (1) | Val  Loss: 1.7684 | Val  Acc: 0.3000
 Site-White_utk-1               (1) | Val  Loss: 1.3921 | Val  Acc: 0.5294
 Site-White_utk-2               (1) | Val  Loss: 1.7249 | Val  Acc: 0.3667
 Site-White_utk-3               (1) | Val  Loss: 1.6468 | Val  Acc: 0.2745
 Site-White_utk-4               (1) | Val  Loss: 1.6505 | Val  Acc: 0.3333
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.7131 | Val  Acc: 0.2778
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.6494 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.6220 | Val  Acc: 0.4259
 Site-Black-0                   (3) | Val  Loss: 1.8444 | Val  Acc: 0.3200
 Site-Black-1                   (3) | Val  Loss: 1.8266 | Val  Acc: 0.3256
 Site-White-0                   (2) | Val  Loss: 1.6026 | Val  Acc: 0.5000
Average Valid Accuracy: 0.3662
 Best site-White_utk-0              (1)  | Epoch:5 | Val Acc: 0.3000
 Best site-White_utk-1              (1)  | Epoch:5 | Val Acc: 0.5294
 Best site-White_utk-2              (1)  | Epoch:5 | Val Acc: 0.3667
 Best site-White_utk-3              (1)  | Epoch:5 | Val Acc: 0.2745
 Best site-White_utk-4              (1)  | Epoch:5 | Val Acc: 0.3333
 Best site-Middle_Eastern-0         (0)  | Epoch:5 | Val Acc: 0.2778
 Best site-Middle_Eastern-1         (0)  | Epoch:5 | Val Acc: 0.3750
 Best site-Middle_Eastern-2         (0)  | Epoch:5 | Val Acc: 0.4259
 Best site-Black-0                  (3)  | Epoch:5 | Val Acc: 0.3200
 Best site-Black-1                  (3)  | Epoch:5 | Val Acc: 0.3256
 Best site-White-0                  (2)  | Epoch:5 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White_utk-0               (1) | Train Loss: 1.6913 | Train Acc: 0.3750
 Site-White_utk-1               (1) | Train Loss: 1.6662 | Train Acc: 0.2984
 Site-White_utk-2               (1) | Train Loss: 1.6704 | Train Acc: 0.3270
 Site-White_utk-3               (1) | Train Loss: 1.6295 | Train Acc: 0.3482
 Site-White_utk-4               (1) | Train Loss: 1.6030 | Train Acc: 0.4085
 Site-Middle_Eastern-0          (3) | Train Loss: 1.4781 | Train Acc: 0.3969
 Site-Middle_Eastern-1          (3) | Train Loss: 1.6581 | Train Acc: 0.3705
 Site-Middle_Eastern-2          (3) | Train Loss: 1.6152 | Train Acc: 0.3911
 Site-Black-0                   (2) | Train Loss: 1.8253 | Train Acc: 0.3239
 Site-Black-1                   (2) | Train Loss: 1.7418 | Train Acc: 0.3488
 Site-White-0                   (0) | Train Loss: 1.5918 | Train Acc: 0.4057
Average Train Accuracy: 0.3631
 Site-White_utk-0               (1) | Val  Loss: 1.6862 | Val  Acc: 0.2000
 Site-White_utk-1               (1) | Val  Loss: 1.3848 | Val  Acc: 0.5294
 Site-White_utk-2               (1) | Val  Loss: 1.6681 | Val  Acc: 0.4000
 Site-White_utk-3               (1) | Val  Loss: 1.6364 | Val  Acc: 0.3137
 Site-White_utk-4               (1) | Val  Loss: 1.6499 | Val  Acc: 0.3218
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5437 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.6575 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.5972 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.8273 | Val  Acc: 0.3600
 Site-Black-1                   (2) | Val  Loss: 1.8758 | Val  Acc: 0.3721
 Site-White-0                   (0) | Val  Loss: 1.6071 | Val  Acc: 0.4500
Average Valid Accuracy: 0.3716
 Best site-White_utk-0              (1)  | Epoch:6 | Val Acc: 0.2000
 Best site-White_utk-1              (1)  | Epoch:6 | Val Acc: 0.5294
 Best site-White_utk-2              (1)  | Epoch:6 | Val Acc: 0.4000
 Best site-White_utk-3              (1)  | Epoch:6 | Val Acc: 0.3137
 Best site-White_utk-4              (1)  | Epoch:6 | Val Acc: 0.3218
 Best site-Middle_Eastern-0         (3)  | Epoch:6 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (3)  | Epoch:6 | Val Acc: 0.3438
 Best site-Middle_Eastern-2         (3)  | Epoch:6 | Val Acc: 0.4074
 Best site-Black-0                  (2)  | Epoch:6 | Val Acc: 0.3600
 Best site-Black-1                  (2)  | Epoch:6 | Val Acc: 0.3721
 Best site-White-0                  (0)  | Epoch:6 | Val Acc: 0.4500
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White_utk-0               (0) | Train Loss: 1.4765 | Train Acc: 0.4028
 Site-White_utk-1               (0) | Train Loss: 1.5763 | Train Acc: 0.3871
 Site-White_utk-2               (0) | Train Loss: 1.5976 | Train Acc: 0.3697
 Site-White_utk-3               (0) | Train Loss: 1.5631 | Train Acc: 0.3983
 Site-White_utk-4               (0) | Train Loss: 1.5600 | Train Acc: 0.4330
 Site-Middle_Eastern-0          (3) | Train Loss: 1.5255 | Train Acc: 0.3588
 Site-Middle_Eastern-1          (3) | Train Loss: 1.6171 | Train Acc: 0.3750
 Site-Middle_Eastern-2          (3) | Train Loss: 1.5794 | Train Acc: 0.3780
 Site-Black-0                   (2) | Train Loss: 1.7508 | Train Acc: 0.3125
 Site-Black-1                   (2) | Train Loss: 1.7179 | Train Acc: 0.3821
 Site-White-0                   (1) | Train Loss: 1.5881 | Train Acc: 0.4021
Average Train Accuracy: 0.3818
 Site-White_utk-0               (0) | Val  Loss: 1.6036 | Val  Acc: 0.3000
 Site-White_utk-1               (0) | Val  Loss: 1.3122 | Val  Acc: 0.5294
 Site-White_utk-2               (0) | Val  Loss: 1.6726 | Val  Acc: 0.4000
 Site-White_utk-3               (0) | Val  Loss: 1.5803 | Val  Acc: 0.3137
 Site-White_utk-4               (0) | Val  Loss: 1.5838 | Val  Acc: 0.3218
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.5589 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.6137 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.5843 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.7790 | Val  Acc: 0.2800
 Site-Black-1                   (2) | Val  Loss: 1.8302 | Val  Acc: 0.2791
 Site-White-0                   (1) | Val  Loss: 1.6011 | Val  Acc: 0.3750
Average Valid Accuracy: 0.3688
============ Train epoch 8 ============
cnt=[1, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White_utk-0               (0) | Train Loss: 1.4293 | Train Acc: 0.3750
 Site-White_utk-1               (3) | Train Loss: 1.5359 | Train Acc: 0.4113
 Site-White_utk-2               (3) | Train Loss: 1.6335 | Train Acc: 0.3744
 Site-White_utk-3               (3) | Train Loss: 1.5632 | Train Acc: 0.4067
 Site-White_utk-4               (3) | Train Loss: 1.5045 | Train Acc: 0.4820
 Site-Middle_Eastern-0          (1) | Train Loss: 1.6603 | Train Acc: 0.3740
 Site-Middle_Eastern-1          (1) | Train Loss: 1.5620 | Train Acc: 0.3973
 Site-Middle_Eastern-2          (1) | Train Loss: 1.5794 | Train Acc: 0.3963
 Site-Black-0                   (2) | Train Loss: 1.7323 | Train Acc: 0.3466
 Site-Black-1                   (2) | Train Loss: 1.6943 | Train Acc: 0.3721
 Site-White-0                   (1) | Train Loss: 1.5573 | Train Acc: 0.4128
Average Train Accuracy: 0.3953
 Site-White_utk-0               (0) | Val  Loss: 1.5241 | Val  Acc: 0.3000
 Site-White_utk-1               (3) | Val  Loss: 1.2487 | Val  Acc: 0.5294
 Site-White_utk-2               (3) | Val  Loss: 1.6494 | Val  Acc: 0.3667
 Site-White_utk-3               (3) | Val  Loss: 1.5333 | Val  Acc: 0.3725
 Site-White_utk-4               (3) | Val  Loss: 1.5115 | Val  Acc: 0.4138
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.4995 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.5529 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.5315 | Val  Acc: 0.4444
 Site-Black-0                   (2) | Val  Loss: 1.7464 | Val  Acc: 0.3200
 Site-Black-1                   (2) | Val  Loss: 1.8430 | Val  Acc: 0.2791
 Site-White-0                   (1) | Val  Loss: 1.6285 | Val  Acc: 0.3750
Average Valid Accuracy: 0.3865
 Best site-White_utk-0              (0)  | Epoch:8 | Val Acc: 0.3000
 Best site-White_utk-1              (3)  | Epoch:8 | Val Acc: 0.5294
 Best site-White_utk-2              (3)  | Epoch:8 | Val Acc: 0.3667
 Best site-White_utk-3              (3)  | Epoch:8 | Val Acc: 0.3725
 Best site-White_utk-4              (3)  | Epoch:8 | Val Acc: 0.4138
 Best site-Middle_Eastern-0         (1)  | Epoch:8 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (1)  | Epoch:8 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (1)  | Epoch:8 | Val Acc: 0.4444
 Best site-Black-0                  (2)  | Epoch:8 | Val Acc: 0.3200
 Best site-Black-1                  (2)  | Epoch:8 | Val Acc: 0.2791
 Best site-White-0                  (1)  | Epoch:8 | Val Acc: 0.3750
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White_utk-0               (1) | Train Loss: 1.4462 | Train Acc: 0.3889
 Site-White_utk-1               (1) | Train Loss: 1.5507 | Train Acc: 0.3871
 Site-White_utk-2               (1) | Train Loss: 1.5934 | Train Acc: 0.3602
 Site-White_utk-3               (1) | Train Loss: 1.5277 | Train Acc: 0.4011
 Site-White_utk-4               (1) | Train Loss: 1.4926 | Train Acc: 0.4412
 Site-Middle_Eastern-0          (2) | Train Loss: 1.4325 | Train Acc: 0.4046
 Site-Middle_Eastern-1          (2) | Train Loss: 1.5786 | Train Acc: 0.3973
 Site-Middle_Eastern-2          (2) | Train Loss: 1.5440 | Train Acc: 0.3675
 Site-Black-0                   (3) | Train Loss: 1.6870 | Train Acc: 0.3807
 Site-Black-1                   (0) | Train Loss: 1.6710 | Train Acc: 0.3621
 Site-White-0                   (2) | Train Loss: 1.5647 | Train Acc: 0.4128
Average Train Accuracy: 0.3912
 Site-White_utk-0               (1) | Val  Loss: 1.4778 | Val  Acc: 0.3000
 Site-White_utk-1               (1) | Val  Loss: 1.2566 | Val  Acc: 0.3529
 Site-White_utk-2               (1) | Val  Loss: 1.5572 | Val  Acc: 0.4333
 Site-White_utk-3               (1) | Val  Loss: 1.5361 | Val  Acc: 0.3922
 Site-White_utk-4               (1) | Val  Loss: 1.5247 | Val  Acc: 0.3333
 Site-Middle_Eastern-0          (2) | Val  Loss: 1.6544 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (2) | Val  Loss: 1.6361 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (2) | Val  Loss: 1.5095 | Val  Acc: 0.4444
 Site-Black-0                   (3) | Val  Loss: 1.7800 | Val  Acc: 0.2400
 Site-Black-1                   (0) | Val  Loss: 1.7453 | Val  Acc: 0.3721
 Site-White-0                   (2) | Val  Loss: 1.5178 | Val  Acc: 0.4500
Average Valid Accuracy: 0.3796
 Test site-White_utk-0               (1)| Epoch:8 | Test Acc: 0.4091
 Test site-White_utk-1               (1)| Epoch:8 | Test Acc: 0.3514
 Test site-White_utk-2               (1)| Epoch:8 | Test Acc: 0.4590
 Test site-White_utk-3               (1)| Epoch:8 | Test Acc: 0.3558
 Test site-White_utk-4               (1)| Epoch:8 | Test Acc: 0.3693
 Test site-Middle_Eastern-0          (2)| Epoch:8 | Test Acc: 0.4615
 Test site-Middle_Eastern-1          (2)| Epoch:8 | Test Acc: 0.4308
 Test site-Middle_Eastern-2          (2)| Epoch:8 | Test Acc: 0.4000
 Test site-Black-0                   (3)| Epoch:8 | Test Acc: 0.2941
 Test site-Black-1                   (0)| Epoch:8 | Test Acc: 0.3488
 Test site-White-0                   (2)| Epoch:8 | Test Acc: 0.3210
White_utk: 0.3889, Middle_Eastern: 0.4308, Black: 0.3215, White: 0.3210, 
Average Test Accuracy(group): 0.3655, Average Test Accuracy(individual): 0.3819,
domain std=0.0467, cluster std=0.0423, individual std=0.0522, 
============ Train epoch 10 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-White_utk-0               (1) | Train Loss: 1.3596 | Train Acc: 0.4028
 Site-White_utk-1               (1) | Train Loss: 1.5055 | Train Acc: 0.4355
 Site-White_utk-2               (1) | Train Loss: 1.5436 | Train Acc: 0.4076
 Site-White_utk-3               (1) | Train Loss: 1.5000 | Train Acc: 0.4011
 Site-White_utk-4               (1) | Train Loss: 1.4511 | Train Acc: 0.4624
 Site-Middle_Eastern-0          (0) | Train Loss: 1.8449 | Train Acc: 0.3969
 Site-Middle_Eastern-1          (0) | Train Loss: 1.5459 | Train Acc: 0.3973
 Site-Middle_Eastern-2          (0) | Train Loss: 1.5099 | Train Acc: 0.4042
 Site-Black-0                   (2) | Train Loss: 1.7160 | Train Acc: 0.3182
 Site-Black-1                   (2) | Train Loss: 1.6489 | Train Acc: 0.3754
 Site-White-0                   (3) | Train Loss: 1.5371 | Train Acc: 0.4164
Average Train Accuracy: 0.4016
 Site-White_utk-0               (1) | Val  Loss: 1.5729 | Val  Acc: 0.2000
 Site-White_utk-1               (1) | Val  Loss: 1.2909 | Val  Acc: 0.4706
 Site-White_utk-2               (1) | Val  Loss: 1.5318 | Val  Acc: 0.3000
 Site-White_utk-3               (1) | Val  Loss: 1.5460 | Val  Acc: 0.3137
 Site-White_utk-4               (1) | Val  Loss: 1.5294 | Val  Acc: 0.3333
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5216 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.5570 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.5333 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.7584 | Val  Acc: 0.4400
 Site-Black-1                   (2) | Val  Loss: 1.8161 | Val  Acc: 0.3953
 Site-White-0                   (3) | Val  Loss: 1.5001 | Val  Acc: 0.4250
Average Valid Accuracy: 0.3777
============ Train epoch 11 ============
cnt=[1, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-White_utk-0               (0) | Train Loss: 1.4129 | Train Acc: 0.4306
 Site-White_utk-1               (3) | Train Loss: 1.4803 | Train Acc: 0.4677
 Site-White_utk-2               (3) | Train Loss: 1.5393 | Train Acc: 0.3839
 Site-White_utk-3               (3) | Train Loss: 1.5103 | Train Acc: 0.4150
 Site-White_utk-4               (3) | Train Loss: 1.4262 | Train Acc: 0.4722
 Site-Middle_Eastern-0          (1) | Train Loss: 1.6373 | Train Acc: 0.4046
 Site-Middle_Eastern-1          (1) | Train Loss: 1.4983 | Train Acc: 0.4375
 Site-Middle_Eastern-2          (1) | Train Loss: 1.4948 | Train Acc: 0.4173
 Site-Black-0                   (2) | Train Loss: 1.7048 | Train Acc: 0.3352
 Site-Black-1                   (2) | Train Loss: 1.6171 | Train Acc: 0.3887
 Site-White-0                   (1) | Train Loss: 1.4732 | Train Acc: 0.4698
Average Train Accuracy: 0.4202
 Site-White_utk-0               (0) | Val  Loss: 1.3967 | Val  Acc: 0.4000
 Site-White_utk-1               (3) | Val  Loss: 1.2411 | Val  Acc: 0.4706
 Site-White_utk-2               (3) | Val  Loss: 1.4775 | Val  Acc: 0.4000
 Site-White_utk-3               (3) | Val  Loss: 1.5048 | Val  Acc: 0.3333
 Site-White_utk-4               (3) | Val  Loss: 1.5153 | Val  Acc: 0.3333
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5300 | Val  Acc: 0.2778
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.5785 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.5388 | Val  Acc: 0.3148
 Site-Black-0                   (2) | Val  Loss: 1.7407 | Val  Acc: 0.3600
 Site-Black-1                   (2) | Val  Loss: 1.7752 | Val  Acc: 0.3256
 Site-White-0                   (1) | Val  Loss: 1.4813 | Val  Acc: 0.4750
Average Valid Accuracy: 0.3753
============ Train epoch 12 ============
===2023-06-16 12:40:28===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
===2023-06-16 12:40:31===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
