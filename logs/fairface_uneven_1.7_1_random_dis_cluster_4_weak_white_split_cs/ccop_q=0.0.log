===2023-06-16 09:47:00===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 70
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 2, 6, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White-0                   (3) | Train Loss: 1.6631 | Train Acc: 0.3944
 Site-White-1                   (3) | Train Loss: 1.8383 | Train Acc: 0.3636
 Site-White-2                   (3) | Train Loss: 1.8633 | Train Acc: 0.3220
 Site-White-3                   (3) | Train Loss: 1.7865 | Train Acc: 0.3604
 Site-White-4                   (3) | Train Loss: 1.7342 | Train Acc: 0.3573
 Site-Middle_Eastern-0          (0) | Train Loss: 2.3338 | Train Acc: 0.2901
 Site-Middle_Eastern-1          (0) | Train Loss: 2.0507 | Train Acc: 0.2500
 Site-Middle_Eastern-2          (3) | Train Loss: 1.9946 | Train Acc: 0.2651
 Site-Black-0                   (2) | Train Loss: 2.0441 | Train Acc: 0.2435
 Site-Black-1                   (2) | Train Loss: 2.0850 | Train Acc: 0.2112
 Site-White_ffhq-0              (1) | Train Loss: 1.1960 | Train Acc: 0.5420
Average Train Accuracy: 0.3272
 Site-White-0                   (3) | Val  Loss: 1.9823 | Val  Acc: 0.2500
 Site-White-1                   (3) | Val  Loss: 1.9170 | Val  Acc: 0.2059
 Site-White-2                   (3) | Val  Loss: 1.8822 | Val  Acc: 0.3390
 Site-White-3                   (3) | Val  Loss: 1.7967 | Val  Acc: 0.3000
 Site-White-4                   (3) | Val  Loss: 1.8630 | Val  Acc: 0.3000
 Site-Middle_Eastern-0          (0) | Val  Loss: 2.2136 | Val  Acc: 0.2222
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.7635 | Val  Acc: 0.2812
 Site-Middle_Eastern-2          (3) | Val  Loss: 2.0206 | Val  Acc: 0.2037
 Site-Black-0                   (2) | Val  Loss: 2.0792 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.9099 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1460 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2920
 Best site-White-0                  (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-White-1                  (3)  | Epoch:0 | Val Acc: 0.2059
 Best site-White-2                  (3)  | Epoch:0 | Val Acc: 0.3390
 Best site-White-3                  (3)  | Epoch:0 | Val Acc: 0.3000
 Best site-White-4                  (3)  | Epoch:0 | Val Acc: 0.3000
 Best site-Middle_Eastern-0         (0)  | Epoch:0 | Val Acc: 0.2222
 Best site-Middle_Eastern-1         (0)  | Epoch:0 | Val Acc: 0.2812
 Best site-Middle_Eastern-2         (3)  | Epoch:0 | Val Acc: 0.2037
 Best site-Black-0                  (2)  | Epoch:0 | Val Acc: 0.2449
 Best site-Black-1                  (2)  | Epoch:0 | Val Acc: 0.3133
 Best site-White_ffhq-0             (1)  | Epoch:0 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0...
============ Train epoch 1 ============
cnt=[1, 1, 2, 7, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White-0                   (3) | Train Loss: 1.7784 | Train Acc: 0.3944
 Site-White-1                   (3) | Train Loss: 1.7922 | Train Acc: 0.3430
 Site-White-2                   (3) | Train Loss: 1.7871 | Train Acc: 0.3341
 Site-White-3                   (3) | Train Loss: 1.7490 | Train Acc: 0.3490
 Site-White-4                   (0) | Train Loss: 1.6934 | Train Acc: 0.3640
 Site-Middle_Eastern-0          (3) | Train Loss: 2.0995 | Train Acc: 0.2748
 Site-Middle_Eastern-1          (3) | Train Loss: 1.9466 | Train Acc: 0.2679
 Site-Middle_Eastern-2          (3) | Train Loss: 1.9130 | Train Acc: 0.2730
 Site-Black-0                   (2) | Train Loss: 1.9134 | Train Acc: 0.2406
 Site-Black-1                   (2) | Train Loss: 1.9801 | Train Acc: 0.1942
 Site-White_ffhq-0              (1) | Train Loss: 1.3054 | Train Acc: 0.4836
Average Train Accuracy: 0.3199
 Site-White-0                   (3) | Val  Loss: 1.9260 | Val  Acc: 0.2000
 Site-White-1                   (3) | Val  Loss: 1.8436 | Val  Acc: 0.2059
 Site-White-2                   (3) | Val  Loss: 1.8354 | Val  Acc: 0.3898
 Site-White-3                   (3) | Val  Loss: 1.8001 | Val  Acc: 0.3100
 Site-White-4                   (0) | Val  Loss: 1.7949 | Val  Acc: 0.3176
 Site-Middle_Eastern-0          (3) | Val  Loss: 2.0748 | Val  Acc: 0.1667
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.6889 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.9097 | Val  Acc: 0.2222
 Site-Black-0                   (2) | Val  Loss: 1.9698 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.9125 | Val  Acc: 0.2410
 Site-White_ffhq-0              (1) | Val  Loss: 1.2981 | Val  Acc: 0.4615
Average Valid Accuracy: 0.2830
============ Train epoch 2 ============
cnt=[4, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White-0                   (0) | Train Loss: 1.7145 | Train Acc: 0.4014
 Site-White-1                   (0) | Train Loss: 1.7567 | Train Acc: 0.3554
 Site-White-2                   (0) | Train Loss: 1.7423 | Train Acc: 0.3874
 Site-White-3                   (0) | Train Loss: 1.7144 | Train Acc: 0.3575
 Site-White-4                   (3) | Train Loss: 1.6613 | Train Acc: 0.3623
 Site-Middle_Eastern-0          (3) | Train Loss: 1.9773 | Train Acc: 0.2901
 Site-Middle_Eastern-1          (3) | Train Loss: 1.8925 | Train Acc: 0.3036
 Site-Middle_Eastern-2          (3) | Train Loss: 1.8446 | Train Acc: 0.3176
 Site-Black-0                   (2) | Train Loss: 1.8692 | Train Acc: 0.2638
 Site-Black-1                   (2) | Train Loss: 1.9316 | Train Acc: 0.2300
 Site-White_ffhq-0              (1) | Train Loss: 1.3462 | Train Acc: 0.4872
Average Train Accuracy: 0.3415
 Site-White-0                   (0) | Val  Loss: 1.8624 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.7902 | Val  Acc: 0.2353
 Site-White-2                   (0) | Val  Loss: 1.8027 | Val  Acc: 0.3390
 Site-White-3                   (0) | Val  Loss: 1.7356 | Val  Acc: 0.3700
 Site-White-4                   (3) | Val  Loss: 1.7822 | Val  Acc: 0.3412
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.9805 | Val  Acc: 0.2778
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.6226 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.8318 | Val  Acc: 0.2593
 Site-Black-0                   (2) | Val  Loss: 1.9611 | Val  Acc: 0.2041
 Site-Black-1                   (2) | Val  Loss: 1.8650 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.3163 | Val  Acc: 0.4744
Average Valid Accuracy: 0.3128
 Best site-White-0                  (0)  | Epoch:2 | Val Acc: 0.3500
 Best site-White-1                  (0)  | Epoch:2 | Val Acc: 0.2353
 Best site-White-2                  (0)  | Epoch:2 | Val Acc: 0.3390
 Best site-White-3                  (0)  | Epoch:2 | Val Acc: 0.3700
 Best site-White-4                  (3)  | Epoch:2 | Val Acc: 0.3412
 Best site-Middle_Eastern-0         (3)  | Epoch:2 | Val Acc: 0.2778
 Best site-Middle_Eastern-1         (3)  | Epoch:2 | Val Acc: 0.3125
 Best site-Middle_Eastern-2         (3)  | Epoch:2 | Val Acc: 0.2593
 Best site-Black-0                  (2)  | Epoch:2 | Val Acc: 0.2041
 Best site-Black-1                  (2)  | Epoch:2 | Val Acc: 0.2771
 Best site-White_ffhq-0             (1)  | Epoch:2 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0...
============ Train epoch 3 ============
cnt=[1, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White-0                   (1) | Train Loss: 1.6702 | Train Acc: 0.4225
 Site-White-1                   (1) | Train Loss: 1.7009 | Train Acc: 0.3760
 Site-White-2                   (1) | Train Loss: 1.6774 | Train Acc: 0.3923
 Site-White-3                   (1) | Train Loss: 1.6504 | Train Acc: 0.3974
 Site-White-4                   (1) | Train Loss: 1.6299 | Train Acc: 0.3791
 Site-Middle_Eastern-0          (3) | Train Loss: 1.7613 | Train Acc: 0.3130
 Site-Middle_Eastern-1          (3) | Train Loss: 1.8175 | Train Acc: 0.3036
 Site-Middle_Eastern-2          (3) | Train Loss: 1.7994 | Train Acc: 0.3255
 Site-Black-0                   (2) | Train Loss: 1.8311 | Train Acc: 0.2870
 Site-Black-1                   (2) | Train Loss: 1.8766 | Train Acc: 0.2368
 Site-White_ffhq-0              (0) | Train Loss: 1.3130 | Train Acc: 0.4982
Average Train Accuracy: 0.3574
 Site-White-0                   (1) | Val  Loss: 1.8580 | Val  Acc: 0.3000
 Site-White-1                   (1) | Val  Loss: 1.7151 | Val  Acc: 0.2941
 Site-White-2                   (1) | Val  Loss: 1.8038 | Val  Acc: 0.3220
 Site-White-3                   (1) | Val  Loss: 1.7024 | Val  Acc: 0.3200
 Site-White-4                   (1) | Val  Loss: 1.7229 | Val  Acc: 0.3706
 Site-Middle_Eastern-0          (3) | Val  Loss: 1.8703 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (3) | Val  Loss: 1.5864 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (3) | Val  Loss: 1.7887 | Val  Acc: 0.2778
 Site-Black-0                   (2) | Val  Loss: 1.8913 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.8409 | Val  Acc: 0.2410
 Site-White_ffhq-0              (0) | Val  Loss: 1.3011 | Val  Acc: 0.4872
Average Valid Accuracy: 0.3264
 Best site-White-0                  (1)  | Epoch:3 | Val Acc: 0.3000
 Best site-White-1                  (1)  | Epoch:3 | Val Acc: 0.2941
 Best site-White-2                  (1)  | Epoch:3 | Val Acc: 0.3220
 Best site-White-3                  (1)  | Epoch:3 | Val Acc: 0.3200
 Best site-White-4                  (1)  | Epoch:3 | Val Acc: 0.3706
 Best site-Middle_Eastern-0         (3)  | Epoch:3 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (3)  | Epoch:3 | Val Acc: 0.3438
 Best site-Middle_Eastern-2         (3)  | Epoch:3 | Val Acc: 0.2778
 Best site-Black-0                  (2)  | Epoch:3 | Val Acc: 0.2449
 Best site-Black-1                  (2)  | Epoch:3 | Val Acc: 0.2410
 Best site-White_ffhq-0             (0)  | Epoch:3 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0...
============ Train epoch 4 ============
cnt=[8, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White-0                   (0) | Train Loss: 1.5844 | Train Acc: 0.4366
 Site-White-1                   (0) | Train Loss: 1.6102 | Train Acc: 0.4380
 Site-White-2                   (0) | Train Loss: 1.6188 | Train Acc: 0.4092
 Site-White-3                   (0) | Train Loss: 1.5779 | Train Acc: 0.3875
 Site-White-4                   (0) | Train Loss: 1.5479 | Train Acc: 0.3992
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5717 | Train Acc: 0.3740
 Site-Middle_Eastern-1          (0) | Train Loss: 1.7099 | Train Acc: 0.3795
 Site-Middle_Eastern-2          (0) | Train Loss: 1.6633 | Train Acc: 0.3622
 Site-Black-0                   (3) | Train Loss: 1.7814 | Train Acc: 0.2754
 Site-Black-1                   (2) | Train Loss: 1.7627 | Train Acc: 0.2726
 Site-White_ffhq-0              (1) | Train Loss: 1.5036 | Train Acc: 0.4161
Average Train Accuracy: 0.3773
 Site-White-0                   (0) | Val  Loss: 1.8150 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.6526 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.7387 | Val  Acc: 0.3559
 Site-White-3                   (0) | Val  Loss: 1.6462 | Val  Acc: 0.3600
 Site-White-4                   (0) | Val  Loss: 1.6557 | Val  Acc: 0.3882
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.7694 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4932 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.6678 | Val  Acc: 0.3333
 Site-Black-0                   (3) | Val  Loss: 1.8413 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.7904 | Val  Acc: 0.2771
 Site-White_ffhq-0              (1) | Val  Loss: 1.4234 | Val  Acc: 0.3462
Average Valid Accuracy: 0.3404
 Best site-White-0                  (0)  | Epoch:4 | Val Acc: 0.3000
 Best site-White-1                  (0)  | Epoch:4 | Val Acc: 0.3235
 Best site-White-2                  (0)  | Epoch:4 | Val Acc: 0.3559
 Best site-White-3                  (0)  | Epoch:4 | Val Acc: 0.3600
 Best site-White-4                  (0)  | Epoch:4 | Val Acc: 0.3882
 Best site-Middle_Eastern-0         (0)  | Epoch:4 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (0)  | Epoch:4 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (0)  | Epoch:4 | Val Acc: 0.3333
 Best site-Black-0                  (3)  | Epoch:4 | Val Acc: 0.2653
 Best site-Black-1                  (2)  | Epoch:4 | Val Acc: 0.2771
 Best site-White_ffhq-0             (1)  | Epoch:4 | Val Acc: 0.3462
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0_gmap...
 Test site-White-0                   (0)| Epoch:4 | Test Acc: 0.2857
 Test site-White-1                   (0)| Epoch:4 | Test Acc: 0.3944
 Test site-White-2                   (0)| Epoch:4 | Test Acc: 0.3950
 Test site-White-3                   (0)| Epoch:4 | Test Acc: 0.3614
 Test site-White-4                   (0)| Epoch:4 | Test Acc: 0.3761
 Test site-Middle_Eastern-0          (0)| Epoch:4 | Test Acc: 0.3333
 Test site-Middle_Eastern-1          (0)| Epoch:4 | Test Acc: 0.2769
 Test site-Middle_Eastern-2          (0)| Epoch:4 | Test Acc: 0.3818
 Test site-Black-0                   (3)| Epoch:4 | Test Acc: 0.3400
 Test site-Black-1                   (2)| Epoch:4 | Test Acc: 0.3254
 Test site-White_ffhq-0              (1)| Epoch:4 | Test Acc: 0.4177
White: 0.3625, Middle_Eastern: 0.3307, Black: 0.3327, White_ffhq: 0.4177, 
Average Test Accuracy(group): 0.3609, Average Test Accuracy(individual): 0.3534,
domain std=0.0351, cluster std=0.0354, individual std=0.0434, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0...
============ Train epoch 5 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White-0                   (0) | Train Loss: 1.5095 | Train Acc: 0.4718
 Site-White-1                   (3) | Train Loss: 1.5635 | Train Acc: 0.4421
 Site-White-2                   (0) | Train Loss: 1.5418 | Train Acc: 0.4068
 Site-White-3                   (3) | Train Loss: 1.5208 | Train Acc: 0.4373
 Site-White-4                   (3) | Train Loss: 1.5058 | Train Acc: 0.4151
 Site-Middle_Eastern-0          (0) | Train Loss: 1.6403 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (0) | Train Loss: 1.6256 | Train Acc: 0.3973
 Site-Middle_Eastern-2          (0) | Train Loss: 1.5959 | Train Acc: 0.3675
 Site-Black-0                   (2) | Train Loss: 1.7881 | Train Acc: 0.2899
 Site-Black-1                   (2) | Train Loss: 1.7138 | Train Acc: 0.3083
 Site-White_ffhq-0              (1) | Train Loss: 1.5731 | Train Acc: 0.3942
Average Train Accuracy: 0.3948
 Site-White-0                   (0) | Val  Loss: 1.7931 | Val  Acc: 0.2500
 Site-White-1                   (3) | Val  Loss: 1.6086 | Val  Acc: 0.2647
 Site-White-2                   (0) | Val  Loss: 1.7430 | Val  Acc: 0.3390
 Site-White-3                   (3) | Val  Loss: 1.6370 | Val  Acc: 0.3700
 Site-White-4                   (3) | Val  Loss: 1.6335 | Val  Acc: 0.3882
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.7933 | Val  Acc: 0.3333
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4617 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.6013 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.7864 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.8418 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.4880 | Val  Acc: 0.3974
Average Valid Accuracy: 0.3425
 Best site-White-0                  (0)  | Epoch:5 | Val Acc: 0.2500
 Best site-White-1                  (3)  | Epoch:5 | Val Acc: 0.2647
 Best site-White-2                  (0)  | Epoch:5 | Val Acc: 0.3390
 Best site-White-3                  (3)  | Epoch:5 | Val Acc: 0.3700
 Best site-White-4                  (3)  | Epoch:5 | Val Acc: 0.3882
 Best site-Middle_Eastern-0         (0)  | Epoch:5 | Val Acc: 0.3333
 Best site-Middle_Eastern-1         (0)  | Epoch:5 | Val Acc: 0.4375
 Best site-Middle_Eastern-2         (0)  | Epoch:5 | Val Acc: 0.3889
 Best site-Black-0                  (2)  | Epoch:5 | Val Acc: 0.2857
 Best site-Black-1                  (2)  | Epoch:5 | Val Acc: 0.3133
 Best site-White_ffhq-0             (1)  | Epoch:5 | Val Acc: 0.3974
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_4_weak_white_split_cs/ccop_q=0.0...
============ Train epoch 6 ============
