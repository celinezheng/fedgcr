===2023-06-10 12:55:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[13,24,43,77,140,252,454,818,1473,2651,80,144,259,467,840,1513,303,547,984,364,655,566,
client_nums=[10,6,3,2,1,]
len_dataset=[7438,4132,2295,1275,708,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                    | Train Loss: 1.7938 | Train Acc: 0.4615
 Site-MNIST                    | Train Loss: 1.6235 | Train Acc: 0.6667
 Site-MNIST                    | Train Loss: 1.6426 | Train Acc: 0.6279
 Site-MNIST                    | Train Loss: 1.6025 | Train Acc: 0.6753
 Site-MNIST                    | Train Loss: 1.5178 | Train Acc: 0.6286
 Site-MNIST                    | Train Loss: 1.6136 | Train Acc: 0.6310
 Site-MNIST                    | Train Loss: 1.6572 | Train Acc: 0.5881
 Site-MNIST                    | Train Loss: 1.6487 | Train Acc: 0.5770
 Site-MNIST                    | Train Loss: 1.6155 | Train Acc: 0.5981
 Site-MNIST                    | Train Loss: 1.6396 | Train Acc: 0.5919
 Site-USPS                     | Train Loss: 1.6252 | Train Acc: 0.7125
 Site-USPS                     | Train Loss: 1.5783 | Train Acc: 0.6875
 Site-USPS                     | Train Loss: 1.5223 | Train Acc: 0.6680
 Site-USPS                     | Train Loss: 1.5850 | Train Acc: 0.6874
 Site-USPS                     | Train Loss: 1.6068 | Train Acc: 0.6298
 Site-USPS                     | Train Loss: 1.5658 | Train Acc: 0.7112
 Site-SynthDigits              | Train Loss: 2.0744 | Train Acc: 0.2706
 Site-SynthDigits              | Train Loss: 2.0443 | Train Acc: 0.2797
 Site-SynthDigits              | Train Loss: 2.0204 | Train Acc: 0.3140
 Site-MNIST-M                  | Train Loss: 2.1678 | Train Acc: 0.2335
 Site-MNIST-M                  | Train Loss: 2.1798 | Train Acc: 0.2183
 Site-SVHN                     | Train Loss: 2.1592 | Train Acc: 0.2261
 Site-MNIST                     (0) | Val  Loss: 2.0333 | Val  Acc: 0.3333
 Site-MNIST                     (0) | Val  Loss: 1.5537 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 1.5507 | Val  Acc: 0.6000
 Site-MNIST                     (0) | Val  Loss: 1.5622 | Val  Acc: 0.5789
 Site-MNIST                     (0) | Val  Loss: 1.7368 | Val  Acc: 0.4571
 Site-MNIST                     (0) | Val  Loss: 1.7470 | Val  Acc: 0.4603
 Site-MNIST                     (0) | Val  Loss: 1.7018 | Val  Acc: 0.5221
 Site-MNIST                     (0) | Val  Loss: 1.6114 | Val  Acc: 0.6127
 Site-MNIST                     (0) | Val  Loss: 1.6477 | Val  Acc: 0.5842
 Site-MNIST                     (0) | Val  Loss: 1.6665 | Val  Acc: 0.5710
 Site-USPS                      (1) | Val  Loss: 1.6532 | Val  Acc: 0.5500
 Site-USPS                      (1) | Val  Loss: 1.5844 | Val  Acc: 0.6111
 Site-USPS                      (1) | Val  Loss: 1.5155 | Val  Acc: 0.7031
 Site-USPS                      (1) | Val  Loss: 1.5586 | Val  Acc: 0.7241
 Site-USPS                      (1) | Val  Loss: 1.5361 | Val  Acc: 0.7238
 Site-USPS                      (1) | Val  Loss: 1.5940 | Val  Acc: 0.6720
 Site-SynthDigits               (2) | Val  Loss: 2.0407 | Val  Acc: 0.3467
 Site-SynthDigits               (2) | Val  Loss: 1.9701 | Val  Acc: 0.3309
 Site-SynthDigits               (2) | Val  Loss: 2.0652 | Val  Acc: 0.2531
 Site-MNIST-M                   (3) | Val  Loss: 2.0901 | Val  Acc: 0.3000
 Site-MNIST-M                   (3) | Val  Loss: 2.1521 | Val  Acc: 0.2515
 Site-SVHN                      (4) | Val  Loss: 2.1180 | Val  Acc: 0.2270
Average Valid Accuracy: 0.5036
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5789
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.4571
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.4603
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5221
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6127
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5842
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5710
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5500
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.6111
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.7031
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.7241
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.7238
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.6720
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.3467
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.3309
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.2531
 Best site-MNIST-M                  (3)  | Epoch:0 | Val Acc: 0.3000
 Best site-MNIST-M                  (3)  | Epoch:0 | Val Acc: 0.2515
 Best site-SVHN                     (4)  | Epoch:0 | Val Acc: 0.2270
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 10, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                    | Train Loss: 1.3072 | Train Acc: 0.6923
 Site-MNIST                    | Train Loss: 1.1627 | Train Acc: 0.7500
 Site-MNIST                    | Train Loss: 1.1648 | Train Acc: 0.7442
 Site-MNIST                    | Train Loss: 1.2309 | Train Acc: 0.7922
 Site-MNIST                    | Train Loss: 1.1293 | Train Acc: 0.7857
 Site-MNIST                    | Train Loss: 1.1629 | Train Acc: 0.7500
 Site-MNIST                    | Train Loss: 1.2228 | Train Acc: 0.7291
 Site-MNIST                    | Train Loss: 1.2037 | Train Acc: 0.7286
 Site-MNIST                    | Train Loss: 1.1743 | Train Acc: 0.7346
 Site-MNIST                    | Train Loss: 1.1962 | Train Acc: 0.7276
 Site-USPS                     | Train Loss: 1.0625 | Train Acc: 0.7750
 Site-USPS                     | Train Loss: 1.0831 | Train Acc: 0.7361
 Site-USPS                     | Train Loss: 1.0855 | Train Acc: 0.7761
 Site-USPS                     | Train Loss: 1.1009 | Train Acc: 0.7580
 Site-USPS                     | Train Loss: 1.1519 | Train Acc: 0.7607
 Site-USPS                     | Train Loss: 1.0767 | Train Acc: 0.7852
 Site-SynthDigits              | Train Loss: 1.8142 | Train Acc: 0.3894
 Site-SynthDigits              | Train Loss: 1.7807 | Train Acc: 0.4022
 Site-SynthDigits              | Train Loss: 1.7317 | Train Acc: 0.4157
 Site-MNIST-M                  | Train Loss: 1.9677 | Train Acc: 0.3269
 Site-MNIST-M                  | Train Loss: 1.9980 | Train Acc: 0.3389
 Site-SVHN                     | Train Loss: 2.0022 | Train Acc: 0.3145
 Site-MNIST                     (1) | Val  Loss: 1.3618 | Val  Acc: 0.6667
 Site-MNIST                     (1) | Val  Loss: 0.9223 | Val  Acc: 0.8333
 Site-MNIST                     (1) | Val  Loss: 0.9992 | Val  Acc: 0.7000
 Site-MNIST                     (1) | Val  Loss: 0.9831 | Val  Acc: 0.7368
 Site-MNIST                     (1) | Val  Loss: 1.2543 | Val  Acc: 0.6571
 Site-MNIST                     (1) | Val  Loss: 1.3132 | Val  Acc: 0.6667
 Site-MNIST                     (1) | Val  Loss: 1.2845 | Val  Acc: 0.6903
 Site-MNIST                     (1) | Val  Loss: 1.1611 | Val  Acc: 0.7598
 Site-MNIST                     (1) | Val  Loss: 1.2155 | Val  Acc: 0.7283
 Site-MNIST                     (1) | Val  Loss: 1.2335 | Val  Acc: 0.7160
 Site-USPS                      (0) | Val  Loss: 1.1937 | Val  Acc: 0.7000
 Site-USPS                      (0) | Val  Loss: 1.0682 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.9868 | Val  Acc: 0.8281
 Site-USPS                      (0) | Val  Loss: 1.0552 | Val  Acc: 0.8017
 Site-USPS                      (0) | Val  Loss: 1.0558 | Val  Acc: 0.7810
 Site-USPS                      (0) | Val  Loss: 1.1471 | Val  Acc: 0.7407
 Site-SynthDigits               (2) | Val  Loss: 1.7429 | Val  Acc: 0.4667
 Site-SynthDigits               (2) | Val  Loss: 1.6899 | Val  Acc: 0.4632
 Site-SynthDigits               (2) | Val  Loss: 1.7851 | Val  Acc: 0.3918
 Site-MNIST-M                   (4) | Val  Loss: 1.8324 | Val  Acc: 0.4333
 Site-MNIST-M                   (4) | Val  Loss: 1.9167 | Val  Acc: 0.3436
 Site-SVHN                      (3) | Val  Loss: 1.9254 | Val  Acc: 0.3262
Average Valid Accuracy: 0.6459
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.8333
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7000
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7368
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.6571
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.6903
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7598
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7283
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7160
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7000
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.8281
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.8017
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7810
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7407
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.4667
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.4632
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3918
 Best site-MNIST-M                  (4)  | Epoch:1 | Val Acc: 0.4333
 Best site-MNIST-M                  (4)  | Epoch:1 | Val Acc: 0.3436
 Best site-SVHN                     (3)  | Epoch:1 | Val Acc: 0.3262
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                    | Train Loss: 1.1390 | Train Acc: 0.6923
 Site-MNIST                    | Train Loss: 0.9659 | Train Acc: 0.7917
 Site-MNIST                    | Train Loss: 0.9819 | Train Acc: 0.7907
 Site-MNIST                    | Train Loss: 0.9984 | Train Acc: 0.8571
 Site-MNIST                    | Train Loss: 0.9092 | Train Acc: 0.8071
 Site-MNIST                    | Train Loss: 1.0104 | Train Acc: 0.7937
 Site-MNIST                    | Train Loss: 1.0783 | Train Acc: 0.7687
 Site-MNIST                    | Train Loss: 1.0396 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.0490 | Train Acc: 0.7624
 Site-MNIST                    | Train Loss: 1.0296 | Train Acc: 0.7605
 Site-USPS                     | Train Loss: 0.7896 | Train Acc: 0.8000
 Site-USPS                     | Train Loss: 0.9157 | Train Acc: 0.8194
 Site-USPS                     | Train Loss: 0.8793 | Train Acc: 0.8069
 Site-USPS                     | Train Loss: 0.9188 | Train Acc: 0.8030
 Site-USPS                     | Train Loss: 0.9388 | Train Acc: 0.7988
 Site-USPS                     | Train Loss: 0.8793 | Train Acc: 0.8367
 Site-SynthDigits              | Train Loss: 1.6100 | Train Acc: 0.4851
 Site-SynthDigits              | Train Loss: 1.5562 | Train Acc: 0.4753
 Site-SynthDigits              | Train Loss: 1.4993 | Train Acc: 0.5122
 Site-MNIST-M                  | Train Loss: 1.7708 | Train Acc: 0.4203
 Site-MNIST-M                  | Train Loss: 1.8119 | Train Acc: 0.4229
 Site-SVHN                     | Train Loss: 1.8893 | Train Acc: 0.3693
 Site-MNIST                     (1) | Val  Loss: 0.9813 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.6737 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.8444 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.8029 | Val  Acc: 0.8421
 Site-MNIST                     (1) | Val  Loss: 1.0925 | Val  Acc: 0.7143
 Site-MNIST                     (1) | Val  Loss: 1.1480 | Val  Acc: 0.6984
 Site-MNIST                     (1) | Val  Loss: 1.1200 | Val  Acc: 0.7168
 Site-MNIST                     (1) | Val  Loss: 1.0035 | Val  Acc: 0.7598
 Site-MNIST                     (1) | Val  Loss: 1.0514 | Val  Acc: 0.7527
 Site-MNIST                     (1) | Val  Loss: 1.0648 | Val  Acc: 0.7598
 Site-USPS                      (2) | Val  Loss: 0.9903 | Val  Acc: 0.8000
 Site-USPS                      (2) | Val  Loss: 0.8503 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.7830 | Val  Acc: 0.8906
 Site-USPS                      (2) | Val  Loss: 0.8415 | Val  Acc: 0.8190
 Site-USPS                      (2) | Val  Loss: 0.8659 | Val  Acc: 0.7905
 Site-USPS                      (2) | Val  Loss: 0.9441 | Val  Acc: 0.7725
 Site-SynthDigits               (0) | Val  Loss: 1.4744 | Val  Acc: 0.5067
 Site-SynthDigits               (0) | Val  Loss: 1.4821 | Val  Acc: 0.5000
 Site-SynthDigits               (0) | Val  Loss: 1.5707 | Val  Acc: 0.4612
 Site-MNIST-M                   (3) | Val  Loss: 1.5948 | Val  Acc: 0.5333
 Site-MNIST-M                   (3) | Val  Loss: 1.7188 | Val  Acc: 0.4479
 Site-SVHN                      (4) | Val  Loss: 1.8437 | Val  Acc: 0.3759
Average Valid Accuracy: 0.7196
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.8421
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7143
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.6984
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7168
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7598
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7527
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7598
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.8000
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.8906
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.8190
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.7905
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.7725
 Best site-SynthDigits              (0)  | Epoch:2 | Val Acc: 0.5067
 Best site-SynthDigits              (0)  | Epoch:2 | Val Acc: 0.5000
 Best site-SynthDigits              (0)  | Epoch:2 | Val Acc: 0.4612
 Best site-MNIST-M                  (3)  | Epoch:2 | Val Acc: 0.5333
 Best site-MNIST-M                  (3)  | Epoch:2 | Val Acc: 0.4479
 Best site-SVHN                     (4)  | Epoch:2 | Val Acc: 0.3759
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 3 ============
cnt=[6, 1, 3, 3, 9, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                    | Train Loss: 0.9479 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.7757 | Train Acc: 0.8750
 Site-MNIST                    | Train Loss: 0.7766 | Train Acc: 0.8605
 Site-MNIST                    | Train Loss: 0.7715 | Train Acc: 0.8701
 Site-MNIST                    | Train Loss: 0.7870 | Train Acc: 0.8500
 Site-MNIST                    | Train Loss: 0.8455 | Train Acc: 0.8214
 Site-MNIST                    | Train Loss: 0.8616 | Train Acc: 0.8260
 Site-MNIST                    | Train Loss: 0.8631 | Train Acc: 0.8203
 Site-MNIST                    | Train Loss: 0.8426 | Train Acc: 0.8113
 Site-MNIST                    | Train Loss: 0.8492 | Train Acc: 0.8050
 Site-USPS                     | Train Loss: 0.6850 | Train Acc: 0.8375
 Site-USPS                     | Train Loss: 0.7939 | Train Acc: 0.8472
 Site-USPS                     | Train Loss: 0.7902 | Train Acc: 0.8263
 Site-USPS                     | Train Loss: 0.7879 | Train Acc: 0.8330
 Site-USPS                     | Train Loss: 0.8138 | Train Acc: 0.8214
 Site-USPS                     | Train Loss: 0.7503 | Train Acc: 0.8605
 Site-SynthDigits              | Train Loss: 1.4442 | Train Acc: 0.5446
 Site-SynthDigits              | Train Loss: 1.3906 | Train Acc: 0.5375
 Site-SynthDigits              | Train Loss: 1.3292 | Train Acc: 0.5722
 Site-MNIST-M                  | Train Loss: 1.6416 | Train Acc: 0.4780
 Site-MNIST-M                  | Train Loss: 1.6697 | Train Acc: 0.4718
 Site-SVHN                     | Train Loss: 1.8072 | Train Acc: 0.4064
 Site-MNIST                     (1) | Val  Loss: 0.6505 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 0.4549 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 0.6628 | Val  Acc: 0.9000
 Site-MNIST                     (4) | Val  Loss: 0.6268 | Val  Acc: 0.8947
 Site-MNIST                     (4) | Val  Loss: 0.9143 | Val  Acc: 0.8000
 Site-MNIST                     (4) | Val  Loss: 0.9733 | Val  Acc: 0.8095
 Site-MNIST                     (4) | Val  Loss: 0.9378 | Val  Acc: 0.7965
 Site-MNIST                     (4) | Val  Loss: 0.8313 | Val  Acc: 0.8235
 Site-MNIST                     (4) | Val  Loss: 0.8677 | Val  Acc: 0.8152
 Site-MNIST                     (4) | Val  Loss: 0.8775 | Val  Acc: 0.8157
 Site-USPS                      (0) | Val  Loss: 0.8439 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 0.7094 | Val  Acc: 0.8611
 Site-USPS                      (0) | Val  Loss: 0.6580 | Val  Acc: 0.8906
 Site-USPS                      (0) | Val  Loss: 0.6991 | Val  Acc: 0.8621
 Site-USPS                      (0) | Val  Loss: 0.7430 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.8128 | Val  Acc: 0.8175
 Site-SynthDigits               (2) | Val  Loss: 1.2692 | Val  Acc: 0.5467
 Site-SynthDigits               (2) | Val  Loss: 1.3173 | Val  Acc: 0.5588
 Site-SynthDigits               (2) | Val  Loss: 1.4011 | Val  Acc: 0.5306
 Site-MNIST-M                   (3) | Val  Loss: 1.4838 | Val  Acc: 0.5333
 Site-MNIST-M                   (3) | Val  Loss: 1.5909 | Val  Acc: 0.5031
 Site-SVHN                      (3) | Val  Loss: 1.7673 | Val  Acc: 0.4184
Average Valid Accuracy: 0.7643
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.9000
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8947
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8095
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.7965
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8235
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8152
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8157
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8611
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8906
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8621
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8175
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5467
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5588
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5306
 Best site-MNIST-M                  (3)  | Epoch:3 | Val Acc: 0.5333
 Best site-MNIST-M                  (3)  | Epoch:3 | Val Acc: 0.5031
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.4184
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 10, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                    | Train Loss: 0.9666 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.7077 | Train Acc: 0.8333
 Site-MNIST                    | Train Loss: 0.7078 | Train Acc: 0.8605
 Site-MNIST                    | Train Loss: 0.8728 | Train Acc: 0.8571
 Site-MNIST                    | Train Loss: 0.7586 | Train Acc: 0.8214
 Site-MNIST                    | Train Loss: 0.7903 | Train Acc: 0.7976
 Site-MNIST                    | Train Loss: 0.8199 | Train Acc: 0.8106
 Site-MNIST                    | Train Loss: 0.8092 | Train Acc: 0.8032
 Site-MNIST                    | Train Loss: 0.7597 | Train Acc: 0.7997
 Site-MNIST                    | Train Loss: 0.7956 | Train Acc: 0.7948
 Site-USPS                     | Train Loss: 0.6719 | Train Acc: 0.8500
 Site-USPS                     | Train Loss: 0.8031 | Train Acc: 0.8472
 Site-USPS                     | Train Loss: 0.7893 | Train Acc: 0.7992
 Site-USPS                     | Train Loss: 0.7478 | Train Acc: 0.8330
 Site-USPS                     | Train Loss: 0.7695 | Train Acc: 0.8167
 Site-USPS                     | Train Loss: 0.7097 | Train Acc: 0.8599
 Site-SynthDigits              | Train Loss: 1.2692 | Train Acc: 0.5974
 Site-SynthDigits              | Train Loss: 1.2176 | Train Acc: 0.6015
 Site-SynthDigits              | Train Loss: 1.1651 | Train Acc: 0.6657
 Site-MNIST-M                  | Train Loss: 1.5545 | Train Acc: 0.5220
 Site-MNIST-M                  | Train Loss: 1.5619 | Train Acc: 0.5008
 Site-SVHN                     | Train Loss: 1.6320 | Train Acc: 0.4717
 Site-MNIST                     (1) | Val  Loss: 0.5099 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.3968 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.6406 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.6147 | Val  Acc: 0.8947
 Site-MNIST                     (1) | Val  Loss: 0.8571 | Val  Acc: 0.7714
 Site-MNIST                     (1) | Val  Loss: 0.9304 | Val  Acc: 0.8095
 Site-MNIST                     (1) | Val  Loss: 0.8863 | Val  Acc: 0.7965
 Site-MNIST                     (1) | Val  Loss: 0.7817 | Val  Acc: 0.8088
 Site-MNIST                     (1) | Val  Loss: 0.8193 | Val  Acc: 0.7962
 Site-MNIST                     (1) | Val  Loss: 0.8184 | Val  Acc: 0.8006
 Site-USPS                      (3) | Val  Loss: 0.7920 | Val  Acc: 0.8000
 Site-USPS                      (3) | Val  Loss: 0.6523 | Val  Acc: 0.8611
 Site-USPS                      (3) | Val  Loss: 0.6145 | Val  Acc: 0.8906
 Site-USPS                      (3) | Val  Loss: 0.6502 | Val  Acc: 0.8966
 Site-USPS                      (3) | Val  Loss: 0.7235 | Val  Acc: 0.8381
 Site-USPS                      (3) | Val  Loss: 0.7808 | Val  Acc: 0.8042
 Site-SynthDigits               (2) | Val  Loss: 1.0967 | Val  Acc: 0.6133
 Site-SynthDigits               (2) | Val  Loss: 1.1682 | Val  Acc: 0.6029
 Site-SynthDigits               (2) | Val  Loss: 1.2369 | Val  Acc: 0.5878
 Site-MNIST-M                   (0) | Val  Loss: 1.4009 | Val  Acc: 0.5667
 Site-MNIST-M                   (0) | Val  Loss: 1.5134 | Val  Acc: 0.5583
 Site-SVHN                      (4) | Val  Loss: 1.6391 | Val  Acc: 0.4681
Average Valid Accuracy: 0.7757
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8947
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.7714
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8095
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.7965
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8088
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.7962
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8006
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8000
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8611
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8906
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8966
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8381
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8042
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.6133
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.6029
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5878
 Best site-MNIST-M                  (0)  | Epoch:4 | Val Acc: 0.5667
 Best site-MNIST-M                  (0)  | Epoch:4 | Val Acc: 0.5583
 Best site-SVHN                     (4)  | Epoch:4 | Val Acc: 0.4681
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 4, 6, 9, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                    | Train Loss: 0.7783 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.5711 | Train Acc: 0.8750
 Site-MNIST                    | Train Loss: 0.5747 | Train Acc: 0.8837
 Site-MNIST                    | Train Loss: 0.6969 | Train Acc: 0.8701
 Site-MNIST                    | Train Loss: 0.6099 | Train Acc: 0.8571
 Site-MNIST                    | Train Loss: 0.6591 | Train Acc: 0.8452
 Site-MNIST                    | Train Loss: 0.7019 | Train Acc: 0.8458
 Site-MNIST                    | Train Loss: 0.6763 | Train Acc: 0.8423
 Site-MNIST                    | Train Loss: 0.6333 | Train Acc: 0.8452
 Site-MNIST                    | Train Loss: 0.6572 | Train Acc: 0.8461
 Site-USPS                     | Train Loss: 0.6174 | Train Acc: 0.8625
 Site-USPS                     | Train Loss: 0.6739 | Train Acc: 0.8403
 Site-USPS                     | Train Loss: 0.5862 | Train Acc: 0.8185
 Site-USPS                     | Train Loss: 0.6837 | Train Acc: 0.8394
 Site-USPS                     | Train Loss: 0.7063 | Train Acc: 0.8214
 Site-USPS                     | Train Loss: 0.6460 | Train Acc: 0.8572
 Site-SynthDigits              | Train Loss: 1.2851 | Train Acc: 0.5644
 Site-SynthDigits              | Train Loss: 1.2146 | Train Acc: 0.5850
 Site-SynthDigits              | Train Loss: 1.1513 | Train Acc: 0.6514
 Site-MNIST-M                  | Train Loss: 1.3579 | Train Acc: 0.6044
 Site-MNIST-M                  | Train Loss: 1.3798 | Train Acc: 0.5924
 Site-SVHN                     | Train Loss: 1.7141 | Train Acc: 0.4399
 Site-MNIST                     (0) | Val  Loss: 0.3392 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.2500 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.4413 | Val  Acc: 0.9000
 Site-MNIST                     (3) | Val  Loss: 0.4552 | Val  Acc: 0.8421
 Site-MNIST                     (3) | Val  Loss: 0.7374 | Val  Acc: 0.7714
 Site-MNIST                     (3) | Val  Loss: 0.8029 | Val  Acc: 0.7619
 Site-MNIST                     (3) | Val  Loss: 0.7643 | Val  Acc: 0.8230
 Site-MNIST                     (3) | Val  Loss: 0.6580 | Val  Acc: 0.8382
 Site-MNIST                     (3) | Val  Loss: 0.6818 | Val  Acc: 0.8397
 Site-MNIST                     (3) | Val  Loss: 0.6802 | Val  Acc: 0.8414
 Site-USPS                      (2) | Val  Loss: 0.7124 | Val  Acc: 0.8000
 Site-USPS                      (2) | Val  Loss: 0.6166 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5724 | Val  Acc: 0.8438
 Site-USPS                      (2) | Val  Loss: 0.5902 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.6485 | Val  Acc: 0.8429
 Site-USPS                      (2) | Val  Loss: 0.7068 | Val  Acc: 0.8228
 Site-SynthDigits               (1) | Val  Loss: 1.1060 | Val  Acc: 0.6533
 Site-SynthDigits               (1) | Val  Loss: 1.1714 | Val  Acc: 0.6029
 Site-SynthDigits               (1) | Val  Loss: 1.2241 | Val  Acc: 0.5796
 Site-MNIST-M                   (4) | Val  Loss: 1.2478 | Val  Acc: 0.6111
 Site-MNIST-M                   (4) | Val  Loss: 1.3392 | Val  Acc: 0.5706
 Site-SVHN                      (1) | Val  Loss: 1.7256 | Val  Acc: 0.4397
Average Valid Accuracy: 0.7756
============ Train epoch 6 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                    | Train Loss: 0.8826 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.5828 | Train Acc: 0.8750
 Site-MNIST                    | Train Loss: 0.5646 | Train Acc: 0.8837
 Site-MNIST                    | Train Loss: 0.7198 | Train Acc: 0.8442
 Site-MNIST                    | Train Loss: 0.6164 | Train Acc: 0.8500
 Site-MNIST                    | Train Loss: 0.6630 | Train Acc: 0.8135
 Site-MNIST                    | Train Loss: 0.7319 | Train Acc: 0.8282
 Site-MNIST                    | Train Loss: 0.6832 | Train Acc: 0.8178
 Site-MNIST                    | Train Loss: 0.6505 | Train Acc: 0.8194
 Site-MNIST                    | Train Loss: 0.6726 | Train Acc: 0.8216
 Site-USPS                     | Train Loss: 0.6096 | Train Acc: 0.9000
 Site-USPS                     | Train Loss: 0.5508 | Train Acc: 0.8681
 Site-USPS                     | Train Loss: 0.6928 | Train Acc: 0.8108
 Site-USPS                     | Train Loss: 0.6265 | Train Acc: 0.8394
 Site-USPS                     | Train Loss: 0.6511 | Train Acc: 0.8393
 Site-USPS                     | Train Loss: 0.5957 | Train Acc: 0.8638
 Site-SynthDigits              | Train Loss: 1.0417 | Train Acc: 0.6832
 Site-SynthDigits              | Train Loss: 1.0273 | Train Acc: 0.6581
 Site-SynthDigits              | Train Loss: 0.9554 | Train Acc: 0.7175
 Site-MNIST-M                  | Train Loss: 1.4024 | Train Acc: 0.5742
 Site-MNIST-M                  | Train Loss: 1.4165 | Train Acc: 0.5496
 Site-SVHN                     | Train Loss: 1.4239 | Train Acc: 0.5159
 Site-MNIST                     (0) | Val  Loss: 0.3111 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2179 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5121 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.4834 | Val  Acc: 0.8947
 Site-MNIST                     (0) | Val  Loss: 0.7374 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.8169 | Val  Acc: 0.8095
 Site-MNIST                     (0) | Val  Loss: 0.7650 | Val  Acc: 0.8407
 Site-MNIST                     (0) | Val  Loss: 0.6755 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.7024 | Val  Acc: 0.8016
 Site-MNIST                     (0) | Val  Loss: 0.6908 | Val  Acc: 0.8112
 Site-USPS                      (1) | Val  Loss: 0.6726 | Val  Acc: 0.8000
 Site-USPS                      (1) | Val  Loss: 0.5148 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.4901 | Val  Acc: 0.9062
 Site-USPS                      (1) | Val  Loss: 0.5214 | Val  Acc: 0.8966
 Site-USPS                      (1) | Val  Loss: 0.6075 | Val  Acc: 0.8381
 Site-USPS                      (1) | Val  Loss: 0.6684 | Val  Acc: 0.8122
 Site-SynthDigits               (2) | Val  Loss: 0.9203 | Val  Acc: 0.6800
 Site-SynthDigits               (2) | Val  Loss: 0.9546 | Val  Acc: 0.6691
 Site-SynthDigits               (2) | Val  Loss: 1.0325 | Val  Acc: 0.6653
 Site-MNIST-M                   (3) | Val  Loss: 1.2724 | Val  Acc: 0.5889
 Site-MNIST-M                   (3) | Val  Loss: 1.3431 | Val  Acc: 0.5583
 Site-SVHN                      (4) | Val  Loss: 1.4133 | Val  Acc: 0.5106
Average Valid Accuracy: 0.7957
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.9000
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8947
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8095
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8407
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8333
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8016
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8112
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8000
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.9062
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8966
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8381
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8122
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6800
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6691
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6653
 Best site-MNIST-M                  (3)  | Epoch:6 | Val Acc: 0.5889
 Best site-MNIST-M                  (3)  | Epoch:6 | Val Acc: 0.5583
 Best site-SVHN                     (4)  | Epoch:6 | Val Acc: 0.5106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                    | Train Loss: 0.7644 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.4537 | Train Acc: 0.9167
 Site-MNIST                    | Train Loss: 0.4630 | Train Acc: 0.8837
 Site-MNIST                    | Train Loss: 0.5018 | Train Acc: 0.8831
 Site-MNIST                    | Train Loss: 0.5471 | Train Acc: 0.9000
 Site-MNIST                    | Train Loss: 0.5673 | Train Acc: 0.8532
 Site-MNIST                    | Train Loss: 0.5911 | Train Acc: 0.8722
 Site-MNIST                    | Train Loss: 0.5820 | Train Acc: 0.8643
 Site-MNIST                    | Train Loss: 0.5468 | Train Acc: 0.8744
 Site-MNIST                    | Train Loss: 0.5686 | Train Acc: 0.8744
 Site-USPS                     | Train Loss: 0.5283 | Train Acc: 0.8875
 Site-USPS                     | Train Loss: 0.6021 | Train Acc: 0.8681
 Site-USPS                     | Train Loss: 0.5179 | Train Acc: 0.8224
 Site-USPS                     | Train Loss: 0.6178 | Train Acc: 0.8351
 Site-USPS                     | Train Loss: 0.6167 | Train Acc: 0.8476
 Site-USPS                     | Train Loss: 0.5597 | Train Acc: 0.8784
 Site-SynthDigits              | Train Loss: 0.9857 | Train Acc: 0.6733
 Site-SynthDigits              | Train Loss: 0.9522 | Train Acc: 0.7038
 Site-SynthDigits              | Train Loss: 0.8816 | Train Acc: 0.7541
 Site-MNIST-M                  | Train Loss: 1.2775 | Train Acc: 0.5989
 Site-MNIST-M                  | Train Loss: 1.3043 | Train Acc: 0.6092
 Site-SVHN                     | Train Loss: 1.3498 | Train Acc: 0.5654
 Site-MNIST                     (1) | Val  Loss: 0.2332 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1724 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.3758 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3955 | Val  Acc: 0.8421
 Site-MNIST                     (1) | Val  Loss: 0.6404 | Val  Acc: 0.8286
 Site-MNIST                     (1) | Val  Loss: 0.7152 | Val  Acc: 0.8413
 Site-MNIST                     (1) | Val  Loss: 0.6663 | Val  Acc: 0.8584
 Site-MNIST                     (1) | Val  Loss: 0.5714 | Val  Acc: 0.8725
 Site-MNIST                     (1) | Val  Loss: 0.5974 | Val  Acc: 0.8478
 Site-MNIST                     (1) | Val  Loss: 0.5831 | Val  Acc: 0.8595
 Site-USPS                      (2) | Val  Loss: 0.6237 | Val  Acc: 0.8000
 Site-USPS                      (2) | Val  Loss: 0.4972 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.4765 | Val  Acc: 0.9062
 Site-USPS                      (2) | Val  Loss: 0.4928 | Val  Acc: 0.8879
 Site-USPS                      (2) | Val  Loss: 0.5733 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.6237 | Val  Acc: 0.8254
 Site-SynthDigits               (3) | Val  Loss: 0.8499 | Val  Acc: 0.7333
 Site-SynthDigits               (3) | Val  Loss: 0.8769 | Val  Acc: 0.7132
 Site-SynthDigits               (3) | Val  Loss: 0.9365 | Val  Acc: 0.7184
 Site-MNIST-M                   (0) | Val  Loss: 1.1817 | Val  Acc: 0.6222
 Site-MNIST-M                   (0) | Val  Loss: 1.2544 | Val  Acc: 0.5828
 Site-SVHN                      (4) | Val  Loss: 1.3360 | Val  Acc: 0.5319
Average Valid Accuracy: 0.8134
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8421
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8286
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8413
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8584
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8725
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8478
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8595
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.8000
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.9062
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.8879
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.8254
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.7333
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.7132
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.7184
 Best site-MNIST-M                  (0)  | Epoch:7 | Val Acc: 0.6222
 Best site-MNIST-M                  (0)  | Epoch:7 | Val Acc: 0.5828
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.5319
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                    | Train Loss: 0.7339 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.4497 | Train Acc: 0.9167
 Site-MNIST                    | Train Loss: 0.4351 | Train Acc: 0.8837
 Site-MNIST                    | Train Loss: 0.4883 | Train Acc: 0.8831
 Site-MNIST                    | Train Loss: 0.5210 | Train Acc: 0.8786
 Site-MNIST                    | Train Loss: 0.5335 | Train Acc: 0.8611
 Site-MNIST                    | Train Loss: 0.5542 | Train Acc: 0.8612
 Site-MNIST                    | Train Loss: 0.5567 | Train Acc: 0.8557
 Site-MNIST                    | Train Loss: 0.5095 | Train Acc: 0.8690
 Site-MNIST                    | Train Loss: 0.5404 | Train Acc: 0.8638
 Site-USPS                     | Train Loss: 0.5172 | Train Acc: 0.9000
 Site-USPS                     | Train Loss: 0.5459 | Train Acc: 0.8889
 Site-USPS                     | Train Loss: 0.6082 | Train Acc: 0.8185
 Site-USPS                     | Train Loss: 0.5598 | Train Acc: 0.8458
 Site-USPS                     | Train Loss: 0.5719 | Train Acc: 0.8440
 Site-USPS                     | Train Loss: 0.5322 | Train Acc: 0.8751
 Site-SynthDigits              | Train Loss: 0.9169 | Train Acc: 0.7030
 Site-SynthDigits              | Train Loss: 0.9083 | Train Acc: 0.7093
 Site-SynthDigits              | Train Loss: 0.8245 | Train Acc: 0.7693
 Site-MNIST-M                  | Train Loss: 1.1842 | Train Acc: 0.6456
 Site-MNIST-M                  | Train Loss: 1.2184 | Train Acc: 0.6366
 Site-SVHN                     | Train Loss: 1.3029 | Train Acc: 0.5601
 Site-MNIST                     (1) | Val  Loss: 0.1878 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1265 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.3450 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3547 | Val  Acc: 0.8421
 Site-MNIST                     (1) | Val  Loss: 0.6091 | Val  Acc: 0.7714
 Site-MNIST                     (1) | Val  Loss: 0.6921 | Val  Acc: 0.8095
 Site-MNIST                     (1) | Val  Loss: 0.6459 | Val  Acc: 0.8407
 Site-MNIST                     (1) | Val  Loss: 0.5589 | Val  Acc: 0.8676
 Site-MNIST                     (1) | Val  Loss: 0.5748 | Val  Acc: 0.8424
 Site-MNIST                     (1) | Val  Loss: 0.5614 | Val  Acc: 0.8505
 Site-USPS                      (2) | Val  Loss: 0.5610 | Val  Acc: 0.8500
 Site-USPS                      (2) | Val  Loss: 0.4488 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.4440 | Val  Acc: 0.9062
 Site-USPS                      (2) | Val  Loss: 0.4714 | Val  Acc: 0.9224
 Site-USPS                      (2) | Val  Loss: 0.5494 | Val  Acc: 0.8667
 Site-USPS                      (2) | Val  Loss: 0.6001 | Val  Acc: 0.8333
 Site-SynthDigits               (0) | Val  Loss: 0.7942 | Val  Acc: 0.7333
 Site-SynthDigits               (0) | Val  Loss: 0.8224 | Val  Acc: 0.7132
 Site-SynthDigits               (0) | Val  Loss: 0.8833 | Val  Acc: 0.7143
 Site-MNIST-M                   (3) | Val  Loss: 1.0796 | Val  Acc: 0.6667
 Site-MNIST-M                   (3) | Val  Loss: 1.1506 | Val  Acc: 0.6196
 Site-SVHN                      (4) | Val  Loss: 1.2831 | Val  Acc: 0.5532
Average Valid Accuracy: 0.8191
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8421
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.7714
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8095
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8407
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8676
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8424
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8505
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.8500
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.9062
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.9224
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.8667
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.8333
 Best site-SynthDigits              (0)  | Epoch:8 | Val Acc: 0.7333
 Best site-SynthDigits              (0)  | Epoch:8 | Val Acc: 0.7132
 Best site-SynthDigits              (0)  | Epoch:8 | Val Acc: 0.7143
 Best site-MNIST-M                  (3)  | Epoch:8 | Val Acc: 0.6667
 Best site-MNIST-M                  (3)  | Epoch:8 | Val Acc: 0.6196
 Best site-SVHN                     (4)  | Epoch:8 | Val Acc: 0.5532
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 6, 9, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                    | Train Loss: 0.6370 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.3886 | Train Acc: 0.9167
 Site-MNIST                    | Train Loss: 0.3855 | Train Acc: 0.9070
 Site-MNIST                    | Train Loss: 0.4470 | Train Acc: 0.8831
 Site-MNIST                    | Train Loss: 0.3987 | Train Acc: 0.9071
 Site-MNIST                    | Train Loss: 0.4682 | Train Acc: 0.8849
 Site-MNIST                    | Train Loss: 0.4611 | Train Acc: 0.8634
 Site-MNIST                    | Train Loss: 0.4933 | Train Acc: 0.8704
 Site-MNIST                    | Train Loss: 0.4504 | Train Acc: 0.8880
 Site-MNIST                    | Train Loss: 0.4745 | Train Acc: 0.8842
 Site-USPS                     | Train Loss: 0.3787 | Train Acc: 0.9000
 Site-USPS                     | Train Loss: 0.5043 | Train Acc: 0.9097
 Site-USPS                     | Train Loss: 0.5938 | Train Acc: 0.8147
 Site-USPS                     | Train Loss: 0.5182 | Train Acc: 0.8608
 Site-USPS                     | Train Loss: 0.5242 | Train Acc: 0.8500
 Site-USPS                     | Train Loss: 0.4802 | Train Acc: 0.8890
 Site-SynthDigits              | Train Loss: 0.9283 | Train Acc: 0.6865
 Site-SynthDigits              | Train Loss: 0.8992 | Train Acc: 0.7239
 Site-SynthDigits              | Train Loss: 0.8257 | Train Acc: 0.7703
 Site-MNIST-M                  | Train Loss: 1.0564 | Train Acc: 0.6896
 Site-MNIST-M                  | Train Loss: 1.0714 | Train Acc: 0.7038
 Site-SVHN                     | Train Loss: 1.3535 | Train Acc: 0.5636
 Site-MNIST                     (3) | Val  Loss: 0.1388 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0909 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.2765 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.3021 | Val  Acc: 0.8421
 Site-MNIST                     (2) | Val  Loss: 0.5594 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6359 | Val  Acc: 0.8254
 Site-MNIST                     (2) | Val  Loss: 0.5876 | Val  Acc: 0.8584
 Site-MNIST                     (2) | Val  Loss: 0.5060 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.5096 | Val  Acc: 0.8533
 Site-MNIST                     (2) | Val  Loss: 0.4960 | Val  Acc: 0.8640
 Site-USPS                      (1) | Val  Loss: 0.4998 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.4120 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.4107 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.4318 | Val  Acc: 0.9310
 Site-USPS                      (1) | Val  Loss: 0.5004 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.5462 | Val  Acc: 0.8492
 Site-SynthDigits               (4) | Val  Loss: 0.7871 | Val  Acc: 0.7333
 Site-SynthDigits               (4) | Val  Loss: 0.8188 | Val  Acc: 0.7353
 Site-SynthDigits               (4) | Val  Loss: 0.8747 | Val  Acc: 0.7388
 Site-MNIST-M                   (0) | Val  Loss: 0.9511 | Val  Acc: 0.7111
 Site-MNIST-M                   (0) | Val  Loss: 1.0390 | Val  Acc: 0.6564
 Site-SVHN                      (4) | Val  Loss: 1.3234 | Val  Acc: 0.5745
Average Valid Accuracy: 0.8354
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.9000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8421
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8254
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8584
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8533
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8640
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.9167
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.9219
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.9310
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.8857
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.8492
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7333
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7353
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7388
 Best site-MNIST-M                  (0)  | Epoch:9 | Val Acc: 0.7111
 Best site-MNIST-M                  (0)  | Epoch:9 | Val Acc: 0.6564
 Best site-SVHN                     (4)  | Epoch:9 | Val Acc: 0.5745
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
 Test site-MNIST                     (3)| Epoch:9 | Test Acc: 0.8822
 Test site-USPS                      (1)| Epoch:9 | Test Acc: 0.8817
 Test site-SynthDigits               (4)| Epoch:9 | Test Acc: 0.7230
 Test site-MNIST-M                   (0)| Epoch:9 | Test Acc: 0.6531
 Test site-MNIST-M                   (0)| Epoch:9 | Test Acc: 0.6531
 Test site-SVHN                      (4)| Epoch:9 | Test Acc: 0.5116
MNIST: 0.7295, USPS: 0.8817, SynthDigits: 0.7230, SVHN: 0.5116, 
Average Test Accuracy(group): 0.7114, Average Test Accuracy(individual): 0.8227,
domain CV=0.1851, cluster CV=nan, individual CV=0.1271, 
============ Train epoch 10 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                    | Train Loss: 0.7044 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.3864 | Train Acc: 0.9167
 Site-MNIST                    | Train Loss: 0.3691 | Train Acc: 0.9070
 Site-MNIST                    | Train Loss: 0.5508 | Train Acc: 0.8831
 Site-MNIST                    | Train Loss: 0.4632 | Train Acc: 0.9000
 Site-MNIST                    | Train Loss: 0.4666 | Train Acc: 0.8770
 Site-MNIST                    | Train Loss: 0.5389 | Train Acc: 0.8767
 Site-MNIST                    | Train Loss: 0.4912 | Train Acc: 0.8753
 Site-MNIST                    | Train Loss: 0.4539 | Train Acc: 0.8880
 Site-MNIST                    | Train Loss: 0.4709 | Train Acc: 0.8838
 Site-USPS                     | Train Loss: 0.4741 | Train Acc: 0.9250
 Site-USPS                     | Train Loss: 0.4398 | Train Acc: 0.8889
 Site-USPS                     | Train Loss: 0.4779 | Train Acc: 0.8263
 Site-USPS                     | Train Loss: 0.4953 | Train Acc: 0.8694
 Site-USPS                     | Train Loss: 0.5015 | Train Acc: 0.8607
 Site-USPS                     | Train Loss: 0.4559 | Train Acc: 0.8969
 Site-SynthDigits              | Train Loss: 0.8168 | Train Acc: 0.7492
 Site-SynthDigits              | Train Loss: 0.8239 | Train Acc: 0.7239
 Site-SynthDigits              | Train Loss: 0.7340 | Train Acc: 0.7866
 Site-MNIST-M                  | Train Loss: 1.0978 | Train Acc: 0.6731
 Site-MNIST-M                  | Train Loss: 1.1017 | Train Acc: 0.6763
 Site-SVHN                     | Train Loss: 1.2020 | Train Acc: 0.6060
 Site-MNIST                     (0) | Val  Loss: 0.1259 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2988 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.2992 | Val  Acc: 0.8947
 Site-MNIST                     (0) | Val  Loss: 0.5637 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6556 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.5925 | Val  Acc: 0.8319
 Site-MNIST                     (0) | Val  Loss: 0.5076 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.5053 | Val  Acc: 0.8641
 Site-MNIST                     (0) | Val  Loss: 0.4844 | Val  Acc: 0.8701
 Site-USPS                      (1) | Val  Loss: 0.4849 | Val  Acc: 0.8500
 Site-USPS                      (1) | Val  Loss: 0.3784 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.3733 | Val  Acc: 0.8906
 Site-USPS                      (1) | Val  Loss: 0.3968 | Val  Acc: 0.9224
 Site-USPS                      (1) | Val  Loss: 0.4678 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.5139 | Val  Acc: 0.8704
 Site-SynthDigits               (2) | Val  Loss: 0.7099 | Val  Acc: 0.8000
 Site-SynthDigits               (2) | Val  Loss: 0.7148 | Val  Acc: 0.7574
 Site-SynthDigits               (2) | Val  Loss: 0.7915 | Val  Acc: 0.7429
 Site-MNIST-M                   (3) | Val  Loss: 0.9959 | Val  Acc: 0.7000
 Site-MNIST-M                   (3) | Val  Loss: 1.0764 | Val  Acc: 0.6380
 Site-SVHN                      (4) | Val  Loss: 1.2333 | Val  Acc: 0.5674
Average Valid Accuracy: 0.8351
============ Train epoch 11 ============
cnt=[1, 6, 9, 2, 4, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                    | Train Loss: 0.5486 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.3218 | Train Acc: 0.9583
 Site-MNIST                    | Train Loss: 0.3256 | Train Acc: 0.9302
 Site-MNIST                    | Train Loss: 0.3320 | Train Acc: 0.9091
 Site-MNIST                    | Train Loss: 0.4273 | Train Acc: 0.9214
 Site-MNIST                    | Train Loss: 0.4098 | Train Acc: 0.9048
 Site-MNIST                    | Train Loss: 0.4324 | Train Acc: 0.8767
 Site-MNIST                    | Train Loss: 0.4290 | Train Acc: 0.8826
 Site-MNIST                    | Train Loss: 0.3794 | Train Acc: 0.9056
 Site-MNIST                    | Train Loss: 0.4105 | Train Acc: 0.8989
 Site-USPS                     | Train Loss: 0.4455 | Train Acc: 0.9125
 Site-USPS                     | Train Loss: 0.4778 | Train Acc: 0.9097
 Site-USPS                     | Train Loss: 0.5328 | Train Acc: 0.8340
 Site-USPS                     | Train Loss: 0.4874 | Train Acc: 0.8779
 Site-USPS                     | Train Loss: 0.4841 | Train Acc: 0.8560
 Site-USPS                     | Train Loss: 0.4332 | Train Acc: 0.9002
 Site-SynthDigits              | Train Loss: 0.8185 | Train Acc: 0.7426
 Site-SynthDigits              | Train Loss: 0.7999 | Train Acc: 0.7422
 Site-SynthDigits              | Train Loss: 0.7159 | Train Acc: 0.8120
 Site-MNIST-M                  | Train Loss: 0.9634 | Train Acc: 0.7115
 Site-MNIST-M                  | Train Loss: 0.9573 | Train Acc: 0.7344
 Site-SVHN                     | Train Loss: 1.2434 | Train Acc: 0.6042
 Site-MNIST                     (0) | Val  Loss: 0.0898 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0601 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.2129 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.2448 | Val  Acc: 0.8947
 Site-MNIST                     (2) | Val  Loss: 0.4979 | Val  Acc: 0.8286
 Site-MNIST                     (2) | Val  Loss: 0.5779 | Val  Acc: 0.8095
 Site-MNIST                     (2) | Val  Loss: 0.5353 | Val  Acc: 0.8319
 Site-MNIST                     (2) | Val  Loss: 0.4500 | Val  Acc: 0.8775
 Site-MNIST                     (2) | Val  Loss: 0.4459 | Val  Acc: 0.8668
 Site-MNIST                     (2) | Val  Loss: 0.4296 | Val  Acc: 0.8761
 Site-USPS                      (1) | Val  Loss: 0.4349 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.3686 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.3756 | Val  Acc: 0.9062
 Site-USPS                      (1) | Val  Loss: 0.3903 | Val  Acc: 0.9224
 Site-USPS                      (1) | Val  Loss: 0.4528 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.4924 | Val  Acc: 0.8677
 Site-SynthDigits               (4) | Val  Loss: 0.6834 | Val  Acc: 0.7733
 Site-SynthDigits               (4) | Val  Loss: 0.7180 | Val  Acc: 0.7500
 Site-SynthDigits               (4) | Val  Loss: 0.7577 | Val  Acc: 0.7551
 Site-MNIST-M                   (3) | Val  Loss: 0.8538 | Val  Acc: 0.7333
 Site-MNIST-M                   (3) | Val  Loss: 0.9543 | Val  Acc: 0.6933
 Site-SVHN                      (4) | Val  Loss: 1.2666 | Val  Acc: 0.5957
Average Valid Accuracy: 0.8454
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.9000
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8947
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8286
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8095
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8319
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8775
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8668
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8761
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.9167
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.9062
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.9224
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8677
 Best site-SynthDigits              (4)  | Epoch:11 | Val Acc: 0.7733
 Best site-SynthDigits              (4)  | Epoch:11 | Val Acc: 0.7500
 Best site-SynthDigits              (4)  | Epoch:11 | Val Acc: 0.7551
 Best site-MNIST-M                  (3)  | Epoch:11 | Val Acc: 0.7333
 Best site-MNIST-M                  (3)  | Epoch:11 | Val Acc: 0.6933
 Best site-SVHN                     (4)  | Epoch:11 | Val Acc: 0.5957
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                    | Train Loss: 0.5729 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.2987 | Train Acc: 0.9583
 Site-MNIST                    | Train Loss: 0.3055 | Train Acc: 0.9302
 Site-MNIST                    | Train Loss: 0.4663 | Train Acc: 0.8961
 Site-MNIST                    | Train Loss: 0.3964 | Train Acc: 0.9286
 Site-MNIST                    | Train Loss: 0.4018 | Train Acc: 0.9008
 Site-MNIST                    | Train Loss: 0.3962 | Train Acc: 0.8943
 Site-MNIST                    | Train Loss: 0.4199 | Train Acc: 0.8888
 Site-MNIST                    | Train Loss: 0.4054 | Train Acc: 0.9117
 Site-MNIST                    | Train Loss: 0.4025 | Train Acc: 0.9015
 Site-USPS                     | Train Loss: 0.4853 | Train Acc: 0.9375
 Site-USPS                     | Train Loss: 0.3946 | Train Acc: 0.8958
 Site-USPS                     | Train Loss: 0.4541 | Train Acc: 0.8456
 Site-USPS                     | Train Loss: 0.4398 | Train Acc: 0.8737
 Site-USPS                     | Train Loss: 0.4517 | Train Acc: 0.8655
 Site-USPS                     | Train Loss: 0.4162 | Train Acc: 0.8995
 Site-SynthDigits              | Train Loss: 0.7209 | Train Acc: 0.7789
 Site-SynthDigits              | Train Loss: 0.7069 | Train Acc: 0.7879
 Site-SynthDigits              | Train Loss: 0.6309 | Train Acc: 0.8323
 Site-MNIST-M                  | Train Loss: 1.0188 | Train Acc: 0.6868
 Site-MNIST-M                  | Train Loss: 0.9846 | Train Acc: 0.7084
 Site-SVHN                     | Train Loss: 1.0885 | Train Acc: 0.6449
 Site-MNIST                     (1) | Val  Loss: 0.0776 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0546 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.2152 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.2311 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.4749 | Val  Acc: 0.8286
 Site-MNIST                     (1) | Val  Loss: 0.5717 | Val  Acc: 0.8254
 Site-MNIST                     (1) | Val  Loss: 0.5235 | Val  Acc: 0.8496
 Site-MNIST                     (1) | Val  Loss: 0.4469 | Val  Acc: 0.8922
 Site-MNIST                     (1) | Val  Loss: 0.4381 | Val  Acc: 0.8723
 Site-MNIST                     (1) | Val  Loss: 0.4152 | Val  Acc: 0.8837
 Site-USPS                      (2) | Val  Loss: 0.4647 | Val  Acc: 0.8500
 Site-USPS                      (2) | Val  Loss: 0.3548 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.3538 | Val  Acc: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.3620 | Val  Acc: 0.9310
 Site-USPS                      (2) | Val  Loss: 0.4332 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.4730 | Val  Acc: 0.8704
 Site-SynthDigits               (3) | Val  Loss: 0.6055 | Val  Acc: 0.8667
 Site-SynthDigits               (3) | Val  Loss: 0.6359 | Val  Acc: 0.8088
 Site-SynthDigits               (3) | Val  Loss: 0.6744 | Val  Acc: 0.8122
 Site-MNIST-M                   (0) | Val  Loss: 0.9216 | Val  Acc: 0.6667
 Site-MNIST-M                   (0) | Val  Loss: 1.0219 | Val  Acc: 0.6626
 Site-SVHN                      (4) | Val  Loss: 1.1488 | Val  Acc: 0.5816
Average Valid Accuracy: 0.8538
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8286
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8254
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8496
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8922
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8723
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8837
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.8500
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.9219
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.9310
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.8952
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.8704
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.8667
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.8088
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.8122
 Best site-MNIST-M                  (0)  | Epoch:12 | Val Acc: 0.6667
 Best site-MNIST-M                  (0)  | Epoch:12 | Val Acc: 0.6626
 Best site-SVHN                     (4)  | Epoch:12 | Val Acc: 0.5816
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 6, 10, 3, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                    | Train Loss: 0.6080 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.3108 | Train Acc: 0.9583
 Site-MNIST                    | Train Loss: 0.3063 | Train Acc: 0.9535
 Site-MNIST                    | Train Loss: 0.3722 | Train Acc: 0.8831
 Site-MNIST                    | Train Loss: 0.3522 | Train Acc: 0.9143
 Site-MNIST                    | Train Loss: 0.3954 | Train Acc: 0.8929
 Site-MNIST                    | Train Loss: 0.4323 | Train Acc: 0.8899
 Site-MNIST                    | Train Loss: 0.4169 | Train Acc: 0.8851
 Site-MNIST                    | Train Loss: 0.4557 | Train Acc: 0.9043
 Site-MNIST                    | Train Loss: 0.3997 | Train Acc: 0.8959
 Site-USPS                     | Train Loss: 0.3026 | Train Acc: 0.9500
 Site-USPS                     | Train Loss: 0.4019 | Train Acc: 0.8958
 Site-USPS                     | Train Loss: 0.5481 | Train Acc: 0.8301
 Site-USPS                     | Train Loss: 0.4473 | Train Acc: 0.8715
 Site-USPS                     | Train Loss: 0.4549 | Train Acc: 0.8571
 Site-USPS                     | Train Loss: 0.4187 | Train Acc: 0.8883
 Site-SynthDigits              | Train Loss: 0.7181 | Train Acc: 0.7657
 Site-SynthDigits              | Train Loss: 0.7123 | Train Acc: 0.7623
 Site-SynthDigits              | Train Loss: 0.6250 | Train Acc: 0.8150
 Site-MNIST-M                  | Train Loss: 0.9571 | Train Acc: 0.7225
 Site-MNIST-M                  | Train Loss: 0.9478 | Train Acc: 0.7282
 Site-SVHN                     | Train Loss: 1.0728 | Train Acc: 0.6449
 Site-MNIST                     (2) | Val  Loss: 0.0714 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0483 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.2374 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.2418 | Val  Acc: 0.8947
 Site-MNIST                     (2) | Val  Loss: 0.4842 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.5756 | Val  Acc: 0.7937
 Site-MNIST                     (2) | Val  Loss: 0.5241 | Val  Acc: 0.8230
 Site-MNIST                     (2) | Val  Loss: 0.4536 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4375 | Val  Acc: 0.8804
 Site-MNIST                     (2) | Val  Loss: 0.4126 | Val  Acc: 0.8897
 Site-USPS                      (1) | Val  Loss: 0.4434 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.3449 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.3480 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.3623 | Val  Acc: 0.9224
 Site-USPS                      (1) | Val  Loss: 0.4382 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.4793 | Val  Acc: 0.8624
 Site-SynthDigits               (3) | Val  Loss: 0.6006 | Val  Acc: 0.8533
 Site-SynthDigits               (3) | Val  Loss: 0.6208 | Val  Acc: 0.7868
 Site-SynthDigits               (3) | Val  Loss: 0.6774 | Val  Acc: 0.7673
 Site-MNIST-M                   (0) | Val  Loss: 0.8730 | Val  Acc: 0.7111
 Site-MNIST-M                   (0) | Val  Loss: 0.9640 | Val  Acc: 0.6810
 Site-SVHN                      (4) | Val  Loss: 1.1479 | Val  Acc: 0.5887
Average Valid Accuracy: 0.8482
============ Train epoch 14 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                    | Train Loss: 0.5824 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.2727 | Train Acc: 0.9583
 Site-MNIST                    | Train Loss: 0.2846 | Train Acc: 0.9535
 Site-MNIST                    | Train Loss: 0.3236 | Train Acc: 0.8831
 Site-MNIST                    | Train Loss: 0.2578 | Train Acc: 0.9286
 Site-MNIST                    | Train Loss: 0.3759 | Train Acc: 0.8968
 Site-MNIST                    | Train Loss: 0.4222 | Train Acc: 0.9009
 Site-MNIST                    | Train Loss: 0.3926 | Train Acc: 0.8961
 Site-MNIST                    | Train Loss: 0.3447 | Train Acc: 0.9097
 Site-MNIST                    | Train Loss: 0.3717 | Train Acc: 0.9031
 Site-USPS                     | Train Loss: 0.3408 | Train Acc: 0.9500
 Site-USPS                     | Train Loss: 0.3848 | Train Acc: 0.9028
 Site-USPS                     | Train Loss: 0.4012 | Train Acc: 0.8417
 Site-USPS                     | Train Loss: 0.4303 | Train Acc: 0.8779
 Site-USPS                     | Train Loss: 0.4583 | Train Acc: 0.8619
 Site-USPS                     | Train Loss: 0.3962 | Train Acc: 0.8942
 Site-SynthDigits              | Train Loss: 0.6884 | Train Acc: 0.7789
 Site-SynthDigits              | Train Loss: 0.6715 | Train Acc: 0.7824
 Site-SynthDigits              | Train Loss: 0.5965 | Train Acc: 0.8303
 Site-MNIST-M                  | Train Loss: 0.9128 | Train Acc: 0.7225
 Site-MNIST-M                  | Train Loss: 0.8942 | Train Acc: 0.7359
 Site-SVHN                     | Train Loss: 1.0601 | Train Acc: 0.6466
 Site-MNIST                     (0) | Val  Loss: 0.0563 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0392 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2086 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.2172 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.4522 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.5435 | Val  Acc: 0.8413
 Site-MNIST                     (0) | Val  Loss: 0.4931 | Val  Acc: 0.8673
 Site-MNIST                     (0) | Val  Loss: 0.4306 | Val  Acc: 0.8971
 Site-MNIST                     (0) | Val  Loss: 0.4152 | Val  Acc: 0.8750
 Site-MNIST                     (0) | Val  Loss: 0.3894 | Val  Acc: 0.8943
 Site-USPS                      (1) | Val  Loss: 0.4318 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.3260 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.3284 | Val  Acc: 0.9062
 Site-USPS                      (1) | Val  Loss: 0.3407 | Val  Acc: 0.9310
 Site-USPS                      (1) | Val  Loss: 0.4179 | Val  Acc: 0.8905
 Site-USPS                      (1) | Val  Loss: 0.4577 | Val  Acc: 0.8757
 Site-SynthDigits               (2) | Val  Loss: 0.5762 | Val  Acc: 0.8667
 Site-SynthDigits               (2) | Val  Loss: 0.6083 | Val  Acc: 0.8162
 Site-SynthDigits               (2) | Val  Loss: 0.6512 | Val  Acc: 0.7755
 Site-MNIST-M                   (3) | Val  Loss: 0.8231 | Val  Acc: 0.7444
 Site-MNIST-M                   (3) | Val  Loss: 0.9222 | Val  Acc: 0.6933
 Site-SVHN                      (4) | Val  Loss: 1.1270 | Val  Acc: 0.5887
Average Valid Accuracy: 0.8629
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.9000
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.8413
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.8673
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.8971
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.8750
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.8943
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.9167
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.9062
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.9310
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8905
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8757
 Best site-SynthDigits              (2)  | Epoch:14 | Val Acc: 0.8667
 Best site-SynthDigits              (2)  | Epoch:14 | Val Acc: 0.8162
 Best site-SynthDigits              (2)  | Epoch:14 | Val Acc: 0.7755
 Best site-MNIST-M                  (3)  | Epoch:14 | Val Acc: 0.7444
 Best site-MNIST-M                  (3)  | Epoch:14 | Val Acc: 0.6933
 Best site-SVHN                     (4)  | Epoch:14 | Val Acc: 0.5887
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                    | Train Loss: 0.5524 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.2585 | Train Acc: 0.9583
 Site-MNIST                    | Train Loss: 0.2725 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.3529 | Train Acc: 0.9091
 Site-MNIST                    | Train Loss: 0.2921 | Train Acc: 0.9214
 Site-MNIST                    | Train Loss: 0.3615 | Train Acc: 0.9167
 Site-MNIST                    | Train Loss: 0.3905 | Train Acc: 0.9053
 Site-MNIST                    | Train Loss: 0.3757 | Train Acc: 0.9010
 Site-MNIST                    | Train Loss: 0.3332 | Train Acc: 0.9124
 Site-MNIST                    | Train Loss: 0.3622 | Train Acc: 0.9110
 Site-USPS                     | Train Loss: 0.3219 | Train Acc: 0.9625
 Site-USPS                     | Train Loss: 0.4156 | Train Acc: 0.9028
 Site-USPS                     | Train Loss: 0.4207 | Train Acc: 0.8340
 Site-USPS                     | Train Loss: 0.4138 | Train Acc: 0.8822
 Site-USPS                     | Train Loss: 0.4500 | Train Acc: 0.8655
 Site-USPS                     | Train Loss: 0.3831 | Train Acc: 0.8942
 Site-SynthDigits              | Train Loss: 0.6428 | Train Acc: 0.7822
 Site-SynthDigits              | Train Loss: 0.6523 | Train Acc: 0.8007
 Site-SynthDigits              | Train Loss: 0.5687 | Train Acc: 0.8404
 Site-MNIST-M                  | Train Loss: 0.8915 | Train Acc: 0.7253
 Site-MNIST-M                  | Train Loss: 0.8808 | Train Acc: 0.7359
 Site-SVHN                     | Train Loss: 1.0115 | Train Acc: 0.6484
 Site-MNIST                     (1) | Val  Loss: 0.0489 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1951 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.2031 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.4343 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.5279 | Val  Acc: 0.8413
 Site-MNIST                     (1) | Val  Loss: 0.4844 | Val  Acc: 0.8673
 Site-MNIST                     (1) | Val  Loss: 0.4145 | Val  Acc: 0.9069
 Site-MNIST                     (1) | Val  Loss: 0.3990 | Val  Acc: 0.8940
 Site-MNIST                     (1) | Val  Loss: 0.3728 | Val  Acc: 0.8988
 Site-USPS                      (3) | Val  Loss: 0.4342 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.3286 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.3273 | Val  Acc: 0.9219
 Site-USPS                      (3) | Val  Loss: 0.3268 | Val  Acc: 0.9397
 Site-USPS                      (3) | Val  Loss: 0.3964 | Val  Acc: 0.8952
 Site-USPS                      (3) | Val  Loss: 0.4403 | Val  Acc: 0.8757
 Site-SynthDigits               (0) | Val  Loss: 0.5388 | Val  Acc: 0.8667
 Site-SynthDigits               (0) | Val  Loss: 0.5658 | Val  Acc: 0.8235
 Site-SynthDigits               (0) | Val  Loss: 0.6074 | Val  Acc: 0.8082
 Site-MNIST-M                   (2) | Val  Loss: 0.8211 | Val  Acc: 0.7111
 Site-MNIST-M                   (2) | Val  Loss: 0.9138 | Val  Acc: 0.7178
 Site-SVHN                      (4) | Val  Loss: 1.0873 | Val  Acc: 0.6028
Average Valid Accuracy: 0.8678
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.8571
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.8413
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.8673
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9069
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.8940
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.8988
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.9167
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.9219
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.9397
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8952
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8757
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8667
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8235
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8082
 Best site-MNIST-M                  (2)  | Epoch:15 | Val Acc: 0.7111
 Best site-MNIST-M                  (2)  | Epoch:15 | Val Acc: 0.7178
 Best site-SVHN                     (4)  | Epoch:15 | Val Acc: 0.6028
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 9, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                    | Train Loss: 0.5264 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.2359 | Train Acc: 0.9583
 Site-MNIST                    | Train Loss: 0.2470 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.3789 | Train Acc: 0.9091
 Site-MNIST                    | Train Loss: 0.2590 | Train Acc: 0.9357
 Site-MNIST                    | Train Loss: 0.3403 | Train Acc: 0.9048
 Site-MNIST                    | Train Loss: 0.3233 | Train Acc: 0.9075
 Site-MNIST                    | Train Loss: 0.3515 | Train Acc: 0.9083
 Site-MNIST                    | Train Loss: 0.3421 | Train Acc: 0.9206
 Site-MNIST                    | Train Loss: 0.3356 | Train Acc: 0.9129
 Site-USPS                     | Train Loss: 0.3023 | Train Acc: 0.9625
 Site-USPS                     | Train Loss: 0.3346 | Train Acc: 0.9097
 Site-USPS                     | Train Loss: 0.4040 | Train Acc: 0.8417
 Site-USPS                     | Train Loss: 0.3905 | Train Acc: 0.8779
 Site-USPS                     | Train Loss: 0.4072 | Train Acc: 0.8631
 Site-USPS                     | Train Loss: 0.3647 | Train Acc: 0.8936
 Site-SynthDigits              | Train Loss: 0.6148 | Train Acc: 0.8020
 Site-SynthDigits              | Train Loss: 0.6115 | Train Acc: 0.8117
 Site-SynthDigits              | Train Loss: 0.5208 | Train Acc: 0.8648
 Site-MNIST-M                  | Train Loss: 0.8187 | Train Acc: 0.7610
 Site-MNIST-M                  | Train Loss: 0.8449 | Train Acc: 0.7710
 Site-SVHN                     | Train Loss: 1.0344 | Train Acc: 0.6519
 Site-MNIST                     (1) | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0260 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1893 | Val  Acc: 0.9000
 Site-MNIST                     (4) | Val  Loss: 0.1828 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.4077 | Val  Acc: 0.8857
 Site-MNIST                     (1) | Val  Loss: 0.4922 | Val  Acc: 0.8889
 Site-MNIST                     (1) | Val  Loss: 0.4566 | Val  Acc: 0.8850
 Site-MNIST                     (1) | Val  Loss: 0.3987 | Val  Acc: 0.8922
 Site-MNIST                     (1) | Val  Loss: 0.3777 | Val  Acc: 0.8913
 Site-MNIST                     (1) | Val  Loss: 0.3507 | Val  Acc: 0.9033
 Site-USPS                      (3) | Val  Loss: 0.3920 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.3067 | Val  Acc: 0.8889
 Site-USPS                      (3) | Val  Loss: 0.3074 | Val  Acc: 0.8906
 Site-USPS                      (3) | Val  Loss: 0.3121 | Val  Acc: 0.9224
 Site-USPS                      (3) | Val  Loss: 0.3802 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.4212 | Val  Acc: 0.8757
 Site-SynthDigits               (2) | Val  Loss: 0.5029 | Val  Acc: 0.8667
 Site-SynthDigits               (2) | Val  Loss: 0.5553 | Val  Acc: 0.8309
 Site-SynthDigits               (2) | Val  Loss: 0.5777 | Val  Acc: 0.8204
 Site-MNIST-M                   (0) | Val  Loss: 0.7429 | Val  Acc: 0.7444
 Site-MNIST-M                   (0) | Val  Loss: 0.8420 | Val  Acc: 0.7301
 Site-SVHN                      (0) | Val  Loss: 1.0966 | Val  Acc: 0.5816
Average Valid Accuracy: 0.8702
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9000
 Best site-MNIST                    (4)  | Epoch:16 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.8857
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.8889
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.8850
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.8922
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.8913
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9033
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8889
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8906
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.9224
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8757
 Best site-SynthDigits              (2)  | Epoch:16 | Val Acc: 0.8667
 Best site-SynthDigits              (2)  | Epoch:16 | Val Acc: 0.8309
 Best site-SynthDigits              (2)  | Epoch:16 | Val Acc: 0.8204
 Best site-MNIST-M                  (0)  | Epoch:16 | Val Acc: 0.7444
 Best site-MNIST-M                  (0)  | Epoch:16 | Val Acc: 0.7301
 Best site-SVHN                     (0)  | Epoch:16 | Val Acc: 0.5816
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 17 ============
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                    | Train Loss: 0.5020 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.2077 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.2288 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.3271 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.2757 | Train Acc: 0.9429
 Site-MNIST                    | Train Loss: 0.3287 | Train Acc: 0.9087
 Site-MNIST                    | Train Loss: 0.3058 | Train Acc: 0.9207
 Site-MNIST                    | Train Loss: 0.3359 | Train Acc: 0.9083
 Site-MNIST                    | Train Loss: 0.2939 | Train Acc: 0.9308
 Site-MNIST                    | Train Loss: 0.3203 | Train Acc: 0.9144
 Site-USPS                     | Train Loss: 0.3869 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.3463 | Train Acc: 0.9028
 Site-USPS                     | Train Loss: 0.5057 | Train Acc: 0.8456
 Site-USPS                     | Train Loss: 0.3892 | Train Acc: 0.8865
 Site-USPS                     | Train Loss: 0.3840 | Train Acc: 0.8738
 Site-USPS                     | Train Loss: 0.3547 | Train Acc: 0.9015
 Site-SynthDigits              | Train Loss: 0.5851 | Train Acc: 0.8119
 Site-SynthDigits              | Train Loss: 0.5801 | Train Acc: 0.8300
 Site-SynthDigits              | Train Loss: 0.4971 | Train Acc: 0.8679
 Site-MNIST-M                  | Train Loss: 0.8602 | Train Acc: 0.7390
 Site-MNIST-M                  | Train Loss: 0.8627 | Train Acc: 0.7618
 Site-SVHN                     | Train Loss: 0.9358 | Train Acc: 0.6943
 Site-MNIST                     (1) | Val  Loss: 0.0298 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0232 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1624 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1656 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3882 | Val  Acc: 0.9143
 Site-MNIST                     (1) | Val  Loss: 0.4760 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.4380 | Val  Acc: 0.8761
 Site-MNIST                     (1) | Val  Loss: 0.3814 | Val  Acc: 0.9069
 Site-MNIST                     (1) | Val  Loss: 0.3615 | Val  Acc: 0.8967
 Site-MNIST                     (1) | Val  Loss: 0.3328 | Val  Acc: 0.9094
 Site-USPS                      (2) | Val  Loss: 0.4093 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.3045 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.3010 | Val  Acc: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.2951 | Val  Acc: 0.9483
 Site-USPS                      (2) | Val  Loss: 0.3612 | Val  Acc: 0.9095
 Site-USPS                      (2) | Val  Loss: 0.4028 | Val  Acc: 0.8862
 Site-SynthDigits               (0) | Val  Loss: 0.4812 | Val  Acc: 0.8800
 Site-SynthDigits               (0) | Val  Loss: 0.5370 | Val  Acc: 0.8235
 Site-SynthDigits               (0) | Val  Loss: 0.5505 | Val  Acc: 0.8245
 Site-MNIST-M                   (3) | Val  Loss: 0.7695 | Val  Acc: 0.7333
 Site-MNIST-M                   (3) | Val  Loss: 0.8727 | Val  Acc: 0.7178
 Site-SVHN                      (4) | Val  Loss: 1.0270 | Val  Acc: 0.6383
Average Valid Accuracy: 0.8776
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9143
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.8571
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.8761
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9069
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.8967
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9094
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9219
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9483
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9095
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.8862
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8800
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8235
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8245
 Best site-MNIST-M                  (3)  | Epoch:17 | Val Acc: 0.7333
 Best site-MNIST-M                  (3)  | Epoch:17 | Val Acc: 0.7178
 Best site-SVHN                     (4)  | Epoch:17 | Val Acc: 0.6383
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 18 ============
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                    | Train Loss: 0.5085 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.2001 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.2264 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2460 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.2389 | Train Acc: 0.9429
 Site-MNIST                    | Train Loss: 0.3202 | Train Acc: 0.9167
 Site-MNIST                    | Train Loss: 0.3469 | Train Acc: 0.9119
 Site-MNIST                    | Train Loss: 0.3332 | Train Acc: 0.9108
 Site-MNIST                    | Train Loss: 0.2867 | Train Acc: 0.9294
 Site-MNIST                    | Train Loss: 0.3170 | Train Acc: 0.9132
 Site-USPS                     | Train Loss: 0.3226 | Train Acc: 0.9625
 Site-USPS                     | Train Loss: 0.3529 | Train Acc: 0.9028
 Site-USPS                     | Train Loss: 0.4341 | Train Acc: 0.8533
 Site-USPS                     | Train Loss: 0.3967 | Train Acc: 0.8801
 Site-USPS                     | Train Loss: 0.3989 | Train Acc: 0.8738
 Site-USPS                     | Train Loss: 0.3512 | Train Acc: 0.8982
 Site-SynthDigits              | Train Loss: 0.5847 | Train Acc: 0.8218
 Site-SynthDigits              | Train Loss: 0.5776 | Train Acc: 0.8227
 Site-SynthDigits              | Train Loss: 0.4916 | Train Acc: 0.8709
 Site-MNIST-M                  | Train Loss: 0.8125 | Train Acc: 0.7665
 Site-MNIST-M                  | Train Loss: 0.7853 | Train Acc: 0.7802
 Site-SVHN                     | Train Loss: 0.9300 | Train Acc: 0.7014
 Site-MNIST                     (0) | Val  Loss: 0.0270 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1609 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1623 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3800 | Val  Acc: 0.9143
 Site-MNIST                     (0) | Val  Loss: 0.4674 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.4321 | Val  Acc: 0.8761
 Site-MNIST                     (0) | Val  Loss: 0.3799 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.3579 | Val  Acc: 0.8913
 Site-MNIST                     (0) | Val  Loss: 0.3286 | Val  Acc: 0.9063
 Site-USPS                      (2) | Val  Loss: 0.3982 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2956 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.2946 | Val  Acc: 0.9062
 Site-USPS                      (2) | Val  Loss: 0.2924 | Val  Acc: 0.9397
 Site-USPS                      (2) | Val  Loss: 0.3634 | Val  Acc: 0.9095
 Site-USPS                      (2) | Val  Loss: 0.4053 | Val  Acc: 0.8836
 Site-SynthDigits               (1) | Val  Loss: 0.4738 | Val  Acc: 0.8667
 Site-SynthDigits               (1) | Val  Loss: 0.5327 | Val  Acc: 0.8162
 Site-SynthDigits               (1) | Val  Loss: 0.5412 | Val  Acc: 0.8245
 Site-MNIST-M                   (3) | Val  Loss: 0.7228 | Val  Acc: 0.7333
 Site-MNIST-M                   (3) | Val  Loss: 0.8293 | Val  Acc: 0.7239
 Site-SVHN                      (4) | Val  Loss: 1.0182 | Val  Acc: 0.6454
Average Valid Accuracy: 0.8749
============ Train epoch 19 ============
cnt=[1, 10, 6, 3, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                    | Train Loss: 0.5280 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1927 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.2143 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.3892 | Train Acc: 0.9091
 Site-MNIST                    | Train Loss: 0.2272 | Train Acc: 0.9286
 Site-MNIST                    | Train Loss: 0.3156 | Train Acc: 0.9127
 Site-MNIST                    | Train Loss: 0.2854 | Train Acc: 0.9163
 Site-MNIST                    | Train Loss: 0.3251 | Train Acc: 0.9071
 Site-MNIST                    | Train Loss: 0.2843 | Train Acc: 0.9274
 Site-MNIST                    | Train Loss: 0.3132 | Train Acc: 0.9178
 Site-USPS                     | Train Loss: 0.4008 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.3079 | Train Acc: 0.9028
 Site-USPS                     | Train Loss: 0.4467 | Train Acc: 0.8571
 Site-USPS                     | Train Loss: 0.3954 | Train Acc: 0.8908
 Site-USPS                     | Train Loss: 0.3901 | Train Acc: 0.8762
 Site-USPS                     | Train Loss: 0.3378 | Train Acc: 0.9028
 Site-SynthDigits              | Train Loss: 0.5668 | Train Acc: 0.8185
 Site-SynthDigits              | Train Loss: 0.5595 | Train Acc: 0.8410
 Site-SynthDigits              | Train Loss: 0.4791 | Train Acc: 0.8689
 Site-MNIST-M                  | Train Loss: 0.8108 | Train Acc: 0.7720
 Site-MNIST-M                  | Train Loss: 0.7749 | Train Acc: 0.7664
 Site-SVHN                     | Train Loss: 0.8813 | Train Acc: 0.7138
 Site-MNIST                     (1) | Val  Loss: 0.0236 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0194 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1705 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1635 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3759 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.4662 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.4233 | Val  Acc: 0.8850
 Site-MNIST                     (1) | Val  Loss: 0.3765 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.3516 | Val  Acc: 0.8967
 Site-MNIST                     (1) | Val  Loss: 0.3201 | Val  Acc: 0.9048
 Site-USPS                      (2) | Val  Loss: 0.4210 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2980 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.2901 | Val  Acc: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.2810 | Val  Acc: 0.9483
 Site-USPS                      (2) | Val  Loss: 0.3488 | Val  Acc: 0.9095
 Site-USPS                      (2) | Val  Loss: 0.3878 | Val  Acc: 0.8915
 Site-SynthDigits               (3) | Val  Loss: 0.4536 | Val  Acc: 0.8800
 Site-SynthDigits               (3) | Val  Loss: 0.5226 | Val  Acc: 0.8309
 Site-SynthDigits               (3) | Val  Loss: 0.5293 | Val  Acc: 0.8408
 Site-MNIST-M                   (4) | Val  Loss: 0.7212 | Val  Acc: 0.7444
 Site-MNIST-M                   (4) | Val  Loss: 0.8343 | Val  Acc: 0.7362
 Site-SVHN                      (0) | Val  Loss: 0.9694 | Val  Acc: 0.6241
Average Valid Accuracy: 0.8775
============ Train epoch 20 ============
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                    | Train Loss: 0.4935 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1804 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.2136 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2485 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1900 | Train Acc: 0.9500
 Site-MNIST                    | Train Loss: 0.3078 | Train Acc: 0.9167
 Site-MNIST                    | Train Loss: 0.3137 | Train Acc: 0.9207
 Site-MNIST                    | Train Loss: 0.3180 | Train Acc: 0.9095
 Site-MNIST                    | Train Loss: 0.2783 | Train Acc: 0.9321
 Site-MNIST                    | Train Loss: 0.3024 | Train Acc: 0.9140
 Site-USPS                     | Train Loss: 0.2708 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.3565 | Train Acc: 0.9028
 Site-USPS                     | Train Loss: 0.4323 | Train Acc: 0.8533
 Site-USPS                     | Train Loss: 0.3751 | Train Acc: 0.8929
 Site-USPS                     | Train Loss: 0.3778 | Train Acc: 0.8821
 Site-USPS                     | Train Loss: 0.3254 | Train Acc: 0.9095
 Site-SynthDigits              | Train Loss: 0.5483 | Train Acc: 0.8218
 Site-SynthDigits              | Train Loss: 0.5394 | Train Acc: 0.8483
 Site-SynthDigits              | Train Loss: 0.4577 | Train Acc: 0.8689
 Site-MNIST-M                  | Train Loss: 0.7547 | Train Acc: 0.7747
 Site-MNIST-M                  | Train Loss: 0.7385 | Train Acc: 0.7802
 Site-SVHN                     | Train Loss: 0.8776 | Train Acc: 0.7102
 Site-MNIST                     (0) | Val  Loss: 0.0210 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1552 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1564 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3697 | Val  Acc: 0.9143
 Site-MNIST                     (0) | Val  Loss: 0.4485 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.4090 | Val  Acc: 0.8850
 Site-MNIST                     (0) | Val  Loss: 0.3627 | Val  Acc: 0.9069
 Site-MNIST                     (0) | Val  Loss: 0.3448 | Val  Acc: 0.8913
 Site-MNIST                     (0) | Val  Loss: 0.3145 | Val  Acc: 0.9079
 Site-USPS                      (2) | Val  Loss: 0.4031 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2884 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.2795 | Val  Acc: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.2700 | Val  Acc: 0.9569
 Site-USPS                      (2) | Val  Loss: 0.3392 | Val  Acc: 0.9190
 Site-USPS                      (2) | Val  Loss: 0.3755 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.4356 | Val  Acc: 0.8800
 Site-SynthDigits               (1) | Val  Loss: 0.5039 | Val  Acc: 0.8309
 Site-SynthDigits               (1) | Val  Loss: 0.5108 | Val  Acc: 0.8449
 Site-MNIST-M                   (3) | Val  Loss: 0.6651 | Val  Acc: 0.7556
 Site-MNIST-M                   (3) | Val  Loss: 0.7751 | Val  Acc: 0.7362
 Site-SVHN                      (4) | Val  Loss: 0.9740 | Val  Acc: 0.6383
Average Valid Accuracy: 0.8825
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9143
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8730
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8850
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9069
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8913
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9079
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9219
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9569
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9190
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.8800
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.8309
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.8449
 Best site-MNIST-M                  (3)  | Epoch:20 | Val Acc: 0.7556
 Best site-MNIST-M                  (3)  | Epoch:20 | Val Acc: 0.7362
 Best site-SVHN                     (4)  | Epoch:20 | Val Acc: 0.6383
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 21 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                    | Train Loss: 0.5088 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1804 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.2107 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.3144 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.2607 | Train Acc: 0.9429
 Site-MNIST                    | Train Loss: 0.3033 | Train Acc: 0.9127
 Site-MNIST                    | Train Loss: 0.2977 | Train Acc: 0.9251
 Site-MNIST                    | Train Loss: 0.3101 | Train Acc: 0.9083
 Site-MNIST                    | Train Loss: 0.2704 | Train Acc: 0.9321
 Site-MNIST                    | Train Loss: 0.2959 | Train Acc: 0.9174
 Site-USPS                     | Train Loss: 0.2639 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2924 | Train Acc: 0.9028
 Site-USPS                     | Train Loss: 0.3689 | Train Acc: 0.8533
 Site-USPS                     | Train Loss: 0.3647 | Train Acc: 0.8908
 Site-USPS                     | Train Loss: 0.3817 | Train Acc: 0.8810
 Site-USPS                     | Train Loss: 0.3186 | Train Acc: 0.9028
 Site-SynthDigits              | Train Loss: 0.5541 | Train Acc: 0.8119
 Site-SynthDigits              | Train Loss: 0.5463 | Train Acc: 0.8282
 Site-SynthDigits              | Train Loss: 0.4624 | Train Acc: 0.8638
 Site-MNIST-M                  | Train Loss: 0.7304 | Train Acc: 0.7857
 Site-MNIST-M                  | Train Loss: 0.7064 | Train Acc: 0.8000
 Site-SVHN                     | Train Loss: 0.8517 | Train Acc: 0.7014
 Site-MNIST                     (0) | Val  Loss: 0.0186 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0153 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1651 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1592 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3671 | Val  Acc: 0.8857
 Site-MNIST                     (0) | Val  Loss: 0.4477 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.4069 | Val  Acc: 0.8850
 Site-MNIST                     (0) | Val  Loss: 0.3645 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.3377 | Val  Acc: 0.8859
 Site-MNIST                     (0) | Val  Loss: 0.3068 | Val  Acc: 0.9079
 Site-USPS                      (1) | Val  Loss: 0.3900 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2808 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2712 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.2613 | Val  Acc: 0.9569
 Site-USPS                      (1) | Val  Loss: 0.3306 | Val  Acc: 0.9095
 Site-USPS                      (1) | Val  Loss: 0.3696 | Val  Acc: 0.8862
 Site-SynthDigits               (2) | Val  Loss: 0.4526 | Val  Acc: 0.8800
 Site-SynthDigits               (2) | Val  Loss: 0.4925 | Val  Acc: 0.8235
 Site-SynthDigits               (2) | Val  Loss: 0.5151 | Val  Acc: 0.8245
 Site-MNIST-M                   (3) | Val  Loss: 0.6423 | Val  Acc: 0.7667
 Site-MNIST-M                   (3) | Val  Loss: 0.7549 | Val  Acc: 0.7362
 Site-SVHN                      (4) | Val  Loss: 0.9450 | Val  Acc: 0.6312
Average Valid Accuracy: 0.8795
============ Train epoch 22 ============
cnt=[9, 6, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                    | Train Loss: 0.4136 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1860 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.2088 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2116 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1895 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2902 | Train Acc: 0.9127
 Site-MNIST                    | Train Loss: 0.2821 | Train Acc: 0.9207
 Site-MNIST                    | Train Loss: 0.3015 | Train Acc: 0.9120
 Site-MNIST                    | Train Loss: 0.2584 | Train Acc: 0.9294
 Site-MNIST                    | Train Loss: 0.2889 | Train Acc: 0.9197
 Site-USPS                     | Train Loss: 0.3439 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.3014 | Train Acc: 0.9097
 Site-USPS                     | Train Loss: 0.3649 | Train Acc: 0.8610
 Site-USPS                     | Train Loss: 0.3374 | Train Acc: 0.9015
 Site-USPS                     | Train Loss: 0.3521 | Train Acc: 0.8798
 Site-USPS                     | Train Loss: 0.2983 | Train Acc: 0.9075
 Site-SynthDigits              | Train Loss: 0.5345 | Train Acc: 0.8317
 Site-SynthDigits              | Train Loss: 0.5231 | Train Acc: 0.8501
 Site-SynthDigits              | Train Loss: 0.4351 | Train Acc: 0.8801
 Site-MNIST-M                  | Train Loss: 0.6795 | Train Acc: 0.8159
 Site-MNIST-M                  | Train Loss: 0.6601 | Train Acc: 0.8092
 Site-SVHN                     | Train Loss: 0.8947 | Train Acc: 0.6961
 Site-MNIST                     (4) | Val  Loss: 0.0146 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1592 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1548 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3681 | Val  Acc: 0.9143
 Site-MNIST                     (0) | Val  Loss: 0.4362 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.3992 | Val  Acc: 0.8938
 Site-MNIST                     (0) | Val  Loss: 0.3465 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.3251 | Val  Acc: 0.8967
 Site-MNIST                     (0) | Val  Loss: 0.2972 | Val  Acc: 0.9109
 Site-USPS                      (1) | Val  Loss: 0.3593 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2705 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.2593 | Val  Acc: 0.9062
 Site-USPS                      (1) | Val  Loss: 0.2500 | Val  Acc: 0.9483
 Site-USPS                      (1) | Val  Loss: 0.3078 | Val  Acc: 0.9095
 Site-USPS                      (1) | Val  Loss: 0.3482 | Val  Acc: 0.8942
 Site-SynthDigits               (3) | Val  Loss: 0.4248 | Val  Acc: 0.8800
 Site-SynthDigits               (3) | Val  Loss: 0.4785 | Val  Acc: 0.8309
 Site-SynthDigits               (3) | Val  Loss: 0.4875 | Val  Acc: 0.8490
 Site-MNIST-M                   (2) | Val  Loss: 0.5766 | Val  Acc: 0.8111
 Site-MNIST-M                   (2) | Val  Loss: 0.6974 | Val  Acc: 0.7546
 Site-SVHN                      (3) | Val  Loss: 0.9978 | Val  Acc: 0.6241
Average Valid Accuracy: 0.8838
 Best site-MNIST                    (4)  | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9000
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9143
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.8730
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.8938
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.8967
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9109
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9062
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9483
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9095
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.8942
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8800
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8309
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8490
 Best site-MNIST-M                  (2)  | Epoch:22 | Val Acc: 0.8111
 Best site-MNIST-M                  (2)  | Epoch:22 | Val Acc: 0.7546
 Best site-SVHN                     (3)  | Epoch:22 | Val Acc: 0.6241
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 23 ============
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                    | Train Loss: 0.4421 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1580 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1867 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2699 | Train Acc: 0.9091
 Site-MNIST                    | Train Loss: 0.1643 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2850 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2924 | Train Acc: 0.9295
 Site-MNIST                    | Train Loss: 0.2878 | Train Acc: 0.9156
 Site-MNIST                    | Train Loss: 0.2580 | Train Acc: 0.9362
 Site-MNIST                    | Train Loss: 0.2744 | Train Acc: 0.9253
 Site-USPS                     | Train Loss: 0.2435 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2713 | Train Acc: 0.9306
 Site-USPS                     | Train Loss: 0.3511 | Train Acc: 0.8764
 Site-USPS                     | Train Loss: 0.3307 | Train Acc: 0.9058
 Site-USPS                     | Train Loss: 0.3501 | Train Acc: 0.8833
 Site-USPS                     | Train Loss: 0.2978 | Train Acc: 0.9161
 Site-SynthDigits              | Train Loss: 0.5281 | Train Acc: 0.8218
 Site-SynthDigits              | Train Loss: 0.5184 | Train Acc: 0.8410
 Site-SynthDigits              | Train Loss: 0.4324 | Train Acc: 0.8720
 Site-MNIST-M                  | Train Loss: 0.7337 | Train Acc: 0.7940
 Site-MNIST-M                  | Train Loss: 0.6937 | Train Acc: 0.8137
 Site-SVHN                     | Train Loss: 0.8138 | Train Acc: 0.7332
 Site-MNIST                     (0) | Val  Loss: 0.0138 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1409 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1360 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3542 | Val  Acc: 0.8857
 Site-MNIST                     (0) | Val  Loss: 0.4313 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.3841 | Val  Acc: 0.9027
 Site-MNIST                     (0) | Val  Loss: 0.3381 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.3122 | Val  Acc: 0.9022
 Site-MNIST                     (0) | Val  Loss: 0.2814 | Val  Acc: 0.9184
 Site-USPS                      (2) | Val  Loss: 0.3837 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2715 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.2567 | Val  Acc: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.2429 | Val  Acc: 0.9483
 Site-USPS                      (2) | Val  Loss: 0.3050 | Val  Acc: 0.9143
 Site-USPS                      (2) | Val  Loss: 0.3416 | Val  Acc: 0.9021
 Site-SynthDigits               (1) | Val  Loss: 0.4244 | Val  Acc: 0.8800
 Site-SynthDigits               (1) | Val  Loss: 0.4785 | Val  Acc: 0.8309
 Site-SynthDigits               (1) | Val  Loss: 0.4876 | Val  Acc: 0.8490
 Site-MNIST-M                   (3) | Val  Loss: 0.6314 | Val  Acc: 0.7667
 Site-MNIST-M                   (3) | Val  Loss: 0.7450 | Val  Acc: 0.7362
 Site-SVHN                      (4) | Val  Loss: 0.9169 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8859
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9000
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.8857
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.8889
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9027
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9022
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9184
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9219
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9483
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9143
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9021
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.8800
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.8309
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.8490
 Best site-MNIST-M                  (3)  | Epoch:23 | Val Acc: 0.7667
 Best site-MNIST-M                  (3)  | Epoch:23 | Val Acc: 0.7362
 Best site-SVHN                     (4)  | Epoch:23 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 6, 2, 9, 4, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                    | Train Loss: 0.3792 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1575 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1870 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2783 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1852 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2784 | Train Acc: 0.9286
 Site-MNIST                    | Train Loss: 0.2528 | Train Acc: 0.9295
 Site-MNIST                    | Train Loss: 0.2799 | Train Acc: 0.9144
 Site-MNIST                    | Train Loss: 0.2416 | Train Acc: 0.9335
 Site-MNIST                    | Train Loss: 0.2694 | Train Acc: 0.9268
 Site-USPS                     | Train Loss: 0.3635 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2823 | Train Acc: 0.9375
 Site-USPS                     | Train Loss: 0.4279 | Train Acc: 0.8764
 Site-USPS                     | Train Loss: 0.3415 | Train Acc: 0.9036
 Site-USPS                     | Train Loss: 0.3272 | Train Acc: 0.8869
 Site-USPS                     | Train Loss: 0.2824 | Train Acc: 0.9128
 Site-SynthDigits              | Train Loss: 0.5070 | Train Acc: 0.8284
 Site-SynthDigits              | Train Loss: 0.5039 | Train Acc: 0.8464
 Site-SynthDigits              | Train Loss: 0.4184 | Train Acc: 0.8821
 Site-MNIST-M                  | Train Loss: 0.6702 | Train Acc: 0.7995
 Site-MNIST-M                  | Train Loss: 0.6422 | Train Acc: 0.8198
 Site-SVHN                     | Train Loss: 0.8619 | Train Acc: 0.7138
 Site-MNIST                     (0) | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.1364 | Val  Acc: 0.9000
 Site-MNIST                     (3) | Val  Loss: 0.1344 | Val  Acc: 0.9474
 Site-MNIST                     (3) | Val  Loss: 0.3458 | Val  Acc: 0.9143
 Site-MNIST                     (3) | Val  Loss: 0.4141 | Val  Acc: 0.8730
 Site-MNIST                     (3) | Val  Loss: 0.3745 | Val  Acc: 0.8938
 Site-MNIST                     (3) | Val  Loss: 0.3265 | Val  Acc: 0.9216
 Site-MNIST                     (3) | Val  Loss: 0.3050 | Val  Acc: 0.9049
 Site-MNIST                     (3) | Val  Loss: 0.2777 | Val  Acc: 0.9154
 Site-USPS                      (1) | Val  Loss: 0.3597 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2635 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2507 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.2359 | Val  Acc: 0.9569
 Site-USPS                      (1) | Val  Loss: 0.2932 | Val  Acc: 0.9238
 Site-USPS                      (1) | Val  Loss: 0.3298 | Val  Acc: 0.9074
 Site-SynthDigits               (4) | Val  Loss: 0.4017 | Val  Acc: 0.8800
 Site-SynthDigits               (4) | Val  Loss: 0.4693 | Val  Acc: 0.8309
 Site-SynthDigits               (4) | Val  Loss: 0.4669 | Val  Acc: 0.8490
 Site-MNIST-M                   (2) | Val  Loss: 0.5820 | Val  Acc: 0.8000
 Site-MNIST-M                   (2) | Val  Loss: 0.6957 | Val  Acc: 0.7546
 Site-SVHN                      (4) | Val  Loss: 0.9620 | Val  Acc: 0.6454
Average Valid Accuracy: 0.8889
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9000
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9474
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9143
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.8730
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.8938
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9216
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9049
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9154
 Best site-USPS                     (1)  | Epoch:24 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:24 | Val Acc: 0.9167
 Best site-USPS                     (1)  | Epoch:24 | Val Acc: 0.9219
 Best site-USPS                     (1)  | Epoch:24 | Val Acc: 0.9569
 Best site-USPS                     (1)  | Epoch:24 | Val Acc: 0.9238
 Best site-USPS                     (1)  | Epoch:24 | Val Acc: 0.9074
 Best site-SynthDigits              (4)  | Epoch:24 | Val Acc: 0.8800
 Best site-SynthDigits              (4)  | Epoch:24 | Val Acc: 0.8309
 Best site-SynthDigits              (4)  | Epoch:24 | Val Acc: 0.8490
 Best site-MNIST-M                  (2)  | Epoch:24 | Val Acc: 0.8000
 Best site-MNIST-M                  (2)  | Epoch:24 | Val Acc: 0.7546
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.6454
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 25 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                    | Train Loss: 0.4328 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1689 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1743 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.3889 | Train Acc: 0.9091
 Site-MNIST                    | Train Loss: 0.2130 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2767 | Train Acc: 0.9206
 Site-MNIST                    | Train Loss: 0.2523 | Train Acc: 0.9273
 Site-MNIST                    | Train Loss: 0.2819 | Train Acc: 0.9144
 Site-MNIST                    | Train Loss: 0.2459 | Train Acc: 0.9335
 Site-MNIST                    | Train Loss: 0.2676 | Train Acc: 0.9310
 Site-USPS                     | Train Loss: 0.2506 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2770 | Train Acc: 0.9097
 Site-USPS                     | Train Loss: 0.3307 | Train Acc: 0.8649
 Site-USPS                     | Train Loss: 0.3350 | Train Acc: 0.8994
 Site-USPS                     | Train Loss: 0.3342 | Train Acc: 0.8857
 Site-USPS                     | Train Loss: 0.2872 | Train Acc: 0.9128
 Site-SynthDigits              | Train Loss: 0.5210 | Train Acc: 0.8251
 Site-SynthDigits              | Train Loss: 0.5012 | Train Acc: 0.8501
 Site-SynthDigits              | Train Loss: 0.4122 | Train Acc: 0.8831
 Site-MNIST-M                  | Train Loss: 0.6795 | Train Acc: 0.8022
 Site-MNIST-M                  | Train Loss: 0.6776 | Train Acc: 0.8168
 Site-SVHN                     | Train Loss: 0.8149 | Train Acc: 0.7385
 Site-MNIST                     (0) | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0106 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1545 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1350 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3426 | Val  Acc: 0.8857
 Site-MNIST                     (0) | Val  Loss: 0.4292 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.3816 | Val  Acc: 0.8938
 Site-MNIST                     (0) | Val  Loss: 0.3389 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.3024 | Val  Acc: 0.9022
 Site-MNIST                     (0) | Val  Loss: 0.2726 | Val  Acc: 0.9169
 Site-USPS                      (1) | Val  Loss: 0.3664 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2582 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2461 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.2346 | Val  Acc: 0.9569
 Site-USPS                      (1) | Val  Loss: 0.2964 | Val  Acc: 0.9095
 Site-USPS                      (1) | Val  Loss: 0.3338 | Val  Acc: 0.9021
 Site-SynthDigits               (2) | Val  Loss: 0.4066 | Val  Acc: 0.8800
 Site-SynthDigits               (2) | Val  Loss: 0.4565 | Val  Acc: 0.8235
 Site-SynthDigits               (2) | Val  Loss: 0.4743 | Val  Acc: 0.8367
 Site-MNIST-M                   (3) | Val  Loss: 0.5918 | Val  Acc: 0.7778
 Site-MNIST-M                   (3) | Val  Loss: 0.6964 | Val  Acc: 0.7546
 Site-SVHN                      (4) | Val  Loss: 0.9151 | Val  Acc: 0.6809
Average Valid Accuracy: 0.8867
============ Train epoch 26 ============
cnt=[6, 9, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                    | Train Loss: 0.3756 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1689 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1763 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2616 | Train Acc: 0.9091
 Site-MNIST                    | Train Loss: 0.1657 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2672 | Train Acc: 0.9286
 Site-MNIST                    | Train Loss: 0.2791 | Train Acc: 0.9295
 Site-MNIST                    | Train Loss: 0.2763 | Train Acc: 0.9144
 Site-MNIST                    | Train Loss: 0.2520 | Train Acc: 0.9369
 Site-MNIST                    | Train Loss: 0.2583 | Train Acc: 0.9295
 Site-USPS                     | Train Loss: 0.2338 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2798 | Train Acc: 0.9375
 Site-USPS                     | Train Loss: 0.3322 | Train Acc: 0.8764
 Site-USPS                     | Train Loss: 0.3123 | Train Acc: 0.9101
 Site-USPS                     | Train Loss: 0.3109 | Train Acc: 0.8833
 Site-USPS                     | Train Loss: 0.2761 | Train Acc: 0.9128
 Site-SynthDigits              | Train Loss: 0.5012 | Train Acc: 0.8482
 Site-SynthDigits              | Train Loss: 0.4897 | Train Acc: 0.8702
 Site-SynthDigits              | Train Loss: 0.4028 | Train Acc: 0.8943
 Site-MNIST-M                  | Train Loss: 0.6170 | Train Acc: 0.8324
 Site-MNIST-M                  | Train Loss: 0.6085 | Train Acc: 0.8275
 Site-SVHN                     | Train Loss: 0.8489 | Train Acc: 0.7279
 Site-MNIST                     (4) | Val  Loss: 0.0098 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1480 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1331 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3397 | Val  Acc: 0.8857
 Site-MNIST                     (1) | Val  Loss: 0.4137 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.3719 | Val  Acc: 0.8850
 Site-MNIST                     (1) | Val  Loss: 0.3252 | Val  Acc: 0.9069
 Site-MNIST                     (1) | Val  Loss: 0.2960 | Val  Acc: 0.8995
 Site-MNIST                     (1) | Val  Loss: 0.2683 | Val  Acc: 0.9169
 Site-USPS                      (0) | Val  Loss: 0.3543 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.2542 | Val  Acc: 0.9167
 Site-USPS                      (0) | Val  Loss: 0.2391 | Val  Acc: 0.9219
 Site-USPS                      (0) | Val  Loss: 0.2258 | Val  Acc: 0.9483
 Site-USPS                      (0) | Val  Loss: 0.2820 | Val  Acc: 0.9095
 Site-USPS                      (0) | Val  Loss: 0.3207 | Val  Acc: 0.9101
 Site-SynthDigits               (2) | Val  Loss: 0.3882 | Val  Acc: 0.8933
 Site-SynthDigits               (2) | Val  Loss: 0.4500 | Val  Acc: 0.8382
 Site-SynthDigits               (2) | Val  Loss: 0.4539 | Val  Acc: 0.8653
 Site-MNIST-M                   (3) | Val  Loss: 0.5274 | Val  Acc: 0.8444
 Site-MNIST-M                   (3) | Val  Loss: 0.6427 | Val  Acc: 0.7853
 Site-SVHN                      (2) | Val  Loss: 0.9485 | Val  Acc: 0.6738
Average Valid Accuracy: 0.8919
 Best site-MNIST                    (4)  | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.8857
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.8730
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.8850
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9069
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.8995
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9169
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9167
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9219
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9483
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9095
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9101
 Best site-SynthDigits              (2)  | Epoch:26 | Val Acc: 0.8933
 Best site-SynthDigits              (2)  | Epoch:26 | Val Acc: 0.8382
 Best site-SynthDigits              (2)  | Epoch:26 | Val Acc: 0.8653
 Best site-MNIST-M                  (3)  | Epoch:26 | Val Acc: 0.8444
 Best site-MNIST-M                  (3)  | Epoch:26 | Val Acc: 0.7853
 Best site-SVHN                     (2)  | Epoch:26 | Val Acc: 0.6738
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 27 ============
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                    | Train Loss: 0.3942 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1388 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1645 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2014 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1818 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2621 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.2273 | Train Acc: 0.9361
 Site-MNIST                    | Train Loss: 0.2674 | Train Acc: 0.9181
 Site-MNIST                    | Train Loss: 0.2272 | Train Acc: 0.9362
 Site-MNIST                    | Train Loss: 0.2517 | Train Acc: 0.9313
 Site-USPS                     | Train Loss: 0.2324 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2372 | Train Acc: 0.9236
 Site-USPS                     | Train Loss: 0.3000 | Train Acc: 0.8803
 Site-USPS                     | Train Loss: 0.3211 | Train Acc: 0.9101
 Site-USPS                     | Train Loss: 0.3128 | Train Acc: 0.8893
 Site-USPS                     | Train Loss: 0.2781 | Train Acc: 0.9180
 Site-SynthDigits              | Train Loss: 0.4908 | Train Acc: 0.8449
 Site-SynthDigits              | Train Loss: 0.4802 | Train Acc: 0.8611
 Site-SynthDigits              | Train Loss: 0.3906 | Train Acc: 0.8923
 Site-MNIST-M                  | Train Loss: 0.6623 | Train Acc: 0.8049
 Site-MNIST-M                  | Train Loss: 0.6415 | Train Acc: 0.8290
 Site-SVHN                     | Train Loss: 0.7700 | Train Acc: 0.7544
 Site-MNIST                     (0) | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1343 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1228 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3372 | Val  Acc: 0.8857
 Site-MNIST                     (0) | Val  Loss: 0.4103 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.3598 | Val  Acc: 0.8938
 Site-MNIST                     (0) | Val  Loss: 0.3224 | Val  Acc: 0.9069
 Site-MNIST                     (0) | Val  Loss: 0.2887 | Val  Acc: 0.9076
 Site-MNIST                     (0) | Val  Loss: 0.2585 | Val  Acc: 0.9245
 Site-USPS                      (1) | Val  Loss: 0.3713 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2532 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2385 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.2248 | Val  Acc: 0.9569
 Site-USPS                      (1) | Val  Loss: 0.2890 | Val  Acc: 0.9190
 Site-USPS                      (1) | Val  Loss: 0.3217 | Val  Acc: 0.9048
 Site-SynthDigits               (3) | Val  Loss: 0.3729 | Val  Acc: 0.8933
 Site-SynthDigits               (3) | Val  Loss: 0.4436 | Val  Acc: 0.8309
 Site-SynthDigits               (3) | Val  Loss: 0.4514 | Val  Acc: 0.8571
 Site-MNIST-M                   (2) | Val  Loss: 0.5650 | Val  Acc: 0.7778
 Site-MNIST-M                   (2) | Val  Loss: 0.6835 | Val  Acc: 0.7485
 Site-SVHN                      (4) | Val  Loss: 0.8739 | Val  Acc: 0.6809
Average Valid Accuracy: 0.8892
============ Train epoch 28 ============
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                    | Train Loss: 0.4270 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1412 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1618 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.1774 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1622 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2622 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.2386 | Train Acc: 0.9317
 Site-MNIST                    | Train Loss: 0.2655 | Train Acc: 0.9169
 Site-MNIST                    | Train Loss: 0.2251 | Train Acc: 0.9382
 Site-MNIST                    | Train Loss: 0.2508 | Train Acc: 0.9313
 Site-USPS                     | Train Loss: 0.3749 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2725 | Train Acc: 0.9167
 Site-USPS                     | Train Loss: 0.3180 | Train Acc: 0.8687
 Site-USPS                     | Train Loss: 0.3128 | Train Acc: 0.9079
 Site-USPS                     | Train Loss: 0.3272 | Train Acc: 0.8869
 Site-USPS                     | Train Loss: 0.2786 | Train Acc: 0.9161
 Site-SynthDigits              | Train Loss: 0.5045 | Train Acc: 0.8482
 Site-SynthDigits              | Train Loss: 0.4648 | Train Acc: 0.8684
 Site-SynthDigits              | Train Loss: 0.3821 | Train Acc: 0.8974
 Site-MNIST-M                  | Train Loss: 0.6566 | Train Acc: 0.7995
 Site-MNIST-M                  | Train Loss: 0.6215 | Train Acc: 0.8321
 Site-SVHN                     | Train Loss: 0.7535 | Train Acc: 0.7703
 Site-MNIST                     (0) | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1302 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1226 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3263 | Val  Acc: 0.9143
 Site-MNIST                     (0) | Val  Loss: 0.4082 | Val  Acc: 0.9048
 Site-MNIST                     (0) | Val  Loss: 0.3628 | Val  Acc: 0.8761
 Site-MNIST                     (0) | Val  Loss: 0.3203 | Val  Acc: 0.9069
 Site-MNIST                     (0) | Val  Loss: 0.2875 | Val  Acc: 0.8995
 Site-MNIST                     (0) | Val  Loss: 0.2557 | Val  Acc: 0.9184
 Site-USPS                      (1) | Val  Loss: 0.3769 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2580 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2405 | Val  Acc: 0.9375
 Site-USPS                      (1) | Val  Loss: 0.2249 | Val  Acc: 0.9655
 Site-USPS                      (1) | Val  Loss: 0.2862 | Val  Acc: 0.9143
 Site-USPS                      (1) | Val  Loss: 0.3225 | Val  Acc: 0.8995
 Site-SynthDigits               (3) | Val  Loss: 0.3782 | Val  Acc: 0.8933
 Site-SynthDigits               (3) | Val  Loss: 0.4392 | Val  Acc: 0.8456
 Site-SynthDigits               (3) | Val  Loss: 0.4474 | Val  Acc: 0.8612
 Site-MNIST-M                   (2) | Val  Loss: 0.5544 | Val  Acc: 0.7778
 Site-MNIST-M                   (2) | Val  Loss: 0.6745 | Val  Acc: 0.7607
 Site-SVHN                      (4) | Val  Loss: 0.8599 | Val  Acc: 0.7021
Average Valid Accuracy: 0.8928
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9000
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9143
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9048
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.8761
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9069
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.8995
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9184
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.9167
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.9375
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.9655
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.9143
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.8995
 Best site-SynthDigits              (3)  | Epoch:28 | Val Acc: 0.8933
 Best site-SynthDigits              (3)  | Epoch:28 | Val Acc: 0.8456
 Best site-SynthDigits              (3)  | Epoch:28 | Val Acc: 0.8612
 Best site-MNIST-M                  (2)  | Epoch:28 | Val Acc: 0.7778
 Best site-MNIST-M                  (2)  | Epoch:28 | Val Acc: 0.7607
 Best site-SVHN                     (4)  | Epoch:28 | Val Acc: 0.7021
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 29 ============
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                    | Train Loss: 0.4302 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1464 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1717 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2479 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1920 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2625 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.2750 | Train Acc: 0.9273
 Site-MNIST                    | Train Loss: 0.2674 | Train Acc: 0.9181
 Site-MNIST                    | Train Loss: 0.2283 | Train Acc: 0.9369
 Site-MNIST                    | Train Loss: 0.2543 | Train Acc: 0.9280
 Site-USPS                     | Train Loss: 0.2146 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2334 | Train Acc: 0.9167
 Site-USPS                     | Train Loss: 0.3567 | Train Acc: 0.8764
 Site-USPS                     | Train Loss: 0.3051 | Train Acc: 0.9101
 Site-USPS                     | Train Loss: 0.3002 | Train Acc: 0.8905
 Site-USPS                     | Train Loss: 0.2679 | Train Acc: 0.9200
 Site-SynthDigits              | Train Loss: 0.4925 | Train Acc: 0.8548
 Site-SynthDigits              | Train Loss: 0.4704 | Train Acc: 0.8574
 Site-SynthDigits              | Train Loss: 0.3858 | Train Acc: 0.8841
 Site-MNIST-M                  | Train Loss: 0.6336 | Train Acc: 0.8104
 Site-MNIST-M                  | Train Loss: 0.6102 | Train Acc: 0.8244
 Site-SVHN                     | Train Loss: 0.7384 | Train Acc: 0.7739
 Site-MNIST                     (0) | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1460 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1390 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3500 | Val  Acc: 0.8857
 Site-MNIST                     (0) | Val  Loss: 0.4181 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.3635 | Val  Acc: 0.8938
 Site-MNIST                     (0) | Val  Loss: 0.3233 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.2917 | Val  Acc: 0.9076
 Site-MNIST                     (0) | Val  Loss: 0.2598 | Val  Acc: 0.9215
 Site-USPS                      (2) | Val  Loss: 0.3662 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2514 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.2337 | Val  Acc: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.2189 | Val  Acc: 0.9569
 Site-USPS                      (2) | Val  Loss: 0.2816 | Val  Acc: 0.9238
 Site-USPS                      (2) | Val  Loss: 0.3143 | Val  Acc: 0.9048
 Site-SynthDigits               (1) | Val  Loss: 0.3764 | Val  Acc: 0.9067
 Site-SynthDigits               (1) | Val  Loss: 0.4375 | Val  Acc: 0.8456
 Site-SynthDigits               (1) | Val  Loss: 0.4492 | Val  Acc: 0.8531
 Site-MNIST-M                   (3) | Val  Loss: 0.5356 | Val  Acc: 0.8111
 Site-MNIST-M                   (3) | Val  Loss: 0.6487 | Val  Acc: 0.7607
 Site-SVHN                      (4) | Val  Loss: 0.8508 | Val  Acc: 0.7234
Average Valid Accuracy: 0.8946
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9000
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.8857
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.8889
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.8938
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9076
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9215
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.9219
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.9569
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.9238
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.9048
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.9067
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8456
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8531
 Best site-MNIST-M                  (3)  | Epoch:29 | Val Acc: 0.8111
 Best site-MNIST-M                  (3)  | Epoch:29 | Val Acc: 0.7607
 Best site-SVHN                     (4)  | Epoch:29 | Val Acc: 0.7234
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
 Test site-MNIST                     (0)| Epoch:29 | Test Acc: 0.9266
 Test site-USPS                      (2)| Epoch:29 | Test Acc: 0.9086
 Test site-SynthDigits               (1)| Epoch:29 | Test Acc: 0.8706
 Test site-MNIST-M                   (3)| Epoch:29 | Test Acc: 0.7391
 Test site-MNIST-M                   (3)| Epoch:29 | Test Acc: 0.7391
 Test site-SVHN                      (4)| Epoch:29 | Test Acc: 0.6719
MNIST: 0.8016, USPS: 0.9086, SynthDigits: 0.8706, SVHN: 0.6719, 
Average Test Accuracy(group): 0.8132, Average Test Accuracy(individual): 0.8855,
domain CV=0.1108, cluster CV=0.1217, individual CV=0.0796, 
============ Train epoch 30 ============
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                    | Train Loss: 0.3914 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1278 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1620 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2447 | Train Acc: 0.9091
 Site-MNIST                    | Train Loss: 0.2109 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2551 | Train Acc: 0.9286
 Site-MNIST                    | Train Loss: 0.2509 | Train Acc: 0.9317
 Site-MNIST                    | Train Loss: 0.2601 | Train Acc: 0.9193
 Site-MNIST                    | Train Loss: 0.2246 | Train Acc: 0.9362
 Site-MNIST                    | Train Loss: 0.2476 | Train Acc: 0.9306
 Site-USPS                     | Train Loss: 0.2413 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2653 | Train Acc: 0.9444
 Site-USPS                     | Train Loss: 0.4285 | Train Acc: 0.8687
 Site-USPS                     | Train Loss: 0.3443 | Train Acc: 0.9058
 Site-USPS                     | Train Loss: 0.2947 | Train Acc: 0.8929
 Site-USPS                     | Train Loss: 0.2654 | Train Acc: 0.9180
 Site-SynthDigits              | Train Loss: 0.4628 | Train Acc: 0.8482
 Site-SynthDigits              | Train Loss: 0.4371 | Train Acc: 0.8775
 Site-SynthDigits              | Train Loss: 0.3542 | Train Acc: 0.8994
 Site-MNIST-M                  | Train Loss: 0.6155 | Train Acc: 0.8324
 Site-MNIST-M                  | Train Loss: 0.6026 | Train Acc: 0.8290
 Site-SVHN                     | Train Loss: 0.7375 | Train Acc: 0.7792
 Site-MNIST                     (1) | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1300 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1182 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3282 | Val  Acc: 0.8857
 Site-MNIST                     (1) | Val  Loss: 0.3924 | Val  Acc: 0.8889
 Site-MNIST                     (1) | Val  Loss: 0.3441 | Val  Acc: 0.9115
 Site-MNIST                     (1) | Val  Loss: 0.3098 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2863 | Val  Acc: 0.9130
 Site-MNIST                     (1) | Val  Loss: 0.2549 | Val  Acc: 0.9245
 Site-USPS                      (2) | Val  Loss: 0.3903 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2580 | Val  Acc: 0.9444
 Site-USPS                      (2) | Val  Loss: 0.2366 | Val  Acc: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.2146 | Val  Acc: 0.9569
 Site-USPS                      (2) | Val  Loss: 0.2844 | Val  Acc: 0.9286
 Site-USPS                      (2) | Val  Loss: 0.3143 | Val  Acc: 0.9048
 Site-SynthDigits               (0) | Val  Loss: 0.3462 | Val  Acc: 0.8933
 Site-SynthDigits               (0) | Val  Loss: 0.4222 | Val  Acc: 0.8456
 Site-SynthDigits               (0) | Val  Loss: 0.4157 | Val  Acc: 0.8694
 Site-MNIST-M                   (3) | Val  Loss: 0.5118 | Val  Acc: 0.8444
 Site-MNIST-M                   (3) | Val  Loss: 0.6283 | Val  Acc: 0.7853
 Site-SVHN                      (4) | Val  Loss: 0.8257 | Val  Acc: 0.7447
Average Valid Accuracy: 0.9014
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8857
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8889
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9115
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9130
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9245
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.9444
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.9219
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.9569
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.9286
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.9048
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8933
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8456
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8694
 Best site-MNIST-M                  (3)  | Epoch:30 | Val Acc: 0.8444
 Best site-MNIST-M                  (3)  | Epoch:30 | Val Acc: 0.7853
 Best site-SVHN                     (4)  | Epoch:30 | Val Acc: 0.7447
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 31 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                    | Train Loss: 0.4317 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1399 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1602 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.1711 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1472 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2531 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.2332 | Train Acc: 0.9295
 Site-MNIST                    | Train Loss: 0.2624 | Train Acc: 0.9193
 Site-MNIST                    | Train Loss: 0.2291 | Train Acc: 0.9389
 Site-MNIST                    | Train Loss: 0.2480 | Train Acc: 0.9291
 Site-USPS                     | Train Loss: 0.2200 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2088 | Train Acc: 0.9375
 Site-USPS                     | Train Loss: 0.3155 | Train Acc: 0.8726
 Site-USPS                     | Train Loss: 0.2975 | Train Acc: 0.9143
 Site-USPS                     | Train Loss: 0.3124 | Train Acc: 0.8905
 Site-USPS                     | Train Loss: 0.2605 | Train Acc: 0.9240
 Site-SynthDigits              | Train Loss: 0.4491 | Train Acc: 0.8482
 Site-SynthDigits              | Train Loss: 0.4493 | Train Acc: 0.8629
 Site-SynthDigits              | Train Loss: 0.3545 | Train Acc: 0.8963
 Site-MNIST-M                  | Train Loss: 0.5982 | Train Acc: 0.8352
 Site-MNIST-M                  | Train Loss: 0.5891 | Train Acc: 0.8427
 Site-SVHN                     | Train Loss: 0.7164 | Train Acc: 0.7809
 Site-MNIST                     (0) | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1508 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1318 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3316 | Val  Acc: 0.8857
 Site-MNIST                     (0) | Val  Loss: 0.3996 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.3509 | Val  Acc: 0.8938
 Site-MNIST                     (0) | Val  Loss: 0.3152 | Val  Acc: 0.9069
 Site-MNIST                     (0) | Val  Loss: 0.2874 | Val  Acc: 0.9049
 Site-MNIST                     (0) | Val  Loss: 0.2541 | Val  Acc: 0.9215
 Site-USPS                      (1) | Val  Loss: 0.3741 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2483 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2280 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.2108 | Val  Acc: 0.9569
 Site-USPS                      (1) | Val  Loss: 0.2777 | Val  Acc: 0.9238
 Site-USPS                      (1) | Val  Loss: 0.3085 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.3519 | Val  Acc: 0.9067
 Site-SynthDigits               (2) | Val  Loss: 0.4192 | Val  Acc: 0.8309
 Site-SynthDigits               (2) | Val  Loss: 0.4254 | Val  Acc: 0.8571
 Site-MNIST-M                   (3) | Val  Loss: 0.4927 | Val  Acc: 0.8333
 Site-MNIST-M                   (3) | Val  Loss: 0.6092 | Val  Acc: 0.7791
 Site-SVHN                      (4) | Val  Loss: 0.8073 | Val  Acc: 0.7376
Average Valid Accuracy: 0.8963
============ Train epoch 32 ============
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                    | Train Loss: 0.4357 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1333 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1566 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.1941 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1527 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2541 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.2268 | Train Acc: 0.9295
 Site-MNIST                    | Train Loss: 0.2574 | Train Acc: 0.9169
 Site-MNIST                    | Train Loss: 0.2342 | Train Acc: 0.9416
 Site-MNIST                    | Train Loss: 0.2423 | Train Acc: 0.9313
 Site-USPS                     | Train Loss: 0.2214 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2019 | Train Acc: 0.9236
 Site-USPS                     | Train Loss: 0.3845 | Train Acc: 0.8764
 Site-USPS                     | Train Loss: 0.3235 | Train Acc: 0.9186
 Site-USPS                     | Train Loss: 0.2906 | Train Acc: 0.8940
 Site-USPS                     | Train Loss: 0.2541 | Train Acc: 0.9247
 Site-SynthDigits              | Train Loss: 0.4620 | Train Acc: 0.8548
 Site-SynthDigits              | Train Loss: 0.4354 | Train Acc: 0.8739
 Site-SynthDigits              | Train Loss: 0.3589 | Train Acc: 0.8963
 Site-MNIST-M                  | Train Loss: 0.5798 | Train Acc: 0.8516
 Site-MNIST-M                  | Train Loss: 0.5640 | Train Acc: 0.8351
 Site-SVHN                     | Train Loss: 0.6929 | Train Acc: 0.7898
 Site-MNIST                     (1) | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1342 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1228 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3257 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.3966 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.3458 | Val  Acc: 0.8850
 Site-MNIST                     (1) | Val  Loss: 0.3081 | Val  Acc: 0.9265
 Site-MNIST                     (1) | Val  Loss: 0.2822 | Val  Acc: 0.9076
 Site-MNIST                     (1) | Val  Loss: 0.2491 | Val  Acc: 0.9245
 Site-USPS                      (2) | Val  Loss: 0.3787 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2470 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.2246 | Val  Acc: 0.9375
 Site-USPS                      (2) | Val  Loss: 0.2033 | Val  Acc: 0.9655
 Site-USPS                      (2) | Val  Loss: 0.2710 | Val  Acc: 0.9286
 Site-USPS                      (2) | Val  Loss: 0.3016 | Val  Acc: 0.9101
 Site-SynthDigits               (3) | Val  Loss: 0.3559 | Val  Acc: 0.9067
 Site-SynthDigits               (3) | Val  Loss: 0.4173 | Val  Acc: 0.8529
 Site-SynthDigits               (3) | Val  Loss: 0.4256 | Val  Acc: 0.8612
 Site-MNIST-M                   (0) | Val  Loss: 0.4913 | Val  Acc: 0.8444
 Site-MNIST-M                   (0) | Val  Loss: 0.6052 | Val  Acc: 0.7853
 Site-SVHN                      (4) | Val  Loss: 0.7875 | Val  Acc: 0.7447
Average Valid Accuracy: 0.8988
============ Train epoch 33 ============
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                    | Train Loss: 0.4163 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1344 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1528 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.1831 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1424 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2472 | Train Acc: 0.9444
 Site-MNIST                    | Train Loss: 0.2334 | Train Acc: 0.9317
 Site-MNIST                    | Train Loss: 0.2568 | Train Acc: 0.9169
 Site-MNIST                    | Train Loss: 0.2164 | Train Acc: 0.9382
 Site-MNIST                    | Train Loss: 0.2398 | Train Acc: 0.9306
 Site-USPS                     | Train Loss: 0.2230 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.3043 | Train Acc: 0.9236
 Site-USPS                     | Train Loss: 0.2796 | Train Acc: 0.8803
 Site-USPS                     | Train Loss: 0.2936 | Train Acc: 0.9186
 Site-USPS                     | Train Loss: 0.2926 | Train Acc: 0.8881
 Site-USPS                     | Train Loss: 0.2520 | Train Acc: 0.9227
 Site-SynthDigits              | Train Loss: 0.4555 | Train Acc: 0.8548
 Site-SynthDigits              | Train Loss: 0.4424 | Train Acc: 0.8720
 Site-SynthDigits              | Train Loss: 0.3644 | Train Acc: 0.8943
 Site-MNIST-M                  | Train Loss: 0.5738 | Train Acc: 0.8324
 Site-MNIST-M                  | Train Loss: 0.5575 | Train Acc: 0.8489
 Site-SVHN                     | Train Loss: 0.6889 | Train Acc: 0.7915
 Site-MNIST                     (1) | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1436 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1252 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3246 | Val  Acc: 0.8857
 Site-MNIST                     (1) | Val  Loss: 0.3958 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.3454 | Val  Acc: 0.8938
 Site-MNIST                     (1) | Val  Loss: 0.3088 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.2786 | Val  Acc: 0.9076
 Site-MNIST                     (1) | Val  Loss: 0.2445 | Val  Acc: 0.9245
 Site-USPS                      (3) | Val  Loss: 0.3668 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.2433 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.2201 | Val  Acc: 0.9375
 Site-USPS                      (3) | Val  Loss: 0.1990 | Val  Acc: 0.9655
 Site-USPS                      (3) | Val  Loss: 0.2626 | Val  Acc: 0.9238
 Site-USPS                      (3) | Val  Loss: 0.2959 | Val  Acc: 0.9074
 Site-SynthDigits               (0) | Val  Loss: 0.3482 | Val  Acc: 0.9067
 Site-SynthDigits               (0) | Val  Loss: 0.4103 | Val  Acc: 0.8529
 Site-SynthDigits               (0) | Val  Loss: 0.4232 | Val  Acc: 0.8694
 Site-MNIST-M                   (2) | Val  Loss: 0.4853 | Val  Acc: 0.8444
 Site-MNIST-M                   (2) | Val  Loss: 0.5975 | Val  Acc: 0.7914
 Site-SVHN                      (4) | Val  Loss: 0.7782 | Val  Acc: 0.7447
Average Valid Accuracy: 0.9004
============ Train epoch 34 ============
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                    | Train Loss: 0.4183 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1243 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1405 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2005 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1726 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2432 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2352 | Train Acc: 0.9317
 Site-MNIST                    | Train Loss: 0.2447 | Train Acc: 0.9218
 Site-MNIST                    | Train Loss: 0.2139 | Train Acc: 0.9403
 Site-MNIST                    | Train Loss: 0.2316 | Train Acc: 0.9329
 Site-USPS                     | Train Loss: 0.2375 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2217 | Train Acc: 0.9306
 Site-USPS                     | Train Loss: 0.4126 | Train Acc: 0.8764
 Site-USPS                     | Train Loss: 0.2753 | Train Acc: 0.9186
 Site-USPS                     | Train Loss: 0.2895 | Train Acc: 0.8940
 Site-USPS                     | Train Loss: 0.2498 | Train Acc: 0.9273
 Site-SynthDigits              | Train Loss: 0.4523 | Train Acc: 0.8647
 Site-SynthDigits              | Train Loss: 0.4197 | Train Acc: 0.8812
 Site-SynthDigits              | Train Loss: 0.3437 | Train Acc: 0.8974
 Site-MNIST-M                  | Train Loss: 0.5722 | Train Acc: 0.8407
 Site-MNIST-M                  | Train Loss: 0.5599 | Train Acc: 0.8351
 Site-SVHN                     | Train Loss: 0.6809 | Train Acc: 0.7827
 Site-MNIST                     (1) | Val  Loss: 0.0064 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1324 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1103 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3077 | Val  Acc: 0.8857
 Site-MNIST                     (1) | Val  Loss: 0.3794 | Val  Acc: 0.8889
 Site-MNIST                     (1) | Val  Loss: 0.3297 | Val  Acc: 0.8938
 Site-MNIST                     (1) | Val  Loss: 0.3010 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2711 | Val  Acc: 0.9158
 Site-MNIST                     (1) | Val  Loss: 0.2376 | Val  Acc: 0.9275
 Site-USPS                      (2) | Val  Loss: 0.3806 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2447 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.2203 | Val  Acc: 0.9375
 Site-USPS                      (2) | Val  Loss: 0.1961 | Val  Acc: 0.9569
 Site-USPS                      (2) | Val  Loss: 0.2628 | Val  Acc: 0.9286
 Site-USPS                      (2) | Val  Loss: 0.2931 | Val  Acc: 0.9074
 Site-SynthDigits               (0) | Val  Loss: 0.3326 | Val  Acc: 0.9067
 Site-SynthDigits               (0) | Val  Loss: 0.3974 | Val  Acc: 0.8603
 Site-SynthDigits               (0) | Val  Loss: 0.4066 | Val  Acc: 0.8776
 Site-MNIST-M                   (3) | Val  Loss: 0.4816 | Val  Acc: 0.8444
 Site-MNIST-M                   (3) | Val  Loss: 0.5870 | Val  Acc: 0.7791
 Site-SVHN                      (4) | Val  Loss: 0.7555 | Val  Acc: 0.7518
Average Valid Accuracy: 0.9026
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.8857
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.8889
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.8938
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9158
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9275
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9375
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9569
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9286
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9074
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.9067
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8603
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8776
 Best site-MNIST-M                  (3)  | Epoch:34 | Val Acc: 0.8444
 Best site-MNIST-M                  (3)  | Epoch:34 | Val Acc: 0.7791
 Best site-SVHN                     (4)  | Epoch:34 | Val Acc: 0.7518
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 35 ============
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                    | Train Loss: 0.4203 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1185 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1412 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2736 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1487 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2399 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2103 | Train Acc: 0.9273
 Site-MNIST                    | Train Loss: 0.2462 | Train Acc: 0.9218
 Site-MNIST                    | Train Loss: 0.2109 | Train Acc: 0.9396
 Site-MNIST                    | Train Loss: 0.2293 | Train Acc: 0.9336
 Site-USPS                     | Train Loss: 0.3220 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.3153 | Train Acc: 0.9375
 Site-USPS                     | Train Loss: 0.2664 | Train Acc: 0.8803
 Site-USPS                     | Train Loss: 0.2969 | Train Acc: 0.9165
 Site-USPS                     | Train Loss: 0.2720 | Train Acc: 0.9000
 Site-USPS                     | Train Loss: 0.2419 | Train Acc: 0.9253
 Site-SynthDigits              | Train Loss: 0.4529 | Train Acc: 0.8548
 Site-SynthDigits              | Train Loss: 0.4381 | Train Acc: 0.8702
 Site-SynthDigits              | Train Loss: 0.3457 | Train Acc: 0.8923
 Site-MNIST-M                  | Train Loss: 0.5544 | Train Acc: 0.8352
 Site-MNIST-M                  | Train Loss: 0.5634 | Train Acc: 0.8489
 Site-SVHN                     | Train Loss: 0.6655 | Train Acc: 0.7968
 Site-MNIST                     (0) | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1302 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1149 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3195 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.3886 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.3321 | Val  Acc: 0.8850
 Site-MNIST                     (0) | Val  Loss: 0.3014 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.2703 | Val  Acc: 0.9076
 Site-MNIST                     (0) | Val  Loss: 0.2362 | Val  Acc: 0.9245
 Site-USPS                      (1) | Val  Loss: 0.3770 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2421 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2148 | Val  Acc: 0.9375
 Site-USPS                      (1) | Val  Loss: 0.1910 | Val  Acc: 0.9655
 Site-USPS                      (1) | Val  Loss: 0.2555 | Val  Acc: 0.9190
 Site-USPS                      (1) | Val  Loss: 0.2866 | Val  Acc: 0.9101
 Site-SynthDigits               (3) | Val  Loss: 0.3304 | Val  Acc: 0.8933
 Site-SynthDigits               (3) | Val  Loss: 0.4022 | Val  Acc: 0.8382
 Site-SynthDigits               (3) | Val  Loss: 0.4089 | Val  Acc: 0.8735
 Site-MNIST-M                   (2) | Val  Loss: 0.4690 | Val  Acc: 0.8556
 Site-MNIST-M                   (2) | Val  Loss: 0.5732 | Val  Acc: 0.7853
 Site-SVHN                      (4) | Val  Loss: 0.7573 | Val  Acc: 0.7589
Average Valid Accuracy: 0.8982
============ Train epoch 36 ============
cnt=[10, 1, 6, 2, 3, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                    | Train Loss: 0.4121 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1182 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1364 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.3942 | Train Acc: 0.9221
 Site-MNIST                    | Train Loss: 0.1548 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2342 | Train Acc: 0.9444
 Site-MNIST                    | Train Loss: 0.2214 | Train Acc: 0.9295
 Site-MNIST                    | Train Loss: 0.2436 | Train Acc: 0.9242
 Site-MNIST                    | Train Loss: 0.2044 | Train Acc: 0.9389
 Site-MNIST                    | Train Loss: 0.2253 | Train Acc: 0.9351
 Site-USPS                     | Train Loss: 0.3807 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2656 | Train Acc: 0.9097
 Site-USPS                     | Train Loss: 0.5620 | Train Acc: 0.8880
 Site-USPS                     | Train Loss: 0.2695 | Train Acc: 0.9229
 Site-USPS                     | Train Loss: 0.2797 | Train Acc: 0.8964
 Site-USPS                     | Train Loss: 0.2403 | Train Acc: 0.9266
 Site-SynthDigits              | Train Loss: 0.4427 | Train Acc: 0.8548
 Site-SynthDigits              | Train Loss: 0.4183 | Train Acc: 0.8720
 Site-SynthDigits              | Train Loss: 0.3458 | Train Acc: 0.8974
 Site-MNIST-M                  | Train Loss: 0.5529 | Train Acc: 0.8379
 Site-MNIST-M                  | Train Loss: 0.5370 | Train Acc: 0.8489
 Site-SVHN                     | Train Loss: 0.6628 | Train Acc: 0.8004
 Site-MNIST                     (0) | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1323 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.1135 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3143 | Val  Acc: 0.8857
 Site-MNIST                     (0) | Val  Loss: 0.3840 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.3266 | Val  Acc: 0.8850
 Site-MNIST                     (0) | Val  Loss: 0.2978 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.2655 | Val  Acc: 0.9130
 Site-MNIST                     (0) | Val  Loss: 0.2316 | Val  Acc: 0.9260
 Site-USPS                      (2) | Val  Loss: 0.3666 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2390 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.2112 | Val  Acc: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.1889 | Val  Acc: 0.9569
 Site-USPS                      (2) | Val  Loss: 0.2546 | Val  Acc: 0.9238
 Site-USPS                      (2) | Val  Loss: 0.2848 | Val  Acc: 0.9101
 Site-SynthDigits               (4) | Val  Loss: 0.3242 | Val  Acc: 0.8933
 Site-SynthDigits               (4) | Val  Loss: 0.3910 | Val  Acc: 0.8382
 Site-SynthDigits               (4) | Val  Loss: 0.4028 | Val  Acc: 0.8694
 Site-MNIST-M                   (3) | Val  Loss: 0.4606 | Val  Acc: 0.8556
 Site-MNIST-M                   (3) | Val  Loss: 0.5659 | Val  Acc: 0.7853
 Site-SVHN                      (1) | Val  Loss: 0.7409 | Val  Acc: 0.7730
Average Valid Accuracy: 0.9001
============ Train epoch 37 ============
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                    | Train Loss: 0.4219 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1188 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1304 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2032 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1233 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2341 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2245 | Train Acc: 0.9317
 Site-MNIST                    | Train Loss: 0.2393 | Train Acc: 0.9205
 Site-MNIST                    | Train Loss: 0.2059 | Train Acc: 0.9396
 Site-MNIST                    | Train Loss: 0.2233 | Train Acc: 0.9355
 Site-USPS                     | Train Loss: 0.3233 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2584 | Train Acc: 0.9444
 Site-USPS                     | Train Loss: 0.3559 | Train Acc: 0.8842
 Site-USPS                     | Train Loss: 0.2627 | Train Acc: 0.9251
 Site-USPS                     | Train Loss: 0.2970 | Train Acc: 0.8964
 Site-USPS                     | Train Loss: 0.2359 | Train Acc: 0.9247
 Site-SynthDigits              | Train Loss: 0.4306 | Train Acc: 0.8614
 Site-SynthDigits              | Train Loss: 0.4185 | Train Acc: 0.8702
 Site-SynthDigits              | Train Loss: 0.3503 | Train Acc: 0.9024
 Site-MNIST-M                  | Train Loss: 0.5510 | Train Acc: 0.8434
 Site-MNIST-M                  | Train Loss: 0.5342 | Train Acc: 0.8412
 Site-SVHN                     | Train Loss: 0.6450 | Train Acc: 0.8057
 Site-MNIST                     (1) | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1293 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1117 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3100 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.3813 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.3220 | Val  Acc: 0.8938
 Site-MNIST                     (1) | Val  Loss: 0.2955 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2627 | Val  Acc: 0.9103
 Site-MNIST                     (1) | Val  Loss: 0.2291 | Val  Acc: 0.9260
 Site-USPS                      (0) | Val  Loss: 0.3722 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.2386 | Val  Acc: 0.9167
 Site-USPS                      (0) | Val  Loss: 0.2079 | Val  Acc: 0.9375
 Site-USPS                      (0) | Val  Loss: 0.1846 | Val  Acc: 0.9655
 Site-USPS                      (0) | Val  Loss: 0.2489 | Val  Acc: 0.9190
 Site-USPS                      (0) | Val  Loss: 0.2785 | Val  Acc: 0.9180
 Site-SynthDigits               (2) | Val  Loss: 0.3246 | Val  Acc: 0.8933
 Site-SynthDigits               (2) | Val  Loss: 0.3950 | Val  Acc: 0.8309
 Site-SynthDigits               (2) | Val  Loss: 0.3942 | Val  Acc: 0.8612
 Site-MNIST-M                   (3) | Val  Loss: 0.4565 | Val  Acc: 0.8444
 Site-MNIST-M                   (3) | Val  Loss: 0.5652 | Val  Acc: 0.7914
 Site-SVHN                      (4) | Val  Loss: 0.7288 | Val  Acc: 0.7518
Average Valid Accuracy: 0.8981
============ Train epoch 38 ============
cnt=[1, 6, 2, 9, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                    | Train Loss: 0.3340 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.1086 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1240 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2126 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1276 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2257 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.2363 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2318 | Train Acc: 0.9242
 Site-MNIST                    | Train Loss: 0.1938 | Train Acc: 0.9437
 Site-MNIST                    | Train Loss: 0.2149 | Train Acc: 0.9400
 Site-USPS                     | Train Loss: 0.3414 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2458 | Train Acc: 0.9236
 Site-USPS                     | Train Loss: 0.3004 | Train Acc: 0.8842
 Site-USPS                     | Train Loss: 0.2482 | Train Acc: 0.9229
 Site-USPS                     | Train Loss: 0.2771 | Train Acc: 0.9012
 Site-USPS                     | Train Loss: 0.2311 | Train Acc: 0.9247
 Site-SynthDigits              | Train Loss: 0.4334 | Train Acc: 0.8647
 Site-SynthDigits              | Train Loss: 0.3960 | Train Acc: 0.8885
 Site-SynthDigits              | Train Loss: 0.3194 | Train Acc: 0.9024
 Site-MNIST-M                  | Train Loss: 0.5234 | Train Acc: 0.8599
 Site-MNIST-M                  | Train Loss: 0.5122 | Train Acc: 0.8519
 Site-SVHN                     | Train Loss: 0.6843 | Train Acc: 0.7809
 Site-MNIST                     (0) | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.1016 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.0959 | Val  Acc: 0.9474
 Site-MNIST                     (3) | Val  Loss: 0.2970 | Val  Acc: 0.8857
 Site-MNIST                     (3) | Val  Loss: 0.3612 | Val  Acc: 0.8889
 Site-MNIST                     (3) | Val  Loss: 0.3135 | Val  Acc: 0.8850
 Site-MNIST                     (3) | Val  Loss: 0.2756 | Val  Acc: 0.9216
 Site-MNIST                     (3) | Val  Loss: 0.2538 | Val  Acc: 0.9130
 Site-MNIST                     (3) | Val  Loss: 0.2229 | Val  Acc: 0.9366
 Site-USPS                      (1) | Val  Loss: 0.3546 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2386 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2034 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.1800 | Val  Acc: 0.9569
 Site-USPS                      (1) | Val  Loss: 0.2427 | Val  Acc: 0.9238
 Site-USPS                      (1) | Val  Loss: 0.2733 | Val  Acc: 0.9101
 Site-SynthDigits               (4) | Val  Loss: 0.3014 | Val  Acc: 0.9067
 Site-SynthDigits               (4) | Val  Loss: 0.3819 | Val  Acc: 0.8603
 Site-SynthDigits               (4) | Val  Loss: 0.3745 | Val  Acc: 0.8898
 Site-MNIST-M                   (2) | Val  Loss: 0.4342 | Val  Acc: 0.8444
 Site-MNIST-M                   (2) | Val  Loss: 0.5385 | Val  Acc: 0.7914
 Site-SVHN                      (4) | Val  Loss: 0.7683 | Val  Acc: 0.7447
Average Valid Accuracy: 0.9066
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9474
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.8857
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.8889
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.8850
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9216
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9130
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9366
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9167
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9219
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9569
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9238
 Best site-USPS                     (1)  | Epoch:38 | Val Acc: 0.9101
 Best site-SynthDigits              (4)  | Epoch:38 | Val Acc: 0.9067
 Best site-SynthDigits              (4)  | Epoch:38 | Val Acc: 0.8603
 Best site-SynthDigits              (4)  | Epoch:38 | Val Acc: 0.8898
 Best site-MNIST-M                  (2)  | Epoch:38 | Val Acc: 0.8444
 Best site-MNIST-M                  (2)  | Epoch:38 | Val Acc: 0.7914
 Best site-SVHN                     (4)  | Epoch:38 | Val Acc: 0.7447
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 39 ============
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                    | Train Loss: 0.3574 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1106 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1189 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.3293 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1966 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2256 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2736 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2301 | Train Acc: 0.9291
 Site-MNIST                    | Train Loss: 0.1921 | Train Acc: 0.9423
 Site-MNIST                    | Train Loss: 0.2122 | Train Acc: 0.9374
 Site-USPS                     | Train Loss: 0.2032 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2424 | Train Acc: 0.9167
 Site-USPS                     | Train Loss: 0.2478 | Train Acc: 0.8880
 Site-USPS                     | Train Loss: 0.2588 | Train Acc: 0.9315
 Site-USPS                     | Train Loss: 0.2736 | Train Acc: 0.9012
 Site-USPS                     | Train Loss: 0.2340 | Train Acc: 0.9293
 Site-SynthDigits              | Train Loss: 0.4339 | Train Acc: 0.8581
 Site-SynthDigits              | Train Loss: 0.4032 | Train Acc: 0.8775
 Site-SynthDigits              | Train Loss: 0.3221 | Train Acc: 0.9045
 Site-MNIST-M                  | Train Loss: 0.5520 | Train Acc: 0.8434
 Site-MNIST-M                  | Train Loss: 0.5360 | Train Acc: 0.8626
 Site-SVHN                     | Train Loss: 0.6361 | Train Acc: 0.8092
 Site-MNIST                     (0) | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1116 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.0999 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.3026 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.3751 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.3145 | Val  Acc: 0.9027
 Site-MNIST                     (0) | Val  Loss: 0.2841 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2497 | Val  Acc: 0.9130
 Site-MNIST                     (0) | Val  Loss: 0.2172 | Val  Acc: 0.9350
 Site-USPS                      (1) | Val  Loss: 0.3485 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2283 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2000 | Val  Acc: 0.9375
 Site-USPS                      (1) | Val  Loss: 0.1811 | Val  Acc: 0.9655
 Site-USPS                      (1) | Val  Loss: 0.2452 | Val  Acc: 0.9238
 Site-USPS                      (1) | Val  Loss: 0.2734 | Val  Acc: 0.9206
 Site-SynthDigits               (3) | Val  Loss: 0.3120 | Val  Acc: 0.9067
 Site-SynthDigits               (3) | Val  Loss: 0.3808 | Val  Acc: 0.8529
 Site-SynthDigits               (3) | Val  Loss: 0.3833 | Val  Acc: 0.8816
 Site-MNIST-M                   (2) | Val  Loss: 0.4558 | Val  Acc: 0.8333
 Site-MNIST-M                   (2) | Val  Loss: 0.5686 | Val  Acc: 0.7853
 Site-SVHN                      (4) | Val  Loss: 0.7100 | Val  Acc: 0.7518
Average Valid Accuracy: 0.9016
============ Train epoch 40 ============
cnt=[6, 10, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                    | Train Loss: 0.3693 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1108 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1200 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.1762 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1272 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2267 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2069 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2301 | Train Acc: 0.9267
 Site-MNIST                    | Train Loss: 0.1964 | Train Acc: 0.9409
 Site-MNIST                    | Train Loss: 0.2140 | Train Acc: 0.9385
 Site-USPS                     | Train Loss: 0.3001 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2315 | Train Acc: 0.9236
 Site-USPS                     | Train Loss: 0.2479 | Train Acc: 0.8880
 Site-USPS                     | Train Loss: 0.2543 | Train Acc: 0.9293
 Site-USPS                     | Train Loss: 0.2800 | Train Acc: 0.8988
 Site-USPS                     | Train Loss: 0.2310 | Train Acc: 0.9299
 Site-SynthDigits              | Train Loss: 0.4295 | Train Acc: 0.8680
 Site-SynthDigits              | Train Loss: 0.4090 | Train Acc: 0.8739
 Site-SynthDigits              | Train Loss: 0.3279 | Train Acc: 0.8994
 Site-MNIST-M                  | Train Loss: 0.5291 | Train Acc: 0.8352
 Site-MNIST-M                  | Train Loss: 0.5483 | Train Acc: 0.8519
 Site-SVHN                     | Train Loss: 0.6296 | Train Acc: 0.8021
 Site-MNIST                     (1) | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1222 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1093 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3125 | Val  Acc: 0.8857
 Site-MNIST                     (1) | Val  Loss: 0.3755 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.3112 | Val  Acc: 0.8938
 Site-MNIST                     (1) | Val  Loss: 0.2849 | Val  Acc: 0.9265
 Site-MNIST                     (1) | Val  Loss: 0.2521 | Val  Acc: 0.9158
 Site-MNIST                     (1) | Val  Loss: 0.2185 | Val  Acc: 0.9381
 Site-USPS                      (0) | Val  Loss: 0.3570 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.2276 | Val  Acc: 0.9167
 Site-USPS                      (0) | Val  Loss: 0.1969 | Val  Acc: 0.9375
 Site-USPS                      (0) | Val  Loss: 0.1785 | Val  Acc: 0.9655
 Site-USPS                      (0) | Val  Loss: 0.2421 | Val  Acc: 0.9238
 Site-USPS                      (0) | Val  Loss: 0.2696 | Val  Acc: 0.9206
 Site-SynthDigits               (3) | Val  Loss: 0.3125 | Val  Acc: 0.8800
 Site-SynthDigits               (3) | Val  Loss: 0.3848 | Val  Acc: 0.8382
 Site-SynthDigits               (3) | Val  Loss: 0.3862 | Val  Acc: 0.8694
 Site-MNIST-M                   (2) | Val  Loss: 0.4444 | Val  Acc: 0.8444
 Site-MNIST-M                   (2) | Val  Loss: 0.5509 | Val  Acc: 0.7914
 Site-SVHN                      (4) | Val  Loss: 0.7052 | Val  Acc: 0.7589
Average Valid Accuracy: 0.9012
============ Train epoch 41 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                    | Train Loss: 0.3751 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1069 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1114 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2217 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1183 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2248 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.1862 | Train Acc: 0.9427
 Site-MNIST                    | Train Loss: 0.2242 | Train Acc: 0.9328
 Site-MNIST                    | Train Loss: 0.2427 | Train Acc: 0.9443
 Site-MNIST                    | Train Loss: 0.2118 | Train Acc: 0.9381
 Site-USPS                     | Train Loss: 0.1961 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2404 | Train Acc: 0.9306
 Site-USPS                     | Train Loss: 0.2518 | Train Acc: 0.8919
 Site-USPS                     | Train Loss: 0.2561 | Train Acc: 0.9315
 Site-USPS                     | Train Loss: 0.2639 | Train Acc: 0.9012
 Site-USPS                     | Train Loss: 0.2280 | Train Acc: 0.9286
 Site-SynthDigits              | Train Loss: 0.4312 | Train Acc: 0.8647
 Site-SynthDigits              | Train Loss: 0.4040 | Train Acc: 0.8867
 Site-SynthDigits              | Train Loss: 0.3125 | Train Acc: 0.9075
 Site-MNIST-M                  | Train Loss: 0.5236 | Train Acc: 0.8489
 Site-MNIST-M                  | Train Loss: 0.4909 | Train Acc: 0.8595
 Site-SVHN                     | Train Loss: 0.6154 | Train Acc: 0.8110
 Site-MNIST                     (0) | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1053 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.0965 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.2867 | Val  Acc: 0.8857
 Site-MNIST                     (0) | Val  Loss: 0.3629 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.3051 | Val  Acc: 0.9115
 Site-MNIST                     (0) | Val  Loss: 0.2776 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2479 | Val  Acc: 0.9185
 Site-MNIST                     (0) | Val  Loss: 0.2145 | Val  Acc: 0.9396
 Site-USPS                      (1) | Val  Loss: 0.3563 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2287 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.1988 | Val  Acc: 0.9375
 Site-USPS                      (1) | Val  Loss: 0.1748 | Val  Acc: 0.9655
 Site-USPS                      (1) | Val  Loss: 0.2359 | Val  Acc: 0.9238
 Site-USPS                      (1) | Val  Loss: 0.2659 | Val  Acc: 0.9180
 Site-SynthDigits               (2) | Val  Loss: 0.3028 | Val  Acc: 0.8933
 Site-SynthDigits               (2) | Val  Loss: 0.3827 | Val  Acc: 0.8529
 Site-SynthDigits               (2) | Val  Loss: 0.3754 | Val  Acc: 0.8776
 Site-MNIST-M                   (3) | Val  Loss: 0.4411 | Val  Acc: 0.8444
 Site-MNIST-M                   (3) | Val  Loss: 0.5440 | Val  Acc: 0.7914
 Site-SVHN                      (4) | Val  Loss: 0.6987 | Val  Acc: 0.7730
Average Valid Accuracy: 0.9046
============ Train epoch 42 ============
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                    | Train Loss: 0.3641 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1035 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1116 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2481 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1279 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2217 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2016 | Train Acc: 0.9427
 Site-MNIST                    | Train Loss: 0.2242 | Train Acc: 0.9315
 Site-MNIST                    | Train Loss: 0.1872 | Train Acc: 0.9437
 Site-MNIST                    | Train Loss: 0.2082 | Train Acc: 0.9404
 Site-USPS                     | Train Loss: 0.3107 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2448 | Train Acc: 0.9236
 Site-USPS                     | Train Loss: 0.2561 | Train Acc: 0.8880
 Site-USPS                     | Train Loss: 0.2487 | Train Acc: 0.9336
 Site-USPS                     | Train Loss: 0.2648 | Train Acc: 0.9060
 Site-USPS                     | Train Loss: 0.2211 | Train Acc: 0.9313
 Site-SynthDigits              | Train Loss: 0.4399 | Train Acc: 0.8680
 Site-SynthDigits              | Train Loss: 0.3944 | Train Acc: 0.8812
 Site-SynthDigits              | Train Loss: 0.3299 | Train Acc: 0.9045
 Site-MNIST-M                  | Train Loss: 0.5089 | Train Acc: 0.8407
 Site-MNIST-M                  | Train Loss: 0.4841 | Train Acc: 0.8611
 Site-SVHN                     | Train Loss: 0.6079 | Train Acc: 0.8163
 Site-MNIST                     (0) | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1027 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.0931 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.2844 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.3560 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.2981 | Val  Acc: 0.9027
 Site-MNIST                     (0) | Val  Loss: 0.2729 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2459 | Val  Acc: 0.9158
 Site-MNIST                     (0) | Val  Loss: 0.2126 | Val  Acc: 0.9366
 Site-USPS                      (1) | Val  Loss: 0.3562 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2270 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.1950 | Val  Acc: 0.9375
 Site-USPS                      (1) | Val  Loss: 0.1708 | Val  Acc: 0.9655
 Site-USPS                      (1) | Val  Loss: 0.2332 | Val  Acc: 0.9286
 Site-USPS                      (1) | Val  Loss: 0.2620 | Val  Acc: 0.9180
 Site-SynthDigits               (3) | Val  Loss: 0.2999 | Val  Acc: 0.8800
 Site-SynthDigits               (3) | Val  Loss: 0.3818 | Val  Acc: 0.8456
 Site-SynthDigits               (3) | Val  Loss: 0.3685 | Val  Acc: 0.8776
 Site-MNIST-M                   (2) | Val  Loss: 0.4343 | Val  Acc: 0.8444
 Site-MNIST-M                   (2) | Val  Loss: 0.5323 | Val  Acc: 0.7975
 Site-SVHN                      (4) | Val  Loss: 0.6994 | Val  Acc: 0.7589
Average Valid Accuracy: 0.9016
============ Train epoch 43 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                    | Train Loss: 0.3609 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.1051 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1137 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.1837 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1688 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2189 | Train Acc: 0.9405
 Site-MNIST                    | Train Loss: 0.2266 | Train Acc: 0.9383
 Site-MNIST                    | Train Loss: 0.2211 | Train Acc: 0.9303
 Site-MNIST                    | Train Loss: 0.1891 | Train Acc: 0.9423
 Site-MNIST                    | Train Loss: 0.2090 | Train Acc: 0.9396
 Site-USPS                     | Train Loss: 0.3469 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.1963 | Train Acc: 0.9444
 Site-USPS                     | Train Loss: 0.2393 | Train Acc: 0.8919
 Site-USPS                     | Train Loss: 0.2570 | Train Acc: 0.9336
 Site-USPS                     | Train Loss: 0.2993 | Train Acc: 0.9060
 Site-USPS                     | Train Loss: 0.2178 | Train Acc: 0.9332
 Site-SynthDigits              | Train Loss: 0.4102 | Train Acc: 0.8713
 Site-SynthDigits              | Train Loss: 0.3742 | Train Acc: 0.8812
 Site-SynthDigits              | Train Loss: 0.3019 | Train Acc: 0.9055
 Site-MNIST-M                  | Train Loss: 0.5105 | Train Acc: 0.8434
 Site-MNIST-M                  | Train Loss: 0.5106 | Train Acc: 0.8565
 Site-SVHN                     | Train Loss: 0.6045 | Train Acc: 0.8180
 Site-MNIST                     (0) | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1100 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.0948 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.2830 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.3500 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.2957 | Val  Acc: 0.9027
 Site-MNIST                     (0) | Val  Loss: 0.2723 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2446 | Val  Acc: 0.9239
 Site-MNIST                     (0) | Val  Loss: 0.2119 | Val  Acc: 0.9350
 Site-USPS                      (1) | Val  Loss: 0.3648 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2363 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.1977 | Val  Acc: 0.9375
 Site-USPS                      (1) | Val  Loss: 0.1665 | Val  Acc: 0.9655
 Site-USPS                      (1) | Val  Loss: 0.2301 | Val  Acc: 0.9286
 Site-USPS                      (1) | Val  Loss: 0.2596 | Val  Acc: 0.9153
 Site-SynthDigits               (2) | Val  Loss: 0.2936 | Val  Acc: 0.8800
 Site-SynthDigits               (2) | Val  Loss: 0.3757 | Val  Acc: 0.8456
 Site-SynthDigits               (2) | Val  Loss: 0.3596 | Val  Acc: 0.8776
 Site-MNIST-M                   (3) | Val  Loss: 0.4252 | Val  Acc: 0.8444
 Site-MNIST-M                   (3) | Val  Loss: 0.5236 | Val  Acc: 0.7975
 Site-SVHN                      (4) | Val  Loss: 0.6959 | Val  Acc: 0.7518
Average Valid Accuracy: 0.9014
============ Train epoch 44 ============
cnt=[2, 6, 10, 3, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                    | Train Loss: 0.3632 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.1053 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1159 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2050 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1397 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2219 | Train Acc: 0.9325
 Site-MNIST                    | Train Loss: 0.2030 | Train Acc: 0.9361
 Site-MNIST                    | Train Loss: 0.2254 | Train Acc: 0.9328
 Site-MNIST                    | Train Loss: 0.1886 | Train Acc: 0.9416
 Site-MNIST                    | Train Loss: 0.2097 | Train Acc: 0.9370
 Site-USPS                     | Train Loss: 0.3215 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2253 | Train Acc: 0.9375
 Site-USPS                     | Train Loss: 0.2456 | Train Acc: 0.8880
 Site-USPS                     | Train Loss: 0.2655 | Train Acc: 0.9251
 Site-USPS                     | Train Loss: 0.2542 | Train Acc: 0.8988
 Site-USPS                     | Train Loss: 0.2168 | Train Acc: 0.9313
 Site-SynthDigits              | Train Loss: 0.4100 | Train Acc: 0.8746
 Site-SynthDigits              | Train Loss: 0.3828 | Train Acc: 0.8903
 Site-SynthDigits              | Train Loss: 0.3013 | Train Acc: 0.9075
 Site-MNIST-M                  | Train Loss: 0.4999 | Train Acc: 0.8544
 Site-MNIST-M                  | Train Loss: 0.4868 | Train Acc: 0.8626
 Site-SVHN                     | Train Loss: 0.6017 | Train Acc: 0.8251
 Site-MNIST                     (2) | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1264 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.1081 | Val  Acc: 0.9474
 Site-MNIST                     (2) | Val  Loss: 0.2975 | Val  Acc: 0.8571
 Site-MNIST                     (2) | Val  Loss: 0.3554 | Val  Acc: 0.8730
 Site-MNIST                     (2) | Val  Loss: 0.2977 | Val  Acc: 0.9027
 Site-MNIST                     (2) | Val  Loss: 0.2769 | Val  Acc: 0.9363
 Site-MNIST                     (2) | Val  Loss: 0.2487 | Val  Acc: 0.9266
 Site-MNIST                     (2) | Val  Loss: 0.2161 | Val  Acc: 0.9335
 Site-USPS                      (1) | Val  Loss: 0.3528 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2307 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.1953 | Val  Acc: 0.9219
 Site-USPS                      (1) | Val  Loss: 0.1695 | Val  Acc: 0.9569
 Site-USPS                      (1) | Val  Loss: 0.2326 | Val  Acc: 0.9286
 Site-USPS                      (1) | Val  Loss: 0.2617 | Val  Acc: 0.9153
 Site-SynthDigits               (3) | Val  Loss: 0.2854 | Val  Acc: 0.8933
 Site-SynthDigits               (3) | Val  Loss: 0.3737 | Val  Acc: 0.8603
 Site-SynthDigits               (3) | Val  Loss: 0.3560 | Val  Acc: 0.8776
 Site-MNIST-M                   (0) | Val  Loss: 0.4221 | Val  Acc: 0.8444
 Site-MNIST-M                   (0) | Val  Loss: 0.5164 | Val  Acc: 0.7914
 Site-SVHN                      (4) | Val  Loss: 0.6776 | Val  Acc: 0.7943
Average Valid Accuracy: 0.9035
============ Train epoch 45 ============
cnt=[6, 10, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                    | Train Loss: 0.3810 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1071 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1151 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2096 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1784 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2203 | Train Acc: 0.9325
 Site-MNIST                    | Train Loss: 0.2120 | Train Acc: 0.9383
 Site-MNIST                    | Train Loss: 0.2247 | Train Acc: 0.9328
 Site-MNIST                    | Train Loss: 0.2079 | Train Acc: 0.9416
 Site-MNIST                    | Train Loss: 0.2067 | Train Acc: 0.9378
 Site-USPS                     | Train Loss: 0.1815 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2305 | Train Acc: 0.9375
 Site-USPS                     | Train Loss: 0.2309 | Train Acc: 0.8880
 Site-USPS                     | Train Loss: 0.2474 | Train Acc: 0.9336
 Site-USPS                     | Train Loss: 0.2507 | Train Acc: 0.9036
 Site-USPS                     | Train Loss: 0.2198 | Train Acc: 0.9313
 Site-SynthDigits              | Train Loss: 0.4041 | Train Acc: 0.8746
 Site-SynthDigits              | Train Loss: 0.3616 | Train Acc: 0.8976
 Site-SynthDigits              | Train Loss: 0.3126 | Train Acc: 0.9096
 Site-MNIST-M                  | Train Loss: 0.4920 | Train Acc: 0.8516
 Site-MNIST-M                  | Train Loss: 0.4838 | Train Acc: 0.8702
 Site-SVHN                     | Train Loss: 0.5819 | Train Acc: 0.8392
 Site-MNIST                     (1) | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1300 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1142 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3106 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.3602 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.2984 | Val  Acc: 0.9027
 Site-MNIST                     (1) | Val  Loss: 0.2773 | Val  Acc: 0.9363
 Site-MNIST                     (1) | Val  Loss: 0.2480 | Val  Acc: 0.9293
 Site-MNIST                     (1) | Val  Loss: 0.2149 | Val  Acc: 0.9366
 Site-USPS                      (0) | Val  Loss: 0.3406 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.2222 | Val  Acc: 0.9167
 Site-USPS                      (0) | Val  Loss: 0.1914 | Val  Acc: 0.9375
 Site-USPS                      (0) | Val  Loss: 0.1702 | Val  Acc: 0.9655
 Site-USPS                      (0) | Val  Loss: 0.2325 | Val  Acc: 0.9238
 Site-USPS                      (0) | Val  Loss: 0.2602 | Val  Acc: 0.9180
 Site-SynthDigits               (3) | Val  Loss: 0.2834 | Val  Acc: 0.9067
 Site-SynthDigits               (3) | Val  Loss: 0.3632 | Val  Acc: 0.8676
 Site-SynthDigits               (3) | Val  Loss: 0.3532 | Val  Acc: 0.8857
 Site-MNIST-M                   (2) | Val  Loss: 0.4184 | Val  Acc: 0.8444
 Site-MNIST-M                   (2) | Val  Loss: 0.5125 | Val  Acc: 0.8037
 Site-SVHN                      (4) | Val  Loss: 0.6646 | Val  Acc: 0.7872
Average Valid Accuracy: 0.9063
 Test site-MNIST                     (1)| Epoch:38 | Test Acc: 0.9355
 Test site-USPS                      (0)| Epoch:38 | Test Acc: 0.9269
 Test site-SynthDigits               (3)| Epoch:38 | Test Acc: 0.8928
 Test site-MNIST-M                   (2)| Epoch:38 | Test Acc: 0.7569
 Test site-MNIST-M                   (2)| Epoch:38 | Test Acc: 0.7569
 Test site-SVHN                      (4)| Epoch:38 | Test Acc: 0.6961
MNIST: 0.8165, USPS: 0.9269, SynthDigits: 0.8928, SVHN: 0.6961, 
Average Test Accuracy(group): 0.8331, Average Test Accuracy(individual): 0.9002,
domain CV=0.1063, cluster CV=0.1152, individual CV=0.0747, 
Average Test Accuracy: 0.8331
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                    | Train Loss: 0.3721 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1099 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1191 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.1920 | Train Acc: 0.9481
 Site-MNIST                    | Train Loss: 0.1170 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2189 | Train Acc: 0.9325
 Site-MNIST                    | Train Loss: 0.1917 | Train Acc: 0.9383
 Site-MNIST                    | Train Loss: 0.2299 | Train Acc: 0.9303
 Site-MNIST                    | Train Loss: 0.1912 | Train Acc: 0.9409
 Site-MNIST                    | Train Loss: 0.2073 | Train Acc: 0.9389
 Site-USPS                     | Train Loss: 0.1736 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.2074 | Train Acc: 0.9306
 Site-USPS                     | Train Loss: 0.2337 | Train Acc: 0.8919
 Site-USPS                     | Train Loss: 0.2477 | Train Acc: 0.9251
 Site-USPS                     | Train Loss: 0.2568 | Train Acc: 0.8988
 Site-USPS                     | Train Loss: 0.2214 | Train Acc: 0.9319
 Site-SynthDigits              | Train Loss: 0.4049 | Train Acc: 0.8779
 Site-SynthDigits              | Train Loss: 0.3786 | Train Acc: 0.8976
 Site-SynthDigits              | Train Loss: 0.2945 | Train Acc: 0.9055
 Site-MNIST-M                  | Train Loss: 0.4812 | Train Acc: 0.8681
 Site-MNIST-M                  | Train Loss: 0.4683 | Train Acc: 0.8672
 Site-SVHN                     | Train Loss: 0.5817 | Train Acc: 0.8269
 Site-MNIST                     (1) | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1615 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1330 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3271 | Val  Acc: 0.8857
 Site-MNIST                     (1) | Val  Loss: 0.3706 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.3043 | Val  Acc: 0.9027
 Site-MNIST                     (1) | Val  Loss: 0.2844 | Val  Acc: 0.9363
 Site-MNIST                     (1) | Val  Loss: 0.2496 | Val  Acc: 0.9212
 Site-MNIST                     (1) | Val  Loss: 0.2158 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.3512 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2320 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.1946 | Val  Acc: 0.9375
 Site-USPS                      (2) | Val  Loss: 0.1710 | Val  Acc: 0.9655
 Site-USPS                      (2) | Val  Loss: 0.2316 | Val  Acc: 0.9190
 Site-USPS                      (2) | Val  Loss: 0.2621 | Val  Acc: 0.9206
 Site-SynthDigits               (3) | Val  Loss: 0.2818 | Val  Acc: 0.9067
 Site-SynthDigits               (3) | Val  Loss: 0.3616 | Val  Acc: 0.8676
 Site-SynthDigits               (3) | Val  Loss: 0.3555 | Val  Acc: 0.8857
 Site-MNIST-M                   (0) | Val  Loss: 0.4120 | Val  Acc: 0.8444
 Site-MNIST-M                   (0) | Val  Loss: 0.4999 | Val  Acc: 0.8098
 Site-SVHN                      (4) | Val  Loss: 0.6560 | Val  Acc: 0.7872
Average Valid Accuracy: 0.9074
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.8857
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.8730
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9027
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9363
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9212
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9366
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.9375
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.9655
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.9190
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.9206
 Best site-SynthDigits              (3)  | Epoch:46 | Val Acc: 0.9067
 Best site-SynthDigits              (3)  | Epoch:46 | Val Acc: 0.8676
 Best site-SynthDigits              (3)  | Epoch:46 | Val Acc: 0.8857
 Best site-MNIST-M                  (0)  | Epoch:46 | Val Acc: 0.8444
 Best site-MNIST-M                  (0)  | Epoch:46 | Val Acc: 0.8098
 Best site-SVHN                     (4)  | Epoch:46 | Val Acc: 0.7872
 Test site-MNIST                     (1)| Epoch:46 | Test Acc: 0.9363
 Test site-USPS                      (2)| Epoch:46 | Test Acc: 0.9237
 Test site-SynthDigits               (3)| Epoch:46 | Test Acc: 0.8920
 Test site-MNIST-M                   (0)| Epoch:46 | Test Acc: 0.7632
 Test site-MNIST-M                   (0)| Epoch:46 | Test Acc: 0.7632
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.6952
MNIST: 0.8209, USPS: 0.9237, SynthDigits: 0.8920, SVHN: 0.6952, 
Average Test Accuracy(group): 0.8330, Average Test Accuracy(individual): 0.9001,
domain CV=0.1054, cluster CV=0.1137, individual CV=0.0734, 
Average Test Accuracy: 0.8330
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 6, 9, 2, 4, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                    | Train Loss: 0.2854 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.0960 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1133 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2374 | Train Acc: 0.9481
 Site-MNIST                    | Train Loss: 0.0977 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2148 | Train Acc: 0.9286
 Site-MNIST                    | Train Loss: 0.1794 | Train Acc: 0.9471
 Site-MNIST                    | Train Loss: 0.2172 | Train Acc: 0.9315
 Site-MNIST                    | Train Loss: 0.1775 | Train Acc: 0.9443
 Site-MNIST                    | Train Loss: 0.2002 | Train Acc: 0.9412
 Site-USPS                     | Train Loss: 0.1552 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.1974 | Train Acc: 0.9444
 Site-USPS                     | Train Loss: 0.2245 | Train Acc: 0.8880
 Site-USPS                     | Train Loss: 0.2561 | Train Acc: 0.9400
 Site-USPS                     | Train Loss: 0.2356 | Train Acc: 0.9119
 Site-USPS                     | Train Loss: 0.2030 | Train Acc: 0.9405
 Site-SynthDigits              | Train Loss: 0.3985 | Train Acc: 0.8647
 Site-SynthDigits              | Train Loss: 0.3734 | Train Acc: 0.8848
 Site-SynthDigits              | Train Loss: 0.2915 | Train Acc: 0.9126
 Site-MNIST-M                  | Train Loss: 0.4770 | Train Acc: 0.8571
 Site-MNIST-M                  | Train Loss: 0.4717 | Train Acc: 0.8626
 Site-SVHN                     | Train Loss: 0.6005 | Train Acc: 0.8216
 Site-MNIST                     (0) | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1189 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.1113 | Val  Acc: 0.9474
 Site-MNIST                     (2) | Val  Loss: 0.3025 | Val  Acc: 0.8571
 Site-MNIST                     (2) | Val  Loss: 0.3429 | Val  Acc: 0.8730
 Site-MNIST                     (2) | Val  Loss: 0.2874 | Val  Acc: 0.9115
 Site-MNIST                     (2) | Val  Loss: 0.2587 | Val  Acc: 0.9314
 Site-MNIST                     (2) | Val  Loss: 0.2383 | Val  Acc: 0.9239
 Site-MNIST                     (2) | Val  Loss: 0.2078 | Val  Acc: 0.9426
 Site-USPS                      (1) | Val  Loss: 0.3498 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.2302 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.1881 | Val  Acc: 0.9531
 Site-USPS                      (1) | Val  Loss: 0.1586 | Val  Acc: 0.9655
 Site-USPS                      (1) | Val  Loss: 0.2133 | Val  Acc: 0.9286
 Site-USPS                      (1) | Val  Loss: 0.2431 | Val  Acc: 0.9233
 Site-SynthDigits               (4) | Val  Loss: 0.2648 | Val  Acc: 0.8800
 Site-SynthDigits               (4) | Val  Loss: 0.3630 | Val  Acc: 0.8456
 Site-SynthDigits               (4) | Val  Loss: 0.3390 | Val  Acc: 0.8776
 Site-MNIST-M                   (3) | Val  Loss: 0.4054 | Val  Acc: 0.8556
 Site-MNIST-M                   (3) | Val  Loss: 0.4934 | Val  Acc: 0.8037
 Site-SVHN                      (4) | Val  Loss: 0.6745 | Val  Acc: 0.7801
Average Valid Accuracy: 0.9053
 Test site-MNIST                     (0)| Epoch:46 | Test Acc: 0.9378
 Test site-USPS                      (1)| Epoch:46 | Test Acc: 0.9296
 Test site-SynthDigits               (4)| Epoch:46 | Test Acc: 0.8934
 Test site-MNIST-M                   (3)| Epoch:46 | Test Acc: 0.7623
 Test site-MNIST-M                   (3)| Epoch:46 | Test Acc: 0.7623
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.6880
MNIST: 0.8208, USPS: 0.9296, SynthDigits: 0.8934, SVHN: 0.6880, 
Average Test Accuracy(group): 0.8330, Average Test Accuracy(individual): 0.9022,
domain CV=0.1109, cluster CV=nan, individual CV=0.0756, 
Average Test Accuracy: 0.8330
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 48 ============
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                    | Train Loss: 0.3355 | Train Acc: 0.7692
 Site-MNIST                    | Train Loss: 0.1064 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1104 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.1585 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.0984 | Train Acc: 0.9643
 Site-MNIST                    | Train Loss: 0.2149 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.2366 | Train Acc: 0.9427
 Site-MNIST                    | Train Loss: 0.2168 | Train Acc: 0.9303
 Site-MNIST                    | Train Loss: 0.1796 | Train Acc: 0.9437
 Site-MNIST                    | Train Loss: 0.1996 | Train Acc: 0.9393
 Site-USPS                     | Train Loss: 0.1780 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.1979 | Train Acc: 0.9375
 Site-USPS                     | Train Loss: 0.2329 | Train Acc: 0.8919
 Site-USPS                     | Train Loss: 0.2274 | Train Acc: 0.9379
 Site-USPS                     | Train Loss: 0.2506 | Train Acc: 0.9107
 Site-USPS                     | Train Loss: 0.2066 | Train Acc: 0.9392
 Site-SynthDigits              | Train Loss: 0.3921 | Train Acc: 0.8746
 Site-SynthDigits              | Train Loss: 0.3666 | Train Acc: 0.9013
 Site-SynthDigits              | Train Loss: 0.2873 | Train Acc: 0.9085
 Site-MNIST-M                  | Train Loss: 0.4931 | Train Acc: 0.8462
 Site-MNIST-M                  | Train Loss: 0.4556 | Train Acc: 0.8687
 Site-SVHN                     | Train Loss: 0.5762 | Train Acc: 0.8322
 Site-MNIST                     (1) | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1422 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1215 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3063 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.3545 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.2909 | Val  Acc: 0.9027
 Site-MNIST                     (1) | Val  Loss: 0.2696 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2374 | Val  Acc: 0.9212
 Site-MNIST                     (1) | Val  Loss: 0.2048 | Val  Acc: 0.9396
 Site-USPS                      (2) | Val  Loss: 0.3417 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2249 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.1899 | Val  Acc: 0.9375
 Site-USPS                      (2) | Val  Loss: 0.1655 | Val  Acc: 0.9655
 Site-USPS                      (2) | Val  Loss: 0.2165 | Val  Acc: 0.9286
 Site-USPS                      (2) | Val  Loss: 0.2446 | Val  Acc: 0.9259
 Site-SynthDigits               (0) | Val  Loss: 0.2746 | Val  Acc: 0.9067
 Site-SynthDigits               (0) | Val  Loss: 0.3580 | Val  Acc: 0.8676
 Site-SynthDigits               (0) | Val  Loss: 0.3461 | Val  Acc: 0.8857
 Site-MNIST-M                   (3) | Val  Loss: 0.4084 | Val  Acc: 0.8556
 Site-MNIST-M                   (3) | Val  Loss: 0.5051 | Val  Acc: 0.7975
 Site-SVHN                      (4) | Val  Loss: 0.6401 | Val  Acc: 0.8014
Average Valid Accuracy: 0.9073
 Test site-MNIST                     (1)| Epoch:47 | Test Acc: 0.9381
 Test site-USPS                      (2)| Epoch:47 | Test Acc: 0.9301
 Test site-SynthDigits               (0)| Epoch:47 | Test Acc: 0.8940
 Test site-MNIST-M                   (3)| Epoch:47 | Test Acc: 0.7570
 Test site-MNIST-M                   (3)| Epoch:47 | Test Acc: 0.7570
 Test site-SVHN                      (4)| Epoch:47 | Test Acc: 0.6970
MNIST: 0.8174, USPS: 0.9301, SynthDigits: 0.8940, SVHN: 0.6970, 
Average Test Accuracy(group): 0.8346, Average Test Accuracy(individual): 0.9025,
domain CV=0.1069, cluster CV=0.1161, individual CV=0.0755, 
Average Test Accuracy: 0.8346
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
============ Train epoch 49 ============
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                    | Train Loss: 0.3388 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.1005 | Train Acc: 1.0000
 Site-MNIST                    | Train Loss: 0.1051 | Train Acc: 0.9767
 Site-MNIST                    | Train Loss: 0.2222 | Train Acc: 0.9351
 Site-MNIST                    | Train Loss: 0.1007 | Train Acc: 0.9571
 Site-MNIST                    | Train Loss: 0.2148 | Train Acc: 0.9365
 Site-MNIST                    | Train Loss: 0.1845 | Train Acc: 0.9493
 Site-MNIST                    | Train Loss: 0.2178 | Train Acc: 0.9303
 Site-MNIST                    | Train Loss: 0.1792 | Train Acc: 0.9450
 Site-MNIST                    | Train Loss: 0.2018 | Train Acc: 0.9412
 Site-USPS                     | Train Loss: 0.3317 | Train Acc: 0.9750
 Site-USPS                     | Train Loss: 0.1624 | Train Acc: 0.9306
 Site-USPS                     | Train Loss: 0.2291 | Train Acc: 0.8919
 Site-USPS                     | Train Loss: 0.2492 | Train Acc: 0.9379
 Site-USPS                     | Train Loss: 0.2418 | Train Acc: 0.9179
 Site-USPS                     | Train Loss: 0.2049 | Train Acc: 0.9385
 Site-SynthDigits              | Train Loss: 0.3986 | Train Acc: 0.8680
 Site-SynthDigits              | Train Loss: 0.3640 | Train Acc: 0.8940
 Site-SynthDigits              | Train Loss: 0.2875 | Train Acc: 0.9075
 Site-MNIST-M                  | Train Loss: 0.4888 | Train Acc: 0.8599
 Site-MNIST-M                  | Train Loss: 0.4683 | Train Acc: 0.8718
 Site-SVHN                     | Train Loss: 0.5660 | Train Acc: 0.8481
 Site-MNIST                     (1) | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1421 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.1208 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.3110 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.3560 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.2885 | Val  Acc: 0.9115
 Site-MNIST                     (1) | Val  Loss: 0.2682 | Val  Acc: 0.9265
 Site-MNIST                     (1) | Val  Loss: 0.2366 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.2044 | Val  Acc: 0.9396
 Site-USPS                      (2) | Val  Loss: 0.3416 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.2229 | Val  Acc: 0.9167
 Site-USPS                      (2) | Val  Loss: 0.1881 | Val  Acc: 0.9375
 Site-USPS                      (2) | Val  Loss: 0.1649 | Val  Acc: 0.9655
 Site-USPS                      (2) | Val  Loss: 0.2176 | Val  Acc: 0.9286
 Site-USPS                      (2) | Val  Loss: 0.2435 | Val  Acc: 0.9233
 Site-SynthDigits               (0) | Val  Loss: 0.2741 | Val  Acc: 0.9067
 Site-SynthDigits               (0) | Val  Loss: 0.3520 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.3432 | Val  Acc: 0.8857
 Site-MNIST-M                   (3) | Val  Loss: 0.4035 | Val  Acc: 0.8556
 Site-MNIST-M                   (3) | Val  Loss: 0.5023 | Val  Acc: 0.7975
 Site-SVHN                      (4) | Val  Loss: 0.6404 | Val  Acc: 0.8014
Average Valid Accuracy: 0.9082
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.8571
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.8730
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9115
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9265
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9239
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9396
 Best site-USPS                     (2)  | Epoch:49 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:49 | Val Acc: 0.9167
 Best site-USPS                     (2)  | Epoch:49 | Val Acc: 0.9375
 Best site-USPS                     (2)  | Epoch:49 | Val Acc: 0.9655
 Best site-USPS                     (2)  | Epoch:49 | Val Acc: 0.9286
 Best site-USPS                     (2)  | Epoch:49 | Val Acc: 0.9233
 Best site-SynthDigits              (0)  | Epoch:49 | Val Acc: 0.9067
 Best site-SynthDigits              (0)  | Epoch:49 | Val Acc: 0.8824
 Best site-SynthDigits              (0)  | Epoch:49 | Val Acc: 0.8857
 Best site-MNIST-M                  (3)  | Epoch:49 | Val Acc: 0.8556
 Best site-MNIST-M                  (3)  | Epoch:49 | Val Acc: 0.7975
 Best site-SVHN                     (4)  | Epoch:49 | Val Acc: 0.8014
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9386
 Test site-USPS                      (2)| Epoch:49 | Test Acc: 0.9312
 Test site-SynthDigits               (0)| Epoch:49 | Test Acc: 0.8952
 Test site-MNIST-M                   (3)| Epoch:49 | Test Acc: 0.7576
 Test site-MNIST-M                   (3)| Epoch:49 | Test Acc: 0.7576
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.6949
MNIST: 0.8180, USPS: 0.9312, SynthDigits: 0.8952, SVHN: 0.6949, 
Average Test Accuracy(group): 0.8348, Average Test Accuracy(individual): 0.9031,
domain CV=0.1085, cluster CV=0.1172, individual CV=0.0758, 
Average Test Accuracy: 0.8348
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_cb/ccop_q=1...
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9386
 Test site-USPS                      (2)| Epoch:49 | Test Acc: 0.9312
 Test site-SynthDigits               (0)| Epoch:49 | Test Acc: 0.8952
 Test site-MNIST-M                   (3)| Epoch:49 | Test Acc: 0.7576
 Test site-MNIST-M                   (3)| Epoch:49 | Test Acc: 0.7576
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.6949
MNIST: 0.8180, USPS: 0.9312, SynthDigits: 0.8952, SVHN: 0.6949, 
Average Test Accuracy(group): 0.8348, Average Test Accuracy(individual): 0.9031,
domain CV=0.1085, cluster CV=0.1172, individual CV=0.0758, 
===2023-06-10 22:49:16===
===2023-06-10 22:49:33===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[13,24,43,77,140,252,454,818,1473,2651,80,144,259,467,840,1513,303,547,984,364,655,566,
client_nums=[10,6,3,2,1,]
len_dataset=[7438,4132,2295,1275,708,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9386
 Test site-USPS                      (2)| Epoch:49 | Test Acc: 0.9312
 Test site-SynthDigits               (0)| Epoch:49 | Test Acc: 0.8952
 Test site-MNIST-M                   (3)| Epoch:49 | Test Acc: 0.7576
 Test site-MNIST-M                   (3)| Epoch:49 | Test Acc: 0.7576
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.6949
MNIST: 0.8180, USPS: 0.9312, SynthDigits: 0.8952, SVHN: 0.6949, 
Average Test Accuracy(group): 0.8348, Average Test Accuracy(individual): 0.9031,
domain CV=0.1085, cluster CV=0.1172, individual CV=0.0758, 
