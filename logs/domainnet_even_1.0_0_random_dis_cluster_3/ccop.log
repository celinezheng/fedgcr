===2023-08-13 16:02:21===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[8, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (0) | Train Loss: 2.0270 | Train Acc: 0.3248
 Site-Clipart                   (0) | Train Loss: 2.0528 | Train Acc: 0.3347
 Site-Real                      (0) | Train Loss: 1.9438 | Train Acc: 0.4713
 Site-Real                      (0) | Train Loss: 1.9334 | Train Acc: 0.5021
 Site-Painting                  (0) | Train Loss: 1.9761 | Train Acc: 0.4331
 Site-Painting                  (0) | Train Loss: 1.9599 | Train Acc: 0.4661
 Site-Sketch                    (0) | Train Loss: 1.9869 | Train Acc: 0.4331
 Site-Sketch                    (0) | Train Loss: 2.0196 | Train Acc: 0.3686
 Site-QuickDraw                 (1) | Train Loss: 2.2237 | Train Acc: 0.1720
 Site-QuickDraw                 (1) | Train Loss: 2.2131 | Train Acc: 0.1970
 Site-Infograph                 (2) | Train Loss: 2.1854 | Train Acc: 0.1911
 Site-Infograph                 (2) | Train Loss: 2.1994 | Train Acc: 0.2521
Average Train Accuracy: 0.3455
 Site-Clipart                   (0) | Val  Loss: 2.1322 | Val  Acc: 0.2762
 Site-Clipart                   (0) | Val  Loss: 2.0882 | Val  Acc: 0.3111
 Site-Real                      (0) | Val  Loss: 1.9005 | Val  Acc: 0.5429
 Site-Real                      (0) | Val  Loss: 1.9571 | Val  Acc: 0.4952
 Site-Painting                  (0) | Val  Loss: 1.9377 | Val  Acc: 0.4571
 Site-Painting                  (0) | Val  Loss: 1.9491 | Val  Acc: 0.4667
 Site-Sketch                    (0) | Val  Loss: 2.0687 | Val  Acc: 0.3619
 Site-Sketch                    (0) | Val  Loss: 2.0408 | Val  Acc: 0.3746
 Site-QuickDraw                 (1) | Val  Loss: 2.2060 | Val  Acc: 0.2000
 Site-QuickDraw                 (1) | Val  Loss: 2.2081 | Val  Acc: 0.2159
 Site-Infograph                 (2) | Val  Loss: 2.2142 | Val  Acc: 0.2190
 Site-Infograph                 (2) | Val  Loss: 2.1774 | Val  Acc: 0.2444
Average Valid Accuracy: 0.3471
 Best site-Clipart                  (0)  | Epoch:0 | Val Acc: 0.2762
 Best site-Clipart                  (0)  | Epoch:0 | Val Acc: 0.3111
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.5429
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4952
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.4571
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.4667
 Best site-Sketch                   (0)  | Epoch:0 | Val Acc: 0.3619
 Best site-Sketch                   (0)  | Epoch:0 | Val Acc: 0.3746
 Best site-QuickDraw                (1)  | Epoch:0 | Val Acc: 0.2000
 Best site-QuickDraw                (1)  | Epoch:0 | Val Acc: 0.2159
 Best site-Infograph                (2)  | Epoch:0 | Val Acc: 0.2190
 Best site-Infograph                (2)  | Epoch:0 | Val Acc: 0.2444
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 4, 6, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (1) | Train Loss: 1.7305 | Train Acc: 0.5159
 Site-Clipart                   (1) | Train Loss: 1.7425 | Train Acc: 0.5572
 Site-Real                      (2) | Train Loss: 1.6268 | Train Acc: 0.6178
 Site-Real                      (2) | Train Loss: 1.5227 | Train Acc: 0.6843
 Site-Painting                  (2) | Train Loss: 1.6563 | Train Acc: 0.5796
 Site-Painting                  (2) | Train Loss: 1.6203 | Train Acc: 0.6208
 Site-Sketch                    (1) | Train Loss: 1.6386 | Train Acc: 0.6051
 Site-Sketch                    (1) | Train Loss: 1.7023 | Train Acc: 0.5572
 Site-QuickDraw                 (0) | Train Loss: 2.1601 | Train Acc: 0.2803
 Site-QuickDraw                 (0) | Train Loss: 2.1230 | Train Acc: 0.3326
 Site-Infograph                 (2) | Train Loss: 2.1095 | Train Acc: 0.2930
 Site-Infograph                 (2) | Train Loss: 2.0188 | Train Acc: 0.3750
Average Train Accuracy: 0.5016
 Site-Clipart                   (1) | Val  Loss: 1.8304 | Val  Acc: 0.4762
 Site-Clipart                   (1) | Val  Loss: 1.7775 | Val  Acc: 0.5238
 Site-Real                      (2) | Val  Loss: 1.5636 | Val  Acc: 0.6286
 Site-Real                      (2) | Val  Loss: 1.5444 | Val  Acc: 0.7111
 Site-Painting                  (2) | Val  Loss: 1.5579 | Val  Acc: 0.6857
 Site-Painting                  (2) | Val  Loss: 1.6172 | Val  Acc: 0.6508
 Site-Sketch                    (1) | Val  Loss: 1.7983 | Val  Acc: 0.5238
 Site-Sketch                    (1) | Val  Loss: 1.7288 | Val  Acc: 0.5619
 Site-QuickDraw                 (0) | Val  Loss: 2.1095 | Val  Acc: 0.3905
 Site-QuickDraw                 (0) | Val  Loss: 2.1136 | Val  Acc: 0.3460
 Site-Infograph                 (2) | Val  Loss: 2.1080 | Val  Acc: 0.3048
 Site-Infograph                 (2) | Val  Loss: 2.0186 | Val  Acc: 0.3683
Average Valid Accuracy: 0.5143
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.4762
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.5238
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6286
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.7111
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.6857
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.6508
 Best site-Sketch                   (1)  | Epoch:1 | Val Acc: 0.5238
 Best site-Sketch                   (1)  | Epoch:1 | Val Acc: 0.5619
 Best site-QuickDraw                (0)  | Epoch:1 | Val Acc: 0.3905
 Best site-QuickDraw                (0)  | Epoch:1 | Val Acc: 0.3460
 Best site-Infograph                (2)  | Epoch:1 | Val Acc: 0.3048
 Best site-Infograph                (2)  | Epoch:1 | Val Acc: 0.3683
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 4, 6, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (1) | Train Loss: 1.4906 | Train Acc: 0.6051
 Site-Clipart                   (1) | Train Loss: 1.4511 | Train Acc: 0.6335
 Site-Real                      (2) | Train Loss: 1.3604 | Train Acc: 0.7134
 Site-Real                      (2) | Train Loss: 1.1730 | Train Acc: 0.7903
 Site-Painting                  (2) | Train Loss: 1.3692 | Train Acc: 0.7070
 Site-Painting                  (2) | Train Loss: 1.3156 | Train Acc: 0.7203
 Site-Sketch                    (1) | Train Loss: 1.3541 | Train Acc: 0.6688
 Site-Sketch                    (1) | Train Loss: 1.3965 | Train Acc: 0.6907
 Site-QuickDraw                 (0) | Train Loss: 2.0618 | Train Acc: 0.3121
 Site-QuickDraw                 (0) | Train Loss: 2.0576 | Train Acc: 0.3284
 Site-Infograph                 (2) | Train Loss: 1.9598 | Train Acc: 0.3694
 Site-Infograph                 (2) | Train Loss: 1.8580 | Train Acc: 0.4386
Average Train Accuracy: 0.5815
 Site-Clipart                   (1) | Val  Loss: 1.5535 | Val  Acc: 0.6000
 Site-Clipart                   (1) | Val  Loss: 1.5574 | Val  Acc: 0.5841
 Site-Real                      (2) | Val  Loss: 1.2399 | Val  Acc: 0.7810
 Site-Real                      (2) | Val  Loss: 1.2203 | Val  Acc: 0.7810
 Site-Painting                  (2) | Val  Loss: 1.2332 | Val  Acc: 0.7810
 Site-Painting                  (2) | Val  Loss: 1.3045 | Val  Acc: 0.7238
 Site-Sketch                    (1) | Val  Loss: 1.4520 | Val  Acc: 0.6000
 Site-Sketch                    (1) | Val  Loss: 1.4316 | Val  Acc: 0.6667
 Site-QuickDraw                 (0) | Val  Loss: 2.0428 | Val  Acc: 0.3238
 Site-QuickDraw                 (0) | Val  Loss: 2.0350 | Val  Acc: 0.3397
 Site-Infograph                 (2) | Val  Loss: 1.8875 | Val  Acc: 0.4571
 Site-Infograph                 (2) | Val  Loss: 1.8794 | Val  Acc: 0.4000
Average Valid Accuracy: 0.5865
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.6000
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.5841
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7810
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7810
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.7810
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.7238
 Best site-Sketch                   (1)  | Epoch:2 | Val Acc: 0.6000
 Best site-Sketch                   (1)  | Epoch:2 | Val Acc: 0.6667
 Best site-QuickDraw                (0)  | Epoch:2 | Val Acc: 0.3238
 Best site-QuickDraw                (0)  | Epoch:2 | Val Acc: 0.3397
 Best site-Infograph                (2)  | Epoch:2 | Val Acc: 0.4571
 Best site-Infograph                (2)  | Epoch:2 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 4, 6, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (2) | Train Loss: 1.2883 | Train Acc: 0.6752
 Site-Clipart                   (2) | Train Loss: 1.2252 | Train Acc: 0.7246
 Site-Real                      (1) | Train Loss: 1.0772 | Train Acc: 0.8025
 Site-Real                      (1) | Train Loss: 0.9691 | Train Acc: 0.8284
 Site-Painting                  (1) | Train Loss: 1.1963 | Train Acc: 0.7389
 Site-Painting                  (1) | Train Loss: 1.0870 | Train Acc: 0.8008
 Site-Sketch                    (2) | Train Loss: 1.1427 | Train Acc: 0.7389
 Site-Sketch                    (2) | Train Loss: 1.2144 | Train Acc: 0.7076
 Site-QuickDraw                 (0) | Train Loss: 1.9611 | Train Acc: 0.3248
 Site-QuickDraw                 (0) | Train Loss: 1.9422 | Train Acc: 0.3686
 Site-Infograph                 (2) | Train Loss: 1.7991 | Train Acc: 0.4586
 Site-Infograph                 (2) | Train Loss: 1.7291 | Train Acc: 0.4894
Average Train Accuracy: 0.6382
 Site-Clipart                   (2) | Val  Loss: 1.3581 | Val  Acc: 0.6667
 Site-Clipart                   (2) | Val  Loss: 1.3053 | Val  Acc: 0.6698
 Site-Real                      (1) | Val  Loss: 1.0345 | Val  Acc: 0.7810
 Site-Real                      (1) | Val  Loss: 0.9835 | Val  Acc: 0.8032
 Site-Painting                  (1) | Val  Loss: 1.0484 | Val  Acc: 0.8286
 Site-Painting                  (1) | Val  Loss: 1.1066 | Val  Acc: 0.7587
 Site-Sketch                    (2) | Val  Loss: 1.2300 | Val  Acc: 0.7333
 Site-Sketch                    (2) | Val  Loss: 1.2372 | Val  Acc: 0.7270
 Site-QuickDraw                 (0) | Val  Loss: 1.9217 | Val  Acc: 0.3714
 Site-QuickDraw                 (0) | Val  Loss: 1.9380 | Val  Acc: 0.4000
 Site-Infograph                 (2) | Val  Loss: 1.8298 | Val  Acc: 0.4286
 Site-Infograph                 (2) | Val  Loss: 1.7545 | Val  Acc: 0.4667
Average Valid Accuracy: 0.6362
 Best site-Clipart                  (2)  | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                  (2)  | Epoch:3 | Val Acc: 0.6698
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.7810
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8032
 Best site-Painting                 (1)  | Epoch:3 | Val Acc: 0.8286
 Best site-Painting                 (1)  | Epoch:3 | Val Acc: 0.7587
 Best site-Sketch                   (2)  | Epoch:3 | Val Acc: 0.7333
 Best site-Sketch                   (2)  | Epoch:3 | Val Acc: 0.7270
 Best site-QuickDraw                (0)  | Epoch:3 | Val Acc: 0.3714
 Best site-QuickDraw                (0)  | Epoch:3 | Val Acc: 0.4000
 Best site-Infograph                (2)  | Epoch:3 | Val Acc: 0.4286
 Best site-Infograph                (2)  | Epoch:3 | Val Acc: 0.4667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 4 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.1839 | Train Acc: 0.7197
 Site-Clipart                   (0) | Train Loss: 1.1190 | Train Acc: 0.7331
 Site-Real                      (2) | Train Loss: 0.9151 | Train Acc: 0.8471
 Site-Real                      (2) | Train Loss: 0.8011 | Train Acc: 0.8602
 Site-Painting                  (2) | Train Loss: 1.0379 | Train Acc: 0.7771
 Site-Painting                  (2) | Train Loss: 0.9415 | Train Acc: 0.8093
 Site-Sketch                    (0) | Train Loss: 1.0011 | Train Acc: 0.7834
 Site-Sketch                    (0) | Train Loss: 1.0686 | Train Acc: 0.7267
 Site-QuickDraw                 (1) | Train Loss: 1.8092 | Train Acc: 0.3949
 Site-QuickDraw                 (1) | Train Loss: 1.8357 | Train Acc: 0.4004
 Site-Infograph                 (0) | Train Loss: 1.7369 | Train Acc: 0.4713
 Site-Infograph                 (0) | Train Loss: 1.6127 | Train Acc: 0.5127
Average Train Accuracy: 0.6697
 Site-Clipart                   (0) | Val  Loss: 1.1812 | Val  Acc: 0.7048
 Site-Clipart                   (0) | Val  Loss: 1.1551 | Val  Acc: 0.7175
 Site-Real                      (2) | Val  Loss: 0.8823 | Val  Acc: 0.8286
 Site-Real                      (2) | Val  Loss: 0.8259 | Val  Acc: 0.8349
 Site-Painting                  (2) | Val  Loss: 0.8301 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 0.9120 | Val  Acc: 0.8095
 Site-Sketch                    (0) | Val  Loss: 1.0747 | Val  Acc: 0.7333
 Site-Sketch                    (0) | Val  Loss: 1.0852 | Val  Acc: 0.7111
 Site-QuickDraw                 (1) | Val  Loss: 1.8272 | Val  Acc: 0.4095
 Site-QuickDraw                 (1) | Val  Loss: 1.7945 | Val  Acc: 0.4413
 Site-Infograph                 (0) | Val  Loss: 1.6692 | Val  Acc: 0.4857
 Site-Infograph                 (0) | Val  Loss: 1.6478 | Val  Acc: 0.4698
Average Valid Accuracy: 0.6669
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7048
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7175
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8286
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8349
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.8571
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.7333
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.7111
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.4095
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.4413
 Best site-Infograph                (0)  | Epoch:4 | Val Acc: 0.4857
 Best site-Infograph                (0)  | Epoch:4 | Val Acc: 0.4698
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 5 ============
cnt=[6, 4, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 0.9726 | Train Acc: 0.7389
 Site-Clipart                   (0) | Train Loss: 0.9974 | Train Acc: 0.7754
 Site-Real                      (1) | Train Loss: 0.7863 | Train Acc: 0.8726
 Site-Real                      (1) | Train Loss: 0.7004 | Train Acc: 0.8983
 Site-Painting                  (1) | Train Loss: 0.8896 | Train Acc: 0.7834
 Site-Painting                  (1) | Train Loss: 0.8164 | Train Acc: 0.8432
 Site-Sketch                    (0) | Train Loss: 0.8593 | Train Acc: 0.8535
 Site-Sketch                    (0) | Train Loss: 0.9260 | Train Acc: 0.7754
 Site-QuickDraw                 (2) | Train Loss: 1.6492 | Train Acc: 0.4268
 Site-QuickDraw                 (2) | Train Loss: 1.6834 | Train Acc: 0.4894
 Site-Infograph                 (0) | Train Loss: 1.6028 | Train Acc: 0.4904
 Site-Infograph                 (0) | Train Loss: 1.5599 | Train Acc: 0.5233
Average Train Accuracy: 0.7059
 Site-Clipart                   (0) | Val  Loss: 1.0107 | Val  Acc: 0.7619
 Site-Clipart                   (0) | Val  Loss: 1.0479 | Val  Acc: 0.7460
 Site-Real                      (1) | Val  Loss: 0.7553 | Val  Acc: 0.8476
 Site-Real                      (1) | Val  Loss: 0.7203 | Val  Acc: 0.8762
 Site-Painting                  (1) | Val  Loss: 0.7345 | Val  Acc: 0.9048
 Site-Painting                  (1) | Val  Loss: 0.8159 | Val  Acc: 0.8667
 Site-Sketch                    (0) | Val  Loss: 0.9408 | Val  Acc: 0.8000
 Site-Sketch                    (0) | Val  Loss: 0.9784 | Val  Acc: 0.7556
 Site-QuickDraw                 (2) | Val  Loss: 1.6692 | Val  Acc: 0.4762
 Site-QuickDraw                 (2) | Val  Loss: 1.6487 | Val  Acc: 0.5111
 Site-Infograph                 (0) | Val  Loss: 1.6072 | Val  Acc: 0.4667
 Site-Infograph                 (0) | Val  Loss: 1.5664 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7116
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7460
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.8476
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.8762
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.9048
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.8667
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.8000
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.7556
 Best site-QuickDraw                (2)  | Epoch:5 | Val Acc: 0.4762
 Best site-QuickDraw                (2)  | Epoch:5 | Val Acc: 0.5111
 Best site-Infograph                (0)  | Epoch:5 | Val Acc: 0.4667
 Best site-Infograph                (0)  | Epoch:5 | Val Acc: 0.5270
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 6, 4, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (1) | Train Loss: 0.9615 | Train Acc: 0.7197
 Site-Clipart                   (1) | Train Loss: 0.8911 | Train Acc: 0.7924
 Site-Real                      (2) | Train Loss: 0.7260 | Train Acc: 0.8726
 Site-Real                      (2) | Train Loss: 0.6152 | Train Acc: 0.8919
 Site-Painting                  (2) | Train Loss: 0.8331 | Train Acc: 0.7643
 Site-Painting                  (2) | Train Loss: 0.7343 | Train Acc: 0.8559
 Site-Sketch                    (1) | Train Loss: 0.7880 | Train Acc: 0.8344
 Site-Sketch                    (1) | Train Loss: 0.8495 | Train Acc: 0.7839
 Site-QuickDraw                 (0) | Train Loss: 1.4902 | Train Acc: 0.5669
 Site-QuickDraw                 (0) | Train Loss: 1.5249 | Train Acc: 0.5847
 Site-Infograph                 (1) | Train Loss: 1.4921 | Train Acc: 0.4841
 Site-Infograph                 (1) | Train Loss: 1.4735 | Train Acc: 0.5614
Average Train Accuracy: 0.7260
 Site-Clipart                   (1) | Val  Loss: 0.9421 | Val  Acc: 0.8190
 Site-Clipart                   (1) | Val  Loss: 0.9439 | Val  Acc: 0.7778
 Site-Real                      (2) | Val  Loss: 0.6844 | Val  Acc: 0.8476
 Site-Real                      (2) | Val  Loss: 0.6332 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.6515 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.7431 | Val  Acc: 0.8508
 Site-Sketch                    (1) | Val  Loss: 0.9019 | Val  Acc: 0.7619
 Site-Sketch                    (1) | Val  Loss: 0.8601 | Val  Acc: 0.7778
 Site-QuickDraw                 (0) | Val  Loss: 1.5350 | Val  Acc: 0.5238
 Site-QuickDraw                 (0) | Val  Loss: 1.4937 | Val  Acc: 0.5460
 Site-Infograph                 (1) | Val  Loss: 1.5416 | Val  Acc: 0.5429
 Site-Infograph                 (1) | Val  Loss: 1.4942 | Val  Acc: 0.5238
Average Valid Accuracy: 0.7317
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.8190
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.7778
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.8476
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.9048
 Best site-Painting                 (2)  | Epoch:6 | Val Acc: 0.9048
 Best site-Painting                 (2)  | Epoch:6 | Val Acc: 0.8508
 Best site-Sketch                   (1)  | Epoch:6 | Val Acc: 0.7619
 Best site-Sketch                   (1)  | Epoch:6 | Val Acc: 0.7778
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.5238
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.5460
 Best site-Infograph                (1)  | Epoch:6 | Val Acc: 0.5429
 Best site-Infograph                (1)  | Epoch:6 | Val Acc: 0.5238
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 7 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (0) | Train Loss: 0.8359 | Train Acc: 0.8153
 Site-Clipart                   (0) | Train Loss: 0.8329 | Train Acc: 0.8008
 Site-Real                      (2) | Train Loss: 0.6760 | Train Acc: 0.8726
 Site-Real                      (2) | Train Loss: 0.5474 | Train Acc: 0.8983
 Site-Painting                  (2) | Train Loss: 0.7359 | Train Acc: 0.8535
 Site-Painting                  (2) | Train Loss: 0.6865 | Train Acc: 0.8729
 Site-Sketch                    (0) | Train Loss: 0.7329 | Train Acc: 0.8471
 Site-Sketch                    (0) | Train Loss: 0.7578 | Train Acc: 0.8030
 Site-QuickDraw                 (1) | Train Loss: 1.4047 | Train Acc: 0.5541
 Site-QuickDraw                 (1) | Train Loss: 1.4261 | Train Acc: 0.5932
 Site-Infograph                 (0) | Train Loss: 1.5400 | Train Acc: 0.4968
 Site-Infograph                 (0) | Train Loss: 1.4052 | Train Acc: 0.5678
Average Train Accuracy: 0.7480
 Site-Clipart                   (0) | Val  Loss: 0.8721 | Val  Acc: 0.7810
 Site-Clipart                   (0) | Val  Loss: 0.8961 | Val  Acc: 0.7619
 Site-Real                      (2) | Val  Loss: 0.6302 | Val  Acc: 0.8952
 Site-Real                      (2) | Val  Loss: 0.5641 | Val  Acc: 0.8952
 Site-Painting                  (2) | Val  Loss: 0.5857 | Val  Acc: 0.8857
 Site-Painting                  (2) | Val  Loss: 0.6644 | Val  Acc: 0.8730
 Site-Sketch                    (0) | Val  Loss: 0.8280 | Val  Acc: 0.8000
 Site-Sketch                    (0) | Val  Loss: 0.7816 | Val  Acc: 0.7968
 Site-QuickDraw                 (1) | Val  Loss: 1.4454 | Val  Acc: 0.5810
 Site-QuickDraw                 (1) | Val  Loss: 1.4105 | Val  Acc: 0.5905
 Site-Infograph                 (0) | Val  Loss: 1.5175 | Val  Acc: 0.5048
 Site-Infograph                 (0) | Val  Loss: 1.4548 | Val  Acc: 0.5492
Average Valid Accuracy: 0.7429
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.7810
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.7619
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.8952
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.8952
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8857
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8730
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.8000
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7968
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.5810
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.5905
 Best site-Infograph                (0)  | Epoch:7 | Val Acc: 0.5048
 Best site-Infograph                (0)  | Epoch:7 | Val Acc: 0.5492
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 2, 5, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (2) | Train Loss: 0.7622 | Train Acc: 0.7516
 Site-Clipart                   (2) | Train Loss: 0.7749 | Train Acc: 0.8242
 Site-Real                      (0) | Train Loss: 0.6019 | Train Acc: 0.8790
 Site-Real                      (0) | Train Loss: 0.5016 | Train Acc: 0.9216
 Site-Painting                  (0) | Train Loss: 0.7324 | Train Acc: 0.8089
 Site-Painting                  (0) | Train Loss: 0.6693 | Train Acc: 0.8644
 Site-Sketch                    (2) | Train Loss: 0.6962 | Train Acc: 0.8344
 Site-Sketch                    (2) | Train Loss: 0.7194 | Train Acc: 0.7860
 Site-QuickDraw                 (1) | Train Loss: 1.2994 | Train Acc: 0.6242
 Site-QuickDraw                 (1) | Train Loss: 1.2683 | Train Acc: 0.6398
 Site-Infograph                 (2) | Train Loss: 1.5291 | Train Acc: 0.5159
 Site-Infograph                 (0) | Train Loss: 1.3766 | Train Acc: 0.5593
Average Train Accuracy: 0.7508
 Site-Clipart                   (2) | Val  Loss: 0.7661 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.8225 | Val  Acc: 0.8063
 Site-Real                      (0) | Val  Loss: 0.5787 | Val  Acc: 0.8857
 Site-Real                      (0) | Val  Loss: 0.5122 | Val  Acc: 0.9111
 Site-Painting                  (0) | Val  Loss: 0.5434 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.6215 | Val  Acc: 0.8794
 Site-Sketch                    (2) | Val  Loss: 0.7400 | Val  Acc: 0.8095
 Site-Sketch                    (2) | Val  Loss: 0.7413 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 1.3503 | Val  Acc: 0.6000
 Site-QuickDraw                 (1) | Val  Loss: 1.2541 | Val  Acc: 0.6698
 Site-Infograph                 (2) | Val  Loss: 1.4496 | Val  Acc: 0.5143
 Site-Infograph                 (0) | Val  Loss: 1.4283 | Val  Acc: 0.5238
Average Valid Accuracy: 0.7635
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8381
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8063
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.8857
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.9111
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.8794
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.8095
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.8190
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.6000
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.6698
 Best site-Infograph                (2)  | Epoch:8 | Val Acc: 0.5143
 Best site-Infograph                (0)  | Epoch:8 | Val Acc: 0.5238
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 9 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.7487 | Train Acc: 0.8153
 Site-Clipart                   (2) | Train Loss: 0.7061 | Train Acc: 0.8453
 Site-Real                      (0) | Train Loss: 0.5075 | Train Acc: 0.8981
 Site-Real                      (0) | Train Loss: 0.4547 | Train Acc: 0.9216
 Site-Painting                  (0) | Train Loss: 0.6820 | Train Acc: 0.8280
 Site-Painting                  (0) | Train Loss: 0.6247 | Train Acc: 0.8581
 Site-Sketch                    (2) | Train Loss: 0.6209 | Train Acc: 0.8344
 Site-Sketch                    (2) | Train Loss: 0.7195 | Train Acc: 0.7945
 Site-QuickDraw                 (1) | Train Loss: 1.1866 | Train Acc: 0.5987
 Site-QuickDraw                 (1) | Train Loss: 1.2427 | Train Acc: 0.6610
 Site-Infograph                 (2) | Train Loss: 1.4150 | Train Acc: 0.5605
 Site-Infograph                 (2) | Train Loss: 1.3100 | Train Acc: 0.6144
Average Train Accuracy: 0.7692
 Site-Clipart                   (2) | Val  Loss: 0.7304 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.7392 | Val  Acc: 0.7968
 Site-Real                      (0) | Val  Loss: 0.5095 | Val  Acc: 0.8952
 Site-Real                      (0) | Val  Loss: 0.4816 | Val  Acc: 0.9143
 Site-Painting                  (0) | Val  Loss: 0.4896 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.6046 | Val  Acc: 0.8603
 Site-Sketch                    (2) | Val  Loss: 0.7486 | Val  Acc: 0.7810
 Site-Sketch                    (2) | Val  Loss: 0.7015 | Val  Acc: 0.8254
 Site-QuickDraw                 (1) | Val  Loss: 1.2399 | Val  Acc: 0.6476
 Site-QuickDraw                 (1) | Val  Loss: 1.1709 | Val  Acc: 0.6857
 Site-Infograph                 (2) | Val  Loss: 1.4251 | Val  Acc: 0.5429
 Site-Infograph                 (2) | Val  Loss: 1.3885 | Val  Acc: 0.5397
Average Valid Accuracy: 0.7677
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7968
 Best site-Real                     (0)  | Epoch:9 | Val Acc: 0.8952
 Best site-Real                     (0)  | Epoch:9 | Val Acc: 0.9143
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8603
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.7810
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.8254
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.6476
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.6857
 Best site-Infograph                (2)  | Epoch:9 | Val Acc: 0.5429
 Best site-Infograph                (2)  | Epoch:9 | Val Acc: 0.5397
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (2) | Train Loss: 0.7062 | Train Acc: 0.8280
 Site-Clipart                   (2) | Train Loss: 0.6892 | Train Acc: 0.8432
 Site-Real                      (0) | Train Loss: 0.4886 | Train Acc: 0.8917
 Site-Real                      (0) | Train Loss: 0.4007 | Train Acc: 0.9364
 Site-Painting                  (0) | Train Loss: 0.6045 | Train Acc: 0.8153
 Site-Painting                  (0) | Train Loss: 0.5401 | Train Acc: 0.8814
 Site-Sketch                    (2) | Train Loss: 0.6081 | Train Acc: 0.8535
 Site-Sketch                    (2) | Train Loss: 0.6475 | Train Acc: 0.8114
 Site-QuickDraw                 (1) | Train Loss: 1.0960 | Train Acc: 0.6752
 Site-QuickDraw                 (1) | Train Loss: 1.1494 | Train Acc: 0.6864
 Site-Infograph                 (2) | Train Loss: 1.4752 | Train Acc: 0.5350
 Site-Infograph                 (2) | Train Loss: 1.3251 | Train Acc: 0.5826
Average Train Accuracy: 0.7784
 Site-Clipart                   (2) | Val  Loss: 0.7069 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.7392 | Val  Acc: 0.8095
 Site-Real                      (0) | Val  Loss: 0.4923 | Val  Acc: 0.8857
 Site-Real                      (0) | Val  Loss: 0.4507 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.4412 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.5452 | Val  Acc: 0.8794
 Site-Sketch                    (2) | Val  Loss: 0.6369 | Val  Acc: 0.8286
 Site-Sketch                    (2) | Val  Loss: 0.6426 | Val  Acc: 0.8254
 Site-QuickDraw                 (1) | Val  Loss: 1.1714 | Val  Acc: 0.6857
 Site-QuickDraw                 (1) | Val  Loss: 1.1268 | Val  Acc: 0.6730
 Site-Infograph                 (2) | Val  Loss: 1.3935 | Val  Acc: 0.5524
 Site-Infograph                 (2) | Val  Loss: 1.3417 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7770
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8095
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.8857
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8794
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.8286
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.8254
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.6857
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.6730
 Best site-Infograph                (2)  | Epoch:10 | Val Acc: 0.5524
 Best site-Infograph                (2)  | Epoch:10 | Val Acc: 0.5556
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 11 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.6683 | Train Acc: 0.8344
 Site-Clipart                   (0) | Train Loss: 0.6403 | Train Acc: 0.8432
 Site-Real                      (2) | Train Loss: 0.4934 | Train Acc: 0.8981
 Site-Real                      (2) | Train Loss: 0.3997 | Train Acc: 0.9301
 Site-Painting                  (2) | Train Loss: 0.5789 | Train Acc: 0.8280
 Site-Painting                  (2) | Train Loss: 0.5514 | Train Acc: 0.8665
 Site-Sketch                    (0) | Train Loss: 0.5762 | Train Acc: 0.8471
 Site-Sketch                    (0) | Train Loss: 0.6070 | Train Acc: 0.8114
 Site-QuickDraw                 (1) | Train Loss: 1.1031 | Train Acc: 0.6879
 Site-QuickDraw                 (1) | Train Loss: 1.0958 | Train Acc: 0.6610
 Site-Infograph                 (2) | Train Loss: 1.4510 | Train Acc: 0.5159
 Site-Infograph                 (2) | Train Loss: 1.2613 | Train Acc: 0.6123
Average Train Accuracy: 0.7780
 Site-Clipart                   (0) | Val  Loss: 0.6739 | Val  Acc: 0.8190
 Site-Clipart                   (0) | Val  Loss: 0.6905 | Val  Acc: 0.8317
 Site-Real                      (2) | Val  Loss: 0.4556 | Val  Acc: 0.8952
 Site-Real                      (2) | Val  Loss: 0.4003 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.4489 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.5477 | Val  Acc: 0.8698
 Site-Sketch                    (0) | Val  Loss: 0.7103 | Val  Acc: 0.7905
 Site-Sketch                    (0) | Val  Loss: 0.6553 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 1.1646 | Val  Acc: 0.6286
 Site-QuickDraw                 (1) | Val  Loss: 1.0757 | Val  Acc: 0.7111
 Site-Infograph                 (2) | Val  Loss: 1.3587 | Val  Acc: 0.5619
 Site-Infograph                 (2) | Val  Loss: 1.3345 | Val  Acc: 0.5619
Average Valid Accuracy: 0.7751
============ Train epoch 12 ============
cnt=[5, 2, 5, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (2) | Train Loss: 0.6944 | Train Acc: 0.7962
 Site-Clipart                   (2) | Train Loss: 0.6077 | Train Acc: 0.8369
 Site-Real                      (2) | Train Loss: 0.4262 | Train Acc: 0.9108
 Site-Real                      (2) | Train Loss: 0.3569 | Train Acc: 0.9428
 Site-Painting                  (2) | Train Loss: 0.5773 | Train Acc: 0.8025
 Site-Painting                  (0) | Train Loss: 0.4857 | Train Acc: 0.8835
 Site-Sketch                    (0) | Train Loss: 0.5893 | Train Acc: 0.8280
 Site-Sketch                    (0) | Train Loss: 0.6293 | Train Acc: 0.8051
 Site-QuickDraw                 (1) | Train Loss: 1.0711 | Train Acc: 0.6879
 Site-QuickDraw                 (1) | Train Loss: 1.0545 | Train Acc: 0.7034
 Site-Infograph                 (0) | Train Loss: 1.3382 | Train Acc: 0.5796
 Site-Infograph                 (0) | Train Loss: 1.2540 | Train Acc: 0.6165
Average Train Accuracy: 0.7828
 Site-Clipart                   (2) | Val  Loss: 0.6792 | Val  Acc: 0.7905
 Site-Clipart                   (2) | Val  Loss: 0.6688 | Val  Acc: 0.8317
 Site-Real                      (2) | Val  Loss: 0.4691 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.3741 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.4301 | Val  Acc: 0.9238
 Site-Painting                  (0) | Val  Loss: 0.4992 | Val  Acc: 0.8825
 Site-Sketch                    (0) | Val  Loss: 0.6367 | Val  Acc: 0.8095
 Site-Sketch                    (0) | Val  Loss: 0.6102 | Val  Acc: 0.8127
 Site-QuickDraw                 (1) | Val  Loss: 1.0398 | Val  Acc: 0.7143
 Site-QuickDraw                 (1) | Val  Loss: 1.0414 | Val  Acc: 0.7111
 Site-Infograph                 (0) | Val  Loss: 1.2974 | Val  Acc: 0.6000
 Site-Infograph                 (0) | Val  Loss: 1.2959 | Val  Acc: 0.5905
Average Valid Accuracy: 0.7921
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.7905
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8317
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9333
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.9238
 Best site-Painting                 (0)  | Epoch:12 | Val Acc: 0.8825
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8095
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8127
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.7143
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.7111
 Best site-Infograph                (0)  | Epoch:12 | Val Acc: 0.6000
 Best site-Infograph                (0)  | Epoch:12 | Val Acc: 0.5905
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 13 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.7032 | Train Acc: 0.8408
 Site-Clipart                   (2) | Train Loss: 0.5960 | Train Acc: 0.8538
 Site-Real                      (0) | Train Loss: 0.4162 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.3481 | Train Acc: 0.9343
 Site-Painting                  (0) | Train Loss: 0.5501 | Train Acc: 0.8726
 Site-Painting                  (0) | Train Loss: 0.5084 | Train Acc: 0.8814
 Site-Sketch                    (2) | Train Loss: 0.5404 | Train Acc: 0.8535
 Site-Sketch                    (2) | Train Loss: 0.5874 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.9725 | Train Acc: 0.6497
 Site-QuickDraw                 (1) | Train Loss: 0.9872 | Train Acc: 0.7225
 Site-Infograph                 (0) | Train Loss: 1.4778 | Train Acc: 0.5159
 Site-Infograph                 (0) | Train Loss: 1.2223 | Train Acc: 0.5996
Average Train Accuracy: 0.7900
 Site-Clipart                   (2) | Val  Loss: 0.6191 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.6840 | Val  Acc: 0.8095
 Site-Real                      (0) | Val  Loss: 0.4543 | Val  Acc: 0.8857
 Site-Real                      (0) | Val  Loss: 0.3647 | Val  Acc: 0.9175
 Site-Painting                  (0) | Val  Loss: 0.4026 | Val  Acc: 0.9143
 Site-Painting                  (0) | Val  Loss: 0.4643 | Val  Acc: 0.8984
 Site-Sketch                    (2) | Val  Loss: 0.5938 | Val  Acc: 0.8381
 Site-Sketch                    (2) | Val  Loss: 0.5859 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.9992 | Val  Acc: 0.7238
 Site-QuickDraw                 (1) | Val  Loss: 0.9793 | Val  Acc: 0.7238
 Site-Infograph                 (0) | Val  Loss: 1.3420 | Val  Acc: 0.6190
 Site-Infograph                 (0) | Val  Loss: 1.2842 | Val  Acc: 0.5937
Average Valid Accuracy: 0.8008
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8476
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8095
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.8857
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9175
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.9143
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8984
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8381
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8381
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.7238
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.7238
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.6190
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.5937
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 14 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (2) | Train Loss: 0.6611 | Train Acc: 0.8408
 Site-Clipart                   (2) | Train Loss: 0.5562 | Train Acc: 0.8581
 Site-Real                      (0) | Train Loss: 0.4356 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.3228 | Train Acc: 0.9449
 Site-Painting                  (0) | Train Loss: 0.4949 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.4593 | Train Acc: 0.8708
 Site-Sketch                    (2) | Train Loss: 0.5070 | Train Acc: 0.8917
 Site-Sketch                    (2) | Train Loss: 0.5349 | Train Acc: 0.8305
 Site-QuickDraw                 (1) | Train Loss: 0.9332 | Train Acc: 0.6624
 Site-QuickDraw                 (1) | Train Loss: 0.9277 | Train Acc: 0.7415
 Site-Infograph                 (2) | Train Loss: 1.3668 | Train Acc: 0.5732
 Site-Infograph                 (2) | Train Loss: 1.2032 | Train Acc: 0.6208
Average Train Accuracy: 0.8026
 Site-Clipart                   (2) | Val  Loss: 0.5997 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.6514 | Val  Acc: 0.8095
 Site-Real                      (0) | Val  Loss: 0.4048 | Val  Acc: 0.8857
 Site-Real                      (0) | Val  Loss: 0.3490 | Val  Acc: 0.9302
 Site-Painting                  (0) | Val  Loss: 0.3628 | Val  Acc: 0.9238
 Site-Painting                  (0) | Val  Loss: 0.4543 | Val  Acc: 0.8952
 Site-Sketch                    (2) | Val  Loss: 0.5588 | Val  Acc: 0.8381
 Site-Sketch                    (2) | Val  Loss: 0.5738 | Val  Acc: 0.8349
 Site-QuickDraw                 (1) | Val  Loss: 0.9897 | Val  Acc: 0.7048
 Site-QuickDraw                 (1) | Val  Loss: 0.9102 | Val  Acc: 0.7492
 Site-Infograph                 (2) | Val  Loss: 1.2819 | Val  Acc: 0.5905
 Site-Infograph                 (2) | Val  Loss: 1.2338 | Val  Acc: 0.5968
Average Valid Accuracy: 0.7981
============ Train epoch 15 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (2) | Train Loss: 0.6036 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.5653 | Train Acc: 0.8411
 Site-Real                      (0) | Train Loss: 0.4005 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.3092 | Train Acc: 0.9364
 Site-Painting                  (0) | Train Loss: 0.5160 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.4916 | Train Acc: 0.8877
 Site-Sketch                    (2) | Train Loss: 0.5216 | Train Acc: 0.8790
 Site-Sketch                    (2) | Train Loss: 0.5643 | Train Acc: 0.8263
 Site-QuickDraw                 (1) | Train Loss: 0.9077 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.9057 | Train Acc: 0.7458
 Site-Infograph                 (0) | Train Loss: 1.3972 | Train Acc: 0.5350
 Site-Infograph                 (0) | Train Loss: 1.1425 | Train Acc: 0.6314
Average Train Accuracy: 0.8081
 Site-Clipart                   (2) | Val  Loss: 0.5728 | Val  Acc: 0.9143
 Site-Clipart                   (2) | Val  Loss: 0.6200 | Val  Acc: 0.8095
 Site-Real                      (0) | Val  Loss: 0.3479 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.3318 | Val  Acc: 0.9270
 Site-Painting                  (0) | Val  Loss: 0.3898 | Val  Acc: 0.9238
 Site-Painting                  (0) | Val  Loss: 0.4553 | Val  Acc: 0.8921
 Site-Sketch                    (2) | Val  Loss: 0.6114 | Val  Acc: 0.8286
 Site-Sketch                    (2) | Val  Loss: 0.5594 | Val  Acc: 0.8444
 Site-QuickDraw                 (1) | Val  Loss: 0.9233 | Val  Acc: 0.7333
 Site-QuickDraw                 (1) | Val  Loss: 0.9074 | Val  Acc: 0.7683
 Site-Infograph                 (0) | Val  Loss: 1.2087 | Val  Acc: 0.6571
 Site-Infograph                 (0) | Val  Loss: 1.2269 | Val  Acc: 0.5873
Average Valid Accuracy: 0.8190
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.9143
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8095
 Best site-Real                     (0)  | Epoch:15 | Val Acc: 0.9429
 Best site-Real                     (0)  | Epoch:15 | Val Acc: 0.9270
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.9238
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.8921
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8286
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8444
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.7333
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.7683
 Best site-Infograph                (0)  | Epoch:15 | Val Acc: 0.6571
 Best site-Infograph                (0)  | Epoch:15 | Val Acc: 0.5873
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 16 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (2) | Train Loss: 0.5752 | Train Acc: 0.8535
 Site-Clipart                   (2) | Train Loss: 0.5601 | Train Acc: 0.8602
 Site-Real                      (0) | Train Loss: 0.4388 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.3005 | Train Acc: 0.9301
 Site-Painting                  (0) | Train Loss: 0.4549 | Train Acc: 0.8535
 Site-Painting                  (0) | Train Loss: 0.4181 | Train Acc: 0.8941
 Site-Sketch                    (2) | Train Loss: 0.4543 | Train Acc: 0.8790
 Site-Sketch                    (2) | Train Loss: 0.5405 | Train Acc: 0.8242
 Site-QuickDraw                 (1) | Train Loss: 0.8930 | Train Acc: 0.7389
 Site-QuickDraw                 (1) | Train Loss: 0.8790 | Train Acc: 0.7627
 Site-Infograph                 (0) | Train Loss: 1.2979 | Train Acc: 0.5478
 Site-Infograph                 (0) | Train Loss: 1.1318 | Train Acc: 0.6335
Average Train Accuracy: 0.8073
 Site-Clipart                   (2) | Val  Loss: 0.5335 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.6237 | Val  Acc: 0.8222
 Site-Real                      (0) | Val  Loss: 0.3529 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.2964 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.3359 | Val  Acc: 0.9143
 Site-Painting                  (0) | Val  Loss: 0.4445 | Val  Acc: 0.8825
 Site-Sketch                    (2) | Val  Loss: 0.5164 | Val  Acc: 0.8190
 Site-Sketch                    (2) | Val  Loss: 0.4992 | Val  Acc: 0.8413
 Site-QuickDraw                 (1) | Val  Loss: 0.9672 | Val  Acc: 0.7143
 Site-QuickDraw                 (1) | Val  Loss: 0.8862 | Val  Acc: 0.7397
 Site-Infograph                 (0) | Val  Loss: 1.2903 | Val  Acc: 0.6190
 Site-Infograph                 (0) | Val  Loss: 1.2190 | Val  Acc: 0.5968
Average Valid Accuracy: 0.8077
============ Train epoch 17 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (2) | Train Loss: 0.5958 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.5192 | Train Acc: 0.8581
 Site-Real                      (0) | Train Loss: 0.3927 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.2817 | Train Acc: 0.9492
 Site-Painting                  (0) | Train Loss: 0.4789 | Train Acc: 0.8726
 Site-Painting                  (0) | Train Loss: 0.4514 | Train Acc: 0.8835
 Site-Sketch                    (2) | Train Loss: 0.4667 | Train Acc: 0.8726
 Site-Sketch                    (2) | Train Loss: 0.4983 | Train Acc: 0.8453
 Site-QuickDraw                 (1) | Train Loss: 0.8666 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.8384 | Train Acc: 0.7754
 Site-Infograph                 (0) | Train Loss: 1.2902 | Train Acc: 0.5669
 Site-Infograph                 (0) | Train Loss: 1.1394 | Train Acc: 0.6398
Average Train Accuracy: 0.8165
 Site-Clipart                   (2) | Val  Loss: 0.5177 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.6056 | Val  Acc: 0.8063
 Site-Real                      (0) | Val  Loss: 0.3377 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.2932 | Val  Acc: 0.9397
 Site-Painting                  (0) | Val  Loss: 0.3647 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.4295 | Val  Acc: 0.8857
 Site-Sketch                    (2) | Val  Loss: 0.5422 | Val  Acc: 0.8667
 Site-Sketch                    (2) | Val  Loss: 0.5526 | Val  Acc: 0.8444
 Site-QuickDraw                 (1) | Val  Loss: 0.9597 | Val  Acc: 0.7048
 Site-QuickDraw                 (1) | Val  Loss: 0.8403 | Val  Acc: 0.7651
 Site-Infograph                 (0) | Val  Loss: 1.2800 | Val  Acc: 0.6095
 Site-Infograph                 (0) | Val  Loss: 1.1962 | Val  Acc: 0.5968
Average Valid Accuracy: 0.8103
============ Train epoch 18 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (2) | Train Loss: 0.5559 | Train Acc: 0.8408
 Site-Clipart                   (2) | Train Loss: 0.5051 | Train Acc: 0.8771
 Site-Real                      (0) | Train Loss: 0.3517 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.2744 | Train Acc: 0.9470
 Site-Painting                  (0) | Train Loss: 0.4221 | Train Acc: 0.8726
 Site-Painting                  (0) | Train Loss: 0.4209 | Train Acc: 0.8919
 Site-Sketch                    (2) | Train Loss: 0.4572 | Train Acc: 0.8854
 Site-Sketch                    (2) | Train Loss: 0.5155 | Train Acc: 0.8199
 Site-QuickDraw                 (1) | Train Loss: 0.8381 | Train Acc: 0.7771
 Site-QuickDraw                 (1) | Train Loss: 0.8189 | Train Acc: 0.7733
 Site-Infograph                 (0) | Train Loss: 1.3698 | Train Acc: 0.5860
 Site-Infograph                 (0) | Train Loss: 1.1220 | Train Acc: 0.6314
Average Train Accuracy: 0.8178
 Site-Clipart                   (2) | Val  Loss: 0.5498 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.5931 | Val  Acc: 0.8159
 Site-Real                      (0) | Val  Loss: 0.3089 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2909 | Val  Acc: 0.9492
 Site-Painting                  (0) | Val  Loss: 0.2958 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.4005 | Val  Acc: 0.9079
 Site-Sketch                    (2) | Val  Loss: 0.5189 | Val  Acc: 0.8571
 Site-Sketch                    (2) | Val  Loss: 0.5301 | Val  Acc: 0.8603
 Site-QuickDraw                 (1) | Val  Loss: 0.8294 | Val  Acc: 0.7714
 Site-QuickDraw                 (1) | Val  Loss: 0.8317 | Val  Acc: 0.7683
 Site-Infograph                 (0) | Val  Loss: 1.1769 | Val  Acc: 0.6190
 Site-Infograph                 (0) | Val  Loss: 1.2065 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8196
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8159
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 0.9492
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.9333
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.9079
 Best site-Sketch                   (2)  | Epoch:18 | Val Acc: 0.8571
 Best site-Sketch                   (2)  | Epoch:18 | Val Acc: 0.8603
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.7714
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.7683
 Best site-Infograph                (0)  | Epoch:18 | Val Acc: 0.6190
 Best site-Infograph                (0)  | Epoch:18 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 4, 6, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (1) | Train Loss: 0.5945 | Train Acc: 0.8662
 Site-Clipart                   (1) | Train Loss: 0.5171 | Train Acc: 0.8665
 Site-Real                      (2) | Train Loss: 0.3420 | Train Acc: 0.9108
 Site-Real                      (2) | Train Loss: 0.2628 | Train Acc: 0.9428
 Site-Painting                  (2) | Train Loss: 0.4236 | Train Acc: 0.8854
 Site-Painting                  (2) | Train Loss: 0.3978 | Train Acc: 0.8877
 Site-Sketch                    (1) | Train Loss: 0.5120 | Train Acc: 0.8471
 Site-Sketch                    (1) | Train Loss: 0.5032 | Train Acc: 0.8369
 Site-QuickDraw                 (0) | Train Loss: 0.8991 | Train Acc: 0.7452
 Site-QuickDraw                 (0) | Train Loss: 0.8421 | Train Acc: 0.7818
 Site-Infograph                 (2) | Train Loss: 1.2769 | Train Acc: 0.5987
 Site-Infograph                 (2) | Train Loss: 1.0590 | Train Acc: 0.6462
Average Train Accuracy: 0.8179
 Site-Clipart                   (1) | Val  Loss: 0.5670 | Val  Acc: 0.8476
 Site-Clipart                   (1) | Val  Loss: 0.5700 | Val  Acc: 0.8286
 Site-Real                      (2) | Val  Loss: 0.3515 | Val  Acc: 0.8857
 Site-Real                      (2) | Val  Loss: 0.3000 | Val  Acc: 0.9365
 Site-Painting                  (2) | Val  Loss: 0.3433 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.4086 | Val  Acc: 0.9016
 Site-Sketch                    (1) | Val  Loss: 0.5609 | Val  Acc: 0.8286
 Site-Sketch                    (1) | Val  Loss: 0.5169 | Val  Acc: 0.8540
 Site-QuickDraw                 (0) | Val  Loss: 0.8199 | Val  Acc: 0.7524
 Site-QuickDraw                 (0) | Val  Loss: 0.8331 | Val  Acc: 0.7556
 Site-Infograph                 (2) | Val  Loss: 1.1579 | Val  Acc: 0.6667
 Site-Infograph                 (2) | Val  Loss: 1.1553 | Val  Acc: 0.5937
Average Valid Accuracy: 0.8138
============ Train epoch 20 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (0) | Train Loss: 0.5166 | Train Acc: 0.8917
 Site-Clipart                   (0) | Train Loss: 0.5167 | Train Acc: 0.8602
 Site-Real                      (2) | Train Loss: 0.3594 | Train Acc: 0.9172
 Site-Real                      (2) | Train Loss: 0.2666 | Train Acc: 0.9364
 Site-Painting                  (2) | Train Loss: 0.4412 | Train Acc: 0.8854
 Site-Painting                  (2) | Train Loss: 0.4128 | Train Acc: 0.8877
 Site-Sketch                    (0) | Train Loss: 0.4906 | Train Acc: 0.8790
 Site-Sketch                    (0) | Train Loss: 0.5034 | Train Acc: 0.8369
 Site-QuickDraw                 (1) | Train Loss: 0.8533 | Train Acc: 0.7389
 Site-QuickDraw                 (1) | Train Loss: 0.8388 | Train Acc: 0.7542
 Site-Infograph                 (2) | Train Loss: 1.2805 | Train Acc: 0.5860
 Site-Infograph                 (2) | Train Loss: 1.0520 | Train Acc: 0.6695
Average Train Accuracy: 0.8203
 Site-Clipart                   (0) | Val  Loss: 0.4954 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.5734 | Val  Acc: 0.8381
 Site-Real                      (2) | Val  Loss: 0.2968 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2886 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3192 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.3906 | Val  Acc: 0.9079
 Site-Sketch                    (0) | Val  Loss: 0.5289 | Val  Acc: 0.8381
 Site-Sketch                    (0) | Val  Loss: 0.5120 | Val  Acc: 0.8540
 Site-QuickDraw                 (1) | Val  Loss: 0.7896 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.7953 | Val  Acc: 0.7841
 Site-Infograph                 (2) | Val  Loss: 1.1910 | Val  Acc: 0.6190
 Site-Infograph                 (2) | Val  Loss: 1.1335 | Val  Acc: 0.6349
Average Valid Accuracy: 0.8257
 Best site-Clipart                  (0)  | Epoch:20 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:20 | Val Acc: 0.8381
 Best site-Real                     (2)  | Epoch:20 | Val Acc: 0.9238
 Best site-Real                     (2)  | Epoch:20 | Val Acc: 0.9270
 Best site-Painting                 (2)  | Epoch:20 | Val Acc: 0.9143
 Best site-Painting                 (2)  | Epoch:20 | Val Acc: 0.9079
 Best site-Sketch                   (0)  | Epoch:20 | Val Acc: 0.8381
 Best site-Sketch                   (0)  | Epoch:20 | Val Acc: 0.8540
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7905
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7841
 Best site-Infograph                (2)  | Epoch:20 | Val Acc: 0.6190
 Best site-Infograph                (2)  | Epoch:20 | Val Acc: 0.6349
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 21 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.5590 | Train Acc: 0.8280
 Site-Clipart                   (0) | Train Loss: 0.4705 | Train Acc: 0.8708
 Site-Real                      (2) | Train Loss: 0.3273 | Train Acc: 0.9108
 Site-Real                      (2) | Train Loss: 0.2571 | Train Acc: 0.9407
 Site-Painting                  (2) | Train Loss: 0.4583 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.4052 | Train Acc: 0.9004
 Site-Sketch                    (0) | Train Loss: 0.4533 | Train Acc: 0.8471
 Site-Sketch                    (0) | Train Loss: 0.5067 | Train Acc: 0.8517
 Site-QuickDraw                 (1) | Train Loss: 0.7814 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.8122 | Train Acc: 0.7881
 Site-Infograph                 (2) | Train Loss: 1.1724 | Train Acc: 0.6051
 Site-Infograph                 (2) | Train Loss: 1.0866 | Train Acc: 0.6462
Average Train Accuracy: 0.8167
 Site-Clipart                   (0) | Val  Loss: 0.4806 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.5230 | Val  Acc: 0.8571
 Site-Real                      (2) | Val  Loss: 0.2895 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2669 | Val  Acc: 0.9302
 Site-Painting                  (2) | Val  Loss: 0.2538 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.3860 | Val  Acc: 0.9048
 Site-Sketch                    (0) | Val  Loss: 0.4812 | Val  Acc: 0.8762
 Site-Sketch                    (0) | Val  Loss: 0.4847 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.7746 | Val  Acc: 0.7714
 Site-QuickDraw                 (1) | Val  Loss: 0.7713 | Val  Acc: 0.7841
 Site-Infograph                 (2) | Val  Loss: 1.1803 | Val  Acc: 0.6095
 Site-Infograph                 (2) | Val  Loss: 1.1277 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8283
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8857
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8571
 Best site-Real                     (2)  | Epoch:21 | Val Acc: 0.9238
 Best site-Real                     (2)  | Epoch:21 | Val Acc: 0.9302
 Best site-Painting                 (2)  | Epoch:21 | Val Acc: 0.9143
 Best site-Painting                 (2)  | Epoch:21 | Val Acc: 0.9048
 Best site-Sketch                   (0)  | Epoch:21 | Val Acc: 0.8762
 Best site-Sketch                   (0)  | Epoch:21 | Val Acc: 0.8571
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.7714
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.7841
 Best site-Infograph                (2)  | Epoch:21 | Val Acc: 0.6095
 Best site-Infograph                (2)  | Epoch:21 | Val Acc: 0.6254
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 22 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.4895 | Train Acc: 0.8599
 Site-Clipart                   (0) | Train Loss: 0.4771 | Train Acc: 0.8665
 Site-Real                      (2) | Train Loss: 0.3120 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.2398 | Train Acc: 0.9534
 Site-Painting                  (2) | Train Loss: 0.3779 | Train Acc: 0.9172
 Site-Painting                  (2) | Train Loss: 0.3700 | Train Acc: 0.8962
 Site-Sketch                    (0) | Train Loss: 0.4511 | Train Acc: 0.8854
 Site-Sketch                    (0) | Train Loss: 0.4946 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7834 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.7618 | Train Acc: 0.7691
 Site-Infograph                 (2) | Train Loss: 1.2891 | Train Acc: 0.6369
 Site-Infograph                 (2) | Train Loss: 1.0456 | Train Acc: 0.6589
Average Train Accuracy: 0.8314
 Site-Clipart                   (0) | Val  Loss: 0.4264 | Val  Acc: 0.9048
 Site-Clipart                   (0) | Val  Loss: 0.5429 | Val  Acc: 0.8413
 Site-Real                      (2) | Val  Loss: 0.2849 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.2707 | Val  Acc: 0.9397
 Site-Painting                  (2) | Val  Loss: 0.3118 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.3692 | Val  Acc: 0.8984
 Site-Sketch                    (0) | Val  Loss: 0.4984 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.4978 | Val  Acc: 0.8508
 Site-QuickDraw                 (1) | Val  Loss: 0.7021 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.7172 | Val  Acc: 0.8190
 Site-Infograph                 (2) | Val  Loss: 1.2099 | Val  Acc: 0.6286
 Site-Infograph                 (2) | Val  Loss: 1.1023 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8354
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.9048
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8413
 Best site-Real                     (2)  | Epoch:22 | Val Acc: 0.9143
 Best site-Real                     (2)  | Epoch:22 | Val Acc: 0.9397
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9333
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.8984
 Best site-Sketch                   (0)  | Epoch:22 | Val Acc: 0.8286
 Best site-Sketch                   (0)  | Epoch:22 | Val Acc: 0.8508
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.8095
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.8190
 Best site-Infograph                (2)  | Epoch:22 | Val Acc: 0.6286
 Best site-Infograph                (2)  | Epoch:22 | Val Acc: 0.6571
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 23 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.4692 | Train Acc: 0.8535
 Site-Clipart                   (2) | Train Loss: 0.4921 | Train Acc: 0.8644
 Site-Real                      (0) | Train Loss: 0.3350 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2288 | Train Acc: 0.9492
 Site-Painting                  (0) | Train Loss: 0.3866 | Train Acc: 0.8662
 Site-Painting                  (0) | Train Loss: 0.3681 | Train Acc: 0.9047
 Site-Sketch                    (2) | Train Loss: 0.4809 | Train Acc: 0.8662
 Site-Sketch                    (2) | Train Loss: 0.5102 | Train Acc: 0.8453
 Site-QuickDraw                 (1) | Train Loss: 0.8150 | Train Acc: 0.7516
 Site-QuickDraw                 (1) | Train Loss: 0.7373 | Train Acc: 0.7903
 Site-Infograph                 (0) | Train Loss: 1.2780 | Train Acc: 0.6178
 Site-Infograph                 (0) | Train Loss: 1.0388 | Train Acc: 0.6525
Average Train Accuracy: 0.8232
 Site-Clipart                   (2) | Val  Loss: 0.4697 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.5457 | Val  Acc: 0.8444
 Site-Real                      (0) | Val  Loss: 0.3038 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.2477 | Val  Acc: 0.9492
 Site-Painting                  (0) | Val  Loss: 0.2722 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3341 | Val  Acc: 0.9206
 Site-Sketch                    (2) | Val  Loss: 0.5080 | Val  Acc: 0.8381
 Site-Sketch                    (2) | Val  Loss: 0.4993 | Val  Acc: 0.8698
 Site-QuickDraw                 (1) | Val  Loss: 0.7252 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.7419 | Val  Acc: 0.7873
 Site-Infograph                 (0) | Val  Loss: 1.1348 | Val  Acc: 0.6571
 Site-Infograph                 (0) | Val  Loss: 1.1321 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8373
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8952
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8444
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9143
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9492
 Best site-Painting                 (0)  | Epoch:23 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:23 | Val Acc: 0.9206
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8381
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8698
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.7905
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.7873
 Best site-Infograph                (0)  | Epoch:23 | Val Acc: 0.6571
 Best site-Infograph                (0)  | Epoch:23 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 24 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (2) | Train Loss: 0.4928 | Train Acc: 0.8471
 Site-Clipart                   (2) | Train Loss: 0.4786 | Train Acc: 0.8835
 Site-Real                      (2) | Train Loss: 0.3459 | Train Acc: 0.9172
 Site-Real                      (2) | Train Loss: 0.2443 | Train Acc: 0.9428
 Site-Painting                  (0) | Train Loss: 0.4173 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.3703 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.4423 | Train Acc: 0.8599
 Site-Sketch                    (2) | Train Loss: 0.4603 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7881 | Train Acc: 0.7771
 Site-QuickDraw                 (1) | Train Loss: 0.7458 | Train Acc: 0.7797
 Site-Infograph                 (0) | Train Loss: 1.2464 | Train Acc: 0.6178
 Site-Infograph                 (0) | Train Loss: 1.0302 | Train Acc: 0.6653
Average Train Accuracy: 0.8271
 Site-Clipart                   (2) | Val  Loss: 0.5293 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.5385 | Val  Acc: 0.8349
 Site-Real                      (2) | Val  Loss: 0.2907 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2587 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.2613 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.3502 | Val  Acc: 0.9143
 Site-Sketch                    (2) | Val  Loss: 0.5036 | Val  Acc: 0.8571
 Site-Sketch                    (2) | Val  Loss: 0.4720 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.7092 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.7357 | Val  Acc: 0.7905
 Site-Infograph                 (0) | Val  Loss: 1.1578 | Val  Acc: 0.6095
 Site-Infograph                 (0) | Val  Loss: 1.1053 | Val  Acc: 0.6476
Average Valid Accuracy: 0.8307
============ Train epoch 25 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (0) | Train Loss: 0.5877 | Train Acc: 0.8280
 Site-Clipart                   (0) | Train Loss: 0.4390 | Train Acc: 0.8962
 Site-Real                      (2) | Train Loss: 0.3462 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.2352 | Train Acc: 0.9428
 Site-Painting                  (2) | Train Loss: 0.3649 | Train Acc: 0.9172
 Site-Painting                  (2) | Train Loss: 0.3716 | Train Acc: 0.8919
 Site-Sketch                    (0) | Train Loss: 0.3868 | Train Acc: 0.8726
 Site-Sketch                    (0) | Train Loss: 0.4762 | Train Acc: 0.8496
 Site-QuickDraw                 (1) | Train Loss: 0.7670 | Train Acc: 0.7516
 Site-QuickDraw                 (1) | Train Loss: 0.7247 | Train Acc: 0.7691
 Site-Infograph                 (2) | Train Loss: 1.1995 | Train Acc: 0.5987
 Site-Infograph                 (2) | Train Loss: 0.9697 | Train Acc: 0.6864
Average Train Accuracy: 0.8273
 Site-Clipart                   (0) | Val  Loss: 0.4457 | Val  Acc: 0.9143
 Site-Clipart                   (0) | Val  Loss: 0.5186 | Val  Acc: 0.8540
 Site-Real                      (2) | Val  Loss: 0.2485 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.2374 | Val  Acc: 0.9429
 Site-Painting                  (2) | Val  Loss: 0.2523 | Val  Acc: 0.9429
 Site-Painting                  (2) | Val  Loss: 0.3073 | Val  Acc: 0.9333
 Site-Sketch                    (0) | Val  Loss: 0.4455 | Val  Acc: 0.8857
 Site-Sketch                    (0) | Val  Loss: 0.4887 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.7671 | Val  Acc: 0.7429
 Site-QuickDraw                 (1) | Val  Loss: 0.7213 | Val  Acc: 0.8063
 Site-Infograph                 (2) | Val  Loss: 1.1336 | Val  Acc: 0.6381
 Site-Infograph                 (2) | Val  Loss: 1.0876 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8407
 Best site-Clipart                  (0)  | Epoch:25 | Val Acc: 0.9143
 Best site-Clipart                  (0)  | Epoch:25 | Val Acc: 0.8540
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9429
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9429
 Best site-Painting                 (2)  | Epoch:25 | Val Acc: 0.9429
 Best site-Painting                 (2)  | Epoch:25 | Val Acc: 0.9333
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8857
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8571
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.7429
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.8063
 Best site-Infograph                (2)  | Epoch:25 | Val Acc: 0.6381
 Best site-Infograph                (2)  | Epoch:25 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 26 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (2) | Train Loss: 0.5140 | Train Acc: 0.8344
 Site-Clipart                   (2) | Train Loss: 0.4526 | Train Acc: 0.8792
 Site-Real                      (0) | Train Loss: 0.2739 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.2242 | Train Acc: 0.9492
 Site-Painting                  (0) | Train Loss: 0.3990 | Train Acc: 0.8726
 Site-Painting                  (0) | Train Loss: 0.3569 | Train Acc: 0.9025
 Site-Sketch                    (2) | Train Loss: 0.4020 | Train Acc: 0.8790
 Site-Sketch                    (2) | Train Loss: 0.4541 | Train Acc: 0.8517
 Site-QuickDraw                 (1) | Train Loss: 0.7951 | Train Acc: 0.7516
 Site-QuickDraw                 (1) | Train Loss: 0.6997 | Train Acc: 0.7945
 Site-Infograph                 (0) | Train Loss: 1.2305 | Train Acc: 0.5796
 Site-Infograph                 (0) | Train Loss: 0.9812 | Train Acc: 0.6737
Average Train Accuracy: 0.8243
 Site-Clipart                   (2) | Val  Loss: 0.4368 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.5190 | Val  Acc: 0.8476
 Site-Real                      (0) | Val  Loss: 0.2743 | Val  Acc: 0.8952
 Site-Real                      (0) | Val  Loss: 0.2390 | Val  Acc: 0.9460
 Site-Painting                  (0) | Val  Loss: 0.2851 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.3516 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.4486 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.4444 | Val  Acc: 0.8698
 Site-QuickDraw                 (1) | Val  Loss: 0.7326 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.6685 | Val  Acc: 0.8286
 Site-Infograph                 (0) | Val  Loss: 1.0923 | Val  Acc: 0.6476
 Site-Infograph                 (0) | Val  Loss: 1.0960 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8429
 Best site-Clipart                  (2)  | Epoch:26 | Val Acc: 0.8952
 Best site-Clipart                  (2)  | Epoch:26 | Val Acc: 0.8476
 Best site-Real                     (0)  | Epoch:26 | Val Acc: 0.8952
 Best site-Real                     (0)  | Epoch:26 | Val Acc: 0.9460
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.9429
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.9048
 Best site-Sketch                   (2)  | Epoch:26 | Val Acc: 0.9048
 Best site-Sketch                   (2)  | Epoch:26 | Val Acc: 0.8698
 Best site-QuickDraw                (1)  | Epoch:26 | Val Acc: 0.7905
 Best site-QuickDraw                (1)  | Epoch:26 | Val Acc: 0.8286
 Best site-Infograph                (0)  | Epoch:26 | Val Acc: 0.6476
 Best site-Infograph                (0)  | Epoch:26 | Val Acc: 0.6413
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 27 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (2) | Train Loss: 0.4966 | Train Acc: 0.8662
 Site-Clipart                   (2) | Train Loss: 0.4592 | Train Acc: 0.8771
 Site-Real                      (0) | Train Loss: 0.3278 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2331 | Train Acc: 0.9513
 Site-Painting                  (0) | Train Loss: 0.4004 | Train Acc: 0.8854
 Site-Painting                  (0) | Train Loss: 0.3550 | Train Acc: 0.9068
 Site-Sketch                    (2) | Train Loss: 0.4093 | Train Acc: 0.8662
 Site-Sketch                    (2) | Train Loss: 0.4361 | Train Acc: 0.8602
 Site-QuickDraw                 (1) | Train Loss: 0.7352 | Train Acc: 0.7898
 Site-QuickDraw                 (1) | Train Loss: 0.7211 | Train Acc: 0.8072
 Site-Infograph                 (0) | Train Loss: 1.2343 | Train Acc: 0.6115
 Site-Infograph                 (0) | Train Loss: 0.9735 | Train Acc: 0.6843
Average Train Accuracy: 0.8353
 Site-Clipart                   (2) | Val  Loss: 0.4080 | Val  Acc: 0.9048
 Site-Clipart                   (2) | Val  Loss: 0.5142 | Val  Acc: 0.8413
 Site-Real                      (0) | Val  Loss: 0.2656 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.2302 | Val  Acc: 0.9556
 Site-Painting                  (0) | Val  Loss: 0.2666 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.3339 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.4064 | Val  Acc: 0.8857
 Site-Sketch                    (2) | Val  Loss: 0.4156 | Val  Acc: 0.9016
 Site-QuickDraw                 (1) | Val  Loss: 0.6799 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.7165 | Val  Acc: 0.7810
 Site-Infograph                 (0) | Val  Loss: 1.1122 | Val  Acc: 0.6476
 Site-Infograph                 (0) | Val  Loss: 1.0813 | Val  Acc: 0.6317
Average Valid Accuracy: 0.8450
 Best site-Clipart                  (2)  | Epoch:27 | Val Acc: 0.9048
 Best site-Clipart                  (2)  | Epoch:27 | Val Acc: 0.8413
 Best site-Real                     (0)  | Epoch:27 | Val Acc: 0.9143
 Best site-Real                     (0)  | Epoch:27 | Val Acc: 0.9556
 Best site-Painting                 (0)  | Epoch:27 | Val Acc: 0.9429
 Best site-Painting                 (0)  | Epoch:27 | Val Acc: 0.9048
 Best site-Sketch                   (2)  | Epoch:27 | Val Acc: 0.8857
 Best site-Sketch                   (2)  | Epoch:27 | Val Acc: 0.9016
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.8286
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.7810
 Best site-Infograph                (0)  | Epoch:27 | Val Acc: 0.6476
 Best site-Infograph                (0)  | Epoch:27 | Val Acc: 0.6317
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 28 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.4750 | Train Acc: 0.8726
 Site-Clipart                   (0) | Train Loss: 0.4332 | Train Acc: 0.8814
 Site-Real                      (2) | Train Loss: 0.2970 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.2487 | Train Acc: 0.9343
 Site-Painting                  (2) | Train Loss: 0.4011 | Train Acc: 0.8917
 Site-Painting                  (2) | Train Loss: 0.3457 | Train Acc: 0.9047
 Site-Sketch                    (0) | Train Loss: 0.3862 | Train Acc: 0.8981
 Site-Sketch                    (0) | Train Loss: 0.4505 | Train Acc: 0.8792
 Site-QuickDraw                 (1) | Train Loss: 0.6804 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.6738 | Train Acc: 0.8008
 Site-Infograph                 (2) | Train Loss: 1.2595 | Train Acc: 0.5860
 Site-Infograph                 (2) | Train Loss: 1.0234 | Train Acc: 0.6462
Average Train Accuracy: 0.8324
 Site-Clipart                   (0) | Val  Loss: 0.3929 | Val  Acc: 0.9333
 Site-Clipart                   (0) | Val  Loss: 0.4923 | Val  Acc: 0.8540
 Site-Real                      (2) | Val  Loss: 0.2393 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2511 | Val  Acc: 0.9460
 Site-Painting                  (2) | Val  Loss: 0.2563 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3385 | Val  Acc: 0.9175
 Site-Sketch                    (0) | Val  Loss: 0.3848 | Val  Acc: 0.8857
 Site-Sketch                    (0) | Val  Loss: 0.4312 | Val  Acc: 0.8762
 Site-QuickDraw                 (1) | Val  Loss: 0.6538 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6998 | Val  Acc: 0.7937
 Site-Infograph                 (2) | Val  Loss: 1.0498 | Val  Acc: 0.6571
 Site-Infograph                 (2) | Val  Loss: 1.0290 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8516
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.9333
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8540
 Best site-Real                     (2)  | Epoch:28 | Val Acc: 0.9238
 Best site-Real                     (2)  | Epoch:28 | Val Acc: 0.9460
 Best site-Painting                 (2)  | Epoch:28 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:28 | Val Acc: 0.9175
 Best site-Sketch                   (0)  | Epoch:28 | Val Acc: 0.8857
 Best site-Sketch                   (0)  | Epoch:28 | Val Acc: 0.8762
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.8095
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.7937
 Best site-Infograph                (2)  | Epoch:28 | Val Acc: 0.6571
 Best site-Infograph                (2)  | Epoch:28 | Val Acc: 0.6698
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 29 ============
cnt=[8, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (0) | Train Loss: 0.5029 | Train Acc: 0.8408
 Site-Clipart                   (0) | Train Loss: 0.4612 | Train Acc: 0.8623
 Site-Real                      (0) | Train Loss: 0.3370 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2267 | Train Acc: 0.9470
 Site-Painting                  (0) | Train Loss: 0.3875 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.3400 | Train Acc: 0.9004
 Site-Sketch                    (0) | Train Loss: 0.4238 | Train Acc: 0.8599
 Site-Sketch                    (0) | Train Loss: 0.4674 | Train Acc: 0.8432
 Site-QuickDraw                 (1) | Train Loss: 0.8048 | Train Acc: 0.7580
 Site-QuickDraw                 (1) | Train Loss: 0.6666 | Train Acc: 0.8030
 Site-Infograph                 (2) | Train Loss: 1.2493 | Train Acc: 0.6242
 Site-Infograph                 (2) | Train Loss: 0.9819 | Train Acc: 0.6780
Average Train Accuracy: 0.8261
 Site-Clipart                   (0) | Val  Loss: 0.4317 | Val  Acc: 0.9143
 Site-Clipart                   (0) | Val  Loss: 0.5021 | Val  Acc: 0.8508
 Site-Real                      (0) | Val  Loss: 0.2556 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.2598 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.2345 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3208 | Val  Acc: 0.9270
 Site-Sketch                    (0) | Val  Loss: 0.4784 | Val  Acc: 0.8476
 Site-Sketch                    (0) | Val  Loss: 0.4388 | Val  Acc: 0.8794
 Site-QuickDraw                 (1) | Val  Loss: 0.6917 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.7203 | Val  Acc: 0.8000
 Site-Infograph                 (2) | Val  Loss: 1.0759 | Val  Acc: 0.6476
 Site-Infograph                 (2) | Val  Loss: 1.0107 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8447
============ Train epoch 30 ============
cnt=[2, 2, 8, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (2) | Train Loss: 0.4756 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.4655 | Train Acc: 0.8602
 Site-Real                      (2) | Train Loss: 0.3338 | Train Acc: 0.9172
 Site-Real                      (2) | Train Loss: 0.2389 | Train Acc: 0.9449
 Site-Painting                  (2) | Train Loss: 0.4510 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3717 | Train Acc: 0.9047
 Site-Sketch                    (2) | Train Loss: 0.4298 | Train Acc: 0.8599
 Site-Sketch                    (2) | Train Loss: 0.4704 | Train Acc: 0.8453
 Site-QuickDraw                 (1) | Train Loss: 0.6994 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.6691 | Train Acc: 0.8284
 Site-Infograph                 (0) | Train Loss: 1.1627 | Train Acc: 0.6178
 Site-Infograph                 (0) | Train Loss: 0.9130 | Train Acc: 0.7119
Average Train Accuracy: 0.8376
 Site-Clipart                   (2) | Val  Loss: 0.4249 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4950 | Val  Acc: 0.8635
 Site-Real                      (2) | Val  Loss: 0.2877 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2803 | Val  Acc: 0.9302
 Site-Painting                  (2) | Val  Loss: 0.2412 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3435 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.4578 | Val  Acc: 0.8857
 Site-Sketch                    (2) | Val  Loss: 0.4305 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.6911 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.6878 | Val  Acc: 0.7873
 Site-Infograph                 (0) | Val  Loss: 0.9994 | Val  Acc: 0.6952
 Site-Infograph                 (0) | Val  Loss: 1.0092 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8450
============ Train epoch 31 ============
cnt=[2, 2, 8, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.4865 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.4408 | Train Acc: 0.8835
 Site-Real                      (2) | Train Loss: 0.3275 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.2374 | Train Acc: 0.9470
 Site-Painting                  (2) | Train Loss: 0.3655 | Train Acc: 0.8726
 Site-Painting                  (2) | Train Loss: 0.3667 | Train Acc: 0.9004
 Site-Sketch                    (2) | Train Loss: 0.4364 | Train Acc: 0.8726
 Site-Sketch                    (2) | Train Loss: 0.4509 | Train Acc: 0.8644
 Site-QuickDraw                 (1) | Train Loss: 0.7118 | Train Acc: 0.8025
 Site-QuickDraw                 (1) | Train Loss: 0.6534 | Train Acc: 0.8284
 Site-Infograph                 (0) | Train Loss: 1.1104 | Train Acc: 0.6497
 Site-Infograph                 (0) | Train Loss: 0.9221 | Train Acc: 0.6970
Average Train Accuracy: 0.8418
 Site-Clipart                   (2) | Val  Loss: 0.4421 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.5004 | Val  Acc: 0.8317
 Site-Real                      (2) | Val  Loss: 0.2678 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2555 | Val  Acc: 0.9365
 Site-Painting                  (2) | Val  Loss: 0.2794 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.3417 | Val  Acc: 0.9143
 Site-Sketch                    (2) | Val  Loss: 0.4074 | Val  Acc: 0.8571
 Site-Sketch                    (2) | Val  Loss: 0.4540 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.6781 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.6843 | Val  Acc: 0.7905
 Site-Infograph                 (0) | Val  Loss: 0.9479 | Val  Acc: 0.7048
 Site-Infograph                 (0) | Val  Loss: 1.0042 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8386
============ Train epoch 32 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.4011 | Train Acc: 0.8726
 Site-Clipart                   (2) | Train Loss: 0.3821 | Train Acc: 0.8877
 Site-Real                      (0) | Train Loss: 0.2754 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.2015 | Train Acc: 0.9513
 Site-Painting                  (0) | Train Loss: 0.3528 | Train Acc: 0.9045
 Site-Painting                  (0) | Train Loss: 0.3205 | Train Acc: 0.9131
 Site-Sketch                    (2) | Train Loss: 0.4204 | Train Acc: 0.8535
 Site-Sketch                    (2) | Train Loss: 0.4384 | Train Acc: 0.8496
 Site-QuickDraw                 (1) | Train Loss: 0.7338 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.7180 | Train Acc: 0.8114
 Site-Infograph                 (0) | Train Loss: 1.2331 | Train Acc: 0.6497
 Site-Infograph                 (0) | Train Loss: 0.9473 | Train Acc: 0.6970
Average Train Accuracy: 0.8404
 Site-Clipart                   (2) | Val  Loss: 0.3849 | Val  Acc: 0.9048
 Site-Clipart                   (2) | Val  Loss: 0.4897 | Val  Acc: 0.8508
 Site-Real                      (0) | Val  Loss: 0.2494 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.2383 | Val  Acc: 0.9365
 Site-Painting                  (0) | Val  Loss: 0.2785 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3264 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.4031 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.3969 | Val  Acc: 0.8889
 Site-QuickDraw                 (1) | Val  Loss: 0.6828 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.6670 | Val  Acc: 0.8349
 Site-Infograph                 (0) | Val  Loss: 1.0344 | Val  Acc: 0.7048
 Site-Infograph                 (0) | Val  Loss: 0.9876 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8566
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.9048
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.8508
 Best site-Real                     (0)  | Epoch:32 | Val Acc: 0.9238
 Best site-Real                     (0)  | Epoch:32 | Val Acc: 0.9365
 Best site-Painting                 (0)  | Epoch:32 | Val Acc: 0.9333
 Best site-Painting                 (0)  | Epoch:32 | Val Acc: 0.9048
 Best site-Sketch                   (2)  | Epoch:32 | Val Acc: 0.9048
 Best site-Sketch                   (2)  | Epoch:32 | Val Acc: 0.8889
 Best site-QuickDraw                (1)  | Epoch:32 | Val Acc: 0.8190
 Best site-QuickDraw                (1)  | Epoch:32 | Val Acc: 0.8349
 Best site-Infograph                (0)  | Epoch:32 | Val Acc: 0.7048
 Best site-Infograph                (0)  | Epoch:32 | Val Acc: 0.6730
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 33 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (0) | Train Loss: 0.4313 | Train Acc: 0.8790
 Site-Clipart                   (0) | Train Loss: 0.3989 | Train Acc: 0.8792
 Site-Real                      (2) | Train Loss: 0.2801 | Train Acc: 0.9363
 Site-Real                      (2) | Train Loss: 0.1902 | Train Acc: 0.9661
 Site-Painting                  (2) | Train Loss: 0.3250 | Train Acc: 0.8917
 Site-Painting                  (2) | Train Loss: 0.3454 | Train Acc: 0.9174
 Site-Sketch                    (0) | Train Loss: 0.3683 | Train Acc: 0.8917
 Site-Sketch                    (0) | Train Loss: 0.4028 | Train Acc: 0.8665
 Site-QuickDraw                 (1) | Train Loss: 0.7074 | Train Acc: 0.7771
 Site-QuickDraw                 (1) | Train Loss: 0.6472 | Train Acc: 0.8242
 Site-Infograph                 (2) | Train Loss: 1.1786 | Train Acc: 0.6497
 Site-Infograph                 (2) | Train Loss: 0.9346 | Train Acc: 0.6907
Average Train Accuracy: 0.8475
 Site-Clipart                   (0) | Val  Loss: 0.3684 | Val  Acc: 0.9238
 Site-Clipart                   (0) | Val  Loss: 0.4656 | Val  Acc: 0.8508
 Site-Real                      (2) | Val  Loss: 0.2308 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2199 | Val  Acc: 0.9397
 Site-Painting                  (2) | Val  Loss: 0.2348 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3014 | Val  Acc: 0.9238
 Site-Sketch                    (0) | Val  Loss: 0.4215 | Val  Acc: 0.8857
 Site-Sketch                    (0) | Val  Loss: 0.4263 | Val  Acc: 0.8825
 Site-QuickDraw                 (1) | Val  Loss: 0.6539 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6335 | Val  Acc: 0.8508
 Site-Infograph                 (2) | Val  Loss: 1.0232 | Val  Acc: 0.6762
 Site-Infograph                 (2) | Val  Loss: 0.9999 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8582
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.9238
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.8508
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9397
 Best site-Painting                 (2)  | Epoch:33 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:33 | Val Acc: 0.9238
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8857
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8825
 Best site-QuickDraw                (1)  | Epoch:33 | Val Acc: 0.8095
 Best site-QuickDraw                (1)  | Epoch:33 | Val Acc: 0.8508
 Best site-Infograph                (2)  | Epoch:33 | Val Acc: 0.6762
 Best site-Infograph                (2)  | Epoch:33 | Val Acc: 0.6508
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 34 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.4937 | Train Acc: 0.8280
 Site-Clipart                   (2) | Train Loss: 0.4013 | Train Acc: 0.8898
 Site-Real                      (2) | Train Loss: 0.3196 | Train Acc: 0.9299
 Site-Real                      (2) | Train Loss: 0.2117 | Train Acc: 0.9513
 Site-Painting                  (0) | Train Loss: 0.4084 | Train Acc: 0.8854
 Site-Painting                  (0) | Train Loss: 0.2996 | Train Acc: 0.9237
 Site-Sketch                    (2) | Train Loss: 0.4538 | Train Acc: 0.8662
 Site-Sketch                    (2) | Train Loss: 0.4384 | Train Acc: 0.8581
 Site-QuickDraw                 (1) | Train Loss: 0.6552 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.6629 | Train Acc: 0.7903
 Site-Infograph                 (0) | Train Loss: 1.1209 | Train Acc: 0.6688
 Site-Infograph                 (0) | Train Loss: 0.8967 | Train Acc: 0.7076
Average Train Accuracy: 0.8402
 Site-Clipart                   (2) | Val  Loss: 0.3896 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.4965 | Val  Acc: 0.8381
 Site-Real                      (2) | Val  Loss: 0.2617 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2215 | Val  Acc: 0.9492
 Site-Painting                  (0) | Val  Loss: 0.2121 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.2954 | Val  Acc: 0.9429
 Site-Sketch                    (2) | Val  Loss: 0.3971 | Val  Acc: 0.8667
 Site-Sketch                    (2) | Val  Loss: 0.4260 | Val  Acc: 0.8794
 Site-QuickDraw                 (1) | Val  Loss: 0.7007 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.6759 | Val  Acc: 0.8127
 Site-Infograph                 (0) | Val  Loss: 0.9583 | Val  Acc: 0.6952
 Site-Infograph                 (0) | Val  Loss: 0.9452 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8548
============ Train epoch 35 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (2) | Train Loss: 0.4800 | Train Acc: 0.8662
 Site-Clipart                   (2) | Train Loss: 0.3672 | Train Acc: 0.9004
 Site-Real                      (0) | Train Loss: 0.3252 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.1961 | Train Acc: 0.9576
 Site-Painting                  (0) | Train Loss: 0.3792 | Train Acc: 0.9108
 Site-Painting                  (0) | Train Loss: 0.3069 | Train Acc: 0.9301
 Site-Sketch                    (2) | Train Loss: 0.3735 | Train Acc: 0.8981
 Site-Sketch                    (2) | Train Loss: 0.4238 | Train Acc: 0.8750
 Site-QuickDraw                 (1) | Train Loss: 0.7034 | Train Acc: 0.7898
 Site-QuickDraw                 (1) | Train Loss: 0.6435 | Train Acc: 0.8199
 Site-Infograph                 (0) | Train Loss: 1.2160 | Train Acc: 0.6497
 Site-Infograph                 (0) | Train Loss: 0.9007 | Train Acc: 0.7182
Average Train Accuracy: 0.8522
 Site-Clipart                   (2) | Val  Loss: 0.4176 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.4544 | Val  Acc: 0.8730
 Site-Real                      (0) | Val  Loss: 0.2384 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2182 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2328 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2794 | Val  Acc: 0.9270
 Site-Sketch                    (2) | Val  Loss: 0.3605 | Val  Acc: 0.9143
 Site-Sketch                    (2) | Val  Loss: 0.4012 | Val  Acc: 0.8889
 Site-QuickDraw                 (1) | Val  Loss: 0.5893 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.6674 | Val  Acc: 0.8032
 Site-Infograph                 (0) | Val  Loss: 1.0015 | Val  Acc: 0.6857
 Site-Infograph                 (0) | Val  Loss: 0.9625 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8648
 Best site-Clipart                  (2)  | Epoch:35 | Val Acc: 0.8952
 Best site-Clipart                  (2)  | Epoch:35 | Val Acc: 0.8730
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:35 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:35 | Val Acc: 0.9270
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.9143
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8889
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.8667
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.8032
 Best site-Infograph                (0)  | Epoch:35 | Val Acc: 0.6857
 Best site-Infograph                (0)  | Epoch:35 | Val Acc: 0.6857
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_3/ccop_q=1...
============ Train epoch 36 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (2) | Train Loss: 0.4517 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.4306 | Train Acc: 0.8962
 Site-Real                      (0) | Train Loss: 0.2415 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.1803 | Train Acc: 0.9597
 Site-Painting                  (0) | Train Loss: 0.3838 | Train Acc: 0.9108
 Site-Painting                  (0) | Train Loss: 0.2847 | Train Acc: 0.9301
 Site-Sketch                    (2) | Train Loss: 0.3953 | Train Acc: 0.9108
 Site-Sketch                    (2) | Train Loss: 0.3929 | Train Acc: 0.8771
 Site-QuickDraw                 (1) | Train Loss: 0.6555 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.6171 | Train Acc: 0.8199
 Site-Infograph                 (0) | Train Loss: 1.3095 | Train Acc: 0.6242
 Site-Infograph                 (0) | Train Loss: 0.8752 | Train Acc: 0.7140
Average Train Accuracy: 0.8513
 Site-Clipart                   (2) | Val  Loss: 0.3727 | Val  Acc: 0.9238
 Site-Clipart                   (2) | Val  Loss: 0.4779 | Val  Acc: 0.8571
 Site-Real                      (0) | Val  Loss: 0.2377 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.1982 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.2245 | Val  Acc: 0.9238
 Site-Painting                  (0) | Val  Loss: 0.2719 | Val  Acc: 0.9302
 Site-Sketch                    (2) | Val  Loss: 0.4142 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.3729 | Val  Acc: 0.8952
 Site-QuickDraw                 (1) | Val  Loss: 0.6000 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.6228 | Val  Acc: 0.8222
 Site-Infograph                 (0) | Val  Loss: 0.9952 | Val  Acc: 0.7048
 Site-Infograph                 (0) | Val  Loss: 0.9307 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8627
============ Train epoch 37 ============
cnt=[2, 2, 8, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (2) | Train Loss: 0.4780 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.4043 | Train Acc: 0.8856
 Site-Real                      (2) | Train Loss: 0.2759 | Train Acc: 0.9172
 Site-Real                      (2) | Train Loss: 0.2075 | Train Acc: 0.9470
 Site-Painting                  (2) | Train Loss: 0.3909 | Train Acc: 0.8726
 Site-Painting                  (2) | Train Loss: 0.3407 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.4752 | Train Acc: 0.8790
 Site-Sketch                    (2) | Train Loss: 0.4223 | Train Acc: 0.8602
 Site-QuickDraw                 (1) | Train Loss: 0.6318 | Train Acc: 0.8217
 Site-QuickDraw                 (1) | Train Loss: 0.6112 | Train Acc: 0.8432
 Site-Infograph                 (0) | Train Loss: 1.1197 | Train Acc: 0.6561
 Site-Infograph                 (0) | Train Loss: 0.8667 | Train Acc: 0.7415
Average Train Accuracy: 0.8485
 Site-Clipart                   (2) | Val  Loss: 0.4329 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.5052 | Val  Acc: 0.8444
 Site-Real                      (2) | Val  Loss: 0.2549 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2350 | Val  Acc: 0.9397
 Site-Painting                  (2) | Val  Loss: 0.2973 | Val  Acc: 0.9238
 Site-Painting                  (2) | Val  Loss: 0.3037 | Val  Acc: 0.9175
 Site-Sketch                    (2) | Val  Loss: 0.4533 | Val  Acc: 0.8571
 Site-Sketch                    (2) | Val  Loss: 0.4322 | Val  Acc: 0.8762
 Site-QuickDraw                 (1) | Val  Loss: 0.6376 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6192 | Val  Acc: 0.8222
 Site-Infograph                 (0) | Val  Loss: 0.9181 | Val  Acc: 0.7238
 Site-Infograph                 (0) | Val  Loss: 0.9343 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8519
============ Train epoch 38 ============
cnt=[2, 2, 8, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.4874 | Train Acc: 0.8662
 Site-Clipart                   (2) | Train Loss: 0.4196 | Train Acc: 0.8729
 Site-Real                      (2) | Train Loss: 0.2826 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.2052 | Train Acc: 0.9534
 Site-Painting                  (2) | Train Loss: 0.3448 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3258 | Train Acc: 0.9237
 Site-Sketch                    (2) | Train Loss: 0.3998 | Train Acc: 0.8726
 Site-Sketch                    (2) | Train Loss: 0.4206 | Train Acc: 0.8644
 Site-QuickDraw                 (1) | Train Loss: 0.6429 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.6168 | Train Acc: 0.8157
 Site-Infograph                 (0) | Train Loss: 1.1754 | Train Acc: 0.6433
 Site-Infograph                 (0) | Train Loss: 0.8708 | Train Acc: 0.7225
Average Train Accuracy: 0.8450
 Site-Clipart                   (2) | Val  Loss: 0.3772 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4821 | Val  Acc: 0.8603
 Site-Real                      (2) | Val  Loss: 0.2369 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2253 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2888 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.3209 | Val  Acc: 0.9016
 Site-Sketch                    (2) | Val  Loss: 0.3783 | Val  Acc: 0.8952
 Site-Sketch                    (2) | Val  Loss: 0.4203 | Val  Acc: 0.8762
 Site-QuickDraw                 (1) | Val  Loss: 0.6541 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6361 | Val  Acc: 0.8254
 Site-Infograph                 (0) | Val  Loss: 0.8879 | Val  Acc: 0.6952
 Site-Infograph                 (0) | Val  Loss: 0.9513 | Val  Acc: 0.7270
Average Valid Accuracy: 0.8571
============ Train epoch 39 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (0) | Train Loss: 0.4789 | Train Acc: 0.8662
 Site-Clipart                   (0) | Train Loss: 0.4012 | Train Acc: 0.8856
 Site-Real                      (2) | Train Loss: 0.3085 | Train Acc: 0.9363
 Site-Real                      (2) | Train Loss: 0.1842 | Train Acc: 0.9534
 Site-Painting                  (2) | Train Loss: 0.3628 | Train Acc: 0.9108
 Site-Painting                  (2) | Train Loss: 0.2948 | Train Acc: 0.9110
 Site-Sketch                    (0) | Train Loss: 0.3346 | Train Acc: 0.9172
 Site-Sketch                    (0) | Train Loss: 0.4144 | Train Acc: 0.8665
 Site-QuickDraw                 (1) | Train Loss: 0.6036 | Train Acc: 0.8025
 Site-QuickDraw                 (1) | Train Loss: 0.6028 | Train Acc: 0.8242
 Site-Infograph                 (2) | Train Loss: 1.1468 | Train Acc: 0.6815
 Site-Infograph                 (2) | Train Loss: 0.8410 | Train Acc: 0.7521
Average Train Accuracy: 0.8590
 Site-Clipart                   (0) | Val  Loss: 0.3757 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4584 | Val  Acc: 0.8667
 Site-Real                      (2) | Val  Loss: 0.2495 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.1990 | Val  Acc: 0.9587
 Site-Painting                  (2) | Val  Loss: 0.2471 | Val  Acc: 0.9238
 Site-Painting                  (2) | Val  Loss: 0.2998 | Val  Acc: 0.9302
 Site-Sketch                    (0) | Val  Loss: 0.3511 | Val  Acc: 0.9048
 Site-Sketch                    (0) | Val  Loss: 0.4121 | Val  Acc: 0.8635
 Site-QuickDraw                 (1) | Val  Loss: 0.6414 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.5980 | Val  Acc: 0.8286
 Site-Infograph                 (2) | Val  Loss: 0.9136 | Val  Acc: 0.7048
 Site-Infograph                 (2) | Val  Loss: 0.9236 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8603
============ Train epoch 40 ============
cnt=[8, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (0) | Train Loss: 0.4731 | Train Acc: 0.8471
 Site-Clipart                   (0) | Train Loss: 0.3959 | Train Acc: 0.8750
 Site-Real                      (0) | Train Loss: 0.2680 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.1999 | Train Acc: 0.9492
 Site-Painting                  (0) | Train Loss: 0.3672 | Train Acc: 0.9108
 Site-Painting                  (0) | Train Loss: 0.3273 | Train Acc: 0.9004
 Site-Sketch                    (0) | Train Loss: 0.3615 | Train Acc: 0.8790
 Site-Sketch                    (0) | Train Loss: 0.3742 | Train Acc: 0.8856
 Site-QuickDraw                 (1) | Train Loss: 0.6833 | Train Acc: 0.8217
 Site-QuickDraw                 (1) | Train Loss: 0.6307 | Train Acc: 0.8199
 Site-Infograph                 (2) | Train Loss: 1.1763 | Train Acc: 0.6561
 Site-Infograph                 (2) | Train Loss: 0.8338 | Train Acc: 0.7458
Average Train Accuracy: 0.8512
 Site-Clipart                   (0) | Val  Loss: 0.4129 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.4849 | Val  Acc: 0.8476
 Site-Real                      (0) | Val  Loss: 0.2534 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.2171 | Val  Acc: 0.9460
 Site-Painting                  (0) | Val  Loss: 0.2302 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3020 | Val  Acc: 0.9270
 Site-Sketch                    (0) | Val  Loss: 0.4236 | Val  Acc: 0.8667
 Site-Sketch                    (0) | Val  Loss: 0.3999 | Val  Acc: 0.8730
 Site-QuickDraw                 (1) | Val  Loss: 0.6151 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.5700 | Val  Acc: 0.8508
 Site-Infograph                 (2) | Val  Loss: 0.9134 | Val  Acc: 0.7238
 Site-Infograph                 (2) | Val  Loss: 0.8729 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8619
 Test site-Clipart                   (0)| Epoch:35 | Test Acc: 0.8802
 Test site-Real                      (0)| Epoch:35 | Test Acc: 0.9408
 Test site-Painting                  (0)| Epoch:35 | Test Acc: 0.9176
 Test site-Sketch                    (0)| Epoch:35 | Test Acc: 0.8682
 Test site-QuickDraw                 (1)| Epoch:35 | Test Acc: 0.8010
 Test site-Infograph                 (2)| Epoch:35 | Test Acc: 0.6271
Clipart: 0.8802, Real: 0.9408, Painting: 0.9176, Sketch: 0.8682, QuickDraw: 0.8010, Infograph: 0.6271, 
Average Test Accuracy(group): 0.8392, Average Test Accuracy(individual): 0.8392,
domain std=0.1044, cluster std=0.1134, individual std=0.1044, 
===2023-08-13 18:46:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 3
Loading snapshots...
 Test site-Clipart                   (2)| Epoch:35 | Test Acc: 0.8859
 Test site-Real                      (0)| Epoch:35 | Test Acc: 0.9417
 Test site-Painting                  (0)| Epoch:35 | Test Acc: 0.9208
 Test site-Sketch                    (2)| Epoch:35 | Test Acc: 0.8682
 Test site-QuickDraw                 (1)| Epoch:35 | Test Acc: 0.7880
 Test site-Infograph                 (0)| Epoch:35 | Test Acc: 0.6256
Clipart: 0.8859, Real: 0.9417, Painting: 0.9208, Sketch: 0.8682, QuickDraw: 0.7880, Infograph: 0.6256, 
Average Test Accuracy(group): 0.8384, Average Test Accuracy(individual): 0.8384,
domain std=0.1068, cluster std=0.0364, individual std=0.1068, 
