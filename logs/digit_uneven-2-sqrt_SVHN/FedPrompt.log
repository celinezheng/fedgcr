===2023-03-30 05:58:22===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7291 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6183 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.6558 | Train Acc: 0.5714
 Site-MNIST     | Train Loss: 1.6795 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.5571 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.6457 | Train Acc: 0.6825
 Site-MNIST     | Train Loss: 1.6581 | Train Acc: 0.6032
 Site-USPS      | Train Loss: 1.7664 | Train Acc: 0.6190
 Site-SynthDigits| Train Loss: 2.1725 | Train Acc: 0.2698
 Site-MNIST-M   | Train Loss: 2.2044 | Train Acc: 0.2222
 Site-MNIST     | Val  Loss: 1.6029 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.5897 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.6398 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.7270 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6301 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.5439 | Val  Acc: 0.7381
 Site-MNIST     | Val  Loss: 1.7864 | Val  Acc: 0.5952
 Site-USPS      | Val  Loss: 1.7978 | Val  Acc: 0.5238
 Site-SynthDigits| Val  Loss: 2.1944 | Val  Acc: 0.1905
 Site-MNIST-M   | Val  Loss: 2.2637 | Val  Acc: 0.1667
Average Valid Accuracy: 0.5238
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7381
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5952
 Best site-USPS       | Epoch:0 | Val Acc: 0.5238
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1905
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2907 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.1383 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.2134 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.2288 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.0938 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.1723 | Train Acc: 0.7460
 Site-MNIST     | Train Loss: 1.2193 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 1.3787 | Train Acc: 0.6349
 Site-SynthDigits| Train Loss: 2.0208 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.1042 | Train Acc: 0.2698
 Site-MNIST     | Val  Loss: 1.1079 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.1477 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.1882 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.2647 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.1791 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.1014 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.3110 | Val  Acc: 0.6429
 Site-USPS      | Val  Loss: 1.4147 | Val  Acc: 0.6429
 Site-SynthDigits| Val  Loss: 2.1106 | Val  Acc: 0.2381
 Site-MNIST-M   | Val  Loss: 2.2062 | Val  Acc: 0.1667
Average Valid Accuracy: 0.5929
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6429
 Best site-USPS       | Epoch:1 | Val Acc: 0.6429
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2381
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8551 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 0.7500 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.8249 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 0.8213 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.6678 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.7136 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7949 | Train Acc: 0.7937
 Site-USPS      | Train Loss: 0.9404 | Train Acc: 0.8254
 Site-SynthDigits| Train Loss: 1.8057 | Train Acc: 0.4127
 Site-MNIST-M   | Train Loss: 1.9440 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.6916 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.6928 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.7763 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.8712 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 0.8185 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 0.7078 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.8946 | Val  Acc: 0.7143
 Site-USPS      | Val  Loss: 0.9858 | Val  Acc: 0.7857
 Site-SynthDigits| Val  Loss: 1.9628 | Val  Acc: 0.3095
 Site-MNIST-M   | Val  Loss: 2.1457 | Val  Acc: 0.2143
Average Valid Accuracy: 0.7048
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7143
 Best site-USPS       | Epoch:2 | Val Acc: 0.7857
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3095
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5240 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4854 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 0.4876 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4826 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3812 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4292 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.5191 | Train Acc: 0.8413
 Site-USPS      | Train Loss: 0.7023 | Train Acc: 0.8413
 Site-SynthDigits| Train Loss: 1.6812 | Train Acc: 0.4921
 Site-MNIST-M   | Train Loss: 1.6779 | Train Acc: 0.4286
 Site-MNIST     | Val  Loss: 0.3908 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3800 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4578 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5200 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.4694 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4608 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.5905 | Val  Acc: 0.8095
 Site-USPS      | Val  Loss: 0.7464 | Val  Acc: 0.7857
 Site-SynthDigits| Val  Loss: 1.9481 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.0505 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7690
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8095
 Best site-USPS       | Epoch:3 | Val Acc: 0.7857
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3122 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.2924 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3013 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.2926 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2175 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.2268 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.2989 | Train Acc: 0.9365
 Site-USPS      | Train Loss: 0.5363 | Train Acc: 0.8730
 Site-SynthDigits| Train Loss: 1.4043 | Train Acc: 0.5079
 Site-MNIST-M   | Train Loss: 1.5187 | Train Acc: 0.5238
 Site-MNIST     | Val  Loss: 0.2207 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2169 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.2763 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3090 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.2875 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2853 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3373 | Val  Acc: 0.8810
 Site-USPS      | Val  Loss: 0.5697 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 1.7571 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 2.0091 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8119
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8810
 Best site-USPS       | Epoch:4 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3571
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2002 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.2120 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.1944 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1521 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1176 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1336 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1923 | Train Acc: 0.9524
 Site-USPS      | Train Loss: 0.4850 | Train Acc: 0.8571
 Site-SynthDigits| Train Loss: 1.1789 | Train Acc: 0.6349
 Site-MNIST-M   | Train Loss: 1.2715 | Train Acc: 0.6508
 Site-MNIST     | Val  Loss: 0.1301 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1169 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1354 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1950 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1719 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.2003 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.2232 | Val  Acc: 0.9286
 Site-USPS      | Val  Loss: 0.5472 | Val  Acc: 0.8095
 Site-SynthDigits| Val  Loss: 1.6314 | Val  Acc: 0.4524
 Site-MNIST-M   | Val  Loss: 1.9052 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8405
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-USPS       | Epoch:5 | Val Acc: 0.8095
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4524
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1302 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1494 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1254 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1222 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0888 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0832 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1285 | Train Acc: 0.9841
 Site-USPS      | Train Loss: 0.3439 | Train Acc: 0.8730
 Site-SynthDigits| Train Loss: 0.9348 | Train Acc: 0.7302
 Site-MNIST-M   | Train Loss: 1.0630 | Train Acc: 0.7460
 Site-MNIST     | Val  Loss: 0.0851 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0835 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1108 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1402 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1078 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1413 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1604 | Val  Acc: 0.9524
 Site-USPS      | Val  Loss: 0.4296 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 1.5416 | Val  Acc: 0.5476
 Site-MNIST-M   | Val  Loss: 1.8423 | Val  Acc: 0.4762
Average Valid Accuracy: 0.8714
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9524
 Best site-USPS       | Epoch:6 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5476
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0871 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1065 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1040 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1033 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0628 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0629 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0932 | Train Acc: 0.9841
 Site-USPS      | Train Loss: 0.3568 | Train Acc: 0.8889
 Site-SynthDigits| Train Loss: 0.9724 | Train Acc: 0.7460
 Site-MNIST-M   | Train Loss: 0.9063 | Train Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.0598 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0591 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1015 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0985 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0932 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1097 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.0852 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.4473 | Val  Acc: 0.8810
 Site-SynthDigits| Val  Loss: 1.5657 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 1.8227 | Val  Acc: 0.4524
Average Valid Accuracy: 0.8810
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-USPS       | Epoch:7 | Val Acc: 0.8810
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0762 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1060 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.0827 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0788 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0469 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0445 | Train Acc: 1.0000
===2023-03-30 06:20:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SVHN: 0.2071
Average Test Accuracy: 0.2071
