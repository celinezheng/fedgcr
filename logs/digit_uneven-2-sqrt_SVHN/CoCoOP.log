===2023-03-30 12:51:36===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7741 | Train Acc: 0.5556
 Site-MNIST     | Train Loss: 1.6678 | Train Acc: 0.6984
 Site-MNIST     | Train Loss: 1.6887 | Train Acc: 0.5714
 Site-MNIST     | Train Loss: 1.7261 | Train Acc: 0.6349
 Site-MNIST     | Train Loss: 1.5996 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.6928 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.6989 | Train Acc: 0.6190
 Site-USPS      | Train Loss: 1.7978 | Train Acc: 0.5556
 Site-SynthDigits| Train Loss: 2.1729 | Train Acc: 0.2540
 Site-MNIST-M   | Train Loss: 2.2146 | Train Acc: 0.1905
 Site-MNIST     | Val  Loss: 1.6395 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.6360 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.6868 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.7789 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.6619 | Val  Acc: 0.5952
 Site-MNIST     | Val  Loss: 1.5986 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.8325 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 1.8269 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.1930 | Val  Acc: 0.2381
 Site-MNIST-M   | Val  Loss: 2.2559 | Val  Acc: 0.1190
Average Valid Accuracy: 0.5190
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4762
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5952
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2381
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1190
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3583 | Train Acc: 0.7302
 Site-MNIST     | Train Loss: 1.2588 | Train Acc: 0.7778
 Site-MNIST     | Train Loss: 1.3176 | Train Acc: 0.6984
 Site-MNIST     | Train Loss: 1.3253 | Train Acc: 0.7778
 Site-MNIST     | Train Loss: 1.2028 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 1.2737 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 1.2917 | Train Acc: 0.7302
 Site-USPS      | Train Loss: 1.4612 | Train Acc: 0.7302
 Site-SynthDigits| Train Loss: 2.0248 | Train Acc: 0.2857
 Site-MNIST-M   | Train Loss: 2.1042 | Train Acc: 0.2698
 Site-MNIST     | Val  Loss: 1.2435 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.2334 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.2754 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.3907 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.2796 | Val  Acc: 0.7381
 Site-MNIST     | Val  Loss: 1.1999 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 1.4108 | Val  Acc: 0.6905
 Site-USPS      | Val  Loss: 1.5013 | Val  Acc: 0.7381
 Site-SynthDigits| Val  Loss: 2.0741 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.1895 | Val  Acc: 0.1667
Average Valid Accuracy: 0.6524
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7381
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-USPS       | Epoch:1 | Val Acc: 0.7381
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2857
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0636 | Train Acc: 0.7778
 Site-MNIST     | Train Loss: 0.9707 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 1.0492 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 1.0227 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.9361 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.9748 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 1.0020 | Train Acc: 0.7937
 Site-USPS      | Train Loss: 1.2209 | Train Acc: 0.7937
 Site-SynthDigits| Train Loss: 1.9116 | Train Acc: 0.3492
 Site-MNIST-M   | Train Loss: 2.0077 | Train Acc: 0.2857
 Site-MNIST     | Val  Loss: 0.9537 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.9540 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.9803 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 1.1126 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.0108 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9247 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.1058 | Val  Acc: 0.7381
 Site-USPS      | Val  Loss: 1.2662 | Val  Acc: 0.7857
 Site-SynthDigits| Val  Loss: 1.9781 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.1272 | Val  Acc: 0.2143
Average Valid Accuracy: 0.7143
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7381
 Best site-USPS       | Epoch:2 | Val Acc: 0.7857
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2857
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8528 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.7820 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.8628 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 0.8298 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.7562 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.7734 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.8041 | Train Acc: 0.8254
 Site-USPS      | Train Loss: 1.0506 | Train Acc: 0.8413
 Site-SynthDigits| Train Loss: 1.8247 | Train Acc: 0.3968
 Site-MNIST-M   | Train Loss: 1.9176 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.7646 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7621 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7834 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9108 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 0.8215 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7449 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.8989 | Val  Acc: 0.7381
 Site-USPS      | Val  Loss: 1.1073 | Val  Acc: 0.7857
 Site-SynthDigits| Val  Loss: 1.9091 | Val  Acc: 0.2619
 Site-MNIST-M   | Val  Loss: 2.0804 | Val  Acc: 0.1905
Average Valid Accuracy: 0.7190
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7381
 Best site-USPS       | Epoch:3 | Val Acc: 0.7857
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2619
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7030 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.6525 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7118 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.6837 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.6188 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.6340 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.6706 | Train Acc: 0.8730
 Site-USPS      | Train Loss: 0.9174 | Train Acc: 0.8571
 Site-SynthDigits| Train Loss: 1.7503 | Train Acc: 0.4286
 Site-MNIST-M   | Train Loss: 1.8379 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.6242 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.6122 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6428 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7559 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.6779 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.6132 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7546 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.9877 | Val  Acc: 0.8095
 Site-SynthDigits| Val  Loss: 1.8517 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.0378 | Val  Acc: 0.1905
Average Valid Accuracy: 0.7524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8333
 Best site-USPS       | Epoch:4 | Val Acc: 0.8095
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2857
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.5968 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.5563 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.6029 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.5821 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.5149 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.5374 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.5718 | Train Acc: 0.8889
 Site-USPS      | Train Loss: 0.8155 | Train Acc: 0.8730
 Site-SynthDigits| Train Loss: 1.6767 | Train Acc: 0.4603
 Site-MNIST-M   | Train Loss: 1.7585 | Train Acc: 0.4127
 Site-MNIST     | Val  Loss: 0.5248 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5042 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5468 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6448 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.5761 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5238 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.6507 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.8919 | Val  Acc: 0.8095
 Site-SynthDigits| Val  Loss: 1.8010 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 1.9904 | Val  Acc: 0.2143
Average Valid Accuracy: 0.7762
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8571
 Best site-USPS       | Epoch:5 | Val Acc: 0.8095
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5121 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4840 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.5151 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4994 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4354 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4593 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4971 | Train Acc: 0.9048
 Site-USPS      | Train Loss: 0.7236 | Train Acc: 0.8730
 Site-SynthDigits| Train Loss: 1.6060 | Train Acc: 0.4921
 Site-MNIST-M   | Train Loss: 1.6929 | Train Acc: 0.4286
 Site-MNIST     | Val  Loss: 0.4448 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4182 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4656 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.5512 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4962 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4520 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5668 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.8112 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 1.7671 | Val  Acc: 0.3810
 Site-MNIST-M   | Val  Loss: 1.9550 | Val  Acc: 0.2619
Average Valid Accuracy: 0.7976
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8571
 Best site-USPS       | Epoch:6 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3810
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4479 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4294 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4468 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4391 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3713 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3919 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4243 | Train Acc: 0.9365
 Site-USPS      | Train Loss: 0.6528 | Train Acc: 0.8730
 Site-SynthDigits| Train Loss: 1.5472 | Train Acc: 0.5079
 Site-MNIST-M   | Train Loss: 1.6130 | Train Acc: 0.4762
 Site-MNIST     | Val  Loss: 0.3850 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3545 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4066 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4829 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4269 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3955 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5048 | Val  Acc: 0.9048
 Site-USPS      | Val  Loss: 0.7481 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 1.7451 | Val  Acc: 0.3810
 Site-MNIST-M   | Val  Loss: 1.9020 | Val  Acc: 0.2857
Average Valid Accuracy: 0.8095
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9048
 Best site-USPS       | Epoch:7 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3810
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.3828 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3812 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.3852 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3840 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3239 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3329 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3674 | Train Acc: 0.9524
 Site-USPS      | Train Loss: 0.5985 | Train Acc: 0.8889
 Site-SynthDigits| Train Loss: 1.4874 | Train Acc: 0.5397
 Site-MNIST-M   | Train Loss: 1.5156 | Train Acc: 0.5238
 Site-MNIST     | Val  Loss: 0.3249 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3000 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3501 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4185 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3639 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3545 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4528 | Val  Acc: 0.8810
 Site-USPS      | Val  Loss: 0.6857 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 1.7603 | Val  Acc: 0.3810
 Site-MNIST-M   | Val  Loss: 1.8251 | Val  Acc: 0.3810
Average Valid Accuracy: 0.8238
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8810
 Best site-USPS       | Epoch:8 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3810
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3335 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.3497 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.3320 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3439 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.2730 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2848 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.3179 | Train Acc: 0.9524
 Site-USPS      | Train Loss: 0.5509 | Train Acc: 0.8889
 Site-SynthDigits| Train Loss: 1.4821 | Train Acc: 0.5397
 Site-MNIST-M   | Train Loss: 1.4455 | Train Acc: 0.6032
 Site-MNIST     | Val  Loss: 0.2749 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2472 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3150 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3704 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3131 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3171 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4125 | Val  Acc: 0.9048
 Site-USPS      | Val  Loss: 0.6359 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 1.7751 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 1.7691 | Val  Acc: 0.3810
Average Valid Accuracy: 0.8238
===2023-03-30 13:15:00===
===2023-03-30 13:15:02===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SVHN: 0.2403
Average Test Accuracy: 0.2403
