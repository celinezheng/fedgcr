===2023-03-26 10:27:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6903 | Train Acc: 0.5676
 Site-MNIST     | Train Loss: 1.7101 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 2.1937 | Train Acc: 0.1532
 Site-SVHN      | Train Loss: 2.2004 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 1.5676 | Train Acc: 0.7477
 Site-USPS      | Train Loss: 1.6465 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 2.0150 | Train Acc: 0.2973
 Site-SynthDigits| Train Loss: 2.0369 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.7068 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.6530 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.2348 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1780 | Val  Acc: 0.1216
 Site-USPS      | Val  Loss: 1.6181 | Val  Acc: 0.7432
 Site-USPS      | Val  Loss: 1.6119 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 2.0482 | Val  Acc: 0.3243
 Site-SynthDigits| Val  Loss: 1.9963 | Val  Acc: 0.3243
Average Valid Accuracy: 0.4527
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1216
 Best site-USPS       | Epoch:0 | Val Acc: 0.7432
 Best site-USPS       | Epoch:0 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.0682 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 1.1349 | Train Acc: 0.7658
 Site-SVHN      | Train Loss: 2.0788 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.0546 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 0.9588 | Train Acc: 0.8468
 Site-USPS      | Train Loss: 1.0805 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.7094 | Train Acc: 0.4414
 Site-SynthDigits| Train Loss: 1.6865 | Train Acc: 0.4685
 Site-MNIST     | Val  Loss: 1.1490 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 1.0572 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 2.1150 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.0258 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.0541 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 1.0287 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.7106 | Val  Acc: 0.4054
 Site-SynthDigits| Val  Loss: 1.6545 | Val  Acc: 0.5135
Average Valid Accuracy: 0.5709
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2162
 Best site-USPS       | Epoch:1 | Val Acc: 0.8378
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4054
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.5998 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.7081 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.9138 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.9077 | Train Acc: 0.3063
 Site-USPS      | Train Loss: 0.5980 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.6797 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.4872 | Train Acc: 0.5225
 Site-SynthDigits| Train Loss: 1.5238 | Train Acc: 0.5045
 Site-MNIST     | Val  Loss: 0.7025 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.6442 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.9963 | Val  Acc: 0.2432
 Site-SVHN      | Val  Loss: 1.8374 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.6619 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.6468 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.5798 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 1.4649 | Val  Acc: 0.5270
Average Valid Accuracy: 0.6351
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3784
 Best site-USPS       | Epoch:2 | Val Acc: 0.8649
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5270
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.3938 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.4927 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.8268 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.7894 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.4317 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.5245 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.1928 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.2184 | Train Acc: 0.5946
 Site-MNIST     | Val  Loss: 0.4809 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.4560 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.9114 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.7289 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.5083 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.4810 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.2523 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 1.1719 | Val  Acc: 0.5811
Average Valid Accuracy: 0.6959
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3784
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-USPS       | Epoch:3 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2549 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.3386 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 1.5261 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.5623 | Train Acc: 0.5045
 Site-USPS      | Train Loss: 0.3073 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.3480 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 1.0604 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 1.0582 | Train Acc: 0.6396
 Site-MNIST     | Val  Loss: 0.3200 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.3151 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.6756 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.4312 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 0.3389 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.3261 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.1095 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 1.0106 | Val  Acc: 0.6757
Average Valid Accuracy: 0.7517
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-USPS       | Epoch:4 | Val Acc: 0.9054
 Best site-USPS       | Epoch:4 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1720 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.2471 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 1.3926 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.3847 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.2514 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.2785 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.8568 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 0.8237 | Train Acc: 0.7297
 Site-MNIST     | Val  Loss: 0.2207 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2402 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.4883 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.2774 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 0.2663 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2674 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.8788 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 0.7867 | Val  Acc: 0.7297
Average Valid Accuracy: 0.7956
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5541
 Best site-USPS       | Epoch:5 | Val Acc: 0.9324
 Best site-USPS       | Epoch:5 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1041 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1724 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 1.1610 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.1335 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 0.2039 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2215 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.6993 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.6071 | Train Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.1571 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1592 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 1.2365 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 1.0349 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 0.2099 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2152 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.6516 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 0.6069 | Val  Acc: 0.7703
Average Valid Accuracy: 0.8463
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6757
 Best site-USPS       | Epoch:6 | Val Acc: 0.9595
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0760 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1217 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 1.0006 | Train Acc: 0.6847
 Site-SVHN      | Train Loss: 1.0296 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.1454 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.1527 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 0.5670 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.5079 | Train Acc: 0.8739
 Site-MNIST     | Val  Loss: 0.1164 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1109 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 1.1451 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 0.8710 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.1519 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1424 | Val  Acc: 0.9730
 Site-SynthDigits| Val  Loss: 0.5709 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4660 | Val  Acc: 0.8514
Average Valid Accuracy: 0.8750
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7568
 Best site-USPS       | Epoch:7 | Val Acc: 0.9730
 Best site-USPS       | Epoch:7 | Val Acc: 0.9730
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0488 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0816 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.7485 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 0.8001 | Train Acc: 0.7748
 Site-USPS      | Train Loss: 0.1062 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0935 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.4957 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 0.4434 | Train Acc: 0.8829
 Site-MNIST     | Val  Loss: 0.0848 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0683 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8633 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 0.6971 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.0908 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1009 | Val  Acc: 0.9730
 Site-SynthDigits| Val  Loss: 0.5088 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4042 | Val  Acc: 0.8784
Average Valid Accuracy: 0.9071
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8243
 Best site-USPS       | Epoch:8 | Val Acc: 0.9865
 Best site-USPS       | Epoch:8 | Val Acc: 0.9730
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0399 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0538 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5327 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 0.5989 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.0855 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.0757 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.3584 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.3228 | Train Acc: 0.9279
 Site-MNIST     | Val  Loss: 0.0514 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0493 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6536 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 0.5196 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.0734 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.0814 | Val  Acc: 0.9730
 Site-SynthDigits| Val  Loss: 0.3717 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.2987 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9375
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8514
 Best site-USPS       | Epoch:9 | Val Acc: 0.9865
 Best site-USPS       | Epoch:9 | Val Acc: 0.9730
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST-M...
===2023-03-26 10:59:34===
===2023-03-26 10:59:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8593
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3315
 Test site-USPS      | Epoch:9 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6162
Average Test Accuracy: 0.6708
===2023-03-26 12:10:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of MNIST-M: 0.2857
Average Test Accuracy: 0.2857
===2023-03-29 23:14:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8648 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.7777 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.7856 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 2.2262 | Train Acc: 0.1477
 Site-SVHN      | Train Loss: 2.1614 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1988 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.7450 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 1.7783 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 1.6760 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.1113 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 2.0995 | Train Acc: 0.2727
 Site-SynthDigits| Train Loss: 2.1162 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.7820 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.8292 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7837 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 2.2490 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1738 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2369 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.6852 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 1.8476 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 1.7535 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.1079 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 2.1263 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 2.0850 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4138
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.7458
 Best site-USPS       | Epoch:0 | Val Acc: 0.5593
 Best site-USPS       | Epoch:0 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4433 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.3918 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.4192 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1657 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.0675 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.0928 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 1.3734 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.3981 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.2729 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.9272 | Train Acc: 0.3636
 Site-SynthDigits| Train Loss: 1.9076 | Train Acc: 0.3750
 Site-SynthDigits| Train Loss: 1.9190 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.4167 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.4553 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.3760 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.1639 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.0695 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1413 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.2804 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 1.4436 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.3473 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9119 | Val  Acc: 0.3051
 Site-SynthDigits| Val  Loss: 1.9423 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.8759 | Val  Acc: 0.4068
Average Valid Accuracy: 0.5099
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.8475
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-USPS       | Epoch:1 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3051
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1959 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.1469 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1722 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.0873 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.9805 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.9725 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 1.0365 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.1115 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.9765 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.7439 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.7330 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.7901 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 1.1725 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1998 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1023 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0942 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 1.9904 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0465 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.9991 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 1.1442 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0603 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.7469 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.7941 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.6996 | Val  Acc: 0.5085
Average Valid Accuracy: 0.5932
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2373
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-USPS       | Epoch:2 | Val Acc: 0.8136
 Best site-USPS       | Epoch:2 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9528 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.9330 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.9642 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 2.0374 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 1.9100 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8983 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.8729 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.9280 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.7926 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6357 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.5246 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.6311 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.9762 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9988 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8981 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0252 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.9403 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9681 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.8204 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.9537 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.8832 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6107 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.6547 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.5599 | Val  Acc: 0.5254
Average Valid Accuracy: 0.6201
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2881
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.8305
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.8078 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.7858 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.8068 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 2.0174 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 1.8456 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8208 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.7593 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.7924 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.6780 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.4909 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.4546 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.4907 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.8413 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8513 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7628 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9565 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.8895 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.9036 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.6945 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.8140 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.7365 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.5019 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.5227 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.4276 | Val  Acc: 0.5254
Average Valid Accuracy: 0.6384
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2712
 Best site-USPS       | Epoch:4 | Val Acc: 0.8644
 Best site-USPS       | Epoch:4 | Val Acc: 0.8475
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.7025 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.7011 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.7476 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.9436 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 1.7518 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.7405 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.6767 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.6823 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5784 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.3911 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.3463 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.3698 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.7419 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7431 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6662 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9102 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8205 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.8359 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.6025 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.7259 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6454 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.4009 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.4252 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.3459 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6511
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2373
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.6005 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6324 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.6378 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.9087 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.6952 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.7257 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.5964 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.6079 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5380 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.3206 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.2635 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.2641 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.6516 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6376 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.5867 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8600 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7647 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7796 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.5351 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6487 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5655 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.3040 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.3087 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.2733 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6780
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2881
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-USPS       | Epoch:6 | Val Acc: 0.8644
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5255 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5284 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5853 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.8379 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.6747 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.6417 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5063 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.5761 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4893 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.2384 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 1.1888 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.1916 | Train Acc: 0.6932
 Site-MNIST     | Val  Loss: 0.5758 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5568 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5211 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8193 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7282 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7165 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.4905 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5713 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4953 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.2187 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 1.2097 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.2203 | Val  Acc: 0.5763
Average Valid Accuracy: 0.6935
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3051
 Best site-USPS       | Epoch:7 | Val Acc: 0.8983
 Best site-USPS       | Epoch:7 | Val Acc: 0.8814
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4642 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4856 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5092 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.8011 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.6126 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.6143 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.4673 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.5121 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4637 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.1561 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.0846 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.1013 | Train Acc: 0.7500
 Site-MNIST     | Val  Loss: 0.5237 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4921 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4690 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.7661 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.6814 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6633 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.4592 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5289 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4538 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.1274 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.1122 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 1.1645 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7189
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3559
 Best site-USPS       | Epoch:8 | Val Acc: 0.8983
 Best site-USPS       | Epoch:8 | Val Acc: 0.8814
 Best site-USPS       | Epoch:8 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4409 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4013 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4538 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.7677 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.5537 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.5617 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.4214 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4496 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4143 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.0605 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.9777 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 1.0940 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.4851 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4411 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4237 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.7243 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6444 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6046 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.4293 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4706 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4026 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0559 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.0224 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.1009 | Val  Acc: 0.6102
Average Valid Accuracy: 0.7373
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4407
 Best site-USPS       | Epoch:9 | Val Acc: 0.8983
 Best site-USPS       | Epoch:9 | Val Acc: 0.8814
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST-M...
===2023-03-29 23:53:25===
===2023-03-29 23:53:26===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST-M: 0.3171
Average Test Accuracy: 0.3171
