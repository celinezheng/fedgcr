===2023-03-26 01:35:27===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
===2023-03-26 01:38:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
===2023-03-26 04:28:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7101 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.7432 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 2.1995 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2206 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 1.6571 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 1.7213 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 2.0625 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.0920 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 1.7399 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6754 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 2.2714 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.1797 | Val  Acc: 0.1892
 Site-USPS      | Val  Loss: 1.6916 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 1.6765 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.0784 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 2.0898 | Val  Acc: 0.2568
Average Valid Accuracy: 0.3986
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-USPS       | Epoch:0 | Val Acc: 0.6081
 Best site-USPS       | Epoch:0 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2585 | Train Acc: 0.6216
 Site-MNIST     | Train Loss: 1.2803 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 2.1600 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0923 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.0626 | Train Acc: 0.8468
 Site-USPS      | Train Loss: 1.1153 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.7672 | Train Acc: 0.3964
 Site-SynthDigits| Train Loss: 1.8179 | Train Acc: 0.4144
 Site-MNIST     | Val  Loss: 1.3195 | Val  Acc: 0.5811
 Site-MNIST     | Val  Loss: 1.1521 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 2.1402 | Val  Acc: 0.2432
 Site-SVHN      | Val  Loss: 2.0573 | Val  Acc: 0.2297
 Site-USPS      | Val  Loss: 1.0993 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 1.0782 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.8302 | Val  Acc: 0.3919
 Site-SynthDigits| Val  Loss: 1.7534 | Val  Acc: 0.4324
Average Valid Accuracy: 0.5355
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5811
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2432
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2297
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-USPS       | Epoch:1 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3919
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9452 | Train Acc: 0.6847
 Site-MNIST     | Train Loss: 0.9580 | Train Acc: 0.7117
 Site-SVHN      | Train Loss: 1.9347 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.9237 | Train Acc: 0.3874
 Site-USPS      | Train Loss: 0.6671 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.6728 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.5497 | Train Acc: 0.4595
 Site-SynthDigits| Train Loss: 1.6265 | Train Acc: 0.4324
 Site-MNIST     | Val  Loss: 0.9758 | Val  Acc: 0.7027
 Site-MNIST     | Val  Loss: 0.8728 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 1.9492 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.9019 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.6626 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.6627 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.6493 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 1.5914 | Val  Acc: 0.4595
Average Valid Accuracy: 0.5980
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7027
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3649
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-USPS       | Epoch:2 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6823 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 0.7512 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 1.9276 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.8141 | Train Acc: 0.4414
 Site-USPS      | Train Loss: 0.4816 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.5718 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.2237 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 1.3087 | Train Acc: 0.5495
 Site-MNIST     | Val  Loss: 0.7851 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 0.6673 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 1.9238 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.7380 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 0.5703 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.5176 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.3126 | Val  Acc: 0.5541
 Site-SynthDigits| Val  Loss: 1.3152 | Val  Acc: 0.5541
Average Valid Accuracy: 0.6453
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3514
 Best site-USPS       | Epoch:3 | Val Acc: 0.8378
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5541
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6267 | Train Acc: 0.7477
 Site-MNIST     | Train Loss: 0.6712 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 1.6032 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 1.6528 | Train Acc: 0.4414
 Site-USPS      | Train Loss: 0.3944 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.4485 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.1177 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.1731 | Train Acc: 0.5225
 Site-MNIST     | Val  Loss: 0.6628 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.6389 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 1.6996 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.5875 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.4392 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.4104 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.2141 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.1591 | Val  Acc: 0.5541
Average Valid Accuracy: 0.6622
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4459
 Best site-USPS       | Epoch:4 | Val Acc: 0.8919
 Best site-USPS       | Epoch:4 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2797 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.3244 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.6568 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 1.5784 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.2750 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.3249 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.7843 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 0.8450 | Train Acc: 0.7297
 Site-MNIST     | Val  Loss: 0.3188 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3073 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.6853 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.5416 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.3038 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.3104 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.9020 | Val  Acc: 0.7162
 Site-SynthDigits| Val  Loss: 0.7965 | Val  Acc: 0.7297
Average Valid Accuracy: 0.7601
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4459
 Best site-USPS       | Epoch:5 | Val Acc: 0.9189
 Best site-USPS       | Epoch:5 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7162
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2572 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.2969 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.2342 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 1.2856 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 0.2328 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.2675 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.6580 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 0.7604 | Train Acc: 0.8018
 Site-MNIST     | Val  Loss: 0.2861 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.2915 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.3806 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.1980 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.2605 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2443 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.8376 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 0.6784 | Val  Acc: 0.8108
Average Valid Accuracy: 0.8108
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1453 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1607 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 1.0968 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.0910 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 0.1899 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.2224 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.4102 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4778 | Train Acc: 0.8829
 Site-MNIST     | Val  Loss: 0.1449 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1655 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 1.2008 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 1.0260 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.2084 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2063 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.5196 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.4441 | Val  Acc: 0.9054
Average Valid Accuracy: 0.8514
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6351
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0962 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1200 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 0.8489 | Train Acc: 0.7207
 Site-SVHN      | Train Loss: 0.8762 | Train Acc: 0.7207
 Site-USPS      | Train Loss: 0.1201 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.1409 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.2728 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.3306 | Train Acc: 0.9279
 Site-MNIST     | Val  Loss: 0.1106 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1242 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 0.9689 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 0.7941 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.1280 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.1323 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.3673 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2934 | Val  Acc: 0.9459
Average Valid Accuracy: 0.8970
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7568
 Best site-USPS       | Epoch:8 | Val Acc: 0.9595
 Best site-USPS       | Epoch:8 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0644 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0853 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.6566 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 0.6787 | Train Acc: 0.8198
 Site-USPS      | Train Loss: 0.1017 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.0993 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 0.2146 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.2531 | Train Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.0707 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0879 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.7589 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 0.6367 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.0949 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.0962 | Val  Acc: 0.9730
 Site-SynthDigits| Val  Loss: 0.2834 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.2323 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9291
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8243
 Best site-USPS       | Epoch:9 | Val Acc: 0.9730
 Best site-USPS       | Epoch:9 | Val Acc: 0.9730
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST-M...
===2023-03-26 05:01:54===
===2023-03-26 05:01:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8757
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3622
 Test site-USPS      | Epoch:9 | Test Acc: 0.8602
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6816
Average Test Accuracy: 0.6949
===2023-03-26 12:02:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of MNIST-M: 0.3179
Average Test Accuracy: 0.3179
===2023-03-29 19:52:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8350 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.7770 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.7509 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2336 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1700 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1758 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.7225 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 1.7820 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 1.6295 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.1117 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.1072 | Train Acc: 0.2727
 Site-SynthDigits| Train Loss: 2.1065 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.7524 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7907 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.7459 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 2.2356 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.1601 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.2283 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.6461 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.8114 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 1.7220 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 2.1071 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 2.1266 | Val  Acc: 0.2542
 Site-SynthDigits| Val  Loss: 2.0749 | Val  Acc: 0.2881
Average Valid Accuracy: 0.4167
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.7288
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-USPS       | Epoch:0 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2542
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4680 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.3291 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.4097 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 2.1828 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0600 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0743 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.1774 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.2434 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.1445 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8365 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 1.8497 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 1.9068 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.4107 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.3767 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.2984 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.1416 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0910 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1135 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.1300 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.2337 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.2073 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.9034 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.8990 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 1.8156 | Val  Acc: 0.4068
Average Valid Accuracy: 0.5099
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.7797
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9967 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 0.8641 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.9804 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.1408 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.8610 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.9622 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.7703 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.7416 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.7489 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.5449 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.5428 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.6799 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.0216 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 0.9503 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.8817 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.0101 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9315 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9621 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.7510 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.7766 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.7698 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.6562 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.6350 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.5681 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5890
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-USPS       | Epoch:2 | Val Acc: 0.8136
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6788 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.6106 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6630 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9518 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7199 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.8298 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.5084 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.5031 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5447 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3584 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.3289 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.4144 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.7569 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.6777 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6150 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.9024 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7882 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8259 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.5509 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.5274 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5093 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.3943 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.3801 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.4171 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6398
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2712
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4822 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4529 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5015 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.7583 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.4708 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.5765 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.3959 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.3580 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.4121 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.0443 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.0376 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.1069 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.5558 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.4884 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.4339 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.7153 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.5651 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.6436 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.4116 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.3885 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3668 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.1006 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.0741 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.1200 | Val  Acc: 0.6610
Average Valid Accuracy: 0.7203
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4068
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3866 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.3470 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.4173 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.6653 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.3845 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 1.5398 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.3537 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.3232 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3404 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.9752 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.9440 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.0294 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.4455 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.3912 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.3539 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.6532 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.5025 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.5477 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.3346 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3155 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.3106 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.0308 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 0.9461 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.1051 | Val  Acc: 0.6271
Average Valid Accuracy: 0.7288
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4068
 Best site-USPS       | Epoch:5 | Val Acc: 0.9153
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2532 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2335 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3208 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.4169 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.1615 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 1.2985 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.2436 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.2078 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.2195 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.7747 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 0.6869 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 0.7050 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.3164 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2506 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2445 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.3238 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.2616 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.3021 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.2249 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2194 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.2171 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.7322 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.6700 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.8115 | Val  Acc: 0.7288
Average Valid Accuracy: 0.8136
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1909 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2135 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2197 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.3873 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.0753 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 1.2159 | Train Acc: 0.5795
 Site-USPS      | Train Loss: 0.1881 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.1749 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1886 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.6837 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.6080 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.6366 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.2298 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2049 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1747 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.3160 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.1462 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.2404 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 0.1892 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1667 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1874 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.6435 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.5833 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.7512 | Val  Acc: 0.7627
Average Valid Accuracy: 0.8263
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6102
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-USPS       | Epoch:7 | Val Acc: 0.9831
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1759 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1107 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1725 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.0768 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 0.8097 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 0.9060 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 0.1429 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1011 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1397 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.5466 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.4474 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.4535 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.1997 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1171 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1197 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.0209 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 0.8741 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.8905 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 0.1338 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1044 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1085 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.5021 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 0.4115 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.5735 | Val  Acc: 0.8475
Average Valid Accuracy: 0.8799
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6780
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-USPS       | Epoch:8 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8475
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1123 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0846 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1267 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.9231 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 0.7078 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 0.8359 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 0.1046 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0710 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0890 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.5801 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4189 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4192 | Train Acc: 0.8636
 Site-MNIST     | Val  Loss: 0.1237 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.0895 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0860 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.9879 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 0.7956 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.8139 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.0967 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0755 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0865 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4667 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 0.3973 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.5688 | Val  Acc: 0.8305
Average Valid Accuracy: 0.8814
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7458
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8305
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST-M...
===2023-03-29 20:33:16===
===2023-03-29 20:33:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST-M: 0.3086
Average Test Accuracy: 0.3086
