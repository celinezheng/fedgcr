===2023-03-26 13:10:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2238 | Train Acc: 0.2703
 Site-MNIST     | Train Loss: 2.2329 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.2778 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.2859 | Train Acc: 0.1081
 Site-USPS      | Train Loss: 2.2122 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 2.2206 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.2895 | Train Acc: 0.1622
 Site-SynthDigits| Train Loss: 2.2805 | Train Acc: 0.1171
 Site-MNIST     | Val  Loss: 2.2447 | Val  Acc: 0.1757
 Site-MNIST     | Val  Loss: 2.2068 | Val  Acc: 0.3784
 Site-SVHN      | Val  Loss: 2.2867 | Val  Acc: 0.0811
 Site-SVHN      | Val  Loss: 2.2820 | Val  Acc: 0.1892
 Site-USPS      | Val  Loss: 2.2195 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 2.2202 | Val  Acc: 0.4865
 Site-SynthDigits| Val  Loss: 2.2857 | Val  Acc: 0.0811
 Site-SynthDigits| Val  Loss: 2.2891 | Val  Acc: 0.1486
Average Valid Accuracy: 0.2348
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1757
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3784
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0811
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-USPS       | Epoch:0 | Val Acc: 0.3378
 Best site-USPS       | Epoch:0 | Val Acc: 0.4865
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0811
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.1568 | Train Acc: 0.4505
 Site-MNIST     | Train Loss: 2.1654 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 2.2619 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.2689 | Train Acc: 0.1622
 Site-USPS      | Train Loss: 2.1268 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 2.1375 | Train Acc: 0.4505
 Site-SynthDigits| Train Loss: 2.2723 | Train Acc: 0.2342
 Site-SynthDigits| Train Loss: 2.2582 | Train Acc: 0.2072
 Site-MNIST     | Val  Loss: 2.1818 | Val  Acc: 0.3649
 Site-MNIST     | Val  Loss: 2.1277 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 2.2726 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.2647 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 2.1345 | Val  Acc: 0.4730
 Site-USPS      | Val  Loss: 2.1356 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 2.2604 | Val  Acc: 0.1757
 Site-SynthDigits| Val  Loss: 2.2750 | Val  Acc: 0.2027
Average Valid Accuracy: 0.3294
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3649
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2162
 Best site-USPS       | Epoch:1 | Val Acc: 0.4730
 Best site-USPS       | Epoch:1 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1757
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.0914 | Train Acc: 0.4775
 Site-MNIST     | Train Loss: 2.0999 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 2.2490 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.2536 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 2.0467 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 2.0587 | Train Acc: 0.5225
 Site-SynthDigits| Train Loss: 2.2529 | Train Acc: 0.2973
 Site-SynthDigits| Train Loss: 2.2347 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 2.1208 | Val  Acc: 0.4324
 Site-MNIST     | Val  Loss: 2.0521 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 2.2595 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.2499 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 2.0545 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 2.0568 | Val  Acc: 0.5541
 Site-SynthDigits| Val  Loss: 2.2361 | Val  Acc: 0.3108
 Site-SynthDigits| Val  Loss: 2.2571 | Val  Acc: 0.2162
Average Valid Accuracy: 0.3801
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4324
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-USPS       | Epoch:2 | Val Acc: 0.5676
 Best site-USPS       | Epoch:2 | Val Acc: 0.5541
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3108
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.0292 | Train Acc: 0.4955
 Site-MNIST     | Train Loss: 2.0394 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 2.2389 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.2408 | Train Acc: 0.1802
 Site-USPS      | Train Loss: 1.9715 | Train Acc: 0.6216
 Site-USPS      | Train Loss: 1.9857 | Train Acc: 0.5225
 Site-SynthDigits| Train Loss: 2.2317 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 2.2099 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 2.0638 | Val  Acc: 0.4595
 Site-MNIST     | Val  Loss: 1.9804 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 2.2484 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.2393 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 1.9818 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.9847 | Val  Acc: 0.5541
 Site-SynthDigits| Val  Loss: 2.2115 | Val  Acc: 0.3649
 Site-SynthDigits| Val  Loss: 2.2356 | Val  Acc: 0.2162
Average Valid Accuracy: 0.3970
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4595
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2703
 Best site-USPS       | Epoch:3 | Val Acc: 0.5676
 Best site-USPS       | Epoch:3 | Val Acc: 0.5541
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3649
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 1.9714 | Train Acc: 0.5315
 Site-MNIST     | Train Loss: 1.9854 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 2.2287 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.2283 | Train Acc: 0.1982
 Site-USPS      | Train Loss: 1.9007 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 1.9160 | Train Acc: 0.5405
 Site-SynthDigits| Train Loss: 2.2102 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 2.1861 | Train Acc: 0.3604
 Site-MNIST     | Val  Loss: 2.0122 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.9151 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 2.2381 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.2285 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.9135 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.9176 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 2.1875 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 2.2144 | Val  Acc: 0.2838
Average Valid Accuracy: 0.4257
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2973
 Best site-USPS       | Epoch:4 | Val Acc: 0.5676
 Best site-USPS       | Epoch:4 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 1.9169 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.9330 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 2.2180 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.2175 | Train Acc: 0.2342
 Site-USPS      | Train Loss: 1.8368 | Train Acc: 0.6757
 Site-USPS      | Train Loss: 1.8568 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 2.1885 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 2.1630 | Train Acc: 0.3874
 Site-MNIST     | Val  Loss: 1.9630 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.8538 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 2.2285 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.2181 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 1.8520 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 1.8574 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1644 | Val  Acc: 0.4054
 Site-SynthDigits| Val  Loss: 2.1931 | Val  Acc: 0.3108
Average Valid Accuracy: 0.4493
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3108
 Best site-USPS       | Epoch:5 | Val Acc: 0.5946
 Best site-USPS       | Epoch:5 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4054
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 1.8634 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.8817 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.2092 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.2073 | Train Acc: 0.2432
 Site-USPS      | Train Loss: 1.7766 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 1.7989 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 2.1685 | Train Acc: 0.3604
 Site-SynthDigits| Train Loss: 2.1404 | Train Acc: 0.4234
 Site-MNIST     | Val  Loss: 1.9137 | Val  Acc: 0.5405
 Site-MNIST     | Val  Loss: 1.7958 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 2.2192 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.2078 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.7929 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 1.8001 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1416 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 2.1728 | Val  Acc: 0.3378
Average Valid Accuracy: 0.4611
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5405
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2973
 Best site-USPS       | Epoch:6 | Val Acc: 0.5946
 Best site-USPS       | Epoch:6 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.8130 | Train Acc: 0.5766
 Site-MNIST     | Train Loss: 1.8350 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 2.2000 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.1970 | Train Acc: 0.2432
 Site-USPS      | Train Loss: 1.7186 | Train Acc: 0.6937
 Site-USPS      | Train Loss: 1.7421 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 2.1471 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.1180 | Train Acc: 0.4414
 Site-MNIST     | Val  Loss: 1.8681 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.7423 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 2.2104 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.1981 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.7362 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 1.7452 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1203 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.1521 | Val  Acc: 0.3378
Average Valid Accuracy: 0.4645
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2973
 Best site-USPS       | Epoch:7 | Val Acc: 0.6081
 Best site-USPS       | Epoch:7 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.7614 | Train Acc: 0.6216
 Site-MNIST     | Train Loss: 1.7895 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 2.1911 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.1875 | Train Acc: 0.2523
 Site-USPS      | Train Loss: 1.6630 | Train Acc: 0.7387
 Site-USPS      | Train Loss: 1.6874 | Train Acc: 0.6036
 Site-SynthDigits| Train Loss: 2.1281 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.0973 | Train Acc: 0.4505
 Site-MNIST     | Val  Loss: 1.8231 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.6908 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 2.2015 | Val  Acc: 0.2162
 Site-SVHN      | Val  Loss: 2.1889 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.6809 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 1.6920 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 2.0993 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.1322 | Val  Acc: 0.3514
Average Valid Accuracy: 0.4831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2162
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2973
 Best site-USPS       | Epoch:8 | Val Acc: 0.6351
 Best site-USPS       | Epoch:8 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.7153 | Train Acc: 0.6577
 Site-MNIST     | Train Loss: 1.7442 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 2.1834 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1774 | Train Acc: 0.2523
 Site-USPS      | Train Loss: 1.6175 | Train Acc: 0.7477
 Site-USPS      | Train Loss: 1.6410 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 2.1087 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.0765 | Train Acc: 0.4595
 Site-MNIST     | Val  Loss: 1.7783 | Val  Acc: 0.5946
 Site-MNIST     | Val  Loss: 1.6398 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 2.1931 | Val  Acc: 0.2162
 Site-SVHN      | Val  Loss: 2.1808 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 1.6337 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 1.6467 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 2.0792 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 2.1112 | Val  Acc: 0.3514
Average Valid Accuracy: 0.4983
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5946
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2162
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3108
 Best site-USPS       | Epoch:9 | Val Acc: 0.6486
 Best site-USPS       | Epoch:9 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST-M...
===2023-03-26 13:25:06===
===2023-03-26 13:25:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of MNIST-M: 0.1886
Average Test Accuracy: 0.1886
