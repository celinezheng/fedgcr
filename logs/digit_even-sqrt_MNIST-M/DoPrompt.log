===2023-03-26 07:29:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7283 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.7383 | Train Acc: 0.5405
 Site-SVHN      | Train Loss: 2.2053 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2219 | Train Acc: 0.2252
 Site-USPS      | Train Loss: 1.6239 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 1.6939 | Train Acc: 0.6667
 Site-SynthDigits| Train Loss: 2.0407 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 2.0765 | Train Acc: 0.3063
 Site-MNIST     | Val  Loss: 1.7344 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.6751 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 2.2662 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.1768 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 1.6653 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 1.6555 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 2.0693 | Val  Acc: 0.2973
 Site-SynthDigits| Val  Loss: 2.0510 | Val  Acc: 0.3108
Average Valid Accuracy: 0.4476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2703
 Best site-USPS       | Epoch:0 | Val Acc: 0.6757
 Best site-USPS       | Epoch:0 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2973
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3357 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.3742 | Train Acc: 0.6757
 Site-SVHN      | Train Loss: 2.1179 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.1182 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 1.2322 | Train Acc: 0.7928
 Site-USPS      | Train Loss: 1.3041 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.8363 | Train Acc: 0.4234
 Site-SynthDigits| Train Loss: 1.8885 | Train Acc: 0.3514
 Site-MNIST     | Val  Loss: 1.3722 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.2959 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 2.1867 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.0572 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.2826 | Val  Acc: 0.7838
 Site-USPS      | Val  Loss: 1.2616 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 1.8804 | Val  Acc: 0.3108
 Site-SynthDigits| Val  Loss: 1.8536 | Val  Acc: 0.4189
Average Valid Accuracy: 0.5253
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2973
 Best site-USPS       | Epoch:1 | Val Acc: 0.7838
 Best site-USPS       | Epoch:1 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3108
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0706 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 1.1252 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 2.0575 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.0501 | Train Acc: 0.3243
 Site-USPS      | Train Loss: 0.9805 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 1.0501 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.6978 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.7539 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 1.1244 | Val  Acc: 0.7432
 Site-MNIST     | Val  Loss: 1.0535 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 2.1250 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 1.9772 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.0338 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 1.0061 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.7499 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 1.7148 | Val  Acc: 0.4865
Average Valid Accuracy: 0.5794
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7432
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2973
 Best site-USPS       | Epoch:2 | Val Acc: 0.8108
 Best site-USPS       | Epoch:2 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8854 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 0.9459 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 2.0083 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.9911 | Train Acc: 0.3333
 Site-USPS      | Train Loss: 0.8217 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.8930 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.5888 | Train Acc: 0.5045
 Site-SynthDigits| Train Loss: 1.6409 | Train Acc: 0.4324
 Site-MNIST     | Val  Loss: 0.9446 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.8854 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 2.0776 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 1.9062 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 0.8770 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 0.8454 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.6343 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 1.6118 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6014
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3108
 Best site-USPS       | Epoch:3 | Val Acc: 0.8108
 Best site-USPS       | Epoch:3 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7506 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.8199 | Train Acc: 0.8288
 Site-SVHN      | Train Loss: 1.9602 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 1.9416 | Train Acc: 0.3333
 Site-USPS      | Train Loss: 0.7184 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.7872 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.5110 | Train Acc: 0.5315
 Site-SynthDigits| Train Loss: 1.5572 | Train Acc: 0.4775
 Site-MNIST     | Val  Loss: 0.8131 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.7735 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 2.0378 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 1.8566 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 0.7733 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.7375 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.5516 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 1.5319 | Val  Acc: 0.5405
Average Valid Accuracy: 0.6318
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3514
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-USPS       | Epoch:4 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5405
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6482 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.7145 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.9217 | Train Acc: 0.3063
 Site-SVHN      | Train Loss: 1.9016 | Train Acc: 0.3243
 Site-USPS      | Train Loss: 0.6465 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.7098 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.4400 | Train Acc: 0.5405
 Site-SynthDigits| Train Loss: 1.4823 | Train Acc: 0.5225
 Site-MNIST     | Val  Loss: 0.7037 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.6850 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 2.0034 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 1.8162 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 0.6985 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.6611 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.4812 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.4635 | Val  Acc: 0.5676
Average Valid Accuracy: 0.6470
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3514
 Best site-USPS       | Epoch:5 | Val Acc: 0.8649
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5669 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.6355 | Train Acc: 0.8919
 Site-SVHN      | Train Loss: 1.8938 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.8703 | Train Acc: 0.3423
 Site-USPS      | Train Loss: 0.5880 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.6509 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.3828 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 1.4183 | Train Acc: 0.5405
 Site-MNIST     | Val  Loss: 0.6218 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.6192 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.9743 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 1.7807 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.6425 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.6015 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.4219 | Val  Acc: 0.5270
 Site-SynthDigits| Val  Loss: 1.3977 | Val  Acc: 0.5676
Average Valid Accuracy: 0.6639
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3649
 Best site-USPS       | Epoch:6 | Val Acc: 0.8649
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5270
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5046 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.5746 | Train Acc: 0.8919
 Site-SVHN      | Train Loss: 1.8618 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.8395 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 0.5541 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.6136 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.3282 | Train Acc: 0.6036
 Site-SynthDigits| Train Loss: 1.3578 | Train Acc: 0.5405
 Site-MNIST     | Val  Loss: 0.5550 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.5644 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.9422 | Val  Acc: 0.2838
 Site-SVHN      | Val  Loss: 1.7547 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.6068 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.5637 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.3617 | Val  Acc: 0.5270
 Site-SynthDigits| Val  Loss: 1.3447 | Val  Acc: 0.5676
Average Valid Accuracy: 0.6639
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4597 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.5287 | Train Acc: 0.8919
 Site-SVHN      | Train Loss: 1.8401 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.8120 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 0.5108 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.5705 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.2817 | Train Acc: 0.6396
 Site-SynthDigits| Train Loss: 1.3013 | Train Acc: 0.5586
 Site-MNIST     | Val  Loss: 0.5037 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5259 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.9218 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 1.7264 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.5634 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.5213 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.3090 | Val  Acc: 0.5541
 Site-SynthDigits| Val  Loss: 1.2947 | Val  Acc: 0.5676
Average Valid Accuracy: 0.6689
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3784
 Best site-USPS       | Epoch:8 | Val Acc: 0.8649
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5541
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4059 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.4731 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 1.8080 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.7825 | Train Acc: 0.3694
 Site-USPS      | Train Loss: 0.4905 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.5515 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.2388 | Train Acc: 0.6396
 Site-SynthDigits| Train Loss: 1.2508 | Train Acc: 0.5676
 Site-MNIST     | Val  Loss: 0.4526 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.4720 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.8937 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.7008 | Val  Acc: 0.3919
 Site-USPS      | Val  Loss: 0.5432 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.5000 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.2595 | Val  Acc: 0.5541
 Site-SynthDigits| Val  Loss: 1.2431 | Val  Acc: 0.5811
Average Valid Accuracy: 0.6807
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3919
 Best site-USPS       | Epoch:9 | Val Acc: 0.8784
 Best site-USPS       | Epoch:9 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5541
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_MNIST-M...
===2023-03-26 08:03:00===
===2023-03-26 08:03:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8321
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2972
 Test site-USPS      | Epoch:9 | Test Acc: 0.8656
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5408
Average Test Accuracy: 0.6339
===2023-03-26 12:06:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of MNIST-M: 0.2621
Average Test Accuracy: 0.2621
