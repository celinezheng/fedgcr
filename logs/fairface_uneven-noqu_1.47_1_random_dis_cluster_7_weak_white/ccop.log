===2023-06-15 11:39:27===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 8, 13, 1, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.1791 | Train Acc: 0.0833
 Site-White_utk                 (4) | Train Loss: 2.1892 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.2624 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2818 | Train Acc: 0.0789
 Site-White_utk                 (4) | Train Loss: 2.2507 | Train Acc: 0.0893
 Site-White_utk                 (4) | Train Loss: 2.2254 | Train Acc: 0.1341
 Site-White_utk                 (4) | Train Loss: 2.1983 | Train Acc: 0.1240
 Site-White_utk                 (4) | Train Loss: 2.2110 | Train Acc: 0.1061
 Site-White_utk                 (4) | Train Loss: 2.2412 | Train Acc: 0.1027
 Site-White_utk                 (4) | Train Loss: 2.2068 | Train Acc: 0.1111
 Site-East_Asian                (3) | Train Loss: 1.8917 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.9416 | Train Acc: 0.4500
 Site-East_Asian                (2) | Train Loss: 1.9573 | Train Acc: 0.3559
 Site-East_Asian                (3) | Train Loss: 1.9491 | Train Acc: 0.3605
 Site-East_Asian                (3) | Train Loss: 1.9426 | Train Acc: 0.3937
 Site-East_Asian                (3) | Train Loss: 1.9654 | Train Acc: 0.3636
 Site-East_Asian                (3) | Train Loss: 1.8997 | Train Acc: 0.4058
 Site-Indian_utk                (5) | Train Loss: 2.0312 | Train Acc: 0.3256
 Site-Indian_utk                (4) | Train Loss: 1.9294 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 2.0111 | Train Acc: 0.3085
 Site-Indian_utk                (4) | Train Loss: 1.9749 | Train Acc: 0.3597
 Site-Indian_utk                (4) | Train Loss: 2.0242 | Train Acc: 0.3366
 Site-Black_utk                 (6) | Train Loss: 1.9781 | Train Acc: 0.3273
 Site-Black_utk                 (6) | Train Loss: 1.9903 | Train Acc: 0.2963
 Site-Black_utk                 (6) | Train Loss: 2.0229 | Train Acc: 0.2437
 Site-Southeast_Asian           (3) | Train Loss: 2.0387 | Train Acc: 0.3333
 Site-Southeast_Asian           (3) | Train Loss: 2.0560 | Train Acc: 0.2867
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6970 | Train Acc: 0.4709
 Site-White_ffhq                (1) | Train Loss: 1.6309 | Train Acc: 0.7692
Average Train Accuracy: 0.2864
 Site-White_utk                 (0) | Val  Loss: 2.1880 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.2854 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.2108 | Val  Acc: 0.1176
 Site-White_utk                 (4) | Val  Loss: 2.2204 | Val  Acc: 0.1600
 Site-White_utk                 (4) | Val  Loss: 2.2153 | Val  Acc: 0.1081
 Site-White_utk                 (4) | Val  Loss: 2.1810 | Val  Acc: 0.0727
 Site-White_utk                 (4) | Val  Loss: 2.1924 | Val  Acc: 0.0988
 Site-White_utk                 (4) | Val  Loss: 2.2264 | Val  Acc: 0.1008
 Site-White_utk                 (4) | Val  Loss: 2.2136 | Val  Acc: 0.1086
 Site-White_utk                 (4) | Val  Loss: 2.3069 | Val  Acc: 0.1085
 Site-East_Asian                (3) | Val  Loss: 2.1019 | Val  Acc: 0.1111
 Site-East_Asian                (3) | Val  Loss: 1.9497 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.9587 | Val  Acc: 0.3846
 Site-East_Asian                (3) | Val  Loss: 1.9246 | Val  Acc: 0.3860
 Site-East_Asian                (3) | Val  Loss: 1.9458 | Val  Acc: 0.4235
 Site-East_Asian                (3) | Val  Loss: 1.9058 | Val  Acc: 0.4240
 Site-East_Asian                (3) | Val  Loss: 1.9310 | Val  Acc: 0.3859
 Site-Indian_utk                (5) | Val  Loss: 1.9785 | Val  Acc: 0.3793
 Site-Indian_utk                (4) | Val  Loss: 2.0199 | Val  Acc: 0.3256
 Site-Indian_utk                (4) | Val  Loss: 2.0017 | Val  Acc: 0.3651
 Site-Indian_utk                (4) | Val  Loss: 2.0341 | Val  Acc: 0.2935
 Site-Indian_utk                (4) | Val  Loss: 1.9134 | Val  Acc: 0.3529
 Site-Black_utk                 (6) | Val  Loss: 1.9965 | Val  Acc: 0.3333
 Site-Black_utk                 (6) | Val  Loss: 1.9849 | Val  Acc: 0.2963
 Site-Black_utk                 (6) | Val  Loss: 1.9648 | Val  Acc: 0.3291
 Site-Southeast_Asian           (3) | Val  Loss: 2.2259 | Val  Acc: 0.2647
 Site-Southeast_Asian           (3) | Val  Loss: 2.0634 | Val  Acc: 0.3100
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.9695 | Val  Acc: 0.1652
 Site-White_ffhq                (1) | Val  Loss: 1.4914 | Val  Acc: 0.9103
Average Valid Accuracy: 0.2730
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0909
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1600
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1081
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0727
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0988
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1008
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1086
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1085
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.1111
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3846
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3846
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3860
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4235
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4240
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3859
 Best site-Indian_utk               (5)  | Epoch:0 | Val Acc: 0.3793
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3256
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3651
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2935
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3529
 Best site-Black_utk                (6)  | Epoch:0 | Val Acc: 0.3333
 Best site-Black_utk                (6)  | Epoch:0 | Val Acc: 0.2963
 Best site-Black_utk                (6)  | Epoch:0 | Val Acc: 0.3291
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2647
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3100
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:0 | Val Acc: 0.1652
 Best site-White_ffhq               (1)  | Epoch:0 | Val Acc: 0.9103
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 2, 5, 9, 3, 7, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (0) | Train Loss: 1.9813 | Train Acc: 0.0833
 Site-White_utk                 (3) | Train Loss: 2.1877 | Train Acc: 0.1176
 Site-White_utk                 (3) | Train Loss: 2.2088 | Train Acc: 0.1154
 Site-White_utk                 (3) | Train Loss: 2.2552 | Train Acc: 0.1053
 Site-White_utk                 (3) | Train Loss: 2.2100 | Train Acc: 0.0893
 Site-White_utk                 (3) | Train Loss: 2.2206 | Train Acc: 0.1098
 Site-White_utk                 (3) | Train Loss: 2.1900 | Train Acc: 0.1240
 Site-White_utk                 (3) | Train Loss: 2.1910 | Train Acc: 0.1173
 Site-White_utk                 (3) | Train Loss: 2.1187 | Train Acc: 0.1141
 Site-White_utk                 (3) | Train Loss: 2.2295 | Train Acc: 0.1163
 Site-East_Asian                (5) | Train Loss: 1.7964 | Train Acc: 0.3704
 Site-East_Asian                (5) | Train Loss: 1.8247 | Train Acc: 0.4750
 Site-East_Asian                (5) | Train Loss: 1.8596 | Train Acc: 0.3729
 Site-East_Asian                (5) | Train Loss: 1.9793 | Train Acc: 0.3372
 Site-East_Asian                (5) | Train Loss: 1.8652 | Train Acc: 0.3937
 Site-East_Asian                (5) | Train Loss: 1.8846 | Train Acc: 0.3690
 Site-East_Asian                (5) | Train Loss: 1.8217 | Train Acc: 0.3877
 Site-Indian_utk                (2) | Train Loss: 1.9495 | Train Acc: 0.3023
 Site-Indian_utk                (2) | Train Loss: 1.8849 | Train Acc: 0.3906
 Site-Indian_utk                (2) | Train Loss: 1.9537 | Train Acc: 0.3404
 Site-Indian_utk                (2) | Train Loss: 1.8840 | Train Acc: 0.3237
 Site-Indian_utk                (2) | Train Loss: 1.9298 | Train Acc: 0.3366
 Site-Black_utk                 (4) | Train Loss: 1.8788 | Train Acc: 0.3273
 Site-Black_utk                 (4) | Train Loss: 1.9911 | Train Acc: 0.3333
 Site-Black_utk                 (4) | Train Loss: 1.9425 | Train Acc: 0.3193
 Site-Southeast_Asian           (1) | Train Loss: 1.9692 | Train Acc: 0.3235
 Site-Southeast_Asian           (1) | Train Loss: 2.0025 | Train Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.6096 | Train Acc: 0.4593
 Site-White_ffhq                (6) | Train Loss: 1.5358 | Train Acc: 0.7949
Average Train Accuracy: 0.2879
 Site-White_utk                 (0) | Val  Loss: 2.1209 | Val  Acc: 0.2500
 Site-White_utk                 (3) | Val  Loss: 2.1891 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.1594 | Val  Acc: 0.1176
 Site-White_utk                 (3) | Val  Loss: 2.2113 | Val  Acc: 0.1200
 Site-White_utk                 (3) | Val  Loss: 2.1749 | Val  Acc: 0.1081
 Site-White_utk                 (3) | Val  Loss: 2.1778 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.1838 | Val  Acc: 0.0988
 Site-White_utk                 (3) | Val  Loss: 2.2007 | Val  Acc: 0.1008
 Site-White_utk                 (3) | Val  Loss: 2.1882 | Val  Acc: 0.1029
 Site-White_utk                 (3) | Val  Loss: 2.2515 | Val  Acc: 0.1124
 Site-East_Asian                (5) | Val  Loss: 2.0566 | Val  Acc: 0.2222
 Site-East_Asian                (5) | Val  Loss: 1.8823 | Val  Acc: 0.4231
 Site-East_Asian                (5) | Val  Loss: 1.8885 | Val  Acc: 0.4103
 Site-East_Asian                (5) | Val  Loss: 1.8522 | Val  Acc: 0.3860
 Site-East_Asian                (5) | Val  Loss: 1.8916 | Val  Acc: 0.4118
 Site-East_Asian                (5) | Val  Loss: 1.8316 | Val  Acc: 0.4080
 Site-East_Asian                (5) | Val  Loss: 1.8580 | Val  Acc: 0.3804
 Site-Indian_utk                (2) | Val  Loss: 1.9337 | Val  Acc: 0.3103
 Site-Indian_utk                (2) | Val  Loss: 1.9296 | Val  Acc: 0.3721
 Site-Indian_utk                (2) | Val  Loss: 1.9264 | Val  Acc: 0.3651
 Site-Indian_utk                (2) | Val  Loss: 1.9261 | Val  Acc: 0.3478
 Site-Indian_utk                (2) | Val  Loss: 1.8549 | Val  Acc: 0.3603
 Site-Black_utk                 (4) | Val  Loss: 1.9291 | Val  Acc: 0.3611
 Site-Black_utk                 (4) | Val  Loss: 1.9231 | Val  Acc: 0.3704
 Site-Black_utk                 (4) | Val  Loss: 1.9168 | Val  Acc: 0.3544
 Site-Southeast_Asian           (1) | Val  Loss: 2.1762 | Val  Acc: 0.2941
 Site-Southeast_Asian           (1) | Val  Loss: 2.0297 | Val  Acc: 0.2900
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.9190 | Val  Acc: 0.1652
 Site-White_ffhq                (6) | Val  Loss: 1.3703 | Val  Acc: 0.9615
Average Valid Accuracy: 0.2892
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.2500
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1176
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1200
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1081
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0988
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1029
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1124
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.2222
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.4231
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.4103
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.3860
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.4118
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.4080
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.3804
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3103
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3721
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3651
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3478
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3603
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3611
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3704
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3544
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2941
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2900
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:1 | Val Acc: 0.1652
 Best site-White_ffhq               (6)  | Epoch:1 | Val Acc: 0.9615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1...
============ Train epoch 2 ============
cnt=[8, 8, 2, 8, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (5) | Train Loss: 1.9347 | Train Acc: 0.2500
 Site-White_utk                 (4) | Train Loss: 2.1122 | Train Acc: 0.1765
 Site-White_utk                 (3) | Train Loss: 2.0895 | Train Acc: 0.1154
 Site-White_utk                 (3) | Train Loss: 2.2288 | Train Acc: 0.1316
 Site-White_utk                 (3) | Train Loss: 2.1101 | Train Acc: 0.1429
 Site-White_utk                 (3) | Train Loss: 2.0733 | Train Acc: 0.1463
 Site-White_utk                 (3) | Train Loss: 2.1192 | Train Acc: 0.1157
 Site-White_utk                 (3) | Train Loss: 2.1475 | Train Acc: 0.1285
 Site-White_utk                 (3) | Train Loss: 2.0887 | Train Acc: 0.1293
 Site-White_utk                 (3) | Train Loss: 2.0954 | Train Acc: 0.1395
 Site-East_Asian                (6) | Train Loss: 1.7630 | Train Acc: 0.4074
 Site-East_Asian                (0) | Train Loss: 1.8327 | Train Acc: 0.4750
 Site-East_Asian                (0) | Train Loss: 1.8504 | Train Acc: 0.3559
 Site-East_Asian                (0) | Train Loss: 1.8959 | Train Acc: 0.3488
 Site-East_Asian                (0) | Train Loss: 1.8417 | Train Acc: 0.3937
 Site-East_Asian                (0) | Train Loss: 1.8583 | Train Acc: 0.3797
 Site-East_Asian                (0) | Train Loss: 1.8250 | Train Acc: 0.4022
 Site-Indian_utk                (1) | Train Loss: 1.9000 | Train Acc: 0.3256
 Site-Indian_utk                (1) | Train Loss: 1.8384 | Train Acc: 0.4062
 Site-Indian_utk                (1) | Train Loss: 1.9208 | Train Acc: 0.3511
 Site-Indian_utk                (1) | Train Loss: 1.9130 | Train Acc: 0.3669
 Site-Indian_utk                (1) | Train Loss: 1.9053 | Train Acc: 0.3512
 Site-Black_utk                 (1) | Train Loss: 1.8496 | Train Acc: 0.3636
 Site-Black_utk                 (1) | Train Loss: 2.0015 | Train Acc: 0.3333
 Site-Black_utk                 (1) | Train Loss: 1.9576 | Train Acc: 0.2773
 Site-Southeast_Asian           (0) | Train Loss: 1.9163 | Train Acc: 0.3235
 Site-Southeast_Asian           (0) | Train Loss: 1.9672 | Train Acc: 0.2933
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6322 | Train Acc: 0.4826
 Site-White_ffhq                (2) | Train Loss: 1.5355 | Train Acc: 0.7863
Average Train Accuracy: 0.3069
 Site-White_utk                 (5) | Val  Loss: 2.1116 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.1159 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.0610 | Val  Acc: 0.1765
 Site-White_utk                 (3) | Val  Loss: 2.1436 | Val  Acc: 0.1200
 Site-White_utk                 (3) | Val  Loss: 2.1504 | Val  Acc: 0.1081
 Site-White_utk                 (3) | Val  Loss: 2.0869 | Val  Acc: 0.1455
 Site-White_utk                 (3) | Val  Loss: 2.1162 | Val  Acc: 0.1481
 Site-White_utk                 (3) | Val  Loss: 2.1448 | Val  Acc: 0.1261
 Site-White_utk                 (3) | Val  Loss: 2.1368 | Val  Acc: 0.1200
 Site-White_utk                 (3) | Val  Loss: 2.2124 | Val  Acc: 0.1357
 Site-East_Asian                (6) | Val  Loss: 2.0183 | Val  Acc: 0.2222
 Site-East_Asian                (0) | Val  Loss: 1.8549 | Val  Acc: 0.4231
 Site-East_Asian                (0) | Val  Loss: 1.9014 | Val  Acc: 0.4103
 Site-East_Asian                (0) | Val  Loss: 1.8206 | Val  Acc: 0.4211
 Site-East_Asian                (0) | Val  Loss: 1.8434 | Val  Acc: 0.4353
 Site-East_Asian                (0) | Val  Loss: 1.7922 | Val  Acc: 0.4160
 Site-East_Asian                (0) | Val  Loss: 1.8340 | Val  Acc: 0.3859
 Site-Indian_utk                (1) | Val  Loss: 1.9064 | Val  Acc: 0.3103
 Site-Indian_utk                (1) | Val  Loss: 1.8514 | Val  Acc: 0.3488
 Site-Indian_utk                (1) | Val  Loss: 1.8984 | Val  Acc: 0.3810
 Site-Indian_utk                (1) | Val  Loss: 1.9492 | Val  Acc: 0.3370
 Site-Indian_utk                (1) | Val  Loss: 1.8419 | Val  Acc: 0.3456
 Site-Black_utk                 (1) | Val  Loss: 1.9067 | Val  Acc: 0.3056
 Site-Black_utk                 (1) | Val  Loss: 1.9175 | Val  Acc: 0.3148
 Site-Black_utk                 (1) | Val  Loss: 1.9335 | Val  Acc: 0.3544
 Site-Southeast_Asian           (0) | Val  Loss: 2.2068 | Val  Acc: 0.2941
 Site-Southeast_Asian           (0) | Val  Loss: 1.9788 | Val  Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9312 | Val  Acc: 0.1739
 Site-White_ffhq                (2) | Val  Loss: 1.3644 | Val  Acc: 0.9615
Average Valid Accuracy: 0.2909
 Best site-White_utk                (5)  | Epoch:2 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1765
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1200
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1081
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1455
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1481
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1261
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1200
 Best site-White_utk                (3)  | Epoch:2 | Val Acc: 0.1357
 Best site-East_Asian               (6)  | Epoch:2 | Val Acc: 0.2222
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.4231
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.4103
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.4211
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.4353
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.4160
 Best site-East_Asian               (0)  | Epoch:2 | Val Acc: 0.3859
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3103
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3488
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3810
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3370
 Best site-Indian_utk               (1)  | Epoch:2 | Val Acc: 0.3456
 Best site-Black_utk                (1)  | Epoch:2 | Val Acc: 0.3056
 Best site-Black_utk                (1)  | Epoch:2 | Val Acc: 0.3148
 Best site-Black_utk                (1)  | Epoch:2 | Val Acc: 0.3544
 Best site-Southeast_Asian          (0)  | Epoch:2 | Val Acc: 0.2941
 Best site-Southeast_Asian          (0)  | Epoch:2 | Val Acc: 0.3000
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:2 | Val Acc: 0.1739
 Best site-White_ffhq               (2)  | Epoch:2 | Val Acc: 0.9615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1...
============ Train epoch 3 ============
cnt=[9, 2, 2, 3, 1, 3, 9, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (4) | Train Loss: 1.9110 | Train Acc: 0.3333
 Site-White_utk                 (6) | Train Loss: 2.0320 | Train Acc: 0.2353
 Site-White_utk                 (6) | Train Loss: 2.0586 | Train Acc: 0.1923
 Site-White_utk                 (6) | Train Loss: 2.1352 | Train Acc: 0.0789
 Site-White_utk                 (6) | Train Loss: 2.0779 | Train Acc: 0.1786
 Site-White_utk                 (6) | Train Loss: 2.0652 | Train Acc: 0.1951
 Site-White_utk                 (6) | Train Loss: 2.0201 | Train Acc: 0.1983
 Site-White_utk                 (6) | Train Loss: 2.0855 | Train Acc: 0.1788
 Site-White_utk                 (6) | Train Loss: 2.0922 | Train Acc: 0.1521
 Site-White_utk                 (6) | Train Loss: 1.9529 | Train Acc: 0.1809
 Site-East_Asian                (0) | Train Loss: 1.7640 | Train Acc: 0.4074
 Site-East_Asian                (0) | Train Loss: 1.7615 | Train Acc: 0.4750
 Site-East_Asian                (0) | Train Loss: 1.8252 | Train Acc: 0.3390
 Site-East_Asian                (0) | Train Loss: 1.8678 | Train Acc: 0.3488
 Site-East_Asian                (0) | Train Loss: 1.8021 | Train Acc: 0.4016
 Site-East_Asian                (0) | Train Loss: 1.8287 | Train Acc: 0.3690
 Site-East_Asian                (0) | Train Loss: 1.7549 | Train Acc: 0.4130
 Site-Indian_utk                (1) | Train Loss: 1.8861 | Train Acc: 0.3256
 Site-Indian_utk                (1) | Train Loss: 1.7783 | Train Acc: 0.4375
 Site-Indian_utk                (3) | Train Loss: 1.8928 | Train Acc: 0.3404
 Site-Indian_utk                (3) | Train Loss: 1.8492 | Train Acc: 0.3813
 Site-Indian_utk                (3) | Train Loss: 1.8653 | Train Acc: 0.3610
 Site-Black_utk                 (5) | Train Loss: 1.8278 | Train Acc: 0.4545
 Site-Black_utk                 (5) | Train Loss: 1.8972 | Train Acc: 0.2963
 Site-Black_utk                 (5) | Train Loss: 1.8889 | Train Acc: 0.3361
 Site-Southeast_Asian           (0) | Train Loss: 1.9670 | Train Acc: 0.3137
 Site-Southeast_Asian           (0) | Train Loss: 1.9472 | Train Acc: 0.3133
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6259 | Train Acc: 0.4709
 Site-White_ffhq                (2) | Train Loss: 1.5367 | Train Acc: 0.7521
Average Train Accuracy: 0.3262
 Site-White_utk                 (4) | Val  Loss: 1.9395 | Val  Acc: 0.2500
 Site-White_utk                 (6) | Val  Loss: 2.0184 | Val  Acc: 0.1818
 Site-White_utk                 (6) | Val  Loss: 2.0560 | Val  Acc: 0.1176
 Site-White_utk                 (6) | Val  Loss: 2.0881 | Val  Acc: 0.0800
 Site-White_utk                 (6) | Val  Loss: 2.0673 | Val  Acc: 0.1892
 Site-White_utk                 (6) | Val  Loss: 2.0557 | Val  Acc: 0.1636
 Site-White_utk                 (6) | Val  Loss: 2.0512 | Val  Acc: 0.1481
 Site-White_utk                 (6) | Val  Loss: 2.0797 | Val  Acc: 0.1681
 Site-White_utk                 (6) | Val  Loss: 2.0753 | Val  Acc: 0.1657
 Site-White_utk                 (6) | Val  Loss: 2.0872 | Val  Acc: 0.1860
 Site-East_Asian                (0) | Val  Loss: 1.9411 | Val  Acc: 0.2222
 Site-East_Asian                (0) | Val  Loss: 1.7703 | Val  Acc: 0.4231
 Site-East_Asian                (0) | Val  Loss: 1.8613 | Val  Acc: 0.3846
 Site-East_Asian                (0) | Val  Loss: 1.7905 | Val  Acc: 0.3860
 Site-East_Asian                (0) | Val  Loss: 1.8367 | Val  Acc: 0.4353
 Site-East_Asian                (0) | Val  Loss: 1.7703 | Val  Acc: 0.4160
 Site-East_Asian                (0) | Val  Loss: 1.7989 | Val  Acc: 0.3913
 Site-Indian_utk                (1) | Val  Loss: 1.8791 | Val  Acc: 0.3448
 Site-Indian_utk                (1) | Val  Loss: 1.8144 | Val  Acc: 0.4186
 Site-Indian_utk                (3) | Val  Loss: 1.8542 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 1.8663 | Val  Acc: 0.3370
 Site-Indian_utk                (3) | Val  Loss: 1.7912 | Val  Acc: 0.3603
 Site-Black_utk                 (5) | Val  Loss: 1.8555 | Val  Acc: 0.3056
 Site-Black_utk                 (5) | Val  Loss: 1.8929 | Val  Acc: 0.2963
 Site-Black_utk                 (5) | Val  Loss: 1.9004 | Val  Acc: 0.3165
 Site-Southeast_Asian           (0) | Val  Loss: 2.0356 | Val  Acc: 0.3088
 Site-Southeast_Asian           (0) | Val  Loss: 1.9499 | Val  Acc: 0.3200
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9061 | Val  Acc: 0.1913
 Site-White_ffhq                (2) | Val  Loss: 1.4086 | Val  Acc: 0.8333
Average Valid Accuracy: 0.3002
 Best site-White_utk                (4)  | Epoch:3 | Val Acc: 0.2500
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1818
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1176
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.0800
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1892
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1636
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1481
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1681
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1657
 Best site-White_utk                (6)  | Epoch:3 | Val Acc: 0.1860
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.2222
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.4231
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.3846
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.3860
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.4353
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.4160
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.3913
 Best site-Indian_utk               (1)  | Epoch:3 | Val Acc: 0.3448
 Best site-Indian_utk               (1)  | Epoch:3 | Val Acc: 0.4186
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3651
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3370
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3603
 Best site-Black_utk                (5)  | Epoch:3 | Val Acc: 0.3056
 Best site-Black_utk                (5)  | Epoch:3 | Val Acc: 0.2963
 Best site-Black_utk                (5)  | Epoch:3 | Val Acc: 0.3165
 Best site-Southeast_Asian          (0)  | Epoch:3 | Val Acc: 0.3088
 Best site-Southeast_Asian          (0)  | Epoch:3 | Val Acc: 0.3200
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:3 | Val Acc: 0.1913
 Best site-White_ffhq               (2)  | Epoch:3 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1...
============ Train epoch 4 ============
cnt=[12, 8, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk                 (0) | Train Loss: 1.7425 | Train Acc: 0.4167
 Site-White_utk                 (6) | Train Loss: 1.8662 | Train Acc: 0.2941
 Site-White_utk                 (0) | Train Loss: 1.8680 | Train Acc: 0.3077
 Site-White_utk                 (0) | Train Loss: 2.0271 | Train Acc: 0.1842
 Site-White_utk                 (0) | Train Loss: 1.9135 | Train Acc: 0.2679
 Site-White_utk                 (0) | Train Loss: 1.9482 | Train Acc: 0.2927
 Site-White_utk                 (0) | Train Loss: 1.9302 | Train Acc: 0.2479
 Site-White_utk                 (0) | Train Loss: 1.9458 | Train Acc: 0.2793
 Site-White_utk                 (0) | Train Loss: 1.9628 | Train Acc: 0.2548
 Site-White_utk                 (0) | Train Loss: 1.9177 | Train Acc: 0.2842
 Site-East_Asian                (1) | Train Loss: 1.6588 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.6815 | Train Acc: 0.5000
 Site-East_Asian                (4) | Train Loss: 1.8272 | Train Acc: 0.3559
 Site-East_Asian                (1) | Train Loss: 1.7656 | Train Acc: 0.3488
 Site-East_Asian                (1) | Train Loss: 1.7556 | Train Acc: 0.4252
 Site-East_Asian                (1) | Train Loss: 1.7848 | Train Acc: 0.3529
 Site-East_Asian                (1) | Train Loss: 1.7315 | Train Acc: 0.4130
 Site-Indian_utk                (3) | Train Loss: 1.7965 | Train Acc: 0.3488
 Site-Indian_utk                (3) | Train Loss: 1.7915 | Train Acc: 0.4531
 Site-Indian_utk                (3) | Train Loss: 1.8389 | Train Acc: 0.3085
 Site-Indian_utk                (3) | Train Loss: 1.8022 | Train Acc: 0.3885
 Site-Indian_utk                (3) | Train Loss: 1.8494 | Train Acc: 0.3659
 Site-Black_utk                 (0) | Train Loss: 1.7720 | Train Acc: 0.4909
 Site-Black_utk                 (0) | Train Loss: 1.8925 | Train Acc: 0.2593
 Site-Black_utk                 (0) | Train Loss: 1.8862 | Train Acc: 0.2941
 Site-Southeast_Asian           (1) | Train Loss: 1.8932 | Train Acc: 0.3333
 Site-Southeast_Asian           (1) | Train Loss: 1.9247 | Train Acc: 0.3267
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6509 | Train Acc: 0.4535
 Site-White_ffhq                (5) | Train Loss: 1.6529 | Train Acc: 0.5128
Average Train Accuracy: 0.3532
 Site-White_utk                 (0) | Val  Loss: 1.8884 | Val  Acc: 0.2500
 Site-White_utk                 (6) | Val  Loss: 1.8360 | Val  Acc: 0.2727
 Site-White_utk                 (0) | Val  Loss: 1.9384 | Val  Acc: 0.2353
 Site-White_utk                 (0) | Val  Loss: 1.9581 | Val  Acc: 0.2800
 Site-White_utk                 (0) | Val  Loss: 1.9495 | Val  Acc: 0.2973
 Site-White_utk                 (0) | Val  Loss: 1.9134 | Val  Acc: 0.2727
 Site-White_utk                 (0) | Val  Loss: 2.0077 | Val  Acc: 0.1975
 Site-White_utk                 (0) | Val  Loss: 1.9342 | Val  Acc: 0.2689
 Site-White_utk                 (0) | Val  Loss: 1.9818 | Val  Acc: 0.2286
 Site-White_utk                 (0) | Val  Loss: 2.0020 | Val  Acc: 0.2403
 Site-East_Asian                (1) | Val  Loss: 1.8149 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.7350 | Val  Acc: 0.4615
 Site-East_Asian                (4) | Val  Loss: 1.7710 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.7440 | Val  Acc: 0.3860
 Site-East_Asian                (1) | Val  Loss: 1.7677 | Val  Acc: 0.3882
 Site-East_Asian                (1) | Val  Loss: 1.7167 | Val  Acc: 0.4240
 Site-East_Asian                (1) | Val  Loss: 1.7465 | Val  Acc: 0.4565
 Site-Indian_utk                (3) | Val  Loss: 1.7603 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.7561 | Val  Acc: 0.3256
 Site-Indian_utk                (3) | Val  Loss: 1.8202 | Val  Acc: 0.3810
 Site-Indian_utk                (3) | Val  Loss: 1.8555 | Val  Acc: 0.3587
 Site-Indian_utk                (3) | Val  Loss: 1.7559 | Val  Acc: 0.3676
 Site-Black_utk                 (0) | Val  Loss: 1.7621 | Val  Acc: 0.5556
 Site-Black_utk                 (0) | Val  Loss: 1.8747 | Val  Acc: 0.3148
 Site-Black_utk                 (0) | Val  Loss: 1.8465 | Val  Acc: 0.3418
 Site-Southeast_Asian           (1) | Val  Loss: 1.9504 | Val  Acc: 0.2794
 Site-Southeast_Asian           (1) | Val  Loss: 1.9446 | Val  Acc: 0.2600
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8531 | Val  Acc: 0.2957
 Site-White_ffhq                (5) | Val  Loss: 1.5779 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3396
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2500
 Best site-White_utk                (6)  | Epoch:4 | Val Acc: 0.2727
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2353
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2800
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2973
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2727
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.1975
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2689
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2286
 Best site-White_utk                (0)  | Epoch:4 | Val Acc: 0.2403
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.3333
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4615
 Best site-East_Asian               (4)  | Epoch:4 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.3860
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.3882
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4240
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4565
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.3103
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.3256
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.3810
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.3587
 Best site-Indian_utk               (3)  | Epoch:4 | Val Acc: 0.3676
 Best site-Black_utk                (0)  | Epoch:4 | Val Acc: 0.5556
 Best site-Black_utk                (0)  | Epoch:4 | Val Acc: 0.3148
 Best site-Black_utk                (0)  | Epoch:4 | Val Acc: 0.3418
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.2794
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.2600
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:4 | Val Acc: 0.2957
 Best site-White_ffhq               (5)  | Epoch:4 | Val Acc: 0.6026
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_7_weak_white/ccop_q=1...
============ Train epoch 5 ============
