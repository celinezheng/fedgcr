===2023-03-30 11:35:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7378 | Train Acc: 0.5556
 Site-MNIST     | Train Loss: 1.6250 | Train Acc: 0.6984
 Site-MNIST     | Train Loss: 1.6737 | Train Acc: 0.5556
 Site-MNIST     | Train Loss: 1.6878 | Train Acc: 0.6032
 Site-MNIST     | Train Loss: 1.5707 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.6657 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.6714 | Train Acc: 0.6190
 Site-SVHN      | Train Loss: 2.2338 | Train Acc: 0.1429
 Site-USPS      | Train Loss: 1.7945 | Train Acc: 0.5397
 Site-MNIST-M   | Train Loss: 2.2091 | Train Acc: 0.2222
 Site-MNIST     | Val  Loss: 1.6243 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.5995 | Val  Acc: 0.5952
 Site-MNIST     | Val  Loss: 1.6614 | Val  Acc: 0.6429
 Site-MNIST     | Val  Loss: 1.7309 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6470 | Val  Acc: 0.5952
 Site-MNIST     | Val  Loss: 1.5493 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.7930 | Val  Acc: 0.5952
 Site-SVHN      | Val  Loss: 2.3030 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 1.8271 | Val  Acc: 0.4524
 Site-MNIST-M   | Val  Loss: 2.2596 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4976
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5952
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5952
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5952
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1667
 Best site-USPS       | Epoch:0 | Val Acc: 0.4524
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2843 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.1328 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.2077 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.2300 | Train Acc: 0.7302
 Site-MNIST     | Train Loss: 1.0809 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.1736 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 1.2198 | Train Acc: 0.7143
 Site-SVHN      | Train Loss: 2.1661 | Train Acc: 0.2222
 Site-USPS      | Train Loss: 1.3956 | Train Acc: 0.6349
 Site-MNIST-M   | Train Loss: 2.0836 | Train Acc: 0.3016
 Site-MNIST     | Val  Loss: 1.1021 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 1.1297 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.2000 | Val  Acc: 0.7381
 Site-MNIST     | Val  Loss: 1.2558 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.1738 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.0935 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.3080 | Val  Acc: 0.6429
 Site-SVHN      | Val  Loss: 2.3129 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.4386 | Val  Acc: 0.5952
 Site-MNIST-M   | Val  Loss: 2.1845 | Val  Acc: 0.1667
Average Valid Accuracy: 0.5810
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7381
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6429
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1429
 Best site-USPS       | Epoch:1 | Val Acc: 0.5952
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8338 | Train Acc: 0.7302
 Site-MNIST     | Train Loss: 0.7374 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.8126 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 0.8061 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.6855 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7231 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.8069 | Train Acc: 0.7937
 Site-SVHN      | Train Loss: 2.1516 | Train Acc: 0.1746
 Site-USPS      | Train Loss: 0.9728 | Train Acc: 0.7619
 Site-MNIST-M   | Train Loss: 1.9332 | Train Acc: 0.3968
 Site-MNIST     | Val  Loss: 0.6997 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7048 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.7765 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.8425 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 0.8108 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.7086 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.8712 | Val  Acc: 0.6905
 Site-SVHN      | Val  Loss: 2.4021 | Val  Acc: 0.0714
 Site-USPS      | Val  Loss: 0.9977 | Val  Acc: 0.7619
 Site-MNIST-M   | Val  Loss: 2.1286 | Val  Acc: 0.2619
Average Valid Accuracy: 0.6786
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6905
 Best site-SVHN       | Epoch:2 | Val Acc: 0.0714
 Best site-USPS       | Epoch:2 | Val Acc: 0.7619
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4875 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4633 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 0.4862 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4720 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3791 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4201 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.5155 | Train Acc: 0.8571
 Site-SVHN      | Train Loss: 2.0057 | Train Acc: 0.2540
 Site-USPS      | Train Loss: 0.7355 | Train Acc: 0.8413
 Site-MNIST-M   | Train Loss: 1.7442 | Train Acc: 0.3810
 Site-MNIST     | Val  Loss: 0.3918 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3800 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4499 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5051 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.4838 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4461 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.5372 | Val  Acc: 0.8095
 Site-SVHN      | Val  Loss: 2.3288 | Val  Acc: 0.1190
 Site-USPS      | Val  Loss: 0.7577 | Val  Acc: 0.8095
 Site-MNIST-M   | Val  Loss: 2.0487 | Val  Acc: 0.2619
Average Valid Accuracy: 0.7452
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8095
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1190
 Best site-USPS       | Epoch:3 | Val Acc: 0.8095
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3025 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.2793 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.2855 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2987 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2260 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.2392 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.3111 | Train Acc: 0.9206
 Site-SVHN      | Train Loss: 1.9719 | Train Acc: 0.2540
 Site-USPS      | Train Loss: 0.5655 | Train Acc: 0.8571
 Site-MNIST-M   | Train Loss: 1.5315 | Train Acc: 0.4603
 Site-MNIST     | Val  Loss: 0.2407 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2227 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.2759 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3062 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.2825 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2835 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3067 | Val  Acc: 0.9286
 Site-SVHN      | Val  Loss: 2.4025 | Val  Acc: 0.1190
 Site-USPS      | Val  Loss: 0.5684 | Val  Acc: 0.8571
 Site-MNIST-M   | Val  Loss: 2.0094 | Val  Acc: 0.3333
Average Valid Accuracy: 0.7952
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1190
 Best site-USPS       | Epoch:4 | Val Acc: 0.8571
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1909 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1687 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.1939 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1903 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1218 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1320 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1746 | Train Acc: 0.9683
 Site-SVHN      | Train Loss: 1.6967 | Train Acc: 0.3651
 Site-USPS      | Train Loss: 0.4027 | Train Acc: 0.8730
 Site-MNIST-M   | Train Loss: 1.2186 | Train Acc: 0.6190
 Site-MNIST     | Val  Loss: 0.1400 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1223 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1776 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1957 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1867 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1666 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1856 | Val  Acc: 0.9286
 Site-SVHN      | Val  Loss: 2.2563 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 0.4674 | Val  Acc: 0.8571
 Site-MNIST-M   | Val  Loss: 1.8764 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8167
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1667
 Best site-USPS       | Epoch:5 | Val Acc: 0.8571
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1372 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1324 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1367 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1236 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.0753 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0883 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1279 | Train Acc: 0.9683
 Site-SVHN      | Train Loss: 1.5731 | Train Acc: 0.4286
 Site-USPS      | Train Loss: 0.3402 | Train Acc: 0.9048
 Site-MNIST-M   | Train Loss: 1.0194 | Train Acc: 0.7460
 Site-MNIST     | Val  Loss: 0.0916 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0740 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1127 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1404 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1209 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1245 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1456 | Val  Acc: 0.9524
 Site-SVHN      | Val  Loss: 2.1791 | Val  Acc: 0.2143
 Site-USPS      | Val  Loss: 0.4089 | Val  Acc: 0.8810
 Site-MNIST-M   | Val  Loss: 1.7927 | Val  Acc: 0.4524
Average Valid Accuracy: 0.8405
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9524
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2143
 Best site-USPS       | Epoch:6 | Val Acc: 0.8810
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0859 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0848 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1076 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1110 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0740 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0716 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0927 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.4483 | Train Acc: 0.4286
 Site-USPS      | Train Loss: 0.2559 | Train Acc: 0.9841
 Site-MNIST-M   | Train Loss: 0.8189 | Train Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.0774 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0718 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1071 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1095 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0913 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0821 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0796 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 2.1816 | Val  Acc: 0.1905
 Site-USPS      | Val  Loss: 0.3291 | Val  Acc: 0.9286
 Site-MNIST-M   | Val  Loss: 1.7535 | Val  Acc: 0.4762
Average Valid Accuracy: 0.8548
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1905
 Best site-USPS       | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0809 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0678 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0794 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0927 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0416 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0478 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0781 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.2166 | Train Acc: 0.5873
 Site-USPS      | Train Loss: 0.2100 | Train Acc: 0.9841
 Site-MNIST-M   | Train Loss: 0.6301 | Train Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.0491 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0399 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0934 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0756 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0775 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0609 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0872 | Val  Acc: 0.9762
 Site-SVHN      | Val  Loss: 2.0036 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.2943 | Val  Acc: 0.9524
 Site-MNIST-M   | Val  Loss: 1.6448 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8714
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3333
 Best site-USPS       | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0448 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0432 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0673 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0653 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0318 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0326 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0430 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.1037 | Train Acc: 0.6825
 Site-USPS      | Train Loss: 0.1472 | Train Acc: 0.9841
 Site-MNIST-M   | Train Loss: 0.4939 | Train Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.0334 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0303 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0647 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0598 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0619 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0403 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0457 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 2.0425 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.2507 | Val  Acc: 0.9286
 Site-MNIST-M   | Val  Loss: 1.5691 | Val  Acc: 0.5476
Average Valid Accuracy: 0.8786
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3333
 Best site-USPS       | Epoch:9 | Val Acc: 0.9286
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_SynthDigits...
===2023-03-30 12:00:12===
===2023-03-30 12:00:14===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SynthDigits: 0.3428
Average Test Accuracy: 0.3428
