===2023-03-30 13:39:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7880 | Train Acc: 0.5556
 Site-MNIST     | Train Loss: 1.6709 | Train Acc: 0.6984
 Site-MNIST     | Train Loss: 1.7084 | Train Acc: 0.5238
 Site-MNIST     | Train Loss: 1.7403 | Train Acc: 0.6349
 Site-MNIST     | Train Loss: 1.6129 | Train Acc: 0.6032
 Site-MNIST     | Train Loss: 1.7144 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.7102 | Train Acc: 0.6032
 Site-SVHN      | Train Loss: 2.2247 | Train Acc: 0.1905
 Site-USPS      | Train Loss: 1.8220 | Train Acc: 0.5079
 Site-MNIST-M   | Train Loss: 2.2223 | Train Acc: 0.1746
 Site-MNIST     | Val  Loss: 1.6647 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.6464 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7123 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.7897 | Val  Acc: 0.4286
 Site-MNIST     | Val  Loss: 1.6796 | Val  Acc: 0.5952
 Site-MNIST     | Val  Loss: 1.6004 | Val  Acc: 0.7381
 Site-MNIST     | Val  Loss: 1.8416 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 2.2775 | Val  Acc: 0.1190
 Site-USPS      | Val  Loss: 1.8562 | Val  Acc: 0.4048
 Site-MNIST-M   | Val  Loss: 2.2557 | Val  Acc: 0.1190
Average Valid Accuracy: 0.4857
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4286
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5952
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7381
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1190
 Best site-USPS       | Epoch:0 | Val Acc: 0.4048
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1190
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3751 | Train Acc: 0.6984
 Site-MNIST     | Train Loss: 1.2621 | Train Acc: 0.7460
 Site-MNIST     | Train Loss: 1.3241 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.3434 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 1.2085 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 1.2924 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 1.3048 | Train Acc: 0.7302
 Site-SVHN      | Train Loss: 2.1693 | Train Acc: 0.2540
 Site-USPS      | Train Loss: 1.4930 | Train Acc: 0.6667
 Site-MNIST-M   | Train Loss: 2.1078 | Train Acc: 0.3016
 Site-MNIST     | Val  Loss: 1.2572 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.2405 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.3020 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.4100 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.2814 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.2013 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.4194 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 2.2631 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 1.5397 | Val  Acc: 0.6429
 Site-MNIST-M   | Val  Loss: 2.1918 | Val  Acc: 0.1667
Average Valid Accuracy: 0.6214
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1667
 Best site-USPS       | Epoch:1 | Val Acc: 0.6429
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0817 | Train Acc: 0.7778
 Site-MNIST     | Train Loss: 0.9760 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 1.0669 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 1.0367 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.9425 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.9950 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 1.0202 | Train Acc: 0.7937
 Site-SVHN      | Train Loss: 2.1069 | Train Acc: 0.2540
 Site-USPS      | Train Loss: 1.2635 | Train Acc: 0.7619
 Site-MNIST-M   | Train Loss: 2.0165 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.9689 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.9605 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.9975 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 1.1277 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.0319 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9329 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 1.1182 | Val  Acc: 0.7381
 Site-SVHN      | Val  Loss: 2.2468 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.3164 | Val  Acc: 0.7381
 Site-MNIST-M   | Val  Loss: 2.1424 | Val  Acc: 0.1905
Average Valid Accuracy: 0.6857
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7381
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1429
 Best site-USPS       | Epoch:2 | Val Acc: 0.7381
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8680 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 0.7857 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.8705 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.8510 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.7544 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.7911 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.8188 | Train Acc: 0.8095
 Site-SVHN      | Train Loss: 2.0861 | Train Acc: 0.2063
 Site-USPS      | Train Loss: 1.0872 | Train Acc: 0.8095
 Site-MNIST-M   | Train Loss: 1.9234 | Train Acc: 0.3810
 Site-MNIST     | Val  Loss: 0.7775 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.7578 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.8071 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9293 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 0.8307 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7473 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.9110 | Val  Acc: 0.7619
 Site-SVHN      | Val  Loss: 2.2492 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.1594 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 2.0877 | Val  Acc: 0.1905
Average Valid Accuracy: 0.7048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7619
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1429
 Best site-USPS       | Epoch:3 | Val Acc: 0.7857
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7218 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.6602 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7290 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7058 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.6181 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.6529 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.6874 | Train Acc: 0.8571
 Site-SVHN      | Train Loss: 2.0447 | Train Acc: 0.2222
 Site-USPS      | Train Loss: 0.9690 | Train Acc: 0.8254
 Site-MNIST-M   | Train Loss: 1.8490 | Train Acc: 0.3968
 Site-MNIST     | Val  Loss: 0.6388 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.6105 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6679 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.7810 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.6921 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.6188 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7692 | Val  Acc: 0.7857
 Site-SVHN      | Val  Loss: 2.2402 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.0519 | Val  Acc: 0.8095
 Site-MNIST-M   | Val  Loss: 2.0472 | Val  Acc: 0.2143
Average Valid Accuracy: 0.7357
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7857
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1429
 Best site-USPS       | Epoch:4 | Val Acc: 0.8095
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6145 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.5630 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.6212 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.6007 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.5141 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.5516 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.5911 | Train Acc: 0.8889
 Site-SVHN      | Train Loss: 2.0024 | Train Acc: 0.2381
 Site-USPS      | Train Loss: 0.8712 | Train Acc: 0.8413
 Site-MNIST-M   | Train Loss: 1.7662 | Train Acc: 0.3968
 Site-MNIST     | Val  Loss: 0.5372 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5015 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5652 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.6687 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.5906 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5304 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.6631 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 2.2265 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 0.9587 | Val  Acc: 0.8333
 Site-MNIST-M   | Val  Loss: 2.0000 | Val  Acc: 0.2381
Average Valid Accuracy: 0.7595
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1429
 Best site-USPS       | Epoch:5 | Val Acc: 0.8333
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5312 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4983 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.5445 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.5202 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4408 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4761 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.5235 | Train Acc: 0.9048
 Site-SVHN      | Train Loss: 1.9651 | Train Acc: 0.2698
 Site-USPS      | Train Loss: 0.7840 | Train Acc: 0.8730
 Site-MNIST-M   | Train Loss: 1.6953 | Train Acc: 0.4603
 Site-MNIST     | Val  Loss: 0.4611 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4242 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4873 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.5862 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.5142 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4605 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5826 | Val  Acc: 0.8571
 Site-SVHN      | Val  Loss: 2.2094 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 0.8802 | Val  Acc: 0.8333
 Site-MNIST-M   | Val  Loss: 1.9605 | Val  Acc: 0.2381
Average Valid Accuracy: 0.7667
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8571
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1429
 Best site-USPS       | Epoch:6 | Val Acc: 0.8333
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4667 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4377 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4777 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4591 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.3763 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4098 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4524 | Train Acc: 0.9048
 Site-SVHN      | Train Loss: 1.9268 | Train Acc: 0.2540
 Site-USPS      | Train Loss: 0.7158 | Train Acc: 0.8730
 Site-MNIST-M   | Train Loss: 1.6391 | Train Acc: 0.4921
 Site-MNIST     | Val  Loss: 0.4001 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3579 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4262 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.5192 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.4512 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4030 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5149 | Val  Acc: 0.8810
 Site-SVHN      | Val  Loss: 2.1990 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 0.8180 | Val  Acc: 0.8333
 Site-MNIST-M   | Val  Loss: 1.9339 | Val  Acc: 0.2619
Average Valid Accuracy: 0.7810
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8810
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1667
 Best site-USPS       | Epoch:7 | Val Acc: 0.8333
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4125 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3880 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4266 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4169 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.3326 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3634 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4042 | Train Acc: 0.9206
 Site-SVHN      | Train Loss: 1.8988 | Train Acc: 0.2857
 Site-USPS      | Train Loss: 0.6501 | Train Acc: 0.8889
 Site-MNIST-M   | Train Loss: 1.5584 | Train Acc: 0.5238
 Site-MNIST     | Val  Loss: 0.3532 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3119 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3829 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4656 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.3997 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3560 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4633 | Val  Acc: 0.9048
 Site-SVHN      | Val  Loss: 2.1918 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 0.7638 | Val  Acc: 0.8333
 Site-MNIST-M   | Val  Loss: 1.8931 | Val  Acc: 0.3095
Average Valid Accuracy: 0.7881
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9048
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1429
 Best site-USPS       | Epoch:8 | Val Acc: 0.8333
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3718 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3520 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.3791 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3735 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.2948 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3172 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3538 | Train Acc: 0.9524
 Site-SVHN      | Train Loss: 1.8653 | Train Acc: 0.3016
 Site-USPS      | Train Loss: 0.5913 | Train Acc: 0.8889
 Site-MNIST-M   | Train Loss: 1.4939 | Train Acc: 0.5238
 Site-MNIST     | Val  Loss: 0.3084 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2738 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3405 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4173 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3566 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3185 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4169 | Val  Acc: 0.9048
 Site-SVHN      | Val  Loss: 2.1752 | Val  Acc: 0.1905
 Site-USPS      | Val  Loss: 0.7119 | Val  Acc: 0.8571
 Site-MNIST-M   | Val  Loss: 1.8443 | Val  Acc: 0.3095
Average Valid Accuracy: 0.8024
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9048
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1905
 Best site-USPS       | Epoch:9 | Val Acc: 0.8571
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_SynthDigits...
===2023-03-30 14:02:40===
===2023-03-30 14:02:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SynthDigits: 0.3050
Average Test Accuracy: 0.3050
