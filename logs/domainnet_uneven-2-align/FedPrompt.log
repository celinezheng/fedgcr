===2023-03-29 13:20:53===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-Clipart   | Train Loss: 1.9921 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9600 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.8527 | Train Acc: 0.5079
 Site-Clipart   | Train Loss: 1.8935 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 2.0940 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9755 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.2290 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1439 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 2.0862 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.9987 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.2911 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.8455 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 1.8524 | Train Acc: 0.5556
 Site-Clipart   | Val  Loss: 2.0534 | Val  Acc: 0.2857
 Site-Clipart   | Val  Loss: 1.8655 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7686 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.8251 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9257 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9818 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1527 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1938 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.2679 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.1187 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2879 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 1.9082 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9864 | Val  Acc: 0.5000
Average Valid Accuracy: 0.3864
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2857
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5637 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.6229 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.4450 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.4086 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.7044 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.5849 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.1131 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 1.9588 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.8415 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.5474 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1740 | Train Acc: 0.3016
 Site-Real      | Train Loss: 1.3860 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.4460 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.7134 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.3995 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3588 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3904 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.5370 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.6622 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9521 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9581 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1398 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.7082 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.1837 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.4452 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.6137 | Val  Acc: 0.5952
Average Valid Accuracy: 0.5513
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Painting   | Epoch:1 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2381
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2004 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.3181 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.1351 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1208 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.3506 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3290 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 2.0073 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 1.9017 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.7548 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.2889 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.0281 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.9714 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 1.0978 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3087 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.1332 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9941 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.1087 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.2804 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.3174 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.8037 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 1.7284 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1299 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.4664 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.0966 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9690 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 1.3013 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6044
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1667
 Best site-Painting   | Epoch:2 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0048 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9679 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.8319 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7808 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.9886 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1252 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 1.8102 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.5043 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.4102 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 1.0091 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.0683 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.7791 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9116 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.9616 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7838 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7273 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7948 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9605 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8917 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.5818 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.4469 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.7861 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 1.1954 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9997 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.8251 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.2465 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7308
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4048
 Best site-Painting   | Epoch:3 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3571
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.6638 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.8559 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.6502 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.5416 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7519 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.8867 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.8396 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.5693 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.4116 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.8051 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.8286 | Train Acc: 0.2222
 Site-Real      | Train Loss: 0.4901 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7358 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7487 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5827 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5324 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6270 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9085 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9047 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5373 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6057 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8847 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.0744 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9334 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.5106 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9790 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6905
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.4908 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6516 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.4281 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3489 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5478 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7407 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.6008 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.2429 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2999 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.6001 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.8445 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.3483 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5516 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.6180 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4584 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3557 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3834 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6649 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.5882 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2371 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.1427 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5031 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.7934 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.9213 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.4544 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9253 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7656
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4524
 Best site-Painting   | Epoch:5 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4048
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4373 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5663 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.3416 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3472 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5055 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6107 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6150 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.2826 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1028 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.5384 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.6541 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.2421 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3874 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5387 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3157 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2880 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2780 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5209 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4640 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.2378 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.2545 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5372 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.7646 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.8293 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.2773 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6577 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7729
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3810
 Best site-Painting   | Epoch:6 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3571
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2915 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4421 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2482 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2170 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3331 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5367 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4809 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.0533 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.9829 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3621 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5244 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2165 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3766 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3741 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1937 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2259 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2010 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3690 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3862 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9847 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9857 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2289 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6201 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.8681 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.2843 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6459 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8278
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3810
 Best site-Real       | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2415 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3744 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.1925 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2038 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3596 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4583 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.4188 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 0.9069 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.8540 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.4050 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.4386 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.2136 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3205 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3652 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1638 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1875 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1460 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4549 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3578 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.7827 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.7965 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.2699 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5964 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.9004 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.3608 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6124 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5238
 Best site-Painting   | Epoch:8 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4048
 Best site-Real       | Epoch:8 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.1696 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3185 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.1384 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1698 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2787 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3582 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.2053 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8720 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.7512 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.2752 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.5397 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.1973 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3376 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2323 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0875 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0964 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1070 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3252 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2572 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8969 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.8274 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9936 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.5171 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.6338 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2250 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.6706 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8462
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Painting   | Epoch:9 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4762
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-align/FedPrompt...
===2023-03-29 13:56:43===
===2023-03-29 13:56:44===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8764
 Test site-Infograph | Epoch:9 | Test Acc: 0.4962
 Test site-Painting  | Epoch:9 | Test Acc: 0.8304
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4400
 Test site-Real      | Epoch:9 | Test Acc: 0.9260
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8213
Average Test Accuracy: 0.7317
