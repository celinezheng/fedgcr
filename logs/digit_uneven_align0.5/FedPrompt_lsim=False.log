===2023-03-23 12:17:33===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
===2023-03-23 12:17:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8051 | Train Acc: 0.5225
 Site-MNIST     | Train Loss: 1.8246 | Train Acc: 0.5045
 Site-MNIST     | Train Loss: 1.7411 | Train Acc: 0.5315
 Site-MNIST     | Train Loss: 1.7934 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.0688 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 2.1350 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0859 | Train Acc: 0.2342
 Site-USPS      | Train Loss: 1.8678 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 2.0952 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.2055 | Train Acc: 0.1532
 Site-MNIST     | Val  Loss: 1.7496 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.7399 | Val  Acc: 0.5405
 Site-MNIST     | Val  Loss: 1.8169 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.7729 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 2.0979 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 2.1392 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0783 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 1.8681 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.0783 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.2486 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4014
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5405
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3243
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4407 | Train Acc: 0.6847
 Site-MNIST     | Train Loss: 1.4611 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.3907 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 1.4152 | Train Acc: 0.7297
 Site-SVHN      | Train Loss: 1.8779 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.9818 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 1.9278 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 1.5297 | Train Acc: 0.6847
 Site-SynthDigits| Train Loss: 1.8906 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.1445 | Train Acc: 0.1892
 Site-MNIST     | Val  Loss: 1.3655 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 1.3776 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 1.4805 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.4014 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 1.9091 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.9942 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.8814 | Val  Acc: 0.5270
 Site-USPS      | Val  Loss: 1.5649 | Val  Acc: 0.6622
 Site-SynthDigits| Val  Loss: 1.8814 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 2.1976 | Val  Acc: 0.1757
Average Valid Accuracy: 0.5568
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5270
 Best site-USPS       | Epoch:1 | Val Acc: 0.6622
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1973 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 1.2913 | Train Acc: 0.7117
 Site-MNIST     | Train Loss: 1.1711 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 1.1705 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 1.7347 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.8489 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.7528 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 1.3076 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.7036 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 2.0692 | Train Acc: 0.1982
 Site-MNIST     | Val  Loss: 1.1384 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 1.1571 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 1.2692 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.1865 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.7589 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.8719 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.7316 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.3640 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7316 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.1548 | Val  Acc: 0.1486
Average Valid Accuracy: 0.6108
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5811
 Best site-USPS       | Epoch:2 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 15 ============
============ Train epoch 16 ============
===2023-03-23 12:26:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
===2023-03-23 12:27:51===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8028 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.8223 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.7384 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.7917 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.0682 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 2.1352 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0863 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.8637 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.0949 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.2063 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 1.7479 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.7367 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.8151 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.7697 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 2.0974 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.1408 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 1.8640 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.0765 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.2510 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4027
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3243
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4344 | Train Acc: 0.6847
 Site-MNIST     | Train Loss: 1.4548 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.3835 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 1.4090 | Train Acc: 0.7387
 Site-SVHN      | Train Loss: 1.8799 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.9826 | Train Acc: 0.3964
 Site-SVHN      | Train Loss: 1.9278 | Train Acc: 0.4144
 Site-USPS      | Train Loss: 1.5318 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 1.8926 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.1409 | Train Acc: 0.1892
 Site-MNIST     | Val  Loss: 1.3611 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 1.3681 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 1.4752 | Val  Acc: 0.6351
 Site-MNIST     | Val  Loss: 1.3936 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 1.9098 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.9944 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.8818 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.5690 | Val  Acc: 0.6757
 Site-SynthDigits| Val  Loss: 1.8818 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.1955 | Val  Acc: 0.1757
Average Valid Accuracy: 0.5608
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6351
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5000
 Best site-USPS       | Epoch:1 | Val Acc: 0.6757
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1964 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 1.2898 | Train Acc: 0.6937
 Site-MNIST     | Train Loss: 1.1707 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 1.1692 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 1.7308 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.8468 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 1.7480 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 1.3032 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.7000 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 2.0672 | Train Acc: 0.1982
 Site-MNIST     | Val  Loss: 1.1374 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 1.1574 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 1.2688 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.1839 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.7543 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.8698 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.7281 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.3601 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7281 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 2.1521 | Val  Acc: 0.1486
Average Valid Accuracy: 0.6000
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5676
 Best site-USPS       | Epoch:2 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9692 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 1.0572 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 0.9367 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.9409 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 1.6226 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.7435 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.6540 | Train Acc: 0.4955
 Site-USPS      | Train Loss: 1.1235 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 1.6304 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 1.9769 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 0.9139 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.9178 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 1.0463 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.9574 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.6458 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7743 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.6331 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.2138 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 1.6331 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.1164 | Val  Acc: 0.1622
Average Valid Accuracy: 0.6432
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5811
 Best site-USPS       | Epoch:3 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.8792 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.9949 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 0.8878 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.8724 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 1.4734 | Train Acc: 0.5676
 Site-SVHN      | Train Loss: 1.6768 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.5392 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.9978 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.4898 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 1.9445 | Train Acc: 0.2432
 Site-MNIST     | Val  Loss: 0.8366 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.8731 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.9845 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.9003 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.5291 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6914 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.5083 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.0822 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.5083 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 2.0874 | Val  Acc: 0.1622
Average Valid Accuracy: 0.6527
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5811
 Best site-USPS       | Epoch:4 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.7236 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.8271 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.6751 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.7746 | Train Acc: 0.8468
 Site-SVHN      | Train Loss: 1.4516 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 1.5884 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.5125 | Train Acc: 0.4955
 Site-USPS      | Train Loss: 0.9670 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.4995 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.8804 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 0.6870 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.6748 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.8021 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.7276 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.4987 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.6647 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.4878 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.0383 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.4878 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0638 | Val  Acc: 0.2162
Average Valid Accuracy: 0.6919
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6216
 Best site-USPS       | Epoch:5 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.7263 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.8811 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 0.6836 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.7092 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 1.2658 | Train Acc: 0.6847
 Site-SVHN      | Train Loss: 1.4774 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.3309 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 0.8565 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.2631 | Train Acc: 0.6847
 Site-MNIST-M   | Train Loss: 1.8670 | Train Acc: 0.3423
 Site-MNIST     | Val  Loss: 0.6710 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.7015 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.8299 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.7450 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.3332 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 1.4985 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.3344 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.9516 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.3344 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0383 | Val  Acc: 0.2838
Average Valid Accuracy: 0.7014
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-USPS       | Epoch:6 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5804 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.6547 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.5350 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.5679 | Train Acc: 0.8919
 Site-SVHN      | Train Loss: 1.2804 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.4537 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 1.3657 | Train Acc: 0.6216
 Site-USPS      | Train Loss: 0.8015 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.3029 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.7728 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 0.5523 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.5555 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.6668 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.6081 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.3551 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 1.5374 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.3633 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.8994 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.3633 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.9756 | Val  Acc: 0.3514
Average Valid Accuracy: 0.7257
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6351
 Best site-USPS       | Epoch:7 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5263 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.6031 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.5280 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.5424 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.2662 | Train Acc: 0.6486
 Site-SVHN      | Train Loss: 1.4396 | Train Acc: 0.5676
 Site-SVHN      | Train Loss: 1.2853 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 0.7675 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.2588 | Train Acc: 0.6486
 Site-MNIST-M   | Train Loss: 1.7389 | Train Acc: 0.3784
 Site-MNIST     | Val  Loss: 0.5124 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.5065 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.6247 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.5628 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.3090 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 1.4954 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.3124 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.8645 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.3124 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.9940 | Val  Acc: 0.3243
Average Valid Accuracy: 0.7297
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6351
 Best site-USPS       | Epoch:8 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.5028 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.6039 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.5182 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.5148 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 1.0218 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 1.2396 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.1561 | Train Acc: 0.6937
 Site-USPS      | Train Loss: 0.7024 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.0385 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.7116 | Train Acc: 0.3784
 Site-MNIST     | Val  Loss: 0.4736 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.4830 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5768 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.5350 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.1462 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 1.3172 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 1.1415 | Val  Acc: 0.7432
 Site-USPS      | Val  Loss: 0.8276 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.1415 | Val  Acc: 0.7432
 Site-MNIST-M   | Val  Loss: 1.9266 | Val  Acc: 0.3378
Average Valid Accuracy: 0.7568
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7432
 Best site-USPS       | Epoch:9 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7432
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_align0.5/FedPrompt_lsim=False...
===2023-03-23 12:55:39===
===2023-03-23 12:55:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8329
 Test site-SVHN      | Epoch:9 | Test Acc: 0.5079
 Test site-USPS      | Epoch:9 | Test Acc: 0.8065
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5079
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3214
Average Test Accuracy: 0.5953
===2023-03-23 13:28:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
