===2023-08-10 15:02:44===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (2) | Train Loss: 1.6736 | Train Acc: 0.4667
 Site-photo                     (2) | Train Loss: 1.7515 | Train Acc: 0.4559
 Site-photo                     (2) | Train Loss: 1.6947 | Train Acc: 0.5000
 Site-photo                     (2) | Train Loss: 1.6159 | Train Acc: 0.5686
 Site-photo                     (2) | Train Loss: 1.6908 | Train Acc: 0.5022
 Site-art_painting              (4) | Train Loss: 1.8027 | Train Acc: 0.3095
 Site-art_painting              (0) | Train Loss: 1.9024 | Train Acc: 0.2526
 Site-art_painting              (0) | Train Loss: 1.7673 | Train Acc: 0.3239
 Site-cartoon                   (3) | Train Loss: 1.8389 | Train Acc: 0.1765
 Site-cartoon                   (5) | Train Loss: 1.8759 | Train Acc: 0.2558
 Site-sketch                    (1) | Train Loss: 1.8480 | Train Acc: 0.1901
Average Train Accuracy: 0.3638
 Site-photo                     (2) | Val  Loss: 1.6976 | Val  Acc: 0.5000
 Site-photo                     (2) | Val  Loss: 1.7470 | Val  Acc: 0.5111
 Site-photo                     (2) | Val  Loss: 1.6030 | Val  Acc: 0.5147
 Site-photo                     (2) | Val  Loss: 1.6918 | Val  Acc: 0.5000
 Site-photo                     (2) | Val  Loss: 1.6341 | Val  Acc: 0.5066
 Site-art_painting              (4) | Val  Loss: 1.9434 | Val  Acc: 0.2143
 Site-art_painting              (0) | Val  Loss: 1.7397 | Val  Acc: 0.4127
 Site-art_painting              (0) | Val  Loss: 1.8255 | Val  Acc: 0.2887
 Site-cartoon                   (3) | Val  Loss: 1.9569 | Val  Acc: 0.3913
 Site-cartoon                   (5) | Val  Loss: 1.8854 | Val  Acc: 0.2348
 Site-sketch                    (1) | Val  Loss: 1.7826 | Val  Acc: 0.2750
Average Valid Accuracy: 0.3954
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5111
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5147
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5066
 Best site-art_painting             (4)  | Epoch:0 | Val Acc: 0.2143
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.4127
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2887
 Best site-cartoon                  (3)  | Epoch:0 | Val Acc: 0.3913
 Best site-cartoon                  (5)  | Epoch:0 | Val Acc: 0.2348
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.2750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (1) | Train Loss: 1.5602 | Train Acc: 0.5556
 Site-photo                     (1) | Train Loss: 1.4513 | Train Acc: 0.5735
 Site-photo                     (1) | Train Loss: 1.4477 | Train Acc: 0.6373
 Site-photo                     (1) | Train Loss: 1.4151 | Train Acc: 0.6667
 Site-photo                     (1) | Train Loss: 1.4967 | Train Acc: 0.6288
 Site-art_painting              (5) | Train Loss: 1.6239 | Train Acc: 0.5476
 Site-art_painting              (3) | Train Loss: 1.8063 | Train Acc: 0.3368
 Site-art_painting              (3) | Train Loss: 1.6439 | Train Acc: 0.4178
 Site-cartoon                   (4) | Train Loss: 1.7339 | Train Acc: 0.2647
 Site-cartoon                   (0) | Train Loss: 1.7925 | Train Acc: 0.3198
 Site-sketch                    (2) | Train Loss: 1.9163 | Train Acc: 0.2314
Average Train Accuracy: 0.4709
 Site-photo                     (1) | Val  Loss: 1.4988 | Val  Acc: 0.6000
 Site-photo                     (1) | Val  Loss: 1.5404 | Val  Acc: 0.6000
 Site-photo                     (1) | Val  Loss: 1.3859 | Val  Acc: 0.6324
 Site-photo                     (1) | Val  Loss: 1.4730 | Val  Acc: 0.6275
 Site-photo                     (1) | Val  Loss: 1.4083 | Val  Acc: 0.7171
 Site-art_painting              (5) | Val  Loss: 1.7190 | Val  Acc: 0.3929
 Site-art_painting              (3) | Val  Loss: 1.6342 | Val  Acc: 0.4286
 Site-art_painting              (3) | Val  Loss: 1.6789 | Val  Acc: 0.4155
 Site-cartoon                   (4) | Val  Loss: 1.8514 | Val  Acc: 0.2174
 Site-cartoon                   (0) | Val  Loss: 1.7573 | Val  Acc: 0.3130
 Site-sketch                    (2) | Val  Loss: 1.8275 | Val  Acc: 0.2625
Average Valid Accuracy: 0.4733
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6324
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6275
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7171
 Best site-art_painting             (5)  | Epoch:1 | Val Acc: 0.3929
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.4286
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.4155
 Best site-cartoon                  (4)  | Epoch:1 | Val Acc: 0.2174
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.3130
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.2625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 2, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (2) | Train Loss: 1.3274 | Train Acc: 0.7556
 Site-photo                     (2) | Train Loss: 1.1867 | Train Acc: 0.7941
 Site-photo                     (2) | Train Loss: 1.1971 | Train Acc: 0.8431
 Site-photo                     (2) | Train Loss: 1.2180 | Train Acc: 0.8758
 Site-photo                     (2) | Train Loss: 1.2845 | Train Acc: 0.8079
 Site-art_painting              (4) | Train Loss: 1.6089 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.6054 | Train Acc: 0.4316
 Site-art_painting              (1) | Train Loss: 1.5426 | Train Acc: 0.5070
 Site-cartoon                   (5) | Train Loss: 1.7167 | Train Acc: 0.3235
 Site-cartoon                   (3) | Train Loss: 1.6778 | Train Acc: 0.3605
 Site-sketch                    (0) | Train Loss: 1.8190 | Train Acc: 0.2397
Average Train Accuracy: 0.5853
 Site-photo                     (2) | Val  Loss: 1.2574 | Val  Acc: 0.8000
 Site-photo                     (2) | Val  Loss: 1.3023 | Val  Acc: 0.7333
 Site-photo                     (2) | Val  Loss: 1.2524 | Val  Acc: 0.8235
 Site-photo                     (2) | Val  Loss: 1.2699 | Val  Acc: 0.8627
 Site-photo                     (2) | Val  Loss: 1.1943 | Val  Acc: 0.8553
 Site-art_painting              (4) | Val  Loss: 1.5337 | Val  Acc: 0.5714
 Site-art_painting              (1) | Val  Loss: 1.5060 | Val  Acc: 0.6032
 Site-art_painting              (1) | Val  Loss: 1.5787 | Val  Acc: 0.5070
 Site-cartoon                   (5) | Val  Loss: 1.8144 | Val  Acc: 0.2174
 Site-cartoon                   (3) | Val  Loss: 1.6535 | Val  Acc: 0.4087
 Site-sketch                    (0) | Val  Loss: 1.7329 | Val  Acc: 0.2375
Average Valid Accuracy: 0.6018
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.8000
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.7333
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.8235
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.8627
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.8553
 Best site-art_painting             (4)  | Epoch:2 | Val Acc: 0.5714
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.6032
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.5070
 Best site-cartoon                  (5)  | Epoch:2 | Val Acc: 0.2174
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.4087
 Best site-sketch                   (0)  | Epoch:2 | Val Acc: 0.2375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 3 ============
cnt=[4, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (5) | Train Loss: 1.1085 | Train Acc: 0.8444
 Site-photo                     (0) | Train Loss: 1.1850 | Train Acc: 0.8382
 Site-photo                     (0) | Train Loss: 1.0214 | Train Acc: 0.9510
 Site-photo                     (0) | Train Loss: 1.0152 | Train Acc: 0.9281
 Site-photo                     (0) | Train Loss: 1.0591 | Train Acc: 0.8821
 Site-art_painting              (4) | Train Loss: 1.3700 | Train Acc: 0.6429
 Site-art_painting              (3) | Train Loss: 1.4567 | Train Acc: 0.6105
 Site-art_painting              (3) | Train Loss: 1.3835 | Train Acc: 0.6385
 Site-cartoon                   (1) | Train Loss: 1.6072 | Train Acc: 0.4118
 Site-cartoon                   (1) | Train Loss: 1.5578 | Train Acc: 0.4593
 Site-sketch                    (2) | Train Loss: 1.7680 | Train Acc: 0.2975
Average Train Accuracy: 0.6822
 Site-photo                     (5) | Val  Loss: 1.0255 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 1.1116 | Val  Acc: 0.8667
 Site-photo                     (0) | Val  Loss: 1.0620 | Val  Acc: 0.9118
 Site-photo                     (0) | Val  Loss: 1.0424 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.9745 | Val  Acc: 0.9276
 Site-art_painting              (4) | Val  Loss: 1.3621 | Val  Acc: 0.6429
 Site-art_painting              (3) | Val  Loss: 1.3425 | Val  Acc: 0.7143
 Site-art_painting              (3) | Val  Loss: 1.4539 | Val  Acc: 0.6127
 Site-cartoon                   (1) | Val  Loss: 1.6304 | Val  Acc: 0.3913
 Site-cartoon                   (1) | Val  Loss: 1.5355 | Val  Acc: 0.4522
 Site-sketch                    (2) | Val  Loss: 1.6767 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7026
 Best site-photo                    (5)  | Epoch:3 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8667
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9118
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9276
 Best site-art_painting             (4)  | Epoch:3 | Val Acc: 0.6429
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.7143
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.6127
 Best site-cartoon                  (1)  | Epoch:3 | Val Acc: 0.3913
 Best site-cartoon                  (1)  | Epoch:3 | Val Acc: 0.4522
 Best site-sketch                   (2)  | Epoch:3 | Val Acc: 0.3250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 2, 1, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (4) | Train Loss: 0.9295 | Train Acc: 0.8667
 Site-photo                     (1) | Train Loss: 0.7444 | Train Acc: 0.8971
 Site-photo                     (4) | Train Loss: 0.8111 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.8403 | Train Acc: 0.9673
 Site-photo                     (4) | Train Loss: 0.8824 | Train Acc: 0.9476
 Site-art_painting              (3) | Train Loss: 1.3108 | Train Acc: 0.7143
 Site-art_painting              (3) | Train Loss: 1.3711 | Train Acc: 0.5684
 Site-art_painting              (3) | Train Loss: 1.2294 | Train Acc: 0.7371
 Site-cartoon                   (0) | Train Loss: 1.5831 | Train Acc: 0.3824
 Site-cartoon                   (5) | Train Loss: 1.4624 | Train Acc: 0.5291
 Site-sketch                    (2) | Train Loss: 1.7191 | Train Acc: 0.2893
Average Train Accuracy: 0.7154
 Site-photo                     (4) | Val  Loss: 0.8561 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.8920 | Val  Acc: 0.9111
 Site-photo                     (4) | Val  Loss: 0.8621 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.8694 | Val  Acc: 0.9510
 Site-photo                     (4) | Val  Loss: 0.7864 | Val  Acc: 0.9671
 Site-art_painting              (3) | Val  Loss: 1.2167 | Val  Acc: 0.7143
 Site-art_painting              (3) | Val  Loss: 1.2409 | Val  Acc: 0.7778
 Site-art_painting              (3) | Val  Loss: 1.3002 | Val  Acc: 0.7324
 Site-cartoon                   (0) | Val  Loss: 1.5197 | Val  Acc: 0.3913
 Site-cartoon                   (5) | Val  Loss: 1.4337 | Val  Acc: 0.5217
 Site-sketch                    (2) | Val  Loss: 1.6601 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7473
 Best site-photo                    (4)  | Epoch:4 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.9111
 Best site-photo                    (4)  | Epoch:4 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.9510
 Best site-photo                    (4)  | Epoch:4 | Val Acc: 0.9671
 Best site-art_painting             (3)  | Epoch:4 | Val Acc: 0.7143
 Best site-art_painting             (3)  | Epoch:4 | Val Acc: 0.7778
 Best site-art_painting             (3)  | Epoch:4 | Val Acc: 0.7324
 Best site-cartoon                  (0)  | Epoch:4 | Val Acc: 0.3913
 Best site-cartoon                  (5)  | Epoch:4 | Val Acc: 0.5217
 Best site-sketch                   (2)  | Epoch:4 | Val Acc: 0.3500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (2) | Train Loss: 0.8002 | Train Acc: 0.9556
 Site-photo                     (2) | Train Loss: 0.9132 | Train Acc: 0.9118
 Site-photo                     (2) | Train Loss: 0.7120 | Train Acc: 0.9804
 Site-photo                     (2) | Train Loss: 0.7137 | Train Acc: 0.9477
 Site-photo                     (2) | Train Loss: 0.7474 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 1.2401 | Train Acc: 0.6667
 Site-art_painting              (0) | Train Loss: 1.2576 | Train Acc: 0.6211
 Site-art_painting              (5) | Train Loss: 1.1160 | Train Acc: 0.7887
 Site-cartoon                   (4) | Train Loss: 1.4445 | Train Acc: 0.5882
 Site-cartoon                   (3) | Train Loss: 1.3587 | Train Acc: 0.5814
 Site-sketch                    (1) | Train Loss: 1.6458 | Train Acc: 0.3719
Average Train Accuracy: 0.7613
 Site-photo                     (2) | Val  Loss: 0.7547 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.7172 | Val  Acc: 0.9778
 Site-photo                     (2) | Val  Loss: 0.7646 | Val  Acc: 0.9265
 Site-photo                     (2) | Val  Loss: 0.7521 | Val  Acc: 0.9412
 Site-photo                     (2) | Val  Loss: 0.6704 | Val  Acc: 0.9539
 Site-art_painting              (0) | Val  Loss: 1.1298 | Val  Acc: 0.7857
 Site-art_painting              (0) | Val  Loss: 1.1366 | Val  Acc: 0.8095
 Site-art_painting              (5) | Val  Loss: 1.2484 | Val  Acc: 0.7394
 Site-cartoon                   (4) | Val  Loss: 1.3793 | Val  Acc: 0.6087
 Site-cartoon                   (3) | Val  Loss: 1.3585 | Val  Acc: 0.5739
 Site-sketch                    (1) | Val  Loss: 1.5930 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7886
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9778
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9265
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9412
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9539
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.7857
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.8095
 Best site-art_painting             (5)  | Epoch:5 | Val Acc: 0.7394
 Best site-cartoon                  (4)  | Epoch:5 | Val Acc: 0.6087
 Best site-cartoon                  (3)  | Epoch:5 | Val Acc: 0.5739
 Best site-sketch                   (1)  | Epoch:5 | Val Acc: 0.4250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 2, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (2) | Train Loss: 0.7269 | Train Acc: 0.9333
 Site-photo                     (2) | Train Loss: 0.6969 | Train Acc: 0.9118
 Site-photo                     (2) | Train Loss: 0.6227 | Train Acc: 0.9608
 Site-photo                     (2) | Train Loss: 0.6463 | Train Acc: 0.9542
 Site-photo                     (2) | Train Loss: 0.6253 | Train Acc: 0.9607
 Site-art_painting              (4) | Train Loss: 1.0818 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 1.1410 | Train Acc: 0.7263
 Site-art_painting              (1) | Train Loss: 1.0402 | Train Acc: 0.8122
 Site-cartoon                   (3) | Train Loss: 1.3221 | Train Acc: 0.6765
 Site-cartoon                   (5) | Train Loss: 1.2794 | Train Acc: 0.6047
 Site-sketch                    (0) | Train Loss: 1.5975 | Train Acc: 0.4050
Average Train Accuracy: 0.7959
 Site-photo                     (2) | Val  Loss: 0.6256 | Val  Acc: 0.9667
 Site-photo                     (2) | Val  Loss: 0.6694 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.6654 | Val  Acc: 0.9559
 Site-photo                     (2) | Val  Loss: 0.6555 | Val  Acc: 0.9510
 Site-photo                     (2) | Val  Loss: 0.5900 | Val  Acc: 0.9671
 Site-art_painting              (4) | Val  Loss: 0.9623 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.9397 | Val  Acc: 0.8889
 Site-art_painting              (1) | Val  Loss: 1.0758 | Val  Acc: 0.8521
 Site-cartoon                   (3) | Val  Loss: 1.3788 | Val  Acc: 0.6087
 Site-cartoon                   (5) | Val  Loss: 1.2134 | Val  Acc: 0.6870
 Site-sketch                    (0) | Val  Loss: 1.5668 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8307
 Best site-photo                    (2)  | Epoch:6 | Val Acc: 0.9667
 Best site-photo                    (2)  | Epoch:6 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:6 | Val Acc: 0.9559
 Best site-photo                    (2)  | Epoch:6 | Val Acc: 0.9510
 Best site-photo                    (2)  | Epoch:6 | Val Acc: 0.9671
 Best site-art_painting             (4)  | Epoch:6 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8889
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8521
 Best site-cartoon                  (3)  | Epoch:6 | Val Acc: 0.6087
 Best site-cartoon                  (5)  | Epoch:6 | Val Acc: 0.6870
 Best site-sketch                   (0)  | Epoch:6 | Val Acc: 0.4125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (0) | Train Loss: 0.6319 | Train Acc: 0.9333
 Site-photo                     (0) | Train Loss: 0.8077 | Train Acc: 0.9265
 Site-photo                     (0) | Train Loss: 0.5420 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.5677 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.5729 | Train Acc: 0.9651
 Site-art_painting              (3) | Train Loss: 0.9648 | Train Acc: 0.7857
 Site-art_painting              (3) | Train Loss: 1.0342 | Train Acc: 0.6947
 Site-art_painting              (3) | Train Loss: 0.8900 | Train Acc: 0.8404
 Site-cartoon                   (2) | Train Loss: 1.2055 | Train Acc: 0.7059
 Site-cartoon                   (5) | Train Loss: 1.1593 | Train Acc: 0.6919
 Site-sketch                    (1) | Train Loss: 1.4973 | Train Acc: 0.5041
Average Train Accuracy: 0.8178
 Site-photo                     (0) | Val  Loss: 0.5932 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.5901 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5985 | Val  Acc: 0.9559
 Site-photo                     (4) | Val  Loss: 0.5993 | Val  Acc: 0.9216
 Site-photo                     (0) | Val  Loss: 0.5217 | Val  Acc: 0.9605
 Site-art_painting              (3) | Val  Loss: 0.9030 | Val  Acc: 0.8214
 Site-art_painting              (3) | Val  Loss: 0.8616 | Val  Acc: 0.8571
 Site-art_painting              (3) | Val  Loss: 0.9565 | Val  Acc: 0.8239
 Site-cartoon                   (2) | Val  Loss: 1.2176 | Val  Acc: 0.5652
 Site-cartoon                   (5) | Val  Loss: 1.1066 | Val  Acc: 0.7217
 Site-sketch                    (1) | Val  Loss: 1.4939 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8101
============ Train epoch 8 ============
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.5676 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.6898 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.4698 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.5284 | Train Acc: 0.9542
 Site-photo                     (5) | Train Loss: 0.5311 | Train Acc: 0.9607
 Site-art_painting              (3) | Train Loss: 0.9389 | Train Acc: 0.7857
 Site-art_painting              (3) | Train Loss: 0.9471 | Train Acc: 0.7474
 Site-art_painting              (3) | Train Loss: 0.8536 | Train Acc: 0.8498
 Site-cartoon                   (4) | Train Loss: 1.1002 | Train Acc: 0.7059
 Site-cartoon                   (1) | Train Loss: 1.0564 | Train Acc: 0.7151
 Site-sketch                    (2) | Train Loss: 1.3971 | Train Acc: 0.4959
Average Train Accuracy: 0.8299
 Site-photo                     (0) | Val  Loss: 0.5154 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5359 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.5390 | Val  Acc: 0.9265
 Site-photo                     (0) | Val  Loss: 0.5410 | Val  Acc: 0.9706
 Site-photo                     (5) | Val  Loss: 0.4730 | Val  Acc: 0.9474
 Site-art_painting              (3) | Val  Loss: 0.7506 | Val  Acc: 0.8571
 Site-art_painting              (3) | Val  Loss: 0.7504 | Val  Acc: 0.9365
 Site-art_painting              (3) | Val  Loss: 0.9172 | Val  Acc: 0.8310
 Site-cartoon                   (4) | Val  Loss: 1.0877 | Val  Acc: 0.6522
 Site-cartoon                   (1) | Val  Loss: 1.0364 | Val  Acc: 0.7478
 Site-sketch                    (2) | Val  Loss: 1.4372 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8325
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9265
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9706
 Best site-photo                    (5)  | Epoch:8 | Val Acc: 0.9474
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.9365
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.8310
 Best site-cartoon                  (4)  | Epoch:8 | Val Acc: 0.6522
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.7478
 Best site-sketch                   (2)  | Epoch:8 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 2, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (1) | Train Loss: 0.5125 | Train Acc: 0.9556
 Site-photo                     (5) | Train Loss: 0.6018 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.4235 | Train Acc: 0.9804
 Site-photo                     (5) | Train Loss: 0.5016 | Train Acc: 0.9477
 Site-photo                     (0) | Train Loss: 0.4738 | Train Acc: 0.9651
 Site-art_painting              (4) | Train Loss: 0.8722 | Train Acc: 0.8095
 Site-art_painting              (4) | Train Loss: 0.8262 | Train Acc: 0.8211
 Site-art_painting              (4) | Train Loss: 0.7723 | Train Acc: 0.8357
 Site-cartoon                   (2) | Train Loss: 1.0409 | Train Acc: 0.7059
 Site-cartoon                   (2) | Train Loss: 0.9925 | Train Acc: 0.7093
 Site-sketch                    (3) | Train Loss: 1.2462 | Train Acc: 0.6116
Average Train Accuracy: 0.8439
 Site-photo                     (1) | Val  Loss: 0.4803 | Val  Acc: 0.9000
 Site-photo                     (5) | Val  Loss: 0.4525 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.4649 | Val  Acc: 0.9559
 Site-photo                     (5) | Val  Loss: 0.4938 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.4136 | Val  Acc: 0.9803
 Site-art_painting              (4) | Val  Loss: 0.6960 | Val  Acc: 0.8214
 Site-art_painting              (4) | Val  Loss: 0.7333 | Val  Acc: 0.9048
 Site-art_painting              (4) | Val  Loss: 0.7829 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.9737 | Val  Acc: 0.7826
 Site-cartoon                   (2) | Val  Loss: 0.9317 | Val  Acc: 0.7826
 Site-sketch                    (3) | Val  Loss: 1.3684 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8470
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9000
 Best site-photo                    (5)  | Epoch:9 | Val Acc: 0.9111
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9559
 Best site-photo                    (5)  | Epoch:9 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9803
 Best site-art_painting             (4)  | Epoch:9 | Val Acc: 0.8214
 Best site-art_painting             (4)  | Epoch:9 | Val Acc: 0.9048
 Best site-art_painting             (4)  | Epoch:9 | Val Acc: 0.8873
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.7826
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.7826
 Best site-sketch                   (3)  | Epoch:9 | Val Acc: 0.4500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 10 ============
cnt=[5, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 0.4771 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.5294 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.3479 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.4409 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.4141 | Train Acc: 0.9607
 Site-art_painting              (5) | Train Loss: 0.8101 | Train Acc: 0.8095
 Site-art_painting              (3) | Train Loss: 0.7401 | Train Acc: 0.8316
 Site-art_painting              (3) | Train Loss: 0.6549 | Train Acc: 0.8920
 Site-cartoon                   (2) | Train Loss: 0.8875 | Train Acc: 0.7353
 Site-cartoon                   (4) | Train Loss: 0.9042 | Train Acc: 0.8081
 Site-sketch                    (1) | Train Loss: 1.1765 | Train Acc: 0.6364
Average Train Accuracy: 0.8629
 Site-photo                     (0) | Val  Loss: 0.4122 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.4173 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.4133 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.4223 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.3665 | Val  Acc: 0.9671
 Site-art_painting              (5) | Val  Loss: 0.6197 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.6506 | Val  Acc: 0.8889
 Site-art_painting              (3) | Val  Loss: 0.7963 | Val  Acc: 0.8451
 Site-cartoon                   (2) | Val  Loss: 0.9217 | Val  Acc: 0.8261
 Site-cartoon                   (4) | Val  Loss: 0.8472 | Val  Acc: 0.8174
 Site-sketch                    (1) | Val  Loss: 1.3277 | Val  Acc: 0.5125
Average Valid Accuracy: 0.8681
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9671
 Best site-art_painting             (5)  | Epoch:10 | Val Acc: 0.9286
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.8889
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.8451
 Best site-cartoon                  (2)  | Epoch:10 | Val Acc: 0.8261
 Best site-cartoon                  (4)  | Epoch:10 | Val Acc: 0.8174
 Best site-sketch                   (1)  | Epoch:10 | Val Acc: 0.5125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 1, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (4) | Train Loss: 0.4410 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.3312 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.3392 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.3826 | Train Acc: 0.9608
 Site-photo                     (4) | Train Loss: 0.3816 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.7752 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.7225 | Train Acc: 0.8105
 Site-art_painting              (0) | Train Loss: 0.6444 | Train Acc: 0.8873
 Site-cartoon                   (2) | Train Loss: 0.8850 | Train Acc: 0.7353
 Site-cartoon                   (5) | Train Loss: 0.8231 | Train Acc: 0.8081
 Site-sketch                    (1) | Train Loss: 1.0643 | Train Acc: 0.6777
Average Train Accuracy: 0.8730
 Site-photo                     (4) | Val  Loss: 0.4002 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.4056 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.3822 | Val  Acc: 0.9412
 Site-photo                     (3) | Val  Loss: 0.3752 | Val  Acc: 0.9412
 Site-photo                     (4) | Val  Loss: 0.3251 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.5012 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.5934 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.7810 | Val  Acc: 0.8592
 Site-cartoon                   (2) | Val  Loss: 0.8496 | Val  Acc: 0.8696
 Site-cartoon                   (5) | Val  Loss: 0.7911 | Val  Acc: 0.8522
 Site-sketch                    (1) | Val  Loss: 1.1427 | Val  Acc: 0.6250
Average Valid Accuracy: 0.8907
 Best site-photo                    (4)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9412
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9412
 Best site-photo                    (4)  | Epoch:11 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.9048
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8592
 Best site-cartoon                  (2)  | Epoch:11 | Val Acc: 0.8696
 Best site-cartoon                  (5)  | Epoch:11 | Val Acc: 0.8522
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.6250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 12 ============
cnt=[3, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (3) | Train Loss: 0.3807 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3704 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.2825 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.3286 | Train Acc: 0.9542
 Site-photo                     (3) | Train Loss: 0.3404 | Train Acc: 0.9694
 Site-art_painting              (4) | Train Loss: 0.6714 | Train Acc: 0.9048
 Site-art_painting              (5) | Train Loss: 0.6443 | Train Acc: 0.8737
 Site-art_painting              (4) | Train Loss: 0.5639 | Train Acc: 0.9014
 Site-cartoon                   (1) | Train Loss: 0.8075 | Train Acc: 0.8235
 Site-cartoon                   (1) | Train Loss: 0.8390 | Train Acc: 0.7907
 Site-sketch                    (2) | Train Loss: 1.0372 | Train Acc: 0.6529
Average Train Accuracy: 0.8895
 Site-photo                     (3) | Val  Loss: 0.4061 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3408 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.3526 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.3475 | Val  Acc: 0.9412
 Site-photo                     (3) | Val  Loss: 0.3019 | Val  Acc: 0.9737
 Site-art_painting              (4) | Val  Loss: 0.6110 | Val  Acc: 0.8929
 Site-art_painting              (5) | Val  Loss: 0.5189 | Val  Acc: 0.9206
 Site-art_painting              (4) | Val  Loss: 0.6837 | Val  Acc: 0.8732
 Site-cartoon                   (1) | Val  Loss: 0.8376 | Val  Acc: 0.8261
 Site-cartoon                   (1) | Val  Loss: 0.7391 | Val  Acc: 0.8522
 Site-sketch                    (2) | Val  Loss: 1.2205 | Val  Acc: 0.6125
Average Valid Accuracy: 0.8872
============ Train epoch 13 ============
cnt=[3, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (0) | Train Loss: 0.3379 | Train Acc: 0.9556
 Site-photo                     (4) | Train Loss: 0.2334 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2810 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.3163 | Train Acc: 0.9673
 Site-photo                     (5) | Train Loss: 0.3253 | Train Acc: 0.9607
 Site-art_painting              (3) | Train Loss: 0.6707 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.6989 | Train Acc: 0.8105
 Site-art_painting              (3) | Train Loss: 0.5621 | Train Acc: 0.8967
 Site-cartoon                   (2) | Train Loss: 0.7120 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.7675 | Train Acc: 0.8081
 Site-sketch                    (1) | Train Loss: 0.9495 | Train Acc: 0.6612
Average Train Accuracy: 0.8802
 Site-photo                     (0) | Val  Loss: 0.3614 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.3718 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3228 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.3377 | Val  Acc: 0.9510
 Site-photo                     (5) | Val  Loss: 0.2815 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.5015 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.4695 | Val  Acc: 0.9524
 Site-art_painting              (3) | Val  Loss: 0.6689 | Val  Acc: 0.8662
 Site-cartoon                   (2) | Val  Loss: 0.7211 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.7228 | Val  Acc: 0.8261
 Site-sketch                    (1) | Val  Loss: 1.1248 | Val  Acc: 0.6125
Average Valid Accuracy: 0.8917
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9333
 Best site-photo                    (4)  | Epoch:13 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9510
 Best site-photo                    (5)  | Epoch:13 | Val Acc: 0.9803
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.9286
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.9524
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.8662
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.8696
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.8261
 Best site-sketch                   (1)  | Epoch:13 | Val Acc: 0.6125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 4, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (1) | Train Loss: 0.2962 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2466 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.2339 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.2841 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.2996 | Train Acc: 0.9607
 Site-art_painting              (5) | Train Loss: 0.5976 | Train Acc: 0.8333
 Site-art_painting              (5) | Train Loss: 0.6580 | Train Acc: 0.8421
 Site-art_painting              (5) | Train Loss: 0.5006 | Train Acc: 0.9155
 Site-cartoon                   (2) | Train Loss: 0.7022 | Train Acc: 0.7941
 Site-cartoon                   (0) | Train Loss: 0.7041 | Train Acc: 0.8372
 Site-sketch                    (3) | Train Loss: 0.9370 | Train Acc: 0.7190
Average Train Accuracy: 0.8914
 Site-photo                     (1) | Val  Loss: 0.3500 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.3018 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2917 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.2968 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.2759 | Val  Acc: 0.9737
 Site-art_painting              (5) | Val  Loss: 0.5885 | Val  Acc: 0.8929
 Site-art_painting              (5) | Val  Loss: 0.4907 | Val  Acc: 0.9048
 Site-art_painting              (5) | Val  Loss: 0.6316 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.6850 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.6639 | Val  Acc: 0.8435
 Site-sketch                    (3) | Val  Loss: 1.0854 | Val  Acc: 0.6750
Average Valid Accuracy: 0.8987
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9333
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9559
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9737
 Best site-art_painting             (5)  | Epoch:14 | Val Acc: 0.8929
 Best site-art_painting             (5)  | Epoch:14 | Val Acc: 0.9048
 Best site-art_painting             (5)  | Epoch:14 | Val Acc: 0.8873
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.9130
 Best site-cartoon                  (0)  | Epoch:14 | Val Acc: 0.8435
 Best site-sketch                   (3)  | Epoch:14 | Val Acc: 0.6750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 1, 3, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (4) | Train Loss: 0.3003 | Train Acc: 0.9778
 Site-photo                     (2) | Train Loss: 0.2557 | Train Acc: 0.9412
 Site-photo                     (2) | Train Loss: 0.2466 | Train Acc: 0.9804
 Site-photo                     (2) | Train Loss: 0.2919 | Train Acc: 0.9608
 Site-photo                     (4) | Train Loss: 0.2631 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.6420 | Train Acc: 0.8333
 Site-art_painting              (5) | Train Loss: 0.6425 | Train Acc: 0.8316
 Site-art_painting              (5) | Train Loss: 0.4750 | Train Acc: 0.9061
 Site-cartoon                   (3) | Train Loss: 0.6817 | Train Acc: 0.7647
 Site-cartoon                   (3) | Train Loss: 0.6774 | Train Acc: 0.8547
 Site-sketch                    (1) | Train Loss: 0.8339 | Train Acc: 0.7521
Average Train Accuracy: 0.8884
 Site-photo                     (4) | Val  Loss: 0.3747 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.2901 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.2776 | Val  Acc: 0.9559
 Site-photo                     (2) | Val  Loss: 0.2945 | Val  Acc: 0.9412
 Site-photo                     (4) | Val  Loss: 0.2530 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3742 | Val  Acc: 0.9643
 Site-art_painting              (5) | Val  Loss: 0.4331 | Val  Acc: 0.9524
 Site-art_painting              (5) | Val  Loss: 0.6318 | Val  Acc: 0.8944
 Site-cartoon                   (3) | Val  Loss: 0.6570 | Val  Acc: 0.8696
 Site-cartoon                   (3) | Val  Loss: 0.6050 | Val  Acc: 0.8609
 Site-sketch                    (1) | Val  Loss: 0.9632 | Val  Acc: 0.7125
Average Valid Accuracy: 0.9095
 Best site-photo                    (4)  | Epoch:15 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9559
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9412
 Best site-photo                    (4)  | Epoch:15 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.9643
 Best site-art_painting             (5)  | Epoch:15 | Val Acc: 0.9524
 Best site-art_painting             (5)  | Epoch:15 | Val Acc: 0.8944
 Best site-cartoon                  (3)  | Epoch:15 | Val Acc: 0.8696
 Best site-cartoon                  (3)  | Epoch:15 | Val Acc: 0.8609
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.7125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 4, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (5) | Train Loss: 0.2563 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2370 | Train Acc: 0.9265
 Site-photo                     (1) | Train Loss: 0.2067 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.2462 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.2386 | Train Acc: 0.9738
 Site-art_painting              (4) | Train Loss: 0.5941 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.5210 | Train Acc: 0.8421
 Site-art_painting              (4) | Train Loss: 0.4623 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.6441 | Train Acc: 0.8235
 Site-cartoon                   (3) | Train Loss: 0.6234 | Train Acc: 0.8256
 Site-sketch                    (0) | Train Loss: 0.8221 | Train Acc: 0.7273
Average Train Accuracy: 0.8916
 Site-photo                     (5) | Val  Loss: 0.2947 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.3013 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2388 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.2594 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.2300 | Val  Acc: 0.9737
 Site-art_painting              (4) | Val  Loss: 0.4652 | Val  Acc: 0.8929
 Site-art_painting              (4) | Val  Loss: 0.3366 | Val  Acc: 0.9524
 Site-art_painting              (4) | Val  Loss: 0.5947 | Val  Acc: 0.8944
 Site-cartoon                   (2) | Val  Loss: 0.6846 | Val  Acc: 0.8261
 Site-cartoon                   (3) | Val  Loss: 0.6025 | Val  Acc: 0.8522
 Site-sketch                    (0) | Val  Loss: 1.0190 | Val  Acc: 0.6500
Average Valid Accuracy: 0.8956
============ Train epoch 17 ============
cnt=[5, 1, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (0) | Train Loss: 0.2845 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1955 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2021 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2432 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2285 | Train Acc: 0.9607
 Site-art_painting              (5) | Train Loss: 0.5551 | Train Acc: 0.8333
 Site-art_painting              (5) | Train Loss: 0.4587 | Train Acc: 0.8842
 Site-art_painting              (4) | Train Loss: 0.4405 | Train Acc: 0.9202
 Site-cartoon                   (3) | Train Loss: 0.6303 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.6151 | Train Acc: 0.8314
 Site-sketch                    (1) | Train Loss: 0.7709 | Train Acc: 0.7438
Average Train Accuracy: 0.9007
 Site-photo                     (0) | Val  Loss: 0.2446 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2859 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2344 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.2570 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.2142 | Val  Acc: 0.9803
 Site-art_painting              (5) | Val  Loss: 0.5269 | Val  Acc: 0.8571
 Site-art_painting              (5) | Val  Loss: 0.3572 | Val  Acc: 0.9524
 Site-art_painting              (4) | Val  Loss: 0.5581 | Val  Acc: 0.9014
 Site-cartoon                   (3) | Val  Loss: 0.6187 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.5418 | Val  Acc: 0.8870
 Site-sketch                    (1) | Val  Loss: 1.0957 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9010
============ Train epoch 18 ============
cnt=[2, 1, 1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (4) | Train Loss: 0.2582 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1783 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.1679 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.2074 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.2449 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.5361 | Train Acc: 0.8810
 Site-art_painting              (4) | Train Loss: 0.5738 | Train Acc: 0.8526
 Site-art_painting              (0) | Train Loss: 0.4159 | Train Acc: 0.8967
 Site-cartoon                   (1) | Train Loss: 0.5932 | Train Acc: 0.8235
 Site-cartoon                   (5) | Train Loss: 0.5973 | Train Acc: 0.8605
 Site-sketch                    (2) | Train Loss: 0.7612 | Train Acc: 0.7603
Average Train Accuracy: 0.9028
 Site-photo                     (4) | Val  Loss: 0.3443 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2467 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2246 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.2509 | Val  Acc: 0.9510
 Site-photo                     (3) | Val  Loss: 0.2041 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.4388 | Val  Acc: 0.8929
 Site-art_painting              (4) | Val  Loss: 0.3487 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.5001 | Val  Acc: 0.9014
 Site-cartoon                   (1) | Val  Loss: 0.5822 | Val  Acc: 0.9130
 Site-cartoon                   (5) | Val  Loss: 0.5106 | Val  Acc: 0.8696
 Site-sketch                    (2) | Val  Loss: 1.0265 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9096
 Best site-photo                    (4)  | Epoch:18 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:18 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:18 | Val Acc: 0.9559
 Best site-photo                    (3)  | Epoch:18 | Val Acc: 0.9510
 Best site-photo                    (3)  | Epoch:18 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.8929
 Best site-art_painting             (4)  | Epoch:18 | Val Acc: 0.9524
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.9014
 Best site-cartoon                  (1)  | Epoch:18 | Val Acc: 0.9130
 Best site-cartoon                  (5)  | Epoch:18 | Val Acc: 0.8696
 Best site-sketch                   (2)  | Epoch:18 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 19 ============
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (3) | Train Loss: 0.2353 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.3581 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.1730 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.2116 | Train Acc: 0.9673
 Site-photo                     (5) | Train Loss: 0.2141 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 0.5505 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.4709 | Train Acc: 0.8737
 Site-art_painting              (0) | Train Loss: 0.4588 | Train Acc: 0.9249
 Site-cartoon                   (2) | Train Loss: 0.5794 | Train Acc: 0.8529
 Site-cartoon                   (4) | Train Loss: 0.5487 | Train Acc: 0.8663
 Site-sketch                    (1) | Train Loss: 0.7287 | Train Acc: 0.7521
Average Train Accuracy: 0.9028
 Site-photo                     (3) | Val  Loss: 0.2999 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2161 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2129 | Val  Acc: 0.9412
 Site-photo                     (3) | Val  Loss: 0.1977 | Val  Acc: 0.9608
 Site-photo                     (5) | Val  Loss: 0.1966 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.3414 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.4129 | Val  Acc: 0.8730
 Site-art_painting              (0) | Val  Loss: 0.4678 | Val  Acc: 0.9014
 Site-cartoon                   (2) | Val  Loss: 0.6074 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.4882 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.8958 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9099
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9412
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9608
 Best site-photo                    (5)  | Epoch:19 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:19 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:19 | Val Acc: 0.8730
 Best site-art_painting             (0)  | Epoch:19 | Val Acc: 0.9014
 Best site-cartoon                  (2)  | Epoch:19 | Val Acc: 0.8696
 Best site-cartoon                  (4)  | Epoch:19 | Val Acc: 0.9217
 Best site-sketch                   (1)  | Epoch:19 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 1, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (4) | Train Loss: 0.1819 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1494 | Train Acc: 0.9559
 Site-photo                     (4) | Train Loss: 0.1520 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.2322 | Train Acc: 0.9477
 Site-photo                     (4) | Train Loss: 0.2103 | Train Acc: 0.9563
 Site-art_painting              (3) | Train Loss: 0.4659 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.3732 | Train Acc: 0.9053
 Site-art_painting              (3) | Train Loss: 0.3319 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.5729 | Train Acc: 0.7941
 Site-cartoon                   (5) | Train Loss: 0.5471 | Train Acc: 0.8372
 Site-sketch                    (1) | Train Loss: 0.7714 | Train Acc: 0.7273
Average Train Accuracy: 0.9000
 Site-photo                     (4) | Val  Loss: 0.2749 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.2135 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.1587 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.1858 | Val  Acc: 0.9510
 Site-photo                     (4) | Val  Loss: 0.1587 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.4007 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.3617 | Val  Acc: 0.9048
 Site-art_painting              (3) | Val  Loss: 0.4627 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.5176 | Val  Acc: 0.9565
 Site-cartoon                   (5) | Val  Loss: 0.5168 | Val  Acc: 0.9043
 Site-sketch                    (1) | Val  Loss: 0.8822 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9126
 Best site-photo                    (4)  | Epoch:20 | Val Acc: 0.9000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:20 | Val Acc: 0.9706
 Best site-photo                    (4)  | Epoch:20 | Val Acc: 0.9510
 Best site-photo                    (4)  | Epoch:20 | Val Acc: 0.9803
 Best site-art_painting             (3)  | Epoch:20 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.9048
 Best site-art_painting             (3)  | Epoch:20 | Val Acc: 0.9225
 Best site-cartoon                  (2)  | Epoch:20 | Val Acc: 0.9565
 Best site-cartoon                  (5)  | Epoch:20 | Val Acc: 0.9043
 Best site-sketch                   (1)  | Epoch:20 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 1, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (3) | Train Loss: 0.2331 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.1797 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.1352 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1849 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.1962 | Train Acc: 0.9738
 Site-art_painting              (4) | Train Loss: 0.5225 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.4724 | Train Acc: 0.8632
 Site-art_painting              (0) | Train Loss: 0.3525 | Train Acc: 0.9296
 Site-cartoon                   (2) | Train Loss: 0.5583 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.5195 | Train Acc: 0.8663
 Site-sketch                    (1) | Train Loss: 0.6687 | Train Acc: 0.7686
Average Train Accuracy: 0.9096
 Site-photo                     (3) | Val  Loss: 0.3056 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2103 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.1718 | Val  Acc: 0.9559
 Site-photo                     (5) | Val  Loss: 0.1751 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1646 | Val  Acc: 0.9737
 Site-art_painting              (4) | Val  Loss: 0.3442 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.3176 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.4879 | Val  Acc: 0.9155
 Site-cartoon                   (2) | Val  Loss: 0.5267 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.4682 | Val  Acc: 0.8870
 Site-sketch                    (1) | Val  Loss: 0.9122 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9187
 Best site-photo                    (3)  | Epoch:21 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:21 | Val Acc: 0.9778
 Best site-photo                    (3)  | Epoch:21 | Val Acc: 0.9559
 Best site-photo                    (5)  | Epoch:21 | Val Acc: 0.9706
 Best site-photo                    (3)  | Epoch:21 | Val Acc: 0.9737
 Best site-art_painting             (4)  | Epoch:21 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.9524
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.9155
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.8870
 Best site-sketch                   (1)  | Epoch:21 | Val Acc: 0.6625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 22 ============
cnt=[3, 1, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.1832 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1553 | Train Acc: 0.9706
 Site-photo                     (5) | Train Loss: 0.1306 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1739 | Train Acc: 0.9608
 Site-photo                     (5) | Train Loss: 0.1882 | Train Acc: 0.9651
 Site-art_painting              (4) | Train Loss: 0.5071 | Train Acc: 0.8571
 Site-art_painting              (4) | Train Loss: 0.4340 | Train Acc: 0.8947
 Site-art_painting              (4) | Train Loss: 0.3275 | Train Acc: 0.9249
 Site-cartoon                   (2) | Train Loss: 0.6436 | Train Acc: 0.7647
 Site-cartoon                   (3) | Train Loss: 0.5515 | Train Acc: 0.8256
 Site-sketch                    (1) | Train Loss: 0.6335 | Train Acc: 0.8099
Average Train Accuracy: 0.9026
 Site-photo                     (0) | Val  Loss: 0.2078 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2491 | Val  Acc: 0.9333
 Site-photo                     (5) | Val  Loss: 0.1766 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1879 | Val  Acc: 0.9608
 Site-photo                     (5) | Val  Loss: 0.1564 | Val  Acc: 0.9868
 Site-art_painting              (4) | Val  Loss: 0.2846 | Val  Acc: 0.9643
 Site-art_painting              (4) | Val  Loss: 0.3336 | Val  Acc: 0.8730
 Site-art_painting              (4) | Val  Loss: 0.4061 | Val  Acc: 0.9366
 Site-cartoon                   (2) | Val  Loss: 0.4998 | Val  Acc: 0.8696
 Site-cartoon                   (3) | Val  Loss: 0.4443 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.9327 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9099
============ Train epoch 23 ============
cnt=[3, 1, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (5) | Train Loss: 0.1801 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.2195 | Train Acc: 0.9706
 Site-photo                     (5) | Train Loss: 0.1461 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1691 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.1692 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4862 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.4541 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.3481 | Train Acc: 0.9249
 Site-cartoon                   (1) | Train Loss: 0.5925 | Train Acc: 0.8529
 Site-cartoon                   (4) | Train Loss: 0.4800 | Train Acc: 0.9012
 Site-sketch                    (2) | Train Loss: 0.6453 | Train Acc: 0.7686
Average Train Accuracy: 0.9215
 Site-photo                     (5) | Val  Loss: 0.2531 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.2375 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1720 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.1619 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1443 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3656 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.3132 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.4457 | Val  Acc: 0.9225
 Site-cartoon                   (1) | Val  Loss: 0.5247 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.4540 | Val  Acc: 0.8957
 Site-sketch                    (2) | Val  Loss: 0.9081 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9077
============ Train epoch 24 ============
cnt=[2, 1, 1, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (5) | Train Loss: 0.1921 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2321 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1403 | Train Acc: 0.9804
 Site-photo                     (5) | Train Loss: 0.1487 | Train Acc: 0.9804
 Site-photo                     (5) | Train Loss: 0.1720 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.4722 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.3776 | Train Acc: 0.8947
 Site-art_painting              (3) | Train Loss: 0.3351 | Train Acc: 0.9108
 Site-cartoon                   (2) | Train Loss: 0.5177 | Train Acc: 0.7941
 Site-cartoon                   (4) | Train Loss: 0.4549 | Train Acc: 0.8953
 Site-sketch                    (1) | Train Loss: 0.6092 | Train Acc: 0.8017
Average Train Accuracy: 0.9085
 Site-photo                     (5) | Val  Loss: 0.1925 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.2748 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1482 | Val  Acc: 0.9706
 Site-photo                     (5) | Val  Loss: 0.1686 | Val  Acc: 0.9510
 Site-photo                     (5) | Val  Loss: 0.1366 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.3411 | Val  Acc: 0.8929
 Site-art_painting              (3) | Val  Loss: 0.2716 | Val  Acc: 0.9206
 Site-art_painting              (3) | Val  Loss: 0.4395 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.5315 | Val  Acc: 0.8261
 Site-cartoon                   (4) | Val  Loss: 0.4041 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.8654 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9156
============ Train epoch 25 ============
cnt=[1, 4, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (1) | Train Loss: 0.1677 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1142 | Train Acc: 0.9706
 Site-photo                     (5) | Train Loss: 0.1327 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1628 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1692 | Train Acc: 0.9651
 Site-art_painting              (3) | Train Loss: 0.4907 | Train Acc: 0.8571
 Site-art_painting              (3) | Train Loss: 0.4114 | Train Acc: 0.8842
 Site-art_painting              (3) | Train Loss: 0.3545 | Train Acc: 0.9014
 Site-cartoon                   (4) | Train Loss: 0.4593 | Train Acc: 0.9118
 Site-cartoon                   (0) | Train Loss: 0.4308 | Train Acc: 0.8895
 Site-sketch                    (2) | Train Loss: 0.6678 | Train Acc: 0.8017
Average Train Accuracy: 0.9197
 Site-photo                     (1) | Val  Loss: 0.2609 | Val  Acc: 0.9000
 Site-photo                     (1) | Val  Loss: 0.2364 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1534 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.1638 | Val  Acc: 0.9608
 Site-photo                     (1) | Val  Loss: 0.1553 | Val  Acc: 0.9737
 Site-art_painting              (3) | Val  Loss: 0.2119 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2326 | Val  Acc: 0.9841
 Site-art_painting              (3) | Val  Loss: 0.3479 | Val  Acc: 0.9648
 Site-cartoon                   (4) | Val  Loss: 0.4749 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.3819 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.9335 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9237
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.9000
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.9556
 Best site-photo                    (5)  | Epoch:25 | Val Acc: 0.9559
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.9608
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.9737
 Best site-art_painting             (3)  | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:25 | Val Acc: 0.9841
 Best site-art_painting             (3)  | Epoch:25 | Val Acc: 0.9648
 Best site-cartoon                  (4)  | Epoch:25 | Val Acc: 0.8696
 Best site-cartoon                  (0)  | Epoch:25 | Val Acc: 0.9217
 Best site-sketch                   (2)  | Epoch:25 | Val Acc: 0.6750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 5, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (1) | Train Loss: 0.1403 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1730 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.1023 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1426 | Train Acc: 0.9608
 Site-photo                     (1) | Train Loss: 0.1614 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.3324 | Train Acc: 0.9048
 Site-art_painting              (4) | Train Loss: 0.4067 | Train Acc: 0.9158
 Site-art_painting              (4) | Train Loss: 0.2821 | Train Acc: 0.9343
 Site-cartoon                   (5) | Train Loss: 0.4793 | Train Acc: 0.9118
 Site-cartoon                   (0) | Train Loss: 0.4427 | Train Acc: 0.9070
 Site-sketch                    (2) | Train Loss: 0.6323 | Train Acc: 0.7686
Average Train Accuracy: 0.9290
 Site-photo                     (1) | Val  Loss: 0.2945 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2368 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1431 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1554 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.1355 | Val  Acc: 0.9737
 Site-art_painting              (3) | Val  Loss: 0.2045 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.2570 | Val  Acc: 0.9524
 Site-art_painting              (4) | Val  Loss: 0.3910 | Val  Acc: 0.9225
 Site-cartoon                   (5) | Val  Loss: 0.4422 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.4134 | Val  Acc: 0.8870
 Site-sketch                    (2) | Val  Loss: 0.8992 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9241
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9737
 Best site-art_painting             (3)  | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting             (4)  | Epoch:26 | Val Acc: 0.9524
 Best site-art_painting             (4)  | Epoch:26 | Val Acc: 0.9225
 Best site-cartoon                  (5)  | Epoch:26 | Val Acc: 0.8696
 Best site-cartoon                  (0)  | Epoch:26 | Val Acc: 0.8870
 Best site-sketch                   (2)  | Epoch:26 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 2, 1, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (5) | Train Loss: 0.1540 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1079 | Train Acc: 0.9706
 Site-photo                     (5) | Train Loss: 0.1066 | Train Acc: 0.9902
 Site-photo                     (5) | Train Loss: 0.1658 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1659 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.5332 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.3712 | Train Acc: 0.9053
 Site-art_painting              (3) | Train Loss: 0.2836 | Train Acc: 0.9343
 Site-cartoon                   (0) | Train Loss: 0.4610 | Train Acc: 0.8824
 Site-cartoon                   (4) | Train Loss: 0.4411 | Train Acc: 0.8605
 Site-sketch                    (2) | Train Loss: 0.6295 | Train Acc: 0.7851
Average Train Accuracy: 0.9164
 Site-photo                     (5) | Val  Loss: 0.1984 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2102 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1337 | Val  Acc: 0.9559
 Site-photo                     (5) | Val  Loss: 0.1518 | Val  Acc: 0.9608
 Site-photo                     (1) | Val  Loss: 0.1313 | Val  Acc: 0.9934
 Site-art_painting              (3) | Val  Loss: 0.2479 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.2274 | Val  Acc: 0.9524
 Site-art_painting              (3) | Val  Loss: 0.3334 | Val  Acc: 0.9437
 Site-cartoon                   (0) | Val  Loss: 0.5325 | Val  Acc: 0.8261
 Site-cartoon                   (4) | Val  Loss: 0.4147 | Val  Acc: 0.9043
 Site-sketch                    (2) | Val  Loss: 0.8159 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9218
============ Train epoch 28 ============
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (3) | Train Loss: 0.1461 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1521 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.1090 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1723 | Train Acc: 0.9739
 Site-photo                     (5) | Train Loss: 0.1485 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4936 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.3334 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.2786 | Train Acc: 0.9249
 Site-cartoon                   (2) | Train Loss: 0.5242 | Train Acc: 0.8235
 Site-cartoon                   (4) | Train Loss: 0.4174 | Train Acc: 0.9012
 Site-sketch                    (1) | Train Loss: 0.5450 | Train Acc: 0.8099
Average Train Accuracy: 0.9161
 Site-photo                     (3) | Val  Loss: 0.2462 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2529 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1402 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1677 | Val  Acc: 0.9608
 Site-photo                     (5) | Val  Loss: 0.1193 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2455 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.2075 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.2875 | Val  Acc: 0.9437
 Site-cartoon                   (2) | Val  Loss: 0.4486 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.3778 | Val  Acc: 0.9043
 Site-sketch                    (1) | Val  Loss: 0.8924 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9237
============ Train epoch 29 ============
cnt=[3, 1, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (5) | Train Loss: 0.1383 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.0857 | Train Acc: 0.9706
 Site-photo                     (5) | Train Loss: 0.1195 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1401 | Train Acc: 0.9608
 Site-photo                     (3) | Train Loss: 0.1583 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4693 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.4223 | Train Acc: 0.8842
 Site-art_painting              (0) | Train Loss: 0.2858 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.4396 | Train Acc: 0.9118
 Site-cartoon                   (4) | Train Loss: 0.4183 | Train Acc: 0.9070
 Site-sketch                    (1) | Train Loss: 0.5644 | Train Acc: 0.7769
Average Train Accuracy: 0.9183
 Site-photo                     (5) | Val  Loss: 0.2045 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2012 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1274 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1456 | Val  Acc: 0.9510
 Site-photo                     (3) | Val  Loss: 0.1220 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2533 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.1982 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.4173 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.4172 | Val  Acc: 0.9565
 Site-cartoon                   (4) | Val  Loss: 0.3494 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.8308 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9313
 Best site-photo                    (5)  | Epoch:29 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9556
 Best site-photo                    (5)  | Epoch:29 | Val Acc: 0.9706
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9510
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9841
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9296
 Best site-cartoon                  (2)  | Epoch:29 | Val Acc: 0.9565
 Best site-cartoon                  (4)  | Epoch:29 | Val Acc: 0.9217
 Best site-sketch                   (1)  | Epoch:29 | Val Acc: 0.7625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 30 ============
cnt=[1, 4, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (5) | Train Loss: 0.1478 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1282 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0914 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1281 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.1581 | Train Acc: 0.9607
 Site-art_painting              (4) | Train Loss: 0.3617 | Train Acc: 0.8810
 Site-art_painting              (4) | Train Loss: 0.3038 | Train Acc: 0.9263
 Site-art_painting              (4) | Train Loss: 0.2531 | Train Acc: 0.9484
 Site-cartoon                   (0) | Train Loss: 0.4803 | Train Acc: 0.8235
 Site-cartoon                   (3) | Train Loss: 0.4115 | Train Acc: 0.9012
 Site-sketch                    (2) | Train Loss: 0.5392 | Train Acc: 0.8182
Average Train Accuracy: 0.9234
 Site-photo                     (5) | Val  Loss: 0.1995 | Val  Acc: 0.9667
 Site-photo                     (1) | Val  Loss: 0.1783 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1208 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1286 | Val  Acc: 0.9608
 Site-photo                     (1) | Val  Loss: 0.1229 | Val  Acc: 0.9868
 Site-art_painting              (4) | Val  Loss: 0.2244 | Val  Acc: 0.9643
 Site-art_painting              (4) | Val  Loss: 0.1881 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.3325 | Val  Acc: 0.9296
 Site-cartoon                   (0) | Val  Loss: 0.4653 | Val  Acc: 0.8696
 Site-cartoon                   (3) | Val  Loss: 0.3494 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.8773 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9285
============ Train epoch 31 ============
cnt=[3, 1, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (3) | Train Loss: 0.1466 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.5614 | Train Acc: 0.9559
 Site-photo                     (5) | Train Loss: 0.0918 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1453 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.1401 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4224 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3617 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2713 | Train Acc: 0.9484
 Site-cartoon                   (1) | Train Loss: 0.5113 | Train Acc: 0.8529
 Site-cartoon                   (4) | Train Loss: 0.3878 | Train Acc: 0.8895
 Site-sketch                    (2) | Train Loss: 0.4890 | Train Acc: 0.8760
Average Train Accuracy: 0.9267
 Site-photo                     (3) | Val  Loss: 0.2605 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2274 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1173 | Val  Acc: 0.9706
 Site-photo                     (5) | Val  Loss: 0.1436 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1235 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.1994 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2656 | Val  Acc: 0.9365
 Site-art_painting              (0) | Val  Loss: 0.3753 | Val  Acc: 0.9366
 Site-cartoon                   (1) | Val  Loss: 0.3905 | Val  Acc: 0.9130
 Site-cartoon                   (4) | Val  Loss: 0.3307 | Val  Acc: 0.9565
 Site-sketch                    (2) | Val  Loss: 0.7260 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9336
 Best site-photo                    (3)  | Epoch:31 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:31 | Val Acc: 0.9556
 Best site-photo                    (5)  | Epoch:31 | Val Acc: 0.9706
 Best site-photo                    (5)  | Epoch:31 | Val Acc: 0.9706
 Best site-photo                    (3)  | Epoch:31 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9365
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9366
 Best site-cartoon                  (1)  | Epoch:31 | Val Acc: 0.9130
 Best site-cartoon                  (4)  | Epoch:31 | Val Acc: 0.9565
 Best site-sketch                   (2)  | Epoch:31 | Val Acc: 0.7875
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 32 ============
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (4) | Train Loss: 0.1203 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.4476 | Train Acc: 0.9559
 Site-photo                     (4) | Train Loss: 0.1008 | Train Acc: 0.9902
 Site-photo                     (4) | Train Loss: 0.1289 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1413 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.4645 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.3382 | Train Acc: 0.8947
 Site-art_painting              (3) | Train Loss: 0.2613 | Train Acc: 0.9202
 Site-cartoon                   (1) | Train Loss: 0.5044 | Train Acc: 0.7941
 Site-cartoon                   (5) | Train Loss: 0.3700 | Train Acc: 0.8953
 Site-sketch                    (2) | Train Loss: 0.5326 | Train Acc: 0.7934
Average Train Accuracy: 0.9110
 Site-photo                     (4) | Val  Loss: 0.1823 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.2369 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.1370 | Val  Acc: 0.9559
 Site-photo                     (4) | Val  Loss: 0.1373 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1225 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.2015 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.1797 | Val  Acc: 0.9841
 Site-art_painting              (3) | Val  Loss: 0.3278 | Val  Acc: 0.9366
 Site-cartoon                   (1) | Val  Loss: 0.4124 | Val  Acc: 0.8696
 Site-cartoon                   (5) | Val  Loss: 0.3398 | Val  Acc: 0.9130
 Site-sketch                    (2) | Val  Loss: 0.8542 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9276
============ Train epoch 33 ============
cnt=[3, 1, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (4) | Train Loss: 0.1939 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.1108 | Train Acc: 0.9853
 Site-photo                     (4) | Train Loss: 0.1039 | Train Acc: 0.9902
 Site-photo                     (4) | Train Loss: 0.1137 | Train Acc: 0.9739
 Site-photo                     (4) | Train Loss: 0.1517 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.4018 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.2906 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2567 | Train Acc: 0.9108
 Site-cartoon                   (1) | Train Loss: 0.4338 | Train Acc: 0.8529
 Site-cartoon                   (5) | Train Loss: 0.3859 | Train Acc: 0.9070
 Site-sketch                    (2) | Train Loss: 0.5469 | Train Acc: 0.8017
Average Train Accuracy: 0.9246
 Site-photo                     (4) | Val  Loss: 0.1302 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.1330 | Val  Acc: 0.9778
 Site-photo                     (4) | Val  Loss: 0.0981 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.1349 | Val  Acc: 0.9608
 Site-photo                     (4) | Val  Loss: 0.0932 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.2478 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2135 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.2892 | Val  Acc: 0.9437
 Site-cartoon                   (1) | Val  Loss: 0.4834 | Val  Acc: 0.9130
 Site-cartoon                   (5) | Val  Loss: 0.3399 | Val  Acc: 0.9565
 Site-sketch                    (2) | Val  Loss: 0.7901 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9383
 Best site-photo                    (4)  | Epoch:33 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9778
 Best site-photo                    (4)  | Epoch:33 | Val Acc: 0.9706
 Best site-photo                    (4)  | Epoch:33 | Val Acc: 0.9608
 Best site-photo                    (4)  | Epoch:33 | Val Acc: 0.9934
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9683
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9437
 Best site-cartoon                  (1)  | Epoch:33 | Val Acc: 0.9130
 Best site-cartoon                  (5)  | Epoch:33 | Val Acc: 0.9565
 Best site-sketch                   (2)  | Epoch:33 | Val Acc: 0.7750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 34 ============
cnt=[3, 1, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (4) | Train Loss: 0.1774 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1495 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0842 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1222 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1463 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.4026 | Train Acc: 0.8571
 Site-art_painting              (5) | Train Loss: 0.3782 | Train Acc: 0.9053
 Site-art_painting              (5) | Train Loss: 0.2260 | Train Acc: 0.9437
 Site-cartoon                   (2) | Train Loss: 0.4328 | Train Acc: 0.8824
 Site-cartoon                   (2) | Train Loss: 0.3605 | Train Acc: 0.9244
 Site-sketch                    (1) | Train Loss: 0.5596 | Train Acc: 0.7769
Average Train Accuracy: 0.9249
 Site-photo                     (4) | Val  Loss: 0.1649 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2199 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1162 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.1169 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.1142 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.2262 | Val  Acc: 0.9286
 Site-art_painting              (5) | Val  Loss: 0.2371 | Val  Acc: 0.9365
 Site-art_painting              (5) | Val  Loss: 0.2556 | Val  Acc: 0.9437
 Site-cartoon                   (2) | Val  Loss: 0.3573 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.3353 | Val  Acc: 0.9043
 Site-sketch                    (1) | Val  Loss: 0.8258 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9287
============ Train epoch 35 ============
cnt=[2, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (3) | Train Loss: 0.1399 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1614 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.0976 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1358 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.1313 | Train Acc: 0.9694
 Site-art_painting              (5) | Train Loss: 0.3008 | Train Acc: 0.9524
 Site-art_painting              (0) | Train Loss: 0.3524 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2339 | Train Acc: 0.9343
 Site-cartoon                   (4) | Train Loss: 0.4178 | Train Acc: 0.8824
 Site-cartoon                   (2) | Train Loss: 0.3899 | Train Acc: 0.8953
 Site-sketch                    (1) | Train Loss: 0.4739 | Train Acc: 0.8430
Average Train Accuracy: 0.9353
 Site-photo                     (3) | Val  Loss: 0.1669 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.1765 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1036 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1521 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.1119 | Val  Acc: 0.9803
 Site-art_painting              (5) | Val  Loss: 0.1370 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.1587 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.3288 | Val  Acc: 0.9155
 Site-cartoon                   (4) | Val  Loss: 0.3341 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.3295 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.6822 | Val  Acc: 0.7375
Average Valid Accuracy: 0.9440
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9667
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9706
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9608
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9803
 Best site-art_painting             (5)  | Epoch:35 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9841
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9155
 Best site-cartoon                  (4)  | Epoch:35 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:35 | Val Acc: 0.9130
 Best site-sketch                   (1)  | Epoch:35 | Val Acc: 0.7375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (3) | Train Loss: 0.1626 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.1169 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.0987 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.1475 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.1049 | Train Acc: 0.9869
 Site-art_painting              (5) | Train Loss: 0.3879 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.3000 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.2582 | Train Acc: 0.9155
 Site-cartoon                   (4) | Train Loss: 0.4581 | Train Acc: 0.8824
 Site-cartoon                   (2) | Train Loss: 0.3344 | Train Acc: 0.9360
 Site-sketch                    (1) | Train Loss: 0.5074 | Train Acc: 0.8264
Average Train Accuracy: 0.9312
 Site-photo                     (3) | Val  Loss: 0.1733 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.1818 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1214 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1393 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1039 | Val  Acc: 0.9803
 Site-art_painting              (5) | Val  Loss: 0.1579 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2030 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.2834 | Val  Acc: 0.9225
 Site-cartoon                   (4) | Val  Loss: 0.2987 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3191 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.6484 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9287
============ Train epoch 37 ============
cnt=[2, 1, 1, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (0) | Train Loss: 0.1200 | Train Acc: 0.9778
 Site-photo                     (5) | Train Loss: 0.1368 | Train Acc: 0.9706
 Site-photo                     (5) | Train Loss: 0.1029 | Train Acc: 0.9804
 Site-photo                     (5) | Train Loss: 0.1394 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1102 | Train Acc: 0.9782
 Site-art_painting              (3) | Train Loss: 0.4131 | Train Acc: 0.9048
 Site-art_painting              (3) | Train Loss: 0.3071 | Train Acc: 0.9263
 Site-art_painting              (3) | Train Loss: 0.2116 | Train Acc: 0.9671
 Site-cartoon                   (2) | Train Loss: 0.3848 | Train Acc: 0.9118
 Site-cartoon                   (4) | Train Loss: 0.3056 | Train Acc: 0.9477
 Site-sketch                    (1) | Train Loss: 0.4522 | Train Acc: 0.8347
Average Train Accuracy: 0.9424
 Site-photo                     (0) | Val  Loss: 0.1235 | Val  Acc: 0.9667
 Site-photo                     (5) | Val  Loss: 0.1481 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.0993 | Val  Acc: 0.9706
 Site-photo                     (5) | Val  Loss: 0.1165 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1144 | Val  Acc: 0.9934
 Site-art_painting              (3) | Val  Loss: 0.1682 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.1763 | Val  Acc: 0.9841
 Site-art_painting              (3) | Val  Loss: 0.2788 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.4222 | Val  Acc: 0.9565
 Site-cartoon                   (4) | Val  Loss: 0.3091 | Val  Acc: 0.9043
 Site-sketch                    (1) | Val  Loss: 0.7747 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9428
============ Train epoch 38 ============
cnt=[1, 3, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (1) | Train Loss: 0.1465 | Train Acc: 0.9778
 Site-photo                     (4) | Train Loss: 0.1316 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0821 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1540 | Train Acc: 0.9673
 Site-photo                     (4) | Train Loss: 0.1078 | Train Acc: 0.9782
 Site-art_painting              (3) | Train Loss: 0.3957 | Train Acc: 0.8810
 Site-art_painting              (3) | Train Loss: 0.2743 | Train Acc: 0.9158
 Site-art_painting              (3) | Train Loss: 0.2145 | Train Acc: 0.9531
 Site-cartoon                   (0) | Train Loss: 0.4132 | Train Acc: 0.8824
 Site-cartoon                   (5) | Train Loss: 0.3602 | Train Acc: 0.9186
 Site-sketch                    (2) | Train Loss: 0.4578 | Train Acc: 0.8512
Average Train Accuracy: 0.9338
 Site-photo                     (1) | Val  Loss: 0.2060 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.1477 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.0940 | Val  Acc: 0.9853
 Site-photo                     (1) | Val  Loss: 0.1025 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.1000 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.1995 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.2037 | Val  Acc: 0.9683
 Site-art_painting              (3) | Val  Loss: 0.2846 | Val  Acc: 0.9296
 Site-cartoon                   (0) | Val  Loss: 0.3033 | Val  Acc: 0.9565
 Site-cartoon                   (5) | Val  Loss: 0.3089 | Val  Acc: 0.9304
 Site-sketch                    (2) | Val  Loss: 0.8056 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9408
============ Train epoch 39 ============
cnt=[3, 1, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (5) | Train Loss: 0.1143 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1183 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0663 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1330 | Train Acc: 0.9804
 Site-photo                     (5) | Train Loss: 0.1221 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.4079 | Train Acc: 0.8571
 Site-art_painting              (3) | Train Loss: 0.2943 | Train Acc: 0.9474
 Site-art_painting              (3) | Train Loss: 0.2111 | Train Acc: 0.9390
 Site-cartoon                   (1) | Train Loss: 0.3912 | Train Acc: 0.9412
 Site-cartoon                   (4) | Train Loss: 0.3192 | Train Acc: 0.9419
 Site-sketch                    (2) | Train Loss: 0.5366 | Train Acc: 0.8347
Average Train Accuracy: 0.9422
 Site-photo                     (5) | Val  Loss: 0.1706 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1563 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1046 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1205 | Val  Acc: 0.9804
 Site-photo                     (5) | Val  Loss: 0.0924 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.1586 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.1883 | Val  Acc: 0.9683
 Site-art_painting              (3) | Val  Loss: 0.3720 | Val  Acc: 0.9296
 Site-cartoon                   (1) | Val  Loss: 0.3476 | Val  Acc: 0.9565
 Site-cartoon                   (4) | Val  Loss: 0.3052 | Val  Acc: 0.9304
 Site-sketch                    (2) | Val  Loss: 0.7706 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9392
============ Train epoch 40 ============
cnt=[1, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (1) | Train Loss: 0.1086 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.0677 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.0809 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.1461 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1190 | Train Acc: 0.9738
 Site-art_painting              (5) | Train Loss: 0.3828 | Train Acc: 0.8810
 Site-art_painting              (3) | Train Loss: 0.2455 | Train Acc: 0.9579
 Site-art_painting              (3) | Train Loss: 0.2248 | Train Acc: 0.9343
 Site-cartoon                   (4) | Train Loss: 0.3977 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.2998 | Train Acc: 0.9419
 Site-sketch                    (0) | Train Loss: 0.4286 | Train Acc: 0.8843
Average Train Accuracy: 0.9451
 Site-photo                     (1) | Val  Loss: 0.1038 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1539 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.1035 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1242 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1142 | Val  Acc: 0.9934
 Site-art_painting              (5) | Val  Loss: 0.1966 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.2262 | Val  Acc: 0.9206
 Site-art_painting              (3) | Val  Loss: 0.2989 | Val  Acc: 0.9366
 Site-cartoon                   (4) | Val  Loss: 0.2448 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.2853 | Val  Acc: 0.9217
 Site-sketch                    (0) | Val  Loss: 0.7111 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9422
 Test site-photo                     (1)| Epoch:35 | Test Acc: 0.9925
 Test site-art_painting              (5)| Epoch:35 | Test Acc: 0.9074
 Test site-cartoon                   (4)| Epoch:35 | Test Acc: 0.8819
 Test site-sketch                    (0)| Epoch:35 | Test Acc: 0.7986
photo: 0.9925, art_painting: 0.9074, cartoon: 0.8819, sketch: 0.7986, 
Average Test Accuracy(group): 0.8951, Average Test Accuracy(individual): 0.9316,
domain std=0.0692, cluster std=0.0569, individual std=0.0625, 
Average Test Accuracy: 0.8951
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 41 ============
cnt=[1, 3, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (5) | Train Loss: 0.1325 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1463 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.0702 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1178 | Train Acc: 0.9739
 Site-photo                     (5) | Train Loss: 0.1104 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.3426 | Train Acc: 0.9048
 Site-art_painting              (3) | Train Loss: 0.2503 | Train Acc: 0.9474
 Site-art_painting              (3) | Train Loss: 0.2141 | Train Acc: 0.9343
 Site-cartoon                   (2) | Train Loss: 0.3829 | Train Acc: 0.9412
 Site-cartoon                   (4) | Train Loss: 0.3148 | Train Acc: 0.9128
 Site-sketch                    (0) | Train Loss: 0.4113 | Train Acc: 0.8595
Average Train Accuracy: 0.9442
 Site-photo                     (5) | Val  Loss: 0.1020 | Val  Acc: 0.9667
 Site-photo                     (1) | Val  Loss: 0.1926 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1151 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.1251 | Val  Acc: 0.9706
 Site-photo                     (5) | Val  Loss: 0.1259 | Val  Acc: 0.9737
 Site-art_painting              (3) | Val  Loss: 0.2198 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.1596 | Val  Acc: 0.9683
 Site-art_painting              (3) | Val  Loss: 0.2395 | Val  Acc: 0.9437
 Site-cartoon                   (2) | Val  Loss: 0.2645 | Val  Acc: 1.0000
 Site-cartoon                   (4) | Val  Loss: 0.2617 | Val  Acc: 0.9565
 Site-sketch                    (0) | Val  Loss: 0.7515 | Val  Acc: 0.7375
Average Valid Accuracy: 0.9415
 Test site-photo                     (5)| Epoch:40 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.9074
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8766
 Test site-sketch                    (0)| Epoch:40 | Test Acc: 0.8056
photo: 0.9925, art_painting: 0.9074, cartoon: 0.8766, sketch: 0.8056, 
Average Test Accuracy(group): 0.8955, Average Test Accuracy(individual): 0.9313,
domain std=0.0671, cluster std=0.0668, individual std=0.0620, 
Average Test Accuracy: 0.8955
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 1, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.1372 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.0685 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0710 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.0970 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1072 | Train Acc: 0.9782
 Site-art_painting              (5) | Train Loss: 0.3796 | Train Acc: 0.8810
 Site-art_painting              (3) | Train Loss: 0.2082 | Train Acc: 0.9579
 Site-art_painting              (5) | Train Loss: 0.2339 | Train Acc: 0.9202
 Site-cartoon                   (4) | Train Loss: 0.3897 | Train Acc: 0.9412
 Site-cartoon                   (2) | Train Loss: 0.2893 | Train Acc: 0.9360
 Site-sketch                    (1) | Train Loss: 0.4320 | Train Acc: 0.8678
Average Train Accuracy: 0.9435
 Site-photo                     (0) | Val  Loss: 0.1143 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1835 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1004 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1283 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1131 | Val  Acc: 0.9868
 Site-art_painting              (5) | Val  Loss: 0.2234 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.1882 | Val  Acc: 0.9365
 Site-art_painting              (5) | Val  Loss: 0.3014 | Val  Acc: 0.9225
 Site-cartoon                   (4) | Val  Loss: 0.3662 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.2692 | Val  Acc: 0.9391
 Site-sketch                    (1) | Val  Loss: 0.7596 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9349
 Test site-photo                     (0)| Epoch:41 | Test Acc: 0.9925
 Test site-art_painting              (5)| Epoch:41 | Test Acc: 0.9099
 Test site-cartoon                   (4)| Epoch:41 | Test Acc: 0.8894
 Test site-sketch                    (1)| Epoch:41 | Test Acc: 0.8005
photo: 0.9925, art_painting: 0.9099, cartoon: 0.8894, sketch: 0.8005, 
Average Test Accuracy(group): 0.8981, Average Test Accuracy(individual): 0.9338,
domain std=0.0683, cluster std=0.0561, individual std=0.0608, 
Average Test Accuracy: 0.8981
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (0) | Train Loss: 0.0926 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0675 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0601 | Train Acc: 0.9902
 Site-photo                     (5) | Train Loss: 0.0964 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.0926 | Train Acc: 0.9869
 Site-art_painting              (3) | Train Loss: 0.3287 | Train Acc: 0.9048
 Site-art_painting              (3) | Train Loss: 0.2656 | Train Acc: 0.8947
 Site-art_painting              (3) | Train Loss: 0.1841 | Train Acc: 0.9577
 Site-cartoon                   (2) | Train Loss: 0.3678 | Train Acc: 0.9118
 Site-cartoon                   (4) | Train Loss: 0.2784 | Train Acc: 0.9419
 Site-sketch                    (1) | Train Loss: 0.4087 | Train Acc: 0.8843
Average Train Accuracy: 0.9470
 Site-photo                     (0) | Val  Loss: 0.1263 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1111 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0957 | Val  Acc: 0.9706
 Site-photo                     (5) | Val  Loss: 0.1167 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.0990 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.2195 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.1505 | Val  Acc: 0.9683
 Site-art_painting              (3) | Val  Loss: 0.2623 | Val  Acc: 0.9577
 Site-cartoon                   (2) | Val  Loss: 0.2792 | Val  Acc: 1.0000
 Site-cartoon                   (4) | Val  Loss: 0.2564 | Val  Acc: 0.9391
 Site-sketch                    (1) | Val  Loss: 0.7715 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9502
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9706
 Best site-photo                    (5)  | Epoch:43 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9868
 Best site-art_painting             (3)  | Epoch:43 | Val Acc: 0.9643
 Best site-art_painting             (3)  | Epoch:43 | Val Acc: 0.9683
 Best site-art_painting             (3)  | Epoch:43 | Val Acc: 0.9577
 Best site-cartoon                  (2)  | Epoch:43 | Val Acc: 1.0000
 Best site-cartoon                  (4)  | Epoch:43 | Val Acc: 0.9391
 Best site-sketch                   (1)  | Epoch:43 | Val Acc: 0.7500
 Test site-photo                     (0)| Epoch:43 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:43 | Test Acc: 0.9147
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.8926
 Test site-sketch                    (1)| Epoch:43 | Test Acc: 0.8075
photo: 0.9925, art_painting: 0.9147, cartoon: 0.8926, sketch: 0.8075, 
Average Test Accuracy(group): 0.9018, Average Test Accuracy(individual): 0.9363,
domain std=0.0659, cluster std=0.0640, individual std=0.0585, 
Average Test Accuracy: 0.9018
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 44 ============
cnt=[1, 4, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (1) | Train Loss: 0.1112 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0800 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.1071 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.0918 | Train Acc: 0.9804
 Site-photo                     (5) | Train Loss: 0.1211 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.3069 | Train Acc: 0.9286
 Site-art_painting              (3) | Train Loss: 0.2876 | Train Acc: 0.9053
 Site-art_painting              (3) | Train Loss: 0.2197 | Train Acc: 0.9484
 Site-cartoon                   (0) | Train Loss: 0.3809 | Train Acc: 0.8824
 Site-cartoon                   (4) | Train Loss: 0.2796 | Train Acc: 0.9593
 Site-sketch                    (2) | Train Loss: 0.4738 | Train Acc: 0.8099
Average Train Accuracy: 0.9408
 Site-photo                     (1) | Val  Loss: 0.1969 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.0931 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.0946 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1107 | Val  Acc: 0.9510
 Site-photo                     (5) | Val  Loss: 0.1093 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.1552 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.1420 | Val  Acc: 0.9841
 Site-art_painting              (3) | Val  Loss: 0.3240 | Val  Acc: 0.9366
 Site-cartoon                   (0) | Val  Loss: 0.2527 | Val  Acc: 1.0000
 Site-cartoon                   (4) | Val  Loss: 0.2538 | Val  Acc: 0.9391
 Site-sketch                    (2) | Val  Loss: 0.5946 | Val  Acc: 0.8250
Average Valid Accuracy: 0.9543
 Best site-photo                    (1)  | Epoch:44 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:44 | Val Acc: 0.9778
 Best site-photo                    (1)  | Epoch:44 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:44 | Val Acc: 0.9510
 Best site-photo                    (5)  | Epoch:44 | Val Acc: 0.9803
 Best site-art_painting             (3)  | Epoch:44 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:44 | Val Acc: 0.9841
 Best site-art_painting             (3)  | Epoch:44 | Val Acc: 0.9366
 Best site-cartoon                  (0)  | Epoch:44 | Val Acc: 1.0000
 Best site-cartoon                  (4)  | Epoch:44 | Val Acc: 0.9391
 Best site-sketch                   (2)  | Epoch:44 | Val Acc: 0.8250
 Test site-photo                     (1)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.9147
 Test site-cartoon                   (0)| Epoch:44 | Test Acc: 0.8947
 Test site-sketch                    (2)| Epoch:44 | Test Acc: 0.8018
photo: 0.9896, art_painting: 0.9147, cartoon: 0.8947, sketch: 0.8018, 
Average Test Accuracy(group): 0.9002, Average Test Accuracy(individual): 0.9348,
domain std=0.0669, cluster std=0.0642, individual std=0.0581, 
Average Test Accuracy: 0.9002
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 45 ============
cnt=[3, 1, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (3) | Train Loss: 0.1237 | Train Acc: 0.9778
 Site-photo                     (5) | Train Loss: 0.2488 | Train Acc: 0.9559
 Site-photo                     (5) | Train Loss: 0.0781 | Train Acc: 0.9706
 Site-photo                     (5) | Train Loss: 0.0757 | Train Acc: 0.9869
 Site-photo                     (3) | Train Loss: 0.1245 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.3302 | Train Acc: 0.9286
 Site-art_painting              (0) | Train Loss: 0.2288 | Train Acc: 0.9789
 Site-art_painting              (0) | Train Loss: 0.1969 | Train Acc: 0.9577
 Site-cartoon                   (4) | Train Loss: 0.2949 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.2866 | Train Acc: 0.9419
 Site-sketch                    (1) | Train Loss: 0.4181 | Train Acc: 0.8926
Average Train Accuracy: 0.9516
 Site-photo                     (3) | Val  Loss: 0.1852 | Val  Acc: 0.9333
 Site-photo                     (5) | Val  Loss: 0.1130 | Val  Acc: 0.9778
 Site-photo                     (5) | Val  Loss: 0.1012 | Val  Acc: 0.9706
 Site-photo                     (5) | Val  Loss: 0.1151 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.0919 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2042 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.1798 | Val  Acc: 0.9206
 Site-art_painting              (0) | Val  Loss: 0.3111 | Val  Acc: 0.9296
 Site-cartoon                   (4) | Val  Loss: 0.3315 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.2753 | Val  Acc: 0.9565
 Site-sketch                    (1) | Val  Loss: 0.7237 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9341
 Test site-photo                     (3)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:44 | Test Acc: 0.9147
 Test site-cartoon                   (4)| Epoch:44 | Test Acc: 0.8894
 Test site-sketch                    (1)| Epoch:44 | Test Acc: 0.7992
photo: 0.9896, art_painting: 0.9147, cartoon: 0.8894, sketch: 0.7992, 
Average Test Accuracy(group): 0.8982, Average Test Accuracy(individual): 0.9336,
domain std=0.0680, cluster std=0.0655, individual std=0.0593, 
Average Test Accuracy: 0.8982
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 46 ============
cnt=[3, 1, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (3) | Train Loss: 0.0950 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.0782 | Train Acc: 0.9706
 Site-photo                     (5) | Train Loss: 0.0611 | Train Acc: 0.9902
 Site-photo                     (5) | Train Loss: 0.0989 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.1114 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.2818 | Train Acc: 0.9286
 Site-art_painting              (0) | Train Loss: 0.2682 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.1722 | Train Acc: 0.9484
 Site-cartoon                   (1) | Train Loss: 0.4271 | Train Acc: 0.8529
 Site-cartoon                   (4) | Train Loss: 0.2667 | Train Acc: 0.9244
 Site-sketch                    (2) | Train Loss: 0.4115 | Train Acc: 0.8512
Average Train Accuracy: 0.9399
 Site-photo                     (3) | Val  Loss: 0.1351 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.0864 | Val  Acc: 0.9778
 Site-photo                     (5) | Val  Loss: 0.0908 | Val  Acc: 0.9706
 Site-photo                     (5) | Val  Loss: 0.0764 | Val  Acc: 0.9804
 Site-photo                     (3) | Val  Loss: 0.1123 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.1795 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.1515 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.2520 | Val  Acc: 0.9507
 Site-cartoon                   (1) | Val  Loss: 0.3047 | Val  Acc: 0.9565
 Site-cartoon                   (4) | Val  Loss: 0.2391 | Val  Acc: 0.9478
 Site-sketch                    (2) | Val  Loss: 0.7926 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9483
 Test site-photo                     (3)| Epoch:45 | Test Acc: 0.9910
 Test site-art_painting              (0)| Epoch:45 | Test Acc: 0.9184
 Test site-cartoon                   (1)| Epoch:45 | Test Acc: 0.8957
 Test site-sketch                    (2)| Epoch:45 | Test Acc: 0.8011
photo: 0.9910, art_painting: 0.9184, cartoon: 0.8957, sketch: 0.8011, 
Average Test Accuracy(group): 0.9016, Average Test Accuracy(individual): 0.9366,
domain std=0.0678, cluster std=0.0649, individual std=0.0584, 
Average Test Accuracy: 0.9016
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 47 ============
cnt=[3, 1, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (4) | Train Loss: 0.1126 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1679 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.0704 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.1008 | Train Acc: 0.9739
 Site-photo                     (4) | Train Loss: 0.1169 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.3122 | Train Acc: 0.9286
 Site-art_painting              (0) | Train Loss: 0.2437 | Train Acc: 0.9368
 Site-art_painting              (0) | Train Loss: 0.1826 | Train Acc: 0.9577
 Site-cartoon                   (5) | Train Loss: 0.3256 | Train Acc: 0.9412
 Site-cartoon                   (2) | Train Loss: 0.2563 | Train Acc: 0.9477
 Site-sketch                    (1) | Train Loss: 0.4565 | Train Acc: 0.8430
Average Train Accuracy: 0.9488
 Site-photo                     (4) | Val  Loss: 0.0999 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.1337 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.0899 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1251 | Val  Acc: 0.9608
 Site-photo                     (4) | Val  Loss: 0.1047 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.1682 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.1289 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.1982 | Val  Acc: 0.9648
 Site-cartoon                   (5) | Val  Loss: 0.2917 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.2237 | Val  Acc: 0.9739
 Site-sketch                    (1) | Val  Loss: 0.6975 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9533
 Test site-photo                     (4)| Epoch:46 | Test Acc: 0.9910
 Test site-art_painting              (0)| Epoch:46 | Test Acc: 0.9172
 Test site-cartoon                   (5)| Epoch:46 | Test Acc: 0.8947
 Test site-sketch                    (1)| Epoch:46 | Test Acc: 0.8018
photo: 0.9910, art_painting: 0.9172, cartoon: 0.8947, sketch: 0.8018, 
Average Test Accuracy(group): 0.9012, Average Test Accuracy(individual): 0.9362,
domain std=0.0676, cluster std=0.0648, individual std=0.0585, 
Average Test Accuracy: 0.9012
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (3) | Train Loss: 0.1174 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.0700 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.0564 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.0863 | Train Acc: 0.9869
 Site-photo                     (3) | Train Loss: 0.0927 | Train Acc: 0.9738
 Site-art_painting              (5) | Train Loss: 0.3944 | Train Acc: 0.9048
 Site-art_painting              (0) | Train Loss: 0.2411 | Train Acc: 0.9158
 Site-art_painting              (0) | Train Loss: 0.1650 | Train Acc: 0.9577
 Site-cartoon                   (2) | Train Loss: 0.3051 | Train Acc: 0.9118
 Site-cartoon                   (4) | Train Loss: 0.2891 | Train Acc: 0.9186
 Site-sketch                    (1) | Train Loss: 0.4340 | Train Acc: 0.8678
Average Train Accuracy: 0.9446
 Site-photo                     (3) | Val  Loss: 0.0714 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.0470 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0945 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.1115 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.0987 | Val  Acc: 0.9803
 Site-art_painting              (5) | Val  Loss: 0.1487 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.1302 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.2413 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.3202 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.2333 | Val  Acc: 0.9478
 Site-sketch                    (1) | Val  Loss: 0.7032 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9373
 Test site-photo                     (3)| Epoch:47 | Test Acc: 0.9925
 Test site-art_painting              (5)| Epoch:47 | Test Acc: 0.9220
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.8936
 Test site-sketch                    (1)| Epoch:47 | Test Acc: 0.8081
photo: 0.9925, art_painting: 0.9220, cartoon: 0.8936, sketch: 0.8081, 
Average Test Accuracy(group): 0.9041, Average Test Accuracy(individual): 0.9386,
domain std=0.0661, cluster std=0.0546, individual std=0.0576, 
Average Test Accuracy: 0.9041
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
============ Train epoch 49 ============
cnt=[5, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.0948 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3695 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0638 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1014 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.0973 | Train Acc: 0.9694
 Site-art_painting              (5) | Train Loss: 0.4234 | Train Acc: 0.8571
 Site-art_painting              (3) | Train Loss: 0.2292 | Train Acc: 0.9579
 Site-art_painting              (3) | Train Loss: 0.1773 | Train Acc: 0.9718
 Site-cartoon                   (1) | Train Loss: 0.3880 | Train Acc: 0.9118
 Site-cartoon                   (4) | Train Loss: 0.2599 | Train Acc: 0.9477
 Site-sketch                    (2) | Train Loss: 0.3950 | Train Acc: 0.8926
Average Train Accuracy: 0.9482
 Site-photo                     (0) | Val  Loss: 0.1685 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1354 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0822 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1308 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.0998 | Val  Acc: 0.9803
 Site-art_painting              (5) | Val  Loss: 0.1595 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.1118 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2418 | Val  Acc: 0.9577
 Site-cartoon                   (1) | Val  Loss: 0.2390 | Val  Acc: 0.9565
 Site-cartoon                   (4) | Val  Loss: 0.2079 | Val  Acc: 0.9739
 Site-sketch                    (2) | Val  Loss: 0.6763 | Val  Acc: 0.8375
Average Valid Accuracy: 0.9537
 Test site-photo                     (0)| Epoch:48 | Test Acc: 0.9925
 Test site-art_painting              (5)| Epoch:48 | Test Acc: 0.9220
 Test site-cartoon                   (1)| Epoch:48 | Test Acc: 0.8894
 Test site-sketch                    (2)| Epoch:48 | Test Acc: 0.8100
photo: 0.9925, art_painting: 0.9220, cartoon: 0.8894, sketch: 0.8100, 
Average Test Accuracy(group): 0.9035, Average Test Accuracy(individual): 0.9380,
domain std=0.0656, cluster std=0.0544, individual std=0.0578, 
Average Test Accuracy: 0.9035
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_6/ccop_q=1...
===2023-08-10 16:19:37===
===2023-08-10 16:19:53===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 6
Loading snapshots...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9925
 Test site-art_painting              (5)| Epoch:49 | Test Acc: 0.9220
 Test site-cartoon                   (1)| Epoch:49 | Test Acc: 0.8894
 Test site-sketch                    (2)| Epoch:49 | Test Acc: 0.8100
photo: 0.9925, art_painting: 0.9220, cartoon: 0.8894, sketch: 0.8100, 
Average Test Accuracy(group): 0.9035, Average Test Accuracy(individual): 0.9380,
domain std=0.0656, cluster std=0.0544, individual std=0.0578, 
