===2023-08-10 18:35:35===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 1, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (0) | Train Loss: 1.8995 | Train Acc: 0.1429
 Site-photo                     (0) | Train Loss: 1.7820 | Train Acc: 0.3889
 Site-photo                     (0) | Train Loss: 1.7170 | Train Acc: 0.2917
 Site-photo                     (0) | Train Loss: 1.6573 | Train Acc: 0.5161
 Site-photo                     (0) | Train Loss: 1.7674 | Train Acc: 0.3000
 Site-photo                     (0) | Train Loss: 1.7652 | Train Acc: 0.3269
 Site-photo                     (0) | Train Loss: 1.5944 | Train Acc: 0.5294
 Site-photo                     (0) | Train Loss: 1.6861 | Train Acc: 0.4205
 Site-photo                     (0) | Train Loss: 1.6968 | Train Acc: 0.4248
 Site-photo                     (0) | Train Loss: 1.7747 | Train Acc: 0.3425
 Site-art_painting              (4) | Train Loss: 1.8106 | Train Acc: 0.4167
 Site-art_painting              (2) | Train Loss: 1.7839 | Train Acc: 0.3182
 Site-art_painting              (5) | Train Loss: 1.9499 | Train Acc: 0.2250
 Site-art_painting              (5) | Train Loss: 2.0031 | Train Acc: 0.1528
 Site-art_painting              (5) | Train Loss: 1.8656 | Train Acc: 0.2812
 Site-cartoon                   (3) | Train Loss: 1.8688 | Train Acc: 0.2727
 Site-cartoon                   (3) | Train Loss: 1.8914 | Train Acc: 0.2087
 Site-sketch                    (1) | Train Loss: 1.9540 | Train Acc: 0.2069
Average Train Accuracy: 0.3203
 Site-photo                     (0) | Val  Loss: 1.7900 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7503 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7375 | Val  Acc: 0.3125
 Site-photo                     (0) | Val  Loss: 1.7571 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7398 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7356 | Val  Acc: 0.4000
 Site-photo                     (0) | Val  Loss: 1.6118 | Val  Acc: 0.4222
 Site-photo                     (0) | Val  Loss: 1.6694 | Val  Acc: 0.4310
 Site-photo                     (0) | Val  Loss: 1.7507 | Val  Acc: 0.4533
 Site-photo                     (0) | Val  Loss: 1.7079 | Val  Acc: 0.3918
 Site-art_painting              (4) | Val  Loss: 2.0499 | Val  Acc: 0.1250
 Site-art_painting              (2) | Val  Loss: 1.8044 | Val  Acc: 0.3333
 Site-art_painting              (5) | Val  Loss: 1.6685 | Val  Acc: 0.3462
 Site-art_painting              (5) | Val  Loss: 1.9233 | Val  Acc: 0.1915
 Site-art_painting              (5) | Val  Loss: 1.9554 | Val  Acc: 0.2000
 Site-cartoon                   (3) | Val  Loss: 1.9725 | Val  Acc: 0.1429
 Site-cartoon                   (3) | Val  Loss: 1.8865 | Val  Acc: 0.1948
 Site-sketch                    (1) | Val  Loss: 1.9095 | Val  Acc: 0.2308
Average Valid Accuracy: 0.3060
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3125
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4222
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4310
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4533
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3918
 Best site-art_painting             (4)  | Epoch:0 | Val Acc: 0.1250
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-art_painting             (5)  | Epoch:0 | Val Acc: 0.3462
 Best site-art_painting             (5)  | Epoch:0 | Val Acc: 0.1915
 Best site-art_painting             (5)  | Epoch:0 | Val Acc: 0.2000
 Best site-cartoon                  (3)  | Epoch:0 | Val Acc: 0.1429
 Best site-cartoon                  (3)  | Epoch:0 | Val Acc: 0.1948
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.2308
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 1 ============
cnt=[9, 4, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (4) | Train Loss: 1.7893 | Train Acc: 0.3571
 Site-photo                     (0) | Train Loss: 1.6000 | Train Acc: 0.6111
 Site-photo                     (0) | Train Loss: 1.6276 | Train Acc: 0.3333
 Site-photo                     (0) | Train Loss: 1.5472 | Train Acc: 0.5806
 Site-photo                     (0) | Train Loss: 1.5921 | Train Acc: 0.4000
 Site-photo                     (0) | Train Loss: 1.5915 | Train Acc: 0.4615
 Site-photo                     (0) | Train Loss: 1.3753 | Train Acc: 0.5000
 Site-photo                     (0) | Train Loss: 1.5727 | Train Acc: 0.4659
 Site-photo                     (0) | Train Loss: 1.5821 | Train Acc: 0.4867
 Site-photo                     (0) | Train Loss: 1.6639 | Train Acc: 0.4315
 Site-art_painting              (5) | Train Loss: 1.6602 | Train Acc: 0.4167
 Site-art_painting              (1) | Train Loss: 1.7062 | Train Acc: 0.3182
 Site-art_painting              (1) | Train Loss: 1.9717 | Train Acc: 0.1750
 Site-art_painting              (1) | Train Loss: 1.7011 | Train Acc: 0.2500
 Site-art_painting              (1) | Train Loss: 1.7619 | Train Acc: 0.2969
 Site-cartoon                   (3) | Train Loss: 1.8203 | Train Acc: 0.2727
 Site-cartoon                   (3) | Train Loss: 1.8864 | Train Acc: 0.2261
 Site-sketch                    (2) | Train Loss: 1.9485 | Train Acc: 0.1724
Average Train Accuracy: 0.3753
 Site-photo                     (4) | Val  Loss: 1.6912 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.6674 | Val  Acc: 0.4167
 Site-photo                     (0) | Val  Loss: 1.6043 | Val  Acc: 0.5625
 Site-photo                     (0) | Val  Loss: 1.6037 | Val  Acc: 0.5238
 Site-photo                     (0) | Val  Loss: 1.5646 | Val  Acc: 0.4074
 Site-photo                     (0) | Val  Loss: 1.6551 | Val  Acc: 0.4571
 Site-photo                     (0) | Val  Loss: 1.4936 | Val  Acc: 0.5333
 Site-photo                     (0) | Val  Loss: 1.5389 | Val  Acc: 0.5172
 Site-photo                     (0) | Val  Loss: 1.6044 | Val  Acc: 0.5333
 Site-photo                     (0) | Val  Loss: 1.5521 | Val  Acc: 0.4948
 Site-art_painting              (5) | Val  Loss: 1.9410 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.6786 | Val  Acc: 0.3333
 Site-art_painting              (1) | Val  Loss: 1.6494 | Val  Acc: 0.3077
 Site-art_painting              (1) | Val  Loss: 1.7729 | Val  Acc: 0.2766
 Site-art_painting              (1) | Val  Loss: 1.8158 | Val  Acc: 0.2353
 Site-cartoon                   (3) | Val  Loss: 1.8952 | Val  Acc: 0.1429
 Site-cartoon                   (3) | Val  Loss: 1.9075 | Val  Acc: 0.2338
 Site-sketch                    (2) | Val  Loss: 1.9183 | Val  Acc: 0.1795
Average Valid Accuracy: 0.3744
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4167
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5625
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5238
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4074
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4571
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5333
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5172
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5333
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4948
 Best site-art_painting             (5)  | Epoch:1 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.3333
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.3077
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.2766
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.2353
 Best site-cartoon                  (3)  | Epoch:1 | Val Acc: 0.1429
 Best site-cartoon                  (3)  | Epoch:1 | Val Acc: 0.2338
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 1, 4, 2, 9, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (4) | Train Loss: 1.7180 | Train Acc: 0.4286
 Site-photo                     (4) | Train Loss: 1.4648 | Train Acc: 0.6111
 Site-photo                     (4) | Train Loss: 1.5134 | Train Acc: 0.4583
 Site-photo                     (1) | Train Loss: 1.4297 | Train Acc: 0.5806
 Site-photo                     (4) | Train Loss: 1.4653 | Train Acc: 0.5500
 Site-photo                     (4) | Train Loss: 1.4923 | Train Acc: 0.6346
 Site-photo                     (4) | Train Loss: 1.4734 | Train Acc: 0.6618
 Site-photo                     (4) | Train Loss: 1.4834 | Train Acc: 0.6364
 Site-photo                     (4) | Train Loss: 1.4409 | Train Acc: 0.6106
 Site-photo                     (4) | Train Loss: 1.5146 | Train Acc: 0.5616
 Site-art_painting              (2) | Train Loss: 1.6684 | Train Acc: 0.4167
 Site-art_painting              (0) | Train Loss: 1.7240 | Train Acc: 0.5000
 Site-art_painting              (2) | Train Loss: 1.8371 | Train Acc: 0.3000
 Site-art_painting              (2) | Train Loss: 1.6673 | Train Acc: 0.3333
 Site-art_painting              (2) | Train Loss: 1.7006 | Train Acc: 0.3750
 Site-cartoon                   (3) | Train Loss: 1.6849 | Train Acc: 0.2727
 Site-cartoon                   (3) | Train Loss: 1.8201 | Train Acc: 0.2435
 Site-sketch                    (5) | Train Loss: 1.9144 | Train Acc: 0.2759
Average Train Accuracy: 0.4695
 Site-photo                     (4) | Val  Loss: 1.5267 | Val  Acc: 0.5556
 Site-photo                     (4) | Val  Loss: 1.5249 | Val  Acc: 0.4167
 Site-photo                     (4) | Val  Loss: 1.4603 | Val  Acc: 0.5625
 Site-photo                     (1) | Val  Loss: 1.4895 | Val  Acc: 0.7143
 Site-photo                     (4) | Val  Loss: 1.4603 | Val  Acc: 0.4815
 Site-photo                     (4) | Val  Loss: 1.5273 | Val  Acc: 0.5143
 Site-photo                     (4) | Val  Loss: 1.3850 | Val  Acc: 0.6444
 Site-photo                     (4) | Val  Loss: 1.4233 | Val  Acc: 0.6379
 Site-photo                     (4) | Val  Loss: 1.5105 | Val  Acc: 0.6400
 Site-photo                     (4) | Val  Loss: 1.4116 | Val  Acc: 0.6598
 Site-art_painting              (2) | Val  Loss: 1.8666 | Val  Acc: 0.1250
 Site-art_painting              (0) | Val  Loss: 1.6870 | Val  Acc: 0.2667
 Site-art_painting              (2) | Val  Loss: 1.6017 | Val  Acc: 0.3846
 Site-art_painting              (2) | Val  Loss: 1.6900 | Val  Acc: 0.3617
 Site-art_painting              (2) | Val  Loss: 1.7542 | Val  Acc: 0.3176
 Site-cartoon                   (3) | Val  Loss: 1.7926 | Val  Acc: 0.2857
 Site-cartoon                   (3) | Val  Loss: 1.8081 | Val  Acc: 0.2468
 Site-sketch                    (5) | Val  Loss: 1.9124 | Val  Acc: 0.1795
Average Valid Accuracy: 0.4441
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.5556
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.4167
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.5625
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.7143
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.4815
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.5143
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.6444
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.6379
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.6400
 Best site-photo                    (4)  | Epoch:2 | Val Acc: 0.6598
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.1250
 Best site-art_painting             (0)  | Epoch:2 | Val Acc: 0.2667
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.3846
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.3617
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.3176
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.2857
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.2468
 Best site-sketch                   (5)  | Epoch:2 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 1, 1, 1, 9, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (4) | Train Loss: 1.5555 | Train Acc: 0.4286
 Site-photo                     (4) | Train Loss: 1.3689 | Train Acc: 0.7222
 Site-photo                     (4) | Train Loss: 1.3645 | Train Acc: 0.6250
 Site-photo                     (1) | Train Loss: 1.2724 | Train Acc: 0.8065
 Site-photo                     (4) | Train Loss: 1.3211 | Train Acc: 0.7500
 Site-photo                     (4) | Train Loss: 1.3289 | Train Acc: 0.6538
 Site-photo                     (4) | Train Loss: 1.2373 | Train Acc: 0.7794
 Site-photo                     (4) | Train Loss: 1.3045 | Train Acc: 0.7386
 Site-photo                     (4) | Train Loss: 1.3181 | Train Acc: 0.7699
 Site-photo                     (4) | Train Loss: 1.3752 | Train Acc: 0.6712
 Site-art_painting              (0) | Train Loss: 1.6019 | Train Acc: 0.5833
 Site-art_painting              (0) | Train Loss: 1.6566 | Train Acc: 0.6364
 Site-art_painting              (0) | Train Loss: 1.7450 | Train Acc: 0.3000
 Site-art_painting              (0) | Train Loss: 1.5793 | Train Acc: 0.4028
 Site-art_painting              (0) | Train Loss: 1.6446 | Train Acc: 0.4219
 Site-cartoon                   (5) | Train Loss: 1.5871 | Train Acc: 0.5455
 Site-cartoon                   (3) | Train Loss: 1.7348 | Train Acc: 0.3739
 Site-sketch                    (2) | Train Loss: 1.8562 | Train Acc: 0.2931
Average Train Accuracy: 0.5835
 Site-photo                     (4) | Val  Loss: 1.3395 | Val  Acc: 0.6667
 Site-photo                     (4) | Val  Loss: 1.3788 | Val  Acc: 0.5833
 Site-photo                     (4) | Val  Loss: 1.3943 | Val  Acc: 0.6875
 Site-photo                     (1) | Val  Loss: 1.3326 | Val  Acc: 0.7619
 Site-photo                     (4) | Val  Loss: 1.4077 | Val  Acc: 0.6667
 Site-photo                     (4) | Val  Loss: 1.3633 | Val  Acc: 0.6571
 Site-photo                     (4) | Val  Loss: 1.2671 | Val  Acc: 0.7333
 Site-photo                     (4) | Val  Loss: 1.2860 | Val  Acc: 0.7414
 Site-photo                     (4) | Val  Loss: 1.3133 | Val  Acc: 0.7600
 Site-photo                     (4) | Val  Loss: 1.2392 | Val  Acc: 0.7835
 Site-art_painting              (0) | Val  Loss: 1.8270 | Val  Acc: 0.2500
 Site-art_painting              (0) | Val  Loss: 1.6850 | Val  Acc: 0.3333
 Site-art_painting              (0) | Val  Loss: 1.5735 | Val  Acc: 0.3462
 Site-art_painting              (0) | Val  Loss: 1.6422 | Val  Acc: 0.5319
 Site-art_painting              (0) | Val  Loss: 1.6882 | Val  Acc: 0.4235
 Site-cartoon                   (5) | Val  Loss: 1.7935 | Val  Acc: 0.0000
 Site-cartoon                   (3) | Val  Loss: 1.7516 | Val  Acc: 0.2857
 Site-sketch                    (2) | Val  Loss: 1.9000 | Val  Acc: 0.1795
Average Valid Accuracy: 0.5218
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.5833
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.6875
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.7619
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.6571
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.7333
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.7414
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.7600
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.7835
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.2500
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.3333
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.3462
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.5319
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.4235
 Best site-cartoon                  (5)  | Epoch:3 | Val Acc: 0.0000
 Best site-cartoon                  (3)  | Epoch:3 | Val Acc: 0.2857
 Best site-sketch                   (2)  | Epoch:3 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 5, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (2) | Train Loss: 1.3941 | Train Acc: 0.7857
 Site-photo                     (2) | Train Loss: 1.2246 | Train Acc: 0.8333
 Site-photo                     (1) | Train Loss: 1.2307 | Train Acc: 0.7917
 Site-photo                     (1) | Train Loss: 1.1301 | Train Acc: 0.9032
 Site-photo                     (2) | Train Loss: 1.2030 | Train Acc: 0.8750
 Site-photo                     (2) | Train Loss: 1.1590 | Train Acc: 0.8846
 Site-photo                     (1) | Train Loss: 1.1107 | Train Acc: 0.8676
 Site-photo                     (1) | Train Loss: 1.1605 | Train Acc: 0.8636
 Site-photo                     (1) | Train Loss: 1.1948 | Train Acc: 0.8584
 Site-photo                     (2) | Train Loss: 1.1601 | Train Acc: 0.8562
 Site-art_painting              (4) | Train Loss: 1.6557 | Train Acc: 0.4167
 Site-art_painting              (0) | Train Loss: 1.5574 | Train Acc: 0.6364
 Site-art_painting              (0) | Train Loss: 1.6699 | Train Acc: 0.3500
 Site-art_painting              (0) | Train Loss: 1.5900 | Train Acc: 0.5139
 Site-art_painting              (0) | Train Loss: 1.5349 | Train Acc: 0.5000
 Site-cartoon                   (3) | Train Loss: 1.5338 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 1.6954 | Train Acc: 0.3478
 Site-sketch                    (5) | Train Loss: 1.8505 | Train Acc: 0.2069
Average Train Accuracy: 0.6737
 Site-photo                     (2) | Val  Loss: 1.2612 | Val  Acc: 0.7778
 Site-photo                     (2) | Val  Loss: 1.2335 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.2090 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.2468 | Val  Acc: 0.8095
 Site-photo                     (2) | Val  Loss: 1.2586 | Val  Acc: 0.7778
 Site-photo                     (2) | Val  Loss: 1.2268 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 1.1159 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.1417 | Val  Acc: 0.8966
 Site-photo                     (1) | Val  Loss: 1.1934 | Val  Acc: 0.8667
 Site-photo                     (2) | Val  Loss: 1.1206 | Val  Acc: 0.9072
 Site-art_painting              (4) | Val  Loss: 1.5635 | Val  Acc: 0.5000
 Site-art_painting              (0) | Val  Loss: 1.6175 | Val  Acc: 0.4667
 Site-art_painting              (0) | Val  Loss: 1.4621 | Val  Acc: 0.5769
 Site-art_painting              (0) | Val  Loss: 1.5421 | Val  Acc: 0.5106
 Site-art_painting              (0) | Val  Loss: 1.5715 | Val  Acc: 0.4353
 Site-cartoon                   (3) | Val  Loss: 1.6962 | Val  Acc: 0.1429
 Site-cartoon                   (3) | Val  Loss: 1.7171 | Val  Acc: 0.4156
 Site-sketch                    (5) | Val  Loss: 1.8726 | Val  Acc: 0.1795
Average Valid Accuracy: 0.6579
 Best site-photo                    (2)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (2)  | Epoch:4 | Val Acc: 0.8333
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8095
 Best site-photo                    (2)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (2)  | Epoch:4 | Val Acc: 0.8571
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8966
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8667
 Best site-photo                    (2)  | Epoch:4 | Val Acc: 0.9072
 Best site-art_painting             (4)  | Epoch:4 | Val Acc: 0.5000
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.4667
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.5769
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.5106
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.4353
 Best site-cartoon                  (3)  | Epoch:4 | Val Acc: 0.1429
 Best site-cartoon                  (3)  | Epoch:4 | Val Acc: 0.4156
 Best site-sketch                   (5)  | Epoch:4 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 5 ============
cnt=[8, 4, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (5) | Train Loss: 1.2743 | Train Acc: 0.7857
 Site-photo                     (5) | Train Loss: 1.0322 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 1.1806 | Train Acc: 0.7500
 Site-photo                     (0) | Train Loss: 0.9737 | Train Acc: 0.9032
 Site-photo                     (0) | Train Loss: 1.0489 | Train Acc: 0.9000
 Site-photo                     (0) | Train Loss: 1.0785 | Train Acc: 0.8462
 Site-photo                     (0) | Train Loss: 1.0709 | Train Acc: 0.8824
 Site-photo                     (0) | Train Loss: 1.0446 | Train Acc: 0.9091
 Site-photo                     (0) | Train Loss: 1.0378 | Train Acc: 0.9381
 Site-photo                     (0) | Train Loss: 1.0744 | Train Acc: 0.8836
 Site-art_painting              (4) | Train Loss: 1.4760 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.5276 | Train Acc: 0.5909
 Site-art_painting              (1) | Train Loss: 1.6062 | Train Acc: 0.4250
 Site-art_painting              (1) | Train Loss: 1.4757 | Train Acc: 0.5278
 Site-art_painting              (1) | Train Loss: 1.4500 | Train Acc: 0.5859
 Site-cartoon                   (3) | Train Loss: 1.4872 | Train Acc: 0.5455
 Site-cartoon                   (3) | Train Loss: 1.6576 | Train Acc: 0.3826
 Site-sketch                    (2) | Train Loss: 1.7954 | Train Acc: 0.2414
Average Train Accuracy: 0.6937
 Site-photo                     (5) | Val  Loss: 1.1214 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 1.1151 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 1.0665 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.1006 | Val  Acc: 0.8571
 Site-photo                     (0) | Val  Loss: 1.1153 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.0894 | Val  Acc: 0.8571
 Site-photo                     (0) | Val  Loss: 0.9612 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 1.0050 | Val  Acc: 0.9310
 Site-photo                     (0) | Val  Loss: 1.0399 | Val  Acc: 0.9200
 Site-photo                     (0) | Val  Loss: 0.9906 | Val  Acc: 0.9381
 Site-art_painting              (4) | Val  Loss: 1.6935 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.5234 | Val  Acc: 0.4667
 Site-art_painting              (1) | Val  Loss: 1.3553 | Val  Acc: 0.6923
 Site-art_painting              (1) | Val  Loss: 1.4398 | Val  Acc: 0.5745
 Site-art_painting              (1) | Val  Loss: 1.5009 | Val  Acc: 0.5294
 Site-cartoon                   (3) | Val  Loss: 1.5184 | Val  Acc: 0.4286
 Site-cartoon                   (3) | Val  Loss: 1.6267 | Val  Acc: 0.3896
 Site-sketch                    (2) | Val  Loss: 1.8228 | Val  Acc: 0.3077
Average Valid Accuracy: 0.7107
 Best site-photo                    (5)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (5)  | Epoch:5 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8571
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8571
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9310
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9200
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9381
 Best site-art_painting             (4)  | Epoch:5 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.4667
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.6923
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.5745
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.5294
 Best site-cartoon                  (3)  | Epoch:5 | Val Acc: 0.4286
 Best site-cartoon                  (3)  | Epoch:5 | Val Acc: 0.3896
 Best site-sketch                   (2)  | Epoch:5 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 6 ============
cnt=[9, 1, 2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (0) | Train Loss: 1.1083 | Train Acc: 0.9286
 Site-photo                     (5) | Train Loss: 0.9422 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 1.0133 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 0.8835 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.9034 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.9510 | Train Acc: 0.9038
 Site-photo                     (0) | Train Loss: 0.8624 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.8861 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.9217 | Train Acc: 0.9292
 Site-photo                     (0) | Train Loss: 0.9560 | Train Acc: 0.9178
 Site-art_painting              (4) | Train Loss: 1.4355 | Train Acc: 0.5833
 Site-art_painting              (3) | Train Loss: 1.4888 | Train Acc: 0.6818
 Site-art_painting              (4) | Train Loss: 1.5124 | Train Acc: 0.4500
 Site-art_painting              (4) | Train Loss: 1.4120 | Train Acc: 0.6250
 Site-art_painting              (4) | Train Loss: 1.3767 | Train Acc: 0.6328
 Site-cartoon                   (2) | Train Loss: 1.4580 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 1.5906 | Train Acc: 0.4261
 Site-sketch                    (1) | Train Loss: 1.7969 | Train Acc: 0.3276
Average Train Accuracy: 0.7557
 Site-photo                     (0) | Val  Loss: 0.9759 | Val  Acc: 0.7778
 Site-photo                     (5) | Val  Loss: 0.9584 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.9497 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.9513 | Val  Acc: 0.9048
 Site-photo                     (0) | Val  Loss: 0.9278 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 1.0108 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.8440 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.8794 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.9420 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.8680 | Val  Acc: 0.9381
 Site-art_painting              (4) | Val  Loss: 1.6244 | Val  Acc: 0.3750
 Site-art_painting              (3) | Val  Loss: 1.3737 | Val  Acc: 0.6000
 Site-art_painting              (4) | Val  Loss: 1.3040 | Val  Acc: 0.7308
 Site-art_painting              (4) | Val  Loss: 1.4127 | Val  Acc: 0.6170
 Site-art_painting              (4) | Val  Loss: 1.3670 | Val  Acc: 0.6588
 Site-cartoon                   (2) | Val  Loss: 1.6068 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.5797 | Val  Acc: 0.4286
 Site-sketch                    (1) | Val  Loss: 1.8126 | Val  Acc: 0.2821
Average Valid Accuracy: 0.7317
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.7778
 Best site-photo                    (5)  | Epoch:6 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9048
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9733
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9381
 Best site-art_painting             (4)  | Epoch:6 | Val Acc: 0.3750
 Best site-art_painting             (3)  | Epoch:6 | Val Acc: 0.6000
 Best site-art_painting             (4)  | Epoch:6 | Val Acc: 0.7308
 Best site-art_painting             (4)  | Epoch:6 | Val Acc: 0.6170
 Best site-art_painting             (4)  | Epoch:6 | Val Acc: 0.6588
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.1429
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.4286
 Best site-sketch                   (1)  | Epoch:6 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 1, 4, 2, 9, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (4) | Train Loss: 1.0498 | Train Acc: 0.7857
 Site-photo                     (4) | Train Loss: 0.8610 | Train Acc: 0.8889
 Site-photo                     (4) | Train Loss: 0.9646 | Train Acc: 0.7500
 Site-photo                     (0) | Train Loss: 0.7713 | Train Acc: 0.9677
 Site-photo                     (4) | Train Loss: 0.8081 | Train Acc: 0.9750
 Site-photo                     (4) | Train Loss: 0.8357 | Train Acc: 0.9231
 Site-photo                     (4) | Train Loss: 0.6626 | Train Acc: 0.9853
 Site-photo                     (4) | Train Loss: 0.8140 | Train Acc: 0.9318
 Site-photo                     (4) | Train Loss: 0.8091 | Train Acc: 0.9646
 Site-photo                     (4) | Train Loss: 0.8287 | Train Acc: 0.9247
 Site-art_painting              (5) | Train Loss: 1.3408 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.3874 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 1.4097 | Train Acc: 0.5750
 Site-art_painting              (2) | Train Loss: 1.3080 | Train Acc: 0.6528
 Site-art_painting              (2) | Train Loss: 1.2882 | Train Acc: 0.6641
 Site-cartoon                   (3) | Train Loss: 1.2888 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 1.5108 | Train Acc: 0.5043
 Site-sketch                    (1) | Train Loss: 1.7683 | Train Acc: 0.2931
Average Train Accuracy: 0.7697
 Site-photo                     (4) | Val  Loss: 0.9209 | Val  Acc: 0.7778
 Site-photo                     (4) | Val  Loss: 0.9215 | Val  Acc: 0.8333
 Site-photo                     (4) | Val  Loss: 0.8555 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.8671 | Val  Acc: 0.9048
 Site-photo                     (4) | Val  Loss: 0.8548 | Val  Acc: 0.9259
 Site-photo                     (4) | Val  Loss: 0.8743 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.7490 | Val  Acc: 0.9778
 Site-photo                     (4) | Val  Loss: 0.7995 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.8446 | Val  Acc: 0.9733
 Site-photo                     (4) | Val  Loss: 0.7807 | Val  Acc: 0.9381
 Site-art_painting              (5) | Val  Loss: 1.4783 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.3124 | Val  Acc: 0.7333
 Site-art_painting              (2) | Val  Loss: 1.2474 | Val  Acc: 0.7308
 Site-art_painting              (2) | Val  Loss: 1.2694 | Val  Acc: 0.6596
 Site-art_painting              (2) | Val  Loss: 1.2934 | Val  Acc: 0.6118
 Site-cartoon                   (3) | Val  Loss: 1.4333 | Val  Acc: 0.4286
 Site-cartoon                   (3) | Val  Loss: 1.5381 | Val  Acc: 0.4935
 Site-sketch                    (1) | Val  Loss: 1.8162 | Val  Acc: 0.1282
Average Valid Accuracy: 0.7479
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.7778
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.8333
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9048
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.9259
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.9429
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.9778
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.9655
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.9733
 Best site-photo                    (4)  | Epoch:7 | Val Acc: 0.9381
 Best site-art_painting             (5)  | Epoch:7 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.7333
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.7308
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.6596
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.6118
 Best site-cartoon                  (3)  | Epoch:7 | Val Acc: 0.4286
 Best site-cartoon                  (3)  | Epoch:7 | Val Acc: 0.4935
 Best site-sketch                   (1)  | Epoch:7 | Val Acc: 0.1282
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 8 ============
cnt=[10, 2, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.8770 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7183 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.8879 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 0.7097 | Train Acc: 0.9355
 Site-photo                     (0) | Train Loss: 0.7032 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.7504 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.6184 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.7659 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.7136 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.7740 | Train Acc: 0.9521
 Site-art_painting              (4) | Train Loss: 1.2791 | Train Acc: 0.6667
 Site-art_painting              (2) | Train Loss: 1.3307 | Train Acc: 0.7273
 Site-art_painting              (5) | Train Loss: 1.3940 | Train Acc: 0.5500
 Site-art_painting              (5) | Train Loss: 1.1437 | Train Acc: 0.7500
 Site-art_painting              (5) | Train Loss: 1.2101 | Train Acc: 0.7422
 Site-cartoon                   (1) | Train Loss: 1.3264 | Train Acc: 0.4545
 Site-cartoon                   (1) | Train Loss: 1.4674 | Train Acc: 0.5391
 Site-sketch                    (3) | Train Loss: 1.7684 | Train Acc: 0.3103
Average Train Accuracy: 0.7900
 Site-photo                     (0) | Val  Loss: 0.7768 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.8259 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.7044 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7389 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.7590 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7941 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.6728 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.6906 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 0.7314 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.6851 | Val  Acc: 0.9588
 Site-art_painting              (4) | Val  Loss: 1.2117 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 1.2430 | Val  Acc: 0.7333
 Site-art_painting              (5) | Val  Loss: 1.1528 | Val  Acc: 0.8462
 Site-art_painting              (5) | Val  Loss: 1.2768 | Val  Acc: 0.7447
 Site-art_painting              (5) | Val  Loss: 1.2318 | Val  Acc: 0.6824
 Site-cartoon                   (1) | Val  Loss: 1.5221 | Val  Acc: 0.1429
 Site-cartoon                   (1) | Val  Loss: 1.4441 | Val  Acc: 0.5195
 Site-sketch                    (3) | Val  Loss: 1.7895 | Val  Acc: 0.1795
Average Valid Accuracy: 0.7926
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9483
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9733
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9588
 Best site-art_painting             (4)  | Epoch:8 | Val Acc: 0.8750
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.7333
 Best site-art_painting             (5)  | Epoch:8 | Val Acc: 0.8462
 Best site-art_painting             (5)  | Epoch:8 | Val Acc: 0.7447
 Best site-art_painting             (5)  | Epoch:8 | Val Acc: 0.6824
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.1429
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.5195
 Best site-sketch                   (3)  | Epoch:8 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 9 ============
cnt=[5, 5, 2, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (4) | Train Loss: 0.8492 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7338 | Train Acc: 0.8889
 Site-photo                     (5) | Train Loss: 0.7912 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 0.6257 | Train Acc: 0.9355
 Site-photo                     (1) | Train Loss: 0.6267 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6647 | Train Acc: 0.9615
 Site-photo                     (5) | Train Loss: 0.6466 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.6954 | Train Acc: 0.9545
 Site-photo                     (5) | Train Loss: 0.6443 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.6780 | Train Acc: 0.9452
 Site-art_painting              (0) | Train Loss: 1.2196 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 1.2499 | Train Acc: 0.7273
 Site-art_painting              (0) | Train Loss: 1.3491 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.2129 | Train Acc: 0.6806
 Site-art_painting              (0) | Train Loss: 1.1490 | Train Acc: 0.7344
 Site-cartoon                   (2) | Train Loss: 1.2317 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 1.4191 | Train Acc: 0.6087
 Site-sketch                    (3) | Train Loss: 1.7366 | Train Acc: 0.3448
Average Train Accuracy: 0.8156
 Site-photo                     (4) | Val  Loss: 0.6630 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7903 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.6658 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.6578 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.6915 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7304 | Val  Acc: 0.9714
 Site-photo                     (5) | Val  Loss: 0.5893 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.6325 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.6161 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.6380 | Val  Acc: 0.9588
 Site-art_painting              (0) | Val  Loss: 1.2250 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.1490 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 1.1394 | Val  Acc: 0.8077
 Site-art_painting              (0) | Val  Loss: 1.1252 | Val  Acc: 0.8298
 Site-art_painting              (0) | Val  Loss: 1.1494 | Val  Acc: 0.7176
 Site-cartoon                   (2) | Val  Loss: 1.4706 | Val  Acc: 0.4286
 Site-cartoon                   (2) | Val  Loss: 1.4231 | Val  Acc: 0.5714
 Site-sketch                    (3) | Val  Loss: 1.7633 | Val  Acc: 0.3077
Average Valid Accuracy: 0.8239
 Best site-photo                    (4)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9167
 Best site-photo                    (5)  | Epoch:9 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9714
 Best site-photo                    (5)  | Epoch:9 | Val Acc: 0.9556
 Best site-photo                    (5)  | Epoch:9 | Val Acc: 0.9655
 Best site-photo                    (5)  | Epoch:9 | Val Acc: 0.9600
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9588
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8000
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8077
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8298
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.7176
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.4286
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.5714
 Best site-sketch                   (3)  | Epoch:9 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 9, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (1) | Train Loss: 0.7693 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6040 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.7159 | Train Acc: 0.9167
 Site-photo                     (1) | Train Loss: 0.5788 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6035 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.6349 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.4054 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5531 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.5909 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.6302 | Train Acc: 0.9589
 Site-art_painting              (3) | Train Loss: 1.2080 | Train Acc: 0.5833
 Site-art_painting              (3) | Train Loss: 1.2244 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 1.1923 | Train Acc: 0.6500
 Site-art_painting              (3) | Train Loss: 1.1587 | Train Acc: 0.7222
 Site-art_painting              (3) | Train Loss: 1.0219 | Train Acc: 0.8438
 Site-cartoon                   (4) | Train Loss: 1.0981 | Train Acc: 0.7273
 Site-cartoon                   (5) | Train Loss: 1.3383 | Train Acc: 0.6435
 Site-sketch                    (0) | Train Loss: 1.6541 | Train Acc: 0.3103
Average Train Accuracy: 0.8283
 Site-photo                     (1) | Val  Loss: 0.6467 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.7530 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.5749 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5965 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.6299 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6482 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.5591 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.5797 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.6034 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.6086 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 1.0413 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 1.0425 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 1.0253 | Val  Acc: 0.7692
 Site-art_painting              (3) | Val  Loss: 1.0441 | Val  Acc: 0.8511
 Site-art_painting              (3) | Val  Loss: 1.0906 | Val  Acc: 0.7294
 Site-cartoon                   (4) | Val  Loss: 1.4159 | Val  Acc: 0.4286
 Site-cartoon                   (5) | Val  Loss: 1.3170 | Val  Acc: 0.5974
 Site-sketch                    (0) | Val  Loss: 1.6519 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8350
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9588
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.8667
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.7692
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.8511
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.7294
 Best site-cartoon                  (4)  | Epoch:10 | Val Acc: 0.4286
 Best site-cartoon                  (5)  | Epoch:10 | Val Acc: 0.5974
 Best site-sketch                   (0)  | Epoch:10 | Val Acc: 0.3590
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 11 ============
cnt=[4, 6, 1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (3) | Train Loss: 0.6503 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.5783 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.6563 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.5295 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5752 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.5643 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.4916 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5156 | Train Acc: 0.9318
 Site-photo                     (1) | Train Loss: 0.5510 | Train Acc: 0.9558
 Site-photo                     (3) | Train Loss: 0.5680 | Train Acc: 0.9658
 Site-art_painting              (5) | Train Loss: 1.0244 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 1.1186 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 1.2044 | Train Acc: 0.5750
 Site-art_painting              (0) | Train Loss: 1.1501 | Train Acc: 0.7778
 Site-art_painting              (0) | Train Loss: 1.0292 | Train Acc: 0.8281
 Site-cartoon                   (4) | Train Loss: 1.0519 | Train Acc: 0.8182
 Site-cartoon                   (4) | Train Loss: 1.2314 | Train Acc: 0.7043
 Site-sketch                    (2) | Train Loss: 1.6018 | Train Acc: 0.3793
Average Train Accuracy: 0.8535
 Site-photo                     (3) | Val  Loss: 0.5746 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.6892 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.5547 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.5600 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.5658 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.6211 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.5118 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.5128 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.5547 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.5237 | Val  Acc: 0.9691
 Site-art_painting              (5) | Val  Loss: 0.9528 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 1.1293 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.8933 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 0.9945 | Val  Acc: 0.7872
 Site-art_painting              (0) | Val  Loss: 0.9987 | Val  Acc: 0.8000
 Site-cartoon                   (4) | Val  Loss: 1.5597 | Val  Acc: 0.1429
 Site-cartoon                   (4) | Val  Loss: 1.3072 | Val  Acc: 0.6494
 Site-sketch                    (2) | Val  Loss: 1.6835 | Val  Acc: 0.2308
Average Valid Accuracy: 0.8175
============ Train epoch 12 ============
cnt=[1, 8, 2, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (1) | Train Loss: 0.6315 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.6142 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.6565 | Train Acc: 0.8333
 Site-photo                     (1) | Train Loss: 0.5061 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5185 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.5381 | Train Acc: 0.9808
 Site-photo                     (5) | Train Loss: 0.3728 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5236 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.5128 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.5441 | Train Acc: 0.9726
 Site-art_painting              (5) | Train Loss: 0.9985 | Train Acc: 0.5833
 Site-art_painting              (3) | Train Loss: 1.1459 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 1.0518 | Train Acc: 0.7000
 Site-art_painting              (3) | Train Loss: 0.8835 | Train Acc: 0.7917
 Site-art_painting              (3) | Train Loss: 0.8937 | Train Acc: 0.8438
 Site-cartoon                   (2) | Train Loss: 0.9834 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 1.2214 | Train Acc: 0.6522
 Site-sketch                    (0) | Train Loss: 1.5776 | Train Acc: 0.3621
Average Train Accuracy: 0.8436
 Site-photo                     (1) | Val  Loss: 0.5835 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.6255 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.4943 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4550 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.5383 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5913 | Val  Acc: 0.9429
 Site-photo                     (5) | Val  Loss: 0.4553 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.4843 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.4766 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.5046 | Val  Acc: 0.9794
 Site-art_painting              (5) | Val  Loss: 0.9496 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 1.0256 | Val  Acc: 0.7333
 Site-art_painting              (3) | Val  Loss: 0.8288 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.9391 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.9838 | Val  Acc: 0.8118
 Site-cartoon                   (2) | Val  Loss: 1.4046 | Val  Acc: 0.5714
 Site-cartoon                   (2) | Val  Loss: 1.2087 | Val  Acc: 0.6883
 Site-sketch                    (0) | Val  Loss: 1.6142 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8556
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.8889
 Best site-photo                    (4)  | Epoch:12 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9429
 Best site-photo                    (5)  | Epoch:12 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9794
 Best site-art_painting             (5)  | Epoch:12 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.7333
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.8846
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.9149
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.8118
 Best site-cartoon                  (2)  | Epoch:12 | Val Acc: 0.5714
 Best site-cartoon                  (2)  | Epoch:12 | Val Acc: 0.6883
 Best site-sketch                   (0)  | Epoch:12 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 6, 1, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (4) | Train Loss: 0.6157 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 0.5444 | Train Acc: 0.8889
 Site-photo                     (4) | Train Loss: 0.5300 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.4829 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4686 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.4778 | Train Acc: 0.9615
 Site-photo                     (4) | Train Loss: 0.3582 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.4776 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.4779 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.5057 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 1.0113 | Train Acc: 0.7500
 Site-art_painting              (3) | Train Loss: 1.1708 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 1.0304 | Train Acc: 0.7000
 Site-art_painting              (3) | Train Loss: 0.9481 | Train Acc: 0.8056
 Site-art_painting              (3) | Train Loss: 0.8725 | Train Acc: 0.8047
 Site-cartoon                   (5) | Train Loss: 0.8713 | Train Acc: 0.9091
 Site-cartoon                   (5) | Train Loss: 1.1082 | Train Acc: 0.7391
 Site-sketch                    (2) | Train Loss: 1.4871 | Train Acc: 0.5172
Average Train Accuracy: 0.8673
 Site-photo                     (4) | Val  Loss: 0.5678 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.5243 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.4714 | Val  Acc: 0.9375
 Site-photo                     (4) | Val  Loss: 0.4558 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.5244 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5386 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.4535 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.4678 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.4634 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.4799 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.9357 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.8073 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.8436 | Val  Acc: 0.8462
 Site-art_painting              (3) | Val  Loss: 0.8917 | Val  Acc: 0.8085
 Site-art_painting              (3) | Val  Loss: 0.9159 | Val  Acc: 0.7529
 Site-cartoon                   (5) | Val  Loss: 1.1593 | Val  Acc: 0.7143
 Site-cartoon                   (5) | Val  Loss: 1.1731 | Val  Acc: 0.7403
 Site-sketch                    (2) | Val  Loss: 1.5640 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8670
 Best site-photo                    (4)  | Epoch:13 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9167
 Best site-photo                    (4)  | Epoch:13 | Val Acc: 0.9375
 Best site-photo                    (4)  | Epoch:13 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9429
 Best site-photo                    (4)  | Epoch:13 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.9333
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.8462
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.8085
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.7529
 Best site-cartoon                  (5)  | Epoch:13 | Val Acc: 0.7143
 Best site-cartoon                  (5)  | Epoch:13 | Val Acc: 0.7403
 Best site-sketch                   (2)  | Epoch:13 | Val Acc: 0.4103
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 5, 4, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (1) | Train Loss: 0.5762 | Train Acc: 0.8571
 Site-photo                     (1) | Train Loss: 0.4504 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.5655 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4281 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.4356 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.4180 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.3155 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.4336 | Train Acc: 0.9545
 Site-photo                     (4) | Train Loss: 0.4327 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.4501 | Train Acc: 0.9589
 Site-art_painting              (0) | Train Loss: 0.9947 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.0576 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 0.9530 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 0.8836 | Train Acc: 0.8750
 Site-art_painting              (2) | Train Loss: 0.8179 | Train Acc: 0.8203
 Site-cartoon                   (3) | Train Loss: 0.8276 | Train Acc: 0.9091
 Site-cartoon                   (3) | Train Loss: 1.0818 | Train Acc: 0.7391
 Site-sketch                    (5) | Train Loss: 1.4678 | Train Acc: 0.5000
Average Train Accuracy: 0.8745
 Site-photo                     (1) | Val  Loss: 0.5133 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5617 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.4217 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.4447 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.4608 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.5182 | Val  Acc: 0.9714
 Site-photo                     (4) | Val  Loss: 0.4180 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.4525 | Val  Acc: 0.9483
 Site-photo                     (4) | Val  Loss: 0.4297 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4333 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.7016 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.8475 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.7865 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.9025 | Val  Acc: 0.7660
 Site-art_painting              (2) | Val  Loss: 0.8864 | Val  Acc: 0.8235
 Site-cartoon                   (3) | Val  Loss: 1.2328 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.1001 | Val  Acc: 0.7532
 Site-sketch                    (5) | Val  Loss: 1.4665 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8736
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9524
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 0.9714
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9483
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:14 | Val Acc: 0.8667
 Best site-art_painting             (2)  | Epoch:14 | Val Acc: 0.8462
 Best site-art_painting             (2)  | Epoch:14 | Val Acc: 0.7660
 Best site-art_painting             (2)  | Epoch:14 | Val Acc: 0.8235
 Best site-cartoon                  (3)  | Epoch:14 | Val Acc: 0.5714
 Best site-cartoon                  (3)  | Epoch:14 | Val Acc: 0.7532
 Best site-sketch                   (5)  | Epoch:14 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 5, 1, 2, 4, 5, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (5) | Train Loss: 0.5526 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4346 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.5184 | Train Acc: 0.9583
 Site-photo                     (5) | Train Loss: 0.3976 | Train Acc: 0.9677
 Site-photo                     (1) | Train Loss: 0.4272 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.3975 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2568 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.4231 | Train Acc: 0.9318
 Site-photo                     (1) | Train Loss: 0.4177 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.4419 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.8535 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.8833 | Train Acc: 0.8636
 Site-art_painting              (4) | Train Loss: 0.9405 | Train Acc: 0.7750
 Site-art_painting              (4) | Train Loss: 0.6069 | Train Acc: 0.8194
 Site-art_painting              (4) | Train Loss: 0.7882 | Train Acc: 0.8438
 Site-cartoon                   (3) | Train Loss: 0.8312 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.0266 | Train Acc: 0.7304
 Site-sketch                    (2) | Train Loss: 1.4287 | Train Acc: 0.5345
Average Train Accuracy: 0.8848
 Site-photo                     (5) | Val  Loss: 0.4362 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.4874 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.4073 | Val  Acc: 0.9375
 Site-photo                     (5) | Val  Loss: 0.3993 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.4100 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5005 | Val  Acc: 0.9429
 Site-photo                     (5) | Val  Loss: 0.3816 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.4115 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.4047 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.3777 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.7455 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.8068 | Val  Acc: 0.8000
 Site-art_painting              (4) | Val  Loss: 0.7308 | Val  Acc: 0.9231
 Site-art_painting              (4) | Val  Loss: 0.8217 | Val  Acc: 0.8298
 Site-art_painting              (4) | Val  Loss: 0.8454 | Val  Acc: 0.7765
 Site-cartoon                   (3) | Val  Loss: 1.3232 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.0966 | Val  Acc: 0.7532
 Site-sketch                    (2) | Val  Loss: 1.4389 | Val  Acc: 0.5128
Average Valid Accuracy: 0.8705
============ Train epoch 16 ============
cnt=[5, 4, 2, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (4) | Train Loss: 0.4776 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.4203 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.4952 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.3855 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.3769 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.3689 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.3885 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3929 | Train Acc: 0.9432
 Site-photo                     (4) | Train Loss: 0.3918 | Train Acc: 0.9646
 Site-photo                     (4) | Train Loss: 0.3645 | Train Acc: 0.9795
 Site-art_painting              (5) | Train Loss: 0.6782 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.9404 | Train Acc: 0.8182
 Site-art_painting              (1) | Train Loss: 0.9455 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 0.6739 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.7207 | Train Acc: 0.8906
 Site-cartoon                   (2) | Train Loss: 0.7899 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.9822 | Train Acc: 0.7739
 Site-sketch                    (3) | Train Loss: 1.3493 | Train Acc: 0.5517
Average Train Accuracy: 0.8930
 Site-photo                     (4) | Val  Loss: 0.3708 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.4400 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.3350 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3520 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.3635 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4605 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.3755 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3762 | Val  Acc: 0.9483
 Site-photo                     (4) | Val  Loss: 0.3889 | Val  Acc: 0.9867
 Site-photo                     (4) | Val  Loss: 0.3460 | Val  Acc: 0.9794
 Site-art_painting              (5) | Val  Loss: 0.6772 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.7332 | Val  Acc: 0.7333
 Site-art_painting              (1) | Val  Loss: 0.7149 | Val  Acc: 0.7692
 Site-art_painting              (1) | Val  Loss: 0.7869 | Val  Acc: 0.7872
 Site-art_painting              (1) | Val  Loss: 0.7997 | Val  Acc: 0.8353
 Site-cartoon                   (2) | Val  Loss: 1.1120 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 1.0611 | Val  Acc: 0.7662
 Site-sketch                    (3) | Val  Loss: 1.4033 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8669
============ Train epoch 17 ============
cnt=[5, 1, 4, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (5) | Train Loss: 0.4643 | Train Acc: 0.9286
 Site-photo                     (2) | Train Loss: 0.3431 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.4578 | Train Acc: 0.9583
 Site-photo                     (5) | Train Loss: 0.3419 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.3778 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3553 | Train Acc: 0.9808
 Site-photo                     (4) | Train Loss: 0.2562 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.3773 | Train Acc: 0.9318
 Site-photo                     (2) | Train Loss: 0.3459 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.3436 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.6406 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.8889 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.8976 | Train Acc: 0.7000
 Site-art_painting              (0) | Train Loss: 0.8308 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6856 | Train Acc: 0.8281
 Site-cartoon                   (3) | Train Loss: 0.7428 | Train Acc: 0.9091
 Site-cartoon                   (3) | Train Loss: 0.9505 | Train Acc: 0.7652
 Site-sketch                    (1) | Train Loss: 1.2913 | Train Acc: 0.6034
Average Train Accuracy: 0.8988
 Site-photo                     (5) | Val  Loss: 0.5081 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.4760 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.3031 | Val  Acc: 0.9375
 Site-photo                     (5) | Val  Loss: 0.3625 | Val  Acc: 0.9524
 Site-photo                     (5) | Val  Loss: 0.3485 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4248 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.3394 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.3919 | Val  Acc: 0.9483
 Site-photo                     (2) | Val  Loss: 0.3499 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3355 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.4785 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.8563 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.5930 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.6853 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.7561 | Val  Acc: 0.8353
 Site-cartoon                   (3) | Val  Loss: 1.0991 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 1.0672 | Val  Acc: 0.7662
 Site-sketch                    (1) | Val  Loss: 1.2174 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8966
 Best site-photo                    (5)  | Epoch:17 | Val Acc: 0.8889
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9167
 Best site-photo                    (4)  | Epoch:17 | Val Acc: 0.9375
 Best site-photo                    (5)  | Epoch:17 | Val Acc: 0.9524
 Best site-photo                    (5)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9429
 Best site-photo                    (4)  | Epoch:17 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:17 | Val Acc: 0.9483
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8723
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8353
 Best site-cartoon                  (3)  | Epoch:17 | Val Acc: 0.7143
 Best site-cartoon                  (3)  | Epoch:17 | Val Acc: 0.7662
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 18 ============
cnt=[7, 2, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.4387 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.3521 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.4045 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3228 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3652 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.3465 | Train Acc: 0.9615
 Site-photo                     (4) | Train Loss: 0.3070 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3380 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.3193 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.3476 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.7780 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.7950 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 0.7718 | Train Acc: 0.8250
 Site-art_painting              (3) | Train Loss: 0.7159 | Train Acc: 0.8472
 Site-art_painting              (3) | Train Loss: 0.6156 | Train Acc: 0.9062
 Site-cartoon                   (1) | Train Loss: 0.8381 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.9412 | Train Acc: 0.7739
 Site-sketch                    (2) | Train Loss: 1.2029 | Train Acc: 0.6552
Average Train Accuracy: 0.8969
 Site-photo                     (0) | Val  Loss: 0.3230 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.3509 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.3049 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3294 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.3170 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3907 | Val  Acc: 0.9714
 Site-photo                     (4) | Val  Loss: 0.3353 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.3550 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 0.3372 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3071 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.4564 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.6738 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 0.5979 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.6516 | Val  Acc: 0.8723
 Site-art_painting              (3) | Val  Loss: 0.6393 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 0.9732 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.9653 | Val  Acc: 0.7662
 Site-sketch                    (2) | Val  Loss: 1.3078 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8953
============ Train epoch 19 ============
cnt=[2, 4, 5, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (1) | Train Loss: 0.4299 | Train Acc: 0.9286
 Site-photo                     (5) | Train Loss: 0.3038 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.4134 | Train Acc: 0.9167
 Site-photo                     (5) | Train Loss: 0.2977 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.3135 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.3147 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.2999 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3173 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2937 | Train Acc: 0.9823
 Site-photo                     (5) | Train Loss: 0.3068 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.8799 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 0.7397 | Train Acc: 0.8636
 Site-art_painting              (2) | Train Loss: 0.7221 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 0.5380 | Train Acc: 0.8750
 Site-art_painting              (2) | Train Loss: 0.6221 | Train Acc: 0.8750
 Site-cartoon                   (0) | Train Loss: 0.8206 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.8758 | Train Acc: 0.7565
 Site-sketch                    (3) | Train Loss: 1.1206 | Train Acc: 0.6379
Average Train Accuracy: 0.8853
 Site-photo                     (1) | Val  Loss: 0.4785 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.3809 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.3085 | Val  Acc: 0.9375
 Site-photo                     (5) | Val  Loss: 0.3153 | Val  Acc: 0.9524
 Site-photo                     (5) | Val  Loss: 0.2996 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.3534 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.2905 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.3083 | Val  Acc: 0.9483
 Site-photo                     (1) | Val  Loss: 0.3013 | Val  Acc: 0.9733
 Site-photo                     (5) | Val  Loss: 0.2882 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.6003 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.5700 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.5707 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.6587 | Val  Acc: 0.8723
 Site-art_painting              (2) | Val  Loss: 0.6237 | Val  Acc: 0.8588
 Site-cartoon                   (0) | Val  Loss: 0.8876 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.9200 | Val  Acc: 0.7792
 Site-sketch                    (3) | Val  Loss: 1.1848 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8982
 Best site-photo                    (1)  | Epoch:19 | Val Acc: 0.8889
 Best site-photo                    (5)  | Epoch:19 | Val Acc: 0.9167
 Best site-photo                    (4)  | Epoch:19 | Val Acc: 0.9375
 Best site-photo                    (5)  | Epoch:19 | Val Acc: 0.9524
 Best site-photo                    (5)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:19 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:19 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:19 | Val Acc: 0.9483
 Best site-photo                    (1)  | Epoch:19 | Val Acc: 0.9733
 Best site-photo                    (5)  | Epoch:19 | Val Acc: 0.9897
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.8750
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.9231
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.8723
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.8588
 Best site-cartoon                  (0)  | Epoch:19 | Val Acc: 0.8571
 Best site-cartoon                  (0)  | Epoch:19 | Val Acc: 0.7792
 Best site-sketch                   (3)  | Epoch:19 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 20 ============
cnt=[7, 1, 3, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (2) | Train Loss: 0.3502 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3277 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.3766 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.2679 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2947 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.2757 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.3506 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3332 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.2629 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.2911 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.6253 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.7641 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.7013 | Train Acc: 0.8250
 Site-art_painting              (3) | Train Loss: 0.5557 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.6122 | Train Acc: 0.8750
 Site-cartoon                   (4) | Train Loss: 0.6729 | Train Acc: 0.9091
 Site-cartoon                   (5) | Train Loss: 0.8389 | Train Acc: 0.7652
 Site-sketch                    (1) | Train Loss: 1.0869 | Train Acc: 0.7069
Average Train Accuracy: 0.9102
 Site-photo                     (2) | Val  Loss: 0.4693 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.4504 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2523 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3057 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.2990 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3387 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.2940 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2800 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2567 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2920 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.4732 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.6777 | Val  Acc: 0.7333
 Site-art_painting              (3) | Val  Loss: 0.4902 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.5726 | Val  Acc: 0.8723
 Site-art_painting              (3) | Val  Loss: 0.5985 | Val  Acc: 0.8941
 Site-cartoon                   (4) | Val  Loss: 0.9334 | Val  Acc: 0.8571
 Site-cartoon                   (5) | Val  Loss: 0.9166 | Val  Acc: 0.8052
 Site-sketch                    (1) | Val  Loss: 1.0386 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9149
 Best site-photo                    (2)  | Epoch:20 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:20 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9794
 Best site-art_painting             (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:20 | Val Acc: 0.7333
 Best site-art_painting             (3)  | Epoch:20 | Val Acc: 0.9615
 Best site-art_painting             (3)  | Epoch:20 | Val Acc: 0.8723
 Best site-art_painting             (3)  | Epoch:20 | Val Acc: 0.8941
 Best site-cartoon                  (4)  | Epoch:20 | Val Acc: 0.8571
 Best site-cartoon                  (5)  | Epoch:20 | Val Acc: 0.8052
 Best site-sketch                   (1)  | Epoch:20 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 5, 5, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (4) | Train Loss: 0.3825 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 0.2761 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.3887 | Train Acc: 0.9167
 Site-photo                     (4) | Train Loss: 0.2527 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3049 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.2874 | Train Acc: 0.9808
 Site-photo                     (4) | Train Loss: 0.2229 | Train Acc: 0.9706
 Site-photo                     (4) | Train Loss: 0.2900 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2662 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.3070 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.5524 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.7432 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.7338 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 0.5785 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.5401 | Train Acc: 0.8984
 Site-cartoon                   (0) | Train Loss: 0.7006 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.7553 | Train Acc: 0.8435
 Site-sketch                    (3) | Train Loss: 1.1014 | Train Acc: 0.6552
Average Train Accuracy: 0.9037
 Site-photo                     (4) | Val  Loss: 0.2723 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4020 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.2054 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2879 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.2437 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3070 | Val  Acc: 0.9714
 Site-photo                     (4) | Val  Loss: 0.2679 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.2810 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.2488 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2568 | Val  Acc: 0.9588
 Site-art_painting              (2) | Val  Loss: 0.3980 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.4408 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.4562 | Val  Acc: 0.9615
 Site-art_painting              (2) | Val  Loss: 0.5210 | Val  Acc: 0.9149
 Site-art_painting              (2) | Val  Loss: 0.6318 | Val  Acc: 0.8824
 Site-cartoon                   (0) | Val  Loss: 1.0611 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.8245 | Val  Acc: 0.7532
 Site-sketch                    (3) | Val  Loss: 1.1796 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9173
 Best site-photo                    (4)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9167
 Best site-photo                    (5)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:21 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9714
 Best site-photo                    (4)  | Epoch:21 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:21 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9588
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.9615
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.9149
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.8824
 Best site-cartoon                  (0)  | Epoch:21 | Val Acc: 0.7143
 Best site-cartoon                  (0)  | Epoch:21 | Val Acc: 0.7532
 Best site-sketch                   (3)  | Epoch:21 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 22 ============
cnt=[5, 1, 8, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (2) | Train Loss: 0.3287 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4153 | Train Acc: 0.8889
 Site-photo                     (3) | Train Loss: 0.3460 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.2663 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3022 | Train Acc: 0.9250
 Site-photo                     (2) | Train Loss: 0.2547 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1889 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3411 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.2513 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.2938 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.5691 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.7193 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.7293 | Train Acc: 0.7750
 Site-art_painting              (0) | Train Loss: 0.5784 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.5373 | Train Acc: 0.9141
 Site-cartoon                   (1) | Train Loss: 0.6704 | Train Acc: 0.9091
 Site-cartoon                   (5) | Train Loss: 0.7199 | Train Acc: 0.8261
 Site-sketch                    (4) | Train Loss: 1.0860 | Train Acc: 0.6379
Average Train Accuracy: 0.9115
 Site-photo                     (2) | Val  Loss: 0.4187 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.3876 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.2356 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2927 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.2214 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3200 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.2349 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.2598 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.2464 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2455 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.4468 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4623 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5194 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.4865 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.5475 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 1.0031 | Val  Acc: 0.5714
 Site-cartoon                   (5) | Val  Loss: 0.7928 | Val  Acc: 0.8571
 Site-sketch                    (4) | Val  Loss: 1.0384 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9150
============ Train epoch 23 ============
cnt=[7, 2, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (5) | Train Loss: 0.3783 | Train Acc: 0.9286
 Site-photo                     (4) | Train Loss: 0.2682 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3346 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.2174 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2782 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.2757 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.1435 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2772 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.2516 | Train Acc: 0.9823
 Site-photo                     (4) | Train Loss: 0.2415 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.5165 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.6947 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 0.6817 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 0.4448 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.5413 | Train Acc: 0.8672
 Site-cartoon                   (1) | Train Loss: 0.5671 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.7135 | Train Acc: 0.8000
 Site-sketch                    (3) | Train Loss: 1.0231 | Train Acc: 0.7414
Average Train Accuracy: 0.9075
 Site-photo                     (5) | Val  Loss: 0.2120 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.3994 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2238 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3131 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.2229 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2926 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2710 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2435 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2314 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2207 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.3987 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.5393 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.4905 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.5065 | Val  Acc: 0.9362
 Site-art_painting              (2) | Val  Loss: 0.5328 | Val  Acc: 0.8706
 Site-cartoon                   (1) | Val  Loss: 0.8980 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.8049 | Val  Acc: 0.8312
 Site-sketch                    (3) | Val  Loss: 1.0228 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9229
 Best site-photo                    (5)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:23 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:23 | Val Acc: 0.9897
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 0.9231
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 0.9362
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 0.8706
 Best site-cartoon                  (1)  | Epoch:23 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:23 | Val Acc: 0.8312
 Best site-sketch                   (3)  | Epoch:23 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 24 ============
cnt=[5, 2, 3, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (0) | Train Loss: 0.2749 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2239 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2859 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2210 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2573 | Train Acc: 0.9500
 Site-photo                     (4) | Train Loss: 0.2200 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1383 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2561 | Train Acc: 0.9432
 Site-photo                     (4) | Train Loss: 0.2305 | Train Acc: 0.9735
 Site-photo                     (4) | Train Loss: 0.2471 | Train Acc: 0.9863
 Site-art_painting              (5) | Train Loss: 0.5955 | Train Acc: 0.8333
 Site-art_painting              (5) | Train Loss: 0.6377 | Train Acc: 0.9091
 Site-art_painting              (2) | Train Loss: 0.6532 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 0.4251 | Train Acc: 0.9028
 Site-art_painting              (2) | Train Loss: 0.5184 | Train Acc: 0.8984
 Site-cartoon                   (1) | Train Loss: 0.5854 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.7143 | Train Acc: 0.7913
 Site-sketch                    (3) | Train Loss: 1.0238 | Train Acc: 0.6724
Average Train Accuracy: 0.9191
 Site-photo                     (0) | Val  Loss: 0.2652 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2779 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2308 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.2517 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.2281 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2751 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.2194 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2422 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.2222 | Val  Acc: 0.9867
 Site-photo                     (4) | Val  Loss: 0.2154 | Val  Acc: 0.9691
 Site-art_painting              (5) | Val  Loss: 0.2600 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.4651 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.3495 | Val  Acc: 0.9615
 Site-art_painting              (2) | Val  Loss: 0.4868 | Val  Acc: 0.9362
 Site-art_painting              (2) | Val  Loss: 0.5060 | Val  Acc: 0.8824
 Site-cartoon                   (1) | Val  Loss: 0.8160 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.7642 | Val  Acc: 0.8312
 Site-sketch                    (3) | Val  Loss: 0.9443 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9333
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:24 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9524
 Best site-photo                    (4)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:24 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9655
 Best site-photo                    (4)  | Epoch:24 | Val Acc: 0.9867
 Best site-photo                    (4)  | Epoch:24 | Val Acc: 0.9691
 Best site-art_painting             (5)  | Epoch:24 | Val Acc: 1.0000
 Best site-art_painting             (5)  | Epoch:24 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.9615
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.9362
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.8824
 Best site-cartoon                  (1)  | Epoch:24 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:24 | Val Acc: 0.8312
 Best site-sketch                   (3)  | Epoch:24 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 25 ============
cnt=[3, 2, 1, 4, 7, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (4) | Train Loss: 0.2780 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2516 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3259 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2231 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2566 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1853 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1637 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2362 | Train Acc: 0.9432
 Site-photo                     (4) | Train Loss: 0.2309 | Train Acc: 0.9735
 Site-photo                     (4) | Train Loss: 0.2572 | Train Acc: 0.9658
 Site-art_painting              (5) | Train Loss: 0.5703 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.6619 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.6068 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.4865 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.4544 | Train Acc: 0.9062
 Site-cartoon                   (1) | Train Loss: 0.5517 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.6431 | Train Acc: 0.8348
 Site-sketch                    (2) | Train Loss: 0.8981 | Train Acc: 0.7931
Average Train Accuracy: 0.9324
 Site-photo                     (4) | Val  Loss: 0.3701 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.2660 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1701 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2500 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1789 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2702 | Val  Acc: 0.9714
 Site-photo                     (4) | Val  Loss: 0.2196 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2202 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.1967 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2047 | Val  Acc: 0.9897
 Site-art_painting              (5) | Val  Loss: 0.3401 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.5534 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.4870 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.4819 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.4675 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.9024 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.7651 | Val  Acc: 0.8182
 Site-sketch                    (2) | Val  Loss: 0.8747 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9206
============ Train epoch 26 ============
cnt=[3, 1, 2, 1, 6, 5, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (0) | Train Loss: 0.2157 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2588 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.2887 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1861 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2281 | Train Acc: 0.9500
 Site-photo                     (4) | Train Loss: 0.2190 | Train Acc: 0.9615
 Site-photo                     (4) | Train Loss: 0.1700 | Train Acc: 0.9853
 Site-photo                     (4) | Train Loss: 0.2884 | Train Acc: 0.9545
 Site-photo                     (4) | Train Loss: 0.2001 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2255 | Train Acc: 0.9863
 Site-art_painting              (5) | Train Loss: 0.4645 | Train Acc: 1.0000
 Site-art_painting              (5) | Train Loss: 0.7609 | Train Acc: 0.8182
 Site-art_painting              (5) | Train Loss: 0.6131 | Train Acc: 0.8750
 Site-art_painting              (5) | Train Loss: 0.4995 | Train Acc: 0.9167
 Site-art_painting              (5) | Train Loss: 0.4538 | Train Acc: 0.9219
 Site-cartoon                   (2) | Train Loss: 0.4737 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.6729 | Train Acc: 0.8261
 Site-sketch                    (3) | Train Loss: 0.8193 | Train Acc: 0.7759
Average Train Accuracy: 0.9332
 Site-photo                     (0) | Val  Loss: 0.2895 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2366 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.1728 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2594 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1675 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2827 | Val  Acc: 0.9143
 Site-photo                     (4) | Val  Loss: 0.2028 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.2382 | Val  Acc: 0.9483
 Site-photo                     (4) | Val  Loss: 0.1829 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.2086 | Val  Acc: 0.9691
 Site-art_painting              (5) | Val  Loss: 0.2432 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.4288 | Val  Acc: 0.9333
 Site-art_painting              (5) | Val  Loss: 0.4472 | Val  Acc: 0.8846
 Site-art_painting              (5) | Val  Loss: 0.4480 | Val  Acc: 0.9574
 Site-art_painting              (5) | Val  Loss: 0.4806 | Val  Acc: 0.8706
 Site-cartoon                   (2) | Val  Loss: 0.9191 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.7821 | Val  Acc: 0.8182
 Site-sketch                    (3) | Val  Loss: 0.9493 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9127
============ Train epoch 27 ============
cnt=[5, 1, 2, 2, 5, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (0) | Train Loss: 0.2449 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3267 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.2611 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.1954 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2143 | Train Acc: 0.9750
 Site-photo                     (4) | Train Loss: 0.1818 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.2343 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2199 | Train Acc: 0.9432
 Site-photo                     (4) | Train Loss: 0.1893 | Train Acc: 0.9823
 Site-photo                     (4) | Train Loss: 0.2080 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.4921 | Train Acc: 0.8333
 Site-art_painting              (5) | Train Loss: 0.6073 | Train Acc: 0.8636
 Site-art_painting              (5) | Train Loss: 0.6079 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.4853 | Train Acc: 0.8889
 Site-art_painting              (5) | Train Loss: 0.3952 | Train Acc: 0.9297
 Site-cartoon                   (3) | Train Loss: 0.6852 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 0.6277 | Train Acc: 0.8348
 Site-sketch                    (1) | Train Loss: 0.8160 | Train Acc: 0.7759
Average Train Accuracy: 0.9117
 Site-photo                     (0) | Val  Loss: 0.3802 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.2369 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1795 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.2620 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1644 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2148 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2105 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.2132 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.2189 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1848 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.2777 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.4171 | Val  Acc: 0.9333
 Site-art_painting              (5) | Val  Loss: 0.3905 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3994 | Val  Acc: 0.9787
 Site-art_painting              (5) | Val  Loss: 0.4482 | Val  Acc: 0.8941
 Site-cartoon                   (3) | Val  Loss: 0.8872 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 0.6384 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.9228 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9062
============ Train epoch 28 ============
cnt=[5, 1, 2, 1, 6, 3, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (5) | Train Loss: 0.2436 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2182 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.2607 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1613 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2225 | Train Acc: 0.9500
 Site-photo                     (4) | Train Loss: 0.2416 | Train Acc: 0.9615
 Site-photo                     (5) | Train Loss: 0.1135 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1839 | Train Acc: 0.9545
 Site-photo                     (4) | Train Loss: 0.1875 | Train Acc: 0.9735
 Site-photo                     (4) | Train Loss: 0.2054 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.4109 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.7245 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.6026 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.4697 | Train Acc: 0.9306
 Site-art_painting              (0) | Train Loss: 0.4476 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.6328 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.6095 | Train Acc: 0.8522
 Site-sketch                    (1) | Train Loss: 0.8570 | Train Acc: 0.7586
Average Train Accuracy: 0.9306
 Site-photo                     (5) | Val  Loss: 0.4096 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.1868 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1396 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2339 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1542 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2366 | Val  Acc: 0.9143
 Site-photo                     (5) | Val  Loss: 0.2204 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.1827 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.1809 | Val  Acc: 0.9867
 Site-photo                     (4) | Val  Loss: 0.2009 | Val  Acc: 0.9588
 Site-art_painting              (0) | Val  Loss: 0.2370 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3267 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4222 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.4157 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.4256 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.7675 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.7040 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.8508 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9347
 Best site-photo                    (5)  | Epoch:28 | Val Acc: 0.8889
 Best site-photo                    (4)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:28 | Val Acc: 0.9524
 Best site-photo                    (4)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:28 | Val Acc: 0.9143
 Best site-photo                    (5)  | Epoch:28 | Val Acc: 0.9333
 Best site-photo                    (4)  | Epoch:28 | Val Acc: 0.9655
 Best site-photo                    (4)  | Epoch:28 | Val Acc: 0.9867
 Best site-photo                    (4)  | Epoch:28 | Val Acc: 0.9588
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9149
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9176
 Best site-cartoon                  (2)  | Epoch:28 | Val Acc: 0.8571
 Best site-cartoon                  (2)  | Epoch:28 | Val Acc: 0.8831
 Best site-sketch                   (1)  | Epoch:28 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 9, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (1) | Train Loss: 0.2292 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1995 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.2146 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1635 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2272 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.1901 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.0995 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.1840 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.1730 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.1848 | Train Acc: 0.9795
 Site-art_painting              (4) | Train Loss: 0.4402 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.4915 | Train Acc: 0.9091
 Site-art_painting              (4) | Train Loss: 0.5326 | Train Acc: 0.8500
 Site-art_painting              (4) | Train Loss: 0.4809 | Train Acc: 0.8889
 Site-art_painting              (4) | Train Loss: 0.4204 | Train Acc: 0.9219
 Site-cartoon                   (0) | Train Loss: 0.5960 | Train Acc: 0.9091
 Site-cartoon                   (5) | Train Loss: 0.6052 | Train Acc: 0.8261
 Site-sketch                    (2) | Train Loss: 0.8054 | Train Acc: 0.7069
Average Train Accuracy: 0.9274
 Site-photo                     (1) | Val  Loss: 0.1882 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2080 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.1228 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2676 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.1406 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2552 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.2165 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1916 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1675 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.1773 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.2383 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.3547 | Val  Acc: 0.9333
 Site-art_painting              (4) | Val  Loss: 0.4098 | Val  Acc: 0.8462
 Site-art_painting              (4) | Val  Loss: 0.3585 | Val  Acc: 0.9149
 Site-art_painting              (4) | Val  Loss: 0.4229 | Val  Acc: 0.8941
 Site-cartoon                   (0) | Val  Loss: 0.8710 | Val  Acc: 0.5714
 Site-cartoon                   (5) | Val  Loss: 0.7737 | Val  Acc: 0.8571
 Site-sketch                    (2) | Val  Loss: 0.8604 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9163
============ Train epoch 30 ============
cnt=[1, 7, 2, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (1) | Train Loss: 0.2226 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2207 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.2151 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1517 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2129 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.2077 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.0946 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.2209 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.1690 | Train Acc: 0.9735
 Site-photo                     (4) | Train Loss: 0.1776 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 0.4901 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.5670 | Train Acc: 0.9545
 Site-art_painting              (3) | Train Loss: 0.4670 | Train Acc: 0.9250
 Site-art_painting              (4) | Train Loss: 0.5136 | Train Acc: 0.9028
 Site-art_painting              (4) | Train Loss: 0.3626 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.5760 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.5572 | Train Acc: 0.8783
 Site-sketch                    (0) | Train Loss: 0.7563 | Train Acc: 0.8103
Average Train Accuracy: 0.9367
 Site-photo                     (1) | Val  Loss: 0.1847 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2907 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.1314 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1845 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1414 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2306 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.1948 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1860 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1481 | Val  Acc: 0.9867
 Site-photo                     (4) | Val  Loss: 0.1765 | Val  Acc: 0.9588
 Site-art_painting              (1) | Val  Loss: 0.2380 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.6276 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.3185 | Val  Acc: 0.9615
 Site-art_painting              (4) | Val  Loss: 0.3457 | Val  Acc: 0.9362
 Site-art_painting              (4) | Val  Loss: 0.4101 | Val  Acc: 0.9294
 Site-cartoon                   (2) | Val  Loss: 0.7452 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6089 | Val  Acc: 0.8571
 Site-sketch                    (0) | Val  Loss: 0.8764 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9281
============ Train epoch 31 ============
cnt=[6, 1, 2, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.1878 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2178 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.2162 | Train Acc: 0.9583
 Site-photo                     (4) | Train Loss: 0.1483 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2009 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1529 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1363 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1899 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1710 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1697 | Train Acc: 0.9863
 Site-art_painting              (5) | Train Loss: 0.4041 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.4987 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.5285 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.4412 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.3804 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.4002 | Train Acc: 1.0000
 Site-cartoon                   (2) | Train Loss: 0.5095 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.7531 | Train Acc: 0.7586
Average Train Accuracy: 0.9397
 Site-photo                     (0) | Val  Loss: 0.4602 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1835 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.1118 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2318 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1584 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2225 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.1884 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1875 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1604 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1779 | Val  Acc: 0.9691
 Site-art_painting              (5) | Val  Loss: 0.3540 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.3567 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.3530 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.4129 | Val  Acc: 0.8936
 Site-art_painting              (3) | Val  Loss: 0.3617 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.6254 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.5500 | Val  Acc: 0.9091
 Site-sketch                    (1) | Val  Loss: 0.8445 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9327
============ Train epoch 32 ============
cnt=[4, 1, 1, 7, 4, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (3) | Train Loss: 0.2231 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1610 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2223 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1307 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2002 | Train Acc: 0.9250
 Site-photo                     (4) | Train Loss: 0.1189 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1454 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1627 | Train Acc: 0.9659
 Site-photo                     (3) | Train Loss: 0.1649 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.1584 | Train Acc: 0.9726
 Site-art_painting              (4) | Train Loss: 0.4771 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5531 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4694 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3760 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.3439 | Train Acc: 0.9375
 Site-cartoon                   (5) | Train Loss: 0.5802 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.5591 | Train Acc: 0.8435
 Site-sketch                    (1) | Train Loss: 0.7694 | Train Acc: 0.7586
Average Train Accuracy: 0.9356
 Site-photo                     (3) | Val  Loss: 0.3641 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1292 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1056 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2697 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.1400 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2331 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.1896 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1785 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.1312 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1454 | Val  Acc: 0.9691
 Site-art_painting              (4) | Val  Loss: 0.1473 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3675 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4094 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3330 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.4170 | Val  Acc: 0.8353
 Site-cartoon                   (5) | Val  Loss: 0.7893 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6434 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 0.8440 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9235
============ Train epoch 33 ============
cnt=[9, 1, 1, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (5) | Train Loss: 0.1876 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1859 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.2035 | Train Acc: 0.9583
 Site-photo                     (5) | Train Loss: 0.1576 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2078 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1410 | Train Acc: 0.9808
 Site-photo                     (5) | Train Loss: 0.0986 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2157 | Train Acc: 0.9432
 Site-photo                     (5) | Train Loss: 0.1753 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.1526 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.4239 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.4791 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.5393 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 0.3429 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.3869 | Train Acc: 0.8984
 Site-cartoon                   (4) | Train Loss: 0.5496 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5093 | Train Acc: 0.8870
 Site-sketch                    (2) | Train Loss: 0.7344 | Train Acc: 0.7586
Average Train Accuracy: 0.9312
 Site-photo                     (5) | Val  Loss: 0.2284 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2742 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1004 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2467 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1221 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1917 | Val  Acc: 0.9714
 Site-photo                     (5) | Val  Loss: 0.2004 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1890 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.1611 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1464 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.1838 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2714 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4207 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3397 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.3755 | Val  Acc: 0.9294
 Site-cartoon                   (4) | Val  Loss: 0.6442 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.7198 | Val  Acc: 0.8571
 Site-sketch                    (2) | Val  Loss: 0.8560 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9338
============ Train epoch 34 ============
cnt=[3, 2, 1, 4, 4, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (4) | Train Loss: 0.1891 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2465 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.2155 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1415 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2009 | Train Acc: 0.9500
 Site-photo                     (4) | Train Loss: 0.1622 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2102 | Train Acc: 0.9853
 Site-photo                     (5) | Train Loss: 0.1758 | Train Acc: 0.9545
 Site-photo                     (5) | Train Loss: 0.1471 | Train Acc: 0.9823
 Site-photo                     (4) | Train Loss: 0.1325 | Train Acc: 0.9932
 Site-art_painting              (0) | Train Loss: 0.3963 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.5410 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.4145 | Train Acc: 0.9250
 Site-art_painting              (3) | Train Loss: 0.4584 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.3348 | Train Acc: 0.9297
 Site-cartoon                   (1) | Train Loss: 0.4295 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.4968 | Train Acc: 0.8870
 Site-sketch                    (2) | Train Loss: 0.7731 | Train Acc: 0.7586
Average Train Accuracy: 0.9441
 Site-photo                     (4) | Val  Loss: 0.3643 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.1818 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1294 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2273 | Val  Acc: 0.9524
 Site-photo                     (5) | Val  Loss: 0.1006 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2061 | Val  Acc: 0.9714
 Site-photo                     (5) | Val  Loss: 0.1580 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1520 | Val  Acc: 0.9828
 Site-photo                     (5) | Val  Loss: 0.1451 | Val  Acc: 0.9867
 Site-photo                     (4) | Val  Loss: 0.1498 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.2730 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.4843 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.3253 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.3077 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.3096 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.6664 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.6207 | Val  Acc: 0.8442
 Site-sketch                    (2) | Val  Loss: 0.7286 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9401
 Best site-photo                    (4)  | Epoch:34 | Val Acc: 0.8889
 Best site-photo                    (4)  | Epoch:34 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 0.9524
 Best site-photo                    (5)  | Epoch:34 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:34 | Val Acc: 0.9714
 Best site-photo                    (5)  | Epoch:34 | Val Acc: 0.9556
 Best site-photo                    (5)  | Epoch:34 | Val Acc: 0.9828
 Best site-photo                    (5)  | Epoch:34 | Val Acc: 0.9867
 Best site-photo                    (4)  | Epoch:34 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:34 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:34 | Val Acc: 0.8667
 Best site-art_painting             (3)  | Epoch:34 | Val Acc: 0.8846
 Best site-art_painting             (3)  | Epoch:34 | Val Acc: 0.9574
 Best site-art_painting             (3)  | Epoch:34 | Val Acc: 0.9294
 Best site-cartoon                  (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-cartoon                  (1)  | Epoch:34 | Val Acc: 0.8442
 Best site-sketch                   (2)  | Epoch:34 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 35 ============
cnt=[8, 2, 1, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (0) | Train Loss: 0.1833 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.3401 | Train Acc: 0.8889
 Site-photo                     (3) | Train Loss: 0.1807 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1132 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1746 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1207 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2382 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1659 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.1521 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1698 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.3997 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.5358 | Train Acc: 0.8182
 Site-art_painting              (4) | Train Loss: 0.5506 | Train Acc: 0.8250
 Site-art_painting              (4) | Train Loss: 0.4753 | Train Acc: 0.8889
 Site-art_painting              (4) | Train Loss: 0.3678 | Train Acc: 0.9297
 Site-cartoon                   (1) | Train Loss: 0.4889 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.4944 | Train Acc: 0.8870
 Site-sketch                    (2) | Train Loss: 0.7716 | Train Acc: 0.6897
Average Train Accuracy: 0.9194
 Site-photo                     (0) | Val  Loss: 0.2272 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.1946 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.1024 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2371 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1161 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2226 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1792 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1596 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1178 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1347 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.1721 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.4731 | Val  Acc: 0.8667
 Site-art_painting              (4) | Val  Loss: 0.2801 | Val  Acc: 0.9231
 Site-art_painting              (4) | Val  Loss: 0.3239 | Val  Acc: 0.9362
 Site-art_painting              (4) | Val  Loss: 0.3375 | Val  Acc: 0.9059
 Site-cartoon                   (1) | Val  Loss: 0.7854 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 0.6233 | Val  Acc: 0.8442
 Site-sketch                    (2) | Val  Loss: 0.8014 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9057
============ Train epoch 36 ============
cnt=[5, 1, 2, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (4) | Train Loss: 0.1583 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1462 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1726 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1273 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1929 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1722 | Train Acc: 0.9615
 Site-photo                     (4) | Train Loss: 0.0740 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1501 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.1705 | Train Acc: 0.9735
 Site-photo                     (5) | Train Loss: 0.1524 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3437 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.5056 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.4584 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.2986 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.3098 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.4638 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4528 | Train Acc: 0.9217
 Site-sketch                    (1) | Train Loss: 0.7112 | Train Acc: 0.7931
Average Train Accuracy: 0.9347
 Site-photo                     (4) | Val  Loss: 0.0985 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1808 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.1033 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2517 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0988 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2001 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.1748 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1452 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1083 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1456 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.2202 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.1864 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2408 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3436 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.3247 | Val  Acc: 0.9294
 Site-cartoon                   (2) | Val  Loss: 0.7113 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6470 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.6833 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9399
============ Train epoch 37 ============
cnt=[2, 1, 4, 1, 9, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (4) | Train Loss: 0.1519 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1697 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.1556 | Train Acc: 0.9583
 Site-photo                     (4) | Train Loss: 0.1047 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1855 | Train Acc: 0.9250
 Site-photo                     (4) | Train Loss: 0.1478 | Train Acc: 0.9808
 Site-photo                     (4) | Train Loss: 0.1285 | Train Acc: 0.9853
 Site-photo                     (4) | Train Loss: 0.1554 | Train Acc: 0.9432
 Site-photo                     (4) | Train Loss: 0.1806 | Train Acc: 0.9646
 Site-photo                     (4) | Train Loss: 0.1865 | Train Acc: 0.9863
 Site-art_painting              (1) | Train Loss: 0.3837 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.4078 | Train Acc: 0.9545
 Site-art_painting              (2) | Train Loss: 0.5026 | Train Acc: 0.8750
 Site-art_painting              (2) | Train Loss: 0.4527 | Train Acc: 0.8750
 Site-art_painting              (2) | Train Loss: 0.3682 | Train Acc: 0.8906
 Site-cartoon                   (0) | Train Loss: 0.3035 | Train Acc: 1.0000
 Site-cartoon                   (0) | Train Loss: 0.4868 | Train Acc: 0.8957
 Site-sketch                    (3) | Train Loss: 0.6189 | Train Acc: 0.8276
Average Train Accuracy: 0.9402
 Site-photo                     (4) | Val  Loss: 0.1165 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1110 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.0844 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1589 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1146 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1577 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.1907 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.1216 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.1136 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1126 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 0.1755 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.4963 | Val  Acc: 0.8000
 Site-art_painting              (2) | Val  Loss: 0.3497 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.2889 | Val  Acc: 0.9787
 Site-art_painting              (2) | Val  Loss: 0.3500 | Val  Acc: 0.9059
 Site-cartoon                   (0) | Val  Loss: 0.4977 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.5607 | Val  Acc: 0.9351
 Site-sketch                    (3) | Val  Loss: 0.7237 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9459
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 0.9524
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 0.9429
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 0.9655
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 0.9897
 Best site-art_painting             (1)  | Epoch:37 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:37 | Val Acc: 0.8000
 Best site-art_painting             (2)  | Epoch:37 | Val Acc: 0.9231
 Best site-art_painting             (2)  | Epoch:37 | Val Acc: 0.9787
 Best site-art_painting             (2)  | Epoch:37 | Val Acc: 0.9059
 Best site-cartoon                  (0)  | Epoch:37 | Val Acc: 0.8571
 Best site-cartoon                  (0)  | Epoch:37 | Val Acc: 0.9351
 Best site-sketch                   (3)  | Epoch:37 | Val Acc: 0.8205
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 38 ============
cnt=[4, 2, 1, 6, 1, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.1539 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1453 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2384 | Train Acc: 0.9167
 Site-photo                     (3) | Train Loss: 0.1024 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1829 | Train Acc: 0.9500
 Site-photo                     (5) | Train Loss: 0.1377 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.0976 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1501 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1298 | Train Acc: 0.9823
 Site-photo                     (5) | Train Loss: 0.1265 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.4647 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.4384 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.4107 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3719 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.3372 | Train Acc: 0.9297
 Site-cartoon                   (1) | Train Loss: 0.5979 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.4668 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.6491 | Train Acc: 0.7759
Average Train Accuracy: 0.9298
 Site-photo                     (3) | Val  Loss: 0.3183 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.2127 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.1063 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1943 | Val  Acc: 0.9524
 Site-photo                     (5) | Val  Loss: 0.1206 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1545 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1837 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1425 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.1152 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1466 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.2368 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.2132 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.1986 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2758 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.2944 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.7560 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.5827 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.6890 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9344
============ Train epoch 39 ============
cnt=[9, 2, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (0) | Train Loss: 0.1390 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1577 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.1929 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1222 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.1936 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.1192 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.0948 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1991 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.1161 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1704 | Train Acc: 0.9795
 Site-art_painting              (5) | Train Loss: 0.3214 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5947 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 0.4785 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.3531 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.2960 | Train Acc: 0.9453
 Site-cartoon                   (1) | Train Loss: 0.4639 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.4579 | Train Acc: 0.8870
 Site-sketch                    (2) | Train Loss: 0.6676 | Train Acc: 0.7931
Average Train Accuracy: 0.9233
 Site-photo                     (0) | Val  Loss: 0.1158 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3336 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.0789 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2329 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0859 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1841 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1612 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1299 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1046 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1357 | Val  Acc: 0.9691
 Site-art_painting              (5) | Val  Loss: 0.1613 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3006 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.3193 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.2836 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.2937 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.5980 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.5298 | Val  Acc: 0.8961
 Site-sketch                    (2) | Val  Loss: 0.6631 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9428
============ Train epoch 40 ============
cnt=[1, 1, 1, 10, 4, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (3) | Train Loss: 0.1391 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2261 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.1708 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.1040 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1621 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.1267 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.1154 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1244 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1536 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.1532 | Train Acc: 0.9658
 Site-art_painting              (4) | Train Loss: 0.3524 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.4396 | Train Acc: 0.9091
 Site-art_painting              (4) | Train Loss: 0.3978 | Train Acc: 0.9000
 Site-art_painting              (4) | Train Loss: 0.2464 | Train Acc: 0.9306
 Site-art_painting              (4) | Train Loss: 0.3029 | Train Acc: 0.9219
 Site-cartoon                   (2) | Train Loss: 0.3920 | Train Acc: 0.9091
 Site-cartoon                   (5) | Train Loss: 0.4018 | Train Acc: 0.9217
 Site-sketch                    (1) | Train Loss: 0.7076 | Train Acc: 0.7241
Average Train Accuracy: 0.9393
 Site-photo                     (3) | Val  Loss: 0.1755 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1109 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0824 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2210 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.1077 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1646 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1712 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1514 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.1054 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.1038 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.0919 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.5587 | Val  Acc: 0.8667
 Site-art_painting              (4) | Val  Loss: 0.4040 | Val  Acc: 0.8846
 Site-art_painting              (4) | Val  Loss: 0.3487 | Val  Acc: 0.9362
 Site-art_painting              (4) | Val  Loss: 0.2978 | Val  Acc: 0.8941
 Site-cartoon                   (2) | Val  Loss: 0.6827 | Val  Acc: 0.8571
 Site-cartoon                   (5) | Val  Loss: 0.5163 | Val  Acc: 0.8961
 Site-sketch                    (1) | Val  Loss: 0.6354 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9318
 Test site-photo                     (3)| Epoch:37 | Test Acc: 0.9896
 Test site-art_painting              (4)| Epoch:37 | Test Acc: 0.8794
 Test site-cartoon                   (2)| Epoch:37 | Test Acc: 0.8468
 Test site-sketch                    (1)| Epoch:37 | Test Acc: 0.7192
photo: 0.9896, art_painting: 0.8794, cartoon: 0.8468, sketch: 0.7192, 
Average Test Accuracy(group): 0.8587, Average Test Accuracy(individual): 0.9281,
domain std=0.0964, cluster std=0.0910, individual std=0.0769, 
Average Test Accuracy: 0.8587
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 41 ============
cnt=[6, 1, 2, 2, 4, 3, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (0) | Train Loss: 0.1477 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1167 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1913 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1069 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1440 | Train Acc: 0.9750
 Site-photo                     (4) | Train Loss: 0.0967 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2017 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1626 | Train Acc: 0.9659
 Site-photo                     (4) | Train Loss: 0.1139 | Train Acc: 0.9823
 Site-photo                     (4) | Train Loss: 0.1504 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.3757 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.4240 | Train Acc: 0.9091
 Site-art_painting              (5) | Train Loss: 0.4757 | Train Acc: 0.8750
 Site-art_painting              (5) | Train Loss: 0.3536 | Train Acc: 0.8889
 Site-art_painting              (5) | Train Loss: 0.2651 | Train Acc: 0.9531
 Site-cartoon                   (2) | Train Loss: 0.4158 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4153 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.5942 | Train Acc: 0.8103
Average Train Accuracy: 0.9382
 Site-photo                     (0) | Val  Loss: 0.1637 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.2857 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0649 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1601 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1017 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1597 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1550 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1378 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.1174 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1338 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.3967 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.2260 | Val  Acc: 0.9333
 Site-art_painting              (5) | Val  Loss: 0.2347 | Val  Acc: 0.9615
 Site-art_painting              (5) | Val  Loss: 0.2299 | Val  Acc: 0.9787
 Site-art_painting              (5) | Val  Loss: 0.3142 | Val  Acc: 0.8941
 Site-cartoon                   (2) | Val  Loss: 0.5434 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5377 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.5983 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9437
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.8794
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8404
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.7287
photo: 0.9896, art_painting: 0.8794, cartoon: 0.8404, sketch: 0.7287, 
Average Test Accuracy(group): 0.8595, Average Test Accuracy(individual): 0.9279,
domain std=0.0932, cluster std=0.0898, individual std=0.0763, 
Average Test Accuracy: 0.8595
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 42 ============
cnt=[4, 1, 2, 1, 4, 6, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (3) | Train Loss: 0.1015 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1655 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1501 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.0976 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2069 | Train Acc: 0.9000
 Site-photo                     (5) | Train Loss: 0.1046 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.0869 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1476 | Train Acc: 0.9659
 Site-photo                     (5) | Train Loss: 0.1455 | Train Acc: 0.9735
 Site-photo                     (5) | Train Loss: 0.1178 | Train Acc: 0.9863
 Site-art_painting              (4) | Train Loss: 0.3741 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.4238 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.4540 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.3300 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.2525 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.3132 | Train Acc: 1.0000
 Site-cartoon                   (2) | Train Loss: 0.4309 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.5784 | Train Acc: 0.8448
Average Train Accuracy: 0.9487
 Site-photo                     (3) | Val  Loss: 0.2840 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.1568 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.0699 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1783 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.0832 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1499 | Val  Acc: 0.9714
 Site-photo                     (4) | Val  Loss: 0.1788 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1408 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.0940 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1291 | Val  Acc: 0.9794
 Site-art_painting              (4) | Val  Loss: 0.1595 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3938 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.1978 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2369 | Val  Acc: 0.9787
 Site-art_painting              (0) | Val  Loss: 0.2832 | Val  Acc: 0.9529
 Site-cartoon                   (2) | Val  Loss: 0.5411 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5490 | Val  Acc: 0.9091
 Site-sketch                    (1) | Val  Loss: 0.6756 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9555
 Best site-photo                    (3)  | Epoch:42 | Val Acc: 0.8889
 Best site-photo                    (5)  | Epoch:42 | Val Acc: 0.9167
 Best site-photo                    (4)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:42 | Val Acc: 0.9524
 Best site-photo                    (4)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:42 | Val Acc: 0.9714
 Best site-photo                    (4)  | Epoch:42 | Val Acc: 0.9556
 Best site-photo                    (5)  | Epoch:42 | Val Acc: 0.9655
 Best site-photo                    (5)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:42 | Val Acc: 0.9794
 Best site-art_painting             (4)  | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:42 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:42 | Val Acc: 0.9787
 Best site-art_painting             (0)  | Epoch:42 | Val Acc: 0.9529
 Best site-cartoon                  (2)  | Epoch:42 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:42 | Val Acc: 0.9091
 Best site-sketch                   (1)  | Epoch:42 | Val Acc: 0.7949
 Test site-photo                     (3)| Epoch:42 | Test Acc: 0.9896
 Test site-art_painting              (4)| Epoch:42 | Test Acc: 0.8782
 Test site-cartoon                   (2)| Epoch:42 | Test Acc: 0.8394
 Test site-sketch                    (1)| Epoch:42 | Test Acc: 0.7338
photo: 0.9896, art_painting: 0.8782, cartoon: 0.8394, sketch: 0.7338, 
Average Test Accuracy(group): 0.8602, Average Test Accuracy(individual): 0.9277,
domain std=0.0915, cluster std=0.0927, individual std=0.0759, 
Average Test Accuracy: 0.8602
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 43 ============
cnt=[3, 2, 1, 9, 1, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (3) | Train Loss: 0.0933 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1830 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.1544 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.0957 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1444 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.1029 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1145 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1375 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1214 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1659 | Train Acc: 0.9726
 Site-art_painting              (5) | Train Loss: 0.4263 | Train Acc: 0.9167
 Site-art_painting              (5) | Train Loss: 0.6094 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.3958 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3223 | Train Acc: 0.9583
 Site-art_painting              (0) | Train Loss: 0.2879 | Train Acc: 0.9375
 Site-cartoon                   (1) | Train Loss: 0.4040 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.3777 | Train Acc: 0.9391
 Site-sketch                    (2) | Train Loss: 0.5802 | Train Acc: 0.8448
Average Train Accuracy: 0.9451
 Site-photo                     (3) | Val  Loss: 0.2433 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.0974 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.0743 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2383 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0768 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1662 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1733 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1423 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 0.1013 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1290 | Val  Acc: 0.9691
 Site-art_painting              (5) | Val  Loss: 0.0909 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.2688 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.2363 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.2923 | Val  Acc: 0.9574
 Site-art_painting              (0) | Val  Loss: 0.2783 | Val  Acc: 0.9647
 Site-cartoon                   (1) | Val  Loss: 0.7653 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.4812 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.6420 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9506
 Test site-photo                     (3)| Epoch:42 | Test Acc: 0.9881
 Test site-art_painting              (5)| Epoch:42 | Test Acc: 0.8733
 Test site-cartoon                   (1)| Epoch:42 | Test Acc: 0.8500
 Test site-sketch                    (2)| Epoch:42 | Test Acc: 0.7351
photo: 0.9881, art_painting: 0.8733, cartoon: 0.8500, sketch: 0.7351, 
Average Test Accuracy(group): 0.8616, Average Test Accuracy(individual): 0.9268,
domain std=0.0898, cluster std=0.0868, individual std=0.0747, 
Average Test Accuracy: 0.8616
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 44 ============
cnt=[3, 1, 1, 9, 1, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (3) | Train Loss: 0.1126 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1635 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.2011 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.0850 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1758 | Train Acc: 0.9500
 Site-photo                     (3) | Train Loss: 0.1033 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1919 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1407 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1101 | Train Acc: 0.9823
 Site-photo                     (5) | Train Loss: 0.1145 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.3386 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.3450 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4955 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.3390 | Train Acc: 0.9028
 Site-art_painting              (5) | Train Loss: 0.2401 | Train Acc: 0.9688
 Site-cartoon                   (4) | Train Loss: 0.3612 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.3935 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.5273 | Train Acc: 0.8621
Average Train Accuracy: 0.9465
 Site-photo                     (3) | Val  Loss: 0.1981 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.1837 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.0616 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1313 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0919 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1818 | Val  Acc: 0.9429
 Site-photo                     (3) | Val  Loss: 0.1683 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1160 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.0915 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1066 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.0787 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.1868 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.2192 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.2106 | Val  Acc: 0.9787
 Site-art_painting              (5) | Val  Loss: 0.3110 | Val  Acc: 0.9529
 Site-cartoon                   (4) | Val  Loss: 0.8912 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.4368 | Val  Acc: 0.8961
 Site-sketch                    (2) | Val  Loss: 0.5620 | Val  Acc: 0.8462
Average Valid Accuracy: 0.9444
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9881
 Test site-art_painting              (0)| Epoch:43 | Test Acc: 0.8794
 Test site-cartoon                   (4)| Epoch:43 | Test Acc: 0.8457
 Test site-sketch                    (2)| Epoch:43 | Test Acc: 0.7376
photo: 0.9881, art_painting: 0.8794, cartoon: 0.8457, sketch: 0.7376, 
Average Test Accuracy(group): 0.8627, Average Test Accuracy(individual): 0.9282,
domain std=0.0893, cluster std=0.0782, individual std=0.0737, 
Average Test Accuracy: 0.8627
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 45 ============
cnt=[8, 2, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (0) | Train Loss: 0.0925 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1807 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1655 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.0795 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1817 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.0834 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0868 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1804 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.1192 | Train Acc: 0.9823
 Site-photo                     (5) | Train Loss: 0.1566 | Train Acc: 0.9726
 Site-art_painting              (4) | Train Loss: 0.3327 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.3961 | Train Acc: 0.8636
 Site-art_painting              (4) | Train Loss: 0.3555 | Train Acc: 0.9500
 Site-art_painting              (3) | Train Loss: 0.2140 | Train Acc: 0.9444
 Site-art_painting              (3) | Train Loss: 0.2821 | Train Acc: 0.9453
 Site-cartoon                   (1) | Train Loss: 0.3020 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.3773 | Train Acc: 0.9391
 Site-sketch                    (2) | Train Loss: 0.6160 | Train Acc: 0.7759
Average Train Accuracy: 0.9438
 Site-photo                     (0) | Val  Loss: 0.3056 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.1304 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0583 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2353 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0949 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1778 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1448 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1399 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0910 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1474 | Val  Acc: 0.9485
 Site-art_painting              (4) | Val  Loss: 0.1126 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.3259 | Val  Acc: 0.8667
 Site-art_painting              (4) | Val  Loss: 0.1879 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.2379 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.2695 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.5493 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.5402 | Val  Acc: 0.8961
 Site-sketch                    (2) | Val  Loss: 0.6176 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9330
 Test site-photo                     (0)| Epoch:44 | Test Acc: 0.9881
 Test site-art_painting              (4)| Epoch:44 | Test Acc: 0.8782
 Test site-cartoon                   (1)| Epoch:44 | Test Acc: 0.8372
 Test site-sketch                    (2)| Epoch:44 | Test Acc: 0.7408
photo: 0.9881, art_painting: 0.8782, cartoon: 0.8372, sketch: 0.7408, 
Average Test Accuracy(group): 0.8611, Average Test Accuracy(individual): 0.9270,
domain std=0.0887, cluster std=0.0860, individual std=0.0745, 
Average Test Accuracy: 0.8611
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 1, 1, 11, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (3) | Train Loss: 0.1207 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2126 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.1478 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.0871 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1679 | Train Acc: 0.9500
 Site-photo                     (3) | Train Loss: 0.0772 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1047 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1300 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1142 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.1086 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.4272 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.2835 | Train Acc: 0.9545
 Site-art_painting              (4) | Train Loss: 0.4228 | Train Acc: 0.8750
 Site-art_painting              (4) | Train Loss: 0.2749 | Train Acc: 0.9583
 Site-art_painting              (4) | Train Loss: 0.2716 | Train Acc: 0.9531
 Site-cartoon                   (2) | Train Loss: 0.3991 | Train Acc: 0.8182
 Site-cartoon                   (5) | Train Loss: 0.3700 | Train Acc: 0.9217
 Site-sketch                    (1) | Train Loss: 0.5799 | Train Acc: 0.8276
Average Train Accuracy: 0.9363
 Site-photo                     (3) | Val  Loss: 0.3137 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.2011 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0583 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1247 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0894 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1246 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1560 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1305 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.0807 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1028 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.1799 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.3302 | Val  Acc: 0.9333
 Site-art_painting              (4) | Val  Loss: 0.3751 | Val  Acc: 0.9231
 Site-art_painting              (4) | Val  Loss: 0.3017 | Val  Acc: 0.9574
 Site-art_painting              (4) | Val  Loss: 0.2078 | Val  Acc: 0.9529
 Site-cartoon                   (2) | Val  Loss: 0.6889 | Val  Acc: 0.8571
 Site-cartoon                   (5) | Val  Loss: 0.4817 | Val  Acc: 0.9351
 Site-sketch                    (1) | Val  Loss: 0.7242 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9376
 Test site-photo                     (3)| Epoch:45 | Test Acc: 0.9881
 Test site-art_painting              (3)| Epoch:45 | Test Acc: 0.8819
 Test site-cartoon                   (2)| Epoch:45 | Test Acc: 0.8426
 Test site-sketch                    (1)| Epoch:45 | Test Acc: 0.7433
photo: 0.9881, art_painting: 0.8819, cartoon: 0.8426, sketch: 0.7433, 
Average Test Accuracy(group): 0.8639, Average Test Accuracy(individual): 0.9288,
domain std=0.0877, cluster std=0.0827, individual std=0.0728, 
Average Test Accuracy: 0.8639
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 47 ============
cnt=[6, 2, 1, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (3) | Train Loss: 0.0858 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2594 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.1546 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0740 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1414 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1011 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.0762 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1430 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.0954 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1000 | Train Acc: 0.9795
 Site-art_painting              (4) | Train Loss: 0.3929 | Train Acc: 0.8333
 Site-art_painting              (5) | Train Loss: 0.5749 | Train Acc: 0.8182
 Site-art_painting              (4) | Train Loss: 0.4090 | Train Acc: 0.9250
 Site-art_painting              (4) | Train Loss: 0.3521 | Train Acc: 0.9583
 Site-art_painting              (4) | Train Loss: 0.2249 | Train Acc: 0.9688
 Site-cartoon                   (1) | Train Loss: 0.4865 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.3970 | Train Acc: 0.9217
 Site-sketch                    (2) | Train Loss: 0.5570 | Train Acc: 0.8103
Average Train Accuracy: 0.9312
 Site-photo                     (3) | Val  Loss: 0.1089 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1017 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0906 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0960 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0859 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1213 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1451 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1350 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0754 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0977 | Val  Acc: 0.9794
 Site-art_painting              (4) | Val  Loss: 0.2215 | Val  Acc: 0.8750
 Site-art_painting              (5) | Val  Loss: 0.3527 | Val  Acc: 0.8667
 Site-art_painting              (4) | Val  Loss: 0.1831 | Val  Acc: 0.9615
 Site-art_painting              (4) | Val  Loss: 0.2109 | Val  Acc: 0.9574
 Site-art_painting              (4) | Val  Loss: 0.2420 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.5495 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.4603 | Val  Acc: 0.9351
 Site-sketch                    (2) | Val  Loss: 0.5951 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9452
 Test site-photo                     (3)| Epoch:46 | Test Acc: 0.9881
 Test site-art_painting              (4)| Epoch:46 | Test Acc: 0.8867
 Test site-cartoon                   (1)| Epoch:46 | Test Acc: 0.8479
 Test site-sketch                    (2)| Epoch:46 | Test Acc: 0.7459
photo: 0.9881, art_painting: 0.8867, cartoon: 0.8479, sketch: 0.7459, 
Average Test Accuracy(group): 0.8671, Average Test Accuracy(individual): 0.9309,
domain std=0.0867, cluster std=0.0835, individual std=0.0709, 
Average Test Accuracy: 0.8671
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 48 ============
cnt=[8, 2, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (0) | Train Loss: 0.0903 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1470 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1390 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0762 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1610 | Train Acc: 0.9250
 Site-photo                     (5) | Train Loss: 0.1170 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1076 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1245 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.1135 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1224 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3200 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.3253 | Train Acc: 0.9545
 Site-art_painting              (3) | Train Loss: 0.4484 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.2399 | Train Acc: 0.9444
 Site-art_painting              (3) | Train Loss: 0.2430 | Train Acc: 0.9531
 Site-cartoon                   (1) | Train Loss: 0.3267 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.3783 | Train Acc: 0.8783
 Site-sketch                    (2) | Train Loss: 0.5621 | Train Acc: 0.8103
Average Train Accuracy: 0.9449
 Site-photo                     (0) | Val  Loss: 0.2364 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.2849 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0711 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1227 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0865 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1500 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1481 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1336 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0732 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1036 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.0998 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.1581 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.3397 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.2042 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.2462 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.4562 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.5253 | Val  Acc: 0.9091
 Site-sketch                    (2) | Val  Loss: 0.6182 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9523
 Test site-photo                     (0)| Epoch:47 | Test Acc: 0.9881
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.8904
 Test site-cartoon                   (1)| Epoch:47 | Test Acc: 0.8447
 Test site-sketch                    (2)| Epoch:47 | Test Acc: 0.7427
photo: 0.9881, art_painting: 0.8904, cartoon: 0.8447, sketch: 0.7427, 
Average Test Accuracy(group): 0.8665, Average Test Accuracy(individual): 0.9314,
domain std=0.0882, cluster std=0.0846, individual std=0.0712, 
Average Test Accuracy: 0.8665
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
============ Train epoch 49 ============
cnt=[1, 1, 2, 2, 4, 8, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (5) | Train Loss: 0.1074 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1542 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1413 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.0973 | Train Acc: 0.9677
 Site-photo                     (2) | Train Loss: 0.1384 | Train Acc: 0.9750
 Site-photo                     (5) | Train Loss: 0.1133 | Train Acc: 0.9808
 Site-photo                     (5) | Train Loss: 0.0502 | Train Acc: 0.9853
 Site-photo                     (5) | Train Loss: 0.1267 | Train Acc: 0.9659
 Site-photo                     (5) | Train Loss: 0.1002 | Train Acc: 0.9823
 Site-photo                     (5) | Train Loss: 0.0961 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.2992 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.3797 | Train Acc: 0.8636
 Site-art_painting              (4) | Train Loss: 0.3540 | Train Acc: 0.9250
 Site-art_painting              (4) | Train Loss: 0.4596 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.2300 | Train Acc: 0.9688
 Site-cartoon                   (3) | Train Loss: 0.2898 | Train Acc: 1.0000
 Site-cartoon                   (3) | Train Loss: 0.3534 | Train Acc: 0.9217
 Site-sketch                    (1) | Train Loss: 0.5243 | Train Acc: 0.8276
Average Train Accuracy: 0.9512
 Site-photo                     (5) | Val  Loss: 0.1369 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.0910 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0724 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1311 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.0933 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1322 | Val  Acc: 0.9714
 Site-photo                     (5) | Val  Loss: 0.1799 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1320 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.0876 | Val  Acc: 0.9867
 Site-photo                     (5) | Val  Loss: 0.1117 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.1918 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.0939 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.3139 | Val  Acc: 0.9615
 Site-art_painting              (4) | Val  Loss: 0.2598 | Val  Acc: 0.9574
 Site-art_painting              (4) | Val  Loss: 0.2471 | Val  Acc: 0.9176
 Site-cartoon                   (3) | Val  Loss: 0.3545 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 0.4482 | Val  Acc: 0.9221
 Site-sketch                    (1) | Val  Loss: 0.6138 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9557
 Best site-photo                    (5)  | Epoch:49 | Val Acc: 0.8889
 Best site-photo                    (5)  | Epoch:49 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:49 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:49 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:49 | Val Acc: 0.9714
 Best site-photo                    (5)  | Epoch:49 | Val Acc: 0.9556
 Best site-photo                    (5)  | Epoch:49 | Val Acc: 0.9655
 Best site-photo                    (5)  | Epoch:49 | Val Acc: 0.9867
 Best site-photo                    (5)  | Epoch:49 | Val Acc: 0.9794
 Best site-art_painting             (2)  | Epoch:49 | Val Acc: 1.0000
 Best site-art_painting             (4)  | Epoch:49 | Val Acc: 1.0000
 Best site-art_painting             (4)  | Epoch:49 | Val Acc: 0.9615
 Best site-art_painting             (4)  | Epoch:49 | Val Acc: 0.9574
 Best site-art_painting             (4)  | Epoch:49 | Val Acc: 0.9176
 Best site-cartoon                  (3)  | Epoch:49 | Val Acc: 1.0000
 Best site-cartoon                  (3)  | Epoch:49 | Val Acc: 0.9221
 Best site-sketch                   (1)  | Epoch:49 | Val Acc: 0.7436
 Test site-photo                     (5)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:49 | Test Acc: 0.8904
 Test site-cartoon                   (3)| Epoch:49 | Test Acc: 0.8447
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.7363
photo: 0.9896, art_painting: 0.8904, cartoon: 0.8447, sketch: 0.7363, 
Average Test Accuracy(group): 0.8652, Average Test Accuracy(individual): 0.9318,
domain std=0.0910, cluster std=0.0890, individual std=0.0728, 
Average Test Accuracy: 0.8652
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_6/ccop_q=1...
===2023-08-10 19:49:54===
===2023-08-10 19:50:10===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 6
Loading snapshots...
 Test site-photo                     (5)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:49 | Test Acc: 0.8904
 Test site-cartoon                   (3)| Epoch:49 | Test Acc: 0.8447
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.7363
photo: 0.9896, art_painting: 0.8904, cartoon: 0.8447, sketch: 0.7363, 
Average Test Accuracy(group): 0.8652, Average Test Accuracy(individual): 0.9318,
domain std=0.0910, cluster std=0.0890, individual std=0.0728, 
