===2023-05-11 09:33:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.7449 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.7091 | Train Acc: 0.5833
 Site-MNIST     | Train Loss: 1.4843 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.6363 | Train Acc: 0.5789
 Site-MNIST     | Train Loss: 1.4431 | Train Acc: 0.7429
 Site-MNIST     | Train Loss: 1.5621 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 1.5608 | Train Acc: 0.7445
 Site-MNIST     | Train Loss: 1.6444 | Train Acc: 0.6577
 Site-MNIST     | Train Loss: 1.6106 | Train Acc: 0.6603
 Site-MNIST     | Train Loss: 1.5932 | Train Acc: 0.6875
 Site-USPS      | Train Loss: 1.6435 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 1.7610 | Train Acc: 0.6528
 Site-USPS      | Train Loss: 1.5977 | Train Acc: 0.7287
 Site-USPS      | Train Loss: 1.6670 | Train Acc: 0.6824
 Site-USPS      | Train Loss: 1.6888 | Train Acc: 0.7167
 Site-USPS      | Train Loss: 1.6852 | Train Acc: 0.6839
 Site-SynthDigits| Train Loss: 2.1130 | Train Acc: 0.2583
 Site-SynthDigits| Train Loss: 2.1386 | Train Acc: 0.2125
 Site-SynthDigits| Train Loss: 2.0873 | Train Acc: 0.2749
 Site-MNIST-M   | Train Loss: 2.2197 | Train Acc: 0.1989
 Site-MNIST-M   | Train Loss: 2.1904 | Train Acc: 0.2049
 Site-SVHN      | Train Loss: 2.2454 | Train Acc: 0.1773
 Site-MNIST     | Val  Loss: 1.9107 | Val  Acc: 0.0000
 Site-MNIST     | Val  Loss: 1.7228 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.5190 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.6234 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.6042 | Val  Acc: 0.6471
 Site-MNIST     | Val  Loss: 1.6303 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.5636 | Val  Acc: 0.7321
 Site-MNIST     | Val  Loss: 1.5616 | Val  Acc: 0.7549
 Site-MNIST     | Val  Loss: 1.5994 | Val  Acc: 0.6995
 Site-MNIST     | Val  Loss: 1.5642 | Val  Acc: 0.6798
 Site-USPS      | Val  Loss: 1.6243 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 1.7943 | Val  Acc: 0.6111
 Site-USPS      | Val  Loss: 1.7561 | Val  Acc: 0.6250
 Site-USPS      | Val  Loss: 1.7340 | Val  Acc: 0.6034
 Site-USPS      | Val  Loss: 1.6650 | Val  Acc: 0.7238
 Site-USPS      | Val  Loss: 1.6394 | Val  Acc: 0.7302
 Site-SynthDigits| Val  Loss: 2.1158 | Val  Acc: 0.2432
 Site-SynthDigits| Val  Loss: 2.0667 | Val  Acc: 0.2647
 Site-SynthDigits| Val  Loss: 2.1329 | Val  Acc: 0.2541
 Site-MNIST-M   | Val  Loss: 2.2269 | Val  Acc: 0.2000
 Site-MNIST-M   | Val  Loss: 2.1988 | Val  Acc: 0.1728
 Site-SVHN      | Val  Loss: 2.1511 | Val  Acc: 0.1000
Average Valid Accuracy: 0.5236
Aggregated Acc | Val Acc: 0.3697
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6471
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6452
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7321
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7549
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6995
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6798
 Best site-USPS       | Epoch:0 | Val Acc: 0.9000
 Best site-USPS       | Epoch:0 | Val Acc: 0.6111
 Best site-USPS       | Epoch:0 | Val Acc: 0.6250
 Best site-USPS       | Epoch:0 | Val Acc: 0.6034
 Best site-USPS       | Epoch:0 | Val Acc: 0.7238
 Best site-USPS       | Epoch:0 | Val Acc: 0.7302
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2432
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2647
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2541
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1728
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.3009 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.2110 | Train Acc: 0.5833
 Site-MNIST     | Train Loss: 0.9449 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 1.0598 | Train Acc: 0.7895
 Site-MNIST     | Train Loss: 1.0697 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 1.0287 | Train Acc: 0.8968
 Site-MNIST     | Train Loss: 1.0180 | Train Acc: 0.8458
 Site-MNIST     | Train Loss: 1.1619 | Train Acc: 0.7873
 Site-MNIST     | Train Loss: 1.1004 | Train Acc: 0.7840
 Site-MNIST     | Train Loss: 1.0592 | Train Acc: 0.8008
 Site-USPS      | Train Loss: 1.1168 | Train Acc: 0.8000
 Site-USPS      | Train Loss: 1.2102 | Train Acc: 0.7917
 Site-USPS      | Train Loss: 0.9748 | Train Acc: 0.7907
 Site-USPS      | Train Loss: 1.1712 | Train Acc: 0.7682
 Site-USPS      | Train Loss: 1.1606 | Train Acc: 0.7976
 Site-USPS      | Train Loss: 1.1771 | Train Acc: 0.7738
 Site-SynthDigits| Train Loss: 1.9061 | Train Acc: 0.3642
 Site-SynthDigits| Train Loss: 1.9706 | Train Acc: 0.2784
 Site-SynthDigits| Train Loss: 1.8892 | Train Acc: 0.3299
 Site-MNIST-M   | Train Loss: 2.0906 | Train Acc: 0.2762
 Site-MNIST-M   | Train Loss: 2.0922 | Train Acc: 0.2905
 Site-SVHN      | Train Loss: 2.1725 | Train Acc: 0.2092
 Site-MNIST     | Val  Loss: 1.0591 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.0671 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.9306 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.1550 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 1.0979 | Val  Acc: 0.7647
 Site-MNIST     | Val  Loss: 1.1113 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.0165 | Val  Acc: 0.8750
 Site-MNIST     | Val  Loss: 1.0348 | Val  Acc: 0.8529
 Site-MNIST     | Val  Loss: 1.1019 | Val  Acc: 0.8197
 Site-MNIST     | Val  Loss: 1.0633 | Val  Acc: 0.7976
 Site-USPS      | Val  Loss: 1.0167 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 1.4002 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 1.3251 | Val  Acc: 0.6875
 Site-USPS      | Val  Loss: 1.3010 | Val  Acc: 0.6897
 Site-USPS      | Val  Loss: 1.1837 | Val  Acc: 0.7429
 Site-USPS      | Val  Loss: 1.1411 | Val  Acc: 0.7937
 Site-SynthDigits| Val  Loss: 2.0031 | Val  Acc: 0.2973
 Site-SynthDigits| Val  Loss: 1.9358 | Val  Acc: 0.3088
 Site-SynthDigits| Val  Loss: 1.9446 | Val  Acc: 0.2951
 Site-MNIST-M   | Val  Loss: 2.1355 | Val  Acc: 0.2444
 Site-MNIST-M   | Val  Loss: 2.0601 | Val  Acc: 0.3086
 Site-SVHN      | Val  Loss: 1.9015 | Val  Acc: 0.2429
Average Valid Accuracy: 0.6603
Aggregated Acc | Val Acc: 0.4824
 Best site-MNIST      | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7647
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8750
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8529
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8197
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7976
 Best site-USPS       | Epoch:1 | Val Acc: 1.0000
 Best site-USPS       | Epoch:1 | Val Acc: 0.7222
 Best site-USPS       | Epoch:1 | Val Acc: 0.6875
 Best site-USPS       | Epoch:1 | Val Acc: 0.6897
 Best site-USPS       | Epoch:1 | Val Acc: 0.7429
 Best site-USPS       | Epoch:1 | Val Acc: 0.7937
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2973
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3088
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2951
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2444
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3086
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.0385 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.0111 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 0.7427 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.8690 | Train Acc: 0.7895
 Site-MNIST     | Train Loss: 0.9132 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.8560 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.8357 | Train Acc: 0.8546
 Site-MNIST     | Train Loss: 0.9569 | Train Acc: 0.7971
 Site-MNIST     | Train Loss: 0.9129 | Train Acc: 0.8152
 Site-MNIST     | Train Loss: 0.8731 | Train Acc: 0.8325
 Site-USPS      | Train Loss: 0.8745 | Train Acc: 0.8000
 Site-USPS      | Train Loss: 0.8627 | Train Acc: 0.8056
 Site-USPS      | Train Loss: 1.0871 | Train Acc: 0.8217
 Site-USPS      | Train Loss: 0.9645 | Train Acc: 0.7940
 Site-USPS      | Train Loss: 0.9603 | Train Acc: 0.7857
 Site-USPS      | Train Loss: 0.9609 | Train Acc: 0.7910
 Site-SynthDigits| Train Loss: 1.6820 | Train Acc: 0.4437
 Site-SynthDigits| Train Loss: 1.7764 | Train Acc: 0.3480
 Site-SynthDigits| Train Loss: 1.6936 | Train Acc: 0.4379
 Site-MNIST-M   | Train Loss: 1.9576 | Train Acc: 0.3260
 Site-MNIST-M   | Train Loss: 1.8670 | Train Acc: 0.4098
 Site-SVHN      | Train Loss: 2.0630 | Train Acc: 0.2518
 Site-MNIST     | Val  Loss: 0.7732 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.7959 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.7069 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.9162 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.8881 | Val  Acc: 0.8235
 Site-MNIST     | Val  Loss: 0.9403 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.8313 | Val  Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.8489 | Val  Acc: 0.8431
 Site-MNIST     | Val  Loss: 0.9269 | Val  Acc: 0.8142
 Site-MNIST     | Val  Loss: 0.8866 | Val  Acc: 0.8127
 Site-USPS      | Val  Loss: 0.7342 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 1.1609 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 1.1233 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 1.1215 | Val  Acc: 0.7069
 Site-USPS      | Val  Loss: 0.9780 | Val  Acc: 0.8000
 Site-USPS      | Val  Loss: 0.9275 | Val  Acc: 0.8148
 Site-SynthDigits| Val  Loss: 1.8105 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 1.7720 | Val  Acc: 0.4265
 Site-SynthDigits| Val  Loss: 1.7606 | Val  Acc: 0.3934
 Site-MNIST-M   | Val  Loss: 2.0200 | Val  Acc: 0.2667
 Site-MNIST-M   | Val  Loss: 1.9330 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 1.8998 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7014
Aggregated Acc | Val Acc: 0.5275
 Best site-MNIST      | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8235
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8750
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8431
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8142
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8127
 Best site-USPS       | Epoch:2 | Val Acc: 1.0000
 Best site-USPS       | Epoch:2 | Val Acc: 0.7222
 Best site-USPS       | Epoch:2 | Val Acc: 0.7188
 Best site-USPS       | Epoch:2 | Val Acc: 0.7069
 Best site-USPS       | Epoch:2 | Val Acc: 0.8000
 Best site-USPS       | Epoch:2 | Val Acc: 0.8148
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4265
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3934
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2667
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-1
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-4
client-20 is in G-4
client-21 is in G-4
cnt=[6, 1, 3, 9, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.9218 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.9219 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.6779 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.7550 | Train Acc: 0.8158
 Site-MNIST     | Train Loss: 0.7480 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 0.7862 | Train Acc: 0.8492
 Site-MNIST     | Train Loss: 0.7120 | Train Acc: 0.8590
 Site-MNIST     | Train Loss: 0.8632 | Train Acc: 0.8044
 Site-MNIST     | Train Loss: 0.8015 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.7827 | Train Acc: 0.8287
 Site-USPS      | Train Loss: 0.7232 | Train Acc: 0.8250
 Site-USPS      | Train Loss: 0.7117 | Train Acc: 0.8194
 Site-USPS      | Train Loss: 0.9073 | Train Acc: 0.8527
 Site-USPS      | Train Loss: 0.8332 | Train Acc: 0.8069
 Site-USPS      | Train Loss: 0.8353 | Train Acc: 0.8095
 Site-USPS      | Train Loss: 0.8325 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.6040 | Train Acc: 0.4901
 Site-SynthDigits| Train Loss: 1.6146 | Train Acc: 0.4322
 Site-SynthDigits| Train Loss: 1.5416 | Train Acc: 0.4888
 Site-MNIST-M   | Train Loss: 1.8640 | Train Acc: 0.3702
 Site-MNIST-M   | Train Loss: 1.7735 | Train Acc: 0.4434
 Site-SVHN      | Train Loss: 2.0084 | Train Acc: 0.2943
 Site-MNIST     | Val  Loss: 0.5777 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5845 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5763 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.7622 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.7828 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.8532 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7449 | Val  Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.7559 | Val  Acc: 0.8431
 Site-MNIST     | Val  Loss: 0.8353 | Val  Acc: 0.8142
 Site-MNIST     | Val  Loss: 0.8016 | Val  Acc: 0.8278
 Site-USPS      | Val  Loss: 0.5927 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 1.0242 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 0.9950 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 1.0186 | Val  Acc: 0.7241
 Site-USPS      | Val  Loss: 0.8638 | Val  Acc: 0.8095
 Site-USPS      | Val  Loss: 0.8017 | Val  Acc: 0.8413
 Site-SynthDigits| Val  Loss: 1.6595 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 1.5877 | Val  Acc: 0.4853
 Site-SynthDigits| Val  Loss: 1.6043 | Val  Acc: 0.4836
 Site-MNIST-M   | Val  Loss: 1.9112 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 1.8334 | Val  Acc: 0.4198
 Site-SVHN      | Val  Loss: 1.8718 | Val  Acc: 0.2714
Average Valid Accuracy: 0.7401
Aggregated Acc | Val Acc: 0.6998
 Best site-MNIST      | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8750
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8431
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8142
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8278
 Best site-USPS       | Epoch:3 | Val Acc: 0.9000
 Best site-USPS       | Epoch:3 | Val Acc: 0.7222
 Best site-USPS       | Epoch:3 | Val Acc: 0.7188
 Best site-USPS       | Epoch:3 | Val Acc: 0.7241
 Best site-USPS       | Epoch:3 | Val Acc: 0.8095
 Best site-USPS       | Epoch:3 | Val Acc: 0.8413
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4853
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4836
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4198
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8363 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.7934 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.5717 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.6235 | Train Acc: 0.8684
 Site-MNIST     | Train Loss: 0.7794 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 0.6769 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.6294 | Train Acc: 0.8722
 Site-MNIST     | Train Loss: 0.7306 | Train Acc: 0.8313
 Site-MNIST     | Train Loss: 0.6944 | Train Acc: 0.8505
 Site-MNIST     | Train Loss: 0.6755 | Train Acc: 0.8551
 Site-USPS      | Train Loss: 0.6257 | Train Acc: 0.8250
 Site-USPS      | Train Loss: 0.7841 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7295 | Train Acc: 0.8682
 Site-USPS      | Train Loss: 0.7491 | Train Acc: 0.8369
 Site-USPS      | Train Loss: 0.7270 | Train Acc: 0.8310
 Site-USPS      | Train Loss: 0.7276 | Train Acc: 0.8347
 Site-SynthDigits| Train Loss: 1.4675 | Train Acc: 0.5298
 Site-SynthDigits| Train Loss: 1.5175 | Train Acc: 0.4725
 Site-SynthDigits| Train Loss: 1.4357 | Train Acc: 0.5356
 Site-MNIST-M   | Train Loss: 1.7919 | Train Acc: 0.3757
 Site-MNIST-M   | Train Loss: 1.7201 | Train Acc: 0.4740
 Site-SVHN      | Train Loss: 1.9498 | Train Acc: 0.3298
 Site-MNIST     | Val  Loss: 0.4289 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4111 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4803 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6675 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6827 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.7374 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.6360 | Val  Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.6440 | Val  Acc: 0.8627
 Site-MNIST     | Val  Loss: 0.7209 | Val  Acc: 0.8415
 Site-MNIST     | Val  Loss: 0.6965 | Val  Acc: 0.8399
 Site-USPS      | Val  Loss: 0.4990 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.9628 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 0.9259 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.9274 | Val  Acc: 0.7586
 Site-USPS      | Val  Loss: 0.7694 | Val  Acc: 0.8381
 Site-USPS      | Val  Loss: 0.6991 | Val  Acc: 0.8624
 Site-SynthDigits| Val  Loss: 1.5466 | Val  Acc: 0.5405
 Site-SynthDigits| Val  Loss: 1.4474 | Val  Acc: 0.5147
 Site-SynthDigits| Val  Loss: 1.5008 | Val  Acc: 0.5082
 Site-MNIST-M   | Val  Loss: 1.8503 | Val  Acc: 0.3556
 Site-MNIST-M   | Val  Loss: 1.7772 | Val  Acc: 0.4444
 Site-SVHN      | Val  Loss: 1.8276 | Val  Acc: 0.3143
Average Valid Accuracy: 0.7580
Aggregated Acc | Val Acc: 0.5911
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8750
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8627
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8415
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8399
 Best site-USPS       | Epoch:4 | Val Acc: 0.9000
 Best site-USPS       | Epoch:4 | Val Acc: 0.7222
 Best site-USPS       | Epoch:4 | Val Acc: 0.7188
 Best site-USPS       | Epoch:4 | Val Acc: 0.7586
 Best site-USPS       | Epoch:4 | Val Acc: 0.8381
 Best site-USPS       | Epoch:4 | Val Acc: 0.8624
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5405
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5147
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5082
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3556
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4444
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 5 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-4
client-20 is in G-4
client-21 is in G-4
cnt=[1, 6, 3, 9, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7946 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.7561 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.5176 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.5597 | Train Acc: 0.8684
 Site-MNIST     | Train Loss: 0.4164 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 0.6293 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.5968 | Train Acc: 0.8634
 Site-MNIST     | Train Loss: 0.6864 | Train Acc: 0.8337
 Site-MNIST     | Train Loss: 0.6483 | Train Acc: 0.8505
 Site-MNIST     | Train Loss: 0.6241 | Train Acc: 0.8475
 Site-USPS      | Train Loss: 0.5655 | Train Acc: 0.8500
 Site-USPS      | Train Loss: 0.7264 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5840 | Train Acc: 0.8837
 Site-USPS      | Train Loss: 0.6874 | Train Acc: 0.8369
 Site-USPS      | Train Loss: 0.6754 | Train Acc: 0.8310
 Site-USPS      | Train Loss: 0.6658 | Train Acc: 0.8479
 Site-SynthDigits| Train Loss: 1.4263 | Train Acc: 0.5828
 Site-SynthDigits| Train Loss: 1.3896 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.3306 | Train Acc: 0.5906
 Site-MNIST-M   | Train Loss: 1.7231 | Train Acc: 0.4088
 Site-MNIST-M   | Train Loss: 1.6005 | Train Acc: 0.5015
 Site-SVHN      | Train Loss: 1.8918 | Train Acc: 0.3652
 Site-MNIST     | Val  Loss: 0.3835 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3404 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4375 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5932 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6292 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.6930 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.5962 | Val  Acc: 0.8393
 Site-MNIST     | Val  Loss: 0.5967 | Val  Acc: 0.8627
 Site-MNIST     | Val  Loss: 0.6693 | Val  Acc: 0.8415
 Site-MNIST     | Val  Loss: 0.6493 | Val  Acc: 0.8429
 Site-USPS      | Val  Loss: 0.4342 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.8806 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 0.8644 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.8741 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.7148 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.6403 | Val  Acc: 0.8836
 Site-SynthDigits| Val  Loss: 1.4419 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 1.3033 | Val  Acc: 0.6324
 Site-SynthDigits| Val  Loss: 1.3868 | Val  Acc: 0.6066
 Site-MNIST-M   | Val  Loss: 1.7933 | Val  Acc: 0.4222
 Site-MNIST-M   | Val  Loss: 1.7200 | Val  Acc: 0.5062
 Site-SVHN      | Val  Loss: 1.8070 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7834
Aggregated Acc | Val Acc: 0.7567
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8393
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8627
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8415
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8429
 Best site-USPS       | Epoch:5 | Val Acc: 0.9000
 Best site-USPS       | Epoch:5 | Val Acc: 0.7222
 Best site-USPS       | Epoch:5 | Val Acc: 0.7500
 Best site-USPS       | Epoch:5 | Val Acc: 0.7759
 Best site-USPS       | Epoch:5 | Val Acc: 0.8476
 Best site-USPS       | Epoch:5 | Val Acc: 0.8836
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6324
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6066
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4222
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5062
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7253 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.7157 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.4694 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4933 | Train Acc: 0.8947
 Site-MNIST     | Train Loss: 0.4757 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 0.5828 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.5439 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.6161 | Train Acc: 0.8484
 Site-MNIST     | Train Loss: 0.6010 | Train Acc: 0.8601
 Site-MNIST     | Train Loss: 0.5744 | Train Acc: 0.8687
 Site-USPS      | Train Loss: 0.5190 | Train Acc: 0.8500
 Site-USPS      | Train Loss: 0.5410 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.4496 | Train Acc: 0.8837
 Site-USPS      | Train Loss: 0.6327 | Train Acc: 0.8369
 Site-USPS      | Train Loss: 0.6075 | Train Acc: 0.8500
 Site-USPS      | Train Loss: 0.6058 | Train Acc: 0.8598
 Site-SynthDigits| Train Loss: 1.2517 | Train Acc: 0.5960
 Site-SynthDigits| Train Loss: 1.2886 | Train Acc: 0.5641
 Site-SynthDigits| Train Loss: 1.2485 | Train Acc: 0.6273
 Site-MNIST-M   | Train Loss: 1.6599 | Train Acc: 0.4254
 Site-MNIST-M   | Train Loss: 1.4851 | Train Acc: 0.5260
 Site-SVHN      | Train Loss: 1.8782 | Train Acc: 0.3830
 Site-MNIST     | Val  Loss: 0.3030 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2620 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4028 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5632 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5908 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.6314 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.5434 | Val  Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.5426 | Val  Acc: 0.8725
 Site-MNIST     | Val  Loss: 0.6187 | Val  Acc: 0.8361
 Site-MNIST     | Val  Loss: 0.5996 | Val  Acc: 0.8429
 Site-USPS      | Val  Loss: 0.3915 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.8412 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 0.8296 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.8284 | Val  Acc: 0.7586
 Site-USPS      | Val  Loss: 0.6668 | Val  Acc: 0.8286
 Site-USPS      | Val  Loss: 0.5877 | Val  Acc: 0.8836
 Site-SynthDigits| Val  Loss: 1.3473 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 1.2144 | Val  Acc: 0.6471
 Site-SynthDigits| Val  Loss: 1.3028 | Val  Acc: 0.6230
 Site-MNIST-M   | Val  Loss: 1.7260 | Val  Acc: 0.4444
 Site-MNIST-M   | Val  Loss: 1.6527 | Val  Acc: 0.5185
 Site-SVHN      | Val  Loss: 1.8059 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7881
Aggregated Acc | Val Acc: 0.6482
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8750
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8725
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8361
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8429
 Best site-USPS       | Epoch:6 | Val Acc: 0.9000
 Best site-USPS       | Epoch:6 | Val Acc: 0.7222
 Best site-USPS       | Epoch:6 | Val Acc: 0.7188
 Best site-USPS       | Epoch:6 | Val Acc: 0.7586
 Best site-USPS       | Epoch:6 | Val Acc: 0.8286
 Best site-USPS       | Epoch:6 | Val Acc: 0.8836
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6471
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6230
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4444
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5185
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-0
client-20 is in G-0
client-21 is in G-3
cnt=[2, 9, 6, 4, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6977 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.6807 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.4322 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4373 | Train Acc: 0.9211
 Site-MNIST     | Train Loss: 0.4235 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 0.5438 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.5107 | Train Acc: 0.8855
 Site-MNIST     | Train Loss: 0.5890 | Train Acc: 0.8557
 Site-MNIST     | Train Loss: 0.5472 | Train Acc: 0.8736
 Site-MNIST     | Train Loss: 0.5331 | Train Acc: 0.8725
 Site-USPS      | Train Loss: 0.4836 | Train Acc: 0.8500
 Site-USPS      | Train Loss: 0.4784 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.5836 | Train Acc: 0.8915
 Site-USPS      | Train Loss: 0.5993 | Train Acc: 0.8541
 Site-USPS      | Train Loss: 0.5594 | Train Acc: 0.8667
 Site-USPS      | Train Loss: 0.5683 | Train Acc: 0.8717
 Site-SynthDigits| Train Loss: 1.2835 | Train Acc: 0.5960
 Site-SynthDigits| Train Loss: 1.2158 | Train Acc: 0.6007
 Site-SynthDigits| Train Loss: 1.1689 | Train Acc: 0.6436
 Site-MNIST-M   | Train Loss: 1.6052 | Train Acc: 0.4475
 Site-MNIST-M   | Train Loss: 1.4518 | Train Acc: 0.5535
 Site-SVHN      | Train Loss: 1.8236 | Train Acc: 0.4149
 Site-MNIST     | Val  Loss: 0.2436 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2143 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3738 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5264 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5503 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.5822 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5033 | Val  Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.5007 | Val  Acc: 0.8725
 Site-MNIST     | Val  Loss: 0.5754 | Val  Acc: 0.8361
 Site-MNIST     | Val  Loss: 0.5580 | Val  Acc: 0.8520
 Site-USPS      | Val  Loss: 0.3643 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.8178 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.8077 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.7934 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.6341 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.5526 | Val  Acc: 0.8995
 Site-SynthDigits| Val  Loss: 1.2654 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 1.1000 | Val  Acc: 0.6765
 Site-SynthDigits| Val  Loss: 1.2181 | Val  Acc: 0.6557
 Site-MNIST-M   | Val  Loss: 1.6731 | Val  Acc: 0.4667
 Site-MNIST-M   | Val  Loss: 1.5999 | Val  Acc: 0.5556
 Site-SVHN      | Val  Loss: 1.7375 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8051
Aggregated Acc | Val Acc: 0.7730
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8750
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8725
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8361
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8520
 Best site-USPS       | Epoch:7 | Val Acc: 0.9000
 Best site-USPS       | Epoch:7 | Val Acc: 0.7778
 Best site-USPS       | Epoch:7 | Val Acc: 0.7500
 Best site-USPS       | Epoch:7 | Val Acc: 0.7931
 Best site-USPS       | Epoch:7 | Val Acc: 0.8476
 Best site-USPS       | Epoch:7 | Val Acc: 0.8995
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6765
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6557
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4667
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5556
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7168 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.6597 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.4268 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4095 | Train Acc: 0.9211
 Site-MNIST     | Train Loss: 0.5362 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 0.5381 | Train Acc: 0.8810
 Site-MNIST     | Train Loss: 0.4957 | Train Acc: 0.8899
 Site-MNIST     | Train Loss: 0.5664 | Train Acc: 0.8582
 Site-MNIST     | Train Loss: 0.5286 | Train Acc: 0.8804
 Site-MNIST     | Train Loss: 0.5146 | Train Acc: 0.8694
 Site-USPS      | Train Loss: 0.4541 | Train Acc: 0.9000
 Site-USPS      | Train Loss: 0.4123 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.5686 | Train Acc: 0.9070
 Site-USPS      | Train Loss: 0.5748 | Train Acc: 0.8412
 Site-USPS      | Train Loss: 0.5407 | Train Acc: 0.8762
 Site-USPS      | Train Loss: 0.5312 | Train Acc: 0.8717
 Site-SynthDigits| Train Loss: 1.1701 | Train Acc: 0.6225
 Site-SynthDigits| Train Loss: 1.1567 | Train Acc: 0.6227
 Site-SynthDigits| Train Loss: 1.1310 | Train Acc: 0.6619
 Site-MNIST-M   | Train Loss: 1.5434 | Train Acc: 0.4917
 Site-MNIST-M   | Train Loss: 1.4207 | Train Acc: 0.5657
 Site-SVHN      | Train Loss: 1.7979 | Train Acc: 0.4326
 Site-MNIST     | Val  Loss: 0.1589 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1814 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3707 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5194 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5433 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.5693 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.4904 | Val  Acc: 0.8929
 Site-MNIST     | Val  Loss: 0.4847 | Val  Acc: 0.8725
 Site-MNIST     | Val  Loss: 0.5598 | Val  Acc: 0.8470
 Site-MNIST     | Val  Loss: 0.5448 | Val  Acc: 0.8520
 Site-USPS      | Val  Loss: 0.3219 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.7630 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 0.7639 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.7624 | Val  Acc: 0.7586
 Site-USPS      | Val  Loss: 0.6042 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.5205 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 1.2146 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 1.0117 | Val  Acc: 0.6765
 Site-SynthDigits| Val  Loss: 1.1565 | Val  Acc: 0.6557
 Site-MNIST-M   | Val  Loss: 1.5871 | Val  Acc: 0.5111
 Site-MNIST-M   | Val  Loss: 1.5184 | Val  Acc: 0.6049
 Site-SVHN      | Val  Loss: 1.6718 | Val  Acc: 0.4429
Average Valid Accuracy: 0.8041
Aggregated Acc | Val Acc: 0.6798
============ Train epoch 9 ============
gmm
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 6, 9, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6696 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.6104 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.3686 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3529 | Train Acc: 0.9211
 Site-MNIST     | Train Loss: 0.7487 | Train Acc: 0.8286
 Site-MNIST     | Train Loss: 0.4842 | Train Acc: 0.8810
 Site-MNIST     | Train Loss: 0.4329 | Train Acc: 0.8899
 Site-MNIST     | Train Loss: 0.5111 | Train Acc: 0.8729
 Site-MNIST     | Train Loss: 0.4785 | Train Acc: 0.8886
 Site-MNIST     | Train Loss: 0.4616 | Train Acc: 0.8875
 Site-USPS      | Train Loss: 0.4299 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.3963 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.4626 | Train Acc: 0.8915
 Site-USPS      | Train Loss: 0.5455 | Train Acc: 0.8498
 Site-USPS      | Train Loss: 0.5124 | Train Acc: 0.8762
 Site-USPS      | Train Loss: 0.5052 | Train Acc: 0.8876
 Site-SynthDigits| Train Loss: 1.1623 | Train Acc: 0.6424
 Site-SynthDigits| Train Loss: 1.0943 | Train Acc: 0.6520
 Site-SynthDigits| Train Loss: 1.0524 | Train Acc: 0.6823
 Site-MNIST-M   | Train Loss: 1.4903 | Train Acc: 0.5470
 Site-MNIST-M   | Train Loss: 1.3492 | Train Acc: 0.5963
 Site-SVHN      | Train Loss: 1.7482 | Train Acc: 0.4326
 Site-MNIST     | Val  Loss: 0.1422 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1580 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3594 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5077 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4968 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.5041 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.4340 | Val  Acc: 0.8929
 Site-MNIST     | Val  Loss: 0.4325 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.5123 | Val  Acc: 0.8634
 Site-MNIST     | Val  Loss: 0.4939 | Val  Acc: 0.8610
 Site-USPS      | Val  Loss: 0.3096 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.7616 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.7656 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.7351 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.5787 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.4966 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 1.1302 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 0.9519 | Val  Acc: 0.7206
 Site-SynthDigits| Val  Loss: 1.1047 | Val  Acc: 0.7295
 Site-MNIST-M   | Val  Loss: 1.5523 | Val  Acc: 0.5111
 Site-MNIST-M   | Val  Loss: 1.4632 | Val  Acc: 0.6296
 Site-SVHN      | Val  Loss: 1.6722 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8199
Aggregated Acc | Val Acc: 0.7943
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8929
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8634
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8610
 Best site-USPS       | Epoch:9 | Val Acc: 0.9000
 Best site-USPS       | Epoch:9 | Val Acc: 0.7778
 Best site-USPS       | Epoch:9 | Val Acc: 0.7500
 Best site-USPS       | Epoch:9 | Val Acc: 0.7931
 Best site-USPS       | Epoch:9 | Val Acc: 0.8571
 Best site-USPS       | Epoch:9 | Val Acc: 0.8942
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7206
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7295
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5111
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6296
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8847
 Test site-USPS      | Epoch:9 | Test Acc: 0.8817
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6644
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.5216
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3865
Average Test Accuracy: 0.6678
============ Train epoch 10 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6763 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.6047 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.3508 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3453 | Train Acc: 0.8947
 Site-MNIST     | Train Loss: 0.4979 | Train Acc: 0.8286
 Site-MNIST     | Train Loss: 0.4694 | Train Acc: 0.8810
 Site-MNIST     | Train Loss: 0.4394 | Train Acc: 0.8811
 Site-MNIST     | Train Loss: 0.5058 | Train Acc: 0.8704
 Site-MNIST     | Train Loss: 0.4646 | Train Acc: 0.8899
 Site-MNIST     | Train Loss: 0.4503 | Train Acc: 0.8845
 Site-USPS      | Train Loss: 0.4200 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.4284 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.4779 | Train Acc: 0.8992
 Site-USPS      | Train Loss: 0.5315 | Train Acc: 0.8455
 Site-USPS      | Train Loss: 0.4927 | Train Acc: 0.8738
 Site-USPS      | Train Loss: 0.4830 | Train Acc: 0.8810
 Site-SynthDigits| Train Loss: 1.0593 | Train Acc: 0.6623
 Site-SynthDigits| Train Loss: 1.0445 | Train Acc: 0.7070
 Site-SynthDigits| Train Loss: 1.0162 | Train Acc: 0.7128
 Site-MNIST-M   | Train Loss: 1.4244 | Train Acc: 0.5746
 Site-MNIST-M   | Train Loss: 1.3343 | Train Acc: 0.5963
 Site-SVHN      | Train Loss: 1.6943 | Train Acc: 0.4468
 Site-MNIST     | Val  Loss: 0.1158 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1468 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3565 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4967 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4902 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.4962 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.4315 | Val  Acc: 0.8929
 Site-MNIST     | Val  Loss: 0.4230 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.5032 | Val  Acc: 0.8579
 Site-MNIST     | Val  Loss: 0.4846 | Val  Acc: 0.8550
 Site-USPS      | Val  Loss: 0.2847 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.7165 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.7342 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.7201 | Val  Acc: 0.8103
 Site-USPS      | Val  Loss: 0.5595 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.4740 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 1.0694 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.8699 | Val  Acc: 0.7647
 Site-SynthDigits| Val  Loss: 1.0427 | Val  Acc: 0.7623
 Site-MNIST-M   | Val  Loss: 1.4686 | Val  Acc: 0.5778
 Site-MNIST-M   | Val  Loss: 1.3765 | Val  Acc: 0.6790
 Site-SVHN      | Val  Loss: 1.5935 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8314
Aggregated Acc | Val Acc: 0.7166
 Best site-MNIST      | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8929
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8579
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8550
 Best site-USPS       | Epoch:10 | Val Acc: 0.9000
 Best site-USPS       | Epoch:10 | Val Acc: 0.7778
 Best site-USPS       | Epoch:10 | Val Acc: 0.7500
 Best site-USPS       | Epoch:10 | Val Acc: 0.8103
 Best site-USPS       | Epoch:10 | Val Acc: 0.8571
 Best site-USPS       | Epoch:10 | Val Acc: 0.8942
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.7647
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.7623
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.5778
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.6790
 Best site-SVHN       | Epoch:10 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 11 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[1, 6, 9, 2, 4, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6737 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.5605 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.3239 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3130 | Train Acc: 0.8947
 Site-MNIST     | Train Loss: 0.3896 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 0.4433 | Train Acc: 0.8810
 Site-MNIST     | Train Loss: 0.3930 | Train Acc: 0.8943
 Site-MNIST     | Train Loss: 0.4744 | Train Acc: 0.8753
 Site-MNIST     | Train Loss: 0.4439 | Train Acc: 0.8981
 Site-MNIST     | Train Loss: 0.4231 | Train Acc: 0.8981
 Site-USPS      | Train Loss: 0.4094 | Train Acc: 0.9000
 Site-USPS      | Train Loss: 0.4083 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.3177 | Train Acc: 0.8837
 Site-USPS      | Train Loss: 0.5234 | Train Acc: 0.8412
 Site-USPS      | Train Loss: 0.4662 | Train Acc: 0.8833
 Site-USPS      | Train Loss: 0.4612 | Train Acc: 0.8836
 Site-SynthDigits| Train Loss: 1.1035 | Train Acc: 0.6623
 Site-SynthDigits| Train Loss: 1.0342 | Train Acc: 0.7289
 Site-SynthDigits| Train Loss: 0.9496 | Train Acc: 0.7393
 Site-MNIST-M   | Train Loss: 1.3649 | Train Acc: 0.5967
 Site-MNIST-M   | Train Loss: 1.2309 | Train Acc: 0.6269
 Site-SVHN      | Train Loss: 1.6231 | Train Acc: 0.4610
 Site-MNIST     | Val  Loss: 0.1002 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1369 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3899 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5388 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.4900 | Val  Acc: 0.8235
 Site-MNIST     | Val  Loss: 0.4669 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3972 | Val  Acc: 0.9107
 Site-MNIST     | Val  Loss: 0.3955 | Val  Acc: 0.8922
 Site-MNIST     | Val  Loss: 0.4766 | Val  Acc: 0.8798
 Site-MNIST     | Val  Loss: 0.4602 | Val  Acc: 0.8701
 Site-USPS      | Val  Loss: 0.2676 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6973 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.7287 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.6978 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.5408 | Val  Acc: 0.8381
 Site-USPS      | Val  Loss: 0.4593 | Val  Acc: 0.8730
 Site-SynthDigits| Val  Loss: 1.0104 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.8179 | Val  Acc: 0.8088
 Site-SynthDigits| Val  Loss: 0.9843 | Val  Acc: 0.7541
 Site-MNIST-M   | Val  Loss: 1.4120 | Val  Acc: 0.6000
 Site-MNIST-M   | Val  Loss: 1.3177 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.5481 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8083
Aggregated Acc | Val Acc: 0.8032
============ Train epoch 12 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-0
client-20 is in G-0
client-21 is in G-3
cnt=[2, 10, 6, 1, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6289 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.5529 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.3097 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2892 | Train Acc: 0.9211
 Site-MNIST     | Train Loss: 0.5495 | Train Acc: 0.8429
 Site-MNIST     | Train Loss: 0.4213 | Train Acc: 0.8810
 Site-MNIST     | Train Loss: 0.3690 | Train Acc: 0.9075
 Site-MNIST     | Train Loss: 0.4488 | Train Acc: 0.8729
 Site-MNIST     | Train Loss: 0.4292 | Train Acc: 0.8981
 Site-MNIST     | Train Loss: 0.4005 | Train Acc: 0.8996
 Site-USPS      | Train Loss: 0.3895 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5066 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.4898 | Train Acc: 0.8837
 Site-USPS      | Train Loss: 0.5013 | Train Acc: 0.8584
 Site-USPS      | Train Loss: 0.4607 | Train Acc: 0.8833
 Site-USPS      | Train Loss: 0.4458 | Train Acc: 0.8849
 Site-SynthDigits| Train Loss: 0.9886 | Train Acc: 0.6689
 Site-SynthDigits| Train Loss: 1.0059 | Train Acc: 0.7326
 Site-SynthDigits| Train Loss: 0.9187 | Train Acc: 0.7495
 Site-MNIST-M   | Train Loss: 1.3334 | Train Acc: 0.6298
 Site-MNIST-M   | Train Loss: 1.2255 | Train Acc: 0.6453
 Site-SVHN      | Train Loss: 1.5519 | Train Acc: 0.4787
 Site-MNIST     | Val  Loss: 0.0879 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1166 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3901 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5305 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.4758 | Val  Acc: 0.8235
 Site-MNIST     | Val  Loss: 0.4373 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3776 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3751 | Val  Acc: 0.8922
 Site-MNIST     | Val  Loss: 0.4591 | Val  Acc: 0.8634
 Site-MNIST     | Val  Loss: 0.4392 | Val  Acc: 0.8731
 Site-USPS      | Val  Loss: 0.2618 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6866 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.7157 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.6886 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.5281 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.4410 | Val  Acc: 0.8836
 Site-SynthDigits| Val  Loss: 0.9653 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 0.7709 | Val  Acc: 0.7941
 Site-SynthDigits| Val  Loss: 0.9441 | Val  Acc: 0.7623
 Site-MNIST-M   | Val  Loss: 1.3375 | Val  Acc: 0.6222
 Site-MNIST-M   | Val  Loss: 1.2478 | Val  Acc: 0.7160
 Site-SVHN      | Val  Loss: 1.4008 | Val  Acc: 0.4857
Average Valid Accuracy: 0.8172
Aggregated Acc | Val Acc: 0.7293
============ Train epoch 13 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5992 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.5288 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.2751 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2653 | Train Acc: 0.9211
 Site-MNIST     | Train Loss: 0.2702 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.3847 | Train Acc: 0.9127
 Site-MNIST     | Train Loss: 0.3363 | Train Acc: 0.9075
 Site-MNIST     | Train Loss: 0.4159 | Train Acc: 0.8900
 Site-MNIST     | Train Loss: 0.3977 | Train Acc: 0.9022
 Site-MNIST     | Train Loss: 0.3692 | Train Acc: 0.9094
 Site-USPS      | Train Loss: 0.3779 | Train Acc: 0.8500
 Site-USPS      | Train Loss: 0.5122 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.3504 | Train Acc: 0.8915
 Site-USPS      | Train Loss: 0.4999 | Train Acc: 0.8541
 Site-USPS      | Train Loss: 0.4296 | Train Acc: 0.8786
 Site-USPS      | Train Loss: 0.4350 | Train Acc: 0.8889
 Site-SynthDigits| Train Loss: 0.9286 | Train Acc: 0.6821
 Site-SynthDigits| Train Loss: 0.9382 | Train Acc: 0.7289
 Site-SynthDigits| Train Loss: 0.8708 | Train Acc: 0.7597
 Site-MNIST-M   | Train Loss: 1.2818 | Train Acc: 0.5967
 Site-MNIST-M   | Train Loss: 1.2253 | Train Acc: 0.6422
 Site-SVHN      | Train Loss: 1.4785 | Train Acc: 0.5142
 Site-MNIST     | Val  Loss: 0.0796 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1028 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3791 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5077 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.4423 | Val  Acc: 0.8235
 Site-MNIST     | Val  Loss: 0.3985 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3478 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3469 | Val  Acc: 0.9118
 Site-MNIST     | Val  Loss: 0.4314 | Val  Acc: 0.8907
 Site-MNIST     | Val  Loss: 0.4099 | Val  Acc: 0.8882
 Site-USPS      | Val  Loss: 0.2686 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6969 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.7184 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.6724 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.5166 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.4295 | Val  Acc: 0.8836
 Site-SynthDigits| Val  Loss: 0.9206 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.7345 | Val  Acc: 0.8088
 Site-SynthDigits| Val  Loss: 0.9162 | Val  Acc: 0.7541
 Site-MNIST-M   | Val  Loss: 1.3016 | Val  Acc: 0.6000
 Site-MNIST-M   | Val  Loss: 1.1895 | Val  Acc: 0.7037
 Site-SVHN      | Val  Loss: 1.3232 | Val  Acc: 0.5286
Average Valid Accuracy: 0.8194
Aggregated Acc | Val Acc: 0.7343
============ Train epoch 14 ============
gmm
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-4
client-20 is in G-4
client-21 is in G-3
cnt=[9, 6, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6098 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.5099 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.2537 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2477 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2324 | Train Acc: 0.8714
 Site-MNIST     | Train Loss: 0.3621 | Train Acc: 0.9127
 Site-MNIST     | Train Loss: 0.3269 | Train Acc: 0.9075
 Site-MNIST     | Train Loss: 0.4050 | Train Acc: 0.8924
 Site-MNIST     | Train Loss: 0.3877 | Train Acc: 0.9062
 Site-MNIST     | Train Loss: 0.3515 | Train Acc: 0.9185
 Site-USPS      | Train Loss: 0.3724 | Train Acc: 0.8500
 Site-USPS      | Train Loss: 0.3508 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.2762 | Train Acc: 0.8837
 Site-USPS      | Train Loss: 0.4695 | Train Acc: 0.8541
 Site-USPS      | Train Loss: 0.4089 | Train Acc: 0.8881
 Site-USPS      | Train Loss: 0.4182 | Train Acc: 0.8902
 Site-SynthDigits| Train Loss: 0.9439 | Train Acc: 0.7152
 Site-SynthDigits| Train Loss: 0.8496 | Train Acc: 0.7399
 Site-SynthDigits| Train Loss: 0.8140 | Train Acc: 0.7800
 Site-MNIST-M   | Train Loss: 1.2221 | Train Acc: 0.6188
 Site-MNIST-M   | Train Loss: 1.1355 | Train Acc: 0.6636
 Site-SVHN      | Train Loss: 1.4474 | Train Acc: 0.5390
 Site-MNIST     | Val  Loss: 0.0746 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0969 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3964 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5255 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.4389 | Val  Acc: 0.8235
 Site-MNIST     | Val  Loss: 0.3758 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3249 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3281 | Val  Acc: 0.9118
 Site-MNIST     | Val  Loss: 0.4117 | Val  Acc: 0.8907
 Site-MNIST     | Val  Loss: 0.3948 | Val  Acc: 0.8852
 Site-USPS      | Val  Loss: 0.2516 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6716 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.7075 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.6555 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.5047 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.4182 | Val  Acc: 0.8783
 Site-SynthDigits| Val  Loss: 0.8673 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.6875 | Val  Acc: 0.8235
 Site-SynthDigits| Val  Loss: 0.8521 | Val  Acc: 0.7705
 Site-MNIST-M   | Val  Loss: 1.2371 | Val  Acc: 0.6222
 Site-MNIST-M   | Val  Loss: 1.1276 | Val  Acc: 0.7778
 Site-SVHN      | Val  Loss: 1.2293 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8281
Aggregated Acc | Val Acc: 0.8284
============ Train epoch 15 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6196 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.4868 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.2390 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2321 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.3689 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.3435 | Train Acc: 0.9286
 Site-MNIST     | Train Loss: 0.2996 | Train Acc: 0.9163
 Site-MNIST     | Train Loss: 0.4126 | Train Acc: 0.8998
 Site-MNIST     | Train Loss: 0.3579 | Train Acc: 0.9171
 Site-MNIST     | Train Loss: 0.3333 | Train Acc: 0.9230
 Site-USPS      | Train Loss: 0.3560 | Train Acc: 0.9250
 Site-USPS      | Train Loss: 0.3076 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.4103 | Train Acc: 0.8837
 Site-USPS      | Train Loss: 0.4587 | Train Acc: 0.8412
 Site-USPS      | Train Loss: 0.3953 | Train Acc: 0.8976
 Site-USPS      | Train Loss: 0.4067 | Train Acc: 0.8968
 Site-SynthDigits| Train Loss: 0.8873 | Train Acc: 0.7285
 Site-SynthDigits| Train Loss: 0.8104 | Train Acc: 0.7692
 Site-SynthDigits| Train Loss: 0.7572 | Train Acc: 0.8147
 Site-MNIST-M   | Train Loss: 1.1898 | Train Acc: 0.6354
 Site-MNIST-M   | Train Loss: 1.1774 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 1.3664 | Train Acc: 0.5709
 Site-MNIST     | Val  Loss: 0.0697 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0905 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3922 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5208 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.4206 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.3540 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3051 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.3122 | Val  Acc: 0.9118
 Site-MNIST     | Val  Loss: 0.3950 | Val  Acc: 0.9016
 Site-MNIST     | Val  Loss: 0.3812 | Val  Acc: 0.8973
 Site-USPS      | Val  Loss: 0.2397 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6576 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.6908 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.6284 | Val  Acc: 0.7586
 Site-USPS      | Val  Loss: 0.4888 | Val  Acc: 0.8286
 Site-USPS      | Val  Loss: 0.4086 | Val  Acc: 0.8730
 Site-SynthDigits| Val  Loss: 0.8295 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 0.6538 | Val  Acc: 0.8529
 Site-SynthDigits| Val  Loss: 0.8080 | Val  Acc: 0.7787
 Site-MNIST-M   | Val  Loss: 1.1995 | Val  Acc: 0.6444
 Site-MNIST-M   | Val  Loss: 1.0844 | Val  Acc: 0.7778
 Site-SVHN      | Val  Loss: 1.1230 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8388
Aggregated Acc | Val Acc: 0.7747
 Best site-MNIST      | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9118
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9016
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8973
 Best site-USPS       | Epoch:15 | Val Acc: 0.9000
 Best site-USPS       | Epoch:15 | Val Acc: 0.7778
 Best site-USPS       | Epoch:15 | Val Acc: 0.7188
 Best site-USPS       | Epoch:15 | Val Acc: 0.7586
 Best site-USPS       | Epoch:15 | Val Acc: 0.8286
 Best site-USPS       | Epoch:15 | Val Acc: 0.8730
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.8529
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7787
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.6444
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7778
 Best site-SVHN       | Epoch:15 | Val Acc: 0.6286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 16 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-0
cnt=[4, 9, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5891 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.4789 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.2204 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2272 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.6081 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.3269 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.3062 | Train Acc: 0.9207
 Site-MNIST     | Train Loss: 0.3772 | Train Acc: 0.8998
 Site-MNIST     | Train Loss: 0.3608 | Train Acc: 0.9076
 Site-MNIST     | Train Loss: 0.3166 | Train Acc: 0.9230
 Site-USPS      | Train Loss: 0.3463 | Train Acc: 0.9000
 Site-USPS      | Train Loss: 0.5347 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.2693 | Train Acc: 0.9070
 Site-USPS      | Train Loss: 0.4536 | Train Acc: 0.8498
 Site-USPS      | Train Loss: 0.3710 | Train Acc: 0.8952
 Site-USPS      | Train Loss: 0.3926 | Train Acc: 0.8968
 Site-SynthDigits| Train Loss: 0.8620 | Train Acc: 0.7417
 Site-SynthDigits| Train Loss: 0.7894 | Train Acc: 0.7582
 Site-SynthDigits| Train Loss: 0.7353 | Train Acc: 0.8086
 Site-MNIST-M   | Train Loss: 1.1209 | Train Acc: 0.6740
 Site-MNIST-M   | Train Loss: 0.9982 | Train Acc: 0.6850
 Site-SVHN      | Train Loss: 1.3943 | Train Acc: 0.5567
 Site-MNIST     | Val  Loss: 0.0501 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0752 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4081 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5338 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.4207 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.3420 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2924 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.2983 | Val  Acc: 0.9216
 Site-MNIST     | Val  Loss: 0.3829 | Val  Acc: 0.9071
 Site-MNIST     | Val  Loss: 0.3657 | Val  Acc: 0.9033
 Site-USPS      | Val  Loss: 0.2360 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6525 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.6786 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.6285 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.4802 | Val  Acc: 0.8381
 Site-USPS      | Val  Loss: 0.3948 | Val  Acc: 0.8836
 Site-SynthDigits| Val  Loss: 0.7948 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.6337 | Val  Acc: 0.8088
 Site-SynthDigits| Val  Loss: 0.7660 | Val  Acc: 0.7869
 Site-MNIST-M   | Val  Loss: 1.1102 | Val  Acc: 0.7111
 Site-MNIST-M   | Val  Loss: 1.0063 | Val  Acc: 0.8148
 Site-SVHN      | Val  Loss: 1.1146 | Val  Acc: 0.6143
Average Valid Accuracy: 0.8405
Aggregated Acc | Val Acc: 0.8445
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9216
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9071
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9033
 Best site-USPS       | Epoch:16 | Val Acc: 0.9000
 Best site-USPS       | Epoch:16 | Val Acc: 0.7778
 Best site-USPS       | Epoch:16 | Val Acc: 0.7500
 Best site-USPS       | Epoch:16 | Val Acc: 0.7759
 Best site-USPS       | Epoch:16 | Val Acc: 0.8381
 Best site-USPS       | Epoch:16 | Val Acc: 0.8836
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.8088
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7869
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7111
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.8148
 Best site-SVHN       | Epoch:16 | Val Acc: 0.6143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 17 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5858 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.4518 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.2115 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2102 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.4072 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.3118 | Train Acc: 0.9286
 Site-MNIST     | Train Loss: 0.2817 | Train Acc: 0.9295
 Site-MNIST     | Train Loss: 0.3504 | Train Acc: 0.9022
 Site-MNIST     | Train Loss: 0.3419 | Train Acc: 0.9198
 Site-MNIST     | Train Loss: 0.3037 | Train Acc: 0.9328
 Site-USPS      | Train Loss: 0.3257 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.3003 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.3270 | Train Acc: 0.9070
 Site-USPS      | Train Loss: 0.4324 | Train Acc: 0.8584
 Site-USPS      | Train Loss: 0.3535 | Train Acc: 0.9119
 Site-USPS      | Train Loss: 0.3786 | Train Acc: 0.9021
 Site-SynthDigits| Train Loss: 0.8373 | Train Acc: 0.7550
 Site-SynthDigits| Train Loss: 0.7334 | Train Acc: 0.7802
 Site-SynthDigits| Train Loss: 0.7014 | Train Acc: 0.8248
 Site-MNIST-M   | Train Loss: 1.0975 | Train Acc: 0.6796
 Site-MNIST-M   | Train Loss: 1.1042 | Train Acc: 0.6881
 Site-SVHN      | Train Loss: 1.2983 | Train Acc: 0.5887
 Site-MNIST     | Val  Loss: 0.0436 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0700 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3890 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5127 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3941 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.3217 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2770 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2840 | Val  Acc: 0.9216
 Site-MNIST     | Val  Loss: 0.3675 | Val  Acc: 0.9016
 Site-MNIST     | Val  Loss: 0.3508 | Val  Acc: 0.9033
 Site-USPS      | Val  Loss: 0.2302 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6392 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.6640 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.6048 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.4667 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.3815 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.7661 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 0.6057 | Val  Acc: 0.8382
 Site-SynthDigits| Val  Loss: 0.7339 | Val  Acc: 0.8115
 Site-MNIST-M   | Val  Loss: 1.1063 | Val  Acc: 0.6889
 Site-MNIST-M   | Val  Loss: 0.9943 | Val  Acc: 0.7654
 Site-SVHN      | Val  Loss: 0.9767 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8447
Aggregated Acc | Val Acc: 0.7835
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:17 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9216
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9016
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9033
 Best site-USPS       | Epoch:17 | Val Acc: 0.9000
 Best site-USPS       | Epoch:17 | Val Acc: 0.7778
 Best site-USPS       | Epoch:17 | Val Acc: 0.7500
 Best site-USPS       | Epoch:17 | Val Acc: 0.7931
 Best site-USPS       | Epoch:17 | Val Acc: 0.8571
 Best site-USPS       | Epoch:17 | Val Acc: 0.8889
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.8382
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.8115
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.6889
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.7654
 Best site-SVHN       | Epoch:17 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 18 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5589 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.4351 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1982 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1969 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.7046 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.3008 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.2713 | Train Acc: 0.9295
 Site-MNIST     | Train Loss: 0.3503 | Train Acc: 0.9120
 Site-MNIST     | Train Loss: 0.3222 | Train Acc: 0.9239
 Site-MNIST     | Train Loss: 0.2911 | Train Acc: 0.9381
 Site-USPS      | Train Loss: 0.3124 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.2931 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.2641 | Train Acc: 0.9147
 Site-USPS      | Train Loss: 0.4398 | Train Acc: 0.8455
 Site-USPS      | Train Loss: 0.3546 | Train Acc: 0.9119
 Site-USPS      | Train Loss: 0.3706 | Train Acc: 0.8995
 Site-SynthDigits| Train Loss: 0.7932 | Train Acc: 0.7483
 Site-SynthDigits| Train Loss: 0.7235 | Train Acc: 0.7875
 Site-SynthDigits| Train Loss: 0.6827 | Train Acc: 0.8289
 Site-MNIST-M   | Train Loss: 1.0793 | Train Acc: 0.6685
 Site-MNIST-M   | Train Loss: 1.0360 | Train Acc: 0.6911
 Site-SVHN      | Train Loss: 1.2711 | Train Acc: 0.6170
 Site-MNIST     | Val  Loss: 0.0434 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0701 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3815 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4938 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3745 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.3030 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2651 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2722 | Val  Acc: 0.9314
 Site-MNIST     | Val  Loss: 0.3569 | Val  Acc: 0.9071
 Site-MNIST     | Val  Loss: 0.3369 | Val  Acc: 0.9033
 Site-USPS      | Val  Loss: 0.2368 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6330 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 0.6602 | Val  Acc: 0.6875
 Site-USPS      | Val  Loss: 0.5973 | Val  Acc: 0.7586
 Site-USPS      | Val  Loss: 0.4649 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.3754 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.7329 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.5766 | Val  Acc: 0.8529
 Site-SynthDigits| Val  Loss: 0.7073 | Val  Acc: 0.8115
 Site-MNIST-M   | Val  Loss: 1.0808 | Val  Acc: 0.7333
 Site-MNIST-M   | Val  Loss: 0.9631 | Val  Acc: 0.7901
 Site-SVHN      | Val  Loss: 0.9116 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8464
Aggregated Acc | Val Acc: 0.7934
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9314
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9071
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9033
 Best site-USPS       | Epoch:18 | Val Acc: 0.9000
 Best site-USPS       | Epoch:18 | Val Acc: 0.7222
 Best site-USPS       | Epoch:18 | Val Acc: 0.6875
 Best site-USPS       | Epoch:18 | Val Acc: 0.7586
 Best site-USPS       | Epoch:18 | Val Acc: 0.8476
 Best site-USPS       | Epoch:18 | Val Acc: 0.8889
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8529
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8115
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7333
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7901
 Best site-SVHN       | Epoch:18 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-4
client-20 is in G-4
client-21 is in G-0
cnt=[1, 10, 6, 3, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5474 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.4202 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1878 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1861 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.4081 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.2845 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.2610 | Train Acc: 0.9251
 Site-MNIST     | Train Loss: 0.3303 | Train Acc: 0.9144
 Site-MNIST     | Train Loss: 0.3081 | Train Acc: 0.9212
 Site-MNIST     | Train Loss: 0.2770 | Train Acc: 0.9374
 Site-USPS      | Train Loss: 0.3139 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.4698 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.3385 | Train Acc: 0.9070
 Site-USPS      | Train Loss: 0.4136 | Train Acc: 0.8541
 Site-USPS      | Train Loss: 0.3463 | Train Acc: 0.9095
 Site-USPS      | Train Loss: 0.3639 | Train Acc: 0.9021
 Site-SynthDigits| Train Loss: 0.8480 | Train Acc: 0.7616
 Site-SynthDigits| Train Loss: 0.6656 | Train Acc: 0.8205
 Site-SynthDigits| Train Loss: 0.6457 | Train Acc: 0.8350
 Site-MNIST-M   | Train Loss: 1.0225 | Train Acc: 0.6961
 Site-MNIST-M   | Train Loss: 0.9366 | Train Acc: 0.7156
 Site-SVHN      | Train Loss: 1.2213 | Train Acc: 0.6099
 Site-MNIST     | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0675 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4063 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5151 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3806 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2893 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2523 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2607 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.3481 | Val  Acc: 0.9180
 Site-MNIST     | Val  Loss: 0.3280 | Val  Acc: 0.9063
 Site-USPS      | Val  Loss: 0.2253 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.6112 | Val  Acc: 0.7222
 Site-USPS      | Val  Loss: 0.6459 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.5849 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.4548 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.3642 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 0.7072 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 0.5563 | Val  Acc: 0.8529
 Site-SynthDigits| Val  Loss: 0.6789 | Val  Acc: 0.8443
 Site-MNIST-M   | Val  Loss: 1.0385 | Val  Acc: 0.7556
 Site-MNIST-M   | Val  Loss: 0.9325 | Val  Acc: 0.8148
 Site-SVHN      | Val  Loss: 0.9008 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8531
Aggregated Acc | Val Acc: 0.8013
 Best site-MNIST      | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9180
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9063
 Best site-USPS       | Epoch:19 | Val Acc: 0.9000
 Best site-USPS       | Epoch:19 | Val Acc: 0.7222
 Best site-USPS       | Epoch:19 | Val Acc: 0.7188
 Best site-USPS       | Epoch:19 | Val Acc: 0.7931
 Best site-USPS       | Epoch:19 | Val Acc: 0.8476
 Best site-USPS       | Epoch:19 | Val Acc: 0.8942
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8529
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8443
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.7556
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.8148
 Best site-SVHN       | Epoch:19 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.9203
 Test site-USPS      | Epoch:19 | Test Acc: 0.9108
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.8034
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.6440
 Test site-SVHN      | Epoch:19 | Test Acc: 0.5393
Average Test Accuracy: 0.7636
============ Train epoch 20 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5594 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.4070 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1765 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1834 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2709 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.2727 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2521 | Train Acc: 0.9383
 Site-MNIST     | Train Loss: 0.3265 | Train Acc: 0.9169
 Site-MNIST     | Train Loss: 0.3099 | Train Acc: 0.9239
 Site-MNIST     | Train Loss: 0.2660 | Train Acc: 0.9411
 Site-USPS      | Train Loss: 0.2920 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.3370 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.2354 | Train Acc: 0.9147
 Site-USPS      | Train Loss: 0.4127 | Train Acc: 0.8498
 Site-USPS      | Train Loss: 0.3353 | Train Acc: 0.9214
 Site-USPS      | Train Loss: 0.3455 | Train Acc: 0.9140
 Site-SynthDigits| Train Loss: 0.7455 | Train Acc: 0.7550
 Site-SynthDigits| Train Loss: 0.7070 | Train Acc: 0.8168
 Site-SynthDigits| Train Loss: 0.6203 | Train Acc: 0.8452
 Site-MNIST-M   | Train Loss: 1.0075 | Train Acc: 0.7127
 Site-MNIST-M   | Train Loss: 1.0663 | Train Acc: 0.6881
 Site-SVHN      | Train Loss: 1.2071 | Train Acc: 0.6135
 Site-MNIST     | Val  Loss: 0.0309 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0614 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3953 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.5078 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3663 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2741 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2402 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2498 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.3373 | Val  Acc: 0.9235
 Site-MNIST     | Val  Loss: 0.3181 | Val  Acc: 0.9215
 Site-USPS      | Val  Loss: 0.2057 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5869 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.6206 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.5647 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.4395 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.3516 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 0.6747 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.5246 | Val  Acc: 0.8676
 Site-SynthDigits| Val  Loss: 0.6513 | Val  Acc: 0.8361
 Site-MNIST-M   | Val  Loss: 1.0320 | Val  Acc: 0.7778
 Site-MNIST-M   | Val  Loss: 0.9232 | Val  Acc: 0.8025
 Site-SVHN      | Val  Loss: 0.8663 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8584
Aggregated Acc | Val Acc: 0.8091
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9235
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9215
 Best site-USPS       | Epoch:20 | Val Acc: 0.9000
 Best site-USPS       | Epoch:20 | Val Acc: 0.7778
 Best site-USPS       | Epoch:20 | Val Acc: 0.7188
 Best site-USPS       | Epoch:20 | Val Acc: 0.7759
 Best site-USPS       | Epoch:20 | Val Acc: 0.8476
 Best site-USPS       | Epoch:20 | Val Acc: 0.8942
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8676
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8361
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.7778
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8025
 Best site-SVHN       | Epoch:20 | Val Acc: 0.6714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 21 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5746 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3996 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1740 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1751 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2008 | Train Acc: 0.8857
 Site-MNIST     | Train Loss: 0.2673 | Train Acc: 0.9286
 Site-MNIST     | Train Loss: 0.2471 | Train Acc: 0.9471
 Site-MNIST     | Train Loss: 0.3190 | Train Acc: 0.9144
 Site-MNIST     | Train Loss: 0.2974 | Train Acc: 0.9226
 Site-MNIST     | Train Loss: 0.2598 | Train Acc: 0.9426
 Site-USPS      | Train Loss: 0.2867 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.3290 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.3580 | Train Acc: 0.9225
 Site-USPS      | Train Loss: 0.3975 | Train Acc: 0.8627
 Site-USPS      | Train Loss: 0.3318 | Train Acc: 0.9286
 Site-USPS      | Train Loss: 0.3382 | Train Acc: 0.9167
 Site-SynthDigits| Train Loss: 0.7329 | Train Acc: 0.7550
 Site-SynthDigits| Train Loss: 0.6377 | Train Acc: 0.8315
 Site-SynthDigits| Train Loss: 0.6150 | Train Acc: 0.8473
 Site-MNIST-M   | Train Loss: 0.9832 | Train Acc: 0.7017
 Site-MNIST-M   | Train Loss: 0.9026 | Train Acc: 0.7034
 Site-SVHN      | Train Loss: 1.2094 | Train Acc: 0.6206
 Site-MNIST     | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0592 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3943 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4986 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3593 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2681 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2377 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2462 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.3322 | Val  Acc: 0.9235
 Site-MNIST     | Val  Loss: 0.3147 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.1907 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5511 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5928 | Val  Acc: 0.7812
 Site-USPS      | Val  Loss: 0.5512 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.4294 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.3412 | Val  Acc: 0.9048
 Site-SynthDigits| Val  Loss: 0.6586 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 0.5119 | Val  Acc: 0.8971
 Site-SynthDigits| Val  Loss: 0.6279 | Val  Acc: 0.8525
 Site-MNIST-M   | Val  Loss: 0.9834 | Val  Acc: 0.7556
 Site-MNIST-M   | Val  Loss: 0.8901 | Val  Acc: 0.8272
 Site-SVHN      | Val  Loss: 0.8332 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8669
Aggregated Acc | Val Acc: 0.8160
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:21 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9235
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9305
 Best site-USPS       | Epoch:21 | Val Acc: 0.9000
 Best site-USPS       | Epoch:21 | Val Acc: 0.8333
 Best site-USPS       | Epoch:21 | Val Acc: 0.7812
 Best site-USPS       | Epoch:21 | Val Acc: 0.7931
 Best site-USPS       | Epoch:21 | Val Acc: 0.8571
 Best site-USPS       | Epoch:21 | Val Acc: 0.9048
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8971
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8525
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.7556
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8272
 Best site-SVHN       | Epoch:21 | Val Acc: 0.6714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 22 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-2
cnt=[9, 6, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5613 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3777 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1581 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1641 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1875 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.2492 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.2312 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.3036 | Train Acc: 0.9193
 Site-MNIST     | Train Loss: 0.2823 | Train Acc: 0.9266
 Site-MNIST     | Train Loss: 0.2460 | Train Acc: 0.9464
 Site-USPS      | Train Loss: 0.2852 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.4335 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.2606 | Train Acc: 0.9225
 Site-USPS      | Train Loss: 0.3926 | Train Acc: 0.8541
 Site-USPS      | Train Loss: 0.3180 | Train Acc: 0.9357
 Site-USPS      | Train Loss: 0.3312 | Train Acc: 0.9114
 Site-SynthDigits| Train Loss: 0.7419 | Train Acc: 0.7616
 Site-SynthDigits| Train Loss: 0.6806 | Train Acc: 0.8352
 Site-SynthDigits| Train Loss: 0.5761 | Train Acc: 0.8554
 Site-MNIST-M   | Train Loss: 0.9545 | Train Acc: 0.7348
 Site-MNIST-M   | Train Loss: 0.9521 | Train Acc: 0.7064
 Site-SVHN      | Train Loss: 1.1671 | Train Acc: 0.6241
 Site-MNIST     | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0545 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3816 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4753 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3379 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2465 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2227 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2318 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.3154 | Val  Acc: 0.9235
 Site-MNIST     | Val  Loss: 0.2981 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.2044 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5644 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.6060 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.5437 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.4283 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.3388 | Val  Acc: 0.8995
 Site-SynthDigits| Val  Loss: 0.6319 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.4807 | Val  Acc: 0.8676
 Site-SynthDigits| Val  Loss: 0.6022 | Val  Acc: 0.8443
 Site-MNIST-M   | Val  Loss: 0.9756 | Val  Acc: 0.7556
 Site-MNIST-M   | Val  Loss: 0.8645 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.8112 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8639
Aggregated Acc | Val Acc: 0.8703
============ Train epoch 23 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-4
client-20 is in G-4
client-21 is in G-3
cnt=[10, 3, 6, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5525 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3675 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1572 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1577 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.3178 | Train Acc: 0.8857
 Site-MNIST     | Train Loss: 0.2470 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.2299 | Train Acc: 0.9471
 Site-MNIST     | Train Loss: 0.2983 | Train Acc: 0.9267
 Site-MNIST     | Train Loss: 0.2741 | Train Acc: 0.9293
 Site-MNIST     | Train Loss: 0.2399 | Train Acc: 0.9449
 Site-USPS      | Train Loss: 0.2659 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2506 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.2311 | Train Acc: 0.9380
 Site-USPS      | Train Loss: 0.3848 | Train Acc: 0.8627
 Site-USPS      | Train Loss: 0.3074 | Train Acc: 0.9310
 Site-USPS      | Train Loss: 0.3258 | Train Acc: 0.9101
 Site-SynthDigits| Train Loss: 0.7079 | Train Acc: 0.7616
 Site-SynthDigits| Train Loss: 0.6076 | Train Acc: 0.8645
 Site-SynthDigits| Train Loss: 0.5600 | Train Acc: 0.8656
 Site-MNIST-M   | Train Loss: 0.9272 | Train Acc: 0.7514
 Site-MNIST-M   | Train Loss: 0.8478 | Train Acc: 0.7248
 Site-SVHN      | Train Loss: 1.1486 | Train Acc: 0.6418
 Site-MNIST     | Val  Loss: 0.0260 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0534 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3881 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4712 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3347 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2389 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2176 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2256 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.3099 | Val  Acc: 0.9235
 Site-MNIST     | Val  Loss: 0.2923 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.2040 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5508 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.5925 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.5347 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.4222 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.3333 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.6077 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4502 | Val  Acc: 0.8971
 Site-SynthDigits| Val  Loss: 0.5760 | Val  Acc: 0.8689
 Site-MNIST-M   | Val  Loss: 0.9463 | Val  Acc: 0.7556
 Site-MNIST-M   | Val  Loss: 0.8355 | Val  Acc: 0.8272
 Site-SVHN      | Val  Loss: 0.7755 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8650
Aggregated Acc | Val Acc: 0.8217
============ Train epoch 24 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-4
client-20 is in G-4
client-21 is in G-3
cnt=[1, 6, 9, 4, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5460 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3528 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1530 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1534 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.3530 | Train Acc: 0.8857
 Site-MNIST     | Train Loss: 0.2372 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.2136 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2838 | Train Acc: 0.9193
 Site-MNIST     | Train Loss: 0.2704 | Train Acc: 0.9280
 Site-MNIST     | Train Loss: 0.2306 | Train Acc: 0.9464
 Site-USPS      | Train Loss: 0.2678 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2014 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1980 | Train Acc: 0.9380
 Site-USPS      | Train Loss: 0.3782 | Train Acc: 0.8584
 Site-USPS      | Train Loss: 0.2971 | Train Acc: 0.9310
 Site-USPS      | Train Loss: 0.3198 | Train Acc: 0.9127
 Site-SynthDigits| Train Loss: 0.7023 | Train Acc: 0.7616
 Site-SynthDigits| Train Loss: 0.5898 | Train Acc: 0.8608
 Site-SynthDigits| Train Loss: 0.5454 | Train Acc: 0.8676
 Site-MNIST-M   | Train Loss: 0.9079 | Train Acc: 0.7459
 Site-MNIST-M   | Train Loss: 0.8313 | Train Acc: 0.7278
 Site-SVHN      | Train Loss: 1.1645 | Train Acc: 0.6418
 Site-MNIST     | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0501 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3864 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4696 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3274 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2289 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2084 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2172 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.3005 | Val  Acc: 0.9235
 Site-MNIST     | Val  Loss: 0.2831 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.1908 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5457 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.5852 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.5232 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.4129 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.3229 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.5843 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4360 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.5560 | Val  Acc: 0.8525
 Site-MNIST-M   | Val  Loss: 0.9258 | Val  Acc: 0.7556
 Site-MNIST-M   | Val  Loss: 0.8155 | Val  Acc: 0.8148
 Site-SVHN      | Val  Loss: 0.7566 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8662
Aggregated Acc | Val Acc: 0.8715
============ Train epoch 25 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-2
client-20 is in G-2
client-21 is in G-3
cnt=[9, 6, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5433 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3435 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1467 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1476 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2237 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.2282 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.2442 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2827 | Train Acc: 0.9242
 Site-MNIST     | Train Loss: 0.2592 | Train Acc: 0.9361
 Site-MNIST     | Train Loss: 0.2229 | Train Acc: 0.9494
 Site-USPS      | Train Loss: 0.2589 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2615 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.2226 | Train Acc: 0.9380
 Site-USPS      | Train Loss: 0.3691 | Train Acc: 0.8541
 Site-USPS      | Train Loss: 0.2907 | Train Acc: 0.9310
 Site-USPS      | Train Loss: 0.3100 | Train Acc: 0.9167
 Site-SynthDigits| Train Loss: 0.7160 | Train Acc: 0.7616
 Site-SynthDigits| Train Loss: 0.5889 | Train Acc: 0.8791
 Site-SynthDigits| Train Loss: 0.5261 | Train Acc: 0.8778
 Site-MNIST-M   | Train Loss: 0.8724 | Train Acc: 0.7569
 Site-MNIST-M   | Train Loss: 0.8180 | Train Acc: 0.7645
 Site-SVHN      | Train Loss: 1.1128 | Train Acc: 0.6312
 Site-MNIST     | Val  Loss: 0.0219 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0460 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3917 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4768 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3260 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2226 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2004 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2100 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.2921 | Val  Acc: 0.9235
 Site-MNIST     | Val  Loss: 0.2759 | Val  Acc: 0.9275
 Site-USPS      | Val  Loss: 0.1813 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5314 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.5771 | Val  Acc: 0.7188
 Site-USPS      | Val  Loss: 0.5154 | Val  Acc: 0.7586
 Site-USPS      | Val  Loss: 0.4068 | Val  Acc: 0.8381
 Site-USPS      | Val  Loss: 0.3159 | Val  Acc: 0.9048
 Site-SynthDigits| Val  Loss: 0.5679 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.4246 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.5394 | Val  Acc: 0.8607
 Site-MNIST-M   | Val  Loss: 0.9155 | Val  Acc: 0.7556
 Site-MNIST-M   | Val  Loss: 0.8053 | Val  Acc: 0.8148
 Site-SVHN      | Val  Loss: 0.7260 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8626
Aggregated Acc | Val Acc: 0.8684
============ Train epoch 26 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-2
cnt=[9, 9, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5462 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3429 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1349 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1457 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2142 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.2229 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.2086 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2623 | Train Acc: 0.9242
 Site-MNIST     | Train Loss: 0.2519 | Train Acc: 0.9307
 Site-MNIST     | Train Loss: 0.2176 | Train Acc: 0.9525
 Site-USPS      | Train Loss: 0.2514 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.3033 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.5161 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.3634 | Train Acc: 0.8670
 Site-USPS      | Train Loss: 0.2776 | Train Acc: 0.9405
 Site-USPS      | Train Loss: 0.2894 | Train Acc: 0.9180
 Site-SynthDigits| Train Loss: 0.6645 | Train Acc: 0.7682
 Site-SynthDigits| Train Loss: 0.5695 | Train Acc: 0.8718
 Site-SynthDigits| Train Loss: 0.5305 | Train Acc: 0.8758
 Site-MNIST-M   | Train Loss: 0.8802 | Train Acc: 0.7569
 Site-MNIST-M   | Train Loss: 0.8277 | Train Acc: 0.7370
 Site-SVHN      | Train Loss: 1.0670 | Train Acc: 0.6560
 Site-MNIST     | Val  Loss: 0.0208 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0432 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3544 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4397 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3047 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2153 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1997 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2062 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.2866 | Val  Acc: 0.9235
 Site-MNIST     | Val  Loss: 0.2702 | Val  Acc: 0.9275
 Site-USPS      | Val  Loss: 0.1607 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5015 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.5368 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.4886 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.3870 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.2962 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5806 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.4355 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.5513 | Val  Acc: 0.8525
 Site-MNIST-M   | Val  Loss: 0.9179 | Val  Acc: 0.7778
 Site-MNIST-M   | Val  Loss: 0.8003 | Val  Acc: 0.8148
 Site-SVHN      | Val  Loss: 0.7184 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8682
Aggregated Acc | Val Acc: 0.8556
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9235
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9275
 Best site-USPS       | Epoch:26 | Val Acc: 0.9000
 Best site-USPS       | Epoch:26 | Val Acc: 0.7778
 Best site-USPS       | Epoch:26 | Val Acc: 0.7500
 Best site-USPS       | Epoch:26 | Val Acc: 0.7931
 Best site-USPS       | Epoch:26 | Val Acc: 0.8571
 Best site-USPS       | Epoch:26 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.9118
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8525
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.7778
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.8148
 Best site-SVHN       | Epoch:26 | Val Acc: 0.7286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 27 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5469 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3205 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1236 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1437 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.3830 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.2075 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2149 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2633 | Train Acc: 0.9291
 Site-MNIST     | Train Loss: 0.2533 | Train Acc: 0.9321
 Site-MNIST     | Train Loss: 0.2086 | Train Acc: 0.9502
 Site-USPS      | Train Loss: 0.2505 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2430 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1984 | Train Acc: 0.9302
 Site-USPS      | Train Loss: 0.3444 | Train Acc: 0.8755
 Site-USPS      | Train Loss: 0.2695 | Train Acc: 0.9405
 Site-USPS      | Train Loss: 0.2876 | Train Acc: 0.9193
 Site-SynthDigits| Train Loss: 0.6874 | Train Acc: 0.7815
 Site-SynthDigits| Train Loss: 0.5770 | Train Acc: 0.8608
 Site-SynthDigits| Train Loss: 0.5081 | Train Acc: 0.8900
 Site-MNIST-M   | Train Loss: 0.8678 | Train Acc: 0.7569
 Site-MNIST-M   | Train Loss: 0.9404 | Train Acc: 0.7462
 Site-SVHN      | Train Loss: 1.0077 | Train Acc: 0.6525
 Site-MNIST     | Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0445 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3892 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4618 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3137 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2073 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1888 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1972 | Val  Acc: 0.9412
 Site-MNIST     | Val  Loss: 0.2780 | Val  Acc: 0.9235
 Site-MNIST     | Val  Loss: 0.2628 | Val  Acc: 0.9275
 Site-USPS      | Val  Loss: 0.1654 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.4927 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5406 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.4831 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.3852 | Val  Acc: 0.8667
 Site-USPS      | Val  Loss: 0.2930 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5596 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.4186 | Val  Acc: 0.8971
 Site-SynthDigits| Val  Loss: 0.5388 | Val  Acc: 0.8770
 Site-MNIST-M   | Val  Loss: 0.9015 | Val  Acc: 0.7778
 Site-MNIST-M   | Val  Loss: 0.7912 | Val  Acc: 0.8148
 Site-SVHN      | Val  Loss: 0.6828 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8716
Aggregated Acc | Val Acc: 0.8314
 Best site-MNIST      | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:27 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9412
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9235
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9275
 Best site-USPS       | Epoch:27 | Val Acc: 0.9000
 Best site-USPS       | Epoch:27 | Val Acc: 0.8333
 Best site-USPS       | Epoch:27 | Val Acc: 0.7500
 Best site-USPS       | Epoch:27 | Val Acc: 0.7931
 Best site-USPS       | Epoch:27 | Val Acc: 0.8667
 Best site-USPS       | Epoch:27 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8971
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8770
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.7778
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.8148
 Best site-SVHN       | Epoch:27 | Val Acc: 0.7286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 28 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-2
client-20 is in G-2
client-21 is in G-3
cnt=[10, 6, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5628 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3133 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1278 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1368 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1813 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.2065 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.2178 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2868 | Train Acc: 0.9291
 Site-MNIST     | Train Loss: 0.2398 | Train Acc: 0.9334
 Site-MNIST     | Train Loss: 0.2044 | Train Acc: 0.9547
 Site-USPS      | Train Loss: 0.2515 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2536 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1946 | Train Acc: 0.9380
 Site-USPS      | Train Loss: 0.3429 | Train Acc: 0.8712
 Site-USPS      | Train Loss: 0.2612 | Train Acc: 0.9476
 Site-USPS      | Train Loss: 0.2874 | Train Acc: 0.9153
 Site-SynthDigits| Train Loss: 0.6687 | Train Acc: 0.7947
 Site-SynthDigits| Train Loss: 0.5568 | Train Acc: 0.8718
 Site-SynthDigits| Train Loss: 0.5009 | Train Acc: 0.8798
 Site-MNIST-M   | Train Loss: 0.8301 | Train Acc: 0.7680
 Site-MNIST-M   | Train Loss: 0.7726 | Train Acc: 0.7829
 Site-SVHN      | Train Loss: 1.0631 | Train Acc: 0.6702
 Site-MNIST     | Val  Loss: 0.0195 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0464 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3972 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4678 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3117 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2031 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1819 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1918 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2720 | Val  Acc: 0.9290
 Site-MNIST     | Val  Loss: 0.2590 | Val  Acc: 0.9275
 Site-USPS      | Val  Loss: 0.1656 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.4876 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.5424 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.4767 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.3859 | Val  Acc: 0.8667
 Site-USPS      | Val  Loss: 0.2971 | Val  Acc: 0.9048
 Site-SynthDigits| Val  Loss: 0.5425 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.4014 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.5201 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.8804 | Val  Acc: 0.7556
 Site-MNIST-M   | Val  Loss: 0.7807 | Val  Acc: 0.8272
 Site-SVHN      | Val  Loss: 0.6628 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8736
Aggregated Acc | Val Acc: 0.8398
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9510
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9290
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9275
 Best site-USPS       | Epoch:28 | Val Acc: 0.9000
 Best site-USPS       | Epoch:28 | Val Acc: 0.7778
 Best site-USPS       | Epoch:28 | Val Acc: 0.7500
 Best site-USPS       | Epoch:28 | Val Acc: 0.7759
 Best site-USPS       | Epoch:28 | Val Acc: 0.8667
 Best site-USPS       | Epoch:28 | Val Acc: 0.9048
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9265
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8852
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.7556
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.8272
 Best site-SVHN       | Epoch:28 | Val Acc: 0.7571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 29 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5491 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3191 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1285 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1395 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.4022 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.2066 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.2209 | Train Acc: 0.9515
 Site-MNIST     | Train Loss: 0.2606 | Train Acc: 0.9242
 Site-MNIST     | Train Loss: 0.2375 | Train Acc: 0.9348
 Site-MNIST     | Train Loss: 0.2033 | Train Acc: 0.9532
 Site-USPS      | Train Loss: 0.2407 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2564 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1827 | Train Acc: 0.9380
 Site-USPS      | Train Loss: 0.3518 | Train Acc: 0.8627
 Site-USPS      | Train Loss: 0.2608 | Train Acc: 0.9405
 Site-USPS      | Train Loss: 0.2809 | Train Acc: 0.9272
 Site-SynthDigits| Train Loss: 0.6626 | Train Acc: 0.7815
 Site-SynthDigits| Train Loss: 0.5499 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.4900 | Train Acc: 0.8839
 Site-MNIST-M   | Train Loss: 0.8455 | Train Acc: 0.7680
 Site-MNIST-M   | Train Loss: 0.8401 | Train Acc: 0.7706
 Site-SVHN      | Train Loss: 1.0072 | Train Acc: 0.6596
 Site-MNIST     | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0430 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3999 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4719 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3136 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.2019 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1802 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1890 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2706 | Val  Acc: 0.9290
 Site-MNIST     | Val  Loss: 0.2568 | Val  Acc: 0.9275
 Site-USPS      | Val  Loss: 0.1469 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.4704 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.5184 | Val  Acc: 0.7812
 Site-USPS      | Val  Loss: 0.4693 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.3755 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.2867 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.5250 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3899 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.5021 | Val  Acc: 0.8770
 Site-MNIST-M   | Val  Loss: 0.8660 | Val  Acc: 0.7556
 Site-MNIST-M   | Val  Loss: 0.7629 | Val  Acc: 0.8148
 Site-SVHN      | Val  Loss: 0.6644 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8751
Aggregated Acc | Val Acc: 0.8407
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:29 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9510
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9290
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9275
 Best site-USPS       | Epoch:29 | Val Acc: 0.9000
 Best site-USPS       | Epoch:29 | Val Acc: 0.7778
 Best site-USPS       | Epoch:29 | Val Acc: 0.7812
 Best site-USPS       | Epoch:29 | Val Acc: 0.7759
 Best site-USPS       | Epoch:29 | Val Acc: 0.8571
 Best site-USPS       | Epoch:29 | Val Acc: 0.9101
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.9265
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.8770
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.7556
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.8148
 Best site-SVHN       | Epoch:29 | Val Acc: 0.7571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.9344
 Test site-USPS      | Epoch:29 | Test Acc: 0.9290
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.8536
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.6894
 Test site-SVHN      | Epoch:29 | Test Acc: 0.6006
Average Test Accuracy: 0.8014
============ Train epoch 30 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-0
cnt=[4, 9, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5422 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3033 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1309 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1351 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.4052 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.2014 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.1822 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2489 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.2290 | Train Acc: 0.9375
 Site-MNIST     | Train Loss: 0.1989 | Train Acc: 0.9502
 Site-USPS      | Train Loss: 0.2300 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2660 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.2057 | Train Acc: 0.9535
 Site-USPS      | Train Loss: 0.3393 | Train Acc: 0.8670
 Site-USPS      | Train Loss: 0.2590 | Train Acc: 0.9429
 Site-USPS      | Train Loss: 0.2762 | Train Acc: 0.9233
 Site-SynthDigits| Train Loss: 0.6079 | Train Acc: 0.7616
 Site-SynthDigits| Train Loss: 0.5384 | Train Acc: 0.8901
 Site-SynthDigits| Train Loss: 0.4726 | Train Acc: 0.8941
 Site-MNIST-M   | Train Loss: 0.8115 | Train Acc: 0.7956
 Site-MNIST-M   | Train Loss: 0.6915 | Train Acc: 0.7829
 Site-SVHN      | Train Loss: 0.9726 | Train Acc: 0.6560
 Site-MNIST     | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0449 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4049 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4664 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.3060 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1921 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1727 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1817 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2628 | Val  Acc: 0.9290
 Site-MNIST     | Val  Loss: 0.2494 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.1463 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.4677 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.5177 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.4625 | Val  Acc: 0.7759
 Site-USPS      | Val  Loss: 0.3721 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.2847 | Val  Acc: 0.8995
 Site-SynthDigits| Val  Loss: 0.5048 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3575 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.4795 | Val  Acc: 0.8770
 Site-MNIST-M   | Val  Loss: 0.8320 | Val  Acc: 0.7778
 Site-MNIST-M   | Val  Loss: 0.7300 | Val  Acc: 0.8395
 Site-SVHN      | Val  Loss: 0.6553 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8748
Aggregated Acc | Val Acc: 0.8826
============ Train epoch 31 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-2
client-20 is in G-2
client-21 is in G-3
cnt=[10, 6, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5508 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.3004 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1262 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1301 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2668 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1983 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.1789 | Train Acc: 0.9515
 Site-MNIST     | Train Loss: 0.2352 | Train Acc: 0.9364
 Site-MNIST     | Train Loss: 0.2296 | Train Acc: 0.9389
 Site-MNIST     | Train Loss: 0.1954 | Train Acc: 0.9517
 Site-USPS      | Train Loss: 0.2296 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2079 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 1.2515 | Train Acc: 0.9535
 Site-USPS      | Train Loss: 0.3233 | Train Acc: 0.8798
 Site-USPS      | Train Loss: 0.2465 | Train Acc: 0.9405
 Site-USPS      | Train Loss: 0.2679 | Train Acc: 0.9259
 Site-SynthDigits| Train Loss: 0.6273 | Train Acc: 0.7682
 Site-SynthDigits| Train Loss: 0.5867 | Train Acc: 0.8828
 Site-SynthDigits| Train Loss: 0.4636 | Train Acc: 0.9002
 Site-MNIST-M   | Train Loss: 0.8147 | Train Acc: 0.7735
 Site-MNIST-M   | Train Loss: 0.6786 | Train Acc: 0.8012
 Site-SVHN      | Train Loss: 0.9324 | Train Acc: 0.6702
 Site-MNIST     | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0437 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3814 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4405 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2928 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1855 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1703 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1785 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2593 | Val  Acc: 0.9290
 Site-MNIST     | Val  Loss: 0.2465 | Val  Acc: 0.9275
 Site-USPS      | Val  Loss: 0.1268 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.4474 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4972 | Val  Acc: 0.7812
 Site-USPS      | Val  Loss: 0.4477 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.3606 | Val  Acc: 0.8762
 Site-USPS      | Val  Loss: 0.2761 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.4988 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3504 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.4724 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.8331 | Val  Acc: 0.8000
 Site-MNIST-M   | Val  Loss: 0.7289 | Val  Acc: 0.8395
 Site-SVHN      | Val  Loss: 0.6371 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8853
Aggregated Acc | Val Acc: 0.8478
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9510
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9290
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9275
 Best site-USPS       | Epoch:31 | Val Acc: 1.0000
 Best site-USPS       | Epoch:31 | Val Acc: 0.8333
 Best site-USPS       | Epoch:31 | Val Acc: 0.7812
 Best site-USPS       | Epoch:31 | Val Acc: 0.7931
 Best site-USPS       | Epoch:31 | Val Acc: 0.8762
 Best site-USPS       | Epoch:31 | Val Acc: 0.9101
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.9118
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.8852
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.8395
 Best site-SVHN       | Epoch:31 | Val Acc: 0.7286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 32 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5373 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2947 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1350 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1272 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.3530 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.2034 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.2031 | Train Acc: 0.9471
 Site-MNIST     | Train Loss: 0.2439 | Train Acc: 0.9340
 Site-MNIST     | Train Loss: 0.2303 | Train Acc: 0.9402
 Site-MNIST     | Train Loss: 0.1954 | Train Acc: 0.9494
 Site-USPS      | Train Loss: 0.2141 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2244 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1757 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.3050 | Train Acc: 0.8755
 Site-USPS      | Train Loss: 0.2476 | Train Acc: 0.9476
 Site-USPS      | Train Loss: 0.2611 | Train Acc: 0.9259
 Site-SynthDigits| Train Loss: 0.5751 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 0.4695 | Train Acc: 0.8828
 Site-SynthDigits| Train Loss: 0.4494 | Train Acc: 0.8839
 Site-MNIST-M   | Train Loss: 0.7679 | Train Acc: 0.7956
 Site-MNIST-M   | Train Loss: 0.7773 | Train Acc: 0.7737
 Site-SVHN      | Train Loss: 0.9776 | Train Acc: 0.6596
 Site-MNIST     | Val  Loss: 0.0119 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3627 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4233 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2811 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1851 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1727 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1793 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2576 | Val  Acc: 0.9344
 Site-MNIST     | Val  Loss: 0.2463 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.1318 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.4480 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.4763 | Val  Acc: 0.8125
 Site-USPS      | Val  Loss: 0.4405 | Val  Acc: 0.8103
 Site-USPS      | Val  Loss: 0.3586 | Val  Acc: 0.8667
 Site-USPS      | Val  Loss: 0.2718 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 0.4827 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3375 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.4649 | Val  Acc: 0.8770
 Site-MNIST-M   | Val  Loss: 0.8166 | Val  Acc: 0.8000
 Site-MNIST-M   | Val  Loss: 0.7251 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.6190 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8806
Aggregated Acc | Val Acc: 0.8453
============ Train epoch 33 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5261 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2868 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1302 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1248 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1700 | Train Acc: 0.8857
 Site-MNIST     | Train Loss: 0.1930 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.1873 | Train Acc: 0.9471
 Site-MNIST     | Train Loss: 0.2353 | Train Acc: 0.9364
 Site-MNIST     | Train Loss: 0.2240 | Train Acc: 0.9389
 Site-MNIST     | Train Loss: 0.1879 | Train Acc: 0.9509
 Site-USPS      | Train Loss: 0.2269 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2049 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1868 | Train Acc: 0.9380
 Site-USPS      | Train Loss: 0.3100 | Train Acc: 0.8712
 Site-USPS      | Train Loss: 0.2324 | Train Acc: 0.9548
 Site-USPS      | Train Loss: 0.2611 | Train Acc: 0.9286
 Site-SynthDigits| Train Loss: 0.5527 | Train Acc: 0.7815
 Site-SynthDigits| Train Loss: 0.5154 | Train Acc: 0.8791
 Site-SynthDigits| Train Loss: 0.4429 | Train Acc: 0.9022
 Site-MNIST-M   | Train Loss: 0.7764 | Train Acc: 0.7901
 Site-MNIST-M   | Train Loss: 0.6716 | Train Acc: 0.7676
 Site-SVHN      | Train Loss: 0.9425 | Train Acc: 0.6738
 Site-MNIST     | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3793 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4372 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2845 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1779 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1644 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1723 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2515 | Val  Acc: 0.9344
 Site-MNIST     | Val  Loss: 0.2394 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.1398 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.4487 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.4824 | Val  Acc: 0.7812
 Site-USPS      | Val  Loss: 0.4370 | Val  Acc: 0.8103
 Site-USPS      | Val  Loss: 0.3566 | Val  Acc: 0.8762
 Site-USPS      | Val  Loss: 0.2684 | Val  Acc: 0.8995
 Site-SynthDigits| Val  Loss: 0.4786 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3373 | Val  Acc: 0.8971
 Site-SynthDigits| Val  Loss: 0.4651 | Val  Acc: 0.8770
 Site-MNIST-M   | Val  Loss: 0.8047 | Val  Acc: 0.8222
 Site-MNIST-M   | Val  Loss: 0.7103 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.6142 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8808
Aggregated Acc | Val Acc: 0.8507
============ Train epoch 34 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5235 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2793 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1205 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1205 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.4085 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1814 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1732 | Train Acc: 0.9515
 Site-MNIST     | Train Loss: 0.2309 | Train Acc: 0.9413
 Site-MNIST     | Train Loss: 0.2271 | Train Acc: 0.9389
 Site-MNIST     | Train Loss: 0.1816 | Train Acc: 0.9547
 Site-USPS      | Train Loss: 0.2180 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2139 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1562 | Train Acc: 0.9535
 Site-USPS      | Train Loss: 0.3185 | Train Acc: 0.8798
 Site-USPS      | Train Loss: 0.2304 | Train Acc: 0.9571
 Site-USPS      | Train Loss: 0.2558 | Train Acc: 0.9259
 Site-SynthDigits| Train Loss: 0.6353 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 0.5530 | Train Acc: 0.8791
 Site-SynthDigits| Train Loss: 0.4438 | Train Acc: 0.8982
 Site-MNIST-M   | Train Loss: 0.7512 | Train Acc: 0.7901
 Site-MNIST-M   | Train Loss: 0.6915 | Train Acc: 0.7768
 Site-SVHN      | Train Loss: 0.9573 | Train Acc: 0.6915
 Site-MNIST     | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3954 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4465 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2868 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1730 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1565 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1658 | Val  Acc: 0.9608
 Site-MNIST     | Val  Loss: 0.2458 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2331 | Val  Acc: 0.9366
 Site-USPS      | Val  Loss: 0.1397 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.4402 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.4785 | Val  Acc: 0.7812
 Site-USPS      | Val  Loss: 0.4321 | Val  Acc: 0.8103
 Site-USPS      | Val  Loss: 0.3503 | Val  Acc: 0.8762
 Site-USPS      | Val  Loss: 0.2655 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.4770 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3315 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.4601 | Val  Acc: 0.8934
 Site-MNIST-M   | Val  Loss: 0.7974 | Val  Acc: 0.8000
 Site-MNIST-M   | Val  Loss: 0.7021 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.5937 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8826
Aggregated Acc | Val Acc: 0.8513
============ Train epoch 35 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5262 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2681 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1242 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1175 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2948 | Train Acc: 0.8857
 Site-MNIST     | Train Loss: 0.1839 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.1762 | Train Acc: 0.9471
 Site-MNIST     | Train Loss: 0.2480 | Train Acc: 0.9364
 Site-MNIST     | Train Loss: 0.2188 | Train Acc: 0.9416
 Site-MNIST     | Train Loss: 0.1803 | Train Acc: 0.9540
 Site-USPS      | Train Loss: 0.2214 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.5037 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1549 | Train Acc: 0.9380
 Site-USPS      | Train Loss: 0.3085 | Train Acc: 0.8712
 Site-USPS      | Train Loss: 0.2361 | Train Acc: 0.9524
 Site-USPS      | Train Loss: 0.2570 | Train Acc: 0.9259
 Site-SynthDigits| Train Loss: 0.6183 | Train Acc: 0.8013
 Site-SynthDigits| Train Loss: 0.5044 | Train Acc: 0.8791
 Site-SynthDigits| Train Loss: 0.4291 | Train Acc: 0.8982
 Site-MNIST-M   | Train Loss: 0.7485 | Train Acc: 0.7790
 Site-MNIST-M   | Train Loss: 0.6923 | Train Acc: 0.7859
 Site-SVHN      | Train Loss: 0.8775 | Train Acc: 0.7092
 Site-MNIST     | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0369 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3836 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4284 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2755 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1684 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1570 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1654 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2448 | Val  Acc: 0.9344
 Site-MNIST     | Val  Loss: 0.2329 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.1306 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.4237 | Val  Acc: 0.7778
 Site-USPS      | Val  Loss: 0.4640 | Val  Acc: 0.7812
 Site-USPS      | Val  Loss: 0.4249 | Val  Acc: 0.8103
 Site-USPS      | Val  Loss: 0.3516 | Val  Acc: 0.8667
 Site-USPS      | Val  Loss: 0.2690 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 0.4582 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3173 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.4448 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.7897 | Val  Acc: 0.7778
 Site-MNIST-M   | Val  Loss: 0.6993 | Val  Acc: 0.8148
 Site-SVHN      | Val  Loss: 0.5954 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8775
Aggregated Acc | Val Acc: 0.8436
============ Train epoch 36 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-1
cnt=[1, 4, 6, 2, 9, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5193 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2762 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1226 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1142 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.4785 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1806 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.1729 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2221 | Train Acc: 0.9364
 Site-MNIST     | Train Loss: 0.2207 | Train Acc: 0.9416
 Site-MNIST     | Train Loss: 0.1775 | Train Acc: 0.9540
 Site-USPS      | Train Loss: 0.2107 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.1820 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.5811 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2988 | Train Acc: 0.8712
 Site-USPS      | Train Loss: 0.2178 | Train Acc: 0.9548
 Site-USPS      | Train Loss: 0.2534 | Train Acc: 0.9259
 Site-SynthDigits| Train Loss: 0.5674 | Train Acc: 0.8013
 Site-SynthDigits| Train Loss: 0.4511 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.4134 | Train Acc: 0.9002
 Site-MNIST-M   | Train Loss: 0.7255 | Train Acc: 0.7956
 Site-MNIST-M   | Train Loss: 0.7019 | Train Acc: 0.7859
 Site-SVHN      | Train Loss: 0.9211 | Train Acc: 0.6915
 Site-MNIST     | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3645 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4166 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2670 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1647 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1548 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1635 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2419 | Val  Acc: 0.9344
 Site-MNIST     | Val  Loss: 0.2300 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.1176 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.4183 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4586 | Val  Acc: 0.7812
 Site-USPS      | Val  Loss: 0.4148 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.3450 | Val  Acc: 0.8476
 Site-USPS      | Val  Loss: 0.2627 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.4358 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3013 | Val  Acc: 0.8971
 Site-SynthDigits| Val  Loss: 0.4236 | Val  Acc: 0.8770
 Site-MNIST-M   | Val  Loss: 0.7555 | Val  Acc: 0.7778
 Site-MNIST-M   | Val  Loss: 0.6757 | Val  Acc: 0.8642
 Site-SVHN      | Val  Loss: 0.5979 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8832
Aggregated Acc | Val Acc: 0.8899
============ Train epoch 37 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-2
client-20 is in G-2
client-21 is in G-3
cnt=[6, 10, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5319 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2706 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1072 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1182 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2183 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1707 | Train Acc: 0.9603
 Site-MNIST     | Train Loss: 0.1680 | Train Acc: 0.9515
 Site-MNIST     | Train Loss: 0.2152 | Train Acc: 0.9462
 Site-MNIST     | Train Loss: 0.2089 | Train Acc: 0.9402
 Site-MNIST     | Train Loss: 0.1728 | Train Acc: 0.9562
 Site-USPS      | Train Loss: 0.2009 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.1581 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1589 | Train Acc: 0.9535
 Site-USPS      | Train Loss: 0.2960 | Train Acc: 0.8970
 Site-USPS      | Train Loss: 0.2138 | Train Acc: 0.9524
 Site-USPS      | Train Loss: 0.2410 | Train Acc: 0.9286
 Site-SynthDigits| Train Loss: 0.6076 | Train Acc: 0.8013
 Site-SynthDigits| Train Loss: 0.4546 | Train Acc: 0.8901
 Site-SynthDigits| Train Loss: 0.4127 | Train Acc: 0.8982
 Site-MNIST-M   | Train Loss: 0.7159 | Train Acc: 0.7956
 Site-MNIST-M   | Train Loss: 0.6289 | Train Acc: 0.7920
 Site-SVHN      | Train Loss: 0.8728 | Train Acc: 0.7163
 Site-MNIST     | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0327 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3506 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4046 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2598 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1606 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1517 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1605 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2378 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2259 | Val  Acc: 0.9366
 Site-USPS      | Val  Loss: 0.1084 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.4038 | Val  Acc: 0.8889
 Site-USPS      | Val  Loss: 0.4415 | Val  Acc: 0.8125
 Site-USPS      | Val  Loss: 0.3973 | Val  Acc: 0.8276
 Site-USPS      | Val  Loss: 0.3288 | Val  Acc: 0.8952
 Site-USPS      | Val  Loss: 0.2518 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.4428 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3161 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.4368 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.7529 | Val  Acc: 0.8222
 Site-MNIST-M   | Val  Loss: 0.6648 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.5764 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8955
Aggregated Acc | Val Acc: 0.8621
 Best site-MNIST      | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:37 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9510
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9399
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9366
 Best site-USPS       | Epoch:37 | Val Acc: 1.0000
 Best site-USPS       | Epoch:37 | Val Acc: 0.8889
 Best site-USPS       | Epoch:37 | Val Acc: 0.8125
 Best site-USPS       | Epoch:37 | Val Acc: 0.8276
 Best site-USPS       | Epoch:37 | Val Acc: 0.8952
 Best site-USPS       | Epoch:37 | Val Acc: 0.9101
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.9118
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.8852
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.8222
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.8519
 Best site-SVHN       | Epoch:37 | Val Acc: 0.7571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 38 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[1, 6, 9, 2, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5182 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2624 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1216 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1126 | Train Acc: 0.9737
 Site-MNIST     | Train Loss: 0.1657 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.1739 | Train Acc: 0.9444
 Site-MNIST     | Train Loss: 0.1665 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2187 | Train Acc: 0.9389
 Site-MNIST     | Train Loss: 0.2064 | Train Acc: 0.9443
 Site-MNIST     | Train Loss: 0.1725 | Train Acc: 0.9532
 Site-USPS      | Train Loss: 0.2091 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2036 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.1493 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2975 | Train Acc: 0.8712
 Site-USPS      | Train Loss: 0.2141 | Train Acc: 0.9476
 Site-USPS      | Train Loss: 0.2448 | Train Acc: 0.9259
 Site-SynthDigits| Train Loss: 0.5451 | Train Acc: 0.8079
 Site-SynthDigits| Train Loss: 0.4652 | Train Acc: 0.8901
 Site-SynthDigits| Train Loss: 0.4109 | Train Acc: 0.9043
 Site-MNIST-M   | Train Loss: 0.6784 | Train Acc: 0.8177
 Site-MNIST-M   | Train Loss: 0.6315 | Train Acc: 0.8043
 Site-SVHN      | Train Loss: 0.8673 | Train Acc: 0.6950
 Site-MNIST     | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3729 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4090 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2617 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1564 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1490 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1588 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2359 | Val  Acc: 0.9344
 Site-MNIST     | Val  Loss: 0.2270 | Val  Acc: 0.9305
 Site-USPS      | Val  Loss: 0.1065 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.4001 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4422 | Val  Acc: 0.8125
 Site-USPS      | Val  Loss: 0.4031 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.3340 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.2559 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 0.4305 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2994 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.4173 | Val  Acc: 0.8770
 Site-MNIST-M   | Val  Loss: 0.7392 | Val  Acc: 0.8000
 Site-MNIST-M   | Val  Loss: 0.6558 | Val  Acc: 0.8642
 Site-SVHN      | Val  Loss: 0.5594 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8876
Aggregated Acc | Val Acc: 0.8951
============ Train epoch 39 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-2
client-20 is in G-2
client-21 is in G-3
cnt=[9, 6, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5104 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2576 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1125 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1104 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1870 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1658 | Train Acc: 0.9603
 Site-MNIST     | Train Loss: 0.1568 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2275 | Train Acc: 0.9438
 Site-MNIST     | Train Loss: 0.2049 | Train Acc: 0.9457
 Site-MNIST     | Train Loss: 0.1682 | Train Acc: 0.9562
 Site-USPS      | Train Loss: 0.2070 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.1888 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.1430 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2866 | Train Acc: 0.8798
 Site-USPS      | Train Loss: 0.2141 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.2388 | Train Acc: 0.9325
 Site-SynthDigits| Train Loss: 0.5632 | Train Acc: 0.8013
 Site-SynthDigits| Train Loss: 0.4182 | Train Acc: 0.8938
 Site-SynthDigits| Train Loss: 0.3917 | Train Acc: 0.9084
 Site-MNIST-M   | Train Loss: 0.6775 | Train Acc: 0.8122
 Site-MNIST-M   | Train Loss: 0.6510 | Train Acc: 0.8043
 Site-SVHN      | Train Loss: 0.8670 | Train Acc: 0.6986
 Site-MNIST     | Val  Loss: 0.0110 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0308 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3797 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4084 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2589 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1497 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1423 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1530 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2313 | Val  Acc: 0.9344
 Site-MNIST     | Val  Loss: 0.2215 | Val  Acc: 0.9335
 Site-USPS      | Val  Loss: 0.1036 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3937 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4310 | Val  Acc: 0.8125
 Site-USPS      | Val  Loss: 0.3917 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.3273 | Val  Acc: 0.8667
 Site-USPS      | Val  Loss: 0.2493 | Val  Acc: 0.8995
 Site-SynthDigits| Val  Loss: 0.4115 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2901 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.4080 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.7326 | Val  Acc: 0.8000
 Site-MNIST-M   | Val  Loss: 0.6444 | Val  Acc: 0.8642
 Site-SVHN      | Val  Loss: 0.5649 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8901
Aggregated Acc | Val Acc: 0.8975
============ Train epoch 40 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[6, 9, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5051 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2518 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1053 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1071 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2135 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1609 | Train Acc: 0.9603
 Site-MNIST     | Train Loss: 0.1694 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2278 | Train Acc: 0.9487
 Site-MNIST     | Train Loss: 0.1975 | Train Acc: 0.9443
 Site-MNIST     | Train Loss: 0.1639 | Train Acc: 0.9577
 Site-USPS      | Train Loss: 0.2028 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.1930 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.3253 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2889 | Train Acc: 0.8841
 Site-USPS      | Train Loss: 0.2095 | Train Acc: 0.9571
 Site-USPS      | Train Loss: 0.2362 | Train Acc: 0.9259
 Site-SynthDigits| Train Loss: 0.5717 | Train Acc: 0.8079
 Site-SynthDigits| Train Loss: 0.4265 | Train Acc: 0.9084
 Site-SynthDigits| Train Loss: 0.3931 | Train Acc: 0.9063
 Site-MNIST-M   | Train Loss: 0.6720 | Train Acc: 0.8011
 Site-MNIST-M   | Train Loss: 0.6425 | Train Acc: 0.8226
 Site-SVHN      | Train Loss: 0.8732 | Train Acc: 0.6986
 Site-MNIST     | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3662 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4075 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2556 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1480 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1400 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1501 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2287 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2174 | Val  Acc: 0.9366
 Site-USPS      | Val  Loss: 0.0965 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3788 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4238 | Val  Acc: 0.8125
 Site-USPS      | Val  Loss: 0.3866 | Val  Acc: 0.7931
 Site-USPS      | Val  Loss: 0.3211 | Val  Acc: 0.8762
 Site-USPS      | Val  Loss: 0.2453 | Val  Acc: 0.8942
 Site-SynthDigits| Val  Loss: 0.4044 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2845 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.4030 | Val  Acc: 0.8934
 Site-MNIST-M   | Val  Loss: 0.7243 | Val  Acc: 0.8000
 Site-MNIST-M   | Val  Loss: 0.6426 | Val  Acc: 0.8642
 Site-SVHN      | Val  Loss: 0.5538 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8911
Aggregated Acc | Val Acc: 0.8982
============ Train epoch 41 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-2
cnt=[9, 6, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5101 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2462 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.1002 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1071 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1798 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1591 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1492 | Train Acc: 0.9515
 Site-MNIST     | Train Loss: 0.2055 | Train Acc: 0.9487
 Site-MNIST     | Train Loss: 0.1984 | Train Acc: 0.9429
 Site-MNIST     | Train Loss: 0.1611 | Train Acc: 0.9592
 Site-USPS      | Train Loss: 0.1966 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2760 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1421 | Train Acc: 0.9535
 Site-USPS      | Train Loss: 0.2685 | Train Acc: 0.9013
 Site-USPS      | Train Loss: 0.2006 | Train Acc: 0.9548
 Site-USPS      | Train Loss: 0.2275 | Train Acc: 0.9312
 Site-SynthDigits| Train Loss: 0.5231 | Train Acc: 0.8146
 Site-SynthDigits| Train Loss: 0.4046 | Train Acc: 0.8938
 Site-SynthDigits| Train Loss: 0.3857 | Train Acc: 0.9165
 Site-MNIST-M   | Train Loss: 0.6750 | Train Acc: 0.8011
 Site-MNIST-M   | Train Loss: 0.7217 | Train Acc: 0.8196
 Site-SVHN      | Train Loss: 0.8971 | Train Acc: 0.7021
 Site-MNIST     | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3475 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.3930 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2469 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1443 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1388 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1471 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2262 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2147 | Val  Acc: 0.9396
 Site-USPS      | Val  Loss: 0.0850 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3597 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4038 | Val  Acc: 0.8125
 Site-USPS      | Val  Loss: 0.3777 | Val  Acc: 0.8276
 Site-USPS      | Val  Loss: 0.3104 | Val  Acc: 0.9048
 Site-USPS      | Val  Loss: 0.2355 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.4009 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2752 | Val  Acc: 0.9412
 Site-SynthDigits| Val  Loss: 0.3963 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.7042 | Val  Acc: 0.8000
 Site-MNIST-M   | Val  Loss: 0.6256 | Val  Acc: 0.8642
 Site-SVHN      | Val  Loss: 0.5566 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8944
Aggregated Acc | Val Acc: 0.9005
============ Train epoch 42 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5133 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2405 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.0999 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1089 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1344 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1561 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1729 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.1969 | Train Acc: 0.9487
 Site-MNIST     | Train Loss: 0.1970 | Train Acc: 0.9497
 Site-MNIST     | Train Loss: 0.1607 | Train Acc: 0.9600
 Site-USPS      | Train Loss: 0.2032 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.3689 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1428 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2806 | Train Acc: 0.8970
 Site-USPS      | Train Loss: 0.2064 | Train Acc: 0.9548
 Site-USPS      | Train Loss: 0.2219 | Train Acc: 0.9352
 Site-SynthDigits| Train Loss: 0.5787 | Train Acc: 0.8278
 Site-SynthDigits| Train Loss: 0.4275 | Train Acc: 0.8974
 Site-SynthDigits| Train Loss: 0.3798 | Train Acc: 0.9084
 Site-MNIST-M   | Train Loss: 0.6530 | Train Acc: 0.8232
 Site-MNIST-M   | Train Loss: 0.5866 | Train Acc: 0.8043
 Site-SVHN      | Train Loss: 0.8463 | Train Acc: 0.7340
 Site-MNIST     | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3502 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.3980 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2488 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1447 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1371 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1456 | Val  Acc: 0.9608
 Site-MNIST     | Val  Loss: 0.2240 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2137 | Val  Acc: 0.9426
 Site-USPS      | Val  Loss: 0.0788 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3596 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.3993 | Val  Acc: 0.8125
 Site-USPS      | Val  Loss: 0.3744 | Val  Acc: 0.8276
 Site-USPS      | Val  Loss: 0.3042 | Val  Acc: 0.8952
 Site-USPS      | Val  Loss: 0.2311 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.4030 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2757 | Val  Acc: 0.9412
 Site-SynthDigits| Val  Loss: 0.3950 | Val  Acc: 0.8934
 Site-MNIST-M   | Val  Loss: 0.6902 | Val  Acc: 0.8000
 Site-MNIST-M   | Val  Loss: 0.6206 | Val  Acc: 0.8642
 Site-SVHN      | Val  Loss: 0.5338 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8952
Aggregated Acc | Val Acc: 0.8623
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5209 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2320 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.0969 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1047 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.3137 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1521 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1667 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.2028 | Train Acc: 0.9535
 Site-MNIST     | Train Loss: 0.1953 | Train Acc: 0.9443
 Site-MNIST     | Train Loss: 0.1566 | Train Acc: 0.9623
 Site-USPS      | Train Loss: 0.1993 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2220 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1347 | Train Acc: 0.9535
 Site-USPS      | Train Loss: 0.2696 | Train Acc: 0.8970
 Site-USPS      | Train Loss: 0.1980 | Train Acc: 0.9571
 Site-USPS      | Train Loss: 0.2228 | Train Acc: 0.9339
 Site-SynthDigits| Train Loss: 0.5511 | Train Acc: 0.8146
 Site-SynthDigits| Train Loss: 0.4058 | Train Acc: 0.8974
 Site-SynthDigits| Train Loss: 0.3705 | Train Acc: 0.9124
 Site-MNIST-M   | Train Loss: 0.6617 | Train Acc: 0.8011
 Site-MNIST-M   | Train Loss: 0.6027 | Train Acc: 0.8287
 Site-SVHN      | Train Loss: 0.7999 | Train Acc: 0.7305
 Site-MNIST     | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0324 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3468 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.3891 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2425 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1402 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1338 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1428 | Val  Acc: 0.9608
 Site-MNIST     | Val  Loss: 0.2214 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2106 | Val  Acc: 0.9426
 Site-USPS      | Val  Loss: 0.0840 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3643 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4047 | Val  Acc: 0.8125
 Site-USPS      | Val  Loss: 0.3679 | Val  Acc: 0.8276
 Site-USPS      | Val  Loss: 0.3075 | Val  Acc: 0.8857
 Site-USPS      | Val  Loss: 0.2351 | Val  Acc: 0.9048
 Site-SynthDigits| Val  Loss: 0.3971 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2787 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.3974 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.7244 | Val  Acc: 0.8222
 Site-MNIST-M   | Val  Loss: 0.6320 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.5242 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8930
Aggregated Acc | Val Acc: 0.8601
============ Train epoch 44 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 6, 10, 3, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5072 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2322 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.0912 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1020 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.2600 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1482 | Train Acc: 0.9762
 Site-MNIST     | Train Loss: 0.1720 | Train Acc: 0.9604
 Site-MNIST     | Train Loss: 0.1893 | Train Acc: 0.9535
 Site-MNIST     | Train Loss: 0.1937 | Train Acc: 0.9484
 Site-MNIST     | Train Loss: 0.1533 | Train Acc: 0.9623
 Site-USPS      | Train Loss: 0.2005 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2731 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.1315 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2593 | Train Acc: 0.9056
 Site-USPS      | Train Loss: 0.1986 | Train Acc: 0.9571
 Site-USPS      | Train Loss: 0.2189 | Train Acc: 0.9352
 Site-SynthDigits| Train Loss: 0.5351 | Train Acc: 0.8013
 Site-SynthDigits| Train Loss: 0.3840 | Train Acc: 0.8938
 Site-SynthDigits| Train Loss: 0.3746 | Train Acc: 0.9145
 Site-MNIST-M   | Train Loss: 0.6492 | Train Acc: 0.8122
 Site-MNIST-M   | Train Loss: 0.6753 | Train Acc: 0.8073
 Site-SVHN      | Train Loss: 0.8279 | Train Acc: 0.7411
 Site-MNIST     | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3508 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.3832 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2401 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1354 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1316 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1409 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2201 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2079 | Val  Acc: 0.9426
 Site-USPS      | Val  Loss: 0.0893 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3610 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.3964 | Val  Acc: 0.8438
 Site-USPS      | Val  Loss: 0.3668 | Val  Acc: 0.8448
 Site-USPS      | Val  Loss: 0.3074 | Val  Acc: 0.8857
 Site-USPS      | Val  Loss: 0.2319 | Val  Acc: 0.9206
 Site-SynthDigits| Val  Loss: 0.3827 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2679 | Val  Acc: 0.9118
 Site-SynthDigits| Val  Loss: 0.3875 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.7210 | Val  Acc: 0.8222
 Site-MNIST-M   | Val  Loss: 0.6241 | Val  Acc: 0.8395
 Site-SVHN      | Val  Loss: 0.5222 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8962
Aggregated Acc | Val Acc: 0.8665
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:44 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:44 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9510
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9399
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9426
 Best site-USPS       | Epoch:44 | Val Acc: 1.0000
 Best site-USPS       | Epoch:44 | Val Acc: 0.8333
 Best site-USPS       | Epoch:44 | Val Acc: 0.8438
 Best site-USPS       | Epoch:44 | Val Acc: 0.8448
 Best site-USPS       | Epoch:44 | Val Acc: 0.8857
 Best site-USPS       | Epoch:44 | Val Acc: 0.9206
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.9118
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.8852
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.8222
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.8395
 Best site-SVHN       | Epoch:44 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 45 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-2
client-20 is in G-2
client-21 is in G-3
cnt=[6, 9, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5013 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2303 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.0860 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1067 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1847 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1422 | Train Acc: 0.9762
 Site-MNIST     | Train Loss: 0.1502 | Train Acc: 0.9604
 Site-MNIST     | Train Loss: 0.1945 | Train Acc: 0.9535
 Site-MNIST     | Train Loss: 0.1846 | Train Acc: 0.9457
 Site-MNIST     | Train Loss: 0.1498 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1985 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2070 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1337 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2758 | Train Acc: 0.9056
 Site-USPS      | Train Loss: 0.1962 | Train Acc: 0.9571
 Site-USPS      | Train Loss: 0.2183 | Train Acc: 0.9312
 Site-SynthDigits| Train Loss: 0.4803 | Train Acc: 0.8146
 Site-SynthDigits| Train Loss: 0.3647 | Train Acc: 0.8938
 Site-SynthDigits| Train Loss: 0.3560 | Train Acc: 0.9185
 Site-MNIST-M   | Train Loss: 0.6364 | Train Acc: 0.8232
 Site-MNIST-M   | Train Loss: 0.5895 | Train Acc: 0.8226
 Site-SVHN      | Train Loss: 0.8574 | Train Acc: 0.7270
 Site-MNIST     | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3761 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.3956 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2480 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1333 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1310 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1397 | Val  Acc: 0.9510
 Site-MNIST     | Val  Loss: 0.2193 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2054 | Val  Acc: 0.9426
 Site-USPS      | Val  Loss: 0.0886 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3553 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.3963 | Val  Acc: 0.8438
 Site-USPS      | Val  Loss: 0.3644 | Val  Acc: 0.8621
 Site-USPS      | Val  Loss: 0.3033 | Val  Acc: 0.9048
 Site-USPS      | Val  Loss: 0.2270 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.3693 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2579 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.3745 | Val  Acc: 0.8852
 Site-MNIST-M   | Val  Loss: 0.6935 | Val  Acc: 0.8444
 Site-MNIST-M   | Val  Loss: 0.6106 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.5238 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8992
Aggregated Acc | Val Acc: 0.9062
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:45 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:45 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9510
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9399
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9426
 Best site-USPS       | Epoch:45 | Val Acc: 1.0000
 Best site-USPS       | Epoch:45 | Val Acc: 0.8333
 Best site-USPS       | Epoch:45 | Val Acc: 0.8438
 Best site-USPS       | Epoch:45 | Val Acc: 0.8621
 Best site-USPS       | Epoch:45 | Val Acc: 0.9048
 Best site-USPS       | Epoch:45 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.9265
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.8852
 Best site-MNIST-M    | Epoch:45 | Val Acc: 0.8444
 Best site-MNIST-M    | Epoch:45 | Val Acc: 0.8519
 Best site-SVHN       | Epoch:45 | Val Acc: 0.7714
 Test site-MNIST     | Epoch:45 | Test Acc: 0.9436
 Test site-USPS      | Epoch:45 | Test Acc: 0.9323
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.8828
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.7253
 Test site-SVHN      | Epoch:45 | Test Acc: 0.6346
Average Test Accuracy: 0.8237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 46 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5023 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2306 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.0824 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1056 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1316 | Train Acc: 0.9000
 Site-MNIST     | Train Loss: 0.1410 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1482 | Train Acc: 0.9604
 Site-MNIST     | Train Loss: 0.1961 | Train Acc: 0.9511
 Site-MNIST     | Train Loss: 0.1853 | Train Acc: 0.9470
 Site-MNIST     | Train Loss: 0.1492 | Train Acc: 0.9638
 Site-USPS      | Train Loss: 0.1904 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2073 | Train Acc: 0.9306
 Site-USPS      | Train Loss: 0.1315 | Train Acc: 0.9535
 Site-USPS      | Train Loss: 0.2540 | Train Acc: 0.9185
 Site-USPS      | Train Loss: 0.1889 | Train Acc: 0.9571
 Site-USPS      | Train Loss: 0.2116 | Train Acc: 0.9405
 Site-SynthDigits| Train Loss: 0.5297 | Train Acc: 0.8013
 Site-SynthDigits| Train Loss: 0.4129 | Train Acc: 0.9011
 Site-SynthDigits| Train Loss: 0.3558 | Train Acc: 0.9226
 Site-MNIST-M   | Train Loss: 0.6404 | Train Acc: 0.7956
 Site-MNIST-M   | Train Loss: 0.5524 | Train Acc: 0.8135
 Site-SVHN      | Train Loss: 0.7688 | Train Acc: 0.7482
 Site-MNIST     | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0315 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3671 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.3900 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2447 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1315 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1303 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1381 | Val  Acc: 0.9608
 Site-MNIST     | Val  Loss: 0.2182 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2037 | Val  Acc: 0.9456
 Site-USPS      | Val  Loss: 0.0866 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3516 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.3832 | Val  Acc: 0.8438
 Site-USPS      | Val  Loss: 0.3596 | Val  Acc: 0.8621
 Site-USPS      | Val  Loss: 0.2918 | Val  Acc: 0.9048
 Site-USPS      | Val  Loss: 0.2168 | Val  Acc: 0.9312
 Site-SynthDigits| Val  Loss: 0.3790 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2642 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.3824 | Val  Acc: 0.8934
 Site-MNIST-M   | Val  Loss: 0.7023 | Val  Acc: 0.8222
 Site-MNIST-M   | Val  Loss: 0.6073 | Val  Acc: 0.8395
 Site-SVHN      | Val  Loss: 0.5106 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8993
Aggregated Acc | Val Acc: 0.8670
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:46 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:46 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:46 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9608
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9399
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9456
 Best site-USPS       | Epoch:46 | Val Acc: 1.0000
 Best site-USPS       | Epoch:46 | Val Acc: 0.8333
 Best site-USPS       | Epoch:46 | Val Acc: 0.8438
 Best site-USPS       | Epoch:46 | Val Acc: 0.8621
 Best site-USPS       | Epoch:46 | Val Acc: 0.9048
 Best site-USPS       | Epoch:46 | Val Acc: 0.9312
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.9265
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.8934
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.8222
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.8395
 Best site-SVHN       | Epoch:46 | Val Acc: 0.7714
 Test site-MNIST     | Epoch:46 | Test Acc: 0.9431
 Test site-USPS      | Epoch:46 | Test Acc: 0.9333
 Test site-SynthDigits| Epoch:46 | Test Acc: 0.8821
 Test site-MNIST-M   | Epoch:46 | Test Acc: 0.7221
 Test site-SVHN      | Epoch:46 | Test Acc: 0.6453
Average Test Accuracy: 0.8252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 47 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[1, 6, 9, 2, 4, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4839 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2208 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.0865 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1074 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.3028 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.1399 | Train Acc: 0.9762
 Site-MNIST     | Train Loss: 0.1497 | Train Acc: 0.9604
 Site-MNIST     | Train Loss: 0.1969 | Train Acc: 0.9511
 Site-MNIST     | Train Loss: 0.1866 | Train Acc: 0.9443
 Site-MNIST     | Train Loss: 0.1468 | Train Acc: 0.9630
 Site-USPS      | Train Loss: 0.1854 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.1898 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.1261 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2599 | Train Acc: 0.9142
 Site-USPS      | Train Loss: 0.1938 | Train Acc: 0.9548
 Site-USPS      | Train Loss: 0.2140 | Train Acc: 0.9365
 Site-SynthDigits| Train Loss: 0.5333 | Train Acc: 0.8344
 Site-SynthDigits| Train Loss: 0.3935 | Train Acc: 0.9011
 Site-SynthDigits| Train Loss: 0.3560 | Train Acc: 0.9226
 Site-MNIST-M   | Train Loss: 0.6312 | Train Acc: 0.8011
 Site-MNIST-M   | Train Loss: 0.6068 | Train Acc: 0.8379
 Site-SVHN      | Train Loss: 0.8060 | Train Acc: 0.7376
 Site-MNIST     | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0300 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3906 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.4048 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2518 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1319 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1265 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1350 | Val  Acc: 0.9608
 Site-MNIST     | Val  Loss: 0.2129 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2013 | Val  Acc: 0.9426
 Site-USPS      | Val  Loss: 0.0889 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3517 | Val  Acc: 0.8889
 Site-USPS      | Val  Loss: 0.3849 | Val  Acc: 0.8438
 Site-USPS      | Val  Loss: 0.3633 | Val  Acc: 0.8276
 Site-USPS      | Val  Loss: 0.2941 | Val  Acc: 0.9048
 Site-USPS      | Val  Loss: 0.2196 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.3691 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2406 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.3591 | Val  Acc: 0.9098
 Site-MNIST-M   | Val  Loss: 0.6702 | Val  Acc: 0.8444
 Site-MNIST-M   | Val  Loss: 0.5922 | Val  Acc: 0.8272
 Site-SVHN      | Val  Loss: 0.4985 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9019
Aggregated Acc | Val Acc: 0.9073
 Best site-MNIST      | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:47 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:47 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:47 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9608
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9399
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9426
 Best site-USPS       | Epoch:47 | Val Acc: 1.0000
 Best site-USPS       | Epoch:47 | Val Acc: 0.8889
 Best site-USPS       | Epoch:47 | Val Acc: 0.8438
 Best site-USPS       | Epoch:47 | Val Acc: 0.8276
 Best site-USPS       | Epoch:47 | Val Acc: 0.9048
 Best site-USPS       | Epoch:47 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:47 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:47 | Val Acc: 0.9265
 Best site-SynthDigits | Epoch:47 | Val Acc: 0.9098
 Best site-MNIST-M    | Epoch:47 | Val Acc: 0.8444
 Best site-MNIST-M    | Epoch:47 | Val Acc: 0.8272
 Best site-SVHN       | Epoch:47 | Val Acc: 0.8000
 Test site-MNIST     | Epoch:47 | Test Acc: 0.9451
 Test site-USPS      | Epoch:47 | Test Acc: 0.9376
 Test site-SynthDigits| Epoch:47 | Test Acc: 0.8855
 Test site-MNIST-M   | Epoch:47 | Test Acc: 0.7273
 Test site-SVHN      | Epoch:47 | Test Acc: 0.6410
Average Test Accuracy: 0.8273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 48 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4909 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2159 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.0943 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1009 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1327 | Train Acc: 0.9286
 Site-MNIST     | Train Loss: 0.1434 | Train Acc: 0.9762
 Site-MNIST     | Train Loss: 0.1481 | Train Acc: 0.9559
 Site-MNIST     | Train Loss: 0.1970 | Train Acc: 0.9511
 Site-MNIST     | Train Loss: 0.1815 | Train Acc: 0.9511
 Site-MNIST     | Train Loss: 0.1476 | Train Acc: 0.9623
 Site-USPS      | Train Loss: 0.1831 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.2281 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.2379 | Train Acc: 0.9535
 Site-USPS      | Train Loss: 0.2480 | Train Acc: 0.9142
 Site-USPS      | Train Loss: 0.1944 | Train Acc: 0.9524
 Site-USPS      | Train Loss: 0.2124 | Train Acc: 0.9405
 Site-SynthDigits| Train Loss: 0.4937 | Train Acc: 0.8477
 Site-SynthDigits| Train Loss: 0.4205 | Train Acc: 0.9011
 Site-SynthDigits| Train Loss: 0.3532 | Train Acc: 0.9246
 Site-MNIST-M   | Train Loss: 0.6138 | Train Acc: 0.8066
 Site-MNIST-M   | Train Loss: 0.5686 | Train Acc: 0.8226
 Site-SVHN      | Train Loss: 0.7517 | Train Acc: 0.7482
 Site-MNIST     | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0285 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3789 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.3907 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2429 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1289 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1249 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1328 | Val  Acc: 0.9608
 Site-MNIST     | Val  Loss: 0.2105 | Val  Acc: 0.9399
 Site-MNIST     | Val  Loss: 0.2007 | Val  Acc: 0.9426
 Site-USPS      | Val  Loss: 0.0826 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3442 | Val  Acc: 0.8889
 Site-USPS      | Val  Loss: 0.3811 | Val  Acc: 0.8438
 Site-USPS      | Val  Loss: 0.3629 | Val  Acc: 0.8276
 Site-USPS      | Val  Loss: 0.2939 | Val  Acc: 0.8952
 Site-USPS      | Val  Loss: 0.2194 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.3674 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2369 | Val  Acc: 0.9412
 Site-SynthDigits| Val  Loss: 0.3568 | Val  Acc: 0.9016
 Site-MNIST-M   | Val  Loss: 0.6630 | Val  Acc: 0.8667
 Site-MNIST-M   | Val  Loss: 0.5859 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.4881 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9037
Aggregated Acc | Val Acc: 0.8795
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:48 | Val Acc: 0.8824
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9608
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9399
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9426
 Best site-USPS       | Epoch:48 | Val Acc: 1.0000
 Best site-USPS       | Epoch:48 | Val Acc: 0.8889
 Best site-USPS       | Epoch:48 | Val Acc: 0.8438
 Best site-USPS       | Epoch:48 | Val Acc: 0.8276
 Best site-USPS       | Epoch:48 | Val Acc: 0.8952
 Best site-USPS       | Epoch:48 | Val Acc: 0.9101
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.9412
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.9016
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.8667
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.8519
 Best site-SVHN       | Epoch:48 | Val Acc: 0.8000
 Test site-MNIST     | Epoch:48 | Test Acc: 0.9460
 Test site-USPS      | Epoch:48 | Test Acc: 0.9376
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.8862
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.7279
 Test site-SVHN      | Epoch:48 | Test Acc: 0.6454
Average Test Accuracy: 0.8286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
============ Train epoch 49 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-2
client-20 is in G-2
client-21 is in G-0
cnt=[4, 1, 2, 6, 9, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4766 | Train Acc: 0.8333
 Site-MNIST     | Train Loss: 0.2103 | Train Acc: 0.9167
 Site-MNIST     | Train Loss: 0.0869 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.0977 | Train Acc: 0.9474
 Site-MNIST     | Train Loss: 0.1299 | Train Acc: 0.9143
 Site-MNIST     | Train Loss: 0.1374 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1436 | Train Acc: 0.9648
 Site-MNIST     | Train Loss: 0.1843 | Train Acc: 0.9535
 Site-MNIST     | Train Loss: 0.1787 | Train Acc: 0.9470
 Site-MNIST     | Train Loss: 0.1432 | Train Acc: 0.9653
 Site-USPS      | Train Loss: 0.1852 | Train Acc: 0.9750
 Site-USPS      | Train Loss: 0.1449 | Train Acc: 0.9444
 Site-USPS      | Train Loss: 0.1609 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2558 | Train Acc: 0.9142
 Site-USPS      | Train Loss: 0.1880 | Train Acc: 0.9500
 Site-USPS      | Train Loss: 0.2099 | Train Acc: 0.9352
 Site-SynthDigits| Train Loss: 0.4355 | Train Acc: 0.8609
 Site-SynthDigits| Train Loss: 0.3801 | Train Acc: 0.9121
 Site-SynthDigits| Train Loss: 0.3400 | Train Acc: 0.9185
 Site-MNIST-M   | Train Loss: 0.6119 | Train Acc: 0.8232
 Site-MNIST-M   | Train Loss: 0.5502 | Train Acc: 0.8410
 Site-SVHN      | Train Loss: 0.7793 | Train Acc: 0.7447
 Site-MNIST     | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0290 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3925 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.3979 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.2456 | Val  Acc: 0.8824
 Site-MNIST     | Val  Loss: 0.1251 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1213 | Val  Acc: 0.9821
 Site-MNIST     | Val  Loss: 0.1297 | Val  Acc: 0.9608
 Site-MNIST     | Val  Loss: 0.2078 | Val  Acc: 0.9454
 Site-MNIST     | Val  Loss: 0.1973 | Val  Acc: 0.9426
 Site-USPS      | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3387 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.3800 | Val  Acc: 0.8438
 Site-USPS      | Val  Loss: 0.3510 | Val  Acc: 0.8448
 Site-USPS      | Val  Loss: 0.2914 | Val  Acc: 0.8952
 Site-USPS      | Val  Loss: 0.2176 | Val  Acc: 0.9101
 Site-SynthDigits| Val  Loss: 0.3598 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2369 | Val  Acc: 0.9265
 Site-SynthDigits| Val  Loss: 0.3522 | Val  Acc: 0.9098
 Site-MNIST-M   | Val  Loss: 0.6595 | Val  Acc: 0.8444
 Site-MNIST-M   | Val  Loss: 0.5854 | Val  Acc: 0.8519
 Site-SVHN      | Val  Loss: 0.4824 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9017
Aggregated Acc | Val Acc: 0.8729
 Test site-MNIST     | Epoch:48 | Test Acc: 0.9469
 Test site-USPS      | Epoch:48 | Test Acc: 0.9376
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.8868
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.7311
 Test site-SVHN      | Epoch:48 | Test Acc: 0.6477
Average Test Accuracy: 0.8300
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ccop_q=1...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.9469
 Test site-USPS      | Epoch:49 | Test Acc: 0.9376
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.8868
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.7311
 Test site-SVHN      | Epoch:49 | Test Acc: 0.6477
Average Test Accuracy: 0.8300
===2023-05-11 13:41:46===
===2023-05-11 13:42:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.9469
 Test site-USPS      | Epoch:49 | Test Acc: 0.9376
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.8868
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.7311
 Test site-SVHN      | Epoch:49 | Test Acc: 0.6477
Average Test Accuracy: 0.8300
===2023-05-13 16:41:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
label set of clients: [4, 7, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST           | Epoch:49 | Test Acc: 0.9467
 Test site-USPS            | Epoch:49 | Test Acc: 0.9387
 Test site-SynthDigits     | Epoch:49 | Test Acc: 0.8889
 Test site-MNIST-M         | Epoch:49 | Test Acc: 0.7199
 Test site-SVHN            | Epoch:49 | Test Acc: 0.6489
Average Test Accuracy: 0.8286
