===2023-05-13 14:20:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 2
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,domain number = 5
============ Train epoch 0 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-4
client-20 is in G-4
client-21 is in G-1
cnt=[10, 1, 6, 3, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.2511 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 2.2845 | Train Acc: 0.0833
 Site-MNIST           | Train Loss: 2.2656 | Train Acc: 0.1429
 Site-MNIST           | Train Loss: 2.2569 | Train Acc: 0.2368
 Site-MNIST           | Train Loss: 2.2507 | Train Acc: 0.2571
 Site-MNIST           | Train Loss: 2.2818 | Train Acc: 0.0714
 Site-MNIST           | Train Loss: 2.2720 | Train Acc: 0.1454
 Site-MNIST           | Train Loss: 2.2758 | Train Acc: 0.1614
 Site-MNIST           | Train Loss: 2.2733 | Train Acc: 0.1495
 Site-MNIST           | Train Loss: 2.2714 | Train Acc: 0.1517
 Site-USPS            | Train Loss: 2.2666 | Train Acc: 0.2750
 Site-USPS            | Train Loss: 2.2860 | Train Acc: 0.2222
 Site-USPS            | Train Loss: 2.2722 | Train Acc: 0.2171
 Site-USPS            | Train Loss: 2.2649 | Train Acc: 0.1931
 Site-USPS            | Train Loss: 2.2680 | Train Acc: 0.2333
 Site-USPS            | Train Loss: 2.2650 | Train Acc: 0.2328
 Site-SynthDigits     | Train Loss: 2.2941 | Train Acc: 0.1258
 Site-SynthDigits     | Train Loss: 2.3029 | Train Acc: 0.1026
 Site-SynthDigits     | Train Loss: 2.3050 | Train Acc: 0.1202
 Site-MNIST-M         | Train Loss: 2.3077 | Train Acc: 0.1105
 Site-MNIST-M         | Train Loss: 2.3198 | Train Acc: 0.0917
 Site-SVHN            | Train Loss: 2.2933 | Train Acc: 0.1064
 Site-MNIST           | Val  Loss: 2.1847 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.3357 | Val  Acc: 0.3333
 Site-MNIST           | Val  Loss: 2.3265 | Val  Acc: 0.2000
 Site-MNIST           | Val  Loss: 2.3487 | Val  Acc: 0.0000
 Site-MNIST           | Val  Loss: 2.3102 | Val  Acc: 0.0588
 Site-MNIST           | Val  Loss: 2.2859 | Val  Acc: 0.0968
 Site-MNIST           | Val  Loss: 2.2740 | Val  Acc: 0.1964
 Site-MNIST           | Val  Loss: 2.2735 | Val  Acc: 0.1569
 Site-MNIST           | Val  Loss: 2.2736 | Val  Acc: 0.1639
 Site-MNIST           | Val  Loss: 2.2764 | Val  Acc: 0.1450
 Site-USPS            | Val  Loss: 2.1989 | Val  Acc: 0.4000
 Site-USPS            | Val  Loss: 2.2435 | Val  Acc: 0.3333
 Site-USPS            | Val  Loss: 2.2626 | Val  Acc: 0.2188
 Site-USPS            | Val  Loss: 2.2623 | Val  Acc: 0.1552
 Site-USPS            | Val  Loss: 2.2634 | Val  Acc: 0.1714
 Site-USPS            | Val  Loss: 2.2705 | Val  Acc: 0.1799
 Site-SynthDigits     | Val  Loss: 2.3056 | Val  Acc: 0.1622
 Site-SynthDigits     | Val  Loss: 2.3315 | Val  Acc: 0.1324
 Site-SynthDigits     | Val  Loss: 2.2975 | Val  Acc: 0.0656
 Site-MNIST-M         | Val  Loss: 2.3134 | Val  Acc: 0.1333
 Site-MNIST-M         | Val  Loss: 2.3079 | Val  Acc: 0.0988
 Site-SVHN            | Val  Loss: 2.3132 | Val  Acc: 0.1714
Average Valid Accuracy: 0.2079
Aggregated Acc | Val Acc: 0.1771
 Best site-MNIST            | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:0 | Val Acc: 0.3333
 Best site-MNIST            | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST            | Epoch:0 | Val Acc: 0.0000
 Best site-MNIST            | Epoch:0 | Val Acc: 0.0588
 Best site-MNIST            | Epoch:0 | Val Acc: 0.0968
 Best site-MNIST            | Epoch:0 | Val Acc: 0.1964
 Best site-MNIST            | Epoch:0 | Val Acc: 0.1569
 Best site-MNIST            | Epoch:0 | Val Acc: 0.1639
 Best site-MNIST            | Epoch:0 | Val Acc: 0.1450
 Best site-USPS             | Epoch:0 | Val Acc: 0.4000
 Best site-USPS             | Epoch:0 | Val Acc: 0.3333
 Best site-USPS             | Epoch:0 | Val Acc: 0.2188
 Best site-USPS             | Epoch:0 | Val Acc: 0.1552
 Best site-USPS             | Epoch:0 | Val Acc: 0.1714
 Best site-USPS             | Epoch:0 | Val Acc: 0.1799
 Best site-SynthDigits      | Epoch:0 | Val Acc: 0.1622
 Best site-SynthDigits      | Epoch:0 | Val Acc: 0.1324
 Best site-SynthDigits      | Epoch:0 | Val Acc: 0.0656
 Best site-MNIST-M          | Epoch:0 | Val Acc: 0.1333
 Best site-MNIST-M          | Epoch:0 | Val Acc: 0.0988
 Best site-SVHN             | Epoch:0 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 1 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.2290 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 2.2584 | Train Acc: 0.2500
 Site-MNIST           | Train Loss: 2.2381 | Train Acc: 0.2857
 Site-MNIST           | Train Loss: 2.2282 | Train Acc: 0.3684
 Site-MNIST           | Train Loss: 2.2162 | Train Acc: 0.3571
 Site-MNIST           | Train Loss: 2.2489 | Train Acc: 0.1905
 Site-MNIST           | Train Loss: 2.2439 | Train Acc: 0.2687
 Site-MNIST           | Train Loss: 2.2497 | Train Acc: 0.2372
 Site-MNIST           | Train Loss: 2.2453 | Train Acc: 0.2500
 Site-MNIST           | Train Loss: 2.2405 | Train Acc: 0.2762
 Site-USPS            | Train Loss: 2.2350 | Train Acc: 0.4000
 Site-USPS            | Train Loss: 2.2411 | Train Acc: 0.3333
 Site-USPS            | Train Loss: 2.2827 | Train Acc: 0.3566
 Site-USPS            | Train Loss: 2.2353 | Train Acc: 0.3820
 Site-USPS            | Train Loss: 2.2379 | Train Acc: 0.3619
 Site-USPS            | Train Loss: 2.2328 | Train Acc: 0.3757
 Site-SynthDigits     | Train Loss: 2.2920 | Train Acc: 0.1325
 Site-SynthDigits     | Train Loss: 2.2953 | Train Acc: 0.1062
 Site-SynthDigits     | Train Loss: 2.2966 | Train Acc: 0.1527
 Site-MNIST-M         | Train Loss: 2.3045 | Train Acc: 0.1215
 Site-MNIST-M         | Train Loss: 2.3128 | Train Acc: 0.0979
 Site-SVHN            | Train Loss: 2.2943 | Train Acc: 0.0887
 Site-MNIST           | Val  Loss: 2.1343 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.3033 | Val  Acc: 0.3333
 Site-MNIST           | Val  Loss: 2.2931 | Val  Acc: 0.2000
 Site-MNIST           | Val  Loss: 2.3202 | Val  Acc: 0.1111
 Site-MNIST           | Val  Loss: 2.2823 | Val  Acc: 0.2353
 Site-MNIST           | Val  Loss: 2.2604 | Val  Acc: 0.1935
 Site-MNIST           | Val  Loss: 2.2475 | Val  Acc: 0.2500
 Site-MNIST           | Val  Loss: 2.2442 | Val  Acc: 0.2451
 Site-MNIST           | Val  Loss: 2.2462 | Val  Acc: 0.2459
 Site-MNIST           | Val  Loss: 2.2466 | Val  Acc: 0.2266
 Site-USPS            | Val  Loss: 2.1715 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 2.2211 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 2.2303 | Val  Acc: 0.4375
 Site-USPS            | Val  Loss: 2.2338 | Val  Acc: 0.3621
 Site-USPS            | Val  Loss: 2.2318 | Val  Acc: 0.3714
 Site-USPS            | Val  Loss: 2.2365 | Val  Acc: 0.3651
 Site-SynthDigits     | Val  Loss: 2.3026 | Val  Acc: 0.1622
 Site-SynthDigits     | Val  Loss: 2.3298 | Val  Acc: 0.1324
 Site-SynthDigits     | Val  Loss: 2.2925 | Val  Acc: 0.0738
 Site-MNIST-M         | Val  Loss: 2.3086 | Val  Acc: 0.1333
 Site-MNIST-M         | Val  Loss: 2.3029 | Val  Acc: 0.1235
 Site-SVHN            | Val  Loss: 2.3106 | Val  Acc: 0.1571
Average Valid Accuracy: 0.2911
Aggregated Acc | Val Acc: 0.2285
 Best site-MNIST            | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:1 | Val Acc: 0.3333
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2000
 Best site-MNIST            | Epoch:1 | Val Acc: 0.1111
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2353
 Best site-MNIST            | Epoch:1 | Val Acc: 0.1935
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2500
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2451
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2459
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2266
 Best site-USPS             | Epoch:1 | Val Acc: 0.6000
 Best site-USPS             | Epoch:1 | Val Acc: 0.4444
 Best site-USPS             | Epoch:1 | Val Acc: 0.4375
 Best site-USPS             | Epoch:1 | Val Acc: 0.3621
 Best site-USPS             | Epoch:1 | Val Acc: 0.3714
 Best site-USPS             | Epoch:1 | Val Acc: 0.3651
 Best site-SynthDigits      | Epoch:1 | Val Acc: 0.1622
 Best site-SynthDigits      | Epoch:1 | Val Acc: 0.1324
 Best site-SynthDigits      | Epoch:1 | Val Acc: 0.0738
 Best site-MNIST-M          | Epoch:1 | Val Acc: 0.1333
 Best site-MNIST-M          | Epoch:1 | Val Acc: 0.1235
 Best site-SVHN             | Epoch:1 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
===2023-05-13 14:25:25===
===2023-05-13 14:25:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,label set of clients: [4, 7, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST           | Epoch:1 | Test Acc: 0.2441
 Test site-USPS            | Epoch:1 | Test Acc: 0.3806
 Test site-SynthDigits     | Epoch:1 | Test Acc: 0.1274
 Test site-MNIST-M         | Epoch:1 | Test Acc: 0.0996
 Test site-SVHN            | Epoch:1 | Test Acc: 0.1075
Average Test Accuracy: 0.1918
===2023-05-13 22:00:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
label set of clients: [4, 7, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-4
client-20 is in G-4
client-21 is in G-1
cnt=[10, 1, 6, 3, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.2508 | Train Acc: 0.1667
 Site-MNIST           | Train Loss: 2.2807 | Train Acc: 0.0833
 Site-MNIST           | Train Loss: 2.2832 | Train Acc: 0.0952
 Site-MNIST           | Train Loss: 2.2840 | Train Acc: 0.2105
 Site-MNIST           | Train Loss: 2.2575 | Train Acc: 0.2714
 Site-MNIST           | Train Loss: 2.2775 | Train Acc: 0.1508
 Site-MNIST           | Train Loss: 2.2822 | Train Acc: 0.1894
 Site-MNIST           | Train Loss: 2.2906 | Train Acc: 0.1394
 Site-MNIST           | Train Loss: 2.2804 | Train Acc: 0.1495
 Site-MNIST           | Train Loss: 2.2768 | Train Acc: 0.1615
 Site-USPS            | Train Loss: 2.2885 | Train Acc: 0.2250
 Site-USPS            | Train Loss: 2.2948 | Train Acc: 0.1528
 Site-USPS            | Train Loss: 2.3245 | Train Acc: 0.2093
 Site-USPS            | Train Loss: 2.2866 | Train Acc: 0.1888
 Site-USPS            | Train Loss: 2.2785 | Train Acc: 0.2095
 Site-USPS            | Train Loss: 2.2888 | Train Acc: 0.1825
 Site-SynthDigits     | Train Loss: 2.3122 | Train Acc: 0.1126
 Site-SynthDigits     | Train Loss: 2.3062 | Train Acc: 0.1062
 Site-SynthDigits     | Train Loss: 2.3054 | Train Acc: 0.1120
 Site-MNIST-M         | Train Loss: 2.3049 | Train Acc: 0.0994
 Site-MNIST-M         | Train Loss: 2.2993 | Train Acc: 0.0887
 Site-SVHN            | Train Loss: 2.3203 | Train Acc: 0.0709
 Site-MNIST           | Val  Loss: 2.1002 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.2066 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 2.2403 | Val  Acc: 0.4000
 Site-MNIST           | Val  Loss: 2.2634 | Val  Acc: 0.2222
 Site-MNIST           | Val  Loss: 2.2840 | Val  Acc: 0.1176
 Site-MNIST           | Val  Loss: 2.3110 | Val  Acc: 0.0645
 Site-MNIST           | Val  Loss: 2.3104 | Val  Acc: 0.0714
 Site-MNIST           | Val  Loss: 2.3003 | Val  Acc: 0.1176
 Site-MNIST           | Val  Loss: 2.2782 | Val  Acc: 0.1803
 Site-MNIST           | Val  Loss: 2.2887 | Val  Acc: 0.1873
 Site-USPS            | Val  Loss: 2.2414 | Val  Acc: 0.3000
 Site-USPS            | Val  Loss: 2.2704 | Val  Acc: 0.2222
 Site-USPS            | Val  Loss: 2.2767 | Val  Acc: 0.3125
 Site-USPS            | Val  Loss: 2.3018 | Val  Acc: 0.1724
 Site-USPS            | Val  Loss: 2.2963 | Val  Acc: 0.1714
 Site-USPS            | Val  Loss: 2.2920 | Val  Acc: 0.1693
 Site-SynthDigits     | Val  Loss: 2.3265 | Val  Acc: 0.0541
 Site-SynthDigits     | Val  Loss: 2.3363 | Val  Acc: 0.0882
 Site-SynthDigits     | Val  Loss: 2.3030 | Val  Acc: 0.0738
 Site-MNIST-M         | Val  Loss: 2.2994 | Val  Acc: 0.0444
 Site-MNIST-M         | Val  Loss: 2.2982 | Val  Acc: 0.0988
 Site-SVHN            | Val  Loss: 2.3292 | Val  Acc: 0.0714
Average Valid Accuracy: 0.2185
Aggregated Acc | Val Acc: 0.1485
 Best site-MNIST            | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:0 | Val Acc: 0.4000
 Best site-MNIST            | Epoch:0 | Val Acc: 0.2222
 Best site-MNIST            | Epoch:0 | Val Acc: 0.1176
 Best site-MNIST            | Epoch:0 | Val Acc: 0.0645
 Best site-MNIST            | Epoch:0 | Val Acc: 0.0714
 Best site-MNIST            | Epoch:0 | Val Acc: 0.1176
 Best site-MNIST            | Epoch:0 | Val Acc: 0.1803
 Best site-MNIST            | Epoch:0 | Val Acc: 0.1873
 Best site-USPS             | Epoch:0 | Val Acc: 0.3000
 Best site-USPS             | Epoch:0 | Val Acc: 0.2222
 Best site-USPS             | Epoch:0 | Val Acc: 0.3125
 Best site-USPS             | Epoch:0 | Val Acc: 0.1724
 Best site-USPS             | Epoch:0 | Val Acc: 0.1714
 Best site-USPS             | Epoch:0 | Val Acc: 0.1693
 Best site-SynthDigits      | Epoch:0 | Val Acc: 0.0541
 Best site-SynthDigits      | Epoch:0 | Val Acc: 0.0882
 Best site-SynthDigits      | Epoch:0 | Val Acc: 0.0738
 Best site-MNIST-M          | Epoch:0 | Val Acc: 0.0444
 Best site-MNIST-M          | Epoch:0 | Val Acc: 0.0988
 Best site-SVHN             | Epoch:0 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 1 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[6, 3, 10, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.2318 | Train Acc: 0.1667
 Site-MNIST           | Train Loss: 2.2580 | Train Acc: 0.0833
 Site-MNIST           | Train Loss: 2.2590 | Train Acc: 0.1429
 Site-MNIST           | Train Loss: 2.2569 | Train Acc: 0.2368
 Site-MNIST           | Train Loss: 2.1853 | Train Acc: 0.3000
 Site-MNIST           | Train Loss: 2.2493 | Train Acc: 0.1825
 Site-MNIST           | Train Loss: 2.2513 | Train Acc: 0.2247
 Site-MNIST           | Train Loss: 2.2656 | Train Acc: 0.1711
 Site-MNIST           | Train Loss: 2.2542 | Train Acc: 0.1821
 Site-MNIST           | Train Loss: 2.2494 | Train Acc: 0.2053
 Site-USPS            | Train Loss: 2.2584 | Train Acc: 0.2500
 Site-USPS            | Train Loss: 2.2994 | Train Acc: 0.1806
 Site-USPS            | Train Loss: 2.2881 | Train Acc: 0.2636
 Site-USPS            | Train Loss: 2.2557 | Train Acc: 0.2189
 Site-USPS            | Train Loss: 2.2498 | Train Acc: 0.2333
 Site-USPS            | Train Loss: 2.2584 | Train Acc: 0.2275
 Site-SynthDigits     | Train Loss: 2.3119 | Train Acc: 0.1192
 Site-SynthDigits     | Train Loss: 2.3055 | Train Acc: 0.1136
 Site-SynthDigits     | Train Loss: 2.2980 | Train Acc: 0.1263
 Site-MNIST-M         | Train Loss: 2.3013 | Train Acc: 0.1105
 Site-MNIST-M         | Train Loss: 2.2989 | Train Acc: 0.0856
 Site-SVHN            | Train Loss: 2.3186 | Train Acc: 0.0674
 Site-MNIST           | Val  Loss: 2.0612 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.1757 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 2.2073 | Val  Acc: 0.4000
 Site-MNIST           | Val  Loss: 2.2392 | Val  Acc: 0.2222
 Site-MNIST           | Val  Loss: 2.2588 | Val  Acc: 0.1176
 Site-MNIST           | Val  Loss: 2.2877 | Val  Acc: 0.0645
 Site-MNIST           | Val  Loss: 2.2845 | Val  Acc: 0.0893
 Site-MNIST           | Val  Loss: 2.2728 | Val  Acc: 0.1471
 Site-MNIST           | Val  Loss: 2.2520 | Val  Acc: 0.2131
 Site-MNIST           | Val  Loss: 2.2611 | Val  Acc: 0.2205
 Site-USPS            | Val  Loss: 2.2148 | Val  Acc: 0.3000
 Site-USPS            | Val  Loss: 2.2498 | Val  Acc: 0.2222
 Site-USPS            | Val  Loss: 2.2477 | Val  Acc: 0.3125
 Site-USPS            | Val  Loss: 2.2741 | Val  Acc: 0.1897
 Site-USPS            | Val  Loss: 2.2657 | Val  Acc: 0.2000
 Site-USPS            | Val  Loss: 2.2592 | Val  Acc: 0.2169
 Site-SynthDigits     | Val  Loss: 2.3222 | Val  Acc: 0.0541
 Site-SynthDigits     | Val  Loss: 2.3318 | Val  Acc: 0.1029
 Site-SynthDigits     | Val  Loss: 2.2974 | Val  Acc: 0.0902
 Site-MNIST-M         | Val  Loss: 2.2951 | Val  Acc: 0.0667
 Site-MNIST-M         | Val  Loss: 2.2937 | Val  Acc: 0.0988
 Site-SVHN            | Val  Loss: 2.3274 | Val  Acc: 0.0714
Average Valid Accuracy: 0.2303
Aggregated Acc | Val Acc: 0.1582
 Best site-MNIST            | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:1 | Val Acc: 0.4000
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2222
 Best site-MNIST            | Epoch:1 | Val Acc: 0.1176
 Best site-MNIST            | Epoch:1 | Val Acc: 0.0645
 Best site-MNIST            | Epoch:1 | Val Acc: 0.0893
 Best site-MNIST            | Epoch:1 | Val Acc: 0.1471
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2131
 Best site-MNIST            | Epoch:1 | Val Acc: 0.2205
 Best site-USPS             | Epoch:1 | Val Acc: 0.3000
 Best site-USPS             | Epoch:1 | Val Acc: 0.2222
 Best site-USPS             | Epoch:1 | Val Acc: 0.3125
 Best site-USPS             | Epoch:1 | Val Acc: 0.1897
 Best site-USPS             | Epoch:1 | Val Acc: 0.2000
 Best site-USPS             | Epoch:1 | Val Acc: 0.2169
 Best site-SynthDigits      | Epoch:1 | Val Acc: 0.0541
 Best site-SynthDigits      | Epoch:1 | Val Acc: 0.1029
 Best site-SynthDigits      | Epoch:1 | Val Acc: 0.0902
 Best site-MNIST-M          | Epoch:1 | Val Acc: 0.0667
 Best site-MNIST-M          | Epoch:1 | Val Acc: 0.0988
 Best site-SVHN             | Epoch:1 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 2 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.2117 | Train Acc: 0.3333
 Site-MNIST           | Train Loss: 2.2359 | Train Acc: 0.0833
 Site-MNIST           | Train Loss: 2.2345 | Train Acc: 0.2381
 Site-MNIST           | Train Loss: 2.2299 | Train Acc: 0.2632
 Site-MNIST           | Train Loss: 2.2124 | Train Acc: 0.3857
 Site-MNIST           | Train Loss: 2.2217 | Train Acc: 0.2619
 Site-MNIST           | Train Loss: 2.2178 | Train Acc: 0.2775
 Site-MNIST           | Train Loss: 2.2440 | Train Acc: 0.2127
 Site-MNIST           | Train Loss: 2.2286 | Train Acc: 0.2500
 Site-MNIST           | Train Loss: 2.2221 | Train Acc: 0.2649
 Site-USPS            | Train Loss: 2.2288 | Train Acc: 0.3000
 Site-USPS            | Train Loss: 2.2635 | Train Acc: 0.2778
 Site-USPS            | Train Loss: 2.2252 | Train Acc: 0.3023
 Site-USPS            | Train Loss: 2.2258 | Train Acc: 0.2618
 Site-USPS            | Train Loss: 2.2235 | Train Acc: 0.2762
 Site-USPS            | Train Loss: 2.2284 | Train Acc: 0.2870
 Site-SynthDigits     | Train Loss: 2.3085 | Train Acc: 0.1325
 Site-SynthDigits     | Train Loss: 2.2951 | Train Acc: 0.1209
 Site-SynthDigits     | Train Loss: 2.2934 | Train Acc: 0.1405
 Site-MNIST-M         | Train Loss: 2.2982 | Train Acc: 0.1271
 Site-MNIST-M         | Train Loss: 2.3005 | Train Acc: 0.0856
 Site-SVHN            | Train Loss: 2.3169 | Train Acc: 0.0674
 Site-MNIST           | Val  Loss: 2.0215 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.1452 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 2.1751 | Val  Acc: 0.4000
 Site-MNIST           | Val  Loss: 2.2153 | Val  Acc: 0.2222
 Site-MNIST           | Val  Loss: 2.2340 | Val  Acc: 0.1176
 Site-MNIST           | Val  Loss: 2.2641 | Val  Acc: 0.0645
 Site-MNIST           | Val  Loss: 2.2584 | Val  Acc: 0.1071
 Site-MNIST           | Val  Loss: 2.2453 | Val  Acc: 0.1863
 Site-MNIST           | Val  Loss: 2.2263 | Val  Acc: 0.2623
 Site-MNIST           | Val  Loss: 2.2340 | Val  Acc: 0.2659
 Site-USPS            | Val  Loss: 2.1884 | Val  Acc: 0.3000
 Site-USPS            | Val  Loss: 2.2298 | Val  Acc: 0.2778
 Site-USPS            | Val  Loss: 2.2195 | Val  Acc: 0.3750
 Site-USPS            | Val  Loss: 2.2471 | Val  Acc: 0.2414
 Site-USPS            | Val  Loss: 2.2357 | Val  Acc: 0.2571
 Site-USPS            | Val  Loss: 2.2272 | Val  Acc: 0.2593
 Site-SynthDigits     | Val  Loss: 2.3180 | Val  Acc: 0.0541
 Site-SynthDigits     | Val  Loss: 2.3275 | Val  Acc: 0.1029
 Site-SynthDigits     | Val  Loss: 2.2920 | Val  Acc: 0.0902
 Site-MNIST-M         | Val  Loss: 2.2909 | Val  Acc: 0.1111
 Site-MNIST-M         | Val  Loss: 2.2894 | Val  Acc: 0.1358
 Site-SVHN            | Val  Loss: 2.3256 | Val  Acc: 0.0714
Average Valid Accuracy: 0.2531
Aggregated Acc | Val Acc: 0.1783
 Best site-MNIST            | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:2 | Val Acc: 0.4000
 Best site-MNIST            | Epoch:2 | Val Acc: 0.2222
 Best site-MNIST            | Epoch:2 | Val Acc: 0.1176
 Best site-MNIST            | Epoch:2 | Val Acc: 0.0645
 Best site-MNIST            | Epoch:2 | Val Acc: 0.1071
 Best site-MNIST            | Epoch:2 | Val Acc: 0.1863
 Best site-MNIST            | Epoch:2 | Val Acc: 0.2623
 Best site-MNIST            | Epoch:2 | Val Acc: 0.2659
 Best site-USPS             | Epoch:2 | Val Acc: 0.3000
 Best site-USPS             | Epoch:2 | Val Acc: 0.2778
 Best site-USPS             | Epoch:2 | Val Acc: 0.3750
 Best site-USPS             | Epoch:2 | Val Acc: 0.2414
 Best site-USPS             | Epoch:2 | Val Acc: 0.2571
 Best site-USPS             | Epoch:2 | Val Acc: 0.2593
 Best site-SynthDigits      | Epoch:2 | Val Acc: 0.0541
 Best site-SynthDigits      | Epoch:2 | Val Acc: 0.1029
 Best site-SynthDigits      | Epoch:2 | Val Acc: 0.0902
 Best site-MNIST-M          | Epoch:2 | Val Acc: 0.1111
 Best site-MNIST-M          | Epoch:2 | Val Acc: 0.1358
 Best site-SVHN             | Epoch:2 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 3 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[6, 3, 10, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.1914 | Train Acc: 0.3333
 Site-MNIST           | Train Loss: 2.2143 | Train Acc: 0.2500
 Site-MNIST           | Train Loss: 2.2098 | Train Acc: 0.2857
 Site-MNIST           | Train Loss: 2.2031 | Train Acc: 0.3947
 Site-MNIST           | Train Loss: 2.1832 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 2.1948 | Train Acc: 0.3571
 Site-MNIST           | Train Loss: 2.1946 | Train Acc: 0.3921
 Site-MNIST           | Train Loss: 2.2206 | Train Acc: 0.3130
 Site-MNIST           | Train Loss: 2.2038 | Train Acc: 0.3207
 Site-MNIST           | Train Loss: 2.1947 | Train Acc: 0.3517
 Site-USPS            | Train Loss: 2.2002 | Train Acc: 0.4750
 Site-USPS            | Train Loss: 2.1863 | Train Acc: 0.3750
 Site-USPS            | Train Loss: 2.2434 | Train Acc: 0.3876
 Site-USPS            | Train Loss: 2.1953 | Train Acc: 0.3863
 Site-USPS            | Train Loss: 2.1952 | Train Acc: 0.3833
 Site-USPS            | Train Loss: 2.1997 | Train Acc: 0.3638
 Site-SynthDigits     | Train Loss: 2.3024 | Train Acc: 0.1391
 Site-SynthDigits     | Train Loss: 2.2922 | Train Acc: 0.1282
 Site-SynthDigits     | Train Loss: 2.2853 | Train Acc: 0.1589
 Site-MNIST-M         | Train Loss: 2.2955 | Train Acc: 0.1381
 Site-MNIST-M         | Train Loss: 2.3126 | Train Acc: 0.1009
 Site-SVHN            | Train Loss: 2.3143 | Train Acc: 0.0674
 Site-MNIST           | Val  Loss: 1.9840 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.1140 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 2.1436 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 2.1909 | Val  Acc: 0.3333
 Site-MNIST           | Val  Loss: 2.2092 | Val  Acc: 0.2941
 Site-MNIST           | Val  Loss: 2.2401 | Val  Acc: 0.2581
 Site-MNIST           | Val  Loss: 2.2328 | Val  Acc: 0.2679
 Site-MNIST           | Val  Loss: 2.2186 | Val  Acc: 0.3137
 Site-MNIST           | Val  Loss: 2.2010 | Val  Acc: 0.3552
 Site-MNIST           | Val  Loss: 2.2075 | Val  Acc: 0.3595
 Site-USPS            | Val  Loss: 2.1628 | Val  Acc: 0.3000
 Site-USPS            | Val  Loss: 2.2106 | Val  Acc: 0.2778
 Site-USPS            | Val  Loss: 2.1928 | Val  Acc: 0.4688
 Site-USPS            | Val  Loss: 2.2210 | Val  Acc: 0.3793
 Site-USPS            | Val  Loss: 2.2069 | Val  Acc: 0.4095
 Site-USPS            | Val  Loss: 2.1964 | Val  Acc: 0.4074
 Site-SynthDigits     | Val  Loss: 2.3138 | Val  Acc: 0.0811
 Site-SynthDigits     | Val  Loss: 2.3231 | Val  Acc: 0.1324
 Site-SynthDigits     | Val  Loss: 2.2867 | Val  Acc: 0.1148
 Site-MNIST-M         | Val  Loss: 2.2870 | Val  Acc: 0.1333
 Site-MNIST-M         | Val  Loss: 2.2853 | Val  Acc: 0.1481
 Site-SVHN            | Val  Loss: 2.3240 | Val  Acc: 0.0857
Average Valid Accuracy: 0.3358
Aggregated Acc | Val Acc: 0.2309
 Best site-MNIST            | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:3 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:3 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:3 | Val Acc: 0.3333
 Best site-MNIST            | Epoch:3 | Val Acc: 0.2941
 Best site-MNIST            | Epoch:3 | Val Acc: 0.2581
 Best site-MNIST            | Epoch:3 | Val Acc: 0.2679
 Best site-MNIST            | Epoch:3 | Val Acc: 0.3137
 Best site-MNIST            | Epoch:3 | Val Acc: 0.3552
 Best site-MNIST            | Epoch:3 | Val Acc: 0.3595
 Best site-USPS             | Epoch:3 | Val Acc: 0.3000
 Best site-USPS             | Epoch:3 | Val Acc: 0.2778
 Best site-USPS             | Epoch:3 | Val Acc: 0.4688
 Best site-USPS             | Epoch:3 | Val Acc: 0.3793
 Best site-USPS             | Epoch:3 | Val Acc: 0.4095
 Best site-USPS             | Epoch:3 | Val Acc: 0.4074
 Best site-SynthDigits      | Epoch:3 | Val Acc: 0.0811
 Best site-SynthDigits      | Epoch:3 | Val Acc: 0.1324
 Best site-SynthDigits      | Epoch:3 | Val Acc: 0.1148
 Best site-MNIST-M          | Epoch:3 | Val Acc: 0.1333
 Best site-MNIST-M          | Epoch:3 | Val Acc: 0.1481
 Best site-SVHN             | Epoch:3 | Val Acc: 0.0857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 4 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.1698 | Train Acc: 0.3333
 Site-MNIST           | Train Loss: 2.1927 | Train Acc: 0.2500
 Site-MNIST           | Train Loss: 2.1848 | Train Acc: 0.2857
 Site-MNIST           | Train Loss: 2.1770 | Train Acc: 0.4211
 Site-MNIST           | Train Loss: 2.1428 | Train Acc: 0.6286
 Site-MNIST           | Train Loss: 2.1672 | Train Acc: 0.3968
 Site-MNIST           | Train Loss: 2.1705 | Train Acc: 0.4361
 Site-MNIST           | Train Loss: 2.1954 | Train Acc: 0.3692
 Site-MNIST           | Train Loss: 2.1793 | Train Acc: 0.3818
 Site-MNIST           | Train Loss: 2.1685 | Train Acc: 0.4257
 Site-USPS            | Train Loss: 2.1721 | Train Acc: 0.5000
 Site-USPS            | Train Loss: 2.1744 | Train Acc: 0.4583
 Site-USPS            | Train Loss: 2.2390 | Train Acc: 0.4806
 Site-USPS            | Train Loss: 2.1676 | Train Acc: 0.4421
 Site-USPS            | Train Loss: 2.1636 | Train Acc: 0.4333
 Site-USPS            | Train Loss: 2.1714 | Train Acc: 0.4193
 Site-SynthDigits     | Train Loss: 2.3045 | Train Acc: 0.1258
 Site-SynthDigits     | Train Loss: 2.2839 | Train Acc: 0.1392
 Site-SynthDigits     | Train Loss: 2.2792 | Train Acc: 0.1772
 Site-MNIST-M         | Train Loss: 2.2909 | Train Acc: 0.1271
 Site-MNIST-M         | Train Loss: 2.2933 | Train Acc: 0.1101
 Site-SVHN            | Train Loss: 2.3123 | Train Acc: 0.0674
 Site-MNIST           | Val  Loss: 1.9453 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.0831 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 2.1127 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 2.1670 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 2.1849 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 2.2156 | Val  Acc: 0.2903
 Site-MNIST           | Val  Loss: 2.2070 | Val  Acc: 0.3571
 Site-MNIST           | Val  Loss: 2.1917 | Val  Acc: 0.3824
 Site-MNIST           | Val  Loss: 2.1757 | Val  Acc: 0.4208
 Site-MNIST           | Val  Loss: 2.1811 | Val  Acc: 0.4048
 Site-USPS            | Val  Loss: 2.1366 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.1913 | Val  Acc: 0.3889
 Site-USPS            | Val  Loss: 2.1666 | Val  Acc: 0.4688
 Site-USPS            | Val  Loss: 2.1953 | Val  Acc: 0.4138
 Site-USPS            | Val  Loss: 2.1784 | Val  Acc: 0.4667
 Site-USPS            | Val  Loss: 2.1658 | Val  Acc: 0.4762
 Site-SynthDigits     | Val  Loss: 2.3096 | Val  Acc: 0.1081
 Site-SynthDigits     | Val  Loss: 2.3189 | Val  Acc: 0.1618
 Site-SynthDigits     | Val  Loss: 2.2815 | Val  Acc: 0.1311
 Site-MNIST-M         | Val  Loss: 2.2830 | Val  Acc: 0.1111
 Site-MNIST-M         | Val  Loss: 2.2811 | Val  Acc: 0.1481
 Site-SVHN            | Val  Loss: 2.3225 | Val  Acc: 0.0857
Average Valid Accuracy: 0.3927
Aggregated Acc | Val Acc: 0.2638
 Best site-MNIST            | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:4 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:4 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:4 | Val Acc: 0.4118
 Best site-MNIST            | Epoch:4 | Val Acc: 0.2903
 Best site-MNIST            | Epoch:4 | Val Acc: 0.3571
 Best site-MNIST            | Epoch:4 | Val Acc: 0.3824
 Best site-MNIST            | Epoch:4 | Val Acc: 0.4208
 Best site-MNIST            | Epoch:4 | Val Acc: 0.4048
 Best site-USPS             | Epoch:4 | Val Acc: 0.5000
 Best site-USPS             | Epoch:4 | Val Acc: 0.3889
 Best site-USPS             | Epoch:4 | Val Acc: 0.4688
 Best site-USPS             | Epoch:4 | Val Acc: 0.4138
 Best site-USPS             | Epoch:4 | Val Acc: 0.4667
 Best site-USPS             | Epoch:4 | Val Acc: 0.4762
 Best site-SynthDigits      | Epoch:4 | Val Acc: 0.1081
 Best site-SynthDigits      | Epoch:4 | Val Acc: 0.1618
 Best site-SynthDigits      | Epoch:4 | Val Acc: 0.1311
 Best site-MNIST-M          | Epoch:4 | Val Acc: 0.1111
 Best site-MNIST-M          | Epoch:4 | Val Acc: 0.1481
 Best site-SVHN             | Epoch:4 | Val Acc: 0.0857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 5 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-4
client-20 is in G-4
client-21 is in G-1
cnt=[1, 4, 6, 9, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.1493 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.1710 | Train Acc: 0.3333
 Site-MNIST           | Train Loss: 2.1593 | Train Acc: 0.3333
 Site-MNIST           | Train Loss: 2.1508 | Train Acc: 0.4474
 Site-MNIST           | Train Loss: 2.0499 | Train Acc: 0.6286
 Site-MNIST           | Train Loss: 2.1405 | Train Acc: 0.4365
 Site-MNIST           | Train Loss: 2.1405 | Train Acc: 0.4890
 Site-MNIST           | Train Loss: 2.1719 | Train Acc: 0.3961
 Site-MNIST           | Train Loss: 2.1558 | Train Acc: 0.4293
 Site-MNIST           | Train Loss: 2.1424 | Train Acc: 0.4649
 Site-USPS            | Train Loss: 2.1449 | Train Acc: 0.5000
 Site-USPS            | Train Loss: 2.1542 | Train Acc: 0.4861
 Site-USPS            | Train Loss: 2.1572 | Train Acc: 0.4961
 Site-USPS            | Train Loss: 2.1395 | Train Acc: 0.4506
 Site-USPS            | Train Loss: 2.1400 | Train Acc: 0.4643
 Site-USPS            | Train Loss: 2.1444 | Train Acc: 0.4563
 Site-SynthDigits     | Train Loss: 2.2972 | Train Acc: 0.1060
 Site-SynthDigits     | Train Loss: 2.2851 | Train Acc: 0.1465
 Site-SynthDigits     | Train Loss: 2.2732 | Train Acc: 0.1772
 Site-MNIST-M         | Train Loss: 2.2895 | Train Acc: 0.1271
 Site-MNIST-M         | Train Loss: 2.2887 | Train Acc: 0.1131
 Site-SVHN            | Train Loss: 2.3117 | Train Acc: 0.0709
 Site-MNIST           | Val  Loss: 1.9103 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.0551 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 2.0843 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 2.1446 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 2.1611 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 2.1905 | Val  Acc: 0.2903
 Site-MNIST           | Val  Loss: 2.1810 | Val  Acc: 0.3750
 Site-MNIST           | Val  Loss: 2.1652 | Val  Acc: 0.4412
 Site-MNIST           | Val  Loss: 2.1514 | Val  Acc: 0.4645
 Site-MNIST           | Val  Loss: 2.1554 | Val  Acc: 0.4502
 Site-USPS            | Val  Loss: 2.1109 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.1733 | Val  Acc: 0.3889
 Site-USPS            | Val  Loss: 2.1422 | Val  Acc: 0.4688
 Site-USPS            | Val  Loss: 2.1707 | Val  Acc: 0.4310
 Site-USPS            | Val  Loss: 2.1510 | Val  Acc: 0.4762
 Site-USPS            | Val  Loss: 2.1366 | Val  Acc: 0.4921
 Site-SynthDigits     | Val  Loss: 2.3053 | Val  Acc: 0.1351
 Site-SynthDigits     | Val  Loss: 2.3148 | Val  Acc: 0.1765
 Site-SynthDigits     | Val  Loss: 2.2765 | Val  Acc: 0.1475
 Site-MNIST-M         | Val  Loss: 2.2796 | Val  Acc: 0.1111
 Site-MNIST-M         | Val  Loss: 2.2773 | Val  Acc: 0.1481
 Site-SVHN            | Val  Loss: 2.3211 | Val  Acc: 0.1000
Average Valid Accuracy: 0.4054
Aggregated Acc | Val Acc: 0.4423
 Best site-MNIST            | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:5 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:5 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:5 | Val Acc: 0.4118
 Best site-MNIST            | Epoch:5 | Val Acc: 0.2903
 Best site-MNIST            | Epoch:5 | Val Acc: 0.3750
 Best site-MNIST            | Epoch:5 | Val Acc: 0.4412
 Best site-MNIST            | Epoch:5 | Val Acc: 0.4645
 Best site-MNIST            | Epoch:5 | Val Acc: 0.4502
 Best site-USPS             | Epoch:5 | Val Acc: 0.5000
 Best site-USPS             | Epoch:5 | Val Acc: 0.3889
 Best site-USPS             | Epoch:5 | Val Acc: 0.4688
 Best site-USPS             | Epoch:5 | Val Acc: 0.4310
 Best site-USPS             | Epoch:5 | Val Acc: 0.4762
 Best site-USPS             | Epoch:5 | Val Acc: 0.4921
 Best site-SynthDigits      | Epoch:5 | Val Acc: 0.1351
 Best site-SynthDigits      | Epoch:5 | Val Acc: 0.1765
 Best site-SynthDigits      | Epoch:5 | Val Acc: 0.1475
 Best site-MNIST-M          | Epoch:5 | Val Acc: 0.1111
 Best site-MNIST-M          | Epoch:5 | Val Acc: 0.1481
 Best site-SVHN             | Epoch:5 | Val Acc: 0.1000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.1280 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.1491 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 2.1355 | Train Acc: 0.3810
 Site-MNIST           | Train Loss: 2.1249 | Train Acc: 0.4737
 Site-MNIST           | Train Loss: 2.0546 | Train Acc: 0.6429
 Site-MNIST           | Train Loss: 2.1145 | Train Acc: 0.4921
 Site-MNIST           | Train Loss: 2.1150 | Train Acc: 0.5154
 Site-MNIST           | Train Loss: 2.1523 | Train Acc: 0.4132
 Site-MNIST           | Train Loss: 2.1315 | Train Acc: 0.4511
 Site-MNIST           | Train Loss: 2.1160 | Train Acc: 0.4891
 Site-USPS            | Train Loss: 2.1178 | Train Acc: 0.5250
 Site-USPS            | Train Loss: 2.1471 | Train Acc: 0.5000
 Site-USPS            | Train Loss: 2.1329 | Train Acc: 0.4961
 Site-USPS            | Train Loss: 2.1171 | Train Acc: 0.4807
 Site-USPS            | Train Loss: 2.1115 | Train Acc: 0.4929
 Site-USPS            | Train Loss: 2.1167 | Train Acc: 0.4815
 Site-SynthDigits     | Train Loss: 2.2866 | Train Acc: 0.1258
 Site-SynthDigits     | Train Loss: 2.2830 | Train Acc: 0.1502
 Site-SynthDigits     | Train Loss: 2.2666 | Train Acc: 0.1935
 Site-MNIST-M         | Train Loss: 2.2863 | Train Acc: 0.1215
 Site-MNIST-M         | Train Loss: 2.2948 | Train Acc: 0.1254
 Site-SVHN            | Train Loss: 2.3102 | Train Acc: 0.0780
 Site-MNIST           | Val  Loss: 1.8726 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 2.0253 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 2.0553 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 2.1215 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 2.1378 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 2.1664 | Val  Acc: 0.3226
 Site-MNIST           | Val  Loss: 2.1559 | Val  Acc: 0.3750
 Site-MNIST           | Val  Loss: 2.1392 | Val  Acc: 0.4510
 Site-MNIST           | Val  Loss: 2.1273 | Val  Acc: 0.4699
 Site-MNIST           | Val  Loss: 2.1302 | Val  Acc: 0.4743
 Site-USPS            | Val  Loss: 2.0854 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.1544 | Val  Acc: 0.3889
 Site-USPS            | Val  Loss: 2.1172 | Val  Acc: 0.4688
 Site-USPS            | Val  Loss: 2.1459 | Val  Acc: 0.4483
 Site-USPS            | Val  Loss: 2.1239 | Val  Acc: 0.5143
 Site-USPS            | Val  Loss: 2.1076 | Val  Acc: 0.5132
 Site-SynthDigits     | Val  Loss: 2.3012 | Val  Acc: 0.1351
 Site-SynthDigits     | Val  Loss: 2.3103 | Val  Acc: 0.1765
 Site-SynthDigits     | Val  Loss: 2.2715 | Val  Acc: 0.1475
 Site-MNIST-M         | Val  Loss: 2.2761 | Val  Acc: 0.1111
 Site-MNIST-M         | Val  Loss: 2.2736 | Val  Acc: 0.1481
 Site-SVHN            | Val  Loss: 2.3197 | Val  Acc: 0.1143
Average Valid Accuracy: 0.4128
Aggregated Acc | Val Acc: 0.2822
 Best site-MNIST            | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:6 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:6 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:6 | Val Acc: 0.4118
 Best site-MNIST            | Epoch:6 | Val Acc: 0.3226
 Best site-MNIST            | Epoch:6 | Val Acc: 0.3750
 Best site-MNIST            | Epoch:6 | Val Acc: 0.4510
 Best site-MNIST            | Epoch:6 | Val Acc: 0.4699
 Best site-MNIST            | Epoch:6 | Val Acc: 0.4743
 Best site-USPS             | Epoch:6 | Val Acc: 0.5000
 Best site-USPS             | Epoch:6 | Val Acc: 0.3889
 Best site-USPS             | Epoch:6 | Val Acc: 0.4688
 Best site-USPS             | Epoch:6 | Val Acc: 0.4483
 Best site-USPS             | Epoch:6 | Val Acc: 0.5143
 Best site-USPS             | Epoch:6 | Val Acc: 0.5132
 Best site-SynthDigits      | Epoch:6 | Val Acc: 0.1351
 Best site-SynthDigits      | Epoch:6 | Val Acc: 0.1765
 Best site-SynthDigits      | Epoch:6 | Val Acc: 0.1475
 Best site-MNIST-M          | Epoch:6 | Val Acc: 0.1111
 Best site-MNIST-M          | Epoch:6 | Val Acc: 0.1481
 Best site-SVHN             | Epoch:6 | Val Acc: 0.1143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 7 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-0
client-20 is in G-0
client-21 is in G-3
cnt=[2, 2, 6, 4, 8, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.1055 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.1277 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 2.1121 | Train Acc: 0.5238
 Site-MNIST           | Train Loss: 2.0999 | Train Acc: 0.4737
 Site-MNIST           | Train Loss: 2.0217 | Train Acc: 0.6429
 Site-MNIST           | Train Loss: 2.0886 | Train Acc: 0.5397
 Site-MNIST           | Train Loss: 2.0892 | Train Acc: 0.5198
 Site-MNIST           | Train Loss: 2.1274 | Train Acc: 0.4352
 Site-MNIST           | Train Loss: 2.1075 | Train Acc: 0.4579
 Site-MNIST           | Train Loss: 2.0910 | Train Acc: 0.5109
 Site-USPS            | Train Loss: 2.0914 | Train Acc: 0.5250
 Site-USPS            | Train Loss: 2.1446 | Train Acc: 0.5000
 Site-USPS            | Train Loss: 2.0715 | Train Acc: 0.4961
 Site-USPS            | Train Loss: 2.0853 | Train Acc: 0.5021
 Site-USPS            | Train Loss: 2.0869 | Train Acc: 0.5048
 Site-USPS            | Train Loss: 2.0895 | Train Acc: 0.5026
 Site-SynthDigits     | Train Loss: 2.2841 | Train Acc: 0.1325
 Site-SynthDigits     | Train Loss: 2.2702 | Train Acc: 0.1538
 Site-SynthDigits     | Train Loss: 2.2612 | Train Acc: 0.2118
 Site-MNIST-M         | Train Loss: 2.2840 | Train Acc: 0.1215
 Site-MNIST-M         | Train Loss: 2.2849 | Train Acc: 0.1193
 Site-SVHN            | Train Loss: 2.3081 | Train Acc: 0.0851
 Site-MNIST           | Val  Loss: 1.8393 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.9962 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 2.0270 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 2.0981 | Val  Acc: 0.3333
 Site-MNIST           | Val  Loss: 2.1140 | Val  Acc: 0.3529
 Site-MNIST           | Val  Loss: 2.1420 | Val  Acc: 0.3871
 Site-MNIST           | Val  Loss: 2.1310 | Val  Acc: 0.4464
 Site-MNIST           | Val  Loss: 2.1135 | Val  Acc: 0.5000
 Site-MNIST           | Val  Loss: 2.1036 | Val  Acc: 0.4973
 Site-MNIST           | Val  Loss: 2.1054 | Val  Acc: 0.4894
 Site-USPS            | Val  Loss: 2.0606 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.1356 | Val  Acc: 0.3889
 Site-USPS            | Val  Loss: 2.0928 | Val  Acc: 0.4688
 Site-USPS            | Val  Loss: 2.1217 | Val  Acc: 0.4655
 Site-USPS            | Val  Loss: 2.0975 | Val  Acc: 0.5333
 Site-USPS            | Val  Loss: 2.0790 | Val  Acc: 0.5344
 Site-SynthDigits     | Val  Loss: 2.2972 | Val  Acc: 0.1351
 Site-SynthDigits     | Val  Loss: 2.3060 | Val  Acc: 0.1765
 Site-SynthDigits     | Val  Loss: 2.2667 | Val  Acc: 0.1475
 Site-MNIST-M         | Val  Loss: 2.2729 | Val  Acc: 0.1333
 Site-MNIST-M         | Val  Loss: 2.2702 | Val  Acc: 0.1605
 Site-SVHN            | Val  Loss: 2.3182 | Val  Acc: 0.1143
Average Valid Accuracy: 0.4105
Aggregated Acc | Val Acc: 0.4112
============ Train epoch 8 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.0865 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.1080 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 2.0882 | Train Acc: 0.5714
 Site-MNIST           | Train Loss: 2.0754 | Train Acc: 0.4737
 Site-MNIST           | Train Loss: 2.0292 | Train Acc: 0.6286
 Site-MNIST           | Train Loss: 2.0628 | Train Acc: 0.5556
 Site-MNIST           | Train Loss: 2.0648 | Train Acc: 0.5242
 Site-MNIST           | Train Loss: 2.0997 | Train Acc: 0.4499
 Site-MNIST           | Train Loss: 2.0842 | Train Acc: 0.4606
 Site-MNIST           | Train Loss: 2.0661 | Train Acc: 0.5268
 Site-USPS            | Train Loss: 2.0651 | Train Acc: 0.5250
 Site-USPS            | Train Loss: 2.0858 | Train Acc: 0.5139
 Site-USPS            | Train Loss: 1.9605 | Train Acc: 0.4884
 Site-USPS            | Train Loss: 2.0601 | Train Acc: 0.5021
 Site-USPS            | Train Loss: 2.0616 | Train Acc: 0.5071
 Site-USPS            | Train Loss: 2.0636 | Train Acc: 0.5106
 Site-SynthDigits     | Train Loss: 2.2818 | Train Acc: 0.1391
 Site-SynthDigits     | Train Loss: 2.2726 | Train Acc: 0.1612
 Site-SynthDigits     | Train Loss: 2.2548 | Train Acc: 0.2179
 Site-MNIST-M         | Train Loss: 2.2806 | Train Acc: 0.1326
 Site-MNIST-M         | Train Loss: 2.2751 | Train Acc: 0.1284
 Site-SVHN            | Train Loss: 2.3108 | Train Acc: 0.0993
 Site-MNIST           | Val  Loss: 1.8043 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.9671 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.9991 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 2.0760 | Val  Acc: 0.3333
 Site-MNIST           | Val  Loss: 2.0910 | Val  Acc: 0.3529
 Site-MNIST           | Val  Loss: 2.1180 | Val  Acc: 0.3871
 Site-MNIST           | Val  Loss: 2.1065 | Val  Acc: 0.4464
 Site-MNIST           | Val  Loss: 2.0884 | Val  Acc: 0.5196
 Site-MNIST           | Val  Loss: 2.0809 | Val  Acc: 0.5082
 Site-MNIST           | Val  Loss: 2.0814 | Val  Acc: 0.4985
 Site-USPS            | Val  Loss: 2.0365 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.1173 | Val  Acc: 0.3889
 Site-USPS            | Val  Loss: 2.0684 | Val  Acc: 0.4688
 Site-USPS            | Val  Loss: 2.0975 | Val  Acc: 0.4828
 Site-USPS            | Val  Loss: 2.0711 | Val  Acc: 0.5333
 Site-USPS            | Val  Loss: 2.0511 | Val  Acc: 0.5344
 Site-SynthDigits     | Val  Loss: 2.2932 | Val  Acc: 0.1351
 Site-SynthDigits     | Val  Loss: 2.3020 | Val  Acc: 0.1765
 Site-SynthDigits     | Val  Loss: 2.2618 | Val  Acc: 0.1475
 Site-MNIST-M         | Val  Loss: 2.2698 | Val  Acc: 0.1556
 Site-MNIST-M         | Val  Loss: 2.2667 | Val  Acc: 0.1852
 Site-SVHN            | Val  Loss: 2.3167 | Val  Acc: 0.1143
Average Valid Accuracy: 0.4152
Aggregated Acc | Val Acc: 0.2907
 Best site-MNIST            | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:8 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:8 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:8 | Val Acc: 0.3333
 Best site-MNIST            | Epoch:8 | Val Acc: 0.3529
 Best site-MNIST            | Epoch:8 | Val Acc: 0.3871
 Best site-MNIST            | Epoch:8 | Val Acc: 0.4464
 Best site-MNIST            | Epoch:8 | Val Acc: 0.5196
 Best site-MNIST            | Epoch:8 | Val Acc: 0.5082
 Best site-MNIST            | Epoch:8 | Val Acc: 0.4985
 Best site-USPS             | Epoch:8 | Val Acc: 0.5000
 Best site-USPS             | Epoch:8 | Val Acc: 0.3889
 Best site-USPS             | Epoch:8 | Val Acc: 0.4688
 Best site-USPS             | Epoch:8 | Val Acc: 0.4828
 Best site-USPS             | Epoch:8 | Val Acc: 0.5333
 Best site-USPS             | Epoch:8 | Val Acc: 0.5344
 Best site-SynthDigits      | Epoch:8 | Val Acc: 0.1351
 Best site-SynthDigits      | Epoch:8 | Val Acc: 0.1765
 Best site-SynthDigits      | Epoch:8 | Val Acc: 0.1475
 Best site-MNIST-M          | Epoch:8 | Val Acc: 0.1556
 Best site-MNIST-M          | Epoch:8 | Val Acc: 0.1852
 Best site-SVHN             | Epoch:8 | Val Acc: 0.1143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 9 ============
gmm
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 6, 9, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.0689 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.0889 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 2.0656 | Train Acc: 0.6190
 Site-MNIST           | Train Loss: 2.0515 | Train Acc: 0.4474
 Site-MNIST           | Train Loss: 1.9545 | Train Acc: 0.6429
 Site-MNIST           | Train Loss: 2.0385 | Train Acc: 0.5556
 Site-MNIST           | Train Loss: 2.0440 | Train Acc: 0.5198
 Site-MNIST           | Train Loss: 2.0859 | Train Acc: 0.4621
 Site-MNIST           | Train Loss: 2.0623 | Train Acc: 0.4606
 Site-MNIST           | Train Loss: 2.0413 | Train Acc: 0.5306
 Site-USPS            | Train Loss: 2.0392 | Train Acc: 0.5250
 Site-USPS            | Train Loss: 2.0679 | Train Acc: 0.5000
 Site-USPS            | Train Loss: 2.0558 | Train Acc: 0.4961
 Site-USPS            | Train Loss: 2.0405 | Train Acc: 0.5021
 Site-USPS            | Train Loss: 2.0359 | Train Acc: 0.5262
 Site-USPS            | Train Loss: 2.0373 | Train Acc: 0.5212
 Site-SynthDigits     | Train Loss: 2.2709 | Train Acc: 0.1457
 Site-SynthDigits     | Train Loss: 2.2674 | Train Acc: 0.1758
 Site-SynthDigits     | Train Loss: 2.2490 | Train Acc: 0.2281
 Site-MNIST-M         | Train Loss: 2.2780 | Train Acc: 0.1436
 Site-MNIST-M         | Train Loss: 2.2666 | Train Acc: 0.1376
 Site-SVHN            | Train Loss: 2.3066 | Train Acc: 0.0993
 Site-MNIST           | Val  Loss: 1.7673 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.9383 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.9715 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 2.0548 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 2.0690 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 2.0955 | Val  Acc: 0.4194
 Site-MNIST           | Val  Loss: 2.0832 | Val  Acc: 0.4464
 Site-MNIST           | Val  Loss: 2.0643 | Val  Acc: 0.5196
 Site-MNIST           | Val  Loss: 2.0590 | Val  Acc: 0.5137
 Site-MNIST           | Val  Loss: 2.0584 | Val  Acc: 0.5015
 Site-USPS            | Val  Loss: 2.0130 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.0989 | Val  Acc: 0.3889
 Site-USPS            | Val  Loss: 2.0437 | Val  Acc: 0.4688
 Site-USPS            | Val  Loss: 2.0734 | Val  Acc: 0.4828
 Site-USPS            | Val  Loss: 2.0450 | Val  Acc: 0.5333
 Site-USPS            | Val  Loss: 2.0237 | Val  Acc: 0.5397
 Site-SynthDigits     | Val  Loss: 2.2894 | Val  Acc: 0.1892
 Site-SynthDigits     | Val  Loss: 2.2981 | Val  Acc: 0.2059
 Site-SynthDigits     | Val  Loss: 2.2569 | Val  Acc: 0.1639
 Site-MNIST-M         | Val  Loss: 2.2664 | Val  Acc: 0.1556
 Site-MNIST-M         | Val  Loss: 2.2630 | Val  Acc: 0.1728
 Site-SVHN            | Val  Loss: 2.3152 | Val  Acc: 0.1143
Average Valid Accuracy: 0.4290
Aggregated Acc | Val Acc: 0.4641
 Best site-MNIST            | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:9 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:9 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:9 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:9 | Val Acc: 0.4118
 Best site-MNIST            | Epoch:9 | Val Acc: 0.4194
 Best site-MNIST            | Epoch:9 | Val Acc: 0.4464
 Best site-MNIST            | Epoch:9 | Val Acc: 0.5196
 Best site-MNIST            | Epoch:9 | Val Acc: 0.5137
 Best site-MNIST            | Epoch:9 | Val Acc: 0.5015
 Best site-USPS             | Epoch:9 | Val Acc: 0.5000
 Best site-USPS             | Epoch:9 | Val Acc: 0.3889
 Best site-USPS             | Epoch:9 | Val Acc: 0.4688
 Best site-USPS             | Epoch:9 | Val Acc: 0.4828
 Best site-USPS             | Epoch:9 | Val Acc: 0.5333
 Best site-USPS             | Epoch:9 | Val Acc: 0.5397
 Best site-SynthDigits      | Epoch:9 | Val Acc: 0.1892
 Best site-SynthDigits      | Epoch:9 | Val Acc: 0.2059
 Best site-SynthDigits      | Epoch:9 | Val Acc: 0.1639
 Best site-MNIST-M          | Epoch:9 | Val Acc: 0.1556
 Best site-MNIST-M          | Epoch:9 | Val Acc: 0.1728
 Best site-SVHN             | Epoch:9 | Val Acc: 0.1143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
 Test site-MNIST           | Epoch:9 | Test Acc: 0.4844
 Test site-USPS            | Epoch:9 | Test Acc: 0.5355
 Test site-SynthDigits     | Epoch:9 | Test Acc: 0.2014
 Test site-MNIST-M         | Epoch:9 | Test Acc: 0.1549
 Test site-SVHN            | Epoch:9 | Test Acc: 0.1287
Average Test Accuracy: 0.3010
============ Train epoch 10 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.0513 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.0685 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 2.0424 | Train Acc: 0.6190
 Site-MNIST           | Train Loss: 2.0274 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.9703 | Train Acc: 0.6571
 Site-MNIST           | Train Loss: 2.0143 | Train Acc: 0.6111
 Site-MNIST           | Train Loss: 2.0099 | Train Acc: 0.5242
 Site-MNIST           | Train Loss: 2.0619 | Train Acc: 0.4670
 Site-MNIST           | Train Loss: 2.0361 | Train Acc: 0.4796
 Site-MNIST           | Train Loss: 2.0166 | Train Acc: 0.5426
 Site-USPS            | Train Loss: 2.0152 | Train Acc: 0.5250
 Site-USPS            | Train Loss: 2.0130 | Train Acc: 0.5000
 Site-USPS            | Train Loss: 1.8778 | Train Acc: 0.4961
 Site-USPS            | Train Loss: 2.0097 | Train Acc: 0.5064
 Site-USPS            | Train Loss: 2.0117 | Train Acc: 0.5405
 Site-USPS            | Train Loss: 2.0130 | Train Acc: 0.5397
 Site-SynthDigits     | Train Loss: 2.2778 | Train Acc: 0.1457
 Site-SynthDigits     | Train Loss: 2.2511 | Train Acc: 0.1941
 Site-SynthDigits     | Train Loss: 2.2420 | Train Acc: 0.2424
 Site-MNIST-M         | Train Loss: 2.2750 | Train Acc: 0.1492
 Site-MNIST-M         | Train Loss: 2.2658 | Train Acc: 0.1407
 Site-SVHN            | Train Loss: 2.3041 | Train Acc: 0.0993
 Site-MNIST           | Val  Loss: 1.7395 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.9134 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.9458 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 2.0344 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 2.0474 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 2.0731 | Val  Acc: 0.4194
 Site-MNIST           | Val  Loss: 2.0596 | Val  Acc: 0.4643
 Site-MNIST           | Val  Loss: 2.0402 | Val  Acc: 0.5294
 Site-MNIST           | Val  Loss: 2.0367 | Val  Acc: 0.5246
 Site-MNIST           | Val  Loss: 2.0350 | Val  Acc: 0.5045
 Site-USPS            | Val  Loss: 1.9893 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 2.0812 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 2.0209 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.0504 | Val  Acc: 0.4828
 Site-USPS            | Val  Loss: 2.0202 | Val  Acc: 0.5333
 Site-USPS            | Val  Loss: 1.9974 | Val  Acc: 0.5397
 Site-SynthDigits     | Val  Loss: 2.2860 | Val  Acc: 0.1892
 Site-SynthDigits     | Val  Loss: 2.2948 | Val  Acc: 0.2206
 Site-SynthDigits     | Val  Loss: 2.2522 | Val  Acc: 0.1721
 Site-MNIST-M         | Val  Loss: 2.2634 | Val  Acc: 0.1556
 Site-MNIST-M         | Val  Loss: 2.2600 | Val  Acc: 0.1728
 Site-SVHN            | Val  Loss: 2.3137 | Val  Acc: 0.1143
Average Valid Accuracy: 0.4404
Aggregated Acc | Val Acc: 0.3091
 Best site-MNIST            | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:10 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:10 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:10 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:10 | Val Acc: 0.4118
 Best site-MNIST            | Epoch:10 | Val Acc: 0.4194
 Best site-MNIST            | Epoch:10 | Val Acc: 0.4643
 Best site-MNIST            | Epoch:10 | Val Acc: 0.5294
 Best site-MNIST            | Epoch:10 | Val Acc: 0.5246
 Best site-MNIST            | Epoch:10 | Val Acc: 0.5045
 Best site-USPS             | Epoch:10 | Val Acc: 0.6000
 Best site-USPS             | Epoch:10 | Val Acc: 0.4444
 Best site-USPS             | Epoch:10 | Val Acc: 0.5000
 Best site-USPS             | Epoch:10 | Val Acc: 0.4828
 Best site-USPS             | Epoch:10 | Val Acc: 0.5333
 Best site-USPS             | Epoch:10 | Val Acc: 0.5397
 Best site-SynthDigits      | Epoch:10 | Val Acc: 0.1892
 Best site-SynthDigits      | Epoch:10 | Val Acc: 0.2206
 Best site-SynthDigits      | Epoch:10 | Val Acc: 0.1721
 Best site-MNIST-M          | Epoch:10 | Val Acc: 0.1556
 Best site-MNIST-M          | Epoch:10 | Val Acc: 0.1728
 Best site-SVHN             | Epoch:10 | Val Acc: 0.1143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 11 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
client-11 is in G-4
client-12 is in G-4
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-1
cnt=[1, 4, 9, 2, 6, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.0336 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.0486 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 2.0202 | Train Acc: 0.5714
 Site-MNIST           | Train Loss: 2.0044 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.9356 | Train Acc: 0.6571
 Site-MNIST           | Train Loss: 1.9908 | Train Acc: 0.6190
 Site-MNIST           | Train Loss: 1.9917 | Train Acc: 0.5198
 Site-MNIST           | Train Loss: 2.0388 | Train Acc: 0.4743
 Site-MNIST           | Train Loss: 2.0141 | Train Acc: 0.4851
 Site-MNIST           | Train Loss: 1.9938 | Train Acc: 0.5487
 Site-USPS            | Train Loss: 1.9907 | Train Acc: 0.5500
 Site-USPS            | Train Loss: 2.0272 | Train Acc: 0.5278
 Site-USPS            | Train Loss: 1.9040 | Train Acc: 0.4961
 Site-USPS            | Train Loss: 1.9829 | Train Acc: 0.5107
 Site-USPS            | Train Loss: 1.9854 | Train Acc: 0.5405
 Site-USPS            | Train Loss: 1.9873 | Train Acc: 0.5437
 Site-SynthDigits     | Train Loss: 2.2743 | Train Acc: 0.1656
 Site-SynthDigits     | Train Loss: 2.2600 | Train Acc: 0.1868
 Site-SynthDigits     | Train Loss: 2.2361 | Train Acc: 0.2444
 Site-MNIST-M         | Train Loss: 2.2728 | Train Acc: 0.1436
 Site-MNIST-M         | Train Loss: 2.2857 | Train Acc: 0.1468
 Site-SVHN            | Train Loss: 2.2981 | Train Acc: 0.1099
 Site-MNIST           | Val  Loss: 1.7059 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.8883 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.9208 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 2.0149 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 2.0267 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 2.0520 | Val  Acc: 0.4194
 Site-MNIST           | Val  Loss: 2.0374 | Val  Acc: 0.4821
 Site-MNIST           | Val  Loss: 2.0171 | Val  Acc: 0.5392
 Site-MNIST           | Val  Loss: 2.0154 | Val  Acc: 0.5410
 Site-MNIST           | Val  Loss: 2.0128 | Val  Acc: 0.5045
 Site-USPS            | Val  Loss: 1.9654 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 2.0632 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.9970 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.0272 | Val  Acc: 0.4828
 Site-USPS            | Val  Loss: 1.9956 | Val  Acc: 0.5333
 Site-USPS            | Val  Loss: 1.9716 | Val  Acc: 0.5450
 Site-SynthDigits     | Val  Loss: 2.2823 | Val  Acc: 0.1892
 Site-SynthDigits     | Val  Loss: 2.2916 | Val  Acc: 0.2206
 Site-SynthDigits     | Val  Loss: 2.2477 | Val  Acc: 0.1721
 Site-MNIST-M         | Val  Loss: 2.2602 | Val  Acc: 0.1556
 Site-MNIST-M         | Val  Loss: 2.2567 | Val  Acc: 0.1728
 Site-SVHN            | Val  Loss: 2.3128 | Val  Acc: 0.1286
Average Valid Accuracy: 0.4433
Aggregated Acc | Val Acc: 0.4743
 Best site-MNIST            | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:11 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:11 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:11 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:11 | Val Acc: 0.4118
 Best site-MNIST            | Epoch:11 | Val Acc: 0.4194
 Best site-MNIST            | Epoch:11 | Val Acc: 0.4821
 Best site-MNIST            | Epoch:11 | Val Acc: 0.5392
 Best site-MNIST            | Epoch:11 | Val Acc: 0.5410
 Best site-MNIST            | Epoch:11 | Val Acc: 0.5045
 Best site-USPS             | Epoch:11 | Val Acc: 0.6000
 Best site-USPS             | Epoch:11 | Val Acc: 0.4444
 Best site-USPS             | Epoch:11 | Val Acc: 0.5000
 Best site-USPS             | Epoch:11 | Val Acc: 0.4828
 Best site-USPS             | Epoch:11 | Val Acc: 0.5333
 Best site-USPS             | Epoch:11 | Val Acc: 0.5450
 Best site-SynthDigits      | Epoch:11 | Val Acc: 0.1892
 Best site-SynthDigits      | Epoch:11 | Val Acc: 0.2206
 Best site-SynthDigits      | Epoch:11 | Val Acc: 0.1721
 Best site-MNIST-M          | Epoch:11 | Val Acc: 0.1556
 Best site-MNIST-M          | Epoch:11 | Val Acc: 0.1728
 Best site-SVHN             | Epoch:11 | Val Acc: 0.1286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 12 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.0175 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.0293 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.9983 | Train Acc: 0.5714
 Site-MNIST           | Train Loss: 1.9819 | Train Acc: 0.5526
 Site-MNIST           | Train Loss: 1.9828 | Train Acc: 0.6714
 Site-MNIST           | Train Loss: 1.9692 | Train Acc: 0.6349
 Site-MNIST           | Train Loss: 1.9743 | Train Acc: 0.5419
 Site-MNIST           | Train Loss: 2.0207 | Train Acc: 0.4817
 Site-MNIST           | Train Loss: 1.9949 | Train Acc: 0.4878
 Site-MNIST           | Train Loss: 1.9721 | Train Acc: 0.5509
 Site-USPS            | Train Loss: 1.9673 | Train Acc: 0.5250
 Site-USPS            | Train Loss: 1.8844 | Train Acc: 0.5556
 Site-USPS            | Train Loss: 2.0360 | Train Acc: 0.5426
 Site-USPS            | Train Loss: 1.9668 | Train Acc: 0.5107
 Site-USPS            | Train Loss: 1.9635 | Train Acc: 0.5500
 Site-USPS            | Train Loss: 1.9637 | Train Acc: 0.5516
 Site-SynthDigits     | Train Loss: 2.2666 | Train Acc: 0.1788
 Site-SynthDigits     | Train Loss: 2.2603 | Train Acc: 0.1905
 Site-SynthDigits     | Train Loss: 2.2310 | Train Acc: 0.2485
 Site-MNIST-M         | Train Loss: 2.2697 | Train Acc: 0.1492
 Site-MNIST-M         | Train Loss: 2.2729 | Train Acc: 0.1651
 Site-SVHN            | Train Loss: 2.2984 | Train Acc: 0.1135
 Site-MNIST           | Val  Loss: 1.6781 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.8653 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.8973 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.9961 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 2.0061 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 2.0311 | Val  Acc: 0.4194
 Site-MNIST           | Val  Loss: 2.0155 | Val  Acc: 0.4821
 Site-MNIST           | Val  Loss: 1.9949 | Val  Acc: 0.5588
 Site-MNIST           | Val  Loss: 1.9949 | Val  Acc: 0.5519
 Site-MNIST           | Val  Loss: 1.9914 | Val  Acc: 0.5196
 Site-USPS            | Val  Loss: 1.9426 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 2.0460 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.9740 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 2.0046 | Val  Acc: 0.4828
 Site-USPS            | Val  Loss: 1.9715 | Val  Acc: 0.5333
 Site-USPS            | Val  Loss: 1.9466 | Val  Acc: 0.5450
 Site-SynthDigits     | Val  Loss: 2.2787 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2883 | Val  Acc: 0.2353
 Site-SynthDigits     | Val  Loss: 2.2431 | Val  Acc: 0.1885
 Site-MNIST-M         | Val  Loss: 2.2572 | Val  Acc: 0.1778
 Site-MNIST-M         | Val  Loss: 2.2537 | Val  Acc: 0.1852
 Site-SVHN            | Val  Loss: 2.3119 | Val  Acc: 0.1286
Average Valid Accuracy: 0.4496
Aggregated Acc | Val Acc: 0.3213
 Best site-MNIST            | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:12 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:12 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:12 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:12 | Val Acc: 0.4118
 Best site-MNIST            | Epoch:12 | Val Acc: 0.4194
 Best site-MNIST            | Epoch:12 | Val Acc: 0.4821
 Best site-MNIST            | Epoch:12 | Val Acc: 0.5588
 Best site-MNIST            | Epoch:12 | Val Acc: 0.5519
 Best site-MNIST            | Epoch:12 | Val Acc: 0.5196
 Best site-USPS             | Epoch:12 | Val Acc: 0.6000
 Best site-USPS             | Epoch:12 | Val Acc: 0.4444
 Best site-USPS             | Epoch:12 | Val Acc: 0.5000
 Best site-USPS             | Epoch:12 | Val Acc: 0.4828
 Best site-USPS             | Epoch:12 | Val Acc: 0.5333
 Best site-USPS             | Epoch:12 | Val Acc: 0.5450
 Best site-SynthDigits      | Epoch:12 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:12 | Val Acc: 0.2353
 Best site-SynthDigits      | Epoch:12 | Val Acc: 0.1885
 Best site-MNIST-M          | Epoch:12 | Val Acc: 0.1778
 Best site-MNIST-M          | Epoch:12 | Val Acc: 0.1852
 Best site-SVHN             | Epoch:12 | Val Acc: 0.1286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 13 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 2.0035 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 2.0111 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.9760 | Train Acc: 0.5714
 Site-MNIST           | Train Loss: 1.9601 | Train Acc: 0.5789
 Site-MNIST           | Train Loss: 1.8348 | Train Acc: 0.6714
 Site-MNIST           | Train Loss: 1.9476 | Train Acc: 0.6349
 Site-MNIST           | Train Loss: 1.9410 | Train Acc: 0.5551
 Site-MNIST           | Train Loss: 2.0050 | Train Acc: 0.4866
 Site-MNIST           | Train Loss: 1.9760 | Train Acc: 0.4946
 Site-MNIST           | Train Loss: 1.9511 | Train Acc: 0.5570
 Site-USPS            | Train Loss: 1.9443 | Train Acc: 0.6000
 Site-USPS            | Train Loss: 1.9333 | Train Acc: 0.5694
 Site-USPS            | Train Loss: 2.0638 | Train Acc: 0.5504
 Site-USPS            | Train Loss: 1.9312 | Train Acc: 0.5193
 Site-USPS            | Train Loss: 1.9410 | Train Acc: 0.5524
 Site-USPS            | Train Loss: 1.9405 | Train Acc: 0.5582
 Site-SynthDigits     | Train Loss: 2.2650 | Train Acc: 0.1788
 Site-SynthDigits     | Train Loss: 2.2452 | Train Acc: 0.2051
 Site-SynthDigits     | Train Loss: 2.2256 | Train Acc: 0.2525
 Site-MNIST-M         | Train Loss: 2.2679 | Train Acc: 0.1713
 Site-MNIST-M         | Train Loss: 2.2685 | Train Acc: 0.1774
 Site-SVHN            | Train Loss: 2.2984 | Train Acc: 0.1135
 Site-MNIST           | Val  Loss: 1.6491 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.8420 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.8736 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.9779 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.9862 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 2.0112 | Val  Acc: 0.4194
 Site-MNIST           | Val  Loss: 1.9944 | Val  Acc: 0.4821
 Site-MNIST           | Val  Loss: 1.9733 | Val  Acc: 0.5588
 Site-MNIST           | Val  Loss: 1.9750 | Val  Acc: 0.5519
 Site-MNIST           | Val  Loss: 1.9707 | Val  Acc: 0.5287
 Site-USPS            | Val  Loss: 1.9200 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 2.0288 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.9515 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.9823 | Val  Acc: 0.4828
 Site-USPS            | Val  Loss: 1.9477 | Val  Acc: 0.5333
 Site-USPS            | Val  Loss: 1.9220 | Val  Acc: 0.5503
 Site-SynthDigits     | Val  Loss: 2.2750 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2850 | Val  Acc: 0.2353
 Site-SynthDigits     | Val  Loss: 2.2385 | Val  Acc: 0.2213
 Site-MNIST-M         | Val  Loss: 2.2541 | Val  Acc: 0.1778
 Site-MNIST-M         | Val  Loss: 2.2503 | Val  Acc: 0.2222
 Site-SVHN            | Val  Loss: 2.3111 | Val  Acc: 0.1286
Average Valid Accuracy: 0.4535
Aggregated Acc | Val Acc: 0.3275
 Best site-MNIST            | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:13 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:13 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:13 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:13 | Val Acc: 0.4118
 Best site-MNIST            | Epoch:13 | Val Acc: 0.4194
 Best site-MNIST            | Epoch:13 | Val Acc: 0.4821
 Best site-MNIST            | Epoch:13 | Val Acc: 0.5588
 Best site-MNIST            | Epoch:13 | Val Acc: 0.5519
 Best site-MNIST            | Epoch:13 | Val Acc: 0.5287
 Best site-USPS             | Epoch:13 | Val Acc: 0.6000
 Best site-USPS             | Epoch:13 | Val Acc: 0.4444
 Best site-USPS             | Epoch:13 | Val Acc: 0.5000
 Best site-USPS             | Epoch:13 | Val Acc: 0.4828
 Best site-USPS             | Epoch:13 | Val Acc: 0.5333
 Best site-USPS             | Epoch:13 | Val Acc: 0.5503
 Best site-SynthDigits      | Epoch:13 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:13 | Val Acc: 0.2353
 Best site-SynthDigits      | Epoch:13 | Val Acc: 0.2213
 Best site-MNIST-M          | Epoch:13 | Val Acc: 0.1778
 Best site-MNIST-M          | Epoch:13 | Val Acc: 0.2222
 Best site-SVHN             | Epoch:13 | Val Acc: 0.1286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-1
client-20 is in G-1
client-21 is in G-4
cnt=[10, 2, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.9870 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.9925 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.9548 | Train Acc: 0.6190
 Site-MNIST           | Train Loss: 1.9382 | Train Acc: 0.5789
 Site-MNIST           | Train Loss: 1.9049 | Train Acc: 0.6714
 Site-MNIST           | Train Loss: 1.9252 | Train Acc: 0.6429
 Site-MNIST           | Train Loss: 1.9309 | Train Acc: 0.5639
 Site-MNIST           | Train Loss: 1.9750 | Train Acc: 0.4890
 Site-MNIST           | Train Loss: 1.9559 | Train Acc: 0.5027
 Site-MNIST           | Train Loss: 1.9281 | Train Acc: 0.5660
 Site-USPS            | Train Loss: 1.9228 | Train Acc: 0.6000
 Site-USPS            | Train Loss: 1.9352 | Train Acc: 0.5694
 Site-USPS            | Train Loss: 1.9281 | Train Acc: 0.5659
 Site-USPS            | Train Loss: 1.9105 | Train Acc: 0.5279
 Site-USPS            | Train Loss: 1.9192 | Train Acc: 0.5571
 Site-USPS            | Train Loss: 1.9196 | Train Acc: 0.5701
 Site-SynthDigits     | Train Loss: 2.2470 | Train Acc: 0.1788
 Site-SynthDigits     | Train Loss: 2.2468 | Train Acc: 0.1978
 Site-SynthDigits     | Train Loss: 2.2211 | Train Acc: 0.2627
 Site-MNIST-M         | Train Loss: 2.2664 | Train Acc: 0.1713
 Site-MNIST-M         | Train Loss: 2.2587 | Train Acc: 0.1896
 Site-SVHN            | Train Loss: 2.2967 | Train Acc: 0.1241
 Site-MNIST           | Val  Loss: 1.6256 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.8216 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.8523 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.9601 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.9667 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.9910 | Val  Acc: 0.4839
 Site-MNIST           | Val  Loss: 1.9732 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.9519 | Val  Acc: 0.5686
 Site-MNIST           | Val  Loss: 1.9551 | Val  Acc: 0.5519
 Site-MNIST           | Val  Loss: 1.9501 | Val  Acc: 0.5257
 Site-USPS            | Val  Loss: 1.8976 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 2.0124 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.9308 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.9617 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.9256 | Val  Acc: 0.5429
 Site-USPS            | Val  Loss: 1.8987 | Val  Acc: 0.5556
 Site-SynthDigits     | Val  Loss: 2.2714 | Val  Acc: 0.1892
 Site-SynthDigits     | Val  Loss: 2.2821 | Val  Acc: 0.2059
 Site-SynthDigits     | Val  Loss: 2.2341 | Val  Acc: 0.2049
 Site-MNIST-M         | Val  Loss: 2.2510 | Val  Acc: 0.1778
 Site-MNIST-M         | Val  Loss: 2.2473 | Val  Acc: 0.2222
 Site-SVHN            | Val  Loss: 2.3102 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4604
Aggregated Acc | Val Acc: 0.3328
 Best site-MNIST            | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:14 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:14 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:14 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:14 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:14 | Val Acc: 0.4839
 Best site-MNIST            | Epoch:14 | Val Acc: 0.5179
 Best site-MNIST            | Epoch:14 | Val Acc: 0.5686
 Best site-MNIST            | Epoch:14 | Val Acc: 0.5519
 Best site-MNIST            | Epoch:14 | Val Acc: 0.5257
 Best site-USPS             | Epoch:14 | Val Acc: 0.6000
 Best site-USPS             | Epoch:14 | Val Acc: 0.4444
 Best site-USPS             | Epoch:14 | Val Acc: 0.5000
 Best site-USPS             | Epoch:14 | Val Acc: 0.5000
 Best site-USPS             | Epoch:14 | Val Acc: 0.5429
 Best site-USPS             | Epoch:14 | Val Acc: 0.5556
 Best site-SynthDigits      | Epoch:14 | Val Acc: 0.1892
 Best site-SynthDigits      | Epoch:14 | Val Acc: 0.2059
 Best site-SynthDigits      | Epoch:14 | Val Acc: 0.2049
 Best site-MNIST-M          | Epoch:14 | Val Acc: 0.1778
 Best site-MNIST-M          | Epoch:14 | Val Acc: 0.2222
 Best site-SVHN             | Epoch:14 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 15 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.9725 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.9749 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.9336 | Train Acc: 0.6190
 Site-MNIST           | Train Loss: 1.9172 | Train Acc: 0.5789
 Site-MNIST           | Train Loss: 1.7330 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.9053 | Train Acc: 0.6508
 Site-MNIST           | Train Loss: 1.9034 | Train Acc: 0.5639
 Site-MNIST           | Train Loss: 1.9715 | Train Acc: 0.4963
 Site-MNIST           | Train Loss: 1.9366 | Train Acc: 0.5095
 Site-MNIST           | Train Loss: 1.9066 | Train Acc: 0.5706
 Site-USPS            | Train Loss: 1.9011 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.9564 | Train Acc: 0.5694
 Site-USPS            | Train Loss: 1.7258 | Train Acc: 0.5736
 Site-USPS            | Train Loss: 1.8951 | Train Acc: 0.5279
 Site-USPS            | Train Loss: 1.8925 | Train Acc: 0.5690
 Site-USPS            | Train Loss: 1.8960 | Train Acc: 0.5767
 Site-SynthDigits     | Train Loss: 2.2537 | Train Acc: 0.1921
 Site-SynthDigits     | Train Loss: 2.2371 | Train Acc: 0.2051
 Site-SynthDigits     | Train Loss: 2.2155 | Train Acc: 0.2770
 Site-MNIST-M         | Train Loss: 2.2631 | Train Acc: 0.1823
 Site-MNIST-M         | Train Loss: 2.2573 | Train Acc: 0.1988
 Site-SVHN            | Train Loss: 2.2962 | Train Acc: 0.1241
 Site-MNIST           | Val  Loss: 1.5981 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.8003 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.8306 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.9431 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.9478 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.9718 | Val  Acc: 0.4839
 Site-MNIST           | Val  Loss: 1.9529 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.9311 | Val  Acc: 0.5686
 Site-MNIST           | Val  Loss: 1.9359 | Val  Acc: 0.5574
 Site-MNIST           | Val  Loss: 1.9301 | Val  Acc: 0.5287
 Site-USPS            | Val  Loss: 1.8752 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 1.9961 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.9101 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.9411 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.9034 | Val  Acc: 0.5429
 Site-USPS            | Val  Loss: 1.8755 | Val  Acc: 0.5556
 Site-SynthDigits     | Val  Loss: 2.2679 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2793 | Val  Acc: 0.2206
 Site-SynthDigits     | Val  Loss: 2.2297 | Val  Acc: 0.2213
 Site-MNIST-M         | Val  Loss: 2.2480 | Val  Acc: 0.1778
 Site-MNIST-M         | Val  Loss: 2.2441 | Val  Acc: 0.2222
 Site-SVHN            | Val  Loss: 2.3092 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4635
Aggregated Acc | Val Acc: 0.3368
 Best site-MNIST            | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:15 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:15 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:15 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:15 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:15 | Val Acc: 0.4839
 Best site-MNIST            | Epoch:15 | Val Acc: 0.5179
 Best site-MNIST            | Epoch:15 | Val Acc: 0.5686
 Best site-MNIST            | Epoch:15 | Val Acc: 0.5574
 Best site-MNIST            | Epoch:15 | Val Acc: 0.5287
 Best site-USPS             | Epoch:15 | Val Acc: 0.6000
 Best site-USPS             | Epoch:15 | Val Acc: 0.4444
 Best site-USPS             | Epoch:15 | Val Acc: 0.5000
 Best site-USPS             | Epoch:15 | Val Acc: 0.5000
 Best site-USPS             | Epoch:15 | Val Acc: 0.5429
 Best site-USPS             | Epoch:15 | Val Acc: 0.5556
 Best site-SynthDigits      | Epoch:15 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:15 | Val Acc: 0.2206
 Best site-SynthDigits      | Epoch:15 | Val Acc: 0.2213
 Best site-MNIST-M          | Epoch:15 | Val Acc: 0.1778
 Best site-MNIST-M          | Epoch:15 | Val Acc: 0.2222
 Best site-SVHN             | Epoch:15 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 16 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-0
client-20 is in G-0
client-21 is in G-0
cnt=[3, 8, 3, 6, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.9587 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.9579 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.9129 | Train Acc: 0.6190
 Site-MNIST           | Train Loss: 1.8966 | Train Acc: 0.5789
 Site-MNIST           | Train Loss: 1.7033 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.8847 | Train Acc: 0.6587
 Site-MNIST           | Train Loss: 1.8897 | Train Acc: 0.5683
 Site-MNIST           | Train Loss: 1.9533 | Train Acc: 0.4939
 Site-MNIST           | Train Loss: 1.9154 | Train Acc: 0.5163
 Site-MNIST           | Train Loss: 1.8882 | Train Acc: 0.5774
 Site-USPS            | Train Loss: 1.8799 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.8929 | Train Acc: 0.5833
 Site-USPS            | Train Loss: 1.9431 | Train Acc: 0.5736
 Site-USPS            | Train Loss: 1.8676 | Train Acc: 0.5322
 Site-USPS            | Train Loss: 1.8750 | Train Acc: 0.5690
 Site-USPS            | Train Loss: 1.8740 | Train Acc: 0.5833
 Site-SynthDigits     | Train Loss: 2.2408 | Train Acc: 0.1921
 Site-SynthDigits     | Train Loss: 2.2428 | Train Acc: 0.2051
 Site-SynthDigits     | Train Loss: 2.2083 | Train Acc: 0.2749
 Site-MNIST-M         | Train Loss: 2.2604 | Train Acc: 0.1878
 Site-MNIST-M         | Train Loss: 2.2639 | Train Acc: 0.2080
 Site-SVHN            | Train Loss: 2.2927 | Train Acc: 0.1277
 Site-MNIST           | Val  Loss: 1.5740 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.7792 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.8092 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.9259 | Val  Acc: 0.3333
 Site-MNIST           | Val  Loss: 1.9289 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 1.9529 | Val  Acc: 0.4516
 Site-MNIST           | Val  Loss: 1.9331 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.9109 | Val  Acc: 0.5686
 Site-MNIST           | Val  Loss: 1.9171 | Val  Acc: 0.5574
 Site-MNIST           | Val  Loss: 1.9105 | Val  Acc: 0.5347
 Site-USPS            | Val  Loss: 1.8538 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 1.9806 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.8901 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.9212 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8820 | Val  Acc: 0.5524
 Site-USPS            | Val  Loss: 1.8530 | Val  Acc: 0.5608
 Site-SynthDigits     | Val  Loss: 2.2646 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2763 | Val  Acc: 0.2206
 Site-SynthDigits     | Val  Loss: 2.2254 | Val  Acc: 0.2213
 Site-MNIST-M         | Val  Loss: 2.2450 | Val  Acc: 0.2000
 Site-MNIST-M         | Val  Loss: 2.2411 | Val  Acc: 0.2469
 Site-SVHN            | Val  Loss: 2.3080 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4574
Aggregated Acc | Val Acc: 0.4555
============ Train epoch 17 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.9441 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.9405 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.8926 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8764 | Train Acc: 0.6053
 Site-MNIST           | Train Loss: 1.7841 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.8642 | Train Acc: 0.6746
 Site-MNIST           | Train Loss: 1.8713 | Train Acc: 0.5727
 Site-MNIST           | Train Loss: 1.9286 | Train Acc: 0.4963
 Site-MNIST           | Train Loss: 1.9047 | Train Acc: 0.5272
 Site-MNIST           | Train Loss: 1.8672 | Train Acc: 0.5826
 Site-USPS            | Train Loss: 1.8595 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.7946 | Train Acc: 0.5972
 Site-USPS            | Train Loss: 1.6479 | Train Acc: 0.5736
 Site-USPS            | Train Loss: 1.8505 | Train Acc: 0.5322
 Site-USPS            | Train Loss: 1.8578 | Train Acc: 0.5738
 Site-USPS            | Train Loss: 1.8535 | Train Acc: 0.5926
 Site-SynthDigits     | Train Loss: 2.2315 | Train Acc: 0.1921
 Site-SynthDigits     | Train Loss: 2.2368 | Train Acc: 0.2125
 Site-SynthDigits     | Train Loss: 2.2039 | Train Acc: 0.2770
 Site-MNIST-M         | Train Loss: 2.2589 | Train Acc: 0.1878
 Site-MNIST-M         | Train Loss: 2.2509 | Train Acc: 0.2110
 Site-SVHN            | Train Loss: 2.2882 | Train Acc: 0.1383
 Site-MNIST           | Val  Loss: 1.5540 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.7602 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.7899 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.9093 | Val  Acc: 0.3333
 Site-MNIST           | Val  Loss: 1.9103 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 1.9336 | Val  Acc: 0.4516
 Site-MNIST           | Val  Loss: 1.9136 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.8912 | Val  Acc: 0.5588
 Site-MNIST           | Val  Loss: 1.8987 | Val  Acc: 0.5574
 Site-MNIST           | Val  Loss: 1.8914 | Val  Acc: 0.5378
 Site-USPS            | Val  Loss: 1.8329 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 1.9656 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.8715 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.9022 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8613 | Val  Acc: 0.5429
 Site-USPS            | Val  Loss: 1.8311 | Val  Acc: 0.5608
 Site-SynthDigits     | Val  Loss: 2.2611 | Val  Acc: 0.2432
 Site-SynthDigits     | Val  Loss: 2.2733 | Val  Acc: 0.2353
 Site-SynthDigits     | Val  Loss: 2.2213 | Val  Acc: 0.2213
 Site-MNIST-M         | Val  Loss: 2.2419 | Val  Acc: 0.2000
 Site-MNIST-M         | Val  Loss: 2.2379 | Val  Acc: 0.2469
 Site-SVHN            | Val  Loss: 2.3068 | Val  Acc: 0.1714
Average Valid Accuracy: 0.4592
Aggregated Acc | Val Acc: 0.3433
============ Train epoch 18 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.9323 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.9250 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.8734 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8567 | Train Acc: 0.6053
 Site-MNIST           | Train Loss: 1.8794 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.8460 | Train Acc: 0.6905
 Site-MNIST           | Train Loss: 1.8566 | Train Acc: 0.5771
 Site-MNIST           | Train Loss: 1.9126 | Train Acc: 0.5037
 Site-MNIST           | Train Loss: 1.8831 | Train Acc: 0.5312
 Site-MNIST           | Train Loss: 1.8493 | Train Acc: 0.5902
 Site-USPS            | Train Loss: 1.8389 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.8148 | Train Acc: 0.5972
 Site-USPS            | Train Loss: 1.6298 | Train Acc: 0.5814
 Site-USPS            | Train Loss: 1.8331 | Train Acc: 0.5365
 Site-USPS            | Train Loss: 1.8293 | Train Acc: 0.5786
 Site-USPS            | Train Loss: 1.8304 | Train Acc: 0.6005
 Site-SynthDigits     | Train Loss: 2.2360 | Train Acc: 0.1987
 Site-SynthDigits     | Train Loss: 2.2302 | Train Acc: 0.2125
 Site-SynthDigits     | Train Loss: 2.1963 | Train Acc: 0.2831
 Site-MNIST-M         | Train Loss: 2.2558 | Train Acc: 0.1934
 Site-MNIST-M         | Train Loss: 2.2685 | Train Acc: 0.2018
 Site-SVHN            | Train Loss: 2.2936 | Train Acc: 0.1348
 Site-MNIST           | Val  Loss: 1.5333 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.7394 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.7701 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.8924 | Val  Acc: 0.3333
 Site-MNIST           | Val  Loss: 1.8918 | Val  Acc: 0.4118
 Site-MNIST           | Val  Loss: 1.9152 | Val  Acc: 0.4516
 Site-MNIST           | Val  Loss: 1.8951 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.8727 | Val  Acc: 0.5784
 Site-MNIST           | Val  Loss: 1.8816 | Val  Acc: 0.5683
 Site-MNIST           | Val  Loss: 1.8738 | Val  Acc: 0.5438
 Site-USPS            | Val  Loss: 1.8139 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 1.9509 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.8527 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8832 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8407 | Val  Acc: 0.5429
 Site-USPS            | Val  Loss: 1.8096 | Val  Acc: 0.5608
 Site-SynthDigits     | Val  Loss: 2.2570 | Val  Acc: 0.2432
 Site-SynthDigits     | Val  Loss: 2.2692 | Val  Acc: 0.2353
 Site-SynthDigits     | Val  Loss: 2.2162 | Val  Acc: 0.2213
 Site-MNIST-M         | Val  Loss: 2.2382 | Val  Acc: 0.2000
 Site-MNIST-M         | Val  Loss: 2.2336 | Val  Acc: 0.2593
 Site-SVHN            | Val  Loss: 2.3056 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4607
Aggregated Acc | Val Acc: 0.3424
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-4
client-20 is in G-4
client-21 is in G-0
cnt=[1, 10, 6, 3, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.9181 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.9093 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.8538 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8377 | Train Acc: 0.6053
 Site-MNIST           | Train Loss: 1.8488 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.8263 | Train Acc: 0.6905
 Site-MNIST           | Train Loss: 1.8366 | Train Acc: 0.5903
 Site-MNIST           | Train Loss: 1.9012 | Train Acc: 0.5134
 Site-MNIST           | Train Loss: 1.8650 | Train Acc: 0.5380
 Site-MNIST           | Train Loss: 1.8300 | Train Acc: 0.5977
 Site-USPS            | Train Loss: 1.8200 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.7494 | Train Acc: 0.5972
 Site-USPS            | Train Loss: 1.6136 | Train Acc: 0.5736
 Site-USPS            | Train Loss: 1.8090 | Train Acc: 0.5451
 Site-USPS            | Train Loss: 1.8148 | Train Acc: 0.5881
 Site-USPS            | Train Loss: 1.8117 | Train Acc: 0.6071
 Site-SynthDigits     | Train Loss: 2.2371 | Train Acc: 0.2053
 Site-SynthDigits     | Train Loss: 2.2263 | Train Acc: 0.2161
 Site-SynthDigits     | Train Loss: 2.1923 | Train Acc: 0.2770
 Site-MNIST-M         | Train Loss: 2.2523 | Train Acc: 0.1934
 Site-MNIST-M         | Train Loss: 2.2666 | Train Acc: 0.1988
 Site-SVHN            | Train Loss: 2.2892 | Train Acc: 0.1418
 Site-MNIST           | Val  Loss: 1.5162 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.7220 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.7521 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.8765 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.8739 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.8967 | Val  Acc: 0.4839
 Site-MNIST           | Val  Loss: 1.8761 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.8536 | Val  Acc: 0.5686
 Site-MNIST           | Val  Loss: 1.8638 | Val  Acc: 0.5683
 Site-MNIST           | Val  Loss: 1.8552 | Val  Acc: 0.5529
 Site-USPS            | Val  Loss: 1.7929 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 1.9361 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.8358 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8657 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8218 | Val  Acc: 0.5524
 Site-USPS            | Val  Loss: 1.7893 | Val  Acc: 0.5608
 Site-SynthDigits     | Val  Loss: 2.2533 | Val  Acc: 0.2432
 Site-SynthDigits     | Val  Loss: 2.2663 | Val  Acc: 0.2353
 Site-SynthDigits     | Val  Loss: 2.2120 | Val  Acc: 0.2295
 Site-MNIST-M         | Val  Loss: 2.2357 | Val  Acc: 0.2000
 Site-MNIST-M         | Val  Loss: 2.2309 | Val  Acc: 0.2593
 Site-SVHN            | Val  Loss: 2.3044 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4707
Aggregated Acc | Val Acc: 0.3473
 Best site-MNIST            | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:19 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:19 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:19 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:19 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:19 | Val Acc: 0.4839
 Best site-MNIST            | Epoch:19 | Val Acc: 0.5179
 Best site-MNIST            | Epoch:19 | Val Acc: 0.5686
 Best site-MNIST            | Epoch:19 | Val Acc: 0.5683
 Best site-MNIST            | Epoch:19 | Val Acc: 0.5529
 Best site-USPS             | Epoch:19 | Val Acc: 0.6000
 Best site-USPS             | Epoch:19 | Val Acc: 0.4444
 Best site-USPS             | Epoch:19 | Val Acc: 0.5000
 Best site-USPS             | Epoch:19 | Val Acc: 0.5000
 Best site-USPS             | Epoch:19 | Val Acc: 0.5524
 Best site-USPS             | Epoch:19 | Val Acc: 0.5608
 Best site-SynthDigits      | Epoch:19 | Val Acc: 0.2432
 Best site-SynthDigits      | Epoch:19 | Val Acc: 0.2353
 Best site-SynthDigits      | Epoch:19 | Val Acc: 0.2295
 Best site-MNIST-M          | Epoch:19 | Val Acc: 0.2000
 Best site-MNIST-M          | Epoch:19 | Val Acc: 0.2593
 Best site-SVHN             | Epoch:19 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
 Test site-MNIST           | Epoch:19 | Test Acc: 0.5570
 Test site-USPS            | Epoch:19 | Test Acc: 0.6269
 Test site-SynthDigits     | Epoch:19 | Test Acc: 0.2414
 Test site-MNIST-M         | Epoch:19 | Test Acc: 0.1876
 Test site-SVHN            | Epoch:19 | Test Acc: 0.1625
Average Test Accuracy: 0.3551
============ Train epoch 20 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.9042 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8933 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.8343 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8191 | Train Acc: 0.6316
 Site-MNIST           | Train Loss: 1.7926 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.8078 | Train Acc: 0.6984
 Site-MNIST           | Train Loss: 1.8053 | Train Acc: 0.5947
 Site-MNIST           | Train Loss: 1.8770 | Train Acc: 0.5232
 Site-MNIST           | Train Loss: 1.8439 | Train Acc: 0.5421
 Site-MNIST           | Train Loss: 1.8115 | Train Acc: 0.6068
 Site-USPS            | Train Loss: 1.8019 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.7596 | Train Acc: 0.5972
 Site-USPS            | Train Loss: 1.5741 | Train Acc: 0.5736
 Site-USPS            | Train Loss: 1.7946 | Train Acc: 0.5494
 Site-USPS            | Train Loss: 1.7961 | Train Acc: 0.6048
 Site-USPS            | Train Loss: 1.7947 | Train Acc: 0.6085
 Site-SynthDigits     | Train Loss: 2.2314 | Train Acc: 0.1987
 Site-SynthDigits     | Train Loss: 2.2234 | Train Acc: 0.2125
 Site-SynthDigits     | Train Loss: 2.1872 | Train Acc: 0.2790
 Site-MNIST-M         | Train Loss: 2.2505 | Train Acc: 0.2044
 Site-MNIST-M         | Train Loss: 2.2630 | Train Acc: 0.2049
 Site-SVHN            | Train Loss: 2.2903 | Train Acc: 0.1489
 Site-MNIST           | Val  Loss: 1.5013 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.7056 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.7343 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.8607 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.8558 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.8785 | Val  Acc: 0.4839
 Site-MNIST           | Val  Loss: 1.8571 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.8345 | Val  Acc: 0.5686
 Site-MNIST           | Val  Loss: 1.8460 | Val  Acc: 0.5792
 Site-MNIST           | Val  Loss: 1.8366 | Val  Acc: 0.5619
 Site-USPS            | Val  Loss: 1.7724 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 1.9217 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.8194 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8488 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8034 | Val  Acc: 0.5524
 Site-USPS            | Val  Loss: 1.7693 | Val  Acc: 0.5661
 Site-SynthDigits     | Val  Loss: 2.2498 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2635 | Val  Acc: 0.2353
 Site-SynthDigits     | Val  Loss: 2.2078 | Val  Acc: 0.2295
 Site-MNIST-M         | Val  Loss: 2.2334 | Val  Acc: 0.2000
 Site-MNIST-M         | Val  Loss: 2.2283 | Val  Acc: 0.2593
 Site-SVHN            | Val  Loss: 2.3029 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4706
Aggregated Acc | Val Acc: 0.3461
============ Train epoch 21 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8921 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8784 | Train Acc: 0.4167
 Site-MNIST           | Train Loss: 1.8154 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8010 | Train Acc: 0.6316
 Site-MNIST           | Train Loss: 1.6950 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.7916 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.7984 | Train Acc: 0.6035
 Site-MNIST           | Train Loss: 1.8713 | Train Acc: 0.5281
 Site-MNIST           | Train Loss: 1.8299 | Train Acc: 0.5462
 Site-MNIST           | Train Loss: 1.7942 | Train Acc: 0.6106
 Site-USPS            | Train Loss: 1.7832 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.6656 | Train Acc: 0.5972
 Site-USPS            | Train Loss: 1.7632 | Train Acc: 0.5891
 Site-USPS            | Train Loss: 1.7724 | Train Acc: 0.5536
 Site-USPS            | Train Loss: 1.7749 | Train Acc: 0.6119
 Site-USPS            | Train Loss: 1.7754 | Train Acc: 0.6124
 Site-SynthDigits     | Train Loss: 2.2173 | Train Acc: 0.2053
 Site-SynthDigits     | Train Loss: 2.2280 | Train Acc: 0.2125
 Site-SynthDigits     | Train Loss: 2.1818 | Train Acc: 0.2892
 Site-MNIST-M         | Train Loss: 2.2501 | Train Acc: 0.2155
 Site-MNIST-M         | Train Loss: 2.2509 | Train Acc: 0.2110
 Site-SVHN            | Train Loss: 2.2880 | Train Acc: 0.1489
 Site-MNIST           | Val  Loss: 1.4837 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.6872 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.7170 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.8461 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.8390 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.8610 | Val  Acc: 0.4839
 Site-MNIST           | Val  Loss: 1.8396 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.8170 | Val  Acc: 0.5686
 Site-MNIST           | Val  Loss: 1.8296 | Val  Acc: 0.5792
 Site-MNIST           | Val  Loss: 1.8198 | Val  Acc: 0.5680
 Site-USPS            | Val  Loss: 1.7535 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 1.9082 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.8033 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8321 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7850 | Val  Acc: 0.5524
 Site-USPS            | Val  Loss: 1.7498 | Val  Acc: 0.5767
 Site-SynthDigits     | Val  Loss: 2.2456 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2605 | Val  Acc: 0.2353
 Site-SynthDigits     | Val  Loss: 2.2030 | Val  Acc: 0.2295
 Site-MNIST-M         | Val  Loss: 2.2306 | Val  Acc: 0.2222
 Site-MNIST-M         | Val  Loss: 2.2254 | Val  Acc: 0.2593
 Site-SVHN            | Val  Loss: 2.3017 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4724
Aggregated Acc | Val Acc: 0.3487
 Best site-MNIST            | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:21 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:21 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:21 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:21 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:21 | Val Acc: 0.4839
 Best site-MNIST            | Epoch:21 | Val Acc: 0.5179
 Best site-MNIST            | Epoch:21 | Val Acc: 0.5686
 Best site-MNIST            | Epoch:21 | Val Acc: 0.5792
 Best site-MNIST            | Epoch:21 | Val Acc: 0.5680
 Best site-USPS             | Epoch:21 | Val Acc: 0.6000
 Best site-USPS             | Epoch:21 | Val Acc: 0.4444
 Best site-USPS             | Epoch:21 | Val Acc: 0.5000
 Best site-USPS             | Epoch:21 | Val Acc: 0.5000
 Best site-USPS             | Epoch:21 | Val Acc: 0.5524
 Best site-USPS             | Epoch:21 | Val Acc: 0.5767
 Best site-SynthDigits      | Epoch:21 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:21 | Val Acc: 0.2353
 Best site-SynthDigits      | Epoch:21 | Val Acc: 0.2295
 Best site-MNIST-M          | Epoch:21 | Val Acc: 0.2222
 Best site-MNIST-M          | Epoch:21 | Val Acc: 0.2593
 Best site-SVHN             | Epoch:21 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 22 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-1
client-20 is in G-1
client-21 is in G-1
cnt=[9, 3, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8799 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8636 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7964 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.7831 | Train Acc: 0.6316
 Site-MNIST           | Train Loss: 1.8237 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.7735 | Train Acc: 0.7222
 Site-MNIST           | Train Loss: 1.7892 | Train Acc: 0.6079
 Site-MNIST           | Train Loss: 1.8536 | Train Acc: 0.5330
 Site-MNIST           | Train Loss: 1.8099 | Train Acc: 0.5530
 Site-MNIST           | Train Loss: 1.7766 | Train Acc: 0.6211
 Site-USPS            | Train Loss: 1.7646 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.6562 | Train Acc: 0.5972
 Site-USPS            | Train Loss: 1.5234 | Train Acc: 0.5969
 Site-USPS            | Train Loss: 1.7586 | Train Acc: 0.5579
 Site-USPS            | Train Loss: 1.7567 | Train Acc: 0.6262
 Site-USPS            | Train Loss: 1.7566 | Train Acc: 0.6283
 Site-SynthDigits     | Train Loss: 2.2268 | Train Acc: 0.1987
 Site-SynthDigits     | Train Loss: 2.2121 | Train Acc: 0.2198
 Site-SynthDigits     | Train Loss: 2.1752 | Train Acc: 0.2933
 Site-MNIST-M         | Train Loss: 2.2472 | Train Acc: 0.2099
 Site-MNIST-M         | Train Loss: 2.2406 | Train Acc: 0.2141
 Site-SVHN            | Train Loss: 2.2877 | Train Acc: 0.1525
 Site-MNIST           | Val  Loss: 1.4684 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.6714 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.7001 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.8310 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.8222 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.8439 | Val  Acc: 0.4839
 Site-MNIST           | Val  Loss: 1.8221 | Val  Acc: 0.5179
 Site-MNIST           | Val  Loss: 1.7994 | Val  Acc: 0.5686
 Site-MNIST           | Val  Loss: 1.8133 | Val  Acc: 0.5902
 Site-MNIST           | Val  Loss: 1.8027 | Val  Acc: 0.5770
 Site-USPS            | Val  Loss: 1.7337 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.8941 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.7872 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.8155 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7670 | Val  Acc: 0.5524
 Site-USPS            | Val  Loss: 1.7306 | Val  Acc: 0.5767
 Site-SynthDigits     | Val  Loss: 2.2418 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2576 | Val  Acc: 0.2500
 Site-SynthDigits     | Val  Loss: 2.1987 | Val  Acc: 0.2377
 Site-MNIST-M         | Val  Loss: 2.2278 | Val  Acc: 0.2222
 Site-MNIST-M         | Val  Loss: 2.2228 | Val  Acc: 0.2469
 Site-SVHN            | Val  Loss: 2.3005 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4777
Aggregated Acc | Val Acc: 0.5062
 Best site-MNIST            | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:22 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:22 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:22 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:22 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:22 | Val Acc: 0.4839
 Best site-MNIST            | Epoch:22 | Val Acc: 0.5179
 Best site-MNIST            | Epoch:22 | Val Acc: 0.5686
 Best site-MNIST            | Epoch:22 | Val Acc: 0.5902
 Best site-MNIST            | Epoch:22 | Val Acc: 0.5770
 Best site-USPS             | Epoch:22 | Val Acc: 0.7000
 Best site-USPS             | Epoch:22 | Val Acc: 0.4444
 Best site-USPS             | Epoch:22 | Val Acc: 0.5000
 Best site-USPS             | Epoch:22 | Val Acc: 0.5000
 Best site-USPS             | Epoch:22 | Val Acc: 0.5524
 Best site-USPS             | Epoch:22 | Val Acc: 0.5767
 Best site-SynthDigits      | Epoch:22 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:22 | Val Acc: 0.2500
 Best site-SynthDigits      | Epoch:22 | Val Acc: 0.2377
 Best site-MNIST-M          | Epoch:22 | Val Acc: 0.2222
 Best site-MNIST-M          | Epoch:22 | Val Acc: 0.2469
 Best site-SVHN             | Epoch:22 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 23 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-4
client-20 is in G-4
client-21 is in G-3
cnt=[10, 3, 6, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8672 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8488 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7783 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.7659 | Train Acc: 0.6316
 Site-MNIST           | Train Loss: 1.6887 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.7575 | Train Acc: 0.7222
 Site-MNIST           | Train Loss: 1.7633 | Train Acc: 0.6123
 Site-MNIST           | Train Loss: 1.8251 | Train Acc: 0.5452
 Site-MNIST           | Train Loss: 1.7944 | Train Acc: 0.5571
 Site-MNIST           | Train Loss: 1.7616 | Train Acc: 0.6287
 Site-USPS            | Train Loss: 1.7470 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.7935 | Train Acc: 0.6111
 Site-USPS            | Train Loss: 1.7276 | Train Acc: 0.6124
 Site-USPS            | Train Loss: 1.7292 | Train Acc: 0.5579
 Site-USPS            | Train Loss: 1.7344 | Train Acc: 0.6310
 Site-USPS            | Train Loss: 1.7393 | Train Acc: 0.6310
 Site-SynthDigits     | Train Loss: 2.2177 | Train Acc: 0.1987
 Site-SynthDigits     | Train Loss: 2.2116 | Train Acc: 0.2234
 Site-SynthDigits     | Train Loss: 2.1705 | Train Acc: 0.2933
 Site-MNIST-M         | Train Loss: 2.2458 | Train Acc: 0.2099
 Site-MNIST-M         | Train Loss: 2.2342 | Train Acc: 0.2141
 Site-SVHN            | Train Loss: 2.2822 | Train Acc: 0.1596
 Site-MNIST           | Val  Loss: 1.4552 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.6549 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6840 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.8159 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.8051 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.8270 | Val  Acc: 0.5484
 Site-MNIST           | Val  Loss: 1.8050 | Val  Acc: 0.5714
 Site-MNIST           | Val  Loss: 1.7825 | Val  Acc: 0.6078
 Site-MNIST           | Val  Loss: 1.7972 | Val  Acc: 0.6011
 Site-MNIST           | Val  Loss: 1.7861 | Val  Acc: 0.5801
 Site-USPS            | Val  Loss: 1.7141 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.8800 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.7718 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7996 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7498 | Val  Acc: 0.5524
 Site-USPS            | Val  Loss: 1.7120 | Val  Acc: 0.5820
 Site-SynthDigits     | Val  Loss: 2.2381 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2547 | Val  Acc: 0.2647
 Site-SynthDigits     | Val  Loss: 2.1944 | Val  Acc: 0.2459
 Site-MNIST-M         | Val  Loss: 2.2249 | Val  Acc: 0.2222
 Site-MNIST-M         | Val  Loss: 2.2200 | Val  Acc: 0.2469
 Site-SVHN            | Val  Loss: 2.2991 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4874
Aggregated Acc | Val Acc: 0.3579
 Best site-MNIST            | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:23 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:23 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:23 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:23 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:23 | Val Acc: 0.5484
 Best site-MNIST            | Epoch:23 | Val Acc: 0.5714
 Best site-MNIST            | Epoch:23 | Val Acc: 0.6078
 Best site-MNIST            | Epoch:23 | Val Acc: 0.6011
 Best site-MNIST            | Epoch:23 | Val Acc: 0.5801
 Best site-USPS             | Epoch:23 | Val Acc: 0.7000
 Best site-USPS             | Epoch:23 | Val Acc: 0.4444
 Best site-USPS             | Epoch:23 | Val Acc: 0.5000
 Best site-USPS             | Epoch:23 | Val Acc: 0.5000
 Best site-USPS             | Epoch:23 | Val Acc: 0.5524
 Best site-USPS             | Epoch:23 | Val Acc: 0.5820
 Best site-SynthDigits      | Epoch:23 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:23 | Val Acc: 0.2647
 Best site-SynthDigits      | Epoch:23 | Val Acc: 0.2459
 Best site-MNIST-M          | Epoch:23 | Val Acc: 0.2222
 Best site-MNIST-M          | Epoch:23 | Val Acc: 0.2469
 Best site-SVHN             | Epoch:23 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 24 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-4
client-20 is in G-4
client-21 is in G-1
cnt=[1, 4, 6, 9, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8554 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8344 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7603 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.7490 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.8428 | Train Acc: 0.6857
 Site-MNIST           | Train Loss: 1.7398 | Train Acc: 0.7460
 Site-MNIST           | Train Loss: 1.7505 | Train Acc: 0.6211
 Site-MNIST           | Train Loss: 1.8154 | Train Acc: 0.5501
 Site-MNIST           | Train Loss: 1.7794 | Train Acc: 0.5679
 Site-MNIST           | Train Loss: 1.7415 | Train Acc: 0.6377
 Site-USPS            | Train Loss: 1.7295 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.6132 | Train Acc: 0.6111
 Site-USPS            | Train Loss: 1.7949 | Train Acc: 0.6124
 Site-USPS            | Train Loss: 1.7211 | Train Acc: 0.5579
 Site-USPS            | Train Loss: 1.7280 | Train Acc: 0.6357
 Site-USPS            | Train Loss: 1.7215 | Train Acc: 0.6376
 Site-SynthDigits     | Train Loss: 2.2093 | Train Acc: 0.1987
 Site-SynthDigits     | Train Loss: 2.2028 | Train Acc: 0.2234
 Site-SynthDigits     | Train Loss: 2.1677 | Train Acc: 0.2953
 Site-MNIST-M         | Train Loss: 2.2450 | Train Acc: 0.2155
 Site-MNIST-M         | Train Loss: 2.2399 | Train Acc: 0.2202
 Site-SVHN            | Train Loss: 2.2786 | Train Acc: 0.1667
 Site-MNIST           | Val  Loss: 1.4397 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.6384 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6672 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.8010 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.7888 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.8110 | Val  Acc: 0.5484
 Site-MNIST           | Val  Loss: 1.7884 | Val  Acc: 0.5714
 Site-MNIST           | Val  Loss: 1.7656 | Val  Acc: 0.6078
 Site-MNIST           | Val  Loss: 1.7813 | Val  Acc: 0.6066
 Site-MNIST           | Val  Loss: 1.7696 | Val  Acc: 0.5861
 Site-USPS            | Val  Loss: 1.6957 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.8670 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.7568 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7842 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7329 | Val  Acc: 0.5524
 Site-USPS            | Val  Loss: 1.6940 | Val  Acc: 0.5820
 Site-SynthDigits     | Val  Loss: 2.2348 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2522 | Val  Acc: 0.2647
 Site-SynthDigits     | Val  Loss: 2.1899 | Val  Acc: 0.2377
 Site-MNIST-M         | Val  Loss: 2.2212 | Val  Acc: 0.2222
 Site-MNIST-M         | Val  Loss: 2.2168 | Val  Acc: 0.2469
 Site-SVHN            | Val  Loss: 2.2974 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4875
Aggregated Acc | Val Acc: 0.5134
 Best site-MNIST            | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:24 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:24 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:24 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:24 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:24 | Val Acc: 0.5484
 Best site-MNIST            | Epoch:24 | Val Acc: 0.5714
 Best site-MNIST            | Epoch:24 | Val Acc: 0.6078
 Best site-MNIST            | Epoch:24 | Val Acc: 0.6066
 Best site-MNIST            | Epoch:24 | Val Acc: 0.5861
 Best site-USPS             | Epoch:24 | Val Acc: 0.7000
 Best site-USPS             | Epoch:24 | Val Acc: 0.4444
 Best site-USPS             | Epoch:24 | Val Acc: 0.5000
 Best site-USPS             | Epoch:24 | Val Acc: 0.5000
 Best site-USPS             | Epoch:24 | Val Acc: 0.5524
 Best site-USPS             | Epoch:24 | Val Acc: 0.5820
 Best site-SynthDigits      | Epoch:24 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:24 | Val Acc: 0.2647
 Best site-SynthDigits      | Epoch:24 | Val Acc: 0.2377
 Best site-MNIST-M          | Epoch:24 | Val Acc: 0.2222
 Best site-MNIST-M          | Epoch:24 | Val Acc: 0.2469
 Best site-SVHN             | Epoch:24 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 25 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-1
client-20 is in G-1
client-21 is in G-4
cnt=[10, 2, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8440 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8208 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7420 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.7324 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.6435 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.7243 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.7173 | Train Acc: 0.6256
 Site-MNIST           | Train Loss: 1.8031 | Train Acc: 0.5501
 Site-MNIST           | Train Loss: 1.7586 | Train Acc: 0.5747
 Site-MNIST           | Train Loss: 1.7255 | Train Acc: 0.6438
 Site-USPS            | Train Loss: 1.7126 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.7342 | Train Acc: 0.6111
 Site-USPS            | Train Loss: 1.5846 | Train Acc: 0.6124
 Site-USPS            | Train Loss: 1.7039 | Train Acc: 0.5665
 Site-USPS            | Train Loss: 1.7115 | Train Acc: 0.6381
 Site-USPS            | Train Loss: 1.7049 | Train Acc: 0.6442
 Site-SynthDigits     | Train Loss: 2.2139 | Train Acc: 0.2053
 Site-SynthDigits     | Train Loss: 2.2069 | Train Acc: 0.2234
 Site-SynthDigits     | Train Loss: 2.1630 | Train Acc: 0.2953
 Site-MNIST-M         | Train Loss: 2.2413 | Train Acc: 0.2099
 Site-MNIST-M         | Train Loss: 2.2385 | Train Acc: 0.2202
 Site-SVHN            | Train Loss: 2.2799 | Train Acc: 0.1702
 Site-MNIST           | Val  Loss: 1.4257 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.6235 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6525 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.7881 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.7731 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.7944 | Val  Acc: 0.5484
 Site-MNIST           | Val  Loss: 1.7719 | Val  Acc: 0.5714
 Site-MNIST           | Val  Loss: 1.7492 | Val  Acc: 0.6078
 Site-MNIST           | Val  Loss: 1.7661 | Val  Acc: 0.6120
 Site-MNIST           | Val  Loss: 1.7538 | Val  Acc: 0.5891
 Site-USPS            | Val  Loss: 1.6772 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.8546 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.7429 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7694 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7166 | Val  Acc: 0.5619
 Site-USPS            | Val  Loss: 1.6767 | Val  Acc: 0.5926
 Site-SynthDigits     | Val  Loss: 2.2311 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2497 | Val  Acc: 0.2647
 Site-SynthDigits     | Val  Loss: 2.1857 | Val  Acc: 0.2377
 Site-MNIST-M         | Val  Loss: 2.2178 | Val  Acc: 0.2222
 Site-MNIST-M         | Val  Loss: 2.2134 | Val  Acc: 0.2346
 Site-SVHN            | Val  Loss: 2.2959 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4883
Aggregated Acc | Val Acc: 0.3572
 Best site-MNIST            | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:25 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:25 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:25 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:25 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:25 | Val Acc: 0.5484
 Best site-MNIST            | Epoch:25 | Val Acc: 0.5714
 Best site-MNIST            | Epoch:25 | Val Acc: 0.6078
 Best site-MNIST            | Epoch:25 | Val Acc: 0.6120
 Best site-MNIST            | Epoch:25 | Val Acc: 0.5891
 Best site-USPS             | Epoch:25 | Val Acc: 0.7000
 Best site-USPS             | Epoch:25 | Val Acc: 0.4444
 Best site-USPS             | Epoch:25 | Val Acc: 0.5000
 Best site-USPS             | Epoch:25 | Val Acc: 0.5000
 Best site-USPS             | Epoch:25 | Val Acc: 0.5619
 Best site-USPS             | Epoch:25 | Val Acc: 0.5926
 Best site-SynthDigits      | Epoch:25 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:25 | Val Acc: 0.2647
 Best site-SynthDigits      | Epoch:25 | Val Acc: 0.2377
 Best site-MNIST-M          | Epoch:25 | Val Acc: 0.2222
 Best site-MNIST-M          | Epoch:25 | Val Acc: 0.2346
 Best site-SVHN             | Epoch:25 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 26 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-1
cnt=[6, 4, 2, 2, 8, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8335 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.8081 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7246 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.7159 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.5276 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.7095 | Train Acc: 0.7698
 Site-MNIST           | Train Loss: 1.7098 | Train Acc: 0.6256
 Site-MNIST           | Train Loss: 1.7830 | Train Acc: 0.5550
 Site-MNIST           | Train Loss: 1.7457 | Train Acc: 0.5829
 Site-MNIST           | Train Loss: 1.7109 | Train Acc: 0.6468
 Site-USPS            | Train Loss: 1.6957 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.6006 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.4361 | Train Acc: 0.6279
 Site-USPS            | Train Loss: 1.6842 | Train Acc: 0.5880
 Site-USPS            | Train Loss: 1.6838 | Train Acc: 0.6476
 Site-USPS            | Train Loss: 1.6880 | Train Acc: 0.6468
 Site-SynthDigits     | Train Loss: 2.1957 | Train Acc: 0.2053
 Site-SynthDigits     | Train Loss: 2.1929 | Train Acc: 0.2271
 Site-SynthDigits     | Train Loss: 2.1569 | Train Acc: 0.2953
 Site-MNIST-M         | Train Loss: 2.2389 | Train Acc: 0.2155
 Site-MNIST-M         | Train Loss: 2.2255 | Train Acc: 0.2294
 Site-SVHN            | Train Loss: 2.2799 | Train Acc: 0.1773
 Site-MNIST           | Val  Loss: 1.4127 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.6076 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6378 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.7748 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.7576 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.7781 | Val  Acc: 0.5484
 Site-MNIST           | Val  Loss: 1.7559 | Val  Acc: 0.5714
 Site-MNIST           | Val  Loss: 1.7336 | Val  Acc: 0.6078
 Site-MNIST           | Val  Loss: 1.7514 | Val  Acc: 0.6120
 Site-MNIST           | Val  Loss: 1.7387 | Val  Acc: 0.5891
 Site-USPS            | Val  Loss: 1.6590 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.8421 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.7287 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7546 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7003 | Val  Acc: 0.5714
 Site-USPS            | Val  Loss: 1.6593 | Val  Acc: 0.6085
 Site-SynthDigits     | Val  Loss: 2.2272 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2470 | Val  Acc: 0.2647
 Site-SynthDigits     | Val  Loss: 2.1812 | Val  Acc: 0.2459
 Site-MNIST-M         | Val  Loss: 2.2146 | Val  Acc: 0.2444
 Site-MNIST-M         | Val  Loss: 2.2104 | Val  Acc: 0.2469
 Site-SVHN            | Val  Loss: 2.2943 | Val  Acc: 0.1571
Average Valid Accuracy: 0.4914
Aggregated Acc | Val Acc: 0.4819
 Best site-MNIST            | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:26 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:26 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:26 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:26 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:26 | Val Acc: 0.5484
 Best site-MNIST            | Epoch:26 | Val Acc: 0.5714
 Best site-MNIST            | Epoch:26 | Val Acc: 0.6078
 Best site-MNIST            | Epoch:26 | Val Acc: 0.6120
 Best site-MNIST            | Epoch:26 | Val Acc: 0.5891
 Best site-USPS             | Epoch:26 | Val Acc: 0.7000
 Best site-USPS             | Epoch:26 | Val Acc: 0.4444
 Best site-USPS             | Epoch:26 | Val Acc: 0.5000
 Best site-USPS             | Epoch:26 | Val Acc: 0.5000
 Best site-USPS             | Epoch:26 | Val Acc: 0.5714
 Best site-USPS             | Epoch:26 | Val Acc: 0.6085
 Best site-SynthDigits      | Epoch:26 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:26 | Val Acc: 0.2647
 Best site-SynthDigits      | Epoch:26 | Val Acc: 0.2459
 Best site-MNIST-M          | Epoch:26 | Val Acc: 0.2444
 Best site-MNIST-M          | Epoch:26 | Val Acc: 0.2469
 Best site-SVHN             | Epoch:26 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 27 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[10, 3, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8212 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.7941 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7076 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.6993 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.6332 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.6929 | Train Acc: 0.7698
 Site-MNIST           | Train Loss: 1.6991 | Train Acc: 0.6300
 Site-MNIST           | Train Loss: 1.7822 | Train Acc: 0.5575
 Site-MNIST           | Train Loss: 1.7298 | Train Acc: 0.5910
 Site-MNIST           | Train Loss: 1.6957 | Train Acc: 0.6543
 Site-USPS            | Train Loss: 1.6802 | Train Acc: 0.6750
 Site-USPS            | Train Loss: 1.6688 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.3912 | Train Acc: 0.6357
 Site-USPS            | Train Loss: 1.6677 | Train Acc: 0.6052
 Site-USPS            | Train Loss: 1.6621 | Train Acc: 0.6500
 Site-USPS            | Train Loss: 1.6727 | Train Acc: 0.6495
 Site-SynthDigits     | Train Loss: 2.1999 | Train Acc: 0.2053
 Site-SynthDigits     | Train Loss: 2.1987 | Train Acc: 0.2418
 Site-SynthDigits     | Train Loss: 2.1491 | Train Acc: 0.2953
 Site-MNIST-M         | Train Loss: 2.2401 | Train Acc: 0.2155
 Site-MNIST-M         | Train Loss: 2.2428 | Train Acc: 0.2324
 Site-SVHN            | Train Loss: 2.2783 | Train Acc: 0.1879
 Site-MNIST           | Val  Loss: 1.4019 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5938 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6239 | Val  Acc: 0.6000
 Site-MNIST           | Val  Loss: 1.7615 | Val  Acc: 0.4444
 Site-MNIST           | Val  Loss: 1.7427 | Val  Acc: 0.4706
 Site-MNIST           | Val  Loss: 1.7623 | Val  Acc: 0.5484
 Site-MNIST           | Val  Loss: 1.7398 | Val  Acc: 0.5714
 Site-MNIST           | Val  Loss: 1.7176 | Val  Acc: 0.6078
 Site-MNIST           | Val  Loss: 1.7363 | Val  Acc: 0.6120
 Site-MNIST           | Val  Loss: 1.7231 | Val  Acc: 0.5921
 Site-USPS            | Val  Loss: 1.6418 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.8304 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.7159 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7409 | Val  Acc: 0.5172
 Site-USPS            | Val  Loss: 1.6853 | Val  Acc: 0.6000
 Site-USPS            | Val  Loss: 1.6431 | Val  Acc: 0.6349
 Site-SynthDigits     | Val  Loss: 2.2238 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2449 | Val  Acc: 0.2941
 Site-SynthDigits     | Val  Loss: 2.1769 | Val  Acc: 0.2787
 Site-MNIST-M         | Val  Loss: 2.2122 | Val  Acc: 0.2444
 Site-MNIST-M         | Val  Loss: 2.2080 | Val  Acc: 0.2469
 Site-SVHN            | Val  Loss: 2.2926 | Val  Acc: 0.1857
Average Valid Accuracy: 0.4989
Aggregated Acc | Val Acc: 0.3744
 Best site-MNIST            | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:27 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:27 | Val Acc: 0.6000
 Best site-MNIST            | Epoch:27 | Val Acc: 0.4444
 Best site-MNIST            | Epoch:27 | Val Acc: 0.4706
 Best site-MNIST            | Epoch:27 | Val Acc: 0.5484
 Best site-MNIST            | Epoch:27 | Val Acc: 0.5714
 Best site-MNIST            | Epoch:27 | Val Acc: 0.6078
 Best site-MNIST            | Epoch:27 | Val Acc: 0.6120
 Best site-MNIST            | Epoch:27 | Val Acc: 0.5921
 Best site-USPS             | Epoch:27 | Val Acc: 0.7000
 Best site-USPS             | Epoch:27 | Val Acc: 0.4444
 Best site-USPS             | Epoch:27 | Val Acc: 0.5000
 Best site-USPS             | Epoch:27 | Val Acc: 0.5172
 Best site-USPS             | Epoch:27 | Val Acc: 0.6000
 Best site-USPS             | Epoch:27 | Val Acc: 0.6349
 Best site-SynthDigits      | Epoch:27 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:27 | Val Acc: 0.2941
 Best site-SynthDigits      | Epoch:27 | Val Acc: 0.2787
 Best site-MNIST-M          | Epoch:27 | Val Acc: 0.2444
 Best site-MNIST-M          | Epoch:27 | Val Acc: 0.2469
 Best site-SVHN             | Epoch:27 | Val Acc: 0.1857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 28 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8102 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7808 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6906 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.6833 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.5561 | Train Acc: 0.7286
 Site-MNIST           | Train Loss: 1.6781 | Train Acc: 0.7698
 Site-MNIST           | Train Loss: 1.6922 | Train Acc: 0.6388
 Site-MNIST           | Train Loss: 1.7634 | Train Acc: 0.5721
 Site-MNIST           | Train Loss: 1.7224 | Train Acc: 0.5965
 Site-MNIST           | Train Loss: 1.6800 | Train Acc: 0.6604
 Site-USPS            | Train Loss: 1.6638 | Train Acc: 0.6750
 Site-USPS            | Train Loss: 1.6862 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.7177 | Train Acc: 0.6434
 Site-USPS            | Train Loss: 1.6635 | Train Acc: 0.6094
 Site-USPS            | Train Loss: 1.6519 | Train Acc: 0.6524
 Site-USPS            | Train Loss: 1.6563 | Train Acc: 0.6548
 Site-SynthDigits     | Train Loss: 2.1814 | Train Acc: 0.2053
 Site-SynthDigits     | Train Loss: 2.1825 | Train Acc: 0.2418
 Site-SynthDigits     | Train Loss: 2.1448 | Train Acc: 0.2974
 Site-MNIST-M         | Train Loss: 2.2375 | Train Acc: 0.2210
 Site-MNIST-M         | Train Loss: 2.2370 | Train Acc: 0.2385
 Site-SVHN            | Train Loss: 2.2780 | Train Acc: 0.1879
 Site-MNIST           | Val  Loss: 1.3895 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5797 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.6096 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.7481 | Val  Acc: 0.5556
 Site-MNIST           | Val  Loss: 1.7274 | Val  Acc: 0.5294
 Site-MNIST           | Val  Loss: 1.7470 | Val  Acc: 0.5484
 Site-MNIST           | Val  Loss: 1.7244 | Val  Acc: 0.5714
 Site-MNIST           | Val  Loss: 1.7022 | Val  Acc: 0.6078
 Site-MNIST           | Val  Loss: 1.7220 | Val  Acc: 0.6120
 Site-MNIST           | Val  Loss: 1.7082 | Val  Acc: 0.5921
 Site-USPS            | Val  Loss: 1.6246 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.8182 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.7021 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7267 | Val  Acc: 0.5172
 Site-USPS            | Val  Loss: 1.6697 | Val  Acc: 0.6095
 Site-USPS            | Val  Loss: 1.6266 | Val  Acc: 0.6455
 Site-SynthDigits     | Val  Loss: 2.2203 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2432 | Val  Acc: 0.2941
 Site-SynthDigits     | Val  Loss: 2.1726 | Val  Acc: 0.2787
 Site-MNIST-M         | Val  Loss: 2.2105 | Val  Acc: 0.2667
 Site-MNIST-M         | Val  Loss: 2.2062 | Val  Acc: 0.2593
 Site-SVHN            | Val  Loss: 2.2912 | Val  Acc: 0.1857
Average Valid Accuracy: 0.5334
Aggregated Acc | Val Acc: 0.3926
 Best site-MNIST            | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:28 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:28 | Val Acc: 0.5556
 Best site-MNIST            | Epoch:28 | Val Acc: 0.5294
 Best site-MNIST            | Epoch:28 | Val Acc: 0.5484
 Best site-MNIST            | Epoch:28 | Val Acc: 0.5714
 Best site-MNIST            | Epoch:28 | Val Acc: 0.6078
 Best site-MNIST            | Epoch:28 | Val Acc: 0.6120
 Best site-MNIST            | Epoch:28 | Val Acc: 0.5921
 Best site-USPS             | Epoch:28 | Val Acc: 0.7000
 Best site-USPS             | Epoch:28 | Val Acc: 0.4444
 Best site-USPS             | Epoch:28 | Val Acc: 0.5000
 Best site-USPS             | Epoch:28 | Val Acc: 0.5172
 Best site-USPS             | Epoch:28 | Val Acc: 0.6095
 Best site-USPS             | Epoch:28 | Val Acc: 0.6455
 Best site-SynthDigits      | Epoch:28 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:28 | Val Acc: 0.2941
 Best site-SynthDigits      | Epoch:28 | Val Acc: 0.2787
 Best site-MNIST-M          | Epoch:28 | Val Acc: 0.2667
 Best site-MNIST-M          | Epoch:28 | Val Acc: 0.2593
 Best site-SVHN             | Epoch:28 | Val Acc: 0.1857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 29 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-1
client-20 is in G-1
client-21 is in G-4
cnt=[10, 2, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.8005 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7682 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6738 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.6674 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.5636 | Train Acc: 0.7429
 Site-MNIST           | Train Loss: 1.6635 | Train Acc: 0.7698
 Site-MNIST           | Train Loss: 1.6531 | Train Acc: 0.6432
 Site-MNIST           | Train Loss: 1.7444 | Train Acc: 0.5844
 Site-MNIST           | Train Loss: 1.7022 | Train Acc: 0.6060
 Site-MNIST           | Train Loss: 1.6633 | Train Acc: 0.6664
 Site-USPS            | Train Loss: 1.6493 | Train Acc: 0.6750
 Site-USPS            | Train Loss: 1.6292 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.7357 | Train Acc: 0.6667
 Site-USPS            | Train Loss: 1.6397 | Train Acc: 0.6137
 Site-USPS            | Train Loss: 1.6380 | Train Acc: 0.6524
 Site-USPS            | Train Loss: 1.6410 | Train Acc: 0.6561
 Site-SynthDigits     | Train Loss: 2.1891 | Train Acc: 0.2053
 Site-SynthDigits     | Train Loss: 2.1740 | Train Acc: 0.2381
 Site-SynthDigits     | Train Loss: 2.1410 | Train Acc: 0.2953
 Site-MNIST-M         | Train Loss: 2.2347 | Train Acc: 0.2210
 Site-MNIST-M         | Train Loss: 2.2307 | Train Acc: 0.2385
 Site-SVHN            | Train Loss: 2.2765 | Train Acc: 0.1879
 Site-MNIST           | Val  Loss: 1.3792 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5660 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5956 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.7358 | Val  Acc: 0.5556
 Site-MNIST           | Val  Loss: 1.7129 | Val  Acc: 0.5294
 Site-MNIST           | Val  Loss: 1.7318 | Val  Acc: 0.5806
 Site-MNIST           | Val  Loss: 1.7089 | Val  Acc: 0.5893
 Site-MNIST           | Val  Loss: 1.6869 | Val  Acc: 0.6176
 Site-MNIST           | Val  Loss: 1.7075 | Val  Acc: 0.6284
 Site-MNIST           | Val  Loss: 1.6932 | Val  Acc: 0.6042
 Site-USPS            | Val  Loss: 1.6077 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.8070 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.6896 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7135 | Val  Acc: 0.5172
 Site-USPS            | Val  Loss: 1.6551 | Val  Acc: 0.6190
 Site-USPS            | Val  Loss: 1.6107 | Val  Acc: 0.6614
 Site-SynthDigits     | Val  Loss: 2.2172 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2407 | Val  Acc: 0.2941
 Site-SynthDigits     | Val  Loss: 2.1690 | Val  Acc: 0.2787
 Site-MNIST-M         | Val  Loss: 2.2084 | Val  Acc: 0.2667
 Site-MNIST-M         | Val  Loss: 2.2040 | Val  Acc: 0.2593
 Site-SVHN            | Val  Loss: 2.2893 | Val  Acc: 0.1857
Average Valid Accuracy: 0.5385
Aggregated Acc | Val Acc: 0.3952
 Best site-MNIST            | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:29 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:29 | Val Acc: 0.5556
 Best site-MNIST            | Epoch:29 | Val Acc: 0.5294
 Best site-MNIST            | Epoch:29 | Val Acc: 0.5806
 Best site-MNIST            | Epoch:29 | Val Acc: 0.5893
 Best site-MNIST            | Epoch:29 | Val Acc: 0.6176
 Best site-MNIST            | Epoch:29 | Val Acc: 0.6284
 Best site-MNIST            | Epoch:29 | Val Acc: 0.6042
 Best site-USPS             | Epoch:29 | Val Acc: 0.7000
 Best site-USPS             | Epoch:29 | Val Acc: 0.4444
 Best site-USPS             | Epoch:29 | Val Acc: 0.5000
 Best site-USPS             | Epoch:29 | Val Acc: 0.5172
 Best site-USPS             | Epoch:29 | Val Acc: 0.6190
 Best site-USPS             | Epoch:29 | Val Acc: 0.6614
 Best site-SynthDigits      | Epoch:29 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:29 | Val Acc: 0.2941
 Best site-SynthDigits      | Epoch:29 | Val Acc: 0.2787
 Best site-MNIST-M          | Epoch:29 | Val Acc: 0.2667
 Best site-MNIST-M          | Epoch:29 | Val Acc: 0.2593
 Best site-SVHN             | Epoch:29 | Val Acc: 0.1857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
 Test site-MNIST           | Epoch:29 | Test Acc: 0.6336
 Test site-USPS            | Epoch:29 | Test Acc: 0.6817
 Test site-SynthDigits     | Epoch:29 | Test Acc: 0.2653
 Test site-MNIST-M         | Epoch:29 | Test Acc: 0.2119
 Test site-SVHN            | Epoch:29 | Test Acc: 0.1842
Average Test Accuracy: 0.3953
============ Train epoch 30 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-0
cnt=[4, 9, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.7889 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7556 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.6575 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.6516 | Train Acc: 0.6842
 Site-MNIST           | Train Loss: 1.4294 | Train Acc: 0.7429
 Site-MNIST           | Train Loss: 1.6494 | Train Acc: 0.7698
 Site-MNIST           | Train Loss: 1.6535 | Train Acc: 0.6476
 Site-MNIST           | Train Loss: 1.7295 | Train Acc: 0.5868
 Site-MNIST           | Train Loss: 1.6944 | Train Acc: 0.6128
 Site-MNIST           | Train Loss: 1.6505 | Train Acc: 0.6762
 Site-USPS            | Train Loss: 1.6347 | Train Acc: 0.6750
 Site-USPS            | Train Loss: 1.6565 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.5635 | Train Acc: 0.6744
 Site-USPS            | Train Loss: 1.6122 | Train Acc: 0.6137
 Site-USPS            | Train Loss: 1.6214 | Train Acc: 0.6548
 Site-USPS            | Train Loss: 1.6265 | Train Acc: 0.6653
 Site-SynthDigits     | Train Loss: 2.1934 | Train Acc: 0.2119
 Site-SynthDigits     | Train Loss: 2.1873 | Train Acc: 0.2418
 Site-SynthDigits     | Train Loss: 2.1390 | Train Acc: 0.2974
 Site-MNIST-M         | Train Loss: 2.2306 | Train Acc: 0.2210
 Site-MNIST-M         | Train Loss: 2.2329 | Train Acc: 0.2385
 Site-SVHN            | Train Loss: 2.2751 | Train Acc: 0.1915
 Site-MNIST           | Val  Loss: 1.3691 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5527 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5826 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.7234 | Val  Acc: 0.5556
 Site-MNIST           | Val  Loss: 1.6986 | Val  Acc: 0.5294
 Site-MNIST           | Val  Loss: 1.7167 | Val  Acc: 0.5806
 Site-MNIST           | Val  Loss: 1.6939 | Val  Acc: 0.5893
 Site-MNIST           | Val  Loss: 1.6721 | Val  Acc: 0.6176
 Site-MNIST           | Val  Loss: 1.6936 | Val  Acc: 0.6339
 Site-MNIST           | Val  Loss: 1.6787 | Val  Acc: 0.6073
 Site-USPS            | Val  Loss: 1.5907 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7953 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.6768 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.7003 | Val  Acc: 0.5172
 Site-USPS            | Val  Loss: 1.6409 | Val  Acc: 0.6190
 Site-USPS            | Val  Loss: 1.5953 | Val  Acc: 0.6614
 Site-SynthDigits     | Val  Loss: 2.2143 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2381 | Val  Acc: 0.2941
 Site-SynthDigits     | Val  Loss: 2.1663 | Val  Acc: 0.2787
 Site-MNIST-M         | Val  Loss: 2.2057 | Val  Acc: 0.2667
 Site-MNIST-M         | Val  Loss: 2.2012 | Val  Acc: 0.2593
 Site-SVHN            | Val  Loss: 2.2878 | Val  Acc: 0.2000
Average Valid Accuracy: 0.5396
Aggregated Acc | Val Acc: 0.5482
 Best site-MNIST            | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:30 | Val Acc: 0.5556
 Best site-MNIST            | Epoch:30 | Val Acc: 0.5294
 Best site-MNIST            | Epoch:30 | Val Acc: 0.5806
 Best site-MNIST            | Epoch:30 | Val Acc: 0.5893
 Best site-MNIST            | Epoch:30 | Val Acc: 0.6176
 Best site-MNIST            | Epoch:30 | Val Acc: 0.6339
 Best site-MNIST            | Epoch:30 | Val Acc: 0.6073
 Best site-USPS             | Epoch:30 | Val Acc: 0.7000
 Best site-USPS             | Epoch:30 | Val Acc: 0.4444
 Best site-USPS             | Epoch:30 | Val Acc: 0.5000
 Best site-USPS             | Epoch:30 | Val Acc: 0.5172
 Best site-USPS             | Epoch:30 | Val Acc: 0.6190
 Best site-USPS             | Epoch:30 | Val Acc: 0.6614
 Best site-SynthDigits      | Epoch:30 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:30 | Val Acc: 0.2941
 Best site-SynthDigits      | Epoch:30 | Val Acc: 0.2787
 Best site-MNIST-M          | Epoch:30 | Val Acc: 0.2667
 Best site-MNIST-M          | Epoch:30 | Val Acc: 0.2593
 Best site-SVHN             | Epoch:30 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 31 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-4
client-20 is in G-4
client-21 is in G-3
cnt=[10, 3, 6, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.7817 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7456 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.6411 | Train Acc: 0.7143
 Site-MNIST           | Train Loss: 1.6357 | Train Acc: 0.6842
 Site-MNIST           | Train Loss: 1.6331 | Train Acc: 0.7429
 Site-MNIST           | Train Loss: 1.6399 | Train Acc: 0.7698
 Site-MNIST           | Train Loss: 1.6272 | Train Acc: 0.6388
 Site-MNIST           | Train Loss: 1.7258 | Train Acc: 0.5941
 Site-MNIST           | Train Loss: 1.6856 | Train Acc: 0.6223
 Site-MNIST           | Train Loss: 1.6357 | Train Acc: 0.6830
 Site-USPS            | Train Loss: 1.6170 | Train Acc: 0.7000
 Site-USPS            | Train Loss: 1.6915 | Train Acc: 0.6250
 Site-USPS            | Train Loss: 1.6761 | Train Acc: 0.6744
 Site-USPS            | Train Loss: 1.6181 | Train Acc: 0.6180
 Site-USPS            | Train Loss: 1.6051 | Train Acc: 0.6619
 Site-USPS            | Train Loss: 1.6095 | Train Acc: 0.6627
 Site-SynthDigits     | Train Loss: 2.1980 | Train Acc: 0.2185
 Site-SynthDigits     | Train Loss: 2.1852 | Train Acc: 0.2454
 Site-SynthDigits     | Train Loss: 2.1316 | Train Acc: 0.3014
 Site-MNIST-M         | Train Loss: 2.2308 | Train Acc: 0.2320
 Site-MNIST-M         | Train Loss: 2.2255 | Train Acc: 0.2508
 Site-SVHN            | Train Loss: 2.2777 | Train Acc: 0.1915
 Site-MNIST           | Val  Loss: 1.3429 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5331 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5678 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.7130 | Val  Acc: 0.5556
 Site-MNIST           | Val  Loss: 1.6852 | Val  Acc: 0.5294
 Site-MNIST           | Val  Loss: 1.7031 | Val  Acc: 0.5806
 Site-MNIST           | Val  Loss: 1.6806 | Val  Acc: 0.5893
 Site-MNIST           | Val  Loss: 1.6590 | Val  Acc: 0.6176
 Site-MNIST           | Val  Loss: 1.6815 | Val  Acc: 0.6393
 Site-MNIST           | Val  Loss: 1.6669 | Val  Acc: 0.6073
 Site-USPS            | Val  Loss: 1.5758 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7831 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.6619 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.6861 | Val  Acc: 0.5172
 Site-USPS            | Val  Loss: 1.6249 | Val  Acc: 0.6286
 Site-USPS            | Val  Loss: 1.5787 | Val  Acc: 0.6720
 Site-SynthDigits     | Val  Loss: 2.2101 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2356 | Val  Acc: 0.2941
 Site-SynthDigits     | Val  Loss: 2.1614 | Val  Acc: 0.2787
 Site-MNIST-M         | Val  Loss: 2.2050 | Val  Acc: 0.2667
 Site-MNIST-M         | Val  Loss: 2.1999 | Val  Acc: 0.2840
 Site-SVHN            | Val  Loss: 2.2862 | Val  Acc: 0.2000
Average Valid Accuracy: 0.5419
Aggregated Acc | Val Acc: 0.4015
 Best site-MNIST            | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:31 | Val Acc: 0.5556
 Best site-MNIST            | Epoch:31 | Val Acc: 0.5294
 Best site-MNIST            | Epoch:31 | Val Acc: 0.5806
 Best site-MNIST            | Epoch:31 | Val Acc: 0.5893
 Best site-MNIST            | Epoch:31 | Val Acc: 0.6176
 Best site-MNIST            | Epoch:31 | Val Acc: 0.6393
 Best site-MNIST            | Epoch:31 | Val Acc: 0.6073
 Best site-USPS             | Epoch:31 | Val Acc: 0.7000
 Best site-USPS             | Epoch:31 | Val Acc: 0.4444
 Best site-USPS             | Epoch:31 | Val Acc: 0.5000
 Best site-USPS             | Epoch:31 | Val Acc: 0.5172
 Best site-USPS             | Epoch:31 | Val Acc: 0.6286
 Best site-USPS             | Epoch:31 | Val Acc: 0.6720
 Best site-SynthDigits      | Epoch:31 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:31 | Val Acc: 0.2941
 Best site-SynthDigits      | Epoch:31 | Val Acc: 0.2787
 Best site-MNIST-M          | Epoch:31 | Val Acc: 0.2667
 Best site-MNIST-M          | Epoch:31 | Val Acc: 0.2840
 Best site-SVHN             | Epoch:31 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 32 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.7734 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7349 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.6258 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.6194 | Train Acc: 0.6842
 Site-MNIST           | Train Loss: 1.5091 | Train Acc: 0.7429
 Site-MNIST           | Train Loss: 1.6304 | Train Acc: 0.7698
 Site-MNIST           | Train Loss: 1.6301 | Train Acc: 0.6476
 Site-MNIST           | Train Loss: 1.6933 | Train Acc: 0.5868
 Site-MNIST           | Train Loss: 1.6651 | Train Acc: 0.6291
 Site-MNIST           | Train Loss: 1.6235 | Train Acc: 0.6815
 Site-USPS            | Train Loss: 1.5983 | Train Acc: 0.7000
 Site-USPS            | Train Loss: 1.5385 | Train Acc: 0.6389
 Site-USPS            | Train Loss: 1.6893 | Train Acc: 0.6822
 Site-USPS            | Train Loss: 1.5859 | Train Acc: 0.6266
 Site-USPS            | Train Loss: 1.5841 | Train Acc: 0.6714
 Site-USPS            | Train Loss: 1.5932 | Train Acc: 0.6653
 Site-SynthDigits     | Train Loss: 2.1695 | Train Acc: 0.2252
 Site-SynthDigits     | Train Loss: 2.1651 | Train Acc: 0.2491
 Site-SynthDigits     | Train Loss: 2.1251 | Train Acc: 0.3014
 Site-MNIST-M         | Train Loss: 2.2280 | Train Acc: 0.2376
 Site-MNIST-M         | Train Loss: 2.2264 | Train Acc: 0.2691
 Site-SVHN            | Train Loss: 2.2652 | Train Acc: 0.1986
 Site-MNIST           | Val  Loss: 1.3142 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5117 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5541 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.7031 | Val  Acc: 0.5556
 Site-MNIST           | Val  Loss: 1.6726 | Val  Acc: 0.5294
 Site-MNIST           | Val  Loss: 1.6913 | Val  Acc: 0.5484
 Site-MNIST           | Val  Loss: 1.6683 | Val  Acc: 0.6071
 Site-MNIST           | Val  Loss: 1.6466 | Val  Acc: 0.6275
 Site-MNIST           | Val  Loss: 1.6698 | Val  Acc: 0.6230
 Site-MNIST           | Val  Loss: 1.6558 | Val  Acc: 0.6012
 Site-USPS            | Val  Loss: 1.5600 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7687 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.6451 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.6713 | Val  Acc: 0.5345
 Site-USPS            | Val  Loss: 1.6083 | Val  Acc: 0.6476
 Site-USPS            | Val  Loss: 1.5618 | Val  Acc: 0.6825
 Site-SynthDigits     | Val  Loss: 2.2051 | Val  Acc: 0.2162
 Site-SynthDigits     | Val  Loss: 2.2335 | Val  Acc: 0.2794
 Site-SynthDigits     | Val  Loss: 2.1560 | Val  Acc: 0.2623
 Site-MNIST-M         | Val  Loss: 2.2049 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1974 | Val  Acc: 0.2963
 Site-SVHN            | Val  Loss: 2.2847 | Val  Acc: 0.2000
Average Valid Accuracy: 0.5429
Aggregated Acc | Val Acc: 0.4039
 Best site-MNIST            | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:32 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:32 | Val Acc: 0.5556
 Best site-MNIST            | Epoch:32 | Val Acc: 0.5294
 Best site-MNIST            | Epoch:32 | Val Acc: 0.5484
 Best site-MNIST            | Epoch:32 | Val Acc: 0.6071
 Best site-MNIST            | Epoch:32 | Val Acc: 0.6275
 Best site-MNIST            | Epoch:32 | Val Acc: 0.6230
 Best site-MNIST            | Epoch:32 | Val Acc: 0.6012
 Best site-USPS             | Epoch:32 | Val Acc: 0.7000
 Best site-USPS             | Epoch:32 | Val Acc: 0.4444
 Best site-USPS             | Epoch:32 | Val Acc: 0.5000
 Best site-USPS             | Epoch:32 | Val Acc: 0.5345
 Best site-USPS             | Epoch:32 | Val Acc: 0.6476
 Best site-USPS             | Epoch:32 | Val Acc: 0.6825
 Best site-SynthDigits      | Epoch:32 | Val Acc: 0.2162
 Best site-SynthDigits      | Epoch:32 | Val Acc: 0.2794
 Best site-SynthDigits      | Epoch:32 | Val Acc: 0.2623
 Best site-MNIST-M          | Epoch:32 | Val Acc: 0.2889
 Best site-MNIST-M          | Epoch:32 | Val Acc: 0.2963
 Best site-SVHN             | Epoch:32 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 33 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.7625 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7219 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.6087 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.6025 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.4887 | Train Acc: 0.7429
 Site-MNIST           | Train Loss: 1.6195 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.6072 | Train Acc: 0.6608
 Site-MNIST           | Train Loss: 1.6966 | Train Acc: 0.6039
 Site-MNIST           | Train Loss: 1.6539 | Train Acc: 0.6454
 Site-MNIST           | Train Loss: 1.6124 | Train Acc: 0.6830
 Site-USPS            | Train Loss: 1.5788 | Train Acc: 0.7000
 Site-USPS            | Train Loss: 1.5902 | Train Acc: 0.6528
 Site-USPS            | Train Loss: 1.2732 | Train Acc: 0.6822
 Site-USPS            | Train Loss: 1.5744 | Train Acc: 0.6309
 Site-USPS            | Train Loss: 1.5697 | Train Acc: 0.6833
 Site-USPS            | Train Loss: 1.5761 | Train Acc: 0.6640
 Site-SynthDigits     | Train Loss: 2.1628 | Train Acc: 0.2318
 Site-SynthDigits     | Train Loss: 2.1636 | Train Acc: 0.2491
 Site-SynthDigits     | Train Loss: 2.1183 | Train Acc: 0.3035
 Site-MNIST-M         | Train Loss: 2.2258 | Train Acc: 0.2320
 Site-MNIST-M         | Train Loss: 2.2205 | Train Acc: 0.2722
 Site-SVHN            | Train Loss: 2.2722 | Train Acc: 0.1986
 Site-MNIST           | Val  Loss: 1.2973 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4924 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5421 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6921 | Val  Acc: 0.5556
 Site-MNIST           | Val  Loss: 1.6590 | Val  Acc: 0.5294
 Site-MNIST           | Val  Loss: 1.6797 | Val  Acc: 0.5806
 Site-MNIST           | Val  Loss: 1.6555 | Val  Acc: 0.6250
 Site-MNIST           | Val  Loss: 1.6335 | Val  Acc: 0.6471
 Site-MNIST           | Val  Loss: 1.6577 | Val  Acc: 0.6393
 Site-MNIST           | Val  Loss: 1.6436 | Val  Acc: 0.6193
 Site-USPS            | Val  Loss: 1.5422 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7529 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.6290 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.6571 | Val  Acc: 0.5345
 Site-USPS            | Val  Loss: 1.5921 | Val  Acc: 0.6476
 Site-USPS            | Val  Loss: 1.5446 | Val  Acc: 0.6825
 Site-SynthDigits     | Val  Loss: 2.1997 | Val  Acc: 0.2432
 Site-SynthDigits     | Val  Loss: 2.2318 | Val  Acc: 0.2941
 Site-SynthDigits     | Val  Loss: 2.1492 | Val  Acc: 0.2623
 Site-MNIST-M         | Val  Loss: 2.2033 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1941 | Val  Acc: 0.2840
 Site-SVHN            | Val  Loss: 2.2843 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5496
Aggregated Acc | Val Acc: 0.4103
 Best site-MNIST            | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:33 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:33 | Val Acc: 0.5556
 Best site-MNIST            | Epoch:33 | Val Acc: 0.5294
 Best site-MNIST            | Epoch:33 | Val Acc: 0.5806
 Best site-MNIST            | Epoch:33 | Val Acc: 0.6250
 Best site-MNIST            | Epoch:33 | Val Acc: 0.6471
 Best site-MNIST            | Epoch:33 | Val Acc: 0.6393
 Best site-MNIST            | Epoch:33 | Val Acc: 0.6193
 Best site-USPS             | Epoch:33 | Val Acc: 0.7000
 Best site-USPS             | Epoch:33 | Val Acc: 0.4444
 Best site-USPS             | Epoch:33 | Val Acc: 0.5000
 Best site-USPS             | Epoch:33 | Val Acc: 0.5345
 Best site-USPS             | Epoch:33 | Val Acc: 0.6476
 Best site-USPS             | Epoch:33 | Val Acc: 0.6825
 Best site-SynthDigits      | Epoch:33 | Val Acc: 0.2432
 Best site-SynthDigits      | Epoch:33 | Val Acc: 0.2941
 Best site-SynthDigits      | Epoch:33 | Val Acc: 0.2623
 Best site-MNIST-M          | Epoch:33 | Val Acc: 0.2889
 Best site-MNIST-M          | Epoch:33 | Val Acc: 0.2840
 Best site-SVHN             | Epoch:33 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 34 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.7496 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.7097 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.5923 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.5858 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.3224 | Train Acc: 0.7429
 Site-MNIST           | Train Loss: 1.6071 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.6008 | Train Acc: 0.6740
 Site-MNIST           | Train Loss: 1.6844 | Train Acc: 0.6186
 Site-MNIST           | Train Loss: 1.6434 | Train Acc: 0.6535
 Site-MNIST           | Train Loss: 1.5993 | Train Acc: 0.6913
 Site-USPS            | Train Loss: 1.5618 | Train Acc: 0.7000
 Site-USPS            | Train Loss: 1.4852 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.7315 | Train Acc: 0.6977
 Site-USPS            | Train Loss: 1.5595 | Train Acc: 0.6438
 Site-USPS            | Train Loss: 1.5563 | Train Acc: 0.6786
 Site-USPS            | Train Loss: 1.5609 | Train Acc: 0.6653
 Site-SynthDigits     | Train Loss: 2.1542 | Train Acc: 0.2384
 Site-SynthDigits     | Train Loss: 2.1639 | Train Acc: 0.2601
 Site-SynthDigits     | Train Loss: 2.1152 | Train Acc: 0.3055
 Site-MNIST-M         | Train Loss: 2.2167 | Train Acc: 0.2431
 Site-MNIST-M         | Train Loss: 2.2097 | Train Acc: 0.2752
 Site-SVHN            | Train Loss: 2.2713 | Train Acc: 0.1986
 Site-MNIST           | Val  Loss: 1.2938 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4781 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5285 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6772 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6443 | Val  Acc: 0.6471
 Site-MNIST           | Val  Loss: 1.6668 | Val  Acc: 0.6774
 Site-MNIST           | Val  Loss: 1.6421 | Val  Acc: 0.6607
 Site-MNIST           | Val  Loss: 1.6196 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6445 | Val  Acc: 0.6448
 Site-MNIST           | Val  Loss: 1.6295 | Val  Acc: 0.6344
 Site-USPS            | Val  Loss: 1.5254 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7400 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.6158 | Val  Acc: 0.5312
 Site-USPS            | Val  Loss: 1.6447 | Val  Acc: 0.5517
 Site-USPS            | Val  Loss: 1.5780 | Val  Acc: 0.6667
 Site-USPS            | Val  Loss: 1.5288 | Val  Acc: 0.6878
 Site-SynthDigits     | Val  Loss: 2.1936 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.2299 | Val  Acc: 0.3088
 Site-SynthDigits     | Val  Loss: 2.1424 | Val  Acc: 0.2787
 Site-MNIST-M         | Val  Loss: 2.1992 | Val  Acc: 0.2667
 Site-MNIST-M         | Val  Loss: 2.1907 | Val  Acc: 0.2840
 Site-SVHN            | Val  Loss: 2.2827 | Val  Acc: 0.2000
Average Valid Accuracy: 0.5722
Aggregated Acc | Val Acc: 0.4196
 Best site-MNIST            | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:34 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:34 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:34 | Val Acc: 0.6471
 Best site-MNIST            | Epoch:34 | Val Acc: 0.6774
 Best site-MNIST            | Epoch:34 | Val Acc: 0.6607
 Best site-MNIST            | Epoch:34 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:34 | Val Acc: 0.6448
 Best site-MNIST            | Epoch:34 | Val Acc: 0.6344
 Best site-USPS             | Epoch:34 | Val Acc: 0.7000
 Best site-USPS             | Epoch:34 | Val Acc: 0.4444
 Best site-USPS             | Epoch:34 | Val Acc: 0.5312
 Best site-USPS             | Epoch:34 | Val Acc: 0.5517
 Best site-USPS             | Epoch:34 | Val Acc: 0.6667
 Best site-USPS             | Epoch:34 | Val Acc: 0.6878
 Best site-SynthDigits      | Epoch:34 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:34 | Val Acc: 0.3088
 Best site-SynthDigits      | Epoch:34 | Val Acc: 0.2787
 Best site-MNIST-M          | Epoch:34 | Val Acc: 0.2667
 Best site-MNIST-M          | Epoch:34 | Val Acc: 0.2840
 Best site-SVHN             | Epoch:34 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 35 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.7338 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6971 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.5776 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.5704 | Train Acc: 0.6579
 Site-MNIST           | Train Loss: 1.5711 | Train Acc: 0.7429
 Site-MNIST           | Train Loss: 1.5924 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.5907 | Train Acc: 0.6784
 Site-MNIST           | Train Loss: 1.6776 | Train Acc: 0.6235
 Site-MNIST           | Train Loss: 1.6234 | Train Acc: 0.6603
 Site-MNIST           | Train Loss: 1.5828 | Train Acc: 0.6943
 Site-USPS            | Train Loss: 1.5481 | Train Acc: 0.7000
 Site-USPS            | Train Loss: 1.5377 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.6269 | Train Acc: 0.6977
 Site-USPS            | Train Loss: 1.5575 | Train Acc: 0.6524
 Site-USPS            | Train Loss: 1.5435 | Train Acc: 0.6905
 Site-USPS            | Train Loss: 1.5478 | Train Acc: 0.6693
 Site-SynthDigits     | Train Loss: 2.1685 | Train Acc: 0.2450
 Site-SynthDigits     | Train Loss: 2.1455 | Train Acc: 0.2674
 Site-SynthDigits     | Train Loss: 2.1035 | Train Acc: 0.3075
 Site-MNIST-M         | Train Loss: 2.2076 | Train Acc: 0.2541
 Site-MNIST-M         | Train Loss: 2.1877 | Train Acc: 0.2722
 Site-SVHN            | Train Loss: 2.2687 | Train Acc: 0.1844
 Site-MNIST           | Val  Loss: 1.2777 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4622 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5148 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6649 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6300 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.6531 | Val  Acc: 0.7097
 Site-MNIST           | Val  Loss: 1.6283 | Val  Acc: 0.6786
 Site-MNIST           | Val  Loss: 1.6053 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6307 | Val  Acc: 0.6448
 Site-MNIST           | Val  Loss: 1.6155 | Val  Acc: 0.6375
 Site-USPS            | Val  Loss: 1.5093 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7291 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.6045 | Val  Acc: 0.5312
 Site-USPS            | Val  Loss: 1.6333 | Val  Acc: 0.5690
 Site-USPS            | Val  Loss: 1.5648 | Val  Acc: 0.6857
 Site-USPS            | Val  Loss: 1.5144 | Val  Acc: 0.6984
 Site-SynthDigits     | Val  Loss: 2.1876 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.2273 | Val  Acc: 0.3088
 Site-SynthDigits     | Val  Loss: 2.1357 | Val  Acc: 0.2869
 Site-MNIST-M         | Val  Loss: 2.1962 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1832 | Val  Acc: 0.2963
 Site-SVHN            | Val  Loss: 2.2817 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5801
Aggregated Acc | Val Acc: 0.4217
 Best site-MNIST            | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:35 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:35 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:35 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:35 | Val Acc: 0.7097
 Best site-MNIST            | Epoch:35 | Val Acc: 0.6786
 Best site-MNIST            | Epoch:35 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:35 | Val Acc: 0.6448
 Best site-MNIST            | Epoch:35 | Val Acc: 0.6375
 Best site-USPS             | Epoch:35 | Val Acc: 0.7000
 Best site-USPS             | Epoch:35 | Val Acc: 0.4444
 Best site-USPS             | Epoch:35 | Val Acc: 0.5312
 Best site-USPS             | Epoch:35 | Val Acc: 0.5690
 Best site-USPS             | Epoch:35 | Val Acc: 0.6857
 Best site-USPS             | Epoch:35 | Val Acc: 0.6984
 Best site-SynthDigits      | Epoch:35 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:35 | Val Acc: 0.3088
 Best site-SynthDigits      | Epoch:35 | Val Acc: 0.2869
 Best site-MNIST-M          | Epoch:35 | Val Acc: 0.2889
 Best site-MNIST-M          | Epoch:35 | Val Acc: 0.2963
 Best site-SVHN             | Epoch:35 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 36 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-4
client-17 is in G-4
client-18 is in G-4
client-19 is in G-1
client-20 is in G-1
client-21 is in G-4
cnt=[2, 2, 6, 8, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.7215 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6843 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.5617 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.5540 | Train Acc: 0.6842
 Site-MNIST           | Train Loss: 1.5855 | Train Acc: 0.7571
 Site-MNIST           | Train Loss: 1.5802 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.5529 | Train Acc: 0.6916
 Site-MNIST           | Train Loss: 1.6531 | Train Acc: 0.6308
 Site-MNIST           | Train Loss: 1.6169 | Train Acc: 0.6630
 Site-MNIST           | Train Loss: 1.5687 | Train Acc: 0.7049
 Site-USPS            | Train Loss: 1.5359 | Train Acc: 0.7000
 Site-USPS            | Train Loss: 1.4844 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.5960 | Train Acc: 0.6977
 Site-USPS            | Train Loss: 1.5204 | Train Acc: 0.6567
 Site-USPS            | Train Loss: 1.5245 | Train Acc: 0.6929
 Site-USPS            | Train Loss: 1.5347 | Train Acc: 0.6720
 Site-SynthDigits     | Train Loss: 2.1426 | Train Acc: 0.2583
 Site-SynthDigits     | Train Loss: 2.1470 | Train Acc: 0.2784
 Site-SynthDigits     | Train Loss: 2.0958 | Train Acc: 0.3177
 Site-MNIST-M         | Train Loss: 2.2004 | Train Acc: 0.2597
 Site-MNIST-M         | Train Loss: 2.1833 | Train Acc: 0.2844
 Site-SVHN            | Train Loss: 2.2641 | Train Acc: 0.1879
 Site-MNIST           | Val  Loss: 1.2722 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4532 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.5020 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6517 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6166 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.6397 | Val  Acc: 0.7097
 Site-MNIST           | Val  Loss: 1.6146 | Val  Acc: 0.6964
 Site-MNIST           | Val  Loss: 1.5910 | Val  Acc: 0.6765
 Site-MNIST           | Val  Loss: 1.6169 | Val  Acc: 0.6503
 Site-MNIST           | Val  Loss: 1.6012 | Val  Acc: 0.6405
 Site-USPS            | Val  Loss: 1.4944 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7195 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.5942 | Val  Acc: 0.5312
 Site-USPS            | Val  Loss: 1.6223 | Val  Acc: 0.5690
 Site-USPS            | Val  Loss: 1.5528 | Val  Acc: 0.6857
 Site-USPS            | Val  Loss: 1.5017 | Val  Acc: 0.6984
 Site-SynthDigits     | Val  Loss: 2.1825 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.2228 | Val  Acc: 0.3235
 Site-SynthDigits     | Val  Loss: 2.1309 | Val  Acc: 0.3033
 Site-MNIST-M         | Val  Loss: 2.1879 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1747 | Val  Acc: 0.3086
 Site-SVHN            | Val  Loss: 2.2827 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5837
Aggregated Acc | Val Acc: 0.5728
 Best site-MNIST            | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:36 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:36 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:36 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:36 | Val Acc: 0.7097
 Best site-MNIST            | Epoch:36 | Val Acc: 0.6964
 Best site-MNIST            | Epoch:36 | Val Acc: 0.6765
 Best site-MNIST            | Epoch:36 | Val Acc: 0.6503
 Best site-MNIST            | Epoch:36 | Val Acc: 0.6405
 Best site-USPS             | Epoch:36 | Val Acc: 0.7000
 Best site-USPS             | Epoch:36 | Val Acc: 0.4444
 Best site-USPS             | Epoch:36 | Val Acc: 0.5312
 Best site-USPS             | Epoch:36 | Val Acc: 0.5690
 Best site-USPS             | Epoch:36 | Val Acc: 0.6857
 Best site-USPS             | Epoch:36 | Val Acc: 0.6984
 Best site-SynthDigits      | Epoch:36 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:36 | Val Acc: 0.3235
 Best site-SynthDigits      | Epoch:36 | Val Acc: 0.3033
 Best site-MNIST-M          | Epoch:36 | Val Acc: 0.2889
 Best site-MNIST-M          | Epoch:36 | Val Acc: 0.3086
 Best site-SVHN             | Epoch:36 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 37 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-4
client-20 is in G-4
client-21 is in G-4
cnt=[6, 3, 2, 8, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.7092 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6725 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.5474 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.5389 | Train Acc: 0.6842
 Site-MNIST           | Train Loss: 1.5877 | Train Acc: 0.7714
 Site-MNIST           | Train Loss: 1.5674 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.5565 | Train Acc: 0.6960
 Site-MNIST           | Train Loss: 1.6581 | Train Acc: 0.6406
 Site-MNIST           | Train Loss: 1.6029 | Train Acc: 0.6644
 Site-MNIST           | Train Loss: 1.5559 | Train Acc: 0.7109
 Site-USPS            | Train Loss: 1.5228 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.5914 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.5942 | Train Acc: 0.6977
 Site-USPS            | Train Loss: 1.5344 | Train Acc: 0.6524
 Site-USPS            | Train Loss: 1.5115 | Train Acc: 0.6976
 Site-USPS            | Train Loss: 1.5215 | Train Acc: 0.6759
 Site-SynthDigits     | Train Loss: 2.1522 | Train Acc: 0.2649
 Site-SynthDigits     | Train Loss: 2.1548 | Train Acc: 0.2747
 Site-SynthDigits     | Train Loss: 2.0898 | Train Acc: 0.3096
 Site-MNIST-M         | Train Loss: 2.1936 | Train Acc: 0.2541
 Site-MNIST-M         | Train Loss: 2.1675 | Train Acc: 0.3028
 Site-SVHN            | Train Loss: 2.2663 | Train Acc: 0.1844
 Site-MNIST           | Val  Loss: 1.2583 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4400 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4894 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6407 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.6042 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.6277 | Val  Acc: 0.7419
 Site-MNIST           | Val  Loss: 1.6023 | Val  Acc: 0.7143
 Site-MNIST           | Val  Loss: 1.5781 | Val  Acc: 0.6961
 Site-MNIST           | Val  Loss: 1.6044 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.5885 | Val  Acc: 0.6495
 Site-USPS            | Val  Loss: 1.4796 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7096 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.5833 | Val  Acc: 0.5312
 Site-USPS            | Val  Loss: 1.6111 | Val  Acc: 0.5690
 Site-USPS            | Val  Loss: 1.5405 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.4887 | Val  Acc: 0.6931
 Site-SynthDigits     | Val  Loss: 2.1749 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.2162 | Val  Acc: 0.3235
 Site-SynthDigits     | Val  Loss: 2.1255 | Val  Acc: 0.3033
 Site-MNIST-M         | Val  Loss: 2.1782 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1651 | Val  Acc: 0.3086
 Site-SVHN            | Val  Loss: 2.2858 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5871
Aggregated Acc | Val Acc: 0.5724
 Best site-MNIST            | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:37 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:37 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:37 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:37 | Val Acc: 0.7419
 Best site-MNIST            | Epoch:37 | Val Acc: 0.7143
 Best site-MNIST            | Epoch:37 | Val Acc: 0.6961
 Best site-MNIST            | Epoch:37 | Val Acc: 0.6612
 Best site-MNIST            | Epoch:37 | Val Acc: 0.6495
 Best site-USPS             | Epoch:37 | Val Acc: 0.7000
 Best site-USPS             | Epoch:37 | Val Acc: 0.4444
 Best site-USPS             | Epoch:37 | Val Acc: 0.5312
 Best site-USPS             | Epoch:37 | Val Acc: 0.5690
 Best site-USPS             | Epoch:37 | Val Acc: 0.6762
 Best site-USPS             | Epoch:37 | Val Acc: 0.6931
 Best site-SynthDigits      | Epoch:37 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:37 | Val Acc: 0.3235
 Best site-SynthDigits      | Epoch:37 | Val Acc: 0.3033
 Best site-MNIST-M          | Epoch:37 | Val Acc: 0.2889
 Best site-MNIST-M          | Epoch:37 | Val Acc: 0.3086
 Best site-SVHN             | Epoch:37 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 38 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-4
client-20 is in G-4
client-21 is in G-4
cnt=[1, 3, 6, 9, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6959 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6603 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.5323 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.5242 | Train Acc: 0.6842
 Site-MNIST           | Train Loss: 1.4025 | Train Acc: 0.7714
 Site-MNIST           | Train Loss: 1.5548 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.5239 | Train Acc: 0.7093
 Site-MNIST           | Train Loss: 1.6242 | Train Acc: 0.6430
 Site-MNIST           | Train Loss: 1.5886 | Train Acc: 0.6780
 Site-MNIST           | Train Loss: 1.5441 | Train Acc: 0.7162
 Site-USPS            | Train Loss: 1.5115 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.4896 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.7374 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.5092 | Train Acc: 0.6652
 Site-USPS            | Train Loss: 1.5166 | Train Acc: 0.6976
 Site-USPS            | Train Loss: 1.5080 | Train Acc: 0.6825
 Site-SynthDigits     | Train Loss: 2.1391 | Train Acc: 0.2781
 Site-SynthDigits     | Train Loss: 2.1389 | Train Acc: 0.2784
 Site-SynthDigits     | Train Loss: 2.0834 | Train Acc: 0.3198
 Site-MNIST-M         | Train Loss: 2.1894 | Train Acc: 0.2541
 Site-MNIST-M         | Train Loss: 2.1570 | Train Acc: 0.3089
 Site-SVHN            | Train Loss: 2.2612 | Train Acc: 0.1915
 Site-MNIST           | Val  Loss: 1.2480 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4293 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4778 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6302 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5918 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.6148 | Val  Acc: 0.7742
 Site-MNIST           | Val  Loss: 1.5892 | Val  Acc: 0.7321
 Site-MNIST           | Val  Loss: 1.5647 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5916 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.5756 | Val  Acc: 0.6586
 Site-USPS            | Val  Loss: 1.4645 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.7000 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.5737 | Val  Acc: 0.5312
 Site-USPS            | Val  Loss: 1.6007 | Val  Acc: 0.5690
 Site-USPS            | Val  Loss: 1.5289 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.4763 | Val  Acc: 0.6984
 Site-SynthDigits     | Val  Loss: 2.1666 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.2101 | Val  Acc: 0.3382
 Site-SynthDigits     | Val  Loss: 2.1199 | Val  Acc: 0.3115
 Site-MNIST-M         | Val  Loss: 2.1702 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1580 | Val  Acc: 0.3086
 Site-SVHN            | Val  Loss: 2.2883 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5915
Aggregated Acc | Val Acc: 0.5822
 Best site-MNIST            | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:38 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:38 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:38 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:38 | Val Acc: 0.7742
 Best site-MNIST            | Epoch:38 | Val Acc: 0.7321
 Best site-MNIST            | Epoch:38 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:38 | Val Acc: 0.6612
 Best site-MNIST            | Epoch:38 | Val Acc: 0.6586
 Best site-USPS             | Epoch:38 | Val Acc: 0.7000
 Best site-USPS             | Epoch:38 | Val Acc: 0.4444
 Best site-USPS             | Epoch:38 | Val Acc: 0.5312
 Best site-USPS             | Epoch:38 | Val Acc: 0.5690
 Best site-USPS             | Epoch:38 | Val Acc: 0.6762
 Best site-USPS             | Epoch:38 | Val Acc: 0.6984
 Best site-SynthDigits      | Epoch:38 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:38 | Val Acc: 0.3382
 Best site-SynthDigits      | Epoch:38 | Val Acc: 0.3115
 Best site-MNIST-M          | Epoch:38 | Val Acc: 0.2889
 Best site-MNIST-M          | Epoch:38 | Val Acc: 0.3086
 Best site-SVHN             | Epoch:38 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 39 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6856 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6490 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.5176 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.5100 | Train Acc: 0.6842
 Site-MNIST           | Train Loss: 1.4241 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.5425 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.5432 | Train Acc: 0.7137
 Site-MNIST           | Train Loss: 1.6298 | Train Acc: 0.6381
 Site-MNIST           | Train Loss: 1.5802 | Train Acc: 0.6793
 Site-MNIST           | Train Loss: 1.5317 | Train Acc: 0.7192
 Site-USPS            | Train Loss: 1.4990 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.5105 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.5424 | Train Acc: 0.6977
 Site-USPS            | Train Loss: 1.5053 | Train Acc: 0.6652
 Site-USPS            | Train Loss: 1.4945 | Train Acc: 0.6976
 Site-USPS            | Train Loss: 1.4967 | Train Acc: 0.6852
 Site-SynthDigits     | Train Loss: 2.1249 | Train Acc: 0.2715
 Site-SynthDigits     | Train Loss: 2.1250 | Train Acc: 0.2784
 Site-SynthDigits     | Train Loss: 2.0777 | Train Acc: 0.3218
 Site-MNIST-M         | Train Loss: 2.1849 | Train Acc: 0.2597
 Site-MNIST-M         | Train Loss: 2.1853 | Train Acc: 0.3089
 Site-SVHN            | Train Loss: 2.2661 | Train Acc: 0.1809
 Site-MNIST           | Val  Loss: 1.2329 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4160 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4661 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6208 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5812 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.6032 | Val  Acc: 0.7419
 Site-MNIST           | Val  Loss: 1.5772 | Val  Acc: 0.7143
 Site-MNIST           | Val  Loss: 1.5522 | Val  Acc: 0.6961
 Site-MNIST           | Val  Loss: 1.5800 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.5640 | Val  Acc: 0.6556
 Site-USPS            | Val  Loss: 1.4529 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.6913 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.5635 | Val  Acc: 0.5312
 Site-USPS            | Val  Loss: 1.5902 | Val  Acc: 0.5690
 Site-USPS            | Val  Loss: 1.5173 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.4649 | Val  Acc: 0.7037
 Site-SynthDigits     | Val  Loss: 2.1605 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.2042 | Val  Acc: 0.3382
 Site-SynthDigits     | Val  Loss: 2.1145 | Val  Acc: 0.3115
 Site-MNIST-M         | Val  Loss: 2.1652 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1537 | Val  Acc: 0.3210
 Site-SVHN            | Val  Loss: 2.2889 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5894
Aggregated Acc | Val Acc: 0.4303
============ Train epoch 40 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[6, 3, 10, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6740 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6373 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.5040 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4967 | Train Acc: 0.7105
 Site-MNIST           | Train Loss: 1.3550 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.5319 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.5159 | Train Acc: 0.7181
 Site-MNIST           | Train Loss: 1.6157 | Train Acc: 0.6430
 Site-MNIST           | Train Loss: 1.5641 | Train Acc: 0.6793
 Site-MNIST           | Train Loss: 1.5200 | Train Acc: 0.7208
 Site-USPS            | Train Loss: 1.4875 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.3996 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.4872 | Train Acc: 0.6977
 Site-USPS            | Train Loss: 1.4842 | Train Acc: 0.6652
 Site-USPS            | Train Loss: 1.4824 | Train Acc: 0.7048
 Site-USPS            | Train Loss: 1.4837 | Train Acc: 0.6918
 Site-SynthDigits     | Train Loss: 2.1135 | Train Acc: 0.2715
 Site-SynthDigits     | Train Loss: 2.1198 | Train Acc: 0.2784
 Site-SynthDigits     | Train Loss: 2.0694 | Train Acc: 0.3299
 Site-MNIST-M         | Train Loss: 2.1794 | Train Acc: 0.2873
 Site-MNIST-M         | Train Loss: 2.1684 | Train Acc: 0.3180
 Site-SVHN            | Train Loss: 2.2594 | Train Acc: 0.1844
 Site-MNIST           | Val  Loss: 1.2215 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4037 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4551 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6115 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5695 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5924 | Val  Acc: 0.7742
 Site-MNIST           | Val  Loss: 1.5662 | Val  Acc: 0.7321
 Site-MNIST           | Val  Loss: 1.5408 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5688 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.5528 | Val  Acc: 0.6556
 Site-USPS            | Val  Loss: 1.4382 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.6814 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.5536 | Val  Acc: 0.5312
 Site-USPS            | Val  Loss: 1.5798 | Val  Acc: 0.5690
 Site-USPS            | Val  Loss: 1.5059 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.4526 | Val  Acc: 0.7037
 Site-SynthDigits     | Val  Loss: 2.1542 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1982 | Val  Acc: 0.3382
 Site-SynthDigits     | Val  Loss: 2.1087 | Val  Acc: 0.3197
 Site-MNIST-M         | Val  Loss: 2.1605 | Val  Acc: 0.3111
 Site-MNIST-M         | Val  Loss: 2.1485 | Val  Acc: 0.3457
 Site-SVHN            | Val  Loss: 2.2890 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5947
Aggregated Acc | Val Acc: 0.4367
 Best site-MNIST            | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:40 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:40 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:40 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:40 | Val Acc: 0.7742
 Best site-MNIST            | Epoch:40 | Val Acc: 0.7321
 Best site-MNIST            | Epoch:40 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:40 | Val Acc: 0.6612
 Best site-MNIST            | Epoch:40 | Val Acc: 0.6556
 Best site-USPS             | Epoch:40 | Val Acc: 0.7000
 Best site-USPS             | Epoch:40 | Val Acc: 0.4444
 Best site-USPS             | Epoch:40 | Val Acc: 0.5312
 Best site-USPS             | Epoch:40 | Val Acc: 0.5690
 Best site-USPS             | Epoch:40 | Val Acc: 0.6762
 Best site-USPS             | Epoch:40 | Val Acc: 0.7037
 Best site-SynthDigits      | Epoch:40 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:40 | Val Acc: 0.3382
 Best site-SynthDigits      | Epoch:40 | Val Acc: 0.3197
 Best site-MNIST-M          | Epoch:40 | Val Acc: 0.3111
 Best site-MNIST-M          | Epoch:40 | Val Acc: 0.3457
 Best site-SVHN             | Epoch:40 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 41 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6662 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6270 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.4890 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4834 | Train Acc: 0.7105
 Site-MNIST           | Train Loss: 1.4661 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.5208 | Train Acc: 0.7619
 Site-MNIST           | Train Loss: 1.5172 | Train Acc: 0.7225
 Site-MNIST           | Train Loss: 1.6014 | Train Acc: 0.6381
 Site-MNIST           | Train Loss: 1.5549 | Train Acc: 0.6821
 Site-MNIST           | Train Loss: 1.5093 | Train Acc: 0.7208
 Site-USPS            | Train Loss: 1.4759 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.5743 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.6394 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.4844 | Train Acc: 0.6652
 Site-USPS            | Train Loss: 1.4750 | Train Acc: 0.7048
 Site-USPS            | Train Loss: 1.4730 | Train Acc: 0.6892
 Site-SynthDigits     | Train Loss: 2.1146 | Train Acc: 0.2781
 Site-SynthDigits     | Train Loss: 2.1086 | Train Acc: 0.2784
 Site-SynthDigits     | Train Loss: 2.0622 | Train Acc: 0.3360
 Site-MNIST-M         | Train Loss: 2.1794 | Train Acc: 0.2928
 Site-MNIST-M         | Train Loss: 2.1848 | Train Acc: 0.3180
 Site-SVHN            | Train Loss: 2.2664 | Train Acc: 0.1773
 Site-MNIST           | Val  Loss: 1.2087 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3927 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4438 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6033 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5608 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5820 | Val  Acc: 0.7097
 Site-MNIST           | Val  Loss: 1.5546 | Val  Acc: 0.7143
 Site-MNIST           | Val  Loss: 1.5286 | Val  Acc: 0.6863
 Site-MNIST           | Val  Loss: 1.5578 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.5418 | Val  Acc: 0.6556
 Site-USPS            | Val  Loss: 1.4271 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.6731 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.5446 | Val  Acc: 0.5312
 Site-USPS            | Val  Loss: 1.5698 | Val  Acc: 0.5690
 Site-USPS            | Val  Loss: 1.4947 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.4419 | Val  Acc: 0.6984
 Site-SynthDigits     | Val  Loss: 2.1500 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1950 | Val  Acc: 0.3382
 Site-SynthDigits     | Val  Loss: 2.1043 | Val  Acc: 0.3197
 Site-MNIST-M         | Val  Loss: 2.1584 | Val  Acc: 0.3111
 Site-MNIST-M         | Val  Loss: 2.1471 | Val  Acc: 0.3457
 Site-SVHN            | Val  Loss: 2.2879 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5898
Aggregated Acc | Val Acc: 0.4345
============ Train epoch 42 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-4
client-20 is in G-4
client-21 is in G-1
cnt=[10, 1, 3, 6, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6582 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6172 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.4760 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4730 | Train Acc: 0.7105
 Site-MNIST           | Train Loss: 1.5618 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.5111 | Train Acc: 0.7540
 Site-MNIST           | Train Loss: 1.5113 | Train Acc: 0.7181
 Site-MNIST           | Train Loss: 1.5897 | Train Acc: 0.6455
 Site-MNIST           | Train Loss: 1.5420 | Train Acc: 0.6848
 Site-MNIST           | Train Loss: 1.4989 | Train Acc: 0.7200
 Site-USPS            | Train Loss: 1.4639 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.4655 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.1917 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.4613 | Train Acc: 0.6609
 Site-USPS            | Train Loss: 1.4515 | Train Acc: 0.6976
 Site-USPS            | Train Loss: 1.4632 | Train Acc: 0.6865
 Site-SynthDigits     | Train Loss: 2.1317 | Train Acc: 0.2848
 Site-SynthDigits     | Train Loss: 2.1150 | Train Acc: 0.2857
 Site-SynthDigits     | Train Loss: 2.0596 | Train Acc: 0.3360
 Site-MNIST-M         | Train Loss: 2.1757 | Train Acc: 0.2873
 Site-MNIST-M         | Train Loss: 2.1483 | Train Acc: 0.3211
 Site-SVHN            | Train Loss: 2.2663 | Train Acc: 0.1702
 Site-MNIST           | Val  Loss: 1.1857 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3782 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4345 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.6000 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5538 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5733 | Val  Acc: 0.7419
 Site-MNIST           | Val  Loss: 1.5449 | Val  Acc: 0.7321
 Site-MNIST           | Val  Loss: 1.5185 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5491 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.5331 | Val  Acc: 0.6556
 Site-USPS            | Val  Loss: 1.4174 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.6649 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.5353 | Val  Acc: 0.5625
 Site-USPS            | Val  Loss: 1.5604 | Val  Acc: 0.5862
 Site-USPS            | Val  Loss: 1.4839 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.4318 | Val  Acc: 0.6878
 Site-SynthDigits     | Val  Loss: 2.1435 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1874 | Val  Acc: 0.3382
 Site-SynthDigits     | Val  Loss: 2.0984 | Val  Acc: 0.3279
 Site-MNIST-M         | Val  Loss: 2.1574 | Val  Acc: 0.3333
 Site-MNIST-M         | Val  Loss: 2.1455 | Val  Acc: 0.3457
 Site-SVHN            | Val  Loss: 2.2875 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5961
Aggregated Acc | Val Acc: 0.4399
 Best site-MNIST            | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:42 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:42 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:42 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:42 | Val Acc: 0.7419
 Best site-MNIST            | Epoch:42 | Val Acc: 0.7321
 Best site-MNIST            | Epoch:42 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:42 | Val Acc: 0.6612
 Best site-MNIST            | Epoch:42 | Val Acc: 0.6556
 Best site-USPS             | Epoch:42 | Val Acc: 0.7000
 Best site-USPS             | Epoch:42 | Val Acc: 0.4444
 Best site-USPS             | Epoch:42 | Val Acc: 0.5625
 Best site-USPS             | Epoch:42 | Val Acc: 0.5862
 Best site-USPS             | Epoch:42 | Val Acc: 0.6762
 Best site-USPS             | Epoch:42 | Val Acc: 0.6878
 Best site-SynthDigits      | Epoch:42 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:42 | Val Acc: 0.3382
 Best site-SynthDigits      | Epoch:42 | Val Acc: 0.3279
 Best site-MNIST-M          | Epoch:42 | Val Acc: 0.3333
 Best site-MNIST-M          | Epoch:42 | Val Acc: 0.3457
 Best site-SVHN             | Epoch:42 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-4
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6457 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.6036 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.4623 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4577 | Train Acc: 0.7632
 Site-MNIST           | Train Loss: 1.3437 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.4965 | Train Acc: 0.7778
 Site-MNIST           | Train Loss: 1.4857 | Train Acc: 0.7313
 Site-MNIST           | Train Loss: 1.5799 | Train Acc: 0.6504
 Site-MNIST           | Train Loss: 1.5307 | Train Acc: 0.6889
 Site-MNIST           | Train Loss: 1.4837 | Train Acc: 0.7260
 Site-USPS            | Train Loss: 1.4549 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.4396 | Train Acc: 0.6944
 Site-USPS            | Train Loss: 1.2064 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.4539 | Train Acc: 0.6695
 Site-USPS            | Train Loss: 1.4458 | Train Acc: 0.7071
 Site-USPS            | Train Loss: 1.4510 | Train Acc: 0.6892
 Site-SynthDigits     | Train Loss: 2.1323 | Train Acc: 0.2848
 Site-SynthDigits     | Train Loss: 2.1104 | Train Acc: 0.2894
 Site-SynthDigits     | Train Loss: 2.0493 | Train Acc: 0.3422
 Site-MNIST-M         | Train Loss: 2.1739 | Train Acc: 0.2873
 Site-MNIST-M         | Train Loss: 2.1615 | Train Acc: 0.3242
 Site-SVHN            | Train Loss: 2.2572 | Train Acc: 0.1738
 Site-MNIST           | Val  Loss: 1.1950 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3763 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4253 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.5860 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5392 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5609 | Val  Acc: 0.7419
 Site-MNIST           | Val  Loss: 1.5326 | Val  Acc: 0.7321
 Site-MNIST           | Val  Loss: 1.5062 | Val  Acc: 0.6961
 Site-MNIST           | Val  Loss: 1.5361 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5197 | Val  Acc: 0.6647
 Site-USPS            | Val  Loss: 1.3978 | Val  Acc: 0.7000
 Site-USPS            | Val  Loss: 1.6548 | Val  Acc: 0.4444
 Site-USPS            | Val  Loss: 1.5263 | Val  Acc: 0.5625
 Site-USPS            | Val  Loss: 1.5496 | Val  Acc: 0.5862
 Site-USPS            | Val  Loss: 1.4731 | Val  Acc: 0.6857
 Site-USPS            | Val  Loss: 1.4189 | Val  Acc: 0.6984
 Site-SynthDigits     | Val  Loss: 2.1398 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1868 | Val  Acc: 0.3529
 Site-SynthDigits     | Val  Loss: 2.0945 | Val  Acc: 0.3361
 Site-MNIST-M         | Val  Loss: 2.1548 | Val  Acc: 0.3333
 Site-MNIST-M         | Val  Loss: 2.1402 | Val  Acc: 0.3457
 Site-SVHN            | Val  Loss: 2.2868 | Val  Acc: 0.1714
Average Valid Accuracy: 0.5982
Aggregated Acc | Val Acc: 0.4422
 Best site-MNIST            | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:43 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:43 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:43 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:43 | Val Acc: 0.7419
 Best site-MNIST            | Epoch:43 | Val Acc: 0.7321
 Best site-MNIST            | Epoch:43 | Val Acc: 0.6961
 Best site-MNIST            | Epoch:43 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:43 | Val Acc: 0.6647
 Best site-USPS             | Epoch:43 | Val Acc: 0.7000
 Best site-USPS             | Epoch:43 | Val Acc: 0.4444
 Best site-USPS             | Epoch:43 | Val Acc: 0.5625
 Best site-USPS             | Epoch:43 | Val Acc: 0.5862
 Best site-USPS             | Epoch:43 | Val Acc: 0.6857
 Best site-USPS             | Epoch:43 | Val Acc: 0.6984
 Best site-SynthDigits      | Epoch:43 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:43 | Val Acc: 0.3529
 Best site-SynthDigits      | Epoch:43 | Val Acc: 0.3361
 Best site-MNIST-M          | Epoch:43 | Val Acc: 0.3333
 Best site-MNIST-M          | Epoch:43 | Val Acc: 0.3457
 Best site-SVHN             | Epoch:43 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 44 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 6, 10, 3, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6351 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.5929 | Train Acc: 0.6667
 Site-MNIST           | Train Loss: 1.4496 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4453 | Train Acc: 0.7632
 Site-MNIST           | Train Loss: 1.2810 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.4879 | Train Acc: 0.7778
 Site-MNIST           | Train Loss: 1.4928 | Train Acc: 0.7313
 Site-MNIST           | Train Loss: 1.5919 | Train Acc: 0.6504
 Site-MNIST           | Train Loss: 1.5191 | Train Acc: 0.6889
 Site-MNIST           | Train Loss: 1.4733 | Train Acc: 0.7298
 Site-USPS            | Train Loss: 1.4442 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.3831 | Train Acc: 0.6944
 Site-USPS            | Train Loss: 1.5754 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.4355 | Train Acc: 0.6695
 Site-USPS            | Train Loss: 1.4325 | Train Acc: 0.7095
 Site-USPS            | Train Loss: 1.4405 | Train Acc: 0.6931
 Site-SynthDigits     | Train Loss: 2.1273 | Train Acc: 0.2848
 Site-SynthDigits     | Train Loss: 2.0976 | Train Acc: 0.2930
 Site-SynthDigits     | Train Loss: 2.0515 | Train Acc: 0.3462
 Site-MNIST-M         | Train Loss: 2.1696 | Train Acc: 0.2818
 Site-MNIST-M         | Train Loss: 2.1615 | Train Acc: 0.3303
 Site-SVHN            | Train Loss: 2.2591 | Train Acc: 0.1773
 Site-MNIST           | Val  Loss: 1.1851 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3654 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4157 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.5780 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5297 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5514 | Val  Acc: 0.7419
 Site-MNIST           | Val  Loss: 1.5225 | Val  Acc: 0.7321
 Site-MNIST           | Val  Loss: 1.4957 | Val  Acc: 0.6961
 Site-MNIST           | Val  Loss: 1.5259 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5095 | Val  Acc: 0.6647
 Site-USPS            | Val  Loss: 1.3858 | Val  Acc: 0.8000
 Site-USPS            | Val  Loss: 1.6458 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.5173 | Val  Acc: 0.5938
 Site-USPS            | Val  Loss: 1.5402 | Val  Acc: 0.5862
 Site-USPS            | Val  Loss: 1.4628 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.4083 | Val  Acc: 0.6931
 Site-SynthDigits     | Val  Loss: 2.1342 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1802 | Val  Acc: 0.3529
 Site-SynthDigits     | Val  Loss: 2.0893 | Val  Acc: 0.3361
 Site-MNIST-M         | Val  Loss: 2.1527 | Val  Acc: 0.3111
 Site-MNIST-M         | Val  Loss: 2.1369 | Val  Acc: 0.3333
 Site-SVHN            | Val  Loss: 2.2855 | Val  Acc: 0.1714
Average Valid Accuracy: 0.6045
Aggregated Acc | Val Acc: 0.4445
 Best site-MNIST            | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:44 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:44 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:44 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:44 | Val Acc: 0.7419
 Best site-MNIST            | Epoch:44 | Val Acc: 0.7321
 Best site-MNIST            | Epoch:44 | Val Acc: 0.6961
 Best site-MNIST            | Epoch:44 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:44 | Val Acc: 0.6647
 Best site-USPS             | Epoch:44 | Val Acc: 0.8000
 Best site-USPS             | Epoch:44 | Val Acc: 0.5000
 Best site-USPS             | Epoch:44 | Val Acc: 0.5938
 Best site-USPS             | Epoch:44 | Val Acc: 0.5862
 Best site-USPS             | Epoch:44 | Val Acc: 0.6762
 Best site-USPS             | Epoch:44 | Val Acc: 0.6931
 Best site-SynthDigits      | Epoch:44 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:44 | Val Acc: 0.3529
 Best site-SynthDigits      | Epoch:44 | Val Acc: 0.3361
 Best site-MNIST-M          | Epoch:44 | Val Acc: 0.3111
 Best site-MNIST-M          | Epoch:44 | Val Acc: 0.3333
 Best site-SVHN             | Epoch:44 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 45 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-3
client-17 is in G-3
client-18 is in G-3
client-19 is in G-1
client-20 is in G-1
client-21 is in G-4
cnt=[6, 2, 10, 3, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6231 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.5819 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.4369 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4334 | Train Acc: 0.7632
 Site-MNIST           | Train Loss: 1.3214 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.4738 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.4787 | Train Acc: 0.7357
 Site-MNIST           | Train Loss: 1.5552 | Train Acc: 0.6553
 Site-MNIST           | Train Loss: 1.5095 | Train Acc: 0.6970
 Site-MNIST           | Train Loss: 1.4630 | Train Acc: 0.7313
 Site-USPS            | Train Loss: 1.4349 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.4279 | Train Acc: 0.6944
 Site-USPS            | Train Loss: 1.6761 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.4329 | Train Acc: 0.6781
 Site-USPS            | Train Loss: 1.4232 | Train Acc: 0.7167
 Site-USPS            | Train Loss: 1.4282 | Train Acc: 0.6984
 Site-SynthDigits     | Train Loss: 2.1006 | Train Acc: 0.2848
 Site-SynthDigits     | Train Loss: 2.0966 | Train Acc: 0.2967
 Site-SynthDigits     | Train Loss: 2.0450 | Train Acc: 0.3462
 Site-MNIST-M         | Train Loss: 2.1672 | Train Acc: 0.2928
 Site-MNIST-M         | Train Loss: 2.1801 | Train Acc: 0.3272
 Site-SVHN            | Train Loss: 2.2599 | Train Acc: 0.1809
 Site-MNIST           | Val  Loss: 1.1689 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3546 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4062 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.5703 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5183 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5395 | Val  Acc: 0.7742
 Site-MNIST           | Val  Loss: 1.5106 | Val  Acc: 0.7500
 Site-MNIST           | Val  Loss: 1.4837 | Val  Acc: 0.7157
 Site-MNIST           | Val  Loss: 1.5139 | Val  Acc: 0.6721
 Site-MNIST           | Val  Loss: 1.4976 | Val  Acc: 0.6707
 Site-USPS            | Val  Loss: 1.3705 | Val  Acc: 0.8000
 Site-USPS            | Val  Loss: 1.6370 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.5092 | Val  Acc: 0.5938
 Site-USPS            | Val  Loss: 1.5308 | Val  Acc: 0.5862
 Site-USPS            | Val  Loss: 1.4527 | Val  Acc: 0.6952
 Site-USPS            | Val  Loss: 1.3968 | Val  Acc: 0.7037
 Site-SynthDigits     | Val  Loss: 2.1322 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1810 | Val  Acc: 0.3529
 Site-SynthDigits     | Val  Loss: 2.0864 | Val  Acc: 0.3361
 Site-MNIST-M         | Val  Loss: 2.1494 | Val  Acc: 0.3333
 Site-MNIST-M         | Val  Loss: 2.1334 | Val  Acc: 0.3457
 Site-SVHN            | Val  Loss: 2.2843 | Val  Acc: 0.1714
Average Valid Accuracy: 0.6111
Aggregated Acc | Val Acc: 0.4505
 Best site-MNIST            | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST            | Epoch:45 | Val Acc: 0.8000
 Best site-MNIST            | Epoch:45 | Val Acc: 0.6667
 Best site-MNIST            | Epoch:45 | Val Acc: 0.7059
 Best site-MNIST            | Epoch:45 | Val Acc: 0.7742
 Best site-MNIST            | Epoch:45 | Val Acc: 0.7500
 Best site-MNIST            | Epoch:45 | Val Acc: 0.7157
 Best site-MNIST            | Epoch:45 | Val Acc: 0.6721
 Best site-MNIST            | Epoch:45 | Val Acc: 0.6707
 Best site-USPS             | Epoch:45 | Val Acc: 0.8000
 Best site-USPS             | Epoch:45 | Val Acc: 0.5000
 Best site-USPS             | Epoch:45 | Val Acc: 0.5938
 Best site-USPS             | Epoch:45 | Val Acc: 0.5862
 Best site-USPS             | Epoch:45 | Val Acc: 0.6952
 Best site-USPS             | Epoch:45 | Val Acc: 0.7037
 Best site-SynthDigits      | Epoch:45 | Val Acc: 0.2703
 Best site-SynthDigits      | Epoch:45 | Val Acc: 0.3529
 Best site-SynthDigits      | Epoch:45 | Val Acc: 0.3361
 Best site-MNIST-M          | Epoch:45 | Val Acc: 0.3333
 Best site-MNIST-M          | Epoch:45 | Val Acc: 0.3457
 Best site-SVHN             | Epoch:45 | Val Acc: 0.1714
 Test site-MNIST           | Epoch:45 | Test Acc: 0.7006
 Test site-USPS            | Epoch:45 | Test Acc: 0.7398
 Test site-SynthDigits     | Epoch:45 | Test Acc: 0.3099
 Test site-MNIST-M         | Epoch:45 | Test Acc: 0.2769
 Test site-SVHN            | Epoch:45 | Test Acc: 0.2061
Average Test Accuracy: 0.4466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 46 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-2
client-19 is in G-0
client-20 is in G-0
client-21 is in G-4
cnt=[2, 10, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6146 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.5725 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.4261 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4248 | Train Acc: 0.7632
 Site-MNIST           | Train Loss: 1.4782 | Train Acc: 0.7714
 Site-MNIST           | Train Loss: 1.4689 | Train Acc: 0.7698
 Site-MNIST           | Train Loss: 1.4692 | Train Acc: 0.7489
 Site-MNIST           | Train Loss: 1.5598 | Train Acc: 0.6455
 Site-MNIST           | Train Loss: 1.5042 | Train Acc: 0.6929
 Site-MNIST           | Train Loss: 1.4562 | Train Acc: 0.7275
 Site-USPS            | Train Loss: 1.4240 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.4585 | Train Acc: 0.6944
 Site-USPS            | Train Loss: 1.1909 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.4087 | Train Acc: 0.6695
 Site-USPS            | Train Loss: 1.4092 | Train Acc: 0.7143
 Site-USPS            | Train Loss: 1.4199 | Train Acc: 0.6944
 Site-SynthDigits     | Train Loss: 2.0932 | Train Acc: 0.2914
 Site-SynthDigits     | Train Loss: 2.1073 | Train Acc: 0.2967
 Site-SynthDigits     | Train Loss: 2.0385 | Train Acc: 0.3422
 Site-MNIST-M         | Train Loss: 2.1633 | Train Acc: 0.2818
 Site-MNIST-M         | Train Loss: 2.1389 | Train Acc: 0.3272
 Site-SVHN            | Train Loss: 2.2556 | Train Acc: 0.1738
 Site-MNIST           | Val  Loss: 1.1534 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3422 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.4011 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.5699 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5135 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5339 | Val  Acc: 0.7419
 Site-MNIST           | Val  Loss: 1.5036 | Val  Acc: 0.7321
 Site-MNIST           | Val  Loss: 1.4763 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5075 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.4913 | Val  Acc: 0.6737
 Site-USPS            | Val  Loss: 1.3603 | Val  Acc: 0.8000
 Site-USPS            | Val  Loss: 1.6275 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.4993 | Val  Acc: 0.5938
 Site-USPS            | Val  Loss: 1.5215 | Val  Acc: 0.5862
 Site-USPS            | Val  Loss: 1.4422 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.3872 | Val  Acc: 0.6931
 Site-SynthDigits     | Val  Loss: 2.1229 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1694 | Val  Acc: 0.3529
 Site-SynthDigits     | Val  Loss: 2.0788 | Val  Acc: 0.3361
 Site-MNIST-M         | Val  Loss: 2.1491 | Val  Acc: 0.3111
 Site-MNIST-M         | Val  Loss: 2.1307 | Val  Acc: 0.3333
 Site-SVHN            | Val  Loss: 2.2843 | Val  Acc: 0.1571
Average Valid Accuracy: 0.6044
Aggregated Acc | Val Acc: 0.4419
 Test site-MNIST           | Epoch:45 | Test Acc: 0.6993
 Test site-USPS            | Epoch:45 | Test Acc: 0.7430
 Test site-SynthDigits     | Epoch:45 | Test Acc: 0.3134
 Test site-MNIST-M         | Epoch:45 | Test Acc: 0.2751
 Test site-SVHN            | Epoch:45 | Test Acc: 0.2076
Average Test Accuracy: 0.4477
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 47 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
client-11 is in G-4
client-12 is in G-4
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-1
client-17 is in G-1
client-18 is in G-1
client-19 is in G-3
client-20 is in G-3
client-21 is in G-3
cnt=[1, 3, 9, 3, 6, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.6067 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.5634 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.4143 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4153 | Train Acc: 0.7632
 Site-MNIST           | Train Loss: 1.3574 | Train Acc: 0.7714
 Site-MNIST           | Train Loss: 1.4577 | Train Acc: 0.7778
 Site-MNIST           | Train Loss: 1.4532 | Train Acc: 0.7445
 Site-MNIST           | Train Loss: 1.5565 | Train Acc: 0.6479
 Site-MNIST           | Train Loss: 1.4970 | Train Acc: 0.6957
 Site-MNIST           | Train Loss: 1.4445 | Train Acc: 0.7313
 Site-USPS            | Train Loss: 1.4139 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.3707 | Train Acc: 0.6944
 Site-USPS            | Train Loss: 1.3998 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.4071 | Train Acc: 0.6652
 Site-USPS            | Train Loss: 1.3957 | Train Acc: 0.7095
 Site-USPS            | Train Loss: 1.4098 | Train Acc: 0.6931
 Site-SynthDigits     | Train Loss: 2.1030 | Train Acc: 0.2848
 Site-SynthDigits     | Train Loss: 2.0879 | Train Acc: 0.3040
 Site-SynthDigits     | Train Loss: 2.0335 | Train Acc: 0.3442
 Site-MNIST-M         | Train Loss: 2.1631 | Train Acc: 0.2707
 Site-MNIST-M         | Train Loss: 2.1401 | Train Acc: 0.3272
 Site-SVHN            | Train Loss: 2.2560 | Train Acc: 0.1844
 Site-MNIST           | Val  Loss: 1.1391 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3308 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3934 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.5655 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.5066 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5269 | Val  Acc: 0.7419
 Site-MNIST           | Val  Loss: 1.4953 | Val  Acc: 0.7321
 Site-MNIST           | Val  Loss: 1.4677 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.4997 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.4833 | Val  Acc: 0.6737
 Site-USPS            | Val  Loss: 1.3512 | Val  Acc: 0.8000
 Site-USPS            | Val  Loss: 1.6191 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.4908 | Val  Acc: 0.5938
 Site-USPS            | Val  Loss: 1.5134 | Val  Acc: 0.5862
 Site-USPS            | Val  Loss: 1.4329 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.3782 | Val  Acc: 0.6878
 Site-SynthDigits     | Val  Loss: 2.1156 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1596 | Val  Acc: 0.3529
 Site-SynthDigits     | Val  Loss: 2.0727 | Val  Acc: 0.3361
 Site-MNIST-M         | Val  Loss: 2.1487 | Val  Acc: 0.3111
 Site-MNIST-M         | Val  Loss: 2.1286 | Val  Acc: 0.3086
 Site-SVHN            | Val  Loss: 2.2833 | Val  Acc: 0.1571
Average Valid Accuracy: 0.6031
Aggregated Acc | Val Acc: 0.5925
 Test site-MNIST           | Epoch:46 | Test Acc: 0.6994
 Test site-USPS            | Epoch:46 | Test Acc: 0.7419
 Test site-SynthDigits     | Epoch:46 | Test Acc: 0.3164
 Test site-MNIST-M         | Epoch:46 | Test Acc: 0.2747
 Test site-SVHN            | Epoch:46 | Test Acc: 0.2093
Average Test Accuracy: 0.4484
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 48 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.5975 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.5534 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.4024 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.4051 | Train Acc: 0.7895
 Site-MNIST           | Train Loss: 1.4464 | Train Acc: 0.7714
 Site-MNIST           | Train Loss: 1.4501 | Train Acc: 0.7778
 Site-MNIST           | Train Loss: 1.4252 | Train Acc: 0.7445
 Site-MNIST           | Train Loss: 1.5429 | Train Acc: 0.6504
 Site-MNIST           | Train Loss: 1.4815 | Train Acc: 0.6957
 Site-MNIST           | Train Loss: 1.4350 | Train Acc: 0.7321
 Site-USPS            | Train Loss: 1.4040 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.3423 | Train Acc: 0.6944
 Site-USPS            | Train Loss: 1.1025 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.4003 | Train Acc: 0.6652
 Site-USPS            | Train Loss: 1.3858 | Train Acc: 0.7095
 Site-USPS            | Train Loss: 1.4028 | Train Acc: 0.6971
 Site-SynthDigits     | Train Loss: 2.0897 | Train Acc: 0.2848
 Site-SynthDigits     | Train Loss: 2.1056 | Train Acc: 0.3040
 Site-SynthDigits     | Train Loss: 2.0264 | Train Acc: 0.3544
 Site-MNIST-M         | Train Loss: 2.1633 | Train Acc: 0.2652
 Site-MNIST-M         | Train Loss: 2.1272 | Train Acc: 0.3333
 Site-SVHN            | Train Loss: 2.2539 | Train Acc: 0.1879
 Site-MNIST           | Val  Loss: 1.1335 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3223 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3867 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.5595 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.4982 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.5179 | Val  Acc: 0.7419
 Site-MNIST           | Val  Loss: 1.4859 | Val  Acc: 0.7321
 Site-MNIST           | Val  Loss: 1.4584 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.4909 | Val  Acc: 0.6612
 Site-MNIST           | Val  Loss: 1.4743 | Val  Acc: 0.6737
 Site-USPS            | Val  Loss: 1.3394 | Val  Acc: 0.8000
 Site-USPS            | Val  Loss: 1.6106 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.4825 | Val  Acc: 0.5938
 Site-USPS            | Val  Loss: 1.5046 | Val  Acc: 0.5862
 Site-USPS            | Val  Loss: 1.4233 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.3682 | Val  Acc: 0.6878
 Site-SynthDigits     | Val  Loss: 2.1097 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1531 | Val  Acc: 0.3529
 Site-SynthDigits     | Val  Loss: 2.0674 | Val  Acc: 0.3361
 Site-MNIST-M         | Val  Loss: 2.1484 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1263 | Val  Acc: 0.2963
 Site-SVHN            | Val  Loss: 2.2823 | Val  Acc: 0.1571
Average Valid Accuracy: 0.6015
Aggregated Acc | Val Acc: 0.4358
 Test site-MNIST           | Epoch:47 | Test Acc: 0.7013
 Test site-USPS            | Epoch:47 | Test Acc: 0.7441
 Test site-SynthDigits     | Epoch:47 | Test Acc: 0.3191
 Test site-MNIST-M         | Epoch:47 | Test Acc: 0.2760
 Test site-SVHN            | Epoch:47 | Test Acc: 0.2111
Average Test Accuracy: 0.4503
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/ablation...
============ Train epoch 49 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-0
client-17 is in G-0
client-18 is in G-0
client-19 is in G-2
client-20 is in G-2
client-21 is in G-4
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
sum of wi : 1.0000
 Site-MNIST           | Train Loss: 1.5895 | Train Acc: 0.5000
 Site-MNIST           | Train Loss: 1.5446 | Train Acc: 0.5833
 Site-MNIST           | Train Loss: 1.3899 | Train Acc: 0.8095
 Site-MNIST           | Train Loss: 1.3941 | Train Acc: 0.7895
 Site-MNIST           | Train Loss: 1.4028 | Train Acc: 0.7714
 Site-MNIST           | Train Loss: 1.4406 | Train Acc: 0.7857
 Site-MNIST           | Train Loss: 1.4293 | Train Acc: 0.7445
 Site-MNIST           | Train Loss: 1.5339 | Train Acc: 0.6577
 Site-MNIST           | Train Loss: 1.4758 | Train Acc: 0.6929
 Site-MNIST           | Train Loss: 1.4273 | Train Acc: 0.7328
 Site-USPS            | Train Loss: 1.3949 | Train Acc: 0.7250
 Site-USPS            | Train Loss: 1.4276 | Train Acc: 0.6806
 Site-USPS            | Train Loss: 1.1393 | Train Acc: 0.6899
 Site-USPS            | Train Loss: 1.3938 | Train Acc: 0.6609
 Site-USPS            | Train Loss: 1.3911 | Train Acc: 0.7143
 Site-USPS            | Train Loss: 1.3916 | Train Acc: 0.6971
 Site-SynthDigits     | Train Loss: 2.0628 | Train Acc: 0.2914
 Site-SynthDigits     | Train Loss: 2.0517 | Train Acc: 0.3077
 Site-SynthDigits     | Train Loss: 2.0235 | Train Acc: 0.3544
 Site-MNIST-M         | Train Loss: 2.1636 | Train Acc: 0.2707
 Site-MNIST-M         | Train Loss: 2.1466 | Train Acc: 0.3180
 Site-SVHN            | Train Loss: 2.2489 | Train Acc: 0.1879
 Site-MNIST           | Val  Loss: 1.1231 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3134 | Val  Acc: 1.0000
 Site-MNIST           | Val  Loss: 1.3779 | Val  Acc: 0.8000
 Site-MNIST           | Val  Loss: 1.5529 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.4904 | Val  Acc: 0.7647
 Site-MNIST           | Val  Loss: 1.5095 | Val  Acc: 0.7742
 Site-MNIST           | Val  Loss: 1.4765 | Val  Acc: 0.7500
 Site-MNIST           | Val  Loss: 1.4487 | Val  Acc: 0.7059
 Site-MNIST           | Val  Loss: 1.4820 | Val  Acc: 0.6667
 Site-MNIST           | Val  Loss: 1.4653 | Val  Acc: 0.6767
 Site-USPS            | Val  Loss: 1.3306 | Val  Acc: 0.8000
 Site-USPS            | Val  Loss: 1.6037 | Val  Acc: 0.5000
 Site-USPS            | Val  Loss: 1.4759 | Val  Acc: 0.5938
 Site-USPS            | Val  Loss: 1.4973 | Val  Acc: 0.5862
 Site-USPS            | Val  Loss: 1.4151 | Val  Acc: 0.6762
 Site-USPS            | Val  Loss: 1.3603 | Val  Acc: 0.6825
 Site-SynthDigits     | Val  Loss: 2.1045 | Val  Acc: 0.2703
 Site-SynthDigits     | Val  Loss: 2.1468 | Val  Acc: 0.3529
 Site-SynthDigits     | Val  Loss: 2.0627 | Val  Acc: 0.3443
 Site-MNIST-M         | Val  Loss: 2.1475 | Val  Acc: 0.2889
 Site-MNIST-M         | Val  Loss: 2.1250 | Val  Acc: 0.3086
 Site-SVHN            | Val  Loss: 2.2806 | Val  Acc: 0.1571
Average Valid Accuracy: 0.6075
Aggregated Acc | Val Acc: 0.4397
 Test site-MNIST           | Epoch:48 | Test Acc: 0.7013
 Test site-USPS            | Epoch:48 | Test Acc: 0.7409
 Test site-SynthDigits     | Epoch:48 | Test Acc: 0.3207
 Test site-MNIST-M         | Epoch:48 | Test Acc: 0.2761
 Test site-SVHN            | Epoch:48 | Test Acc: 0.2122
Average Test Accuracy: 0.4502
===2023-05-14 01:04:39===
===2023-05-14 01:04:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
label set of clients: [4, 7, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST           | Epoch:48 | Test Acc: 0.7013
 Test site-USPS            | Epoch:48 | Test Acc: 0.7441
 Test site-SynthDigits     | Epoch:48 | Test Acc: 0.3191
 Test site-MNIST-M         | Epoch:48 | Test Acc: 0.2760
 Test site-SVHN            | Epoch:48 | Test Acc: 0.2111
Average Test Accuracy: 0.4503
