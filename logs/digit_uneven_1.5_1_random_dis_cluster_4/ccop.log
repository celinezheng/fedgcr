===2023-08-01 02:19:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[3, 5, 3, 2, ]
cnt=[5, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (1) | Train Loss: 1.6235 | Train Acc: 0.6578
 Site-MNIST                     (1) | Train Loss: 1.5961 | Train Acc: 0.6982
 Site-MNIST                     (1) | Train Loss: 1.6599 | Train Acc: 0.6213
 Site-MNIST                     (1) | Train Loss: 1.6277 | Train Acc: 0.6321
 Site-MNIST                     (1) | Train Loss: 1.6288 | Train Acc: 0.6515
 Site-USPS                      (0) | Train Loss: 1.6180 | Train Acc: 0.7194
 Site-USPS                      (0) | Train Loss: 1.6205 | Train Acc: 0.7364
 Site-USPS                      (0) | Train Loss: 1.6168 | Train Acc: 0.7061
 Site-SynthDigits               (3) | Train Loss: 2.0876 | Train Acc: 0.2538
 Site-SynthDigits               (3) | Train Loss: 2.0605 | Train Acc: 0.2828
 Site-MNIST_M                   (2) | Train Loss: 2.2041 | Train Acc: 0.1903
 Site-MNIST_M                   (2) | Train Loss: 2.1899 | Train Acc: 0.2292
 Site-SVHN                      (2) | Train Loss: 2.1919 | Train Acc: 0.2164
Average Train Accuracy: 0.5073
 Site-MNIST                     (1) | Val  Loss: 1.7304 | Val  Acc: 0.6429
 Site-MNIST                     (1) | Val  Loss: 1.7310 | Val  Acc: 0.6429
 Site-MNIST                     (1) | Val  Loss: 1.5776 | Val  Acc: 0.7302
 Site-MNIST                     (1) | Val  Loss: 1.6214 | Val  Acc: 0.6579
 Site-MNIST                     (1) | Val  Loss: 1.6194 | Val  Acc: 0.6772
 Site-USPS                      (0) | Val  Loss: 1.6432 | Val  Acc: 0.7404
 Site-USPS                      (0) | Val  Loss: 1.6616 | Val  Acc: 0.6987
 Site-USPS                      (0) | Val  Loss: 1.5938 | Val  Acc: 0.6966
 Site-SynthDigits               (3) | Val  Loss: 2.2191 | Val  Acc: 0.2273
 Site-SynthDigits               (3) | Val  Loss: 2.0671 | Val  Acc: 0.2525
 Site-MNIST_M                   (2) | Val  Loss: 2.1321 | Val  Acc: 0.2159
 Site-MNIST_M                   (2) | Val  Loss: 2.1630 | Val  Acc: 0.1818
 Site-SVHN                      (2) | Val  Loss: 2.2067 | Val  Acc: 0.2671
Average Valid Accuracy: 0.5101
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.7302
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6579
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6772
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.7404
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6987
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6966
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2273
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2525
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.2159
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.1818
 Best site-SVHN                     (2)  | Epoch:0 | Val Acc: 0.2671
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 3, 2, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.1627 | Train Acc: 0.7733
 Site-MNIST                     (0) | Train Loss: 1.1266 | Train Acc: 0.8136
 Site-MNIST                     (0) | Train Loss: 1.2366 | Train Acc: 0.7436
 Site-MNIST                     (0) | Train Loss: 1.1875 | Train Acc: 0.7556
 Site-MNIST                     (0) | Train Loss: 1.1799 | Train Acc: 0.7583
 Site-USPS                      (3) | Train Loss: 1.1232 | Train Acc: 0.7842
 Site-USPS                      (3) | Train Loss: 1.1352 | Train Acc: 0.7812
 Site-USPS                      (3) | Train Loss: 1.1295 | Train Acc: 0.7774
 Site-SynthDigits               (2) | Train Loss: 1.8585 | Train Acc: 0.3352
 Site-SynthDigits               (2) | Train Loss: 1.8403 | Train Acc: 0.3359
 Site-MNIST_M                   (1) | Train Loss: 2.0543 | Train Acc: 0.2841
 Site-MNIST_M                   (1) | Train Loss: 2.0522 | Train Acc: 0.2936
 Site-SVHN                      (1) | Train Loss: 2.0957 | Train Acc: 0.2641
Average Train Accuracy: 0.5923
 Site-MNIST                     (0) | Val  Loss: 1.2757 | Val  Acc: 0.7857
 Site-MNIST                     (0) | Val  Loss: 1.2694 | Val  Acc: 0.7976
 Site-MNIST                     (0) | Val  Loss: 1.1460 | Val  Acc: 0.8175
 Site-MNIST                     (0) | Val  Loss: 1.2128 | Val  Acc: 0.7737
 Site-MNIST                     (0) | Val  Loss: 1.1838 | Val  Acc: 0.7965
 Site-USPS                      (3) | Val  Loss: 1.1537 | Val  Acc: 0.7692
 Site-USPS                      (3) | Val  Loss: 1.2025 | Val  Acc: 0.7308
 Site-USPS                      (3) | Val  Loss: 1.1216 | Val  Acc: 0.7821
 Site-SynthDigits               (2) | Val  Loss: 2.0888 | Val  Acc: 0.3409
 Site-SynthDigits               (2) | Val  Loss: 1.8136 | Val  Acc: 0.3384
 Site-MNIST_M                   (1) | Val  Loss: 1.9223 | Val  Acc: 0.3864
 Site-MNIST_M                   (1) | Val  Loss: 2.0403 | Val  Acc: 0.2500
 Site-SVHN                      (1) | Val  Loss: 2.1113 | Val  Acc: 0.2945
Average Valid Accuracy: 0.6049
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7976
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.8175
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7737
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7965
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7692
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7308
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7821
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3409
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3384
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.3864
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.2500
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.2945
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 2 ============
cnt=[8, 1, 2, 2, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 1.0249 | Train Acc: 0.7822
 Site-MNIST                     (0) | Train Loss: 0.9935 | Train Acc: 0.7959
 Site-MNIST                     (0) | Train Loss: 1.0778 | Train Acc: 0.7554
 Site-MNIST                     (0) | Train Loss: 1.0240 | Train Acc: 0.7687
 Site-MNIST                     (0) | Train Loss: 1.0161 | Train Acc: 0.7776
 Site-USPS                      (0) | Train Loss: 0.9299 | Train Acc: 0.7938
 Site-USPS                      (0) | Train Loss: 0.9470 | Train Acc: 0.7923
 Site-USPS                      (0) | Train Loss: 0.9399 | Train Acc: 0.8030
 Site-SynthDigits               (2) | Train Loss: 1.6721 | Train Acc: 0.4205
 Site-SynthDigits               (2) | Train Loss: 1.6247 | Train Acc: 0.4293
 Site-MNIST_M                   (3) | Train Loss: 1.8885 | Train Acc: 0.3409
 Site-MNIST_M                   (3) | Train Loss: 1.8815 | Train Acc: 0.3769
 Site-SVHN                      (1) | Train Loss: 2.0042 | Train Acc: 0.2981
Average Train Accuracy: 0.6257
 Site-MNIST                     (0) | Val  Loss: 1.1009 | Val  Acc: 0.8036
 Site-MNIST                     (0) | Val  Loss: 1.0913 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.9769 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 1.0632 | Val  Acc: 0.7579
 Site-MNIST                     (0) | Val  Loss: 1.0286 | Val  Acc: 0.7860
 Site-USPS                      (0) | Val  Loss: 0.9656 | Val  Acc: 0.7692
 Site-USPS                      (0) | Val  Loss: 1.0182 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.9401 | Val  Acc: 0.7991
 Site-SynthDigits               (2) | Val  Loss: 1.9153 | Val  Acc: 0.4545
 Site-SynthDigits               (2) | Val  Loss: 1.6086 | Val  Acc: 0.4091
 Site-MNIST_M                   (3) | Val  Loss: 1.7629 | Val  Acc: 0.3977
 Site-MNIST_M                   (3) | Val  Loss: 1.9153 | Val  Acc: 0.3030
 Site-SVHN                      (1) | Val  Loss: 2.0177 | Val  Acc: 0.2877
Average Valid Accuracy: 0.6314
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8036
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7579
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7860
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7692
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7991
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4545
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4091
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.3977
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.3030
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2877
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 8, 2, 2, ]
cnt=[3, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (1) | Train Loss: 0.9031 | Train Acc: 0.7911
 Site-MNIST                     (1) | Train Loss: 0.9155 | Train Acc: 0.8343
 Site-MNIST                     (1) | Train Loss: 0.9738 | Train Acc: 0.7771
 Site-MNIST                     (1) | Train Loss: 0.9237 | Train Acc: 0.7976
 Site-MNIST                     (1) | Train Loss: 0.9179 | Train Acc: 0.7863
 Site-USPS                      (1) | Train Loss: 0.8165 | Train Acc: 0.8225
 Site-USPS                      (1) | Train Loss: 0.8212 | Train Acc: 0.8131
 Site-USPS                      (1) | Train Loss: 0.8174 | Train Acc: 0.8349
 Site-SynthDigits               (2) | Train Loss: 1.5473 | Train Acc: 0.4735
 Site-SynthDigits               (2) | Train Loss: 1.4708 | Train Acc: 0.5063
 Site-MNIST_M                   (3) | Train Loss: 1.7767 | Train Acc: 0.3892
 Site-MNIST_M                   (3) | Train Loss: 1.7774 | Train Acc: 0.4015
 Site-SVHN                      (0) | Train Loss: 1.9213 | Train Acc: 0.3560
Average Train Accuracy: 0.6603
 Site-MNIST                     (1) | Val  Loss: 1.0034 | Val  Acc: 0.7857
 Site-MNIST                     (1) | Val  Loss: 0.9813 | Val  Acc: 0.8095
 Site-MNIST                     (1) | Val  Loss: 0.8745 | Val  Acc: 0.8175
 Site-MNIST                     (1) | Val  Loss: 0.9599 | Val  Acc: 0.8158
 Site-MNIST                     (1) | Val  Loss: 0.9295 | Val  Acc: 0.8246
 Site-USPS                      (1) | Val  Loss: 0.8349 | Val  Acc: 0.8462
 Site-USPS                      (1) | Val  Loss: 0.8901 | Val  Acc: 0.7885
 Site-USPS                      (1) | Val  Loss: 0.8257 | Val  Acc: 0.8162
 Site-SynthDigits               (2) | Val  Loss: 1.7531 | Val  Acc: 0.5000
 Site-SynthDigits               (2) | Val  Loss: 1.4611 | Val  Acc: 0.4848
 Site-MNIST_M                   (3) | Val  Loss: 1.6412 | Val  Acc: 0.4659
 Site-MNIST_M                   (3) | Val  Loss: 1.7920 | Val  Acc: 0.3636
 Site-SVHN                      (0) | Val  Loss: 1.9204 | Val  Acc: 0.3288
Average Valid Accuracy: 0.6652
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.7857
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8095
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8175
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8158
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8246
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.8462
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.7885
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.8162
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.4848
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.4659
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.3636
 Best site-SVHN                     (0)  | Epoch:3 | Val Acc: 0.3288
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 5, 3, 3, ]
cnt=[3, 3, 5, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (1) | Train Loss: 0.7919 | Train Acc: 0.8400
 Site-MNIST                     (1) | Train Loss: 0.7571 | Train Acc: 0.8521
 Site-MNIST                     (1) | Train Loss: 0.8294 | Train Acc: 0.8166
 Site-MNIST                     (1) | Train Loss: 0.7917 | Train Acc: 0.8384
 Site-MNIST                     (1) | Train Loss: 0.7767 | Train Acc: 0.8292
 Site-USPS                      (3) | Train Loss: 0.7376 | Train Acc: 0.8321
 Site-USPS                      (3) | Train Loss: 0.7519 | Train Acc: 0.8179
 Site-USPS                      (3) | Train Loss: 0.7500 | Train Acc: 0.8339
 Site-SynthDigits               (0) | Train Loss: 1.4292 | Train Acc: 0.5322
 Site-SynthDigits               (0) | Train Loss: 1.3418 | Train Acc: 0.5657
 Site-MNIST_M                   (2) | Train Loss: 1.6927 | Train Acc: 0.4375
 Site-MNIST_M                   (2) | Train Loss: 1.6956 | Train Acc: 0.4451
 Site-SVHN                      (2) | Train Loss: 1.8278 | Train Acc: 0.3629
Average Train Accuracy: 0.6926
 Site-MNIST                     (1) | Val  Loss: 0.8328 | Val  Acc: 0.8393
 Site-MNIST                     (1) | Val  Loss: 0.8102 | Val  Acc: 0.8690
 Site-MNIST                     (1) | Val  Loss: 0.7431 | Val  Acc: 0.8413
 Site-MNIST                     (1) | Val  Loss: 0.8318 | Val  Acc: 0.8211
 Site-MNIST                     (1) | Val  Loss: 0.7965 | Val  Acc: 0.8421
 Site-USPS                      (3) | Val  Loss: 0.7522 | Val  Acc: 0.8173
 Site-USPS                      (3) | Val  Loss: 0.8124 | Val  Acc: 0.7692
 Site-USPS                      (3) | Val  Loss: 0.7605 | Val  Acc: 0.8248
 Site-SynthDigits               (0) | Val  Loss: 1.6721 | Val  Acc: 0.5227
 Site-SynthDigits               (0) | Val  Loss: 1.3404 | Val  Acc: 0.5606
 Site-MNIST_M                   (2) | Val  Loss: 1.5620 | Val  Acc: 0.4659
 Site-MNIST_M                   (2) | Val  Loss: 1.7143 | Val  Acc: 0.4318
 Site-SVHN                      (2) | Val  Loss: 1.8559 | Val  Acc: 0.3699
Average Valid Accuracy: 0.6904
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8393
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8690
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8413
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8211
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8421
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8173
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.7692
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8248
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.5227
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.5606
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.4659
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.4318
 Best site-SVHN                     (2)  | Epoch:4 | Val Acc: 0.3699
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 3, 2, 5, ]
cnt=[3, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (3) | Train Loss: 0.7644 | Train Acc: 0.8356
 Site-MNIST                     (3) | Train Loss: 0.7148 | Train Acc: 0.8550
 Site-MNIST                     (3) | Train Loss: 0.7922 | Train Acc: 0.8028
 Site-MNIST                     (3) | Train Loss: 0.7539 | Train Acc: 0.8265
 Site-MNIST                     (3) | Train Loss: 0.7431 | Train Acc: 0.8240
 Site-USPS                      (0) | Train Loss: 0.7084 | Train Acc: 0.8393
 Site-USPS                      (0) | Train Loss: 0.7086 | Train Acc: 0.8371
 Site-USPS                      (0) | Train Loss: 0.7132 | Train Acc: 0.8435
 Site-SynthDigits               (2) | Train Loss: 1.3070 | Train Acc: 0.5966
 Site-SynthDigits               (2) | Train Loss: 1.2327 | Train Acc: 0.6288
 Site-MNIST_M                   (1) | Train Loss: 1.5782 | Train Acc: 0.4972
 Site-MNIST_M                   (1) | Train Loss: 1.6241 | Train Acc: 0.4905
 Site-SVHN                      (1) | Train Loss: 1.7733 | Train Acc: 0.3935
Average Train Accuracy: 0.7131
 Site-MNIST                     (3) | Val  Loss: 0.7894 | Val  Acc: 0.8214
 Site-MNIST                     (3) | Val  Loss: 0.7666 | Val  Acc: 0.8333
 Site-MNIST                     (3) | Val  Loss: 0.7084 | Val  Acc: 0.8333
 Site-MNIST                     (3) | Val  Loss: 0.8014 | Val  Acc: 0.8368
 Site-MNIST                     (3) | Val  Loss: 0.7588 | Val  Acc: 0.8456
 Site-USPS                      (0) | Val  Loss: 0.7079 | Val  Acc: 0.8558
 Site-USPS                      (0) | Val  Loss: 0.7655 | Val  Acc: 0.8141
 Site-USPS                      (0) | Val  Loss: 0.7230 | Val  Acc: 0.8376
 Site-SynthDigits               (2) | Val  Loss: 1.5642 | Val  Acc: 0.5682
 Site-SynthDigits               (2) | Val  Loss: 1.2307 | Val  Acc: 0.6010
 Site-MNIST_M                   (1) | Val  Loss: 1.4533 | Val  Acc: 0.5455
 Site-MNIST_M                   (1) | Val  Loss: 1.6173 | Val  Acc: 0.5000
 Site-SVHN                      (1) | Val  Loss: 1.7684 | Val  Acc: 0.3904
Average Valid Accuracy: 0.7141
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8214
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8333
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8333
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8368
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8456
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8558
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8141
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8376
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5682
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6010
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.5455
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.5000
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.3904
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 3, 3, 5, ]
cnt=[2, 5, 3, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (3) | Train Loss: 0.6594 | Train Acc: 0.8489
 Site-MNIST                     (3) | Train Loss: 0.6578 | Train Acc: 0.8521
 Site-MNIST                     (3) | Train Loss: 0.7110 | Train Acc: 0.8323
 Site-MNIST                     (3) | Train Loss: 0.6776 | Train Acc: 0.8371
 Site-MNIST                     (3) | Train Loss: 0.6635 | Train Acc: 0.8433
 Site-USPS                      (1) | Train Loss: 0.6653 | Train Acc: 0.8345
 Site-USPS                      (1) | Train Loss: 0.6589 | Train Acc: 0.8259
 Site-USPS                      (1) | Train Loss: 0.6576 | Train Acc: 0.8445
 Site-SynthDigits               (0) | Train Loss: 1.1957 | Train Acc: 0.6496
 Site-SynthDigits               (0) | Train Loss: 1.1056 | Train Acc: 0.6755
 Site-MNIST_M                   (2) | Train Loss: 1.5200 | Train Acc: 0.5398
 Site-MNIST_M                   (2) | Train Loss: 1.5170 | Train Acc: 0.5227
 Site-SVHN                      (2) | Train Loss: 1.6452 | Train Acc: 0.4412
Average Train Accuracy: 0.7344
 Site-MNIST                     (3) | Val  Loss: 0.7040 | Val  Acc: 0.8571
 Site-MNIST                     (3) | Val  Loss: 0.6794 | Val  Acc: 0.8690
 Site-MNIST                     (3) | Val  Loss: 0.6297 | Val  Acc: 0.8730
 Site-MNIST                     (3) | Val  Loss: 0.7186 | Val  Acc: 0.8579
 Site-MNIST                     (3) | Val  Loss: 0.6841 | Val  Acc: 0.8386
 Site-USPS                      (1) | Val  Loss: 0.6387 | Val  Acc: 0.8365
 Site-USPS                      (1) | Val  Loss: 0.7102 | Val  Acc: 0.7692
 Site-USPS                      (1) | Val  Loss: 0.6785 | Val  Acc: 0.7991
 Site-SynthDigits               (0) | Val  Loss: 1.4526 | Val  Acc: 0.6288
 Site-SynthDigits               (0) | Val  Loss: 1.1240 | Val  Acc: 0.6616
 Site-MNIST_M                   (2) | Val  Loss: 1.4004 | Val  Acc: 0.5909
 Site-MNIST_M                   (2) | Val  Loss: 1.5167 | Val  Acc: 0.5530
 Site-SVHN                      (2) | Val  Loss: 1.6790 | Val  Acc: 0.4384
Average Valid Accuracy: 0.7364
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8571
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8690
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8730
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8579
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8386
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8365
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7692
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7991
 Best site-SynthDigits              (0)  | Epoch:6 | Val Acc: 0.6288
 Best site-SynthDigits              (0)  | Epoch:6 | Val Acc: 0.6616
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.5909
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.5530
 Best site-SVHN                     (2)  | Epoch:6 | Val Acc: 0.4384
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 3, 2, 3, ]
cnt=[3, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.6293 | Train Acc: 0.8489
 Site-MNIST                     (0) | Train Loss: 0.6089 | Train Acc: 0.8491
 Site-MNIST                     (0) | Train Loss: 0.6692 | Train Acc: 0.8284
 Site-MNIST                     (0) | Train Loss: 0.6361 | Train Acc: 0.8371
 Site-MNIST                     (0) | Train Loss: 0.6217 | Train Acc: 0.8476
 Site-USPS                      (3) | Train Loss: 0.6262 | Train Acc: 0.8465
 Site-USPS                      (3) | Train Loss: 0.6169 | Train Acc: 0.8450
 Site-USPS                      (3) | Train Loss: 0.6139 | Train Acc: 0.8520
 Site-SynthDigits               (2) | Train Loss: 1.0999 | Train Acc: 0.6648
 Site-SynthDigits               (2) | Train Loss: 1.0035 | Train Acc: 0.7146
 Site-MNIST_M                   (1) | Train Loss: 1.4387 | Train Acc: 0.5483
 Site-MNIST_M                   (1) | Train Loss: 1.4357 | Train Acc: 0.5492
 Site-SVHN                      (1) | Train Loss: 1.5806 | Train Acc: 0.4787
Average Train Accuracy: 0.7469
 Site-MNIST                     (0) | Val  Loss: 0.6541 | Val  Acc: 0.8393
 Site-MNIST                     (0) | Val  Loss: 0.6315 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.5929 | Val  Acc: 0.8492
 Site-MNIST                     (0) | Val  Loss: 0.6794 | Val  Acc: 0.8474
 Site-MNIST                     (0) | Val  Loss: 0.6404 | Val  Acc: 0.8456
 Site-USPS                      (3) | Val  Loss: 0.5933 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.6612 | Val  Acc: 0.8205
 Site-USPS                      (3) | Val  Loss: 0.6425 | Val  Acc: 0.8248
 Site-SynthDigits               (2) | Val  Loss: 1.3652 | Val  Acc: 0.6364
 Site-SynthDigits               (2) | Val  Loss: 1.0248 | Val  Acc: 0.6768
 Site-MNIST_M                   (1) | Val  Loss: 1.3213 | Val  Acc: 0.5909
 Site-MNIST_M                   (1) | Val  Loss: 1.4258 | Val  Acc: 0.5530
 Site-SVHN                      (1) | Val  Loss: 1.5992 | Val  Acc: 0.4726
Average Valid Accuracy: 0.7445
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8393
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8492
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8474
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8456
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8205
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8248
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6364
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6768
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5909
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5530
 Best site-SVHN                     (1)  | Epoch:7 | Val Acc: 0.4726
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 8 ============
cnt=[8, 1, 2, 2, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (0) | Train Loss: 0.5707 | Train Acc: 0.8622
 Site-MNIST                     (0) | Train Loss: 0.5940 | Train Acc: 0.8609
 Site-MNIST                     (0) | Train Loss: 0.6099 | Train Acc: 0.8383
 Site-MNIST                     (0) | Train Loss: 0.5841 | Train Acc: 0.8502
 Site-MNIST                     (0) | Train Loss: 0.5649 | Train Acc: 0.8625
 Site-USPS                      (0) | Train Loss: 0.5834 | Train Acc: 0.8513
 Site-USPS                      (0) | Train Loss: 0.5732 | Train Acc: 0.8498
 Site-USPS                      (0) | Train Loss: 0.5731 | Train Acc: 0.8573
 Site-SynthDigits               (2) | Train Loss: 1.0402 | Train Acc: 0.6818
 Site-SynthDigits               (2) | Train Loss: 0.9537 | Train Acc: 0.7285
 Site-MNIST_M                   (3) | Train Loss: 1.3333 | Train Acc: 0.5824
 Site-MNIST_M                   (3) | Train Loss: 1.3573 | Train Acc: 0.5644
 Site-SVHN                      (1) | Train Loss: 1.4574 | Train Acc: 0.5145
Average Train Accuracy: 0.7619
 Site-MNIST                     (0) | Val  Loss: 0.5829 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.5672 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.5406 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.6246 | Val  Acc: 0.8684
 Site-MNIST                     (0) | Val  Loss: 0.5864 | Val  Acc: 0.8491
 Site-USPS                      (0) | Val  Loss: 0.5402 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.6142 | Val  Acc: 0.8397
 Site-USPS                      (0) | Val  Loss: 0.6054 | Val  Acc: 0.8248
 Site-SynthDigits               (2) | Val  Loss: 1.2955 | Val  Acc: 0.6439
 Site-SynthDigits               (2) | Val  Loss: 0.9555 | Val  Acc: 0.6970
 Site-MNIST_M                   (3) | Val  Loss: 1.2510 | Val  Acc: 0.5909
 Site-MNIST_M                   (3) | Val  Loss: 1.3422 | Val  Acc: 0.5758
 Site-SVHN                      (1) | Val  Loss: 1.5368 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7574
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8684
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8491
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8846
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8397
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8248
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.6439
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.6970
 Best site-MNIST_M                  (3)  | Epoch:8 | Val Acc: 0.5909
 Best site-MNIST_M                  (3)  | Epoch:8 | Val Acc: 0.5758
 Best site-SVHN                     (1)  | Epoch:8 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 9 ============
cnt=[5, 3, 3, 2, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.5483 | Train Acc: 0.8400
 Site-MNIST                     (0) | Train Loss: 0.5623 | Train Acc: 0.8580
 Site-MNIST                     (0) | Train Loss: 0.5911 | Train Acc: 0.8402
 Site-MNIST                     (0) | Train Loss: 0.5577 | Train Acc: 0.8476
 Site-MNIST                     (0) | Train Loss: 0.5418 | Train Acc: 0.8581
 Site-USPS                      (2) | Train Loss: 0.5375 | Train Acc: 0.8657
 Site-USPS                      (2) | Train Loss: 0.5403 | Train Acc: 0.8674
 Site-USPS                      (2) | Train Loss: 0.5433 | Train Acc: 0.8743
 Site-SynthDigits               (3) | Train Loss: 0.9666 | Train Acc: 0.6989
 Site-SynthDigits               (3) | Train Loss: 0.8850 | Train Acc: 0.7563
 Site-MNIST_M                   (1) | Train Loss: 1.2914 | Train Acc: 0.6023
 Site-MNIST_M                   (1) | Train Loss: 1.3002 | Train Acc: 0.5985
 Site-SVHN                      (1) | Train Loss: 1.4567 | Train Acc: 0.5451
Average Train Accuracy: 0.7733
 Site-MNIST                     (0) | Val  Loss: 0.5576 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.5398 | Val  Acc: 0.8452
 Site-MNIST                     (0) | Val  Loss: 0.5190 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.6057 | Val  Acc: 0.8526
 Site-MNIST                     (0) | Val  Loss: 0.5605 | Val  Acc: 0.8561
 Site-USPS                      (2) | Val  Loss: 0.5122 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.5780 | Val  Acc: 0.8526
 Site-USPS                      (2) | Val  Loss: 0.5761 | Val  Acc: 0.8419
 Site-SynthDigits               (3) | Val  Loss: 1.2027 | Val  Acc: 0.6591
 Site-SynthDigits               (3) | Val  Loss: 0.8797 | Val  Acc: 0.7071
 Site-MNIST_M                   (1) | Val  Loss: 1.1988 | Val  Acc: 0.6023
 Site-MNIST_M                   (1) | Val  Loss: 1.2795 | Val  Acc: 0.5985
 Site-SVHN                      (1) | Val  Loss: 1.4771 | Val  Acc: 0.5205
Average Valid Accuracy: 0.7635
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8452
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8526
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8561
 Best site-USPS                     (2)  | Epoch:9 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:9 | Val Acc: 0.8526
 Best site-USPS                     (2)  | Epoch:9 | Val Acc: 0.8419
 Best site-SynthDigits              (3)  | Epoch:9 | Val Acc: 0.6591
 Best site-SynthDigits              (3)  | Epoch:9 | Val Acc: 0.7071
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.6023
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.5985
 Best site-SVHN                     (1)  | Epoch:9 | Val Acc: 0.5205
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 2, 5, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (2) | Train Loss: 0.4737 | Train Acc: 0.8844
 Site-MNIST                     (2) | Train Loss: 0.4674 | Train Acc: 0.9024
 Site-MNIST                     (2) | Train Loss: 0.4993 | Train Acc: 0.8698
 Site-MNIST                     (2) | Train Loss: 0.4812 | Train Acc: 0.8752
 Site-MNIST                     (2) | Train Loss: 0.4587 | Train Acc: 0.8905
 Site-USPS                      (0) | Train Loss: 0.5305 | Train Acc: 0.8441
 Site-USPS                      (0) | Train Loss: 0.5255 | Train Acc: 0.8482
 Site-USPS                      (0) | Train Loss: 0.5193 | Train Acc: 0.8701
 Site-SynthDigits               (3) | Train Loss: 0.9131 | Train Acc: 0.7216
 Site-SynthDigits               (3) | Train Loss: 0.8328 | Train Acc: 0.7765
 Site-MNIST_M                   (1) | Train Loss: 1.2394 | Train Acc: 0.6193
 Site-MNIST_M                   (1) | Train Loss: 1.2210 | Train Acc: 0.6098
 Site-SVHN                      (3) | Train Loss: 1.4052 | Train Acc: 0.5468
Average Train Accuracy: 0.7891
 Site-MNIST                     (2) | Val  Loss: 0.4505 | Val  Acc: 0.9107
 Site-MNIST                     (2) | Val  Loss: 0.4377 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.4387 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.5185 | Val  Acc: 0.8947
 Site-MNIST                     (2) | Val  Loss: 0.4764 | Val  Acc: 0.8947
 Site-USPS                      (0) | Val  Loss: 0.4701 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.5537 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.5675 | Val  Acc: 0.8205
 Site-SynthDigits               (3) | Val  Loss: 1.1564 | Val  Acc: 0.6970
 Site-SynthDigits               (3) | Val  Loss: 0.8346 | Val  Acc: 0.7273
 Site-MNIST_M                   (1) | Val  Loss: 1.1985 | Val  Acc: 0.6023
 Site-MNIST_M                   (1) | Val  Loss: 1.2452 | Val  Acc: 0.6136
 Site-SVHN                      (3) | Val  Loss: 1.4252 | Val  Acc: 0.5411
Average Valid Accuracy: 0.7869
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.9107
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.9048
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.9048
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8947
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8947
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8846
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8333
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8205
 Best site-SynthDigits              (3)  | Epoch:10 | Val Acc: 0.6970
 Best site-SynthDigits              (3)  | Epoch:10 | Val Acc: 0.7273
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6023
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6136
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.5411
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 2, 5, 3, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (2) | Train Loss: 0.4585 | Train Acc: 0.8711
 Site-MNIST                     (2) | Train Loss: 0.4161 | Train Acc: 0.9083
 Site-MNIST                     (2) | Train Loss: 0.4825 | Train Acc: 0.8698
 Site-MNIST                     (2) | Train Loss: 0.4622 | Train Acc: 0.8739
 Site-MNIST                     (2) | Train Loss: 0.4384 | Train Acc: 0.8949
 Site-USPS                      (0) | Train Loss: 0.5264 | Train Acc: 0.8561
 Site-USPS                      (0) | Train Loss: 0.4884 | Train Acc: 0.8594
 Site-USPS                      (0) | Train Loss: 0.4856 | Train Acc: 0.8797
 Site-SynthDigits               (3) | Train Loss: 0.8225 | Train Acc: 0.7462
 Site-SynthDigits               (3) | Train Loss: 0.7621 | Train Acc: 0.7955
 Site-MNIST_M                   (1) | Train Loss: 1.2046 | Train Acc: 0.6449
 Site-MNIST_M                   (1) | Train Loss: 1.1744 | Train Acc: 0.6439
 Site-SVHN                      (3) | Train Loss: 1.3261 | Train Acc: 0.5809
Average Train Accuracy: 0.8019
 Site-MNIST                     (2) | Val  Loss: 0.4329 | Val  Acc: 0.8750
 Site-MNIST                     (2) | Val  Loss: 0.4241 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.4224 | Val  Acc: 0.8968
 Site-MNIST                     (2) | Val  Loss: 0.5007 | Val  Acc: 0.8842
 Site-MNIST                     (2) | Val  Loss: 0.4551 | Val  Acc: 0.8982
 Site-USPS                      (0) | Val  Loss: 0.4359 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.5154 | Val  Acc: 0.8526
 Site-USPS                      (0) | Val  Loss: 0.5353 | Val  Acc: 0.8333
 Site-SynthDigits               (3) | Val  Loss: 1.0572 | Val  Acc: 0.7121
 Site-SynthDigits               (3) | Val  Loss: 0.7550 | Val  Acc: 0.7576
 Site-MNIST_M                   (1) | Val  Loss: 1.1354 | Val  Acc: 0.6364
 Site-MNIST_M                   (1) | Val  Loss: 1.1823 | Val  Acc: 0.6439
 Site-SVHN                      (3) | Val  Loss: 1.3480 | Val  Acc: 0.5616
Average Valid Accuracy: 0.7955
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8750
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.9048
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8968
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8842
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8982
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8846
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8526
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8333
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7121
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7576
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.6364
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.6439
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.5616
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 12 ============
cnt=[3, 5, 2, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (1) | Train Loss: 0.4719 | Train Acc: 0.8578
 Site-MNIST                     (1) | Train Loss: 0.4124 | Train Acc: 0.8964
 Site-MNIST                     (1) | Train Loss: 0.4808 | Train Acc: 0.8698
 Site-MNIST                     (1) | Train Loss: 0.4559 | Train Acc: 0.8699
 Site-MNIST                     (1) | Train Loss: 0.4308 | Train Acc: 0.8905
 Site-USPS                      (3) | Train Loss: 0.4854 | Train Acc: 0.8777
 Site-USPS                      (3) | Train Loss: 0.4614 | Train Acc: 0.8738
 Site-USPS                      (3) | Train Loss: 0.4582 | Train Acc: 0.8839
 Site-SynthDigits               (0) | Train Loss: 0.7734 | Train Acc: 0.7670
 Site-SynthDigits               (0) | Train Loss: 0.7055 | Train Acc: 0.8119
 Site-MNIST_M                   (2) | Train Loss: 1.0996 | Train Acc: 0.6733
 Site-MNIST_M                   (2) | Train Loss: 1.0864 | Train Acc: 0.6799
 Site-SVHN                      (0) | Train Loss: 1.2819 | Train Acc: 0.5775
Average Train Accuracy: 0.8100
 Site-MNIST                     (1) | Val  Loss: 0.4344 | Val  Acc: 0.8750
 Site-MNIST                     (1) | Val  Loss: 0.4240 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.4169 | Val  Acc: 0.8889
 Site-MNIST                     (1) | Val  Loss: 0.4982 | Val  Acc: 0.8842
 Site-MNIST                     (1) | Val  Loss: 0.4486 | Val  Acc: 0.8877
 Site-USPS                      (3) | Val  Loss: 0.4117 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.4887 | Val  Acc: 0.8718
 Site-USPS                      (3) | Val  Loss: 0.5124 | Val  Acc: 0.8590
 Site-SynthDigits               (0) | Val  Loss: 0.9701 | Val  Acc: 0.7273
 Site-SynthDigits               (0) | Val  Loss: 0.6966 | Val  Acc: 0.7626
 Site-MNIST_M                   (2) | Val  Loss: 1.0279 | Val  Acc: 0.6591
 Site-MNIST_M                   (2) | Val  Loss: 1.1050 | Val  Acc: 0.6742
 Site-SVHN                      (0) | Val  Loss: 1.3231 | Val  Acc: 0.5685
Average Valid Accuracy: 0.8042
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8750
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8929
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8889
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8842
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8877
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8718
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8590
 Best site-SynthDigits              (0)  | Epoch:12 | Val Acc: 0.7273
 Best site-SynthDigits              (0)  | Epoch:12 | Val Acc: 0.7626
 Best site-MNIST_M                  (2)  | Epoch:12 | Val Acc: 0.6591
 Best site-MNIST_M                  (2)  | Epoch:12 | Val Acc: 0.6742
 Best site-SVHN                     (0)  | Epoch:12 | Val Acc: 0.5685
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 13 ============
cnt=[5, 1, 5, 2, ]
cnt=[3, 2, 5, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (0) | Train Loss: 0.4121 | Train Acc: 0.8711
 Site-MNIST                     (0) | Train Loss: 0.3631 | Train Acc: 0.9083
 Site-MNIST                     (0) | Train Loss: 0.4409 | Train Acc: 0.8757
 Site-MNIST                     (0) | Train Loss: 0.4191 | Train Acc: 0.8844
 Site-MNIST                     (0) | Train Loss: 0.3940 | Train Acc: 0.8984
 Site-USPS                      (2) | Train Loss: 0.4452 | Train Acc: 0.8873
 Site-USPS                      (2) | Train Loss: 0.4272 | Train Acc: 0.8850
 Site-USPS                      (2) | Train Loss: 0.4245 | Train Acc: 0.8924
 Site-SynthDigits               (2) | Train Loss: 0.7503 | Train Acc: 0.7727
 Site-SynthDigits               (2) | Train Loss: 0.6915 | Train Acc: 0.8068
 Site-MNIST_M                   (3) | Train Loss: 1.0907 | Train Acc: 0.6676
 Site-MNIST_M                   (3) | Train Loss: 1.0773 | Train Acc: 0.6989
 Site-SVHN                      (1) | Train Loss: 1.2308 | Train Acc: 0.6218
Average Train Accuracy: 0.8208
 Site-MNIST                     (0) | Val  Loss: 0.3843 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.3821 | Val  Acc: 0.9048
 Site-MNIST                     (0) | Val  Loss: 0.3870 | Val  Acc: 0.8968
 Site-MNIST                     (0) | Val  Loss: 0.4599 | Val  Acc: 0.8895
 Site-MNIST                     (0) | Val  Loss: 0.4098 | Val  Acc: 0.8982
 Site-USPS                      (2) | Val  Loss: 0.3703 | Val  Acc: 0.9231
 Site-USPS                      (2) | Val  Loss: 0.4446 | Val  Acc: 0.8590
 Site-USPS                      (2) | Val  Loss: 0.4797 | Val  Acc: 0.8590
 Site-SynthDigits               (2) | Val  Loss: 0.9444 | Val  Acc: 0.7273
 Site-SynthDigits               (2) | Val  Loss: 0.6710 | Val  Acc: 0.7879
 Site-MNIST_M                   (3) | Val  Loss: 1.0440 | Val  Acc: 0.6250
 Site-MNIST_M                   (3) | Val  Loss: 1.0897 | Val  Acc: 0.6667
 Site-SVHN                      (1) | Val  Loss: 1.2449 | Val  Acc: 0.5890
Average Valid Accuracy: 0.8092
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.9048
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8968
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8895
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8982
 Best site-USPS                     (2)  | Epoch:13 | Val Acc: 0.9231
 Best site-USPS                     (2)  | Epoch:13 | Val Acc: 0.8590
 Best site-USPS                     (2)  | Epoch:13 | Val Acc: 0.8590
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7273
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7879
 Best site-MNIST_M                  (3)  | Epoch:13 | Val Acc: 0.6250
 Best site-MNIST_M                  (3)  | Epoch:13 | Val Acc: 0.6667
 Best site-SVHN                     (1)  | Epoch:13 | Val Acc: 0.5890
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 3, 5, 3, ]
cnt=[5, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (2) | Train Loss: 0.4102 | Train Acc: 0.8711
 Site-MNIST                     (2) | Train Loss: 0.3405 | Train Acc: 0.9201
 Site-MNIST                     (2) | Train Loss: 0.4117 | Train Acc: 0.8876
 Site-MNIST                     (2) | Train Loss: 0.3952 | Train Acc: 0.8922
 Site-MNIST                     (2) | Train Loss: 0.3694 | Train Acc: 0.9116
 Site-USPS                      (1) | Train Loss: 0.4444 | Train Acc: 0.8777
 Site-USPS                      (1) | Train Loss: 0.4251 | Train Acc: 0.8866
 Site-USPS                      (1) | Train Loss: 0.4270 | Train Acc: 0.8914
 Site-SynthDigits               (3) | Train Loss: 0.7179 | Train Acc: 0.8049
 Site-SynthDigits               (3) | Train Loss: 0.6453 | Train Acc: 0.8434
 Site-MNIST_M                   (0) | Train Loss: 1.0382 | Train Acc: 0.7017
 Site-MNIST_M                   (0) | Train Loss: 0.9846 | Train Acc: 0.7197
 Site-SVHN                      (3) | Train Loss: 1.2248 | Train Acc: 0.6099
Average Train Accuracy: 0.8321
 Site-MNIST                     (2) | Val  Loss: 0.3537 | Val  Acc: 0.8929
 Site-MNIST                     (2) | Val  Loss: 0.3493 | Val  Acc: 0.9167
 Site-MNIST                     (2) | Val  Loss: 0.3630 | Val  Acc: 0.9127
 Site-MNIST                     (2) | Val  Loss: 0.4332 | Val  Acc: 0.8947
 Site-MNIST                     (2) | Val  Loss: 0.3852 | Val  Acc: 0.9088
 Site-USPS                      (1) | Val  Loss: 0.3680 | Val  Acc: 0.9038
 Site-USPS                      (1) | Val  Loss: 0.4345 | Val  Acc: 0.8654
 Site-USPS                      (1) | Val  Loss: 0.4793 | Val  Acc: 0.8462
 Site-SynthDigits               (3) | Val  Loss: 0.8618 | Val  Acc: 0.7727
 Site-SynthDigits               (3) | Val  Loss: 0.6112 | Val  Acc: 0.8131
 Site-MNIST_M                   (0) | Val  Loss: 1.0122 | Val  Acc: 0.6818
 Site-MNIST_M                   (0) | Val  Loss: 1.0510 | Val  Acc: 0.6894
 Site-SVHN                      (3) | Val  Loss: 1.2226 | Val  Acc: 0.5822
Average Valid Accuracy: 0.8216
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8929
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9167
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9127
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8947
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9088
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.9038
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8654
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8462
 Best site-SynthDigits              (3)  | Epoch:14 | Val Acc: 0.7727
 Best site-SynthDigits              (3)  | Epoch:14 | Val Acc: 0.8131
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.6818
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.6894
 Best site-SVHN                     (3)  | Epoch:14 | Val Acc: 0.5822
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 5, 2, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (1) | Train Loss: 0.3400 | Train Acc: 0.9111
 Site-MNIST                     (1) | Train Loss: 0.3065 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.3752 | Train Acc: 0.8935
 Site-MNIST                     (1) | Train Loss: 0.3611 | Train Acc: 0.9028
 Site-MNIST                     (1) | Train Loss: 0.3336 | Train Acc: 0.9273
 Site-USPS                      (3) | Train Loss: 0.4336 | Train Acc: 0.8777
 Site-USPS                      (3) | Train Loss: 0.4119 | Train Acc: 0.8866
 Site-USPS                      (3) | Train Loss: 0.4045 | Train Acc: 0.8892
 Site-SynthDigits               (0) | Train Loss: 0.6717 | Train Acc: 0.8087
 Site-SynthDigits               (0) | Train Loss: 0.6036 | Train Acc: 0.8497
 Site-MNIST_M                   (2) | Train Loss: 0.9848 | Train Acc: 0.7273
 Site-MNIST_M                   (2) | Train Loss: 1.0035 | Train Acc: 0.7159
 Site-SVHN                      (0) | Train Loss: 1.1422 | Train Acc: 0.6184
Average Train Accuracy: 0.8413
 Site-MNIST                     (1) | Val  Loss: 0.3144 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.3165 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.3266 | Val  Acc: 0.9127
 Site-MNIST                     (1) | Val  Loss: 0.3956 | Val  Acc: 0.9053
 Site-MNIST                     (1) | Val  Loss: 0.3515 | Val  Acc: 0.9193
 Site-USPS                      (3) | Val  Loss: 0.3426 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.4213 | Val  Acc: 0.8782
 Site-USPS                      (3) | Val  Loss: 0.4644 | Val  Acc: 0.8590
 Site-SynthDigits               (0) | Val  Loss: 0.8346 | Val  Acc: 0.7879
 Site-SynthDigits               (0) | Val  Loss: 0.5752 | Val  Acc: 0.8182
 Site-MNIST_M                   (2) | Val  Loss: 0.9780 | Val  Acc: 0.6932
 Site-MNIST_M                   (2) | Val  Loss: 1.0137 | Val  Acc: 0.7121
 Site-SVHN                      (0) | Val  Loss: 1.2230 | Val  Acc: 0.5822
Average Valid Accuracy: 0.8322
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9167
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9127
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9053
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9193
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8782
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8590
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7879
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8182
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.6932
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.7121
 Best site-SVHN                     (0)  | Epoch:15 | Val Acc: 0.5822
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 5, 2, 3, ]
cnt=[1, 5, 5, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.3646 | Train Acc: 0.8711
 Site-MNIST                     (1) | Train Loss: 0.3318 | Train Acc: 0.9231
 Site-MNIST                     (1) | Train Loss: 0.3671 | Train Acc: 0.8915
 Site-MNIST                     (1) | Train Loss: 0.3580 | Train Acc: 0.9001
 Site-MNIST                     (1) | Train Loss: 0.3323 | Train Acc: 0.9194
 Site-USPS                      (0) | Train Loss: 0.4109 | Train Acc: 0.8873
 Site-USPS                      (0) | Train Loss: 0.3873 | Train Acc: 0.8994
 Site-USPS                      (0) | Train Loss: 0.3860 | Train Acc: 0.8999
 Site-SynthDigits               (3) | Train Loss: 0.6449 | Train Acc: 0.8163
 Site-SynthDigits               (3) | Train Loss: 0.5848 | Train Acc: 0.8523
 Site-MNIST_M                   (2) | Train Loss: 0.9274 | Train Acc: 0.7386
 Site-MNIST_M                   (2) | Train Loss: 0.9099 | Train Acc: 0.7424
 Site-SVHN                      (3) | Train Loss: 1.2094 | Train Acc: 0.6218
Average Train Accuracy: 0.8433
 Site-MNIST                     (1) | Val  Loss: 0.3087 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.3098 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.3254 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.3882 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3473 | Val  Acc: 0.9193
 Site-USPS                      (0) | Val  Loss: 0.3221 | Val  Acc: 0.9038
 Site-USPS                      (0) | Val  Loss: 0.3921 | Val  Acc: 0.8590
 Site-USPS                      (0) | Val  Loss: 0.4405 | Val  Acc: 0.8504
 Site-SynthDigits               (3) | Val  Loss: 0.7832 | Val  Acc: 0.7955
 Site-SynthDigits               (3) | Val  Loss: 0.5465 | Val  Acc: 0.8182
 Site-MNIST_M                   (2) | Val  Loss: 0.9179 | Val  Acc: 0.7159
 Site-MNIST_M                   (2) | Val  Loss: 0.9718 | Val  Acc: 0.7121
 Site-SVHN                      (3) | Val  Loss: 1.2219 | Val  Acc: 0.5959
Average Valid Accuracy: 0.8309
============ Train epoch 17 ============
cnt=[5, 3, 3, 2, ]
cnt=[3, 2, 3, 5, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (0) | Train Loss: 0.3490 | Train Acc: 0.8844
 Site-MNIST                     (0) | Train Loss: 0.3194 | Train Acc: 0.9349
 Site-MNIST                     (0) | Train Loss: 0.3499 | Train Acc: 0.9014
 Site-MNIST                     (0) | Train Loss: 0.3455 | Train Acc: 0.9028
 Site-MNIST                     (0) | Train Loss: 0.3195 | Train Acc: 0.9212
 Site-USPS                      (1) | Train Loss: 0.4097 | Train Acc: 0.8921
 Site-USPS                      (1) | Train Loss: 0.3745 | Train Acc: 0.9042
 Site-USPS                      (1) | Train Loss: 0.3799 | Train Acc: 0.8988
 Site-SynthDigits               (2) | Train Loss: 0.6114 | Train Acc: 0.8201
 Site-SynthDigits               (2) | Train Loss: 0.5703 | Train Acc: 0.8497
 Site-MNIST_M                   (3) | Train Loss: 0.9073 | Train Acc: 0.7614
 Site-MNIST_M                   (3) | Train Loss: 0.8870 | Train Acc: 0.7538
 Site-SVHN                      (2) | Train Loss: 1.1499 | Train Acc: 0.6440
Average Train Accuracy: 0.8514
 Site-MNIST                     (0) | Val  Loss: 0.2899 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2940 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.3137 | Val  Acc: 0.9127
 Site-MNIST                     (0) | Val  Loss: 0.3741 | Val  Acc: 0.9105
 Site-MNIST                     (0) | Val  Loss: 0.3316 | Val  Acc: 0.9298
 Site-USPS                      (1) | Val  Loss: 0.3138 | Val  Acc: 0.9231
 Site-USPS                      (1) | Val  Loss: 0.3795 | Val  Acc: 0.8846
 Site-USPS                      (1) | Val  Loss: 0.4305 | Val  Acc: 0.8590
 Site-SynthDigits               (2) | Val  Loss: 0.7476 | Val  Acc: 0.8106
 Site-SynthDigits               (2) | Val  Loss: 0.5209 | Val  Acc: 0.8182
 Site-MNIST_M                   (3) | Val  Loss: 0.9187 | Val  Acc: 0.7045
 Site-MNIST_M                   (3) | Val  Loss: 0.9584 | Val  Acc: 0.7348
 Site-SVHN                      (2) | Val  Loss: 1.1873 | Val  Acc: 0.5959
Average Valid Accuracy: 0.8393
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9167
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9127
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9105
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9298
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.9231
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8846
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8590
 Best site-SynthDigits              (2)  | Epoch:17 | Val Acc: 0.8106
 Best site-SynthDigits              (2)  | Epoch:17 | Val Acc: 0.8182
 Best site-MNIST_M                  (3)  | Epoch:17 | Val Acc: 0.7045
 Best site-MNIST_M                  (3)  | Epoch:17 | Val Acc: 0.7348
 Best site-SVHN                     (2)  | Epoch:17 | Val Acc: 0.5959
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 18 ============
cnt=[3, 5, 2, 3, ]
cnt=[2, 5, 3, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (1) | Train Loss: 0.3405 | Train Acc: 0.8933
 Site-MNIST                     (1) | Train Loss: 0.2862 | Train Acc: 0.9320
 Site-MNIST                     (1) | Train Loss: 0.3362 | Train Acc: 0.9034
 Site-MNIST                     (1) | Train Loss: 0.3297 | Train Acc: 0.9093
 Site-MNIST                     (1) | Train Loss: 0.3027 | Train Acc: 0.9238
 Site-USPS                      (0) | Train Loss: 0.3868 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.3626 | Train Acc: 0.9042
 Site-USPS                      (0) | Train Loss: 0.3606 | Train Acc: 0.9052
 Site-SynthDigits               (3) | Train Loss: 0.5836 | Train Acc: 0.8409
 Site-SynthDigits               (3) | Train Loss: 0.5215 | Train Acc: 0.8636
 Site-MNIST_M                   (2) | Train Loss: 0.9017 | Train Acc: 0.7557
 Site-MNIST_M                   (2) | Train Loss: 0.8869 | Train Acc: 0.7576
 Site-SVHN                      (3) | Train Loss: 1.0853 | Train Acc: 0.6559
Average Train Accuracy: 0.8569
 Site-MNIST                     (1) | Val  Loss: 0.2775 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2789 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.3004 | Val  Acc: 0.9206
 Site-MNIST                     (1) | Val  Loss: 0.3565 | Val  Acc: 0.9105
 Site-MNIST                     (1) | Val  Loss: 0.3170 | Val  Acc: 0.9228
 Site-USPS                      (0) | Val  Loss: 0.2973 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.3649 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.4204 | Val  Acc: 0.8547
 Site-SynthDigits               (3) | Val  Loss: 0.7060 | Val  Acc: 0.8182
 Site-SynthDigits               (3) | Val  Loss: 0.4844 | Val  Acc: 0.8434
 Site-MNIST_M                   (2) | Val  Loss: 0.9176 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 0.9452 | Val  Acc: 0.7500
 Site-SVHN                      (3) | Val  Loss: 1.1455 | Val  Acc: 0.5959
Average Valid Accuracy: 0.8452
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9167
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9206
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9105
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9228
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.9327
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8846
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8547
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8182
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8434
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7273
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7500
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.5959
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 19 ============
cnt=[3, 5, 2, 3, ]
cnt=[2, 3, 5, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (1) | Train Loss: 0.3128 | Train Acc: 0.8978
 Site-MNIST                     (1) | Train Loss: 0.2775 | Train Acc: 0.9349
 Site-MNIST                     (1) | Train Loss: 0.3248 | Train Acc: 0.9112
 Site-MNIST                     (1) | Train Loss: 0.3203 | Train Acc: 0.9120
 Site-MNIST                     (1) | Train Loss: 0.2892 | Train Acc: 0.9299
 Site-USPS                      (0) | Train Loss: 0.3795 | Train Acc: 0.8897
 Site-USPS                      (0) | Train Loss: 0.3558 | Train Acc: 0.8962
 Site-USPS                      (0) | Train Loss: 0.3564 | Train Acc: 0.8967
 Site-SynthDigits               (3) | Train Loss: 0.5398 | Train Acc: 0.8485
 Site-SynthDigits               (3) | Train Loss: 0.4990 | Train Acc: 0.8851
 Site-MNIST_M                   (2) | Train Loss: 0.8587 | Train Acc: 0.7614
 Site-MNIST_M                   (2) | Train Loss: 0.8581 | Train Acc: 0.7765
 Site-SVHN                      (3) | Train Loss: 1.0662 | Train Acc: 0.6576
Average Train Accuracy: 0.8613
 Site-MNIST                     (1) | Val  Loss: 0.2634 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2668 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2869 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.3478 | Val  Acc: 0.9158
 Site-MNIST                     (1) | Val  Loss: 0.3053 | Val  Acc: 0.9263
 Site-USPS                      (0) | Val  Loss: 0.2881 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.3523 | Val  Acc: 0.8910
 Site-USPS                      (0) | Val  Loss: 0.4063 | Val  Acc: 0.8590
 Site-SynthDigits               (3) | Val  Loss: 0.6693 | Val  Acc: 0.8106
 Site-SynthDigits               (3) | Val  Loss: 0.4590 | Val  Acc: 0.8636
 Site-MNIST_M                   (2) | Val  Loss: 0.9020 | Val  Acc: 0.6818
 Site-MNIST_M                   (2) | Val  Loss: 0.9273 | Val  Acc: 0.7500
 Site-SVHN                      (3) | Val  Loss: 1.1263 | Val  Acc: 0.6027
Average Valid Accuracy: 0.8475
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9158
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9263
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.9231
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.8910
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.8590
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.8106
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.8636
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.6818
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7500
 Best site-SVHN                     (3)  | Epoch:19 | Val Acc: 0.6027
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 20 ============
cnt=[3, 5, 2, 3, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (1) | Train Loss: 0.3325 | Train Acc: 0.8933
 Site-MNIST                     (1) | Train Loss: 0.2687 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.3188 | Train Acc: 0.9093
 Site-MNIST                     (1) | Train Loss: 0.3128 | Train Acc: 0.9146
 Site-MNIST                     (1) | Train Loss: 0.2851 | Train Acc: 0.9291
 Site-USPS                      (0) | Train Loss: 0.3668 | Train Acc: 0.8897
 Site-USPS                      (0) | Train Loss: 0.3406 | Train Acc: 0.9010
 Site-USPS                      (0) | Train Loss: 0.3425 | Train Acc: 0.8988
 Site-SynthDigits               (3) | Train Loss: 0.5460 | Train Acc: 0.8466
 Site-SynthDigits               (3) | Train Loss: 0.4851 | Train Acc: 0.8826
 Site-MNIST_M                   (2) | Train Loss: 0.8429 | Train Acc: 0.7670
 Site-MNIST_M                   (2) | Train Loss: 0.8267 | Train Acc: 0.7689
 Site-SVHN                      (3) | Train Loss: 1.0315 | Train Acc: 0.6542
Average Train Accuracy: 0.8603
 Site-MNIST                     (1) | Val  Loss: 0.2577 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2607 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2830 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3399 | Val  Acc: 0.9211
 Site-MNIST                     (1) | Val  Loss: 0.3010 | Val  Acc: 0.9228
 Site-USPS                      (0) | Val  Loss: 0.2779 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.3433 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.3964 | Val  Acc: 0.8504
 Site-SynthDigits               (3) | Val  Loss: 0.6621 | Val  Acc: 0.8258
 Site-SynthDigits               (3) | Val  Loss: 0.4454 | Val  Acc: 0.8636
 Site-MNIST_M                   (2) | Val  Loss: 0.8581 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 0.8959 | Val  Acc: 0.7348
 Site-SVHN                      (3) | Val  Loss: 1.1283 | Val  Acc: 0.5959
Average Valid Accuracy: 0.8489
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9211
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9228
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.9231
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.8846
 Best site-USPS                     (0)  | Epoch:20 | Val Acc: 0.8504
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8258
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8636
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.7273
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.7348
 Best site-SVHN                     (3)  | Epoch:20 | Val Acc: 0.5959
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 21 ============
cnt=[3, 5, 2, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.2909 | Train Acc: 0.9200
 Site-MNIST                     (1) | Train Loss: 0.2663 | Train Acc: 0.9320
 Site-MNIST                     (1) | Train Loss: 0.3010 | Train Acc: 0.9152
 Site-MNIST                     (1) | Train Loss: 0.2982 | Train Acc: 0.9146
 Site-MNIST                     (1) | Train Loss: 0.2674 | Train Acc: 0.9361
 Site-USPS                      (3) | Train Loss: 0.3552 | Train Acc: 0.8945
 Site-USPS                      (3) | Train Loss: 0.3366 | Train Acc: 0.9058
 Site-USPS                      (3) | Train Loss: 0.3316 | Train Acc: 0.9052
 Site-SynthDigits               (0) | Train Loss: 0.5299 | Train Acc: 0.8598
 Site-SynthDigits               (0) | Train Loss: 0.4756 | Train Acc: 0.8775
 Site-MNIST_M                   (2) | Train Loss: 0.8122 | Train Acc: 0.7614
 Site-MNIST_M                   (2) | Train Loss: 0.7915 | Train Acc: 0.7973
 Site-SVHN                      (0) | Train Loss: 1.0722 | Train Acc: 0.6559
Average Train Accuracy: 0.8673
 Site-MNIST                     (1) | Val  Loss: 0.2455 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2463 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.2668 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3211 | Val  Acc: 0.9211
 Site-MNIST                     (1) | Val  Loss: 0.2854 | Val  Acc: 0.9298
 Site-USPS                      (3) | Val  Loss: 0.2653 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.3357 | Val  Acc: 0.8910
 Site-USPS                      (3) | Val  Loss: 0.3886 | Val  Acc: 0.8590
 Site-SynthDigits               (0) | Val  Loss: 0.6296 | Val  Acc: 0.8485
 Site-SynthDigits               (0) | Val  Loss: 0.4333 | Val  Acc: 0.8687
 Site-MNIST_M                   (2) | Val  Loss: 0.8428 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 0.8679 | Val  Acc: 0.7500
 Site-SVHN                      (0) | Val  Loss: 1.1177 | Val  Acc: 0.5959
Average Valid Accuracy: 0.8505
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9167
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9211
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9298
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8910
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8590
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8485
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8687
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7045
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7500
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.5959
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 22 ============
cnt=[5, 3, 2, 3, ]
cnt=[5, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (0) | Train Loss: 0.2688 | Train Acc: 0.9156
 Site-MNIST                     (0) | Train Loss: 0.2535 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.2886 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.2886 | Train Acc: 0.9212
 Site-MNIST                     (0) | Train Loss: 0.2590 | Train Acc: 0.9352
 Site-USPS                      (3) | Train Loss: 0.3622 | Train Acc: 0.8873
 Site-USPS                      (3) | Train Loss: 0.3274 | Train Acc: 0.9089
 Site-USPS                      (3) | Train Loss: 0.3283 | Train Acc: 0.9020
 Site-SynthDigits               (1) | Train Loss: 0.5384 | Train Acc: 0.8617
 Site-SynthDigits               (1) | Train Loss: 0.4559 | Train Acc: 0.8914
 Site-MNIST_M                   (2) | Train Loss: 0.7983 | Train Acc: 0.7670
 Site-MNIST_M                   (2) | Train Loss: 0.7686 | Train Acc: 0.7955
 Site-SVHN                      (1) | Train Loss: 1.0084 | Train Acc: 0.6712
Average Train Accuracy: 0.8707
 Site-MNIST                     (0) | Val  Loss: 0.2306 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2327 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2571 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.3112 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2752 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2591 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.3260 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.3841 | Val  Acc: 0.8504
 Site-SynthDigits               (1) | Val  Loss: 0.6218 | Val  Acc: 0.8561
 Site-SynthDigits               (1) | Val  Loss: 0.4179 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.8632 | Val  Acc: 0.7159
 Site-MNIST_M                   (2) | Val  Loss: 0.8735 | Val  Acc: 0.7424
 Site-SVHN                      (1) | Val  Loss: 1.0794 | Val  Acc: 0.6027
Average Valid Accuracy: 0.8569
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9365
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9316
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:22 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:22 | Val Acc: 0.8846
 Best site-USPS                     (3)  | Epoch:22 | Val Acc: 0.8504
 Best site-SynthDigits              (1)  | Epoch:22 | Val Acc: 0.8561
 Best site-SynthDigits              (1)  | Epoch:22 | Val Acc: 0.8889
 Best site-MNIST_M                  (2)  | Epoch:22 | Val Acc: 0.7159
 Best site-MNIST_M                  (2)  | Epoch:22 | Val Acc: 0.7424
 Best site-SVHN                     (1)  | Epoch:22 | Val Acc: 0.6027
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 23 ============
cnt=[5, 3, 2, 3, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (0) | Train Loss: 0.2627 | Train Acc: 0.9156
 Site-MNIST                     (0) | Train Loss: 0.2483 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.2776 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.2811 | Train Acc: 0.9264
 Site-MNIST                     (0) | Train Loss: 0.2500 | Train Acc: 0.9422
 Site-USPS                      (3) | Train Loss: 0.3412 | Train Acc: 0.8897
 Site-USPS                      (3) | Train Loss: 0.3236 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.3220 | Train Acc: 0.9020
 Site-SynthDigits               (1) | Train Loss: 0.5031 | Train Acc: 0.8598
 Site-SynthDigits               (1) | Train Loss: 0.4306 | Train Acc: 0.8990
 Site-MNIST_M                   (2) | Train Loss: 0.8240 | Train Acc: 0.7443
 Site-MNIST_M                   (2) | Train Loss: 0.7920 | Train Acc: 0.7860
 Site-SVHN                      (1) | Train Loss: 0.9990 | Train Acc: 0.6746
Average Train Accuracy: 0.8706
 Site-MNIST                     (0) | Val  Loss: 0.2224 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2263 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2489 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.3002 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2664 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2498 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.3140 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.3728 | Val  Acc: 0.8590
 Site-SynthDigits               (1) | Val  Loss: 0.5997 | Val  Acc: 0.8485
 Site-SynthDigits               (1) | Val  Loss: 0.4032 | Val  Acc: 0.8838
 Site-MNIST_M                   (2) | Val  Loss: 0.8783 | Val  Acc: 0.6591
 Site-MNIST_M                   (2) | Val  Loss: 0.8603 | Val  Acc: 0.7424
 Site-SVHN                      (1) | Val  Loss: 1.0487 | Val  Acc: 0.6096
Average Valid Accuracy: 0.8533
============ Train epoch 24 ============
cnt=[5, 3, 2, 3, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.2472 | Train Acc: 0.9289
 Site-MNIST                     (0) | Train Loss: 0.2392 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2703 | Train Acc: 0.9270
 Site-MNIST                     (0) | Train Loss: 0.2728 | Train Acc: 0.9251
 Site-MNIST                     (0) | Train Loss: 0.2404 | Train Acc: 0.9422
 Site-USPS                      (3) | Train Loss: 0.3299 | Train Acc: 0.8945
 Site-USPS                      (3) | Train Loss: 0.3051 | Train Acc: 0.9105
 Site-USPS                      (3) | Train Loss: 0.3076 | Train Acc: 0.9073
 Site-SynthDigits               (1) | Train Loss: 0.4893 | Train Acc: 0.8807
 Site-SynthDigits               (1) | Train Loss: 0.4256 | Train Acc: 0.9028
 Site-MNIST_M                   (2) | Train Loss: 0.7799 | Train Acc: 0.7756
 Site-MNIST_M                   (2) | Train Loss: 0.7720 | Train Acc: 0.7992
 Site-SVHN                      (1) | Train Loss: 0.9896 | Train Acc: 0.6848
Average Train Accuracy: 0.8789
 Site-MNIST                     (0) | Val  Loss: 0.2163 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2224 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2399 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2940 | Val  Acc: 0.9263
 Site-MNIST                     (0) | Val  Loss: 0.2599 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.2405 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.3050 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.3629 | Val  Acc: 0.8504
 Site-SynthDigits               (1) | Val  Loss: 0.5723 | Val  Acc: 0.8712
 Site-SynthDigits               (1) | Val  Loss: 0.3792 | Val  Acc: 0.8990
 Site-MNIST_M                   (2) | Val  Loss: 0.8433 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 0.8368 | Val  Acc: 0.7576
 Site-SVHN                      (1) | Val  Loss: 1.0378 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8604
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9263
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9439
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8846
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8504
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8712
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8990
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7045
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7576
 Best site-SVHN                     (1)  | Epoch:24 | Val Acc: 0.6233
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 25 ============
cnt=[5, 3, 2, 3, ]
cnt=[2, 5, 1, 5, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (0) | Train Loss: 0.2582 | Train Acc: 0.9289
 Site-MNIST                     (0) | Train Loss: 0.2416 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.2706 | Train Acc: 0.9250
 Site-MNIST                     (0) | Train Loss: 0.2723 | Train Acc: 0.9225
 Site-MNIST                     (0) | Train Loss: 0.2417 | Train Acc: 0.9413
 Site-USPS                      (3) | Train Loss: 0.3292 | Train Acc: 0.8969
 Site-USPS                      (3) | Train Loss: 0.3025 | Train Acc: 0.9105
 Site-USPS                      (3) | Train Loss: 0.2991 | Train Acc: 0.9116
 Site-SynthDigits               (1) | Train Loss: 0.4635 | Train Acc: 0.8826
 Site-SynthDigits               (1) | Train Loss: 0.3995 | Train Acc: 0.9028
 Site-MNIST_M                   (2) | Train Loss: 0.7457 | Train Acc: 0.7869
 Site-MNIST_M                   (2) | Train Loss: 0.7448 | Train Acc: 0.8182
 Site-SVHN                      (1) | Train Loss: 0.9934 | Train Acc: 0.6746
Average Train Accuracy: 0.8802
 Site-MNIST                     (0) | Val  Loss: 0.2228 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2267 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2419 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2907 | Val  Acc: 0.9263
 Site-MNIST                     (0) | Val  Loss: 0.2595 | Val  Acc: 0.9368
 Site-USPS                      (3) | Val  Loss: 0.2341 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2966 | Val  Acc: 0.8910
 Site-USPS                      (3) | Val  Loss: 0.3529 | Val  Acc: 0.8504
 Site-SynthDigits               (1) | Val  Loss: 0.5779 | Val  Acc: 0.8636
 Site-SynthDigits               (1) | Val  Loss: 0.3697 | Val  Acc: 0.9091
 Site-MNIST_M                   (2) | Val  Loss: 0.7987 | Val  Acc: 0.6932
 Site-MNIST_M                   (2) | Val  Loss: 0.8058 | Val  Acc: 0.7803
 Site-SVHN                      (1) | Val  Loss: 1.0350 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8615
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9263
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9368
 Best site-USPS                     (3)  | Epoch:25 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:25 | Val Acc: 0.8910
 Best site-USPS                     (3)  | Epoch:25 | Val Acc: 0.8504
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.8636
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.9091
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.6932
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.7803
 Best site-SVHN                     (1)  | Epoch:25 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 26 ============
cnt=[5, 3, 3, 2, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (0) | Train Loss: 0.2684 | Train Acc: 0.9289
 Site-MNIST                     (0) | Train Loss: 0.2289 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.2644 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.2685 | Train Acc: 0.9225
 Site-MNIST                     (0) | Train Loss: 0.2379 | Train Acc: 0.9378
 Site-USPS                      (2) | Train Loss: 0.3219 | Train Acc: 0.8969
 Site-USPS                      (2) | Train Loss: 0.2950 | Train Acc: 0.9121
 Site-USPS                      (2) | Train Loss: 0.3007 | Train Acc: 0.9095
 Site-SynthDigits               (1) | Train Loss: 0.4887 | Train Acc: 0.8769
 Site-SynthDigits               (1) | Train Loss: 0.4047 | Train Acc: 0.9040
 Site-MNIST_M                   (3) | Train Loss: 0.7373 | Train Acc: 0.7926
 Site-MNIST_M                   (3) | Train Loss: 0.6995 | Train Acc: 0.8144
 Site-SVHN                      (1) | Train Loss: 0.9820 | Train Acc: 0.6780
Average Train Accuracy: 0.8799
 Site-MNIST                     (0) | Val  Loss: 0.2181 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2221 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2378 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2833 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2546 | Val  Acc: 0.9404
 Site-USPS                      (2) | Val  Loss: 0.2303 | Val  Acc: 0.9327
 Site-USPS                      (2) | Val  Loss: 0.2926 | Val  Acc: 0.9038
 Site-USPS                      (2) | Val  Loss: 0.3469 | Val  Acc: 0.8590
 Site-SynthDigits               (1) | Val  Loss: 0.5759 | Val  Acc: 0.8636
 Site-SynthDigits               (1) | Val  Loss: 0.3651 | Val  Acc: 0.9040
 Site-MNIST_M                   (3) | Val  Loss: 0.7788 | Val  Acc: 0.6932
 Site-MNIST_M                   (3) | Val  Loss: 0.7912 | Val  Acc: 0.7879
 Site-SVHN                      (1) | Val  Loss: 1.0166 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8634
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9316
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9404
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.9327
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.9038
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.8590
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.8636
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.9040
 Best site-MNIST_M                  (3)  | Epoch:26 | Val Acc: 0.6932
 Best site-MNIST_M                  (3)  | Epoch:26 | Val Acc: 0.7879
 Best site-SVHN                     (1)  | Epoch:26 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 27 ============
cnt=[5, 3, 2, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (0) | Train Loss: 0.2343 | Train Acc: 0.9378
 Site-MNIST                     (0) | Train Loss: 0.2173 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2570 | Train Acc: 0.9270
 Site-MNIST                     (0) | Train Loss: 0.2613 | Train Acc: 0.9238
 Site-MNIST                     (0) | Train Loss: 0.2284 | Train Acc: 0.9440
 Site-USPS                      (3) | Train Loss: 0.3205 | Train Acc: 0.8993
 Site-USPS                      (3) | Train Loss: 0.2947 | Train Acc: 0.9169
 Site-USPS                      (3) | Train Loss: 0.2961 | Train Acc: 0.9084
 Site-SynthDigits               (1) | Train Loss: 0.4374 | Train Acc: 0.8883
 Site-SynthDigits               (1) | Train Loss: 0.3834 | Train Acc: 0.9053
 Site-MNIST_M                   (2) | Train Loss: 0.7141 | Train Acc: 0.7898
 Site-MNIST_M                   (2) | Train Loss: 0.7153 | Train Acc: 0.8049
 Site-SVHN                      (1) | Train Loss: 0.9300 | Train Acc: 0.7019
Average Train Accuracy: 0.8842
 Site-MNIST                     (0) | Val  Loss: 0.2043 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2130 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2299 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2774 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2466 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2308 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.2891 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.3442 | Val  Acc: 0.8632
 Site-SynthDigits               (1) | Val  Loss: 0.5423 | Val  Acc: 0.8561
 Site-SynthDigits               (1) | Val  Loss: 0.3473 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.7758 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 0.7899 | Val  Acc: 0.7879
 Site-SVHN                      (1) | Val  Loss: 0.9713 | Val  Acc: 0.6712
Average Valid Accuracy: 0.8713
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9316
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:27 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:27 | Val Acc: 0.9103
 Best site-USPS                     (3)  | Epoch:27 | Val Acc: 0.8632
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8561
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.9141
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.7273
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.7879
 Best site-SVHN                     (1)  | Epoch:27 | Val Acc: 0.6712
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 28 ============
cnt=[3, 2, 5, 3, ]
cnt=[1, 5, 5, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (2) | Train Loss: 0.2542 | Train Acc: 0.9333
 Site-MNIST                     (2) | Train Loss: 0.2174 | Train Acc: 0.9379
 Site-MNIST                     (2) | Train Loss: 0.2583 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.2632 | Train Acc: 0.9172
 Site-MNIST                     (2) | Train Loss: 0.2287 | Train Acc: 0.9396
 Site-USPS                      (0) | Train Loss: 0.2978 | Train Acc: 0.9041
 Site-USPS                      (0) | Train Loss: 0.2870 | Train Acc: 0.9137
 Site-USPS                      (0) | Train Loss: 0.2807 | Train Acc: 0.9127
 Site-SynthDigits               (3) | Train Loss: 0.4338 | Train Acc: 0.8845
 Site-SynthDigits               (3) | Train Loss: 0.3721 | Train Acc: 0.9154
 Site-MNIST_M                   (1) | Train Loss: 0.6857 | Train Acc: 0.7955
 Site-MNIST_M                   (1) | Train Loss: 0.6890 | Train Acc: 0.8277
 Site-SVHN                      (3) | Train Loss: 0.9319 | Train Acc: 0.7104
Average Train Accuracy: 0.8859
 Site-MNIST                     (2) | Val  Loss: 0.2152 | Val  Acc: 0.9107
 Site-MNIST                     (2) | Val  Loss: 0.2204 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2299 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2781 | Val  Acc: 0.9263
 Site-MNIST                     (2) | Val  Loss: 0.2468 | Val  Acc: 0.9333
 Site-USPS                      (0) | Val  Loss: 0.2234 | Val  Acc: 0.9423
 Site-USPS                      (0) | Val  Loss: 0.2787 | Val  Acc: 0.8974
 Site-USPS                      (0) | Val  Loss: 0.3272 | Val  Acc: 0.8718
 Site-SynthDigits               (3) | Val  Loss: 0.5070 | Val  Acc: 0.8712
 Site-SynthDigits               (3) | Val  Loss: 0.3387 | Val  Acc: 0.8939
 Site-MNIST_M                   (1) | Val  Loss: 0.7509 | Val  Acc: 0.7386
 Site-MNIST_M                   (1) | Val  Loss: 0.7623 | Val  Acc: 0.8106
 Site-SVHN                      (3) | Val  Loss: 0.9582 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8722
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9107
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9263
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9333
 Best site-USPS                     (0)  | Epoch:28 | Val Acc: 0.9423
 Best site-USPS                     (0)  | Epoch:28 | Val Acc: 0.8974
 Best site-USPS                     (0)  | Epoch:28 | Val Acc: 0.8718
 Best site-SynthDigits              (3)  | Epoch:28 | Val Acc: 0.8712
 Best site-SynthDigits              (3)  | Epoch:28 | Val Acc: 0.8939
 Best site-MNIST_M                  (1)  | Epoch:28 | Val Acc: 0.7386
 Best site-MNIST_M                  (1)  | Epoch:28 | Val Acc: 0.8106
 Best site-SVHN                     (3)  | Epoch:28 | Val Acc: 0.6849
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 29 ============
cnt=[3, 2, 5, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (2) | Train Loss: 0.2318 | Train Acc: 0.9333
 Site-MNIST                     (2) | Train Loss: 0.2249 | Train Acc: 0.9467
 Site-MNIST                     (2) | Train Loss: 0.2415 | Train Acc: 0.9408
 Site-MNIST                     (2) | Train Loss: 0.2499 | Train Acc: 0.9264
 Site-MNIST                     (2) | Train Loss: 0.2174 | Train Acc: 0.9457
 Site-USPS                      (0) | Train Loss: 0.3012 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.2747 | Train Acc: 0.9153
 Site-USPS                      (0) | Train Loss: 0.2821 | Train Acc: 0.9148
 Site-SynthDigits               (3) | Train Loss: 0.4192 | Train Acc: 0.8883
 Site-SynthDigits               (3) | Train Loss: 0.3613 | Train Acc: 0.9091
 Site-MNIST_M                   (1) | Train Loss: 0.6746 | Train Acc: 0.8040
 Site-MNIST_M                   (1) | Train Loss: 0.6706 | Train Acc: 0.8258
 Site-SVHN                      (3) | Train Loss: 0.9178 | Train Acc: 0.7138
Average Train Accuracy: 0.8891
 Site-MNIST                     (2) | Val  Loss: 0.1936 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2015 | Val  Acc: 0.9405
 Site-MNIST                     (2) | Val  Loss: 0.2171 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.2634 | Val  Acc: 0.9368
 Site-MNIST                     (2) | Val  Loss: 0.2336 | Val  Acc: 0.9439
 Site-USPS                      (0) | Val  Loss: 0.2143 | Val  Acc: 0.9423
 Site-USPS                      (0) | Val  Loss: 0.2670 | Val  Acc: 0.9038
 Site-USPS                      (0) | Val  Loss: 0.3200 | Val  Acc: 0.8718
 Site-SynthDigits               (3) | Val  Loss: 0.4980 | Val  Acc: 0.8712
 Site-SynthDigits               (3) | Val  Loss: 0.3279 | Val  Acc: 0.9141
 Site-MNIST_M                   (1) | Val  Loss: 0.7428 | Val  Acc: 0.7273
 Site-MNIST_M                   (1) | Val  Loss: 0.7520 | Val  Acc: 0.8030
 Site-SVHN                      (3) | Val  Loss: 0.9412 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8780
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9405
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9524
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9368
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9439
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9423
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9038
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.8718
 Best site-SynthDigits              (3)  | Epoch:29 | Val Acc: 0.8712
 Best site-SynthDigits              (3)  | Epoch:29 | Val Acc: 0.9141
 Best site-MNIST_M                  (1)  | Epoch:29 | Val Acc: 0.7273
 Best site-MNIST_M                  (1)  | Epoch:29 | Val Acc: 0.8030
 Best site-SVHN                     (3)  | Epoch:29 | Val Acc: 0.6781
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 30 ============
cnt=[3, 5, 2, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2115 | Train Acc: 0.9378
 Site-MNIST                     (1) | Train Loss: 0.1997 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.2299 | Train Acc: 0.9408
 Site-MNIST                     (1) | Train Loss: 0.2381 | Train Acc: 0.9304
 Site-MNIST                     (1) | Train Loss: 0.2078 | Train Acc: 0.9492
 Site-USPS                      (3) | Train Loss: 0.2938 | Train Acc: 0.9041
 Site-USPS                      (3) | Train Loss: 0.2698 | Train Acc: 0.9201
 Site-USPS                      (3) | Train Loss: 0.2760 | Train Acc: 0.9169
 Site-SynthDigits               (0) | Train Loss: 0.4059 | Train Acc: 0.8845
 Site-SynthDigits               (0) | Train Loss: 0.3620 | Train Acc: 0.9217
 Site-MNIST_M                   (2) | Train Loss: 0.6740 | Train Acc: 0.8153
 Site-MNIST_M                   (2) | Train Loss: 0.6396 | Train Acc: 0.8314
 Site-SVHN                      (0) | Train Loss: 0.8955 | Train Acc: 0.7274
Average Train Accuracy: 0.8948
 Site-MNIST                     (1) | Val  Loss: 0.1784 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1924 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.2090 | Val  Acc: 0.9603
 Site-MNIST                     (1) | Val  Loss: 0.2549 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.2241 | Val  Acc: 0.9474
 Site-USPS                      (3) | Val  Loss: 0.2114 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.2641 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3172 | Val  Acc: 0.8675
 Site-SynthDigits               (0) | Val  Loss: 0.4894 | Val  Acc: 0.8636
 Site-SynthDigits               (0) | Val  Loss: 0.3177 | Val  Acc: 0.9091
 Site-MNIST_M                   (2) | Val  Loss: 0.7372 | Val  Acc: 0.7386
 Site-MNIST_M                   (2) | Val  Loss: 0.7431 | Val  Acc: 0.8333
 Site-SVHN                      (0) | Val  Loss: 0.9006 | Val  Acc: 0.6918
Average Valid Accuracy: 0.8822
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9603
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9474
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.9423
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.8675
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8636
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.9091
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.7386
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8333
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.6918
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 31 ============
cnt=[3, 5, 3, 2, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.2147 | Train Acc: 0.9378
 Site-MNIST                     (1) | Train Loss: 0.2067 | Train Acc: 0.9497
 Site-MNIST                     (1) | Train Loss: 0.2276 | Train Acc: 0.9369
 Site-MNIST                     (1) | Train Loss: 0.2402 | Train Acc: 0.9277
 Site-MNIST                     (1) | Train Loss: 0.2056 | Train Acc: 0.9501
 Site-USPS                      (0) | Train Loss: 0.2756 | Train Acc: 0.9185
 Site-USPS                      (0) | Train Loss: 0.2587 | Train Acc: 0.9185
 Site-USPS                      (0) | Train Loss: 0.2591 | Train Acc: 0.9223
 Site-SynthDigits               (2) | Train Loss: 0.4036 | Train Acc: 0.8920
 Site-SynthDigits               (2) | Train Loss: 0.3482 | Train Acc: 0.9217
 Site-MNIST_M                   (3) | Train Loss: 0.6375 | Train Acc: 0.8068
 Site-MNIST_M                   (3) | Train Loss: 0.6426 | Train Acc: 0.8239
 Site-SVHN                      (2) | Train Loss: 0.9162 | Train Acc: 0.7325
Average Train Accuracy: 0.8953
 Site-MNIST                     (1) | Val  Loss: 0.1772 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1896 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.2085 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2498 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.2211 | Val  Acc: 0.9439
 Site-USPS                      (0) | Val  Loss: 0.1925 | Val  Acc: 0.9423
 Site-USPS                      (0) | Val  Loss: 0.2531 | Val  Acc: 0.9103
 Site-USPS                      (0) | Val  Loss: 0.3055 | Val  Acc: 0.8761
 Site-SynthDigits               (2) | Val  Loss: 0.4978 | Val  Acc: 0.8636
 Site-SynthDigits               (2) | Val  Loss: 0.3107 | Val  Acc: 0.9141
 Site-MNIST_M                   (3) | Val  Loss: 0.7146 | Val  Acc: 0.7727
 Site-MNIST_M                   (3) | Val  Loss: 0.7268 | Val  Acc: 0.8182
 Site-SVHN                      (2) | Val  Loss: 0.8923 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8849
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9439
 Best site-USPS                     (0)  | Epoch:31 | Val Acc: 0.9423
 Best site-USPS                     (0)  | Epoch:31 | Val Acc: 0.9103
 Best site-USPS                     (0)  | Epoch:31 | Val Acc: 0.8761
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.8636
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.9141
 Best site-MNIST_M                  (3)  | Epoch:31 | Val Acc: 0.7727
 Best site-MNIST_M                  (3)  | Epoch:31 | Val Acc: 0.8182
 Best site-SVHN                     (2)  | Epoch:31 | Val Acc: 0.6986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 32 ============
cnt=[5, 3, 2, 3, ]
cnt=[5, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2313 | Train Acc: 0.9422
 Site-MNIST                     (0) | Train Loss: 0.1964 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2307 | Train Acc: 0.9270
 Site-MNIST                     (0) | Train Loss: 0.2422 | Train Acc: 0.9304
 Site-MNIST                     (0) | Train Loss: 0.2081 | Train Acc: 0.9475
 Site-USPS                      (3) | Train Loss: 0.2983 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2610 | Train Acc: 0.9201
 Site-USPS                      (3) | Train Loss: 0.2629 | Train Acc: 0.9223
 Site-SynthDigits               (1) | Train Loss: 0.3893 | Train Acc: 0.8920
 Site-SynthDigits               (1) | Train Loss: 0.3481 | Train Acc: 0.9217
 Site-MNIST_M                   (2) | Train Loss: 0.6205 | Train Acc: 0.8125
 Site-MNIST_M                   (2) | Train Loss: 0.6409 | Train Acc: 0.8333
 Site-SVHN                      (1) | Train Loss: 0.8140 | Train Acc: 0.7291
Average Train Accuracy: 0.8955
 Site-MNIST                     (0) | Val  Loss: 0.1925 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.1961 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.2109 | Val  Acc: 0.9444
 Site-MNIST                     (0) | Val  Loss: 0.2518 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.2239 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.1970 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.2541 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.3030 | Val  Acc: 0.8761
 Site-SynthDigits               (1) | Val  Loss: 0.4508 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.3013 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.7033 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.7178 | Val  Acc: 0.8106
 Site-SVHN                      (1) | Val  Loss: 0.8817 | Val  Acc: 0.6918
Average Valid Accuracy: 0.8780
============ Train epoch 33 ============
cnt=[2, 3, 5, 3, ]
cnt=[5, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (2) | Train Loss: 0.2465 | Train Acc: 0.9378
 Site-MNIST                     (2) | Train Loss: 0.2221 | Train Acc: 0.9497
 Site-MNIST                     (2) | Train Loss: 0.2304 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.2423 | Train Acc: 0.9212
 Site-MNIST                     (2) | Train Loss: 0.2069 | Train Acc: 0.9431
 Site-USPS                      (1) | Train Loss: 0.2865 | Train Acc: 0.9113
 Site-USPS                      (1) | Train Loss: 0.2525 | Train Acc: 0.9249
 Site-USPS                      (1) | Train Loss: 0.2560 | Train Acc: 0.9233
 Site-SynthDigits               (3) | Train Loss: 0.4015 | Train Acc: 0.8883
 Site-SynthDigits               (3) | Train Loss: 0.3375 | Train Acc: 0.9255
 Site-MNIST_M                   (0) | Train Loss: 0.6314 | Train Acc: 0.8210
 Site-MNIST_M                   (0) | Train Loss: 0.6188 | Train Acc: 0.8428
 Site-SVHN                      (3) | Train Loss: 0.8420 | Train Acc: 0.7394
Average Train Accuracy: 0.8964
 Site-MNIST                     (2) | Val  Loss: 0.1880 | Val  Acc: 0.9107
 Site-MNIST                     (2) | Val  Loss: 0.1960 | Val  Acc: 0.9167
 Site-MNIST                     (2) | Val  Loss: 0.2098 | Val  Acc: 0.9444
 Site-MNIST                     (2) | Val  Loss: 0.2488 | Val  Acc: 0.9368
 Site-MNIST                     (2) | Val  Loss: 0.2214 | Val  Acc: 0.9439
 Site-USPS                      (1) | Val  Loss: 0.1908 | Val  Acc: 0.9423
 Site-USPS                      (1) | Val  Loss: 0.2464 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2960 | Val  Acc: 0.8761
 Site-SynthDigits               (3) | Val  Loss: 0.4711 | Val  Acc: 0.8561
 Site-SynthDigits               (3) | Val  Loss: 0.2975 | Val  Acc: 0.9242
 Site-MNIST_M                   (0) | Val  Loss: 0.7037 | Val  Acc: 0.7727
 Site-MNIST_M                   (0) | Val  Loss: 0.7222 | Val  Acc: 0.8258
 Site-SVHN                      (3) | Val  Loss: 0.8599 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8819
============ Train epoch 34 ============
cnt=[5, 3, 2, 3, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (0) | Train Loss: 0.2205 | Train Acc: 0.9422
 Site-MNIST                     (0) | Train Loss: 0.1963 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2219 | Train Acc: 0.9310
 Site-MNIST                     (0) | Train Loss: 0.2313 | Train Acc: 0.9304
 Site-MNIST                     (0) | Train Loss: 0.1992 | Train Acc: 0.9475
 Site-USPS                      (3) | Train Loss: 0.2687 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2489 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2486 | Train Acc: 0.9265
 Site-SynthDigits               (1) | Train Loss: 0.4016 | Train Acc: 0.8883
 Site-SynthDigits               (1) | Train Loss: 0.3309 | Train Acc: 0.9255
 Site-MNIST_M                   (2) | Train Loss: 0.6088 | Train Acc: 0.8295
 Site-MNIST_M                   (2) | Train Loss: 0.6031 | Train Acc: 0.8466
 Site-SVHN                      (1) | Train Loss: 0.7970 | Train Acc: 0.7496
Average Train Accuracy: 0.9004
 Site-MNIST                     (0) | Val  Loss: 0.1776 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.1870 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2015 | Val  Acc: 0.9444
 Site-MNIST                     (0) | Val  Loss: 0.2401 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.2140 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.1841 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2387 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.2891 | Val  Acc: 0.8761
 Site-SynthDigits               (1) | Val  Loss: 0.4817 | Val  Acc: 0.8712
 Site-SynthDigits               (1) | Val  Loss: 0.2940 | Val  Acc: 0.9242
 Site-MNIST_M                   (2) | Val  Loss: 0.6958 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.7077 | Val  Acc: 0.8182
 Site-SVHN                      (1) | Val  Loss: 0.8453 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8872
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9444
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9421
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9439
 Best site-USPS                     (3)  | Epoch:34 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:34 | Val Acc: 0.9167
 Best site-USPS                     (3)  | Epoch:34 | Val Acc: 0.8761
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8712
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.9242
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8182
 Best site-SVHN                     (1)  | Epoch:34 | Val Acc: 0.7123
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 35 ============
cnt=[5, 3, 2, 3, ]
cnt=[2, 5, 3, 3, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (0) | Train Loss: 0.2102 | Train Acc: 0.9333
 Site-MNIST                     (0) | Train Loss: 0.1780 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.2107 | Train Acc: 0.9369
 Site-MNIST                     (0) | Train Loss: 0.2256 | Train Acc: 0.9304
 Site-MNIST                     (0) | Train Loss: 0.1930 | Train Acc: 0.9501
 Site-USPS                      (3) | Train Loss: 0.2583 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2495 | Train Acc: 0.9249
 Site-USPS                      (3) | Train Loss: 0.2445 | Train Acc: 0.9286
 Site-SynthDigits               (1) | Train Loss: 0.3779 | Train Acc: 0.8977
 Site-SynthDigits               (1) | Train Loss: 0.3362 | Train Acc: 0.9255
 Site-MNIST_M                   (2) | Train Loss: 0.5930 | Train Acc: 0.8239
 Site-MNIST_M                   (2) | Train Loss: 0.6279 | Train Acc: 0.8371
 Site-SVHN                      (1) | Train Loss: 0.8016 | Train Acc: 0.7462
Average Train Accuracy: 0.9006
 Site-MNIST                     (0) | Val  Loss: 0.1709 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1785 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1933 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2291 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.2066 | Val  Acc: 0.9474
 Site-USPS                      (3) | Val  Loss: 0.1764 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2361 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2839 | Val  Acc: 0.8761
 Site-SynthDigits               (1) | Val  Loss: 0.4481 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2853 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.6766 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.6885 | Val  Acc: 0.8258
 Site-SVHN                      (1) | Val  Loss: 0.8438 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8868
============ Train epoch 36 ============
cnt=[5, 3, 3, 2, ]
cnt=[2, 5, 3, 3, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (0) | Train Loss: 0.1926 | Train Acc: 0.9422
 Site-MNIST                     (0) | Train Loss: 0.2144 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.2052 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.2208 | Train Acc: 0.9317
 Site-MNIST                     (0) | Train Loss: 0.1875 | Train Acc: 0.9492
 Site-USPS                      (2) | Train Loss: 0.2616 | Train Acc: 0.9161
 Site-USPS                      (2) | Train Loss: 0.2369 | Train Acc: 0.9281
 Site-USPS                      (2) | Train Loss: 0.2373 | Train Acc: 0.9297
 Site-SynthDigits               (1) | Train Loss: 0.3862 | Train Acc: 0.9015
 Site-SynthDigits               (1) | Train Loss: 0.3142 | Train Acc: 0.9255
 Site-MNIST_M                   (3) | Train Loss: 0.5883 | Train Acc: 0.8324
 Site-MNIST_M                   (3) | Train Loss: 0.6024 | Train Acc: 0.8409
 Site-SVHN                      (1) | Train Loss: 0.7881 | Train Acc: 0.7581
Average Train Accuracy: 0.9040
 Site-MNIST                     (0) | Val  Loss: 0.1595 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1706 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1906 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2245 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.2012 | Val  Acc: 0.9509
 Site-USPS                      (2) | Val  Loss: 0.1707 | Val  Acc: 0.9519
 Site-USPS                      (2) | Val  Loss: 0.2302 | Val  Acc: 0.9231
 Site-USPS                      (2) | Val  Loss: 0.2816 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.4555 | Val  Acc: 0.8712
 Site-SynthDigits               (1) | Val  Loss: 0.2768 | Val  Acc: 0.9293
 Site-MNIST_M                   (3) | Val  Loss: 0.6699 | Val  Acc: 0.7841
 Site-MNIST_M                   (3) | Val  Loss: 0.6828 | Val  Acc: 0.8333
 Site-SVHN                      (1) | Val  Loss: 0.8349 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8934
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9405
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9421
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9509
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9519
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9231
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8803
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8712
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.9293
 Best site-MNIST_M                  (3)  | Epoch:36 | Val Acc: 0.7841
 Best site-MNIST_M                  (3)  | Epoch:36 | Val Acc: 0.8333
 Best site-SVHN                     (1)  | Epoch:36 | Val Acc: 0.7260
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 37 ============
cnt=[3, 2, 5, 3, ]
cnt=[1, 5, 5, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (2) | Train Loss: 0.1980 | Train Acc: 0.9467
 Site-MNIST                     (2) | Train Loss: 0.1621 | Train Acc: 0.9556
 Site-MNIST                     (2) | Train Loss: 0.1983 | Train Acc: 0.9448
 Site-MNIST                     (2) | Train Loss: 0.2151 | Train Acc: 0.9330
 Site-MNIST                     (2) | Train Loss: 0.1835 | Train Acc: 0.9501
 Site-USPS                      (0) | Train Loss: 0.2649 | Train Acc: 0.9161
 Site-USPS                      (0) | Train Loss: 0.2327 | Train Acc: 0.9313
 Site-USPS                      (0) | Train Loss: 0.2353 | Train Acc: 0.9297
 Site-SynthDigits               (3) | Train Loss: 0.3765 | Train Acc: 0.9053
 Site-SynthDigits               (3) | Train Loss: 0.3185 | Train Acc: 0.9306
 Site-MNIST_M                   (1) | Train Loss: 0.5981 | Train Acc: 0.8523
 Site-MNIST_M                   (1) | Train Loss: 0.5697 | Train Acc: 0.8466
 Site-SVHN                      (3) | Train Loss: 0.7942 | Train Acc: 0.7445
Average Train Accuracy: 0.9066
 Site-MNIST                     (2) | Val  Loss: 0.1483 | Val  Acc: 0.9464
 Site-MNIST                     (2) | Val  Loss: 0.1579 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.1846 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.2172 | Val  Acc: 0.9421
 Site-MNIST                     (2) | Val  Loss: 0.1948 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1671 | Val  Acc: 0.9519
 Site-USPS                      (0) | Val  Loss: 0.2296 | Val  Acc: 0.9295
 Site-USPS                      (0) | Val  Loss: 0.2778 | Val  Acc: 0.8932
 Site-SynthDigits               (3) | Val  Loss: 0.4449 | Val  Acc: 0.8788
 Site-SynthDigits               (3) | Val  Loss: 0.2759 | Val  Acc: 0.9192
 Site-MNIST_M                   (1) | Val  Loss: 0.6622 | Val  Acc: 0.8068
 Site-MNIST_M                   (1) | Val  Loss: 0.6859 | Val  Acc: 0.8258
 Site-SVHN                      (3) | Val  Loss: 0.8252 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8963
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9464
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9524
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9421
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9519
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9295
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.8932
 Best site-SynthDigits              (3)  | Epoch:37 | Val Acc: 0.8788
 Best site-SynthDigits              (3)  | Epoch:37 | Val Acc: 0.9192
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.8068
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.8258
 Best site-SVHN                     (3)  | Epoch:37 | Val Acc: 0.7260
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 38 ============
cnt=[3, 2, 3, 5, ]
cnt=[1, 5, 5, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (3) | Train Loss: 0.1806 | Train Acc: 0.9511
 Site-MNIST                     (3) | Train Loss: 0.1618 | Train Acc: 0.9556
 Site-MNIST                     (3) | Train Loss: 0.1915 | Train Acc: 0.9566
 Site-MNIST                     (3) | Train Loss: 0.2080 | Train Acc: 0.9382
 Site-MNIST                     (3) | Train Loss: 0.1773 | Train Acc: 0.9510
 Site-USPS                      (0) | Train Loss: 0.2594 | Train Acc: 0.9209
 Site-USPS                      (0) | Train Loss: 0.2284 | Train Acc: 0.9345
 Site-USPS                      (0) | Train Loss: 0.2296 | Train Acc: 0.9318
 Site-SynthDigits               (2) | Train Loss: 0.3671 | Train Acc: 0.9053
 Site-SynthDigits               (2) | Train Loss: 0.3049 | Train Acc: 0.9306
 Site-MNIST_M                   (1) | Train Loss: 0.5717 | Train Acc: 0.8409
 Site-MNIST_M                   (1) | Train Loss: 0.5843 | Train Acc: 0.8561
 Site-SVHN                      (2) | Train Loss: 0.8046 | Train Acc: 0.7462
Average Train Accuracy: 0.9091
 Site-MNIST                     (3) | Val  Loss: 0.1394 | Val  Acc: 0.9821
 Site-MNIST                     (3) | Val  Loss: 0.1514 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1774 | Val  Acc: 0.9603
 Site-MNIST                     (3) | Val  Loss: 0.2137 | Val  Acc: 0.9421
 Site-MNIST                     (3) | Val  Loss: 0.1907 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1635 | Val  Acc: 0.9712
 Site-USPS                      (0) | Val  Loss: 0.2269 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.2748 | Val  Acc: 0.8846
 Site-SynthDigits               (2) | Val  Loss: 0.4347 | Val  Acc: 0.8864
 Site-SynthDigits               (2) | Val  Loss: 0.2704 | Val  Acc: 0.9192
 Site-MNIST_M                   (1) | Val  Loss: 0.6502 | Val  Acc: 0.8068
 Site-MNIST_M                   (1) | Val  Loss: 0.6808 | Val  Acc: 0.8258
 Site-SVHN                      (2) | Val  Loss: 0.8066 | Val  Acc: 0.7397
Average Valid Accuracy: 0.9043
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9821
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9603
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9421
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.9712
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.9231
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.8846
 Best site-SynthDigits              (2)  | Epoch:38 | Val Acc: 0.8864
 Best site-SynthDigits              (2)  | Epoch:38 | Val Acc: 0.9192
 Best site-MNIST_M                  (1)  | Epoch:38 | Val Acc: 0.8068
 Best site-MNIST_M                  (1)  | Epoch:38 | Val Acc: 0.8258
 Best site-SVHN                     (2)  | Epoch:38 | Val Acc: 0.7397
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 5, 3, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (1) | Train Loss: 0.1873 | Train Acc: 0.9511
 Site-MNIST                     (1) | Train Loss: 0.1858 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.1899 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.2049 | Train Acc: 0.9369
 Site-MNIST                     (1) | Train Loss: 0.1735 | Train Acc: 0.9527
 Site-USPS                      (3) | Train Loss: 0.2600 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2258 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2296 | Train Acc: 0.9329
 Site-SynthDigits               (2) | Train Loss: 0.3493 | Train Acc: 0.9015
 Site-SynthDigits               (2) | Train Loss: 0.3012 | Train Acc: 0.9293
 Site-MNIST_M                   (0) | Train Loss: 0.5520 | Train Acc: 0.8352
 Site-MNIST_M                   (0) | Train Loss: 0.5656 | Train Acc: 0.8466
 Site-SVHN                      (2) | Train Loss: 0.7972 | Train Acc: 0.7564
Average Train Accuracy: 0.9082
 Site-MNIST                     (1) | Val  Loss: 0.1356 | Val  Acc: 0.9821
 Site-MNIST                     (1) | Val  Loss: 0.1475 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1755 | Val  Acc: 0.9603
 Site-MNIST                     (1) | Val  Loss: 0.2117 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1884 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1616 | Val  Acc: 0.9712
 Site-USPS                      (3) | Val  Loss: 0.2202 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2713 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4290 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 0.2658 | Val  Acc: 0.9192
 Site-MNIST_M                   (0) | Val  Loss: 0.6403 | Val  Acc: 0.8295
 Site-MNIST_M                   (0) | Val  Loss: 0.6599 | Val  Acc: 0.8409
 Site-SVHN                      (2) | Val  Loss: 0.8007 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9075
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9821
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9603
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.9712
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.8788
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.9192
 Best site-MNIST_M                  (0)  | Epoch:39 | Val Acc: 0.8295
 Best site-MNIST_M                  (0)  | Epoch:39 | Val Acc: 0.8409
 Best site-SVHN                     (2)  | Epoch:39 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 5, 3, 3, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.1943 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.1694 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.1880 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.2067 | Train Acc: 0.9382
 Site-MNIST                     (1) | Train Loss: 0.1748 | Train Acc: 0.9518
 Site-USPS                      (3) | Train Loss: 0.2617 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2187 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2291 | Train Acc: 0.9361
 Site-SynthDigits               (2) | Train Loss: 0.3380 | Train Acc: 0.9072
 Site-SynthDigits               (2) | Train Loss: 0.2898 | Train Acc: 0.9331
 Site-MNIST_M                   (0) | Train Loss: 0.5664 | Train Acc: 0.8409
 Site-MNIST_M                   (0) | Train Loss: 0.5724 | Train Acc: 0.8504
 Site-SVHN                      (2) | Train Loss: 0.7353 | Train Acc: 0.7632
Average Train Accuracy: 0.9113
 Site-MNIST                     (1) | Val  Loss: 0.1352 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1463 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.1752 | Val  Acc: 0.9603
 Site-MNIST                     (1) | Val  Loss: 0.2101 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1871 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1594 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2190 | Val  Acc: 0.9295
 Site-USPS                      (3) | Val  Loss: 0.2677 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4237 | Val  Acc: 0.8939
 Site-SynthDigits               (2) | Val  Loss: 0.2604 | Val  Acc: 0.9293
 Site-MNIST_M                   (0) | Val  Loss: 0.6364 | Val  Acc: 0.8068
 Site-MNIST_M                   (0) | Val  Loss: 0.6595 | Val  Acc: 0.8258
 Site-SVHN                      (2) | Val  Loss: 0.7827 | Val  Acc: 0.7329
Average Valid Accuracy: 0.9030
============ Train epoch 41 ============
cnt=[5, 3, 3, 2, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (0) | Train Loss: 0.1909 | Train Acc: 0.9511
 Site-MNIST                     (0) | Train Loss: 0.1630 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1896 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.2037 | Train Acc: 0.9343
 Site-MNIST                     (0) | Train Loss: 0.1717 | Train Acc: 0.9536
 Site-USPS                      (1) | Train Loss: 0.2481 | Train Acc: 0.9209
 Site-USPS                      (1) | Train Loss: 0.2163 | Train Acc: 0.9409
 Site-USPS                      (1) | Train Loss: 0.2185 | Train Acc: 0.9350
 Site-SynthDigits               (2) | Train Loss: 0.3331 | Train Acc: 0.9110
 Site-SynthDigits               (2) | Train Loss: 0.2931 | Train Acc: 0.9331
 Site-MNIST_M                   (3) | Train Loss: 0.5414 | Train Acc: 0.8551
 Site-MNIST_M                   (3) | Train Loss: 0.5707 | Train Acc: 0.8485
 Site-SVHN                      (2) | Train Loss: 0.7799 | Train Acc: 0.7632
Average Train Accuracy: 0.9119
 Site-MNIST                     (0) | Val  Loss: 0.1376 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.1482 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.1729 | Val  Acc: 0.9603
 Site-MNIST                     (0) | Val  Loss: 0.2078 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.1857 | Val  Acc: 0.9509
 Site-USPS                      (1) | Val  Loss: 0.1528 | Val  Acc: 0.9615
 Site-USPS                      (1) | Val  Loss: 0.2124 | Val  Acc: 0.9295
 Site-USPS                      (1) | Val  Loss: 0.2553 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4118 | Val  Acc: 0.9015
 Site-SynthDigits               (2) | Val  Loss: 0.2577 | Val  Acc: 0.9343
 Site-MNIST_M                   (3) | Val  Loss: 0.6080 | Val  Acc: 0.8295
 Site-MNIST_M                   (3) | Val  Loss: 0.6318 | Val  Acc: 0.8409
 Site-SVHN                      (2) | Val  Loss: 0.7926 | Val  Acc: 0.7260
Average Valid Accuracy: 0.9050
============ Train epoch 42 ============
cnt=[5, 3, 2, 3, ]
cnt=[5, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (0) | Train Loss: 0.1705 | Train Acc: 0.9511
 Site-MNIST                     (0) | Train Loss: 0.1703 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1846 | Train Acc: 0.9546
 Site-MNIST                     (0) | Train Loss: 0.2014 | Train Acc: 0.9369
 Site-MNIST                     (0) | Train Loss: 0.1679 | Train Acc: 0.9527
 Site-USPS                      (3) | Train Loss: 0.2306 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2081 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2134 | Train Acc: 0.9361
 Site-SynthDigits               (1) | Train Loss: 0.3381 | Train Acc: 0.9091
 Site-SynthDigits               (1) | Train Loss: 0.2965 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.5263 | Train Acc: 0.8580
 Site-MNIST_M                   (2) | Train Loss: 0.5473 | Train Acc: 0.8485
 Site-SVHN                      (1) | Train Loss: 0.7224 | Train Acc: 0.7785
Average Train Accuracy: 0.9132
 Site-MNIST                     (0) | Val  Loss: 0.1311 | Val  Acc: 0.9821
 Site-MNIST                     (0) | Val  Loss: 0.1441 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1686 | Val  Acc: 0.9603
 Site-MNIST                     (0) | Val  Loss: 0.2052 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.1840 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1494 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2057 | Val  Acc: 0.9295
 Site-USPS                      (3) | Val  Loss: 0.2487 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.4268 | Val  Acc: 0.8939
 Site-SynthDigits               (1) | Val  Loss: 0.2549 | Val  Acc: 0.9293
 Site-MNIST_M                   (2) | Val  Loss: 0.6023 | Val  Acc: 0.8068
 Site-MNIST_M                   (2) | Val  Loss: 0.6342 | Val  Acc: 0.8258
 Site-SVHN                      (1) | Val  Loss: 0.7833 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9068
============ Train epoch 43 ============
cnt=[5, 3, 2, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.1751 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1599 | Train Acc: 0.9586
 Site-MNIST                     (0) | Train Loss: 0.1773 | Train Acc: 0.9586
 Site-MNIST                     (0) | Train Loss: 0.1955 | Train Acc: 0.9422
 Site-MNIST                     (0) | Train Loss: 0.1623 | Train Acc: 0.9536
 Site-USPS                      (3) | Train Loss: 0.2340 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2110 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2162 | Train Acc: 0.9382
 Site-SynthDigits               (1) | Train Loss: 0.3295 | Train Acc: 0.9129
 Site-SynthDigits               (1) | Train Loss: 0.2886 | Train Acc: 0.9356
 Site-MNIST_M                   (2) | Train Loss: 0.5226 | Train Acc: 0.8551
 Site-MNIST_M                   (2) | Train Loss: 0.5288 | Train Acc: 0.8542
 Site-SVHN                      (1) | Train Loss: 0.7154 | Train Acc: 0.7785
Average Train Accuracy: 0.9154
 Site-MNIST                     (0) | Val  Loss: 0.1249 | Val  Acc: 0.9821
 Site-MNIST                     (0) | Val  Loss: 0.1406 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1630 | Val  Acc: 0.9683
 Site-MNIST                     (0) | Val  Loss: 0.2013 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.1801 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1466 | Val  Acc: 0.9712
 Site-USPS                      (3) | Val  Loss: 0.2064 | Val  Acc: 0.9295
 Site-USPS                      (3) | Val  Loss: 0.2520 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.4205 | Val  Acc: 0.8939
 Site-SynthDigits               (1) | Val  Loss: 0.2494 | Val  Acc: 0.9343
 Site-MNIST_M                   (2) | Val  Loss: 0.5955 | Val  Acc: 0.8068
 Site-MNIST_M                   (2) | Val  Loss: 0.6407 | Val  Acc: 0.8258
 Site-SVHN                      (1) | Val  Loss: 0.7696 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9087
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9821
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9683
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9544
 Best site-USPS                     (3)  | Epoch:43 | Val Acc: 0.9712
 Best site-USPS                     (3)  | Epoch:43 | Val Acc: 0.9295
 Best site-USPS                     (3)  | Epoch:43 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:43 | Val Acc: 0.8939
 Best site-SynthDigits              (1)  | Epoch:43 | Val Acc: 0.9343
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.8068
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.8258
 Best site-SVHN                     (1)  | Epoch:43 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 44 ============
cnt=[5, 3, 2, 3, ]
cnt=[3, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.1643 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1468 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1759 | Train Acc: 0.9566
 Site-MNIST                     (0) | Train Loss: 0.1926 | Train Acc: 0.9382
 Site-MNIST                     (0) | Train Loss: 0.1613 | Train Acc: 0.9553
 Site-USPS                      (3) | Train Loss: 0.2271 | Train Acc: 0.9257
 Site-USPS                      (3) | Train Loss: 0.2102 | Train Acc: 0.9473
 Site-USPS                      (3) | Train Loss: 0.2092 | Train Acc: 0.9446
 Site-SynthDigits               (1) | Train Loss: 0.3121 | Train Acc: 0.9148
 Site-SynthDigits               (1) | Train Loss: 0.2798 | Train Acc: 0.9407
 Site-MNIST_M                   (2) | Train Loss: 0.5244 | Train Acc: 0.8580
 Site-MNIST_M                   (2) | Train Loss: 0.5297 | Train Acc: 0.8636
 Site-SVHN                      (1) | Train Loss: 0.7002 | Train Acc: 0.7751
Average Train Accuracy: 0.9178
 Site-MNIST                     (0) | Val  Loss: 0.1196 | Val  Acc: 0.9821
 Site-MNIST                     (0) | Val  Loss: 0.1401 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.1601 | Val  Acc: 0.9683
 Site-MNIST                     (0) | Val  Loss: 0.1983 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.1770 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1413 | Val  Acc: 0.9808
 Site-USPS                      (3) | Val  Loss: 0.2027 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2483 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.4082 | Val  Acc: 0.9015
 Site-SynthDigits               (1) | Val  Loss: 0.2417 | Val  Acc: 0.9394
 Site-MNIST_M                   (2) | Val  Loss: 0.5918 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6297 | Val  Acc: 0.8258
 Site-SVHN                      (1) | Val  Loss: 0.7506 | Val  Acc: 0.7603
Average Valid Accuracy: 0.9089
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9821
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9683
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.9808
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:44 | Val Acc: 0.9015
 Best site-SynthDigits              (1)  | Epoch:44 | Val Acc: 0.9394
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.7955
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.8258
 Best site-SVHN                     (1)  | Epoch:44 | Val Acc: 0.7603
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_4/ccop_q=1...
============ Train epoch 45 ============
cnt=[5, 3, 2, 3, ]
cnt=[5, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (0) | Train Loss: 0.1621 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1423 | Train Acc: 0.9586
 Site-MNIST                     (0) | Train Loss: 0.1757 | Train Acc: 0.9546
 Site-MNIST                     (0) | Train Loss: 0.1900 | Train Acc: 0.9448
 Site-MNIST                     (0) | Train Loss: 0.1568 | Train Acc: 0.9527
 Site-USPS                      (3) | Train Loss: 0.2300 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2067 | Train Acc: 0.9409
 Site-USPS                      (3) | Train Loss: 0.2084 | Train Acc: 0.9414
 Site-SynthDigits               (1) | Train Loss: 0.3085 | Train Acc: 0.9110
 Site-SynthDigits               (1) | Train Loss: 0.2739 | Train Acc: 0.9419
 Site-MNIST_M                   (2) | Train Loss: 0.5120 | Train Acc: 0.8636
 Site-MNIST_M                   (2) | Train Loss: 0.5093 | Train Acc: 0.8542
 Site-SVHN                      (1) | Train Loss: 0.6913 | Train Acc: 0.7802
Average Train Accuracy: 0.9171
 Site-MNIST                     (0) | Val  Loss: 0.1187 | Val  Acc: 0.9821
 Site-MNIST                     (0) | Val  Loss: 0.1382 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1569 | Val  Acc: 0.9683
 Site-MNIST                     (0) | Val  Loss: 0.1978 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.1764 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1423 | Val  Acc: 0.9808
 Site-USPS                      (3) | Val  Loss: 0.2008 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2434 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.3930 | Val  Acc: 0.9015
 Site-SynthDigits               (1) | Val  Loss: 0.2391 | Val  Acc: 0.9444
 Site-MNIST_M                   (2) | Val  Loss: 0.5916 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6241 | Val  Acc: 0.8561
 Site-SVHN                      (1) | Val  Loss: 0.7366 | Val  Acc: 0.7671
Average Valid Accuracy: 0.9130
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9821
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9683
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9421
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9544
 Best site-USPS                     (3)  | Epoch:45 | Val Acc: 0.9808
 Best site-USPS                     (3)  | Epoch:45 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:45 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:45 | Val Acc: 0.9015
 Best site-SynthDigits              (1)  | Epoch:45 | Val Acc: 0.9444
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.7955
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8561
 Best site-SVHN                     (1)  | Epoch:45 | Val Acc: 0.7671
 Test site-MNIST                     (0)| Epoch:45 | Test Acc: 0.9449
 Test site-USPS                      (3)| Epoch:45 | Test Acc: 0.9430
 Test site-SynthDigits               (1)| Epoch:45 | Test Acc: 0.9079
 Test site-MNIST_M                   (2)| Epoch:45 | Test Acc: 0.7584
 Test site-SVHN                      (1)| Epoch:45 | Test Acc: 0.7010
MNIST: 0.9449, USPS: 0.9430, SynthDigits: 0.9079, MNIST_M: 0.7584, SVHN: 0.7010, 
Average Test Accuracy(group): 0.8510, Average Test Accuracy(individual): 0.8913,
domain std=0.1016, cluster std=0.0780, individual std=0.0852, 
===2023-08-01 06:19:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 4
Loading snapshots...
 Test site-MNIST                     (0)| Epoch:44 | Test Acc: 0.9447
 Test site-USPS                      (3)| Epoch:44 | Test Acc: 0.9409
 Test site-SynthDigits               (1)| Epoch:44 | Test Acc: 0.9074
 Test site-MNIST_M                   (2)| Epoch:44 | Test Acc: 0.7583
 Test site-SVHN                      (1)| Epoch:44 | Test Acc: 0.7019
MNIST: 0.9447, USPS: 0.9409, SynthDigits: 0.9074, MNIST_M: 0.7583, SVHN: 0.7019, 
Average Test Accuracy(group): 0.8506, Average Test Accuracy(individual): 0.8907,
domain std=0.1009, cluster std=0.0775, individual std=0.0848, 
