===2023-05-30 03:00:14===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.8
    std_rw: False
data_number=[193,254,332,436,571,217,284,373,488,258,338,443,343,450,262,343,462,352,]
client_nums=[5,4,3,2,2,1,1,]
len_dataset=[2980,2274,1735,1324,1010,770,587,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[7, 2, 1, 2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.03016, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White                    | Train Loss: 2.1234 | Train Acc: 0.3627
 Site-White                    | Train Loss: 1.8582 | Train Acc: 0.3465
 Site-White                    | Train Loss: 1.8435 | Train Acc: 0.3494
 Site-White                    | Train Loss: 1.8041 | Train Acc: 0.3624
 Site-White                    | Train Loss: 1.8429 | Train Acc: 0.3485
 Site-Latino_Hispanic          | Train Loss: 2.0300 | Train Acc: 0.2535
 Site-Latino_Hispanic          | Train Loss: 1.9438 | Train Acc: 0.2887
 Site-Latino_Hispanic          | Train Loss: 2.0311 | Train Acc: 0.2627
 Site-Latino_Hispanic          | Train Loss: 1.9844 | Train Acc: 0.2746
 Site-Black                    | Train Loss: 2.3270 | Train Acc: 0.2481
 Site-Black                    | Train Loss: 2.0720 | Train Acc: 0.2426
 Site-Black                    | Train Loss: 2.0679 | Train Acc: 0.2438
 Site-East_Asian               | Train Loss: 1.8488 | Train Acc: 0.3644
 Site-East_Asian               | Train Loss: 1.7981 | Train Acc: 0.3911
 Site-Indian                   | Train Loss: 2.1443 | Train Acc: 0.2290
 Site-Indian                   | Train Loss: 2.1394 | Train Acc: 0.2303
 Site-Southeast_Asian          | Train Loss: 2.1047 | Train Acc: 0.3074
 Site-Middle_Eastern           | Train Loss: 1.9990 | Train Acc: 0.2557
 Site-White                     (1) | Val  Loss: 2.3500 | Val  Acc: 0.3178
 Site-White                     (5) | Val  Loss: 1.7859 | Val  Acc: 0.3669
 Site-White                     (1) | Val  Loss: 1.8020 | Val  Acc: 0.3529
 Site-White                     (5) | Val  Loss: 1.8863 | Val  Acc: 0.3310
 Site-White                     (5) | Val  Loss: 1.8595 | Val  Acc: 0.3500
 Site-Latino_Hispanic           (0) | Val  Loss: 2.0713 | Val  Acc: 0.2639
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9808 | Val  Acc: 0.2540
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9762 | Val  Acc: 0.2742
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9221 | Val  Acc: 0.2769
 Site-Black                     (4) | Val  Loss: 2.1358 | Val  Acc: 0.2209
 Site-Black                     (2) | Val  Loss: 2.0448 | Val  Acc: 0.2444
 Site-Black                     (6) | Val  Loss: 2.0758 | Val  Acc: 0.2475
 Site-East_Asian                (3) | Val  Loss: 1.8617 | Val  Acc: 0.3668
 Site-East_Asian                (3) | Val  Loss: 1.8253 | Val  Acc: 0.3779
 Site-Indian                    (0) | Val  Loss: 2.1298 | Val  Acc: 0.2414
 Site-Indian                    (0) | Val  Loss: 2.1834 | Val  Acc: 0.2271
 Site-Southeast_Asian           (0) | Val  Loss: 2.0881 | Val  Acc: 0.2922
 Site-Middle_Eastern            (5) | Val  Loss: 2.0715 | Val  Acc: 0.2479
Average Valid Accuracy: 0.2919
Aggregated Acc | Val Acc: 0.2866
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3178
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3669
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3529
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3310
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3500
 Best site-Latino_Hispanic          (0)  | Epoch:0 | Val Acc: 0.2639
 Best site-Latino_Hispanic          (0)  | Epoch:0 | Val Acc: 0.2540
 Best site-Latino_Hispanic          (0)  | Epoch:0 | Val Acc: 0.2742
 Best site-Latino_Hispanic          (0)  | Epoch:0 | Val Acc: 0.2769
 Best site-Black                    (4)  | Epoch:0 | Val Acc: 0.2209
 Best site-Black                    (2)  | Epoch:0 | Val Acc: 0.2444
 Best site-Black                    (6)  | Epoch:0 | Val Acc: 0.2475
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3668
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3779
 Best site-Indian                   (0)  | Epoch:0 | Val Acc: 0.2414
 Best site-Indian                   (0)  | Epoch:0 | Val Acc: 0.2271
 Best site-Southeast_Asian          (0)  | Epoch:0 | Val Acc: 0.2922
 Best site-Middle_Eastern           (5)  | Epoch:0 | Val Acc: 0.2479
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 1, 4, 3, 2, 4, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.13381, quan_i=2.13, quan_c=2.16
minimize weight of clients:[1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.6019 | Train Acc: 0.3523
 Site-White                    | Train Loss: 1.8149 | Train Acc: 0.3228
 Site-White                    | Train Loss: 1.8323 | Train Acc: 0.3404
 Site-White                    | Train Loss: 1.7836 | Train Acc: 0.3440
 Site-White                    | Train Loss: 1.8103 | Train Acc: 0.3345
 Site-Latino_Hispanic          | Train Loss: 1.9411 | Train Acc: 0.2535
 Site-Latino_Hispanic          | Train Loss: 1.9076 | Train Acc: 0.2817
 Site-Latino_Hispanic          | Train Loss: 1.9323 | Train Acc: 0.2440
 Site-Latino_Hispanic          | Train Loss: 1.8935 | Train Acc: 0.2725
 Site-Black                    | Train Loss: 2.0472 | Train Acc: 0.2597
 Site-Black                    | Train Loss: 1.9950 | Train Acc: 0.2515
 Site-Black                    | Train Loss: 1.9657 | Train Acc: 0.2257
 Site-East_Asian               | Train Loss: 1.7954 | Train Acc: 0.3615
 Site-East_Asian               | Train Loss: 1.7194 | Train Acc: 0.3800
 Site-Indian                   | Train Loss: 2.0997 | Train Acc: 0.2290
 Site-Indian                   | Train Loss: 2.0186 | Train Acc: 0.2391
 Site-Southeast_Asian          | Train Loss: 1.9809 | Train Acc: 0.3074
 Site-Middle_Eastern           | Train Loss: 1.9266 | Train Acc: 0.2472
 Site-White                     (0) | Val  Loss: 2.2100 | Val  Acc: 0.3101
 Site-White                     (6) | Val  Loss: 1.7557 | Val  Acc: 0.3728
 Site-White                     (6) | Val  Loss: 1.7749 | Val  Acc: 0.3439
 Site-White                     (0) | Val  Loss: 1.8282 | Val  Acc: 0.3345
 Site-White                     (6) | Val  Loss: 1.8204 | Val  Acc: 0.3474
 Site-Latino_Hispanic           (3) | Val  Loss: 1.9360 | Val  Acc: 0.2569
 Site-Latino_Hispanic           (3) | Val  Loss: 1.9105 | Val  Acc: 0.2434
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8878 | Val  Acc: 0.3024
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8374 | Val  Acc: 0.2708
 Site-Black                     (4) | Val  Loss: 2.0242 | Val  Acc: 0.2267
 Site-Black                     (4) | Val  Loss: 1.9474 | Val  Acc: 0.2444
 Site-Black                     (4) | Val  Loss: 1.9460 | Val  Acc: 0.2508
 Site-East_Asian                (5) | Val  Loss: 1.7939 | Val  Acc: 0.3974
 Site-East_Asian                (5) | Val  Loss: 1.7848 | Val  Acc: 0.3712
 Site-Indian                    (1) | Val  Loss: 2.0464 | Val  Acc: 0.2586
 Site-Indian                    (1) | Val  Loss: 2.0618 | Val  Acc: 0.2183
 Site-Southeast_Asian           (2) | Val  Loss: 1.9952 | Val  Acc: 0.3019
 Site-Middle_Eastern            (6) | Val  Loss: 1.9672 | Val  Acc: 0.2650
Average Valid Accuracy: 0.2954
Aggregated Acc | Val Acc: 0.2983
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.3101
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3728
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3439
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.3345
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3474
 Best site-Latino_Hispanic          (3)  | Epoch:1 | Val Acc: 0.2569
 Best site-Latino_Hispanic          (3)  | Epoch:1 | Val Acc: 0.2434
 Best site-Latino_Hispanic          (3)  | Epoch:1 | Val Acc: 0.3024
 Best site-Latino_Hispanic          (3)  | Epoch:1 | Val Acc: 0.2708
 Best site-Black                    (4)  | Epoch:1 | Val Acc: 0.2267
 Best site-Black                    (4)  | Epoch:1 | Val Acc: 0.2444
 Best site-Black                    (4)  | Epoch:1 | Val Acc: 0.2508
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.3974
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.3712
 Best site-Indian                   (1)  | Epoch:1 | Val Acc: 0.2586
 Best site-Indian                   (1)  | Epoch:1 | Val Acc: 0.2183
 Best site-Southeast_Asian          (2)  | Epoch:1 | Val Acc: 0.3019
 Best site-Middle_Eastern           (6)  | Epoch:1 | Val Acc: 0.2650
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 6, 2, 1, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.08109, quan_i=2.00, quan_c=2.03
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.6383 | Train Acc: 0.3420
 Site-White                    | Train Loss: 1.8002 | Train Acc: 0.3346
 Site-White                    | Train Loss: 1.8577 | Train Acc: 0.3614
 Site-White                    | Train Loss: 1.7725 | Train Acc: 0.3601
 Site-White                    | Train Loss: 1.7825 | Train Acc: 0.3433
 Site-Latino_Hispanic          | Train Loss: 1.9013 | Train Acc: 0.2811
 Site-Latino_Hispanic          | Train Loss: 1.8494 | Train Acc: 0.2782
 Site-Latino_Hispanic          | Train Loss: 1.8949 | Train Acc: 0.2654
 Site-Latino_Hispanic          | Train Loss: 1.8523 | Train Acc: 0.2725
 Site-Black                    | Train Loss: 1.9325 | Train Acc: 0.2558
 Site-Black                    | Train Loss: 1.9317 | Train Acc: 0.2663
 Site-Black                    | Train Loss: 1.9126 | Train Acc: 0.2573
 Site-East_Asian               | Train Loss: 1.7787 | Train Acc: 0.3732
 Site-East_Asian               | Train Loss: 1.7281 | Train Acc: 0.3822
 Site-Indian                   | Train Loss: 2.0458 | Train Acc: 0.2366
 Site-Indian                   | Train Loss: 1.9723 | Train Acc: 0.2653
 Site-Southeast_Asian          | Train Loss: 1.9483 | Train Acc: 0.3117
 Site-Middle_Eastern           | Train Loss: 1.8617 | Train Acc: 0.2699
 Site-White                     (1) | Val  Loss: 2.1966 | Val  Acc: 0.3256
 Site-White                     (1) | Val  Loss: 1.7669 | Val  Acc: 0.4024
 Site-White                     (1) | Val  Loss: 1.7531 | Val  Acc: 0.3258
 Site-White                     (1) | Val  Loss: 1.7984 | Val  Acc: 0.3517
 Site-White                     (1) | Val  Loss: 1.7978 | Val  Acc: 0.3500
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9042 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8565 | Val  Acc: 0.2487
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8582 | Val  Acc: 0.2944
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8204 | Val  Acc: 0.2954
 Site-Black                     (3) | Val  Loss: 1.9643 | Val  Acc: 0.2442
 Site-Black                     (6) | Val  Loss: 1.8812 | Val  Acc: 0.2889
 Site-Black                     (6) | Val  Loss: 1.9137 | Val  Acc: 0.2712
 Site-East_Asian                (5) | Val  Loss: 1.7781 | Val  Acc: 0.3755
 Site-East_Asian                (5) | Val  Loss: 1.7449 | Val  Acc: 0.3612
 Site-Indian                    (6) | Val  Loss: 1.9753 | Val  Acc: 0.2759
 Site-Indian                    (0) | Val  Loss: 2.0015 | Val  Acc: 0.2096
 Site-Southeast_Asian           (0) | Val  Loss: 1.9302 | Val  Acc: 0.2955
 Site-Middle_Eastern            (1) | Val  Loss: 1.9313 | Val  Acc: 0.2607
Average Valid Accuracy: 0.3015
Aggregated Acc | Val Acc: 0.2891
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3256
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.4024
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3258
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3517
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3500
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.2500
 Best site-Latino_Hispanic          (2)  | Epoch:2 | Val Acc: 0.2487
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.2944
 Best site-Latino_Hispanic          (2)  | Epoch:2 | Val Acc: 0.2954
 Best site-Black                    (3)  | Epoch:2 | Val Acc: 0.2442
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.2889
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.2712
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.3755
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.3612
 Best site-Indian                   (6)  | Epoch:2 | Val Acc: 0.2759
 Best site-Indian                   (0)  | Epoch:2 | Val Acc: 0.2096
 Best site-Southeast_Asian          (0)  | Epoch:2 | Val Acc: 0.2955
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.2607
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 3 ============
cnt=[6, 3, 2, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.08355, quan_i=1.96, quan_c=1.94
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.5984 | Train Acc: 0.3834
 Site-White                    | Train Loss: 1.7735 | Train Acc: 0.3346
 Site-White                    | Train Loss: 1.7424 | Train Acc: 0.3313
 Site-White                    | Train Loss: 1.7301 | Train Acc: 0.3601
 Site-White                    | Train Loss: 1.7525 | Train Acc: 0.3625
 Site-Latino_Hispanic          | Train Loss: 1.8332 | Train Acc: 0.2673
 Site-Latino_Hispanic          | Train Loss: 1.8271 | Train Acc: 0.2923
 Site-Latino_Hispanic          | Train Loss: 1.8710 | Train Acc: 0.2440
 Site-Latino_Hispanic          | Train Loss: 1.8258 | Train Acc: 0.2848
 Site-Black                    | Train Loss: 1.8462 | Train Acc: 0.2519
 Site-Black                    | Train Loss: 1.9277 | Train Acc: 0.2811
 Site-Black                    | Train Loss: 1.9047 | Train Acc: 0.2393
 Site-East_Asian               | Train Loss: 1.7072 | Train Acc: 0.3644
 Site-East_Asian               | Train Loss: 1.6281 | Train Acc: 0.3956
 Site-Indian                   | Train Loss: 1.8695 | Train Acc: 0.2405
 Site-Indian                   | Train Loss: 1.9209 | Train Acc: 0.2507
 Site-Southeast_Asian          | Train Loss: 1.8841 | Train Acc: 0.3225
 Site-Middle_Eastern           | Train Loss: 1.8399 | Train Acc: 0.2869
 Site-White                     (3) | Val  Loss: 1.9628 | Val  Acc: 0.3411
 Site-White                     (2) | Val  Loss: 1.7207 | Val  Acc: 0.4142
 Site-White                     (3) | Val  Loss: 1.7277 | Val  Acc: 0.3529
 Site-White                     (5) | Val  Loss: 1.7722 | Val  Acc: 0.3345
 Site-White                     (3) | Val  Loss: 1.7768 | Val  Acc: 0.3474
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8710 | Val  Acc: 0.2431
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8471 | Val  Acc: 0.2381
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8386 | Val  Acc: 0.3024
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8144 | Val  Acc: 0.2892
 Site-Black                     (1) | Val  Loss: 1.9392 | Val  Acc: 0.2326
 Site-Black                     (1) | Val  Loss: 1.8545 | Val  Acc: 0.2533
 Site-Black                     (1) | Val  Loss: 1.8785 | Val  Acc: 0.3051
 Site-East_Asian                (0) | Val  Loss: 1.7199 | Val  Acc: 0.4017
 Site-East_Asian                (4) | Val  Loss: 1.7139 | Val  Acc: 0.3779
 Site-Indian                    (6) | Val  Loss: 1.9040 | Val  Acc: 0.2529
 Site-Indian                    (6) | Val  Loss: 1.9534 | Val  Acc: 0.2314
 Site-Southeast_Asian           (0) | Val  Loss: 1.8715 | Val  Acc: 0.3182
 Site-Middle_Eastern            (2) | Val  Loss: 1.8743 | Val  Acc: 0.2863
Average Valid Accuracy: 0.3068
Aggregated Acc | Val Acc: 0.3163
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3411
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.4142
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3529
 Best site-White                    (5)  | Epoch:3 | Val Acc: 0.3345
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3474
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.2431
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.2381
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.3024
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.2892
 Best site-Black                    (1)  | Epoch:3 | Val Acc: 0.2326
 Best site-Black                    (1)  | Epoch:3 | Val Acc: 0.2533
 Best site-Black                    (1)  | Epoch:3 | Val Acc: 0.3051
 Best site-East_Asian               (0)  | Epoch:3 | Val Acc: 0.4017
 Best site-East_Asian               (4)  | Epoch:3 | Val Acc: 0.3779
 Best site-Indian                   (6)  | Epoch:3 | Val Acc: 0.2529
 Best site-Indian                   (6)  | Epoch:3 | Val Acc: 0.2314
 Best site-Southeast_Asian          (0)  | Epoch:3 | Val Acc: 0.3182
 Best site-Middle_Eastern           (2)  | Epoch:3 | Val Acc: 0.2863
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 3, 2, 2, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.08131, quan_i=1.89, quan_c=1.90
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.8197 | Train Acc: 0.3886
 Site-White                    | Train Loss: 1.7295 | Train Acc: 0.3661
 Site-White                    | Train Loss: 1.7223 | Train Acc: 0.3554
 Site-White                    | Train Loss: 1.7092 | Train Acc: 0.3647
 Site-White                    | Train Loss: 1.7058 | Train Acc: 0.3695
 Site-Latino_Hispanic          | Train Loss: 1.8352 | Train Acc: 0.2903
 Site-Latino_Hispanic          | Train Loss: 1.8013 | Train Acc: 0.3028
 Site-Latino_Hispanic          | Train Loss: 1.8221 | Train Acc: 0.3056
 Site-Latino_Hispanic          | Train Loss: 1.8096 | Train Acc: 0.2746
 Site-Black                    | Train Loss: 1.8773 | Train Acc: 0.2636
 Site-Black                    | Train Loss: 1.8828 | Train Acc: 0.3018
 Site-Black                    | Train Loss: 1.8832 | Train Acc: 0.2483
 Site-East_Asian               | Train Loss: 1.7057 | Train Acc: 0.3761
 Site-East_Asian               | Train Loss: 1.6889 | Train Acc: 0.4000
 Site-Indian                   | Train Loss: 1.9440 | Train Acc: 0.3015
 Site-Indian                   | Train Loss: 1.8806 | Train Acc: 0.2770
 Site-Southeast_Asian          | Train Loss: 1.8483 | Train Acc: 0.3333
 Site-Middle_Eastern           | Train Loss: 1.7982 | Train Acc: 0.3040
 Site-White                     (5) | Val  Loss: 1.8839 | Val  Acc: 0.3798
 Site-White                     (2) | Val  Loss: 1.7155 | Val  Acc: 0.4083
 Site-White                     (5) | Val  Loss: 1.6919 | Val  Acc: 0.3575
 Site-White                     (5) | Val  Loss: 1.7415 | Val  Acc: 0.3621
 Site-White                     (2) | Val  Loss: 1.7423 | Val  Acc: 0.3658
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8413 | Val  Acc: 0.2569
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8173 | Val  Acc: 0.2487
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8060 | Val  Acc: 0.3226
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7925 | Val  Acc: 0.3169
 Site-Black                     (1) | Val  Loss: 1.9323 | Val  Acc: 0.2384
 Site-Black                     (1) | Val  Loss: 1.8376 | Val  Acc: 0.2978
 Site-Black                     (1) | Val  Loss: 1.8543 | Val  Acc: 0.2949
 Site-East_Asian                (3) | Val  Loss: 1.6964 | Val  Acc: 0.4061
 Site-East_Asian                (3) | Val  Loss: 1.6840 | Val  Acc: 0.3746
 Site-Indian                    (4) | Val  Loss: 1.8740 | Val  Acc: 0.2989
 Site-Indian                    (4) | Val  Loss: 1.9119 | Val  Acc: 0.2402
 Site-Southeast_Asian           (4) | Val  Loss: 1.8211 | Val  Acc: 0.3474
 Site-Middle_Eastern            (5) | Val  Loss: 1.8095 | Val  Acc: 0.3120
Average Valid Accuracy: 0.3238
Aggregated Acc | Val Acc: 0.3215
 Best site-White                    (5)  | Epoch:4 | Val Acc: 0.3798
 Best site-White                    (2)  | Epoch:4 | Val Acc: 0.4083
 Best site-White                    (5)  | Epoch:4 | Val Acc: 0.3575
 Best site-White                    (5)  | Epoch:4 | Val Acc: 0.3621
 Best site-White                    (2)  | Epoch:4 | Val Acc: 0.3658
 Best site-Latino_Hispanic          (0)  | Epoch:4 | Val Acc: 0.2569
 Best site-Latino_Hispanic          (6)  | Epoch:4 | Val Acc: 0.2487
 Best site-Latino_Hispanic          (0)  | Epoch:4 | Val Acc: 0.3226
 Best site-Latino_Hispanic          (0)  | Epoch:4 | Val Acc: 0.3169
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.2384
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.2978
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.2949
 Best site-East_Asian               (3)  | Epoch:4 | Val Acc: 0.4061
 Best site-East_Asian               (3)  | Epoch:4 | Val Acc: 0.3746
 Best site-Indian                   (4)  | Epoch:4 | Val Acc: 0.2989
 Best site-Indian                   (4)  | Epoch:4 | Val Acc: 0.2402
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.3474
 Best site-Middle_Eastern           (5)  | Epoch:4 | Val Acc: 0.3120
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 2, 5, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.10052, quan_i=1.89, quan_c=1.87
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 12, 13, 16, 17, ]
 Site-White                    | Train Loss: 1.6150 | Train Acc: 0.3886
 Site-White                    | Train Loss: 1.7098 | Train Acc: 0.3622
 Site-White                    | Train Loss: 1.6795 | Train Acc: 0.3735
 Site-White                    | Train Loss: 1.6786 | Train Acc: 0.3922
 Site-White                    | Train Loss: 1.6889 | Train Acc: 0.3765
 Site-Latino_Hispanic          | Train Loss: 1.8285 | Train Acc: 0.2995
 Site-Latino_Hispanic          | Train Loss: 1.7492 | Train Acc: 0.3099
 Site-Latino_Hispanic          | Train Loss: 1.8014 | Train Acc: 0.3029
 Site-Latino_Hispanic          | Train Loss: 1.7673 | Train Acc: 0.2889
 Site-Black                    | Train Loss: 1.8884 | Train Acc: 0.2519
 Site-Black                    | Train Loss: 1.8572 | Train Acc: 0.3195
 Site-Black                    | Train Loss: 1.8560 | Train Acc: 0.2415
 Site-East_Asian               | Train Loss: 1.6639 | Train Acc: 0.4169
 Site-East_Asian               | Train Loss: 1.6032 | Train Acc: 0.4133
 Site-Indian                   | Train Loss: 1.8854 | Train Acc: 0.2939
 Site-Indian                   | Train Loss: 1.8478 | Train Acc: 0.2945
 Site-Southeast_Asian          | Train Loss: 1.8294 | Train Acc: 0.3290
 Site-Middle_Eastern           | Train Loss: 1.7567 | Train Acc: 0.3210
 Site-White                     (2) | Val  Loss: 1.8308 | Val  Acc: 0.4031
 Site-White                     (2) | Val  Loss: 1.6824 | Val  Acc: 0.4083
 Site-White                     (2) | Val  Loss: 1.6513 | Val  Acc: 0.4072
 Site-White                     (2) | Val  Loss: 1.7022 | Val  Acc: 0.3828
 Site-White                     (2) | Val  Loss: 1.7022 | Val  Acc: 0.3789
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8052 | Val  Acc: 0.2431
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7837 | Val  Acc: 0.2646
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7650 | Val  Acc: 0.3347
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7412 | Val  Acc: 0.3169
 Site-Black                     (0) | Val  Loss: 1.8699 | Val  Acc: 0.2500
 Site-Black                     (0) | Val  Loss: 1.8024 | Val  Acc: 0.2711
 Site-Black                     (0) | Val  Loss: 1.8412 | Val  Acc: 0.3051
 Site-East_Asian                (3) | Val  Loss: 1.6612 | Val  Acc: 0.4279
 Site-East_Asian                (3) | Val  Loss: 1.6568 | Val  Acc: 0.4348
 Site-Indian                    (4) | Val  Loss: 1.8213 | Val  Acc: 0.2989
 Site-Indian                    (4) | Val  Loss: 1.8798 | Val  Acc: 0.2707
 Site-Southeast_Asian           (6) | Val  Loss: 1.8144 | Val  Acc: 0.3312
 Site-Middle_Eastern            (5) | Val  Loss: 1.7786 | Val  Acc: 0.3419
Average Valid Accuracy: 0.3373
Aggregated Acc | Val Acc: 0.3336
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.4031
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.4083
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.4072
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.3828
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.3789
 Best site-Latino_Hispanic          (1)  | Epoch:5 | Val Acc: 0.2431
 Best site-Latino_Hispanic          (1)  | Epoch:5 | Val Acc: 0.2646
 Best site-Latino_Hispanic          (4)  | Epoch:5 | Val Acc: 0.3347
 Best site-Latino_Hispanic          (4)  | Epoch:5 | Val Acc: 0.3169
 Best site-Black                    (0)  | Epoch:5 | Val Acc: 0.2500
 Best site-Black                    (0)  | Epoch:5 | Val Acc: 0.2711
 Best site-Black                    (0)  | Epoch:5 | Val Acc: 0.3051
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.4279
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.4348
 Best site-Indian                   (4)  | Epoch:5 | Val Acc: 0.2989
 Best site-Indian                   (4)  | Epoch:5 | Val Acc: 0.2707
 Best site-Southeast_Asian          (6)  | Epoch:5 | Val Acc: 0.3312
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.3419
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 5, 2, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.08288, quan_i=1.87, quan_c=1.87
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 16, 17, ]
 Site-White                    | Train Loss: 1.4639 | Train Acc: 0.4093
 Site-White                    | Train Loss: 1.6407 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.7267 | Train Acc: 0.4006
 Site-White                    | Train Loss: 1.6311 | Train Acc: 0.4312
 Site-White                    | Train Loss: 1.6340 | Train Acc: 0.3958
 Site-Latino_Hispanic          | Train Loss: 1.7658 | Train Acc: 0.3410
 Site-Latino_Hispanic          | Train Loss: 1.7252 | Train Acc: 0.3134
 Site-Latino_Hispanic          | Train Loss: 1.7375 | Train Acc: 0.3217
 Site-Latino_Hispanic          | Train Loss: 1.7256 | Train Acc: 0.3074
 Site-Black                    | Train Loss: 1.8489 | Train Acc: 0.2946
 Site-Black                    | Train Loss: 1.7844 | Train Acc: 0.2988
 Site-Black                    | Train Loss: 1.8136 | Train Acc: 0.2664
 Site-East_Asian               | Train Loss: 1.6438 | Train Acc: 0.4052
 Site-East_Asian               | Train Loss: 1.5599 | Train Acc: 0.4378
 Site-Indian                   | Train Loss: 1.7662 | Train Acc: 0.3359
 Site-Indian                   | Train Loss: 1.7632 | Train Acc: 0.3178
 Site-Southeast_Asian          | Train Loss: 1.7604 | Train Acc: 0.3723
 Site-Middle_Eastern           | Train Loss: 1.7024 | Train Acc: 0.3608
 Site-White                     (2) | Val  Loss: 1.5213 | Val  Acc: 0.4341
 Site-White                     (2) | Val  Loss: 1.6424 | Val  Acc: 0.4260
 Site-White                     (1) | Val  Loss: 1.5765 | Val  Acc: 0.4208
 Site-White                     (2) | Val  Loss: 1.6453 | Val  Acc: 0.3862
 Site-White                     (2) | Val  Loss: 1.6657 | Val  Acc: 0.3895
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7274 | Val  Acc: 0.2917
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7382 | Val  Acc: 0.3016
 Site-Latino_Hispanic           (6) | Val  Loss: 1.7136 | Val  Acc: 0.3306
 Site-Latino_Hispanic           (6) | Val  Loss: 1.7091 | Val  Acc: 0.3415
 Site-Black                     (4) | Val  Loss: 1.8595 | Val  Acc: 0.2616
 Site-Black                     (3) | Val  Loss: 1.7607 | Val  Acc: 0.2889
 Site-Black                     (3) | Val  Loss: 1.7791 | Val  Acc: 0.3119
 Site-East_Asian                (1) | Val  Loss: 1.6181 | Val  Acc: 0.4192
 Site-East_Asian                (6) | Val  Loss: 1.6249 | Val  Acc: 0.4247
 Site-Indian                    (0) | Val  Loss: 1.7396 | Val  Acc: 0.3103
 Site-Indian                    (0) | Val  Loss: 1.8202 | Val  Acc: 0.2664
 Site-Southeast_Asian           (5) | Val  Loss: 1.7601 | Val  Acc: 0.3701
 Site-Middle_Eastern            (2) | Val  Loss: 1.7194 | Val  Acc: 0.4017
Average Valid Accuracy: 0.3543
Aggregated Acc | Val Acc: 0.3378
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.4341
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.4260
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4208
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.3862
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.3895
 Best site-Latino_Hispanic          (5)  | Epoch:6 | Val Acc: 0.2917
 Best site-Latino_Hispanic          (5)  | Epoch:6 | Val Acc: 0.3016
 Best site-Latino_Hispanic          (6)  | Epoch:6 | Val Acc: 0.3306
 Best site-Latino_Hispanic          (6)  | Epoch:6 | Val Acc: 0.3415
 Best site-Black                    (4)  | Epoch:6 | Val Acc: 0.2616
 Best site-Black                    (3)  | Epoch:6 | Val Acc: 0.2889
 Best site-Black                    (3)  | Epoch:6 | Val Acc: 0.3119
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.4192
 Best site-East_Asian               (6)  | Epoch:6 | Val Acc: 0.4247
 Best site-Indian                   (0)  | Epoch:6 | Val Acc: 0.3103
 Best site-Indian                   (0)  | Epoch:6 | Val Acc: 0.2664
 Best site-Southeast_Asian          (5)  | Epoch:6 | Val Acc: 0.3701
 Best site-Middle_Eastern           (2)  | Epoch:6 | Val Acc: 0.4017
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 2, 4, 3, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.06896, quan_i=1.79, quan_c=1.79
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.6584 | Train Acc: 0.3731
 Site-White                    | Train Loss: 1.5985 | Train Acc: 0.4331
 Site-White                    | Train Loss: 1.6153 | Train Acc: 0.3705
 Site-White                    | Train Loss: 1.5932 | Train Acc: 0.4427
 Site-White                    | Train Loss: 1.5828 | Train Acc: 0.4168
 Site-Latino_Hispanic          | Train Loss: 1.7525 | Train Acc: 0.3594
 Site-Latino_Hispanic          | Train Loss: 1.6978 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.7046 | Train Acc: 0.3298
 Site-Latino_Hispanic          | Train Loss: 1.6696 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.6975 | Train Acc: 0.3295
 Site-Black                    | Train Loss: 1.7452 | Train Acc: 0.3373
 Site-Black                    | Train Loss: 1.7649 | Train Acc: 0.2867
 Site-East_Asian               | Train Loss: 1.5851 | Train Acc: 0.3994
 Site-East_Asian               | Train Loss: 1.5988 | Train Acc: 0.4467
 Site-Indian                   | Train Loss: 1.6427 | Train Acc: 0.3779
 Site-Indian                   | Train Loss: 1.6505 | Train Acc: 0.3673
 Site-Southeast_Asian          | Train Loss: 1.7252 | Train Acc: 0.3831
 Site-Middle_Eastern           | Train Loss: 1.6252 | Train Acc: 0.4006
 Site-White                     (6) | Val  Loss: 1.4011 | Val  Acc: 0.4419
 Site-White                     (6) | Val  Loss: 1.5820 | Val  Acc: 0.4556
 Site-White                     (0) | Val  Loss: 1.5745 | Val  Acc: 0.4299
 Site-White                     (6) | Val  Loss: 1.6267 | Val  Acc: 0.4138
 Site-White                     (6) | Val  Loss: 1.6184 | Val  Acc: 0.4079
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6855 | Val  Acc: 0.3194
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7247 | Val  Acc: 0.3228
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6918 | Val  Acc: 0.3468
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6841 | Val  Acc: 0.3508
 Site-Black                     (3) | Val  Loss: 1.8124 | Val  Acc: 0.2674
 Site-Black                     (3) | Val  Loss: 1.7369 | Val  Acc: 0.2800
 Site-Black                     (3) | Val  Loss: 1.7281 | Val  Acc: 0.3525
 Site-East_Asian                (2) | Val  Loss: 1.5731 | Val  Acc: 0.4279
 Site-East_Asian                (2) | Val  Loss: 1.5663 | Val  Acc: 0.4281
 Site-Indian                    (1) | Val  Loss: 1.6794 | Val  Acc: 0.3333
 Site-Indian                    (1) | Val  Loss: 1.7111 | Val  Acc: 0.3406
 Site-Southeast_Asian           (2) | Val  Loss: 1.6380 | Val  Acc: 0.3864
 Site-Middle_Eastern            (5) | Val  Loss: 1.6493 | Val  Acc: 0.4145
Average Valid Accuracy: 0.3733
Aggregated Acc | Val Acc: 0.3773
 Best site-White                    (6)  | Epoch:7 | Val Acc: 0.4419
 Best site-White                    (6)  | Epoch:7 | Val Acc: 0.4556
 Best site-White                    (0)  | Epoch:7 | Val Acc: 0.4299
 Best site-White                    (6)  | Epoch:7 | Val Acc: 0.4138
 Best site-White                    (6)  | Epoch:7 | Val Acc: 0.4079
 Best site-Latino_Hispanic          (4)  | Epoch:7 | Val Acc: 0.3194
 Best site-Latino_Hispanic          (2)  | Epoch:7 | Val Acc: 0.3228
 Best site-Latino_Hispanic          (4)  | Epoch:7 | Val Acc: 0.3468
 Best site-Latino_Hispanic          (4)  | Epoch:7 | Val Acc: 0.3508
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.2674
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.2800
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.3525
 Best site-East_Asian               (2)  | Epoch:7 | Val Acc: 0.4279
 Best site-East_Asian               (2)  | Epoch:7 | Val Acc: 0.4281
 Best site-Indian                   (1)  | Epoch:7 | Val Acc: 0.3333
 Best site-Indian                   (1)  | Epoch:7 | Val Acc: 0.3406
 Best site-Southeast_Asian          (2)  | Epoch:7 | Val Acc: 0.3864
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.4145
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 2, 5, 3, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.08219, quan_i=1.74, quan_c=1.72
minimize weight of clients:[0, 1, 2, 3, 4, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.3163 | Train Acc: 0.4301
 Site-White                    | Train Loss: 1.5407 | Train Acc: 0.4291
 Site-White                    | Train Loss: 1.5660 | Train Acc: 0.3916
 Site-White                    | Train Loss: 1.5342 | Train Acc: 0.4220
 Site-White                    | Train Loss: 1.5486 | Train Acc: 0.4098
 Site-Latino_Hispanic          | Train Loss: 1.6214 | Train Acc: 0.3456
 Site-Latino_Hispanic          | Train Loss: 1.6403 | Train Acc: 0.3521
 Site-Latino_Hispanic          | Train Loss: 1.6604 | Train Acc: 0.3566
 Site-Latino_Hispanic          | Train Loss: 1.6156 | Train Acc: 0.3484
 Site-Black                    | Train Loss: 1.6543 | Train Acc: 0.2907
 Site-Black                    | Train Loss: 1.7112 | Train Acc: 0.3550
 Site-Black                    | Train Loss: 1.7551 | Train Acc: 0.2889
 Site-East_Asian               | Train Loss: 1.5217 | Train Acc: 0.4082
 Site-East_Asian               | Train Loss: 1.3883 | Train Acc: 0.4578
 Site-Indian                   | Train Loss: 1.6156 | Train Acc: 0.4046
 Site-Indian                   | Train Loss: 1.6256 | Train Acc: 0.3732
 Site-Southeast_Asian          | Train Loss: 1.6369 | Train Acc: 0.4091
 Site-Middle_Eastern           | Train Loss: 1.5733 | Train Acc: 0.4205
 Site-White                     (2) | Val  Loss: 1.6038 | Val  Acc: 0.4186
 Site-White                     (2) | Val  Loss: 1.5252 | Val  Acc: 0.4556
 Site-White                     (2) | Val  Loss: 1.5178 | Val  Acc: 0.4751
 Site-White                     (2) | Val  Loss: 1.5615 | Val  Acc: 0.4000
 Site-White                     (2) | Val  Loss: 1.5790 | Val  Acc: 0.4079
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6787 | Val  Acc: 0.3056
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6460 | Val  Acc: 0.3333
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6602 | Val  Acc: 0.3710
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6891 | Val  Acc: 0.3692
 Site-Black                     (6) | Val  Loss: 1.7803 | Val  Acc: 0.2907
 Site-Black                     (1) | Val  Loss: 1.7010 | Val  Acc: 0.3156
 Site-Black                     (1) | Val  Loss: 1.6917 | Val  Acc: 0.3559
 Site-East_Asian                (3) | Val  Loss: 1.5106 | Val  Acc: 0.4498
 Site-East_Asian                (3) | Val  Loss: 1.5290 | Val  Acc: 0.4314
 Site-Indian                    (5) | Val  Loss: 1.6408 | Val  Acc: 0.3678
 Site-Indian                    (5) | Val  Loss: 1.7040 | Val  Acc: 0.3188
 Site-Southeast_Asian           (3) | Val  Loss: 1.6175 | Val  Acc: 0.4026
 Site-Middle_Eastern            (0) | Val  Loss: 1.6030 | Val  Acc: 0.4060
Average Valid Accuracy: 0.3819
Aggregated Acc | Val Acc: 0.3686
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4186
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4556
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4751
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4000
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4079
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.3056
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.3333
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.3710
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.3692
 Best site-Black                    (6)  | Epoch:8 | Val Acc: 0.2907
 Best site-Black                    (1)  | Epoch:8 | Val Acc: 0.3156
 Best site-Black                    (1)  | Epoch:8 | Val Acc: 0.3559
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4498
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4314
 Best site-Indian                   (5)  | Epoch:8 | Val Acc: 0.3678
 Best site-Indian                   (5)  | Epoch:8 | Val Acc: 0.3188
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.4026
 Best site-Middle_Eastern           (0)  | Epoch:8 | Val Acc: 0.4060
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 3, 2, 4, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.05879, quan_i=1.67, quan_c=1.65
minimize weight of clients:[0, 1, 2, 3, 4, 5, 12, 13, 14, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.3111 | Train Acc: 0.4404
 Site-White                    | Train Loss: 1.5258 | Train Acc: 0.4409
 Site-White                    | Train Loss: 1.5591 | Train Acc: 0.3855
 Site-White                    | Train Loss: 1.5327 | Train Acc: 0.4358
 Site-White                    | Train Loss: 1.5296 | Train Acc: 0.4028
 Site-Latino_Hispanic          | Train Loss: 1.6632 | Train Acc: 0.3364
 Site-Latino_Hispanic          | Train Loss: 1.5968 | Train Acc: 0.3768
 Site-Latino_Hispanic          | Train Loss: 1.6177 | Train Acc: 0.3673
 Site-Latino_Hispanic          | Train Loss: 1.5940 | Train Acc: 0.3811
 Site-Black                    | Train Loss: 1.6130 | Train Acc: 0.3256
 Site-Black                    | Train Loss: 1.6611 | Train Acc: 0.3580
 Site-Black                    | Train Loss: 1.6907 | Train Acc: 0.3205
 Site-East_Asian               | Train Loss: 1.5229 | Train Acc: 0.4373
 Site-East_Asian               | Train Loss: 1.4678 | Train Acc: 0.4467
 Site-Indian                   | Train Loss: 1.6645 | Train Acc: 0.3931
 Site-Indian                   | Train Loss: 1.6191 | Train Acc: 0.3819
 Site-Southeast_Asian          | Train Loss: 1.6605 | Train Acc: 0.4048
 Site-Middle_Eastern           | Train Loss: 1.5476 | Train Acc: 0.4006
 Site-White                     (4) | Val  Loss: 1.5467 | Val  Acc: 0.3876
 Site-White                     (4) | Val  Loss: 1.5304 | Val  Acc: 0.4260
 Site-White                     (4) | Val  Loss: 1.5187 | Val  Acc: 0.4434
 Site-White                     (5) | Val  Loss: 1.5457 | Val  Acc: 0.4000
 Site-White                     (4) | Val  Loss: 1.5574 | Val  Acc: 0.4079
 Site-Latino_Hispanic           (3) | Val  Loss: 1.6076 | Val  Acc: 0.3750
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5991 | Val  Acc: 0.3810
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5842 | Val  Acc: 0.4032
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5897 | Val  Acc: 0.3662
 Site-Black                     (1) | Val  Loss: 1.7154 | Val  Acc: 0.2965
 Site-Black                     (1) | Val  Loss: 1.6587 | Val  Acc: 0.3333
 Site-Black                     (1) | Val  Loss: 1.6448 | Val  Acc: 0.3627
 Site-East_Asian                (6) | Val  Loss: 1.5014 | Val  Acc: 0.4498
 Site-East_Asian                (6) | Val  Loss: 1.5161 | Val  Acc: 0.4314
 Site-Indian                    (3) | Val  Loss: 1.6157 | Val  Acc: 0.3621
 Site-Indian                    (3) | Val  Loss: 1.7194 | Val  Acc: 0.3144
 Site-Southeast_Asian           (6) | Val  Loss: 1.6206 | Val  Acc: 0.3994
 Site-Middle_Eastern            (0) | Val  Loss: 1.5883 | Val  Acc: 0.3889
Average Valid Accuracy: 0.3849
Aggregated Acc | Val Acc: 0.3865
 Best site-White                    (4)  | Epoch:9 | Val Acc: 0.3876
 Best site-White                    (4)  | Epoch:9 | Val Acc: 0.4260
 Best site-White                    (4)  | Epoch:9 | Val Acc: 0.4434
 Best site-White                    (5)  | Epoch:9 | Val Acc: 0.4000
 Best site-White                    (4)  | Epoch:9 | Val Acc: 0.4079
 Best site-Latino_Hispanic          (3)  | Epoch:9 | Val Acc: 0.3750
 Best site-Latino_Hispanic          (3)  | Epoch:9 | Val Acc: 0.3810
 Best site-Latino_Hispanic          (2)  | Epoch:9 | Val Acc: 0.4032
 Best site-Latino_Hispanic          (2)  | Epoch:9 | Val Acc: 0.3662
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.2965
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.3333
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.3627
 Best site-East_Asian               (6)  | Epoch:9 | Val Acc: 0.4498
 Best site-East_Asian               (6)  | Epoch:9 | Val Acc: 0.4314
 Best site-Indian                   (3)  | Epoch:9 | Val Acc: 0.3621
 Best site-Indian                   (3)  | Epoch:9 | Val Acc: 0.3144
 Best site-Southeast_Asian          (6)  | Epoch:9 | Val Acc: 0.3994
 Best site-Middle_Eastern           (0)  | Epoch:9 | Val Acc: 0.3889
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:9 | Test Acc: 0.3636
 Test site-Latino_Hispanic          | Epoch:9 | Test Acc: 0.3323
 Test site-Black                    | Epoch:9 | Test Acc: 0.3000
 Test site-East_Asian               | Epoch:9 | Test Acc: 0.4221
 Test site-Indian                   | Epoch:9 | Test Acc: 0.3254
 Test site-Southeast_Asian          | Epoch:9 | Test Acc: 0.3926
 Test site-Middle_Eastern           | Epoch:9 | Test Acc: 0.3918
Average Test Accuracy: 0.3611, domain std=0.0405, individual std=0.0371
============ Train epoch 10 ============
cnt=[1, 4, 3, 6, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.05746, quan_i=1.67, quan_c=1.65
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 15, 17, ]
 Site-White                    | Train Loss: 1.6360 | Train Acc: 0.4663
 Site-White                    | Train Loss: 1.4966 | Train Acc: 0.4488
 Site-White                    | Train Loss: 1.5339 | Train Acc: 0.4036
 Site-White                    | Train Loss: 1.4996 | Train Acc: 0.4450
 Site-White                    | Train Loss: 1.4888 | Train Acc: 0.4326
 Site-Latino_Hispanic          | Train Loss: 1.6382 | Train Acc: 0.3548
 Site-Latino_Hispanic          | Train Loss: 1.5804 | Train Acc: 0.3732
 Site-Latino_Hispanic          | Train Loss: 1.6035 | Train Acc: 0.3566
 Site-Latino_Hispanic          | Train Loss: 1.5747 | Train Acc: 0.3873
 Site-Black                    | Train Loss: 1.7359 | Train Acc: 0.3217
 Site-Black                    | Train Loss: 1.6293 | Train Acc: 0.3698
 Site-Black                    | Train Loss: 1.6898 | Train Acc: 0.2957
 Site-East_Asian               | Train Loss: 1.5047 | Train Acc: 0.4286
 Site-East_Asian               | Train Loss: 1.3912 | Train Acc: 0.4800
 Site-Indian                   | Train Loss: 1.5608 | Train Acc: 0.4008
 Site-Indian                   | Train Loss: 1.6037 | Train Acc: 0.3703
 Site-Southeast_Asian          | Train Loss: 1.6371 | Train Acc: 0.4567
 Site-Middle_Eastern           | Train Loss: 1.5303 | Train Acc: 0.3977
 Site-White                     (1) | Val  Loss: 1.5307 | Val  Acc: 0.3798
 Site-White                     (1) | Val  Loss: 1.4923 | Val  Acc: 0.4556
 Site-White                     (1) | Val  Loss: 1.4646 | Val  Acc: 0.4525
 Site-White                     (5) | Val  Loss: 1.5259 | Val  Acc: 0.4103
 Site-White                     (1) | Val  Loss: 1.5233 | Val  Acc: 0.4026
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5948 | Val  Acc: 0.3472
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5684 | Val  Acc: 0.3862
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5831 | Val  Acc: 0.3911
 Site-Latino_Hispanic           (3) | Val  Loss: 1.6157 | Val  Acc: 0.3723
 Site-Black                     (2) | Val  Loss: 1.7098 | Val  Acc: 0.3256
 Site-Black                     (2) | Val  Loss: 1.6367 | Val  Acc: 0.3600
 Site-Black                     (2) | Val  Loss: 1.6414 | Val  Acc: 0.3356
 Site-East_Asian                (4) | Val  Loss: 1.4581 | Val  Acc: 0.4410
 Site-East_Asian                (4) | Val  Loss: 1.4822 | Val  Acc: 0.4515
 Site-Indian                    (3) | Val  Loss: 1.6087 | Val  Acc: 0.3333
 Site-Indian                    (3) | Val  Loss: 1.6863 | Val  Acc: 0.3537
 Site-Southeast_Asian           (0) | Val  Loss: 1.5953 | Val  Acc: 0.4123
 Site-Middle_Eastern            (6) | Val  Loss: 1.5392 | Val  Acc: 0.4231
Average Valid Accuracy: 0.3908
Aggregated Acc | Val Acc: 0.4027
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.3798
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.4556
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.4525
 Best site-White                    (5)  | Epoch:10 | Val Acc: 0.4103
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.4026
 Best site-Latino_Hispanic          (3)  | Epoch:10 | Val Acc: 0.3472
 Best site-Latino_Hispanic          (3)  | Epoch:10 | Val Acc: 0.3862
 Best site-Latino_Hispanic          (3)  | Epoch:10 | Val Acc: 0.3911
 Best site-Latino_Hispanic          (3)  | Epoch:10 | Val Acc: 0.3723
 Best site-Black                    (2)  | Epoch:10 | Val Acc: 0.3256
 Best site-Black                    (2)  | Epoch:10 | Val Acc: 0.3600
 Best site-Black                    (2)  | Epoch:10 | Val Acc: 0.3356
 Best site-East_Asian               (4)  | Epoch:10 | Val Acc: 0.4410
 Best site-East_Asian               (4)  | Epoch:10 | Val Acc: 0.4515
 Best site-Indian                   (3)  | Epoch:10 | Val Acc: 0.3333
 Best site-Indian                   (3)  | Epoch:10 | Val Acc: 0.3537
 Best site-Southeast_Asian          (0)  | Epoch:10 | Val Acc: 0.4123
 Best site-Middle_Eastern           (6)  | Epoch:10 | Val Acc: 0.4231
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 6, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.07706, quan_i=1.64, quan_c=1.62
minimize weight of clients:[1, 2, 3, 4, 6, 7, 8, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.3127 | Train Acc: 0.4508
 Site-White                    | Train Loss: 1.4808 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.5576 | Train Acc: 0.3946
 Site-White                    | Train Loss: 1.4741 | Train Acc: 0.4702
 Site-White                    | Train Loss: 1.4699 | Train Acc: 0.4326
 Site-Latino_Hispanic          | Train Loss: 1.6217 | Train Acc: 0.3641
 Site-Latino_Hispanic          | Train Loss: 1.5983 | Train Acc: 0.3768
 Site-Latino_Hispanic          | Train Loss: 1.5856 | Train Acc: 0.3887
 Site-Latino_Hispanic          | Train Loss: 1.5669 | Train Acc: 0.3586
 Site-Black                    | Train Loss: 1.7606 | Train Acc: 0.3217
 Site-Black                    | Train Loss: 1.6356 | Train Acc: 0.3609
 Site-Black                    | Train Loss: 1.6534 | Train Acc: 0.3634
 Site-East_Asian               | Train Loss: 1.4998 | Train Acc: 0.4227
 Site-East_Asian               | Train Loss: 1.4653 | Train Acc: 0.4578
 Site-Indian                   | Train Loss: 1.4718 | Train Acc: 0.3855
 Site-Indian                   | Train Loss: 1.5790 | Train Acc: 0.3615
 Site-Southeast_Asian          | Train Loss: 1.5748 | Train Acc: 0.4524
 Site-Middle_Eastern           | Train Loss: 1.4798 | Train Acc: 0.4148
 Site-White                     (2) | Val  Loss: 1.3313 | Val  Acc: 0.4109
 Site-White                     (2) | Val  Loss: 1.5132 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.4448 | Val  Acc: 0.4480
 Site-White                     (2) | Val  Loss: 1.5145 | Val  Acc: 0.4000
 Site-White                     (2) | Val  Loss: 1.4908 | Val  Acc: 0.4368
 Site-Latino_Hispanic           (5) | Val  Loss: 1.6134 | Val  Acc: 0.3611
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5658 | Val  Acc: 0.3757
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5805 | Val  Acc: 0.3871
 Site-Latino_Hispanic           (5) | Val  Loss: 1.6016 | Val  Acc: 0.3723
 Site-Black                     (3) | Val  Loss: 1.7183 | Val  Acc: 0.2907
 Site-Black                     (1) | Val  Loss: 1.6102 | Val  Acc: 0.3644
 Site-Black                     (1) | Val  Loss: 1.6470 | Val  Acc: 0.3932
 Site-East_Asian                (0) | Val  Loss: 1.4412 | Val  Acc: 0.4716
 Site-East_Asian                (0) | Val  Loss: 1.4712 | Val  Acc: 0.4582
 Site-Indian                    (6) | Val  Loss: 1.5568 | Val  Acc: 0.3736
 Site-Indian                    (6) | Val  Loss: 1.6529 | Val  Acc: 0.3581
 Site-Southeast_Asian           (4) | Val  Loss: 1.5629 | Val  Acc: 0.4221
 Site-Middle_Eastern            (2) | Val  Loss: 1.5305 | Val  Acc: 0.4274
Average Valid Accuracy: 0.4007
Aggregated Acc | Val Acc: 0.3896
 Best site-White                    (2)  | Epoch:11 | Val Acc: 0.4109
 Best site-White                    (2)  | Epoch:11 | Val Acc: 0.4615
 Best site-White                    (2)  | Epoch:11 | Val Acc: 0.4480
 Best site-White                    (2)  | Epoch:11 | Val Acc: 0.4000
 Best site-White                    (2)  | Epoch:11 | Val Acc: 0.4368
 Best site-Latino_Hispanic          (5)  | Epoch:11 | Val Acc: 0.3611
 Best site-Latino_Hispanic          (5)  | Epoch:11 | Val Acc: 0.3757
 Best site-Latino_Hispanic          (5)  | Epoch:11 | Val Acc: 0.3871
 Best site-Latino_Hispanic          (5)  | Epoch:11 | Val Acc: 0.3723
 Best site-Black                    (3)  | Epoch:11 | Val Acc: 0.2907
 Best site-Black                    (1)  | Epoch:11 | Val Acc: 0.3644
 Best site-Black                    (1)  | Epoch:11 | Val Acc: 0.3932
 Best site-East_Asian               (0)  | Epoch:11 | Val Acc: 0.4716
 Best site-East_Asian               (0)  | Epoch:11 | Val Acc: 0.4582
 Best site-Indian                   (6)  | Epoch:11 | Val Acc: 0.3736
 Best site-Indian                   (6)  | Epoch:11 | Val Acc: 0.3581
 Best site-Southeast_Asian          (4)  | Epoch:11 | Val Acc: 0.4221
 Best site-Middle_Eastern           (2)  | Epoch:11 | Val Acc: 0.4274
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 12 ============
cnt=[5, 3, 3, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.05699, quan_i=1.63, quan_c=1.61
minimize weight of clients:[0, 1, 2, 3, 4, 7, 8, 12, 13, 14, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.5339 | Train Acc: 0.4093
 Site-White                    | Train Loss: 1.4641 | Train Acc: 0.4528
 Site-White                    | Train Loss: 1.5301 | Train Acc: 0.4127
 Site-White                    | Train Loss: 1.4725 | Train Acc: 0.4541
 Site-White                    | Train Loss: 1.4690 | Train Acc: 0.4151
 Site-Latino_Hispanic          | Train Loss: 1.6162 | Train Acc: 0.3456
 Site-Latino_Hispanic          | Train Loss: 1.5552 | Train Acc: 0.3838
 Site-Latino_Hispanic          | Train Loss: 1.5847 | Train Acc: 0.3807
 Site-Latino_Hispanic          | Train Loss: 1.5258 | Train Acc: 0.3873
 Site-Black                    | Train Loss: 1.4993 | Train Acc: 0.3256
 Site-Black                    | Train Loss: 1.5967 | Train Acc: 0.3846
 Site-Black                    | Train Loss: 1.6438 | Train Acc: 0.3431
 Site-East_Asian               | Train Loss: 1.4822 | Train Acc: 0.4140
 Site-East_Asian               | Train Loss: 1.4430 | Train Acc: 0.4644
 Site-Indian                   | Train Loss: 1.5617 | Train Acc: 0.4122
 Site-Indian                   | Train Loss: 1.5244 | Train Acc: 0.3965
 Site-Southeast_Asian          | Train Loss: 1.6096 | Train Acc: 0.4416
 Site-Middle_Eastern           | Train Loss: 1.5014 | Train Acc: 0.4148
 Site-White                     (0) | Val  Loss: 1.4901 | Val  Acc: 0.4109
 Site-White                     (0) | Val  Loss: 1.5057 | Val  Acc: 0.4793
 Site-White                     (0) | Val  Loss: 1.4604 | Val  Acc: 0.4706
 Site-White                     (0) | Val  Loss: 1.5104 | Val  Acc: 0.4276
 Site-White                     (0) | Val  Loss: 1.4995 | Val  Acc: 0.4395
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5826 | Val  Acc: 0.3542
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5461 | Val  Acc: 0.4021
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5413 | Val  Acc: 0.4153
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5535 | Val  Acc: 0.3846
 Site-Black                     (2) | Val  Loss: 1.6953 | Val  Acc: 0.3430
 Site-Black                     (2) | Val  Loss: 1.5928 | Val  Acc: 0.3556
 Site-Black                     (2) | Val  Loss: 1.6019 | Val  Acc: 0.3695
 Site-East_Asian                (4) | Val  Loss: 1.4332 | Val  Acc: 0.4847
 Site-East_Asian                (4) | Val  Loss: 1.4698 | Val  Acc: 0.4615
 Site-Indian                    (1) | Val  Loss: 1.5725 | Val  Acc: 0.3391
 Site-Indian                    (1) | Val  Loss: 1.6356 | Val  Acc: 0.3581
 Site-Southeast_Asian           (4) | Val  Loss: 1.5691 | Val  Acc: 0.4156
 Site-Middle_Eastern            (6) | Val  Loss: 1.5088 | Val  Acc: 0.4231
Average Valid Accuracy: 0.4075
Aggregated Acc | Val Acc: 0.4030
 Best site-White                    (0)  | Epoch:12 | Val Acc: 0.4109
 Best site-White                    (0)  | Epoch:12 | Val Acc: 0.4793
 Best site-White                    (0)  | Epoch:12 | Val Acc: 0.4706
 Best site-White                    (0)  | Epoch:12 | Val Acc: 0.4276
 Best site-White                    (0)  | Epoch:12 | Val Acc: 0.4395
 Best site-Latino_Hispanic          (5)  | Epoch:12 | Val Acc: 0.3542
 Best site-Latino_Hispanic          (3)  | Epoch:12 | Val Acc: 0.4021
 Best site-Latino_Hispanic          (1)  | Epoch:12 | Val Acc: 0.4153
 Best site-Latino_Hispanic          (5)  | Epoch:12 | Val Acc: 0.3846
 Best site-Black                    (2)  | Epoch:12 | Val Acc: 0.3430
 Best site-Black                    (2)  | Epoch:12 | Val Acc: 0.3556
 Best site-Black                    (2)  | Epoch:12 | Val Acc: 0.3695
 Best site-East_Asian               (4)  | Epoch:12 | Val Acc: 0.4847
 Best site-East_Asian               (4)  | Epoch:12 | Val Acc: 0.4615
 Best site-Indian                   (1)  | Epoch:12 | Val Acc: 0.3391
 Best site-Indian                   (1)  | Epoch:12 | Val Acc: 0.3581
 Best site-Southeast_Asian          (4)  | Epoch:12 | Val Acc: 0.4156
 Best site-Middle_Eastern           (6)  | Epoch:12 | Val Acc: 0.4231
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 1, 3, 6, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.06997, quan_i=1.60, quan_c=1.61
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.2613 | Train Acc: 0.4663
 Site-White                    | Train Loss: 1.4476 | Train Acc: 0.4567
 Site-White                    | Train Loss: 1.5107 | Train Acc: 0.4247
 Site-White                    | Train Loss: 1.4454 | Train Acc: 0.4541
 Site-White                    | Train Loss: 1.4429 | Train Acc: 0.4361
 Site-Latino_Hispanic          | Train Loss: 1.5952 | Train Acc: 0.3502
 Site-Latino_Hispanic          | Train Loss: 1.5355 | Train Acc: 0.3979
 Site-Latino_Hispanic          | Train Loss: 1.5797 | Train Acc: 0.3995
 Site-Latino_Hispanic          | Train Loss: 1.5176 | Train Acc: 0.3914
 Site-Black                    | Train Loss: 1.6654 | Train Acc: 0.3062
 Site-Black                    | Train Loss: 1.6362 | Train Acc: 0.3876
 Site-Black                    | Train Loss: 1.6404 | Train Acc: 0.3679
 Site-East_Asian               | Train Loss: 1.4286 | Train Acc: 0.4140
 Site-East_Asian               | Train Loss: 1.3354 | Train Acc: 0.4711
 Site-Indian                   | Train Loss: 1.5901 | Train Acc: 0.4122
 Site-Indian                   | Train Loss: 1.5673 | Train Acc: 0.3907
 Site-Southeast_Asian          | Train Loss: 1.5313 | Train Acc: 0.4416
 Site-Middle_Eastern           | Train Loss: 1.4505 | Train Acc: 0.4659
 Site-White                     (3) | Val  Loss: 1.2934 | Val  Acc: 0.4031
 Site-White                     (3) | Val  Loss: 1.4558 | Val  Acc: 0.4970
 Site-White                     (3) | Val  Loss: 1.4290 | Val  Acc: 0.4842
 Site-White                     (3) | Val  Loss: 1.4671 | Val  Acc: 0.3966
 Site-White                     (3) | Val  Loss: 1.4737 | Val  Acc: 0.4368
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5331 | Val  Acc: 0.3611
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5444 | Val  Acc: 0.3704
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5433 | Val  Acc: 0.3911
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5372 | Val  Acc: 0.3785
 Site-Black                     (2) | Val  Loss: 1.6536 | Val  Acc: 0.2907
 Site-Black                     (2) | Val  Loss: 1.6281 | Val  Acc: 0.3511
 Site-Black                     (2) | Val  Loss: 1.5960 | Val  Acc: 0.4034
 Site-East_Asian                (0) | Val  Loss: 1.4020 | Val  Acc: 0.4629
 Site-East_Asian                (0) | Val  Loss: 1.4622 | Val  Acc: 0.4649
 Site-Indian                    (6) | Val  Loss: 1.5542 | Val  Acc: 0.3563
 Site-Indian                    (6) | Val  Loss: 1.6134 | Val  Acc: 0.3712
 Site-Southeast_Asian           (4) | Val  Loss: 1.5371 | Val  Acc: 0.4123
 Site-Middle_Eastern            (3) | Val  Loss: 1.5095 | Val  Acc: 0.3974
Average Valid Accuracy: 0.4016
Aggregated Acc | Val Acc: 0.3968
============ Train epoch 14 ============
cnt=[2, 2, 5, 3, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.05305, quan_i=1.61, quan_c=1.60
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 16, 17, ]
 Site-White                    | Train Loss: 1.5401 | Train Acc: 0.4611
 Site-White                    | Train Loss: 1.4538 | Train Acc: 0.4528
 Site-White                    | Train Loss: 1.4464 | Train Acc: 0.4096
 Site-White                    | Train Loss: 1.4797 | Train Acc: 0.4450
 Site-White                    | Train Loss: 1.4504 | Train Acc: 0.4186
 Site-Latino_Hispanic          | Train Loss: 1.5803 | Train Acc: 0.3825
 Site-Latino_Hispanic          | Train Loss: 1.5342 | Train Acc: 0.3873
 Site-Latino_Hispanic          | Train Loss: 1.5694 | Train Acc: 0.3861
 Site-Latino_Hispanic          | Train Loss: 1.4991 | Train Acc: 0.4016
 Site-Black                    | Train Loss: 1.8932 | Train Acc: 0.3372
 Site-Black                    | Train Loss: 1.5817 | Train Acc: 0.4142
 Site-Black                    | Train Loss: 1.5893 | Train Acc: 0.3860
 Site-East_Asian               | Train Loss: 1.4561 | Train Acc: 0.4286
 Site-East_Asian               | Train Loss: 1.4029 | Train Acc: 0.4644
 Site-Indian                   | Train Loss: 1.6630 | Train Acc: 0.4275
 Site-Indian                   | Train Loss: 1.5293 | Train Acc: 0.3994
 Site-Southeast_Asian          | Train Loss: 1.5507 | Train Acc: 0.4459
 Site-Middle_Eastern           | Train Loss: 1.4815 | Train Acc: 0.4403
 Site-White                     (1) | Val  Loss: 1.3924 | Val  Acc: 0.4109
 Site-White                     (5) | Val  Loss: 1.4651 | Val  Acc: 0.4675
 Site-White                     (1) | Val  Loss: 1.4591 | Val  Acc: 0.4661
 Site-White                     (5) | Val  Loss: 1.4576 | Val  Acc: 0.4069
 Site-White                     (5) | Val  Loss: 1.4744 | Val  Acc: 0.4316
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5001 | Val  Acc: 0.3750
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5159 | Val  Acc: 0.4127
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5135 | Val  Acc: 0.3790
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5298 | Val  Acc: 0.3631
 Site-Black                     (3) | Val  Loss: 1.6461 | Val  Acc: 0.3430
 Site-Black                     (3) | Val  Loss: 1.5808 | Val  Acc: 0.3644
 Site-Black                     (3) | Val  Loss: 1.5585 | Val  Acc: 0.3966
 Site-East_Asian                (4) | Val  Loss: 1.4112 | Val  Acc: 0.4629
 Site-East_Asian                (4) | Val  Loss: 1.4591 | Val  Acc: 0.4482
 Site-Indian                    (0) | Val  Loss: 1.5050 | Val  Acc: 0.3448
 Site-Indian                    (0) | Val  Loss: 1.6194 | Val  Acc: 0.3668
 Site-Southeast_Asian           (2) | Val  Loss: 1.5272 | Val  Acc: 0.4545
 Site-Middle_Eastern            (6) | Val  Loss: 1.5033 | Val  Acc: 0.4316
Average Valid Accuracy: 0.4070
Aggregated Acc | Val Acc: 0.4117
============ Train epoch 15 ============
cnt=[2, 3, 3, 2, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
min_w=0.07099, quan_i=1.59, quan_c=1.58
minimize weight of clients:[0, 1, 2, 3, 4, 6, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.1464 | Train Acc: 0.4508
 Site-White                    | Train Loss: 1.4374 | Train Acc: 0.4606
 Site-White                    | Train Loss: 1.5612 | Train Acc: 0.4217
 Site-White                    | Train Loss: 1.4429 | Train Acc: 0.4427
 Site-White                    | Train Loss: 1.4435 | Train Acc: 0.4238
 Site-Latino_Hispanic          | Train Loss: 1.5654 | Train Acc: 0.3871
 Site-Latino_Hispanic          | Train Loss: 1.5320 | Train Acc: 0.3556
 Site-Latino_Hispanic          | Train Loss: 1.5471 | Train Acc: 0.3700
 Site-Latino_Hispanic          | Train Loss: 1.5070 | Train Acc: 0.3934
 Site-Black                    | Train Loss: 1.6416 | Train Acc: 0.3256
 Site-Black                    | Train Loss: 1.5984 | Train Acc: 0.4201
 Site-Black                    | Train Loss: 1.6032 | Train Acc: 0.3499
 Site-East_Asian               | Train Loss: 1.4525 | Train Acc: 0.4461
 Site-East_Asian               | Train Loss: 1.4207 | Train Acc: 0.4778
 Site-Indian                   | Train Loss: 1.4662 | Train Acc: 0.4160
 Site-Indian                   | Train Loss: 1.4833 | Train Acc: 0.3819
 Site-Southeast_Asian          | Train Loss: 1.5539 | Train Acc: 0.4567
 Site-Middle_Eastern           | Train Loss: 1.4507 | Train Acc: 0.4489
 Site-White                     (0) | Val  Loss: 1.2960 | Val  Acc: 0.4186
 Site-White                     (5) | Val  Loss: 1.4363 | Val  Acc: 0.4970
 Site-White                     (5) | Val  Loss: 1.4579 | Val  Acc: 0.4570
 Site-White                     (5) | Val  Loss: 1.4623 | Val  Acc: 0.4000
 Site-White                     (0) | Val  Loss: 1.4590 | Val  Acc: 0.4368
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4990 | Val  Acc: 0.3750
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4907 | Val  Acc: 0.4021
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4978 | Val  Acc: 0.3911
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5124 | Val  Acc: 0.3569
 Site-Black                     (2) | Val  Loss: 1.6516 | Val  Acc: 0.3081
 Site-Black                     (2) | Val  Loss: 1.5333 | Val  Acc: 0.3911
 Site-Black                     (2) | Val  Loss: 1.5736 | Val  Acc: 0.4102
 Site-East_Asian                (3) | Val  Loss: 1.4021 | Val  Acc: 0.4847
 Site-East_Asian                (3) | Val  Loss: 1.4404 | Val  Acc: 0.4448
 Site-Indian                    (1) | Val  Loss: 1.5174 | Val  Acc: 0.3678
 Site-Indian                    (1) | Val  Loss: 1.5864 | Val  Acc: 0.3755
 Site-Southeast_Asian           (1) | Val  Loss: 1.5100 | Val  Acc: 0.4513
 Site-Middle_Eastern            (6) | Val  Loss: 1.5181 | Val  Acc: 0.4274
Average Valid Accuracy: 0.4109
Aggregated Acc | Val Acc: 0.4172
 Best site-White                    (0)  | Epoch:15 | Val Acc: 0.4186
 Best site-White                    (5)  | Epoch:15 | Val Acc: 0.4970
 Best site-White                    (5)  | Epoch:15 | Val Acc: 0.4570
 Best site-White                    (5)  | Epoch:15 | Val Acc: 0.4000
 Best site-White                    (0)  | Epoch:15 | Val Acc: 0.4368
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.3750
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.4021
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.3911
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.3569
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.3081
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.3911
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.4102
 Best site-East_Asian               (3)  | Epoch:15 | Val Acc: 0.4847
 Best site-East_Asian               (3)  | Epoch:15 | Val Acc: 0.4448
 Best site-Indian                   (1)  | Epoch:15 | Val Acc: 0.3678
 Best site-Indian                   (1)  | Epoch:15 | Val Acc: 0.3755
 Best site-Southeast_Asian          (1)  | Epoch:15 | Val Acc: 0.4513
 Best site-Middle_Eastern           (6)  | Epoch:15 | Val Acc: 0.4274
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 3, 1, 2, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
min_w=0.04658, quan_i=1.58, quan_c=1.56
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.5214 | Train Acc: 0.4301
 Site-White                    | Train Loss: 1.4307 | Train Acc: 0.4843
 Site-White                    | Train Loss: 1.4663 | Train Acc: 0.4066
 Site-White                    | Train Loss: 1.4253 | Train Acc: 0.4702
 Site-White                    | Train Loss: 1.4235 | Train Acc: 0.4361
 Site-Latino_Hispanic          | Train Loss: 1.5330 | Train Acc: 0.3871
 Site-Latino_Hispanic          | Train Loss: 1.5220 | Train Acc: 0.3803
 Site-Latino_Hispanic          | Train Loss: 1.5305 | Train Acc: 0.3834
 Site-Latino_Hispanic          | Train Loss: 1.5138 | Train Acc: 0.3668
 Site-Black                    | Train Loss: 1.7109 | Train Acc: 0.3488
 Site-Black                    | Train Loss: 1.6191 | Train Acc: 0.3964
 Site-Black                    | Train Loss: 1.5800 | Train Acc: 0.3612
 Site-East_Asian               | Train Loss: 1.4400 | Train Acc: 0.4461
 Site-East_Asian               | Train Loss: 1.3256 | Train Acc: 0.4756
 Site-Indian                   | Train Loss: 1.5057 | Train Acc: 0.4466
 Site-Indian                   | Train Loss: 1.4698 | Train Acc: 0.4227
 Site-Southeast_Asian          | Train Loss: 1.5411 | Train Acc: 0.4437
 Site-Middle_Eastern           | Train Loss: 1.4635 | Train Acc: 0.4403
 Site-White                     (5) | Val  Loss: 1.1975 | Val  Acc: 0.4264
 Site-White                     (5) | Val  Loss: 1.4805 | Val  Acc: 0.4970
 Site-White                     (0) | Val  Loss: 1.4367 | Val  Acc: 0.4570
 Site-White                     (0) | Val  Loss: 1.4265 | Val  Acc: 0.4586
 Site-White                     (0) | Val  Loss: 1.4554 | Val  Acc: 0.4237
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5188 | Val  Acc: 0.3681
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4937 | Val  Acc: 0.3810
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5151 | Val  Acc: 0.3992
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4981 | Val  Acc: 0.3723
 Site-Black                     (1) | Val  Loss: 1.6044 | Val  Acc: 0.3488
 Site-Black                     (1) | Val  Loss: 1.5594 | Val  Acc: 0.4089
 Site-Black                     (1) | Val  Loss: 1.5388 | Val  Acc: 0.4068
 Site-East_Asian                (6) | Val  Loss: 1.3993 | Val  Acc: 0.4891
 Site-East_Asian                (6) | Val  Loss: 1.4498 | Val  Acc: 0.4415
 Site-Indian                    (3) | Val  Loss: 1.4805 | Val  Acc: 0.4080
 Site-Indian                    (3) | Val  Loss: 1.6015 | Val  Acc: 0.3537
 Site-Southeast_Asian           (2) | Val  Loss: 1.5170 | Val  Acc: 0.4253
 Site-Middle_Eastern            (5) | Val  Loss: 1.5064 | Val  Acc: 0.4402
Average Valid Accuracy: 0.4170
Aggregated Acc | Val Acc: 0.4201
 Best site-White                    (5)  | Epoch:16 | Val Acc: 0.4264
 Best site-White                    (5)  | Epoch:16 | Val Acc: 0.4970
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.4570
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.4586
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.4237
 Best site-Latino_Hispanic          (4)  | Epoch:16 | Val Acc: 0.3681
 Best site-Latino_Hispanic          (4)  | Epoch:16 | Val Acc: 0.3810
 Best site-Latino_Hispanic          (4)  | Epoch:16 | Val Acc: 0.3992
 Best site-Latino_Hispanic          (4)  | Epoch:16 | Val Acc: 0.3723
 Best site-Black                    (1)  | Epoch:16 | Val Acc: 0.3488
 Best site-Black                    (1)  | Epoch:16 | Val Acc: 0.4089
 Best site-Black                    (1)  | Epoch:16 | Val Acc: 0.4068
 Best site-East_Asian               (6)  | Epoch:16 | Val Acc: 0.4891
 Best site-East_Asian               (6)  | Epoch:16 | Val Acc: 0.4415
 Best site-Indian                   (3)  | Epoch:16 | Val Acc: 0.4080
 Best site-Indian                   (3)  | Epoch:16 | Val Acc: 0.3537
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4253
 Best site-Middle_Eastern           (5)  | Epoch:16 | Val Acc: 0.4402
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 17 ============
cnt=[6, 2, 1, 2, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
min_w=0.06806, quan_i=1.55, quan_c=1.53
minimize weight of clients:[0, 1, 2, 3, 4, 5, 7, 8, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.4422 | Train Acc: 0.5078
 Site-White                    | Train Loss: 1.4527 | Train Acc: 0.4685
 Site-White                    | Train Loss: 1.4522 | Train Acc: 0.4488
 Site-White                    | Train Loss: 1.4321 | Train Acc: 0.4862
 Site-White                    | Train Loss: 1.4139 | Train Acc: 0.4396
 Site-Latino_Hispanic          | Train Loss: 1.5480 | Train Acc: 0.3733
 Site-Latino_Hispanic          | Train Loss: 1.4817 | Train Acc: 0.3908
 Site-Latino_Hispanic          | Train Loss: 1.5335 | Train Acc: 0.3941
 Site-Latino_Hispanic          | Train Loss: 1.4803 | Train Acc: 0.3852
 Site-Black                    | Train Loss: 1.5946 | Train Acc: 0.3527
 Site-Black                    | Train Loss: 1.5591 | Train Acc: 0.3876
 Site-Black                    | Train Loss: 1.5697 | Train Acc: 0.3837
 Site-East_Asian               | Train Loss: 1.4201 | Train Acc: 0.4577
 Site-East_Asian               | Train Loss: 1.4225 | Train Acc: 0.4911
 Site-Indian                   | Train Loss: 1.4803 | Train Acc: 0.4237
 Site-Indian                   | Train Loss: 1.4975 | Train Acc: 0.4111
 Site-Southeast_Asian          | Train Loss: 1.5391 | Train Acc: 0.4567
 Site-Middle_Eastern           | Train Loss: 1.4306 | Train Acc: 0.4631
 Site-White                     (0) | Val  Loss: 1.2753 | Val  Acc: 0.4264
 Site-White                     (0) | Val  Loss: 1.4476 | Val  Acc: 0.5148
 Site-White                     (0) | Val  Loss: 1.4343 | Val  Acc: 0.4434
 Site-White                     (0) | Val  Loss: 1.4438 | Val  Acc: 0.4310
 Site-White                     (0) | Val  Loss: 1.4457 | Val  Acc: 0.4342
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4858 | Val  Acc: 0.4236
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5221 | Val  Acc: 0.3545
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5124 | Val  Acc: 0.3911
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5094 | Val  Acc: 0.3877
 Site-Black                     (3) | Val  Loss: 1.6407 | Val  Acc: 0.3430
 Site-Black                     (3) | Val  Loss: 1.5693 | Val  Acc: 0.3556
 Site-Black                     (2) | Val  Loss: 1.5401 | Val  Acc: 0.4305
 Site-East_Asian                (4) | Val  Loss: 1.3983 | Val  Acc: 0.5066
 Site-East_Asian                (4) | Val  Loss: 1.4314 | Val  Acc: 0.4749
 Site-Indian                    (1) | Val  Loss: 1.4886 | Val  Acc: 0.4310
 Site-Indian                    (1) | Val  Loss: 1.5892 | Val  Acc: 0.3537
 Site-Southeast_Asian           (4) | Val  Loss: 1.4997 | Val  Acc: 0.4351
 Site-Middle_Eastern            (0) | Val  Loss: 1.5019 | Val  Acc: 0.4274
Average Valid Accuracy: 0.4202
Aggregated Acc | Val Acc: 0.4066
 Best site-White                    (0)  | Epoch:17 | Val Acc: 0.4264
 Best site-White                    (0)  | Epoch:17 | Val Acc: 0.5148
 Best site-White                    (0)  | Epoch:17 | Val Acc: 0.4434
 Best site-White                    (0)  | Epoch:17 | Val Acc: 0.4310
 Best site-White                    (0)  | Epoch:17 | Val Acc: 0.4342
 Best site-Latino_Hispanic          (5)  | Epoch:17 | Val Acc: 0.4236
 Best site-Latino_Hispanic          (6)  | Epoch:17 | Val Acc: 0.3545
 Best site-Latino_Hispanic          (5)  | Epoch:17 | Val Acc: 0.3911
 Best site-Latino_Hispanic          (5)  | Epoch:17 | Val Acc: 0.3877
 Best site-Black                    (3)  | Epoch:17 | Val Acc: 0.3430
 Best site-Black                    (3)  | Epoch:17 | Val Acc: 0.3556
 Best site-Black                    (2)  | Epoch:17 | Val Acc: 0.4305
 Best site-East_Asian               (4)  | Epoch:17 | Val Acc: 0.5066
 Best site-East_Asian               (4)  | Epoch:17 | Val Acc: 0.4749
 Best site-Indian                   (1)  | Epoch:17 | Val Acc: 0.4310
 Best site-Indian                   (1)  | Epoch:17 | Val Acc: 0.3537
 Best site-Southeast_Asian          (4)  | Epoch:17 | Val Acc: 0.4351
 Best site-Middle_Eastern           (0)  | Epoch:17 | Val Acc: 0.4274
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 18 ============
cnt=[5, 4, 3, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
min_w=0.06336, quan_i=1.56, quan_c=1.52
minimize weight of clients:[0, 1, 2, 3, 4, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.3040 | Train Acc: 0.4663
 Site-White                    | Train Loss: 1.4342 | Train Acc: 0.4528
 Site-White                    | Train Loss: 1.4616 | Train Acc: 0.4217
 Site-White                    | Train Loss: 1.4108 | Train Acc: 0.4679
 Site-White                    | Train Loss: 1.4270 | Train Acc: 0.4448
 Site-Latino_Hispanic          | Train Loss: 1.5563 | Train Acc: 0.3733
 Site-Latino_Hispanic          | Train Loss: 1.4941 | Train Acc: 0.3838
 Site-Latino_Hispanic          | Train Loss: 1.4833 | Train Acc: 0.3941
 Site-Latino_Hispanic          | Train Loss: 1.4811 | Train Acc: 0.4016
 Site-Black                    | Train Loss: 1.5169 | Train Acc: 0.3798
 Site-Black                    | Train Loss: 1.5542 | Train Acc: 0.4349
 Site-Black                    | Train Loss: 1.5807 | Train Acc: 0.3567
 Site-East_Asian               | Train Loss: 1.4543 | Train Acc: 0.4373
 Site-East_Asian               | Train Loss: 1.3705 | Train Acc: 0.4889
 Site-Indian                   | Train Loss: 1.5311 | Train Acc: 0.3817
 Site-Indian                   | Train Loss: 1.4961 | Train Acc: 0.4286
 Site-Southeast_Asian          | Train Loss: 1.5519 | Train Acc: 0.4654
 Site-Middle_Eastern           | Train Loss: 1.4308 | Train Acc: 0.4574
 Site-White                     (0) | Val  Loss: 1.2778 | Val  Acc: 0.4264
 Site-White                     (0) | Val  Loss: 1.4565 | Val  Acc: 0.4615
 Site-White                     (0) | Val  Loss: 1.4294 | Val  Acc: 0.4299
 Site-White                     (0) | Val  Loss: 1.4332 | Val  Acc: 0.4552
 Site-White                     (0) | Val  Loss: 1.4340 | Val  Acc: 0.4421
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4911 | Val  Acc: 0.3889
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4689 | Val  Acc: 0.4180
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4931 | Val  Acc: 0.3911
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4924 | Val  Acc: 0.3815
 Site-Black                     (3) | Val  Loss: 1.5835 | Val  Acc: 0.3256
 Site-Black                     (6) | Val  Loss: 1.5306 | Val  Acc: 0.3867
 Site-Black                     (3) | Val  Loss: 1.5221 | Val  Acc: 0.4542
 Site-East_Asian                (2) | Val  Loss: 1.3782 | Val  Acc: 0.4978
 Site-East_Asian                (2) | Val  Loss: 1.4356 | Val  Acc: 0.4381
 Site-Indian                    (5) | Val  Loss: 1.4705 | Val  Acc: 0.3793
 Site-Indian                    (5) | Val  Loss: 1.5811 | Val  Acc: 0.4017
 Site-Southeast_Asian           (2) | Val  Loss: 1.4888 | Val  Acc: 0.4286
 Site-Middle_Eastern            (4) | Val  Loss: 1.4710 | Val  Acc: 0.4402
Average Valid Accuracy: 0.4193
Aggregated Acc | Val Acc: 0.4143
============ Train epoch 19 ============
cnt=[1, 2, 3, 3, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
min_w=0.05623, quan_i=1.55, quan_c=1.54
minimize weight of clients:[0, 1, 2, 3, 4, 7, 8, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.2939 | Train Acc: 0.4663
 Site-White                    | Train Loss: 1.4182 | Train Acc: 0.4646
 Site-White                    | Train Loss: 1.4398 | Train Acc: 0.4337
 Site-White                    | Train Loss: 1.4276 | Train Acc: 0.4564
 Site-White                    | Train Loss: 1.4226 | Train Acc: 0.4308
 Site-Latino_Hispanic          | Train Loss: 1.5869 | Train Acc: 0.3917
 Site-Latino_Hispanic          | Train Loss: 1.5126 | Train Acc: 0.3592
 Site-Latino_Hispanic          | Train Loss: 1.5056 | Train Acc: 0.3914
 Site-Latino_Hispanic          | Train Loss: 1.4768 | Train Acc: 0.3893
 Site-Black                    | Train Loss: 1.7945 | Train Acc: 0.3798
 Site-Black                    | Train Loss: 1.5236 | Train Acc: 0.4320
 Site-Black                    | Train Loss: 1.5672 | Train Acc: 0.3612
 Site-East_Asian               | Train Loss: 1.4632 | Train Acc: 0.4431
 Site-East_Asian               | Train Loss: 1.3451 | Train Acc: 0.4867
 Site-Indian                   | Train Loss: 1.5298 | Train Acc: 0.3969
 Site-Indian                   | Train Loss: 1.4969 | Train Acc: 0.4111
 Site-Southeast_Asian          | Train Loss: 1.4813 | Train Acc: 0.4459
 Site-Middle_Eastern           | Train Loss: 1.4328 | Train Acc: 0.4318
 Site-White                     (4) | Val  Loss: 1.3223 | Val  Acc: 0.3876
 Site-White                     (4) | Val  Loss: 1.4505 | Val  Acc: 0.4675
 Site-White                     (4) | Val  Loss: 1.3998 | Val  Acc: 0.4615
 Site-White                     (0) | Val  Loss: 1.4208 | Val  Acc: 0.4241
 Site-White                     (4) | Val  Loss: 1.4344 | Val  Acc: 0.4447
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4911 | Val  Acc: 0.4097
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4616 | Val  Acc: 0.4127
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4893 | Val  Acc: 0.4194
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4871 | Val  Acc: 0.3785
 Site-Black                     (2) | Val  Loss: 1.5505 | Val  Acc: 0.3605
 Site-Black                     (2) | Val  Loss: 1.5466 | Val  Acc: 0.3689
 Site-Black                     (2) | Val  Loss: 1.5340 | Val  Acc: 0.4136
 Site-East_Asian                (3) | Val  Loss: 1.4076 | Val  Acc: 0.4716
 Site-East_Asian                (3) | Val  Loss: 1.4343 | Val  Acc: 0.4649
 Site-Indian                    (5) | Val  Loss: 1.4817 | Val  Acc: 0.3736
 Site-Indian                    (5) | Val  Loss: 1.5886 | Val  Acc: 0.3493
 Site-Southeast_Asian           (3) | Val  Loss: 1.5092 | Val  Acc: 0.4286
 Site-Middle_Eastern            (4) | Val  Loss: 1.4735 | Val  Acc: 0.4060
Average Valid Accuracy: 0.4135
Aggregated Acc | Val Acc: 0.4093
============ Train epoch 20 ============
cnt=[2, 2, 2, 3, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
min_w=0.05453, quan_i=1.54, quan_c=1.53
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 16, 17, ]
 Site-White                    | Train Loss: 1.4175 | Train Acc: 0.4404
 Site-White                    | Train Loss: 1.4194 | Train Acc: 0.4606
 Site-White                    | Train Loss: 1.4419 | Train Acc: 0.4307
 Site-White                    | Train Loss: 1.4133 | Train Acc: 0.4450
 Site-White                    | Train Loss: 1.4181 | Train Acc: 0.4326
 Site-Latino_Hispanic          | Train Loss: 1.5508 | Train Acc: 0.3871
 Site-Latino_Hispanic          | Train Loss: 1.4979 | Train Acc: 0.4049
 Site-Latino_Hispanic          | Train Loss: 1.4929 | Train Acc: 0.3914
 Site-Latino_Hispanic          | Train Loss: 1.4606 | Train Acc: 0.3914
 Site-Black                    | Train Loss: 1.6895 | Train Acc: 0.3605
 Site-Black                    | Train Loss: 1.5124 | Train Acc: 0.4349
 Site-Black                    | Train Loss: 1.5276 | Train Acc: 0.3837
 Site-East_Asian               | Train Loss: 1.4336 | Train Acc: 0.4577
 Site-East_Asian               | Train Loss: 1.4182 | Train Acc: 0.4867
 Site-Indian                   | Train Loss: 1.4989 | Train Acc: 0.4237
 Site-Indian                   | Train Loss: 1.4860 | Train Acc: 0.3907
 Site-Southeast_Asian          | Train Loss: 1.5111 | Train Acc: 0.4610
 Site-Middle_Eastern           | Train Loss: 1.4325 | Train Acc: 0.4489
 Site-White                     (6) | Val  Loss: 1.2467 | Val  Acc: 0.4186
 Site-White                     (6) | Val  Loss: 1.4353 | Val  Acc: 0.4675
 Site-White                     (2) | Val  Loss: 1.3895 | Val  Acc: 0.4932
 Site-White                     (2) | Val  Loss: 1.4211 | Val  Acc: 0.4448
 Site-White                     (6) | Val  Loss: 1.4098 | Val  Acc: 0.4526
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4509 | Val  Acc: 0.4097
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4538 | Val  Acc: 0.4021
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4773 | Val  Acc: 0.4113
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4913 | Val  Acc: 0.3723
 Site-Black                     (3) | Val  Loss: 1.5604 | Val  Acc: 0.3663
 Site-Black                     (3) | Val  Loss: 1.4833 | Val  Acc: 0.4267
 Site-Black                     (3) | Val  Loss: 1.4878 | Val  Acc: 0.4305
 Site-East_Asian                (0) | Val  Loss: 1.3858 | Val  Acc: 0.4803
 Site-East_Asian                (0) | Val  Loss: 1.4543 | Val  Acc: 0.4482
 Site-Indian                    (1) | Val  Loss: 1.4586 | Val  Acc: 0.3621
 Site-Indian                    (1) | Val  Loss: 1.6169 | Val  Acc: 0.3450
 Site-Southeast_Asian           (4) | Val  Loss: 1.5158 | Val  Acc: 0.4416
 Site-Middle_Eastern            (5) | Val  Loss: 1.4587 | Val  Acc: 0.4145
Average Valid Accuracy: 0.4215
Aggregated Acc | Val Acc: 0.4226
 Best site-White                    (6)  | Epoch:20 | Val Acc: 0.4186
 Best site-White                    (6)  | Epoch:20 | Val Acc: 0.4675
 Best site-White                    (2)  | Epoch:20 | Val Acc: 0.4932
 Best site-White                    (2)  | Epoch:20 | Val Acc: 0.4448
 Best site-White                    (6)  | Epoch:20 | Val Acc: 0.4526
 Best site-Latino_Hispanic          (5)  | Epoch:20 | Val Acc: 0.4097
 Best site-Latino_Hispanic          (4)  | Epoch:20 | Val Acc: 0.4021
 Best site-Latino_Hispanic          (4)  | Epoch:20 | Val Acc: 0.4113
 Best site-Latino_Hispanic          (5)  | Epoch:20 | Val Acc: 0.3723
 Best site-Black                    (3)  | Epoch:20 | Val Acc: 0.3663
 Best site-Black                    (3)  | Epoch:20 | Val Acc: 0.4267
 Best site-Black                    (3)  | Epoch:20 | Val Acc: 0.4305
 Best site-East_Asian               (0)  | Epoch:20 | Val Acc: 0.4803
 Best site-East_Asian               (0)  | Epoch:20 | Val Acc: 0.4482
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.3621
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.3450
 Best site-Southeast_Asian          (4)  | Epoch:20 | Val Acc: 0.4416
 Best site-Middle_Eastern           (5)  | Epoch:20 | Val Acc: 0.4145
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 3, 6, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
min_w=0.06181, quan_i=1.52, quan_c=1.52
minimize weight of clients:[0, 1, 2, 3, 4, 8, 12, 13, 15, 17, ]
 Site-White                    | Train Loss: 1.6614 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3852 | Train Acc: 0.4528
 Site-White                    | Train Loss: 1.4342 | Train Acc: 0.4367
 Site-White                    | Train Loss: 1.4144 | Train Acc: 0.4725
 Site-White                    | Train Loss: 1.4023 | Train Acc: 0.4466
 Site-Latino_Hispanic          | Train Loss: 1.5013 | Train Acc: 0.3963
 Site-Latino_Hispanic          | Train Loss: 1.4670 | Train Acc: 0.4085
 Site-Latino_Hispanic          | Train Loss: 1.4851 | Train Acc: 0.4129
 Site-Latino_Hispanic          | Train Loss: 1.4618 | Train Acc: 0.4160
 Site-Black                    | Train Loss: 1.4941 | Train Acc: 0.3566
 Site-Black                    | Train Loss: 1.4932 | Train Acc: 0.4201
 Site-Black                    | Train Loss: 1.5610 | Train Acc: 0.3747
 Site-East_Asian               | Train Loss: 1.4447 | Train Acc: 0.4519
 Site-East_Asian               | Train Loss: 1.4548 | Train Acc: 0.4756
 Site-Indian                   | Train Loss: 1.4473 | Train Acc: 0.3969
 Site-Indian                   | Train Loss: 1.4699 | Train Acc: 0.4402
 Site-Southeast_Asian          | Train Loss: 1.4676 | Train Acc: 0.4675
 Site-Middle_Eastern           | Train Loss: 1.3967 | Train Acc: 0.4631
 Site-White                     (2) | Val  Loss: 1.1603 | Val  Acc: 0.4574
 Site-White                     (2) | Val  Loss: 1.4427 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.3956 | Val  Acc: 0.4751
 Site-White                     (2) | Val  Loss: 1.4108 | Val  Acc: 0.4379
 Site-White                     (2) | Val  Loss: 1.4165 | Val  Acc: 0.4500
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4755 | Val  Acc: 0.4167
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4753 | Val  Acc: 0.4127
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4708 | Val  Acc: 0.3992
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4665 | Val  Acc: 0.3815
 Site-Black                     (1) | Val  Loss: 1.5709 | Val  Acc: 0.3488
 Site-Black                     (1) | Val  Loss: 1.5448 | Val  Acc: 0.3733
 Site-Black                     (1) | Val  Loss: 1.5124 | Val  Acc: 0.4102
 Site-East_Asian                (0) | Val  Loss: 1.3626 | Val  Acc: 0.4891
 Site-East_Asian                (0) | Val  Loss: 1.4397 | Val  Acc: 0.4515
 Site-Indian                    (5) | Val  Loss: 1.4645 | Val  Acc: 0.3736
 Site-Indian                    (5) | Val  Loss: 1.5751 | Val  Acc: 0.3799
 Site-Southeast_Asian           (6) | Val  Loss: 1.4898 | Val  Acc: 0.4416
 Site-Middle_Eastern            (2) | Val  Loss: 1.4581 | Val  Acc: 0.4145
Average Valid Accuracy: 0.4208
Aggregated Acc | Val Acc: 0.4172
============ Train epoch 22 ============
cnt=[1, 1, 5, 3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
min_w=0.07361, quan_i=1.52, quan_c=1.48
minimize weight of clients:[1, 2, 3, 4, 12, 13, 14, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.3250 | Train Acc: 0.4715
 Site-White                    | Train Loss: 1.3828 | Train Acc: 0.4685
 Site-White                    | Train Loss: 1.4295 | Train Acc: 0.4337
 Site-White                    | Train Loss: 1.3986 | Train Acc: 0.4610
 Site-White                    | Train Loss: 1.3879 | Train Acc: 0.4553
 Site-Latino_Hispanic          | Train Loss: 1.5016 | Train Acc: 0.3594
 Site-Latino_Hispanic          | Train Loss: 1.4838 | Train Acc: 0.3873
 Site-Latino_Hispanic          | Train Loss: 1.4667 | Train Acc: 0.3995
 Site-Latino_Hispanic          | Train Loss: 1.4487 | Train Acc: 0.4262
 Site-Black                    | Train Loss: 1.6777 | Train Acc: 0.3527
 Site-Black                    | Train Loss: 1.4921 | Train Acc: 0.4112
 Site-Black                    | Train Loss: 1.5514 | Train Acc: 0.3792
 Site-East_Asian               | Train Loss: 1.4238 | Train Acc: 0.4577
 Site-East_Asian               | Train Loss: 1.3050 | Train Acc: 0.4978
 Site-Indian                   | Train Loss: 1.4817 | Train Acc: 0.4046
 Site-Indian                   | Train Loss: 1.4520 | Train Acc: 0.4286
 Site-Southeast_Asian          | Train Loss: 1.5206 | Train Acc: 0.4610
 Site-Middle_Eastern           | Train Loss: 1.4056 | Train Acc: 0.4602
 Site-White                     (2) | Val  Loss: 1.4876 | Val  Acc: 0.4264
 Site-White                     (2) | Val  Loss: 1.4432 | Val  Acc: 0.4675
 Site-White                     (2) | Val  Loss: 1.3971 | Val  Acc: 0.4977
 Site-White                     (2) | Val  Loss: 1.4143 | Val  Acc: 0.4103
 Site-White                     (2) | Val  Loss: 1.3912 | Val  Acc: 0.4684
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4462 | Val  Acc: 0.3611
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4368 | Val  Acc: 0.4392
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4444 | Val  Acc: 0.4355
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4371 | Val  Acc: 0.3908
 Site-Black                     (6) | Val  Loss: 1.5567 | Val  Acc: 0.3663
 Site-Black                     (6) | Val  Loss: 1.5163 | Val  Acc: 0.4044
 Site-Black                     (1) | Val  Loss: 1.4968 | Val  Acc: 0.4441
 Site-East_Asian                (3) | Val  Loss: 1.3212 | Val  Acc: 0.4891
 Site-East_Asian                (3) | Val  Loss: 1.4346 | Val  Acc: 0.4615
 Site-Indian                    (5) | Val  Loss: 1.4526 | Val  Acc: 0.3966
 Site-Indian                    (5) | Val  Loss: 1.5528 | Val  Acc: 0.4148
 Site-Southeast_Asian           (3) | Val  Loss: 1.4785 | Val  Acc: 0.4545
 Site-Middle_Eastern            (0) | Val  Loss: 1.4356 | Val  Acc: 0.4231
Average Valid Accuracy: 0.4306
Aggregated Acc | Val Acc: 0.4268
 Best site-White                    (2)  | Epoch:22 | Val Acc: 0.4264
 Best site-White                    (2)  | Epoch:22 | Val Acc: 0.4675
 Best site-White                    (2)  | Epoch:22 | Val Acc: 0.4977
 Best site-White                    (2)  | Epoch:22 | Val Acc: 0.4103
 Best site-White                    (2)  | Epoch:22 | Val Acc: 0.4684
 Best site-Latino_Hispanic          (4)  | Epoch:22 | Val Acc: 0.3611
 Best site-Latino_Hispanic          (4)  | Epoch:22 | Val Acc: 0.4392
 Best site-Latino_Hispanic          (4)  | Epoch:22 | Val Acc: 0.4355
 Best site-Latino_Hispanic          (4)  | Epoch:22 | Val Acc: 0.3908
 Best site-Black                    (6)  | Epoch:22 | Val Acc: 0.3663
 Best site-Black                    (6)  | Epoch:22 | Val Acc: 0.4044
 Best site-Black                    (1)  | Epoch:22 | Val Acc: 0.4441
 Best site-East_Asian               (3)  | Epoch:22 | Val Acc: 0.4891
 Best site-East_Asian               (3)  | Epoch:22 | Val Acc: 0.4615
 Best site-Indian                   (5)  | Epoch:22 | Val Acc: 0.3966
 Best site-Indian                   (5)  | Epoch:22 | Val Acc: 0.4148
 Best site-Southeast_Asian          (3)  | Epoch:22 | Val Acc: 0.4545
 Best site-Middle_Eastern           (0)  | Epoch:22 | Val Acc: 0.4231
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 23 ============
cnt=[5, 3, 2, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
min_w=0.05479, quan_i=1.51, quan_c=1.52
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.3063 | Train Acc: 0.4767
 Site-White                    | Train Loss: 1.3963 | Train Acc: 0.4803
 Site-White                    | Train Loss: 1.4316 | Train Acc: 0.4608
 Site-White                    | Train Loss: 1.4093 | Train Acc: 0.4633
 Site-White                    | Train Loss: 1.3736 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.4795 | Train Acc: 0.4378
 Site-Latino_Hispanic          | Train Loss: 1.4535 | Train Acc: 0.4120
 Site-Latino_Hispanic          | Train Loss: 1.4568 | Train Acc: 0.4129
 Site-Latino_Hispanic          | Train Loss: 1.4394 | Train Acc: 0.4262
 Site-Black                    | Train Loss: 1.4814 | Train Acc: 0.3682
 Site-Black                    | Train Loss: 1.5104 | Train Acc: 0.4408
 Site-Black                    | Train Loss: 1.5108 | Train Acc: 0.4199
 Site-East_Asian               | Train Loss: 1.3838 | Train Acc: 0.4461
 Site-East_Asian               | Train Loss: 1.3656 | Train Acc: 0.4778
 Site-Indian                   | Train Loss: 1.4730 | Train Acc: 0.4160
 Site-Indian                   | Train Loss: 1.4688 | Train Acc: 0.4169
 Site-Southeast_Asian          | Train Loss: 1.5088 | Train Acc: 0.4589
 Site-Middle_Eastern           | Train Loss: 1.3989 | Train Acc: 0.4489
 Site-White                     (2) | Val  Loss: 1.3624 | Val  Acc: 0.3876
 Site-White                     (2) | Val  Loss: 1.4233 | Val  Acc: 0.5030
 Site-White                     (5) | Val  Loss: 1.4312 | Val  Acc: 0.4480
 Site-White                     (5) | Val  Loss: 1.4056 | Val  Acc: 0.4483
 Site-White                     (5) | Val  Loss: 1.3982 | Val  Acc: 0.4632
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4748 | Val  Acc: 0.3750
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4470 | Val  Acc: 0.4127
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4495 | Val  Acc: 0.4274
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4523 | Val  Acc: 0.3877
 Site-Black                     (1) | Val  Loss: 1.5514 | Val  Acc: 0.3488
 Site-Black                     (1) | Val  Loss: 1.4947 | Val  Acc: 0.3822
 Site-Black                     (1) | Val  Loss: 1.4883 | Val  Acc: 0.4678
 Site-East_Asian                (3) | Val  Loss: 1.3892 | Val  Acc: 0.4891
 Site-East_Asian                (3) | Val  Loss: 1.4015 | Val  Acc: 0.4615
 Site-Indian                    (4) | Val  Loss: 1.4652 | Val  Acc: 0.3966
 Site-Indian                    (4) | Val  Loss: 1.5683 | Val  Acc: 0.4017
 Site-Southeast_Asian           (6) | Val  Loss: 1.4959 | Val  Acc: 0.4416
 Site-Middle_Eastern            (0) | Val  Loss: 1.4534 | Val  Acc: 0.4060
Average Valid Accuracy: 0.4249
Aggregated Acc | Val Acc: 0.4308
============ Train epoch 24 ============
cnt=[5, 1, 3, 2, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
min_w=0.05548, quan_i=1.49, quan_c=1.50
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 15, 17, ]
 Site-White                    | Train Loss: 1.7010 | Train Acc: 0.4819
 Site-White                    | Train Loss: 1.3550 | Train Acc: 0.4961
 Site-White                    | Train Loss: 1.4294 | Train Acc: 0.4367
 Site-White                    | Train Loss: 1.4089 | Train Acc: 0.4220
 Site-White                    | Train Loss: 1.3761 | Train Acc: 0.4571
 Site-Latino_Hispanic          | Train Loss: 1.5134 | Train Acc: 0.4055
 Site-Latino_Hispanic          | Train Loss: 1.5079 | Train Acc: 0.4120
 Site-Latino_Hispanic          | Train Loss: 1.4720 | Train Acc: 0.4048
 Site-Latino_Hispanic          | Train Loss: 1.4347 | Train Acc: 0.4262
 Site-Black                    | Train Loss: 1.5992 | Train Acc: 0.3837
 Site-Black                    | Train Loss: 1.4984 | Train Acc: 0.4053
 Site-Black                    | Train Loss: 1.5242 | Train Acc: 0.3837
 Site-East_Asian               | Train Loss: 1.4333 | Train Acc: 0.4461
 Site-East_Asian               | Train Loss: 1.3160 | Train Acc: 0.5000
 Site-Indian                   | Train Loss: 1.4704 | Train Acc: 0.3931
 Site-Indian                   | Train Loss: 1.4623 | Train Acc: 0.3878
 Site-Southeast_Asian          | Train Loss: 1.5140 | Train Acc: 0.4784
 Site-Middle_Eastern           | Train Loss: 1.4059 | Train Acc: 0.4432
 Site-White                     (0) | Val  Loss: 1.3560 | Val  Acc: 0.4109
 Site-White                     (0) | Val  Loss: 1.4215 | Val  Acc: 0.5089
 Site-White                     (0) | Val  Loss: 1.3653 | Val  Acc: 0.4932
 Site-White                     (0) | Val  Loss: 1.3998 | Val  Acc: 0.4379
 Site-White                     (0) | Val  Loss: 1.3903 | Val  Acc: 0.4763
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4245 | Val  Acc: 0.4097
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4560 | Val  Acc: 0.4021
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4659 | Val  Acc: 0.4153
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4548 | Val  Acc: 0.3785
 Site-Black                     (2) | Val  Loss: 1.5714 | Val  Acc: 0.3953
 Site-Black                     (2) | Val  Loss: 1.4594 | Val  Acc: 0.3911
 Site-Black                     (2) | Val  Loss: 1.4822 | Val  Acc: 0.4475
 Site-East_Asian                (6) | Val  Loss: 1.3419 | Val  Acc: 0.5109
 Site-East_Asian                (6) | Val  Loss: 1.4046 | Val  Acc: 0.4448
 Site-Indian                    (3) | Val  Loss: 1.4394 | Val  Acc: 0.3966
 Site-Indian                    (3) | Val  Loss: 1.5707 | Val  Acc: 0.3930
 Site-Southeast_Asian           (1) | Val  Loss: 1.4788 | Val  Acc: 0.4610
 Site-Middle_Eastern            (5) | Val  Loss: 1.4537 | Val  Acc: 0.4359
Average Valid Accuracy: 0.4338
Aggregated Acc | Val Acc: 0.4354
 Best site-White                    (0)  | Epoch:24 | Val Acc: 0.4109
 Best site-White                    (0)  | Epoch:24 | Val Acc: 0.5089
 Best site-White                    (0)  | Epoch:24 | Val Acc: 0.4932
 Best site-White                    (0)  | Epoch:24 | Val Acc: 0.4379
 Best site-White                    (0)  | Epoch:24 | Val Acc: 0.4763
 Best site-Latino_Hispanic          (4)  | Epoch:24 | Val Acc: 0.4097
 Best site-Latino_Hispanic          (4)  | Epoch:24 | Val Acc: 0.4021
 Best site-Latino_Hispanic          (4)  | Epoch:24 | Val Acc: 0.4153
 Best site-Latino_Hispanic          (4)  | Epoch:24 | Val Acc: 0.3785
 Best site-Black                    (2)  | Epoch:24 | Val Acc: 0.3953
 Best site-Black                    (2)  | Epoch:24 | Val Acc: 0.3911
 Best site-Black                    (2)  | Epoch:24 | Val Acc: 0.4475
 Best site-East_Asian               (6)  | Epoch:24 | Val Acc: 0.5109
 Best site-East_Asian               (6)  | Epoch:24 | Val Acc: 0.4448
 Best site-Indian                   (3)  | Epoch:24 | Val Acc: 0.3966
 Best site-Indian                   (3)  | Epoch:24 | Val Acc: 0.3930
 Best site-Southeast_Asian          (1)  | Epoch:24 | Val Acc: 0.4610
 Best site-Middle_Eastern           (5)  | Epoch:24 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 5, 2, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
min_w=0.07522, quan_i=1.52, quan_c=1.50
minimize weight of clients:[1, 2, 3, 4, 7, 8, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.7195 | Train Acc: 0.4922
 Site-White                    | Train Loss: 1.3607 | Train Acc: 0.4449
 Site-White                    | Train Loss: 1.3454 | Train Acc: 0.4428
 Site-White                    | Train Loss: 1.3962 | Train Acc: 0.4633
 Site-White                    | Train Loss: 1.3682 | Train Acc: 0.4588
 Site-Latino_Hispanic          | Train Loss: 1.4671 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.4154 | Train Acc: 0.4085
 Site-Latino_Hispanic          | Train Loss: 1.4937 | Train Acc: 0.3887
 Site-Latino_Hispanic          | Train Loss: 1.4357 | Train Acc: 0.4283
 Site-Black                    | Train Loss: 1.5905 | Train Acc: 0.3721
 Site-Black                    | Train Loss: 1.5508 | Train Acc: 0.4231
 Site-Black                    | Train Loss: 1.5234 | Train Acc: 0.3905
 Site-East_Asian               | Train Loss: 1.4161 | Train Acc: 0.4606
 Site-East_Asian               | Train Loss: 1.3539 | Train Acc: 0.4867
 Site-Indian                   | Train Loss: 1.4153 | Train Acc: 0.3969
 Site-Indian                   | Train Loss: 1.4715 | Train Acc: 0.4344
 Site-Southeast_Asian          | Train Loss: 1.4798 | Train Acc: 0.4675
 Site-Middle_Eastern           | Train Loss: 1.3740 | Train Acc: 0.4460
 Site-White                     (1) | Val  Loss: 1.1197 | Val  Acc: 0.4186
 Site-White                     (1) | Val  Loss: 1.3942 | Val  Acc: 0.4793
 Site-White                     (1) | Val  Loss: 1.3878 | Val  Acc: 0.4932
 Site-White                     (1) | Val  Loss: 1.3869 | Val  Acc: 0.4414
 Site-White                     (1) | Val  Loss: 1.3742 | Val  Acc: 0.4816
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4219 | Val  Acc: 0.4375
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4338 | Val  Acc: 0.4550
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4570 | Val  Acc: 0.4153
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4548 | Val  Acc: 0.3969
 Site-Black                     (2) | Val  Loss: 1.5609 | Val  Acc: 0.3895
 Site-Black                     (5) | Val  Loss: 1.5260 | Val  Acc: 0.4044
 Site-Black                     (2) | Val  Loss: 1.5102 | Val  Acc: 0.4102
 Site-East_Asian                (3) | Val  Loss: 1.3389 | Val  Acc: 0.4803
 Site-East_Asian                (3) | Val  Loss: 1.4272 | Val  Acc: 0.4482
 Site-Indian                    (0) | Val  Loss: 1.4719 | Val  Acc: 0.3851
 Site-Indian                    (0) | Val  Loss: 1.5618 | Val  Acc: 0.3974
 Site-Southeast_Asian           (6) | Val  Loss: 1.4531 | Val  Acc: 0.4545
 Site-Middle_Eastern            (4) | Val  Loss: 1.4356 | Val  Acc: 0.4231
Average Valid Accuracy: 0.4340
Aggregated Acc | Val Acc: 0.4275
 Best site-White                    (1)  | Epoch:25 | Val Acc: 0.4186
 Best site-White                    (1)  | Epoch:25 | Val Acc: 0.4793
 Best site-White                    (1)  | Epoch:25 | Val Acc: 0.4932
 Best site-White                    (1)  | Epoch:25 | Val Acc: 0.4414
 Best site-White                    (1)  | Epoch:25 | Val Acc: 0.4816
 Best site-Latino_Hispanic          (4)  | Epoch:25 | Val Acc: 0.4375
 Best site-Latino_Hispanic          (3)  | Epoch:25 | Val Acc: 0.4550
 Best site-Latino_Hispanic          (4)  | Epoch:25 | Val Acc: 0.4153
 Best site-Latino_Hispanic          (4)  | Epoch:25 | Val Acc: 0.3969
 Best site-Black                    (2)  | Epoch:25 | Val Acc: 0.3895
 Best site-Black                    (5)  | Epoch:25 | Val Acc: 0.4044
 Best site-Black                    (2)  | Epoch:25 | Val Acc: 0.4102
 Best site-East_Asian               (3)  | Epoch:25 | Val Acc: 0.4803
 Best site-East_Asian               (3)  | Epoch:25 | Val Acc: 0.4482
 Best site-Indian                   (0)  | Epoch:25 | Val Acc: 0.3851
 Best site-Indian                   (0)  | Epoch:25 | Val Acc: 0.3974
 Best site-Southeast_Asian          (6)  | Epoch:25 | Val Acc: 0.4545
 Best site-Middle_Eastern           (4)  | Epoch:25 | Val Acc: 0.4231
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 26 ============
cnt=[4, 3, 4, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
min_w=0.07448, quan_i=1.53, quan_c=1.50
minimize weight of clients:[1, 2, 3, 4, 6, 8, 12, 13, 14, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.6598 | Train Acc: 0.4819
 Site-White                    | Train Loss: 1.3676 | Train Acc: 0.4803
 Site-White                    | Train Loss: 1.4157 | Train Acc: 0.4217
 Site-White                    | Train Loss: 1.3937 | Train Acc: 0.4656
 Site-White                    | Train Loss: 1.3802 | Train Acc: 0.4553
 Site-Latino_Hispanic          | Train Loss: 1.4837 | Train Acc: 0.4240
 Site-Latino_Hispanic          | Train Loss: 1.4459 | Train Acc: 0.3768
 Site-Latino_Hispanic          | Train Loss: 1.4632 | Train Acc: 0.4263
 Site-Latino_Hispanic          | Train Loss: 1.4564 | Train Acc: 0.4139
 Site-Black                    | Train Loss: 1.5028 | Train Acc: 0.3760
 Site-Black                    | Train Loss: 1.5073 | Train Acc: 0.4024
 Site-Black                    | Train Loss: 1.5173 | Train Acc: 0.3815
 Site-East_Asian               | Train Loss: 1.3791 | Train Acc: 0.4606
 Site-East_Asian               | Train Loss: 1.3414 | Train Acc: 0.5044
 Site-Indian                   | Train Loss: 1.4041 | Train Acc: 0.3740
 Site-Indian                   | Train Loss: 1.4449 | Train Acc: 0.4257
 Site-Southeast_Asian          | Train Loss: 1.5236 | Train Acc: 0.4675
 Site-Middle_Eastern           | Train Loss: 1.3706 | Train Acc: 0.4858
 Site-White                     (2) | Val  Loss: 1.1334 | Val  Acc: 0.4574
 Site-White                     (2) | Val  Loss: 1.4341 | Val  Acc: 0.4497
 Site-White                     (2) | Val  Loss: 1.4037 | Val  Acc: 0.4751
 Site-White                     (4) | Val  Loss: 1.3925 | Val  Acc: 0.4621
 Site-White                     (2) | Val  Loss: 1.3918 | Val  Acc: 0.4500
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4482 | Val  Acc: 0.4097
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4603 | Val  Acc: 0.4180
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4364 | Val  Acc: 0.4032
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4239 | Val  Acc: 0.4062
 Site-Black                     (1) | Val  Loss: 1.5361 | Val  Acc: 0.3895
 Site-Black                     (1) | Val  Loss: 1.5116 | Val  Acc: 0.3956
 Site-Black                     (1) | Val  Loss: 1.4808 | Val  Acc: 0.4237
 Site-East_Asian                (3) | Val  Loss: 1.3218 | Val  Acc: 0.5502
 Site-East_Asian                (3) | Val  Loss: 1.4062 | Val  Acc: 0.4749
 Site-Indian                    (0) | Val  Loss: 1.4648 | Val  Acc: 0.3736
 Site-Indian                    (5) | Val  Loss: 1.5418 | Val  Acc: 0.4105
 Site-Southeast_Asian           (5) | Val  Loss: 1.4729 | Val  Acc: 0.4545
 Site-Middle_Eastern            (0) | Val  Loss: 1.4222 | Val  Acc: 0.4145
Average Valid Accuracy: 0.4344
Aggregated Acc | Val Acc: 0.4397
 Best site-White                    (2)  | Epoch:26 | Val Acc: 0.4574
 Best site-White                    (2)  | Epoch:26 | Val Acc: 0.4497
 Best site-White                    (2)  | Epoch:26 | Val Acc: 0.4751
 Best site-White                    (4)  | Epoch:26 | Val Acc: 0.4621
 Best site-White                    (2)  | Epoch:26 | Val Acc: 0.4500
 Best site-Latino_Hispanic          (6)  | Epoch:26 | Val Acc: 0.4097
 Best site-Latino_Hispanic          (0)  | Epoch:26 | Val Acc: 0.4180
 Best site-Latino_Hispanic          (6)  | Epoch:26 | Val Acc: 0.4032
 Best site-Latino_Hispanic          (0)  | Epoch:26 | Val Acc: 0.4062
 Best site-Black                    (1)  | Epoch:26 | Val Acc: 0.3895
 Best site-Black                    (1)  | Epoch:26 | Val Acc: 0.3956
 Best site-Black                    (1)  | Epoch:26 | Val Acc: 0.4237
 Best site-East_Asian               (3)  | Epoch:26 | Val Acc: 0.5502
 Best site-East_Asian               (3)  | Epoch:26 | Val Acc: 0.4749
 Best site-Indian                   (0)  | Epoch:26 | Val Acc: 0.3736
 Best site-Indian                   (5)  | Epoch:26 | Val Acc: 0.4105
 Best site-Southeast_Asian          (5)  | Epoch:26 | Val Acc: 0.4545
 Best site-Middle_Eastern           (0)  | Epoch:26 | Val Acc: 0.4145
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 27 ============
cnt=[3, 4, 3, 2, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
min_w=0.07431, quan_i=1.52, quan_c=1.48
minimize weight of clients:[1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.3792 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3368 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.4316 | Train Acc: 0.4639
 Site-White                    | Train Loss: 1.3980 | Train Acc: 0.4587
 Site-White                    | Train Loss: 1.3602 | Train Acc: 0.4553
 Site-Latino_Hispanic          | Train Loss: 1.5449 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.4553 | Train Acc: 0.4085
 Site-Latino_Hispanic          | Train Loss: 1.4864 | Train Acc: 0.4236
 Site-Latino_Hispanic          | Train Loss: 1.4361 | Train Acc: 0.4037
 Site-Black                    | Train Loss: 1.6243 | Train Acc: 0.3643
 Site-Black                    | Train Loss: 1.5026 | Train Acc: 0.4349
 Site-Black                    | Train Loss: 1.5100 | Train Acc: 0.4063
 Site-East_Asian               | Train Loss: 1.4000 | Train Acc: 0.4840
 Site-East_Asian               | Train Loss: 1.2695 | Train Acc: 0.5089
 Site-Indian                   | Train Loss: 1.5341 | Train Acc: 0.4084
 Site-Indian                   | Train Loss: 1.4251 | Train Acc: 0.4286
 Site-Southeast_Asian          | Train Loss: 1.4747 | Train Acc: 0.4632
 Site-Middle_Eastern           | Train Loss: 1.3805 | Train Acc: 0.4489
 Site-White                     (2) | Val  Loss: 1.4848 | Val  Acc: 0.4264
 Site-White                     (2) | Val  Loss: 1.4242 | Val  Acc: 0.4911
 Site-White                     (2) | Val  Loss: 1.3755 | Val  Acc: 0.4661
 Site-White                     (4) | Val  Loss: 1.3764 | Val  Acc: 0.4586
 Site-White                     (6) | Val  Loss: 1.3622 | Val  Acc: 0.4789
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4577 | Val  Acc: 0.3958
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4156 | Val  Acc: 0.4286
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4443 | Val  Acc: 0.4315
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4469 | Val  Acc: 0.4062
 Site-Black                     (0) | Val  Loss: 1.5412 | Val  Acc: 0.3721
 Site-Black                     (0) | Val  Loss: 1.4977 | Val  Acc: 0.4044
 Site-Black                     (0) | Val  Loss: 1.4750 | Val  Acc: 0.4305
 Site-East_Asian                (3) | Val  Loss: 1.3350 | Val  Acc: 0.4978
 Site-East_Asian                (3) | Val  Loss: 1.3708 | Val  Acc: 0.4950
 Site-Indian                    (5) | Val  Loss: 1.4586 | Val  Acc: 0.3448
 Site-Indian                    (5) | Val  Loss: 1.5399 | Val  Acc: 0.3668
 Site-Southeast_Asian           (5) | Val  Loss: 1.4636 | Val  Acc: 0.4870
 Site-Middle_Eastern            (6) | Val  Loss: 1.4153 | Val  Acc: 0.4444
Average Valid Accuracy: 0.4348
Aggregated Acc | Val Acc: 0.4422
 Best site-White                    (2)  | Epoch:27 | Val Acc: 0.4264
 Best site-White                    (2)  | Epoch:27 | Val Acc: 0.4911
 Best site-White                    (2)  | Epoch:27 | Val Acc: 0.4661
 Best site-White                    (4)  | Epoch:27 | Val Acc: 0.4586
 Best site-White                    (6)  | Epoch:27 | Val Acc: 0.4789
 Best site-Latino_Hispanic          (1)  | Epoch:27 | Val Acc: 0.3958
 Best site-Latino_Hispanic          (1)  | Epoch:27 | Val Acc: 0.4286
 Best site-Latino_Hispanic          (1)  | Epoch:27 | Val Acc: 0.4315
 Best site-Latino_Hispanic          (1)  | Epoch:27 | Val Acc: 0.4062
 Best site-Black                    (0)  | Epoch:27 | Val Acc: 0.3721
 Best site-Black                    (0)  | Epoch:27 | Val Acc: 0.4044
 Best site-Black                    (0)  | Epoch:27 | Val Acc: 0.4305
 Best site-East_Asian               (3)  | Epoch:27 | Val Acc: 0.4978
 Best site-East_Asian               (3)  | Epoch:27 | Val Acc: 0.4950
 Best site-Indian                   (5)  | Epoch:27 | Val Acc: 0.3448
 Best site-Indian                   (5)  | Epoch:27 | Val Acc: 0.3668
 Best site-Southeast_Asian          (5)  | Epoch:27 | Val Acc: 0.4870
 Best site-Middle_Eastern           (6)  | Epoch:27 | Val Acc: 0.4444
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 28 ============
cnt=[1, 3, 2, 3, 3, 2, 4, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
min_w=0.05864, quan_i=1.52, quan_c=1.48
minimize weight of clients:[0, 1, 2, 3, 4, 7, 12, 13, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.2752 | Train Acc: 0.4767
 Site-White                    | Train Loss: 1.3635 | Train Acc: 0.4528
 Site-White                    | Train Loss: 1.4229 | Train Acc: 0.4398
 Site-White                    | Train Loss: 1.3946 | Train Acc: 0.4725
 Site-White                    | Train Loss: 1.3656 | Train Acc: 0.4694
 Site-Latino_Hispanic          | Train Loss: 1.4700 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.4221 | Train Acc: 0.4472
 Site-Latino_Hispanic          | Train Loss: 1.4479 | Train Acc: 0.4102
 Site-Latino_Hispanic          | Train Loss: 1.4146 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.5562 | Train Acc: 0.3798
 Site-Black                    | Train Loss: 1.5068 | Train Acc: 0.4379
 Site-Black                    | Train Loss: 1.4820 | Train Acc: 0.4221
 Site-East_Asian               | Train Loss: 1.3774 | Train Acc: 0.4577
 Site-East_Asian               | Train Loss: 1.3713 | Train Acc: 0.4956
 Site-Indian                   | Train Loss: 1.5160 | Train Acc: 0.4351
 Site-Indian                   | Train Loss: 1.4662 | Train Acc: 0.4315
 Site-Southeast_Asian          | Train Loss: 1.4476 | Train Acc: 0.4827
 Site-Middle_Eastern           | Train Loss: 1.3455 | Train Acc: 0.4858
 Site-White                     (6) | Val  Loss: 1.2122 | Val  Acc: 0.4574
 Site-White                     (0) | Val  Loss: 1.4212 | Val  Acc: 0.4675
 Site-White                     (6) | Val  Loss: 1.3549 | Val  Acc: 0.5158
 Site-White                     (6) | Val  Loss: 1.3751 | Val  Acc: 0.4759
 Site-White                     (6) | Val  Loss: 1.3846 | Val  Acc: 0.4500
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4472 | Val  Acc: 0.3750
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4404 | Val  Acc: 0.4233
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4228 | Val  Acc: 0.4315
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4392 | Val  Acc: 0.4123
 Site-Black                     (1) | Val  Loss: 1.5418 | Val  Acc: 0.3953
 Site-Black                     (1) | Val  Loss: 1.4761 | Val  Acc: 0.4267
 Site-Black                     (1) | Val  Loss: 1.4471 | Val  Acc: 0.4407
 Site-East_Asian                (3) | Val  Loss: 1.3348 | Val  Acc: 0.4803
 Site-East_Asian                (3) | Val  Loss: 1.3852 | Val  Acc: 0.4649
 Site-Indian                    (2) | Val  Loss: 1.4459 | Val  Acc: 0.4138
 Site-Indian                    (2) | Val  Loss: 1.5465 | Val  Acc: 0.3886
 Site-Southeast_Asian           (3) | Val  Loss: 1.4444 | Val  Acc: 0.4675
 Site-Middle_Eastern            (5) | Val  Loss: 1.4353 | Val  Acc: 0.4231
Average Valid Accuracy: 0.4394
Aggregated Acc | Val Acc: 0.4380
 Best site-White                    (6)  | Epoch:28 | Val Acc: 0.4574
 Best site-White                    (0)  | Epoch:28 | Val Acc: 0.4675
 Best site-White                    (6)  | Epoch:28 | Val Acc: 0.5158
 Best site-White                    (6)  | Epoch:28 | Val Acc: 0.4759
 Best site-White                    (6)  | Epoch:28 | Val Acc: 0.4500
 Best site-Latino_Hispanic          (4)  | Epoch:28 | Val Acc: 0.3750
 Best site-Latino_Hispanic          (4)  | Epoch:28 | Val Acc: 0.4233
 Best site-Latino_Hispanic          (5)  | Epoch:28 | Val Acc: 0.4315
 Best site-Latino_Hispanic          (4)  | Epoch:28 | Val Acc: 0.4123
 Best site-Black                    (1)  | Epoch:28 | Val Acc: 0.3953
 Best site-Black                    (1)  | Epoch:28 | Val Acc: 0.4267
 Best site-Black                    (1)  | Epoch:28 | Val Acc: 0.4407
 Best site-East_Asian               (3)  | Epoch:28 | Val Acc: 0.4803
 Best site-East_Asian               (3)  | Epoch:28 | Val Acc: 0.4649
 Best site-Indian                   (2)  | Epoch:28 | Val Acc: 0.4138
 Best site-Indian                   (2)  | Epoch:28 | Val Acc: 0.3886
 Best site-Southeast_Asian          (3)  | Epoch:28 | Val Acc: 0.4675
 Best site-Middle_Eastern           (5)  | Epoch:28 | Val Acc: 0.4231
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 29 ============
cnt=[5, 3, 4, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
min_w=0.05322, quan_i=1.48, quan_c=1.50
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 16, 17, ]
 Site-White                    | Train Loss: 1.2636 | Train Acc: 0.5078
 Site-White                    | Train Loss: 1.3405 | Train Acc: 0.4882
 Site-White                    | Train Loss: 1.4173 | Train Acc: 0.4337
 Site-White                    | Train Loss: 1.3834 | Train Acc: 0.4794
 Site-White                    | Train Loss: 1.3726 | Train Acc: 0.4746
 Site-Latino_Hispanic          | Train Loss: 1.4845 | Train Acc: 0.4055
 Site-Latino_Hispanic          | Train Loss: 1.4774 | Train Acc: 0.4190
 Site-Latino_Hispanic          | Train Loss: 1.4453 | Train Acc: 0.4263
 Site-Latino_Hispanic          | Train Loss: 1.4176 | Train Acc: 0.4242
 Site-Black                    | Train Loss: 1.3846 | Train Acc: 0.4070
 Site-Black                    | Train Loss: 1.4876 | Train Acc: 0.4349
 Site-Black                    | Train Loss: 1.4862 | Train Acc: 0.4108
 Site-East_Asian               | Train Loss: 1.4005 | Train Acc: 0.4286
 Site-East_Asian               | Train Loss: 1.3086 | Train Acc: 0.4622
 Site-Indian                   | Train Loss: 1.4982 | Train Acc: 0.4237
 Site-Indian                   | Train Loss: 1.4388 | Train Acc: 0.4198
 Site-Southeast_Asian          | Train Loss: 1.4679 | Train Acc: 0.4719
 Site-Middle_Eastern           | Train Loss: 1.3688 | Train Acc: 0.4886
 Site-White                     (0) | Val  Loss: 1.2889 | Val  Acc: 0.4419
 Site-White                     (0) | Val  Loss: 1.4330 | Val  Acc: 0.4911
 Site-White                     (0) | Val  Loss: 1.3865 | Val  Acc: 0.4977
 Site-White                     (0) | Val  Loss: 1.3818 | Val  Acc: 0.4448
 Site-White                     (0) | Val  Loss: 1.3871 | Val  Acc: 0.4658
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4190 | Val  Acc: 0.4236
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4338 | Val  Acc: 0.4127
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4266 | Val  Acc: 0.4395
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4268 | Val  Acc: 0.3877
 Site-Black                     (1) | Val  Loss: 1.5269 | Val  Acc: 0.3837
 Site-Black                     (1) | Val  Loss: 1.4181 | Val  Acc: 0.4311
 Site-Black                     (1) | Val  Loss: 1.4531 | Val  Acc: 0.4576
 Site-East_Asian                (6) | Val  Loss: 1.3653 | Val  Acc: 0.4716
 Site-East_Asian                (6) | Val  Loss: 1.4037 | Val  Acc: 0.4548
 Site-Indian                    (4) | Val  Loss: 1.4299 | Val  Acc: 0.4023
 Site-Indian                    (4) | Val  Loss: 1.5349 | Val  Acc: 0.3974
 Site-Southeast_Asian           (3) | Val  Loss: 1.4795 | Val  Acc: 0.4481
 Site-Middle_Eastern            (5) | Val  Loss: 1.4301 | Val  Acc: 0.4231
Average Valid Accuracy: 0.4375
Aggregated Acc | Val Acc: 0.4346
============ Train epoch 30 ============
cnt=[4, 3, 1, 2, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
min_w=0.05226, quan_i=1.49, quan_c=1.47
minimize weight of clients:[0, 1, 2, 3, 4, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.6632 | Train Acc: 0.4715
 Site-White                    | Train Loss: 1.3146 | Train Acc: 0.4685
 Site-White                    | Train Loss: 1.3936 | Train Acc: 0.4578
 Site-White                    | Train Loss: 1.3725 | Train Acc: 0.4771
 Site-White                    | Train Loss: 1.3506 | Train Acc: 0.4694
 Site-Latino_Hispanic          | Train Loss: 1.5132 | Train Acc: 0.3594
 Site-Latino_Hispanic          | Train Loss: 1.4332 | Train Acc: 0.3627
 Site-Latino_Hispanic          | Train Loss: 1.4499 | Train Acc: 0.4129
 Site-Latino_Hispanic          | Train Loss: 1.4158 | Train Acc: 0.4242
 Site-Black                    | Train Loss: 1.6818 | Train Acc: 0.3643
 Site-Black                    | Train Loss: 1.4792 | Train Acc: 0.3994
 Site-Black                    | Train Loss: 1.4953 | Train Acc: 0.3905
 Site-East_Asian               | Train Loss: 1.3772 | Train Acc: 0.4694
 Site-East_Asian               | Train Loss: 1.2801 | Train Acc: 0.5178
 Site-Indian                   | Train Loss: 1.5261 | Train Acc: 0.3931
 Site-Indian                   | Train Loss: 1.3750 | Train Acc: 0.4227
 Site-Southeast_Asian          | Train Loss: 1.4295 | Train Acc: 0.4870
 Site-Middle_Eastern           | Train Loss: 1.3675 | Train Acc: 0.4545
 Site-White                     (5) | Val  Loss: 1.3377 | Val  Acc: 0.4651
 Site-White                     (5) | Val  Loss: 1.4077 | Val  Acc: 0.4497
 Site-White                     (5) | Val  Loss: 1.3479 | Val  Acc: 0.4887
 Site-White                     (4) | Val  Loss: 1.3842 | Val  Acc: 0.4448
 Site-White                     (5) | Val  Loss: 1.3613 | Val  Acc: 0.4737
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4244 | Val  Acc: 0.4444
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4300 | Val  Acc: 0.4233
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4600 | Val  Acc: 0.4113
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4025 | Val  Acc: 0.3785
 Site-Black                     (1) | Val  Loss: 1.5439 | Val  Acc: 0.3721
 Site-Black                     (1) | Val  Loss: 1.5083 | Val  Acc: 0.3511
 Site-Black                     (1) | Val  Loss: 1.4706 | Val  Acc: 0.4441
 Site-East_Asian                (3) | Val  Loss: 1.3223 | Val  Acc: 0.5022
 Site-East_Asian                (3) | Val  Loss: 1.3880 | Val  Acc: 0.4649
 Site-Indian                    (6) | Val  Loss: 1.3895 | Val  Acc: 0.4195
 Site-Indian                    (6) | Val  Loss: 1.5223 | Val  Acc: 0.4017
 Site-Southeast_Asian           (2) | Val  Loss: 1.4380 | Val  Acc: 0.4675
 Site-Middle_Eastern            (5) | Val  Loss: 1.4290 | Val  Acc: 0.4402
Average Valid Accuracy: 0.4357
Aggregated Acc | Val Acc: 0.4391
============ Train epoch 31 ============
cnt=[2, 5, 2, 4, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
min_w=0.07081, quan_i=1.52, quan_c=1.46
minimize weight of clients:[1, 2, 3, 4, 12, 13, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.4630 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3586 | Train Acc: 0.4961
 Site-White                    | Train Loss: 1.3710 | Train Acc: 0.4398
 Site-White                    | Train Loss: 1.3844 | Train Acc: 0.4817
 Site-White                    | Train Loss: 1.3597 | Train Acc: 0.4658
 Site-Latino_Hispanic          | Train Loss: 1.4665 | Train Acc: 0.4332
 Site-Latino_Hispanic          | Train Loss: 1.4223 | Train Acc: 0.4085
 Site-Latino_Hispanic          | Train Loss: 1.4383 | Train Acc: 0.4155
 Site-Latino_Hispanic          | Train Loss: 1.4018 | Train Acc: 0.4467
 Site-Black                    | Train Loss: 1.5038 | Train Acc: 0.3876
 Site-Black                    | Train Loss: 1.4485 | Train Acc: 0.4645
 Site-Black                    | Train Loss: 1.4774 | Train Acc: 0.4018
 Site-East_Asian               | Train Loss: 1.3990 | Train Acc: 0.4636
 Site-East_Asian               | Train Loss: 1.3367 | Train Acc: 0.4889
 Site-Indian                   | Train Loss: 1.3892 | Train Acc: 0.4542
 Site-Indian                   | Train Loss: 1.4515 | Train Acc: 0.4286
 Site-Southeast_Asian          | Train Loss: 1.4474 | Train Acc: 0.4827
 Site-Middle_Eastern           | Train Loss: 1.3590 | Train Acc: 0.4830
 Site-White                     (1) | Val  Loss: 1.3089 | Val  Acc: 0.4574
 Site-White                     (1) | Val  Loss: 1.3876 | Val  Acc: 0.4556
 Site-White                     (1) | Val  Loss: 1.3655 | Val  Acc: 0.4661
 Site-White                     (1) | Val  Loss: 1.3696 | Val  Acc: 0.4655
 Site-White                     (1) | Val  Loss: 1.3579 | Val  Acc: 0.4684
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4210 | Val  Acc: 0.4444
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4088 | Val  Acc: 0.4286
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4225 | Val  Acc: 0.4274
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4130 | Val  Acc: 0.4154
 Site-Black                     (2) | Val  Loss: 1.5173 | Val  Acc: 0.4012
 Site-Black                     (6) | Val  Loss: 1.4834 | Val  Acc: 0.3867
 Site-Black                     (2) | Val  Loss: 1.4279 | Val  Acc: 0.4542
 Site-East_Asian                (4) | Val  Loss: 1.3520 | Val  Acc: 0.4629
 Site-East_Asian                (4) | Val  Loss: 1.3961 | Val  Acc: 0.4515
 Site-Indian                    (0) | Val  Loss: 1.4170 | Val  Acc: 0.3736
 Site-Indian                    (0) | Val  Loss: 1.5239 | Val  Acc: 0.4279
 Site-Southeast_Asian           (4) | Val  Loss: 1.4507 | Val  Acc: 0.4545
 Site-Middle_Eastern            (5) | Val  Loss: 1.4251 | Val  Acc: 0.4530
Average Valid Accuracy: 0.4386
Aggregated Acc | Val Acc: 0.4309
============ Train epoch 32 ============
cnt=[1, 4, 2, 3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
min_w=0.06189, quan_i=1.47, quan_c=1.44
minimize weight of clients:[1, 2, 3, 4, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.3326 | Train Acc: 0.4974
 Site-White                    | Train Loss: 1.3362 | Train Acc: 0.4882
 Site-White                    | Train Loss: 1.3903 | Train Acc: 0.4277
 Site-White                    | Train Loss: 1.3633 | Train Acc: 0.4794
 Site-White                    | Train Loss: 1.3585 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.5003 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.4577 | Train Acc: 0.4049
 Site-Latino_Hispanic          | Train Loss: 1.4544 | Train Acc: 0.4102
 Site-Latino_Hispanic          | Train Loss: 1.4079 | Train Acc: 0.4139
 Site-Black                    | Train Loss: 1.7100 | Train Acc: 0.3643
 Site-Black                    | Train Loss: 1.4949 | Train Acc: 0.4290
 Site-Black                    | Train Loss: 1.4850 | Train Acc: 0.4176
 Site-East_Asian               | Train Loss: 1.3588 | Train Acc: 0.4606
 Site-East_Asian               | Train Loss: 1.2921 | Train Acc: 0.4889
 Site-Indian                   | Train Loss: 1.4456 | Train Acc: 0.4122
 Site-Indian                   | Train Loss: 1.4479 | Train Acc: 0.4373
 Site-Southeast_Asian          | Train Loss: 1.4240 | Train Acc: 0.4784
 Site-Middle_Eastern           | Train Loss: 1.3642 | Train Acc: 0.4744
 Site-White                     (3) | Val  Loss: 1.0877 | Val  Acc: 0.4341
 Site-White                     (6) | Val  Loss: 1.4079 | Val  Acc: 0.4379
 Site-White                     (6) | Val  Loss: 1.3778 | Val  Acc: 0.4842
 Site-White                     (3) | Val  Loss: 1.3834 | Val  Acc: 0.4345
 Site-White                     (3) | Val  Loss: 1.3399 | Val  Acc: 0.4868
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4080 | Val  Acc: 0.4306
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4120 | Val  Acc: 0.4339
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4213 | Val  Acc: 0.4234
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4092 | Val  Acc: 0.3969
 Site-Black                     (5) | Val  Loss: 1.4910 | Val  Acc: 0.4244
 Site-Black                     (0) | Val  Loss: 1.4674 | Val  Acc: 0.4178
 Site-Black                     (5) | Val  Loss: 1.4375 | Val  Acc: 0.4102
 Site-East_Asian                (2) | Val  Loss: 1.3240 | Val  Acc: 0.5240
 Site-East_Asian                (2) | Val  Loss: 1.3783 | Val  Acc: 0.4816
 Site-Indian                    (4) | Val  Loss: 1.3772 | Val  Acc: 0.4138
 Site-Indian                    (4) | Val  Loss: 1.5213 | Val  Acc: 0.4192
 Site-Southeast_Asian           (4) | Val  Loss: 1.4219 | Val  Acc: 0.4578
 Site-Middle_Eastern            (1) | Val  Loss: 1.4352 | Val  Acc: 0.4060
Average Valid Accuracy: 0.4398
Aggregated Acc | Val Acc: 0.4423
 Best site-White                    (3)  | Epoch:32 | Val Acc: 0.4341
 Best site-White                    (6)  | Epoch:32 | Val Acc: 0.4379
 Best site-White                    (6)  | Epoch:32 | Val Acc: 0.4842
 Best site-White                    (3)  | Epoch:32 | Val Acc: 0.4345
 Best site-White                    (3)  | Epoch:32 | Val Acc: 0.4868
 Best site-Latino_Hispanic          (1)  | Epoch:32 | Val Acc: 0.4306
 Best site-Latino_Hispanic          (4)  | Epoch:32 | Val Acc: 0.4339
 Best site-Latino_Hispanic          (1)  | Epoch:32 | Val Acc: 0.4234
 Best site-Latino_Hispanic          (1)  | Epoch:32 | Val Acc: 0.3969
 Best site-Black                    (5)  | Epoch:32 | Val Acc: 0.4244
 Best site-Black                    (0)  | Epoch:32 | Val Acc: 0.4178
 Best site-Black                    (5)  | Epoch:32 | Val Acc: 0.4102
 Best site-East_Asian               (2)  | Epoch:32 | Val Acc: 0.5240
 Best site-East_Asian               (2)  | Epoch:32 | Val Acc: 0.4816
 Best site-Indian                   (4)  | Epoch:32 | Val Acc: 0.4138
 Best site-Indian                   (4)  | Epoch:32 | Val Acc: 0.4192
 Best site-Southeast_Asian          (4)  | Epoch:32 | Val Acc: 0.4578
 Best site-Middle_Eastern           (1)  | Epoch:32 | Val Acc: 0.4060
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 5, 3, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
min_w=0.05507, quan_i=1.48, quan_c=1.49
minimize weight of clients:[0, 1, 2, 3, 4, 6, 8, 12, 13, 14, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.1909 | Train Acc: 0.4922
 Site-White                    | Train Loss: 1.3319 | Train Acc: 0.4961
 Site-White                    | Train Loss: 1.3907 | Train Acc: 0.4548
 Site-White                    | Train Loss: 1.3716 | Train Acc: 0.4908
 Site-White                    | Train Loss: 1.3566 | Train Acc: 0.4606
 Site-Latino_Hispanic          | Train Loss: 1.5194 | Train Acc: 0.4055
 Site-Latino_Hispanic          | Train Loss: 1.4112 | Train Acc: 0.4190
 Site-Latino_Hispanic          | Train Loss: 1.4485 | Train Acc: 0.4155
 Site-Latino_Hispanic          | Train Loss: 1.4036 | Train Acc: 0.4344
 Site-Black                    | Train Loss: 1.7026 | Train Acc: 0.3682
 Site-Black                    | Train Loss: 1.4079 | Train Acc: 0.4586
 Site-Black                    | Train Loss: 1.4719 | Train Acc: 0.4402
 Site-East_Asian               | Train Loss: 1.4170 | Train Acc: 0.4694
 Site-East_Asian               | Train Loss: 1.2493 | Train Acc: 0.5133
 Site-Indian                   | Train Loss: 1.4125 | Train Acc: 0.4160
 Site-Indian                   | Train Loss: 1.4358 | Train Acc: 0.4227
 Site-Southeast_Asian          | Train Loss: 1.5014 | Train Acc: 0.4502
 Site-Middle_Eastern           | Train Loss: 1.3413 | Train Acc: 0.4801
 Site-White                     (2) | Val  Loss: 1.3480 | Val  Acc: 0.3876
 Site-White                     (2) | Val  Loss: 1.3951 | Val  Acc: 0.4734
 Site-White                     (2) | Val  Loss: 1.3699 | Val  Acc: 0.4977
 Site-White                     (2) | Val  Loss: 1.3638 | Val  Acc: 0.4483
 Site-White                     (2) | Val  Loss: 1.3394 | Val  Acc: 0.4868
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3883 | Val  Acc: 0.4514
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3903 | Val  Acc: 0.4339
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4118 | Val  Acc: 0.4153
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3918 | Val  Acc: 0.4462
 Site-Black                     (3) | Val  Loss: 1.5069 | Val  Acc: 0.4070
 Site-Black                     (3) | Val  Loss: 1.4548 | Val  Acc: 0.4222
 Site-Black                     (3) | Val  Loss: 1.4303 | Val  Acc: 0.4508
 Site-East_Asian                (5) | Val  Loss: 1.3388 | Val  Acc: 0.5066
 Site-East_Asian                (5) | Val  Loss: 1.3960 | Val  Acc: 0.4615
 Site-Indian                    (1) | Val  Loss: 1.3829 | Val  Acc: 0.4310
 Site-Indian                    (4) | Val  Loss: 1.5262 | Val  Acc: 0.3843
 Site-Southeast_Asian           (5) | Val  Loss: 1.4466 | Val  Acc: 0.4481
 Site-Middle_Eastern            (6) | Val  Loss: 1.4200 | Val  Acc: 0.4316
Average Valid Accuracy: 0.4435
Aggregated Acc | Val Acc: 0.4393
 Best site-White                    (2)  | Epoch:33 | Val Acc: 0.3876
 Best site-White                    (2)  | Epoch:33 | Val Acc: 0.4734
 Best site-White                    (2)  | Epoch:33 | Val Acc: 0.4977
 Best site-White                    (2)  | Epoch:33 | Val Acc: 0.4483
 Best site-White                    (2)  | Epoch:33 | Val Acc: 0.4868
 Best site-Latino_Hispanic          (0)  | Epoch:33 | Val Acc: 0.4514
 Best site-Latino_Hispanic          (4)  | Epoch:33 | Val Acc: 0.4339
 Best site-Latino_Hispanic          (0)  | Epoch:33 | Val Acc: 0.4153
 Best site-Latino_Hispanic          (4)  | Epoch:33 | Val Acc: 0.4462
 Best site-Black                    (3)  | Epoch:33 | Val Acc: 0.4070
 Best site-Black                    (3)  | Epoch:33 | Val Acc: 0.4222
 Best site-Black                    (3)  | Epoch:33 | Val Acc: 0.4508
 Best site-East_Asian               (5)  | Epoch:33 | Val Acc: 0.5066
 Best site-East_Asian               (5)  | Epoch:33 | Val Acc: 0.4615
 Best site-Indian                   (1)  | Epoch:33 | Val Acc: 0.4310
 Best site-Indian                   (4)  | Epoch:33 | Val Acc: 0.3843
 Best site-Southeast_Asian          (5)  | Epoch:33 | Val Acc: 0.4481
 Best site-Middle_Eastern           (6)  | Epoch:33 | Val Acc: 0.4316
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 3, 5, 4, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
min_w=0.04922, quan_i=1.48, quan_c=1.47
minimize weight of clients:[0, 1, 2, 3, 4, 6, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.3345 | Train Acc: 0.4715
 Site-White                    | Train Loss: 1.3226 | Train Acc: 0.4843
 Site-White                    | Train Loss: 1.3466 | Train Acc: 0.4428
 Site-White                    | Train Loss: 1.3764 | Train Acc: 0.4885
 Site-White                    | Train Loss: 1.3423 | Train Acc: 0.4729
 Site-Latino_Hispanic          | Train Loss: 1.4259 | Train Acc: 0.4009
 Site-Latino_Hispanic          | Train Loss: 1.4215 | Train Acc: 0.4155
 Site-Latino_Hispanic          | Train Loss: 1.4272 | Train Acc: 0.4129
 Site-Latino_Hispanic          | Train Loss: 1.3954 | Train Acc: 0.4385
 Site-Black                    | Train Loss: 1.4833 | Train Acc: 0.3566
 Site-Black                    | Train Loss: 1.4483 | Train Acc: 0.4497
 Site-Black                    | Train Loss: 1.4559 | Train Acc: 0.4312
 Site-East_Asian               | Train Loss: 1.4200 | Train Acc: 0.4636
 Site-East_Asian               | Train Loss: 1.3419 | Train Acc: 0.4978
 Site-Indian                   | Train Loss: 1.5128 | Train Acc: 0.4198
 Site-Indian                   | Train Loss: 1.4315 | Train Acc: 0.4286
 Site-Southeast_Asian          | Train Loss: 1.4732 | Train Acc: 0.4762
 Site-Middle_Eastern           | Train Loss: 1.3570 | Train Acc: 0.4744
 Site-White                     (2) | Val  Loss: 1.5754 | Val  Acc: 0.4341
 Site-White                     (2) | Val  Loss: 1.3813 | Val  Acc: 0.4970
 Site-White                     (2) | Val  Loss: 1.3396 | Val  Acc: 0.4661
 Site-White                     (2) | Val  Loss: 1.3635 | Val  Acc: 0.4517
 Site-White                     (2) | Val  Loss: 1.3525 | Val  Acc: 0.4632
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3798 | Val  Acc: 0.4444
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3885 | Val  Acc: 0.4392
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3988 | Val  Acc: 0.4395
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4070 | Val  Acc: 0.3938
 Site-Black                     (1) | Val  Loss: 1.4832 | Val  Acc: 0.4012
 Site-Black                     (1) | Val  Loss: 1.4295 | Val  Acc: 0.4267
 Site-Black                     (1) | Val  Loss: 1.4266 | Val  Acc: 0.4542
 Site-East_Asian                (5) | Val  Loss: 1.3294 | Val  Acc: 0.5153
 Site-East_Asian                (5) | Val  Loss: 1.4078 | Val  Acc: 0.4582
 Site-Indian                    (6) | Val  Loss: 1.3710 | Val  Acc: 0.4253
 Site-Indian                    (6) | Val  Loss: 1.5079 | Val  Acc: 0.4105
 Site-Southeast_Asian           (3) | Val  Loss: 1.4615 | Val  Acc: 0.4513
 Site-Middle_Eastern            (4) | Val  Loss: 1.4162 | Val  Acc: 0.4487
Average Valid Accuracy: 0.4456
Aggregated Acc | Val Acc: 0.4449
 Best site-White                    (2)  | Epoch:34 | Val Acc: 0.4341
 Best site-White                    (2)  | Epoch:34 | Val Acc: 0.4970
 Best site-White                    (2)  | Epoch:34 | Val Acc: 0.4661
 Best site-White                    (2)  | Epoch:34 | Val Acc: 0.4517
 Best site-White                    (2)  | Epoch:34 | Val Acc: 0.4632
 Best site-Latino_Hispanic          (3)  | Epoch:34 | Val Acc: 0.4444
 Best site-Latino_Hispanic          (0)  | Epoch:34 | Val Acc: 0.4392
 Best site-Latino_Hispanic          (3)  | Epoch:34 | Val Acc: 0.4395
 Best site-Latino_Hispanic          (3)  | Epoch:34 | Val Acc: 0.3938
 Best site-Black                    (1)  | Epoch:34 | Val Acc: 0.4012
 Best site-Black                    (1)  | Epoch:34 | Val Acc: 0.4267
 Best site-Black                    (1)  | Epoch:34 | Val Acc: 0.4542
 Best site-East_Asian               (5)  | Epoch:34 | Val Acc: 0.5153
 Best site-East_Asian               (5)  | Epoch:34 | Val Acc: 0.4582
 Best site-Indian                   (6)  | Epoch:34 | Val Acc: 0.4253
 Best site-Indian                   (6)  | Epoch:34 | Val Acc: 0.4105
 Best site-Southeast_Asian          (3)  | Epoch:34 | Val Acc: 0.4513
 Best site-Middle_Eastern           (4)  | Epoch:34 | Val Acc: 0.4487
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 3, 3, 1, 3, 5, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
min_w=0.05512, quan_i=1.46, quan_c=1.47
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.3458 | Train Acc: 0.4715
 Site-White                    | Train Loss: 1.3504 | Train Acc: 0.4409
 Site-White                    | Train Loss: 1.4206 | Train Acc: 0.4428
 Site-White                    | Train Loss: 1.3644 | Train Acc: 0.4839
 Site-White                    | Train Loss: 1.3427 | Train Acc: 0.4694
 Site-Latino_Hispanic          | Train Loss: 1.5094 | Train Acc: 0.4424
 Site-Latino_Hispanic          | Train Loss: 1.4437 | Train Acc: 0.4190
 Site-Latino_Hispanic          | Train Loss: 1.4431 | Train Acc: 0.4209
 Site-Latino_Hispanic          | Train Loss: 1.4050 | Train Acc: 0.3934
 Site-Black                    | Train Loss: 1.6481 | Train Acc: 0.3915
 Site-Black                    | Train Loss: 1.4404 | Train Acc: 0.4556
 Site-Black                    | Train Loss: 1.4799 | Train Acc: 0.3995
 Site-East_Asian               | Train Loss: 1.4183 | Train Acc: 0.4519
 Site-East_Asian               | Train Loss: 1.4120 | Train Acc: 0.5044
 Site-Indian                   | Train Loss: 1.4508 | Train Acc: 0.4542
 Site-Indian                   | Train Loss: 1.4169 | Train Acc: 0.4140
 Site-Southeast_Asian          | Train Loss: 1.4339 | Train Acc: 0.4913
 Site-Middle_Eastern           | Train Loss: 1.3470 | Train Acc: 0.4716
 Site-White                     (5) | Val  Loss: 1.0908 | Val  Acc: 0.4806
 Site-White                     (5) | Val  Loss: 1.3861 | Val  Acc: 0.4734
 Site-White                     (5) | Val  Loss: 1.3434 | Val  Acc: 0.4796
 Site-White                     (3) | Val  Loss: 1.3595 | Val  Acc: 0.4552
 Site-White                     (5) | Val  Loss: 1.3504 | Val  Acc: 0.4553
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4324 | Val  Acc: 0.4097
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4316 | Val  Acc: 0.4233
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4115 | Val  Acc: 0.4234
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3789 | Val  Acc: 0.4215
 Site-Black                     (2) | Val  Loss: 1.5530 | Val  Acc: 0.3721
 Site-Black                     (2) | Val  Loss: 1.4499 | Val  Acc: 0.4133
 Site-Black                     (2) | Val  Loss: 1.4808 | Val  Acc: 0.4305
 Site-East_Asian                (4) | Val  Loss: 1.3208 | Val  Acc: 0.5153
 Site-East_Asian                (4) | Val  Loss: 1.3786 | Val  Acc: 0.4515
 Site-Indian                    (0) | Val  Loss: 1.3990 | Val  Acc: 0.4195
 Site-Indian                    (0) | Val  Loss: 1.4980 | Val  Acc: 0.4105
 Site-Southeast_Asian           (4) | Val  Loss: 1.4198 | Val  Acc: 0.4675
 Site-Middle_Eastern            (5) | Val  Loss: 1.4097 | Val  Acc: 0.4573
Average Valid Accuracy: 0.4422
Aggregated Acc | Val Acc: 0.4376
============ Train epoch 36 ============
cnt=[3, 5, 2, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
min_w=0.05619, quan_i=1.46, quan_c=1.45
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 16, 17, ]
 Site-White                    | Train Loss: 1.1279 | Train Acc: 0.5026
 Site-White                    | Train Loss: 1.3154 | Train Acc: 0.4961
 Site-White                    | Train Loss: 1.3996 | Train Acc: 0.4398
 Site-White                    | Train Loss: 1.3534 | Train Acc: 0.4908
 Site-White                    | Train Loss: 1.3358 | Train Acc: 0.4816
 Site-Latino_Hispanic          | Train Loss: 1.4629 | Train Acc: 0.4009
 Site-Latino_Hispanic          | Train Loss: 1.4269 | Train Acc: 0.4366
 Site-Latino_Hispanic          | Train Loss: 1.4505 | Train Acc: 0.4236
 Site-Latino_Hispanic          | Train Loss: 1.3972 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.5260 | Train Acc: 0.3876
 Site-Black                    | Train Loss: 1.4767 | Train Acc: 0.4112
 Site-Black                    | Train Loss: 1.4700 | Train Acc: 0.4402
 Site-East_Asian               | Train Loss: 1.4420 | Train Acc: 0.4227
 Site-East_Asian               | Train Loss: 1.2630 | Train Acc: 0.4911
 Site-Indian                   | Train Loss: 1.4144 | Train Acc: 0.4313
 Site-Indian                   | Train Loss: 1.3856 | Train Acc: 0.4548
 Site-Southeast_Asian          | Train Loss: 1.4250 | Train Acc: 0.4957
 Site-Middle_Eastern           | Train Loss: 1.3682 | Train Acc: 0.4886
 Site-White                     (4) | Val  Loss: 1.1046 | Val  Acc: 0.4496
 Site-White                     (4) | Val  Loss: 1.4067 | Val  Acc: 0.4675
 Site-White                     (4) | Val  Loss: 1.3623 | Val  Acc: 0.4751
 Site-White                     (4) | Val  Loss: 1.3554 | Val  Acc: 0.4621
 Site-White                     (6) | Val  Loss: 1.3527 | Val  Acc: 0.4500
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3980 | Val  Acc: 0.4444
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3951 | Val  Acc: 0.4656
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4077 | Val  Acc: 0.4395
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3929 | Val  Acc: 0.4154
 Site-Black                     (0) | Val  Loss: 1.4898 | Val  Acc: 0.3895
 Site-Black                     (0) | Val  Loss: 1.4513 | Val  Acc: 0.4133
 Site-Black                     (0) | Val  Loss: 1.4297 | Val  Acc: 0.4712
 Site-East_Asian                (3) | Val  Loss: 1.3348 | Val  Acc: 0.5066
 Site-East_Asian                (3) | Val  Loss: 1.3904 | Val  Acc: 0.4950
 Site-Indian                    (2) | Val  Loss: 1.3730 | Val  Acc: 0.4195
 Site-Indian                    (2) | Val  Loss: 1.5057 | Val  Acc: 0.4061
 Site-Southeast_Asian           (1) | Val  Loss: 1.4321 | Val  Acc: 0.4610
 Site-Middle_Eastern            (5) | Val  Loss: 1.3998 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4503
Aggregated Acc | Val Acc: 0.4531
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.4496
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.4675
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.4751
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.4621
 Best site-White                    (6)  | Epoch:36 | Val Acc: 0.4500
 Best site-Latino_Hispanic          (1)  | Epoch:36 | Val Acc: 0.4444
 Best site-Latino_Hispanic          (1)  | Epoch:36 | Val Acc: 0.4656
 Best site-Latino_Hispanic          (1)  | Epoch:36 | Val Acc: 0.4395
 Best site-Latino_Hispanic          (1)  | Epoch:36 | Val Acc: 0.4154
 Best site-Black                    (0)  | Epoch:36 | Val Acc: 0.3895
 Best site-Black                    (0)  | Epoch:36 | Val Acc: 0.4133
 Best site-Black                    (0)  | Epoch:36 | Val Acc: 0.4712
 Best site-East_Asian               (3)  | Epoch:36 | Val Acc: 0.5066
 Best site-East_Asian               (3)  | Epoch:36 | Val Acc: 0.4950
 Best site-Indian                   (2)  | Epoch:36 | Val Acc: 0.4195
 Best site-Indian                   (2)  | Epoch:36 | Val Acc: 0.4061
 Best site-Southeast_Asian          (1)  | Epoch:36 | Val Acc: 0.4610
 Best site-Middle_Eastern           (5)  | Epoch:36 | Val Acc: 0.4744
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 37 ============
cnt=[1, 5, 3, 2, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
min_w=0.04573, quan_i=1.47, quan_c=1.43
minimize weight of clients:[0, 1, 2, 3, 4, 8, 12, 13, 14, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.2402 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3484 | Train Acc: 0.4646
 Site-White                    | Train Loss: 1.3938 | Train Acc: 0.4578
 Site-White                    | Train Loss: 1.3573 | Train Acc: 0.4931
 Site-White                    | Train Loss: 1.3511 | Train Acc: 0.4729
 Site-Latino_Hispanic          | Train Loss: 1.4339 | Train Acc: 0.4286
 Site-Latino_Hispanic          | Train Loss: 1.4212 | Train Acc: 0.4261
 Site-Latino_Hispanic          | Train Loss: 1.4235 | Train Acc: 0.4316
 Site-Latino_Hispanic          | Train Loss: 1.4050 | Train Acc: 0.4385
 Site-Black                    | Train Loss: 1.4901 | Train Acc: 0.3915
 Site-Black                    | Train Loss: 1.4360 | Train Acc: 0.4349
 Site-Black                    | Train Loss: 1.4360 | Train Acc: 0.4357
 Site-East_Asian               | Train Loss: 1.3918 | Train Acc: 0.4548
 Site-East_Asian               | Train Loss: 1.3509 | Train Acc: 0.4978
 Site-Indian                   | Train Loss: 1.5995 | Train Acc: 0.3931
 Site-Indian                   | Train Loss: 1.4321 | Train Acc: 0.4490
 Site-Southeast_Asian          | Train Loss: 1.4883 | Train Acc: 0.4827
 Site-Middle_Eastern           | Train Loss: 1.3851 | Train Acc: 0.4943
 Site-White                     (1) | Val  Loss: 1.1649 | Val  Acc: 0.4264
 Site-White                     (1) | Val  Loss: 1.4190 | Val  Acc: 0.4911
 Site-White                     (1) | Val  Loss: 1.3463 | Val  Acc: 0.5068
 Site-White                     (1) | Val  Loss: 1.3472 | Val  Acc: 0.4862
 Site-White                     (1) | Val  Loss: 1.3586 | Val  Acc: 0.4579
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3629 | Val  Acc: 0.4236
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4139 | Val  Acc: 0.4550
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4162 | Val  Acc: 0.4194
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4031 | Val  Acc: 0.3908
 Site-Black                     (2) | Val  Loss: 1.4406 | Val  Acc: 0.4302
 Site-Black                     (2) | Val  Loss: 1.4320 | Val  Acc: 0.4311
 Site-Black                     (2) | Val  Loss: 1.4079 | Val  Acc: 0.4847
 Site-East_Asian                (3) | Val  Loss: 1.3405 | Val  Acc: 0.5153
 Site-East_Asian                (3) | Val  Loss: 1.3836 | Val  Acc: 0.4548
 Site-Indian                    (6) | Val  Loss: 1.4113 | Val  Acc: 0.3966
 Site-Indian                    (6) | Val  Loss: 1.5365 | Val  Acc: 0.4017
 Site-Southeast_Asian           (5) | Val  Loss: 1.4588 | Val  Acc: 0.4740
 Site-Middle_Eastern            (4) | Val  Loss: 1.4250 | Val  Acc: 0.4274
Average Valid Accuracy: 0.4485
Aggregated Acc | Val Acc: 0.4501
============ Train epoch 38 ============
cnt=[2, 1, 2, 4, 3, 5, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
min_w=0.05104, quan_i=1.45, quan_c=1.46
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.4488 | Train Acc: 0.4767
 Site-White                    | Train Loss: 1.3058 | Train Acc: 0.4882
 Site-White                    | Train Loss: 1.3062 | Train Acc: 0.4398
 Site-White                    | Train Loss: 1.3526 | Train Acc: 0.4564
 Site-White                    | Train Loss: 1.3418 | Train Acc: 0.4764
 Site-Latino_Hispanic          | Train Loss: 1.4525 | Train Acc: 0.4286
 Site-Latino_Hispanic          | Train Loss: 1.4343 | Train Acc: 0.4190
 Site-Latino_Hispanic          | Train Loss: 1.4327 | Train Acc: 0.4343
 Site-Latino_Hispanic          | Train Loss: 1.4099 | Train Acc: 0.4283
 Site-Black                    | Train Loss: 1.5450 | Train Acc: 0.3992
 Site-Black                    | Train Loss: 1.4456 | Train Acc: 0.4527
 Site-Black                    | Train Loss: 1.4560 | Train Acc: 0.4470
 Site-East_Asian               | Train Loss: 1.3878 | Train Acc: 0.4665
 Site-East_Asian               | Train Loss: 1.3497 | Train Acc: 0.4911
 Site-Indian                   | Train Loss: 1.4008 | Train Acc: 0.3931
 Site-Indian                   | Train Loss: 1.4203 | Train Acc: 0.4636
 Site-Southeast_Asian          | Train Loss: 1.4573 | Train Acc: 0.4913
 Site-Middle_Eastern           | Train Loss: 1.3492 | Train Acc: 0.4801
 Site-White                     (5) | Val  Loss: 1.1254 | Val  Acc: 0.4574
 Site-White                     (5) | Val  Loss: 1.3944 | Val  Acc: 0.5089
 Site-White                     (5) | Val  Loss: 1.3533 | Val  Acc: 0.4480
 Site-White                     (5) | Val  Loss: 1.3248 | Val  Acc: 0.4862
 Site-White                     (5) | Val  Loss: 1.3539 | Val  Acc: 0.4553
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4128 | Val  Acc: 0.3750
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3800 | Val  Acc: 0.4550
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4103 | Val  Acc: 0.4395
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4298 | Val  Acc: 0.4092
 Site-Black                     (4) | Val  Loss: 1.4788 | Val  Acc: 0.3721
 Site-Black                     (4) | Val  Loss: 1.4137 | Val  Acc: 0.4311
 Site-Black                     (4) | Val  Loss: 1.4415 | Val  Acc: 0.4542
 Site-East_Asian                (0) | Val  Loss: 1.3214 | Val  Acc: 0.5022
 Site-East_Asian                (0) | Val  Loss: 1.3693 | Val  Acc: 0.4783
 Site-Indian                    (2) | Val  Loss: 1.3582 | Val  Acc: 0.4540
 Site-Indian                    (2) | Val  Loss: 1.5203 | Val  Acc: 0.3712
 Site-Southeast_Asian           (6) | Val  Loss: 1.4339 | Val  Acc: 0.4448
 Site-Middle_Eastern            (1) | Val  Loss: 1.4462 | Val  Acc: 0.4274
Average Valid Accuracy: 0.4428
Aggregated Acc | Val Acc: 0.4407
============ Train epoch 39 ============
cnt=[5, 2, 1, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
min_w=0.05928, quan_i=1.46, quan_c=1.46
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.1896 | Train Acc: 0.4974
 Site-White                    | Train Loss: 1.3259 | Train Acc: 0.4882
 Site-White                    | Train Loss: 1.3201 | Train Acc: 0.4759
 Site-White                    | Train Loss: 1.3392 | Train Acc: 0.4817
 Site-White                    | Train Loss: 1.3227 | Train Acc: 0.4869
 Site-Latino_Hispanic          | Train Loss: 1.4420 | Train Acc: 0.4194
 Site-Latino_Hispanic          | Train Loss: 1.4147 | Train Acc: 0.4225
 Site-Latino_Hispanic          | Train Loss: 1.4331 | Train Acc: 0.4424
 Site-Latino_Hispanic          | Train Loss: 1.4037 | Train Acc: 0.4467
 Site-Black                    | Train Loss: 1.6919 | Train Acc: 0.3760
 Site-Black                    | Train Loss: 1.4905 | Train Acc: 0.4467
 Site-Black                    | Train Loss: 1.4326 | Train Acc: 0.4357
 Site-East_Asian               | Train Loss: 1.3580 | Train Acc: 0.4402
 Site-East_Asian               | Train Loss: 1.2800 | Train Acc: 0.5022
 Site-Indian                   | Train Loss: 1.4652 | Train Acc: 0.4160
 Site-Indian                   | Train Loss: 1.3818 | Train Acc: 0.4198
 Site-Southeast_Asian          | Train Loss: 1.3736 | Train Acc: 0.4870
 Site-Middle_Eastern           | Train Loss: 1.3709 | Train Acc: 0.4744
 Site-White                     (0) | Val  Loss: 1.1063 | Val  Acc: 0.4884
 Site-White                     (0) | Val  Loss: 1.3790 | Val  Acc: 0.4911
 Site-White                     (0) | Val  Loss: 1.3475 | Val  Acc: 0.4615
 Site-White                     (0) | Val  Loss: 1.3392 | Val  Acc: 0.4655
 Site-White                     (0) | Val  Loss: 1.3215 | Val  Acc: 0.5079
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3815 | Val  Acc: 0.4861
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4083 | Val  Acc: 0.4233
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3934 | Val  Acc: 0.4476
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3988 | Val  Acc: 0.4154
 Site-Black                     (5) | Val  Loss: 1.5018 | Val  Acc: 0.3895
 Site-Black                     (5) | Val  Loss: 1.4304 | Val  Acc: 0.4311
 Site-Black                     (5) | Val  Loss: 1.4353 | Val  Acc: 0.4780
 Site-East_Asian                (6) | Val  Loss: 1.3180 | Val  Acc: 0.5022
 Site-East_Asian                (6) | Val  Loss: 1.3672 | Val  Acc: 0.4682
 Site-Indian                    (1) | Val  Loss: 1.3831 | Val  Acc: 0.4023
 Site-Indian                    (1) | Val  Loss: 1.4847 | Val  Acc: 0.3624
 Site-Southeast_Asian           (3) | Val  Loss: 1.3984 | Val  Acc: 0.4545
 Site-Middle_Eastern            (2) | Val  Loss: 1.3855 | Val  Acc: 0.4402
Average Valid Accuracy: 0.4508
Aggregated Acc | Val Acc: 0.4459
 Best site-White                    (0)  | Epoch:39 | Val Acc: 0.4884
 Best site-White                    (0)  | Epoch:39 | Val Acc: 0.4911
 Best site-White                    (0)  | Epoch:39 | Val Acc: 0.4615
 Best site-White                    (0)  | Epoch:39 | Val Acc: 0.4655
 Best site-White                    (0)  | Epoch:39 | Val Acc: 0.5079
 Best site-Latino_Hispanic          (4)  | Epoch:39 | Val Acc: 0.4861
 Best site-Latino_Hispanic          (4)  | Epoch:39 | Val Acc: 0.4233
 Best site-Latino_Hispanic          (4)  | Epoch:39 | Val Acc: 0.4476
 Best site-Latino_Hispanic          (4)  | Epoch:39 | Val Acc: 0.4154
 Best site-Black                    (5)  | Epoch:39 | Val Acc: 0.3895
 Best site-Black                    (5)  | Epoch:39 | Val Acc: 0.4311
 Best site-Black                    (5)  | Epoch:39 | Val Acc: 0.4780
 Best site-East_Asian               (6)  | Epoch:39 | Val Acc: 0.5022
 Best site-East_Asian               (6)  | Epoch:39 | Val Acc: 0.4682
 Best site-Indian                   (1)  | Epoch:39 | Val Acc: 0.4023
 Best site-Indian                   (1)  | Epoch:39 | Val Acc: 0.3624
 Best site-Southeast_Asian          (3)  | Epoch:39 | Val Acc: 0.4545
 Best site-Middle_Eastern           (2)  | Epoch:39 | Val Acc: 0.4402
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:39 | Test Acc: 0.4519
 Test site-Latino_Hispanic          | Epoch:39 | Test Acc: 0.3797
 Test site-Black                    | Epoch:39 | Test Acc: 0.3500
 Test site-East_Asian               | Epoch:39 | Test Acc: 0.5065
 Test site-Indian                   | Epoch:39 | Test Acc: 0.3780
 Test site-Southeast_Asian          | Epoch:39 | Test Acc: 0.4185
 Test site-Middle_Eastern           | Epoch:39 | Test Acc: 0.4098
Average Test Accuracy: 0.4135, domain std=0.0487, individual std=0.0494
============ Train epoch 40 ============
cnt=[6, 3, 2, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
min_w=0.04708, quan_i=1.45, quan_c=1.43
minimize weight of clients:[0, 1, 2, 3, 4, 12, 13, 16, 17, ]
 Site-White                    | Train Loss: 1.1992 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3428 | Train Acc: 0.4685
 Site-White                    | Train Loss: 1.3568 | Train Acc: 0.4789
 Site-White                    | Train Loss: 1.3630 | Train Acc: 0.4862
 Site-White                    | Train Loss: 1.3371 | Train Acc: 0.4781
 Site-Latino_Hispanic          | Train Loss: 1.5259 | Train Acc: 0.3871
 Site-Latino_Hispanic          | Train Loss: 1.3798 | Train Acc: 0.4577
 Site-Latino_Hispanic          | Train Loss: 1.4162 | Train Acc: 0.4343
 Site-Latino_Hispanic          | Train Loss: 1.3714 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.5443 | Train Acc: 0.3527
 Site-Black                    | Train Loss: 1.3894 | Train Acc: 0.4852
 Site-Black                    | Train Loss: 1.4318 | Train Acc: 0.4334
 Site-East_Asian               | Train Loss: 1.4017 | Train Acc: 0.4577
 Site-East_Asian               | Train Loss: 1.4091 | Train Acc: 0.4933
 Site-Indian                   | Train Loss: 1.4250 | Train Acc: 0.4427
 Site-Indian                   | Train Loss: 1.3932 | Train Acc: 0.4519
 Site-Southeast_Asian          | Train Loss: 1.4291 | Train Acc: 0.4870
 Site-Middle_Eastern           | Train Loss: 1.3420 | Train Acc: 0.4943
 Site-White                     (5) | Val  Loss: 1.1975 | Val  Acc: 0.4651
 Site-White                     (2) | Val  Loss: 1.4251 | Val  Acc: 0.4675
 Site-White                     (5) | Val  Loss: 1.3536 | Val  Acc: 0.4842
 Site-White                     (5) | Val  Loss: 1.3520 | Val  Acc: 0.4586
 Site-White                     (2) | Val  Loss: 1.3492 | Val  Acc: 0.4842
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3673 | Val  Acc: 0.4583
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4003 | Val  Acc: 0.4497
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3820 | Val  Acc: 0.4355
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4024 | Val  Acc: 0.4308
 Site-Black                     (1) | Val  Loss: 1.4400 | Val  Acc: 0.3895
 Site-Black                     (1) | Val  Loss: 1.4029 | Val  Acc: 0.4400
 Site-Black                     (1) | Val  Loss: 1.4091 | Val  Acc: 0.4678
 Site-East_Asian                (4) | Val  Loss: 1.3548 | Val  Acc: 0.4934
 Site-East_Asian                (4) | Val  Loss: 1.3962 | Val  Acc: 0.4749
 Site-Indian                    (0) | Val  Loss: 1.3510 | Val  Acc: 0.4655
 Site-Indian                    (0) | Val  Loss: 1.5081 | Val  Acc: 0.4323
 Site-Southeast_Asian           (3) | Val  Loss: 1.4294 | Val  Acc: 0.4935
 Site-Middle_Eastern            (6) | Val  Loss: 1.3985 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4592
Aggregated Acc | Val Acc: 0.4679
 Best site-White                    (5)  | Epoch:40 | Val Acc: 0.4651
 Best site-White                    (2)  | Epoch:40 | Val Acc: 0.4675
 Best site-White                    (5)  | Epoch:40 | Val Acc: 0.4842
 Best site-White                    (5)  | Epoch:40 | Val Acc: 0.4586
 Best site-White                    (2)  | Epoch:40 | Val Acc: 0.4842
 Best site-Latino_Hispanic          (0)  | Epoch:40 | Val Acc: 0.4583
 Best site-Latino_Hispanic          (0)  | Epoch:40 | Val Acc: 0.4497
 Best site-Latino_Hispanic          (0)  | Epoch:40 | Val Acc: 0.4355
 Best site-Latino_Hispanic          (0)  | Epoch:40 | Val Acc: 0.4308
 Best site-Black                    (1)  | Epoch:40 | Val Acc: 0.3895
 Best site-Black                    (1)  | Epoch:40 | Val Acc: 0.4400
 Best site-Black                    (1)  | Epoch:40 | Val Acc: 0.4678
 Best site-East_Asian               (4)  | Epoch:40 | Val Acc: 0.4934
 Best site-East_Asian               (4)  | Epoch:40 | Val Acc: 0.4749
 Best site-Indian                   (0)  | Epoch:40 | Val Acc: 0.4655
 Best site-Indian                   (0)  | Epoch:40 | Val Acc: 0.4323
 Best site-Southeast_Asian          (3)  | Epoch:40 | Val Acc: 0.4935
 Best site-Middle_Eastern           (6)  | Epoch:40 | Val Acc: 0.4744
 Test site-White                    | Epoch:40 | Test Acc: 0.4358
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3576
 Test site-Black                    | Epoch:40 | Test Acc: 0.3375
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.4773
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3660
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.4037
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.4098
Average Test Accuracy: 0.3982, domain std=0.0450, individual std=0.0468
Average Test Accuracy: 0.3982
============ Train epoch 41 ============
cnt=[3, 3, 2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
min_w=0.04789, quan_i=1.44, quan_c=1.43
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 8, 12, 13, 14, 17, ]
 Site-White                    | Train Loss: 1.2554 | Train Acc: 0.5233
 Site-White                    | Train Loss: 1.3173 | Train Acc: 0.4961
 Site-White                    | Train Loss: 1.3901 | Train Acc: 0.4578
 Site-White                    | Train Loss: 1.3463 | Train Acc: 0.4794
 Site-White                    | Train Loss: 1.3354 | Train Acc: 0.4816
 Site-Latino_Hispanic          | Train Loss: 1.4173 | Train Acc: 0.4194
 Site-Latino_Hispanic          | Train Loss: 1.4134 | Train Acc: 0.4120
 Site-Latino_Hispanic          | Train Loss: 1.4166 | Train Acc: 0.4155
 Site-Latino_Hispanic          | Train Loss: 1.4031 | Train Acc: 0.4426
 Site-Black                    | Train Loss: 1.5840 | Train Acc: 0.3721
 Site-Black                    | Train Loss: 1.4489 | Train Acc: 0.4290
 Site-Black                    | Train Loss: 1.4583 | Train Acc: 0.4199
 Site-East_Asian               | Train Loss: 1.3887 | Train Acc: 0.4752
 Site-East_Asian               | Train Loss: 1.3092 | Train Acc: 0.5222
 Site-Indian                   | Train Loss: 1.3836 | Train Acc: 0.4084
 Site-Indian                   | Train Loss: 1.4007 | Train Acc: 0.4169
 Site-Southeast_Asian          | Train Loss: 1.4080 | Train Acc: 0.4784
 Site-Middle_Eastern           | Train Loss: 1.3474 | Train Acc: 0.4972
 Site-White                     (3) | Val  Loss: 1.2089 | Val  Acc: 0.4341
 Site-White                     (0) | Val  Loss: 1.3910 | Val  Acc: 0.4852
 Site-White                     (0) | Val  Loss: 1.3444 | Val  Acc: 0.5023
 Site-White                     (3) | Val  Loss: 1.3421 | Val  Acc: 0.4690
 Site-White                     (0) | Val  Loss: 1.3449 | Val  Acc: 0.4605
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3630 | Val  Acc: 0.5139
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3702 | Val  Acc: 0.4550
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4017 | Val  Acc: 0.4435
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4014 | Val  Acc: 0.4123
 Site-Black                     (1) | Val  Loss: 1.4614 | Val  Acc: 0.3953
 Site-Black                     (1) | Val  Loss: 1.4168 | Val  Acc: 0.4400
 Site-Black                     (1) | Val  Loss: 1.4136 | Val  Acc: 0.4475
 Site-East_Asian                (6) | Val  Loss: 1.3512 | Val  Acc: 0.4891
 Site-East_Asian                (6) | Val  Loss: 1.3891 | Val  Acc: 0.4816
 Site-Indian                    (4) | Val  Loss: 1.3540 | Val  Acc: 0.4310
 Site-Indian                    (2) | Val  Loss: 1.4749 | Val  Acc: 0.4148
 Site-Southeast_Asian           (2) | Val  Loss: 1.4053 | Val  Acc: 0.4578
 Site-Middle_Eastern            (4) | Val  Loss: 1.4171 | Val  Acc: 0.4103
Average Valid Accuracy: 0.4524
Aggregated Acc | Val Acc: 0.4535
 Test site-White                    | Epoch:40 | Test Acc: 0.4465
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3797
 Test site-Black                    | Epoch:40 | Test Acc: 0.3375
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.5097
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3756
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.4111
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.4201
Average Test Accuracy: 0.4115, domain std=0.0517, individual std=0.0519
Average Test Accuracy: 0.4115
============ Train epoch 42 ============
cnt=[2, 1, 3, 1, 4, 5, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
min_w=0.05151, quan_i=1.43, quan_c=1.42
minimize weight of clients:[0, 1, 2, 3, 4, 12, 13, 14, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.4331 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3079 | Train Acc: 0.4961
 Site-White                    | Train Loss: 1.4002 | Train Acc: 0.4518
 Site-White                    | Train Loss: 1.3443 | Train Acc: 0.5023
 Site-White                    | Train Loss: 1.3346 | Train Acc: 0.4623
 Site-Latino_Hispanic          | Train Loss: 1.4482 | Train Acc: 0.4055
 Site-Latino_Hispanic          | Train Loss: 1.3933 | Train Acc: 0.4331
 Site-Latino_Hispanic          | Train Loss: 1.4233 | Train Acc: 0.4290
 Site-Latino_Hispanic          | Train Loss: 1.3644 | Train Acc: 0.4324
 Site-Black                    | Train Loss: 1.5240 | Train Acc: 0.3837
 Site-Black                    | Train Loss: 1.3987 | Train Acc: 0.4882
 Site-Black                    | Train Loss: 1.4199 | Train Acc: 0.4402
 Site-East_Asian               | Train Loss: 1.3484 | Train Acc: 0.4519
 Site-East_Asian               | Train Loss: 1.2862 | Train Acc: 0.4600
 Site-Indian                   | Train Loss: 1.4596 | Train Acc: 0.4046
 Site-Indian                   | Train Loss: 1.3984 | Train Acc: 0.4461
 Site-Southeast_Asian          | Train Loss: 1.4030 | Train Acc: 0.4957
 Site-Middle_Eastern           | Train Loss: 1.3191 | Train Acc: 0.4773
 Site-White                     (5) | Val  Loss: 1.2286 | Val  Acc: 0.3953
 Site-White                     (5) | Val  Loss: 1.4203 | Val  Acc: 0.4852
 Site-White                     (5) | Val  Loss: 1.3573 | Val  Acc: 0.4842
 Site-White                     (1) | Val  Loss: 1.3356 | Val  Acc: 0.4793
 Site-White                     (5) | Val  Loss: 1.3570 | Val  Acc: 0.4553
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3647 | Val  Acc: 0.4306
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3551 | Val  Acc: 0.4497
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3834 | Val  Acc: 0.4597
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3562 | Val  Acc: 0.4215
 Site-Black                     (2) | Val  Loss: 1.4372 | Val  Acc: 0.4477
 Site-Black                     (2) | Val  Loss: 1.3976 | Val  Acc: 0.4444
 Site-Black                     (2) | Val  Loss: 1.3859 | Val  Acc: 0.4814
 Site-East_Asian                (6) | Val  Loss: 1.3236 | Val  Acc: 0.4934
 Site-East_Asian                (6) | Val  Loss: 1.3887 | Val  Acc: 0.4381
 Site-Indian                    (0) | Val  Loss: 1.3921 | Val  Acc: 0.4368
 Site-Indian                    (0) | Val  Loss: 1.4852 | Val  Acc: 0.4279
 Site-Southeast_Asian           (3) | Val  Loss: 1.4193 | Val  Acc: 0.4578
 Site-Middle_Eastern            (5) | Val  Loss: 1.4158 | Val  Acc: 0.4444
Average Valid Accuracy: 0.4518
Aggregated Acc | Val Acc: 0.4552
 Test site-White                    | Epoch:40 | Test Acc: 0.4492
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3924
 Test site-Black                    | Epoch:40 | Test Acc: 0.3250
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.4675
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3708
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.3963
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.4175
Average Test Accuracy: 0.4027, domain std=0.0444, individual std=0.0471
Average Test Accuracy: 0.4027
============ Train epoch 43 ============
cnt=[4, 1, 1, 6, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
min_w=0.05957, quan_i=1.44, quan_c=1.42
minimize weight of clients:[1, 2, 3, 4, 6, 7, 8, 10, 12, 13, 16, 17, ]
 Site-White                    | Train Loss: 1.2506 | Train Acc: 0.5078
 Site-White                    | Train Loss: 1.3070 | Train Acc: 0.5315
 Site-White                    | Train Loss: 1.3693 | Train Acc: 0.4458
 Site-White                    | Train Loss: 1.3637 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.3096 | Train Acc: 0.4764
 Site-Latino_Hispanic          | Train Loss: 1.4745 | Train Acc: 0.3825
 Site-Latino_Hispanic          | Train Loss: 1.3706 | Train Acc: 0.4261
 Site-Latino_Hispanic          | Train Loss: 1.4176 | Train Acc: 0.4182
 Site-Latino_Hispanic          | Train Loss: 1.3941 | Train Acc: 0.4529
 Site-Black                    | Train Loss: 1.4420 | Train Acc: 0.3915
 Site-Black                    | Train Loss: 1.4508 | Train Acc: 0.4379
 Site-Black                    | Train Loss: 1.4213 | Train Acc: 0.4041
 Site-East_Asian               | Train Loss: 1.3964 | Train Acc: 0.4577
 Site-East_Asian               | Train Loss: 1.2918 | Train Acc: 0.5111
 Site-Indian                   | Train Loss: 1.4365 | Train Acc: 0.4008
 Site-Indian                   | Train Loss: 1.4000 | Train Acc: 0.4431
 Site-Southeast_Asian          | Train Loss: 1.3869 | Train Acc: 0.5087
 Site-Middle_Eastern           | Train Loss: 1.3134 | Train Acc: 0.4858
 Site-White                     (3) | Val  Loss: 1.2083 | Val  Acc: 0.4496
 Site-White                     (3) | Val  Loss: 1.3963 | Val  Acc: 0.4675
 Site-White                     (3) | Val  Loss: 1.3356 | Val  Acc: 0.4842
 Site-White                     (3) | Val  Loss: 1.3253 | Val  Acc: 0.4897
 Site-White                     (3) | Val  Loss: 1.3355 | Val  Acc: 0.4658
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3650 | Val  Acc: 0.4792
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3817 | Val  Acc: 0.4603
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4041 | Val  Acc: 0.4274
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3765 | Val  Acc: 0.4400
 Site-Black                     (5) | Val  Loss: 1.4235 | Val  Acc: 0.4535
 Site-Black                     (1) | Val  Loss: 1.3980 | Val  Acc: 0.4489
 Site-Black                     (5) | Val  Loss: 1.4197 | Val  Acc: 0.4678
 Site-East_Asian                (6) | Val  Loss: 1.3303 | Val  Acc: 0.5109
 Site-East_Asian                (6) | Val  Loss: 1.3812 | Val  Acc: 0.4615
 Site-Indian                    (4) | Val  Loss: 1.3464 | Val  Acc: 0.4368
 Site-Indian                    (4) | Val  Loss: 1.4938 | Val  Acc: 0.4061
 Site-Southeast_Asian           (2) | Val  Loss: 1.4263 | Val  Acc: 0.4416
 Site-Middle_Eastern            (3) | Val  Loss: 1.4024 | Val  Acc: 0.4274
Average Valid Accuracy: 0.4566
Aggregated Acc | Val Acc: 0.4535
 Test site-White                    | Epoch:40 | Test Acc: 0.4519
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3987
 Test site-Black                    | Epoch:40 | Test Acc: 0.3125
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.4740
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3612
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.3963
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.4149
Average Test Accuracy: 0.4014, domain std=0.0501, individual std=0.0529
Average Test Accuracy: 0.4014
============ Train epoch 44 ============
cnt=[3, 1, 5, 2, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
min_w=0.05089, quan_i=1.44, quan_c=1.43
minimize weight of clients:[0, 1, 2, 3, 4, 6, 7, 12, 13, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.1837 | Train Acc: 0.5026
 Site-White                    | Train Loss: 1.3035 | Train Acc: 0.4921
 Site-White                    | Train Loss: 1.3936 | Train Acc: 0.4639
 Site-White                    | Train Loss: 1.3406 | Train Acc: 0.4771
 Site-White                    | Train Loss: 1.3304 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.4798 | Train Acc: 0.4240
 Site-Latino_Hispanic          | Train Loss: 1.3712 | Train Acc: 0.4261
 Site-Latino_Hispanic          | Train Loss: 1.4104 | Train Acc: 0.4611
 Site-Latino_Hispanic          | Train Loss: 1.3498 | Train Acc: 0.4488
 Site-Black                    | Train Loss: 1.4853 | Train Acc: 0.3953
 Site-Black                    | Train Loss: 1.4137 | Train Acc: 0.4527
 Site-Black                    | Train Loss: 1.4053 | Train Acc: 0.4153
 Site-East_Asian               | Train Loss: 1.3994 | Train Acc: 0.4694
 Site-East_Asian               | Train Loss: 1.3440 | Train Acc: 0.4778
 Site-Indian                   | Train Loss: 1.4281 | Train Acc: 0.4313
 Site-Indian                   | Train Loss: 1.3593 | Train Acc: 0.4665
 Site-Southeast_Asian          | Train Loss: 1.4143 | Train Acc: 0.4762
 Site-Middle_Eastern           | Train Loss: 1.3278 | Train Acc: 0.4773
 Site-White                     (2) | Val  Loss: 1.4807 | Val  Acc: 0.4884
 Site-White                     (2) | Val  Loss: 1.4014 | Val  Acc: 0.4734
 Site-White                     (2) | Val  Loss: 1.3332 | Val  Acc: 0.4796
 Site-White                     (2) | Val  Loss: 1.3492 | Val  Acc: 0.4552
 Site-White                     (2) | Val  Loss: 1.3479 | Val  Acc: 0.4421
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3504 | Val  Acc: 0.4653
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3550 | Val  Acc: 0.4762
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3693 | Val  Acc: 0.4274
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3835 | Val  Acc: 0.4031
 Site-Black                     (6) | Val  Loss: 1.4486 | Val  Acc: 0.4302
 Site-Black                     (1) | Val  Loss: 1.4119 | Val  Acc: 0.4444
 Site-Black                     (6) | Val  Loss: 1.3720 | Val  Acc: 0.4915
 Site-East_Asian                (4) | Val  Loss: 1.3280 | Val  Acc: 0.4978
 Site-East_Asian                (4) | Val  Loss: 1.4005 | Val  Acc: 0.4448
 Site-Indian                    (5) | Val  Loss: 1.3748 | Val  Acc: 0.4138
 Site-Indian                    (5) | Val  Loss: 1.4850 | Val  Acc: 0.3843
 Site-Southeast_Asian           (4) | Val  Loss: 1.4700 | Val  Acc: 0.4513
 Site-Middle_Eastern            (0) | Val  Loss: 1.3905 | Val  Acc: 0.4274
Average Valid Accuracy: 0.4498
Aggregated Acc | Val Acc: 0.4449
 Test site-White                    | Epoch:40 | Test Acc: 0.4358
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3797
 Test site-Black                    | Epoch:40 | Test Acc: 0.3344
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.4805
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3708
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.4000
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.4175
Average Test Accuracy: 0.4027, domain std=0.0441, individual std=0.0447
Average Test Accuracy: 0.4027
============ Train epoch 45 ============
cnt=[4, 2, 1, 3, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
min_w=0.04672, quan_i=1.43, quan_c=1.42
minimize weight of clients:[0, 1, 2, 3, 4, 6, 8, 13, 15, 17, ]
 Site-White                    | Train Loss: 1.2731 | Train Acc: 0.5285
 Site-White                    | Train Loss: 1.2940 | Train Acc: 0.4843
 Site-White                    | Train Loss: 1.2901 | Train Acc: 0.4940
 Site-White                    | Train Loss: 1.3216 | Train Acc: 0.4839
 Site-White                    | Train Loss: 1.3232 | Train Acc: 0.4711
 Site-Latino_Hispanic          | Train Loss: 1.4326 | Train Acc: 0.4055
 Site-Latino_Hispanic          | Train Loss: 1.4233 | Train Acc: 0.4366
 Site-Latino_Hispanic          | Train Loss: 1.4058 | Train Acc: 0.4209
 Site-Latino_Hispanic          | Train Loss: 1.3685 | Train Acc: 0.4611
 Site-Black                    | Train Loss: 1.4045 | Train Acc: 0.3721
 Site-Black                    | Train Loss: 1.3818 | Train Acc: 0.4734
 Site-Black                    | Train Loss: 1.4400 | Train Acc: 0.4266
 Site-East_Asian               | Train Loss: 1.3271 | Train Acc: 0.4606
 Site-East_Asian               | Train Loss: 1.3006 | Train Acc: 0.4933
 Site-Indian                   | Train Loss: 1.3177 | Train Acc: 0.4427
 Site-Indian                   | Train Loss: 1.3656 | Train Acc: 0.4490
 Site-Southeast_Asian          | Train Loss: 1.4264 | Train Acc: 0.5043
 Site-Middle_Eastern           | Train Loss: 1.3525 | Train Acc: 0.4716
 Site-White                     (1) | Val  Loss: 1.1065 | Val  Acc: 0.4574
 Site-White                     (6) | Val  Loss: 1.3801 | Val  Acc: 0.4793
 Site-White                     (6) | Val  Loss: 1.3128 | Val  Acc: 0.4977
 Site-White                     (1) | Val  Loss: 1.3348 | Val  Acc: 0.4552
 Site-White                     (6) | Val  Loss: 1.3032 | Val  Acc: 0.4763
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3733 | Val  Acc: 0.4931
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3488 | Val  Acc: 0.4339
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3892 | Val  Acc: 0.4435
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3736 | Val  Acc: 0.4246
 Site-Black                     (3) | Val  Loss: 1.4554 | Val  Acc: 0.4012
 Site-Black                     (3) | Val  Loss: 1.4315 | Val  Acc: 0.4356
 Site-Black                     (3) | Val  Loss: 1.4138 | Val  Acc: 0.4644
 Site-East_Asian                (4) | Val  Loss: 1.2775 | Val  Acc: 0.5371
 Site-East_Asian                (2) | Val  Loss: 1.3583 | Val  Acc: 0.4916
 Site-Indian                    (5) | Val  Loss: 1.3816 | Val  Acc: 0.4195
 Site-Indian                    (5) | Val  Loss: 1.5061 | Val  Acc: 0.3930
 Site-Southeast_Asian           (4) | Val  Loss: 1.4323 | Val  Acc: 0.4545
 Site-Middle_Eastern            (6) | Val  Loss: 1.3778 | Val  Acc: 0.4658
Average Valid Accuracy: 0.4569
Aggregated Acc | Val Acc: 0.4589
 Test site-White                    | Epoch:40 | Test Acc: 0.4412
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3734
 Test site-Black                    | Epoch:40 | Test Acc: 0.3375
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.5097
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3900
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.4333
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.4175
Average Test Accuracy: 0.4147, domain std=0.0512, individual std=0.0512
Average Test Accuracy: 0.4147
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-quan-std_1.31_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 46 ============
cnt=[3, 5, 2, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
min_w=0.05089, quan_i=1.42, quan_c=1.40
minimize weight of clients:[0, 1, 2, 3, 4, 7, 12, 13, 14, 15, 17, ]
 Site-White                    | Train Loss: 1.6144 | Train Acc: 0.4974
 Site-White                    | Train Loss: 1.3039 | Train Acc: 0.4921
 Site-White                    | Train Loss: 1.3727 | Train Acc: 0.4518
 Site-White                    | Train Loss: 1.3288 | Train Acc: 0.4931
 Site-White                    | Train Loss: 1.3223 | Train Acc: 0.4764
 Site-Latino_Hispanic          | Train Loss: 1.4281 | Train Acc: 0.4009
 Site-Latino_Hispanic          | Train Loss: 1.3615 | Train Acc: 0.4296
 Site-Latino_Hispanic          | Train Loss: 1.4311 | Train Acc: 0.4343
 Site-Latino_Hispanic          | Train Loss: 1.3572 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.4554 | Train Acc: 0.3876
 Site-Black                    | Train Loss: 1.4093 | Train Acc: 0.4734
 Site-Black                    | Train Loss: 1.4137 | Train Acc: 0.4424
 Site-East_Asian               | Train Loss: 1.3595 | Train Acc: 0.4519
 Site-East_Asian               | Train Loss: 1.3203 | Train Acc: 0.5044
 Site-Indian                   | Train Loss: 1.4850 | Train Acc: 0.4389
 Site-Indian                   | Train Loss: 1.3674 | Train Acc: 0.4519
 Site-Southeast_Asian          | Train Loss: 1.4044 | Train Acc: 0.4978
 Site-Middle_Eastern           | Train Loss: 1.3227 | Train Acc: 0.5057
 Site-White                     (1) | Val  Loss: 1.2251 | Val  Acc: 0.4264
 Site-White                     (1) | Val  Loss: 1.3740 | Val  Acc: 0.4734
 Site-White                     (1) | Val  Loss: 1.3209 | Val  Acc: 0.4796
 Site-White                     (1) | Val  Loss: 1.3203 | Val  Acc: 0.4793
 Site-White                     (1) | Val  Loss: 1.3290 | Val  Acc: 0.4789
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3673 | Val  Acc: 0.4722
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3612 | Val  Acc: 0.4709
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3860 | Val  Acc: 0.4597
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3542 | Val  Acc: 0.4000
 Site-Black                     (6) | Val  Loss: 1.4412 | Val  Acc: 0.4186
 Site-Black                     (2) | Val  Loss: 1.3969 | Val  Acc: 0.4444
 Site-Black                     (2) | Val  Loss: 1.4048 | Val  Acc: 0.4881
 Site-East_Asian                (3) | Val  Loss: 1.2936 | Val  Acc: 0.5197
 Site-East_Asian                (3) | Val  Loss: 1.3453 | Val  Acc: 0.4615
 Site-Indian                    (4) | Val  Loss: 1.3657 | Val  Acc: 0.4655
 Site-Indian                    (4) | Val  Loss: 1.4790 | Val  Acc: 0.4236
 Site-Southeast_Asian           (3) | Val  Loss: 1.4309 | Val  Acc: 0.4545
 Site-Middle_Eastern            (5) | Val  Loss: 1.3515 | Val  Acc: 0.4274
Average Valid Accuracy: 0.4580
Aggregated Acc | Val Acc: 0.4524
 Test site-White                    | Epoch:45 | Test Acc: 0.4439
 Test site-Latino_Hispanic          | Epoch:45 | Test Acc: 0.3892
 Test site-Black                    | Epoch:45 | Test Acc: 0.3281
 Test site-East_Asian               | Epoch:45 | Test Acc: 0.4838
 Test site-Indian                   | Epoch:45 | Test Acc: 0.3780
 Test site-Southeast_Asian          | Epoch:45 | Test Acc: 0.4074
 Test site-Middle_Eastern           | Epoch:45 | Test Acc: 0.4098
Average Test Accuracy: 0.4057, domain std=0.0457, individual std=0.0472
Average Test Accuracy: 0.4057
============ Train epoch 47 ============
cnt=[2, 2, 5, 3, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
min_w=0.06700, quan_i=1.44, quan_c=1.42
minimize weight of clients:[1, 2, 3, 4, 5, 6, 8, 12, 13, 17, ]
 Site-White                    | Train Loss: 1.1875 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3142 | Train Acc: 0.4961
 Site-White                    | Train Loss: 1.3443 | Train Acc: 0.4759
 Site-White                    | Train Loss: 1.3234 | Train Acc: 0.4885
 Site-White                    | Train Loss: 1.2995 | Train Acc: 0.4904
 Site-Latino_Hispanic          | Train Loss: 1.4054 | Train Acc: 0.4424
 Site-Latino_Hispanic          | Train Loss: 1.4019 | Train Acc: 0.4225
 Site-Latino_Hispanic          | Train Loss: 1.4286 | Train Acc: 0.4316
 Site-Latino_Hispanic          | Train Loss: 1.3721 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.5089 | Train Acc: 0.3760
 Site-Black                    | Train Loss: 1.4397 | Train Acc: 0.4675
 Site-Black                    | Train Loss: 1.3905 | Train Acc: 0.4402
 Site-East_Asian               | Train Loss: 1.4294 | Train Acc: 0.4373
 Site-East_Asian               | Train Loss: 1.3469 | Train Acc: 0.5244
 Site-Indian                   | Train Loss: 1.3842 | Train Acc: 0.4275
 Site-Indian                   | Train Loss: 1.3499 | Train Acc: 0.4694
 Site-Southeast_Asian          | Train Loss: 1.3638 | Train Acc: 0.4978
 Site-Middle_Eastern           | Train Loss: 1.3204 | Train Acc: 0.4773
 Site-White                     (2) | Val  Loss: 1.5186 | Val  Acc: 0.4264
 Site-White                     (2) | Val  Loss: 1.3764 | Val  Acc: 0.5030
 Site-White                     (2) | Val  Loss: 1.3084 | Val  Acc: 0.5068
 Site-White                     (2) | Val  Loss: 1.3604 | Val  Acc: 0.4517
 Site-White                     (2) | Val  Loss: 1.2922 | Val  Acc: 0.5079
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3579 | Val  Acc: 0.4514
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3622 | Val  Acc: 0.4815
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4045 | Val  Acc: 0.4194
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3615 | Val  Acc: 0.4246
 Site-Black                     (1) | Val  Loss: 1.4433 | Val  Acc: 0.4128
 Site-Black                     (6) | Val  Loss: 1.4046 | Val  Acc: 0.4578
 Site-Black                     (1) | Val  Loss: 1.3680 | Val  Acc: 0.4712
 Site-East_Asian                (0) | Val  Loss: 1.3067 | Val  Acc: 0.5328
 Site-East_Asian                (0) | Val  Loss: 1.3723 | Val  Acc: 0.4749
 Site-Indian                    (4) | Val  Loss: 1.3736 | Val  Acc: 0.4713
 Site-Indian                    (4) | Val  Loss: 1.4685 | Val  Acc: 0.4017
 Site-Southeast_Asian           (4) | Val  Loss: 1.3989 | Val  Acc: 0.4610
 Site-Middle_Eastern            (5) | Val  Loss: 1.4073 | Val  Acc: 0.4359
Average Valid Accuracy: 0.4607
Aggregated Acc | Val Acc: 0.4582
 Best site-White                    (2)  | Epoch:47 | Val Acc: 0.4264
 Best site-White                    (2)  | Epoch:47 | Val Acc: 0.5030
 Best site-White                    (2)  | Epoch:47 | Val Acc: 0.5068
 Best site-White                    (2)  | Epoch:47 | Val Acc: 0.4517
 Best site-White                    (2)  | Epoch:47 | Val Acc: 0.5079
 Best site-Latino_Hispanic          (3)  | Epoch:47 | Val Acc: 0.4514
 Best site-Latino_Hispanic          (3)  | Epoch:47 | Val Acc: 0.4815
 Best site-Latino_Hispanic          (5)  | Epoch:47 | Val Acc: 0.4194
 Best site-Latino_Hispanic          (3)  | Epoch:47 | Val Acc: 0.4246
 Best site-Black                    (1)  | Epoch:47 | Val Acc: 0.4128
 Best site-Black                    (6)  | Epoch:47 | Val Acc: 0.4578
 Best site-Black                    (1)  | Epoch:47 | Val Acc: 0.4712
 Best site-East_Asian               (0)  | Epoch:47 | Val Acc: 0.5328
 Best site-East_Asian               (0)  | Epoch:47 | Val Acc: 0.4749
 Best site-Indian                   (4)  | Epoch:47 | Val Acc: 0.4713
 Best site-Indian                   (4)  | Epoch:47 | Val Acc: 0.4017
 Best site-Southeast_Asian          (4)  | Epoch:47 | Val Acc: 0.4610
 Best site-Middle_Eastern           (5)  | Epoch:47 | Val Acc: 0.4359
 Test site-White                    | Epoch:47 | Test Acc: 0.4412
 Test site-Latino_Hispanic          | Epoch:47 | Test Acc: 0.3861
 Test site-Black                    | Epoch:47 | Test Acc: 0.3281
 Test site-East_Asian               | Epoch:47 | Test Acc: 0.4968
 Test site-Indian                   | Epoch:47 | Test Acc: 0.3804
 Test site-Southeast_Asian          | Epoch:47 | Test Acc: 0.4148
 Test site-Middle_Eastern           | Epoch:47 | Test Acc: 0.4201
Average Test Accuracy: 0.4096, domain std=0.0490, individual std=0.0495
Average Test Accuracy: 0.4096
============ Train epoch 48 ============
cnt=[2, 2, 5, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
min_w=0.04712, quan_i=1.43, quan_c=1.40
minimize weight of clients:[0, 1, 2, 3, 4, 13, 14, 15, 16, ]
 Site-White                    | Train Loss: 1.1316 | Train Acc: 0.4819
 Site-White                    | Train Loss: 1.3264 | Train Acc: 0.4843
 Site-White                    | Train Loss: 1.3988 | Train Acc: 0.4488
 Site-White                    | Train Loss: 1.3294 | Train Acc: 0.4862
 Site-White                    | Train Loss: 1.3010 | Train Acc: 0.4956
 Site-Latino_Hispanic          | Train Loss: 1.4660 | Train Acc: 0.4562
 Site-Latino_Hispanic          | Train Loss: 1.3692 | Train Acc: 0.4296
 Site-Latino_Hispanic          | Train Loss: 1.4125 | Train Acc: 0.4316
 Site-Latino_Hispanic          | Train Loss: 1.3550 | Train Acc: 0.4467
 Site-Black                    | Train Loss: 1.6393 | Train Acc: 0.3915
 Site-Black                    | Train Loss: 1.3712 | Train Acc: 0.4320
 Site-Black                    | Train Loss: 1.4161 | Train Acc: 0.4289
 Site-East_Asian               | Train Loss: 1.3656 | Train Acc: 0.4461
 Site-East_Asian               | Train Loss: 1.2333 | Train Acc: 0.5044
 Site-Indian                   | Train Loss: 1.3854 | Train Acc: 0.4275
 Site-Indian                   | Train Loss: 1.3848 | Train Acc: 0.4577
 Site-Southeast_Asian          | Train Loss: 1.3778 | Train Acc: 0.4957
 Site-Middle_Eastern           | Train Loss: 1.3073 | Train Acc: 0.5028
 Site-White                     (2) | Val  Loss: 1.1755 | Val  Acc: 0.4419
 Site-White                     (2) | Val  Loss: 1.3495 | Val  Acc: 0.4793
 Site-White                     (2) | Val  Loss: 1.3246 | Val  Acc: 0.4887
 Site-White                     (2) | Val  Loss: 1.3171 | Val  Acc: 0.4655
 Site-White                     (2) | Val  Loss: 1.3268 | Val  Acc: 0.4789
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3797 | Val  Acc: 0.4514
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3485 | Val  Acc: 0.5079
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4153 | Val  Acc: 0.4274
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3519 | Val  Acc: 0.4246
 Site-Black                     (5) | Val  Loss: 1.4241 | Val  Acc: 0.4419
 Site-Black                     (4) | Val  Loss: 1.3830 | Val  Acc: 0.4089
 Site-Black                     (4) | Val  Loss: 1.4024 | Val  Acc: 0.4746
 Site-East_Asian                (1) | Val  Loss: 1.2786 | Val  Acc: 0.5109
 Site-East_Asian                (1) | Val  Loss: 1.3424 | Val  Acc: 0.4849
 Site-Indian                    (0) | Val  Loss: 1.3636 | Val  Acc: 0.4483
 Site-Indian                    (0) | Val  Loss: 1.5160 | Val  Acc: 0.4323
 Site-Southeast_Asian           (6) | Val  Loss: 1.4221 | Val  Acc: 0.4545
 Site-Middle_Eastern            (3) | Val  Loss: 1.4126 | Val  Acc: 0.4316
Average Valid Accuracy: 0.4585
Aggregated Acc | Val Acc: 0.4565
 Test site-White                    | Epoch:47 | Test Acc: 0.4519
 Test site-Latino_Hispanic          | Epoch:47 | Test Acc: 0.3892
 Test site-Black                    | Epoch:47 | Test Acc: 0.3281
 Test site-East_Asian               | Epoch:47 | Test Acc: 0.4773
 Test site-Indian                   | Epoch:47 | Test Acc: 0.3708
 Test site-Southeast_Asian          | Epoch:47 | Test Acc: 0.4037
 Test site-Middle_Eastern           | Epoch:47 | Test Acc: 0.4124
Average Test Accuracy: 0.4048, domain std=0.0460, individual std=0.0486
Average Test Accuracy: 0.4048
============ Train epoch 49 ============
cnt=[2, 4, 3, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
min_w=0.04522, quan_i=1.42, quan_c=1.40
minimize weight of clients:[0, 1, 2, 3, 4, 12, 13, 14, 15, 16, 17, ]
 Site-White                    | Train Loss: 1.2640 | Train Acc: 0.5389
 Site-White                    | Train Loss: 1.3405 | Train Acc: 0.4803
 Site-White                    | Train Loss: 1.3849 | Train Acc: 0.4608
 Site-White                    | Train Loss: 1.3427 | Train Acc: 0.4931
 Site-White                    | Train Loss: 1.3292 | Train Acc: 0.4711
 Site-Latino_Hispanic          | Train Loss: 1.4066 | Train Acc: 0.4332
 Site-Latino_Hispanic          | Train Loss: 1.3805 | Train Acc: 0.4366
 Site-Latino_Hispanic          | Train Loss: 1.3851 | Train Acc: 0.4263
 Site-Latino_Hispanic          | Train Loss: 1.3289 | Train Acc: 0.4672
 Site-Black                    | Train Loss: 1.4982 | Train Acc: 0.4070
 Site-Black                    | Train Loss: 1.3906 | Train Acc: 0.4675
 Site-Black                    | Train Loss: 1.4095 | Train Acc: 0.4447
 Site-East_Asian               | Train Loss: 1.3769 | Train Acc: 0.4606
 Site-East_Asian               | Train Loss: 1.3305 | Train Acc: 0.4933
 Site-Indian                   | Train Loss: 1.4384 | Train Acc: 0.4198
 Site-Indian                   | Train Loss: 1.4435 | Train Acc: 0.4257
 Site-Southeast_Asian          | Train Loss: 1.4222 | Train Acc: 0.4913
 Site-Middle_Eastern           | Train Loss: 1.3262 | Train Acc: 0.4972
 Site-White                     (3) | Val  Loss: 1.2516 | Val  Acc: 0.4651
 Site-White                     (3) | Val  Loss: 1.4167 | Val  Acc: 0.4852
 Site-White                     (3) | Val  Loss: 1.3397 | Val  Acc: 0.4977
 Site-White                     (3) | Val  Loss: 1.3418 | Val  Acc: 0.4586
 Site-White                     (3) | Val  Loss: 1.3101 | Val  Acc: 0.5026
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3235 | Val  Acc: 0.4792
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3427 | Val  Acc: 0.4868
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3898 | Val  Acc: 0.4355
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3343 | Val  Acc: 0.4400
 Site-Black                     (2) | Val  Loss: 1.4180 | Val  Acc: 0.4302
 Site-Black                     (2) | Val  Loss: 1.3738 | Val  Acc: 0.4622
 Site-Black                     (2) | Val  Loss: 1.3680 | Val  Acc: 0.4983
 Site-East_Asian                (5) | Val  Loss: 1.3498 | Val  Acc: 0.4934
 Site-East_Asian                (6) | Val  Loss: 1.3880 | Val  Acc: 0.4582
 Site-Indian                    (0) | Val  Loss: 1.3823 | Val  Acc: 0.4598
 Site-Indian                    (0) | Val  Loss: 1.5183 | Val  Acc: 0.4323
 Site-Southeast_Asian           (5) | Val  Loss: 1.4484 | Val  Acc: 0.4545
 Site-Middle_Eastern            (4) | Val  Loss: 1.4172 | Val  Acc: 0.3932
Average Valid Accuracy: 0.4629
Aggregated Acc | Val Acc: 0.4539
 Best site-White                    (3)  | Epoch:49 | Val Acc: 0.4651
 Best site-White                    (3)  | Epoch:49 | Val Acc: 0.4852
 Best site-White                    (3)  | Epoch:49 | Val Acc: 0.4977
 Best site-White                    (3)  | Epoch:49 | Val Acc: 0.4586
 Best site-White                    (3)  | Epoch:49 | Val Acc: 0.5026
 Best site-Latino_Hispanic          (1)  | Epoch:49 | Val Acc: 0.4792
 Best site-Latino_Hispanic          (1)  | Epoch:49 | Val Acc: 0.4868
 Best site-Latino_Hispanic          (1)  | Epoch:49 | Val Acc: 0.4355
 Best site-Latino_Hispanic          (1)  | Epoch:49 | Val Acc: 0.4400
 Best site-Black                    (2)  | Epoch:49 | Val Acc: 0.4302
 Best site-Black                    (2)  | Epoch:49 | Val Acc: 0.4622
 Best site-Black                    (2)  | Epoch:49 | Val Acc: 0.4983
 Best site-East_Asian               (5)  | Epoch:49 | Val Acc: 0.4934
 Best site-East_Asian               (6)  | Epoch:49 | Val Acc: 0.4582
 Best site-Indian                   (0)  | Epoch:49 | Val Acc: 0.4598
 Best site-Indian                   (0)  | Epoch:49 | Val Acc: 0.4323
 Best site-Southeast_Asian          (5)  | Epoch:49 | Val Acc: 0.4545
 Best site-Middle_Eastern           (4)  | Epoch:49 | Val Acc: 0.3932
 Test site-White                    | Epoch:49 | Test Acc: 0.4439
 Test site-Latino_Hispanic          | Epoch:49 | Test Acc: 0.3924
 Test site-Black                    | Epoch:49 | Test Acc: 0.3469
 Test site-East_Asian               | Epoch:49 | Test Acc: 0.4740
 Test site-Indian                   | Epoch:49 | Test Acc: 0.3708
 Test site-Southeast_Asian          | Epoch:49 | Test Acc: 0.4074
 Test site-Middle_Eastern           | Epoch:49 | Test Acc: 0.4175
Average Test Accuracy: 0.4076, domain std=0.0398, individual std=0.0409
Average Test Accuracy: 0.4076
===2023-05-30 06:35:22===
===2023-05-30 06:35:37===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.8
    std_rw: False
data_number=[193,254,332,436,571,217,284,373,488,258,338,443,343,450,262,343,462,352,]
client_nums=[5,4,3,2,2,1,1,]
len_dataset=[2980,2274,1735,1324,1010,770,587,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
Loading snapshots...
 Test site-White                    | Epoch:45 | Test Acc: 0.4412
 Test site-Latino_Hispanic          | Epoch:45 | Test Acc: 0.3734
 Test site-Black                    | Epoch:45 | Test Acc: 0.3375
 Test site-East_Asian               | Epoch:45 | Test Acc: 0.5097
 Test site-Indian                   | Epoch:45 | Test Acc: 0.3900
 Test site-Southeast_Asian          | Epoch:45 | Test Acc: 0.4333
 Test site-Middle_Eastern           | Epoch:45 | Test Acc: 0.4175
Average Test Accuracy: 0.4147, domain std=0.0512, individual std=0.0512
===2023-06-07 16:29:38===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[193,254,332,436,571,217,284,373,488,258,338,443,343,450,262,343,462,352,]
client_nums=[5,4,3,2,2,1,1,]
len_dataset=[2980,2274,1735,1324,1010,770,587,]
domain number = 7
Loading snapshots...
 Test site-White                     | Epoch:45 | Test Acc: 0.4412
 Test site-Latino_Hispanic           | Epoch:45 | Test Acc: 0.3734
 Test site-Black                     | Epoch:45 | Test Acc: 0.3375
 Test site-East_Asian                | Epoch:45 | Test Acc: 0.5097
 Test site-Indian                    | Epoch:45 | Test Acc: 0.3900
 Test site-Southeast_Asian           | Epoch:45 | Test Acc: 0.4333
 Test site-Middle_Eastern            | Epoch:45 | Test Acc: 0.4175
White: 0.4412, Latino_Hispanic: 0.3734, Black: 0.3375, East_Asian: 0.5097, Indian: 0.3900, Southeast_Asian: 0.4333, Middle_Eastern: 0.4175, 
Average Test Accuracy(group): 0.4147, Average Test Accuracy(individual): 0.4090,
domain std=0.0512, cluster std=-1.0000, individual std=0.0512, 
