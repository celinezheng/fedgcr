===2023-03-26 13:59:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 4
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6872 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.7207 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 1.6507 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 1.7130 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 2.0764 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.0948 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.1854 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.1685 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 1.7252 | Val  Acc: 0.5676
 Site-MNIST     | Val  Loss: 1.6508 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 1.6899 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 1.6815 | Val  Acc: 0.6757
 Site-SynthDigits| Val  Loss: 2.0921 | Val  Acc: 0.2703
 Site-SynthDigits| Val  Loss: 2.0876 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1672 | Val  Acc: 0.2297
 Site-MNIST-M   | Val  Loss: 2.1686 | Val  Acc: 0.2432
Average Valid Accuracy: 0.4493
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5676
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6892
 Best site-USPS       | Epoch:0 | Val Acc: 0.6757
 Best site-USPS       | Epoch:0 | Val Acc: 0.6757
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2703
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2297
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1665 | Train Acc: 0.7477
 Site-MNIST     | Train Loss: 1.2130 | Train Acc: 0.7387
 Site-USPS      | Train Loss: 1.1008 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 1.1533 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.8295 | Train Acc: 0.3514
 Site-SynthDigits| Train Loss: 1.8783 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 1.9951 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 1.9708 | Train Acc: 0.3604
 Site-MNIST     | Val  Loss: 1.2278 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.1161 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 1.1452 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 1.1278 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.9114 | Val  Acc: 0.3243
 Site-SynthDigits| Val  Loss: 1.8022 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 1.9544 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 1.9940 | Val  Acc: 0.3108
Average Valid Accuracy: 0.5929
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7973
 Best site-USPS       | Epoch:1 | Val Acc: 0.8784
 Best site-USPS       | Epoch:1 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3243
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7316 | Train Acc: 0.7928
 Site-MNIST     | Train Loss: 0.7950 | Train Acc: 0.8288
 Site-USPS      | Train Loss: 0.6387 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.7308 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.6121 | Train Acc: 0.4234
 Site-SynthDigits| Train Loss: 1.5902 | Train Acc: 0.4775
 Site-MNIST-M   | Train Loss: 1.7615 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.7519 | Train Acc: 0.4144
 Site-MNIST     | Val  Loss: 0.8094 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.7187 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.7262 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.6780 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.6125 | Val  Acc: 0.4459
 Site-SynthDigits| Val  Loss: 1.6135 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.7627 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 1.7233 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6486
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-USPS       | Epoch:2 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4459
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4391 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.5118 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.3829 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.4360 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.4948 | Train Acc: 0.4505
 Site-SynthDigits| Train Loss: 1.5070 | Train Acc: 0.4685
 Site-MNIST-M   | Train Loss: 1.4533 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.5265 | Train Acc: 0.5045
 Site-MNIST     | Val  Loss: 0.5055 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.4730 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.4382 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.3907 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.5673 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 1.4684 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.4870 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.4613 | Val  Acc: 0.5405
Average Valid Accuracy: 0.6841
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-USPS       | Epoch:3 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5405
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3271 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.3913 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3702 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.4413 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.2084 | Train Acc: 0.5405
 Site-SynthDigits| Train Loss: 1.1466 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.2576 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.3568 | Train Acc: 0.5586
 Site-MNIST     | Val  Loss: 0.3712 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3830 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.4300 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.4038 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.2007 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 1.1393 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.3393 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.2489 | Val  Acc: 0.6351
Average Valid Accuracy: 0.7432
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8919
 Best site-USPS       | Epoch:4 | Val Acc: 0.8784
 Best site-USPS       | Epoch:4 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3200 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.3989 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3513 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3956 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.0952 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.1233 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 0.9979 | Train Acc: 0.7207
 Site-MNIST-M   | Train Loss: 1.0684 | Train Acc: 0.6486
 Site-MNIST     | Val  Loss: 0.3920 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.3881 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.3728 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.3803 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.1990 | Val  Acc: 0.5676
 Site-SynthDigits| Val  Loss: 1.0477 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.0335 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 0.9739 | Val  Acc: 0.7027
Average Valid Accuracy: 0.7753
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5676
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2479 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.2943 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.3257 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.3996 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.8284 | Train Acc: 0.7207
 Site-SynthDigits| Train Loss: 0.8312 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 0.7997 | Train Acc: 0.7387
 Site-MNIST-M   | Train Loss: 0.8417 | Train Acc: 0.7568
 Site-MNIST     | Val  Loss: 0.2717 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.3022 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.3906 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.3528 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.8881 | Val  Acc: 0.7162
 Site-SynthDigits| Val  Loss: 0.7575 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.8147 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.7560 | Val  Acc: 0.7703
Average Valid Accuracy: 0.8412
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-USPS       | Epoch:6 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7162
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1571 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1833 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.1914 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2298 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.7092 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 0.7173 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 0.4265 | Train Acc: 0.9279
 Site-MNIST-M   | Train Loss: 0.5295 | Train Acc: 0.8829
 Site-MNIST     | Val  Loss: 0.1849 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.1872 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2033 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2167 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.7872 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.6334 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 0.5116 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 0.4533 | Val  Acc: 0.9189
Average Valid Accuracy: 0.8818
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1018 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1126 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.1884 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.1851 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.4246 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.4391 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 0.2825 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.3485 | Train Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.1125 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1167 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1507 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.1990 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.4799 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.3868 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.3346 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.2961 | Val  Acc: 0.9730
Average Valid Accuracy: 0.9392
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-USPS       | Epoch:8 | Val Acc: 0.9595
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0958 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1208 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.1155 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.1311 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.4065 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.4401 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 0.2419 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 0.3230 | Train Acc: 0.9279
 Site-MNIST     | Val  Loss: 0.1220 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1199 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1200 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.1167 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.4728 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.3882 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.3262 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.2572 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9409
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SVHN...
===2023-03-26 14:33:34===
===2023-03-26 14:33:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 4
Loading snapshots...
Test Accuracy of SVHN: 0.3108
Average Test Accuracy: 0.3108
