===2023-03-27 18:00:25===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6099 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.6327 | Train Acc: 0.5856
 Site-MNIST     | Train Loss: 1.5353 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.5877 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 2.2197 | Train Acc: 0.1802
 Site-SVHN      | Train Loss: 2.2036 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.1117 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.6768 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 2.0902 | Train Acc: 0.2883
 Site-MNIST-M   | Train Loss: 2.1956 | Train Acc: 0.1712
 Site-MNIST     | Val  Loss: 1.5105 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.5376 | Val  Acc: 0.6351
 Site-MNIST     | Val  Loss: 1.6445 | Val  Acc: 0.5811
 Site-MNIST     | Val  Loss: 1.5425 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 2.0886 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 2.2607 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.1589 | Val  Acc: 0.2027
 Site-USPS      | Val  Loss: 1.7089 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 2.1073 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.2317 | Val  Acc: 0.1622
Average Valid Accuracy: 0.4297
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6351
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-USPS       | Epoch:0 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1317 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.1944 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.0543 | Train Acc: 0.7387
 Site-MNIST     | Train Loss: 1.1256 | Train Acc: 0.6937
 Site-SVHN      | Train Loss: 2.1046 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.0743 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 1.9461 | Train Acc: 0.3784
 Site-USPS      | Train Loss: 1.1521 | Train Acc: 0.6937
 Site-SynthDigits| Train Loss: 1.8498 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 2.0613 | Train Acc: 0.2523
 Site-MNIST     | Val  Loss: 1.0040 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 1.0735 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.2022 | Val  Acc: 0.6351
 Site-MNIST     | Val  Loss: 1.0856 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 1.9337 | Val  Acc: 0.3919
 Site-SVHN      | Val  Loss: 2.1711 | Val  Acc: 0.2162
 Site-SVHN      | Val  Loss: 1.9850 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.2067 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 1.9358 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 2.1293 | Val  Acc: 0.2027
Average Valid Accuracy: 0.4946
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6351
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3919
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2162
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2973
 Best site-USPS       | Epoch:1 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7153 | Train Acc: 0.7387
 Site-MNIST     | Train Loss: 0.7589 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 0.6092 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.7220 | Train Acc: 0.7658
 Site-SVHN      | Train Loss: 1.9537 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.9046 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.7846 | Train Acc: 0.4414
 Site-USPS      | Train Loss: 0.7565 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 1.6646 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 1.8491 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 0.5925 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.6290 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.7403 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 0.7077 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 1.7794 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.9570 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.9115 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 0.8391 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7970 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 1.9692 | Val  Acc: 0.3243
Average Valid Accuracy: 0.5797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2838
 Best site-USPS       | Epoch:2 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5129 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.5809 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.4214 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.5042 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.7663 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 1.6684 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.5171 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.5151 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.3786 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 1.6574 | Train Acc: 0.4685
 Site-MNIST     | Val  Loss: 0.4122 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4272 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5780 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.5426 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.5150 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.7754 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.6214 | Val  Acc: 0.4865
 Site-USPS      | Val  Loss: 0.5895 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.6053 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.9087 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6716
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4865
 Best site-USPS       | Epoch:3 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3130 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.3661 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.2186 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.3011 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 1.6451 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.5493 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 1.3706 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.4143 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.1998 | Train Acc: 0.5766
 Site-MNIST-M   | Train Loss: 1.4132 | Train Acc: 0.5135
 Site-MNIST     | Val  Loss: 0.2261 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2195 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.3396 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.3450 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.3642 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.6572 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.4943 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 0.5121 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.4583 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.8589 | Val  Acc: 0.4054
Average Valid Accuracy: 0.7095
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2186 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.2426 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.1461 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.2195 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.2935 | Train Acc: 0.5405
 Site-SVHN      | Train Loss: 1.2191 | Train Acc: 0.6126
 Site-SVHN      | Train Loss: 1.1182 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 0.3096 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.9734 | Train Acc: 0.6937
 Site-MNIST-M   | Train Loss: 1.0386 | Train Acc: 0.6937
 Site-MNIST     | Val  Loss: 0.1689 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1407 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.2110 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2463 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.1134 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 1.2973 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.1802 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 0.4373 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.3274 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.7533 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7662
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5946
 Best site-USPS       | Epoch:5 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1274 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.1520 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0862 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1145 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 1.1540 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.0236 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 0.8927 | Train Acc: 0.7297
 Site-USPS      | Train Loss: 0.2495 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.7721 | Train Acc: 0.7387
 Site-MNIST-M   | Train Loss: 0.7498 | Train Acc: 0.8018
 Site-MNIST     | Val  Loss: 0.0871 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0862 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1266 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1498 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.8754 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.1231 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 0.9776 | Val  Acc: 0.7027
 Site-USPS      | Val  Loss: 0.4087 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.2103 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.5553 | Val  Acc: 0.5676
Average Valid Accuracy: 0.8176
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7027
 Best site-USPS       | Epoch:6 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1113 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1317 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0725 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0954 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 0.8498 | Train Acc: 0.7387
 Site-SVHN      | Train Loss: 0.7751 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 0.6949 | Train Acc: 0.7658
 Site-USPS      | Train Loss: 0.1808 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.6240 | Train Acc: 0.7928
 Site-MNIST-M   | Train Loss: 0.5323 | Train Acc: 0.8829
 Site-MNIST     | Val  Loss: 0.0780 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0700 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1063 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1313 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.6835 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 0.8436 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 0.7677 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.3727 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.1919 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.5799 | Val  Acc: 0.5946
Average Valid Accuracy: 0.8392
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7973
 Best site-USPS       | Epoch:7 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0694 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0683 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0401 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0494 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.7161 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 0.6899 | Train Acc: 0.7658
 Site-SVHN      | Train Loss: 0.5833 | Train Acc: 0.8288
 Site-USPS      | Train Loss: 0.1286 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.4558 | Train Acc: 0.8649
 Site-MNIST-M   | Train Loss: 0.3562 | Train Acc: 0.9550
 Site-MNIST     | Val  Loss: 0.0396 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0391 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0584 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0670 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.5538 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 0.7536 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 0.6503 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.3364 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.0266 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 1.4399 | Val  Acc: 0.6351
Average Valid Accuracy: 0.8622
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8243
 Best site-USPS       | Epoch:8 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0561 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0521 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0287 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0344 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5766 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 0.5070 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 0.4332 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.1031 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.3879 | Train Acc: 0.8919
 Site-MNIST-M   | Train Loss: 0.2743 | Train Acc: 0.9550
 Site-MNIST     | Val  Loss: 0.0307 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0275 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0428 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0521 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4083 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 0.5329 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 0.5244 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.3218 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.0428 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 1.5367 | Val  Acc: 0.6216
Average Valid Accuracy: 0.8878
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8919
 Best site-USPS       | Epoch:9 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.5...
===2023-03-27 18:42:59===
===2023-03-27 18:43:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8900
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3652
 Test site-USPS      | Epoch:9 | Test Acc: 0.8441
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5582
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3514
Average Test Accuracy: 0.6018
