===2023-03-27 17:13:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.5868 | Train Acc: 0.5766
 Site-MNIST     | Train Loss: 1.6179 | Train Acc: 0.5766
 Site-MNIST     | Train Loss: 1.5387 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.5691 | Train Acc: 0.6757
 Site-SVHN      | Train Loss: 2.2042 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.2003 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.0879 | Train Acc: 0.2883
 Site-USPS      | Train Loss: 1.7055 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 2.1006 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.1874 | Train Acc: 0.1982
 Site-MNIST     | Val  Loss: 1.5027 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.5501 | Val  Acc: 0.6351
 Site-MNIST     | Val  Loss: 1.6152 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.5414 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 2.0712 | Val  Acc: 0.3243
 Site-SVHN      | Val  Loss: 2.2679 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1493 | Val  Acc: 0.2297
 Site-USPS      | Val  Loss: 1.7330 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 2.1163 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.2300 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4230
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6351
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3243
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2297
 Best site-USPS       | Epoch:0 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.0007 | Train Acc: 0.7387
 Site-MNIST     | Train Loss: 1.0713 | Train Acc: 0.7297
 Site-MNIST     | Train Loss: 0.9583 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 1.0071 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 2.0749 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0143 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.9002 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 1.1707 | Train Acc: 0.7207
 Site-SynthDigits| Train Loss: 1.8704 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.0279 | Train Acc: 0.2793
 Site-MNIST     | Val  Loss: 0.9129 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.9792 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 1.0700 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 0.9679 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 1.8975 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 2.1165 | Val  Acc: 0.2432
 Site-SVHN      | Val  Loss: 1.9910 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 1.2225 | Val  Acc: 0.7162
 Site-SynthDigits| Val  Loss: 1.9371 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.1336 | Val  Acc: 0.2432
Average Valid Accuracy: 0.5473
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2432
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-USPS       | Epoch:1 | Val Acc: 0.7162
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.6138 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.6653 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.5792 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.6621 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 1.9253 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 1.8853 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.6965 | Train Acc: 0.4955
 Site-USPS      | Train Loss: 0.7837 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.6319 | Train Acc: 0.4414
 Site-MNIST-M   | Train Loss: 1.8396 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 0.5553 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.5980 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.6381 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.6208 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 1.7101 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 2.0172 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 1.8033 | Val  Acc: 0.4054
 Site-USPS      | Val  Loss: 0.8703 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7250 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 2.0513 | Val  Acc: 0.3108
Average Valid Accuracy: 0.6081
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4054
 Best site-USPS       | Epoch:2 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4558 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.4774 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.3578 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.4409 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.7737 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 1.7246 | Train Acc: 0.4505
 Site-SVHN      | Train Loss: 1.5058 | Train Acc: 0.5225
 Site-USPS      | Train Loss: 0.5000 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.3926 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 1.6584 | Train Acc: 0.4595
 Site-MNIST     | Val  Loss: 0.3733 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.3491 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4475 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.4795 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.5101 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.8637 | Val  Acc: 0.3919
 Site-SVHN      | Val  Loss: 1.6569 | Val  Acc: 0.4595
 Site-USPS      | Val  Loss: 0.6071 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.5785 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.9513 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6662
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3919
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4595
 Best site-USPS       | Epoch:3 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2550 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2927 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.1933 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.2561 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 1.5071 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.4938 | Train Acc: 0.5405
 Site-SVHN      | Train Loss: 1.2719 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 0.3574 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 1.1664 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.3154 | Train Acc: 0.6036
 Site-MNIST     | Val  Loss: 0.1857 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1985 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2665 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.2865 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.2671 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 1.6434 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.3846 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 0.4884 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.4114 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.7929 | Val  Acc: 0.4459
Average Valid Accuracy: 0.7365
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:4 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5541
 Best site-USPS       | Epoch:4 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1590 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.2001 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.1113 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1652 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 1.3079 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.2436 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.0670 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 0.2944 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.9232 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.0293 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.0990 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1162 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1684 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.1939 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.0388 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 1.3862 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.1430 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 0.4632 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.2851 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.6890 | Val  Acc: 0.4730
Average Valid Accuracy: 0.7716
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:5 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6351
 Best site-USPS       | Epoch:5 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.0941 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1660 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.0820 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1148 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 1.0411 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 1.0112 | Train Acc: 0.7207
 Site-SVHN      | Train Loss: 0.8616 | Train Acc: 0.7477
 Site-USPS      | Train Loss: 0.2172 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 0.7621 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 0.8025 | Train Acc: 0.7658
 Site-MNIST     | Val  Loss: 0.0699 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0850 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1595 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.1412 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.8262 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.1077 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 0.9515 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 0.4047 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.2362 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 1.5952 | Val  Acc: 0.5135
Average Valid Accuracy: 0.8149
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7297
 Best site-USPS       | Epoch:6 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0785 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1342 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.0555 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0807 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.8074 | Train Acc: 0.7297
 Site-SVHN      | Train Loss: 0.8515 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 0.6755 | Train Acc: 0.8108
 Site-USPS      | Train Loss: 0.1737 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.6224 | Train Acc: 0.7838
 Site-MNIST-M   | Train Loss: 0.5854 | Train Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.0510 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0561 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1209 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1192 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.6499 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 0.9613 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 0.7318 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 0.4031 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.1926 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.5323 | Val  Acc: 0.5946
Average Valid Accuracy: 0.8405
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:7 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:7 | Val Acc: 0.8108
 Best site-USPS       | Epoch:7 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0626 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1090 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.0475 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0585 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.7264 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 0.7461 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 0.5447 | Train Acc: 0.8108
 Site-USPS      | Train Loss: 0.1249 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 0.4622 | Train Acc: 0.8829
 Site-MNIST-M   | Train Loss: 0.3949 | Train Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.0390 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0475 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1020 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.0947 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.5166 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 0.8450 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 0.6583 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.3953 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.0941 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.5105 | Val  Acc: 0.6351
Average Valid Accuracy: 0.8486
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8378
 Best site-USPS       | Epoch:8 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0358 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0662 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0268 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0323 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5638 | Train Acc: 0.8468
 Site-SVHN      | Train Loss: 0.5777 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 0.4173 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.0908 | Train Acc: 0.9910
 Site-SynthDigits| Train Loss: 0.3494 | Train Acc: 0.9369
 Site-MNIST-M   | Train Loss: 0.2974 | Train Acc: 0.9820
 Site-MNIST     | Val  Loss: 0.0219 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0503 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0668 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.4109 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 0.6543 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 0.4977 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.3745 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.0226 | Val  Acc: 0.7568
 Site-MNIST-M   | Val  Loss: 1.5101 | Val  Acc: 0.6351
Average Valid Accuracy: 0.8851
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8919
 Best site-USPS       | Epoch:9 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7568
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
===2023-03-27 17:56:28===
===2023-03-27 17:56:29===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8886
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3436
 Test site-USPS      | Epoch:9 | Test Acc: 0.8602
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5655
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3250
Average Test Accuracy: 0.5966
