===2023-08-03 08:16:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6953 | Train Acc: 0.6361
 Site-MNIST                     (2) | Train Loss: 1.7569 | Train Acc: 0.5686
 Site-USPS                      (2) | Train Loss: 1.6787 | Train Acc: 0.6119
 Site-USPS                      (2) | Train Loss: 1.6896 | Train Acc: 0.5892
 Site-SynthDigits               (0) | Train Loss: 2.0828 | Train Acc: 0.3288
 Site-SynthDigits               (0) | Train Loss: 2.0609 | Train Acc: 0.3345
 Site-MNIST_M                   (3) | Train Loss: 2.1527 | Train Acc: 0.2264
 Site-MNIST_M                   (3) | Train Loss: 2.1751 | Train Acc: 0.2054
 Site-SVHN                      (1) | Train Loss: 2.2009 | Train Acc: 0.1833
 Site-SVHN                      (1) | Train Loss: 2.2028 | Train Acc: 0.2108
Average Train Accuracy: 0.3895
 Site-MNIST                     (2) | Val  Loss: 1.7693 | Val  Acc: 0.5435
 Site-MNIST                     (2) | Val  Loss: 1.7402 | Val  Acc: 0.5899
 Site-USPS                      (2) | Val  Loss: 1.7620 | Val  Acc: 0.5543
 Site-USPS                      (2) | Val  Loss: 1.7301 | Val  Acc: 0.5719
 Site-SynthDigits               (0) | Val  Loss: 2.0961 | Val  Acc: 0.3043
 Site-SynthDigits               (0) | Val  Loss: 2.0716 | Val  Acc: 0.3381
 Site-MNIST_M                   (3) | Val  Loss: 2.0927 | Val  Acc: 0.2500
 Site-MNIST_M                   (3) | Val  Loss: 2.1633 | Val  Acc: 0.2230
 Site-SVHN                      (1) | Val  Loss: 2.1702 | Val  Acc: 0.2391
 Site-SVHN                      (1) | Val  Loss: 2.2057 | Val  Acc: 0.2050
Average Valid Accuracy: 0.3819
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5435
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5899
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5543
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5719
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3043
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3381
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2230
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2391
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (2) | Train Loss: 1.2930 | Train Acc: 0.7709
 Site-MNIST                     (2) | Train Loss: 1.3736 | Train Acc: 0.7076
 Site-USPS                      (1) | Train Loss: 1.2134 | Train Acc: 0.7466
 Site-USPS                      (1) | Train Loss: 1.2483 | Train Acc: 0.7453
 Site-SynthDigits               (2) | Train Loss: 1.8778 | Train Acc: 0.4178
 Site-SynthDigits               (2) | Train Loss: 1.7996 | Train Acc: 0.4475
 Site-MNIST_M                   (0) | Train Loss: 1.8876 | Train Acc: 0.3774
 Site-MNIST_M                   (0) | Train Loss: 1.9370 | Train Acc: 0.3381
 Site-SVHN                      (3) | Train Loss: 2.0636 | Train Acc: 0.2615
 Site-SVHN                      (3) | Train Loss: 2.0516 | Train Acc: 0.2807
===2023-08-03 11:40:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6953 | Train Acc: 0.6361
 Site-MNIST                     (2) | Train Loss: 1.7569 | Train Acc: 0.5686
 Site-USPS                      (2) | Train Loss: 1.6787 | Train Acc: 0.6119
 Site-USPS                      (2) | Train Loss: 1.6896 | Train Acc: 0.5892
 Site-SynthDigits               (0) | Train Loss: 2.0828 | Train Acc: 0.3288
 Site-SynthDigits               (0) | Train Loss: 2.0609 | Train Acc: 0.3345
 Site-MNIST_M                   (3) | Train Loss: 2.1527 | Train Acc: 0.2264
 Site-MNIST_M                   (3) | Train Loss: 2.1751 | Train Acc: 0.2054
 Site-SVHN                      (1) | Train Loss: 2.2009 | Train Acc: 0.1833
 Site-SVHN                      (1) | Train Loss: 2.2028 | Train Acc: 0.2108
Average Train Accuracy: 0.3895
 Site-MNIST                     (2) | Val  Loss: 1.7693 | Val  Acc: 0.5435
 Site-MNIST                     (2) | Val  Loss: 1.7402 | Val  Acc: 0.5899
 Site-USPS                      (2) | Val  Loss: 1.7620 | Val  Acc: 0.5543
 Site-USPS                      (2) | Val  Loss: 1.7301 | Val  Acc: 0.5719
 Site-SynthDigits               (0) | Val  Loss: 2.0961 | Val  Acc: 0.3043
 Site-SynthDigits               (0) | Val  Loss: 2.0716 | Val  Acc: 0.3381
 Site-MNIST_M                   (3) | Val  Loss: 2.0927 | Val  Acc: 0.2500
 Site-MNIST_M                   (3) | Val  Loss: 2.1633 | Val  Acc: 0.2230
 Site-SVHN                      (1) | Val  Loss: 2.1702 | Val  Acc: 0.2391
 Site-SVHN                      (1) | Val  Loss: 2.2057 | Val  Acc: 0.2050
Average Valid Accuracy: 0.3819
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5435
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5899
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5543
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5719
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3043
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3381
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2230
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2391
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (2) | Train Loss: 1.2930 | Train Acc: 0.7709
 Site-MNIST                     (2) | Train Loss: 1.3736 | Train Acc: 0.7076
 Site-USPS                      (1) | Train Loss: 1.2134 | Train Acc: 0.7466
 Site-USPS                      (1) | Train Loss: 1.2483 | Train Acc: 0.7453
 Site-SynthDigits               (2) | Train Loss: 1.8778 | Train Acc: 0.4178
 Site-SynthDigits               (2) | Train Loss: 1.7996 | Train Acc: 0.4475
 Site-MNIST_M                   (0) | Train Loss: 1.8876 | Train Acc: 0.3774
 Site-MNIST_M                   (0) | Train Loss: 1.9370 | Train Acc: 0.3381
 Site-SVHN                      (3) | Train Loss: 2.0636 | Train Acc: 0.2615
 Site-SVHN                      (3) | Train Loss: 2.0516 | Train Acc: 0.2807
Average Train Accuracy: 0.5093
 Site-MNIST                     (2) | Val  Loss: 1.3524 | Val  Acc: 0.7283
 Site-MNIST                     (2) | Val  Loss: 1.3499 | Val  Acc: 0.7482
 Site-USPS                      (1) | Val  Loss: 1.3184 | Val  Acc: 0.6630
 Site-USPS                      (1) | Val  Loss: 1.2979 | Val  Acc: 0.7230
 Site-SynthDigits               (2) | Val  Loss: 1.8399 | Val  Acc: 0.3696
 Site-SynthDigits               (2) | Val  Loss: 1.8145 | Val  Acc: 0.4209
 Site-MNIST_M                   (0) | Val  Loss: 1.8657 | Val  Acc: 0.3696
 Site-MNIST_M                   (0) | Val  Loss: 1.8967 | Val  Acc: 0.3885
 Site-SVHN                      (3) | Val  Loss: 2.0401 | Val  Acc: 0.3261
 Site-SVHN                      (3) | Val  Loss: 2.0662 | Val  Acc: 0.2986
Average Valid Accuracy: 0.5036
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7283
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7482
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.6630
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.7230
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3696
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.4209
 Best site-MNIST_M                  (0)  | Epoch:1 | Val Acc: 0.3696
 Best site-MNIST_M                  (0)  | Epoch:1 | Val Acc: 0.3885
 Best site-SVHN                     (3)  | Epoch:1 | Val Acc: 0.3261
 Best site-SVHN                     (3)  | Epoch:1 | Val Acc: 0.2986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 1.1223 | Train Acc: 0.7574
 Site-MNIST                     (0) | Train Loss: 1.2057 | Train Acc: 0.7112
 Site-USPS                      (0) | Train Loss: 1.0100 | Train Acc: 0.7817
 Site-USPS                      (0) | Train Loss: 1.0255 | Train Acc: 0.7561
 Site-SynthDigits               (3) | Train Loss: 1.6150 | Train Acc: 0.4825
 Site-SynthDigits               (3) | Train Loss: 1.5069 | Train Acc: 0.5336
 Site-MNIST_M                   (2) | Train Loss: 1.6948 | Train Acc: 0.4744
 Site-MNIST_M                   (2) | Train Loss: 1.7691 | Train Acc: 0.4395
 Site-SVHN                      (1) | Train Loss: 1.9153 | Train Acc: 0.3288
 Site-SVHN                      (1) | Train Loss: 1.8712 | Train Acc: 0.3471
Average Train Accuracy: 0.5612
 Site-MNIST                     (0) | Val  Loss: 1.1681 | Val  Acc: 0.7717
 Site-MNIST                     (0) | Val  Loss: 1.1887 | Val  Acc: 0.7626
 Site-USPS                      (0) | Val  Loss: 1.0878 | Val  Acc: 0.7283
 Site-USPS                      (0) | Val  Loss: 1.0965 | Val  Acc: 0.7374
 Site-SynthDigits               (3) | Val  Loss: 1.5144 | Val  Acc: 0.5217
 Site-SynthDigits               (3) | Val  Loss: 1.5321 | Val  Acc: 0.5072
 Site-MNIST_M                   (2) | Val  Loss: 1.7438 | Val  Acc: 0.4674
 Site-MNIST_M                   (2) | Val  Loss: 1.7253 | Val  Acc: 0.4784
 Site-SVHN                      (1) | Val  Loss: 1.9072 | Val  Acc: 0.2609
 Site-SVHN                      (1) | Val  Loss: 1.9326 | Val  Acc: 0.3094
Average Valid Accuracy: 0.5545
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7717
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7626
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7283
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7374
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.5217
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.5072
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.4674
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.4784
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2609
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3094
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (1) | Train Loss: 0.8703 | Train Acc: 0.8221
 Site-MNIST                     (1) | Train Loss: 0.9508 | Train Acc: 0.7857
 Site-USPS                      (2) | Train Loss: 0.8222 | Train Acc: 0.8329
 Site-USPS                      (2) | Train Loss: 0.8377 | Train Acc: 0.8188
 Site-SynthDigits               (1) | Train Loss: 1.4016 | Train Acc: 0.5687
 Site-SynthDigits               (1) | Train Loss: 1.2957 | Train Acc: 0.6233
 Site-MNIST_M                   (0) | Train Loss: 1.5924 | Train Acc: 0.4933
 Site-MNIST_M                   (0) | Train Loss: 1.6371 | Train Acc: 0.4852
 Site-SVHN                      (3) | Train Loss: 1.8117 | Train Acc: 0.3639
 Site-SVHN                      (3) | Train Loss: 1.7448 | Train Acc: 0.4090
Average Train Accuracy: 0.6203
 Site-MNIST                     (1) | Val  Loss: 0.9094 | Val  Acc: 0.8370
 Site-MNIST                     (1) | Val  Loss: 0.9331 | Val  Acc: 0.8309
 Site-USPS                      (2) | Val  Loss: 0.9250 | Val  Acc: 0.7283
 Site-USPS                      (2) | Val  Loss: 0.8959 | Val  Acc: 0.7878
 Site-SynthDigits               (1) | Val  Loss: 1.3410 | Val  Acc: 0.5543
 Site-SynthDigits               (1) | Val  Loss: 1.3180 | Val  Acc: 0.5647
 Site-MNIST_M                   (0) | Val  Loss: 1.6338 | Val  Acc: 0.5109
 Site-MNIST_M                   (0) | Val  Loss: 1.5995 | Val  Acc: 0.5504
 Site-SVHN                      (3) | Val  Loss: 1.7937 | Val  Acc: 0.2826
 Site-SVHN                      (3) | Val  Loss: 1.8145 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5989
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8370
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8309
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.7283
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.7878
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.5543
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.5647
 Best site-MNIST_M                  (0)  | Epoch:3 | Val Acc: 0.5109
 Best site-MNIST_M                  (0)  | Epoch:3 | Val Acc: 0.5504
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.2826
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (2) | Train Loss: 0.7502 | Train Acc: 0.8437
 Site-MNIST                     (2) | Train Loss: 0.8372 | Train Acc: 0.8099
 Site-USPS                      (3) | Train Loss: 0.7435 | Train Acc: 0.8518
 Site-USPS                      (3) | Train Loss: 0.7673 | Train Acc: 0.8269
 Site-SynthDigits               (2) | Train Loss: 1.2604 | Train Acc: 0.6011
 Site-SynthDigits               (2) | Train Loss: 1.1573 | Train Acc: 0.6583
 Site-MNIST_M                   (1) | Train Loss: 1.4708 | Train Acc: 0.5687
 Site-MNIST_M                   (1) | Train Loss: 1.5100 | Train Acc: 0.5659
 Site-SVHN                      (0) | Train Loss: 1.6909 | Train Acc: 0.4313
 Site-SVHN                      (0) | Train Loss: 1.6223 | Train Acc: 0.4448
Average Train Accuracy: 0.6602
 Site-MNIST                     (2) | Val  Loss: 0.7641 | Val  Acc: 0.8804
 Site-MNIST                     (2) | Val  Loss: 0.8131 | Val  Acc: 0.8633
 Site-USPS                      (3) | Val  Loss: 0.8602 | Val  Acc: 0.7391
 Site-USPS                      (3) | Val  Loss: 0.8236 | Val  Acc: 0.8022
 Site-SynthDigits               (2) | Val  Loss: 1.2015 | Val  Acc: 0.5761
 Site-SynthDigits               (2) | Val  Loss: 1.1838 | Val  Acc: 0.5971
 Site-MNIST_M                   (1) | Val  Loss: 1.5104 | Val  Acc: 0.5761
 Site-MNIST_M                   (1) | Val  Loss: 1.4743 | Val  Acc: 0.6187
 Site-SVHN                      (0) | Val  Loss: 1.6669 | Val  Acc: 0.3913
 Site-SVHN                      (0) | Val  Loss: 1.6802 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6472
 Best site-MNIST                    (2)  | Epoch:4 | Val Acc: 0.8804
 Best site-MNIST                    (2)  | Epoch:4 | Val Acc: 0.8633
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.7391
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8022
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5761
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5971
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5761
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.6187
 Best site-SVHN                     (0)  | Epoch:4 | Val Acc: 0.3913
 Best site-SVHN                     (0)  | Epoch:4 | Val Acc: 0.4281
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (2) | Train Loss: 0.6592 | Train Acc: 0.8518
 Site-MNIST                     (2) | Train Loss: 0.7438 | Train Acc: 0.8233
 Site-USPS                      (0) | Train Loss: 0.6850 | Train Acc: 0.8491
 Site-USPS                      (0) | Train Loss: 0.7018 | Train Acc: 0.8422
 Site-SynthDigits               (2) | Train Loss: 1.1101 | Train Acc: 0.6550
 Site-SynthDigits               (2) | Train Loss: 1.0177 | Train Acc: 0.7094
 Site-MNIST_M                   (1) | Train Loss: 1.3633 | Train Acc: 0.6011
 Site-MNIST_M                   (1) | Train Loss: 1.3895 | Train Acc: 0.6161
 Site-SVHN                      (3) | Train Loss: 1.5211 | Train Acc: 0.4879
 Site-SVHN                      (3) | Train Loss: 1.4746 | Train Acc: 0.5157
Average Train Accuracy: 0.6951
 Site-MNIST                     (2) | Val  Loss: 0.6558 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.7204 | Val  Acc: 0.8525
 Site-USPS                      (0) | Val  Loss: 0.8040 | Val  Acc: 0.7609
 Site-USPS                      (0) | Val  Loss: 0.7627 | Val  Acc: 0.8129
 Site-SynthDigits               (2) | Val  Loss: 1.0506 | Val  Acc: 0.6304
 Site-SynthDigits               (2) | Val  Loss: 1.0439 | Val  Acc: 0.6439
 Site-MNIST_M                   (1) | Val  Loss: 1.3967 | Val  Acc: 0.6087
 Site-MNIST_M                   (1) | Val  Loss: 1.3610 | Val  Acc: 0.6331
 Site-SVHN                      (3) | Val  Loss: 1.5109 | Val  Acc: 0.4674
 Site-SVHN                      (3) | Val  Loss: 1.5153 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6812
 Best site-MNIST                    (2)  | Epoch:5 | Val Acc: 0.9022
 Best site-MNIST                    (2)  | Epoch:5 | Val Acc: 0.8525
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7609
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8129
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6304
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6439
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.6087
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.6331
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.4674
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (0) | Train Loss: 0.5782 | Train Acc: 0.8733
 Site-MNIST                     (0) | Train Loss: 0.6602 | Train Acc: 0.8395
 Site-USPS                      (1) | Train Loss: 0.6291 | Train Acc: 0.8625
 Site-USPS                      (1) | Train Loss: 0.6497 | Train Acc: 0.8475
 Site-SynthDigits               (0) | Train Loss: 0.9971 | Train Acc: 0.6927
 Site-SynthDigits               (0) | Train Loss: 0.9194 | Train Acc: 0.7453
 Site-MNIST_M                   (2) | Train Loss: 1.2535 | Train Acc: 0.6307
 Site-MNIST_M                   (2) | Train Loss: 1.2841 | Train Acc: 0.6475
 Site-SVHN                      (3) | Train Loss: 1.4405 | Train Acc: 0.5202
 Site-SVHN                      (3) | Train Loss: 1.3952 | Train Acc: 0.5435
Average Train Accuracy: 0.7203
 Site-MNIST                     (0) | Val  Loss: 0.5666 | Val  Acc: 0.8913
 Site-MNIST                     (0) | Val  Loss: 0.6419 | Val  Acc: 0.8597
 Site-USPS                      (1) | Val  Loss: 0.7626 | Val  Acc: 0.7826
 Site-USPS                      (1) | Val  Loss: 0.7198 | Val  Acc: 0.8237
 Site-SynthDigits               (0) | Val  Loss: 0.9399 | Val  Acc: 0.6522
 Site-SynthDigits               (0) | Val  Loss: 0.9382 | Val  Acc: 0.6763
 Site-MNIST_M                   (2) | Val  Loss: 1.2877 | Val  Acc: 0.6304
 Site-MNIST_M                   (2) | Val  Loss: 1.2383 | Val  Acc: 0.6511
 Site-SVHN                      (3) | Val  Loss: 1.4378 | Val  Acc: 0.5000
 Site-SVHN                      (3) | Val  Loss: 1.4358 | Val  Acc: 0.5360
Average Valid Accuracy: 0.7003
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8913
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8597
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7826
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8237
 Best site-SynthDigits              (0)  | Epoch:6 | Val Acc: 0.6522
 Best site-SynthDigits              (0)  | Epoch:6 | Val Acc: 0.6763
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.6304
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.6511
 Best site-SVHN                     (3)  | Epoch:6 | Val Acc: 0.5000
 Best site-SVHN                     (3)  | Epoch:6 | Val Acc: 0.5360
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (2) | Train Loss: 0.5475 | Train Acc: 0.8491
 Site-MNIST                     (2) | Train Loss: 0.6301 | Train Acc: 0.8278
 Site-USPS                      (0) | Train Loss: 0.5899 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.6097 | Train Acc: 0.8484
 Site-SynthDigits               (2) | Train Loss: 0.9215 | Train Acc: 0.7035
 Site-SynthDigits               (2) | Train Loss: 0.8492 | Train Acc: 0.7578
 Site-MNIST_M                   (1) | Train Loss: 1.2003 | Train Acc: 0.6361
 Site-MNIST_M                   (1) | Train Loss: 1.2160 | Train Acc: 0.6601
 Site-SVHN                      (3) | Train Loss: 1.3766 | Train Acc: 0.5445
 Site-SVHN                      (3) | Train Loss: 1.3037 | Train Acc: 0.5839
Average Train Accuracy: 0.7268
 Site-MNIST                     (2) | Val  Loss: 0.5322 | Val  Acc: 0.8696
 Site-MNIST                     (2) | Val  Loss: 0.6133 | Val  Acc: 0.8453
 Site-USPS                      (0) | Val  Loss: 0.7284 | Val  Acc: 0.7826
 Site-USPS                      (0) | Val  Loss: 0.6823 | Val  Acc: 0.8165
 Site-SynthDigits               (2) | Val  Loss: 0.8732 | Val  Acc: 0.6630
 Site-SynthDigits               (2) | Val  Loss: 0.8706 | Val  Acc: 0.7014
 Site-MNIST_M                   (1) | Val  Loss: 1.2216 | Val  Acc: 0.6739
 Site-MNIST_M                   (1) | Val  Loss: 1.1714 | Val  Acc: 0.6871
 Site-SVHN                      (3) | Val  Loss: 1.3340 | Val  Acc: 0.5435
 Site-SVHN                      (3) | Val  Loss: 1.3495 | Val  Acc: 0.5612
Average Valid Accuracy: 0.7144
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8696
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8453
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7826
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8165
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6630
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.7014
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.6739
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.6871
 Best site-SVHN                     (3)  | Epoch:7 | Val Acc: 0.5435
 Best site-SVHN                     (3)  | Epoch:7 | Val Acc: 0.5612
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (2) | Train Loss: 0.4947 | Train Acc: 0.8706
 Site-MNIST                     (2) | Train Loss: 0.5833 | Train Acc: 0.8341
 Site-USPS                      (3) | Train Loss: 0.5884 | Train Acc: 0.8491
 Site-USPS                      (3) | Train Loss: 0.6033 | Train Acc: 0.8422
 Site-SynthDigits               (2) | Train Loss: 0.8424 | Train Acc: 0.7412
 Site-SynthDigits               (2) | Train Loss: 0.7773 | Train Acc: 0.7677
 Site-MNIST_M                   (0) | Train Loss: 1.1353 | Train Acc: 0.6442
 Site-MNIST_M                   (0) | Train Loss: 1.1353 | Train Acc: 0.6789
 Site-SVHN                      (1) | Train Loss: 1.2621 | Train Acc: 0.5768
 Site-SVHN                      (1) | Train Loss: 1.2051 | Train Acc: 0.6135
Average Train Accuracy: 0.7418
 Site-MNIST                     (2) | Val  Loss: 0.4910 | Val  Acc: 0.8804
 Site-MNIST                     (2) | Val  Loss: 0.5707 | Val  Acc: 0.8489
 Site-USPS                      (3) | Val  Loss: 0.7222 | Val  Acc: 0.7500
 Site-USPS                      (3) | Val  Loss: 0.6869 | Val  Acc: 0.7986
 Site-SynthDigits               (2) | Val  Loss: 0.8054 | Val  Acc: 0.6848
 Site-SynthDigits               (2) | Val  Loss: 0.8050 | Val  Acc: 0.7158
 Site-MNIST_M                   (0) | Val  Loss: 1.1724 | Val  Acc: 0.6413
 Site-MNIST_M                   (0) | Val  Loss: 1.1076 | Val  Acc: 0.6727
 Site-SVHN                      (1) | Val  Loss: 1.2424 | Val  Acc: 0.6087
 Site-SVHN                      (1) | Val  Loss: 1.2389 | Val  Acc: 0.6079
Average Valid Accuracy: 0.7209
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8804
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8489
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7500
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7986
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.6848
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7158
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.6413
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.6727
 Best site-SVHN                     (1)  | Epoch:8 | Val Acc: 0.6087
 Best site-SVHN                     (1)  | Epoch:8 | Val Acc: 0.6079
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 9 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.4498 | Train Acc: 0.8787
 Site-MNIST                     (0) | Train Loss: 0.5215 | Train Acc: 0.8655
 Site-USPS                      (1) | Train Loss: 0.5024 | Train Acc: 0.8544
 Site-USPS                      (1) | Train Loss: 0.5207 | Train Acc: 0.8646
 Site-SynthDigits               (0) | Train Loss: 0.8367 | Train Acc: 0.7305
 Site-SynthDigits               (0) | Train Loss: 0.7595 | Train Acc: 0.7785
 Site-MNIST_M                   (2) | Train Loss: 1.0927 | Train Acc: 0.6765
 Site-MNIST_M                   (2) | Train Loss: 1.0926 | Train Acc: 0.7040
 Site-SVHN                      (3) | Train Loss: 1.2913 | Train Acc: 0.5768
 Site-SVHN                      (3) | Train Loss: 1.2060 | Train Acc: 0.6036
Average Train Accuracy: 0.7533
 Site-MNIST                     (0) | Val  Loss: 0.4228 | Val  Acc: 0.9130
 Site-MNIST                     (0) | Val  Loss: 0.5069 | Val  Acc: 0.8813
 Site-USPS                      (1) | Val  Loss: 0.6547 | Val  Acc: 0.7826
 Site-USPS                      (1) | Val  Loss: 0.5907 | Val  Acc: 0.8237
 Site-SynthDigits               (0) | Val  Loss: 0.8066 | Val  Acc: 0.7174
 Site-SynthDigits               (0) | Val  Loss: 0.7824 | Val  Acc: 0.7230
 Site-MNIST_M                   (2) | Val  Loss: 1.1055 | Val  Acc: 0.6957
 Site-MNIST_M                   (2) | Val  Loss: 1.0489 | Val  Acc: 0.7230
 Site-SVHN                      (3) | Val  Loss: 1.2712 | Val  Acc: 0.5435
 Site-SVHN                      (3) | Val  Loss: 1.2649 | Val  Acc: 0.5899
Average Valid Accuracy: 0.7393
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.9130
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8813
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.7826
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.8237
 Best site-SynthDigits              (0)  | Epoch:9 | Val Acc: 0.7174
 Best site-SynthDigits              (0)  | Epoch:9 | Val Acc: 0.7230
 Best site-MNIST_M                  (2)  | Epoch:9 | Val Acc: 0.6957
 Best site-MNIST_M                  (2)  | Epoch:9 | Val Acc: 0.7230
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5435
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5899
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (1) | Train Loss: 0.4454 | Train Acc: 0.8625
 Site-MNIST                     (1) | Train Loss: 0.5263 | Train Acc: 0.8484
 Site-USPS                      (3) | Train Loss: 0.5081 | Train Acc: 0.8598
 Site-USPS                      (3) | Train Loss: 0.5248 | Train Acc: 0.8538
 Site-SynthDigits               (1) | Train Loss: 0.7556 | Train Acc: 0.7817
 Site-SynthDigits               (1) | Train Loss: 0.7036 | Train Acc: 0.7973
 Site-MNIST_M                   (2) | Train Loss: 1.0319 | Train Acc: 0.6765
 Site-MNIST_M                   (2) | Train Loss: 1.0271 | Train Acc: 0.7256
 Site-SVHN                      (0) | Train Loss: 1.2015 | Train Acc: 0.6092
 Site-SVHN                      (0) | Train Loss: 1.1330 | Train Acc: 0.6350
Average Train Accuracy: 0.7650
 Site-MNIST                     (1) | Val  Loss: 0.4141 | Val  Acc: 0.8804
 Site-MNIST                     (1) | Val  Loss: 0.5041 | Val  Acc: 0.8561
 Site-USPS                      (3) | Val  Loss: 0.6577 | Val  Acc: 0.7609
 Site-USPS                      (3) | Val  Loss: 0.5987 | Val  Acc: 0.8201
 Site-SynthDigits               (1) | Val  Loss: 0.7224 | Val  Acc: 0.7609
 Site-SynthDigits               (1) | Val  Loss: 0.7229 | Val  Acc: 0.7662
 Site-MNIST_M                   (2) | Val  Loss: 1.0469 | Val  Acc: 0.7174
 Site-MNIST_M                   (2) | Val  Loss: 0.9884 | Val  Acc: 0.7446
 Site-SVHN                      (0) | Val  Loss: 1.1606 | Val  Acc: 0.6522
 Site-SVHN                      (0) | Val  Loss: 1.1683 | Val  Acc: 0.6475
Average Valid Accuracy: 0.7606
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8804
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8561
 Best site-USPS                     (3)  | Epoch:10 | Val Acc: 0.7609
 Best site-USPS                     (3)  | Epoch:10 | Val Acc: 0.8201
 Best site-SynthDigits              (1)  | Epoch:10 | Val Acc: 0.7609
 Best site-SynthDigits              (1)  | Epoch:10 | Val Acc: 0.7662
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.7174
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.7446
 Best site-SVHN                     (0)  | Epoch:10 | Val Acc: 0.6522
 Best site-SVHN                     (0)  | Epoch:10 | Val Acc: 0.6475
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (1) | Train Loss: 0.3997 | Train Acc: 0.8841
 Site-MNIST                     (1) | Train Loss: 0.4678 | Train Acc: 0.8664
 Site-USPS                      (2) | Train Loss: 0.4972 | Train Acc: 0.8544
 Site-USPS                      (2) | Train Loss: 0.5065 | Train Acc: 0.8574
 Site-SynthDigits               (1) | Train Loss: 0.7078 | Train Acc: 0.8005
 Site-SynthDigits               (1) | Train Loss: 0.6548 | Train Acc: 0.8117
 Site-MNIST_M                   (3) | Train Loss: 0.9949 | Train Acc: 0.6954
 Site-MNIST_M                   (3) | Train Loss: 0.9791 | Train Acc: 0.7408
 Site-SVHN                      (0) | Train Loss: 1.1578 | Train Acc: 0.6361
 Site-SVHN                      (0) | Train Loss: 1.0820 | Train Acc: 0.6583
Average Train Accuracy: 0.7805
 Site-MNIST                     (1) | Val  Loss: 0.3703 | Val  Acc: 0.9022
 Site-MNIST                     (1) | Val  Loss: 0.4624 | Val  Acc: 0.8885
 Site-USPS                      (2) | Val  Loss: 0.6478 | Val  Acc: 0.8043
 Site-USPS                      (2) | Val  Loss: 0.5833 | Val  Acc: 0.8381
 Site-SynthDigits               (1) | Val  Loss: 0.6805 | Val  Acc: 0.7826
 Site-SynthDigits               (1) | Val  Loss: 0.6737 | Val  Acc: 0.7842
 Site-MNIST_M                   (3) | Val  Loss: 1.0139 | Val  Acc: 0.6957
 Site-MNIST_M                   (3) | Val  Loss: 0.9489 | Val  Acc: 0.7446
 Site-SVHN                      (0) | Val  Loss: 1.1153 | Val  Acc: 0.6304
 Site-SVHN                      (0) | Val  Loss: 1.1181 | Val  Acc: 0.6547
Average Valid Accuracy: 0.7725
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.9022
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8885
 Best site-USPS                     (2)  | Epoch:11 | Val Acc: 0.8043
 Best site-USPS                     (2)  | Epoch:11 | Val Acc: 0.8381
 Best site-SynthDigits              (1)  | Epoch:11 | Val Acc: 0.7826
 Best site-SynthDigits              (1)  | Epoch:11 | Val Acc: 0.7842
 Best site-MNIST_M                  (3)  | Epoch:11 | Val Acc: 0.6957
 Best site-MNIST_M                  (3)  | Epoch:11 | Val Acc: 0.7446
 Best site-SVHN                     (0)  | Epoch:11 | Val Acc: 0.6304
 Best site-SVHN                     (0)  | Epoch:11 | Val Acc: 0.6547
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (1) | Train Loss: 0.3734 | Train Acc: 0.8976
 Site-MNIST                     (1) | Train Loss: 0.4436 | Train Acc: 0.8789
 Site-USPS                      (2) | Train Loss: 0.4663 | Train Acc: 0.8571
 Site-USPS                      (2) | Train Loss: 0.4820 | Train Acc: 0.8637
 Site-SynthDigits               (2) | Train Loss: 0.6649 | Train Acc: 0.8221
 Site-SynthDigits               (2) | Train Loss: 0.6096 | Train Acc: 0.8314
 Site-MNIST_M                   (3) | Train Loss: 0.9550 | Train Acc: 0.7062
 Site-MNIST_M                   (3) | Train Loss: 0.9348 | Train Acc: 0.7498
 Site-SVHN                      (0) | Train Loss: 1.1190 | Train Acc: 0.6442
 Site-SVHN                      (0) | Train Loss: 1.0322 | Train Acc: 0.6744
Average Train Accuracy: 0.7925
 Site-MNIST                     (1) | Val  Loss: 0.3444 | Val  Acc: 0.9130
 Site-MNIST                     (1) | Val  Loss: 0.4357 | Val  Acc: 0.8993
 Site-USPS                      (2) | Val  Loss: 0.6213 | Val  Acc: 0.8043
 Site-USPS                      (2) | Val  Loss: 0.5536 | Val  Acc: 0.8345
 Site-SynthDigits               (2) | Val  Loss: 0.6306 | Val  Acc: 0.8043
 Site-SynthDigits               (2) | Val  Loss: 0.6263 | Val  Acc: 0.8094
 Site-MNIST_M                   (3) | Val  Loss: 0.9718 | Val  Acc: 0.6957
 Site-MNIST_M                   (3) | Val  Loss: 0.9019 | Val  Acc: 0.7518
 Site-SVHN                      (0) | Val  Loss: 1.0777 | Val  Acc: 0.6739
 Site-SVHN                      (0) | Val  Loss: 1.0742 | Val  Acc: 0.6727
Average Valid Accuracy: 0.7859
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.9130
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8993
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.8043
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.8345
 Best site-SynthDigits              (2)  | Epoch:12 | Val Acc: 0.8043
 Best site-SynthDigits              (2)  | Epoch:12 | Val Acc: 0.8094
 Best site-MNIST_M                  (3)  | Epoch:12 | Val Acc: 0.6957
 Best site-MNIST_M                  (3)  | Epoch:12 | Val Acc: 0.7518
 Best site-SVHN                     (0)  | Epoch:12 | Val Acc: 0.6739
 Best site-SVHN                     (0)  | Epoch:12 | Val Acc: 0.6727
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (3) | Train Loss: 0.3503 | Train Acc: 0.9111
 Site-MNIST                     (3) | Train Loss: 0.4206 | Train Acc: 0.8825
 Site-USPS                      (1) | Train Loss: 0.4440 | Train Acc: 0.8679
 Site-USPS                      (1) | Train Loss: 0.4578 | Train Acc: 0.8655
 Site-SynthDigits               (1) | Train Loss: 0.6546 | Train Acc: 0.8113
 Site-SynthDigits               (1) | Train Loss: 0.6021 | Train Acc: 0.8260
 Site-MNIST_M                   (0) | Train Loss: 0.9138 | Train Acc: 0.7412
 Site-MNIST_M                   (0) | Train Loss: 0.8950 | Train Acc: 0.7570
 Site-SVHN                      (2) | Train Loss: 1.0936 | Train Acc: 0.6388
 Site-SVHN                      (2) | Train Loss: 1.0133 | Train Acc: 0.6789
Average Train Accuracy: 0.7980
 Site-MNIST                     (3) | Val  Loss: 0.3171 | Val  Acc: 0.9130
 Site-MNIST                     (3) | Val  Loss: 0.4122 | Val  Acc: 0.9065
 Site-USPS                      (1) | Val  Loss: 0.5889 | Val  Acc: 0.7935
 Site-USPS                      (1) | Val  Loss: 0.5244 | Val  Acc: 0.8345
 Site-SynthDigits               (1) | Val  Loss: 0.6318 | Val  Acc: 0.7826
 Site-SynthDigits               (1) | Val  Loss: 0.6236 | Val  Acc: 0.7914
 Site-MNIST_M                   (0) | Val  Loss: 0.9311 | Val  Acc: 0.7174
 Site-MNIST_M                   (0) | Val  Loss: 0.8624 | Val  Acc: 0.7662
 Site-SVHN                      (2) | Val  Loss: 1.0497 | Val  Acc: 0.6848
 Site-SVHN                      (2) | Val  Loss: 1.0539 | Val  Acc: 0.6799
Average Valid Accuracy: 0.7870
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.9130
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.9065
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.7935
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8345
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7826
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7914
 Best site-MNIST_M                  (0)  | Epoch:13 | Val Acc: 0.7174
 Best site-MNIST_M                  (0)  | Epoch:13 | Val Acc: 0.7662
 Best site-SVHN                     (2)  | Epoch:13 | Val Acc: 0.6848
 Best site-SVHN                     (2)  | Epoch:13 | Val Acc: 0.6799
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (3) | Train Loss: 0.3277 | Train Acc: 0.9084
 Site-MNIST                     (3) | Train Loss: 0.4008 | Train Acc: 0.8906
 Site-USPS                      (1) | Train Loss: 0.4182 | Train Acc: 0.8706
 Site-USPS                      (1) | Train Loss: 0.4198 | Train Acc: 0.8735
 Site-SynthDigits               (1) | Train Loss: 0.6376 | Train Acc: 0.8140
 Site-SynthDigits               (1) | Train Loss: 0.5768 | Train Acc: 0.8269
 Site-MNIST_M                   (0) | Train Loss: 0.8734 | Train Acc: 0.7385
 Site-MNIST_M                   (0) | Train Loss: 0.8541 | Train Acc: 0.7614
 Site-SVHN                      (2) | Train Loss: 1.0742 | Train Acc: 0.6496
 Site-SVHN                      (2) | Train Loss: 0.9731 | Train Acc: 0.6888
Average Train Accuracy: 0.8022
 Site-MNIST                     (3) | Val  Loss: 0.2974 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.3932 | Val  Acc: 0.9209
 Site-USPS                      (1) | Val  Loss: 0.5665 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.4958 | Val  Acc: 0.8345
 Site-SynthDigits               (1) | Val  Loss: 0.6200 | Val  Acc: 0.7717
 Site-SynthDigits               (1) | Val  Loss: 0.6048 | Val  Acc: 0.7914
 Site-MNIST_M                   (0) | Val  Loss: 0.8973 | Val  Acc: 0.7174
 Site-MNIST_M                   (0) | Val  Loss: 0.8201 | Val  Acc: 0.7698
 Site-SVHN                      (2) | Val  Loss: 1.0188 | Val  Acc: 0.7065
 Site-SVHN                      (2) | Val  Loss: 1.0149 | Val  Acc: 0.6691
Average Valid Accuracy: 0.7910
 Best site-MNIST                    (3)  | Epoch:14 | Val Acc: 0.9239
 Best site-MNIST                    (3)  | Epoch:14 | Val Acc: 0.9209
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8345
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7717
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7914
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.7174
 Best site-MNIST_M                  (0)  | Epoch:14 | Val Acc: 0.7698
 Best site-SVHN                     (2)  | Epoch:14 | Val Acc: 0.7065
 Best site-SVHN                     (2)  | Epoch:14 | Val Acc: 0.6691
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (0) | Train Loss: 0.3132 | Train Acc: 0.9218
 Site-MNIST                     (0) | Train Loss: 0.3847 | Train Acc: 0.8960
 Site-USPS                      (1) | Train Loss: 0.4036 | Train Acc: 0.8679
 Site-USPS                      (1) | Train Loss: 0.4040 | Train Acc: 0.8807
 Site-SynthDigits               (1) | Train Loss: 0.6254 | Train Acc: 0.8248
 Site-SynthDigits               (1) | Train Loss: 0.5664 | Train Acc: 0.8386
 Site-MNIST_M                   (3) | Train Loss: 0.8329 | Train Acc: 0.7601
 Site-MNIST_M                   (3) | Train Loss: 0.8132 | Train Acc: 0.7767
 Site-SVHN                      (2) | Train Loss: 1.0971 | Train Acc: 0.6307
 Site-SVHN                      (2) | Train Loss: 0.9659 | Train Acc: 0.6879
Average Train Accuracy: 0.8085
 Site-MNIST                     (0) | Val  Loss: 0.2797 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.3786 | Val  Acc: 0.9209
 Site-USPS                      (1) | Val  Loss: 0.5519 | Val  Acc: 0.8152
 Site-USPS                      (1) | Val  Loss: 0.4760 | Val  Acc: 0.8489
 Site-SynthDigits               (1) | Val  Loss: 0.6126 | Val  Acc: 0.7826
 Site-SynthDigits               (1) | Val  Loss: 0.5867 | Val  Acc: 0.8129
 Site-MNIST_M                   (3) | Val  Loss: 0.8644 | Val  Acc: 0.7174
 Site-MNIST_M                   (3) | Val  Loss: 0.7839 | Val  Acc: 0.7950
 Site-SVHN                      (2) | Val  Loss: 1.0092 | Val  Acc: 0.6848
 Site-SVHN                      (2) | Val  Loss: 1.0230 | Val  Acc: 0.6799
Average Valid Accuracy: 0.8003
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9209
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8152
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8489
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.7826
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8129
 Best site-MNIST_M                  (3)  | Epoch:15 | Val Acc: 0.7174
 Best site-MNIST_M                  (3)  | Epoch:15 | Val Acc: 0.7950
 Best site-SVHN                     (2)  | Epoch:15 | Val Acc: 0.6848
 Best site-SVHN                     (2)  | Epoch:15 | Val Acc: 0.6799
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 16 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (3) | Train Loss: 0.3194 | Train Acc: 0.9137
 Site-MNIST                     (3) | Train Loss: 0.3823 | Train Acc: 0.8951
 Site-USPS                      (0) | Train Loss: 0.4013 | Train Acc: 0.8787
 Site-USPS                      (0) | Train Loss: 0.4073 | Train Acc: 0.8843
 Site-SynthDigits               (0) | Train Loss: 0.5775 | Train Acc: 0.8356
 Site-SynthDigits               (0) | Train Loss: 0.5290 | Train Acc: 0.8619
 Site-MNIST_M                   (1) | Train Loss: 0.8284 | Train Acc: 0.7439
 Site-MNIST_M                   (1) | Train Loss: 0.7954 | Train Acc: 0.7749
 Site-SVHN                      (2) | Train Loss: 1.0382 | Train Acc: 0.6631
 Site-SVHN                      (2) | Train Loss: 0.9155 | Train Acc: 0.7058
Average Train Accuracy: 0.8157
 Site-MNIST                     (3) | Val  Loss: 0.2814 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.3846 | Val  Acc: 0.9173
 Site-USPS                      (0) | Val  Loss: 0.5460 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.4749 | Val  Acc: 0.8525
 Site-SynthDigits               (0) | Val  Loss: 0.5683 | Val  Acc: 0.8152
 Site-SynthDigits               (0) | Val  Loss: 0.5428 | Val  Acc: 0.8273
 Site-MNIST_M                   (1) | Val  Loss: 0.8462 | Val  Acc: 0.7283
 Site-MNIST_M                   (1) | Val  Loss: 0.7728 | Val  Acc: 0.7806
 Site-SVHN                      (2) | Val  Loss: 0.9615 | Val  Acc: 0.7174
 Site-SVHN                      (2) | Val  Loss: 0.9720 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8108
 Best site-MNIST                    (3)  | Epoch:16 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:16 | Val Acc: 0.9173
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8152
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8525
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8152
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8273
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7283
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7806
 Best site-SVHN                     (2)  | Epoch:16 | Val Acc: 0.7174
 Best site-SVHN                     (2)  | Epoch:16 | Val Acc: 0.7086
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (3) | Train Loss: 0.3052 | Train Acc: 0.9137
 Site-MNIST                     (3) | Train Loss: 0.3754 | Train Acc: 0.8915
 Site-USPS                      (1) | Train Loss: 0.3855 | Train Acc: 0.8787
 Site-USPS                      (1) | Train Loss: 0.4030 | Train Acc: 0.8807
 Site-SynthDigits               (1) | Train Loss: 0.5611 | Train Acc: 0.8437
 Site-SynthDigits               (1) | Train Loss: 0.5181 | Train Acc: 0.8565
 Site-MNIST_M                   (0) | Train Loss: 0.7871 | Train Acc: 0.7601
 Site-MNIST_M                   (0) | Train Loss: 0.7674 | Train Acc: 0.7865
 Site-SVHN                      (2) | Train Loss: 1.0321 | Train Acc: 0.6523
 Site-SVHN                      (2) | Train Loss: 0.9212 | Train Acc: 0.7067
Average Train Accuracy: 0.8170
 Site-MNIST                     (3) | Val  Loss: 0.2685 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3755 | Val  Acc: 0.9209
 Site-USPS                      (1) | Val  Loss: 0.5331 | Val  Acc: 0.8152
 Site-USPS                      (1) | Val  Loss: 0.4606 | Val  Acc: 0.8525
 Site-SynthDigits               (1) | Val  Loss: 0.5422 | Val  Acc: 0.8152
 Site-SynthDigits               (1) | Val  Loss: 0.5313 | Val  Acc: 0.8417
 Site-MNIST_M                   (0) | Val  Loss: 0.8195 | Val  Acc: 0.7283
 Site-MNIST_M                   (0) | Val  Loss: 0.7413 | Val  Acc: 0.7878
 Site-SVHN                      (2) | Val  Loss: 0.9604 | Val  Acc: 0.7283
 Site-SVHN                      (2) | Val  Loss: 0.9672 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8133
 Best site-MNIST                    (3)  | Epoch:17 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:17 | Val Acc: 0.9209
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8152
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8525
 Best site-SynthDigits              (1)  | Epoch:17 | Val Acc: 0.8152
 Best site-SynthDigits              (1)  | Epoch:17 | Val Acc: 0.8417
 Best site-MNIST_M                  (0)  | Epoch:17 | Val Acc: 0.7283
 Best site-MNIST_M                  (0)  | Epoch:17 | Val Acc: 0.7878
 Best site-SVHN                     (2)  | Epoch:17 | Val Acc: 0.7283
 Best site-SVHN                     (2)  | Epoch:17 | Val Acc: 0.7086
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 18 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (3) | Train Loss: 0.2812 | Train Acc: 0.9218
 Site-MNIST                     (3) | Train Loss: 0.3493 | Train Acc: 0.9058
 Site-USPS                      (0) | Train Loss: 0.3678 | Train Acc: 0.8760
 Site-USPS                      (0) | Train Loss: 0.3661 | Train Acc: 0.8906
 Site-SynthDigits               (0) | Train Loss: 0.5805 | Train Acc: 0.8383
 Site-SynthDigits               (0) | Train Loss: 0.5208 | Train Acc: 0.8502
 Site-MNIST_M                   (1) | Train Loss: 0.7713 | Train Acc: 0.7682
 Site-MNIST_M                   (1) | Train Loss: 0.7440 | Train Acc: 0.7839
 Site-SVHN                      (2) | Train Loss: 1.0299 | Train Acc: 0.6739
 Site-SVHN                      (2) | Train Loss: 0.8980 | Train Acc: 0.7094
Average Train Accuracy: 0.8218
 Site-MNIST                     (3) | Val  Loss: 0.2461 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.3477 | Val  Acc: 0.9281
 Site-USPS                      (0) | Val  Loss: 0.5105 | Val  Acc: 0.8043
 Site-USPS                      (0) | Val  Loss: 0.4288 | Val  Acc: 0.8453
 Site-SynthDigits               (0) | Val  Loss: 0.5766 | Val  Acc: 0.7826
 Site-SynthDigits               (0) | Val  Loss: 0.5458 | Val  Acc: 0.8237
 Site-MNIST_M                   (1) | Val  Loss: 0.8015 | Val  Acc: 0.7609
 Site-MNIST_M                   (1) | Val  Loss: 0.7245 | Val  Acc: 0.7986
 Site-SVHN                      (2) | Val  Loss: 0.9374 | Val  Acc: 0.7174
 Site-SVHN                      (2) | Val  Loss: 0.9519 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8122
============ Train epoch 19 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (3) | Train Loss: 0.2779 | Train Acc: 0.9218
 Site-MNIST                     (3) | Train Loss: 0.3349 | Train Acc: 0.9085
 Site-USPS                      (0) | Train Loss: 0.3670 | Train Acc: 0.8814
 Site-USPS                      (0) | Train Loss: 0.3628 | Train Acc: 0.8897
 Site-SynthDigits               (0) | Train Loss: 0.5267 | Train Acc: 0.8571
 Site-SynthDigits               (0) | Train Loss: 0.4801 | Train Acc: 0.8726
 Site-MNIST_M                   (2) | Train Loss: 0.7729 | Train Acc: 0.7601
 Site-MNIST_M                   (2) | Train Loss: 0.7318 | Train Acc: 0.7964
 Site-SVHN                      (1) | Train Loss: 0.9815 | Train Acc: 0.6846
 Site-SVHN                      (1) | Train Loss: 0.8706 | Train Acc: 0.7354
Average Train Accuracy: 0.8308
 Site-MNIST                     (3) | Val  Loss: 0.2408 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3437 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.5072 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.4276 | Val  Acc: 0.8561
 Site-SynthDigits               (0) | Val  Loss: 0.5183 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4968 | Val  Acc: 0.8489
 Site-MNIST_M                   (2) | Val  Loss: 0.7826 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.7168 | Val  Acc: 0.7914
 Site-SVHN                      (1) | Val  Loss: 0.9128 | Val  Acc: 0.7609
 Site-SVHN                      (1) | Val  Loss: 0.9113 | Val  Acc: 0.7482
Average Valid Accuracy: 0.8296
 Best site-MNIST                    (3)  | Epoch:19 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:19 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.8261
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.8561
 Best site-SynthDigits              (0)  | Epoch:19 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:19 | Val Acc: 0.8489
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7500
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7914
 Best site-SVHN                     (1)  | Epoch:19 | Val Acc: 0.7609
 Best site-SVHN                     (1)  | Epoch:19 | Val Acc: 0.7482
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (3) | Train Loss: 0.2657 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3271 | Train Acc: 0.9112
 Site-USPS                      (0) | Train Loss: 0.3569 | Train Acc: 0.8814
 Site-USPS                      (0) | Train Loss: 0.3549 | Train Acc: 0.8951
 Site-SynthDigits               (0) | Train Loss: 0.5067 | Train Acc: 0.8571
 Site-SynthDigits               (0) | Train Loss: 0.4640 | Train Acc: 0.8735
 Site-MNIST_M                   (1) | Train Loss: 0.7267 | Train Acc: 0.7601
 Site-MNIST_M                   (1) | Train Loss: 0.7002 | Train Acc: 0.8027
 Site-SVHN                      (2) | Train Loss: 0.9818 | Train Acc: 0.6658
 Site-SVHN                      (2) | Train Loss: 0.8648 | Train Acc: 0.7283
Average Train Accuracy: 0.8300
 Site-MNIST                     (3) | Val  Loss: 0.2243 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.3297 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4966 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.4117 | Val  Acc: 0.8597
 Site-SynthDigits               (0) | Val  Loss: 0.4922 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.4782 | Val  Acc: 0.8525
 Site-MNIST_M                   (1) | Val  Loss: 0.7405 | Val  Acc: 0.7609
 Site-MNIST_M                   (1) | Val  Loss: 0.6743 | Val  Acc: 0.8022
 Site-SVHN                      (2) | Val  Loss: 0.9140 | Val  Acc: 0.7500
 Site-SVHN                      (2) | Val  Loss: 0.9125 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8296
============ Train epoch 21 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (3) | Train Loss: 0.2648 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3226 | Train Acc: 0.9085
 Site-USPS                      (1) | Train Loss: 0.3561 | Train Acc: 0.8895
 Site-USPS                      (1) | Train Loss: 0.3406 | Train Acc: 0.8987
 Site-SynthDigits               (1) | Train Loss: 0.5052 | Train Acc: 0.8491
 Site-SynthDigits               (1) | Train Loss: 0.4616 | Train Acc: 0.8726
 Site-MNIST_M                   (2) | Train Loss: 0.7259 | Train Acc: 0.7790
 Site-MNIST_M                   (2) | Train Loss: 0.6954 | Train Acc: 0.8090
 Site-SVHN                      (0) | Train Loss: 0.9513 | Train Acc: 0.6792
 Site-SVHN                      (0) | Train Loss: 0.8412 | Train Acc: 0.7381
Average Train Accuracy: 0.8348
 Site-MNIST                     (3) | Val  Loss: 0.2257 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3273 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.4817 | Val  Acc: 0.8261
 Site-USPS                      (1) | Val  Loss: 0.4076 | Val  Acc: 0.8669
 Site-SynthDigits               (1) | Val  Loss: 0.4998 | Val  Acc: 0.8370
 Site-SynthDigits               (1) | Val  Loss: 0.4749 | Val  Acc: 0.8489
 Site-MNIST_M                   (2) | Val  Loss: 0.7290 | Val  Acc: 0.7717
 Site-MNIST_M                   (2) | Val  Loss: 0.6643 | Val  Acc: 0.8022
 Site-SVHN                      (0) | Val  Loss: 0.8861 | Val  Acc: 0.7609
 Site-SVHN                      (0) | Val  Loss: 0.8855 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8314
 Best site-MNIST                    (3)  | Epoch:21 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:21 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:21 | Val Acc: 0.8261
 Best site-USPS                     (1)  | Epoch:21 | Val Acc: 0.8669
 Best site-SynthDigits              (1)  | Epoch:21 | Val Acc: 0.8370
 Best site-SynthDigits              (1)  | Epoch:21 | Val Acc: 0.8489
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7717
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.8022
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.7609
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.7374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 22 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (3) | Train Loss: 0.2568 | Train Acc: 0.9191
 Site-MNIST                     (3) | Train Loss: 0.3114 | Train Acc: 0.9175
 Site-USPS                      (0) | Train Loss: 0.3343 | Train Acc: 0.8895
 Site-USPS                      (0) | Train Loss: 0.3297 | Train Acc: 0.9067
 Site-SynthDigits               (0) | Train Loss: 0.5049 | Train Acc: 0.8544
 Site-SynthDigits               (0) | Train Loss: 0.4608 | Train Acc: 0.8744
 Site-MNIST_M                   (1) | Train Loss: 0.7158 | Train Acc: 0.7736
 Site-MNIST_M                   (1) | Train Loss: 0.6660 | Train Acc: 0.8099
 Site-SVHN                      (2) | Train Loss: 0.9379 | Train Acc: 0.6846
 Site-SVHN                      (2) | Train Loss: 0.8133 | Train Acc: 0.7489
Average Train Accuracy: 0.8379
 Site-MNIST                     (3) | Val  Loss: 0.2198 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3155 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4568 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.3873 | Val  Acc: 0.8705
 Site-SynthDigits               (0) | Val  Loss: 0.5079 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4759 | Val  Acc: 0.8489
 Site-MNIST_M                   (1) | Val  Loss: 0.7168 | Val  Acc: 0.7609
 Site-MNIST_M                   (1) | Val  Loss: 0.6532 | Val  Acc: 0.8022
 Site-SVHN                      (2) | Val  Loss: 0.8553 | Val  Acc: 0.7609
 Site-SVHN                      (2) | Val  Loss: 0.8635 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8321
 Best site-MNIST                    (3)  | Epoch:22 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:22 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:22 | Val Acc: 0.8261
 Best site-USPS                     (0)  | Epoch:22 | Val Acc: 0.8705
 Best site-SynthDigits              (0)  | Epoch:22 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:22 | Val Acc: 0.8489
 Best site-MNIST_M                  (1)  | Epoch:22 | Val Acc: 0.7609
 Best site-MNIST_M                  (1)  | Epoch:22 | Val Acc: 0.8022
 Best site-SVHN                     (2)  | Epoch:22 | Val Acc: 0.7609
 Best site-SVHN                     (2)  | Epoch:22 | Val Acc: 0.7374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (3) | Train Loss: 0.2483 | Train Acc: 0.9272
 Site-MNIST                     (3) | Train Loss: 0.3032 | Train Acc: 0.9166
 Site-USPS                      (1) | Train Loss: 0.3261 | Train Acc: 0.8841
 Site-USPS                      (1) | Train Loss: 0.3181 | Train Acc: 0.9085
 Site-SynthDigits               (1) | Train Loss: 0.4825 | Train Acc: 0.8598
 Site-SynthDigits               (1) | Train Loss: 0.4467 | Train Acc: 0.8816
 Site-MNIST_M                   (0) | Train Loss: 0.6887 | Train Acc: 0.7763
 Site-MNIST_M                   (0) | Train Loss: 0.6553 | Train Acc: 0.8143
 Site-SVHN                      (2) | Train Loss: 0.9312 | Train Acc: 0.6981
 Site-SVHN                      (2) | Train Loss: 0.8073 | Train Acc: 0.7453
Average Train Accuracy: 0.8412
 Site-MNIST                     (3) | Val  Loss: 0.2113 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3044 | Val  Acc: 0.9353
 Site-USPS                      (1) | Val  Loss: 0.4429 | Val  Acc: 0.8261
 Site-USPS                      (1) | Val  Loss: 0.3750 | Val  Acc: 0.8669
 Site-SynthDigits               (1) | Val  Loss: 0.4905 | Val  Acc: 0.8587
 Site-SynthDigits               (1) | Val  Loss: 0.4550 | Val  Acc: 0.8561
 Site-MNIST_M                   (0) | Val  Loss: 0.6872 | Val  Acc: 0.7826
 Site-MNIST_M                   (0) | Val  Loss: 0.6257 | Val  Acc: 0.8201
 Site-SVHN                      (2) | Val  Loss: 0.8645 | Val  Acc: 0.7500
 Site-SVHN                      (2) | Val  Loss: 0.8657 | Val  Acc: 0.7446
Average Valid Accuracy: 0.8375
 Best site-MNIST                    (3)  | Epoch:23 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:23 | Val Acc: 0.9353
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.8261
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.8669
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.8587
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.8561
 Best site-MNIST_M                  (0)  | Epoch:23 | Val Acc: 0.7826
 Best site-MNIST_M                  (0)  | Epoch:23 | Val Acc: 0.8201
 Best site-SVHN                     (2)  | Epoch:23 | Val Acc: 0.7500
 Best site-SVHN                     (2)  | Epoch:23 | Val Acc: 0.7446
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (1) | Train Loss: 0.2469 | Train Acc: 0.9245
 Site-MNIST                     (1) | Train Loss: 0.2986 | Train Acc: 0.9157
 Site-USPS                      (2) | Train Loss: 0.3358 | Train Acc: 0.8868
 Site-USPS                      (2) | Train Loss: 0.3357 | Train Acc: 0.9022
 Site-SynthDigits               (2) | Train Loss: 0.4616 | Train Acc: 0.8733
 Site-SynthDigits               (2) | Train Loss: 0.4160 | Train Acc: 0.8924
 Site-MNIST_M                   (3) | Train Loss: 0.6790 | Train Acc: 0.7709
 Site-MNIST_M                   (3) | Train Loss: 0.6421 | Train Acc: 0.8126
 Site-SVHN                      (0) | Train Loss: 0.9073 | Train Acc: 0.6873
 Site-SVHN                      (0) | Train Loss: 0.7883 | Train Acc: 0.7632
Average Train Accuracy: 0.8429
 Site-MNIST                     (1) | Val  Loss: 0.2138 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.3130 | Val  Acc: 0.9245
 Site-USPS                      (2) | Val  Loss: 0.4680 | Val  Acc: 0.8152
 Site-USPS                      (2) | Val  Loss: 0.3959 | Val  Acc: 0.8633
 Site-SynthDigits               (2) | Val  Loss: 0.4512 | Val  Acc: 0.8804
 Site-SynthDigits               (2) | Val  Loss: 0.4322 | Val  Acc: 0.8777
 Site-MNIST_M                   (3) | Val  Loss: 0.6804 | Val  Acc: 0.8043
 Site-MNIST_M                   (3) | Val  Loss: 0.6196 | Val  Acc: 0.7986
 Site-SVHN                      (0) | Val  Loss: 0.8270 | Val  Acc: 0.7717
 Site-SVHN                      (0) | Val  Loss: 0.8225 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8430
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9348
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9245
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8152
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8633
 Best site-SynthDigits              (2)  | Epoch:24 | Val Acc: 0.8804
 Best site-SynthDigits              (2)  | Epoch:24 | Val Acc: 0.8777
 Best site-MNIST_M                  (3)  | Epoch:24 | Val Acc: 0.8043
 Best site-MNIST_M                  (3)  | Epoch:24 | Val Acc: 0.7986
 Best site-SVHN                     (0)  | Epoch:24 | Val Acc: 0.7717
 Best site-SVHN                     (0)  | Epoch:24 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 25 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (3) | Train Loss: 0.2439 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3042 | Train Acc: 0.9121
 Site-USPS                      (0) | Train Loss: 0.3129 | Train Acc: 0.8949
 Site-USPS                      (0) | Train Loss: 0.3156 | Train Acc: 0.9085
 Site-SynthDigits               (0) | Train Loss: 0.4571 | Train Acc: 0.8706
 Site-SynthDigits               (0) | Train Loss: 0.4206 | Train Acc: 0.8888
 Site-MNIST_M                   (1) | Train Loss: 0.6737 | Train Acc: 0.7871
 Site-MNIST_M                   (1) | Train Loss: 0.6298 | Train Acc: 0.8197
 Site-SVHN                      (2) | Train Loss: 0.9141 | Train Acc: 0.6900
 Site-SVHN                      (2) | Train Loss: 0.7849 | Train Acc: 0.7668
Average Train Accuracy: 0.8463
 Site-MNIST                     (3) | Val  Loss: 0.2101 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.3042 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4305 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.3649 | Val  Acc: 0.8777
 Site-SynthDigits               (0) | Val  Loss: 0.4526 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.4310 | Val  Acc: 0.8669
 Site-MNIST_M                   (1) | Val  Loss: 0.6737 | Val  Acc: 0.7935
 Site-MNIST_M                   (1) | Val  Loss: 0.6092 | Val  Acc: 0.8022
 Site-SVHN                      (2) | Val  Loss: 0.8188 | Val  Acc: 0.7826
 Site-SVHN                      (2) | Val  Loss: 0.8292 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8408
============ Train epoch 26 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (3) | Train Loss: 0.2417 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3035 | Train Acc: 0.9085
 Site-USPS                      (0) | Train Loss: 0.3116 | Train Acc: 0.9003
 Site-USPS                      (0) | Train Loss: 0.3051 | Train Acc: 0.9067
 Site-SynthDigits               (0) | Train Loss: 0.4406 | Train Acc: 0.8787
 Site-SynthDigits               (0) | Train Loss: 0.4116 | Train Acc: 0.8825
 Site-MNIST_M                   (2) | Train Loss: 0.6528 | Train Acc: 0.7978
 Site-MNIST_M                   (2) | Train Loss: 0.6290 | Train Acc: 0.8233
 Site-SVHN                      (1) | Train Loss: 0.9081 | Train Acc: 0.6954
 Site-SVHN                      (1) | Train Loss: 0.7776 | Train Acc: 0.7641
Average Train Accuracy: 0.8482
 Site-MNIST                     (3) | Val  Loss: 0.2125 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.3044 | Val  Acc: 0.9281
 Site-USPS                      (0) | Val  Loss: 0.4227 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.3601 | Val  Acc: 0.8669
 Site-SynthDigits               (0) | Val  Loss: 0.4411 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4203 | Val  Acc: 0.8633
 Site-MNIST_M                   (2) | Val  Loss: 0.6501 | Val  Acc: 0.8043
 Site-MNIST_M                   (2) | Val  Loss: 0.5902 | Val  Acc: 0.8237
 Site-SVHN                      (1) | Val  Loss: 0.7978 | Val  Acc: 0.7717
 Site-SVHN                      (1) | Val  Loss: 0.8125 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8400
============ Train epoch 27 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.2348 | Train Acc: 0.9272
 Site-MNIST                     (1) | Train Loss: 0.2919 | Train Acc: 0.9166
 Site-USPS                      (2) | Train Loss: 0.2929 | Train Acc: 0.9111
 Site-USPS                      (2) | Train Loss: 0.2870 | Train Acc: 0.9112
 Site-SynthDigits               (2) | Train Loss: 0.4621 | Train Acc: 0.8679
 Site-SynthDigits               (2) | Train Loss: 0.4191 | Train Acc: 0.8807
 Site-MNIST_M                   (3) | Train Loss: 0.6377 | Train Acc: 0.7898
 Site-MNIST_M                   (3) | Train Loss: 0.6049 | Train Acc: 0.8278
 Site-SVHN                      (0) | Train Loss: 0.9122 | Train Acc: 0.6981
 Site-SVHN                      (0) | Train Loss: 0.7610 | Train Acc: 0.7543
Average Train Accuracy: 0.8485
 Site-MNIST                     (1) | Val  Loss: 0.2049 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.2905 | Val  Acc: 0.9281
 Site-USPS                      (2) | Val  Loss: 0.4039 | Val  Acc: 0.8261
 Site-USPS                      (2) | Val  Loss: 0.3372 | Val  Acc: 0.8813
 Site-SynthDigits               (2) | Val  Loss: 0.4634 | Val  Acc: 0.8261
 Site-SynthDigits               (2) | Val  Loss: 0.4310 | Val  Acc: 0.8597
 Site-MNIST_M                   (3) | Val  Loss: 0.6345 | Val  Acc: 0.8043
 Site-MNIST_M                   (3) | Val  Loss: 0.5757 | Val  Acc: 0.8273
 Site-SVHN                      (0) | Val  Loss: 0.8030 | Val  Acc: 0.7500
 Site-SVHN                      (0) | Val  Loss: 0.8239 | Val  Acc: 0.7410
Average Valid Accuracy: 0.8379
============ Train epoch 28 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (3) | Train Loss: 0.2333 | Train Acc: 0.9218
 Site-MNIST                     (3) | Train Loss: 0.2976 | Train Acc: 0.9103
 Site-USPS                      (0) | Train Loss: 0.2992 | Train Acc: 0.8976
 Site-USPS                      (0) | Train Loss: 0.2908 | Train Acc: 0.9085
 Site-SynthDigits               (0) | Train Loss: 0.4409 | Train Acc: 0.8679
 Site-SynthDigits               (0) | Train Loss: 0.4053 | Train Acc: 0.8843
 Site-MNIST_M                   (2) | Train Loss: 0.6340 | Train Acc: 0.8032
 Site-MNIST_M                   (2) | Train Loss: 0.5938 | Train Acc: 0.8278
 Site-SVHN                      (1) | Train Loss: 0.8912 | Train Acc: 0.7089
 Site-SVHN                      (1) | Train Loss: 0.7373 | Train Acc: 0.7713
Average Train Accuracy: 0.8502
 Site-MNIST                     (3) | Val  Loss: 0.2074 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.2942 | Val  Acc: 0.9281
 Site-USPS                      (0) | Val  Loss: 0.4066 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.3463 | Val  Acc: 0.8777
 Site-SynthDigits               (0) | Val  Loss: 0.4461 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4223 | Val  Acc: 0.8633
 Site-MNIST_M                   (2) | Val  Loss: 0.6365 | Val  Acc: 0.8043
 Site-MNIST_M                   (2) | Val  Loss: 0.5717 | Val  Acc: 0.8165
 Site-SVHN                      (1) | Val  Loss: 0.7885 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.7910 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8429
============ Train epoch 29 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.2231 | Train Acc: 0.9272
 Site-MNIST                     (0) | Train Loss: 0.2778 | Train Acc: 0.9166
 Site-USPS                      (2) | Train Loss: 0.2933 | Train Acc: 0.9057
 Site-USPS                      (2) | Train Loss: 0.2886 | Train Acc: 0.9103
 Site-SynthDigits               (2) | Train Loss: 0.4294 | Train Acc: 0.8841
 Site-SynthDigits               (2) | Train Loss: 0.3931 | Train Acc: 0.8933
 Site-MNIST_M                   (3) | Train Loss: 0.6302 | Train Acc: 0.8005
 Site-MNIST_M                   (3) | Train Loss: 0.5865 | Train Acc: 0.8350
 Site-SVHN                      (1) | Train Loss: 0.8728 | Train Acc: 0.7143
 Site-SVHN                      (1) | Train Loss: 0.7355 | Train Acc: 0.7767
Average Train Accuracy: 0.8564
 Site-MNIST                     (0) | Val  Loss: 0.1921 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.2831 | Val  Acc: 0.9281
 Site-USPS                      (2) | Val  Loss: 0.4039 | Val  Acc: 0.8261
 Site-USPS                      (2) | Val  Loss: 0.3393 | Val  Acc: 0.8777
 Site-SynthDigits               (2) | Val  Loss: 0.4359 | Val  Acc: 0.8804
 Site-SynthDigits               (2) | Val  Loss: 0.4061 | Val  Acc: 0.8777
 Site-MNIST_M                   (3) | Val  Loss: 0.6227 | Val  Acc: 0.8043
 Site-MNIST_M                   (3) | Val  Loss: 0.5586 | Val  Acc: 0.8237
 Site-SVHN                      (1) | Val  Loss: 0.7788 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.7815 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8502
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9348
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9281
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.8261
 Best site-USPS                     (2)  | Epoch:29 | Val Acc: 0.8777
 Best site-SynthDigits              (2)  | Epoch:29 | Val Acc: 0.8804
 Best site-SynthDigits              (2)  | Epoch:29 | Val Acc: 0.8777
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.8043
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.8237
 Best site-SVHN                     (1)  | Epoch:29 | Val Acc: 0.7826
 Best site-SVHN                     (1)  | Epoch:29 | Val Acc: 0.7662
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 30 ============
cnt=[2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (0) | Train Loss: 0.2197 | Train Acc: 0.9272
 Site-MNIST                     (0) | Train Loss: 0.2800 | Train Acc: 0.9184
 Site-USPS                      (3) | Train Loss: 0.2887 | Train Acc: 0.9111
 Site-USPS                      (3) | Train Loss: 0.2882 | Train Acc: 0.9166
 Site-SynthDigits               (3) | Train Loss: 0.4110 | Train Acc: 0.8841
 Site-SynthDigits               (3) | Train Loss: 0.3801 | Train Acc: 0.9031
 Site-MNIST_M                   (2) | Train Loss: 0.6202 | Train Acc: 0.8113
 Site-MNIST_M                   (2) | Train Loss: 0.5777 | Train Acc: 0.8386
 Site-SVHN                      (1) | Train Loss: 0.8822 | Train Acc: 0.7143
 Site-SVHN                      (1) | Train Loss: 0.7435 | Train Acc: 0.7695
Average Train Accuracy: 0.8594
 Site-MNIST                     (0) | Val  Loss: 0.1901 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.2815 | Val  Acc: 0.9317
 Site-USPS                      (3) | Val  Loss: 0.3889 | Val  Acc: 0.8370
 Site-USPS                      (3) | Val  Loss: 0.3314 | Val  Acc: 0.8813
 Site-SynthDigits               (3) | Val  Loss: 0.4063 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.3876 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.6026 | Val  Acc: 0.7826
 Site-MNIST_M                   (2) | Val  Loss: 0.5440 | Val  Acc: 0.8345
 Site-SVHN                      (1) | Val  Loss: 0.7798 | Val  Acc: 0.7500
 Site-SVHN                      (1) | Val  Loss: 0.7909 | Val  Acc: 0.7518
Average Valid Accuracy: 0.8454
============ Train epoch 31 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (3) | Train Loss: 0.2198 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2691 | Train Acc: 0.9220
 Site-USPS                      (0) | Train Loss: 0.2837 | Train Acc: 0.9164
 Site-USPS                      (0) | Train Loss: 0.2747 | Train Acc: 0.9184
 Site-SynthDigits               (0) | Train Loss: 0.4112 | Train Acc: 0.8760
 Site-SynthDigits               (0) | Train Loss: 0.3750 | Train Acc: 0.8969
 Site-MNIST_M                   (1) | Train Loss: 0.6113 | Train Acc: 0.8113
 Site-MNIST_M                   (1) | Train Loss: 0.5676 | Train Acc: 0.8377
 Site-SVHN                      (2) | Train Loss: 0.8556 | Train Acc: 0.7008
 Site-SVHN                      (2) | Train Loss: 0.7106 | Train Acc: 0.7821
Average Train Accuracy: 0.8591
 Site-MNIST                     (3) | Val  Loss: 0.1798 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2734 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3867 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.3175 | Val  Acc: 0.8921
 Site-SynthDigits               (0) | Val  Loss: 0.4121 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3826 | Val  Acc: 0.8813
 Site-MNIST_M                   (1) | Val  Loss: 0.6011 | Val  Acc: 0.8152
 Site-MNIST_M                   (1) | Val  Loss: 0.5379 | Val  Acc: 0.8309
 Site-SVHN                      (2) | Val  Loss: 0.7642 | Val  Acc: 0.7500
 Site-SVHN                      (2) | Val  Loss: 0.7608 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8501
============ Train epoch 32 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2158 | Train Acc: 0.9299
 Site-MNIST                     (0) | Train Loss: 0.2684 | Train Acc: 0.9238
 Site-USPS                      (2) | Train Loss: 0.2873 | Train Acc: 0.9057
 Site-USPS                      (2) | Train Loss: 0.2748 | Train Acc: 0.9121
 Site-SynthDigits               (2) | Train Loss: 0.4150 | Train Acc: 0.8814
 Site-SynthDigits               (2) | Train Loss: 0.3785 | Train Acc: 0.8978
 Site-MNIST_M                   (3) | Train Loss: 0.6147 | Train Acc: 0.8113
 Site-MNIST_M                   (3) | Train Loss: 0.5651 | Train Acc: 0.8341
 Site-SVHN                      (1) | Train Loss: 0.8493 | Train Acc: 0.7170
 Site-SVHN                      (1) | Train Loss: 0.6977 | Train Acc: 0.7874
Average Train Accuracy: 0.8600
 Site-MNIST                     (0) | Val  Loss: 0.1750 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2685 | Val  Acc: 0.9353
 Site-USPS                      (2) | Val  Loss: 0.3833 | Val  Acc: 0.8261
 Site-USPS                      (2) | Val  Loss: 0.3204 | Val  Acc: 0.8849
 Site-SynthDigits               (2) | Val  Loss: 0.4102 | Val  Acc: 0.8804
 Site-SynthDigits               (2) | Val  Loss: 0.3859 | Val  Acc: 0.8849
 Site-MNIST_M                   (3) | Val  Loss: 0.6013 | Val  Acc: 0.8152
 Site-MNIST_M                   (3) | Val  Loss: 0.5381 | Val  Acc: 0.8273
 Site-SVHN                      (1) | Val  Loss: 0.7504 | Val  Acc: 0.7717
 Site-SVHN                      (1) | Val  Loss: 0.7435 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8548
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9353
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.8261
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.8849
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8804
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8849
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.8152
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.8273
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7717
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (0) | Train Loss: 0.2117 | Train Acc: 0.9326
 Site-MNIST                     (0) | Train Loss: 0.2641 | Train Acc: 0.9247
 Site-USPS                      (2) | Train Loss: 0.2714 | Train Acc: 0.9218
 Site-USPS                      (2) | Train Loss: 0.2632 | Train Acc: 0.9166
 Site-SynthDigits               (2) | Train Loss: 0.4037 | Train Acc: 0.8760
 Site-SynthDigits               (2) | Train Loss: 0.3639 | Train Acc: 0.8996
 Site-MNIST_M                   (3) | Train Loss: 0.6114 | Train Acc: 0.8032
 Site-MNIST_M                   (3) | Train Loss: 0.5481 | Train Acc: 0.8341
 Site-SVHN                      (1) | Train Loss: 0.8550 | Train Acc: 0.7116
 Site-SVHN                      (1) | Train Loss: 0.6934 | Train Acc: 0.7901
Average Train Accuracy: 0.8610
 Site-MNIST                     (0) | Val  Loss: 0.1721 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2631 | Val  Acc: 0.9353
 Site-USPS                      (2) | Val  Loss: 0.3689 | Val  Acc: 0.8261
 Site-USPS                      (2) | Val  Loss: 0.3036 | Val  Acc: 0.8921
 Site-SynthDigits               (2) | Val  Loss: 0.3982 | Val  Acc: 0.8913
 Site-SynthDigits               (2) | Val  Loss: 0.3762 | Val  Acc: 0.8813
 Site-MNIST_M                   (3) | Val  Loss: 0.5802 | Val  Acc: 0.8152
 Site-MNIST_M                   (3) | Val  Loss: 0.5234 | Val  Acc: 0.8309
 Site-SVHN                      (1) | Val  Loss: 0.7401 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.7446 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8585
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9353
 Best site-USPS                     (2)  | Epoch:33 | Val Acc: 0.8261
 Best site-USPS                     (2)  | Epoch:33 | Val Acc: 0.8921
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8913
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8813
 Best site-MNIST_M                  (3)  | Epoch:33 | Val Acc: 0.8152
 Best site-MNIST_M                  (3)  | Epoch:33 | Val Acc: 0.8309
 Best site-SVHN                     (1)  | Epoch:33 | Val Acc: 0.7826
 Best site-SVHN                     (1)  | Epoch:33 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 34 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (3) | Train Loss: 0.2056 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2610 | Train Acc: 0.9256
 Site-USPS                      (0) | Train Loss: 0.2636 | Train Acc: 0.9245
 Site-USPS                      (0) | Train Loss: 0.2687 | Train Acc: 0.9229
 Site-SynthDigits               (0) | Train Loss: 0.4012 | Train Acc: 0.8814
 Site-SynthDigits               (0) | Train Loss: 0.3670 | Train Acc: 0.9004
 Site-MNIST_M                   (2) | Train Loss: 0.5983 | Train Acc: 0.8194
 Site-MNIST_M                   (2) | Train Loss: 0.5350 | Train Acc: 0.8404
 Site-SVHN                      (1) | Train Loss: 0.8399 | Train Acc: 0.7197
 Site-SVHN                      (1) | Train Loss: 0.6862 | Train Acc: 0.7946
Average Train Accuracy: 0.8659
 Site-MNIST                     (3) | Val  Loss: 0.1659 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2641 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3640 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.2999 | Val  Acc: 0.8921
 Site-SynthDigits               (0) | Val  Loss: 0.3995 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.3731 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5624 | Val  Acc: 0.8261
 Site-MNIST_M                   (2) | Val  Loss: 0.5157 | Val  Acc: 0.8345
 Site-SVHN                      (1) | Val  Loss: 0.7286 | Val  Acc: 0.7935
 Site-SVHN                      (1) | Val  Loss: 0.7352 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8596
 Best site-MNIST                    (3)  | Epoch:34 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:34 | Val Acc: 0.9353
 Best site-USPS                     (0)  | Epoch:34 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:34 | Val Acc: 0.8921
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8804
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8813
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8261
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8345
 Best site-SVHN                     (1)  | Epoch:34 | Val Acc: 0.7935
 Best site-SVHN                     (1)  | Epoch:34 | Val Acc: 0.7698
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (0) | Train Loss: 0.2076 | Train Acc: 0.9299
 Site-MNIST                     (0) | Train Loss: 0.2592 | Train Acc: 0.9274
 Site-USPS                      (3) | Train Loss: 0.2660 | Train Acc: 0.9191
 Site-USPS                      (3) | Train Loss: 0.2607 | Train Acc: 0.9220
 Site-SynthDigits               (3) | Train Loss: 0.3856 | Train Acc: 0.8841
 Site-SynthDigits               (3) | Train Loss: 0.3638 | Train Acc: 0.9058
 Site-MNIST_M                   (2) | Train Loss: 0.5991 | Train Acc: 0.8059
 Site-MNIST_M                   (2) | Train Loss: 0.5329 | Train Acc: 0.8422
 Site-SVHN                      (1) | Train Loss: 0.8319 | Train Acc: 0.7251
 Site-SVHN                      (1) | Train Loss: 0.6677 | Train Acc: 0.8009
Average Train Accuracy: 0.8662
 Site-MNIST                     (0) | Val  Loss: 0.1603 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2639 | Val  Acc: 0.9317
 Site-USPS                      (3) | Val  Loss: 0.3667 | Val  Acc: 0.8370
 Site-USPS                      (3) | Val  Loss: 0.3017 | Val  Acc: 0.8921
 Site-SynthDigits               (3) | Val  Loss: 0.3891 | Val  Acc: 0.8804
 Site-SynthDigits               (3) | Val  Loss: 0.3586 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5477 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.5109 | Val  Acc: 0.8381
 Site-SVHN                      (1) | Val  Loss: 0.7169 | Val  Acc: 0.7500
 Site-SVHN                      (1) | Val  Loss: 0.7257 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8567
============ Train epoch 36 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (3) | Train Loss: 0.1961 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2526 | Train Acc: 0.9247
 Site-USPS                      (1) | Train Loss: 0.2684 | Train Acc: 0.9245
 Site-USPS                      (1) | Train Loss: 0.2631 | Train Acc: 0.9193
 Site-SynthDigits               (1) | Train Loss: 0.3905 | Train Acc: 0.8868
 Site-SynthDigits               (1) | Train Loss: 0.3648 | Train Acc: 0.9013
 Site-MNIST_M                   (2) | Train Loss: 0.5838 | Train Acc: 0.8167
 Site-MNIST_M                   (2) | Train Loss: 0.5249 | Train Acc: 0.8457
 Site-SVHN                      (0) | Train Loss: 0.8241 | Train Acc: 0.7197
 Site-SVHN                      (0) | Train Loss: 0.6705 | Train Acc: 0.8018
Average Train Accuracy: 0.8673
 Site-MNIST                     (3) | Val  Loss: 0.1591 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2630 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3692 | Val  Acc: 0.8370
 Site-USPS                      (1) | Val  Loss: 0.3083 | Val  Acc: 0.8993
 Site-SynthDigits               (1) | Val  Loss: 0.3911 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3648 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5434 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.5033 | Val  Acc: 0.8525
 Site-SVHN                      (0) | Val  Loss: 0.7134 | Val  Acc: 0.7826
 Site-SVHN                      (0) | Val  Loss: 0.7077 | Val  Acc: 0.7806
Average Valid Accuracy: 0.8628
 Best site-MNIST                    (3)  | Epoch:36 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:36 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.8370
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.8993
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8849
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.8370
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.8525
 Best site-SVHN                     (0)  | Epoch:36 | Val Acc: 0.7826
 Best site-SVHN                     (0)  | Epoch:36 | Val Acc: 0.7806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 37 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.1939 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2524 | Train Acc: 0.9265
 Site-USPS                      (0) | Train Loss: 0.2601 | Train Acc: 0.9272
 Site-USPS                      (0) | Train Loss: 0.2541 | Train Acc: 0.9220
 Site-SynthDigits               (0) | Train Loss: 0.3940 | Train Acc: 0.8733
 Site-SynthDigits               (0) | Train Loss: 0.3675 | Train Acc: 0.8969
 Site-MNIST_M                   (1) | Train Loss: 0.5705 | Train Acc: 0.8113
 Site-MNIST_M                   (1) | Train Loss: 0.5188 | Train Acc: 0.8484
 Site-SVHN                      (2) | Train Loss: 0.8265 | Train Acc: 0.7143
 Site-SVHN                      (2) | Train Loss: 0.6493 | Train Acc: 0.8018
Average Train Accuracy: 0.8662
 Site-MNIST                     (3) | Val  Loss: 0.1603 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2567 | Val  Acc: 0.9388
 Site-USPS                      (0) | Val  Loss: 0.3584 | Val  Acc: 0.8478
 Site-USPS                      (0) | Val  Loss: 0.2982 | Val  Acc: 0.8957
 Site-SynthDigits               (0) | Val  Loss: 0.4004 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3647 | Val  Acc: 0.8741
 Site-MNIST_M                   (1) | Val  Loss: 0.5378 | Val  Acc: 0.8261
 Site-MNIST_M                   (1) | Val  Loss: 0.4919 | Val  Acc: 0.8525
 Site-SVHN                      (2) | Val  Loss: 0.6995 | Val  Acc: 0.7826
 Site-SVHN                      (2) | Val  Loss: 0.7087 | Val  Acc: 0.7806
Average Valid Accuracy: 0.8613
============ Train epoch 38 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (3) | Train Loss: 0.1996 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2491 | Train Acc: 0.9274
 Site-USPS                      (0) | Train Loss: 0.2502 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.2471 | Train Acc: 0.9256
 Site-SynthDigits               (0) | Train Loss: 0.3927 | Train Acc: 0.8814
 Site-SynthDigits               (0) | Train Loss: 0.3530 | Train Acc: 0.8969
 Site-MNIST_M                   (2) | Train Loss: 0.5794 | Train Acc: 0.8113
 Site-MNIST_M                   (2) | Train Loss: 0.5227 | Train Acc: 0.8457
 Site-SVHN                      (1) | Train Loss: 0.8176 | Train Acc: 0.7224
 Site-SVHN                      (1) | Train Loss: 0.6485 | Train Acc: 0.7991
Average Train Accuracy: 0.8680
 Site-MNIST                     (3) | Val  Loss: 0.1573 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2550 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3397 | Val  Acc: 0.8478
 Site-USPS                      (0) | Val  Loss: 0.2838 | Val  Acc: 0.8993
 Site-SynthDigits               (0) | Val  Loss: 0.4062 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3631 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5351 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.4912 | Val  Acc: 0.8561
 Site-SVHN                      (1) | Val  Loss: 0.6892 | Val  Acc: 0.7717
 Site-SVHN                      (1) | Val  Loss: 0.7026 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8621
============ Train epoch 39 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (3) | Train Loss: 0.1920 | Train Acc: 0.9380
 Site-MNIST                     (3) | Train Loss: 0.2420 | Train Acc: 0.9309
 Site-USPS                      (1) | Train Loss: 0.2603 | Train Acc: 0.9326
 Site-USPS                      (1) | Train Loss: 0.2516 | Train Acc: 0.9238
 Site-SynthDigits               (1) | Train Loss: 0.3690 | Train Acc: 0.8841
 Site-SynthDigits               (1) | Train Loss: 0.3396 | Train Acc: 0.9004
 Site-MNIST_M                   (2) | Train Loss: 0.5592 | Train Acc: 0.8140
 Site-MNIST_M                   (2) | Train Loss: 0.5108 | Train Acc: 0.8422
 Site-SVHN                      (0) | Train Loss: 0.8223 | Train Acc: 0.7197
 Site-SVHN                      (0) | Train Loss: 0.6521 | Train Acc: 0.8000
Average Train Accuracy: 0.8686
 Site-MNIST                     (3) | Val  Loss: 0.1489 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2478 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3424 | Val  Acc: 0.8587
 Site-USPS                      (1) | Val  Loss: 0.2865 | Val  Acc: 0.9029
 Site-SynthDigits               (1) | Val  Loss: 0.3692 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3424 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5245 | Val  Acc: 0.8478
 Site-MNIST_M                   (2) | Val  Loss: 0.4803 | Val  Acc: 0.8597
 Site-SVHN                      (0) | Val  Loss: 0.6977 | Val  Acc: 0.7826
 Site-SVHN                      (0) | Val  Loss: 0.7042 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8682
 Best site-MNIST                    (3)  | Epoch:39 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:39 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:39 | Val Acc: 0.8587
 Best site-USPS                     (1)  | Epoch:39 | Val Acc: 0.9029
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8813
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8478
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8597
 Best site-SVHN                     (0)  | Epoch:39 | Val Acc: 0.7826
 Best site-SVHN                     (0)  | Epoch:39 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 40 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (3) | Train Loss: 0.1898 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2331 | Train Acc: 0.9336
 Site-USPS                      (0) | Train Loss: 0.2484 | Train Acc: 0.9353
 Site-USPS                      (0) | Train Loss: 0.2378 | Train Acc: 0.9265
 Site-SynthDigits               (0) | Train Loss: 0.3720 | Train Acc: 0.8868
 Site-SynthDigits               (0) | Train Loss: 0.3384 | Train Acc: 0.9058
 Site-MNIST_M                   (2) | Train Loss: 0.5624 | Train Acc: 0.8194
 Site-MNIST_M                   (2) | Train Loss: 0.4972 | Train Acc: 0.8466
 Site-SVHN                      (1) | Train Loss: 0.8293 | Train Acc: 0.7332
 Site-SVHN                      (1) | Train Loss: 0.6472 | Train Acc: 0.8054
Average Train Accuracy: 0.8725
 Site-MNIST                     (3) | Val  Loss: 0.1478 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2447 | Val  Acc: 0.9388
 Site-USPS                      (0) | Val  Loss: 0.3396 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.2794 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3712 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.3460 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5180 | Val  Acc: 0.8478
 Site-MNIST_M                   (2) | Val  Loss: 0.4739 | Val  Acc: 0.8561
 Site-SVHN                      (1) | Val  Loss: 0.6944 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.6988 | Val  Acc: 0.7878
Average Valid Accuracy: 0.8675
============ Train epoch 41 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (3) | Train Loss: 0.1908 | Train Acc: 0.9380
 Site-MNIST                     (3) | Train Loss: 0.2402 | Train Acc: 0.9336
 Site-USPS                      (1) | Train Loss: 0.2423 | Train Acc: 0.9326
 Site-USPS                      (1) | Train Loss: 0.2382 | Train Acc: 0.9291
 Site-SynthDigits               (1) | Train Loss: 0.3668 | Train Acc: 0.8895
 Site-SynthDigits               (1) | Train Loss: 0.3359 | Train Acc: 0.9004
 Site-MNIST_M                   (2) | Train Loss: 0.5549 | Train Acc: 0.8221
 Site-MNIST_M                   (2) | Train Loss: 0.4953 | Train Acc: 0.8511
 Site-SVHN                      (0) | Train Loss: 0.8162 | Train Acc: 0.7332
 Site-SVHN                      (0) | Train Loss: 0.6397 | Train Acc: 0.8018
Average Train Accuracy: 0.8732
 Site-MNIST                     (3) | Val  Loss: 0.1450 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2432 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3308 | Val  Acc: 0.8587
 Site-USPS                      (1) | Val  Loss: 0.2703 | Val  Acc: 0.9137
 Site-SynthDigits               (1) | Val  Loss: 0.3676 | Val  Acc: 0.8478
 Site-SynthDigits               (1) | Val  Loss: 0.3429 | Val  Acc: 0.8777
 Site-MNIST_M                   (2) | Val  Loss: 0.5123 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.4684 | Val  Acc: 0.8597
 Site-SVHN                      (0) | Val  Loss: 0.6893 | Val  Acc: 0.7826
 Site-SVHN                      (0) | Val  Loss: 0.6882 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8668
============ Train epoch 42 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (3) | Train Loss: 0.1882 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2309 | Train Acc: 0.9354
 Site-USPS                      (1) | Train Loss: 0.2376 | Train Acc: 0.9407
 Site-USPS                      (1) | Train Loss: 0.2395 | Train Acc: 0.9265
 Site-SynthDigits               (1) | Train Loss: 0.3604 | Train Acc: 0.8841
 Site-SynthDigits               (1) | Train Loss: 0.3318 | Train Acc: 0.9058
 Site-MNIST_M                   (0) | Train Loss: 0.5529 | Train Acc: 0.8302
 Site-MNIST_M                   (0) | Train Loss: 0.4921 | Train Acc: 0.8574
 Site-SVHN                      (2) | Train Loss: 0.8041 | Train Acc: 0.7305
 Site-SVHN                      (2) | Train Loss: 0.6197 | Train Acc: 0.8143
Average Train Accuracy: 0.8766
 Site-MNIST                     (3) | Val  Loss: 0.1469 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2432 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3248 | Val  Acc: 0.8587
 Site-USPS                      (1) | Val  Loss: 0.2690 | Val  Acc: 0.9065
 Site-SynthDigits               (1) | Val  Loss: 0.3531 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3255 | Val  Acc: 0.8885
 Site-MNIST_M                   (0) | Val  Loss: 0.5020 | Val  Acc: 0.8587
 Site-MNIST_M                   (0) | Val  Loss: 0.4629 | Val  Acc: 0.8597
 Site-SVHN                      (2) | Val  Loss: 0.6621 | Val  Acc: 0.8152
 Site-SVHN                      (2) | Val  Loss: 0.6798 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8751
 Best site-MNIST                    (3)  | Epoch:42 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:42 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.8587
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.9065
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.8885
 Best site-MNIST_M                  (0)  | Epoch:42 | Val Acc: 0.8587
 Best site-MNIST_M                  (0)  | Epoch:42 | Val Acc: 0.8597
 Best site-SVHN                     (2)  | Epoch:42 | Val Acc: 0.8152
 Best site-SVHN                     (2)  | Epoch:42 | Val Acc: 0.7986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (3) | Train Loss: 0.1800 | Train Acc: 0.9461
 Site-MNIST                     (3) | Train Loss: 0.2270 | Train Acc: 0.9345
 Site-USPS                      (0) | Train Loss: 0.2469 | Train Acc: 0.9353
 Site-USPS                      (0) | Train Loss: 0.2282 | Train Acc: 0.9256
 Site-SynthDigits               (0) | Train Loss: 0.3594 | Train Acc: 0.8814
 Site-SynthDigits               (0) | Train Loss: 0.3358 | Train Acc: 0.9058
 Site-MNIST_M                   (2) | Train Loss: 0.5524 | Train Acc: 0.8275
 Site-MNIST_M                   (2) | Train Loss: 0.4822 | Train Acc: 0.8556
 Site-SVHN                      (1) | Train Loss: 0.7925 | Train Acc: 0.7385
 Site-SVHN                      (1) | Train Loss: 0.6144 | Train Acc: 0.8126
Average Train Accuracy: 0.8763
 Site-MNIST                     (3) | Val  Loss: 0.1458 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2377 | Val  Acc: 0.9424
 Site-USPS                      (0) | Val  Loss: 0.3261 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.2694 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3538 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3318 | Val  Acc: 0.8885
 Site-MNIST_M                   (2) | Val  Loss: 0.5095 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4617 | Val  Acc: 0.8561
 Site-SVHN                      (1) | Val  Loss: 0.6594 | Val  Acc: 0.8152
 Site-SVHN                      (1) | Val  Loss: 0.6633 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8747
============ Train epoch 44 ============
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (3) | Train Loss: 0.1756 | Train Acc: 0.9488
 Site-MNIST                     (3) | Train Loss: 0.2286 | Train Acc: 0.9336
 Site-USPS                      (1) | Train Loss: 0.2406 | Train Acc: 0.9272
 Site-USPS                      (1) | Train Loss: 0.2320 | Train Acc: 0.9247
 Site-SynthDigits               (1) | Train Loss: 0.3605 | Train Acc: 0.8787
 Site-SynthDigits               (1) | Train Loss: 0.3282 | Train Acc: 0.9067
 Site-MNIST_M                   (0) | Train Loss: 0.5391 | Train Acc: 0.8167
 Site-MNIST_M                   (0) | Train Loss: 0.4783 | Train Acc: 0.8538
 Site-SVHN                      (2) | Train Loss: 0.7839 | Train Acc: 0.7305
 Site-SVHN                      (2) | Train Loss: 0.6046 | Train Acc: 0.8108
Average Train Accuracy: 0.8731
 Site-MNIST                     (3) | Val  Loss: 0.1406 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2347 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3275 | Val  Acc: 0.8587
 Site-USPS                      (1) | Val  Loss: 0.2686 | Val  Acc: 0.9065
 Site-SynthDigits               (1) | Val  Loss: 0.3460 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3216 | Val  Acc: 0.8885
 Site-MNIST_M                   (0) | Val  Loss: 0.5035 | Val  Acc: 0.8804
 Site-MNIST_M                   (0) | Val  Loss: 0.4555 | Val  Acc: 0.8597
 Site-SVHN                      (2) | Val  Loss: 0.6476 | Val  Acc: 0.8370
 Site-SVHN                      (2) | Val  Loss: 0.6641 | Val  Acc: 0.8094
Average Valid Accuracy: 0.8805
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:44 | Val Acc: 0.8587
 Best site-USPS                     (1)  | Epoch:44 | Val Acc: 0.9065
 Best site-SynthDigits              (1)  | Epoch:44 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:44 | Val Acc: 0.8885
 Best site-MNIST_M                  (0)  | Epoch:44 | Val Acc: 0.8804
 Best site-MNIST_M                  (0)  | Epoch:44 | Val Acc: 0.8597
 Best site-SVHN                     (2)  | Epoch:44 | Val Acc: 0.8370
 Best site-SVHN                     (2)  | Epoch:44 | Val Acc: 0.8094
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_4/ccop_q=1...
============ Train epoch 45 ============
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (3) | Train Loss: 0.1778 | Train Acc: 0.9434
 Site-MNIST                     (3) | Train Loss: 0.2298 | Train Acc: 0.9363
 Site-USPS                      (0) | Train Loss: 0.2362 | Train Acc: 0.9326
 Site-USPS                      (0) | Train Loss: 0.2268 | Train Acc: 0.9318
 Site-SynthDigits               (0) | Train Loss: 0.3607 | Train Acc: 0.8841
 Site-SynthDigits               (0) | Train Loss: 0.3250 | Train Acc: 0.9076
 Site-MNIST_M                   (2) | Train Loss: 0.5477 | Train Acc: 0.8140
 Site-MNIST_M                   (2) | Train Loss: 0.4749 | Train Acc: 0.8538
 Site-SVHN                      (1) | Train Loss: 0.7839 | Train Acc: 0.7385
 Site-SVHN                      (1) | Train Loss: 0.5998 | Train Acc: 0.8188
Average Train Accuracy: 0.8761
 Site-MNIST                     (3) | Val  Loss: 0.1394 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2337 | Val  Acc: 0.9424
 Site-USPS                      (0) | Val  Loss: 0.3166 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.2578 | Val  Acc: 0.9173
 Site-SynthDigits               (0) | Val  Loss: 0.3554 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.3210 | Val  Acc: 0.8885
 Site-MNIST_M                   (2) | Val  Loss: 0.4950 | Val  Acc: 0.8804
 Site-MNIST_M                   (2) | Val  Loss: 0.4509 | Val  Acc: 0.8561
 Site-SVHN                      (1) | Val  Loss: 0.6496 | Val  Acc: 0.8043
 Site-SVHN                      (1) | Val  Loss: 0.6608 | Val  Acc: 0.8022
Average Valid Accuracy: 0.8765
 Test site-MNIST                     (3)| Epoch:44 | Test Acc: 0.9401
 Test site-USPS                      (0)| Epoch:44 | Test Acc: 0.9419
 Test site-SynthDigits               (0)| Epoch:44 | Test Acc: 0.8943
 Test site-MNIST_M                   (2)| Epoch:44 | Test Acc: 0.7803
 Test site-SVHN                      (1)| Epoch:44 | Test Acc: 0.7325
MNIST: 0.9401, USPS: 0.9419, SynthDigits: 0.8943, MNIST_M: 0.7803, SVHN: 0.7325, 
Average Test Accuracy(group): 0.8578, Average Test Accuracy(individual): 0.8578,
domain std=0.0859, cluster std=0.0884, individual std=0.0859, 
===2023-08-03 15:37:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 4
Loading snapshots...
