===2023-08-07 04:31:36===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.1089 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0515 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.0853 | Train Acc: 0.9608
 Site-photo                         | Train Loss: 1.0449 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 1.0669 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 1.4837 | Train Acc: 0.7143
 Site-art_painting                  | Train Loss: 1.4616 | Train Acc: 0.7474
 Site-art_painting                  | Train Loss: 1.4387 | Train Acc: 0.7981
 Site-cartoon                       | Train Loss: 1.6353 | Train Acc: 0.5588
 Site-cartoon                       | Train Loss: 1.6001 | Train Acc: 0.6047
 Site-sketch                        | Train Loss: 1.8313 | Train Acc: 0.2810
Average Train Accuracy: 0.7837
 Site-photo                         | Val  Loss: 1.0797 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.0805 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.0183 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 1.0410 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 1.0554 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 1.4305 | Val  Acc: 0.7143
 Site-art_painting                  | Val  Loss: 1.4076 | Val  Acc: 0.7937
 Site-art_painting                  | Val  Loss: 1.4646 | Val  Acc: 0.7465
 Site-cartoon                       | Val  Loss: 1.5752 | Val  Acc: 0.6522
 Site-cartoon                       | Val  Loss: 1.5652 | Val  Acc: 0.6261
 Site-sketch                        | Val  Loss: 1.8180 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7938
 Best site-photo                     | Epoch:0 | Val Acc: 0.9333
 Best site-photo                     | Epoch:0 | Val Acc: 0.9778
 Best site-photo                     | Epoch:0 | Val Acc: 0.9706
 Best site-photo                     | Epoch:0 | Val Acc: 0.9804
 Best site-photo                     | Epoch:0 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7143
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7937
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7465
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.6522
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.6261
 Best site-sketch                    | Epoch:0 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 0.5690 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.7686 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.5496 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.5333 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.5359 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 1.1512 | Train Acc: 0.7619
 Site-art_painting                  | Train Loss: 1.1374 | Train Acc: 0.7789
 Site-art_painting                  | Train Loss: 1.0506 | Train Acc: 0.8263
 Site-cartoon                       | Train Loss: 1.4045 | Train Acc: 0.5882
 Site-cartoon                       | Train Loss: 1.3547 | Train Acc: 0.6802
 Site-sketch                        | Train Loss: 1.6890 | Train Acc: 0.4711
Average Train Accuracy: 0.8183
 Site-photo                         | Val  Loss: 0.5804 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 0.5565 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 0.4943 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.5254 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.5168 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 1.0522 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.0118 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 1.0790 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.2713 | Val  Acc: 0.6522
 Site-cartoon                       | Val  Loss: 1.2883 | Val  Acc: 0.6870
 Site-sketch                        | Val  Loss: 1.7199 | Val  Acc: 0.3625
Average Valid Accuracy: 0.8254
 Best site-photo                     | Epoch:1 | Val Acc: 0.9333
 Best site-photo                     | Epoch:1 | Val Acc: 0.9556
 Best site-photo                     | Epoch:1 | Val Acc: 0.9853
 Best site-photo                     | Epoch:1 | Val Acc: 0.9804
 Best site-photo                     | Epoch:1 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:1 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:1 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8592
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.6522
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.6870
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 0.2878 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5180 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.2799 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.2709 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.2571 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.9521 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 0.7925 | Train Acc: 0.8316
 Site-art_painting                  | Train Loss: 0.7957 | Train Acc: 0.8779
 Site-cartoon                       | Train Loss: 1.2031 | Train Acc: 0.5882
 Site-cartoon                       | Train Loss: 1.1344 | Train Acc: 0.7209
 Site-sketch                        | Train Loss: 1.5793 | Train Acc: 0.4545
Average Train Accuracy: 0.8389
 Site-photo                         | Val  Loss: 0.2922 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.2938 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.2501 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.2532 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.2523 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.8172 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.8274 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.8829 | Val  Acc: 0.8592
 Site-cartoon                       | Val  Loss: 1.0228 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 1.1173 | Val  Acc: 0.7043
 Site-sketch                        | Val  Loss: 1.6090 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8615
 Best site-photo                     | Epoch:2 | Val Acc: 0.9667
 Best site-photo                     | Epoch:2 | Val Acc: 0.9778
 Best site-photo                     | Epoch:2 | Val Acc: 0.9853
 Best site-photo                     | Epoch:2 | Val Acc: 0.9804
 Best site-photo                     | Epoch:2 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:2 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:2 | Val Acc: 0.9048
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8592
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7043
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 0.1373 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1262 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.1511 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.1271 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.1315 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.8710 | Train Acc: 0.7381
 Site-art_painting                  | Train Loss: 0.6961 | Train Acc: 0.8105
 Site-art_painting                  | Train Loss: 0.5989 | Train Acc: 0.8873
 Site-cartoon                       | Train Loss: 1.0784 | Train Acc: 0.7353
 Site-cartoon                       | Train Loss: 1.0271 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 1.4842 | Train Acc: 0.4876
Average Train Accuracy: 0.8481
 Site-photo                         | Val  Loss: 0.1583 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.1441 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1398 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.1352 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.1155 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.6647 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 0.6011 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.7153 | Val  Acc: 0.8803
 Site-cartoon                       | Val  Loss: 0.8447 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.9934 | Val  Acc: 0.7217
 Site-sketch                        | Val  Loss: 1.5377 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8703
 Best site-photo                     | Epoch:3 | Val Acc: 0.9667
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 0.9853
 Best site-photo                     | Epoch:3 | Val Acc: 0.9902
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8571
 Best site-art_painting              | Epoch:3 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8803
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7826
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7217
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.0937 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1371 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.1329 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0716 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0789 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.7744 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 0.6226 | Train Acc: 0.8526
 Site-art_painting                  | Train Loss: 0.5555 | Train Acc: 0.9014
 Site-cartoon                       | Train Loss: 1.0005 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.9476 | Train Acc: 0.7558
 Site-sketch                        | Train Loss: 1.3825 | Train Acc: 0.5207
Average Train Accuracy: 0.8637
 Site-photo                         | Val  Loss: 0.0703 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0775 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0803 | Val  Acc: 0.9706
 Site-photo                         | Val  Loss: 0.0842 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.0744 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.5543 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.5760 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.5779 | Val  Acc: 0.8873
 Site-cartoon                       | Val  Loss: 0.8023 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 0.9231 | Val  Acc: 0.7565
 Site-sketch                        | Val  Loss: 1.5061 | Val  Acc: 0.4250
Average Valid Accuracy: 0.8729
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 0.9706
 Best site-photo                     | Epoch:4 | Val Acc: 0.9804
 Best site-photo                     | Epoch:4 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9206
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8873
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.7565
 Best site-sketch                    | Epoch:4 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.0546 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0503 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0867 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0864 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.0488 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6081 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.6194 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.4817 | Train Acc: 0.9202
 Site-cartoon                       | Train Loss: 0.9040 | Train Acc: 0.7059
 Site-cartoon                       | Train Loss: 0.8992 | Train Acc: 0.7326
 Site-sketch                        | Train Loss: 1.3705 | Train Acc: 0.4545
Average Train Accuracy: 0.8645
 Site-photo                         | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0506 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0563 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0601 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0536 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4919 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.4638 | Val  Acc: 0.9365
 Site-art_painting                  | Val  Loss: 0.5690 | Val  Acc: 0.9014
 Site-cartoon                       | Val  Loss: 0.7207 | Val  Acc: 0.7391
 Site-cartoon                       | Val  Loss: 0.8003 | Val  Acc: 0.8087
 Site-sketch                        | Val  Loss: 1.4362 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8770
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9853
 Best site-photo                     | Epoch:5 | Val Acc: 0.9902
 Best site-photo                     | Epoch:5 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8929
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9365
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9014
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7391
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.8087
 Best site-sketch                    | Epoch:5 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.0361 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0418 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.0758 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0585 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6409 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6094 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.3970 | Train Acc: 0.9061
 Site-cartoon                       | Train Loss: 0.8500 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.7656 | Train Acc: 0.7907
 Site-sketch                        | Train Loss: 1.2917 | Train Acc: 0.5041
Average Train Accuracy: 0.8781
 Site-photo                         | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0539 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0482 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0645 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.0499 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.4504 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.4076 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.4948 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.6060 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.7917 | Val  Acc: 0.7739
 Site-sketch                        | Val  Loss: 1.3827 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8870
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9853
 Best site-photo                     | Epoch:6 | Val Acc: 0.9804
 Best site-photo                     | Epoch:6 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8929
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9155
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7739
 Best site-sketch                    | Epoch:6 | Val Acc: 0.4375
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.0349 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0398 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0600 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0356 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0391 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6465 | Train Acc: 0.7619
 Site-art_painting                  | Train Loss: 0.5351 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.3998 | Train Acc: 0.9014
 Site-cartoon                       | Train Loss: 0.8574 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.7398 | Train Acc: 0.7907
 Site-sketch                        | Train Loss: 1.3182 | Train Acc: 0.4876
Average Train Accuracy: 0.8667
 Site-photo                         | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0354 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0578 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.0422 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.3811 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.3874 | Val  Acc: 0.8889
 Site-art_painting                  | Val  Loss: 0.4651 | Val  Acc: 0.9155
 Site-cartoon                       | Val  Loss: 0.7060 | Val  Acc: 0.6957
 Site-cartoon                       | Val  Loss: 0.7638 | Val  Acc: 0.7652
 Site-sketch                        | Val  Loss: 1.2931 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8802
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.0550 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1044 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0680 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0291 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6305 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 0.4912 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.3687 | Train Acc: 0.9343
 Site-cartoon                       | Train Loss: 0.9279 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.7479 | Train Acc: 0.7674
 Site-sketch                        | Train Loss: 1.2053 | Train Acc: 0.5289
Average Train Accuracy: 0.8795
 Site-photo                         | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0224 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0439 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3253 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3336 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.3928 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.6390 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.7331 | Val  Acc: 0.7913
 Site-sketch                        | Val  Loss: 1.3732 | Val  Acc: 0.4250
Average Valid Accuracy: 0.9023
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 0.9853
 Best site-photo                     | Epoch:8 | Val Acc: 0.9804
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:8 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:8 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:8 | Val Acc: 0.9648
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.8261
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.7913
 Best site-sketch                    | Epoch:8 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0352 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0797 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0161 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0187 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5196 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.4567 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.3586 | Train Acc: 0.9014
 Site-cartoon                       | Train Loss: 0.8143 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.7172 | Train Acc: 0.8140
 Site-sketch                        | Train Loss: 1.1584 | Train Acc: 0.5702
Average Train Accuracy: 0.8872
 Site-photo                         | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0235 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0351 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.4191 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.2731 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.4505 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.5728 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.6806 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.3381 | Val  Acc: 0.4750
Average Valid Accuracy: 0.9036
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9853
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9286
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9683
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9437
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8696
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7826
 Best site-sketch                    | Epoch:9 | Val Acc: 0.4750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.0480 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0194 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.1125 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0252 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0117 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5403 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.4289 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.3162 | Train Acc: 0.9202
 Site-cartoon                       | Train Loss: 0.7970 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.6861 | Train Acc: 0.8140
 Site-sketch                        | Train Loss: 1.1627 | Train Acc: 0.5289
Average Train Accuracy: 0.8910
 Site-photo                         | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0182 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0300 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.0343 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.2864 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2758 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.3906 | Val  Acc: 0.9225
 Site-cartoon                       | Val  Loss: 0.5109 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.6810 | Val  Acc: 0.7826
 Site-sketch                        | Val  Loss: 1.3078 | Val  Acc: 0.4875
Average Valid Accuracy: 0.9068
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9853
 Best site-photo                     | Epoch:10 | Val Acc: 0.9804
 Best site-photo                     | Epoch:10 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9524
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9225
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7826
 Best site-sketch                    | Epoch:10 | Val Acc: 0.4875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.0377 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0212 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0778 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0204 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0186 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5585 | Train Acc: 0.7857
 Site-art_painting                  | Train Loss: 0.4415 | Train Acc: 0.8842
 Site-art_painting                  | Train Loss: 0.2820 | Train Acc: 0.9577
 Site-cartoon                       | Train Loss: 0.7279 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.6623 | Train Acc: 0.8314
 Site-sketch                        | Train Loss: 1.1398 | Train Acc: 0.5702
Average Train Accuracy: 0.8923
 Site-photo                         | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0207 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0290 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3149 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2485 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.4707 | Val  Acc: 0.9296
 Site-cartoon                       | Val  Loss: 0.5289 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.6227 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.2873 | Val  Acc: 0.4875
Average Valid Accuracy: 0.9019
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0222 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0381 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0156 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4356 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3744 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.2922 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.7095 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.6336 | Train Acc: 0.8198
 Site-sketch                        | Train Loss: 1.0785 | Train Acc: 0.5868
Average Train Accuracy: 0.9035
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0114 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0229 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0327 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2628 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2354 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.4678 | Val  Acc: 0.9085
 Site-cartoon                       | Val  Loss: 0.4401 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.5904 | Val  Acc: 0.8174
 Site-sketch                        | Val  Loss: 1.2257 | Val  Acc: 0.5625
Average Valid Accuracy: 0.9238
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 0.9853
 Best site-photo                     | Epoch:12 | Val Acc: 0.9902
 Best site-photo                     | Epoch:12 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9085
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.9565
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8174
 Best site-sketch                    | Epoch:12 | Val Acc: 0.5625
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0314 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.0148 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0288 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0106 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4989 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.4332 | Train Acc: 0.8632
 Site-art_painting                  | Train Loss: 0.2601 | Train Acc: 0.9437
 Site-cartoon                       | Train Loss: 0.7189 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.6092 | Train Acc: 0.8023
 Site-sketch                        | Train Loss: 1.1029 | Train Acc: 0.5950
Average Train Accuracy: 0.8950
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0127 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0267 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0161 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2691 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2208 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.3814 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.5706 | Val  Acc: 0.7826
 Site-cartoon                       | Val  Loss: 0.5419 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 1.2780 | Val  Acc: 0.5375
Average Valid Accuracy: 0.9105
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0214 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0486 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0226 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4862 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.3795 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.2410 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.7273 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.5279 | Train Acc: 0.8663
 Site-sketch                        | Train Loss: 1.1019 | Train Acc: 0.5868
Average Train Accuracy: 0.9060
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0162 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0360 | Val  Acc: 0.9804
 Site-photo                         | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1951 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2932 | Val  Acc: 0.9048
 Site-art_painting                  | Val  Loss: 0.3666 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.4338 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.5482 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 1.2762 | Val  Acc: 0.5625
Average Valid Accuracy: 0.9115
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0204 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0322 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0086 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4826 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.3157 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.2248 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6859 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.5597 | Train Acc: 0.8372
 Site-sketch                        | Train Loss: 1.0699 | Train Acc: 0.6116
Average Train Accuracy: 0.9030
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0183 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2276 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1886 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3825 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3441 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4652 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 1.1559 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9348
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9902
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:15 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9577
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.9130
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8696
 Best site-sketch                    | Epoch:15 | Val Acc: 0.5875
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.0257 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0690 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0272 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0077 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4101 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3771 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.2333 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6764 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.5459 | Train Acc: 0.8663
 Site-sketch                        | Train Loss: 1.0375 | Train Acc: 0.6529
Average Train Accuracy: 0.9062
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0208 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0102 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.3083 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.2534 | Val  Acc: 0.9206
 Site-art_painting                  | Val  Loss: 0.2709 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.4666 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.5072 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 1.2116 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9273
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.0234 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3003 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.0749 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0049 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4268 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3124 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.1893 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.6013 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.4642 | Train Acc: 0.8547
 Site-sketch                        | Train Loss: 1.0205 | Train Acc: 0.6529
Average Train Accuracy: 0.9137
 Site-photo                         | Val  Loss: 0.0599 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0093 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0208 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0356 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.1419 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1733 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.3185 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3214 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.5334 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 1.1628 | Val  Acc: 0.5625
Average Valid Accuracy: 0.9273
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0415 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.0097 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0162 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4826 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.2797 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2231 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.7431 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.5382 | Train Acc: 0.8430
 Site-sketch                        | Train Loss: 1.0255 | Train Acc: 0.6364
Average Train Accuracy: 0.9108
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0135 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0244 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.3175 | Val  Acc: 0.8929
 Site-art_painting                  | Val  Loss: 0.1318 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2494 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.3037 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.5179 | Val  Acc: 0.8261
 Site-sketch                        | Val  Loss: 1.1988 | Val  Acc: 0.6000
Average Valid Accuracy: 0.9328
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0150 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0147 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0308 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0161 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5045 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.3224 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.1765 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.7454 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.4858 | Train Acc: 0.8663
 Site-sketch                        | Train Loss: 1.0265 | Train Acc: 0.6612
Average Train Accuracy: 0.9086
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0284 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1850 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1371 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2255 | Val  Acc: 0.9859
 Site-cartoon                       | Val  Loss: 0.3313 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.5470 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 1.1666 | Val  Acc: 0.5375
Average Valid Accuracy: 0.9308
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0132 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0189 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0535 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0293 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0161 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4858 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3001 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1829 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.7346 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4459 | Train Acc: 0.8837
 Site-sketch                        | Train Loss: 1.0540 | Train Acc: 0.6116
Average Train Accuracy: 0.9135
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0244 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1940 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1373 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1854 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.3272 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4839 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 1.1405 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9420
 Best site-photo                     | Epoch:20 | Val Acc: 1.0000
 Best site-photo                     | Epoch:20 | Val Acc: 1.0000
 Best site-photo                     | Epoch:20 | Val Acc: 1.0000
 Best site-photo                     | Epoch:20 | Val Acc: 1.0000
 Best site-photo                     | Epoch:20 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:20 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9789
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.9565
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.8435
 Best site-sketch                    | Epoch:20 | Val Acc: 0.6250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0128 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0335 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.0050 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0395 | Train Acc: 0.9869
 Site-photo                         | Train Loss: 0.0064 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5916 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.4198 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.2315 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.6268 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4650 | Train Acc: 0.8430
 Site-sketch                        | Train Loss: 1.0213 | Train Acc: 0.6612
Average Train Accuracy: 0.9107
 Site-photo                         | Val  Loss: 0.0608 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0223 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1732 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1287 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.2253 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.2807 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4560 | Val  Acc: 0.8348
 Site-sketch                        | Val  Loss: 1.1341 | Val  Acc: 0.5625
Average Valid Accuracy: 0.9229
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0204 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0268 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4781 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.3571 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.1602 | Train Acc: 0.9859
 Site-cartoon                       | Train Loss: 0.6720 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.4599 | Train Acc: 0.8547
 Site-sketch                        | Train Loss: 1.0458 | Train Acc: 0.6198
Average Train Accuracy: 0.9084
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1210 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1217 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2102 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3385 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4403 | Val  Acc: 0.9043
 Site-sketch                        | Val  Loss: 1.1467 | Val  Acc: 0.6000
Average Valid Accuracy: 0.9333
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0069 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0618 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0086 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4059 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.3282 | Train Acc: 0.8737
 Site-art_painting                  | Train Loss: 0.2011 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.6425 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.4178 | Train Acc: 0.8953
 Site-sketch                        | Train Loss: 0.8880 | Train Acc: 0.7603
Average Train Accuracy: 0.9248
 Site-photo                         | Val  Loss: 0.0972 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0171 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2056 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1266 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2717 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.3444 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4302 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 1.0683 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9311
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0193 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0413 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0106 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2902 | Train Acc: 0.9524
 Site-art_painting                  | Train Loss: 0.2152 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.1479 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6428 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.4289 | Train Acc: 0.8837
 Site-sketch                        | Train Loss: 0.9321 | Train Acc: 0.6942
Average Train Accuracy: 0.9358
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1632 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1215 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2757 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.2480 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4584 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 1.1886 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9347
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0122 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0057 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0507 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0146 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4531 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.2524 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.1691 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.6294 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.4043 | Train Acc: 0.8721
 Site-sketch                        | Train Loss: 0.9353 | Train Acc: 0.6612
Average Train Accuracy: 0.9180
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1958 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.1083 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2299 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.3311 | Val  Acc: 0.8696
 Site-cartoon                       | Val  Loss: 0.4440 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 1.1052 | Val  Acc: 0.6000
Average Valid Accuracy: 0.9265
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0115 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0489 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0092 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3524 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.2462 | Train Acc: 0.9579
 Site-art_painting                  | Train Loss: 0.1475 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.6161 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.4015 | Train Acc: 0.8779
 Site-sketch                        | Train Loss: 0.8891 | Train Acc: 0.6777
Average Train Accuracy: 0.9258
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0083 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0360 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.2221 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1144 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2588 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.2930 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4536 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 1.1523 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9431
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 0.9868
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9643
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9789
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.9565
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.8783
 Best site-sketch                    | Epoch:26 | Val Acc: 0.6250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0114 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0283 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3735 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.2851 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1663 | Train Acc: 0.9484
 Site-cartoon                       | Train Loss: 0.6681 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3745 | Train Acc: 0.8837
 Site-sketch                        | Train Loss: 0.9720 | Train Acc: 0.6198
Average Train Accuracy: 0.9136
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0242 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1436 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1726 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1829 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.3367 | Val  Acc: 0.8261
 Site-cartoon                       | Val  Loss: 0.4520 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 1.0818 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9308
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0239 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.1686 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0092 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3142 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2410 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1080 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.4586 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.4241 | Train Acc: 0.8895
 Site-sketch                        | Train Loss: 0.8950 | Train Acc: 0.6860
Average Train Accuracy: 0.9277
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2417 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.1008 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1752 | Val  Acc: 0.9577
 Site-cartoon                       | Val  Loss: 0.2497 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.3980 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 1.0725 | Val  Acc: 0.5875
Average Valid Accuracy: 0.9381
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0187 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3632 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2578 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.1434 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.6295 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.3955 | Train Acc: 0.8953
 Site-sketch                        | Train Loss: 0.8824 | Train Acc: 0.7273
Average Train Accuracy: 0.9299
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0153 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0264 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.0613 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1007 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1634 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.2814 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3607 | Val  Acc: 0.9130
 Site-sketch                        | Val  Loss: 1.1234 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9492
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 0.9902
 Best site-photo                     | Epoch:29 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:29 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:29 | Val Acc: 0.9841
 Best site-art_painting              | Epoch:29 | Val Acc: 0.9789
 Best site-cartoon                   | Epoch:29 | Val Acc: 0.9565
 Best site-cartoon                   | Epoch:29 | Val Acc: 0.9130
 Best site-sketch                    | Epoch:29 | Val Acc: 0.6250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0139 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0590 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3713 | Train Acc: 0.8810
 Site-art_painting                  | Train Loss: 0.2788 | Train Acc: 0.9579
 Site-art_painting                  | Train Loss: 0.1782 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6620 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3616 | Train Acc: 0.8837
 Site-sketch                        | Train Loss: 0.9068 | Train Acc: 0.6860
Average Train Accuracy: 0.9219
 Site-photo                         | Val  Loss: 0.1213 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0261 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1701 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.0927 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1698 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.2607 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4076 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 1.1090 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9345
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0208 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0044 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4159 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2433 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.1703 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.7408 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3898 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.8475 | Train Acc: 0.6860
Average Train Accuracy: 0.9267
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0064 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.0978 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0619 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1962 | Val  Acc: 0.9859
 Site-cartoon                       | Val  Loss: 0.2583 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.3854 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 1.0778 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9560
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 0.9934
 Best site-art_painting              | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9859
 Best site-cartoon                   | Epoch:31 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8870
 Best site-sketch                    | Epoch:31 | Val Acc: 0.6500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0093 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0720 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0215 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4763 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2283 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.0926 | Train Acc: 0.9765
 Site-cartoon                       | Train Loss: 0.6285 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.3656 | Train Acc: 0.8837
 Site-sketch                        | Train Loss: 0.8513 | Train Acc: 0.7025
Average Train Accuracy: 0.9309
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0088 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0311 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0308 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1103 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1615 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1945 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.2623 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3492 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 1.0963 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9361
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0101 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0316 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3245 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2479 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1477 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.6266 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3419 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.8171 | Train Acc: 0.7355
Average Train Accuracy: 0.9313
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0222 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0215 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1794 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.1083 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1423 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.2481 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4242 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 0.9993 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9420
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0119 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0637 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0054 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3661 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.3329 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.1115 | Train Acc: 0.9671
 Site-cartoon                       | Train Loss: 0.6709 | Train Acc: 0.7647
 Site-cartoon                       | Train Loss: 0.3305 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.8830 | Train Acc: 0.6694
Average Train Accuracy: 0.9135
 Site-photo                         | Val  Loss: 0.0731 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0060 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1988 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1603 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.3307 | Val  Acc: 0.9437
 Site-cartoon                       | Val  Loss: 0.2464 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3288 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 1.1015 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9291
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0221 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0835 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0330 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3421 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3087 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.0958 | Train Acc: 0.9859
 Site-cartoon                       | Train Loss: 0.6926 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3659 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.8745 | Train Acc: 0.6612
Average Train Accuracy: 0.9228
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0125 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1509 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.0760 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.2119 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.3472 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3988 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 1.1043 | Val  Acc: 0.5750
Average Valid Accuracy: 0.9345
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0101 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0398 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0165 | Train Acc: 0.9913
 Site-art_painting                  | Train Loss: 0.2291 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3141 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.1221 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.5655 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.3816 | Train Acc: 0.8895
 Site-sketch                        | Train Loss: 0.8425 | Train Acc: 0.7273
Average Train Accuracy: 0.9303
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0262 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.3162 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.1017 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2431 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.3222 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.4311 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 1.1363 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9310
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0461 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0244 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4066 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.2819 | Train Acc: 0.9579
 Site-art_painting                  | Train Loss: 0.1276 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.5752 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.2990 | Train Acc: 0.9186
 Site-sketch                        | Train Loss: 0.8571 | Train Acc: 0.6777
Average Train Accuracy: 0.9238
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0307 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.1954 | Val  Acc: 0.8571
 Site-art_painting                  | Val  Loss: 0.0823 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1642 | Val  Acc: 0.9789
 Site-cartoon                       | Val  Loss: 0.2592 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4798 | Val  Acc: 0.8435
 Site-sketch                        | Val  Loss: 1.2182 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9296
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0156 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0088 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0583 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3338 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2540 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.1381 | Train Acc: 0.9624
 Site-cartoon                       | Train Loss: 0.6686 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.2962 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.8611 | Train Acc: 0.6777
Average Train Accuracy: 0.9297
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0537 | Val  Acc: 0.9868
 Site-art_painting                  | Val  Loss: 0.1585 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.0944 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.1528 | Val  Acc: 0.9859
 Site-cartoon                       | Val  Loss: 0.3016 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3333 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 0.9376 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9387
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0084 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0263 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3406 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2513 | Train Acc: 0.9053
 Site-art_painting                  | Train Loss: 0.0971 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.7296 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3015 | Train Acc: 0.9128
 Site-sketch                        | Train Loss: 0.9226 | Train Acc: 0.6694
Average Train Accuracy: 0.9217
 Site-photo                         | Val  Loss: 0.0237 | Val  Acc: 0.9667
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2215 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.0950 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2169 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.2002 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3556 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 1.0314 | Val  Acc: 0.6125
Average Valid Accuracy: 0.9324
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0003 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3416 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.3828 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.1106 | Train Acc: 0.9765
 Site-cartoon                       | Train Loss: 0.6942 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.3155 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.8092 | Train Acc: 0.7025
Average Train Accuracy: 0.9300
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0064 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.0832 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1022 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1461 | Val  Acc: 0.9718
 Site-cartoon                       | Val  Loss: 0.2846 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3698 | Val  Acc: 0.8522
 Site-sketch                        | Val  Loss: 1.1018 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9411
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0087 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0058 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2760 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.1941 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.0769 | Train Acc: 0.9953
 Site-cartoon                       | Train Loss: 0.6115 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.3067 | Train Acc: 0.9186
 Site-sketch                        | Train Loss: 0.9252 | Train Acc: 0.6612
Average Train Accuracy: 0.9355
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0161 | Val  Acc: 0.9853
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0901 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0605 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0929 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.1510 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.3692 | Val  Acc: 0.8696
 Site-sketch                        | Val  Loss: 0.9984 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9573
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 0.9853
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:41 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:41 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:41 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:41 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.8696
 Best site-sketch                    | Epoch:41 | Val Acc: 0.6750
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/fedsam...
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3764 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0475 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3218 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.2128 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.1021 | Train Acc: 0.9765
 Site-cartoon                       | Train Loss: 0.5060 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.2953 | Train Acc: 0.9186
 Site-sketch                        | Train Loss: 0.8722 | Train Acc: 0.6694
Average Train Accuracy: 0.9295
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0100 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0594 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1538 | Val  Acc: 0.9859
 Site-cartoon                       | Val  Loss: 0.2129 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3926 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 1.0649 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9481
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0518 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.0181 | Train Acc: 0.9935
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3227 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.3855 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.0895 | Train Acc: 0.9812
 Site-cartoon                       | Train Loss: 0.5242 | Train Acc: 0.8529
 Site-cartoon                       | Train Loss: 0.2532 | Train Acc: 0.9477
 Site-sketch                        | Train Loss: 0.8466 | Train Acc: 0.6942
Average Train Accuracy: 0.9294
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0322 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.0969 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1638 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.2403 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.2081 | Val  Acc: 0.9130
 Site-cartoon                       | Val  Loss: 0.3493 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 1.0572 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9401
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0224 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0075 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3937 | Train Acc: 0.8571
 Site-art_painting                  | Train Loss: 0.2256 | Train Acc: 0.9158
 Site-art_painting                  | Train Loss: 0.0883 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.4709 | Train Acc: 0.8824
 Site-cartoon                       | Train Loss: 0.2661 | Train Acc: 0.9244
 Site-sketch                        | Train Loss: 0.8036 | Train Acc: 0.7107
Average Train Accuracy: 0.9296
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0179 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2178 | Val  Acc: 0.9286
 Site-art_painting                  | Val  Loss: 0.1099 | Val  Acc: 0.9841
 Site-art_painting                  | Val  Loss: 0.1594 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.2282 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3198 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.9846 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9448
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0563 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3629 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.2510 | Train Acc: 0.9263
 Site-art_painting                  | Train Loss: 0.0912 | Train Acc: 0.9812
 Site-cartoon                       | Train Loss: 0.7387 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.3078 | Train Acc: 0.9012
 Site-sketch                        | Train Loss: 0.8402 | Train Acc: 0.7190
Average Train Accuracy: 0.9223
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0662 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.0515 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1167 | Val  Acc: 0.9859
 Site-cartoon                       | Val  Loss: 0.1843 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3508 | Val  Acc: 0.8957
 Site-sketch                        | Val  Loss: 1.1629 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9479
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0227 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0565 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3804 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.2049 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.0825 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.5939 | Train Acc: 0.9118
 Site-cartoon                       | Train Loss: 0.3285 | Train Acc: 0.9070
 Site-sketch                        | Train Loss: 0.8152 | Train Acc: 0.7438
Average Train Accuracy: 0.9355
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1237 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.0485 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2610 | Val  Acc: 0.9507
 Site-cartoon                       | Val  Loss: 0.3411 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3942 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 1.0174 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9443
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0535 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3728 | Train Acc: 0.9048
 Site-art_painting                  | Train Loss: 0.1704 | Train Acc: 0.9368
 Site-art_painting                  | Train Loss: 0.0954 | Train Acc: 0.9765
 Site-cartoon                       | Train Loss: 0.5974 | Train Acc: 0.7941
 Site-cartoon                       | Train Loss: 0.2980 | Train Acc: 0.9244
 Site-sketch                        | Train Loss: 0.8775 | Train Acc: 0.6860
Average Train Accuracy: 0.9275
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0923 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1220 | Val  Acc: 0.9683
 Site-art_painting                  | Val  Loss: 0.0996 | Val  Acc: 0.9859
 Site-cartoon                       | Val  Loss: 0.0839 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.3184 | Val  Acc: 0.8870
 Site-sketch                        | Val  Loss: 1.0062 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9526
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0354 | Train Acc: 0.9804
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0001 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4112 | Train Acc: 0.8095
 Site-art_painting                  | Train Loss: 0.2346 | Train Acc: 0.9579
 Site-art_painting                  | Train Loss: 0.0999 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.7412 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.2898 | Train Acc: 0.9302
 Site-sketch                        | Train Loss: 0.8167 | Train Acc: 0.6612
Average Train Accuracy: 0.9213
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0084 | Val  Acc: 0.9902
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1517 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.1812 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1325 | Val  Acc: 0.9648
 Site-cartoon                       | Val  Loss: 0.1964 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.3570 | Val  Acc: 0.8609
 Site-sketch                        | Val  Loss: 1.0686 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9445
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0569 | Train Acc: 0.9902
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0002 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2733 | Train Acc: 0.9286
 Site-art_painting                  | Train Loss: 0.2840 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.0881 | Train Acc: 0.9718
 Site-cartoon                       | Train Loss: 0.6384 | Train Acc: 0.8235
 Site-cartoon                       | Train Loss: 0.2616 | Train Acc: 0.9302
 Site-sketch                        | Train Loss: 0.8378 | Train Acc: 0.6860
Average Train Accuracy: 0.9295
 Site-photo                         | Val  Loss: 0.0000 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0080 | Val  Acc: 0.9934
 Site-art_painting                  | Val  Loss: 0.2300 | Val  Acc: 0.9643
 Site-art_painting                  | Val  Loss: 0.2110 | Val  Acc: 0.9524
 Site-art_painting                  | Val  Loss: 0.1214 | Val  Acc: 0.9859
 Site-cartoon                       | Val  Loss: 0.2424 | Val  Acc: 0.9565
 Site-cartoon                       | Val  Loss: 0.4012 | Val  Acc: 0.8783
 Site-sketch                        | Val  Loss: 0.9986 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9426
===2023-08-07 05:04:47===
===2023-08-07 05:04:57===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 4
Loading snapshots...
 Test site-photo                     (1)| Epoch:41 | Test Acc: 0.9985
 Test site-art_painting              (1)| Epoch:41 | Test Acc: 0.9208
 Test site-cartoon                   (3)| Epoch:41 | Test Acc: 0.8234
 Test site-sketch                    (2)| Epoch:41 | Test Acc: 0.6518
photo: 0.9985, art_painting: 0.9208, cartoon: 0.8234, sketch: 0.6518, 
Average Test Accuracy(group): 0.8486, Average Test Accuracy(individual): 0.9140,
domain std=0.1295, cluster std=0.1124, individual std=0.1049, 
