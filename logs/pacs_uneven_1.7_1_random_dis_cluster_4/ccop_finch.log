===2023-08-06 22:41:01===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (0) | Train Loss: 1.6736 | Train Acc: 0.4667
 Site-photo                     (0) | Train Loss: 1.7515 | Train Acc: 0.4559
 Site-photo                     (0) | Train Loss: 1.6947 | Train Acc: 0.5000
 Site-photo                     (0) | Train Loss: 1.6159 | Train Acc: 0.5686
 Site-photo                     (0) | Train Loss: 1.6908 | Train Acc: 0.5022
 Site-art_painting              (1) | Train Loss: 1.8027 | Train Acc: 0.3095
 Site-art_painting              (1) | Train Loss: 1.9024 | Train Acc: 0.2526
 Site-art_painting              (1) | Train Loss: 1.7673 | Train Acc: 0.3239
 Site-cartoon                   (2) | Train Loss: 1.8389 | Train Acc: 0.1765
 Site-cartoon                   (2) | Train Loss: 1.8759 | Train Acc: 0.2558
 Site-sketch                    (2) | Train Loss: 1.8480 | Train Acc: 0.1901
Average Train Accuracy: 0.3638
 Site-photo                     (0) | Val  Loss: 1.6976 | Val  Acc: 0.5000
 Site-photo                     (0) | Val  Loss: 1.7470 | Val  Acc: 0.5111
 Site-photo                     (0) | Val  Loss: 1.6030 | Val  Acc: 0.5147
 Site-photo                     (0) | Val  Loss: 1.6918 | Val  Acc: 0.5000
 Site-photo                     (0) | Val  Loss: 1.6341 | Val  Acc: 0.5066
 Site-art_painting              (1) | Val  Loss: 1.9434 | Val  Acc: 0.2143
 Site-art_painting              (1) | Val  Loss: 1.7397 | Val  Acc: 0.4127
 Site-art_painting              (1) | Val  Loss: 1.8255 | Val  Acc: 0.2887
 Site-cartoon                   (2) | Val  Loss: 1.9569 | Val  Acc: 0.3913
 Site-cartoon                   (2) | Val  Loss: 1.8854 | Val  Acc: 0.2348
 Site-sketch                    (2) | Val  Loss: 1.7826 | Val  Acc: 0.2750
Average Valid Accuracy: 0.3954
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5111
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5147
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5066
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.2143
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.4127
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.2887
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.3913
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.2348
 Best site-sketch                   (2)  | Epoch:0 | Val Acc: 0.2750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 1 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (0) | Train Loss: 1.5588 | Train Acc: 0.5778
 Site-photo                     (0) | Train Loss: 1.4522 | Train Acc: 0.5735
 Site-photo                     (0) | Train Loss: 1.4487 | Train Acc: 0.6373
 Site-photo                     (0) | Train Loss: 1.4163 | Train Acc: 0.6667
 Site-photo                     (0) | Train Loss: 1.4965 | Train Acc: 0.6332
 Site-art_painting              (1) | Train Loss: 1.6252 | Train Acc: 0.5476
 Site-art_painting              (1) | Train Loss: 1.8035 | Train Acc: 0.3474
 Site-art_painting              (1) | Train Loss: 1.6445 | Train Acc: 0.4038
 Site-cartoon                   (2) | Train Loss: 1.7340 | Train Acc: 0.2647
 Site-cartoon                   (2) | Train Loss: 1.7918 | Train Acc: 0.3198
 Site-sketch                    (2) | Train Loss: 1.9127 | Train Acc: 0.2397
Average Train Accuracy: 0.4738
 Site-photo                     (0) | Val  Loss: 1.4979 | Val  Acc: 0.6000
 Site-photo                     (0) | Val  Loss: 1.5392 | Val  Acc: 0.6000
 Site-photo                     (0) | Val  Loss: 1.3900 | Val  Acc: 0.6471
 Site-photo                     (0) | Val  Loss: 1.4741 | Val  Acc: 0.6373
 Site-photo                     (0) | Val  Loss: 1.4088 | Val  Acc: 0.7171
 Site-art_painting              (1) | Val  Loss: 1.7178 | Val  Acc: 0.3929
 Site-art_painting              (1) | Val  Loss: 1.6358 | Val  Acc: 0.4286
 Site-art_painting              (1) | Val  Loss: 1.6792 | Val  Acc: 0.4225
 Site-cartoon                   (2) | Val  Loss: 1.8499 | Val  Acc: 0.2609
 Site-cartoon                   (2) | Val  Loss: 1.7564 | Val  Acc: 0.3304
 Site-sketch                    (2) | Val  Loss: 1.8250 | Val  Acc: 0.2625
Average Valid Accuracy: 0.4817
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6471
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6373
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.7171
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.3929
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.4286
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.4225
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.2609
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.3304
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.2625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 2 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 1.3274 | Train Acc: 0.7556
 Site-photo                     (0) | Train Loss: 1.1873 | Train Acc: 0.7941
 Site-photo                     (0) | Train Loss: 1.1974 | Train Acc: 0.8431
 Site-photo                     (0) | Train Loss: 1.2187 | Train Acc: 0.8758
 Site-photo                     (0) | Train Loss: 1.2849 | Train Acc: 0.8079
 Site-art_painting              (1) | Train Loss: 1.6101 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.6060 | Train Acc: 0.4316
 Site-art_painting              (1) | Train Loss: 1.5434 | Train Acc: 0.5117
 Site-cartoon                   (2) | Train Loss: 1.7161 | Train Acc: 0.2941
 Site-cartoon                   (2) | Train Loss: 1.6775 | Train Acc: 0.3605
 Site-sketch                    (2) | Train Loss: 1.8197 | Train Acc: 0.2397
Average Train Accuracy: 0.5831
 Site-photo                     (0) | Val  Loss: 1.2579 | Val  Acc: 0.8000
 Site-photo                     (0) | Val  Loss: 1.3034 | Val  Acc: 0.7333
 Site-photo                     (0) | Val  Loss: 1.2518 | Val  Acc: 0.8235
 Site-photo                     (0) | Val  Loss: 1.2703 | Val  Acc: 0.8627
 Site-photo                     (0) | Val  Loss: 1.1951 | Val  Acc: 0.8553
 Site-art_painting              (1) | Val  Loss: 1.5334 | Val  Acc: 0.5714
 Site-art_painting              (1) | Val  Loss: 1.5061 | Val  Acc: 0.6032
 Site-art_painting              (1) | Val  Loss: 1.5792 | Val  Acc: 0.5141
 Site-cartoon                   (2) | Val  Loss: 1.8128 | Val  Acc: 0.2174
 Site-cartoon                   (2) | Val  Loss: 1.6535 | Val  Acc: 0.3913
 Site-sketch                    (2) | Val  Loss: 1.7344 | Val  Acc: 0.2375
Average Valid Accuracy: 0.6009
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7333
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8235
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8627
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8553
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.5714
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.6032
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.5141
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.2174
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.3913
 Best site-sketch                   (2)  | Epoch:2 | Val Acc: 0.2375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 3 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (0) | Train Loss: 1.1097 | Train Acc: 0.8444
 Site-photo                     (0) | Train Loss: 1.1845 | Train Acc: 0.8382
 Site-photo                     (0) | Train Loss: 1.0203 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 1.0147 | Train Acc: 0.9281
 Site-photo                     (0) | Train Loss: 1.0591 | Train Acc: 0.8821
 Site-art_painting              (1) | Train Loss: 1.3694 | Train Acc: 0.6429
 Site-art_painting              (1) | Train Loss: 1.4567 | Train Acc: 0.6105
 Site-art_painting              (1) | Train Loss: 1.3825 | Train Acc: 0.6385
 Site-cartoon                   (2) | Train Loss: 1.6058 | Train Acc: 0.4118
 Site-cartoon                   (2) | Train Loss: 1.5561 | Train Acc: 0.4593
 Site-sketch                    (2) | Train Loss: 1.7690 | Train Acc: 0.2975
Average Train Accuracy: 0.6813
 Site-photo                     (0) | Val  Loss: 1.0256 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 1.1116 | Val  Acc: 0.8667
 Site-photo                     (0) | Val  Loss: 1.0614 | Val  Acc: 0.8971
 Site-photo                     (0) | Val  Loss: 1.0417 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.9738 | Val  Acc: 0.9276
 Site-art_painting              (1) | Val  Loss: 1.3619 | Val  Acc: 0.6429
 Site-art_painting              (1) | Val  Loss: 1.3416 | Val  Acc: 0.7143
 Site-art_painting              (1) | Val  Loss: 1.4536 | Val  Acc: 0.6127
 Site-cartoon                   (2) | Val  Loss: 1.6274 | Val  Acc: 0.3913
 Site-cartoon                   (2) | Val  Loss: 1.5341 | Val  Acc: 0.4522
 Site-sketch                    (2) | Val  Loss: 1.6781 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7013
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8667
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8971
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9276
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.6429
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.7143
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.6127
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.3913
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.4522
 Best site-sketch                   (2)  | Epoch:3 | Val Acc: 0.3250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 4 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 0.9284 | Train Acc: 0.8667
 Site-photo                     (0) | Train Loss: 0.7412 | Train Acc: 0.8971
 Site-photo                     (0) | Train Loss: 0.8089 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.8381 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.8811 | Train Acc: 0.9476
 Site-art_painting              (1) | Train Loss: 1.3092 | Train Acc: 0.7143
 Site-art_painting              (1) | Train Loss: 1.3696 | Train Acc: 0.5684
 Site-art_painting              (1) | Train Loss: 1.2279 | Train Acc: 0.7324
 Site-cartoon                   (2) | Train Loss: 1.5788 | Train Acc: 0.3824
 Site-cartoon                   (2) | Train Loss: 1.4591 | Train Acc: 0.5291
 Site-sketch                    (2) | Train Loss: 1.7203 | Train Acc: 0.2727
Average Train Accuracy: 0.7129
 Site-photo                     (0) | Val  Loss: 0.8541 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.8909 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.8608 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.8674 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.7841 | Val  Acc: 0.9671
 Site-art_painting              (1) | Val  Loss: 1.2145 | Val  Acc: 0.7143
 Site-art_painting              (1) | Val  Loss: 1.2384 | Val  Acc: 0.7778
 Site-art_painting              (1) | Val  Loss: 1.2983 | Val  Acc: 0.7324
 Site-cartoon                   (2) | Val  Loss: 1.5150 | Val  Acc: 0.3913
 Site-cartoon                   (2) | Val  Loss: 1.4304 | Val  Acc: 0.5217
 Site-sketch                    (2) | Val  Loss: 1.6619 | Val  Acc: 0.3375
Average Valid Accuracy: 0.7449
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9111
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9671
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.7143
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.7778
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.7324
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.3913
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.5217
 Best site-sketch                   (2)  | Epoch:4 | Val Acc: 0.3375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 5 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (0) | Train Loss: 0.7976 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.9114 | Train Acc: 0.9118
 Site-photo                     (0) | Train Loss: 0.7093 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.7100 | Train Acc: 0.9477
 Site-photo                     (0) | Train Loss: 0.7453 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 1.2358 | Train Acc: 0.6667
 Site-art_painting              (1) | Train Loss: 1.2552 | Train Acc: 0.6316
 Site-art_painting              (1) | Train Loss: 1.1129 | Train Acc: 0.7934
 Site-cartoon                   (2) | Train Loss: 1.4380 | Train Acc: 0.5588
 Site-cartoon                   (2) | Train Loss: 1.3536 | Train Acc: 0.5930
 Site-sketch                    (2) | Train Loss: 1.6476 | Train Acc: 0.3719
Average Train Accuracy: 0.7610
 Site-photo                     (0) | Val  Loss: 0.7506 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.7150 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.7617 | Val  Acc: 0.9265
 Site-photo                     (0) | Val  Loss: 0.7487 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.6666 | Val  Acc: 0.9539
 Site-art_painting              (1) | Val  Loss: 1.1272 | Val  Acc: 0.7857
 Site-art_painting              (1) | Val  Loss: 1.1326 | Val  Acc: 0.8095
 Site-art_painting              (1) | Val  Loss: 1.2455 | Val  Acc: 0.7465
 Site-cartoon                   (2) | Val  Loss: 1.3723 | Val  Acc: 0.6087
 Site-cartoon                   (2) | Val  Loss: 1.3519 | Val  Acc: 0.5913
 Site-sketch                    (2) | Val  Loss: 1.5945 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7909
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9265
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9539
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.7857
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.8095
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.7465
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.6087
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.5913
 Best site-sketch                   (2)  | Epoch:5 | Val Acc: 0.4250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 6 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (0) | Train Loss: 0.7262 | Train Acc: 0.9333
 Site-photo                     (0) | Train Loss: 0.6964 | Train Acc: 0.9118
 Site-photo                     (0) | Train Loss: 0.6198 | Train Acc: 0.9510
 Site-photo                     (0) | Train Loss: 0.6443 | Train Acc: 0.9542
 Site-photo                     (0) | Train Loss: 0.6234 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 1.0793 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 1.1389 | Train Acc: 0.7263
 Site-art_painting              (1) | Train Loss: 1.0378 | Train Acc: 0.8122
 Site-cartoon                   (2) | Train Loss: 1.3136 | Train Acc: 0.6765
 Site-cartoon                   (2) | Train Loss: 1.2722 | Train Acc: 0.6047
 Site-sketch                    (2) | Train Loss: 1.5998 | Train Acc: 0.4050
Average Train Accuracy: 0.7950
 Site-photo                     (0) | Val  Loss: 0.6237 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.6682 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.6641 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.6532 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.5871 | Val  Acc: 0.9671
 Site-art_painting              (1) | Val  Loss: 0.9595 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.9358 | Val  Acc: 0.9048
 Site-art_painting              (1) | Val  Loss: 1.0734 | Val  Acc: 0.8521
 Site-cartoon                   (2) | Val  Loss: 1.3672 | Val  Acc: 0.6087
 Site-cartoon                   (2) | Val  Loss: 1.2064 | Val  Acc: 0.6870
 Site-sketch                    (2) | Val  Loss: 1.5684 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8322
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9671
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.9048
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8521
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.6087
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.6870
 Best site-sketch                   (2)  | Epoch:6 | Val Acc: 0.4125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 7 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (0) | Train Loss: 0.6304 | Train Acc: 0.9111
 Site-photo                     (0) | Train Loss: 0.8054 | Train Acc: 0.9265
 Site-photo                     (0) | Train Loss: 0.5388 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.5647 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.5708 | Train Acc: 0.9651
 Site-art_painting              (1) | Train Loss: 0.9611 | Train Acc: 0.7857
 Site-art_painting              (1) | Train Loss: 1.0303 | Train Acc: 0.6947
 Site-art_painting              (1) | Train Loss: 0.8867 | Train Acc: 0.8545
 Site-cartoon                   (2) | Train Loss: 1.1961 | Train Acc: 0.7059
 Site-cartoon                   (2) | Train Loss: 1.1499 | Train Acc: 0.6919
 Site-sketch                    (2) | Train Loss: 1.5000 | Train Acc: 0.4959
Average Train Accuracy: 0.8163
 Site-photo                     (0) | Val  Loss: 0.5914 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.5892 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5965 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.5966 | Val  Acc: 0.9314
 Site-photo                     (0) | Val  Loss: 0.5184 | Val  Acc: 0.9605
 Site-art_painting              (1) | Val  Loss: 0.8984 | Val  Acc: 0.8214
 Site-art_painting              (1) | Val  Loss: 0.8574 | Val  Acc: 0.8571
 Site-art_painting              (1) | Val  Loss: 0.9531 | Val  Acc: 0.8239
 Site-cartoon                   (2) | Val  Loss: 1.2059 | Val  Acc: 0.5652
 Site-cartoon                   (2) | Val  Loss: 1.0982 | Val  Acc: 0.7130
 Site-sketch                    (2) | Val  Loss: 1.4957 | Val  Acc: 0.4375
Average Valid Accuracy: 0.8090
============ Train epoch 8 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.5654 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.6853 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.4651 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.5240 | Train Acc: 0.9542
 Site-photo                     (0) | Train Loss: 0.5272 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.9336 | Train Acc: 0.7857
 Site-art_painting              (1) | Train Loss: 0.9426 | Train Acc: 0.7579
 Site-art_painting              (1) | Train Loss: 0.8499 | Train Acc: 0.8498
 Site-cartoon                   (2) | Train Loss: 1.0919 | Train Acc: 0.7059
 Site-cartoon                   (2) | Train Loss: 1.0459 | Train Acc: 0.7209
 Site-sketch                    (2) | Train Loss: 1.4016 | Train Acc: 0.4959
Average Train Accuracy: 0.8327
 Site-photo                     (0) | Val  Loss: 0.5122 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5332 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.5360 | Val  Acc: 0.9265
 Site-photo                     (0) | Val  Loss: 0.5366 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.4684 | Val  Acc: 0.9474
 Site-art_painting              (1) | Val  Loss: 0.7472 | Val  Acc: 0.8571
 Site-art_painting              (1) | Val  Loss: 0.7458 | Val  Acc: 0.9365
 Site-art_painting              (1) | Val  Loss: 0.9133 | Val  Acc: 0.8380
 Site-cartoon                   (2) | Val  Loss: 1.0751 | Val  Acc: 0.6522
 Site-cartoon                   (2) | Val  Loss: 1.0270 | Val  Acc: 0.7565
 Site-sketch                    (2) | Val  Loss: 1.4419 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8340
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9265
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9474
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.8571
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.9365
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.8380
 Best site-cartoon                  (2)  | Epoch:8 | Val Acc: 0.6522
 Best site-cartoon                  (2)  | Epoch:8 | Val Acc: 0.7565
 Best site-sketch                   (2)  | Epoch:8 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 9 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (0) | Train Loss: 0.5073 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.5969 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.4180 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.4957 | Train Acc: 0.9477
 Site-photo                     (0) | Train Loss: 0.4682 | Train Acc: 0.9651
 Site-art_painting              (1) | Train Loss: 0.8650 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 0.8210 | Train Acc: 0.8105
 Site-art_painting              (1) | Train Loss: 0.7676 | Train Acc: 0.8404
 Site-cartoon                   (2) | Train Loss: 1.0337 | Train Acc: 0.7353
 Site-cartoon                   (2) | Train Loss: 0.9822 | Train Acc: 0.7151
 Site-sketch                    (2) | Train Loss: 1.2540 | Train Acc: 0.6116
Average Train Accuracy: 0.8466
 Site-photo                     (0) | Val  Loss: 0.4756 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.4471 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.4593 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.4885 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.4077 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.6921 | Val  Acc: 0.8214
 Site-art_painting              (1) | Val  Loss: 0.7284 | Val  Acc: 0.8889
 Site-art_painting              (1) | Val  Loss: 0.7790 | Val  Acc: 0.8803
 Site-cartoon                   (2) | Val  Loss: 0.9610 | Val  Acc: 0.7826
 Site-cartoon                   (2) | Val  Loss: 0.9231 | Val  Acc: 0.8000
 Site-sketch                    (2) | Val  Loss: 1.3764 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8495
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9111
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:9 | Val Acc: 0.8214
 Best site-art_painting             (1)  | Epoch:9 | Val Acc: 0.8889
 Best site-art_painting             (1)  | Epoch:9 | Val Acc: 0.8803
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.7826
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.8000
 Best site-sketch                   (2)  | Epoch:9 | Val Acc: 0.4500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 10 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 0.4727 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.5226 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.3436 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.4363 | Train Acc: 0.9477
 Site-photo                     (0) | Train Loss: 0.4098 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.8045 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.7347 | Train Acc: 0.8316
 Site-art_painting              (1) | Train Loss: 0.6514 | Train Acc: 0.8920
 Site-cartoon                   (2) | Train Loss: 0.8799 | Train Acc: 0.7353
 Site-cartoon                   (2) | Train Loss: 0.8928 | Train Acc: 0.8140
 Site-sketch                    (2) | Train Loss: 1.1865 | Train Acc: 0.6281
Average Train Accuracy: 0.8654
 Site-photo                     (0) | Val  Loss: 0.4079 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.4134 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.4096 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.4174 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.3618 | Val  Acc: 0.9671
 Site-art_painting              (1) | Val  Loss: 0.6160 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.6473 | Val  Acc: 0.8889
 Site-art_painting              (1) | Val  Loss: 0.7939 | Val  Acc: 0.8451
 Site-cartoon                   (2) | Val  Loss: 0.9077 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.8377 | Val  Acc: 0.8174
 Site-sketch                    (2) | Val  Loss: 1.3367 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8690
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9671
 Best site-art_painting             (1)  | Epoch:10 | Val Acc: 0.9286
 Best site-art_painting             (1)  | Epoch:10 | Val Acc: 0.8889
 Best site-art_painting             (1)  | Epoch:10 | Val Acc: 0.8451
 Best site-cartoon                  (2)  | Epoch:10 | Val Acc: 0.8261
 Best site-cartoon                  (2)  | Epoch:10 | Val Acc: 0.8174
 Best site-sketch                   (2)  | Epoch:10 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 11 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (0) | Train Loss: 0.4364 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.3262 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.3354 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.3782 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.3775 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.7708 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.7193 | Train Acc: 0.8105
 Site-art_painting              (1) | Train Loss: 0.6399 | Train Acc: 0.8873
 Site-cartoon                   (2) | Train Loss: 0.8754 | Train Acc: 0.7353
 Site-cartoon                   (2) | Train Loss: 0.8119 | Train Acc: 0.8081
 Site-sketch                    (2) | Train Loss: 1.0780 | Train Acc: 0.6529
Average Train Accuracy: 0.8686
 Site-photo                     (0) | Val  Loss: 0.3963 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.4018 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3786 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.3708 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.3208 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.4967 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.5894 | Val  Acc: 0.9048
 Site-art_painting              (1) | Val  Loss: 0.7783 | Val  Acc: 0.8662
 Site-cartoon                   (2) | Val  Loss: 0.8358 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.7815 | Val  Acc: 0.8522
 Site-sketch                    (2) | Val  Loss: 1.1520 | Val  Acc: 0.6375
Average Valid Accuracy: 0.8934
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9737
 Best site-art_painting             (1)  | Epoch:11 | Val Acc: 0.9643
 Best site-art_painting             (1)  | Epoch:11 | Val Acc: 0.9048
 Best site-art_painting             (1)  | Epoch:11 | Val Acc: 0.8662
 Best site-cartoon                  (2)  | Epoch:11 | Val Acc: 0.8696
 Best site-cartoon                  (2)  | Epoch:11 | Val Acc: 0.8522
 Best site-sketch                   (2)  | Epoch:11 | Val Acc: 0.6375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 12 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (0) | Train Loss: 0.3772 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3671 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.2786 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.3254 | Train Acc: 0.9542
 Site-photo                     (0) | Train Loss: 0.3369 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.6673 | Train Acc: 0.9048
 Site-art_painting              (1) | Train Loss: 0.6398 | Train Acc: 0.8737
 Site-art_painting              (1) | Train Loss: 0.5597 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.7992 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.8261 | Train Acc: 0.7907
 Site-sketch                    (2) | Train Loss: 1.0534 | Train Acc: 0.6529
Average Train Accuracy: 0.8895
 Site-photo                     (0) | Val  Loss: 0.4036 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3378 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.3492 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.3437 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.2983 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.6077 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.5139 | Val  Acc: 0.9206
 Site-art_painting              (1) | Val  Loss: 0.6803 | Val  Acc: 0.8662
 Site-cartoon                   (2) | Val  Loss: 0.8214 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.7284 | Val  Acc: 0.8522
 Site-sketch                    (2) | Val  Loss: 1.2308 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8854
============ Train epoch 13 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (0) | Train Loss: 0.3348 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.2310 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2783 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.3138 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.3224 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.6681 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.6967 | Train Acc: 0.8211
 Site-art_painting              (1) | Train Loss: 0.5593 | Train Acc: 0.8967
 Site-cartoon                   (2) | Train Loss: 0.7048 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.7550 | Train Acc: 0.8140
 Site-sketch                    (2) | Train Loss: 0.9616 | Train Acc: 0.6612
Average Train Accuracy: 0.8817
 Site-photo                     (0) | Val  Loss: 0.3592 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3707 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.3204 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.3353 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2790 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.4978 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.4651 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.6667 | Val  Acc: 0.8662
 Site-cartoon                   (2) | Val  Loss: 0.7070 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.7126 | Val  Acc: 0.8348
 Site-sketch                    (2) | Val  Loss: 1.1358 | Val  Acc: 0.6125
Average Valid Accuracy: 0.8945
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:13 | Val Acc: 0.9286
 Best site-art_painting             (1)  | Epoch:13 | Val Acc: 0.9524
 Best site-art_painting             (1)  | Epoch:13 | Val Acc: 0.8662
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.8696
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.8348
 Best site-sketch                   (2)  | Epoch:13 | Val Acc: 0.6125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 14 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.2947 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2449 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.2321 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2826 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2978 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.5953 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.6565 | Train Acc: 0.8421
 Site-art_painting              (1) | Train Loss: 0.4991 | Train Acc: 0.9155
 Site-cartoon                   (2) | Train Loss: 0.6943 | Train Acc: 0.7941
 Site-cartoon                   (2) | Train Loss: 0.6918 | Train Acc: 0.8430
 Site-sketch                    (2) | Train Loss: 0.9509 | Train Acc: 0.7107
Average Train Accuracy: 0.8912
 Site-photo                     (0) | Val  Loss: 0.3481 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3007 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2909 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2951 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2742 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.5873 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.4887 | Val  Acc: 0.9048
 Site-art_painting              (1) | Val  Loss: 0.6298 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.6685 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.6527 | Val  Acc: 0.8435
 Site-sketch                    (2) | Val  Loss: 1.0926 | Val  Acc: 0.6750
Average Valid Accuracy: 0.8987
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9737
 Best site-art_painting             (1)  | Epoch:14 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:14 | Val Acc: 0.9048
 Best site-art_painting             (1)  | Epoch:14 | Val Acc: 0.8873
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8435
 Best site-sketch                   (2)  | Epoch:14 | Val Acc: 0.6750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 15 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.2990 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2531 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.2450 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2901 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.2615 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.6401 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.6410 | Train Acc: 0.8316
 Site-art_painting              (1) | Train Loss: 0.4732 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.6719 | Train Acc: 0.7647
 Site-cartoon                   (2) | Train Loss: 0.6623 | Train Acc: 0.8547
 Site-sketch                    (2) | Train Loss: 0.8495 | Train Acc: 0.7355
Average Train Accuracy: 0.8864
 Site-photo                     (0) | Val  Loss: 0.3752 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2891 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2765 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2922 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.2511 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.3725 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.4307 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.6290 | Val  Acc: 0.8944
 Site-cartoon                   (2) | Val  Loss: 0.6402 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.5930 | Val  Acc: 0.8696
 Site-sketch                    (2) | Val  Loss: 0.9773 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9080
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9868
 Best site-art_painting             (1)  | Epoch:15 | Val Acc: 0.9643
 Best site-art_painting             (1)  | Epoch:15 | Val Acc: 0.9524
 Best site-art_painting             (1)  | Epoch:15 | Val Acc: 0.8944
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.8696
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.8696
 Best site-sketch                   (2)  | Epoch:15 | Val Acc: 0.6875
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 16 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (0) | Train Loss: 0.2549 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2349 | Train Acc: 0.9265
 Site-photo                     (0) | Train Loss: 0.2048 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2445 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.2366 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.5922 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.5188 | Train Acc: 0.8421
 Site-art_painting              (1) | Train Loss: 0.4614 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.6361 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.6092 | Train Acc: 0.8372
 Site-sketch                    (2) | Train Loss: 0.8365 | Train Acc: 0.7190
Average Train Accuracy: 0.8919
 Site-photo                     (0) | Val  Loss: 0.2941 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.3009 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2371 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.2577 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2281 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.4644 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.3335 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.5938 | Val  Acc: 0.8944
 Site-cartoon                   (2) | Val  Loss: 0.6656 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.5909 | Val  Acc: 0.8696
 Site-sketch                    (2) | Val  Loss: 1.0277 | Val  Acc: 0.6500
Average Valid Accuracy: 0.8972
============ Train epoch 17 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (0) | Train Loss: 0.2830 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1932 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2006 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2413 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2264 | Train Acc: 0.9651
 Site-art_painting              (1) | Train Loss: 0.5526 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.4563 | Train Acc: 0.8842
 Site-art_painting              (1) | Train Loss: 0.4374 | Train Acc: 0.9202
 Site-cartoon                   (2) | Train Loss: 0.6212 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.6010 | Train Acc: 0.8314
 Site-sketch                    (2) | Train Loss: 0.7868 | Train Acc: 0.7438
Average Train Accuracy: 0.9011
 Site-photo                     (0) | Val  Loss: 0.2438 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2847 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2325 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.2548 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.2124 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.5231 | Val  Acc: 0.8571
 Site-art_painting              (1) | Val  Loss: 0.3526 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.5547 | Val  Acc: 0.9014
 Site-cartoon                   (2) | Val  Loss: 0.6009 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.5311 | Val  Acc: 0.8870
 Site-sketch                    (2) | Val  Loss: 1.1055 | Val  Acc: 0.6375
Average Valid Accuracy: 0.8987
============ Train epoch 18 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.2572 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1770 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1662 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.2055 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2430 | Train Acc: 0.9651
 Site-art_painting              (1) | Train Loss: 0.5321 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.5693 | Train Acc: 0.8632
 Site-art_painting              (1) | Train Loss: 0.4121 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.5866 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.5830 | Train Acc: 0.8663
 Site-sketch                    (2) | Train Loss: 0.7802 | Train Acc: 0.7438
Average Train Accuracy: 0.9032
 Site-photo                     (0) | Val  Loss: 0.3430 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2461 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2231 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2486 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2022 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.4331 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.3453 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.4969 | Val  Acc: 0.9014
 Site-cartoon                   (2) | Val  Loss: 0.5664 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.4998 | Val  Acc: 0.8870
 Site-sketch                    (2) | Val  Loss: 1.0407 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9100
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:18 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:18 | Val Acc: 0.9524
 Best site-art_painting             (1)  | Epoch:18 | Val Acc: 0.9014
 Best site-cartoon                  (2)  | Epoch:18 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:18 | Val Acc: 0.8870
 Best site-sketch                   (2)  | Epoch:18 | Val Acc: 0.6875
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 19 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (0) | Train Loss: 0.2358 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3579 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1720 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.2100 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2134 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.5498 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 0.4705 | Train Acc: 0.8737
 Site-art_painting              (1) | Train Loss: 0.4573 | Train Acc: 0.9202
 Site-cartoon                   (2) | Train Loss: 0.5725 | Train Acc: 0.8529
 Site-cartoon                   (2) | Train Loss: 0.5329 | Train Acc: 0.8779
 Site-sketch                    (2) | Train Loss: 0.7460 | Train Acc: 0.7438
Average Train Accuracy: 0.9027
 Site-photo                     (0) | Val  Loss: 0.3006 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2172 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2128 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.1964 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1951 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.3408 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.4120 | Val  Acc: 0.8730
 Site-art_painting              (1) | Val  Loss: 0.4667 | Val  Acc: 0.9014
 Site-cartoon                   (2) | Val  Loss: 0.5886 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.4763 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.9091 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9099
============ Train epoch 20 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (0) | Train Loss: 0.1811 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1483 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1508 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2311 | Train Acc: 0.9477
 Site-photo                     (0) | Train Loss: 0.2088 | Train Acc: 0.9563
 Site-art_painting              (1) | Train Loss: 0.4650 | Train Acc: 0.8571
 Site-art_painting              (1) | Train Loss: 0.3703 | Train Acc: 0.9053
 Site-art_painting              (1) | Train Loss: 0.3295 | Train Acc: 0.9343
 Site-cartoon                   (2) | Train Loss: 0.5637 | Train Acc: 0.8529
 Site-cartoon                   (2) | Train Loss: 0.5326 | Train Acc: 0.8372
 Site-sketch                    (2) | Train Loss: 0.7910 | Train Acc: 0.7107
Average Train Accuracy: 0.9034
 Site-photo                     (0) | Val  Loss: 0.2734 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.2131 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1589 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1848 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1577 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.3983 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.3602 | Val  Acc: 0.9048
 Site-art_painting              (1) | Val  Loss: 0.4614 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.5002 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.5049 | Val  Acc: 0.9043
 Site-sketch                    (2) | Val  Loss: 0.8967 | Val  Acc: 0.7125
Average Valid Accuracy: 0.9137
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:20 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:20 | Val Acc: 0.9048
 Best site-art_painting             (1)  | Epoch:20 | Val Acc: 0.9225
 Best site-cartoon                  (2)  | Epoch:20 | Val Acc: 0.9565
 Best site-cartoon                  (2)  | Epoch:20 | Val Acc: 0.9043
 Best site-sketch                   (2)  | Epoch:20 | Val Acc: 0.7125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 21 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (0) | Train Loss: 0.2333 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1771 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1340 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1836 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1946 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.5241 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.4702 | Train Acc: 0.8632
 Site-art_painting              (1) | Train Loss: 0.3510 | Train Acc: 0.9202
 Site-cartoon                   (2) | Train Loss: 0.5470 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.5036 | Train Acc: 0.8837
 Site-sketch                    (2) | Train Loss: 0.6880 | Train Acc: 0.7769
Average Train Accuracy: 0.9111
 Site-photo                     (0) | Val  Loss: 0.3049 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2107 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1714 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1743 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1641 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.3431 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.3152 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.4860 | Val  Acc: 0.9155
 Site-cartoon                   (2) | Val  Loss: 0.5094 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.4546 | Val  Acc: 0.8957
 Site-sketch                    (2) | Val  Loss: 0.9317 | Val  Acc: 0.6375
Average Valid Accuracy: 0.9178
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 0.9643
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 0.9524
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 0.9155
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.8957
 Best site-sketch                   (2)  | Epoch:21 | Val Acc: 0.6375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 22 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.1830 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1544 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1300 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1732 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.1875 | Train Acc: 0.9651
 Site-art_painting              (1) | Train Loss: 0.5087 | Train Acc: 0.8571
 Site-art_painting              (1) | Train Loss: 0.4324 | Train Acc: 0.8947
 Site-art_painting              (1) | Train Loss: 0.3272 | Train Acc: 0.9249
 Site-cartoon                   (2) | Train Loss: 0.6315 | Train Acc: 0.7647
 Site-cartoon                   (2) | Train Loss: 0.5329 | Train Acc: 0.8256
 Site-sketch                    (2) | Train Loss: 0.6491 | Train Acc: 0.8017
Average Train Accuracy: 0.9019
 Site-photo                     (0) | Val  Loss: 0.2073 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2506 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1768 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1872 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1556 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2862 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.3337 | Val  Acc: 0.8889
 Site-art_painting              (1) | Val  Loss: 0.4059 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.4822 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.4300 | Val  Acc: 0.8957
 Site-sketch                    (2) | Val  Loss: 0.9527 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9098
============ Train epoch 23 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (0) | Train Loss: 0.1800 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2202 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1457 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1688 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1687 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.4874 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.4537 | Train Acc: 0.9263
 Site-art_painting              (1) | Train Loss: 0.3479 | Train Acc: 0.9249
 Site-cartoon                   (2) | Train Loss: 0.5833 | Train Acc: 0.8529
 Site-cartoon                   (2) | Train Loss: 0.4637 | Train Acc: 0.9070
 Site-sketch                    (2) | Train Loss: 0.6598 | Train Acc: 0.7686
Average Train Accuracy: 0.9220
 Site-photo                     (0) | Val  Loss: 0.2534 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.2391 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1723 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1611 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1441 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.3645 | Val  Acc: 0.8571
 Site-art_painting              (1) | Val  Loss: 0.3129 | Val  Acc: 0.9048
 Site-art_painting              (1) | Val  Loss: 0.4446 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.5071 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.4413 | Val  Acc: 0.8957
 Site-sketch                    (2) | Val  Loss: 0.9218 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9117
============ Train epoch 24 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (0) | Train Loss: 0.1923 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2293 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1399 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1481 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1717 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.4733 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.3770 | Train Acc: 0.8947
 Site-art_painting              (1) | Train Loss: 0.3357 | Train Acc: 0.9155
 Site-cartoon                   (2) | Train Loss: 0.5082 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.4369 | Train Acc: 0.8953
 Site-sketch                    (2) | Train Loss: 0.6263 | Train Acc: 0.8017
Average Train Accuracy: 0.9116
 Site-photo                     (0) | Val  Loss: 0.1920 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.2759 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1485 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1678 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1359 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.3420 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.2719 | Val  Acc: 0.9206
 Site-art_painting              (1) | Val  Loss: 0.4372 | Val  Acc: 0.9366
 Site-cartoon                   (2) | Val  Loss: 0.5120 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3910 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.8821 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9202
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9868
 Best site-art_painting             (1)  | Epoch:24 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:24 | Val Acc: 0.9206
 Best site-art_painting             (1)  | Epoch:24 | Val Acc: 0.9366
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.8696
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.9217
 Best site-sketch                   (2)  | Epoch:24 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 25 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (0) | Train Loss: 0.1677 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1142 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1327 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1626 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1693 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.4924 | Train Acc: 0.8571
 Site-art_painting              (1) | Train Loss: 0.4112 | Train Acc: 0.8842
 Site-art_painting              (1) | Train Loss: 0.3547 | Train Acc: 0.8920
 Site-cartoon                   (2) | Train Loss: 0.4492 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.4135 | Train Acc: 0.9012
 Site-sketch                    (2) | Train Loss: 0.6856 | Train Acc: 0.7851
Average Train Accuracy: 0.9180
 Site-photo                     (0) | Val  Loss: 0.2622 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.2390 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1536 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1632 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1552 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.2129 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.2329 | Val  Acc: 0.9841
 Site-art_painting              (1) | Val  Loss: 0.3458 | Val  Acc: 0.9648
 Site-cartoon                   (2) | Val  Loss: 0.4534 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3685 | Val  Acc: 0.9304
 Site-sketch                    (2) | Val  Loss: 0.9466 | Val  Acc: 0.6250
Average Valid Accuracy: 0.9200
============ Train epoch 26 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (0) | Train Loss: 0.1406 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1724 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1019 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1417 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1611 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.3329 | Train Acc: 0.9048
 Site-art_painting              (1) | Train Loss: 0.4070 | Train Acc: 0.9158
 Site-art_painting              (1) | Train Loss: 0.2819 | Train Acc: 0.9296
 Site-cartoon                   (2) | Train Loss: 0.4650 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.4219 | Train Acc: 0.9244
 Site-sketch                    (2) | Train Loss: 0.6560 | Train Acc: 0.7438
Average Train Accuracy: 0.9284
 Site-photo                     (0) | Val  Loss: 0.2965 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2385 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1433 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1543 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1351 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.2046 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.2569 | Val  Acc: 0.9365
 Site-art_painting              (1) | Val  Loss: 0.3863 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.4201 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.3983 | Val  Acc: 0.8870
 Site-sketch                    (2) | Val  Loss: 0.9186 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9278
 Best site-photo                    (0)  | Epoch:26 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:26 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:26 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:26 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:26 | Val Acc: 0.9737
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 0.9365
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 0.9225
 Best site-cartoon                  (2)  | Epoch:26 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:26 | Val Acc: 0.8870
 Best site-sketch                   (2)  | Epoch:26 | Val Acc: 0.7625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 27 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (0) | Train Loss: 0.1547 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1072 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1063 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1652 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1658 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.5349 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.3691 | Train Acc: 0.9053
 Site-art_painting              (1) | Train Loss: 0.2846 | Train Acc: 0.9296
 Site-cartoon                   (2) | Train Loss: 0.4487 | Train Acc: 0.8824
 Site-cartoon                   (2) | Train Loss: 0.4207 | Train Acc: 0.8721
 Site-sketch                    (2) | Train Loss: 0.6489 | Train Acc: 0.7769
Average Train Accuracy: 0.9163
 Site-photo                     (0) | Val  Loss: 0.2007 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2131 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1339 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1510 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1304 | Val  Acc: 0.9934
 Site-art_painting              (1) | Val  Loss: 0.2469 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.2283 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.3314 | Val  Acc: 0.9437
 Site-cartoon                   (2) | Val  Loss: 0.5092 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.3976 | Val  Acc: 0.9043
 Site-sketch                    (2) | Val  Loss: 0.8328 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9218
============ Train epoch 28 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (0) | Train Loss: 0.1468 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1503 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1088 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1706 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.1489 | Train Acc: 0.9694
 Site-art_painting              (2) | Train Loss: 0.4914 | Train Acc: 0.8095
 Site-art_painting              (2) | Train Loss: 0.3325 | Train Acc: 0.9263
 Site-art_painting              (2) | Train Loss: 0.2784 | Train Acc: 0.9249
 Site-cartoon                   (3) | Train Loss: 0.5105 | Train Acc: 0.8235
 Site-cartoon                   (3) | Train Loss: 0.3964 | Train Acc: 0.9070
 Site-sketch                    (3) | Train Loss: 0.5624 | Train Acc: 0.7934
Average Train Accuracy: 0.9151
 Site-photo                     (0) | Val  Loss: 0.2485 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2566 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1396 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1661 | Val  Acc: 0.9608
 Site-photo                     (1) | Val  Loss: 0.1186 | Val  Acc: 0.9868
 Site-art_painting              (2) | Val  Loss: 0.2488 | Val  Acc: 0.8929
 Site-art_painting              (2) | Val  Loss: 0.2092 | Val  Acc: 0.9683
 Site-art_painting              (2) | Val  Loss: 0.2860 | Val  Acc: 0.9507
 Site-cartoon                   (3) | Val  Loss: 0.4246 | Val  Acc: 0.8696
 Site-cartoon                   (3) | Val  Loss: 0.3612 | Val  Acc: 0.9043
 Site-sketch                    (3) | Val  Loss: 0.9083 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9221
============ Train epoch 29 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (0) | Train Loss: 0.1390 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.0849 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1200 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1397 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.1586 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.4680 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 0.4207 | Train Acc: 0.8842
 Site-art_painting              (1) | Train Loss: 0.2850 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.4312 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.3989 | Train Acc: 0.9186
 Site-sketch                    (2) | Train Loss: 0.5815 | Train Acc: 0.7769
Average Train Accuracy: 0.9194
 Site-photo                     (0) | Val  Loss: 0.2038 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2020 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1273 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1448 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1216 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2517 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.1981 | Val  Acc: 0.9841
 Site-art_painting              (1) | Val  Loss: 0.4136 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.3976 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.3354 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.8516 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9313
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:29 | Val Acc: 0.9868
 Best site-art_painting             (1)  | Epoch:29 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:29 | Val Acc: 0.9841
 Best site-art_painting             (1)  | Epoch:29 | Val Acc: 0.9296
 Best site-cartoon                  (2)  | Epoch:29 | Val Acc: 0.9565
 Best site-cartoon                  (2)  | Epoch:29 | Val Acc: 0.9217
 Best site-sketch                   (2)  | Epoch:29 | Val Acc: 0.7625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 30 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (0) | Train Loss: 0.1484 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1278 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.0917 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1278 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1586 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.3597 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.3051 | Train Acc: 0.9263
 Site-art_painting              (1) | Train Loss: 0.2527 | Train Acc: 0.9624
 Site-cartoon                   (2) | Train Loss: 0.4691 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.3914 | Train Acc: 0.9128
 Site-sketch                    (2) | Train Loss: 0.5584 | Train Acc: 0.8017
Average Train Accuracy: 0.9242
 Site-photo                     (0) | Val  Loss: 0.2012 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1797 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1215 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1282 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1226 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2249 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.1889 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.3306 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.4405 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3361 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.8923 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9262
============ Train epoch 31 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.1490 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.5659 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0926 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1456 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1411 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.4206 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.3631 | Train Acc: 0.9158
 Site-art_painting              (1) | Train Loss: 0.2727 | Train Acc: 0.9437
 Site-cartoon                   (2) | Train Loss: 0.4983 | Train Acc: 0.8529
 Site-cartoon                   (2) | Train Loss: 0.3674 | Train Acc: 0.9012
 Site-sketch                    (2) | Train Loss: 0.5099 | Train Acc: 0.8347
Average Train Accuracy: 0.9258
 Site-photo                     (0) | Val  Loss: 0.2626 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2297 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1192 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1432 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1239 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.2003 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.2676 | Val  Acc: 0.9365
 Site-art_painting              (1) | Val  Loss: 0.3731 | Val  Acc: 0.9366
 Site-cartoon                   (2) | Val  Loss: 0.3659 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.3187 | Val  Acc: 0.9565
 Site-sketch                    (2) | Val  Loss: 0.7480 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9324
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:31 | Val Acc: 0.9286
 Best site-art_painting             (1)  | Epoch:31 | Val Acc: 0.9365
 Best site-art_painting             (1)  | Epoch:31 | Val Acc: 0.9366
 Best site-cartoon                  (2)  | Epoch:31 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:31 | Val Acc: 0.9565
 Best site-sketch                   (2)  | Epoch:31 | Val Acc: 0.7750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 32 ============
cnt=[3, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (0) | Train Loss: 0.1215 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.4499 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.1003 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1297 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1415 | Train Acc: 0.9694
 Site-art_painting              (2) | Train Loss: 0.4628 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.3373 | Train Acc: 0.8947
 Site-art_painting              (2) | Train Loss: 0.2606 | Train Acc: 0.9202
 Site-cartoon                   (3) | Train Loss: 0.4969 | Train Acc: 0.7941
 Site-cartoon                   (3) | Train Loss: 0.3515 | Train Acc: 0.9070
 Site-sketch                    (3) | Train Loss: 0.5512 | Train Acc: 0.7934
Average Train Accuracy: 0.9100
 Site-photo                     (0) | Val  Loss: 0.1846 | Val  Acc: 0.9000
 Site-photo                     (1) | Val  Loss: 0.2381 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1376 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1380 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1240 | Val  Acc: 0.9803
 Site-art_painting              (2) | Val  Loss: 0.2025 | Val  Acc: 0.9643
 Site-art_painting              (2) | Val  Loss: 0.1801 | Val  Acc: 0.9841
 Site-art_painting              (2) | Val  Loss: 0.3248 | Val  Acc: 0.9366
 Site-cartoon                   (3) | Val  Loss: 0.3939 | Val  Acc: 0.8696
 Site-cartoon                   (3) | Val  Loss: 0.3260 | Val  Acc: 0.9130
 Site-sketch                    (3) | Val  Loss: 0.8728 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9266
============ Train epoch 33 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (0) | Train Loss: 0.1955 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1114 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1049 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1153 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1527 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.4004 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.2895 | Train Acc: 0.9474
 Site-art_painting              (1) | Train Loss: 0.2554 | Train Acc: 0.9108
 Site-cartoon                   (2) | Train Loss: 0.4241 | Train Acc: 0.8529
 Site-cartoon                   (2) | Train Loss: 0.3656 | Train Acc: 0.9186
 Site-sketch                    (2) | Train Loss: 0.5676 | Train Acc: 0.7851
Average Train Accuracy: 0.9232
 Site-photo                     (0) | Val  Loss: 0.1326 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1346 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1000 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1355 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.0941 | Val  Acc: 0.9934
 Site-art_painting              (1) | Val  Loss: 0.2469 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.2120 | Val  Acc: 0.9683
 Site-art_painting              (1) | Val  Loss: 0.2855 | Val  Acc: 0.9507
 Site-cartoon                   (2) | Val  Loss: 0.4574 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.3256 | Val  Acc: 0.9565
 Site-sketch                    (2) | Val  Loss: 0.8133 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9378
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9934
 Best site-art_painting             (1)  | Epoch:33 | Val Acc: 0.9286
 Best site-art_painting             (1)  | Epoch:33 | Val Acc: 0.9683
 Best site-art_painting             (1)  | Epoch:33 | Val Acc: 0.9507
 Best site-cartoon                  (2)  | Epoch:33 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:33 | Val Acc: 0.9565
 Best site-sketch                   (2)  | Epoch:33 | Val Acc: 0.7625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 34 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (0) | Train Loss: 0.1813 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1515 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0852 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1242 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1481 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.4062 | Train Acc: 0.8571
 Site-art_painting              (1) | Train Loss: 0.3799 | Train Acc: 0.9053
 Site-art_painting              (1) | Train Loss: 0.2266 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.4183 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.3395 | Train Acc: 0.9244
 Site-sketch                    (2) | Train Loss: 0.5792 | Train Acc: 0.7851
Average Train Accuracy: 0.9270
 Site-photo                     (0) | Val  Loss: 0.1672 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2234 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1188 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1179 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.1152 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2277 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.2387 | Val  Acc: 0.9365
 Site-art_painting              (1) | Val  Loss: 0.2562 | Val  Acc: 0.9437
 Site-cartoon                   (2) | Val  Loss: 0.3333 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.3222 | Val  Acc: 0.9043
 Site-sketch                    (2) | Val  Loss: 0.8372 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9275
============ Train epoch 35 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (0) | Train Loss: 0.1428 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1626 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.0990 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1371 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1326 | Train Acc: 0.9694
 Site-art_painting              (2) | Train Loss: 0.3061 | Train Acc: 0.9524
 Site-art_painting              (2) | Train Loss: 0.3520 | Train Acc: 0.9053
 Site-art_painting              (2) | Train Loss: 0.2335 | Train Acc: 0.9343
 Site-cartoon                   (3) | Train Loss: 0.4069 | Train Acc: 0.8824
 Site-cartoon                   (3) | Train Loss: 0.3651 | Train Acc: 0.9128
 Site-sketch                    (3) | Train Loss: 0.4904 | Train Acc: 0.8430
Average Train Accuracy: 0.9368
 Site-photo                     (0) | Val  Loss: 0.1694 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1798 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1057 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1528 | Val  Acc: 0.9608
 Site-photo                     (1) | Val  Loss: 0.1127 | Val  Acc: 0.9803
 Site-art_painting              (2) | Val  Loss: 0.1381 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.1594 | Val  Acc: 0.9841
 Site-art_painting              (2) | Val  Loss: 0.3279 | Val  Acc: 0.9155
 Site-cartoon                   (3) | Val  Loss: 0.3095 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 0.3156 | Val  Acc: 0.9130
 Site-sketch                    (3) | Val  Loss: 0.6964 | Val  Acc: 0.7375
Average Valid Accuracy: 0.9410
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:35 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:35 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9608
 Best site-photo                    (1)  | Epoch:35 | Val Acc: 0.9803
 Best site-art_painting             (2)  | Epoch:35 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:35 | Val Acc: 0.9841
 Best site-art_painting             (2)  | Epoch:35 | Val Acc: 0.9155
 Best site-cartoon                  (3)  | Epoch:35 | Val Acc: 1.0000
 Best site-cartoon                  (3)  | Epoch:35 | Val Acc: 0.9130
 Best site-sketch                   (3)  | Epoch:35 | Val Acc: 0.7375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 36 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (0) | Train Loss: 0.1631 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.1190 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.0994 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1486 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1055 | Train Acc: 0.9869
 Site-art_painting              (2) | Train Loss: 0.3901 | Train Acc: 0.8810
 Site-art_painting              (2) | Train Loss: 0.2970 | Train Acc: 0.9263
 Site-art_painting              (2) | Train Loss: 0.2546 | Train Acc: 0.9155
 Site-cartoon                   (3) | Train Loss: 0.4516 | Train Acc: 0.8824
 Site-cartoon                   (3) | Train Loss: 0.3190 | Train Acc: 0.9419
 Site-sketch                    (3) | Train Loss: 0.5247 | Train Acc: 0.8264
Average Train Accuracy: 0.9317
 Site-photo                     (0) | Val  Loss: 0.1745 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1826 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1223 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1396 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1046 | Val  Acc: 0.9803
 Site-art_painting              (2) | Val  Loss: 0.1562 | Val  Acc: 0.9643
 Site-art_painting              (2) | Val  Loss: 0.1994 | Val  Acc: 0.9524
 Site-art_painting              (2) | Val  Loss: 0.2769 | Val  Acc: 0.9366
 Site-cartoon                   (3) | Val  Loss: 0.2827 | Val  Acc: 0.9130
 Site-cartoon                   (3) | Val  Loss: 0.3064 | Val  Acc: 0.9304
 Site-sketch                    (3) | Val  Loss: 0.6641 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9336
============ Train epoch 37 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (0) | Train Loss: 0.1209 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1377 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.1040 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.1401 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1115 | Train Acc: 0.9782
 Site-art_painting              (2) | Train Loss: 0.4170 | Train Acc: 0.9048
 Site-art_painting              (2) | Train Loss: 0.3067 | Train Acc: 0.9368
 Site-art_painting              (2) | Train Loss: 0.2106 | Train Acc: 0.9718
 Site-cartoon                   (3) | Train Loss: 0.3766 | Train Acc: 0.9118
 Site-cartoon                   (3) | Train Loss: 0.2882 | Train Acc: 0.9651
 Site-sketch                    (3) | Train Loss: 0.4700 | Train Acc: 0.8264
Average Train Accuracy: 0.9446
 Site-photo                     (0) | Val  Loss: 0.1255 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1521 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1010 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1170 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1152 | Val  Acc: 0.9934
 Site-art_painting              (2) | Val  Loss: 0.1677 | Val  Acc: 0.9643
 Site-art_painting              (2) | Val  Loss: 0.1752 | Val  Acc: 0.9841
 Site-art_painting              (2) | Val  Loss: 0.2764 | Val  Acc: 0.9296
 Site-cartoon                   (3) | Val  Loss: 0.3984 | Val  Acc: 0.9565
 Site-cartoon                   (3) | Val  Loss: 0.2948 | Val  Acc: 0.9130
 Site-sketch                    (3) | Val  Loss: 0.7918 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9447
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:37 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:37 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:37 | Val Acc: 0.9934
 Best site-art_painting             (2)  | Epoch:37 | Val Acc: 0.9643
 Best site-art_painting             (2)  | Epoch:37 | Val Acc: 0.9841
 Best site-art_painting             (2)  | Epoch:37 | Val Acc: 0.9296
 Best site-cartoon                  (3)  | Epoch:37 | Val Acc: 0.9565
 Best site-cartoon                  (3)  | Epoch:37 | Val Acc: 0.9130
 Best site-sketch                   (3)  | Epoch:37 | Val Acc: 0.7875
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 38 ============
cnt=[3, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (0) | Train Loss: 0.1486 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1315 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0821 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1547 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1098 | Train Acc: 0.9782
 Site-art_painting              (2) | Train Loss: 0.3937 | Train Acc: 0.8810
 Site-art_painting              (2) | Train Loss: 0.2735 | Train Acc: 0.9158
 Site-art_painting              (2) | Train Loss: 0.2144 | Train Acc: 0.9484
 Site-cartoon                   (3) | Train Loss: 0.4076 | Train Acc: 0.9118
 Site-cartoon                   (3) | Train Loss: 0.3356 | Train Acc: 0.9186
 Site-sketch                    (3) | Train Loss: 0.4776 | Train Acc: 0.8347
Average Train Accuracy: 0.9345
 Site-photo                     (0) | Val  Loss: 0.2112 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1511 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.0965 | Val  Acc: 0.9853
 Site-photo                     (0) | Val  Loss: 0.1028 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1010 | Val  Acc: 0.9803
 Site-art_painting              (2) | Val  Loss: 0.2000 | Val  Acc: 0.9643
 Site-art_painting              (2) | Val  Loss: 0.2027 | Val  Acc: 0.9524
 Site-art_painting              (2) | Val  Loss: 0.2824 | Val  Acc: 0.9296
 Site-cartoon                   (3) | Val  Loss: 0.2793 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 0.2924 | Val  Acc: 0.9304
 Site-sketch                    (3) | Val  Loss: 0.8172 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9422
============ Train epoch 39 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (0) | Train Loss: 0.1168 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1192 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0670 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1337 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1231 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.4075 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.2904 | Train Acc: 0.9368
 Site-art_painting              (1) | Train Loss: 0.2103 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.3837 | Train Acc: 0.9412
 Site-cartoon                   (2) | Train Loss: 0.3005 | Train Acc: 0.9360
 Site-sketch                    (2) | Train Loss: 0.5574 | Train Acc: 0.8264
Average Train Accuracy: 0.9378
 Site-photo                     (0) | Val  Loss: 0.1729 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1573 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1064 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1200 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.0927 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.1590 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.1875 | Val  Acc: 0.9683
 Site-art_painting              (1) | Val  Loss: 0.3695 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.3297 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.2947 | Val  Acc: 0.9391
 Site-sketch                    (2) | Val  Loss: 0.7766 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9389
============ Train epoch 40 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (0) | Train Loss: 0.1103 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.0690 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0825 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1483 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1212 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.3862 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.2418 | Train Acc: 0.9579
 Site-art_painting              (1) | Train Loss: 0.2216 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.3856 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.2807 | Train Acc: 0.9535
 Site-sketch                    (2) | Train Loss: 0.4484 | Train Acc: 0.8760
Average Train Accuracy: 0.9458
 Site-photo                     (0) | Val  Loss: 0.1076 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1553 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1058 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1251 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1155 | Val  Acc: 0.9934
 Site-art_painting              (1) | Val  Loss: 0.1988 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.2288 | Val  Acc: 0.9206
 Site-art_painting              (1) | Val  Loss: 0.2981 | Val  Acc: 0.9366
 Site-cartoon                   (2) | Val  Loss: 0.2247 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.2709 | Val  Acc: 0.9304
 Site-sketch                    (2) | Val  Loss: 0.7266 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9407
 Test site-photo                     (0)| Epoch:37 | Test Acc: 0.9925
 Test site-art_painting              (1)| Epoch:37 | Test Acc: 0.9086
 Test site-cartoon                   (2)| Epoch:37 | Test Acc: 0.8883
 Test site-sketch                    (2)| Epoch:37 | Test Acc: 0.7954
photo: 0.9925, art_painting: 0.9086, cartoon: 0.8883, sketch: 0.7954, 
Average Test Accuracy(group): 0.8962, Average Test Accuracy(individual): 0.9328,
domain std=0.0701, cluster std=0.0557, individual std=0.0621, 
Average Test Accuracy: 0.8962
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 41 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (0) | Train Loss: 0.1350 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1443 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0701 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1199 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1129 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.3452 | Train Acc: 0.9048
 Site-art_painting              (1) | Train Loss: 0.2502 | Train Acc: 0.9474
 Site-art_painting              (1) | Train Loss: 0.2121 | Train Acc: 0.9343
 Site-cartoon                   (2) | Train Loss: 0.3704 | Train Acc: 0.9412
 Site-cartoon                   (2) | Train Loss: 0.2922 | Train Acc: 0.9360
 Site-sketch                    (2) | Train Loss: 0.4285 | Train Acc: 0.8595
Average Train Accuracy: 0.9463
 Site-photo                     (0) | Val  Loss: 0.1051 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1950 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1165 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1253 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1275 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.2172 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.1595 | Val  Acc: 0.9683
 Site-art_painting              (1) | Val  Loss: 0.2356 | Val  Acc: 0.9437
 Site-cartoon                   (2) | Val  Loss: 0.2414 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.2447 | Val  Acc: 0.9652
 Site-sketch                    (2) | Val  Loss: 0.7654 | Val  Acc: 0.7375
Average Valid Accuracy: 0.9437
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9925
 Test site-art_painting              (1)| Epoch:40 | Test Acc: 0.9050
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8862
 Test site-sketch                    (2)| Epoch:40 | Test Acc: 0.8024
photo: 0.9925, art_painting: 0.9050, cartoon: 0.8862, sketch: 0.8024, 
Average Test Accuracy(group): 0.8965, Average Test Accuracy(individual): 0.9320,
domain std=0.0676, cluster std=0.0557, individual std=0.0614, 
Average Test Accuracy: 0.8965
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 42 ============
cnt=[3, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.1393 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.0695 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.0721 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.0978 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1079 | Train Acc: 0.9782
 Site-art_painting              (2) | Train Loss: 0.3784 | Train Acc: 0.8810
 Site-art_painting              (2) | Train Loss: 0.2064 | Train Acc: 0.9579
 Site-art_painting              (2) | Train Loss: 0.2311 | Train Acc: 0.9155
 Site-cartoon                   (3) | Train Loss: 0.3810 | Train Acc: 0.9412
 Site-cartoon                   (3) | Train Loss: 0.2722 | Train Acc: 0.9535
 Site-sketch                    (3) | Train Loss: 0.4521 | Train Acc: 0.8595
Average Train Accuracy: 0.9439
 Site-photo                     (0) | Val  Loss: 0.1187 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1835 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1016 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.1288 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1141 | Val  Acc: 0.9868
 Site-art_painting              (2) | Val  Loss: 0.2205 | Val  Acc: 0.9286
 Site-art_painting              (2) | Val  Loss: 0.1834 | Val  Acc: 0.9524
 Site-art_painting              (2) | Val  Loss: 0.2981 | Val  Acc: 0.9225
 Site-cartoon                   (3) | Val  Loss: 0.3473 | Val  Acc: 0.9565
 Site-cartoon                   (3) | Val  Loss: 0.2595 | Val  Acc: 0.9478
 Site-sketch                    (3) | Val  Loss: 0.7710 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9363
 Test site-photo                     (0)| Epoch:41 | Test Acc: 0.9925
 Test site-art_painting              (2)| Epoch:41 | Test Acc: 0.9111
 Test site-cartoon                   (3)| Epoch:41 | Test Acc: 0.8957
 Test site-sketch                    (3)| Epoch:41 | Test Acc: 0.7992
photo: 0.9925, art_painting: 0.9111, cartoon: 0.8957, sketch: 0.7992, 
Average Test Accuracy(group): 0.8997, Average Test Accuracy(individual): 0.9352,
domain std=0.0687, cluster std=0.0552, individual std=0.0601, 
Average Test Accuracy: 0.8997
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 43 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (0) | Train Loss: 0.0942 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0686 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0611 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.0976 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.0947 | Train Acc: 0.9869
 Site-art_painting              (1) | Train Loss: 0.3287 | Train Acc: 0.9286
 Site-art_painting              (1) | Train Loss: 0.2663 | Train Acc: 0.8947
 Site-art_painting              (1) | Train Loss: 0.1843 | Train Acc: 0.9624
 Site-cartoon                   (2) | Train Loss: 0.3616 | Train Acc: 0.9412
 Site-cartoon                   (2) | Train Loss: 0.2580 | Train Acc: 0.9477
 Site-sketch                    (2) | Train Loss: 0.4246 | Train Acc: 0.8595
Average Train Accuracy: 0.9499
 Site-photo                     (0) | Val  Loss: 0.1302 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1115 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0973 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1167 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.0999 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2225 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.1481 | Val  Acc: 0.9683
 Site-art_painting              (1) | Val  Loss: 0.2623 | Val  Acc: 0.9577
 Site-cartoon                   (2) | Val  Loss: 0.2613 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.2417 | Val  Acc: 0.9391
 Site-sketch                    (2) | Val  Loss: 0.7859 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9482
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:43 | Val Acc: 0.9868
 Best site-art_painting             (1)  | Epoch:43 | Val Acc: 0.9643
 Best site-art_painting             (1)  | Epoch:43 | Val Acc: 0.9683
 Best site-art_painting             (1)  | Epoch:43 | Val Acc: 0.9577
 Best site-cartoon                  (2)  | Epoch:43 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:43 | Val Acc: 0.9391
 Best site-sketch                   (2)  | Epoch:43 | Val Acc: 0.7500
 Test site-photo                     (0)| Epoch:43 | Test Acc: 0.9925
 Test site-art_painting              (1)| Epoch:43 | Test Acc: 0.9099
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.9021
 Test site-sketch                    (2)| Epoch:43 | Test Acc: 0.8030
photo: 0.9925, art_painting: 0.9099, cartoon: 0.9021, sketch: 0.8030, 
Average Test Accuracy(group): 0.9019, Average Test Accuracy(individual): 0.9363,
domain std=0.0672, cluster std=0.0514, individual std=0.0588, 
Average Test Accuracy: 0.9019
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 44 ============
cnt=[3, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (0) | Train Loss: 0.1124 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0808 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1070 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.0935 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.1234 | Train Acc: 0.9738
 Site-art_painting              (2) | Train Loss: 0.3102 | Train Acc: 0.9286
 Site-art_painting              (2) | Train Loss: 0.2903 | Train Acc: 0.9053
 Site-art_painting              (2) | Train Loss: 0.2181 | Train Acc: 0.9484
 Site-cartoon                   (3) | Train Loss: 0.3761 | Train Acc: 0.8529
 Site-cartoon                   (3) | Train Loss: 0.2611 | Train Acc: 0.9651
 Site-sketch                    (3) | Train Loss: 0.4899 | Train Acc: 0.8017
Average Train Accuracy: 0.9373
 Site-photo                     (0) | Val  Loss: 0.2033 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.0948 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0955 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1104 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.1105 | Val  Acc: 0.9803
 Site-art_painting              (2) | Val  Loss: 0.1558 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.1435 | Val  Acc: 0.9683
 Site-art_painting              (2) | Val  Loss: 0.3216 | Val  Acc: 0.9366
 Site-cartoon                   (3) | Val  Loss: 0.2350 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 0.2423 | Val  Acc: 0.9391
 Site-sketch                    (3) | Val  Loss: 0.6040 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9506
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:44 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:44 | Val Acc: 0.9803
 Best site-art_painting             (2)  | Epoch:44 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:44 | Val Acc: 0.9683
 Best site-art_painting             (2)  | Epoch:44 | Val Acc: 0.9366
 Best site-cartoon                  (3)  | Epoch:44 | Val Acc: 1.0000
 Best site-cartoon                  (3)  | Epoch:44 | Val Acc: 0.9391
 Best site-sketch                   (3)  | Epoch:44 | Val Acc: 0.8000
 Test site-photo                     (0)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:44 | Test Acc: 0.9111
 Test site-cartoon                   (3)| Epoch:44 | Test Acc: 0.9032
 Test site-sketch                    (3)| Epoch:44 | Test Acc: 0.7992
photo: 0.9896, art_painting: 0.9111, cartoon: 0.9032, sketch: 0.7992, 
Average Test Accuracy(group): 0.9008, Average Test Accuracy(individual): 0.9351,
domain std=0.0676, cluster std=0.0521, individual std=0.0580, 
Average Test Accuracy: 0.9008
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 45 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (0) | Train Loss: 0.1258 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.2382 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0774 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.0767 | Train Acc: 0.9869
 Site-photo                     (0) | Train Loss: 0.1269 | Train Acc: 0.9651
 Site-art_painting              (2) | Train Loss: 0.3278 | Train Acc: 0.9286
 Site-art_painting              (2) | Train Loss: 0.2251 | Train Acc: 0.9789
 Site-art_painting              (2) | Train Loss: 0.1943 | Train Acc: 0.9577
 Site-cartoon                   (3) | Train Loss: 0.2930 | Train Acc: 0.8824
 Site-cartoon                   (3) | Train Loss: 0.2649 | Train Acc: 0.9477
 Site-sketch                    (3) | Train Loss: 0.4439 | Train Acc: 0.8843
Average Train Accuracy: 0.9496
 Site-photo                     (0) | Val  Loss: 0.1941 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1157 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.1022 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1161 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.0938 | Val  Acc: 0.9868
 Site-art_painting              (2) | Val  Loss: 0.2041 | Val  Acc: 0.9286
 Site-art_painting              (2) | Val  Loss: 0.1773 | Val  Acc: 0.9206
 Site-art_painting              (2) | Val  Loss: 0.3077 | Val  Acc: 0.9296
 Site-cartoon                   (3) | Val  Loss: 0.3115 | Val  Acc: 0.9130
 Site-cartoon                   (3) | Val  Loss: 0.2645 | Val  Acc: 0.9565
 Site-sketch                    (3) | Val  Loss: 0.7299 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9341
 Test site-photo                     (0)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:44 | Test Acc: 0.9160
 Test site-cartoon                   (3)| Epoch:44 | Test Acc: 0.8968
 Test site-sketch                    (3)| Epoch:44 | Test Acc: 0.7954
photo: 0.9896, art_painting: 0.9160, cartoon: 0.8968, sketch: 0.7954, 
Average Test Accuracy(group): 0.8994, Average Test Accuracy(individual): 0.9350,
domain std=0.0693, cluster std=0.0534, individual std=0.0591, 
Average Test Accuracy: 0.8994
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 46 ============
cnt=[3, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (0) | Train Loss: 0.0967 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.0787 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0606 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1013 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1135 | Train Acc: 0.9738
 Site-art_painting              (2) | Train Loss: 0.2804 | Train Acc: 0.9286
 Site-art_painting              (2) | Train Loss: 0.2655 | Train Acc: 0.9368
 Site-art_painting              (2) | Train Loss: 0.1707 | Train Acc: 0.9531
 Site-cartoon                   (3) | Train Loss: 0.4137 | Train Acc: 0.8529
 Site-cartoon                   (3) | Train Loss: 0.2473 | Train Acc: 0.9244
 Site-sketch                    (3) | Train Loss: 0.4326 | Train Acc: 0.8430
Average Train Accuracy: 0.9373
 Site-photo                     (0) | Val  Loss: 0.1404 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.0872 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.0922 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.0774 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.1143 | Val  Acc: 0.9737
 Site-art_painting              (2) | Val  Loss: 0.1872 | Val  Acc: 0.9286
 Site-art_painting              (2) | Val  Loss: 0.1497 | Val  Acc: 0.9683
 Site-art_painting              (2) | Val  Loss: 0.2517 | Val  Acc: 0.9437
 Site-cartoon                   (3) | Val  Loss: 0.2796 | Val  Acc: 0.9565
 Site-cartoon                   (3) | Val  Loss: 0.2280 | Val  Acc: 0.9478
 Site-sketch                    (3) | Val  Loss: 0.8010 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9444
 Test site-photo                     (0)| Epoch:45 | Test Acc: 0.9925
 Test site-art_painting              (2)| Epoch:45 | Test Acc: 0.9184
 Test site-cartoon                   (3)| Epoch:45 | Test Acc: 0.9021
 Test site-sketch                    (3)| Epoch:45 | Test Acc: 0.8011
photo: 0.9925, art_painting: 0.9184, cartoon: 0.9021, sketch: 0.8011, 
Average Test Accuracy(group): 0.9036, Average Test Accuracy(individual): 0.9385,
domain std=0.0682, cluster std=0.0526, individual std=0.0583, 
Average Test Accuracy: 0.9036
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 47 ============
cnt=[3, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (0) | Train Loss: 0.1160 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1739 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.0706 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1029 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1181 | Train Acc: 0.9738
 Site-art_painting              (2) | Train Loss: 0.3105 | Train Acc: 0.9286
 Site-art_painting              (2) | Train Loss: 0.2427 | Train Acc: 0.9368
 Site-art_painting              (2) | Train Loss: 0.1831 | Train Acc: 0.9577
 Site-cartoon                   (3) | Train Loss: 0.3200 | Train Acc: 0.9412
 Site-cartoon                   (3) | Train Loss: 0.2374 | Train Acc: 0.9535
 Site-sketch                    (3) | Train Loss: 0.4767 | Train Acc: 0.8347
Average Train Accuracy: 0.9485
 Site-photo                     (0) | Val  Loss: 0.1047 | Val  Acc: 0.9667
 Site-photo                     (1) | Val  Loss: 0.1336 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.0905 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1258 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1065 | Val  Acc: 0.9803
 Site-art_painting              (2) | Val  Loss: 0.1700 | Val  Acc: 0.9643
 Site-art_painting              (2) | Val  Loss: 0.1297 | Val  Acc: 0.9841
 Site-art_painting              (2) | Val  Loss: 0.1980 | Val  Acc: 0.9718
 Site-cartoon                   (3) | Val  Loss: 0.2691 | Val  Acc: 0.9565
 Site-cartoon                   (3) | Val  Loss: 0.2158 | Val  Acc: 0.9739
 Site-sketch                    (3) | Val  Loss: 0.7118 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9516
 Best site-photo                    (0)  | Epoch:47 | Val Acc: 0.9667
 Best site-photo                    (1)  | Epoch:47 | Val Acc: 0.9778
 Best site-photo                    (1)  | Epoch:47 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:47 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:47 | Val Acc: 0.9803
 Best site-art_painting             (2)  | Epoch:47 | Val Acc: 0.9643
 Best site-art_painting             (2)  | Epoch:47 | Val Acc: 0.9841
 Best site-art_painting             (2)  | Epoch:47 | Val Acc: 0.9718
 Best site-cartoon                  (3)  | Epoch:47 | Val Acc: 0.9565
 Best site-cartoon                  (3)  | Epoch:47 | Val Acc: 0.9739
 Best site-sketch                   (3)  | Epoch:47 | Val Acc: 0.7750
 Test site-photo                     (0)| Epoch:47 | Test Acc: 0.9925
 Test site-art_painting              (2)| Epoch:47 | Test Acc: 0.9184
 Test site-cartoon                   (3)| Epoch:47 | Test Acc: 0.9021
 Test site-sketch                    (3)| Epoch:47 | Test Acc: 0.8011
photo: 0.9925, art_painting: 0.9184, cartoon: 0.9021, sketch: 0.8011, 
Average Test Accuracy(group): 0.9036, Average Test Accuracy(individual): 0.9385,
domain std=0.0682, cluster std=0.0526, individual std=0.0583, 
Average Test Accuracy: 0.9036
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 48 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (0) | Train Loss: 0.1186 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.0707 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.0567 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0882 | Train Acc: 0.9869
 Site-photo                     (0) | Train Loss: 0.0950 | Train Acc: 0.9738
 Site-art_painting              (2) | Train Loss: 0.3968 | Train Acc: 0.9048
 Site-art_painting              (2) | Train Loss: 0.2443 | Train Acc: 0.9158
 Site-art_painting              (2) | Train Loss: 0.1647 | Train Acc: 0.9577
 Site-cartoon                   (3) | Train Loss: 0.2970 | Train Acc: 0.8824
 Site-cartoon                   (3) | Train Loss: 0.2688 | Train Acc: 0.9360
 Site-sketch                    (3) | Train Loss: 0.4515 | Train Acc: 0.8595
Average Train Accuracy: 0.9436
 Site-photo                     (0) | Val  Loss: 0.0742 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0496 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0954 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.1110 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.0998 | Val  Acc: 0.9803
 Site-art_painting              (2) | Val  Loss: 0.1519 | Val  Acc: 0.9286
 Site-art_painting              (2) | Val  Loss: 0.1306 | Val  Acc: 0.9841
 Site-art_painting              (2) | Val  Loss: 0.2430 | Val  Acc: 0.9296
 Site-cartoon                   (3) | Val  Loss: 0.2914 | Val  Acc: 0.9130
 Site-cartoon                   (3) | Val  Loss: 0.2217 | Val  Acc: 0.9478
 Site-sketch                    (3) | Val  Loss: 0.7164 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9421
 Test site-photo                     (0)| Epoch:47 | Test Acc: 0.9925
 Test site-art_painting              (2)| Epoch:47 | Test Acc: 0.9184
 Test site-cartoon                   (3)| Epoch:47 | Test Acc: 0.9021
 Test site-sketch                    (3)| Epoch:47 | Test Acc: 0.8075
photo: 0.9925, art_painting: 0.9184, cartoon: 0.9021, sketch: 0.8075, 
Average Test Accuracy(group): 0.9051, Average Test Accuracy(individual): 0.9391,
domain std=0.0659, cluster std=0.0519, individual std=0.0569, 
Average Test Accuracy: 0.9051
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 49 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.0972 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3852 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0646 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1028 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1003 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.4425 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.2262 | Train Acc: 0.9684
 Site-art_painting              (1) | Train Loss: 0.1763 | Train Acc: 0.9671
 Site-cartoon                   (2) | Train Loss: 0.3784 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.2387 | Train Acc: 0.9535
 Site-sketch                    (2) | Train Loss: 0.4133 | Train Acc: 0.8678
Average Train Accuracy: 0.9449
 Site-photo                     (0) | Val  Loss: 0.1749 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1418 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0839 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1308 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1015 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.1669 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.1101 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.2437 | Val  Acc: 0.9577
 Site-cartoon                   (2) | Val  Loss: 0.2167 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.1967 | Val  Acc: 0.9739
 Site-sketch                    (2) | Val  Loss: 0.6862 | Val  Acc: 0.8250
Average Valid Accuracy: 0.9565
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:49 | Val Acc: 0.9643
 Best site-art_painting             (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:49 | Val Acc: 0.9577
 Best site-cartoon                  (2)  | Epoch:49 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:49 | Val Acc: 0.9739
 Best site-sketch                   (2)  | Epoch:49 | Val Acc: 0.8250
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9925
 Test site-art_painting              (1)| Epoch:49 | Test Acc: 0.9184
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.8957
 Test site-sketch                    (2)| Epoch:49 | Test Acc: 0.8088
photo: 0.9925, art_painting: 0.9184, cartoon: 0.8957, sketch: 0.8088, 
Average Test Accuracy(group): 0.9039, Average Test Accuracy(individual): 0.9380,
domain std=0.0655, cluster std=0.0516, individual std=0.0574, 
Average Test Accuracy: 0.9039
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1/ccop_q=1_finch...
===2023-08-07 00:00:50===
===2023-08-07 00:01:05===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 7
Loading snapshots...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9925
 Test site-art_painting              (1)| Epoch:49 | Test Acc: 0.9184
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.8957
 Test site-sketch                    (2)| Epoch:49 | Test Acc: 0.8088
photo: 0.9925, art_painting: 0.9184, cartoon: 0.8957, sketch: 0.8088, 
Average Test Accuracy(group): 0.9039, Average Test Accuracy(individual): 0.9380,
domain std=0.0655, cluster std=0.0516, individual std=0.0574, 
