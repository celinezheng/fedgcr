===2023-03-29 07:36:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7055 | Train Acc: 0.5616
 Site-MNIST     | Train Loss: 1.6661 | Train Acc: 0.6575
 Site-MNIST     | Train Loss: 1.7098 | Train Acc: 0.5342
 Site-MNIST     | Train Loss: 1.6537 | Train Acc: 0.5479
 Site-MNIST     | Train Loss: 1.6063 | Train Acc: 0.6438
 Site-MNIST     | Train Loss: 1.6797 | Train Acc: 0.6164
 Site-SVHN      | Train Loss: 2.2014 | Train Acc: 0.1781
 Site-USPS      | Train Loss: 1.7982 | Train Acc: 0.4795
 Site-SynthDigits| Train Loss: 2.1454 | Train Acc: 0.2877
 Site-MNIST-M   | Train Loss: 2.2331 | Train Acc: 0.1918
 Site-MNIST     | Val  Loss: 1.4834 | Val  Acc: 0.6122
 Site-MNIST     | Val  Loss: 1.6983 | Val  Acc: 0.4898
 Site-MNIST     | Val  Loss: 1.8274 | Val  Acc: 0.6735
 Site-MNIST     | Val  Loss: 1.6869 | Val  Acc: 0.4694
 Site-MNIST     | Val  Loss: 1.5982 | Val  Acc: 0.6122
 Site-MNIST     | Val  Loss: 1.5552 | Val  Acc: 0.6735
 Site-SVHN      | Val  Loss: 2.3079 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.8740 | Val  Acc: 0.4082
 Site-SynthDigits| Val  Loss: 1.9952 | Val  Acc: 0.3265
 Site-MNIST-M   | Val  Loss: 2.2539 | Val  Acc: 0.1224
Average Valid Accuracy: 0.4531
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6122
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4898
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6735
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4694
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6122
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6735
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1429
 Best site-USPS       | Epoch:0 | Val Acc: 0.4082
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3265
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1224
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2813 | Train Acc: 0.7260
 Site-MNIST     | Train Loss: 1.2433 | Train Acc: 0.7123
 Site-MNIST     | Train Loss: 1.2701 | Train Acc: 0.6986
 Site-MNIST     | Train Loss: 1.2406 | Train Acc: 0.7945
 Site-MNIST     | Train Loss: 1.1630 | Train Acc: 0.8219
 Site-MNIST     | Train Loss: 1.2471 | Train Acc: 0.7534
 Site-SVHN      | Train Loss: 2.1617 | Train Acc: 0.1918
 Site-USPS      | Train Loss: 1.4159 | Train Acc: 0.6849
 Site-SynthDigits| Train Loss: 1.9729 | Train Acc: 0.2877
 Site-MNIST-M   | Train Loss: 2.1156 | Train Acc: 0.2740
 Site-MNIST     | Val  Loss: 1.0695 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.2485 | Val  Acc: 0.8163
 Site-MNIST     | Val  Loss: 1.4253 | Val  Acc: 0.7959
 Site-MNIST     | Val  Loss: 1.2568 | Val  Acc: 0.6531
 Site-MNIST     | Val  Loss: 1.2003 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.1164 | Val  Acc: 0.7755
 Site-SVHN      | Val  Loss: 2.2387 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.5722 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.7544 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.1161 | Val  Acc: 0.1837
Average Valid Accuracy: 0.5898
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8163
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7959
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6531
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7755
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1429
 Best site-USPS       | Epoch:1 | Val Acc: 0.6531
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1837
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9751 | Train Acc: 0.7808
 Site-MNIST     | Train Loss: 0.9813 | Train Acc: 0.8356
 Site-MNIST     | Train Loss: 0.9979 | Train Acc: 0.8219
 Site-MNIST     | Train Loss: 0.9424 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.8707 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.9336 | Train Acc: 0.7945
 Site-SVHN      | Train Loss: 2.1156 | Train Acc: 0.2192
 Site-USPS      | Train Loss: 1.1496 | Train Acc: 0.7808
 Site-SynthDigits| Train Loss: 1.8325 | Train Acc: 0.3288
 Site-MNIST-M   | Train Loss: 1.9934 | Train Acc: 0.3288
 Site-MNIST     | Val  Loss: 0.7869 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.9380 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 1.1700 | Val  Acc: 0.8367
 Site-MNIST     | Val  Loss: 0.9529 | Val  Acc: 0.7959
 Site-MNIST     | Val  Loss: 0.9145 | Val  Acc: 0.8367
 Site-MNIST     | Val  Loss: 0.8114 | Val  Acc: 0.8163
 Site-SVHN      | Val  Loss: 2.1795 | Val  Acc: 0.1837
 Site-USPS      | Val  Loss: 1.3423 | Val  Acc: 0.7551
 Site-SynthDigits| Val  Loss: 1.5602 | Val  Acc: 0.3265
 Site-MNIST-M   | Val  Loss: 1.9874 | Val  Acc: 0.2245
Average Valid Accuracy: 0.6612
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8367
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7959
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8367
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8163
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1837
 Best site-USPS       | Epoch:2 | Val Acc: 0.7551
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3265
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7714 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.8192 | Train Acc: 0.8630
 Site-MNIST     | Train Loss: 0.8238 | Train Acc: 0.8904
 Site-MNIST     | Train Loss: 0.7405 | Train Acc: 0.9041
 Site-MNIST     | Train Loss: 0.7084 | Train Acc: 0.8904
 Site-MNIST     | Train Loss: 0.7335 | Train Acc: 0.8767
 Site-SVHN      | Train Loss: 2.0579 | Train Acc: 0.2740
 Site-USPS      | Train Loss: 0.9763 | Train Acc: 0.7945
 Site-SynthDigits| Train Loss: 1.7270 | Train Acc: 0.3699
 Site-MNIST-M   | Train Loss: 1.9174 | Train Acc: 0.3425
 Site-MNIST     | Val  Loss: 0.6237 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.7268 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.9917 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.7582 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7243 | Val  Acc: 0.8776
 Site-MNIST     | Val  Loss: 0.6203 | Val  Acc: 0.8776
 Site-SVHN      | Val  Loss: 2.2052 | Val  Acc: 0.1633
 Site-USPS      | Val  Loss: 1.1997 | Val  Acc: 0.7551
 Site-SynthDigits| Val  Loss: 1.4656 | Val  Acc: 0.3265
 Site-MNIST-M   | Val  Loss: 1.9137 | Val  Acc: 0.2449
Average Valid Accuracy: 0.6857
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8776
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8776
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1633
 Best site-USPS       | Epoch:3 | Val Acc: 0.7551
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3265
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2449
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6116 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.6540 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.6581 | Train Acc: 0.9178
 Site-MNIST     | Train Loss: 0.6119 | Train Acc: 0.9178
 Site-MNIST     | Train Loss: 0.6018 | Train Acc: 0.9178
 Site-MNIST     | Train Loss: 0.6462 | Train Acc: 0.8904
 Site-SVHN      | Train Loss: 2.0184 | Train Acc: 0.2740
 Site-USPS      | Train Loss: 0.8449 | Train Acc: 0.8219
 Site-SynthDigits| Train Loss: 1.6784 | Train Acc: 0.4247
 Site-MNIST-M   | Train Loss: 1.8345 | Train Acc: 0.3699
 Site-MNIST     | Val  Loss: 0.4983 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.5515 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.8381 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.6070 | Val  Acc: 0.8980
 Site-MNIST     | Val  Loss: 0.5944 | Val  Acc: 0.8980
 Site-MNIST     | Val  Loss: 0.4875 | Val  Acc: 0.8776
 Site-SVHN      | Val  Loss: 2.1804 | Val  Acc: 0.1633
 Site-USPS      | Val  Loss: 1.0841 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.3955 | Val  Acc: 0.3265
 Site-MNIST-M   | Val  Loss: 1.8425 | Val  Acc: 0.2245
Average Valid Accuracy: 0.7000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8980
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8980
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8776
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1633
 Best site-USPS       | Epoch:4 | Val Acc: 0.7959
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3265
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4904 | Train Acc: 0.9041
 Site-MNIST     | Train Loss: 0.5509 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.5285 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.4988 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.4848 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.5285 | Train Acc: 0.9178
 Site-SVHN      | Train Loss: 1.9800 | Train Acc: 0.2603
 Site-USPS      | Train Loss: 0.7392 | Train Acc: 0.8356
 Site-SynthDigits| Train Loss: 1.6226 | Train Acc: 0.4521
 Site-MNIST-M   | Train Loss: 1.7244 | Train Acc: 0.4521
 Site-MNIST     | Val  Loss: 0.4000 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.4183 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.7320 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.4819 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.4861 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.3820 | Val  Acc: 0.8776
 Site-SVHN      | Val  Loss: 2.1319 | Val  Acc: 0.1837
 Site-USPS      | Val  Loss: 0.9659 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 1.3520 | Val  Acc: 0.3878
 Site-MNIST-M   | Val  Loss: 1.7528 | Val  Acc: 0.3265
Average Valid Accuracy: 0.7306
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8776
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1837
 Best site-USPS       | Epoch:5 | Val Acc: 0.8163
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3878
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3265
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.3893 | Train Acc: 0.9178
 Site-MNIST     | Train Loss: 0.4425 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.4430 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.4031 | Train Acc: 0.9589
 Site-MNIST     | Train Loss: 0.3973 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.4152 | Train Acc: 0.9315
 Site-SVHN      | Train Loss: 1.9247 | Train Acc: 0.2740
 Site-USPS      | Train Loss: 0.6844 | Train Acc: 0.8493
 Site-SynthDigits| Train Loss: 1.6128 | Train Acc: 0.4521
 Site-MNIST-M   | Train Loss: 1.6412 | Train Acc: 0.4795
 Site-MNIST     | Val  Loss: 0.3165 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.3223 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.6442 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.3878 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.4014 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.3025 | Val  Acc: 0.8776
 Site-SVHN      | Val  Loss: 2.1333 | Val  Acc: 0.2041
 Site-USPS      | Val  Loss: 0.8440 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 1.3062 | Val  Acc: 0.4082
 Site-MNIST-M   | Val  Loss: 1.6460 | Val  Acc: 0.3673
Average Valid Accuracy: 0.7429
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8776
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2041
 Best site-USPS       | Epoch:6 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4082
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3673
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.3740 | Train Acc: 0.9178
 Site-MNIST     | Train Loss: 0.4053 | Train Acc: 0.9178
 Site-MNIST     | Train Loss: 0.3883 | Train Acc: 0.9452
 Site-MNIST     | Train Loss: 0.3333 | Train Acc: 0.9589
 Site-MNIST     | Train Loss: 0.3416 | Train Acc: 0.9452
 Site-MNIST     | Train Loss: 0.3641 | Train Acc: 0.9315
 Site-SVHN      | Train Loss: 1.8816 | Train Acc: 0.3014
 Site-USPS      | Train Loss: 0.6117 | Train Acc: 0.8767
 Site-SynthDigits| Train Loss: 1.5054 | Train Acc: 0.5068
 Site-MNIST-M   | Train Loss: 1.5582 | Train Acc: 0.5479
 Site-MNIST     | Val  Loss: 0.2645 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.2596 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.5803 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.3280 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.3462 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.2533 | Val  Acc: 0.9184
 Site-SVHN      | Val  Loss: 2.1101 | Val  Acc: 0.2245
 Site-USPS      | Val  Loss: 0.7421 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 1.2499 | Val  Acc: 0.4286
 Site-MNIST-M   | Val  Loss: 1.5462 | Val  Acc: 0.4490
Average Valid Accuracy: 0.7633
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9184
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2245
 Best site-USPS       | Epoch:7 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4286
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4490
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.3045 | Train Acc: 0.9178
 Site-MNIST     | Train Loss: 0.3880 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.3371 | Train Acc: 0.9589
 Site-MNIST     | Train Loss: 0.2899 | Train Acc: 0.9589
 Site-MNIST     | Train Loss: 0.2825 | Train Acc: 0.9452
 Site-MNIST     | Train Loss: 0.3215 | Train Acc: 0.9452
 Site-SVHN      | Train Loss: 1.8663 | Train Acc: 0.3562
 Site-USPS      | Train Loss: 0.6072 | Train Acc: 0.8767
 Site-SynthDigits| Train Loss: 1.4640 | Train Acc: 0.4932
 Site-MNIST-M   | Train Loss: 1.4612 | Train Acc: 0.6164
 Site-MNIST     | Val  Loss: 0.2231 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.2117 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.5341 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.2823 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.3066 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.2209 | Val  Acc: 0.9388
 Site-SVHN      | Val  Loss: 2.0756 | Val  Acc: 0.2449
 Site-USPS      | Val  Loss: 0.6632 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 1.2195 | Val  Acc: 0.4082
 Site-MNIST-M   | Val  Loss: 1.4672 | Val  Acc: 0.5102
Average Valid Accuracy: 0.7755
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9388
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2449
 Best site-USPS       | Epoch:8 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4082
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.2704 | Train Acc: 0.9452
 Site-MNIST     | Train Loss: 0.3379 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.2970 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.2431 | Train Acc: 0.9589
 Site-MNIST     | Train Loss: 0.2491 | Train Acc: 0.9589
 Site-MNIST     | Train Loss: 0.2898 | Train Acc: 0.9452
 Site-SVHN      | Train Loss: 1.7902 | Train Acc: 0.3562
 Site-USPS      | Train Loss: 0.5198 | Train Acc: 0.8767
 Site-SynthDigits| Train Loss: 1.3788 | Train Acc: 0.5342
 Site-MNIST-M   | Train Loss: 1.3465 | Train Acc: 0.6575
 Site-MNIST     | Val  Loss: 0.1910 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.1794 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.4753 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.2480 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.2776 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.2009 | Val  Acc: 0.9388
 Site-SVHN      | Val  Loss: 2.0656 | Val  Acc: 0.2449
 Site-USPS      | Val  Loss: 0.6012 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 1.1810 | Val  Acc: 0.4694
 Site-MNIST-M   | Val  Loss: 1.4186 | Val  Acc: 0.5510
Average Valid Accuracy: 0.7918
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9388
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2449
 Best site-USPS       | Epoch:9 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4694
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5510
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/CoCoOP...
===2023-03-29 08:03:40===
===2023-03-29 08:03:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8686
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2917
 Test site-USPS      | Epoch:9 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4390
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4543
Average Test Accuracy: 0.5806
