===2023-03-29 08:07:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6994 | Train Acc: 0.6164
 Site-MNIST     | Train Loss: 1.6088 | Train Acc: 0.6575
 Site-MNIST     | Train Loss: 1.6511 | Train Acc: 0.5616
 Site-MNIST     | Train Loss: 1.5855 | Train Acc: 0.5890
 Site-MNIST     | Train Loss: 1.5471 | Train Acc: 0.6986
 Site-MNIST     | Train Loss: 1.6273 | Train Acc: 0.6301
 Site-SVHN      | Train Loss: 2.2149 | Train Acc: 0.2055
 Site-USPS      | Train Loss: 1.7785 | Train Acc: 0.6027
 Site-SynthDigits| Train Loss: 2.1348 | Train Acc: 0.2466
 Site-MNIST-M   | Train Loss: 2.2050 | Train Acc: 0.1918
 Site-MNIST     | Val  Loss: 1.4313 | Val  Acc: 0.6735
 Site-MNIST     | Val  Loss: 1.6421 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7482 | Val  Acc: 0.6735
 Site-MNIST     | Val  Loss: 1.6783 | Val  Acc: 0.4898
 Site-MNIST     | Val  Loss: 1.5531 | Val  Acc: 0.6122
 Site-MNIST     | Val  Loss: 1.5168 | Val  Acc: 0.6939
 Site-SVHN      | Val  Loss: 2.3057 | Val  Acc: 0.1020
 Site-USPS      | Val  Loss: 1.8671 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.9745 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.2516 | Val  Acc: 0.1224
Average Valid Accuracy: 0.4776
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6735
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6735
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4898
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6122
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6939
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1020
 Best site-USPS       | Epoch:0 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1224
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1402 | Train Acc: 0.7260
 Site-MNIST     | Train Loss: 1.0781 | Train Acc: 0.7534
 Site-MNIST     | Train Loss: 1.1354 | Train Acc: 0.7260
 Site-MNIST     | Train Loss: 1.0749 | Train Acc: 0.7808
 Site-MNIST     | Train Loss: 0.9602 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 1.1188 | Train Acc: 0.7808
 Site-SVHN      | Train Loss: 2.2149 | Train Acc: 0.1644
 Site-USPS      | Train Loss: 1.2563 | Train Acc: 0.7397
 Site-SynthDigits| Train Loss: 1.9357 | Train Acc: 0.3836
 Site-MNIST-M   | Train Loss: 2.0539 | Train Acc: 0.3014
 Site-MNIST     | Val  Loss: 0.8727 | Val  Acc: 0.8980
 Site-MNIST     | Val  Loss: 1.0996 | Val  Acc: 0.7755
 Site-MNIST     | Val  Loss: 1.2457 | Val  Acc: 0.8367
 Site-MNIST     | Val  Loss: 1.1093 | Val  Acc: 0.6531
 Site-MNIST     | Val  Loss: 1.0333 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 0.9366 | Val  Acc: 0.7959
 Site-SVHN      | Val  Loss: 2.2901 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.4247 | Val  Acc: 0.6939
 Site-SynthDigits| Val  Loss: 1.6477 | Val  Acc: 0.3265
 Site-MNIST-M   | Val  Loss: 2.0263 | Val  Acc: 0.2653
Average Valid Accuracy: 0.6102
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8980
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7755
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8367
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6531
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7959
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1429
 Best site-USPS       | Epoch:1 | Val Acc: 0.6939
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3265
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2653
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7337 | Train Acc: 0.8356
 Site-MNIST     | Train Loss: 0.6980 | Train Acc: 0.8356
 Site-MNIST     | Train Loss: 0.6924 | Train Acc: 0.8356
 Site-MNIST     | Train Loss: 0.6390 | Train Acc: 0.8767
 Site-MNIST     | Train Loss: 0.5509 | Train Acc: 0.9178
 Site-MNIST     | Train Loss: 0.7353 | Train Acc: 0.7808
 Site-SVHN      | Train Loss: 2.0418 | Train Acc: 0.2329
 Site-USPS      | Train Loss: 0.9131 | Train Acc: 0.7671
 Site-SynthDigits| Train Loss: 1.7720 | Train Acc: 0.3973
 Site-MNIST-M   | Train Loss: 1.9316 | Train Acc: 0.3288
 Site-MNIST     | Val  Loss: 0.4570 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.5981 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.8007 | Val  Acc: 0.8776
 Site-MNIST     | Val  Loss: 0.6437 | Val  Acc: 0.7755
 Site-MNIST     | Val  Loss: 0.6350 | Val  Acc: 0.8367
 Site-MNIST     | Val  Loss: 0.5476 | Val  Acc: 0.8367
 Site-SVHN      | Val  Loss: 2.1868 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.1191 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.5016 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 1.8576 | Val  Acc: 0.2653
Average Valid Accuracy: 0.6551
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8776
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7755
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8367
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8367
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1429
 Best site-USPS       | Epoch:2 | Val Acc: 0.6735
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2857
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2653
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4461 | Train Acc: 0.8904
 Site-MNIST     | Train Loss: 0.4977 | Train Acc: 0.8493
 Site-MNIST     | Train Loss: 0.4700 | Train Acc: 0.9041
 Site-MNIST     | Train Loss: 0.3764 | Train Acc: 0.9452
 Site-MNIST     | Train Loss: 0.3583 | Train Acc: 0.9452
 Site-MNIST     | Train Loss: 0.4132 | Train Acc: 0.8767
 Site-SVHN      | Train Loss: 2.0293 | Train Acc: 0.3288
 Site-USPS      | Train Loss: 0.6723 | Train Acc: 0.8219
 Site-SynthDigits| Train Loss: 1.4088 | Train Acc: 0.5479
 Site-MNIST-M   | Train Loss: 1.7985 | Train Acc: 0.3836
 Site-MNIST     | Val  Loss: 0.3076 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.3600 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.5480 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.4294 | Val  Acc: 0.8776
 Site-MNIST     | Val  Loss: 0.4251 | Val  Acc: 0.8776
 Site-MNIST     | Val  Loss: 0.3424 | Val  Acc: 0.8776
 Site-SVHN      | Val  Loss: 2.3970 | Val  Acc: 0.2449
 Site-USPS      | Val  Loss: 0.7358 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.2837 | Val  Acc: 0.4286
 Site-MNIST-M   | Val  Loss: 1.7554 | Val  Acc: 0.3265
Average Valid Accuracy: 0.7245
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8776
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8776
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8776
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2449
 Best site-USPS       | Epoch:3 | Val Acc: 0.7959
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4286
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3265
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2553 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.3054 | Train Acc: 0.9041
 Site-MNIST     | Train Loss: 0.2535 | Train Acc: 0.9315
 Site-MNIST     | Train Loss: 0.1989 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.2037 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2558 | Train Acc: 0.9589
 Site-SVHN      | Train Loss: 1.8012 | Train Acc: 0.3836
 Site-USPS      | Train Loss: 0.4891 | Train Acc: 0.8630
 Site-SynthDigits| Train Loss: 1.3722 | Train Acc: 0.5205
 Site-MNIST-M   | Train Loss: 1.6581 | Train Acc: 0.4247
 Site-MNIST     | Val  Loss: 0.1622 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1682 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.2868 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.2260 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.2730 | Val  Acc: 0.8980
 Site-MNIST     | Val  Loss: 0.1804 | Val  Acc: 0.9388
 Site-SVHN      | Val  Loss: 2.2703 | Val  Acc: 0.2653
 Site-USPS      | Val  Loss: 0.6243 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 1.1789 | Val  Acc: 0.5102
 Site-MNIST-M   | Val  Loss: 1.6669 | Val  Acc: 0.3265
Average Valid Accuracy: 0.7633
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8980
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9388
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2653
 Best site-USPS       | Epoch:4 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5102
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3265
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1741 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.2533 | Train Acc: 0.9452
 Site-MNIST     | Train Loss: 0.2048 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.1602 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.1385 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1585 | Train Acc: 0.9863
 Site-SVHN      | Train Loss: 1.4095 | Train Acc: 0.5342
 Site-USPS      | Train Loss: 0.3799 | Train Acc: 0.8767
 Site-SynthDigits| Train Loss: 1.0478 | Train Acc: 0.6849
 Site-MNIST-M   | Train Loss: 1.2703 | Train Acc: 0.6712
 Site-MNIST     | Val  Loss: 0.1244 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1201 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2590 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.1858 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.2230 | Val  Acc: 0.9184
 Site-MNIST     | Val  Loss: 0.1195 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 2.1741 | Val  Acc: 0.2857
 Site-USPS      | Val  Loss: 0.4574 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 1.0751 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 1.4726 | Val  Acc: 0.4490
Average Valid Accuracy: 0.8020
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9184
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2857
 Best site-USPS       | Epoch:5 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4490
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1111 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.2004 | Train Acc: 0.9589
 Site-MNIST     | Train Loss: 0.1357 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.1136 | Train Acc: 0.9863
 Site-MNIST     | Train Loss: 0.0925 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1190 | Train Acc: 0.9863
 Site-SVHN      | Train Loss: 1.6460 | Train Acc: 0.4247
 Site-USPS      | Train Loss: 0.3657 | Train Acc: 0.9041
 Site-SynthDigits| Train Loss: 0.9351 | Train Acc: 0.6849
 Site-MNIST-M   | Train Loss: 1.2100 | Train Acc: 0.6438
 Site-MNIST     | Val  Loss: 0.0738 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0601 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1445 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.1174 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.1701 | Val  Acc: 0.9388
 Site-MNIST     | Val  Loss: 0.0957 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 2.1953 | Val  Acc: 0.2653
 Site-USPS      | Val  Loss: 0.4619 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.9939 | Val  Acc: 0.5918
 Site-MNIST-M   | Val  Loss: 1.4725 | Val  Acc: 0.4490
Average Valid Accuracy: 0.8041
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9388
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2653
 Best site-USPS       | Epoch:6 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5918
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4490
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0900 | Train Acc: 0.9863
 Site-MNIST     | Train Loss: 0.1403 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.1048 | Train Acc: 0.9863
 Site-MNIST     | Train Loss: 0.0861 | Train Acc: 0.9863
 Site-MNIST     | Train Loss: 0.0687 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0866 | Train Acc: 0.9863
 Site-SVHN      | Train Loss: 1.1017 | Train Acc: 0.7534
 Site-USPS      | Train Loss: 0.3095 | Train Acc: 0.9041
 Site-SynthDigits| Train Loss: 0.7154 | Train Acc: 0.7945
 Site-MNIST-M   | Train Loss: 0.7802 | Train Acc: 0.8767
 Site-MNIST     | Val  Loss: 0.0624 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0522 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1417 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.0864 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1323 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.0632 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.9455 | Val  Acc: 0.3878
 Site-USPS      | Val  Loss: 0.3263 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.9161 | Val  Acc: 0.6122
 Site-MNIST-M   | Val  Loss: 1.3185 | Val  Acc: 0.5102
Average Valid Accuracy: 0.8306
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3878
 Best site-USPS       | Epoch:7 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6122
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0507 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1134 | Train Acc: 0.9726
 Site-MNIST     | Train Loss: 0.0500 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0366 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0381 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0528 | Train Acc: 0.9863
 Site-SVHN      | Train Loss: 1.0184 | Train Acc: 0.7397
 Site-USPS      | Train Loss: 0.2357 | Train Acc: 0.9178
 Site-SynthDigits| Train Loss: 0.6618 | Train Acc: 0.8356
 Site-MNIST-M   | Train Loss: 0.7092 | Train Acc: 0.8219
 Site-MNIST     | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0228 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0579 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0423 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0880 | Val  Acc: 0.9592
 Site-MNIST     | Val  Loss: 0.0388 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 2.0327 | Val  Acc: 0.3265
 Site-USPS      | Val  Loss: 0.3043 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.8956 | Val  Acc: 0.6939
 Site-MNIST-M   | Val  Loss: 1.2997 | Val  Acc: 0.5102
Average Valid Accuracy: 0.8367
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9592
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3265
 Best site-USPS       | Epoch:8 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6939
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0370 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0684 | Train Acc: 0.9863
 Site-MNIST     | Train Loss: 0.0465 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0446 | Train Acc: 0.9863
 Site-MNIST     | Train Loss: 0.0251 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0386 | Train Acc: 0.9863
 Site-SVHN      | Train Loss: 0.7336 | Train Acc: 0.8356
 Site-USPS      | Train Loss: 0.1366 | Train Acc: 0.9863
 Site-SynthDigits| Train Loss: 0.4034 | Train Acc: 0.9452
 Site-MNIST-M   | Train Loss: 0.4436 | Train Acc: 0.9863
 Site-MNIST     | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0234 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0683 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0605 | Val  Acc: 0.9796
 Site-MNIST     | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.7908 | Val  Acc: 0.4286
 Site-USPS      | Val  Loss: 0.1881 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.7484 | Val  Acc: 0.7347
 Site-MNIST-M   | Val  Loss: 1.1160 | Val  Acc: 0.6531
Average Valid Accuracy: 0.8735
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9796
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4286
 Best site-USPS       | Epoch:9 | Val Acc: 0.9592
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7347
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6531
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3/FedPrompt...
===2023-03-29 08:35:44===
===2023-03-29 08:35:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8893
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2655
 Test site-USPS      | Epoch:9 | Test Acc: 0.8656
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4818
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3757
Average Test Accuracy: 0.5756
